var Jhe=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var ybt=Jhe((vbt,LR)=>{function Qhe(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const i in n)if(i!=="default"&&!(i in e)){const o=Object.getOwnPropertyDescriptor(n,i);o&&Object.defineProperty(e,i,o.get?o:{enumerable:!0,get:()=>n[i]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function r(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(i){if(i.ep)return;i.ep=!0;const o=r(i);fetch(i.href,o)}})();var ug=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function V_(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function ede(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function n(){if(this instanceof n){var i=[null];i.push.apply(i,arguments);var o=Function.bind.apply(t,i);return new o}return t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var i=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,i.get?i:{enumerable:!0,get:function(){return e[n]}})}),r}var DQ={exports:{}},TP={},$Q={exports:{}},Tn={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Rx=Symbol.for("react.element"),tde=Symbol.for("react.portal"),rde=Symbol.for("react.fragment"),nde=Symbol.for("react.strict_mode"),ide=Symbol.for("react.profiler"),ode=Symbol.for("react.provider"),ade=Symbol.for("react.context"),sde=Symbol.for("react.forward_ref"),lde=Symbol.for("react.suspense"),ude=Symbol.for("react.memo"),cde=Symbol.for("react.lazy"),t5=Symbol.iterator;function fde(e){return e===null||typeof e!="object"?null:(e=t5&&e[t5]||e["@@iterator"],typeof e=="function"?e:null)}var LQ={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},NQ=Object.assign,BQ={};function U_(e,t,r){this.props=e,this.context=t,this.refs=BQ,this.updater=r||LQ}U_.prototype.isReactComponent={};U_.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};U_.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function jQ(){}jQ.prototype=U_.prototype;function Mz(e,t,r){this.props=e,this.context=t,this.refs=BQ,this.updater=r||LQ}var Dz=Mz.prototype=new jQ;Dz.constructor=Mz;NQ(Dz,U_.prototype);Dz.isPureReactComponent=!0;var r5=Array.isArray,zQ=Object.prototype.hasOwnProperty,$z={current:null},FQ={key:!0,ref:!0,__self:!0,__source:!0};function HQ(e,t,r){var n,i={},o=null,s=null;if(t!=null)for(n in t.ref!==void 0&&(s=t.ref),t.key!==void 0&&(o=""+t.key),t)zQ.call(t,n)&&!FQ.hasOwnProperty(n)&&(i[n]=t[n]);var a=arguments.length-2;if(a===1)i.children=r;else if(1<a){for(var h=Array(a),p=0;p<a;p++)h[p]=arguments[p+2];i.children=h}if(e&&e.defaultProps)for(n in a=e.defaultProps,a)i[n]===void 0&&(i[n]=a[n]);return{$$typeof:Rx,type:e,key:o,ref:s,props:i,_owner:$z.current}}function hde(e,t){return{$$typeof:Rx,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Lz(e){return typeof e=="object"&&e!==null&&e.$$typeof===Rx}function dde(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var n5=/\/+/g;function RM(e,t){return typeof e=="object"&&e!==null&&e.key!=null?dde(""+e.key):t.toString(36)}function LO(e,t,r,n,i){var o=typeof e;(o==="undefined"||o==="boolean")&&(e=null);var s=!1;if(e===null)s=!0;else switch(o){case"string":case"number":s=!0;break;case"object":switch(e.$$typeof){case Rx:case tde:s=!0}}if(s)return s=e,i=i(s),e=n===""?"."+RM(s,0):n,r5(i)?(r="",e!=null&&(r=e.replace(n5,"$&/")+"/"),LO(i,t,r,"",function(p){return p})):i!=null&&(Lz(i)&&(i=hde(i,r+(!i.key||s&&s.key===i.key?"":(""+i.key).replace(n5,"$&/")+"/")+e)),t.push(i)),1;if(s=0,n=n===""?".":n+":",r5(e))for(var a=0;a<e.length;a++){o=e[a];var h=n+RM(o,a);s+=LO(o,t,r,h,i)}else if(h=fde(e),typeof h=="function")for(e=h.call(e),a=0;!(o=e.next()).done;)o=o.value,h=n+RM(o,a++),s+=LO(o,t,r,h,i);else if(o==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return s}function lT(e,t,r){if(e==null)return e;var n=[],i=0;return LO(e,n,"","",function(o){return t.call(r,o,i++)}),n}function pde(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var va={current:null},NO={transition:null},mde={ReactCurrentDispatcher:va,ReactCurrentBatchConfig:NO,ReactCurrentOwner:$z};Tn.Children={map:lT,forEach:function(e,t,r){lT(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return lT(e,function(){t++}),t},toArray:function(e){return lT(e,function(t){return t})||[]},only:function(e){if(!Lz(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Tn.Component=U_;Tn.Fragment=rde;Tn.Profiler=ide;Tn.PureComponent=Mz;Tn.StrictMode=nde;Tn.Suspense=lde;Tn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=mde;Tn.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=NQ({},e.props),i=e.key,o=e.ref,s=e._owner;if(t!=null){if(t.ref!==void 0&&(o=t.ref,s=$z.current),t.key!==void 0&&(i=""+t.key),e.type&&e.type.defaultProps)var a=e.type.defaultProps;for(h in t)zQ.call(t,h)&&!FQ.hasOwnProperty(h)&&(n[h]=t[h]===void 0&&a!==void 0?a[h]:t[h])}var h=arguments.length-2;if(h===1)n.children=r;else if(1<h){a=Array(h);for(var p=0;p<h;p++)a[p]=arguments[p+2];n.children=a}return{$$typeof:Rx,type:e.type,key:i,ref:o,props:n,_owner:s}};Tn.createContext=function(e){return e={$$typeof:ade,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:ode,_context:e},e.Consumer=e};Tn.createElement=HQ;Tn.createFactory=function(e){var t=HQ.bind(null,e);return t.type=e,t};Tn.createRef=function(){return{current:null}};Tn.forwardRef=function(e){return{$$typeof:sde,render:e}};Tn.isValidElement=Lz;Tn.lazy=function(e){return{$$typeof:cde,_payload:{_status:-1,_result:e},_init:pde}};Tn.memo=function(e,t){return{$$typeof:ude,type:e,compare:t===void 0?null:t}};Tn.startTransition=function(e){var t=NO.transition;NO.transition={};try{e()}finally{NO.transition=t}};Tn.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};Tn.useCallback=function(e,t){return va.current.useCallback(e,t)};Tn.useContext=function(e){return va.current.useContext(e)};Tn.useDebugValue=function(){};Tn.useDeferredValue=function(e){return va.current.useDeferredValue(e)};Tn.useEffect=function(e,t){return va.current.useEffect(e,t)};Tn.useId=function(){return va.current.useId()};Tn.useImperativeHandle=function(e,t,r){return va.current.useImperativeHandle(e,t,r)};Tn.useInsertionEffect=function(e,t){return va.current.useInsertionEffect(e,t)};Tn.useLayoutEffect=function(e,t){return va.current.useLayoutEffect(e,t)};Tn.useMemo=function(e,t){return va.current.useMemo(e,t)};Tn.useReducer=function(e,t,r){return va.current.useReducer(e,t,r)};Tn.useRef=function(e){return va.current.useRef(e)};Tn.useState=function(e){return va.current.useState(e)};Tn.useSyncExternalStore=function(e,t,r){return va.current.useSyncExternalStore(e,t,r)};Tn.useTransition=function(){return va.current.useTransition()};Tn.version="18.2.0";$Q.exports=Tn;var Rt=$Q.exports;const ro=V_(Rt);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yde=Rt,gde=Symbol.for("react.element"),vde=Symbol.for("react.fragment"),_de=Object.prototype.hasOwnProperty,bde=yde.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,wde={key:!0,ref:!0,__self:!0,__source:!0};function VQ(e,t,r){var n,i={},o=null,s=null;r!==void 0&&(o=""+r),t.key!==void 0&&(o=""+t.key),t.ref!==void 0&&(s=t.ref);for(n in t)_de.call(t,n)&&!wde.hasOwnProperty(n)&&(i[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)i[n]===void 0&&(i[n]=t[n]);return{$$typeof:gde,type:e,key:o,ref:s,props:i,_owner:bde.current}}TP.Fragment=vde;TP.jsx=VQ;TP.jsxs=VQ;DQ.exports=TP;var Qe=DQ.exports,L2={},UQ={exports:{}},ls={},WQ={exports:{}},GQ={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(ae,D){var U=ae.length;ae.push(D);e:for(;0<U;){var q=U-1>>>1,ne=ae[q];if(0<i(ne,D))ae[q]=D,ae[U]=ne,U=q;else break e}}function r(ae){return ae.length===0?null:ae[0]}function n(ae){if(ae.length===0)return null;var D=ae[0],U=ae.pop();if(U!==D){ae[0]=U;e:for(var q=0,ne=ae.length,ye=ne>>>1;q<ye;){var ve=2*(q+1)-1,ze=ae[ve],je=ve+1,Je=ae[je];if(0>i(ze,U))je<ne&&0>i(Je,ze)?(ae[q]=Je,ae[je]=U,q=je):(ae[q]=ze,ae[ve]=U,q=ve);else if(je<ne&&0>i(Je,U))ae[q]=Je,ae[je]=U,q=je;else break e}}return D}function i(ae,D){var U=ae.sortIndex-D.sortIndex;return U!==0?U:ae.id-D.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;e.unstable_now=function(){return o.now()}}else{var s=Date,a=s.now();e.unstable_now=function(){return s.now()-a}}var h=[],p=[],g=1,S=null,T=3,R=!1,A=!1,$=!1,j=typeof setTimeout=="function"?setTimeout:null,z=typeof clearTimeout=="function"?clearTimeout:null,V=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function G(ae){for(var D=r(p);D!==null;){if(D.callback===null)n(p);else if(D.startTime<=ae)n(p),D.sortIndex=D.expirationTime,t(h,D);else break;D=r(p)}}function ee(ae){if($=!1,G(ae),!A)if(r(h)!==null)A=!0,At(K);else{var D=r(p);D!==null&&Gt(ee,D.startTime-ae)}}function K(ae,D){A=!1,$&&($=!1,z(He),He=-1),R=!0;var U=T;try{for(G(D),S=r(h);S!==null&&(!(S.expirationTime>D)||ae&&!gt());){var q=S.callback;if(typeof q=="function"){S.callback=null,T=S.priorityLevel;var ne=q(S.expirationTime<=D);D=e.unstable_now(),typeof ne=="function"?S.callback=ne:S===r(h)&&n(h),G(D)}else n(h);S=r(h)}if(S!==null)var ye=!0;else{var ve=r(p);ve!==null&&Gt(ee,ve.startTime-D),ye=!1}return ye}finally{S=null,T=U,R=!1}}var xe=!1,Me=null,He=-1,Ne=5,We=-1;function gt(){return!(e.unstable_now()-We<Ne)}function Lt(){if(Me!==null){var ae=e.unstable_now();We=ae;var D=!0;try{D=Me(!0,ae)}finally{D?_t():(xe=!1,Me=null)}}else xe=!1}var _t;if(typeof V=="function")_t=function(){V(Lt)};else if(typeof MessageChannel<"u"){var $e=new MessageChannel,Fe=$e.port2;$e.port1.onmessage=Lt,_t=function(){Fe.postMessage(null)}}else _t=function(){j(Lt,0)};function At(ae){Me=ae,xe||(xe=!0,_t())}function Gt(ae,D){He=j(function(){ae(e.unstable_now())},D)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(ae){ae.callback=null},e.unstable_continueExecution=function(){A||R||(A=!0,At(K))},e.unstable_forceFrameRate=function(ae){0>ae||125<ae?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Ne=0<ae?Math.floor(1e3/ae):5},e.unstable_getCurrentPriorityLevel=function(){return T},e.unstable_getFirstCallbackNode=function(){return r(h)},e.unstable_next=function(ae){switch(T){case 1:case 2:case 3:var D=3;break;default:D=T}var U=T;T=D;try{return ae()}finally{T=U}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(ae,D){switch(ae){case 1:case 2:case 3:case 4:case 5:break;default:ae=3}var U=T;T=ae;try{return D()}finally{T=U}},e.unstable_scheduleCallback=function(ae,D,U){var q=e.unstable_now();switch(typeof U=="object"&&U!==null?(U=U.delay,U=typeof U=="number"&&0<U?q+U:q):U=q,ae){case 1:var ne=-1;break;case 2:ne=250;break;case 5:ne=1073741823;break;case 4:ne=1e4;break;default:ne=5e3}return ne=U+ne,ae={id:g++,callback:D,priorityLevel:ae,startTime:U,expirationTime:ne,sortIndex:-1},U>q?(ae.sortIndex=U,t(p,ae),r(h)===null&&ae===r(p)&&($?(z(He),He=-1):$=!0,Gt(ee,U-q))):(ae.sortIndex=ne,t(h,ae),A||R||(A=!0,At(K))),ae},e.unstable_shouldYield=gt,e.unstable_wrapCallback=function(ae){var D=T;return function(){var U=T;T=D;try{return ae.apply(this,arguments)}finally{T=U}}}})(GQ);WQ.exports=GQ;var Sde=WQ.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var YQ=Rt,ss=Sde;function Kt(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var KQ=new Set,Q0={};function Vp(e,t){Pg(e,t),Pg(e+"Capture",t)}function Pg(e,t){for(Q0[e]=t,e=0;e<t.length;e++)KQ.add(t[e])}var Cc=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),N2=Object.prototype.hasOwnProperty,xde=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,i5={},o5={};function Cde(e){return N2.call(o5,e)?!0:N2.call(i5,e)?!1:xde.test(e)?o5[e]=!0:(i5[e]=!0,!1)}function Ede(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function Tde(e,t,r,n){if(t===null||typeof t>"u"||Ede(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function _a(e,t,r,n,i,o,s){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=o,this.removeEmptyString=s}var Bo={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Bo[e]=new _a(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Bo[t]=new _a(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Bo[e]=new _a(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Bo[e]=new _a(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Bo[e]=new _a(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Bo[e]=new _a(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Bo[e]=new _a(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Bo[e]=new _a(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Bo[e]=new _a(e,5,!1,e.toLowerCase(),null,!1,!1)});var Nz=/[\-:]([a-z])/g;function Bz(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Nz,Bz);Bo[t]=new _a(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Nz,Bz);Bo[t]=new _a(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Nz,Bz);Bo[t]=new _a(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Bo[e]=new _a(e,1,!1,e.toLowerCase(),null,!1,!1)});Bo.xlinkHref=new _a("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Bo[e]=new _a(e,1,!1,e.toLowerCase(),null,!0,!0)});function jz(e,t,r,n){var i=Bo.hasOwnProperty(t)?Bo[t]:null;(i!==null?i.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(Tde(t,r,i,n)&&(r=null),n||i===null?Cde(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):i.mustUseProperty?e[i.propertyName]=r===null?i.type===3?!1:"":r:(t=i.attributeName,n=i.attributeNamespace,r===null?e.removeAttribute(t):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var Mc=YQ.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,uT=Symbol.for("react.element"),Yy=Symbol.for("react.portal"),Ky=Symbol.for("react.fragment"),zz=Symbol.for("react.strict_mode"),B2=Symbol.for("react.profiler"),qQ=Symbol.for("react.provider"),XQ=Symbol.for("react.context"),Fz=Symbol.for("react.forward_ref"),j2=Symbol.for("react.suspense"),z2=Symbol.for("react.suspense_list"),Hz=Symbol.for("react.memo"),Pf=Symbol.for("react.lazy"),ZQ=Symbol.for("react.offscreen"),a5=Symbol.iterator;function Aw(e){return e===null||typeof e!="object"?null:(e=a5&&e[a5]||e["@@iterator"],typeof e=="function"?e:null)}var Li=Object.assign,kM;function y0(e){if(kM===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);kM=t&&t[1]||""}return`
`+kM+e}var PM=!1;function AM(e,t){if(!e||PM)return"";PM=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(p){var n=p}Reflect.construct(e,[],t)}else{try{t.call()}catch(p){n=p}e.call(t.prototype)}else{try{throw Error()}catch(p){n=p}e()}}catch(p){if(p&&n&&typeof p.stack=="string"){for(var i=p.stack.split(`
`),o=n.stack.split(`
`),s=i.length-1,a=o.length-1;1<=s&&0<=a&&i[s]!==o[a];)a--;for(;1<=s&&0<=a;s--,a--)if(i[s]!==o[a]){if(s!==1||a!==1)do if(s--,a--,0>a||i[s]!==o[a]){var h=`
`+i[s].replace(" at new "," at ");return e.displayName&&h.includes("<anonymous>")&&(h=h.replace("<anonymous>",e.displayName)),h}while(1<=s&&0<=a);break}}}finally{PM=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?y0(e):""}function Ode(e){switch(e.tag){case 5:return y0(e.type);case 16:return y0("Lazy");case 13:return y0("Suspense");case 19:return y0("SuspenseList");case 0:case 2:case 15:return e=AM(e.type,!1),e;case 11:return e=AM(e.type.render,!1),e;case 1:return e=AM(e.type,!0),e;default:return""}}function F2(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Ky:return"Fragment";case Yy:return"Portal";case B2:return"Profiler";case zz:return"StrictMode";case j2:return"Suspense";case z2:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case XQ:return(e.displayName||"Context")+".Consumer";case qQ:return(e._context.displayName||"Context")+".Provider";case Fz:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Hz:return t=e.displayName||null,t!==null?t:F2(e.type)||"Memo";case Pf:t=e._payload,e=e._init;try{return F2(e(t))}catch{}}return null}function Rde(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return F2(t);case 8:return t===zz?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function dh(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function JQ(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function kde(e){var t=JQ(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,o=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(s){n=""+s,o.call(this,s)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(s){n=""+s},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function cT(e){e._valueTracker||(e._valueTracker=kde(e))}function QQ(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=JQ(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function NR(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function H2(e,t){var r=t.checked;return Li({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function s5(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=dh(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function eee(e,t){t=t.checked,t!=null&&jz(e,"checked",t,!1)}function V2(e,t){eee(e,t);var r=dh(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?U2(e,t.type,r):t.hasOwnProperty("defaultValue")&&U2(e,t.type,dh(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function l5(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function U2(e,t,r){(t!=="number"||NR(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var g0=Array.isArray;function cg(e,t,r,n){if(e=e.options,t){t={};for(var i=0;i<r.length;i++)t["$"+r[i]]=!0;for(r=0;r<e.length;r++)i=t.hasOwnProperty("$"+e[r].value),e[r].selected!==i&&(e[r].selected=i),i&&n&&(e[r].defaultSelected=!0)}else{for(r=""+dh(r),t=null,i=0;i<e.length;i++){if(e[i].value===r){e[i].selected=!0,n&&(e[i].defaultSelected=!0);return}t!==null||e[i].disabled||(t=e[i])}t!==null&&(t.selected=!0)}}function W2(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(Kt(91));return Li({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function u5(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(Kt(92));if(g0(r)){if(1<r.length)throw Error(Kt(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:dh(r)}}function tee(e,t){var r=dh(t.value),n=dh(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function c5(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function ree(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function G2(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?ree(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var fT,nee=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,i){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,i)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(fT=fT||document.createElement("div"),fT.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=fT.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function eS(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var O0={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Pde=["Webkit","ms","Moz","O"];Object.keys(O0).forEach(function(e){Pde.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),O0[t]=O0[e]})});function iee(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||O0.hasOwnProperty(e)&&O0[e]?(""+t).trim():t+"px"}function oee(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=iee(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,i):e[r]=i}}var Ade=Li({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Y2(e,t){if(t){if(Ade[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(Kt(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(Kt(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(Kt(61))}if(t.style!=null&&typeof t.style!="object")throw Error(Kt(62))}}function K2(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var q2=null;function Vz(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var X2=null,fg=null,hg=null;function f5(e){if(e=Ax(e)){if(typeof X2!="function")throw Error(Kt(280));var t=e.stateNode;t&&(t=AP(t),X2(e.stateNode,e.type,t))}}function aee(e){fg?hg?hg.push(e):hg=[e]:fg=e}function see(){if(fg){var e=fg,t=hg;if(hg=fg=null,f5(e),t)for(e=0;e<t.length;e++)f5(t[e])}}function lee(e,t){return e(t)}function uee(){}var IM=!1;function cee(e,t,r){if(IM)return e(t,r);IM=!0;try{return lee(e,t,r)}finally{IM=!1,(fg!==null||hg!==null)&&(uee(),see())}}function tS(e,t){var r=e.stateNode;if(r===null)return null;var n=AP(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(Kt(231,t,typeof r));return r}var Z2=!1;if(Cc)try{var Iw={};Object.defineProperty(Iw,"passive",{get:function(){Z2=!0}}),window.addEventListener("test",Iw,Iw),window.removeEventListener("test",Iw,Iw)}catch{Z2=!1}function Ide(e,t,r,n,i,o,s,a,h){var p=Array.prototype.slice.call(arguments,3);try{t.apply(r,p)}catch(g){this.onError(g)}}var R0=!1,BR=null,jR=!1,J2=null,Mde={onError:function(e){R0=!0,BR=e}};function Dde(e,t,r,n,i,o,s,a,h){R0=!1,BR=null,Ide.apply(Mde,arguments)}function $de(e,t,r,n,i,o,s,a,h){if(Dde.apply(this,arguments),R0){if(R0){var p=BR;R0=!1,BR=null}else throw Error(Kt(198));jR||(jR=!0,J2=p)}}function Up(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function fee(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function h5(e){if(Up(e)!==e)throw Error(Kt(188))}function Lde(e){var t=e.alternate;if(!t){if(t=Up(e),t===null)throw Error(Kt(188));return t!==e?null:e}for(var r=e,n=t;;){var i=r.return;if(i===null)break;var o=i.alternate;if(o===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===r)return h5(i),e;if(o===n)return h5(i),t;o=o.sibling}throw Error(Kt(188))}if(r.return!==n.return)r=i,n=o;else{for(var s=!1,a=i.child;a;){if(a===r){s=!0,r=i,n=o;break}if(a===n){s=!0,n=i,r=o;break}a=a.sibling}if(!s){for(a=o.child;a;){if(a===r){s=!0,r=o,n=i;break}if(a===n){s=!0,n=o,r=i;break}a=a.sibling}if(!s)throw Error(Kt(189))}}if(r.alternate!==n)throw Error(Kt(190))}if(r.tag!==3)throw Error(Kt(188));return r.stateNode.current===r?e:t}function hee(e){return e=Lde(e),e!==null?dee(e):null}function dee(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=dee(e);if(t!==null)return t;e=e.sibling}return null}var pee=ss.unstable_scheduleCallback,d5=ss.unstable_cancelCallback,Nde=ss.unstable_shouldYield,Bde=ss.unstable_requestPaint,qi=ss.unstable_now,jde=ss.unstable_getCurrentPriorityLevel,Uz=ss.unstable_ImmediatePriority,mee=ss.unstable_UserBlockingPriority,zR=ss.unstable_NormalPriority,zde=ss.unstable_LowPriority,yee=ss.unstable_IdlePriority,OP=null,iu=null;function Fde(e){if(iu&&typeof iu.onCommitFiberRoot=="function")try{iu.onCommitFiberRoot(OP,e,void 0,(e.current.flags&128)===128)}catch{}}var dl=Math.clz32?Math.clz32:Ude,Hde=Math.log,Vde=Math.LN2;function Ude(e){return e>>>=0,e===0?32:31-(Hde(e)/Vde|0)|0}var hT=64,dT=4194304;function v0(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function FR(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,i=e.suspendedLanes,o=e.pingedLanes,s=r&268435455;if(s!==0){var a=s&~i;a!==0?n=v0(a):(o&=s,o!==0&&(n=v0(o)))}else s=r&~i,s!==0?n=v0(s):o!==0&&(n=v0(o));if(n===0)return 0;if(t!==0&&t!==n&&!(t&i)&&(i=n&-n,o=t&-t,i>=o||i===16&&(o&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-dl(t),i=1<<r,n|=e[r],t&=~i;return n}function Wde(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Gde(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,i=e.expirationTimes,o=e.pendingLanes;0<o;){var s=31-dl(o),a=1<<s,h=i[s];h===-1?(!(a&r)||a&n)&&(i[s]=Wde(a,t)):h<=t&&(e.expiredLanes|=a),o&=~a}}function Q2(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function gee(){var e=hT;return hT<<=1,!(hT&4194240)&&(hT=64),e}function MM(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function kx(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-dl(t),e[t]=r}function Yde(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var i=31-dl(r),o=1<<i;t[i]=0,n[i]=-1,e[i]=-1,r&=~o}}function Wz(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-dl(r),i=1<<n;i&t|e[n]&t&&(e[n]|=t),r&=~i}}var Qn=0;function vee(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var _ee,Gz,bee,wee,See,eL=!1,pT=[],Uf=null,Wf=null,Gf=null,rS=new Map,nS=new Map,Mf=[],Kde="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function p5(e,t){switch(e){case"focusin":case"focusout":Uf=null;break;case"dragenter":case"dragleave":Wf=null;break;case"mouseover":case"mouseout":Gf=null;break;case"pointerover":case"pointerout":rS.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":nS.delete(t.pointerId)}}function Mw(e,t,r,n,i,o){return e===null||e.nativeEvent!==o?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:o,targetContainers:[i]},t!==null&&(t=Ax(t),t!==null&&Gz(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,i!==null&&t.indexOf(i)===-1&&t.push(i),e)}function qde(e,t,r,n,i){switch(t){case"focusin":return Uf=Mw(Uf,e,t,r,n,i),!0;case"dragenter":return Wf=Mw(Wf,e,t,r,n,i),!0;case"mouseover":return Gf=Mw(Gf,e,t,r,n,i),!0;case"pointerover":var o=i.pointerId;return rS.set(o,Mw(rS.get(o)||null,e,t,r,n,i)),!0;case"gotpointercapture":return o=i.pointerId,nS.set(o,Mw(nS.get(o)||null,e,t,r,n,i)),!0}return!1}function xee(e){var t=Fd(e.target);if(t!==null){var r=Up(t);if(r!==null){if(t=r.tag,t===13){if(t=fee(r),t!==null){e.blockedOn=t,See(e.priority,function(){bee(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function BO(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=tL(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);q2=n,r.target.dispatchEvent(n),q2=null}else return t=Ax(r),t!==null&&Gz(t),e.blockedOn=r,!1;t.shift()}return!0}function m5(e,t,r){BO(e)&&r.delete(t)}function Xde(){eL=!1,Uf!==null&&BO(Uf)&&(Uf=null),Wf!==null&&BO(Wf)&&(Wf=null),Gf!==null&&BO(Gf)&&(Gf=null),rS.forEach(m5),nS.forEach(m5)}function Dw(e,t){e.blockedOn===t&&(e.blockedOn=null,eL||(eL=!0,ss.unstable_scheduleCallback(ss.unstable_NormalPriority,Xde)))}function iS(e){function t(i){return Dw(i,e)}if(0<pT.length){Dw(pT[0],e);for(var r=1;r<pT.length;r++){var n=pT[r];n.blockedOn===e&&(n.blockedOn=null)}}for(Uf!==null&&Dw(Uf,e),Wf!==null&&Dw(Wf,e),Gf!==null&&Dw(Gf,e),rS.forEach(t),nS.forEach(t),r=0;r<Mf.length;r++)n=Mf[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<Mf.length&&(r=Mf[0],r.blockedOn===null);)xee(r),r.blockedOn===null&&Mf.shift()}var dg=Mc.ReactCurrentBatchConfig,HR=!0;function Zde(e,t,r,n){var i=Qn,o=dg.transition;dg.transition=null;try{Qn=1,Yz(e,t,r,n)}finally{Qn=i,dg.transition=o}}function Jde(e,t,r,n){var i=Qn,o=dg.transition;dg.transition=null;try{Qn=4,Yz(e,t,r,n)}finally{Qn=i,dg.transition=o}}function Yz(e,t,r,n){if(HR){var i=tL(e,t,r,n);if(i===null)VM(e,t,n,VR,r),p5(e,n);else if(qde(i,e,t,r,n))n.stopPropagation();else if(p5(e,n),t&4&&-1<Kde.indexOf(e)){for(;i!==null;){var o=Ax(i);if(o!==null&&_ee(o),o=tL(e,t,r,n),o===null&&VM(e,t,n,VR,r),o===i)break;i=o}i!==null&&n.stopPropagation()}else VM(e,t,n,null,r)}}var VR=null;function tL(e,t,r,n){if(VR=null,e=Vz(n),e=Fd(e),e!==null)if(t=Up(e),t===null)e=null;else if(r=t.tag,r===13){if(e=fee(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return VR=e,null}function Cee(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(jde()){case Uz:return 1;case mee:return 4;case zR:case zde:return 16;case yee:return 536870912;default:return 16}default:return 16}}var Nf=null,Kz=null,jO=null;function Eee(){if(jO)return jO;var e,t=Kz,r=t.length,n,i="value"in Nf?Nf.value:Nf.textContent,o=i.length;for(e=0;e<r&&t[e]===i[e];e++);var s=r-e;for(n=1;n<=s&&t[r-n]===i[o-n];n++);return jO=i.slice(e,1<n?1-n:void 0)}function zO(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function mT(){return!0}function y5(){return!1}function us(e){function t(r,n,i,o,s){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=o,this.target=s,this.currentTarget=null;for(var a in e)e.hasOwnProperty(a)&&(r=e[a],this[a]=r?r(o):o[a]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?mT:y5,this.isPropagationStopped=y5,this}return Li(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=mT)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=mT)},persist:function(){},isPersistent:mT}),t}var W_={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},qz=us(W_),Px=Li({},W_,{view:0,detail:0}),Qde=us(Px),DM,$M,$w,RP=Li({},Px,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Xz,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==$w&&($w&&e.type==="mousemove"?(DM=e.screenX-$w.screenX,$M=e.screenY-$w.screenY):$M=DM=0,$w=e),DM)},movementY:function(e){return"movementY"in e?e.movementY:$M}}),g5=us(RP),epe=Li({},RP,{dataTransfer:0}),tpe=us(epe),rpe=Li({},Px,{relatedTarget:0}),LM=us(rpe),npe=Li({},W_,{animationName:0,elapsedTime:0,pseudoElement:0}),ipe=us(npe),ope=Li({},W_,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),ape=us(ope),spe=Li({},W_,{data:0}),v5=us(spe),lpe={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},upe={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},cpe={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function fpe(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=cpe[e])?!!t[e]:!1}function Xz(){return fpe}var hpe=Li({},Px,{key:function(e){if(e.key){var t=lpe[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=zO(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?upe[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Xz,charCode:function(e){return e.type==="keypress"?zO(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?zO(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),dpe=us(hpe),ppe=Li({},RP,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),_5=us(ppe),mpe=Li({},Px,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Xz}),ype=us(mpe),gpe=Li({},W_,{propertyName:0,elapsedTime:0,pseudoElement:0}),vpe=us(gpe),_pe=Li({},RP,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),bpe=us(_pe),wpe=[9,13,27,32],Zz=Cc&&"CompositionEvent"in window,k0=null;Cc&&"documentMode"in document&&(k0=document.documentMode);var Spe=Cc&&"TextEvent"in window&&!k0,Tee=Cc&&(!Zz||k0&&8<k0&&11>=k0),b5=String.fromCharCode(32),w5=!1;function Oee(e,t){switch(e){case"keyup":return wpe.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ree(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var qy=!1;function xpe(e,t){switch(e){case"compositionend":return Ree(t);case"keypress":return t.which!==32?null:(w5=!0,b5);case"textInput":return e=t.data,e===b5&&w5?null:e;default:return null}}function Cpe(e,t){if(qy)return e==="compositionend"||!Zz&&Oee(e,t)?(e=Eee(),jO=Kz=Nf=null,qy=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Tee&&t.locale!=="ko"?null:t.data;default:return null}}var Epe={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function S5(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Epe[e.type]:t==="textarea"}function kee(e,t,r,n){aee(n),t=UR(t,"onChange"),0<t.length&&(r=new qz("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var P0=null,oS=null;function Tpe(e){zee(e,0)}function kP(e){var t=Jy(e);if(QQ(t))return e}function Ope(e,t){if(e==="change")return t}var Pee=!1;if(Cc){var NM;if(Cc){var BM="oninput"in document;if(!BM){var x5=document.createElement("div");x5.setAttribute("oninput","return;"),BM=typeof x5.oninput=="function"}NM=BM}else NM=!1;Pee=NM&&(!document.documentMode||9<document.documentMode)}function C5(){P0&&(P0.detachEvent("onpropertychange",Aee),oS=P0=null)}function Aee(e){if(e.propertyName==="value"&&kP(oS)){var t=[];kee(t,oS,e,Vz(e)),cee(Tpe,t)}}function Rpe(e,t,r){e==="focusin"?(C5(),P0=t,oS=r,P0.attachEvent("onpropertychange",Aee)):e==="focusout"&&C5()}function kpe(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return kP(oS)}function Ppe(e,t){if(e==="click")return kP(t)}function Ape(e,t){if(e==="input"||e==="change")return kP(t)}function Ipe(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var ml=typeof Object.is=="function"?Object.is:Ipe;function aS(e,t){if(ml(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!N2.call(t,i)||!ml(e[i],t[i]))return!1}return!0}function E5(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function T5(e,t){var r=E5(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=E5(r)}}function Iee(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Iee(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Mee(){for(var e=window,t=NR();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=NR(e.document)}return t}function Jz(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function Mpe(e){var t=Mee(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&Iee(r.ownerDocument.documentElement,r)){if(n!==null&&Jz(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var i=r.textContent.length,o=Math.min(n.start,i);n=n.end===void 0?o:Math.min(n.end,i),!e.extend&&o>n&&(i=n,n=o,o=i),i=T5(r,o);var s=T5(r,n);i&&s&&(e.rangeCount!==1||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==s.node||e.focusOffset!==s.offset)&&(t=t.createRange(),t.setStart(i.node,i.offset),e.removeAllRanges(),o>n?(e.addRange(t),e.extend(s.node,s.offset)):(t.setEnd(s.node,s.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Dpe=Cc&&"documentMode"in document&&11>=document.documentMode,Xy=null,rL=null,A0=null,nL=!1;function O5(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;nL||Xy==null||Xy!==NR(n)||(n=Xy,"selectionStart"in n&&Jz(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),A0&&aS(A0,n)||(A0=n,n=UR(rL,"onSelect"),0<n.length&&(t=new qz("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=Xy)))}function yT(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Zy={animationend:yT("Animation","AnimationEnd"),animationiteration:yT("Animation","AnimationIteration"),animationstart:yT("Animation","AnimationStart"),transitionend:yT("Transition","TransitionEnd")},jM={},Dee={};Cc&&(Dee=document.createElement("div").style,"AnimationEvent"in window||(delete Zy.animationend.animation,delete Zy.animationiteration.animation,delete Zy.animationstart.animation),"TransitionEvent"in window||delete Zy.transitionend.transition);function PP(e){if(jM[e])return jM[e];if(!Zy[e])return e;var t=Zy[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in Dee)return jM[e]=t[r];return e}var $ee=PP("animationend"),Lee=PP("animationiteration"),Nee=PP("animationstart"),Bee=PP("transitionend"),jee=new Map,R5="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function gh(e,t){jee.set(e,t),Vp(t,[e])}for(var zM=0;zM<R5.length;zM++){var FM=R5[zM],$pe=FM.toLowerCase(),Lpe=FM[0].toUpperCase()+FM.slice(1);gh($pe,"on"+Lpe)}gh($ee,"onAnimationEnd");gh(Lee,"onAnimationIteration");gh(Nee,"onAnimationStart");gh("dblclick","onDoubleClick");gh("focusin","onFocus");gh("focusout","onBlur");gh(Bee,"onTransitionEnd");Pg("onMouseEnter",["mouseout","mouseover"]);Pg("onMouseLeave",["mouseout","mouseover"]);Pg("onPointerEnter",["pointerout","pointerover"]);Pg("onPointerLeave",["pointerout","pointerover"]);Vp("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Vp("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Vp("onBeforeInput",["compositionend","keypress","textInput","paste"]);Vp("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Vp("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Vp("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var _0="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Npe=new Set("cancel close invalid load scroll toggle".split(" ").concat(_0));function k5(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,$de(n,t,void 0,e),e.currentTarget=null}function zee(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],i=n.event;n=n.listeners;e:{var o=void 0;if(t)for(var s=n.length-1;0<=s;s--){var a=n[s],h=a.instance,p=a.currentTarget;if(a=a.listener,h!==o&&i.isPropagationStopped())break e;k5(i,a,p),o=h}else for(s=0;s<n.length;s++){if(a=n[s],h=a.instance,p=a.currentTarget,a=a.listener,h!==o&&i.isPropagationStopped())break e;k5(i,a,p),o=h}}}if(jR)throw e=J2,jR=!1,J2=null,e}function mi(e,t){var r=t[lL];r===void 0&&(r=t[lL]=new Set);var n=e+"__bubble";r.has(n)||(Fee(t,e,2,!1),r.add(n))}function HM(e,t,r){var n=0;t&&(n|=4),Fee(r,e,n,t)}var gT="_reactListening"+Math.random().toString(36).slice(2);function sS(e){if(!e[gT]){e[gT]=!0,KQ.forEach(function(r){r!=="selectionchange"&&(Npe.has(r)||HM(r,!1,e),HM(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[gT]||(t[gT]=!0,HM("selectionchange",!1,t))}}function Fee(e,t,r,n){switch(Cee(t)){case 1:var i=Zde;break;case 4:i=Jde;break;default:i=Yz}r=i.bind(null,t,r,e),i=void 0,!Z2||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(i=!0),n?i!==void 0?e.addEventListener(t,r,{capture:!0,passive:i}):e.addEventListener(t,r,!0):i!==void 0?e.addEventListener(t,r,{passive:i}):e.addEventListener(t,r,!1)}function VM(e,t,r,n,i){var o=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var s=n.tag;if(s===3||s===4){var a=n.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(s===4)for(s=n.return;s!==null;){var h=s.tag;if((h===3||h===4)&&(h=s.stateNode.containerInfo,h===i||h.nodeType===8&&h.parentNode===i))return;s=s.return}for(;a!==null;){if(s=Fd(a),s===null)return;if(h=s.tag,h===5||h===6){n=o=s;continue e}a=a.parentNode}}n=n.return}cee(function(){var p=o,g=Vz(r),S=[];e:{var T=jee.get(e);if(T!==void 0){var R=qz,A=e;switch(e){case"keypress":if(zO(r)===0)break e;case"keydown":case"keyup":R=dpe;break;case"focusin":A="focus",R=LM;break;case"focusout":A="blur",R=LM;break;case"beforeblur":case"afterblur":R=LM;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":R=g5;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":R=tpe;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":R=ype;break;case $ee:case Lee:case Nee:R=ipe;break;case Bee:R=vpe;break;case"scroll":R=Qde;break;case"wheel":R=bpe;break;case"copy":case"cut":case"paste":R=ape;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":R=_5}var $=(t&4)!==0,j=!$&&e==="scroll",z=$?T!==null?T+"Capture":null:T;$=[];for(var V=p,G;V!==null;){G=V;var ee=G.stateNode;if(G.tag===5&&ee!==null&&(G=ee,z!==null&&(ee=tS(V,z),ee!=null&&$.push(lS(V,ee,G)))),j)break;V=V.return}0<$.length&&(T=new R(T,A,null,r,g),S.push({event:T,listeners:$}))}}if(!(t&7)){e:{if(T=e==="mouseover"||e==="pointerover",R=e==="mouseout"||e==="pointerout",T&&r!==q2&&(A=r.relatedTarget||r.fromElement)&&(Fd(A)||A[Ec]))break e;if((R||T)&&(T=g.window===g?g:(T=g.ownerDocument)?T.defaultView||T.parentWindow:window,R?(A=r.relatedTarget||r.toElement,R=p,A=A?Fd(A):null,A!==null&&(j=Up(A),A!==j||A.tag!==5&&A.tag!==6)&&(A=null)):(R=null,A=p),R!==A)){if($=g5,ee="onMouseLeave",z="onMouseEnter",V="mouse",(e==="pointerout"||e==="pointerover")&&($=_5,ee="onPointerLeave",z="onPointerEnter",V="pointer"),j=R==null?T:Jy(R),G=A==null?T:Jy(A),T=new $(ee,V+"leave",R,r,g),T.target=j,T.relatedTarget=G,ee=null,Fd(g)===p&&($=new $(z,V+"enter",A,r,g),$.target=G,$.relatedTarget=j,ee=$),j=ee,R&&A)t:{for($=R,z=A,V=0,G=$;G;G=sy(G))V++;for(G=0,ee=z;ee;ee=sy(ee))G++;for(;0<V-G;)$=sy($),V--;for(;0<G-V;)z=sy(z),G--;for(;V--;){if($===z||z!==null&&$===z.alternate)break t;$=sy($),z=sy(z)}$=null}else $=null;R!==null&&P5(S,T,R,$,!1),A!==null&&j!==null&&P5(S,j,A,$,!0)}}e:{if(T=p?Jy(p):window,R=T.nodeName&&T.nodeName.toLowerCase(),R==="select"||R==="input"&&T.type==="file")var K=Ope;else if(S5(T))if(Pee)K=Ape;else{K=kpe;var xe=Rpe}else(R=T.nodeName)&&R.toLowerCase()==="input"&&(T.type==="checkbox"||T.type==="radio")&&(K=Ppe);if(K&&(K=K(e,p))){kee(S,K,r,g);break e}xe&&xe(e,T,p),e==="focusout"&&(xe=T._wrapperState)&&xe.controlled&&T.type==="number"&&U2(T,"number",T.value)}switch(xe=p?Jy(p):window,e){case"focusin":(S5(xe)||xe.contentEditable==="true")&&(Xy=xe,rL=p,A0=null);break;case"focusout":A0=rL=Xy=null;break;case"mousedown":nL=!0;break;case"contextmenu":case"mouseup":case"dragend":nL=!1,O5(S,r,g);break;case"selectionchange":if(Dpe)break;case"keydown":case"keyup":O5(S,r,g)}var Me;if(Zz)e:{switch(e){case"compositionstart":var He="onCompositionStart";break e;case"compositionend":He="onCompositionEnd";break e;case"compositionupdate":He="onCompositionUpdate";break e}He=void 0}else qy?Oee(e,r)&&(He="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(He="onCompositionStart");He&&(Tee&&r.locale!=="ko"&&(qy||He!=="onCompositionStart"?He==="onCompositionEnd"&&qy&&(Me=Eee()):(Nf=g,Kz="value"in Nf?Nf.value:Nf.textContent,qy=!0)),xe=UR(p,He),0<xe.length&&(He=new v5(He,e,null,r,g),S.push({event:He,listeners:xe}),Me?He.data=Me:(Me=Ree(r),Me!==null&&(He.data=Me)))),(Me=Spe?xpe(e,r):Cpe(e,r))&&(p=UR(p,"onBeforeInput"),0<p.length&&(g=new v5("onBeforeInput","beforeinput",null,r,g),S.push({event:g,listeners:p}),g.data=Me))}zee(S,t)})}function lS(e,t,r){return{instance:e,listener:t,currentTarget:r}}function UR(e,t){for(var r=t+"Capture",n=[];e!==null;){var i=e,o=i.stateNode;i.tag===5&&o!==null&&(i=o,o=tS(e,r),o!=null&&n.unshift(lS(e,o,i)),o=tS(e,t),o!=null&&n.push(lS(e,o,i))),e=e.return}return n}function sy(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function P5(e,t,r,n,i){for(var o=t._reactName,s=[];r!==null&&r!==n;){var a=r,h=a.alternate,p=a.stateNode;if(h!==null&&h===n)break;a.tag===5&&p!==null&&(a=p,i?(h=tS(r,o),h!=null&&s.unshift(lS(r,h,a))):i||(h=tS(r,o),h!=null&&s.push(lS(r,h,a)))),r=r.return}s.length!==0&&e.push({event:t,listeners:s})}var Bpe=/\r\n?/g,jpe=/\u0000|\uFFFD/g;function A5(e){return(typeof e=="string"?e:""+e).replace(Bpe,`
`).replace(jpe,"")}function vT(e,t,r){if(t=A5(t),A5(e)!==t&&r)throw Error(Kt(425))}function WR(){}var iL=null,oL=null;function aL(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var sL=typeof setTimeout=="function"?setTimeout:void 0,zpe=typeof clearTimeout=="function"?clearTimeout:void 0,I5=typeof Promise=="function"?Promise:void 0,Fpe=typeof queueMicrotask=="function"?queueMicrotask:typeof I5<"u"?function(e){return I5.resolve(null).then(e).catch(Hpe)}:sL;function Hpe(e){setTimeout(function(){throw e})}function UM(e,t){var r=t,n=0;do{var i=r.nextSibling;if(e.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){e.removeChild(i),iS(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);iS(t)}function Yf(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function M5(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var G_=Math.random().toString(36).slice(2),eu="__reactFiber$"+G_,uS="__reactProps$"+G_,Ec="__reactContainer$"+G_,lL="__reactEvents$"+G_,Vpe="__reactListeners$"+G_,Upe="__reactHandles$"+G_;function Fd(e){var t=e[eu];if(t)return t;for(var r=e.parentNode;r;){if(t=r[Ec]||r[eu]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=M5(e);e!==null;){if(r=e[eu])return r;e=M5(e)}return t}e=r,r=e.parentNode}return null}function Ax(e){return e=e[eu]||e[Ec],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Jy(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Kt(33))}function AP(e){return e[uS]||null}var uL=[],Qy=-1;function vh(e){return{current:e}}function yi(e){0>Qy||(e.current=uL[Qy],uL[Qy]=null,Qy--)}function fi(e,t){Qy++,uL[Qy]=e.current,e.current=t}var ph={},ea=vh(ph),Ba=vh(!1),Cp=ph;function Ag(e,t){var r=e.type.contextTypes;if(!r)return ph;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var i={},o;for(o in r)i[o]=t[o];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function ja(e){return e=e.childContextTypes,e!=null}function GR(){yi(Ba),yi(ea)}function D5(e,t,r){if(ea.current!==ph)throw Error(Kt(168));fi(ea,t),fi(Ba,r)}function Hee(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in t))throw Error(Kt(108,Rde(e)||"Unknown",i));return Li({},r,n)}function YR(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||ph,Cp=ea.current,fi(ea,e),fi(Ba,Ba.current),!0}function $5(e,t,r){var n=e.stateNode;if(!n)throw Error(Kt(169));r?(e=Hee(e,t,Cp),n.__reactInternalMemoizedMergedChildContext=e,yi(Ba),yi(ea),fi(ea,e)):yi(Ba),fi(Ba,r)}var Uu=null,IP=!1,WM=!1;function Vee(e){Uu===null?Uu=[e]:Uu.push(e)}function Wpe(e){IP=!0,Vee(e)}function _h(){if(!WM&&Uu!==null){WM=!0;var e=0,t=Qn;try{var r=Uu;for(Qn=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}Uu=null,IP=!1}catch(i){throw Uu!==null&&(Uu=Uu.slice(e+1)),pee(Uz,_h),i}finally{Qn=t,WM=!1}}return null}var eg=[],tg=0,KR=null,qR=0,Ts=[],Os=0,Ep=null,Yu=1,Ku="";function Md(e,t){eg[tg++]=qR,eg[tg++]=KR,KR=e,qR=t}function Uee(e,t,r){Ts[Os++]=Yu,Ts[Os++]=Ku,Ts[Os++]=Ep,Ep=e;var n=Yu;e=Ku;var i=32-dl(n)-1;n&=~(1<<i),r+=1;var o=32-dl(t)+i;if(30<o){var s=i-i%5;o=(n&(1<<s)-1).toString(32),n>>=s,i-=s,Yu=1<<32-dl(t)+i|r<<i|n,Ku=o+e}else Yu=1<<o|r<<i|n,Ku=e}function Qz(e){e.return!==null&&(Md(e,1),Uee(e,1,0))}function eF(e){for(;e===KR;)KR=eg[--tg],eg[tg]=null,qR=eg[--tg],eg[tg]=null;for(;e===Ep;)Ep=Ts[--Os],Ts[Os]=null,Ku=Ts[--Os],Ts[Os]=null,Yu=Ts[--Os],Ts[Os]=null}var as=null,is=null,Ei=!1,ll=null;function Wee(e,t){var r=Ps(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function L5(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,as=e,is=Yf(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,as=e,is=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=Ep!==null?{id:Yu,overflow:Ku}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=Ps(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,as=e,is=null,!0):!1;default:return!1}}function cL(e){return(e.mode&1)!==0&&(e.flags&128)===0}function fL(e){if(Ei){var t=is;if(t){var r=t;if(!L5(e,t)){if(cL(e))throw Error(Kt(418));t=Yf(r.nextSibling);var n=as;t&&L5(e,t)?Wee(n,r):(e.flags=e.flags&-4097|2,Ei=!1,as=e)}}else{if(cL(e))throw Error(Kt(418));e.flags=e.flags&-4097|2,Ei=!1,as=e}}}function N5(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;as=e}function _T(e){if(e!==as)return!1;if(!Ei)return N5(e),Ei=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!aL(e.type,e.memoizedProps)),t&&(t=is)){if(cL(e))throw Gee(),Error(Kt(418));for(;t;)Wee(e,t),t=Yf(t.nextSibling)}if(N5(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Kt(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){is=Yf(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}is=null}}else is=as?Yf(e.stateNode.nextSibling):null;return!0}function Gee(){for(var e=is;e;)e=Yf(e.nextSibling)}function Ig(){is=as=null,Ei=!1}function tF(e){ll===null?ll=[e]:ll.push(e)}var Gpe=Mc.ReactCurrentBatchConfig;function il(e,t){if(e&&e.defaultProps){t=Li({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}var XR=vh(null),ZR=null,rg=null,rF=null;function nF(){rF=rg=ZR=null}function iF(e){var t=XR.current;yi(XR),e._currentValue=t}function hL(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function pg(e,t){ZR=e,rF=rg=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(La=!0),e.firstContext=null)}function Ms(e){var t=e._currentValue;if(rF!==e)if(e={context:e,memoizedValue:t,next:null},rg===null){if(ZR===null)throw Error(Kt(308));rg=e,ZR.dependencies={lanes:0,firstContext:e}}else rg=rg.next=e;return t}var Hd=null;function oF(e){Hd===null?Hd=[e]:Hd.push(e)}function Yee(e,t,r,n){var i=t.interleaved;return i===null?(r.next=r,oF(t)):(r.next=i.next,i.next=r),t.interleaved=r,Tc(e,n)}function Tc(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var Af=!1;function aF(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Kee(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function wc(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Kf(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,Dn&2){var i=n.pending;return i===null?t.next=t:(t.next=i.next,i.next=t),n.pending=t,Tc(e,r)}return i=n.interleaved,i===null?(t.next=t,oF(n)):(t.next=i.next,i.next=t),n.interleaved=t,Tc(e,r)}function FO(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,Wz(e,r)}}function B5(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,o=null;if(r=r.firstBaseUpdate,r!==null){do{var s={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};o===null?i=o=s:o=o.next=s,r=r.next}while(r!==null);o===null?i=o=t:o=o.next=t}else i=o=t;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:o,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function JR(e,t,r,n){var i=e.updateQueue;Af=!1;var o=i.firstBaseUpdate,s=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var h=a,p=h.next;h.next=null,s===null?o=p:s.next=p,s=h;var g=e.alternate;g!==null&&(g=g.updateQueue,a=g.lastBaseUpdate,a!==s&&(a===null?g.firstBaseUpdate=p:a.next=p,g.lastBaseUpdate=h))}if(o!==null){var S=i.baseState;s=0,g=p=h=null,a=o;do{var T=a.lane,R=a.eventTime;if((n&T)===T){g!==null&&(g=g.next={eventTime:R,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var A=e,$=a;switch(T=t,R=r,$.tag){case 1:if(A=$.payload,typeof A=="function"){S=A.call(R,S,T);break e}S=A;break e;case 3:A.flags=A.flags&-65537|128;case 0:if(A=$.payload,T=typeof A=="function"?A.call(R,S,T):A,T==null)break e;S=Li({},S,T);break e;case 2:Af=!0}}a.callback!==null&&a.lane!==0&&(e.flags|=64,T=i.effects,T===null?i.effects=[a]:T.push(a))}else R={eventTime:R,lane:T,tag:a.tag,payload:a.payload,callback:a.callback,next:null},g===null?(p=g=R,h=S):g=g.next=R,s|=T;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;T=a,a=T.next,T.next=null,i.lastBaseUpdate=T,i.shared.pending=null}}while(1);if(g===null&&(h=S),i.baseState=h,i.firstBaseUpdate=p,i.lastBaseUpdate=g,t=i.shared.interleaved,t!==null){i=t;do s|=i.lane,i=i.next;while(i!==t)}else o===null&&(i.shared.lanes=0);Op|=s,e.lanes=s,e.memoizedState=S}}function j5(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(Kt(191,i));i.call(n)}}}var qee=new YQ.Component().refs;function dL(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:Li({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var MP={isMounted:function(e){return(e=e._reactInternals)?Up(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=ma(),i=Xf(e),o=wc(n,i);o.payload=t,r!=null&&(o.callback=r),t=Kf(e,o,i),t!==null&&(pl(t,e,i,n),FO(t,e,i))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=ma(),i=Xf(e),o=wc(n,i);o.tag=1,o.payload=t,r!=null&&(o.callback=r),t=Kf(e,o,i),t!==null&&(pl(t,e,i,n),FO(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=ma(),n=Xf(e),i=wc(r,n);i.tag=2,t!=null&&(i.callback=t),t=Kf(e,i,n),t!==null&&(pl(t,e,n,r),FO(t,e,n))}};function z5(e,t,r,n,i,o,s){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,o,s):t.prototype&&t.prototype.isPureReactComponent?!aS(r,n)||!aS(i,o):!0}function Xee(e,t,r){var n=!1,i=ph,o=t.contextType;return typeof o=="object"&&o!==null?o=Ms(o):(i=ja(t)?Cp:ea.current,n=t.contextTypes,o=(n=n!=null)?Ag(e,i):ph),t=new t(r,o),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=MP,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=o),t}function F5(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&MP.enqueueReplaceState(t,t.state,null)}function pL(e,t,r,n){var i=e.stateNode;i.props=r,i.state=e.memoizedState,i.refs=qee,aF(e);var o=t.contextType;typeof o=="object"&&o!==null?i.context=Ms(o):(o=ja(t)?Cp:ea.current,i.context=Ag(e,o)),i.state=e.memoizedState,o=t.getDerivedStateFromProps,typeof o=="function"&&(dL(e,t,o,r),i.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(t=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),t!==i.state&&MP.enqueueReplaceState(i,i.state,null),JR(e,r,i,n),i.state=e.memoizedState),typeof i.componentDidMount=="function"&&(e.flags|=4194308)}function Lw(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Kt(309));var n=r.stateNode}if(!n)throw Error(Kt(147,e));var i=n,o=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===o?t.ref:(t=function(s){var a=i.refs;a===qee&&(a=i.refs={}),s===null?delete a[o]:a[o]=s},t._stringRef=o,t)}if(typeof e!="string")throw Error(Kt(284));if(!r._owner)throw Error(Kt(290,e))}return e}function bT(e,t){throw e=Object.prototype.toString.call(t),Error(Kt(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function H5(e){var t=e._init;return t(e._payload)}function Zee(e){function t(z,V){if(e){var G=z.deletions;G===null?(z.deletions=[V],z.flags|=16):G.push(V)}}function r(z,V){if(!e)return null;for(;V!==null;)t(z,V),V=V.sibling;return null}function n(z,V){for(z=new Map;V!==null;)V.key!==null?z.set(V.key,V):z.set(V.index,V),V=V.sibling;return z}function i(z,V){return z=Zf(z,V),z.index=0,z.sibling=null,z}function o(z,V,G){return z.index=G,e?(G=z.alternate,G!==null?(G=G.index,G<V?(z.flags|=2,V):G):(z.flags|=2,V)):(z.flags|=1048576,V)}function s(z){return e&&z.alternate===null&&(z.flags|=2),z}function a(z,V,G,ee){return V===null||V.tag!==6?(V=JM(G,z.mode,ee),V.return=z,V):(V=i(V,G),V.return=z,V)}function h(z,V,G,ee){var K=G.type;return K===Ky?g(z,V,G.props.children,ee,G.key):V!==null&&(V.elementType===K||typeof K=="object"&&K!==null&&K.$$typeof===Pf&&H5(K)===V.type)?(ee=i(V,G.props),ee.ref=Lw(z,V,G),ee.return=z,ee):(ee=YO(G.type,G.key,G.props,null,z.mode,ee),ee.ref=Lw(z,V,G),ee.return=z,ee)}function p(z,V,G,ee){return V===null||V.tag!==4||V.stateNode.containerInfo!==G.containerInfo||V.stateNode.implementation!==G.implementation?(V=QM(G,z.mode,ee),V.return=z,V):(V=i(V,G.children||[]),V.return=z,V)}function g(z,V,G,ee,K){return V===null||V.tag!==7?(V=vp(G,z.mode,ee,K),V.return=z,V):(V=i(V,G),V.return=z,V)}function S(z,V,G){if(typeof V=="string"&&V!==""||typeof V=="number")return V=JM(""+V,z.mode,G),V.return=z,V;if(typeof V=="object"&&V!==null){switch(V.$$typeof){case uT:return G=YO(V.type,V.key,V.props,null,z.mode,G),G.ref=Lw(z,null,V),G.return=z,G;case Yy:return V=QM(V,z.mode,G),V.return=z,V;case Pf:var ee=V._init;return S(z,ee(V._payload),G)}if(g0(V)||Aw(V))return V=vp(V,z.mode,G,null),V.return=z,V;bT(z,V)}return null}function T(z,V,G,ee){var K=V!==null?V.key:null;if(typeof G=="string"&&G!==""||typeof G=="number")return K!==null?null:a(z,V,""+G,ee);if(typeof G=="object"&&G!==null){switch(G.$$typeof){case uT:return G.key===K?h(z,V,G,ee):null;case Yy:return G.key===K?p(z,V,G,ee):null;case Pf:return K=G._init,T(z,V,K(G._payload),ee)}if(g0(G)||Aw(G))return K!==null?null:g(z,V,G,ee,null);bT(z,G)}return null}function R(z,V,G,ee,K){if(typeof ee=="string"&&ee!==""||typeof ee=="number")return z=z.get(G)||null,a(V,z,""+ee,K);if(typeof ee=="object"&&ee!==null){switch(ee.$$typeof){case uT:return z=z.get(ee.key===null?G:ee.key)||null,h(V,z,ee,K);case Yy:return z=z.get(ee.key===null?G:ee.key)||null,p(V,z,ee,K);case Pf:var xe=ee._init;return R(z,V,G,xe(ee._payload),K)}if(g0(ee)||Aw(ee))return z=z.get(G)||null,g(V,z,ee,K,null);bT(V,ee)}return null}function A(z,V,G,ee){for(var K=null,xe=null,Me=V,He=V=0,Ne=null;Me!==null&&He<G.length;He++){Me.index>He?(Ne=Me,Me=null):Ne=Me.sibling;var We=T(z,Me,G[He],ee);if(We===null){Me===null&&(Me=Ne);break}e&&Me&&We.alternate===null&&t(z,Me),V=o(We,V,He),xe===null?K=We:xe.sibling=We,xe=We,Me=Ne}if(He===G.length)return r(z,Me),Ei&&Md(z,He),K;if(Me===null){for(;He<G.length;He++)Me=S(z,G[He],ee),Me!==null&&(V=o(Me,V,He),xe===null?K=Me:xe.sibling=Me,xe=Me);return Ei&&Md(z,He),K}for(Me=n(z,Me);He<G.length;He++)Ne=R(Me,z,He,G[He],ee),Ne!==null&&(e&&Ne.alternate!==null&&Me.delete(Ne.key===null?He:Ne.key),V=o(Ne,V,He),xe===null?K=Ne:xe.sibling=Ne,xe=Ne);return e&&Me.forEach(function(gt){return t(z,gt)}),Ei&&Md(z,He),K}function $(z,V,G,ee){var K=Aw(G);if(typeof K!="function")throw Error(Kt(150));if(G=K.call(G),G==null)throw Error(Kt(151));for(var xe=K=null,Me=V,He=V=0,Ne=null,We=G.next();Me!==null&&!We.done;He++,We=G.next()){Me.index>He?(Ne=Me,Me=null):Ne=Me.sibling;var gt=T(z,Me,We.value,ee);if(gt===null){Me===null&&(Me=Ne);break}e&&Me&&gt.alternate===null&&t(z,Me),V=o(gt,V,He),xe===null?K=gt:xe.sibling=gt,xe=gt,Me=Ne}if(We.done)return r(z,Me),Ei&&Md(z,He),K;if(Me===null){for(;!We.done;He++,We=G.next())We=S(z,We.value,ee),We!==null&&(V=o(We,V,He),xe===null?K=We:xe.sibling=We,xe=We);return Ei&&Md(z,He),K}for(Me=n(z,Me);!We.done;He++,We=G.next())We=R(Me,z,He,We.value,ee),We!==null&&(e&&We.alternate!==null&&Me.delete(We.key===null?He:We.key),V=o(We,V,He),xe===null?K=We:xe.sibling=We,xe=We);return e&&Me.forEach(function(Lt){return t(z,Lt)}),Ei&&Md(z,He),K}function j(z,V,G,ee){if(typeof G=="object"&&G!==null&&G.type===Ky&&G.key===null&&(G=G.props.children),typeof G=="object"&&G!==null){switch(G.$$typeof){case uT:e:{for(var K=G.key,xe=V;xe!==null;){if(xe.key===K){if(K=G.type,K===Ky){if(xe.tag===7){r(z,xe.sibling),V=i(xe,G.props.children),V.return=z,z=V;break e}}else if(xe.elementType===K||typeof K=="object"&&K!==null&&K.$$typeof===Pf&&H5(K)===xe.type){r(z,xe.sibling),V=i(xe,G.props),V.ref=Lw(z,xe,G),V.return=z,z=V;break e}r(z,xe);break}else t(z,xe);xe=xe.sibling}G.type===Ky?(V=vp(G.props.children,z.mode,ee,G.key),V.return=z,z=V):(ee=YO(G.type,G.key,G.props,null,z.mode,ee),ee.ref=Lw(z,V,G),ee.return=z,z=ee)}return s(z);case Yy:e:{for(xe=G.key;V!==null;){if(V.key===xe)if(V.tag===4&&V.stateNode.containerInfo===G.containerInfo&&V.stateNode.implementation===G.implementation){r(z,V.sibling),V=i(V,G.children||[]),V.return=z,z=V;break e}else{r(z,V);break}else t(z,V);V=V.sibling}V=QM(G,z.mode,ee),V.return=z,z=V}return s(z);case Pf:return xe=G._init,j(z,V,xe(G._payload),ee)}if(g0(G))return A(z,V,G,ee);if(Aw(G))return $(z,V,G,ee);bT(z,G)}return typeof G=="string"&&G!==""||typeof G=="number"?(G=""+G,V!==null&&V.tag===6?(r(z,V.sibling),V=i(V,G),V.return=z,z=V):(r(z,V),V=JM(G,z.mode,ee),V.return=z,z=V),s(z)):r(z,V)}return j}var Mg=Zee(!0),Jee=Zee(!1),Ix={},ou=vh(Ix),cS=vh(Ix),fS=vh(Ix);function Vd(e){if(e===Ix)throw Error(Kt(174));return e}function sF(e,t){switch(fi(fS,t),fi(cS,e),fi(ou,Ix),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:G2(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=G2(t,e)}yi(ou),fi(ou,t)}function Dg(){yi(ou),yi(cS),yi(fS)}function Qee(e){Vd(fS.current);var t=Vd(ou.current),r=G2(t,e.type);t!==r&&(fi(cS,e),fi(ou,r))}function lF(e){cS.current===e&&(yi(ou),yi(cS))}var Ai=vh(0);function QR(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var GM=[];function uF(){for(var e=0;e<GM.length;e++)GM[e]._workInProgressVersionPrimary=null;GM.length=0}var HO=Mc.ReactCurrentDispatcher,YM=Mc.ReactCurrentBatchConfig,Tp=0,Di=null,po=null,Ro=null,ek=!1,I0=!1,hS=0,Ype=0;function Ko(){throw Error(Kt(321))}function cF(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!ml(e[r],t[r]))return!1;return!0}function fF(e,t,r,n,i,o){if(Tp=o,Di=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,HO.current=e===null||e.memoizedState===null?Zpe:Jpe,e=r(n,i),I0){o=0;do{if(I0=!1,hS=0,25<=o)throw Error(Kt(301));o+=1,Ro=po=null,t.updateQueue=null,HO.current=Qpe,e=r(n,i)}while(I0)}if(HO.current=tk,t=po!==null&&po.next!==null,Tp=0,Ro=po=Di=null,ek=!1,t)throw Error(Kt(300));return e}function hF(){var e=hS!==0;return hS=0,e}function Zl(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ro===null?Di.memoizedState=Ro=e:Ro=Ro.next=e,Ro}function Ds(){if(po===null){var e=Di.alternate;e=e!==null?e.memoizedState:null}else e=po.next;var t=Ro===null?Di.memoizedState:Ro.next;if(t!==null)Ro=t,po=e;else{if(e===null)throw Error(Kt(310));po=e,e={memoizedState:po.memoizedState,baseState:po.baseState,baseQueue:po.baseQueue,queue:po.queue,next:null},Ro===null?Di.memoizedState=Ro=e:Ro=Ro.next=e}return Ro}function dS(e,t){return typeof t=="function"?t(e):t}function KM(e){var t=Ds(),r=t.queue;if(r===null)throw Error(Kt(311));r.lastRenderedReducer=e;var n=po,i=n.baseQueue,o=r.pending;if(o!==null){if(i!==null){var s=i.next;i.next=o.next,o.next=s}n.baseQueue=i=o,r.pending=null}if(i!==null){o=i.next,n=n.baseState;var a=s=null,h=null,p=o;do{var g=p.lane;if((Tp&g)===g)h!==null&&(h=h.next={lane:0,action:p.action,hasEagerState:p.hasEagerState,eagerState:p.eagerState,next:null}),n=p.hasEagerState?p.eagerState:e(n,p.action);else{var S={lane:g,action:p.action,hasEagerState:p.hasEagerState,eagerState:p.eagerState,next:null};h===null?(a=h=S,s=n):h=h.next=S,Di.lanes|=g,Op|=g}p=p.next}while(p!==null&&p!==o);h===null?s=n:h.next=a,ml(n,t.memoizedState)||(La=!0),t.memoizedState=n,t.baseState=s,t.baseQueue=h,r.lastRenderedState=n}if(e=r.interleaved,e!==null){i=e;do o=i.lane,Di.lanes|=o,Op|=o,i=i.next;while(i!==e)}else i===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function qM(e){var t=Ds(),r=t.queue;if(r===null)throw Error(Kt(311));r.lastRenderedReducer=e;var n=r.dispatch,i=r.pending,o=t.memoizedState;if(i!==null){r.pending=null;var s=i=i.next;do o=e(o,s.action),s=s.next;while(s!==i);ml(o,t.memoizedState)||(La=!0),t.memoizedState=o,t.baseQueue===null&&(t.baseState=o),r.lastRenderedState=o}return[o,n]}function ete(){}function tte(e,t){var r=Di,n=Ds(),i=t(),o=!ml(n.memoizedState,i);if(o&&(n.memoizedState=i,La=!0),n=n.queue,dF(ite.bind(null,r,n,e),[e]),n.getSnapshot!==t||o||Ro!==null&&Ro.memoizedState.tag&1){if(r.flags|=2048,pS(9,nte.bind(null,r,n,i,t),void 0,null),Po===null)throw Error(Kt(349));Tp&30||rte(r,t,i)}return i}function rte(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=Di.updateQueue,t===null?(t={lastEffect:null,stores:null},Di.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function nte(e,t,r,n){t.value=r,t.getSnapshot=n,ote(t)&&ate(e)}function ite(e,t,r){return r(function(){ote(t)&&ate(e)})}function ote(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!ml(e,r)}catch{return!0}}function ate(e){var t=Tc(e,1);t!==null&&pl(t,e,1,-1)}function V5(e){var t=Zl();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:dS,lastRenderedState:e},t.queue=e,e=e.dispatch=Xpe.bind(null,Di,e),[t.memoizedState,e]}function pS(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=Di.updateQueue,t===null?(t={lastEffect:null,stores:null},Di.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function ste(){return Ds().memoizedState}function VO(e,t,r,n){var i=Zl();Di.flags|=e,i.memoizedState=pS(1|t,r,void 0,n===void 0?null:n)}function DP(e,t,r,n){var i=Ds();n=n===void 0?null:n;var o=void 0;if(po!==null){var s=po.memoizedState;if(o=s.destroy,n!==null&&cF(n,s.deps)){i.memoizedState=pS(t,r,o,n);return}}Di.flags|=e,i.memoizedState=pS(1|t,r,o,n)}function U5(e,t){return VO(8390656,8,e,t)}function dF(e,t){return DP(2048,8,e,t)}function lte(e,t){return DP(4,2,e,t)}function ute(e,t){return DP(4,4,e,t)}function cte(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function fte(e,t,r){return r=r!=null?r.concat([e]):null,DP(4,4,cte.bind(null,t,e),r)}function pF(){}function hte(e,t){var r=Ds();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&cF(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function dte(e,t){var r=Ds();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&cF(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function pte(e,t,r){return Tp&21?(ml(r,t)||(r=gee(),Di.lanes|=r,Op|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,La=!0),e.memoizedState=r)}function Kpe(e,t){var r=Qn;Qn=r!==0&&4>r?r:4,e(!0);var n=YM.transition;YM.transition={};try{e(!1),t()}finally{Qn=r,YM.transition=n}}function mte(){return Ds().memoizedState}function qpe(e,t,r){var n=Xf(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},yte(e))gte(t,r);else if(r=Yee(e,t,r,n),r!==null){var i=ma();pl(r,e,n,i),vte(r,t,n)}}function Xpe(e,t,r){var n=Xf(e),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(yte(e))gte(t,i);else{var o=e.alternate;if(e.lanes===0&&(o===null||o.lanes===0)&&(o=t.lastRenderedReducer,o!==null))try{var s=t.lastRenderedState,a=o(s,r);if(i.hasEagerState=!0,i.eagerState=a,ml(a,s)){var h=t.interleaved;h===null?(i.next=i,oF(t)):(i.next=h.next,h.next=i),t.interleaved=i;return}}catch{}finally{}r=Yee(e,t,i,n),r!==null&&(i=ma(),pl(r,e,n,i),vte(r,t,n))}}function yte(e){var t=e.alternate;return e===Di||t!==null&&t===Di}function gte(e,t){I0=ek=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function vte(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,Wz(e,r)}}var tk={readContext:Ms,useCallback:Ko,useContext:Ko,useEffect:Ko,useImperativeHandle:Ko,useInsertionEffect:Ko,useLayoutEffect:Ko,useMemo:Ko,useReducer:Ko,useRef:Ko,useState:Ko,useDebugValue:Ko,useDeferredValue:Ko,useTransition:Ko,useMutableSource:Ko,useSyncExternalStore:Ko,useId:Ko,unstable_isNewReconciler:!1},Zpe={readContext:Ms,useCallback:function(e,t){return Zl().memoizedState=[e,t===void 0?null:t],e},useContext:Ms,useEffect:U5,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,VO(4194308,4,cte.bind(null,t,e),r)},useLayoutEffect:function(e,t){return VO(4194308,4,e,t)},useInsertionEffect:function(e,t){return VO(4,2,e,t)},useMemo:function(e,t){var r=Zl();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=Zl();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=qpe.bind(null,Di,e),[n.memoizedState,e]},useRef:function(e){var t=Zl();return e={current:e},t.memoizedState=e},useState:V5,useDebugValue:pF,useDeferredValue:function(e){return Zl().memoizedState=e},useTransition:function(){var e=V5(!1),t=e[0];return e=Kpe.bind(null,e[1]),Zl().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=Di,i=Zl();if(Ei){if(r===void 0)throw Error(Kt(407));r=r()}else{if(r=t(),Po===null)throw Error(Kt(349));Tp&30||rte(n,t,r)}i.memoizedState=r;var o={value:r,getSnapshot:t};return i.queue=o,U5(ite.bind(null,n,o,e),[e]),n.flags|=2048,pS(9,nte.bind(null,n,o,r,t),void 0,null),r},useId:function(){var e=Zl(),t=Po.identifierPrefix;if(Ei){var r=Ku,n=Yu;r=(n&~(1<<32-dl(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=hS++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=Ype++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Jpe={readContext:Ms,useCallback:hte,useContext:Ms,useEffect:dF,useImperativeHandle:fte,useInsertionEffect:lte,useLayoutEffect:ute,useMemo:dte,useReducer:KM,useRef:ste,useState:function(){return KM(dS)},useDebugValue:pF,useDeferredValue:function(e){var t=Ds();return pte(t,po.memoizedState,e)},useTransition:function(){var e=KM(dS)[0],t=Ds().memoizedState;return[e,t]},useMutableSource:ete,useSyncExternalStore:tte,useId:mte,unstable_isNewReconciler:!1},Qpe={readContext:Ms,useCallback:hte,useContext:Ms,useEffect:dF,useImperativeHandle:fte,useInsertionEffect:lte,useLayoutEffect:ute,useMemo:dte,useReducer:qM,useRef:ste,useState:function(){return qM(dS)},useDebugValue:pF,useDeferredValue:function(e){var t=Ds();return po===null?t.memoizedState=e:pte(t,po.memoizedState,e)},useTransition:function(){var e=qM(dS)[0],t=Ds().memoizedState;return[e,t]},useMutableSource:ete,useSyncExternalStore:tte,useId:mte,unstable_isNewReconciler:!1};function $g(e,t){try{var r="",n=t;do r+=Ode(n),n=n.return;while(n);var i=r}catch(o){i=`
Error generating stack: `+o.message+`
`+o.stack}return{value:e,source:t,stack:i,digest:null}}function XM(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function mL(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var eme=typeof WeakMap=="function"?WeakMap:Map;function _te(e,t,r){r=wc(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){nk||(nk=!0,EL=n),mL(e,t)},r}function bte(e,t,r){r=wc(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var i=t.value;r.payload=function(){return n(i)},r.callback=function(){mL(e,t)}}var o=e.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(r.callback=function(){mL(e,t),typeof n!="function"&&(qf===null?qf=new Set([this]):qf.add(this));var s=t.stack;this.componentDidCatch(t.value,{componentStack:s!==null?s:""})}),r}function W5(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new eme;var i=new Set;n.set(t,i)}else i=n.get(t),i===void 0&&(i=new Set,n.set(t,i));i.has(r)||(i.add(r),e=pme.bind(null,e,t,r),t.then(e,e))}function G5(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Y5(e,t,r,n,i){return e.mode&1?(e.flags|=65536,e.lanes=i,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=wc(-1,1),t.tag=2,Kf(r,t,1))),r.lanes|=1),e)}var tme=Mc.ReactCurrentOwner,La=!1;function da(e,t,r,n){t.child=e===null?Jee(t,null,r,n):Mg(t,e.child,r,n)}function K5(e,t,r,n,i){r=r.render;var o=t.ref;return pg(t,i),n=fF(e,t,r,n,o,i),r=hF(),e!==null&&!La?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Oc(e,t,i)):(Ei&&r&&Qz(t),t.flags|=1,da(e,t,n,i),t.child)}function q5(e,t,r,n,i){if(e===null){var o=r.type;return typeof o=="function"&&!SF(o)&&o.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=o,wte(e,t,o,n,i)):(e=YO(r.type,null,n,t,t.mode,i),e.ref=t.ref,e.return=t,t.child=e)}if(o=e.child,!(e.lanes&i)){var s=o.memoizedProps;if(r=r.compare,r=r!==null?r:aS,r(s,n)&&e.ref===t.ref)return Oc(e,t,i)}return t.flags|=1,e=Zf(o,n),e.ref=t.ref,e.return=t,t.child=e}function wte(e,t,r,n,i){if(e!==null){var o=e.memoizedProps;if(aS(o,n)&&e.ref===t.ref)if(La=!1,t.pendingProps=n=o,(e.lanes&i)!==0)e.flags&131072&&(La=!0);else return t.lanes=e.lanes,Oc(e,t,i)}return yL(e,t,r,n,i)}function Ste(e,t,r){var n=t.pendingProps,i=n.children,o=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},fi(ig,ts),ts|=r;else{if(!(r&1073741824))return e=o!==null?o.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,fi(ig,ts),ts|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=o!==null?o.baseLanes:r,fi(ig,ts),ts|=n}else o!==null?(n=o.baseLanes|r,t.memoizedState=null):n=r,fi(ig,ts),ts|=n;return da(e,t,i,r),t.child}function xte(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function yL(e,t,r,n,i){var o=ja(r)?Cp:ea.current;return o=Ag(t,o),pg(t,i),r=fF(e,t,r,n,o,i),n=hF(),e!==null&&!La?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Oc(e,t,i)):(Ei&&n&&Qz(t),t.flags|=1,da(e,t,r,i),t.child)}function X5(e,t,r,n,i){if(ja(r)){var o=!0;YR(t)}else o=!1;if(pg(t,i),t.stateNode===null)UO(e,t),Xee(t,r,n),pL(t,r,n,i),n=!0;else if(e===null){var s=t.stateNode,a=t.memoizedProps;s.props=a;var h=s.context,p=r.contextType;typeof p=="object"&&p!==null?p=Ms(p):(p=ja(r)?Cp:ea.current,p=Ag(t,p));var g=r.getDerivedStateFromProps,S=typeof g=="function"||typeof s.getSnapshotBeforeUpdate=="function";S||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(a!==n||h!==p)&&F5(t,s,n,p),Af=!1;var T=t.memoizedState;s.state=T,JR(t,n,s,i),h=t.memoizedState,a!==n||T!==h||Ba.current||Af?(typeof g=="function"&&(dL(t,r,g,n),h=t.memoizedState),(a=Af||z5(t,r,a,n,T,h,p))?(S||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount()),typeof s.componentDidMount=="function"&&(t.flags|=4194308)):(typeof s.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=h),s.props=n,s.state=h,s.context=p,n=a):(typeof s.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{s=t.stateNode,Kee(e,t),a=t.memoizedProps,p=t.type===t.elementType?a:il(t.type,a),s.props=p,S=t.pendingProps,T=s.context,h=r.contextType,typeof h=="object"&&h!==null?h=Ms(h):(h=ja(r)?Cp:ea.current,h=Ag(t,h));var R=r.getDerivedStateFromProps;(g=typeof R=="function"||typeof s.getSnapshotBeforeUpdate=="function")||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(a!==S||T!==h)&&F5(t,s,n,h),Af=!1,T=t.memoizedState,s.state=T,JR(t,n,s,i);var A=t.memoizedState;a!==S||T!==A||Ba.current||Af?(typeof R=="function"&&(dL(t,r,R,n),A=t.memoizedState),(p=Af||z5(t,r,p,n,T,A,h)||!1)?(g||typeof s.UNSAFE_componentWillUpdate!="function"&&typeof s.componentWillUpdate!="function"||(typeof s.componentWillUpdate=="function"&&s.componentWillUpdate(n,A,h),typeof s.UNSAFE_componentWillUpdate=="function"&&s.UNSAFE_componentWillUpdate(n,A,h)),typeof s.componentDidUpdate=="function"&&(t.flags|=4),typeof s.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof s.componentDidUpdate!="function"||a===e.memoizedProps&&T===e.memoizedState||(t.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||a===e.memoizedProps&&T===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=A),s.props=n,s.state=A,s.context=h,n=p):(typeof s.componentDidUpdate!="function"||a===e.memoizedProps&&T===e.memoizedState||(t.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||a===e.memoizedProps&&T===e.memoizedState||(t.flags|=1024),n=!1)}return gL(e,t,r,n,o,i)}function gL(e,t,r,n,i,o){xte(e,t);var s=(t.flags&128)!==0;if(!n&&!s)return i&&$5(t,r,!1),Oc(e,t,o);n=t.stateNode,tme.current=t;var a=s&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&s?(t.child=Mg(t,e.child,null,o),t.child=Mg(t,null,a,o)):da(e,t,a,o),t.memoizedState=n.state,i&&$5(t,r,!0),t.child}function Cte(e){var t=e.stateNode;t.pendingContext?D5(e,t.pendingContext,t.pendingContext!==t.context):t.context&&D5(e,t.context,!1),sF(e,t.containerInfo)}function Z5(e,t,r,n,i){return Ig(),tF(i),t.flags|=256,da(e,t,r,n),t.child}var vL={dehydrated:null,treeContext:null,retryLane:0};function _L(e){return{baseLanes:e,cachePool:null,transitions:null}}function Ete(e,t,r){var n=t.pendingProps,i=Ai.current,o=!1,s=(t.flags&128)!==0,a;if((a=s)||(a=e!==null&&e.memoizedState===null?!1:(i&2)!==0),a?(o=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(i|=1),fi(Ai,i&1),e===null)return fL(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(s=n.children,e=n.fallback,o?(n=t.mode,o=t.child,s={mode:"hidden",children:s},!(n&1)&&o!==null?(o.childLanes=0,o.pendingProps=s):o=NP(s,n,0,null),e=vp(e,n,r,null),o.return=t,e.return=t,o.sibling=e,t.child=o,t.child.memoizedState=_L(r),t.memoizedState=vL,e):mF(t,s));if(i=e.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return rme(e,t,s,n,a,i,r);if(o){o=n.fallback,s=t.mode,i=e.child,a=i.sibling;var h={mode:"hidden",children:n.children};return!(s&1)&&t.child!==i?(n=t.child,n.childLanes=0,n.pendingProps=h,t.deletions=null):(n=Zf(i,h),n.subtreeFlags=i.subtreeFlags&14680064),a!==null?o=Zf(a,o):(o=vp(o,s,r,null),o.flags|=2),o.return=t,n.return=t,n.sibling=o,t.child=n,n=o,o=t.child,s=e.child.memoizedState,s=s===null?_L(r):{baseLanes:s.baseLanes|r,cachePool:null,transitions:s.transitions},o.memoizedState=s,o.childLanes=e.childLanes&~r,t.memoizedState=vL,n}return o=e.child,e=o.sibling,n=Zf(o,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function mF(e,t){return t=NP({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function wT(e,t,r,n){return n!==null&&tF(n),Mg(t,e.child,null,r),e=mF(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function rme(e,t,r,n,i,o,s){if(r)return t.flags&256?(t.flags&=-257,n=XM(Error(Kt(422))),wT(e,t,s,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(o=n.fallback,i=t.mode,n=NP({mode:"visible",children:n.children},i,0,null),o=vp(o,i,s,null),o.flags|=2,n.return=t,o.return=t,n.sibling=o,t.child=n,t.mode&1&&Mg(t,e.child,null,s),t.child.memoizedState=_L(s),t.memoizedState=vL,o);if(!(t.mode&1))return wT(e,t,s,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var a=n.dgst;return n=a,o=Error(Kt(419)),n=XM(o,n,void 0),wT(e,t,s,n)}if(a=(s&e.childLanes)!==0,La||a){if(n=Po,n!==null){switch(s&-s){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|s)?0:i,i!==0&&i!==o.retryLane&&(o.retryLane=i,Tc(e,i),pl(n,e,i,-1))}return wF(),n=XM(Error(Kt(421))),wT(e,t,s,n)}return i.data==="$?"?(t.flags|=128,t.child=e.child,t=mme.bind(null,e),i._reactRetry=t,null):(e=o.treeContext,is=Yf(i.nextSibling),as=t,Ei=!0,ll=null,e!==null&&(Ts[Os++]=Yu,Ts[Os++]=Ku,Ts[Os++]=Ep,Yu=e.id,Ku=e.overflow,Ep=t),t=mF(t,n.children),t.flags|=4096,t)}function J5(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),hL(e.return,t,r)}function ZM(e,t,r,n,i){var o=e.memoizedState;o===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(o.isBackwards=t,o.rendering=null,o.renderingStartTime=0,o.last=n,o.tail=r,o.tailMode=i)}function Tte(e,t,r){var n=t.pendingProps,i=n.revealOrder,o=n.tail;if(da(e,t,n.children,r),n=Ai.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&J5(e,r,t);else if(e.tag===19)J5(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(fi(Ai,n),!(t.mode&1))t.memoizedState=null;else switch(i){case"forwards":for(r=t.child,i=null;r!==null;)e=r.alternate,e!==null&&QR(e)===null&&(i=r),r=r.sibling;r=i,r===null?(i=t.child,t.child=null):(i=r.sibling,r.sibling=null),ZM(t,!1,i,r,o);break;case"backwards":for(r=null,i=t.child,t.child=null;i!==null;){if(e=i.alternate,e!==null&&QR(e)===null){t.child=i;break}e=i.sibling,i.sibling=r,r=i,i=e}ZM(t,!0,r,null,o);break;case"together":ZM(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function UO(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Oc(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),Op|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(Kt(153));if(t.child!==null){for(e=t.child,r=Zf(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=Zf(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function nme(e,t,r){switch(t.tag){case 3:Cte(t),Ig();break;case 5:Qee(t);break;case 1:ja(t.type)&&YR(t);break;case 4:sF(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,i=t.memoizedProps.value;fi(XR,n._currentValue),n._currentValue=i;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(fi(Ai,Ai.current&1),t.flags|=128,null):r&t.child.childLanes?Ete(e,t,r):(fi(Ai,Ai.current&1),e=Oc(e,t,r),e!==null?e.sibling:null);fi(Ai,Ai.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return Tte(e,t,r);t.flags|=128}if(i=t.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),fi(Ai,Ai.current),n)break;return null;case 22:case 23:return t.lanes=0,Ste(e,t,r)}return Oc(e,t,r)}var Ote,bL,Rte,kte;Ote=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};bL=function(){};Rte=function(e,t,r,n){var i=e.memoizedProps;if(i!==n){e=t.stateNode,Vd(ou.current);var o=null;switch(r){case"input":i=H2(e,i),n=H2(e,n),o=[];break;case"select":i=Li({},i,{value:void 0}),n=Li({},n,{value:void 0}),o=[];break;case"textarea":i=W2(e,i),n=W2(e,n),o=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=WR)}Y2(r,n);var s;r=null;for(p in i)if(!n.hasOwnProperty(p)&&i.hasOwnProperty(p)&&i[p]!=null)if(p==="style"){var a=i[p];for(s in a)a.hasOwnProperty(s)&&(r||(r={}),r[s]="")}else p!=="dangerouslySetInnerHTML"&&p!=="children"&&p!=="suppressContentEditableWarning"&&p!=="suppressHydrationWarning"&&p!=="autoFocus"&&(Q0.hasOwnProperty(p)?o||(o=[]):(o=o||[]).push(p,null));for(p in n){var h=n[p];if(a=i!=null?i[p]:void 0,n.hasOwnProperty(p)&&h!==a&&(h!=null||a!=null))if(p==="style")if(a){for(s in a)!a.hasOwnProperty(s)||h&&h.hasOwnProperty(s)||(r||(r={}),r[s]="");for(s in h)h.hasOwnProperty(s)&&a[s]!==h[s]&&(r||(r={}),r[s]=h[s])}else r||(o||(o=[]),o.push(p,r)),r=h;else p==="dangerouslySetInnerHTML"?(h=h?h.__html:void 0,a=a?a.__html:void 0,h!=null&&a!==h&&(o=o||[]).push(p,h)):p==="children"?typeof h!="string"&&typeof h!="number"||(o=o||[]).push(p,""+h):p!=="suppressContentEditableWarning"&&p!=="suppressHydrationWarning"&&(Q0.hasOwnProperty(p)?(h!=null&&p==="onScroll"&&mi("scroll",e),o||a===h||(o=[])):(o=o||[]).push(p,h))}r&&(o=o||[]).push("style",r);var p=o;(t.updateQueue=p)&&(t.flags|=4)}};kte=function(e,t,r,n){r!==n&&(t.flags|=4)};function Nw(e,t){if(!Ei)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function qo(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=e,i=i.sibling;else for(i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function ime(e,t,r){var n=t.pendingProps;switch(eF(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return qo(t),null;case 1:return ja(t.type)&&GR(),qo(t),null;case 3:return n=t.stateNode,Dg(),yi(Ba),yi(ea),uF(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(_T(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,ll!==null&&(RL(ll),ll=null))),bL(e,t),qo(t),null;case 5:lF(t);var i=Vd(fS.current);if(r=t.type,e!==null&&t.stateNode!=null)Rte(e,t,r,n,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(Kt(166));return qo(t),null}if(e=Vd(ou.current),_T(t)){n=t.stateNode,r=t.type;var o=t.memoizedProps;switch(n[eu]=t,n[uS]=o,e=(t.mode&1)!==0,r){case"dialog":mi("cancel",n),mi("close",n);break;case"iframe":case"object":case"embed":mi("load",n);break;case"video":case"audio":for(i=0;i<_0.length;i++)mi(_0[i],n);break;case"source":mi("error",n);break;case"img":case"image":case"link":mi("error",n),mi("load",n);break;case"details":mi("toggle",n);break;case"input":s5(n,o),mi("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!o.multiple},mi("invalid",n);break;case"textarea":u5(n,o),mi("invalid",n)}Y2(r,o),i=null;for(var s in o)if(o.hasOwnProperty(s)){var a=o[s];s==="children"?typeof a=="string"?n.textContent!==a&&(o.suppressHydrationWarning!==!0&&vT(n.textContent,a,e),i=["children",a]):typeof a=="number"&&n.textContent!==""+a&&(o.suppressHydrationWarning!==!0&&vT(n.textContent,a,e),i=["children",""+a]):Q0.hasOwnProperty(s)&&a!=null&&s==="onScroll"&&mi("scroll",n)}switch(r){case"input":cT(n),l5(n,o,!0);break;case"textarea":cT(n),c5(n);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(n.onclick=WR)}n=i,t.updateQueue=n,n!==null&&(t.flags|=4)}else{s=i.nodeType===9?i:i.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=ree(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=s.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=s.createElement(r,{is:n.is}):(e=s.createElement(r),r==="select"&&(s=e,n.multiple?s.multiple=!0:n.size&&(s.size=n.size))):e=s.createElementNS(e,r),e[eu]=t,e[uS]=n,Ote(e,t,!1,!1),t.stateNode=e;e:{switch(s=K2(r,n),r){case"dialog":mi("cancel",e),mi("close",e),i=n;break;case"iframe":case"object":case"embed":mi("load",e),i=n;break;case"video":case"audio":for(i=0;i<_0.length;i++)mi(_0[i],e);i=n;break;case"source":mi("error",e),i=n;break;case"img":case"image":case"link":mi("error",e),mi("load",e),i=n;break;case"details":mi("toggle",e),i=n;break;case"input":s5(e,n),i=H2(e,n),mi("invalid",e);break;case"option":i=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},i=Li({},n,{value:void 0}),mi("invalid",e);break;case"textarea":u5(e,n),i=W2(e,n),mi("invalid",e);break;default:i=n}Y2(r,i),a=i;for(o in a)if(a.hasOwnProperty(o)){var h=a[o];o==="style"?oee(e,h):o==="dangerouslySetInnerHTML"?(h=h?h.__html:void 0,h!=null&&nee(e,h)):o==="children"?typeof h=="string"?(r!=="textarea"||h!=="")&&eS(e,h):typeof h=="number"&&eS(e,""+h):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(Q0.hasOwnProperty(o)?h!=null&&o==="onScroll"&&mi("scroll",e):h!=null&&jz(e,o,h,s))}switch(r){case"input":cT(e),l5(e,n,!1);break;case"textarea":cT(e),c5(e);break;case"option":n.value!=null&&e.setAttribute("value",""+dh(n.value));break;case"select":e.multiple=!!n.multiple,o=n.value,o!=null?cg(e,!!n.multiple,o,!1):n.defaultValue!=null&&cg(e,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(e.onclick=WR)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return qo(t),null;case 6:if(e&&t.stateNode!=null)kte(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(Kt(166));if(r=Vd(fS.current),Vd(ou.current),_T(t)){if(n=t.stateNode,r=t.memoizedProps,n[eu]=t,(o=n.nodeValue!==r)&&(e=as,e!==null))switch(e.tag){case 3:vT(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&vT(n.nodeValue,r,(e.mode&1)!==0)}o&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[eu]=t,t.stateNode=n}return qo(t),null;case 13:if(yi(Ai),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Ei&&is!==null&&t.mode&1&&!(t.flags&128))Gee(),Ig(),t.flags|=98560,o=!1;else if(o=_T(t),n!==null&&n.dehydrated!==null){if(e===null){if(!o)throw Error(Kt(318));if(o=t.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(Kt(317));o[eu]=t}else Ig(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;qo(t),o=!1}else ll!==null&&(RL(ll),ll=null),o=!0;if(!o)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||Ai.current&1?mo===0&&(mo=3):wF())),t.updateQueue!==null&&(t.flags|=4),qo(t),null);case 4:return Dg(),bL(e,t),e===null&&sS(t.stateNode.containerInfo),qo(t),null;case 10:return iF(t.type._context),qo(t),null;case 17:return ja(t.type)&&GR(),qo(t),null;case 19:if(yi(Ai),o=t.memoizedState,o===null)return qo(t),null;if(n=(t.flags&128)!==0,s=o.rendering,s===null)if(n)Nw(o,!1);else{if(mo!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(s=QR(e),s!==null){for(t.flags|=128,Nw(o,!1),n=s.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)o=r,e=n,o.flags&=14680066,s=o.alternate,s===null?(o.childLanes=0,o.lanes=e,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=s.childLanes,o.lanes=s.lanes,o.child=s.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=s.memoizedProps,o.memoizedState=s.memoizedState,o.updateQueue=s.updateQueue,o.type=s.type,e=s.dependencies,o.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return fi(Ai,Ai.current&1|2),t.child}e=e.sibling}o.tail!==null&&qi()>Lg&&(t.flags|=128,n=!0,Nw(o,!1),t.lanes=4194304)}else{if(!n)if(e=QR(s),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Nw(o,!0),o.tail===null&&o.tailMode==="hidden"&&!s.alternate&&!Ei)return qo(t),null}else 2*qi()-o.renderingStartTime>Lg&&r!==1073741824&&(t.flags|=128,n=!0,Nw(o,!1),t.lanes=4194304);o.isBackwards?(s.sibling=t.child,t.child=s):(r=o.last,r!==null?r.sibling=s:t.child=s,o.last=s)}return o.tail!==null?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=qi(),t.sibling=null,r=Ai.current,fi(Ai,n?r&1|2:r&1),t):(qo(t),null);case 22:case 23:return bF(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?ts&1073741824&&(qo(t),t.subtreeFlags&6&&(t.flags|=8192)):qo(t),null;case 24:return null;case 25:return null}throw Error(Kt(156,t.tag))}function ome(e,t){switch(eF(t),t.tag){case 1:return ja(t.type)&&GR(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Dg(),yi(Ba),yi(ea),uF(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return lF(t),null;case 13:if(yi(Ai),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(Kt(340));Ig()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return yi(Ai),null;case 4:return Dg(),null;case 10:return iF(t.type._context),null;case 22:case 23:return bF(),null;case 24:return null;default:return null}}var ST=!1,Zo=!1,ame=typeof WeakSet=="function"?WeakSet:Set,br=null;function ng(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Vi(e,t,n)}else r.current=null}function wL(e,t,r){try{r()}catch(n){Vi(e,t,n)}}var Q5=!1;function sme(e,t){if(iL=HR,e=Mee(),Jz(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,o=n.focusNode;n=n.focusOffset;try{r.nodeType,o.nodeType}catch{r=null;break e}var s=0,a=-1,h=-1,p=0,g=0,S=e,T=null;t:for(;;){for(var R;S!==r||i!==0&&S.nodeType!==3||(a=s+i),S!==o||n!==0&&S.nodeType!==3||(h=s+n),S.nodeType===3&&(s+=S.nodeValue.length),(R=S.firstChild)!==null;)T=S,S=R;for(;;){if(S===e)break t;if(T===r&&++p===i&&(a=s),T===o&&++g===n&&(h=s),(R=S.nextSibling)!==null)break;S=T,T=S.parentNode}S=R}r=a===-1||h===-1?null:{start:a,end:h}}else r=null}r=r||{start:0,end:0}}else r=null;for(oL={focusedElem:e,selectionRange:r},HR=!1,br=t;br!==null;)if(t=br,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,br=e;else for(;br!==null;){t=br;try{var A=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(A!==null){var $=A.memoizedProps,j=A.memoizedState,z=t.stateNode,V=z.getSnapshotBeforeUpdate(t.elementType===t.type?$:il(t.type,$),j);z.__reactInternalSnapshotBeforeUpdate=V}break;case 3:var G=t.stateNode.containerInfo;G.nodeType===1?G.textContent="":G.nodeType===9&&G.documentElement&&G.removeChild(G.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Kt(163))}}catch(ee){Vi(t,t.return,ee)}if(e=t.sibling,e!==null){e.return=t.return,br=e;break}br=t.return}return A=Q5,Q5=!1,A}function M0(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&e)===e){var o=i.destroy;i.destroy=void 0,o!==void 0&&wL(t,r,o)}i=i.next}while(i!==n)}}function $P(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function SL(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function Pte(e){var t=e.alternate;t!==null&&(e.alternate=null,Pte(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[eu],delete t[uS],delete t[lL],delete t[Vpe],delete t[Upe])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Ate(e){return e.tag===5||e.tag===3||e.tag===4}function eG(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Ate(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function xL(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=WR));else if(n!==4&&(e=e.child,e!==null))for(xL(e,t,r),e=e.sibling;e!==null;)xL(e,t,r),e=e.sibling}function CL(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(CL(e,t,r),e=e.sibling;e!==null;)CL(e,t,r),e=e.sibling}var Lo=null,al=!1;function vf(e,t,r){for(r=r.child;r!==null;)Ite(e,t,r),r=r.sibling}function Ite(e,t,r){if(iu&&typeof iu.onCommitFiberUnmount=="function")try{iu.onCommitFiberUnmount(OP,r)}catch{}switch(r.tag){case 5:Zo||ng(r,t);case 6:var n=Lo,i=al;Lo=null,vf(e,t,r),Lo=n,al=i,Lo!==null&&(al?(e=Lo,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):Lo.removeChild(r.stateNode));break;case 18:Lo!==null&&(al?(e=Lo,r=r.stateNode,e.nodeType===8?UM(e.parentNode,r):e.nodeType===1&&UM(e,r),iS(e)):UM(Lo,r.stateNode));break;case 4:n=Lo,i=al,Lo=r.stateNode.containerInfo,al=!0,vf(e,t,r),Lo=n,al=i;break;case 0:case 11:case 14:case 15:if(!Zo&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var o=i,s=o.destroy;o=o.tag,s!==void 0&&(o&2||o&4)&&wL(r,t,s),i=i.next}while(i!==n)}vf(e,t,r);break;case 1:if(!Zo&&(ng(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(a){Vi(r,t,a)}vf(e,t,r);break;case 21:vf(e,t,r);break;case 22:r.mode&1?(Zo=(n=Zo)||r.memoizedState!==null,vf(e,t,r),Zo=n):vf(e,t,r);break;default:vf(e,t,r)}}function tG(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new ame),t.forEach(function(n){var i=yme.bind(null,e,n);r.has(n)||(r.add(n),n.then(i,i))})}}function Qs(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var o=e,s=t,a=s;e:for(;a!==null;){switch(a.tag){case 5:Lo=a.stateNode,al=!1;break e;case 3:Lo=a.stateNode.containerInfo,al=!0;break e;case 4:Lo=a.stateNode.containerInfo,al=!0;break e}a=a.return}if(Lo===null)throw Error(Kt(160));Ite(o,s,i),Lo=null,al=!1;var h=i.alternate;h!==null&&(h.return=null),i.return=null}catch(p){Vi(i,t,p)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)Mte(t,e),t=t.sibling}function Mte(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Qs(t,e),Bl(e),n&4){try{M0(3,e,e.return),$P(3,e)}catch($){Vi(e,e.return,$)}try{M0(5,e,e.return)}catch($){Vi(e,e.return,$)}}break;case 1:Qs(t,e),Bl(e),n&512&&r!==null&&ng(r,r.return);break;case 5:if(Qs(t,e),Bl(e),n&512&&r!==null&&ng(r,r.return),e.flags&32){var i=e.stateNode;try{eS(i,"")}catch($){Vi(e,e.return,$)}}if(n&4&&(i=e.stateNode,i!=null)){var o=e.memoizedProps,s=r!==null?r.memoizedProps:o,a=e.type,h=e.updateQueue;if(e.updateQueue=null,h!==null)try{a==="input"&&o.type==="radio"&&o.name!=null&&eee(i,o),K2(a,s);var p=K2(a,o);for(s=0;s<h.length;s+=2){var g=h[s],S=h[s+1];g==="style"?oee(i,S):g==="dangerouslySetInnerHTML"?nee(i,S):g==="children"?eS(i,S):jz(i,g,S,p)}switch(a){case"input":V2(i,o);break;case"textarea":tee(i,o);break;case"select":var T=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!o.multiple;var R=o.value;R!=null?cg(i,!!o.multiple,R,!1):T!==!!o.multiple&&(o.defaultValue!=null?cg(i,!!o.multiple,o.defaultValue,!0):cg(i,!!o.multiple,o.multiple?[]:"",!1))}i[uS]=o}catch($){Vi(e,e.return,$)}}break;case 6:if(Qs(t,e),Bl(e),n&4){if(e.stateNode===null)throw Error(Kt(162));i=e.stateNode,o=e.memoizedProps;try{i.nodeValue=o}catch($){Vi(e,e.return,$)}}break;case 3:if(Qs(t,e),Bl(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{iS(t.containerInfo)}catch($){Vi(e,e.return,$)}break;case 4:Qs(t,e),Bl(e);break;case 13:Qs(t,e),Bl(e),i=e.child,i.flags&8192&&(o=i.memoizedState!==null,i.stateNode.isHidden=o,!o||i.alternate!==null&&i.alternate.memoizedState!==null||(vF=qi())),n&4&&tG(e);break;case 22:if(g=r!==null&&r.memoizedState!==null,e.mode&1?(Zo=(p=Zo)||g,Qs(t,e),Zo=p):Qs(t,e),Bl(e),n&8192){if(p=e.memoizedState!==null,(e.stateNode.isHidden=p)&&!g&&e.mode&1)for(br=e,g=e.child;g!==null;){for(S=br=g;br!==null;){switch(T=br,R=T.child,T.tag){case 0:case 11:case 14:case 15:M0(4,T,T.return);break;case 1:ng(T,T.return);var A=T.stateNode;if(typeof A.componentWillUnmount=="function"){n=T,r=T.return;try{t=n,A.props=t.memoizedProps,A.state=t.memoizedState,A.componentWillUnmount()}catch($){Vi(n,r,$)}}break;case 5:ng(T,T.return);break;case 22:if(T.memoizedState!==null){nG(S);continue}}R!==null?(R.return=T,br=R):nG(S)}g=g.sibling}e:for(g=null,S=e;;){if(S.tag===5){if(g===null){g=S;try{i=S.stateNode,p?(o=i.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(a=S.stateNode,h=S.memoizedProps.style,s=h!=null&&h.hasOwnProperty("display")?h.display:null,a.style.display=iee("display",s))}catch($){Vi(e,e.return,$)}}}else if(S.tag===6){if(g===null)try{S.stateNode.nodeValue=p?"":S.memoizedProps}catch($){Vi(e,e.return,$)}}else if((S.tag!==22&&S.tag!==23||S.memoizedState===null||S===e)&&S.child!==null){S.child.return=S,S=S.child;continue}if(S===e)break e;for(;S.sibling===null;){if(S.return===null||S.return===e)break e;g===S&&(g=null),S=S.return}g===S&&(g=null),S.sibling.return=S.return,S=S.sibling}}break;case 19:Qs(t,e),Bl(e),n&4&&tG(e);break;case 21:break;default:Qs(t,e),Bl(e)}}function Bl(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(Ate(r)){var n=r;break e}r=r.return}throw Error(Kt(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(eS(i,""),n.flags&=-33);var o=eG(e);CL(e,o,i);break;case 3:case 4:var s=n.stateNode.containerInfo,a=eG(e);xL(e,a,s);break;default:throw Error(Kt(161))}}catch(h){Vi(e,e.return,h)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function lme(e,t,r){br=e,Dte(e)}function Dte(e,t,r){for(var n=(e.mode&1)!==0;br!==null;){var i=br,o=i.child;if(i.tag===22&&n){var s=i.memoizedState!==null||ST;if(!s){var a=i.alternate,h=a!==null&&a.memoizedState!==null||Zo;a=ST;var p=Zo;if(ST=s,(Zo=h)&&!p)for(br=i;br!==null;)s=br,h=s.child,s.tag===22&&s.memoizedState!==null?iG(i):h!==null?(h.return=s,br=h):iG(i);for(;o!==null;)br=o,Dte(o),o=o.sibling;br=i,ST=a,Zo=p}rG(e)}else i.subtreeFlags&8772&&o!==null?(o.return=i,br=o):rG(e)}}function rG(e){for(;br!==null;){var t=br;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Zo||$P(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!Zo)if(r===null)n.componentDidMount();else{var i=t.elementType===t.type?r.memoizedProps:il(t.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;o!==null&&j5(t,o,n);break;case 3:var s=t.updateQueue;if(s!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}j5(t,s,r)}break;case 5:var a=t.stateNode;if(r===null&&t.flags&4){r=a;var h=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":h.autoFocus&&r.focus();break;case"img":h.src&&(r.src=h.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var p=t.alternate;if(p!==null){var g=p.memoizedState;if(g!==null){var S=g.dehydrated;S!==null&&iS(S)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Kt(163))}Zo||t.flags&512&&SL(t)}catch(T){Vi(t,t.return,T)}}if(t===e){br=null;break}if(r=t.sibling,r!==null){r.return=t.return,br=r;break}br=t.return}}function nG(e){for(;br!==null;){var t=br;if(t===e){br=null;break}var r=t.sibling;if(r!==null){r.return=t.return,br=r;break}br=t.return}}function iG(e){for(;br!==null;){var t=br;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{$P(4,t)}catch(h){Vi(t,r,h)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var i=t.return;try{n.componentDidMount()}catch(h){Vi(t,i,h)}}var o=t.return;try{SL(t)}catch(h){Vi(t,o,h)}break;case 5:var s=t.return;try{SL(t)}catch(h){Vi(t,s,h)}}}catch(h){Vi(t,t.return,h)}if(t===e){br=null;break}var a=t.sibling;if(a!==null){a.return=t.return,br=a;break}br=t.return}}var ume=Math.ceil,rk=Mc.ReactCurrentDispatcher,yF=Mc.ReactCurrentOwner,Is=Mc.ReactCurrentBatchConfig,Dn=0,Po=null,no=null,No=0,ts=0,ig=vh(0),mo=0,mS=null,Op=0,LP=0,gF=0,D0=null,Da=null,vF=0,Lg=1/0,zu=null,nk=!1,EL=null,qf=null,xT=!1,Bf=null,ik=0,$0=0,TL=null,WO=-1,GO=0;function ma(){return Dn&6?qi():WO!==-1?WO:WO=qi()}function Xf(e){return e.mode&1?Dn&2&&No!==0?No&-No:Gpe.transition!==null?(GO===0&&(GO=gee()),GO):(e=Qn,e!==0||(e=window.event,e=e===void 0?16:Cee(e.type)),e):1}function pl(e,t,r,n){if(50<$0)throw $0=0,TL=null,Error(Kt(185));kx(e,r,n),(!(Dn&2)||e!==Po)&&(e===Po&&(!(Dn&2)&&(LP|=r),mo===4&&Df(e,No)),za(e,n),r===1&&Dn===0&&!(t.mode&1)&&(Lg=qi()+500,IP&&_h()))}function za(e,t){var r=e.callbackNode;Gde(e,t);var n=FR(e,e===Po?No:0);if(n===0)r!==null&&d5(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&d5(r),t===1)e.tag===0?Wpe(oG.bind(null,e)):Vee(oG.bind(null,e)),Fpe(function(){!(Dn&6)&&_h()}),r=null;else{switch(vee(n)){case 1:r=Uz;break;case 4:r=mee;break;case 16:r=zR;break;case 536870912:r=yee;break;default:r=zR}r=Hte(r,$te.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function $te(e,t){if(WO=-1,GO=0,Dn&6)throw Error(Kt(327));var r=e.callbackNode;if(mg()&&e.callbackNode!==r)return null;var n=FR(e,e===Po?No:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=ok(e,n);else{t=n;var i=Dn;Dn|=2;var o=Nte();(Po!==e||No!==t)&&(zu=null,Lg=qi()+500,gp(e,t));do try{hme();break}catch(a){Lte(e,a)}while(1);nF(),rk.current=o,Dn=i,no!==null?t=0:(Po=null,No=0,t=mo)}if(t!==0){if(t===2&&(i=Q2(e),i!==0&&(n=i,t=OL(e,i))),t===1)throw r=mS,gp(e,0),Df(e,n),za(e,qi()),r;if(t===6)Df(e,n);else{if(i=e.current.alternate,!(n&30)&&!cme(i)&&(t=ok(e,n),t===2&&(o=Q2(e),o!==0&&(n=o,t=OL(e,o))),t===1))throw r=mS,gp(e,0),Df(e,n),za(e,qi()),r;switch(e.finishedWork=i,e.finishedLanes=n,t){case 0:case 1:throw Error(Kt(345));case 2:Dd(e,Da,zu);break;case 3:if(Df(e,n),(n&130023424)===n&&(t=vF+500-qi(),10<t)){if(FR(e,0)!==0)break;if(i=e.suspendedLanes,(i&n)!==n){ma(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=sL(Dd.bind(null,e,Da,zu),t);break}Dd(e,Da,zu);break;case 4:if(Df(e,n),(n&4194240)===n)break;for(t=e.eventTimes,i=-1;0<n;){var s=31-dl(n);o=1<<s,s=t[s],s>i&&(i=s),n&=~o}if(n=i,n=qi()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*ume(n/1960))-n,10<n){e.timeoutHandle=sL(Dd.bind(null,e,Da,zu),n);break}Dd(e,Da,zu);break;case 5:Dd(e,Da,zu);break;default:throw Error(Kt(329))}}}return za(e,qi()),e.callbackNode===r?$te.bind(null,e):null}function OL(e,t){var r=D0;return e.current.memoizedState.isDehydrated&&(gp(e,t).flags|=256),e=ok(e,t),e!==2&&(t=Da,Da=r,t!==null&&RL(t)),e}function RL(e){Da===null?Da=e:Da.push.apply(Da,e)}function cme(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],o=i.getSnapshot;i=i.value;try{if(!ml(o(),i))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Df(e,t){for(t&=~gF,t&=~LP,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-dl(t),n=1<<r;e[r]=-1,t&=~n}}function oG(e){if(Dn&6)throw Error(Kt(327));mg();var t=FR(e,0);if(!(t&1))return za(e,qi()),null;var r=ok(e,t);if(e.tag!==0&&r===2){var n=Q2(e);n!==0&&(t=n,r=OL(e,n))}if(r===1)throw r=mS,gp(e,0),Df(e,t),za(e,qi()),r;if(r===6)throw Error(Kt(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Dd(e,Da,zu),za(e,qi()),null}function _F(e,t){var r=Dn;Dn|=1;try{return e(t)}finally{Dn=r,Dn===0&&(Lg=qi()+500,IP&&_h())}}function Rp(e){Bf!==null&&Bf.tag===0&&!(Dn&6)&&mg();var t=Dn;Dn|=1;var r=Is.transition,n=Qn;try{if(Is.transition=null,Qn=1,e)return e()}finally{Qn=n,Is.transition=r,Dn=t,!(Dn&6)&&_h()}}function bF(){ts=ig.current,yi(ig)}function gp(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,zpe(r)),no!==null)for(r=no.return;r!==null;){var n=r;switch(eF(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&GR();break;case 3:Dg(),yi(Ba),yi(ea),uF();break;case 5:lF(n);break;case 4:Dg();break;case 13:yi(Ai);break;case 19:yi(Ai);break;case 10:iF(n.type._context);break;case 22:case 23:bF()}r=r.return}if(Po=e,no=e=Zf(e.current,null),No=ts=t,mo=0,mS=null,gF=LP=Op=0,Da=D0=null,Hd!==null){for(t=0;t<Hd.length;t++)if(r=Hd[t],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,o=r.pending;if(o!==null){var s=o.next;o.next=i,n.next=s}r.pending=n}Hd=null}return e}function Lte(e,t){do{var r=no;try{if(nF(),HO.current=tk,ek){for(var n=Di.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}ek=!1}if(Tp=0,Ro=po=Di=null,I0=!1,hS=0,yF.current=null,r===null||r.return===null){mo=1,mS=t,no=null;break}e:{var o=e,s=r.return,a=r,h=t;if(t=No,a.flags|=32768,h!==null&&typeof h=="object"&&typeof h.then=="function"){var p=h,g=a,S=g.tag;if(!(g.mode&1)&&(S===0||S===11||S===15)){var T=g.alternate;T?(g.updateQueue=T.updateQueue,g.memoizedState=T.memoizedState,g.lanes=T.lanes):(g.updateQueue=null,g.memoizedState=null)}var R=G5(s);if(R!==null){R.flags&=-257,Y5(R,s,a,o,t),R.mode&1&&W5(o,p,t),t=R,h=p;var A=t.updateQueue;if(A===null){var $=new Set;$.add(h),t.updateQueue=$}else A.add(h);break e}else{if(!(t&1)){W5(o,p,t),wF();break e}h=Error(Kt(426))}}else if(Ei&&a.mode&1){var j=G5(s);if(j!==null){!(j.flags&65536)&&(j.flags|=256),Y5(j,s,a,o,t),tF($g(h,a));break e}}o=h=$g(h,a),mo!==4&&(mo=2),D0===null?D0=[o]:D0.push(o),o=s;do{switch(o.tag){case 3:o.flags|=65536,t&=-t,o.lanes|=t;var z=_te(o,h,t);B5(o,z);break e;case 1:a=h;var V=o.type,G=o.stateNode;if(!(o.flags&128)&&(typeof V.getDerivedStateFromError=="function"||G!==null&&typeof G.componentDidCatch=="function"&&(qf===null||!qf.has(G)))){o.flags|=65536,t&=-t,o.lanes|=t;var ee=bte(o,a,t);B5(o,ee);break e}}o=o.return}while(o!==null)}jte(r)}catch(K){t=K,no===r&&r!==null&&(no=r=r.return);continue}break}while(1)}function Nte(){var e=rk.current;return rk.current=tk,e===null?tk:e}function wF(){(mo===0||mo===3||mo===2)&&(mo=4),Po===null||!(Op&268435455)&&!(LP&268435455)||Df(Po,No)}function ok(e,t){var r=Dn;Dn|=2;var n=Nte();(Po!==e||No!==t)&&(zu=null,gp(e,t));do try{fme();break}catch(i){Lte(e,i)}while(1);if(nF(),Dn=r,rk.current=n,no!==null)throw Error(Kt(261));return Po=null,No=0,mo}function fme(){for(;no!==null;)Bte(no)}function hme(){for(;no!==null&&!Nde();)Bte(no)}function Bte(e){var t=Fte(e.alternate,e,ts);e.memoizedProps=e.pendingProps,t===null?jte(e):no=t,yF.current=null}function jte(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=ome(r,t),r!==null){r.flags&=32767,no=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{mo=6,no=null;return}}else if(r=ime(r,t,ts),r!==null){no=r;return}if(t=t.sibling,t!==null){no=t;return}no=t=e}while(t!==null);mo===0&&(mo=5)}function Dd(e,t,r){var n=Qn,i=Is.transition;try{Is.transition=null,Qn=1,dme(e,t,r,n)}finally{Is.transition=i,Qn=n}return null}function dme(e,t,r,n){do mg();while(Bf!==null);if(Dn&6)throw Error(Kt(327));r=e.finishedWork;var i=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(Kt(177));e.callbackNode=null,e.callbackPriority=0;var o=r.lanes|r.childLanes;if(Yde(e,o),e===Po&&(no=Po=null,No=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||xT||(xT=!0,Hte(zR,function(){return mg(),null})),o=(r.flags&15990)!==0,r.subtreeFlags&15990||o){o=Is.transition,Is.transition=null;var s=Qn;Qn=1;var a=Dn;Dn|=4,yF.current=null,sme(e,r),Mte(r,e),Mpe(oL),HR=!!iL,oL=iL=null,e.current=r,lme(r),Bde(),Dn=a,Qn=s,Is.transition=o}else e.current=r;if(xT&&(xT=!1,Bf=e,ik=i),o=e.pendingLanes,o===0&&(qf=null),Fde(r.stateNode),za(e,qi()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)i=t[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(nk)throw nk=!1,e=EL,EL=null,e;return ik&1&&e.tag!==0&&mg(),o=e.pendingLanes,o&1?e===TL?$0++:($0=0,TL=e):$0=0,_h(),null}function mg(){if(Bf!==null){var e=vee(ik),t=Is.transition,r=Qn;try{if(Is.transition=null,Qn=16>e?16:e,Bf===null)var n=!1;else{if(e=Bf,Bf=null,ik=0,Dn&6)throw Error(Kt(331));var i=Dn;for(Dn|=4,br=e.current;br!==null;){var o=br,s=o.child;if(br.flags&16){var a=o.deletions;if(a!==null){for(var h=0;h<a.length;h++){var p=a[h];for(br=p;br!==null;){var g=br;switch(g.tag){case 0:case 11:case 15:M0(8,g,o)}var S=g.child;if(S!==null)S.return=g,br=S;else for(;br!==null;){g=br;var T=g.sibling,R=g.return;if(Pte(g),g===p){br=null;break}if(T!==null){T.return=R,br=T;break}br=R}}}var A=o.alternate;if(A!==null){var $=A.child;if($!==null){A.child=null;do{var j=$.sibling;$.sibling=null,$=j}while($!==null)}}br=o}}if(o.subtreeFlags&2064&&s!==null)s.return=o,br=s;else e:for(;br!==null;){if(o=br,o.flags&2048)switch(o.tag){case 0:case 11:case 15:M0(9,o,o.return)}var z=o.sibling;if(z!==null){z.return=o.return,br=z;break e}br=o.return}}var V=e.current;for(br=V;br!==null;){s=br;var G=s.child;if(s.subtreeFlags&2064&&G!==null)G.return=s,br=G;else e:for(s=V;br!==null;){if(a=br,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:$P(9,a)}}catch(K){Vi(a,a.return,K)}if(a===s){br=null;break e}var ee=a.sibling;if(ee!==null){ee.return=a.return,br=ee;break e}br=a.return}}if(Dn=i,_h(),iu&&typeof iu.onPostCommitFiberRoot=="function")try{iu.onPostCommitFiberRoot(OP,e)}catch{}n=!0}return n}finally{Qn=r,Is.transition=t}}return!1}function aG(e,t,r){t=$g(r,t),t=_te(e,t,1),e=Kf(e,t,1),t=ma(),e!==null&&(kx(e,1,t),za(e,t))}function Vi(e,t,r){if(e.tag===3)aG(e,e,r);else for(;t!==null;){if(t.tag===3){aG(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(qf===null||!qf.has(n))){e=$g(r,e),e=bte(t,e,1),t=Kf(t,e,1),e=ma(),t!==null&&(kx(t,1,e),za(t,e));break}}t=t.return}}function pme(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=ma(),e.pingedLanes|=e.suspendedLanes&r,Po===e&&(No&r)===r&&(mo===4||mo===3&&(No&130023424)===No&&500>qi()-vF?gp(e,0):gF|=r),za(e,t)}function zte(e,t){t===0&&(e.mode&1?(t=dT,dT<<=1,!(dT&130023424)&&(dT=4194304)):t=1);var r=ma();e=Tc(e,t),e!==null&&(kx(e,t,r),za(e,r))}function mme(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),zte(e,r)}function yme(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,i=e.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(Kt(314))}n!==null&&n.delete(t),zte(e,r)}var Fte;Fte=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||Ba.current)La=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return La=!1,nme(e,t,r);La=!!(e.flags&131072)}else La=!1,Ei&&t.flags&1048576&&Uee(t,qR,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;UO(e,t),e=t.pendingProps;var i=Ag(t,ea.current);pg(t,r),i=fF(null,t,n,e,i,r);var o=hF();return t.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,ja(n)?(o=!0,YR(t)):o=!1,t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,aF(t),i.updater=MP,t.stateNode=i,i._reactInternals=t,pL(t,n,e,r),t=gL(null,t,n,!0,o,r)):(t.tag=0,Ei&&o&&Qz(t),da(null,t,i,r),t=t.child),t;case 16:n=t.elementType;e:{switch(UO(e,t),e=t.pendingProps,i=n._init,n=i(n._payload),t.type=n,i=t.tag=vme(n),e=il(n,e),i){case 0:t=yL(null,t,n,e,r);break e;case 1:t=X5(null,t,n,e,r);break e;case 11:t=K5(null,t,n,e,r);break e;case 14:t=q5(null,t,n,il(n.type,e),r);break e}throw Error(Kt(306,n,""))}return t;case 0:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:il(n,i),yL(e,t,n,i,r);case 1:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:il(n,i),X5(e,t,n,i,r);case 3:e:{if(Cte(t),e===null)throw Error(Kt(387));n=t.pendingProps,o=t.memoizedState,i=o.element,Kee(e,t),JR(t,n,null,r);var s=t.memoizedState;if(n=s.element,o.isDehydrated)if(o={element:n,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},t.updateQueue.baseState=o,t.memoizedState=o,t.flags&256){i=$g(Error(Kt(423)),t),t=Z5(e,t,n,r,i);break e}else if(n!==i){i=$g(Error(Kt(424)),t),t=Z5(e,t,n,r,i);break e}else for(is=Yf(t.stateNode.containerInfo.firstChild),as=t,Ei=!0,ll=null,r=Jee(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Ig(),n===i){t=Oc(e,t,r);break e}da(e,t,n,r)}t=t.child}return t;case 5:return Qee(t),e===null&&fL(t),n=t.type,i=t.pendingProps,o=e!==null?e.memoizedProps:null,s=i.children,aL(n,i)?s=null:o!==null&&aL(n,o)&&(t.flags|=32),xte(e,t),da(e,t,s,r),t.child;case 6:return e===null&&fL(t),null;case 13:return Ete(e,t,r);case 4:return sF(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=Mg(t,null,n,r):da(e,t,n,r),t.child;case 11:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:il(n,i),K5(e,t,n,i,r);case 7:return da(e,t,t.pendingProps,r),t.child;case 8:return da(e,t,t.pendingProps.children,r),t.child;case 12:return da(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,i=t.pendingProps,o=t.memoizedProps,s=i.value,fi(XR,n._currentValue),n._currentValue=s,o!==null)if(ml(o.value,s)){if(o.children===i.children&&!Ba.current){t=Oc(e,t,r);break e}}else for(o=t.child,o!==null&&(o.return=t);o!==null;){var a=o.dependencies;if(a!==null){s=o.child;for(var h=a.firstContext;h!==null;){if(h.context===n){if(o.tag===1){h=wc(-1,r&-r),h.tag=2;var p=o.updateQueue;if(p!==null){p=p.shared;var g=p.pending;g===null?h.next=h:(h.next=g.next,g.next=h),p.pending=h}}o.lanes|=r,h=o.alternate,h!==null&&(h.lanes|=r),hL(o.return,r,t),a.lanes|=r;break}h=h.next}}else if(o.tag===10)s=o.type===t.type?null:o.child;else if(o.tag===18){if(s=o.return,s===null)throw Error(Kt(341));s.lanes|=r,a=s.alternate,a!==null&&(a.lanes|=r),hL(s,r,t),s=o.sibling}else s=o.child;if(s!==null)s.return=o;else for(s=o;s!==null;){if(s===t){s=null;break}if(o=s.sibling,o!==null){o.return=s.return,s=o;break}s=s.return}o=s}da(e,t,i.children,r),t=t.child}return t;case 9:return i=t.type,n=t.pendingProps.children,pg(t,r),i=Ms(i),n=n(i),t.flags|=1,da(e,t,n,r),t.child;case 14:return n=t.type,i=il(n,t.pendingProps),i=il(n.type,i),q5(e,t,n,i,r);case 15:return wte(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:il(n,i),UO(e,t),t.tag=1,ja(n)?(e=!0,YR(t)):e=!1,pg(t,r),Xee(t,n,i),pL(t,n,i,r),gL(null,t,n,!0,e,r);case 19:return Tte(e,t,r);case 22:return Ste(e,t,r)}throw Error(Kt(156,t.tag))};function Hte(e,t){return pee(e,t)}function gme(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ps(e,t,r,n){return new gme(e,t,r,n)}function SF(e){return e=e.prototype,!(!e||!e.isReactComponent)}function vme(e){if(typeof e=="function")return SF(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Fz)return 11;if(e===Hz)return 14}return 2}function Zf(e,t){var r=e.alternate;return r===null?(r=Ps(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function YO(e,t,r,n,i,o){var s=2;if(n=e,typeof e=="function")SF(e)&&(s=1);else if(typeof e=="string")s=5;else e:switch(e){case Ky:return vp(r.children,i,o,t);case zz:s=8,i|=8;break;case B2:return e=Ps(12,r,t,i|2),e.elementType=B2,e.lanes=o,e;case j2:return e=Ps(13,r,t,i),e.elementType=j2,e.lanes=o,e;case z2:return e=Ps(19,r,t,i),e.elementType=z2,e.lanes=o,e;case ZQ:return NP(r,i,o,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case qQ:s=10;break e;case XQ:s=9;break e;case Fz:s=11;break e;case Hz:s=14;break e;case Pf:s=16,n=null;break e}throw Error(Kt(130,e==null?e:typeof e,""))}return t=Ps(s,r,t,i),t.elementType=e,t.type=n,t.lanes=o,t}function vp(e,t,r,n){return e=Ps(7,e,n,t),e.lanes=r,e}function NP(e,t,r,n){return e=Ps(22,e,n,t),e.elementType=ZQ,e.lanes=r,e.stateNode={isHidden:!1},e}function JM(e,t,r){return e=Ps(6,e,null,t),e.lanes=r,e}function QM(e,t,r){return t=Ps(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function _me(e,t,r,n,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=MM(0),this.expirationTimes=MM(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=MM(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function xF(e,t,r,n,i,o,s,a,h){return e=new _me(e,t,r,a,h),t===1?(t=1,o===!0&&(t|=8)):t=0,o=Ps(3,null,null,t),e.current=o,o.stateNode=e,o.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},aF(o),e}function bme(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Yy,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function Vte(e){if(!e)return ph;e=e._reactInternals;e:{if(Up(e)!==e||e.tag!==1)throw Error(Kt(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(ja(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(Kt(171))}if(e.tag===1){var r=e.type;if(ja(r))return Hee(e,r,t)}return t}function Ute(e,t,r,n,i,o,s,a,h){return e=xF(r,n,!0,e,i,o,s,a,h),e.context=Vte(null),r=e.current,n=ma(),i=Xf(r),o=wc(n,i),o.callback=t??null,Kf(r,o,i),e.current.lanes=i,kx(e,i,n),za(e,n),e}function BP(e,t,r,n){var i=t.current,o=ma(),s=Xf(i);return r=Vte(r),t.context===null?t.context=r:t.pendingContext=r,t=wc(o,s),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=Kf(i,t,s),e!==null&&(pl(e,i,s,o),FO(e,i,s)),s}function ak(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function sG(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function CF(e,t){sG(e,t),(e=e.alternate)&&sG(e,t)}function wme(){return null}var Wte=typeof reportError=="function"?reportError:function(e){console.error(e)};function EF(e){this._internalRoot=e}jP.prototype.render=EF.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(Kt(409));BP(e,t,null,null)};jP.prototype.unmount=EF.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Rp(function(){BP(null,e,null,null)}),t[Ec]=null}};function jP(e){this._internalRoot=e}jP.prototype.unstable_scheduleHydration=function(e){if(e){var t=wee();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Mf.length&&t!==0&&t<Mf[r].priority;r++);Mf.splice(r,0,e),r===0&&xee(e)}};function TF(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function zP(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function lG(){}function Sme(e,t,r,n,i){if(i){if(typeof n=="function"){var o=n;n=function(){var p=ak(s);o.call(p)}}var s=Ute(t,n,e,0,null,!1,!1,"",lG);return e._reactRootContainer=s,e[Ec]=s.current,sS(e.nodeType===8?e.parentNode:e),Rp(),s}for(;i=e.lastChild;)e.removeChild(i);if(typeof n=="function"){var a=n;n=function(){var p=ak(h);a.call(p)}}var h=xF(e,0,!1,null,null,!1,!1,"",lG);return e._reactRootContainer=h,e[Ec]=h.current,sS(e.nodeType===8?e.parentNode:e),Rp(function(){BP(t,h,r,n)}),h}function FP(e,t,r,n,i){var o=r._reactRootContainer;if(o){var s=o;if(typeof i=="function"){var a=i;i=function(){var h=ak(s);a.call(h)}}BP(t,s,e,i)}else s=Sme(r,t,e,i,n);return ak(s)}_ee=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=v0(t.pendingLanes);r!==0&&(Wz(t,r|1),za(t,qi()),!(Dn&6)&&(Lg=qi()+500,_h()))}break;case 13:Rp(function(){var n=Tc(e,1);if(n!==null){var i=ma();pl(n,e,1,i)}}),CF(e,1)}};Gz=function(e){if(e.tag===13){var t=Tc(e,134217728);if(t!==null){var r=ma();pl(t,e,134217728,r)}CF(e,134217728)}};bee=function(e){if(e.tag===13){var t=Xf(e),r=Tc(e,t);if(r!==null){var n=ma();pl(r,e,t,n)}CF(e,t)}};wee=function(){return Qn};See=function(e,t){var r=Qn;try{return Qn=e,t()}finally{Qn=r}};X2=function(e,t,r){switch(t){case"input":if(V2(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var i=AP(n);if(!i)throw Error(Kt(90));QQ(n),V2(n,i)}}}break;case"textarea":tee(e,r);break;case"select":t=r.value,t!=null&&cg(e,!!r.multiple,t,!1)}};lee=_F;uee=Rp;var xme={usingClientEntryPoint:!1,Events:[Ax,Jy,AP,aee,see,_F]},Bw={findFiberByHostInstance:Fd,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},Cme={bundleType:Bw.bundleType,version:Bw.version,rendererPackageName:Bw.rendererPackageName,rendererConfig:Bw.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Mc.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=hee(e),e===null?null:e.stateNode},findFiberByHostInstance:Bw.findFiberByHostInstance||wme,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var CT=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!CT.isDisabled&&CT.supportsFiber)try{OP=CT.inject(Cme),iu=CT}catch{}}ls.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=xme;ls.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!TF(t))throw Error(Kt(200));return bme(e,t,null,r)};ls.createRoot=function(e,t){if(!TF(e))throw Error(Kt(299));var r=!1,n="",i=Wte;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(i=t.onRecoverableError)),t=xF(e,1,!1,null,null,r,!1,n,i),e[Ec]=t.current,sS(e.nodeType===8?e.parentNode:e),new EF(t)};ls.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(Kt(188)):(e=Object.keys(e).join(","),Error(Kt(268,e)));return e=hee(t),e=e===null?null:e.stateNode,e};ls.flushSync=function(e){return Rp(e)};ls.hydrate=function(e,t,r){if(!zP(t))throw Error(Kt(200));return FP(null,e,t,!0,r)};ls.hydrateRoot=function(e,t,r){if(!TF(e))throw Error(Kt(405));var n=r!=null&&r.hydratedSources||null,i=!1,o="",s=Wte;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(o=r.identifierPrefix),r.onRecoverableError!==void 0&&(s=r.onRecoverableError)),t=Ute(t,null,e,1,r??null,i,!1,o,s),e[Ec]=t.current,sS(e),n)for(e=0;e<n.length;e++)r=n[e],i=r._getVersion,i=i(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,i]:t.mutableSourceEagerHydrationData.push(r,i);return new jP(t)};ls.render=function(e,t,r){if(!zP(t))throw Error(Kt(200));return FP(null,e,t,!1,r)};ls.unmountComponentAtNode=function(e){if(!zP(e))throw Error(Kt(40));return e._reactRootContainer?(Rp(function(){FP(null,null,e,!1,function(){e._reactRootContainer=null,e[Ec]=null})}),!0):!1};ls.unstable_batchedUpdates=_F;ls.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!zP(r))throw Error(Kt(200));if(e==null||e._reactInternals===void 0)throw Error(Kt(38));return FP(e,t,r,!1,n)};ls.version="18.2.0-next-9e3b772b8-20220608";function Gte(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Gte)}catch(e){console.error(e)}}Gte(),UQ.exports=ls;var Yte=UQ.exports;const Kte=V_(Yte);var uG=Yte;L2.createRoot=uG.createRoot,L2.hydrateRoot=uG.hydrateRoot;/**
 * @remix-run/router v1.6.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function yS(){return yS=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},yS.apply(this,arguments)}var jf;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(jf||(jf={}));const cG="popstate";function Eme(e){e===void 0&&(e={});function t(i,o){let{pathname:s="/",search:a="",hash:h=""}=Wp(i.location.hash.substr(1));return kL("",{pathname:s,search:a,hash:h},o.state&&o.state.usr||null,o.state&&o.state.key||"default")}function r(i,o){let s=i.document.querySelector("base"),a="";if(s&&s.getAttribute("href")){let h=i.location.href,p=h.indexOf("#");a=p===-1?h:h.slice(0,p)}return a+"#"+(typeof o=="string"?o:sk(o))}function n(i,o){HP(i.pathname.charAt(0)==="/","relative pathnames are not supported in hash history.push("+JSON.stringify(o)+")")}return Ome(t,r,n,e)}function oo(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function HP(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function Tme(){return Math.random().toString(36).substr(2,8)}function fG(e,t){return{usr:e.state,key:e.key,idx:t}}function kL(e,t,r,n){return r===void 0&&(r=null),yS({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?Wp(t):t,{state:r,key:t&&t.key||n||Tme()})}function sk(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function Wp(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function Ome(e,t,r,n){n===void 0&&(n={});let{window:i=document.defaultView,v5Compat:o=!1}=n,s=i.history,a=jf.Pop,h=null,p=g();p==null&&(p=0,s.replaceState(yS({},s.state,{idx:p}),""));function g(){return(s.state||{idx:null}).idx}function S(){a=jf.Pop;let j=g(),z=j==null?null:j-p;p=j,h&&h({action:a,location:$.location,delta:z})}function T(j,z){a=jf.Push;let V=kL($.location,j,z);r&&r(V,j),p=g()+1;let G=fG(V,p),ee=$.createHref(V);try{s.pushState(G,"",ee)}catch{i.location.assign(ee)}o&&h&&h({action:a,location:$.location,delta:1})}function R(j,z){a=jf.Replace;let V=kL($.location,j,z);r&&r(V,j),p=g();let G=fG(V,p),ee=$.createHref(V);s.replaceState(G,"",ee),o&&h&&h({action:a,location:$.location,delta:0})}function A(j){let z=i.location.origin!=="null"?i.location.origin:i.location.href,V=typeof j=="string"?j:sk(j);return oo(z,"No window.location.(origin|href) available to create URL for href: "+V),new URL(V,z)}let $={get action(){return a},get location(){return e(i,s)},listen(j){if(h)throw new Error("A history only accepts one active listener");return i.addEventListener(cG,S),h=j,()=>{i.removeEventListener(cG,S),h=null}},createHref(j){return t(i,j)},createURL:A,encodeLocation(j){let z=A(j);return{pathname:z.pathname,search:z.search,hash:z.hash}},push:T,replace:R,go(j){return s.go(j)}};return $}var hG;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(hG||(hG={}));function Rme(e,t,r){r===void 0&&(r="/");let n=typeof t=="string"?Wp(t):t,i=OF(n.pathname||"/",r);if(i==null)return null;let o=qte(e);kme(o);let s=null;for(let a=0;s==null&&a<o.length;++a)s=Bme(o[a],Fme(i));return s}function qte(e,t,r,n){t===void 0&&(t=[]),r===void 0&&(r=[]),n===void 0&&(n="");let i=(o,s,a)=>{let h={relativePath:a===void 0?o.path||"":a,caseSensitive:o.caseSensitive===!0,childrenIndex:s,route:o};h.relativePath.startsWith("/")&&(oo(h.relativePath.startsWith(n),'Absolute route path "'+h.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),h.relativePath=h.relativePath.slice(n.length));let p=Jf([n,h.relativePath]),g=r.concat(h);o.children&&o.children.length>0&&(oo(o.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+p+'".')),qte(o.children,t,g,p)),!(o.path==null&&!o.index)&&t.push({path:p,score:Lme(p,o.index),routesMeta:g})};return e.forEach((o,s)=>{var a;if(o.path===""||!((a=o.path)!=null&&a.includes("?")))i(o,s);else for(let h of Xte(o.path))i(o,s,h)}),t}function Xte(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,i=r.endsWith("?"),o=r.replace(/\?$/,"");if(n.length===0)return i?[o,""]:[o];let s=Xte(n.join("/")),a=[];return a.push(...s.map(h=>h===""?o:[o,h].join("/"))),i&&a.push(...s),a.map(h=>e.startsWith("/")&&h===""?"/":h)}function kme(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:Nme(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const Pme=/^:\w+$/,Ame=3,Ime=2,Mme=1,Dme=10,$me=-2,dG=e=>e==="*";function Lme(e,t){let r=e.split("/"),n=r.length;return r.some(dG)&&(n+=$me),t&&(n+=Ime),r.filter(i=>!dG(i)).reduce((i,o)=>i+(Pme.test(o)?Ame:o===""?Mme:Dme),n)}function Nme(e,t){return e.length===t.length&&e.slice(0,-1).every((n,i)=>n===t[i])?e[e.length-1]-t[t.length-1]:0}function Bme(e,t){let{routesMeta:r}=e,n={},i="/",o=[];for(let s=0;s<r.length;++s){let a=r[s],h=s===r.length-1,p=i==="/"?t:t.slice(i.length)||"/",g=jme({path:a.relativePath,caseSensitive:a.caseSensitive,end:h},p);if(!g)return null;Object.assign(n,g.params);let S=a.route;o.push({params:n,pathname:Jf([i,g.pathname]),pathnameBase:Wme(Jf([i,g.pathnameBase])),route:S}),g.pathnameBase!=="/"&&(i=Jf([i,g.pathnameBase]))}return o}function jme(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=zme(e.path,e.caseSensitive,e.end),i=t.match(r);if(!i)return null;let o=i[0],s=o.replace(/(.)\/+$/,"$1"),a=i.slice(1);return{params:n.reduce((p,g,S)=>{if(g==="*"){let T=a[S]||"";s=o.slice(0,o.length-T.length).replace(/(.)\/+$/,"$1")}return p[g]=Hme(a[S]||"",g),p},{}),pathname:o,pathnameBase:s,pattern:e}}function zme(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),HP(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let n=[],i="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^$?{}|()[\]]/g,"\\$&").replace(/\/:(\w+)/g,(s,a)=>(n.push(a),"/([^\\/]+)"));return e.endsWith("*")?(n.push("*"),i+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?i+="\\/*$":e!==""&&e!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,t?void 0:"i"),n]}function Fme(e){try{return decodeURI(e)}catch(t){return HP(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function Hme(e,t){try{return decodeURIComponent(e)}catch(r){return HP(!1,'The value for the URL param "'+t+'" will not be decoded because'+(' the string "'+e+'" is a malformed URL segment. This is probably')+(" due to a bad percent encoding ("+r+").")),e}}function OF(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}function Vme(e,t){t===void 0&&(t="/");let{pathname:r,search:n="",hash:i=""}=typeof e=="string"?Wp(e):e;return{pathname:r?r.startsWith("/")?r:Ume(r,t):t,search:Gme(n),hash:Yme(i)}}function Ume(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(i=>{i===".."?r.length>1&&r.pop():i!=="."&&r.push(i)}),r.length>1?r.join("/"):"/"}function eD(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function Zte(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function Jte(e,t,r,n){n===void 0&&(n=!1);let i;typeof e=="string"?i=Wp(e):(i=yS({},e),oo(!i.pathname||!i.pathname.includes("?"),eD("?","pathname","search",i)),oo(!i.pathname||!i.pathname.includes("#"),eD("#","pathname","hash",i)),oo(!i.search||!i.search.includes("#"),eD("#","search","hash",i)));let o=e===""||i.pathname==="",s=o?"/":i.pathname,a;if(n||s==null)a=r;else{let S=t.length-1;if(s.startsWith("..")){let T=s.split("/");for(;T[0]==="..";)T.shift(),S-=1;i.pathname=T.join("/")}a=S>=0?t[S]:"/"}let h=Vme(i,a),p=s&&s!=="/"&&s.endsWith("/"),g=(o||s===".")&&r.endsWith("/");return!h.pathname.endsWith("/")&&(p||g)&&(h.pathname+="/"),h}const Jf=e=>e.join("/").replace(/\/\/+/g,"/"),Wme=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),Gme=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,Yme=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function Kme(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const Qte=["post","put","patch","delete"];new Set(Qte);const qme=["get",...Qte];new Set(qme);/**
 * React Router v6.11.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function lk(){return lk=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},lk.apply(this,arguments)}const RF=Rt.createContext(null),Xme=Rt.createContext(null),Y_=Rt.createContext(null),VP=Rt.createContext(null),Gp=Rt.createContext({outlet:null,matches:[],isDataRoute:!1}),ere=Rt.createContext(null);function Zme(e,t){let{relative:r}=t===void 0?{}:t;Mx()||oo(!1);let{basename:n,navigator:i}=Rt.useContext(Y_),{hash:o,pathname:s,search:a}=rre(e,{relative:r}),h=s;return n!=="/"&&(h=s==="/"?n:Jf([n,s])),i.createHref({pathname:h,search:a,hash:o})}function Mx(){return Rt.useContext(VP)!=null}function Dx(){return Mx()||oo(!1),Rt.useContext(VP).location}function tre(e){Rt.useContext(Y_).static||Rt.useLayoutEffect(e)}function UP(){let{isDataRoute:e}=Rt.useContext(Gp);return e?cye():Jme()}function Jme(){Mx()||oo(!1);let e=Rt.useContext(RF),{basename:t,navigator:r}=Rt.useContext(Y_),{matches:n}=Rt.useContext(Gp),{pathname:i}=Dx(),o=JSON.stringify(Zte(n).map(h=>h.pathnameBase)),s=Rt.useRef(!1);return tre(()=>{s.current=!0}),Rt.useCallback(function(h,p){if(p===void 0&&(p={}),!s.current)return;if(typeof h=="number"){r.go(h);return}let g=Jte(h,JSON.parse(o),i,p.relative==="path");e==null&&t!=="/"&&(g.pathname=g.pathname==="/"?t:Jf([t,g.pathname])),(p.replace?r.replace:r.push)(g,p.state,p)},[t,r,o,i,e])}function rre(e,t){let{relative:r}=t===void 0?{}:t,{matches:n}=Rt.useContext(Gp),{pathname:i}=Dx(),o=JSON.stringify(Zte(n).map(s=>s.pathnameBase));return Rt.useMemo(()=>Jte(e,JSON.parse(o),i,r==="path"),[e,o,i,r])}function Qme(e,t){return eye(e,t)}function eye(e,t,r){Mx()||oo(!1);let{navigator:n}=Rt.useContext(Y_),{matches:i}=Rt.useContext(Gp),o=i[i.length-1],s=o?o.params:{};o&&o.pathname;let a=o?o.pathnameBase:"/";o&&o.route;let h=Dx(),p;if(t){var g;let $=typeof t=="string"?Wp(t):t;a==="/"||(g=$.pathname)!=null&&g.startsWith(a)||oo(!1),p=$}else p=h;let S=p.pathname||"/",T=a==="/"?S:S.slice(a.length)||"/",R=Rme(e,{pathname:T}),A=oye(R&&R.map($=>Object.assign({},$,{params:Object.assign({},s,$.params),pathname:Jf([a,n.encodeLocation?n.encodeLocation($.pathname).pathname:$.pathname]),pathnameBase:$.pathnameBase==="/"?a:Jf([a,n.encodeLocation?n.encodeLocation($.pathnameBase).pathname:$.pathnameBase])})),i,r);return t&&A?Rt.createElement(VP.Provider,{value:{location:lk({pathname:"/",search:"",hash:"",state:null,key:"default"},p),navigationType:jf.Pop}},A):A}function tye(){let e=uye(),t=Kme(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},o=null;return Rt.createElement(Rt.Fragment,null,Rt.createElement("h2",null,"Unexpected Application Error!"),Rt.createElement("h3",{style:{fontStyle:"italic"}},t),r?Rt.createElement("pre",{style:i},r):null,o)}const rye=Rt.createElement(tye,null);class nye extends Rt.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error||r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error?Rt.createElement(Gp.Provider,{value:this.props.routeContext},Rt.createElement(ere.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function iye(e){let{routeContext:t,match:r,children:n}=e,i=Rt.useContext(RF);return i&&i.static&&i.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=r.route.id),Rt.createElement(Gp.Provider,{value:t},n)}function oye(e,t,r){var n;if(t===void 0&&(t=[]),r===void 0&&(r=null),e==null){var i;if((i=r)!=null&&i.errors)e=r.matches;else return null}let o=e,s=(n=r)==null?void 0:n.errors;if(s!=null){let a=o.findIndex(h=>h.route.id&&(s==null?void 0:s[h.route.id]));a>=0||oo(!1),o=o.slice(0,Math.min(o.length,a+1))}return o.reduceRight((a,h,p)=>{let g=h.route.id?s==null?void 0:s[h.route.id]:null,S=null;r&&(S=h.route.errorElement||rye);let T=t.concat(o.slice(0,p+1)),R=()=>{let A;return g?A=S:h.route.Component?A=Rt.createElement(h.route.Component,null):h.route.element?A=h.route.element:A=a,Rt.createElement(iye,{match:h,routeContext:{outlet:a,matches:T,isDataRoute:r!=null},children:A})};return r&&(h.route.ErrorBoundary||h.route.errorElement||p===0)?Rt.createElement(nye,{location:r.location,revalidation:r.revalidation,component:S,error:g,children:R(),routeContext:{outlet:null,matches:T,isDataRoute:!0}}):R()},null)}var PL;(function(e){e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate"})(PL||(PL={}));var gS;(function(e){e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId"})(gS||(gS={}));function aye(e){let t=Rt.useContext(RF);return t||oo(!1),t}function sye(e){let t=Rt.useContext(Xme);return t||oo(!1),t}function lye(e){let t=Rt.useContext(Gp);return t||oo(!1),t}function nre(e){let t=lye(),r=t.matches[t.matches.length-1];return r.route.id||oo(!1),r.route.id}function uye(){var e;let t=Rt.useContext(ere),r=sye(gS.UseRouteError),n=nre(gS.UseRouteError);return t||((e=r.errors)==null?void 0:e[n])}function cye(){let{router:e}=aye(PL.UseNavigateStable),t=nre(gS.UseNavigateStable),r=Rt.useRef(!1);return tre(()=>{r.current=!0}),Rt.useCallback(function(i,o){o===void 0&&(o={}),r.current&&(typeof i=="number"?e.navigate(i):e.navigate(i,lk({fromRouteId:t},o)))},[e,t])}function zy(e){oo(!1)}function fye(e){let{basename:t="/",children:r=null,location:n,navigationType:i=jf.Pop,navigator:o,static:s=!1}=e;Mx()&&oo(!1);let a=t.replace(/^\/*/,"/"),h=Rt.useMemo(()=>({basename:a,navigator:o,static:s}),[a,o,s]);typeof n=="string"&&(n=Wp(n));let{pathname:p="/",search:g="",hash:S="",state:T=null,key:R="default"}=n,A=Rt.useMemo(()=>{let $=OF(p,a);return $==null?null:{location:{pathname:$,search:g,hash:S,state:T,key:R},navigationType:i}},[a,p,g,S,T,R,i]);return A==null?null:Rt.createElement(Y_.Provider,{value:h},Rt.createElement(VP.Provider,{children:r,value:A}))}function hye(e){let{children:t,location:r}=e;return Qme(AL(t),r)}var pG;(function(e){e[e.pending=0]="pending",e[e.success=1]="success",e[e.error=2]="error"})(pG||(pG={}));new Promise(()=>{});function AL(e,t){t===void 0&&(t=[]);let r=[];return Rt.Children.forEach(e,(n,i)=>{if(!Rt.isValidElement(n))return;let o=[...t,i];if(n.type===Rt.Fragment){r.push.apply(r,AL(n.props.children,o));return}n.type!==zy&&oo(!1),!n.props.index||!n.props.children||oo(!1);let s={id:n.props.id||o.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(s.children=AL(n.props.children,o)),r.push(s)}),r}/**
 * React Router DOM v6.11.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function IL(){return IL=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},IL.apply(this,arguments)}function dye(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,o;for(o=0;o<n.length;o++)i=n[o],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function pye(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function mye(e,t){return e.button===0&&(!t||t==="_self")&&!pye(e)}const yye=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset"];function gye(e){let{basename:t,children:r,window:n}=e,i=Rt.useRef();i.current==null&&(i.current=Eme({window:n,v5Compat:!0}));let o=i.current,[s,a]=Rt.useState({action:o.action,location:o.location});return Rt.useLayoutEffect(()=>o.listen(a),[o]),Rt.createElement(fye,{basename:t,children:r,location:s.location,navigationType:s.action,navigator:o})}const vye=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",_ye=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,mG=Rt.forwardRef(function(t,r){let{onClick:n,relative:i,reloadDocument:o,replace:s,state:a,target:h,to:p,preventScrollReset:g}=t,S=dye(t,yye),{basename:T}=Rt.useContext(Y_),R,A=!1;if(typeof p=="string"&&_ye.test(p)&&(R=p,vye))try{let V=new URL(window.location.href),G=p.startsWith("//")?new URL(V.protocol+p):new URL(p),ee=OF(G.pathname,T);G.origin===V.origin&&ee!=null?p=ee+G.search+G.hash:A=!0}catch{}let $=Zme(p,{relative:i}),j=bye(p,{replace:s,state:a,target:h,preventScrollReset:g,relative:i});function z(V){n&&n(V),V.defaultPrevented||j(V)}return Rt.createElement("a",IL({},S,{href:R||$,onClick:A||o?n:z,ref:r,target:h}))});var yG;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmitImpl="useSubmitImpl",e.UseFetcher="useFetcher"})(yG||(yG={}));var gG;(function(e){e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(gG||(gG={}));function bye(e,t){let{target:r,replace:n,state:i,preventScrollReset:o,relative:s}=t===void 0?{}:t,a=UP(),h=Dx(),p=rre(e,{relative:s});return Rt.useCallback(g=>{if(mye(g,r)){g.preventDefault();let S=n!==void 0?n:sk(h)===sk(p);a(e,{replace:S,state:i,preventScrollReset:o,relative:s})}},[h,a,p,n,i,r,e,o,s])}const wye="modulepreload",Sye=function(e){return"/"+e},vG={},WP=function(t,r,n){if(!r||r.length===0)return t();const i=document.getElementsByTagName("link");return Promise.all(r.map(o=>{if(o=Sye(o),o in vG)return;vG[o]=!0;const s=o.endsWith(".css"),a=s?'[rel="stylesheet"]':"";if(!!n)for(let g=i.length-1;g>=0;g--){const S=i[g];if(S.href===o&&(!s||S.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${o}"]${a}`))return;const p=document.createElement("link");if(p.rel=s?"stylesheet":wye,s||(p.as="script",p.crossOrigin=""),p.href=o,document.head.appendChild(p),s)return new Promise((g,S)=>{p.addEventListener("load",g),p.addEventListener("error",()=>S(new Error(`Unable to preload CSS for ${o}`)))})})).then(()=>t())};var xye=globalThis&&globalThis.__awaiter||function(e,t,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(g){try{p(n.next(g))}catch(S){s(S)}}function h(g){try{p(n.throw(g))}catch(S){s(S)}}function p(g){g.done?o(g.value):i(g.value).then(a,h)}p((n=n.apply(e,t||[])).next())})};const Cye=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>xye(void 0,void 0,void 0,function*(){return yield(yield WP(()=>Promise.resolve().then(()=>GP),void 0)).fetch(...r)}):t=fetch,(...r)=>t(...r)};class kF extends Error{constructor(t,r="FunctionsError",n){super(t),super.name=r,this.context=n}}class Eye extends kF{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class Tye extends kF{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class Oye extends kF{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var Rye=globalThis&&globalThis.__awaiter||function(e,t,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(g){try{p(n.next(g))}catch(S){s(S)}}function h(g){try{p(n.throw(g))}catch(S){s(S)}}function p(g){g.done?o(g.value):i(g.value).then(a,h)}p((n=n.apply(e,t||[])).next())})};class kye{constructor(t,{headers:r={},customFetch:n}={}){this.url=t,this.headers=r,this.fetch=Cye(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t,r={}){var n;return Rye(this,void 0,void 0,function*(){try{const{headers:i,method:o,body:s}=r;let a={},h;s&&(i&&!Object.prototype.hasOwnProperty.call(i,"Content-Type")||!i)&&(typeof Blob<"u"&&s instanceof Blob||s instanceof ArrayBuffer?(a["Content-Type"]="application/octet-stream",h=s):typeof s=="string"?(a["Content-Type"]="text/plain",h=s):typeof FormData<"u"&&s instanceof FormData?h=s:(a["Content-Type"]="application/json",h=JSON.stringify(s)));const p=yield this.fetch(`${this.url}/${t}`,{method:o||"POST",headers:Object.assign(Object.assign(Object.assign({},a),this.headers),i),body:h}).catch(R=>{throw new Eye(R)}),g=p.headers.get("x-relay-error");if(g&&g==="true")throw new Tye(p);if(!p.ok)throw new Oye(p);let S=((n=p.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),T;return S==="application/json"?T=yield p.json():S==="application/octet-stream"?T=yield p.blob():S==="multipart/form-data"?T=yield p.formData():T=yield p.text(),{data:T,error:null}}catch(i){return{data:null,error:i}}})}}var ML={exports:{}};(function(e,t){var r=typeof self<"u"?self:ug,n=function(){function o(){this.fetch=!1,this.DOMException=r.DOMException}return o.prototype=r,new o}();(function(o){(function(s){var a={searchParams:"URLSearchParams"in o,iterable:"Symbol"in o&&"iterator"in Symbol,blob:"FileReader"in o&&"Blob"in o&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in o,arrayBuffer:"ArrayBuffer"in o};function h($e){return $e&&DataView.prototype.isPrototypeOf($e)}if(a.arrayBuffer)var p=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],g=ArrayBuffer.isView||function($e){return $e&&p.indexOf(Object.prototype.toString.call($e))>-1};function S($e){if(typeof $e!="string"&&($e=String($e)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test($e))throw new TypeError("Invalid character in header field name");return $e.toLowerCase()}function T($e){return typeof $e!="string"&&($e=String($e)),$e}function R($e){var Fe={next:function(){var At=$e.shift();return{done:At===void 0,value:At}}};return a.iterable&&(Fe[Symbol.iterator]=function(){return Fe}),Fe}function A($e){this.map={},$e instanceof A?$e.forEach(function(Fe,At){this.append(At,Fe)},this):Array.isArray($e)?$e.forEach(function(Fe){this.append(Fe[0],Fe[1])},this):$e&&Object.getOwnPropertyNames($e).forEach(function(Fe){this.append(Fe,$e[Fe])},this)}A.prototype.append=function($e,Fe){$e=S($e),Fe=T(Fe);var At=this.map[$e];this.map[$e]=At?At+", "+Fe:Fe},A.prototype.delete=function($e){delete this.map[S($e)]},A.prototype.get=function($e){return $e=S($e),this.has($e)?this.map[$e]:null},A.prototype.has=function($e){return this.map.hasOwnProperty(S($e))},A.prototype.set=function($e,Fe){this.map[S($e)]=T(Fe)},A.prototype.forEach=function($e,Fe){for(var At in this.map)this.map.hasOwnProperty(At)&&$e.call(Fe,this.map[At],At,this)},A.prototype.keys=function(){var $e=[];return this.forEach(function(Fe,At){$e.push(At)}),R($e)},A.prototype.values=function(){var $e=[];return this.forEach(function(Fe){$e.push(Fe)}),R($e)},A.prototype.entries=function(){var $e=[];return this.forEach(function(Fe,At){$e.push([At,Fe])}),R($e)},a.iterable&&(A.prototype[Symbol.iterator]=A.prototype.entries);function $($e){if($e.bodyUsed)return Promise.reject(new TypeError("Already read"));$e.bodyUsed=!0}function j($e){return new Promise(function(Fe,At){$e.onload=function(){Fe($e.result)},$e.onerror=function(){At($e.error)}})}function z($e){var Fe=new FileReader,At=j(Fe);return Fe.readAsArrayBuffer($e),At}function V($e){var Fe=new FileReader,At=j(Fe);return Fe.readAsText($e),At}function G($e){for(var Fe=new Uint8Array($e),At=new Array(Fe.length),Gt=0;Gt<Fe.length;Gt++)At[Gt]=String.fromCharCode(Fe[Gt]);return At.join("")}function ee($e){if($e.slice)return $e.slice(0);var Fe=new Uint8Array($e.byteLength);return Fe.set(new Uint8Array($e)),Fe.buffer}function K(){return this.bodyUsed=!1,this._initBody=function($e){this._bodyInit=$e,$e?typeof $e=="string"?this._bodyText=$e:a.blob&&Blob.prototype.isPrototypeOf($e)?this._bodyBlob=$e:a.formData&&FormData.prototype.isPrototypeOf($e)?this._bodyFormData=$e:a.searchParams&&URLSearchParams.prototype.isPrototypeOf($e)?this._bodyText=$e.toString():a.arrayBuffer&&a.blob&&h($e)?(this._bodyArrayBuffer=ee($e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):a.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf($e)||g($e))?this._bodyArrayBuffer=ee($e):this._bodyText=$e=Object.prototype.toString.call($e):this._bodyText="",this.headers.get("content-type")||(typeof $e=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):a.searchParams&&URLSearchParams.prototype.isPrototypeOf($e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},a.blob&&(this.blob=function(){var $e=$(this);if($e)return $e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?$(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(z)}),this.text=function(){var $e=$(this);if($e)return $e;if(this._bodyBlob)return V(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(G(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},a.formData&&(this.formData=function(){return this.text().then(Ne)}),this.json=function(){return this.text().then(JSON.parse)},this}var xe=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function Me($e){var Fe=$e.toUpperCase();return xe.indexOf(Fe)>-1?Fe:$e}function He($e,Fe){Fe=Fe||{};var At=Fe.body;if($e instanceof He){if($e.bodyUsed)throw new TypeError("Already read");this.url=$e.url,this.credentials=$e.credentials,Fe.headers||(this.headers=new A($e.headers)),this.method=$e.method,this.mode=$e.mode,this.signal=$e.signal,!At&&$e._bodyInit!=null&&(At=$e._bodyInit,$e.bodyUsed=!0)}else this.url=String($e);if(this.credentials=Fe.credentials||this.credentials||"same-origin",(Fe.headers||!this.headers)&&(this.headers=new A(Fe.headers)),this.method=Me(Fe.method||this.method||"GET"),this.mode=Fe.mode||this.mode||null,this.signal=Fe.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&At)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(At)}He.prototype.clone=function(){return new He(this,{body:this._bodyInit})};function Ne($e){var Fe=new FormData;return $e.trim().split("&").forEach(function(At){if(At){var Gt=At.split("="),ae=Gt.shift().replace(/\+/g," "),D=Gt.join("=").replace(/\+/g," ");Fe.append(decodeURIComponent(ae),decodeURIComponent(D))}}),Fe}function We($e){var Fe=new A,At=$e.replace(/\r?\n[\t ]+/g," ");return At.split(/\r?\n/).forEach(function(Gt){var ae=Gt.split(":"),D=ae.shift().trim();if(D){var U=ae.join(":").trim();Fe.append(D,U)}}),Fe}K.call(He.prototype);function gt($e,Fe){Fe||(Fe={}),this.type="default",this.status=Fe.status===void 0?200:Fe.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in Fe?Fe.statusText:"OK",this.headers=new A(Fe.headers),this.url=Fe.url||"",this._initBody($e)}K.call(gt.prototype),gt.prototype.clone=function(){return new gt(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new A(this.headers),url:this.url})},gt.error=function(){var $e=new gt(null,{status:0,statusText:""});return $e.type="error",$e};var Lt=[301,302,303,307,308];gt.redirect=function($e,Fe){if(Lt.indexOf(Fe)===-1)throw new RangeError("Invalid status code");return new gt(null,{status:Fe,headers:{location:$e}})},s.DOMException=o.DOMException;try{new s.DOMException}catch{s.DOMException=function(Fe,At){this.message=Fe,this.name=At;var Gt=Error(Fe);this.stack=Gt.stack},s.DOMException.prototype=Object.create(Error.prototype),s.DOMException.prototype.constructor=s.DOMException}function _t($e,Fe){return new Promise(function(At,Gt){var ae=new He($e,Fe);if(ae.signal&&ae.signal.aborted)return Gt(new s.DOMException("Aborted","AbortError"));var D=new XMLHttpRequest;function U(){D.abort()}D.onload=function(){var q={status:D.status,statusText:D.statusText,headers:We(D.getAllResponseHeaders()||"")};q.url="responseURL"in D?D.responseURL:q.headers.get("X-Request-URL");var ne="response"in D?D.response:D.responseText;At(new gt(ne,q))},D.onerror=function(){Gt(new TypeError("Network request failed"))},D.ontimeout=function(){Gt(new TypeError("Network request failed"))},D.onabort=function(){Gt(new s.DOMException("Aborted","AbortError"))},D.open(ae.method,ae.url,!0),ae.credentials==="include"?D.withCredentials=!0:ae.credentials==="omit"&&(D.withCredentials=!1),"responseType"in D&&a.blob&&(D.responseType="blob"),ae.headers.forEach(function(q,ne){D.setRequestHeader(ne,q)}),ae.signal&&(ae.signal.addEventListener("abort",U),D.onreadystatechange=function(){D.readyState===4&&ae.signal.removeEventListener("abort",U)}),D.send(typeof ae._bodyInit>"u"?null:ae._bodyInit)})}return _t.polyfill=!0,o.fetch||(o.fetch=_t,o.Headers=A,o.Request=He,o.Response=gt),s.Headers=A,s.Request=He,s.Response=gt,s.fetch=_t,Object.defineProperty(s,"__esModule",{value:!0}),s})({})})(n),n.fetch.ponyfill=!0,delete n.fetch.polyfill;var i=n;t=i.fetch,t.default=i.fetch,t.fetch=i.fetch,t.Headers=i.Headers,t.Request=i.Request,t.Response=i.Response,e.exports=t})(ML,ML.exports);var PF=ML.exports;const AF=V_(PF),GP=Qhe({__proto__:null,default:AF},[PF]);class Pye{constructor(t){this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=t.headers,this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=t.shouldThrowOnError,this.signal=t.signal,this.isMaybeSingle=t.isMaybeSingle,t.fetch?this.fetch=t.fetch:typeof fetch>"u"?this.fetch=AF:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}then(t,r){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const n=this.fetch;let i=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async o=>{var s,a,h;let p=null,g=null,S=null,T=o.status,R=o.statusText;if(o.ok){if(this.method!=="HEAD"){const z=await o.text();z===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?g=z:g=JSON.parse(z))}const $=(s=this.headers.Prefer)===null||s===void 0?void 0:s.match(/count=(exact|planned|estimated)/),j=(a=o.headers.get("content-range"))===null||a===void 0?void 0:a.split("/");$&&j&&j.length>1&&(S=parseInt(j[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(g)&&(g.length>1?(p={code:"PGRST116",details:`Results contain ${g.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},g=null,S=null,T=406,R="Not Acceptable"):g.length===1?g=g[0]:g=null)}else{const $=await o.text();try{p=JSON.parse($),Array.isArray(p)&&o.status===404&&(g=[],p=null,T=200,R="OK")}catch{o.status===404&&$===""?(T=204,R="No Content"):p={message:$}}if(p&&this.isMaybeSingle&&(!((h=p==null?void 0:p.details)===null||h===void 0)&&h.includes("Results contain 0 rows"))&&(p=null,T=200,R="OK"),p&&this.shouldThrowOnError)throw p}return{error:p,data:g,count:S,status:T,statusText:R}});return this.shouldThrowOnError||(i=i.catch(o=>{var s,a,h;return{error:{message:`${(s=o==null?void 0:o.name)!==null&&s!==void 0?s:"FetchError"}: ${o==null?void 0:o.message}`,details:`${(a=o==null?void 0:o.stack)!==null&&a!==void 0?a:""}`,hint:"",code:`${(h=o==null?void 0:o.code)!==null&&h!==void 0?h:""}`},data:null,count:null,status:0,statusText:""}})),i.then(t,r)}}class Aye extends Pye{select(t){let r=!1;const n=(t??"*").split("").map(i=>/\s/.test(i)&&!r?"":(i==='"'&&(r=!r),i)).join("");return this.url.searchParams.set("select",n),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(t,{ascending:r=!0,nullsFirst:n,foreignTable:i}={}){const o=i?`${i}.order`:"order",s=this.url.searchParams.get(o);return this.url.searchParams.set(o,`${s?`${s},`:""}${t}.${r?"asc":"desc"}${n===void 0?"":n?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:r}={}){const n=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(n,`${t}`),this}range(t,r,{foreignTable:n}={}){const i=typeof n>"u"?"offset":`${n}.offset`,o=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(i,`${t}`),this.url.searchParams.set(o,`${r-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:t=!1,verbose:r=!1,settings:n=!1,buffers:i=!1,wal:o=!1,format:s="text"}={}){const a=[t?"analyze":null,r?"verbose":null,n?"settings":null,i?"buffers":null,o?"wal":null].filter(Boolean).join("|"),h=this.headers.Accept;return this.headers.Accept=`application/vnd.pgrst.plan+${s}; for="${h}"; options=${a};`,s==="json"?this:this}rollback(){var t;return((t=this.headers.Prefer)!==null&&t!==void 0?t:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}class Fy extends Aye{eq(t,r){return this.url.searchParams.append(t,`eq.${r}`),this}neq(t,r){return this.url.searchParams.append(t,`neq.${r}`),this}gt(t,r){return this.url.searchParams.append(t,`gt.${r}`),this}gte(t,r){return this.url.searchParams.append(t,`gte.${r}`),this}lt(t,r){return this.url.searchParams.append(t,`lt.${r}`),this}lte(t,r){return this.url.searchParams.append(t,`lte.${r}`),this}like(t,r){return this.url.searchParams.append(t,`like.${r}`),this}likeAllOf(t,r){return this.url.searchParams.append(t,`like(all).{${r.join(",")}}`),this}likeAnyOf(t,r){return this.url.searchParams.append(t,`like(any).{${r.join(",")}}`),this}ilike(t,r){return this.url.searchParams.append(t,`ilike.${r}`),this}ilikeAllOf(t,r){return this.url.searchParams.append(t,`ilike(all).{${r.join(",")}}`),this}ilikeAnyOf(t,r){return this.url.searchParams.append(t,`ilike(any).{${r.join(",")}}`),this}is(t,r){return this.url.searchParams.append(t,`is.${r}`),this}in(t,r){const n=r.map(i=>typeof i=="string"&&new RegExp("[,()]").test(i)?`"${i}"`:`${i}`).join(",");return this.url.searchParams.append(t,`in.(${n})`),this}contains(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cs.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cs.{${r.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(r)}`),this}containedBy(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cd.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cd.{${r.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(r)}`),this}rangeGt(t,r){return this.url.searchParams.append(t,`sr.${r}`),this}rangeGte(t,r){return this.url.searchParams.append(t,`nxl.${r}`),this}rangeLt(t,r){return this.url.searchParams.append(t,`sl.${r}`),this}rangeLte(t,r){return this.url.searchParams.append(t,`nxr.${r}`),this}rangeAdjacent(t,r){return this.url.searchParams.append(t,`adj.${r}`),this}overlaps(t,r){return typeof r=="string"?this.url.searchParams.append(t,`ov.${r}`):this.url.searchParams.append(t,`ov.{${r.join(",")}}`),this}textSearch(t,r,{config:n,type:i}={}){let o="";i==="plain"?o="pl":i==="phrase"?o="ph":i==="websearch"&&(o="w");const s=n===void 0?"":`(${n})`;return this.url.searchParams.append(t,`${o}fts${s}.${r}`),this}match(t){return Object.entries(t).forEach(([r,n])=>{this.url.searchParams.append(r,`eq.${n}`)}),this}not(t,r,n){return this.url.searchParams.append(t,`not.${r}.${n}`),this}or(t,{foreignTable:r}={}){const n=r?`${r}.or`:"or";return this.url.searchParams.append(n,`(${t})`),this}filter(t,r,n){return this.url.searchParams.append(t,`${r}.${n}`),this}}class Iye{constructor(t,{headers:r={},schema:n,fetch:i}){this.url=t,this.headers=r,this.schema=n,this.fetch=i}select(t,{head:r=!1,count:n}={}){const i=r?"HEAD":"GET";let o=!1;const s=(t??"*").split("").map(a=>/\s/.test(a)&&!o?"":(a==='"'&&(o=!o),a)).join("");return this.url.searchParams.set("select",s),n&&(this.headers.Prefer=`count=${n}`),new Fy({method:i,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(t,{count:r,defaultToNull:n=!0}={}){const i="POST",o=[];if(this.headers.Prefer&&o.push(this.headers.Prefer),r&&o.push(`count=${r}`),n||o.push("missing=default"),this.headers.Prefer=o.join(","),Array.isArray(t)){const s=t.reduce((a,h)=>a.concat(Object.keys(h)),[]);if(s.length>0){const a=[...new Set(s)].map(h=>`"${h}"`);this.url.searchParams.set("columns",a.join(","))}}return new Fy({method:i,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}upsert(t,{onConflict:r,ignoreDuplicates:n=!1,count:i,defaultToNull:o=!0}={}){const s="POST",a=[`resolution=${n?"ignore":"merge"}-duplicates`];if(r!==void 0&&this.url.searchParams.set("on_conflict",r),this.headers.Prefer&&a.push(this.headers.Prefer),i&&a.push(`count=${i}`),o||a.push("missing=default"),this.headers.Prefer=a.join(","),Array.isArray(t)){const h=t.reduce((p,g)=>p.concat(Object.keys(g)),[]);if(h.length>0){const p=[...new Set(h)].map(g=>`"${g}"`);this.url.searchParams.set("columns",p.join(","))}}return new Fy({method:s,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}update(t,{count:r}={}){const n="PATCH",i=[];return this.headers.Prefer&&i.push(this.headers.Prefer),r&&i.push(`count=${r}`),this.headers.Prefer=i.join(","),new Fy({method:n,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}delete({count:t}={}){const r="DELETE",n=[];return t&&n.push(`count=${t}`),this.headers.Prefer&&n.unshift(this.headers.Prefer),this.headers.Prefer=n.join(","),new Fy({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}const Mye="1.6.1",Dye={"X-Client-Info":`postgrest-js/${Mye}`};class $ye{constructor(t,{headers:r={},schema:n,fetch:i}={}){this.url=t,this.headers=Object.assign(Object.assign({},Dye),r),this.schema=n,this.fetch=i}from(t){const r=new URL(`${this.url}/${t}`);return new Iye(r,{headers:Object.assign({},this.headers),schema:this.schema,fetch:this.fetch})}rpc(t,r={},{head:n=!1,count:i}={}){let o;const s=new URL(`${this.url}/rpc/${t}`);let a;n?(o="HEAD",Object.entries(r).forEach(([p,g])=>{s.searchParams.append(p,`${g}`)})):(o="POST",a=r);const h=Object.assign({},this.headers);return i&&(h.Prefer=`count=${i}`),new Fy({method:o,url:s,headers:h,schema:this.schema,body:a,fetch:this.fetch,allowEmpty:!1})}}var tD,_G;function Lye(){if(_G)return tD;_G=1;var e=function(){if(typeof self=="object"&&self)return self;if(typeof window=="object"&&window)return window;throw new Error("Unable to resolve global `this`")};return tD=function(){if(this)return this;if(typeof globalThis=="object"&&globalThis)return globalThis;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch{return e()}try{return __global__||e()}finally{delete Object.prototype.__global__}}(),tD}const Nye="websocket",Bye="Websocket Client & Server Library implementing the WebSocket protocol as specified in RFC 6455.",jye=["websocket","websockets","socket","networking","comet","push","RFC-6455","realtime","server","client"],zye="Brian McKelvey <theturtle32@gmail.com> (https://github.com/theturtle32)",Fye=["Iaki Baz Castillo <ibc@aliax.net> (http://dev.sipdoc.net)"],Hye="1.0.34",Vye={type:"git",url:"https://github.com/theturtle32/WebSocket-Node.git"},Uye="https://github.com/theturtle32/WebSocket-Node",Wye={node:">=4.0.0"},Gye={bufferutil:"^4.0.1",debug:"^2.2.0","es5-ext":"^0.10.50","typedarray-to-buffer":"^3.1.5","utf-8-validate":"^5.0.2",yaeti:"^0.0.6"},Yye={"buffer-equal":"^1.0.0",gulp:"^4.0.2","gulp-jshint":"^2.0.4","jshint-stylish":"^2.2.1",jshint:"^2.0.0",tape:"^4.9.1"},Kye={verbose:!1},qye={test:"tape test/unit/*.js",gulp:"gulp"},Xye="index",Zye={lib:"./lib"},Jye="lib/browser.js",Qye="Apache-2.0",ege={name:Nye,description:Bye,keywords:jye,author:zye,contributors:Fye,version:Hye,repository:Vye,homepage:Uye,engines:Wye,dependencies:Gye,devDependencies:Yye,config:Kye,scripts:qye,main:Xye,directories:Zye,browser:Jye,license:Qye};var tge=ege.version,Ld;if(typeof globalThis=="object")Ld=globalThis;else try{Ld=Lye()}catch{}finally{if(!Ld&&typeof window<"u"&&(Ld=window),!Ld)throw new Error("Could not determine global this")}var vS=Ld.WebSocket||Ld.MozWebSocket,rge=tge;function ire(e,t){var r;return t?r=new vS(e,t):r=new vS(e),r}vS&&["CONNECTING","OPEN","CLOSING","CLOSED"].forEach(function(e){Object.defineProperty(ire,e,{get:function(){return vS[e]}})});var nge={w3cwebsocket:vS?ire:null,version:rge};const ige="2.7.2",oge={"X-Client-Info":`realtime-js/${ige}`},age="1.0.0",ore=1e4,sge=1e3;var L0;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(L0||(L0={}));var Ja;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(Ja||(Ja={}));var sl;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(sl||(sl={}));var DL;(function(e){e.websocket="websocket"})(DL||(DL={}));var Nd;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(Nd||(Nd={}));class are{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}class lge{constructor(){this.HEADER_LENGTH=1}decode(t,r){return t.constructor===ArrayBuffer?r(this._binaryDecode(t)):r(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const r=new DataView(t),n=new TextDecoder;return this._decodeBroadcast(t,r,n)}_decodeBroadcast(t,r,n){const i=r.getUint8(1),o=r.getUint8(2);let s=this.HEADER_LENGTH+2;const a=n.decode(t.slice(s,s+i));s=s+i;const h=n.decode(t.slice(s,s+o));s=s+o;const p=JSON.parse(n.decode(t.slice(s,t.byteLength)));return{ref:null,topic:a,event:h,payload:p}}}class rD{constructor(t,r,n={},i=ore){this.channel=t,this.event=r,this.payload=n,this.timeout=i,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null,this.rateLimited=!1}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){if(this._hasReceived("timeout"))return;this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()})==="rate limited"&&(this.rateLimited=!0)}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var n;return this._hasReceived(t)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var bG;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(bG||(bG={}));class N0{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},i=>{const{onJoin:o,onLeave:s,onSync:a}=this.caller;this.joinRef=this.channel._joinRef(),this.state=N0.syncState(this.state,i,o,s),this.pendingDiffs.forEach(h=>{this.state=N0.syncDiff(this.state,h,o,s)}),this.pendingDiffs=[],a()}),this.channel._on(n.diff,{},i=>{const{onJoin:o,onLeave:s,onSync:a}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(i):(this.state=N0.syncDiff(this.state,i,o,s),a())}),this.onJoin((i,o,s)=>{this.channel._trigger("presence",{event:"join",key:i,currentPresences:o,newPresences:s})}),this.onLeave((i,o,s)=>{this.channel._trigger("presence",{event:"leave",key:i,currentPresences:o,leftPresences:s})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,n,i){const o=this.cloneDeep(t),s=this.transformState(r),a={},h={};return this.map(o,(p,g)=>{s[p]||(h[p]=g)}),this.map(s,(p,g)=>{const S=o[p];if(S){const T=g.map(j=>j.presence_ref),R=S.map(j=>j.presence_ref),A=g.filter(j=>R.indexOf(j.presence_ref)<0),$=S.filter(j=>T.indexOf(j.presence_ref)<0);A.length>0&&(a[p]=A),$.length>0&&(h[p]=$)}else a[p]=g}),this.syncDiff(o,{joins:a,leaves:h},n,i)}static syncDiff(t,r,n,i){const{joins:o,leaves:s}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),i||(i=()=>{}),this.map(o,(a,h)=>{var p;const g=(p=t[a])!==null&&p!==void 0?p:[];if(t[a]=this.cloneDeep(h),g.length>0){const S=t[a].map(R=>R.presence_ref),T=g.filter(R=>S.indexOf(R.presence_ref)<0);t[a].unshift(...T)}n(a,g,h)}),this.map(s,(a,h)=>{let p=t[a];if(!p)return;const g=h.map(S=>S.presence_ref);p=p.filter(S=>g.indexOf(S.presence_ref)<0),t[a]=p,i(a,p,h),p.length===0&&delete t[a]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(n=>r(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,n)=>{const i=t[n];return"metas"in i?r[n]=i.metas.map(o=>(o.presence_ref=o.phx_ref,delete o.phx_ref,delete o.phx_ref_prev,o)):r[n]=i,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var ui;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(ui||(ui={}));const wG=(e,t,r={})=>{var n;const i=(n=r.skipTypes)!==null&&n!==void 0?n:[];return Object.keys(t).reduce((o,s)=>(o[s]=uge(s,e,t,i),o),{})},uge=(e,t,r,n)=>{const i=t.find(a=>a.name===e),o=i==null?void 0:i.type,s=r[e];return o&&!n.includes(o)?sre(o,s):$L(s)},sre=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return dge(t,r)}switch(e){case ui.bool:return cge(t);case ui.float4:case ui.float8:case ui.int2:case ui.int4:case ui.int8:case ui.numeric:case ui.oid:return fge(t);case ui.json:case ui.jsonb:return hge(t);case ui.timestamp:return pge(t);case ui.abstime:case ui.date:case ui.daterange:case ui.int4range:case ui.int8range:case ui.money:case ui.reltime:case ui.text:case ui.time:case ui.timestamptz:case ui.timetz:case ui.tsrange:case ui.tstzrange:return $L(t);default:return $L(t)}},$L=e=>e,cge=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},fge=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},hge=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},dge=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,n=e[r];if(e[0]==="{"&&n==="}"){let o;const s=e.slice(1,r);try{o=JSON.parse("["+s+"]")}catch{o=s?s.split(","):[]}return o.map(a=>sre(t,a))}return e},pge=e=>typeof e=="string"?e.replace(" ","T"):e;var SG=globalThis&&globalThis.__awaiter||function(e,t,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(g){try{p(n.next(g))}catch(S){s(S)}}function h(g){try{p(n.throw(g))}catch(S){s(S)}}function p(g){g.done?o(g.value):i(g.value).then(a,h)}p((n=n.apply(e,t||[])).next())})},xG;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(xG||(xG={}));var CG;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes"})(CG||(CG={}));var EG;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(EG||(EG={}));class IF{constructor(t,r={config:{}},n){this.topic=t,this.params=r,this.socket=n,this.bindings={},this.state=Ja.closed,this.joinedOnce=!1,this.pushBuffer=[],this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""}},r.config),this.timeout=this.socket.timeout,this.joinPush=new rD(this,sl.join,this.params,this.timeout),this.rejoinTimer=new are(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Ja.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(i=>i.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Ja.closed,this.socket._remove(this)}),this._onError(i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=Ja.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Ja.errored,this.rejoinTimer.scheduleTimeout())}),this._on(sl.reply,{},(i,o)=>{this._trigger(this._replyEventName(o),i)}),this.presence=new N0(this)}subscribe(t,r=this.timeout){var n,i;if(this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:o,presence:s}}=this.params;this._onError(p=>t&&t("CHANNEL_ERROR",p)),this._onClose(()=>t&&t("CLOSED"));const a={},h={broadcast:o,presence:s,postgres_changes:(i=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(p=>p.filter))!==null&&i!==void 0?i:[]};this.socket.accessToken&&(a.access_token=this.socket.accessToken),this.updateJoinPayload(Object.assign({config:h},a)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",({postgres_changes:p})=>{var g;if(this.socket.accessToken&&this.socket.setAuth(this.socket.accessToken),p===void 0){t&&t("SUBSCRIBED");return}else{const S=this.bindings.postgres_changes,T=(g=S==null?void 0:S.length)!==null&&g!==void 0?g:0,R=[];for(let A=0;A<T;A++){const $=S[A],{filter:{event:j,schema:z,table:V,filter:G}}=$,ee=p&&p[A];if(ee&&ee.event===j&&ee.schema===z&&ee.table===V&&ee.filter===G)R.push(Object.assign(Object.assign({},$),{id:ee.id}));else{this.unsubscribe(),t&&t("CHANNEL_ERROR",new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=R,t&&t("SUBSCRIBED");return}}).receive("error",p=>{t&&t("CHANNEL_ERROR",new Error(JSON.stringify(Object.values(p).join(", ")||"error")))}).receive("timeout",()=>{t&&t("TIMED_OUT")})}return this}presenceState(){return this.presence.state}track(t,r={}){return SG(this,void 0,void 0,function*(){return yield this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)})}untrack(t={}){return SG(this,void 0,void 0,function*(){return yield this.send({type:"presence",event:"untrack"},t)})}on(t,r,n){return this._on(t,r,n)}send(t,r={}){return new Promise(n=>{var i,o,s;const a=this._push(t.type,t,r.timeout||this.timeout);a.rateLimited&&n("rate limited"),t.type==="broadcast"&&!(!((s=(o=(i=this.params)===null||i===void 0?void 0:i.config)===null||o===void 0?void 0:o.broadcast)===null||s===void 0)&&s.ack)&&n("ok"),a.receive("ok",()=>n("ok")),a.receive("timeout",()=>n("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=Ja.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(sl.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise(n=>{const i=new rD(this,sl.leave,{},t);i.receive("ok",()=>{r(),n("ok")}).receive("timeout",()=>{r(),n("timed out")}).receive("error",()=>{n("error")}),i.send(),this._canPush()||i.trigger("ok",{})})}_push(t,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let i=new rD(this,t,r,n);return this._canPush()?i.send():(i.startTimeout(),this.pushBuffer.push(i)),i}_onMessage(t,r,n){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,n){var i,o;const s=t.toLocaleLowerCase(),{close:a,error:h,leave:p,join:g}=sl;if(n&&[a,h,p,g].indexOf(s)>=0&&n!==this._joinRef())return;let T=this._onMessage(s,r,n);if(r&&!T)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(s)?(i=this.bindings.postgres_changes)===null||i===void 0||i.filter(R=>{var A,$,j;return((A=R.filter)===null||A===void 0?void 0:A.event)==="*"||((j=($=R.filter)===null||$===void 0?void 0:$.event)===null||j===void 0?void 0:j.toLocaleLowerCase())===s}).map(R=>R.callback(T,n)):(o=this.bindings[s])===null||o===void 0||o.filter(R=>{var A,$,j,z,V,G;if(["broadcast","presence","postgres_changes"].includes(s))if("id"in R){const ee=R.id,K=(A=R.filter)===null||A===void 0?void 0:A.event;return ee&&(($=r.ids)===null||$===void 0?void 0:$.includes(ee))&&(K==="*"||(K==null?void 0:K.toLocaleLowerCase())===((j=r.data)===null||j===void 0?void 0:j.type.toLocaleLowerCase()))}else{const ee=(V=(z=R==null?void 0:R.filter)===null||z===void 0?void 0:z.event)===null||V===void 0?void 0:V.toLocaleLowerCase();return ee==="*"||ee===((G=r==null?void 0:r.event)===null||G===void 0?void 0:G.toLocaleLowerCase())}else return R.type.toLocaleLowerCase()===s}).map(R=>{if(typeof T=="object"&&"ids"in T){const A=T.data,{schema:$,table:j,commit_timestamp:z,type:V,errors:G}=A;T=Object.assign(Object.assign({},{schema:$,table:j,commit_timestamp:z,eventType:V,new:{},old:{},errors:G}),this._getPayloadRecords(A))}R.callback(T,n)})}_isClosed(){return this.state===Ja.closed}_isJoined(){return this.state===Ja.joined}_isJoining(){return this.state===Ja.joining}_isLeaving(){return this.state===Ja.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,n){const i=t.toLocaleLowerCase(),o={type:i,filter:r,callback:n};return this.bindings[i]?this.bindings[i].push(o):this.bindings[i]=[o],this}_off(t,r){const n=t.toLocaleLowerCase();return this.bindings[n]=this.bindings[n].filter(i=>{var o;return!(((o=i.type)===null||o===void 0?void 0:o.toLocaleLowerCase())===n&&IF.isEqual(i.filter,r))}),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(t[n]!==r[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(sl.close,{},t)}_onError(t){this._on(sl.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Ja.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=wG(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=wG(t.columns,t.old_record)),r}}var nD=globalThis&&globalThis.__awaiter||function(e,t,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(g){try{p(n.next(g))}catch(S){s(S)}}function h(g){try{p(n.throw(g))}catch(S){s(S)}}function p(g){g.done?o(g.value):i(g.value).then(a,h)}p((n=n.apply(e,t||[])).next())})};const mge=()=>{};class yge{constructor(t,r){var n;this.accessToken=null,this.channels=[],this.endPoint="",this.headers=oge,this.params={},this.timeout=ore,this.transport=nge.w3cwebsocket,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=mge,this.conn=null,this.sendBuffer=[],this.serializer=new lge,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.eventsPerSecondLimitMs=100,this.inThrottle=!1,this.endPoint=`${t}/${DL.websocket}`,r!=null&&r.params&&(this.params=r.params),r!=null&&r.headers&&(this.headers=Object.assign(Object.assign({},this.headers),r.headers)),r!=null&&r.timeout&&(this.timeout=r.timeout),r!=null&&r.logger&&(this.logger=r.logger),r!=null&&r.transport&&(this.transport=r.transport),r!=null&&r.heartbeatIntervalMs&&(this.heartbeatIntervalMs=r.heartbeatIntervalMs);const i=(n=r==null?void 0:r.params)===null||n===void 0?void 0:n.eventsPerSecond;i&&(this.eventsPerSecondLimitMs=Math.floor(1e3/i)),this.reconnectAfterMs=r!=null&&r.reconnectAfterMs?r.reconnectAfterMs:o=>[1e3,2e3,5e3,1e4][o-1]||1e4,this.encode=r!=null&&r.encode?r.encode:(o,s)=>s(JSON.stringify(o)),this.decode=r!=null&&r.decode?r.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new are(()=>nD(this,void 0,void 0,function*(){this.disconnect(),this.connect()}),this.reconnectAfterMs)}connect(){this.conn||(this.conn=new this.transport(this._endPointURL(),[],null,this.headers),this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t)))}disconnect(t,r){this.conn&&(this.conn.onclose=function(){},t?this.conn.close(t,r??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}removeChannel(t){return nD(this,void 0,void 0,function*(){const r=yield t.unsubscribe();return this.channels.length===0&&this.disconnect(),r})}removeAllChannels(){return nD(this,void 0,void 0,function*(){const t=yield Promise.all(this.channels.map(r=>r.unsubscribe()));return this.disconnect(),t})}log(t,r,n){this.logger(t,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case L0.connecting:return Nd.Connecting;case L0.open:return Nd.Open;case L0.closing:return Nd.Closing;default:return Nd.Closed}}isConnected(){return this.connectionState()===Nd.Open}channel(t,r={config:{}}){this.isConnected()||this.connect();const n=new IF(`realtime:${t}`,r,this);return this.channels.push(n),n}push(t){const{topic:r,event:n,payload:i,ref:o}=t;let s=()=>{this.encode(t,a=>{var h;(h=this.conn)===null||h===void 0||h.send(a)})};if(this.log("push",`${r} ${n} (${o})`,i),this.isConnected())if(["broadcast","presence","postgres_changes"].includes(n)){if(this._throttle(s)())return"rate limited"}else s();else this.sendBuffer.push(s)}setAuth(t){this.accessToken=t,this.channels.forEach(r=>{t&&r.updateJoinPayload({access_token:t}),r.joinedOnce&&r._isJoined()&&r._push(sl.access_token,{access_token:t})})}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r._joinRef()!==t._joinRef())}_endPointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:age}))}_onConnMessage(t){this.decode(t.data,r=>{let{topic:n,event:i,payload:o,ref:s}=r;(s&&s===this.pendingHeartbeatRef||i===(o==null?void 0:o.type))&&(this.pendingHeartbeatRef=null),this.log("receive",`${o.status||""} ${n} ${i} ${s&&"("+s+")"||""}`,o),this.channels.filter(a=>a._isMember(n)).forEach(a=>a._trigger(i,o,s)),this.stateChangeCallbacks.message.forEach(a=>a(r))})}_onConnOpen(){this.log("transport",`connected to ${this._endPointURL()}`),this._flushSendBuffer(),this.reconnectTimer.reset(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this._sendHeartbeat(),this.heartbeatIntervalMs),this.stateChangeCallbacks.open.forEach(t=>t())}_onConnClose(t){this.log("transport","close",t),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(r=>r(t))}_onConnError(t){this.log("transport",t.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(r=>r(t))}_triggerChanError(){this.channels.forEach(t=>t._trigger(sl.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const n=t.match(/\?/)?"&":"?",i=new URLSearchParams(r);return`${t}${n}${i}`}_flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_sendHeartbeat(){var t;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),(t=this.conn)===null||t===void 0||t.close(sge,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth(this.accessToken)}}_throttle(t,r=this.eventsPerSecondLimitMs){return()=>this.inThrottle?!0:(t(),r>0&&(this.inThrottle=!0,setTimeout(()=>{this.inThrottle=!1},r)),!1)}}class MF extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function Xo(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class gge extends MF{constructor(t,r){super(t),this.name="StorageApiError",this.status=r}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class TG extends MF{constructor(t,r){super(t),this.name="StorageUnknownError",this.originalError=r}}var lre=globalThis&&globalThis.__awaiter||function(e,t,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(g){try{p(n.next(g))}catch(S){s(S)}}function h(g){try{p(n.throw(g))}catch(S){s(S)}}function p(g){g.done?o(g.value):i(g.value).then(a,h)}p((n=n.apply(e,t||[])).next())})};const ure=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>lre(void 0,void 0,void 0,function*(){return yield(yield WP(()=>Promise.resolve().then(()=>GP),void 0)).fetch(...r)}):t=fetch,(...r)=>t(...r)},vge=()=>lre(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield WP(()=>Promise.resolve().then(()=>GP),void 0)).Response:Response});var K_=globalThis&&globalThis.__awaiter||function(e,t,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(g){try{p(n.next(g))}catch(S){s(S)}}function h(g){try{p(n.throw(g))}catch(S){s(S)}}function p(g){g.done?o(g.value):i(g.value).then(a,h)}p((n=n.apply(e,t||[])).next())})};const iD=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),_ge=(e,t)=>K_(void 0,void 0,void 0,function*(){const r=yield vge();e instanceof r?e.json().then(n=>{t(new gge(iD(n),e.status||500))}).catch(n=>{t(new TG(iD(n),n))}):t(new TG(iD(e),e))}),bge=(e,t,r,n)=>{const i={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),i.body=JSON.stringify(n),Object.assign(Object.assign({},i),r))};function YP(e,t,r,n,i,o){return K_(this,void 0,void 0,function*(){return new Promise((s,a)=>{e(r,bge(t,n,i,o)).then(h=>{if(!h.ok)throw h;return n!=null&&n.noResolveJson?h:h.json()}).then(h=>s(h)).catch(h=>_ge(h,a))})})}function LL(e,t,r,n){return K_(this,void 0,void 0,function*(){return YP(e,"GET",t,r,n)})}function If(e,t,r,n,i){return K_(this,void 0,void 0,function*(){return YP(e,"POST",t,n,i,r)})}function wge(e,t,r,n,i){return K_(this,void 0,void 0,function*(){return YP(e,"PUT",t,n,i,r)})}function cre(e,t,r,n,i){return K_(this,void 0,void 0,function*(){return YP(e,"DELETE",t,n,i,r)})}var ws=globalThis&&globalThis.__awaiter||function(e,t,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(g){try{p(n.next(g))}catch(S){s(S)}}function h(g){try{p(n.throw(g))}catch(S){s(S)}}function p(g){g.done?o(g.value):i(g.value).then(a,h)}p((n=n.apply(e,t||[])).next())})};const Sge={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},OG={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class xge{constructor(t,r={},n,i){this.url=t,this.headers=r,this.bucketId=n,this.fetch=ure(i)}uploadOrUpdate(t,r,n,i){return ws(this,void 0,void 0,function*(){try{let o;const s=Object.assign(Object.assign({},OG),i),a=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(s.upsert)});typeof Blob<"u"&&n instanceof Blob?(o=new FormData,o.append("cacheControl",s.cacheControl),o.append("",n)):typeof FormData<"u"&&n instanceof FormData?(o=n,o.append("cacheControl",s.cacheControl)):(o=n,a["cache-control"]=`max-age=${s.cacheControl}`,a["content-type"]=s.contentType);const h=this._removeEmptyFolders(r),p=this._getFinalPath(h),g=yield this.fetch(`${this.url}/object/${p}`,Object.assign({method:t,body:o,headers:a},s!=null&&s.duplex?{duplex:s.duplex}:{}));return g.ok?{data:{path:h},error:null}:{data:null,error:yield g.json()}}catch(o){if(Xo(o))return{data:null,error:o};throw o}})}upload(t,r,n){return ws(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,r,n)})}uploadToSignedUrl(t,r,n,i){return ws(this,void 0,void 0,function*(){const o=this._removeEmptyFolders(t),s=this._getFinalPath(o),a=new URL(this.url+`/object/upload/sign/${s}`);a.searchParams.set("token",r);try{let h;const p=Object.assign({upsert:OG.upsert},i),g=Object.assign(Object.assign({},this.headers),{"x-upsert":String(p.upsert)});typeof Blob<"u"&&n instanceof Blob?(h=new FormData,h.append("cacheControl",p.cacheControl),h.append("",n)):typeof FormData<"u"&&n instanceof FormData?(h=n,h.append("cacheControl",p.cacheControl)):(h=n,g["cache-control"]=`max-age=${p.cacheControl}`,g["content-type"]=p.contentType);const S=yield this.fetch(a.toString(),{method:"PUT",body:h,headers:g});return S.ok?{data:{path:o},error:null}:{data:null,error:yield S.json()}}catch(h){if(Xo(h))return{data:null,error:h};throw h}})}createSignedUploadUrl(t){return ws(this,void 0,void 0,function*(){try{let r=this._getFinalPath(t);const n=yield If(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:this.headers}),i=new URL(this.url+n.url),o=i.searchParams.get("token");if(!o)throw new MF("No token returned by API");return{data:{signedUrl:i.toString(),path:t,token:o},error:null}}catch(r){if(Xo(r))return{data:null,error:r};throw r}})}update(t,r,n){return ws(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,r,n)})}move(t,r){return ws(this,void 0,void 0,function*(){try{return{data:yield If(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r},{headers:this.headers}),error:null}}catch(n){if(Xo(n))return{data:null,error:n};throw n}})}copy(t,r){return ws(this,void 0,void 0,function*(){try{return{data:{path:(yield If(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r},{headers:this.headers})).Key},error:null}}catch(n){if(Xo(n))return{data:null,error:n};throw n}})}createSignedUrl(t,r,n){return ws(this,void 0,void 0,function*(){try{let i=this._getFinalPath(t),o=yield If(this.fetch,`${this.url}/object/sign/${i}`,Object.assign({expiresIn:r},n!=null&&n.transform?{transform:n.transform}:{}),{headers:this.headers});const s=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return o={signedUrl:encodeURI(`${this.url}${o.signedURL}${s}`)},{data:o,error:null}}catch(i){if(Xo(i))return{data:null,error:i};throw i}})}createSignedUrls(t,r,n){return ws(this,void 0,void 0,function*(){try{const i=yield If(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:t},{headers:this.headers}),o=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:i.map(s=>Object.assign(Object.assign({},s),{signedUrl:s.signedURL?encodeURI(`${this.url}${s.signedURL}${o}`):null})),error:null}}catch(i){if(Xo(i))return{data:null,error:i};throw i}})}download(t,r){return ws(this,void 0,void 0,function*(){const i=typeof(r==null?void 0:r.transform)<"u"?"render/image/authenticated":"object",o=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),s=o?`?${o}`:"";try{const a=this._getFinalPath(t);return{data:yield(yield LL(this.fetch,`${this.url}/${i}/${a}${s}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(a){if(Xo(a))return{data:null,error:a};throw a}})}getPublicUrl(t,r){const n=this._getFinalPath(t),i=[],o=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";o!==""&&i.push(o);const a=typeof(r==null?void 0:r.transform)<"u"?"render/image":"object",h=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});h!==""&&i.push(h);let p=i.join("&");return p!==""&&(p=`?${p}`),{data:{publicUrl:encodeURI(`${this.url}/${a}/public/${n}${p}`)}}}remove(t){return ws(this,void 0,void 0,function*(){try{return{data:yield cre(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(r){if(Xo(r))return{data:null,error:r};throw r}})}list(t,r,n){return ws(this,void 0,void 0,function*(){try{const i=Object.assign(Object.assign(Object.assign({},Sge),r),{prefix:t||""});return{data:yield If(this.fetch,`${this.url}/object/list/${this.bucketId}`,i,{headers:this.headers},n),error:null}}catch(i){if(Xo(i))return{data:null,error:i};throw i}})}_getFinalPath(t){return`${this.bucketId}/${t}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const r=[];return t.width&&r.push(`width=${t.width}`),t.height&&r.push(`height=${t.height}`),t.resize&&r.push(`resize=${t.resize}`),t.format&&r.push(`format=${t.format}`),t.quality&&r.push(`quality=${t.quality}`),r.join("&")}}const Cge="2.5.1",Ege={"X-Client-Info":`storage-js/${Cge}`};var ly=globalThis&&globalThis.__awaiter||function(e,t,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(g){try{p(n.next(g))}catch(S){s(S)}}function h(g){try{p(n.throw(g))}catch(S){s(S)}}function p(g){g.done?o(g.value):i(g.value).then(a,h)}p((n=n.apply(e,t||[])).next())})};class Tge{constructor(t,r={},n){this.url=t,this.headers=Object.assign(Object.assign({},Ege),r),this.fetch=ure(n)}listBuckets(){return ly(this,void 0,void 0,function*(){try{return{data:yield LL(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(Xo(t))return{data:null,error:t};throw t}})}getBucket(t){return ly(this,void 0,void 0,function*(){try{return{data:yield LL(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(r){if(Xo(r))return{data:null,error:r};throw r}})}createBucket(t,r={public:!1}){return ly(this,void 0,void 0,function*(){try{return{data:yield If(this.fetch,`${this.url}/bucket`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(Xo(n))return{data:null,error:n};throw n}})}updateBucket(t,r){return ly(this,void 0,void 0,function*(){try{return{data:yield wge(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(Xo(n))return{data:null,error:n};throw n}})}emptyBucket(t){return ly(this,void 0,void 0,function*(){try{return{data:yield If(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(Xo(r))return{data:null,error:r};throw r}})}deleteBucket(t){return ly(this,void 0,void 0,function*(){try{return{data:yield cre(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(Xo(r))return{data:null,error:r};throw r}})}}class Oge extends Tge{constructor(t,r={},n){super(t,r,n)}from(t){return new xge(this.url,this.headers,t,this.fetch)}}const Rge="2.22.0",kge={"X-Client-Info":`supabase-js/${Rge}`};var Pge=globalThis&&globalThis.__awaiter||function(e,t,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(g){try{p(n.next(g))}catch(S){s(S)}}function h(g){try{p(n.throw(g))}catch(S){s(S)}}function p(g){g.done?o(g.value):i(g.value).then(a,h)}p((n=n.apply(e,t||[])).next())})};const Age=e=>{let t;return e?t=e:typeof fetch>"u"?t=AF:t=fetch,(...r)=>t(...r)},Ige=()=>typeof Headers>"u"?PF.Headers:Headers,Mge=(e,t,r)=>{const n=Age(r),i=Ige();return(o,s)=>Pge(void 0,void 0,void 0,function*(){var a;const h=(a=yield t())!==null&&a!==void 0?a:e;let p=new i(s==null?void 0:s.headers);return p.has("apikey")||p.set("apikey",e),p.has("Authorization")||p.set("Authorization",`Bearer ${h}`),n(o,Object.assign(Object.assign({},s),{headers:p}))})};function Dge(e){return e.replace(/\/$/,"")}function $ge(e,t){const{db:r,auth:n,realtime:i,global:o}=e,{db:s,auth:a,realtime:h,global:p}=t;return{db:Object.assign(Object.assign({},s),r),auth:Object.assign(Object.assign({},a),n),realtime:Object.assign(Object.assign({},h),i),global:Object.assign(Object.assign({},p),o)}}var Yp=globalThis&&globalThis.__awaiter||function(e,t,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(g){try{p(n.next(g))}catch(S){s(S)}}function h(g){try{p(n.throw(g))}catch(S){s(S)}}function p(g){g.done?o(g.value):i(g.value).then(a,h)}p((n=n.apply(e,t||[])).next())})};function Lge(e){return Math.round(Date.now()/1e3)+e}function Nge(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0;return(e=="x"?t:t&3|8).toString(16)})}const Rf=()=>typeof document<"u",md={tested:!1,writable:!1},oD=()=>{if(!Rf())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(md.tested)return md.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),md.tested=!0,md.writable=!0}catch{md.tested=!0,md.writable=!1}return md.writable};function Pa(e,t){var r;t||(t=((r=window==null?void 0:window.location)===null||r===void 0?void 0:r.href)||""),e=e.replace(/[\[\]]/g,"\\$&");const n=new RegExp("[?&#]"+e+"(=([^&#]*)|&|#|$)"),i=n.exec(t);return i?i[2]?decodeURIComponent(i[2].replace(/\+/g," ")):"":null}const fre=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>Yp(void 0,void 0,void 0,function*(){return yield(yield WP(()=>Promise.resolve().then(()=>GP),void 0)).fetch(...r)}):t=fetch,(...r)=>t(...r)},Bge=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",jw=(e,t,r)=>Yp(void 0,void 0,void 0,function*(){yield e.setItem(t,JSON.stringify(r))}),ET=(e,t)=>Yp(void 0,void 0,void 0,function*(){const r=yield e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}}),aD=(e,t)=>Yp(void 0,void 0,void 0,function*(){yield e.removeItem(t)});function jge(e){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let r="",n,i,o,s,a,h,p,g=0;for(e=e.replace("-","+").replace("_","/");g<e.length;)s=t.indexOf(e.charAt(g++)),a=t.indexOf(e.charAt(g++)),h=t.indexOf(e.charAt(g++)),p=t.indexOf(e.charAt(g++)),n=s<<2|a>>4,i=(a&15)<<4|h>>2,o=(h&3)<<6|p,r=r+String.fromCharCode(n),h!=64&&i!=0&&(r=r+String.fromCharCode(i)),p!=64&&o!=0&&(r=r+String.fromCharCode(o));return r}class KP{constructor(){this.promise=new KP.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}KP.promiseConstructor=Promise;function RG(e){const t=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}=?$|[a-z0-9_-]{2}(==)?$)$/i,r=e.split(".");if(r.length!==3)throw new Error("JWT is not valid: not a JWT structure");if(!t.test(r[1]))throw new Error("JWT is not valid: payload is not in base64url format");const n=r[1];return JSON.parse(jge(n))}function zge(e){return new Promise(t=>{setTimeout(()=>t(null),e)})}function Fge(e,t){return new Promise((n,i)=>{Yp(this,void 0,void 0,function*(){for(let o=0;o<1/0;o++)try{const s=yield e(o);if(!t(o,null,s)){n(s);return}}catch(s){if(!t(o,s)){i(s);return}}})})}function Hge(e){return("0"+e.toString(16)).substr(-2)}function TT(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let i="";for(let o=0;o<56;o++)i+=r.charAt(Math.floor(Math.random()*n));return i}return crypto.getRandomValues(t),Array.from(t,Hge).join("")}function Vge(e){return Yp(this,void 0,void 0,function*(){const r=new TextEncoder().encode(e),n=yield crypto.subtle.digest("SHA-256",r),i=new Uint8Array(n);return Array.from(i).map(o=>String.fromCharCode(o)).join("")})}function Uge(e){return btoa(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}function OT(e){return Yp(this,void 0,void 0,function*(){if(typeof crypto>"u")return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const t=yield Vge(e);return Uge(t)})}class DF extends Error{constructor(t,r){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r}}function Nn(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class Wge extends DF{constructor(t,r){super(t,r),this.name="AuthApiError",this.status=r}toJSON(){return{name:this.name,message:this.message,status:this.status}}}function Gge(e){return Nn(e)&&e.name==="AuthApiError"}class hre extends DF{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class $x extends DF{constructor(t,r,n){super(t),this.name=r,this.status=n}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class uy extends $x{constructor(){super("Auth session missing!","AuthSessionMissingError",400)}}class RT extends $x{constructor(t){super(t,"AuthInvalidCredentialsError",400)}}class Au extends $x{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class sD extends $x{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class NL extends $x{constructor(t,r){super(t,"AuthRetryableFetchError",r)}}var $F=globalThis&&globalThis.__awaiter||function(e,t,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(g){try{p(n.next(g))}catch(S){s(S)}}function h(g){try{p(n.throw(g))}catch(S){s(S)}}function p(g){g.done?o(g.value):i(g.value).then(a,h)}p((n=n.apply(e,t||[])).next())})},Yge=globalThis&&globalThis.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r};const kT=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),Kge=(e,t)=>$F(void 0,void 0,void 0,function*(){const r=[502,503,504];Bge(e)?r.includes(e.status)?t(new NL(kT(e),e.status)):e.json().then(n=>{t(new Wge(kT(n),e.status||500))}).catch(n=>{t(new hre(kT(n),n))}):t(new NL(kT(e),0))}),qge=(e,t,r,n)=>{const i={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),i.body=JSON.stringify(n),Object.assign(Object.assign({},i),r))};function Un(e,t,r,n){var i;return $F(this,void 0,void 0,function*(){const o=Object.assign({},n==null?void 0:n.headers);n!=null&&n.jwt&&(o.Authorization=`Bearer ${n.jwt}`);const s=(i=n==null?void 0:n.query)!==null&&i!==void 0?i:{};n!=null&&n.redirectTo&&(s.redirect_to=n.redirectTo);const a=Object.keys(s).length?"?"+new URLSearchParams(s).toString():"",h=yield Xge(e,t,r+a,{headers:o,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(h):{data:Object.assign({},h),error:null}})}function Xge(e,t,r,n,i,o){return $F(this,void 0,void 0,function*(){return new Promise((s,a)=>{e(r,qge(t,n,i,o)).then(h=>{if(!h.ok)throw h;return n!=null&&n.noResolveJson?h:h.json()}).then(h=>s(h)).catch(h=>Kge(h,a))})})}function _f(e){var t;let r=null;eve(e)&&(r=Object.assign({},e),r.expires_at=Lge(e.expires_in));const n=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:n},error:null}}function Bd(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function Zge(e){return{data:e,error:null}}function Jge(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:i,verification_type:o}=e,s=Yge(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),a={action_link:t,email_otp:r,hashed_token:n,redirect_to:i,verification_type:o},h=Object.assign({},s);return{data:{properties:a,user:h},error:null}}function Qge(e){return e}function eve(e){return e.access_token&&e.refresh_token&&e.expires_in}var jl=globalThis&&globalThis.__awaiter||function(e,t,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(g){try{p(n.next(g))}catch(S){s(S)}}function h(g){try{p(n.throw(g))}catch(S){s(S)}}function p(g){g.done?o(g.value):i(g.value).then(a,h)}p((n=n.apply(e,t||[])).next())})},tve=globalThis&&globalThis.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r};class rve{constructor({url:t="",headers:r={},fetch:n}){this.url=t,this.headers=r,this.fetch=fre(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}signOut(t){return jl(this,void 0,void 0,function*(){try{return yield Un(this.fetch,"POST",`${this.url}/logout`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(r){if(Nn(r))return{data:null,error:r};throw r}})}inviteUserByEmail(t,r={}){return jl(this,void 0,void 0,function*(){try{return yield Un(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:Bd})}catch(n){if(Nn(n))return{data:{user:null},error:n};throw n}})}generateLink(t){return jl(this,void 0,void 0,function*(){try{const{options:r}=t,n=tve(t,["options"]),i=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(i.new_email=n==null?void 0:n.newEmail,delete i.newEmail),yield Un(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:i,headers:this.headers,xform:Jge,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(Nn(r))return{data:{properties:null,user:null},error:r};throw r}})}createUser(t){return jl(this,void 0,void 0,function*(){try{return yield Un(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:Bd})}catch(r){if(Nn(r))return{data:{user:null},error:r};throw r}})}listUsers(t){var r,n,i,o,s,a,h;return jl(this,void 0,void 0,function*(){try{const p={nextPage:null,lastPage:0,total:0},g=yield Un(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(o=(i=t==null?void 0:t.perPage)===null||i===void 0?void 0:i.toString())!==null&&o!==void 0?o:""},xform:Qge});if(g.error)throw g.error;const S=yield g.json(),T=(s=g.headers.get("x-total-count"))!==null&&s!==void 0?s:0,R=(h=(a=g.headers.get("link"))===null||a===void 0?void 0:a.split(","))!==null&&h!==void 0?h:[];return R.length>0&&(R.forEach(A=>{const $=parseInt(A.split(";")[0].split("=")[1].substring(0,1)),j=JSON.parse(A.split(";")[1].split("=")[1]);p[`${j}Page`]=$}),p.total=parseInt(T)),{data:Object.assign(Object.assign({},S),p),error:null}}catch(p){if(Nn(p))return{data:{users:[]},error:p};throw p}})}getUserById(t){return jl(this,void 0,void 0,function*(){try{return yield Un(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:Bd})}catch(r){if(Nn(r))return{data:{user:null},error:r};throw r}})}updateUserById(t,r){return jl(this,void 0,void 0,function*(){try{return yield Un(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:Bd})}catch(n){if(Nn(n))return{data:{user:null},error:n};throw n}})}deleteUser(t,r=!1){return jl(this,void 0,void 0,function*(){try{return yield Un(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:Bd})}catch(n){if(Nn(n))return{data:{user:null},error:n};throw n}})}_listFactors(t){return jl(this,void 0,void 0,function*(){try{const{data:r,error:n}=yield Un(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:i=>({data:{factors:i},error:null})});return{data:r,error:n}}catch(r){if(Nn(r))return{data:null,error:r};throw r}})}_deleteFactor(t){return jl(this,void 0,void 0,function*(){try{return{data:yield Un(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(Nn(r))return{data:null,error:r};throw r}})}}const nve="2.27.2",ive="http://localhost:9999",ove="supabase.auth.token",ave={"X-Client-Info":`gotrue-js/${nve}`},sve=10,lve={getItem:e=>oD()?globalThis.localStorage.getItem(e):null,setItem:(e,t)=>{oD()&&globalThis.localStorage.setItem(e,t)},removeItem:e=>{oD()&&globalThis.localStorage.removeItem(e)}};function uve(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}var Qr=globalThis&&globalThis.__awaiter||function(e,t,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(g){try{p(n.next(g))}catch(S){s(S)}}function h(g){try{p(n.throw(g))}catch(S){s(S)}}function p(g){g.done?o(g.value):i(g.value).then(a,h)}p((n=n.apply(e,t||[])).next())})};uve();const cve={url:ive,storageKey:ove,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:ave,flowType:"implicit"},lD=30*1e3,fve=3;class hve{constructor(t){var r;this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.broadcastChannel=null;const n=Object.assign(Object.assign({},cve),t);if(this.inMemorySession=null,this.storageKey=n.storageKey,this.autoRefreshToken=n.autoRefreshToken,this.persistSession=n.persistSession,this.storage=n.storage||lve,this.admin=new rve({url:n.url,headers:n.headers,fetch:n.fetch}),this.url=n.url,this.headers=n.headers,this.fetch=fre(n.fetch),this.detectSessionInUrl=n.detectSessionInUrl,this.flowType=n.flowType,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},Rf()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(r=this.broadcastChannel)===null||r===void 0||r.addEventListener("message",i=>{this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}initialize(){return this.initializePromise||(this.initializePromise=this._initialize()),this.initializePromise}_initialize(){return Qr(this,void 0,void 0,function*(){if(this.initializePromise)return this.initializePromise;try{const t=yield this._isPKCEFlow();if(this.detectSessionInUrl&&this._isImplicitGrantFlow()||t){const{data:r,error:n}=yield this._getSessionFromUrl(t);if(n)return yield this._removeSession(),{error:n};const{session:i,redirectType:o}=r;return yield this._saveSession(i),setTimeout(()=>{o==="recovery"?this._notifyAllSubscribers("PASSWORD_RECOVERY",i):this._notifyAllSubscribers("SIGNED_IN",i)},0),{error:null}}return yield this._recoverAndRefresh(),{error:null}}catch(t){return Nn(t)?{error:t}:{error:new hre("Unexpected error during initialization",t)}}finally{yield this._handleVisibilityChange()}})}signUp(t){var r,n,i;return Qr(this,void 0,void 0,function*(){try{yield this._removeSession();let o;if("email"in t){const{email:g,password:S,options:T}=t;let R=null,A=null;if(this.flowType==="pkce"){const $=TT();yield jw(this.storage,`${this.storageKey}-code-verifier`,$),R=yield OT($),A=$===R?"plain":"s256"}o=yield Un(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:T==null?void 0:T.emailRedirectTo,body:{email:g,password:S,data:(r=T==null?void 0:T.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:T==null?void 0:T.captchaToken},code_challenge:R,code_challenge_method:A},xform:_f})}else if("phone"in t){const{phone:g,password:S,options:T}=t;o=yield Un(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:g,password:S,data:(n=T==null?void 0:T.data)!==null&&n!==void 0?n:{},channel:(i=T==null?void 0:T.channel)!==null&&i!==void 0?i:"sms",gotrue_meta_security:{captcha_token:T==null?void 0:T.captchaToken}},xform:_f})}else throw new RT("You must provide either an email or phone number and a password");const{data:s,error:a}=o;if(a||!s)return{data:{user:null,session:null},error:a};const h=s.session,p=s.user;return s.session&&(yield this._saveSession(s.session),this._notifyAllSubscribers("SIGNED_IN",h)),{data:{user:p,session:h},error:null}}catch(o){if(Nn(o))return{data:{user:null,session:null},error:o};throw o}})}signInWithPassword(t){return Qr(this,void 0,void 0,function*(){try{yield this._removeSession();let r;if("email"in t){const{email:o,password:s,options:a}=t;r=yield Un(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:o,password:s,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:_f})}else if("phone"in t){const{phone:o,password:s,options:a}=t;r=yield Un(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:o,password:s,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:_f})}else throw new RT("You must provide either an email or phone number and a password");const{data:n,error:i}=r;return i||!n?{data:{user:null,session:null},error:i}:(n.session&&(yield this._saveSession(n.session),this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:n,error:i})}catch(r){if(Nn(r))return{data:{user:null,session:null},error:r};throw r}})}signInWithOAuth(t){var r,n,i,o;return Qr(this,void 0,void 0,function*(){return yield this._removeSession(),yield this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(i=t.options)===null||i===void 0?void 0:i.queryParams,skipBrowserRedirect:(o=t.options)===null||o===void 0?void 0:o.skipBrowserRedirect})})}exchangeCodeForSession(t){return Qr(this,void 0,void 0,function*(){const r=yield ET(this.storage,`${this.storageKey}-code-verifier`),{data:n,error:i}=yield Un(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:r},xform:_f});return yield aD(this.storage,`${this.storageKey}-code-verifier`),i||!n?{data:{user:null,session:null},error:i}:(n.session&&(yield this._saveSession(n.session),this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:n,error:i})})}signInWithIdToken(t){return Qr(this,void 0,void 0,function*(){yield this._removeSession();try{const{options:r,provider:n,token:i,nonce:o}=t,s=yield Un(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:i,nonce:o,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:_f}),{data:a,error:h}=s;return h||!a?{data:{user:null,session:null},error:h}:(a.session&&(yield this._saveSession(a.session),this._notifyAllSubscribers("SIGNED_IN",a.session)),{data:a,error:h})}catch(r){if(Nn(r))return{data:{user:null,session:null},error:r};throw r}})}signInWithOtp(t){var r,n,i,o,s;return Qr(this,void 0,void 0,function*(){try{if(yield this._removeSession(),"email"in t){const{email:a,options:h}=t;let p=null,g=null;if(this.flowType==="pkce"){const T=TT();yield jw(this.storage,`${this.storageKey}-code-verifier`,T),p=yield OT(T),g=T===p?"plain":"s256"}const{error:S}=yield Un(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:a,data:(r=h==null?void 0:h.data)!==null&&r!==void 0?r:{},create_user:(n=h==null?void 0:h.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken},code_challenge:p,code_challenge_method:g},redirectTo:h==null?void 0:h.emailRedirectTo});return{data:{user:null,session:null},error:S}}if("phone"in t){const{phone:a,options:h}=t,{error:p}=yield Un(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:a,data:(i=h==null?void 0:h.data)!==null&&i!==void 0?i:{},create_user:(o=h==null?void 0:h.shouldCreateUser)!==null&&o!==void 0?o:!0,gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken},channel:(s=h==null?void 0:h.channel)!==null&&s!==void 0?s:"sms"}});return{data:{user:null,session:null},error:p}}throw new RT("You must provide either an email or phone number.")}catch(a){if(Nn(a))return{data:{user:null,session:null},error:a};throw a}})}verifyOtp(t){var r,n;return Qr(this,void 0,void 0,function*(){try{yield this._removeSession();const{data:i,error:o}=yield Un(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:(r=t.options)===null||r===void 0?void 0:r.captchaToken}}),redirectTo:(n=t.options)===null||n===void 0?void 0:n.redirectTo,xform:_f});if(o)throw o;if(!i)throw new Error("An error occurred on token verification.");const s=i.session,a=i.user;return s!=null&&s.access_token&&(yield this._saveSession(s),this._notifyAllSubscribers("SIGNED_IN",s)),{data:{user:a,session:s},error:null}}catch(i){if(Nn(i))return{data:{user:null,session:null},error:i};throw i}})}signInWithSSO(t){var r,n,i;return Qr(this,void 0,void 0,function*(){try{return yield this._removeSession(),yield Un(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((i=t==null?void 0:t.options)===null||i===void 0)&&i.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0}),headers:this.headers,xform:Zge})}catch(o){if(Nn(o))return{data:null,error:o};throw o}})}reauthenticate(){return Qr(this,void 0,void 0,function*(){try{const{data:{session:t},error:r}=yield this.getSession();if(r)throw r;if(!t)throw new uy;const{error:n}=yield Un(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:n}}catch(t){if(Nn(t))return{data:{user:null,session:null},error:t};throw t}})}resend(t){return Qr(this,void 0,void 0,function*(){try{yield this._removeSession();const r=`${this.url}/resend`;if("email"in t){const{email:n,type:i,options:o}=t,{error:s}=yield Un(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:i,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}}});return{data:{user:null,session:null},error:s}}else if("phone"in t){const{phone:n,type:i,options:o}=t,{error:s}=yield Un(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:i,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}}});return{data:{user:null,session:null},error:s}}throw new RT("You must provide either an email or phone number and a type")}catch(r){if(Nn(r))return{data:{user:null,session:null},error:r};throw r}})}getSession(){return Qr(this,void 0,void 0,function*(){yield this.initializePromise;let t=null;if(this.persistSession){const o=yield ET(this.storage,this.storageKey);o!==null&&(this._isValidSession(o)?t=o:yield this._removeSession())}else t=this.inMemorySession;if(!t)return{data:{session:null},error:null};if(!(t.expires_at?t.expires_at<=Date.now()/1e3:!1))return{data:{session:t},error:null};const{session:n,error:i}=yield this._callRefreshToken(t.refresh_token);return i?{data:{session:null},error:i}:{data:{session:n},error:null}})}getUser(t){var r,n;return Qr(this,void 0,void 0,function*(){try{if(!t){const{data:i,error:o}=yield this.getSession();if(o)throw o;t=(n=(r=i.session)===null||r===void 0?void 0:r.access_token)!==null&&n!==void 0?n:void 0}return yield Un(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:Bd})}catch(i){if(Nn(i))return{data:{user:null},error:i};throw i}})}updateUser(t,r={}){return Qr(this,void 0,void 0,function*(){try{const{data:n,error:i}=yield this.getSession();if(i)throw i;if(!n.session)throw new uy;const o=n.session,{data:s,error:a}=yield Un(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:t,jwt:o.access_token,xform:Bd});if(a)throw a;return o.user=s.user,yield this._saveSession(o),this._notifyAllSubscribers("USER_UPDATED",o),{data:{user:o.user},error:null}}catch(n){if(Nn(n))return{data:{user:null},error:n};throw n}})}_decodeJWT(t){return RG(t)}setSession(t){return Qr(this,void 0,void 0,function*(){try{if(!t.access_token||!t.refresh_token)throw new uy;const r=Date.now()/1e3;let n=r,i=!0,o=null;const s=RG(t.access_token);if(s.exp&&(n=s.exp,i=n<=r),i){const{session:a,error:h}=yield this._callRefreshToken(t.refresh_token);if(h)return{data:{user:null,session:null},error:h};if(!a)return{data:{user:null,session:null},error:null};o=a}else{const{data:a,error:h}=yield this.getUser(t.access_token);if(h)throw h;o={access_token:t.access_token,refresh_token:t.refresh_token,user:a.user,token_type:"bearer",expires_in:n-r,expires_at:n},yield this._saveSession(o),this._notifyAllSubscribers("SIGNED_IN",o)}return{data:{user:o.user,session:o},error:null}}catch(r){if(Nn(r))return{data:{session:null,user:null},error:r};throw r}})}refreshSession(t){var r;return Qr(this,void 0,void 0,function*(){try{if(!t){const{data:o,error:s}=yield this.getSession();if(s)throw s;t=(r=o.session)!==null&&r!==void 0?r:void 0}if(!(t!=null&&t.refresh_token))throw new uy;const{session:n,error:i}=yield this._callRefreshToken(t.refresh_token);return i?{data:{user:null,session:null},error:i}:n?{data:{user:n.user,session:n},error:null}:{data:{user:null,session:null},error:null}}catch(n){if(Nn(n))return{data:{user:null,session:null},error:n};throw n}})}_getSessionFromUrl(t){return Qr(this,void 0,void 0,function*(){try{if(!Rf())throw new Au("No browser detected.");if(this.flowType==="implicit"&&!this._isImplicitGrantFlow())throw new Au("Not a valid implicit grant flow url.");if(this.flowType=="pkce"&&!t)throw new sD("Not a valid PKCE flow url.");if(t){const j=Pa("code");if(!j)throw new sD("No code detected.");const{data:z,error:V}=yield this.exchangeCodeForSession(j);if(V)throw V;if(!z.session)throw new sD("No session detected.");let G=new URL(window.location.href);return G.searchParams.delete("code"),window.history.replaceState(window.history.state,"",G.toString()),{data:{session:z.session,redirectType:null},error:null}}const r=Pa("error_description");if(r){const j=Pa("error_code");if(!j)throw new Au("No error_code detected.");const z=Pa("error");throw z?new Au(r,{error:z,code:j}):new Au("No error detected.")}const n=Pa("provider_token"),i=Pa("provider_refresh_token"),o=Pa("access_token");if(!o)throw new Au("No access_token detected.");const s=Pa("expires_in");if(!s)throw new Au("No expires_in detected.");const a=Pa("refresh_token");if(!a)throw new Au("No refresh_token detected.");const h=Pa("token_type");if(!h)throw new Au("No token_type detected.");const g=Math.round(Date.now()/1e3)+parseInt(s),{data:S,error:T}=yield this.getUser(o);if(T)throw T;const R=S.user,A={provider_token:n,provider_refresh_token:i,access_token:o,expires_in:parseInt(s),expires_at:g,refresh_token:a,token_type:h,user:R},$=Pa("type");return window.location.hash="",{data:{session:A,redirectType:$},error:null}}catch(r){if(Nn(r))return{data:{session:null,redirectType:null},error:r};throw r}})}_isImplicitGrantFlow(){return Rf()&&(!!Pa("access_token")||!!Pa("error_description"))}_isPKCEFlow(){return Qr(this,void 0,void 0,function*(){const t=yield ET(this.storage,`${this.storageKey}-code-verifier`);return Rf()&&!!Pa("code")&&!!t})}signOut(){var t;return Qr(this,void 0,void 0,function*(){const{data:r,error:n}=yield this.getSession();if(n)return{error:n};const i=(t=r.session)===null||t===void 0?void 0:t.access_token;if(i){const{error:o}=yield this.admin.signOut(i);if(o&&!(Gge(o)&&(o.status===404||o.status===401)))return{error:o}}return yield this._removeSession(),yield aD(this.storage,`${this.storageKey}-code-verifier`),this._notifyAllSubscribers("SIGNED_OUT",null),{error:null}})}onAuthStateChange(t){const r=Nge(),n={id:r,callback:t,unsubscribe:()=>{this.stateChangeEmitters.delete(r)}};return this.stateChangeEmitters.set(r,n),this.emitInitialSession(r),{data:{subscription:n}}}emitInitialSession(t){var r,n;return Qr(this,void 0,void 0,function*(){try{const{data:{session:i},error:o}=yield this.getSession();if(o)throw o;(r=this.stateChangeEmitters.get(t))===null||r===void 0||r.callback("INITIAL_SESSION",i)}catch(i){(n=this.stateChangeEmitters.get(t))===null||n===void 0||n.callback("INITIAL_SESSION",null),console.error(i)}})}resetPasswordForEmail(t,r={}){return Qr(this,void 0,void 0,function*(){let n=null,i=null;if(this.flowType==="pkce"){const o=TT();yield jw(this.storage,`${this.storageKey}-code-verifier`,o),n=yield OT(o),i=o===n?"plain":"s256"}try{return yield Un(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:i,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(o){if(Nn(o))return{data:null,error:o};throw o}})}_refreshAccessToken(t){return Qr(this,void 0,void 0,function*(){try{const r=Date.now();return yield Fge(n=>Qr(this,void 0,void 0,function*(){return yield zge(n*200),yield Un(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:_f})}),(n,i,o)=>o&&o.error&&o.error instanceof NL&&Date.now()+(n+1)*200-r<lD)}catch(r){if(Nn(r))return{data:{session:null,user:null},error:r};throw r}})}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}_handleProviderSignIn(t,r){return Qr(this,void 0,void 0,function*(){const n=yield this._getUrlForProvider(t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return Rf()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}})}_recoverAndRefresh(){var t;return Qr(this,void 0,void 0,function*(){try{const r=yield ET(this.storage,this.storageKey);if(!this._isValidSession(r)){r!==null&&(yield this._removeSession());return}const n=Math.round(Date.now()/1e3);if(((t=r.expires_at)!==null&&t!==void 0?t:1/0)<n+sve){if(this.autoRefreshToken&&r.refresh_token){const{error:i}=yield this._callRefreshToken(r.refresh_token);i&&(console.log(i.message),yield this._removeSession())}}else this.persistSession&&(yield this._saveSession(r)),this._notifyAllSubscribers("SIGNED_IN",r)}catch(r){console.error(r);return}})}_callRefreshToken(t){var r,n;return Qr(this,void 0,void 0,function*(){if(this.refreshingDeferred)return this.refreshingDeferred.promise;try{if(this.refreshingDeferred=new KP,!t)throw new uy;const{data:i,error:o}=yield this._refreshAccessToken(t);if(o)throw o;if(!i.session)throw new uy;yield this._saveSession(i.session),this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const s={session:i.session,error:null};return this.refreshingDeferred.resolve(s),s}catch(i){if(Nn(i)){const o={session:null,error:i};return(r=this.refreshingDeferred)===null||r===void 0||r.resolve(o),o}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(i),i}finally{this.refreshingDeferred=null}})}_notifyAllSubscribers(t,r,n=!0){this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:r}),this.stateChangeEmitters.forEach(i=>i.callback(t,r))}_saveSession(t){return Qr(this,void 0,void 0,function*(){this.persistSession||(this.inMemorySession=t),this.persistSession&&t.expires_at&&(yield this._persistSession(t))})}_persistSession(t){return jw(this.storage,this.storageKey,t)}_removeSession(){return Qr(this,void 0,void 0,function*(){this.persistSession?yield aD(this.storage,this.storageKey):this.inMemorySession=null})}_removeVisibilityChangedCallback(){const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&Rf()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}_startAutoRefresh(){return Qr(this,void 0,void 0,function*(){yield this._stopAutoRefresh();const t=setInterval(()=>this._autoRefreshTokenTick(),lD);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),yield this._autoRefreshTokenTick()})}_stopAutoRefresh(){return Qr(this,void 0,void 0,function*(){const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)})}startAutoRefresh(){return Qr(this,void 0,void 0,function*(){this._removeVisibilityChangedCallback(),yield this._startAutoRefresh()})}stopAutoRefresh(){return Qr(this,void 0,void 0,function*(){this._removeVisibilityChangedCallback(),yield this._stopAutoRefresh()})}_autoRefreshTokenTick(){return Qr(this,void 0,void 0,function*(){const t=Date.now();try{const{data:{session:r}}=yield this.getSession();if(!r||!r.refresh_token||!r.expires_at)return;Math.floor((r.expires_at*1e3-t)/lD)<fve&&(yield this._callRefreshToken(r.refresh_token))}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}})}_handleVisibilityChange(){return Qr(this,void 0,void 0,function*(){if(!Rf()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=()=>Qr(this,void 0,void 0,function*(){return yield this._onVisibilityChanged(!1)}),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),yield this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}})}_onVisibilityChanged(t){return Qr(this,void 0,void 0,function*(){document.visibilityState==="visible"?(t||(yield this.initializePromise,yield this._recoverAndRefresh()),this.autoRefreshToken&&this._startAutoRefresh()):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()})}_getUrlForProvider(t,r){return Qr(this,void 0,void 0,function*(){const n=[`provider=${encodeURIComponent(t)}`];if(r!=null&&r.redirectTo&&n.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r!=null&&r.scopes&&n.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){const i=TT();yield jw(this.storage,`${this.storageKey}-code-verifier`,i);const o=yield OT(i),s=i===o?"plain":"s256",a=new URLSearchParams({code_challenge:`${encodeURIComponent(o)}`,code_challenge_method:`${encodeURIComponent(s)}`});n.push(a.toString())}if(r!=null&&r.queryParams){const i=new URLSearchParams(r.queryParams);n.push(i.toString())}return`${this.url}/authorize?${n.join("&")}`})}_unenroll(t){var r;return Qr(this,void 0,void 0,function*(){try{const{data:n,error:i}=yield this.getSession();return i?{data:null,error:i}:yield Un(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(r=n==null?void 0:n.session)===null||r===void 0?void 0:r.access_token})}catch(n){if(Nn(n))return{data:null,error:n};throw n}})}_enroll(t){var r,n;return Qr(this,void 0,void 0,function*(){try{const{data:i,error:o}=yield this.getSession();if(o)return{data:null,error:o};const{data:s,error:a}=yield Un(this.fetch,"POST",`${this.url}/factors`,{body:{friendly_name:t.friendlyName,factor_type:t.factorType,issuer:t.issuer},headers:this.headers,jwt:(r=i==null?void 0:i.session)===null||r===void 0?void 0:r.access_token});return a?{data:null,error:a}:(!((n=s==null?void 0:s.totp)===null||n===void 0)&&n.qr_code&&(s.totp.qr_code=`data:image/svg+xml;utf-8,${s.totp.qr_code}`),{data:s,error:null})}catch(i){if(Nn(i))return{data:null,error:i};throw i}})}_verify(t){var r;return Qr(this,void 0,void 0,function*(){try{const{data:n,error:i}=yield this.getSession();if(i)return{data:null,error:i};const{data:o,error:s}=yield Un(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:{code:t.code,challenge_id:t.challengeId},headers:this.headers,jwt:(r=n==null?void 0:n.session)===null||r===void 0?void 0:r.access_token});return s?{data:null,error:s}:(yield this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),{data:o,error:s})}catch(n){if(Nn(n))return{data:null,error:n};throw n}})}_challenge(t){var r;return Qr(this,void 0,void 0,function*(){try{const{data:n,error:i}=yield this.getSession();return i?{data:null,error:i}:yield Un(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{headers:this.headers,jwt:(r=n==null?void 0:n.session)===null||r===void 0?void 0:r.access_token})}catch(n){if(Nn(n))return{data:null,error:n};throw n}})}_challengeAndVerify(t){return Qr(this,void 0,void 0,function*(){const{data:r,error:n}=yield this._challenge({factorId:t.factorId});return n?{data:null,error:n}:yield this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})})}_listFactors(){return Qr(this,void 0,void 0,function*(){const{data:{user:t},error:r}=yield this.getUser();if(r)return{data:null,error:r};const n=(t==null?void 0:t.factors)||[],i=n.filter(o=>o.factor_type==="totp"&&o.status==="verified");return{data:{all:n,totp:i},error:null}})}_getAuthenticatorAssuranceLevel(){var t,r;return Qr(this,void 0,void 0,function*(){const{data:{session:n},error:i}=yield this.getSession();if(i)return{data:null,error:i};if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const o=this._decodeJWT(n.access_token);let s=null;o.aal&&(s=o.aal);let a=s;((r=(t=n.user.factors)===null||t===void 0?void 0:t.filter(g=>g.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(a="aal2");const p=o.amr||[];return{data:{currentLevel:s,nextLevel:a,currentAuthenticationMethods:p},error:null}})}}class dve extends hve{constructor(t){super(t)}}var pve=globalThis&&globalThis.__awaiter||function(e,t,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(g){try{p(n.next(g))}catch(S){s(S)}}function h(g){try{p(n.throw(g))}catch(S){s(S)}}function p(g){g.done?o(g.value):i(g.value).then(a,h)}p((n=n.apply(e,t||[])).next())})};const mve={headers:kge},yve={schema:"public"},gve={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},vve={};class _ve{constructor(t,r,n){var i,o,s,a,h,p,g,S;if(this.supabaseUrl=t,this.supabaseKey=r,!t)throw new Error("supabaseUrl is required.");if(!r)throw new Error("supabaseKey is required.");const T=Dge(t);if(this.realtimeUrl=`${T}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${T}/auth/v1`,this.storageUrl=`${T}/storage/v1`,T.match(/(supabase\.co)|(supabase\.in)/)){const z=T.split(".");this.functionsUrl=`${z[0]}.functions.${z[1]}.${z[2]}`}else this.functionsUrl=`${T}/functions/v1`;const A=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,$={db:yve,realtime:vve,auth:Object.assign(Object.assign({},gve),{storageKey:A}),global:mve},j=$ge(n??{},$);this.storageKey=(o=(i=j.auth)===null||i===void 0?void 0:i.storageKey)!==null&&o!==void 0?o:"",this.headers=(a=(s=j.global)===null||s===void 0?void 0:s.headers)!==null&&a!==void 0?a:{},this.auth=this._initSupabaseAuthClient((h=j.auth)!==null&&h!==void 0?h:{},this.headers,(p=j.global)===null||p===void 0?void 0:p.fetch),this.fetch=Mge(r,this._getAccessToken.bind(this),(g=j.global)===null||g===void 0?void 0:g.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers},j.realtime)),this.rest=new $ye(`${T}/rest/v1`,{headers:this.headers,schema:(S=j.db)===null||S===void 0?void 0:S.schema,fetch:this.fetch}),this._listenForAuthEvents()}get functions(){return new kye(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new Oge(this.storageUrl,this.headers,this.fetch)}from(t){return this.rest.from(t)}rpc(t,r={},n){return this.rest.rpc(t,r,n)}channel(t,r={config:{}}){return this.realtime.channel(t,r)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var t,r;return pve(this,void 0,void 0,function*(){const{data:n}=yield this.auth.getSession();return(r=(t=n.session)===null||t===void 0?void 0:t.access_token)!==null&&r!==void 0?r:null})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:i,storageKey:o,flowType:s},a,h){const p={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new dve({url:this.authUrl,headers:Object.assign(Object.assign({},p),a),storageKey:o,autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:i,flowType:s,fetch:h})}_initRealtimeClient(t){return new yge(this.realtimeUrl,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,n)=>{this._handleTokenChanged(r,n==null?void 0:n.access_token,"CLIENT")})}_handleTokenChanged(t,r,n){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==r?(this.realtime.setAuth(r??null),this.changedAccessToken=r):t==="SIGNED_OUT"&&(this.realtime.setAuth(this.supabaseKey),n=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const bve=(e,t,r)=>new _ve(e,t,r);function wve(){return Qe.jsx(Qe.Fragment,{children:Qe.jsx("div",{className:"marker-set-route"})})}function Sve(){return Qe.jsxs(Qe.Fragment,{children:[Qe.jsxs("div",{children:[Qe.jsx(mG,{to:"log-in",children:Qe.jsx("button",{className:"input-button-import",children:"Log in "})}),Qe.jsx(mG,{to:"register",children:Qe.jsx("button",{className:"input-button-import",children:"Sign Up"})})]}),Qe.jsx(wve,{})]})}const xve="/assets/Silkroad-1b347aca.svg";function Cve({onMenuClick:e,currentPage:t,selectFile:r,setLogOut:n}){const i=UP(),o=a=>{e(a)},s=()=>{n(!0),i("/log-in/")};return Qe.jsxs(Qe.Fragment,{children:[Qe.jsxs("div",{className:"menu-grid",children:[Qe.jsx("div",{className:"img-div logo",children:Qe.jsx("a",{children:Qe.jsx("img",{src:xve,height:"32",width:"48"})})}),Qe.jsx("div",{onClick:()=>{o("route"),r("")},className:t==="route"?"glyph route menu-select-active":"glyph route",title:"Route",children:Qe.jsx("a",{placeholder:"Route",children:Qe.jsx("i",{className:"fi fi-rs-rocket-lunch glyphicon glyph-prop"})})}),Qe.jsx("div",{onClick:()=>{o("schedule"),r("")},className:t==="schedule"||t==="grid"?"glyph schedule menu-select-active":"glyph schedule",title:"Schedule",children:Qe.jsx("a",{children:Qe.jsx("i",{className:"fi fi-rr-calendar glyphicon glyph-prop"})})}),Qe.jsx("div",{className:t=="driver"?"glyph driver menu-select-active":"glyph driver",onClick:()=>{o("driver"),r("")},title:"Drivers",children:Qe.jsx("a",{children:Qe.jsx("i",{className:"fi fi-rs-users glyphicon glyph-prop"})})})]}),Qe.jsxs("div",{className:"menu-grid-two",children:[Qe.jsx("div",{onClick:()=>{o("settings")},title:"Settings",className:t==="settings"?"glyph setting menu-select-active":"glyph setting",children:Qe.jsx("a",{children:Qe.jsx("i",{className:"fi fi-rr-settings glyphicon glyph-prop"})})}),Qe.jsx("div",{className:"glyph log-out",onClick:()=>s(),title:"Log out",children:Qe.jsx("a",{children:Qe.jsx("i",{className:"fi fi-rs-address-card glyphicon glyph-prop"})})})]})]})}function Eve(){const[e,t]=Rt.useState(0),r=()=>{t(e+1)};return Qe.jsxs(Qe.Fragment,{children:[Qe.jsx("div",{className:"page-title-div",children:Qe.jsx("p",{className:"page-title",children:"Route"})}),Qe.jsx("div",{className:"change-map-div",children:Qe.jsx("button",{className:"select-map-button",onClick:r,children:"Change Map"})}),Qe.jsxs("div",{id:"stylemenu",className:"show-map-div"+(e===0?"":e%2===0?" inactive":" active"),children:[Qe.jsx("button",{className:"select-map-button",id:"mapbox://styles/mapbox/streets-v12",children:"Streets"}),Qe.jsx("button",{className:"select-map-button",id:"mapbox://styles/mapbox/outdoors-v12",children:"Outdoors"}),Qe.jsx("button",{className:"select-map-button",id:"mapbox://styles/mapbox/navigation-night-v1",children:"Night"}),Qe.jsx("button",{className:"select-map-button",id:"mapbox://styles/mapbox/satellite-streets-v12",children:"Satelite"}),Qe.jsx("button",{className:"last-button",id:"mapbox://styles/mapbox/navigation-night-v1",children:"Navigation Night"})]})]})}var dre={exports:{}};(function(e,t){(function(r,n){e.exports=n()})(ug,function(){var r,n,i;function o(a,h){if(!r)r=h;else if(!n)n=h;else{var p="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+r+")(sharedChunk); ("+n+")(sharedChunk); self.onerror = null;",g={};r(g),i=h(g),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(i.workerUrl=window.URL.createObjectURL(new Blob([p],{type:"text/javascript"})))}}o(["exports"],function(a){var h=typeof self<"u"?self:{},p="2.14.1";let g;const S={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(g==null){const u=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{g={}.API_URL_REGEX!=null?new RegExp({}.API_URL_REGEX):u}catch{g=u}}return g},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!S.API_URL)return null;try{const u=new URL(S.API_URL);return u.hostname==="api.mapbox.cn"?"https://events.mapbox.cn/events/v2":u.hostname==="api.mapbox.com"?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},T={supported:!1,testSupport:function(u){!$&&A&&(j?z(u):R=u)}};let R,A,$=!1,j=!1;function z(u){const l=u.createTexture();u.bindTexture(u.TEXTURE_2D,l);try{if(u.texImage2D(u.TEXTURE_2D,0,u.RGBA,u.RGBA,u.UNSIGNED_BYTE,A),u.isContextLost())return;T.supported=!0}catch{}u.deleteTexture(l),$=!0}h.document&&(A=h.document.createElement("img"),A.onload=function(){R&&z(R),R=null,j=!0},A.onerror=function(){$=!0,R=null},A.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const V="01";var G=ee;function ee(u,l,c,d){this.cx=3*u,this.bx=3*(c-u)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*l,this.by=3*(d-l)-this.cy,this.ay=1-this.cy-this.by,this.p1x=u,this.p1y=l,this.p2x=c,this.p2y=d}ee.prototype={sampleCurveX:function(u){return((this.ax*u+this.bx)*u+this.cx)*u},sampleCurveY:function(u){return((this.ay*u+this.by)*u+this.cy)*u},sampleCurveDerivativeX:function(u){return(3*this.ax*u+2*this.bx)*u+this.cx},solveCurveX:function(u,l){if(l===void 0&&(l=1e-6),u<0)return 0;if(u>1)return 1;for(var c=u,d=0;d<8;d++){var y=this.sampleCurveX(c)-u;if(Math.abs(y)<l)return c;var _=this.sampleCurveDerivativeX(c);if(Math.abs(_)<1e-6)break;c-=y/_}var w=0,C=1;for(c=u,d=0;d<20&&(y=this.sampleCurveX(c),!(Math.abs(y-u)<l));d++)u>y?w=c:C=c,c=.5*(C-w)+w;return c},solve:function(u,l){return this.sampleCurveY(this.solveCurveX(u,l))}};var K=xe;function xe(u,l){this.x=u,this.y=l}xe.prototype={clone:function(){return new xe(this.x,this.y)},add:function(u){return this.clone()._add(u)},sub:function(u){return this.clone()._sub(u)},multByPoint:function(u){return this.clone()._multByPoint(u)},divByPoint:function(u){return this.clone()._divByPoint(u)},mult:function(u){return this.clone()._mult(u)},div:function(u){return this.clone()._div(u)},rotate:function(u){return this.clone()._rotate(u)},rotateAround:function(u,l){return this.clone()._rotateAround(u,l)},matMult:function(u){return this.clone()._matMult(u)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(u){return this.x===u.x&&this.y===u.y},dist:function(u){return Math.sqrt(this.distSqr(u))},distSqr:function(u){var l=u.x-this.x,c=u.y-this.y;return l*l+c*c},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(u){return Math.atan2(this.y-u.y,this.x-u.x)},angleWith:function(u){return this.angleWithSep(u.x,u.y)},angleWithSep:function(u,l){return Math.atan2(this.x*l-this.y*u,this.x*u+this.y*l)},_matMult:function(u){var l=u[2]*this.x+u[3]*this.y;return this.x=u[0]*this.x+u[1]*this.y,this.y=l,this},_add:function(u){return this.x+=u.x,this.y+=u.y,this},_sub:function(u){return this.x-=u.x,this.y-=u.y,this},_mult:function(u){return this.x*=u,this.y*=u,this},_div:function(u){return this.x/=u,this.y/=u,this},_multByPoint:function(u){return this.x*=u.x,this.y*=u.y,this},_divByPoint:function(u){return this.x/=u.x,this.y/=u.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var u=this.y;return this.y=this.x,this.x=-u,this},_rotate:function(u){var l=Math.cos(u),c=Math.sin(u),d=c*this.x+l*this.y;return this.x=l*this.x-c*this.y,this.y=d,this},_rotateAround:function(u,l){var c=Math.cos(u),d=Math.sin(u),y=l.y+d*(this.x-l.x)+c*(this.y-l.y);return this.x=l.x+c*(this.x-l.x)-d*(this.y-l.y),this.y=y,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},xe.convert=function(u){return u instanceof xe?u:Array.isArray(u)?new xe(u[0],u[1]):u};const Me=Math.PI/180,He=180/Math.PI;function Ne(u){return u*Me}function We(u){return u*He}const gt=[[0,0],[1,0],[1,1],[0,1]];function Lt(u){if(u<=0)return 0;if(u>=1)return 1;const l=u*u,c=l*u;return 4*(u<.5?c:3*(u-l)+c-.75)}function _t(u,l,c,d){const y=new G(u,l,c,d);return function(_){return y.solve(_)}}const $e=_t(.25,.1,.25,1);function Fe(u,l,c){return Math.min(c,Math.max(l,u))}function At(u,l,c){return(c=Fe((c-u)/(l-u),0,1))*c*(3-2*c)}function Gt(u,l,c){const d=c-l,y=((u-l)%d+d)%d+l;return y===l?c:y}function ae(u,l,c){if(!u.length)return c(null,[]);let d=u.length;const y=new Array(u.length);let _=null;u.forEach((w,C)=>{l(w,(O,k)=>{O&&(_=O),y[C]=k,--d==0&&c(_,y)})})}function D(u){const l=[];for(const c in u)l.push(u[c]);return l}function U(u,...l){for(const c of l)for(const d in c)u[d]=c[d];return u}let q=1;function ne(){return q++}function ye(){return function u(l){return l?(l^Math.random()*(16>>l/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,u)}()}function ve(u){return u<=1?1:Math.pow(2,Math.ceil(Math.log(u)/Math.LN2))}function ze(u){return!!u&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(u)}function je(u,l){u.forEach(c=>{l[c]&&(l[c]=l[c].bind(l))})}function Je(u,l){return u.indexOf(l,u.length-l.length)!==-1}function xt(u,l,c){const d={};for(const y in u)d[y]=l.call(c||this,u[y],y,u);return d}function kt(u,l,c){const d={};for(const y in u)l.call(c||this,u[y],y,u)&&(d[y]=u[y]);return d}function jt(u){return Array.isArray(u)?u.map(jt):typeof u=="object"&&u?xt(u,jt):u}const yr={};function Ft(u){yr[u]||(typeof console<"u"&&console.warn(u),yr[u]=!0)}function Jt(u,l,c){return(c.y-u.y)*(l.x-u.x)>(l.y-u.y)*(c.x-u.x)}function et(u){let l=0;for(let c,d,y=0,_=u.length,w=_-1;y<_;w=y++)c=u[y],d=u[w],l+=(d.x-c.x)*(c.y+d.y);return l}function wr(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function $r(u){const l={};if(u.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(c,d,y,_)=>{const w=y||_;return l[d]=!w||w.toLowerCase(),""}),l["max-age"]){const c=parseInt(l["max-age"],10);isNaN(c)?delete l["max-age"]:l["max-age"]=c}return l}let lr=null;function Sr(u){if(lr==null){const l=u.navigator?u.navigator.userAgent:null;lr=!!u.safari||!(!l||!(/\b(iPad|iPhone|iPod)\b/.test(l)||l.match("Safari")&&!l.match("Chrome")))}return lr}function Or(u){try{const l=h[u];return l.setItem("_mapbox_test_",1),l.removeItem("_mapbox_test_"),!0}catch{return!1}}function se(u,l){return[u[4*l],u[4*l+1],u[4*l+2],u[4*l+3]]}const _e="mapbox-tiles";let Re,Ke,Be=500,rt=50;function Ue(){try{return h.caches}catch{}}function Ve(){Ue()&&!Re&&(Re=h.caches.open(_e))}function st(u){const l=u.indexOf("?");if(l<0)return u;const c=function(y){const _=y.indexOf("?");return _>0?y.slice(_+1).split("&"):[]}(u),d=c.filter(y=>{const _=y.split("=");return _[0]==="language"||_[0]==="worldview"});return d.length?`${u.slice(0,l)}?${d.join("&")}`:u.slice(0,l)}let Ze=1/0;const ft={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(ft);class zt extends Error{constructor(l,c,d){c===401&&jr(d)&&(l+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(l),this.status=c,this.url=d}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const nr=wr()?()=>self.worker&&self.worker.referrer:()=>(h.location.protocol==="blob:"?h.parent:h).location.href,cr=function(u,l){if(!(/^file:/.test(c=u.url)||/^file:/.test(nr())&&!/^\w+:/.test(c))){if(h.fetch&&h.Request&&h.AbortController&&h.Request.prototype.hasOwnProperty("signal"))return function(d,y){const _=new h.AbortController,w=new h.Request(d.url,{method:d.method||"GET",body:d.body,credentials:d.credentials,headers:d.headers,referrer:nr(),referrerPolicy:d.referrerPolicy,signal:_.signal});let C=!1,O=!1;const k=(M=w.url).indexOf("sku=")>0&&jr(M);var M;d.type==="json"&&w.headers.set("Accept","application/json");const N=(W,Y,J)=>{if(O)return;if(W&&W.message!=="SecurityError"&&Ft(W),Y&&J)return B(Y);const ie=Date.now();h.fetch(w).then(pe=>{if(pe.ok){const Ce=k?pe.clone():null;return B(pe,Ce,ie)}return y(new zt(pe.statusText,pe.status,d.url))}).catch(pe=>{pe.name!=="AbortError"&&y(new Error(`${pe.message} ${d.url}`))})},B=(W,Y,J)=>{(d.type==="arrayBuffer"?W.arrayBuffer():d.type==="json"?W.json():W.text()).then(ie=>{O||(Y&&J&&function(pe,Ce,he){if(Ve(),!Re)return;const Se={status:Ce.status,statusText:Ce.statusText,headers:new h.Headers};Ce.headers.forEach((lt,it)=>Se.headers.set(it,lt));const ke=$r(Ce.headers.get("Cache-Control")||"");if(ke["no-store"])return;ke["max-age"]&&Se.headers.set("Expires",new Date(he+1e3*ke["max-age"]).toUTCString());const Te=Se.headers.get("Expires");Te&&(new Date(Te).getTime()-he<42e4||function(lt,it){if(Ke===void 0)try{new Response(new ReadableStream),Ke=!0}catch{Ke=!1}Ke?it(lt.body):lt.blob().then(it)}(Ce,lt=>{const it=new h.Response(lt,Se);Ve(),Re&&Re.then(vt=>vt.put(st(pe.url),it)).catch(vt=>Ft(vt.message))}))}(w,Y,J),C=!0,y(null,ie,W.headers.get("Cache-Control"),W.headers.get("Expires")))}).catch(ie=>{O||y(new Error(ie.message))})};return k?function(W,Y){if(Ve(),!Re)return Y(null);const J=st(W.url);Re.then(ie=>{ie.match(J).then(pe=>{const Ce=function(he){if(!he)return!1;const Se=new Date(he.headers.get("Expires")||0),ke=$r(he.headers.get("Cache-Control")||"");return Se>Date.now()&&!ke["no-cache"]}(pe);ie.delete(J),Ce&&ie.put(J,pe.clone()),Y(null,pe,Ce)}).catch(Y)}).catch(Y)}(w,N):N(null,null),{cancel:()=>{O=!0,C||_.abort()}}}(u,l);if(wr()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",u,l,void 0,!0)}var c;return function(d,y){const _=new h.XMLHttpRequest;_.open(d.method||"GET",d.url,!0),d.type==="arrayBuffer"&&(_.responseType="arraybuffer");for(const w in d.headers)_.setRequestHeader(w,d.headers[w]);return d.type==="json"&&(_.responseType="text",_.setRequestHeader("Accept","application/json")),_.withCredentials=d.credentials==="include",_.onerror=()=>{y(new Error(_.statusText))},_.onload=()=>{if((_.status>=200&&_.status<300||_.status===0)&&_.response!==null){let w=_.response;if(d.type==="json")try{w=JSON.parse(_.response)}catch(C){return y(C)}y(null,w,_.getResponseHeader("Cache-Control"),_.getResponseHeader("Expires"))}else y(new zt(_.statusText,_.status,d.url))},_.send(d.body),{cancel:()=>_.abort()}}(u,l)},Pr=function(u,l){return cr(U(u,{type:"arrayBuffer"}),l)};function Vr(u){const l=h.document.createElement("a");return l.href=u,l.protocol===h.document.location.protocol&&l.host===h.document.location.host}const gn="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let Ir,Ar;Ir=[],Ar=0;const sn=function(u,l){if(T.supported&&(u.headers||(u.headers={}),u.headers.accept="image/webp,*/*"),Ar>=S.MAX_PARALLEL_IMAGE_REQUESTS){const _={requestParameters:u,callback:l,cancelled:!1,cancel(){this.cancelled=!0}};return Ir.push(_),_}Ar++;let c=!1;const d=()=>{if(!c)for(c=!0,Ar--;Ir.length&&Ar<S.MAX_PARALLEL_IMAGE_REQUESTS;){const _=Ir.shift(),{requestParameters:w,callback:C,cancelled:O}=_;O||(_.cancel=sn(w,C).cancel)}},y=Pr(u,(_,w,C,O)=>{d(),_?l(_):w&&(h.createImageBitmap?function(k,M){const N=new h.Blob([new Uint8Array(k)],{type:"image/png"});h.createImageBitmap(N).then(B=>{M(null,B)}).catch(B=>{M(new Error(`Could not load image because of ${B.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(w,(k,M)=>l(k,M,C,O)):function(k,M){const N=new h.Image,B=h.URL;N.onload=()=>{M(null,N),B.revokeObjectURL(N.src),N.onload=null,h.requestAnimationFrame(()=>{N.src=gn})},N.onerror=()=>M(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const W=new h.Blob([new Uint8Array(k)],{type:"image/png"});N.src=k.byteLength?B.createObjectURL(W):gn}(w,(k,M)=>l(k,M,C,O)))});return{cancel:()=>{y.cancel(),d()}}},on="NO_ACCESS_TOKEN";function Fr(u){return u.indexOf("mapbox:")===0}function jr(u){return S.API_URL_REGEX.test(u)}function tn(u){return S.API_CDN_URL_REGEX.test(u)}function ei(u){return S.API_STYLE_REGEX.test(u)&&!xn(u)}function xn(u){return S.API_SPRITE_REGEX.test(u)}const ln=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function zr(u){const l=u.match(ln);if(!l)throw new Error("Unable to parse URL object");return{protocol:l[1],authority:l[2],path:l[3]||"/",params:l[4]?l[4].split("&"):[]}}function vo(u){const l=u.params.length?`?${u.params.join("&")}`:"";return`${u.protocol}://${u.authority}${u.path}${l}`}function ia(u){if(!u)return null;const l=u.split(".");if(!l||l.length!==3)return null;try{return JSON.parse(decodeURIComponent(h.atob(l[1]).split("").map(c=>"%"+("00"+c.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch{return null}}class jo{constructor(l){this.type=l,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(l){const c=ia(S.ACCESS_TOKEN);let d="";return d=c&&c.u?h.btoa(encodeURIComponent(c.u).replace(/%([0-9A-F]{2})/g,(y,_)=>String.fromCharCode(+("0x"+_)))):S.ACCESS_TOKEN||"",l?`mapbox.eventData.${l}:${d}`:`mapbox.eventData:${d}`}fetchEventData(){const l=Or("localStorage"),c=this.getStorageKey(),d=this.getStorageKey("uuid");if(l)try{const y=h.localStorage.getItem(c);y&&(this.eventData=JSON.parse(y));const _=h.localStorage.getItem(d);_&&(this.anonId=_)}catch{Ft("Unable to read from LocalStorage")}}saveEventData(){const l=Or("localStorage"),c=this.getStorageKey(),d=this.getStorageKey("uuid");if(l)try{h.localStorage.setItem(d,this.anonId),Object.keys(this.eventData).length>=1&&h.localStorage.setItem(c,JSON.stringify(this.eventData))}catch{Ft("Unable to write to LocalStorage")}}processRequests(l){}postEvent(l,c,d,y){if(!S.EVENTS_URL)return;const _=zr(S.EVENTS_URL);_.params.push(`access_token=${y||S.ACCESS_TOKEN||""}`);const w={event:this.type,created:new Date(l).toISOString()},C=c?U(w,c):w,O={url:vo(_),headers:{"Content-Type":"text/plain"},body:JSON.stringify([C])};this.pendingRequest=function(k,M){return cr(U(k,{method:"POST"}),M)}(O,k=>{this.pendingRequest=null,d(k),this.saveEventData(),this.processRequests(y)})}queueRequest(l,c){this.queue.push(l),this.processRequests(c)}}const de=new class extends jo{constructor(u){super("appUserTurnstile"),this._customAccessToken=u}postTurnstileEvent(u,l){S.EVENTS_URL&&S.ACCESS_TOKEN&&Array.isArray(u)&&u.some(c=>Fr(c)||jr(c))&&this.queueRequest(Date.now(),l)}processRequests(u){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const l=ia(S.ACCESS_TOKEN),c=l?l.u:S.ACCESS_TOKEN;let d=c!==this.eventData.tokenU;ze(this.anonId)||(this.anonId=ye(),d=!0);const y=this.queue.shift();if(this.eventData.lastSuccess){const _=new Date(this.eventData.lastSuccess),w=new Date(y),C=(y-this.eventData.lastSuccess)/864e5;d=d||C>=1||C<-1||_.getDate()!==w.getDate()}else d=!0;d?this.postEvent(y,{sdkIdentifier:"mapbox-gl-js",sdkVersion:p,skuId:V,"enabled.telemetry":!1,userId:this.anonId},_=>{_||(this.eventData.lastSuccess=y,this.eventData.tokenU=c)},u):this.processRequests()}},Z=de.postTurnstileEvent.bind(de),Q=new class extends jo{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(u,l,c,d){this.skuToken=l,this.errorCb=d,S.EVENTS_URL&&(c||S.ACCESS_TOKEN?this.queueRequest({id:u,timestamp:Date.now()},c):this.errorCb(new Error(on)))}processRequests(u){if(this.pendingRequest||this.queue.length===0)return;const{id:l,timestamp:c}=this.queue.shift();l&&this.success[l]||(this.anonId||this.fetchEventData(),ze(this.anonId)||(this.anonId=ye()),this.postEvent(c,{sdkIdentifier:"mapbox-gl-js",sdkVersion:p,skuId:V,skuToken:this.skuToken,userId:this.anonId},d=>{d?this.errorCb(d):l&&(this.success[l]=!0)},u))}},fe=Q.postMapLoadEvent.bind(Q),we=new class extends jo{constructor(){super("gljs.performance")}postPerformanceEvent(u,l){S.EVENTS_URL&&(u||S.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:l},u)}processRequests(u){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:l,performanceData:c}=this.queue.shift(),d=function(y){const _=h.performance.getEntriesByType("resource"),w=h.performance.getEntriesByType("mark"),C=function(B){const W={};if(B){for(const Y in B)if(Y!=="other")for(const J of B[Y]){const ie=`${Y}ResolveRangeMin`,pe=`${Y}ResolveRangeMax`,Ce=`${Y}RequestCount`,he=`${Y}RequestCachedCount`;W[ie]=Math.min(W[ie]||1/0,J.startTime),W[pe]=Math.max(W[pe]||-1/0,J.responseEnd);const Se=ke=>{W[ke]===void 0&&(W[ke]=0),++W[ke]};J.transferSize!==void 0&&J.transferSize===0&&Se(he),Se(Ce)}}return W}(function(B,W){const Y={};if(B)for(const J of B){const ie=W(J);Y[ie]===void 0&&(Y[ie]=[]),Y[ie].push(J)}return Y}(_,Xt)),O=h.devicePixelRatio,k=h.navigator.connection||h.navigator.mozConnection||h.navigator.webkitConnection,M={counters:[],metadata:[],attributes:[]},N=(B,W,Y)=>{Y!=null&&B.push({name:W,value:Y.toString()})};for(const B in C)N(M.counters,B,C[B]);if(y.interactionRange[0]!==1/0&&y.interactionRange[1]!==-1/0&&(N(M.counters,"interactionRangeMin",y.interactionRange[0]),N(M.counters,"interactionRangeMax",y.interactionRange[1])),w)for(const B of Object.keys(nt)){const W=nt[B],Y=w.find(J=>J.name===W);Y&&N(M.counters,W,Y.startTime)}return N(M.counters,"visibilityHidden",y.visibilityHidden),N(M.attributes,"style",function(B){if(B)for(const W of B){const Y=W.name.split("?")[0];if(ei(Y)){const J=Y.split("/").slice(-2);if(J.length===2)return`mapbox://styles/${J[0]}/${J[1]}`}}}(_)),N(M.attributes,"terrainEnabled",y.terrainEnabled?"true":"false"),N(M.attributes,"fogEnabled",y.fogEnabled?"true":"false"),N(M.attributes,"projection",y.projection),N(M.attributes,"zoom",y.zoom),N(M.metadata,"devicePixelRatio",O),N(M.metadata,"connectionEffectiveType",k?k.effectiveType:void 0),N(M.metadata,"navigatorUserAgent",h.navigator.userAgent),N(M.metadata,"screenWidth",h.screen.width),N(M.metadata,"screenHeight",h.screen.height),N(M.metadata,"windowWidth",h.innerWidth),N(M.metadata,"windowHeight",h.innerHeight),N(M.metadata,"mapWidth",y.width/O),N(M.metadata,"mapHeight",y.height/O),N(M.metadata,"webglRenderer",y.renderer),N(M.metadata,"webglVendor",y.vendor),N(M.metadata,"sdkVersion",p),N(M.metadata,"sdkIdentifier","mapbox-gl-js"),M}(c);for(const y of d.metadata);for(const y of d.counters);for(const y of d.attributes);this.postEvent(l,d,()=>{},u)}},Ae=we.postPerformanceEvent.bind(we),qe=new class extends jo{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(u,l,c,d){if(!S.API_URL||!S.SESSION_PATH)return;const y=zr(S.API_URL+S.SESSION_PATH);y.params.push(`sku=${l||""}`),y.params.push(`access_token=${d||S.ACCESS_TOKEN||""}`);const _={url:vo(y),headers:{"Content-Type":"text/plain"}};this.pendingRequest=function(w,C){return cr(U(w,{method:"GET"}),C)}(_,w=>{this.pendingRequest=null,c(w),this.saveEventData(),this.processRequests(d)})}getSessionAPI(u,l,c,d){this.skuToken=l,this.errorCb=d,S.SESSION_PATH&&S.API_URL&&(c||S.ACCESS_TOKEN?this.queueRequest({id:u,timestamp:Date.now()},c):this.errorCb(new Error(on)))}processRequests(u){if(this.pendingRequest||this.queue.length===0)return;const{id:l,timestamp:c}=this.queue.shift();l&&this.success[l]||this.getSession(c,this.skuToken,d=>{d?this.errorCb(d):l&&(this.success[l]=!0)},u)}},Ge=qe.getSessionAPI.bind(qe),Ie=new Set,nt={create:"create",load:"load",fullLoad:"fullLoad"},Ct={mark(u){h.performance.mark(u)},measure(u,l,c){h.performance.measure(u,l,c)}};function Xt(u){const l=u.name.split("?")[0];return tn(l)&&l.includes("mapbox-gl.js")?"javascript":tn(l)&&l.includes("mapbox-gl.css")?"css":function(c){return S.API_FONTS_REGEX.test(c)}(l)?"fontRange":xn(l)?"sprite":ei(l)?"style":function(c){return S.API_TILEJSON_REGEX.test(c)}(l)?"tilejson":"other"}const Dt=h.performance;function _r(u){const l=u?u.url.toString():void 0;return Dt.getEntriesByName(l)}let Tt,Ee,mt,It;const pr={now:()=>mt!==void 0?mt:h.performance.now(),setNow(u){mt=u},restoreNow(){mt=void 0},frame(u){const l=h.requestAnimationFrame(u);return{cancel:()=>h.cancelAnimationFrame(l)}},getImageData(u,l=0){const{width:c,height:d}=u;It||(It=h.document.createElement("canvas"));const y=It.getContext("2d",{willReadFrequently:!0});if(!y)throw new Error("failed to create canvas 2d context");return(c>It.width||d>It.height)&&(It.width=c,It.height=d),y.clearRect(-l,-l,c+2*l,d+2*l),y.drawImage(u,0,0,c,d),y.getImageData(-l,-l,c+2*l,d+2*l)},resolveURL:u=>(Tt||(Tt=h.document.createElement("a")),Tt.href=u,Tt.href),get devicePixelRatio(){return h.devicePixelRatio},get prefersReducedMotion(){return!!h.matchMedia&&(Ee==null&&(Ee=h.matchMedia("(prefers-reduced-motion: reduce)")),Ee.matches)}};function or(u,l,c){c[u]&&c[u].indexOf(l)!==-1||(c[u]=c[u]||[],c[u].push(l))}function Nr(u,l,c){if(c&&c[u]){const d=c[u].indexOf(l);d!==-1&&c[u].splice(d,1)}}class Lr{constructor(l,c={}){U(this,c),this.type=l}}class oa extends Lr{constructor(l,c={}){super("error",U({error:l},c))}}class Gn{on(l,c){return this._listeners=this._listeners||{},or(l,c,this._listeners),this}off(l,c){return Nr(l,c,this._listeners),Nr(l,c,this._oneTimeListeners),this}once(l,c){return c?(this._oneTimeListeners=this._oneTimeListeners||{},or(l,c,this._oneTimeListeners),this):new Promise(d=>this.once(l,d))}fire(l,c){typeof l=="string"&&(l=new Lr(l,c||{}));const d=l.type;if(this.listens(d)){l.target=this;const y=this._listeners&&this._listeners[d]?this._listeners[d].slice():[];for(const C of y)C.call(this,l);const _=this._oneTimeListeners&&this._oneTimeListeners[d]?this._oneTimeListeners[d].slice():[];for(const C of _)Nr(d,C,this._oneTimeListeners),C.call(this,l);const w=this._eventedParent;w&&(U(l,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),w.fire(l))}else l instanceof oa&&console.error(l.error);return this}listens(l){return!!(this._listeners&&this._listeners[l]&&this._listeners[l].length>0||this._oneTimeListeners&&this._oneTimeListeners[l]&&this._oneTimeListeners[l].length>0||this._eventedParent&&this._eventedParent.listens(l))}setEventedParent(l,c){return this._eventedParent=l,this._eventedParentData=c,this}}var yt=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360,"units":"degrees"},"pitch":{"type":"number","default":0,"units":"degrees"},"light":{"type":"light"},"terrain":{"type":"terrain"},"fog":{"type":"fog"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":{},"mapbox":{}},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":{}}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":{}}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":{}}},"url":{"required":true,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"background":{},"sky":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],"layout_background":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","private":true,"default":0,"minimum":0,"maximum":1,"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":{},"round":{},"square":{}},"default":"butt","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":{},"round":{},"miter":{}},"default":"miter","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"requires":[{"line-join":"miter"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"requires":[{"line-join":"round"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":{},"line":{},"line-center":{}},"default":"point","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"units":"pixels","requires":[{"symbol-placement":"line"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":{},"viewport-y":{},"source":{}},"default":"auto","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"units":"factor of the original icon size","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":{},"width":{},"height":{},"both":{}},"default":"none","requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"units":"pixels","requires":["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"requires":["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"units":"ems","requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":{},"left":{},"center":{},"right":{}},"default":"center","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","units":"ems","default":0,"requires":["text-field"],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["text-field",{"!":"text-variable-anchor"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"units":"degrees","requires":["text-field",{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":{},"vertical":{}},"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"requires":["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":{},"uppercase":{},"lowercase":{}},"default":"none","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","units":"ems","length":2,"default":[0,0],"requires":["text-field",{"!":"text-radial-offset"}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"requires":["text-field","icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},"in":{},"!in":{},"all":{},"any":{},"none":{},"has":{},"!has":{},"within":{}}},"geometry_type":{"type":"enum","values":{"Point":{},"LineString":{},"Polygon":{}}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":{},"exponential":{},"interval":{},"categorical":{}},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":{},"lab":{},"hcl":{}},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":{},"viewport":{}},"property-type":"data-constant","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":{},"equalEarth":{},"equirectangular":{},"lambertConformalConic":{},"mercator":{},"naturalEarth":{},"winkelTripel":{},"globe":{}},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["source"]}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"requires":[{"!":"fill-pattern"},{"fill-antialias":true}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-extrusion-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-extrusion-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"requires":["fill-extrusion-height"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","private":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["fill-extrusion-edge-radius"]}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"line-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["line-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"transition":false,"units":"line widths","requires":[{"!":"line-pattern"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","transition":false,"requires":[{"!":"line-pattern"},{"source":"geojson","has":{"lineMetrics":true}}],"expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"transition":false,"requires":[{"source":"geojson","has":{"lineMetrics":true}}],"property-type":"constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["circle-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"transition":false,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"transition":false,"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["icon-image","icon-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["text-field","text-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"units":"degrees","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":{},"nearest":{}},"default":"linear","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"transition":false,"units":"milliseconds","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"transition":false,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"background-pattern"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":{},"atmosphere":{}},"default":"atmosphere","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"requires":[{"sky-type":"atmosphere"}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","requires":[{"sky-type":"atmosphere"}],"default":10,"minimum":0,"maximum":100,"transition":false,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","requires":[{"sky-type":"gradient"}],"value":"number","default":[0,0],"length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","requires":[{"sky-type":"gradient"}],"default":90,"minimum":0,"maximum":180,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"transition":false,"requires":[{"sky-type":"gradient"}],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0,"units":"milliseconds"},"delay":{"type":"number","default":0,"minimum":0,"units":"milliseconds"}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function Sa(u,...l){for(const c of l)for(const d in c)u[d]=c[d];return u}function bi(u){return u instanceof Number||u instanceof String||u instanceof Boolean?u.valueOf():u}function wl(u){if(Array.isArray(u))return u.map(wl);if(u instanceof Object&&!(u instanceof Number||u instanceof String||u instanceof Boolean)){const l={};for(const c in u)l[c]=wl(u[c]);return l}return bi(u)}class TC extends Error{constructor(l,c){super(c),this.message=c,this.key=l}}var ds=TC;class jc{constructor(l,c=[]){this.parent=l,this.bindings={};for(const[d,y]of c)this.bindings[d]=y}concat(l){return new jc(this,l)}get(l){if(this.bindings[l])return this.bindings[l];if(this.parent)return this.parent.get(l);throw new Error(`${l} not found in scope.`)}has(l){return!!this.bindings[l]||!!this.parent&&this.parent.has(l)}}var OC=jc;const zc={kind:"null"},Ut={kind:"number"},rn={kind:"string"},qr={kind:"boolean"},ps={kind:"color"},mu={kind:"object"},Gr={kind:"value"},Eh={kind:"collator"},Fc={kind:"formatted"},Hc={kind:"resolvedImage"};function Mo(u,l){return{kind:"array",itemType:u,N:l}}function zn(u){if(u.kind==="array"){const l=zn(u.itemType);return typeof u.N=="number"?`array<${l}, ${u.N}>`:u.itemType.kind==="value"?"array":`array<${l}>`}return u.kind}const RC=[zc,Ut,rn,qr,ps,Fc,mu,Mo(Gr),Hc];function zo(u,l){if(l.kind==="error")return null;if(u.kind==="array"){if(l.kind==="array"&&(l.N===0&&l.itemType.kind==="value"||!zo(u.itemType,l.itemType))&&(typeof u.N!="number"||u.N===l.N))return null}else{if(u.kind===l.kind)return null;if(u.kind==="value"){for(const c of RC)if(!zo(c,l))return null}}return`Expected ${zn(u)} but found ${zn(l)} instead.`}function cb(u,l){return l.some(c=>c.kind===u.kind)}function yu(u,l){return l.some(c=>c==="null"?u===null:c==="array"?Array.isArray(u):c==="object"?u&&!Array.isArray(u)&&typeof u=="object":c===typeof u)}var fb,am={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function Th(u){return(u=Math.round(u))<0?0:u>255?255:u}function gu(u){return Th(u[u.length-1]==="%"?parseFloat(u)/100*255:parseInt(u))}function Vc(u){return(l=u[u.length-1]==="%"?parseFloat(u)/100:parseFloat(u))<0?0:l>1?1:l;var l}function hb(u,l,c){return c<0?c+=1:c>1&&(c-=1),6*c<1?u+(l-u)*c*6:2*c<1?l:3*c<2?u+(l-u)*(2/3-c)*6:u}try{fb={}.parseCSSColor=function(u){var l,c=u.replace(/ /g,"").toLowerCase();if(c in am)return am[c].slice();if(c[0]==="#")return c.length===4?(l=parseInt(c.substr(1),16))>=0&&l<=4095?[(3840&l)>>4|(3840&l)>>8,240&l|(240&l)>>4,15&l|(15&l)<<4,1]:null:c.length===7&&(l=parseInt(c.substr(1),16))>=0&&l<=16777215?[(16711680&l)>>16,(65280&l)>>8,255&l,1]:null;var d=c.indexOf("("),y=c.indexOf(")");if(d!==-1&&y+1===c.length){var _=c.substr(0,d),w=c.substr(d+1,y-(d+1)).split(","),C=1;switch(_){case"rgba":if(w.length!==4)return null;C=Vc(w.pop());case"rgb":return w.length!==3?null:[gu(w[0]),gu(w[1]),gu(w[2]),C];case"hsla":if(w.length!==4)return null;C=Vc(w.pop());case"hsl":if(w.length!==3)return null;var O=(parseFloat(w[0])%360+360)%360/360,k=Vc(w[1]),M=Vc(w[2]),N=M<=.5?M*(k+1):M+k-M*k,B=2*M-N;return[Th(255*hb(B,N,O+1/3)),Th(255*hb(B,N,O)),Th(255*hb(B,N,O-1/3)),C];default:return null}}return null}}catch{}class Fo{constructor(l,c,d,y=1){this.r=l,this.g=c,this.b=d,this.a=y}static parse(l){if(!l)return;if(l instanceof Fo)return l;if(typeof l!="string")return;const c=fb(l);return c?new Fo(c[0]/255*c[3],c[1]/255*c[3],c[2]/255*c[3],c[3]):void 0}toString(){const[l,c,d,y]=this.toArray();return`rgba(${Math.round(l)},${Math.round(c)},${Math.round(d)},${y})`}toArray(){const{r:l,g:c,b:d,a:y}=this;return y===0?[0,0,0,0]:[255*l/y,255*c/y,255*d/y,y]}toArray01(){const{r:l,g:c,b:d,a:y}=this;return y===0?[0,0,0,0]:[l/y,c/y,d/y,y]}toArray01PremultipliedAlpha(){const{r:l,g:c,b:d,a:y}=this;return[l,c,d,y]}}Fo.black=new Fo(0,0,0,1),Fo.white=new Fo(1,1,1,1),Fo.transparent=new Fo(0,0,0,0),Fo.red=new Fo(1,0,0,1),Fo.blue=new Fo(0,0,1,1);var wi=Fo;class sm{constructor(l,c,d){this.sensitivity=l?c?"variant":"case":c?"accent":"base",this.locale=d,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(l,c){return this.collator.compare(l,c)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Oh{constructor(l,c,d,y,_){this.text=l.normalize?l.normalize():l,this.image=c,this.scale=d,this.fontStack=y,this.textColor=_}}class Ho{constructor(l){this.sections=l}static fromString(l){return new Ho([new Oh(l,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(l=>l.text.length!==0||l.image&&l.image.name.length!==0)}static factory(l){return l instanceof Ho?l:Ho.fromString(l)}toString(){return this.sections.length===0?"":this.sections.map(l=>l.text).join("")}serialize(){const l=["format"];for(const c of this.sections){if(c.image){l.push(["image",c.image.name]);continue}l.push(c.text);const d={};c.fontStack&&(d["text-font"]=["literal",c.fontStack.split(",")]),c.scale&&(d["font-scale"]=c.scale),c.textColor&&(d["text-color"]=["rgba"].concat(c.textColor.toArray())),l.push(d)}return l}}class Do{constructor(l){this.name=l.name,this.available=l.available}toString(){return this.name}static fromString(l){return l?new Do({name:l,available:!1}):null}serialize(){return["image",this.name]}}function kC(u,l,c,d){return typeof u=="number"&&u>=0&&u<=255&&typeof l=="number"&&l>=0&&l<=255&&typeof c=="number"&&c>=0&&c<=255?d===void 0||typeof d=="number"&&d>=0&&d<=1?null:`Invalid rgba value [${[u,l,c,d].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof d=="number"?[u,l,c,d]:[u,l,c]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function lm(u){if(u===null||typeof u=="string"||typeof u=="boolean"||typeof u=="number"||u instanceof wi||u instanceof sm||u instanceof Ho||u instanceof Do)return!0;if(Array.isArray(u)){for(const l of u)if(!lm(l))return!1;return!0}if(typeof u=="object"){for(const l in u)if(!lm(u[l]))return!1;return!0}return!1}function zi(u){if(u===null)return zc;if(typeof u=="string")return rn;if(typeof u=="boolean")return qr;if(typeof u=="number")return Ut;if(u instanceof wi)return ps;if(u instanceof sm)return Eh;if(u instanceof Ho)return Fc;if(u instanceof Do)return Hc;if(Array.isArray(u)){const l=u.length;let c;for(const d of u){const y=zi(d);if(c){if(c===y)continue;c=Gr;break}c=y}return Mo(c||Gr,l)}return mu}function Rh(u){const l=typeof u;return u===null?"":l==="string"||l==="number"||l==="boolean"?String(u):u instanceof wi||u instanceof Ho||u instanceof Do?u.toString():JSON.stringify(u)}class db{constructor(l,c){this.type=l,this.value=c}static parse(l,c){if(l.length!==2)return c.error(`'literal' expression requires exactly one argument, but found ${l.length-1} instead.`);if(!lm(l[1]))return c.error("invalid value");const d=l[1];let y=zi(d);const _=c.expectedType;return y.kind!=="array"||y.N!==0||!_||_.kind!=="array"||typeof _.N=="number"&&_.N!==0||(y=_),new db(y,d)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof wi?["rgba"].concat(this.value.toArray()):this.value instanceof Ho?this.value.serialize():this.value}}var kh=db,lo=class{constructor(u){this.name="ExpressionEvaluationError",this.message=u}toJSON(){return this.message}};const um={string:rn,number:Ut,boolean:qr,object:mu};class Uc{constructor(l,c){this.type=l,this.args=c}static parse(l,c){if(l.length<2)return c.error("Expected at least one argument.");let d,y=1;const _=l[0];if(_==="array"){let C,O;if(l.length>2){const k=l[1];if(typeof k!="string"||!(k in um)||k==="object")return c.error('The item type argument of "array" must be one of string, number, boolean',1);C=um[k],y++}else C=Gr;if(l.length>3){if(l[2]!==null&&(typeof l[2]!="number"||l[2]<0||l[2]!==Math.floor(l[2])))return c.error('The length argument to "array" must be a positive integer literal',2);O=l[2],y++}d=Mo(C,O)}else d=um[_];const w=[];for(;y<l.length;y++){const C=c.parse(l[y],y,Gr);if(!C)return null;w.push(C)}return new Uc(d,w)}evaluate(l){for(let c=0;c<this.args.length;c++){const d=this.args[c].evaluate(l);if(!zo(this.type,zi(d)))return d;if(c===this.args.length-1)throw new lo(`Expected value to be of type ${zn(this.type)}, but found ${zn(zi(d))} instead.`)}return null}eachChild(l){this.args.forEach(l)}outputDefined(){return this.args.every(l=>l.outputDefined())}serialize(){const l=this.type,c=[l.kind];if(l.kind==="array"){const d=l.itemType;if(d.kind==="string"||d.kind==="number"||d.kind==="boolean"){c.push(d.kind);const y=l.N;(typeof y=="number"||this.args.length>1)&&c.push(y)}}return c.concat(this.args.map(d=>d.serialize()))}}var Hs=Uc;class Ph{constructor(l){this.type=Fc,this.sections=l}static parse(l,c){if(l.length<2)return c.error("Expected at least one argument.");const d=l[1];if(!Array.isArray(d)&&typeof d=="object")return c.error("First argument must be an image or text section.");const y=[];let _=!1;for(let w=1;w<=l.length-1;++w){const C=l[w];if(_&&typeof C=="object"&&!Array.isArray(C)){_=!1;let O=null;if(C["font-scale"]&&(O=c.parse(C["font-scale"],1,Ut),!O))return null;let k=null;if(C["text-font"]&&(k=c.parse(C["text-font"],1,Mo(rn)),!k))return null;let M=null;if(C["text-color"]&&(M=c.parse(C["text-color"],1,ps),!M))return null;const N=y[y.length-1];N.scale=O,N.font=k,N.textColor=M}else{const O=c.parse(l[w],1,Gr);if(!O)return null;const k=O.type.kind;if(k!=="string"&&k!=="value"&&k!=="null"&&k!=="resolvedImage")return c.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");_=!0,y.push({content:O,scale:null,font:null,textColor:null})}}return new Ph(y)}evaluate(l){return new Ho(this.sections.map(c=>{const d=c.content.evaluate(l);return zi(d)===Hc?new Oh("",d,null,null,null):new Oh(Rh(d),null,c.scale?c.scale.evaluate(l):null,c.font?c.font.evaluate(l).join(","):null,c.textColor?c.textColor.evaluate(l):null)}))}eachChild(l){for(const c of this.sections)l(c.content),c.scale&&l(c.scale),c.font&&l(c.font),c.textColor&&l(c.textColor)}outputDefined(){return!1}serialize(){const l=["format"];for(const c of this.sections){l.push(c.content.serialize());const d={};c.scale&&(d["font-scale"]=c.scale.serialize()),c.font&&(d["text-font"]=c.font.serialize()),c.textColor&&(d["text-color"]=c.textColor.serialize()),l.push(d)}return l}}class cm{constructor(l){this.type=Hc,this.input=l}static parse(l,c){if(l.length!==2)return c.error("Expected two arguments.");const d=c.parse(l[1],1,rn);return d?new cm(d):c.error("No image name provided.")}evaluate(l){const c=this.input.evaluate(l),d=Do.fromString(c);return d&&l.availableImages&&(d.available=l.availableImages.indexOf(c)>-1),d}eachChild(l){l(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const fI={"to-boolean":qr,"to-color":ps,"to-number":Ut,"to-string":rn};class pb{constructor(l,c){this.type=l,this.args=c}static parse(l,c){if(l.length<2)return c.error("Expected at least one argument.");const d=l[0];if((d==="to-boolean"||d==="to-string")&&l.length!==2)return c.error("Expected one argument.");const y=fI[d],_=[];for(let w=1;w<l.length;w++){const C=c.parse(l[w],w,Gr);if(!C)return null;_.push(C)}return new pb(y,_)}evaluate(l){if(this.type.kind==="boolean")return!!this.args[0].evaluate(l);if(this.type.kind==="color"){let c,d;for(const y of this.args){if(c=y.evaluate(l),d=null,c instanceof wi)return c;if(typeof c=="string"){const _=l.parseColor(c);if(_)return _}else if(Array.isArray(c)&&(d=c.length<3||c.length>4?`Invalid rbga value ${JSON.stringify(c)}: expected an array containing either three or four numeric values.`:kC(c[0],c[1],c[2],c[3]),!d))return new wi(c[0]/255,c[1]/255,c[2]/255,c[3])}throw new lo(d||`Could not parse color from value '${typeof c=="string"?c:String(JSON.stringify(c))}'`)}if(this.type.kind==="number"){let c=null;for(const d of this.args){if(c=d.evaluate(l),c===null)return 0;const y=Number(c);if(!isNaN(y))return y}throw new lo(`Could not convert ${JSON.stringify(c)} to number.`)}return this.type.kind==="formatted"?Ho.fromString(Rh(this.args[0].evaluate(l))):this.type.kind==="resolvedImage"?Do.fromString(Rh(this.args[0].evaluate(l))):Rh(this.args[0].evaluate(l))}eachChild(l){this.args.forEach(l)}outputDefined(){return this.args.every(l=>l.outputDefined())}serialize(){if(this.type.kind==="formatted")return new Ph([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new cm(this.args[0]).serialize();const l=[`to-${this.type.kind}`];return this.eachChild(c=>{l.push(c.serialize())}),l}}var Wc=pb;const PC=["Unknown","Point","LineString","Polygon"];var Ah=class{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?PC[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const u=this.featureDistanceData.center,l=this.featureDistanceData.scale,{x:c,y:d}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(c*l-u[0])+this.featureDistanceData.bearing[1]*(d*l-u[1])}return 0}parseColor(u){let l=this._parseColorCache[u];return l||(l=this._parseColorCache[u]=wi.parse(u)),l}};class Gc{constructor(l,c,d,y){this.name=l,this.type=c,this._evaluate=d,this.args=y}evaluate(l){return this._evaluate(l,this.args)}eachChild(l){this.args.forEach(l)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(l=>l.serialize()))}static parse(l,c){const d=l[0],y=Gc.definitions[d];if(!y)return c.error(`Unknown expression "${d}". If you wanted a literal array, use ["literal", [...]].`,0);const _=Array.isArray(y)?y[0]:y.type,w=Array.isArray(y)?[[y[1],y[2]]]:y.overloads,C=w.filter(([k])=>!Array.isArray(k)||k.length===l.length-1);let O=null;for(const[k,M]of C){O=new bb(c.registry,c.path,null,c.scope);const N=[];let B=!1;for(let W=1;W<l.length;W++){const Y=l[W],J=Array.isArray(k)?k[W-1]:k.type,ie=O.parse(Y,1+N.length,J);if(!ie){B=!0;break}N.push(ie)}if(!B)if(Array.isArray(k)&&k.length!==N.length)O.error(`Expected ${k.length} arguments, but found ${N.length} instead.`);else{for(let W=0;W<N.length;W++){const Y=Array.isArray(k)?k[W]:k.type,J=N[W];O.concat(W+1).checkSubtype(Y,J.type)}if(O.errors.length===0)return new Gc(d,_,M,N)}}if(C.length===1)c.errors.push(...O.errors);else{const k=(C.length?C:w).map(([N])=>{return B=N,Array.isArray(B)?`(${B.map(zn).join(", ")})`:`(${zn(B.type)}...)`;var B}).join(" | "),M=[];for(let N=1;N<l.length;N++){const B=c.parse(l[N],1+M.length);if(!B)return null;M.push(zn(B.type))}c.error(`Expected arguments of type ${k}, but found (${M.join(", ")}) instead.`)}return null}static register(l,c){Gc.definitions=c;for(const d in c)l[d]=Gc}}var Sl=Gc;class fm{constructor(l,c,d){this.type=Eh,this.locale=d,this.caseSensitive=l,this.diacriticSensitive=c}static parse(l,c){if(l.length!==2)return c.error("Expected one argument.");const d=l[1];if(typeof d!="object"||Array.isArray(d))return c.error("Collator options argument must be an object.");const y=c.parse(d["case-sensitive"]!==void 0&&d["case-sensitive"],1,qr);if(!y)return null;const _=c.parse(d["diacritic-sensitive"]!==void 0&&d["diacritic-sensitive"],1,qr);if(!_)return null;let w=null;return d.locale&&(w=c.parse(d.locale,1,rn),!w)?null:new fm(y,_,w)}evaluate(l){return new sm(this.caseSensitive.evaluate(l),this.diacriticSensitive.evaluate(l),this.locale?this.locale.evaluate(l):null)}eachChild(l){l(this.caseSensitive),l(this.diacriticSensitive),this.locale&&l(this.locale)}outputDefined(){return!1}serialize(){const l={};return l["case-sensitive"]=this.caseSensitive.serialize(),l["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(l.locale=this.locale.serialize()),["collator",l]}}const xl=8192;function xa(u,l){u[0]=Math.min(u[0],l[0]),u[1]=Math.min(u[1],l[1]),u[2]=Math.max(u[2],l[0]),u[3]=Math.max(u[3],l[1])}function Ih(u,l){return!(u[0]<=l[0]||u[2]>=l[2]||u[1]<=l[1]||u[3]>=l[3])}function AC(u,l){const c=(180+u[0])/360,d=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+u[1]*Math.PI/360)))/360,y=Math.pow(2,l.z);return[Math.round(c*y*xl),Math.round(d*y*xl)]}function IC(u,l,c){const d=u[0]-l[0],y=u[1]-l[1],_=u[0]-c[0],w=u[1]-c[1];return d*w-_*y==0&&d*_<=0&&y*w<=0}function hm(u,l){let c=!1;for(let w=0,C=l.length;w<C;w++){const O=l[w];for(let k=0,M=O.length;k<M-1;k++){if(IC(u,O[k],O[k+1]))return!1;(y=O[k])[1]>(d=u)[1]!=(_=O[k+1])[1]>d[1]&&d[0]<(_[0]-y[0])*(d[1]-y[1])/(_[1]-y[1])+y[0]&&(c=!c)}}var d,y,_;return c}function MC(u,l){for(let c=0;c<l.length;c++)if(hm(u,l[c]))return!0;return!1}function mb(u,l,c,d){const y=d[0]-c[0],_=d[1]-c[1],w=(u[0]-c[0])*_-y*(u[1]-c[1]),C=(l[0]-c[0])*_-y*(l[1]-c[1]);return w>0&&C<0||w<0&&C>0}function yb(u,l,c){for(const k of c)for(let M=0;M<k.length-1;++M)if((C=[(w=k[M+1])[0]-(_=k[M])[0],w[1]-_[1]])[0]*(O=[(y=l)[0]-(d=u)[0],y[1]-d[1]])[1]-C[1]*O[0]!=0&&mb(d,y,_,w)&&mb(_,w,d,y))return!0;var d,y,_,w,C,O;return!1}function Yc(u,l){for(let c=0;c<u.length;++c)if(!hm(u[c],l))return!1;for(let c=0;c<u.length-1;++c)if(yb(u[c],u[c+1],l))return!1;return!0}function DC(u,l){for(let c=0;c<l.length;c++)if(Yc(u,l[c]))return!0;return!1}function dm(u,l,c){const d=[];for(let y=0;y<u.length;y++){const _=[];for(let w=0;w<u[y].length;w++){const C=AC(u[y][w],c);xa(l,C),_.push(C)}d.push(_)}return d}function pm(u,l,c){const d=[];for(let y=0;y<u.length;y++){const _=dm(u[y],l,c);d.push(_)}return d}function gb(u,l,c,d){if(u[0]<c[0]||u[0]>c[2]){const y=.5*d;let _=u[0]-c[0]>y?-d:c[0]-u[0]>y?d:0;_===0&&(_=u[0]-c[2]>y?-d:c[2]-u[0]>y?d:0),u[0]+=_}xa(l,u)}function vu(u,l,c,d){const y=Math.pow(2,d.z)*xl,_=[d.x*xl,d.y*xl],w=[];if(!u)return w;for(const C of u)for(const O of C){const k=[O.x+_[0],O.y+_[1]];gb(k,l,c,y),w.push(k)}return w}function Cn(u,l,c,d){const y=Math.pow(2,d.z)*xl,_=[d.x*xl,d.y*xl],w=[];if(!u)return w;for(const O of u){const k=[];for(const M of O){const N=[M.x+_[0],M.y+_[1]];xa(l,N),k.push(N)}w.push(k)}if(l[2]-l[0]<=y/2){(C=l)[0]=C[1]=1/0,C[2]=C[3]=-1/0;for(const O of w)for(const k of O)gb(k,l,c,y)}var C;return w}class Mh{constructor(l,c){this.type=qr,this.geojson=l,this.geometries=c}static parse(l,c){if(l.length!==2)return c.error(`'within' expression requires exactly one argument, but found ${l.length-1} instead.`);if(lm(l[1])){const d=l[1];if(d.type==="FeatureCollection")for(let y=0;y<d.features.length;++y){const _=d.features[y].geometry.type;if(_==="Polygon"||_==="MultiPolygon")return new Mh(d,d.features[y].geometry)}else if(d.type==="Feature"){const y=d.geometry.type;if(y==="Polygon"||y==="MultiPolygon")return new Mh(d,d.geometry)}else if(d.type==="Polygon"||d.type==="MultiPolygon")return new Mh(d,d)}return c.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(l){if(l.geometry()!=null&&l.canonicalID()!=null){if(l.geometryType()==="Point")return function(c,d){const y=[1/0,1/0,-1/0,-1/0],_=[1/0,1/0,-1/0,-1/0],w=c.canonicalID();if(!w)return!1;if(d.type==="Polygon"){const C=dm(d.coordinates,_,w),O=vu(c.geometry(),y,_,w);if(!Ih(y,_))return!1;for(const k of O)if(!hm(k,C))return!1}if(d.type==="MultiPolygon"){const C=pm(d.coordinates,_,w),O=vu(c.geometry(),y,_,w);if(!Ih(y,_))return!1;for(const k of O)if(!MC(k,C))return!1}return!0}(l,this.geometries);if(l.geometryType()==="LineString")return function(c,d){const y=[1/0,1/0,-1/0,-1/0],_=[1/0,1/0,-1/0,-1/0],w=c.canonicalID();if(!w)return!1;if(d.type==="Polygon"){const C=dm(d.coordinates,_,w),O=Cn(c.geometry(),y,_,w);if(!Ih(y,_))return!1;for(const k of O)if(!Yc(k,C))return!1}if(d.type==="MultiPolygon"){const C=pm(d.coordinates,_,w),O=Cn(c.geometry(),y,_,w);if(!Ih(y,_))return!1;for(const k of O)if(!DC(k,C))return!1}return!0}(l,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var vb=Mh;function Dh(u){if(u instanceof Sl&&(u.name==="get"&&u.args.length===1||u.name==="feature-state"||u.name==="has"&&u.args.length===1||u.name==="properties"||u.name==="geometry-type"||u.name==="id"||/^filter-/.test(u.name))||u instanceof vb)return!1;let l=!0;return u.eachChild(c=>{l&&!Dh(c)&&(l=!1)}),l}function $h(u){if(u instanceof Sl&&u.name==="feature-state")return!1;let l=!0;return u.eachChild(c=>{l&&!$h(c)&&(l=!1)}),l}function mm(u,l){if(u instanceof Sl&&l.indexOf(u.name)>=0)return!1;let c=!0;return u.eachChild(d=>{c&&!mm(d,l)&&(c=!1)}),c}class ym{constructor(l,c){this.type=c.type,this.name=l,this.boundExpression=c}static parse(l,c){if(l.length!==2||typeof l[1]!="string")return c.error("'var' expression requires exactly one string literal argument.");const d=l[1];return c.scope.has(d)?new ym(d,c.scope.get(d)):c.error(`Unknown variable "${d}". Make sure "${d}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(l){return this.boundExpression.evaluate(l)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var _b=ym;class gm{constructor(l,c=[],d,y=new OC,_=[]){this.registry=l,this.path=c,this.key=c.map(w=>`[${w}]`).join(""),this.scope=y,this.errors=_,this.expectedType=d}parse(l,c,d,y,_={}){return c?this.concat(c,d,y)._parse(l,_):this._parse(l,_)}_parse(l,c){function d(y,_,w){return w==="assert"?new Hs(_,[y]):w==="coerce"?new Wc(_,[y]):y}if(l!==null&&typeof l!="string"&&typeof l!="boolean"&&typeof l!="number"||(l=["literal",l]),Array.isArray(l)){if(l.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const y=l[0];if(typeof y!="string")return this.error(`Expression name must be a string, but found ${typeof y} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const _=this.registry[y];if(_){let w=_.parse(l,this);if(!w)return null;if(this.expectedType){const C=this.expectedType,O=w.type;if(C.kind!=="string"&&C.kind!=="number"&&C.kind!=="boolean"&&C.kind!=="object"&&C.kind!=="array"||O.kind!=="value")if(C.kind!=="color"&&C.kind!=="formatted"&&C.kind!=="resolvedImage"||O.kind!=="value"&&O.kind!=="string"){if(this.checkSubtype(C,O))return null}else w=d(w,C,c.typeAnnotation||"coerce");else w=d(w,C,c.typeAnnotation||"assert")}if(!(w instanceof kh)&&w.type.kind!=="resolvedImage"&&Cl(w)){const C=new Ah;try{w=new kh(w.type,w.evaluate(C))}catch(O){return this.error(O.message),null}}return w}return this.error(`Unknown expression "${y}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(l===void 0?"'undefined' value invalid. Use null instead.":typeof l=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof l} instead.`)}concat(l,c,d){const y=typeof l=="number"?this.path.concat(l):this.path,_=d?this.scope.concat(d):this.scope;return new gm(this.registry,y,c||null,_,this.errors)}error(l,...c){const d=`${this.key}${c.map(y=>`[${y}]`).join("")}`;this.errors.push(new ds(d,l))}checkSubtype(l,c){const d=zo(l,c);return d&&this.error(d),d}}var bb=gm;function Cl(u){if(u instanceof _b)return Cl(u.boundExpression);if(u instanceof Sl&&u.name==="error"||u instanceof fm||u instanceof vb)return!1;const l=u instanceof Wc||u instanceof Hs;let c=!0;return u.eachChild(d=>{c=l?c&&Cl(d):c&&d instanceof kh}),!!c&&Dh(u)&&mm(u,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"])}function _u(u,l){const c=u.length-1;let d,y,_=0,w=c,C=0;for(;_<=w;)if(C=Math.floor((_+w)/2),d=u[C],y=u[C+1],d<=l){if(C===c||l<y)return C;_=C+1}else{if(!(d>l))throw new lo("Input is not a number.");w=C-1}return 0}class vm{constructor(l,c,d){this.type=l,this.input=c,this.labels=[],this.outputs=[];for(const[y,_]of d)this.labels.push(y),this.outputs.push(_)}static parse(l,c){if(l.length-1<4)return c.error(`Expected at least 4 arguments, but found only ${l.length-1}.`);if((l.length-1)%2!=0)return c.error("Expected an even number of arguments.");const d=c.parse(l[1],1,Ut);if(!d)return null;const y=[];let _=null;c.expectedType&&c.expectedType.kind!=="value"&&(_=c.expectedType);for(let w=1;w<l.length;w+=2){const C=w===1?-1/0:l[w],O=l[w+1],k=w,M=w+1;if(typeof C!="number")return c.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',k);if(y.length&&y[y.length-1][0]>=C)return c.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',k);const N=c.parse(O,M,_);if(!N)return null;_=_||N.type,y.push([C,N])}return new vm(_,d,y)}evaluate(l){const c=this.labels,d=this.outputs;if(c.length===1)return d[0].evaluate(l);const y=this.input.evaluate(l);if(y<=c[0])return d[0].evaluate(l);const _=c.length;return y>=c[_-1]?d[_-1].evaluate(l):d[_u(c,y)].evaluate(l)}eachChild(l){l(this.input);for(const c of this.outputs)l(c)}outputDefined(){return this.outputs.every(l=>l.outputDefined())}serialize(){const l=["step",this.input.serialize()];for(let c=0;c<this.labels.length;c++)c>0&&l.push(this.labels[c]),l.push(this.outputs[c].serialize());return l}}var wb=vm;function mn(u,l,c){return u*(1-c)+l*c}var Lh=Object.freeze({__proto__:null,number:mn,color:function(u,l,c){return new wi(mn(u.r,l.r,c),mn(u.g,l.g,c),mn(u.b,l.b,c),mn(u.a,l.a,c))},array:function(u,l,c){return u.map((d,y)=>mn(d,l[y],c))}});const $C=.95047,LC=1.08883,Sb=4/29,xb=6/29,Cb=3*xb*xb,NC=Math.PI/180,hI=180/Math.PI;function _m(u){return u>.008856451679035631?Math.pow(u,1/3):u/Cb+Sb}function Eb(u){return u>xb?u*u*u:Cb*(u-Sb)}function bm(u){return 255*(u<=.0031308?12.92*u:1.055*Math.pow(u,1/2.4)-.055)}function wm(u){return(u/=255)<=.04045?u/12.92:Math.pow((u+.055)/1.055,2.4)}function BC(u){const l=wm(u.r),c=wm(u.g),d=wm(u.b),y=_m((.4124564*l+.3575761*c+.1804375*d)/$C),_=_m((.2126729*l+.7151522*c+.072175*d)/1);return{l:116*_-16,a:500*(y-_),b:200*(_-_m((.0193339*l+.119192*c+.9503041*d)/LC)),alpha:u.a}}function jC(u){let l=(u.l+16)/116,c=isNaN(u.a)?l:l+u.a/500,d=isNaN(u.b)?l:l-u.b/200;return l=1*Eb(l),c=$C*Eb(c),d=LC*Eb(d),new wi(bm(3.2404542*c-1.5371385*l-.4985314*d),bm(-.969266*c+1.8760108*l+.041556*d),bm(.0556434*c-.2040259*l+1.0572252*d),u.alpha)}function dI(u,l,c){const d=l-u;return u+c*(d>180||d<-180?d-360*Math.round(d/360):d)}const Nh={forward:BC,reverse:jC,interpolate:function(u,l,c){return{l:mn(u.l,l.l,c),a:mn(u.a,l.a,c),b:mn(u.b,l.b,c),alpha:mn(u.alpha,l.alpha,c)}}},Bh={forward:function(u){const{l,a:c,b:d}=BC(u),y=Math.atan2(d,c)*hI;return{h:y<0?y+360:y,c:Math.sqrt(c*c+d*d),l,alpha:u.a}},reverse:function(u){const l=u.h*NC,c=u.c;return jC({l:u.l,a:Math.cos(l)*c,b:Math.sin(l)*c,alpha:u.alpha})},interpolate:function(u,l,c){return{h:dI(u.h,l.h,c),c:mn(u.c,l.c,c),l:mn(u.l,l.l,c),alpha:mn(u.alpha,l.alpha,c)}}};var zC=Object.freeze({__proto__:null,lab:Nh,hcl:Bh});class jh{constructor(l,c,d,y,_){this.type=l,this.operator=c,this.interpolation=d,this.input=y,this.labels=[],this.outputs=[];for(const[w,C]of _)this.labels.push(w),this.outputs.push(C)}static interpolationFactor(l,c,d,y){let _=0;if(l.name==="exponential")_=Tb(c,l.base,d,y);else if(l.name==="linear")_=Tb(c,1,d,y);else if(l.name==="cubic-bezier"){const w=l.controlPoints;_=new G(w[0],w[1],w[2],w[3]).solve(Tb(c,1,d,y))}return _}static parse(l,c){let[d,y,_,...w]=l;if(!Array.isArray(y)||y.length===0)return c.error("Expected an interpolation type expression.",1);if(y[0]==="linear")y={name:"linear"};else if(y[0]==="exponential"){const k=y[1];if(typeof k!="number")return c.error("Exponential interpolation requires a numeric base.",1,1);y={name:"exponential",base:k}}else{if(y[0]!=="cubic-bezier")return c.error(`Unknown interpolation type ${String(y[0])}`,1,0);{const k=y.slice(1);if(k.length!==4||k.some(M=>typeof M!="number"||M<0||M>1))return c.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);y={name:"cubic-bezier",controlPoints:k}}}if(l.length-1<4)return c.error(`Expected at least 4 arguments, but found only ${l.length-1}.`);if((l.length-1)%2!=0)return c.error("Expected an even number of arguments.");if(_=c.parse(_,2,Ut),!_)return null;const C=[];let O=null;d==="interpolate-hcl"||d==="interpolate-lab"?O=ps:c.expectedType&&c.expectedType.kind!=="value"&&(O=c.expectedType);for(let k=0;k<w.length;k+=2){const M=w[k],N=w[k+1],B=k+3,W=k+4;if(typeof M!="number")return c.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',B);if(C.length&&C[C.length-1][0]>=M)return c.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',B);const Y=c.parse(N,W,O);if(!Y)return null;O=O||Y.type,C.push([M,Y])}return O.kind==="number"||O.kind==="color"||O.kind==="array"&&O.itemType.kind==="number"&&typeof O.N=="number"?new jh(O,d,y,_,C):c.error(`Type ${zn(O)} is not interpolatable.`)}evaluate(l){const c=this.labels,d=this.outputs;if(c.length===1)return d[0].evaluate(l);const y=this.input.evaluate(l);if(y<=c[0])return d[0].evaluate(l);const _=c.length;if(y>=c[_-1])return d[_-1].evaluate(l);const w=_u(c,y),C=jh.interpolationFactor(this.interpolation,y,c[w],c[w+1]),O=d[w].evaluate(l),k=d[w+1].evaluate(l);return this.operator==="interpolate"?Lh[this.type.kind.toLowerCase()](O,k,C):this.operator==="interpolate-hcl"?Bh.reverse(Bh.interpolate(Bh.forward(O),Bh.forward(k),C)):Nh.reverse(Nh.interpolate(Nh.forward(O),Nh.forward(k),C))}eachChild(l){l(this.input);for(const c of this.outputs)l(c)}outputDefined(){return this.outputs.every(l=>l.outputDefined())}serialize(){let l;l=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const c=[this.operator,l,this.input.serialize()];for(let d=0;d<this.labels.length;d++)c.push(this.labels[d],this.outputs[d].serialize());return c}}function Tb(u,l,c,d){const y=d-c,_=u-c;return y===0?0:l===1?_/y:(Math.pow(l,_)-1)/(Math.pow(l,y)-1)}var ms=jh;class Ob{constructor(l,c){this.type=l,this.args=c}static parse(l,c){if(l.length<2)return c.error("Expectected at least one argument.");let d=null;const y=c.expectedType;y&&y.kind!=="value"&&(d=y);const _=[];for(const C of l.slice(1)){const O=c.parse(C,1+_.length,d,void 0,{typeAnnotation:"omit"});if(!O)return null;d=d||O.type,_.push(O)}const w=y&&_.some(C=>zo(y,C.type));return new Ob(w?Gr:d,_)}evaluate(l){let c,d=null,y=0;for(const _ of this.args){if(y++,d=_.evaluate(l),d&&d instanceof Do&&!d.available&&(c||(c=d),d=null,y===this.args.length))return c;if(d!==null)break}return d}eachChild(l){this.args.forEach(l)}outputDefined(){return this.args.every(l=>l.outputDefined())}serialize(){const l=["coalesce"];return this.eachChild(c=>{l.push(c.serialize())}),l}}var FC=Ob;class Sm{constructor(l,c){this.type=c.type,this.bindings=[].concat(l),this.result=c}evaluate(l){return this.result.evaluate(l)}eachChild(l){for(const c of this.bindings)l(c[1]);l(this.result)}static parse(l,c){if(l.length<4)return c.error(`Expected at least 3 arguments, but found ${l.length-1} instead.`);const d=[];for(let _=1;_<l.length-1;_+=2){const w=l[_];if(typeof w!="string")return c.error(`Expected string, but found ${typeof w} instead.`,_);if(/[^a-zA-Z0-9_]/.test(w))return c.error("Variable names must contain only alphanumeric characters or '_'.",_);const C=c.parse(l[_+1],_+1);if(!C)return null;d.push([w,C])}const y=c.parse(l[l.length-1],l.length-1,c.expectedType,d);return y?new Sm(d,y):null}outputDefined(){return this.result.outputDefined()}serialize(){const l=["let"];for(const[c,d]of this.bindings)l.push(c,d.serialize());return l.push(this.result.serialize()),l}}var Rb=Sm;class xm{constructor(l,c,d){this.type=l,this.index=c,this.input=d}static parse(l,c){if(l.length!==3)return c.error(`Expected 2 arguments, but found ${l.length-1} instead.`);const d=c.parse(l[1],1,Ut),y=c.parse(l[2],2,Mo(c.expectedType||Gr));return d&&y?new xm(y.type.itemType,d,y):null}evaluate(l){const c=this.index.evaluate(l),d=this.input.evaluate(l);if(c<0)throw new lo(`Array index out of bounds: ${c} < 0.`);if(c>=d.length)throw new lo(`Array index out of bounds: ${c} > ${d.length-1}.`);if(c!==Math.floor(c))throw new lo(`Array index must be an integer, but found ${c} instead.`);return d[c]}eachChild(l){l(this.index),l(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}var pI=xm;class kb{constructor(l,c){this.type=qr,this.needle=l,this.haystack=c}static parse(l,c){if(l.length!==3)return c.error(`Expected 2 arguments, but found ${l.length-1} instead.`);const d=c.parse(l[1],1,Gr),y=c.parse(l[2],2,Gr);return d&&y?cb(d.type,[qr,rn,Ut,zc,Gr])?new kb(d,y):c.error(`Expected first argument to be of type boolean, string, number or null, but found ${zn(d.type)} instead`):null}evaluate(l){const c=this.needle.evaluate(l),d=this.haystack.evaluate(l);if(d==null)return!1;if(!yu(c,["boolean","string","number","null"]))throw new lo(`Expected first argument to be of type boolean, string, number or null, but found ${zn(zi(c))} instead.`);if(!yu(d,["string","array"]))throw new lo(`Expected second argument to be of type array or string, but found ${zn(zi(d))} instead.`);return d.indexOf(c)>=0}eachChild(l){l(this.needle),l(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var HC=kb;class zh{constructor(l,c,d){this.type=Ut,this.needle=l,this.haystack=c,this.fromIndex=d}static parse(l,c){if(l.length<=2||l.length>=5)return c.error(`Expected 3 or 4 arguments, but found ${l.length-1} instead.`);const d=c.parse(l[1],1,Gr),y=c.parse(l[2],2,Gr);if(!d||!y)return null;if(!cb(d.type,[qr,rn,Ut,zc,Gr]))return c.error(`Expected first argument to be of type boolean, string, number or null, but found ${zn(d.type)} instead`);if(l.length===4){const _=c.parse(l[3],3,Ut);return _?new zh(d,y,_):null}return new zh(d,y)}evaluate(l){const c=this.needle.evaluate(l),d=this.haystack.evaluate(l);if(!yu(c,["boolean","string","number","null"]))throw new lo(`Expected first argument to be of type boolean, string, number or null, but found ${zn(zi(c))} instead.`);if(!yu(d,["string","array"]))throw new lo(`Expected second argument to be of type array or string, but found ${zn(zi(d))} instead.`);if(this.fromIndex){const y=this.fromIndex.evaluate(l);return d.indexOf(c,y)}return d.indexOf(c)}eachChild(l){l(this.needle),l(this.haystack),this.fromIndex&&l(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const l=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),l]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var VC=zh;class Pb{constructor(l,c,d,y,_,w){this.inputType=l,this.type=c,this.input=d,this.cases=y,this.outputs=_,this.otherwise=w}static parse(l,c){if(l.length<5)return c.error(`Expected at least 4 arguments, but found only ${l.length-1}.`);if(l.length%2!=1)return c.error("Expected an even number of arguments.");let d,y;c.expectedType&&c.expectedType.kind!=="value"&&(y=c.expectedType);const _={},w=[];for(let k=2;k<l.length-1;k+=2){let M=l[k];const N=l[k+1];Array.isArray(M)||(M=[M]);const B=c.concat(k);if(M.length===0)return B.error("Expected at least one branch label.");for(const Y of M){if(typeof Y!="number"&&typeof Y!="string")return B.error("Branch labels must be numbers or strings.");if(typeof Y=="number"&&Math.abs(Y)>Number.MAX_SAFE_INTEGER)return B.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof Y=="number"&&Math.floor(Y)!==Y)return B.error("Numeric branch labels must be integer values.");if(d){if(B.checkSubtype(d,zi(Y)))return null}else d=zi(Y);if(_[String(Y)]!==void 0)return B.error("Branch labels must be unique.");_[String(Y)]=w.length}const W=c.parse(N,k,y);if(!W)return null;y=y||W.type,w.push(W)}const C=c.parse(l[1],1,Gr);if(!C)return null;const O=c.parse(l[l.length-1],l.length-1,y);return O?C.type.kind!=="value"&&c.concat(1).checkSubtype(d,C.type)?null:new Pb(d,y,C,_,w,O):null}evaluate(l){const c=this.input.evaluate(l);return(zi(c)===this.inputType&&this.outputs[this.cases[c]]||this.otherwise).evaluate(l)}eachChild(l){l(this.input),this.outputs.forEach(l),l(this.otherwise)}outputDefined(){return this.outputs.every(l=>l.outputDefined())&&this.otherwise.outputDefined()}serialize(){const l=["match",this.input.serialize()],c=Object.keys(this.cases).sort(),d=[],y={};for(const w of c){const C=y[this.cases[w]];C===void 0?(y[this.cases[w]]=d.length,d.push([this.cases[w],[w]])):d[C][1].push(w)}const _=w=>this.inputType.kind==="number"?Number(w):w;for(const[w,C]of d)l.push(C.length===1?_(C[0]):C.map(_)),l.push(this.outputs[w].serialize());return l.push(this.otherwise.serialize()),l}}var mI=Pb;class Ab{constructor(l,c,d){this.type=l,this.branches=c,this.otherwise=d}static parse(l,c){if(l.length<4)return c.error(`Expected at least 3 arguments, but found only ${l.length-1}.`);if(l.length%2!=0)return c.error("Expected an odd number of arguments.");let d;c.expectedType&&c.expectedType.kind!=="value"&&(d=c.expectedType);const y=[];for(let w=1;w<l.length-1;w+=2){const C=c.parse(l[w],w,qr);if(!C)return null;const O=c.parse(l[w+1],w+1,d);if(!O)return null;y.push([C,O]),d=d||O.type}const _=c.parse(l[l.length-1],l.length-1,d);return _?new Ab(d,y,_):null}evaluate(l){for(const[c,d]of this.branches)if(c.evaluate(l))return d.evaluate(l);return this.otherwise.evaluate(l)}eachChild(l){for(const[c,d]of this.branches)l(c),l(d);l(this.otherwise)}outputDefined(){return this.branches.every(([l,c])=>c.outputDefined())&&this.otherwise.outputDefined()}serialize(){const l=["case"];return this.eachChild(c=>{l.push(c.serialize())}),l}}var yI=Ab;class bu{constructor(l,c,d,y){this.type=l,this.input=c,this.beginIndex=d,this.endIndex=y}static parse(l,c){if(l.length<=2||l.length>=5)return c.error(`Expected 3 or 4 arguments, but found ${l.length-1} instead.`);const d=c.parse(l[1],1,Gr),y=c.parse(l[2],2,Ut);if(!d||!y)return null;if(!cb(d.type,[Mo(Gr),rn,Gr]))return c.error(`Expected first argument to be of type array or string, but found ${zn(d.type)} instead`);if(l.length===4){const _=c.parse(l[3],3,Ut);return _?new bu(d.type,d,y,_):null}return new bu(d.type,d,y)}evaluate(l){const c=this.input.evaluate(l),d=this.beginIndex.evaluate(l);if(!yu(c,["string","array"]))throw new lo(`Expected first argument to be of type array or string, but found ${zn(zi(c))} instead.`);if(this.endIndex){const y=this.endIndex.evaluate(l);return c.slice(d,y)}return c.slice(d)}eachChild(l){l(this.input),l(this.beginIndex),this.endIndex&&l(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const l=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),l]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var UC=bu;function Ib(u,l){return u==="=="||u==="!="?l.kind==="boolean"||l.kind==="string"||l.kind==="number"||l.kind==="null"||l.kind==="value":l.kind==="string"||l.kind==="number"||l.kind==="value"}function WC(u,l,c,d){return d.compare(l,c)===0}function Kc(u,l,c){const d=u!=="=="&&u!=="!=";return class pre{constructor(_,w,C){this.type=qr,this.lhs=_,this.rhs=w,this.collator=C,this.hasUntypedArgument=_.type.kind==="value"||w.type.kind==="value"}static parse(_,w){if(_.length!==3&&_.length!==4)return w.error("Expected two or three arguments.");const C=_[0];let O=w.parse(_[1],1,Gr);if(!O)return null;if(!Ib(C,O.type))return w.concat(1).error(`"${C}" comparisons are not supported for type '${zn(O.type)}'.`);let k=w.parse(_[2],2,Gr);if(!k)return null;if(!Ib(C,k.type))return w.concat(2).error(`"${C}" comparisons are not supported for type '${zn(k.type)}'.`);if(O.type.kind!==k.type.kind&&O.type.kind!=="value"&&k.type.kind!=="value")return w.error(`Cannot compare types '${zn(O.type)}' and '${zn(k.type)}'.`);d&&(O.type.kind==="value"&&k.type.kind!=="value"?O=new Hs(k.type,[O]):O.type.kind!=="value"&&k.type.kind==="value"&&(k=new Hs(O.type,[k])));let M=null;if(_.length===4){if(O.type.kind!=="string"&&k.type.kind!=="string"&&O.type.kind!=="value"&&k.type.kind!=="value")return w.error("Cannot use collator to compare non-string types.");if(M=w.parse(_[3],3,Eh),!M)return null}return new pre(O,k,M)}evaluate(_){const w=this.lhs.evaluate(_),C=this.rhs.evaluate(_);if(d&&this.hasUntypedArgument){const O=zi(w),k=zi(C);if(O.kind!==k.kind||O.kind!=="string"&&O.kind!=="number")throw new lo(`Expected arguments for "${u}" to be (string, string) or (number, number), but found (${O.kind}, ${k.kind}) instead.`)}if(this.collator&&!d&&this.hasUntypedArgument){const O=zi(w),k=zi(C);if(O.kind!=="string"||k.kind!=="string")return l(_,w,C)}return this.collator?c(_,w,C,this.collator.evaluate(_)):l(_,w,C)}eachChild(_){_(this.lhs),_(this.rhs),this.collator&&_(this.collator)}outputDefined(){return!0}serialize(){const _=[u];return this.eachChild(w=>{_.push(w.serialize())}),_}}}const gI=Kc("==",function(u,l,c){return l===c},WC),GC=Kc("!=",function(u,l,c){return l!==c},function(u,l,c,d){return!WC(0,l,c,d)}),YC=Kc("<",function(u,l,c){return l<c},function(u,l,c,d){return d.compare(l,c)<0}),KC=Kc(">",function(u,l,c){return l>c},function(u,l,c,d){return d.compare(l,c)>0}),Mb=Kc("<=",function(u,l,c){return l<=c},function(u,l,c,d){return d.compare(l,c)<=0}),vI=Kc(">=",function(u,l,c){return l>=c},function(u,l,c,d){return d.compare(l,c)>=0});class Db{constructor(l,c,d,y,_,w){this.type=rn,this.number=l,this.locale=c,this.currency=d,this.unit=y,this.minFractionDigits=_,this.maxFractionDigits=w}static parse(l,c){if(l.length!==3)return c.error("Expected two arguments.");const d=c.parse(l[1],1,Ut);if(!d)return null;const y=l[2];if(typeof y!="object"||Array.isArray(y))return c.error("NumberFormat options argument must be an object.");let _=null;if(y.locale&&(_=c.parse(y.locale,1,rn),!_))return null;let w=null;if(y.currency&&(w=c.parse(y.currency,1,rn),!w))return null;let C=null;if(y.unit&&(C=c.parse(y.unit,1,rn),!C))return null;let O=null;if(y["min-fraction-digits"]&&(O=c.parse(y["min-fraction-digits"],1,Ut),!O))return null;let k=null;return y["max-fraction-digits"]&&(k=c.parse(y["max-fraction-digits"],1,Ut),!k)?null:new Db(d,_,w,C,O,k)}evaluate(l){return new Intl.NumberFormat(this.locale?this.locale.evaluate(l):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(l):void 0,unit:this.unit?this.unit.evaluate(l):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(l):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(l):void 0}).format(this.number.evaluate(l))}eachChild(l){l(this.number),this.locale&&l(this.locale),this.currency&&l(this.currency),this.unit&&l(this.unit),this.minFractionDigits&&l(this.minFractionDigits),this.maxFractionDigits&&l(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const l={};return this.locale&&(l.locale=this.locale.serialize()),this.currency&&(l.currency=this.currency.serialize()),this.unit&&(l.unit=this.unit.serialize()),this.minFractionDigits&&(l["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(l["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),l]}}class $b{constructor(l){this.type=Ut,this.input=l}static parse(l,c){if(l.length!==2)return c.error(`Expected 1 argument, but found ${l.length-1} instead.`);const d=c.parse(l[1],1);return d?d.type.kind!=="array"&&d.type.kind!=="string"&&d.type.kind!=="value"?c.error(`Expected argument of type string or array, but found ${zn(d.type)} instead.`):new $b(d):null}evaluate(l){const c=this.input.evaluate(l);if(typeof c=="string"||Array.isArray(c))return c.length;throw new lo(`Expected value to be of type string or array, but found ${zn(zi(c))} instead.`)}eachChild(l){l(this.input)}outputDefined(){return!1}serialize(){const l=["length"];return this.eachChild(c=>{l.push(c.serialize())}),l}}const qC={"==":gI,"!=":GC,">":KC,"<":YC,">=":vI,"<=":Mb,array:Hs,at:pI,boolean:Hs,case:yI,coalesce:FC,collator:fm,format:Ph,image:cm,in:HC,"index-of":VC,interpolate:ms,"interpolate-hcl":ms,"interpolate-lab":ms,length:$b,let:Rb,literal:kh,match:mI,number:Hs,"number-format":Db,object:Hs,slice:UC,step:wb,string:Hs,"to-boolean":Wc,"to-color":Wc,"to-number":Wc,"to-string":Wc,var:_b,within:vb};function XC(u,[l,c,d,y]){l=l.evaluate(u),c=c.evaluate(u),d=d.evaluate(u);const _=y?y.evaluate(u):1,w=kC(l,c,d,_);if(w)throw new lo(w);return new wi(l/255*_,c/255*_,d/255*_,_)}function ZC(u,l){return u in l}function Lb(u,l){const c=l[u];return c===void 0?null:c}function El(u){return{type:u}}Sl.register(qC,{error:[{kind:"error"},[rn],(u,[l])=>{throw new lo(l.evaluate(u))}],typeof:[rn,[Gr],(u,[l])=>zn(zi(l.evaluate(u)))],"to-rgba":[Mo(Ut,4),[ps],(u,[l])=>l.evaluate(u).toArray()],rgb:[ps,[Ut,Ut,Ut],XC],rgba:[ps,[Ut,Ut,Ut,Ut],XC],has:{type:qr,overloads:[[[rn],(u,[l])=>ZC(l.evaluate(u),u.properties())],[[rn,mu],(u,[l,c])=>ZC(l.evaluate(u),c.evaluate(u))]]},get:{type:Gr,overloads:[[[rn],(u,[l])=>Lb(l.evaluate(u),u.properties())],[[rn,mu],(u,[l,c])=>Lb(l.evaluate(u),c.evaluate(u))]]},"feature-state":[Gr,[rn],(u,[l])=>Lb(l.evaluate(u),u.featureState||{})],properties:[mu,[],u=>u.properties()],"geometry-type":[rn,[],u=>u.geometryType()],id:[Gr,[],u=>u.id()],zoom:[Ut,[],u=>u.globals.zoom],pitch:[Ut,[],u=>u.globals.pitch||0],"distance-from-center":[Ut,[],u=>u.distanceFromCenter()],"heatmap-density":[Ut,[],u=>u.globals.heatmapDensity||0],"line-progress":[Ut,[],u=>u.globals.lineProgress||0],"sky-radial-progress":[Ut,[],u=>u.globals.skyRadialProgress||0],accumulated:[Gr,[],u=>u.globals.accumulated===void 0?null:u.globals.accumulated],"+":[Ut,El(Ut),(u,l)=>{let c=0;for(const d of l)c+=d.evaluate(u);return c}],"*":[Ut,El(Ut),(u,l)=>{let c=1;for(const d of l)c*=d.evaluate(u);return c}],"-":{type:Ut,overloads:[[[Ut,Ut],(u,[l,c])=>l.evaluate(u)-c.evaluate(u)],[[Ut],(u,[l])=>-l.evaluate(u)]]},"/":[Ut,[Ut,Ut],(u,[l,c])=>l.evaluate(u)/c.evaluate(u)],"%":[Ut,[Ut,Ut],(u,[l,c])=>l.evaluate(u)%c.evaluate(u)],ln2:[Ut,[],()=>Math.LN2],pi:[Ut,[],()=>Math.PI],e:[Ut,[],()=>Math.E],"^":[Ut,[Ut,Ut],(u,[l,c])=>Math.pow(l.evaluate(u),c.evaluate(u))],sqrt:[Ut,[Ut],(u,[l])=>Math.sqrt(l.evaluate(u))],log10:[Ut,[Ut],(u,[l])=>Math.log(l.evaluate(u))/Math.LN10],ln:[Ut,[Ut],(u,[l])=>Math.log(l.evaluate(u))],log2:[Ut,[Ut],(u,[l])=>Math.log(l.evaluate(u))/Math.LN2],sin:[Ut,[Ut],(u,[l])=>Math.sin(l.evaluate(u))],cos:[Ut,[Ut],(u,[l])=>Math.cos(l.evaluate(u))],tan:[Ut,[Ut],(u,[l])=>Math.tan(l.evaluate(u))],asin:[Ut,[Ut],(u,[l])=>Math.asin(l.evaluate(u))],acos:[Ut,[Ut],(u,[l])=>Math.acos(l.evaluate(u))],atan:[Ut,[Ut],(u,[l])=>Math.atan(l.evaluate(u))],min:[Ut,El(Ut),(u,l)=>Math.min(...l.map(c=>c.evaluate(u)))],max:[Ut,El(Ut),(u,l)=>Math.max(...l.map(c=>c.evaluate(u)))],abs:[Ut,[Ut],(u,[l])=>Math.abs(l.evaluate(u))],round:[Ut,[Ut],(u,[l])=>{const c=l.evaluate(u);return c<0?-Math.round(-c):Math.round(c)}],floor:[Ut,[Ut],(u,[l])=>Math.floor(l.evaluate(u))],ceil:[Ut,[Ut],(u,[l])=>Math.ceil(l.evaluate(u))],"filter-==":[qr,[rn,Gr],(u,[l,c])=>u.properties()[l.value]===c.value],"filter-id-==":[qr,[Gr],(u,[l])=>u.id()===l.value],"filter-type-==":[qr,[rn],(u,[l])=>u.geometryType()===l.value],"filter-<":[qr,[rn,Gr],(u,[l,c])=>{const d=u.properties()[l.value],y=c.value;return typeof d==typeof y&&d<y}],"filter-id-<":[qr,[Gr],(u,[l])=>{const c=u.id(),d=l.value;return typeof c==typeof d&&c<d}],"filter->":[qr,[rn,Gr],(u,[l,c])=>{const d=u.properties()[l.value],y=c.value;return typeof d==typeof y&&d>y}],"filter-id->":[qr,[Gr],(u,[l])=>{const c=u.id(),d=l.value;return typeof c==typeof d&&c>d}],"filter-<=":[qr,[rn,Gr],(u,[l,c])=>{const d=u.properties()[l.value],y=c.value;return typeof d==typeof y&&d<=y}],"filter-id-<=":[qr,[Gr],(u,[l])=>{const c=u.id(),d=l.value;return typeof c==typeof d&&c<=d}],"filter->=":[qr,[rn,Gr],(u,[l,c])=>{const d=u.properties()[l.value],y=c.value;return typeof d==typeof y&&d>=y}],"filter-id->=":[qr,[Gr],(u,[l])=>{const c=u.id(),d=l.value;return typeof c==typeof d&&c>=d}],"filter-has":[qr,[Gr],(u,[l])=>l.value in u.properties()],"filter-has-id":[qr,[],u=>u.id()!==null&&u.id()!==void 0],"filter-type-in":[qr,[Mo(rn)],(u,[l])=>l.value.indexOf(u.geometryType())>=0],"filter-id-in":[qr,[Mo(Gr)],(u,[l])=>l.value.indexOf(u.id())>=0],"filter-in-small":[qr,[rn,Mo(Gr)],(u,[l,c])=>c.value.indexOf(u.properties()[l.value])>=0],"filter-in-large":[qr,[rn,Mo(Gr)],(u,[l,c])=>function(d,y,_,w){for(;_<=w;){const C=_+w>>1;if(y[C]===d)return!0;y[C]>d?w=C-1:_=C+1}return!1}(u.properties()[l.value],c.value,0,c.value.length-1)],all:{type:qr,overloads:[[[qr,qr],(u,[l,c])=>l.evaluate(u)&&c.evaluate(u)],[El(qr),(u,l)=>{for(const c of l)if(!c.evaluate(u))return!1;return!0}]]},any:{type:qr,overloads:[[[qr,qr],(u,[l,c])=>l.evaluate(u)||c.evaluate(u)],[El(qr),(u,l)=>{for(const c of l)if(c.evaluate(u))return!0;return!1}]]},"!":[qr,[qr],(u,[l])=>!l.evaluate(u)],"is-supported-script":[qr,[rn],(u,[l])=>{const c=u.globals&&u.globals.isSupportedScript;return!c||c(l.evaluate(u))}],upcase:[rn,[rn],(u,[l])=>l.evaluate(u).toUpperCase()],downcase:[rn,[rn],(u,[l])=>l.evaluate(u).toLowerCase()],concat:[rn,El(Gr),(u,l)=>l.map(c=>Rh(c.evaluate(u))).join("")],"resolved-locale":[rn,[Eh],(u,[l])=>l.evaluate(u).resolvedLocale()]});var qc=qC;function Fh(u){return{result:"success",value:u}}function Xc(u){return{result:"error",value:u}}function Zc(u){return u["property-type"]==="data-driven"}function Vs(u){return!!u.expression&&u.expression.parameters.indexOf("zoom")>-1}function Cm(u){return!!u.expression&&u.expression.interpolated}function un(u){return u instanceof Number?"number":u instanceof String?"string":u instanceof Boolean?"boolean":Array.isArray(u)?"array":u===null?"null":typeof u}function Em(u){return typeof u=="object"&&u!==null&&!Array.isArray(u)}function _I(u){return u}function Nb(u,l){const c=l.type==="color",d=u.stops&&typeof u.stops[0][0]=="object",y=d||!(d||u.property!==void 0),_=u.type||(Cm(l)?"exponential":"interval");if(c&&((u=Sa({},u)).stops&&(u.stops=u.stops.map(k=>[k[0],wi.parse(k[1])])),u.default=wi.parse(u.default?u.default:l.default)),u.colorSpace&&u.colorSpace!=="rgb"&&!zC[u.colorSpace])throw new Error(`Unknown color space: ${u.colorSpace}`);let w,C,O;if(_==="exponential")w=Tm;else if(_==="interval")w=JC;else if(_==="categorical"){w=Bb,C=Object.create(null);for(const k of u.stops)C[k[0]]=k[1];O=typeof u.stops[0][0]}else{if(_!=="identity")throw new Error(`Unknown function type "${_}"`);w=QC}if(d){const k={},M=[];for(let W=0;W<u.stops.length;W++){const Y=u.stops[W],J=Y[0].zoom;k[J]===void 0&&(k[J]={zoom:J,type:u.type,property:u.property,default:u.default,stops:[]},M.push(J)),k[J].stops.push([Y[0].value,Y[1]])}const N=[];for(const W of M)N.push([k[W].zoom,Nb(k[W],l)]);const B={name:"linear"};return{kind:"composite",interpolationType:B,interpolationFactor:ms.interpolationFactor.bind(void 0,B),zoomStops:N.map(W=>W[0]),evaluate:({zoom:W},Y)=>Tm({stops:N,base:u.base},l,W).evaluate(W,Y)}}if(y){const k=_==="exponential"?{name:"exponential",base:u.base!==void 0?u.base:1}:null;return{kind:"camera",interpolationType:k,interpolationFactor:ms.interpolationFactor.bind(void 0,k),zoomStops:u.stops.map(M=>M[0]),evaluate:({zoom:M})=>w(u,l,M,C,O)}}return{kind:"source",evaluate(k,M){const N=M&&M.properties?M.properties[u.property]:void 0;return N===void 0?Hh(u.default,l.default):w(u,l,N,C,O)}}}function Hh(u,l,c){return u!==void 0?u:l!==void 0?l:c!==void 0?c:void 0}function Bb(u,l,c,d,y){return Hh(typeof c===y?d[c]:void 0,u.default,l.default)}function JC(u,l,c){if(un(c)!=="number")return Hh(u.default,l.default);const d=u.stops.length;if(d===1||c<=u.stops[0][0])return u.stops[0][1];if(c>=u.stops[d-1][0])return u.stops[d-1][1];const y=_u(u.stops.map(_=>_[0]),c);return u.stops[y][1]}function Tm(u,l,c){const d=u.base!==void 0?u.base:1;if(un(c)!=="number")return Hh(u.default,l.default);const y=u.stops.length;if(y===1||c<=u.stops[0][0])return u.stops[0][1];if(c>=u.stops[y-1][0])return u.stops[y-1][1];const _=_u(u.stops.map(M=>M[0]),c),w=function(M,N,B,W){const Y=W-B,J=M-B;return Y===0?0:N===1?J/Y:(Math.pow(N,J)-1)/(Math.pow(N,Y)-1)}(c,d,u.stops[_][0],u.stops[_+1][0]),C=u.stops[_][1],O=u.stops[_+1][1];let k=Lh[l.type]||_I;if(u.colorSpace&&u.colorSpace!=="rgb"){const M=zC[u.colorSpace];k=(N,B)=>M.reverse(M.interpolate(M.forward(N),M.forward(B),w))}return typeof C.evaluate=="function"?{evaluate(...M){const N=C.evaluate.apply(void 0,M),B=O.evaluate.apply(void 0,M);if(N!==void 0&&B!==void 0)return k(N,B,w)}}:k(C,O,w)}function QC(u,l,c){return l.type==="color"?c=wi.parse(c):l.type==="formatted"?c=Ho.fromString(c.toString()):l.type==="resolvedImage"?c=Do.fromString(c.toString()):un(c)===l.type||l.type==="enum"&&l.values[c]||(c=void 0),Hh(c,u.default,l.default)}class Om{constructor(l,c){this.expression=l,this._warningHistory={},this._evaluator=new Ah,this._defaultValue=c?function(d){return d.type==="color"&&(Em(d.default)||Array.isArray(d.default))?new wi(0,0,0,0):d.type==="color"?wi.parse(d.default)||null:d.default===void 0?null:d.default}(c):null,this._enumValues=c&&c.type==="enum"?c.values:null}evaluateWithoutErrorHandling(l,c,d,y,_,w,C,O){return this._evaluator.globals=l,this._evaluator.feature=c,this._evaluator.featureState=d,this._evaluator.canonical=y||null,this._evaluator.availableImages=_||null,this._evaluator.formattedSection=w,this._evaluator.featureTileCoord=C||null,this._evaluator.featureDistanceData=O||null,this.expression.evaluate(this._evaluator)}evaluate(l,c,d,y,_,w,C,O){this._evaluator.globals=l,this._evaluator.feature=c||null,this._evaluator.featureState=d||null,this._evaluator.canonical=y||null,this._evaluator.availableImages=_||null,this._evaluator.formattedSection=w||null,this._evaluator.featureTileCoord=C||null,this._evaluator.featureDistanceData=O||null;try{const k=this.expression.evaluate(this._evaluator);if(k==null||typeof k=="number"&&k!=k)return this._defaultValue;if(this._enumValues&&!(k in this._enumValues))throw new lo(`Expected value to be one of ${Object.keys(this._enumValues).map(M=>JSON.stringify(M)).join(", ")}, but found ${JSON.stringify(k)} instead.`);return k}catch(k){return this._warningHistory[k.message]||(this._warningHistory[k.message]=!0,typeof console<"u"&&console.warn(k.message)),this._defaultValue}}}function Jc(u){return Array.isArray(u)&&u.length>0&&typeof u[0]=="string"&&u[0]in qc}function Qc(u,l){const c=new bb(qc,[],l?function(y){const _={color:ps,string:rn,number:Ut,enum:rn,boolean:qr,formatted:Fc,resolvedImage:Hc};return y.type==="array"?Mo(_[y.value]||Gr,y.length):_[y.type]}(l):void 0),d=c.parse(u,void 0,void 0,void 0,l&&l.type==="string"?{typeAnnotation:"coerce"}:void 0);return d?Fh(new Om(d,l)):Xc(c.errors)}class Rm{constructor(l,c){this.kind=l,this._styleExpression=c,this.isStateDependent=l!=="constant"&&!$h(c.expression)}evaluateWithoutErrorHandling(l,c,d,y,_,w){return this._styleExpression.evaluateWithoutErrorHandling(l,c,d,y,_,w)}evaluate(l,c,d,y,_,w){return this._styleExpression.evaluate(l,c,d,y,_,w)}}class wu{constructor(l,c,d,y){this.kind=l,this.zoomStops=d,this._styleExpression=c,this.isStateDependent=l!=="camera"&&!$h(c.expression),this.interpolationType=y}evaluateWithoutErrorHandling(l,c,d,y,_,w){return this._styleExpression.evaluateWithoutErrorHandling(l,c,d,y,_,w)}evaluate(l,c,d,y,_,w){return this._styleExpression.evaluate(l,c,d,y,_,w)}interpolationFactor(l,c,d){return this.interpolationType?ms.interpolationFactor(this.interpolationType,l,c,d):0}}function Su(u,l){if((u=Qc(u,l)).result==="error")return u;const c=u.value.expression,d=Dh(c);if(!d&&!Zc(l))return Xc([new ds("","data expressions not supported")]);const y=mm(c,["zoom","pitch","distance-from-center"]);if(!y&&!Vs(l))return Xc([new ds("","zoom expressions not supported")]);const _=Uh(c);return _||y?_ instanceof ds?Xc([_]):_ instanceof ms&&!Cm(l)?Xc([new ds("",'"interpolate" expressions cannot be used with this property')]):Fh(_?new wu(d?"camera":"composite",u.value,_.labels,_ instanceof ms?_.interpolation:void 0):new Rm(d?"constant":"source",u.value)):Xc([new ds("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Vh{constructor(l,c){this._parameters=l,this._specification=c,Sa(this,Nb(this._parameters,this._specification))}static deserialize(l){return new Vh(l._parameters,l._specification)}static serialize(l){return{_parameters:l._parameters,_specification:l._specification}}}function Uh(u){let l=null;if(u instanceof Rb)l=Uh(u.result);else if(u instanceof FC){for(const c of u.args)if(l=Uh(c),l)break}else(u instanceof wb||u instanceof ms)&&u.input instanceof Sl&&u.input.name==="zoom"&&(l=u);return l instanceof ds||u.eachChild(c=>{const d=Uh(c);d instanceof ds?l=d:!l&&d?l=new ds("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):l&&d&&l!==d&&(l=new ds("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),l}class Qt{constructor(l,c,d,y){this.message=(l?`${l}: `:"")+d,y&&(this.identifier=y),c!=null&&c.__line__&&(this.line=c.__line__)}}function Ca(u){const l=u.key,c=u.value,d=u.valueSpec||{},y=u.objectElementValidators||{},_=u.style,w=u.styleSpec;let C=[];const O=un(c);if(O!=="object")return[new Qt(l,c,`object expected, ${O} found`)];for(const k in c){const M=k.split(".")[0],N=d[M]||d["*"];let B;y[M]?B=y[M]:d[M]?B=_o:y["*"]?B=y["*"]:d["*"]&&(B=_o),B?C=C.concat(B({key:(l&&`${l}.`)+k,value:c[k],valueSpec:N,style:_,styleSpec:w,object:c,objectKey:k},c)):C.push(new Qt(l,c[k],`unknown property "${k}"`))}for(const k in d)y[k]||d[k].required&&d[k].default===void 0&&c[k]===void 0&&C.push(new Qt(l,c,`missing required property "${k}"`));return C}function eE(u){const l=u.value,c=u.valueSpec,d=u.style,y=u.styleSpec,_=u.key,w=u.arrayElementValidator||_o;if(un(l)!=="array")return[new Qt(_,l,`array expected, ${un(l)} found`)];if(c.length&&l.length!==c.length)return[new Qt(_,l,`array length ${c.length} expected, length ${l.length} found`)];if(c["min-length"]&&l.length<c["min-length"])return[new Qt(_,l,`array length at least ${c["min-length"]} expected, length ${l.length} found`)];let C={type:c.value,values:c.values,minimum:c.minimum,maximum:c.maximum,function:void 0};y.$version<7&&(C.function=c.function),un(c.value)==="object"&&(C=c.value);let O=[];for(let k=0;k<l.length;k++)O=O.concat(w({array:l,arrayIndex:k,value:l[k],valueSpec:C,style:d,styleSpec:y,key:`${_}[${k}]`}));return O}function jb(u){const l=u.key,c=u.value,d=u.valueSpec;let y=un(c);if(y==="number"&&c!=c&&(y="NaN"),y!=="number")return[new Qt(l,c,`number expected, ${y} found`)];if("minimum"in d){let _=d.minimum;if(un(d.minimum)==="array"&&(_=d.minimum[u.arrayIndex]),c<_)return[new Qt(l,c,`${c} is less than the minimum value ${_}`)]}if("maximum"in d){let _=d.maximum;if(un(d.maximum)==="array"&&(_=d.maximum[u.arrayIndex]),c>_)return[new Qt(l,c,`${c} is greater than the maximum value ${_}`)]}return[]}function Wh(u){const l=u.valueSpec,c=bi(u.value.type);let d,y,_,w={};const C=c!=="categorical"&&u.value.property===void 0,O=!C,k=un(u.value.stops)==="array"&&un(u.value.stops[0])==="array"&&un(u.value.stops[0][0])==="object",M=Ca({key:u.key,value:u.value,valueSpec:u.styleSpec.function,style:u.style,styleSpec:u.styleSpec,objectElementValidators:{stops:function(W){if(c==="identity")return[new Qt(W.key,W.value,'identity function may not have a "stops" property')];let Y=[];const J=W.value;return Y=Y.concat(eE({key:W.key,value:J,valueSpec:W.valueSpec,style:W.style,styleSpec:W.styleSpec,arrayElementValidator:N})),un(J)==="array"&&J.length===0&&Y.push(new Qt(W.key,J,"array must have at least one stop")),Y},default:function(W){return _o({key:W.key,value:W.value,valueSpec:l,style:W.style,styleSpec:W.styleSpec})}}});return c==="identity"&&C&&M.push(new Qt(u.key,u.value,'missing required property "property"')),c==="identity"||u.value.stops||M.push(new Qt(u.key,u.value,'missing required property "stops"')),c==="exponential"&&u.valueSpec.expression&&!Cm(u.valueSpec)&&M.push(new Qt(u.key,u.value,"exponential functions not supported")),u.styleSpec.$version>=8&&(O&&!Zc(u.valueSpec)?M.push(new Qt(u.key,u.value,"property functions not supported")):C&&!Vs(u.valueSpec)&&M.push(new Qt(u.key,u.value,"zoom functions not supported"))),c!=="categorical"&&!k||u.value.property!==void 0||M.push(new Qt(u.key,u.value,'"property" property is required')),M;function N(W){let Y=[];const J=W.value,ie=W.key;if(un(J)!=="array")return[new Qt(ie,J,`array expected, ${un(J)} found`)];if(J.length!==2)return[new Qt(ie,J,`array length 2 expected, length ${J.length} found`)];if(k){if(un(J[0])!=="object")return[new Qt(ie,J,`object expected, ${un(J[0])} found`)];if(J[0].zoom===void 0)return[new Qt(ie,J,"object stop key must have zoom")];if(J[0].value===void 0)return[new Qt(ie,J,"object stop key must have value")];const pe=bi(J[0].zoom);if(typeof pe!="number")return[new Qt(ie,J[0].zoom,"stop zoom values must be numbers")];if(_&&_>pe)return[new Qt(ie,J[0].zoom,"stop zoom values must appear in ascending order")];pe!==_&&(_=pe,y=void 0,w={}),Y=Y.concat(Ca({key:`${ie}[0]`,value:J[0],valueSpec:{zoom:{}},style:W.style,styleSpec:W.styleSpec,objectElementValidators:{zoom:jb,value:B}}))}else Y=Y.concat(B({key:`${ie}[0]`,value:J[0],valueSpec:{},style:W.style,styleSpec:W.styleSpec},J));return Jc(wl(J[1]))?Y.concat([new Qt(`${ie}[1]`,J[1],"expressions are not allowed in function stops.")]):Y.concat(_o({key:`${ie}[1]`,value:J[1],valueSpec:l,style:W.style,styleSpec:W.styleSpec}))}function B(W,Y){const J=un(W.value),ie=bi(W.value),pe=W.value!==null?W.value:Y;if(d){if(J!==d)return[new Qt(W.key,pe,`${J} stop domain type must match previous stop domain type ${d}`)]}else d=J;if(J!=="number"&&J!=="string"&&J!=="boolean"&&typeof ie!="number"&&typeof ie!="string"&&typeof ie!="boolean")return[new Qt(W.key,pe,"stop domain value must be a number, string, or boolean")];if(J!=="number"&&c!=="categorical"){let Ce=`number expected, ${J} found`;return Zc(l)&&c===void 0&&(Ce+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Qt(W.key,pe,Ce)]}return c!=="categorical"||J!=="number"||typeof ie=="number"&&isFinite(ie)&&Math.floor(ie)===ie?c!=="categorical"&&J==="number"&&typeof ie=="number"&&typeof y=="number"&&y!==void 0&&ie<y?[new Qt(W.key,pe,"stop domain values must appear in ascending order")]:(y=ie,c==="categorical"&&ie in w?[new Qt(W.key,pe,"stop domain values must be unique")]:(w[ie]=!0,[])):[new Qt(W.key,pe,`integer expected, found ${String(ie)}`)]}}function ef(u){const l=(u.expressionContext==="property"?Su:Qc)(wl(u.value),u.valueSpec);if(l.result==="error")return l.value.map(d=>new Qt(`${u.key}${d.key}`,u.value,d.message));const c=l.value.expression||l.value._styleExpression.expression;if(u.expressionContext==="property"&&u.propertyKey==="text-font"&&!c.outputDefined())return[new Qt(u.key,u.value,`Invalid data expression for "${u.propertyKey}". Output values must be contained as literals within the expression.`)];if(u.expressionContext==="property"&&u.propertyType==="layout"&&!$h(c))return[new Qt(u.key,u.value,'"feature-state" data expressions are not supported with layout properties.')];if(u.expressionContext==="filter")return tE(c,u);if(u.expressionContext&&u.expressionContext.indexOf("cluster")===0){if(!mm(c,["zoom","feature-state"]))return[new Qt(u.key,u.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(u.expressionContext==="cluster-initial"&&!Dh(c))return[new Qt(u.key,u.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function tE(u,l){const c=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(l.valueSpec&&l.valueSpec.expression)for(const y of l.valueSpec.expression.parameters)c.delete(y);if(c.size===0)return[];const d=[];return u instanceof Sl&&c.has(u.name)?[new Qt(l.key,l.value,`["${u.name}"] expression is not supported in a filter for a ${l.object.type} layer with id: ${l.object.id}`)]:(u.eachChild(y=>{d.push(...tE(y,l))}),d)}function km(u){const l=u.key,c=u.value,d=u.valueSpec,y=[];return Array.isArray(d.values)?d.values.indexOf(bi(c))===-1&&y.push(new Qt(l,c,`expected one of [${d.values.join(", ")}], ${JSON.stringify(c)} found`)):Object.keys(d.values).indexOf(bi(c))===-1&&y.push(new Qt(l,c,`expected one of [${Object.keys(d.values).join(", ")}], ${JSON.stringify(c)} found`)),y}function zb(u){if(u===!0||u===!1)return!0;if(!Array.isArray(u)||u.length===0)return!1;switch(u[0]){case"has":return u.length>=2&&u[1]!=="$id"&&u[1]!=="$type";case"in":return u.length>=3&&(typeof u[1]!="string"||Array.isArray(u[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return u.length!==3||Array.isArray(u[1])||Array.isArray(u[2]);case"any":case"all":for(const l of u.slice(1))if(!zb(l)&&typeof l!="boolean")return!1;return!0;default:return!0}}function Pm(u,l="fill"){if(u==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};zb(u)||(u=Im(u));const c=u;let d=!0;try{d=function(k){if(!to(k))return k;let M=wl(k);return Yh(M),M=Gh(M),M}(c)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(c,null,2)}
        `)}const y=yt[`filter_${l}`],_=Qc(d,y);let w=null;if(_.result==="error")throw new Error(_.value.map(k=>`${k.key}: ${k.message}`).join(", "));w=(k,M,N)=>_.value.evaluate(k,M,{},N);let C=null,O=null;if(d!==c){const k=Qc(c,y);if(k.result==="error")throw new Error(k.value.map(M=>`${M.key}: ${M.message}`).join(", "));C=(M,N,B,W,Y)=>k.value.evaluate(M,N,{},B,void 0,void 0,W,Y),O=!Dh(k.value.expression)}return{filter:w,dynamicFilter:C||void 0,needGeometry:rE(d),needFeature:!!O}}function Gh(u){if(!Array.isArray(u))return u;const l=function(c){if(Am.has(c[0])){for(let d=1;d<c.length;d++)if(to(c[d]))return!0}return c}(u);return l===!0?l:l.map(c=>Gh(c))}function Yh(u){let l=!1;const c=[];if(u[0]==="case"){for(let d=1;d<u.length-1;d+=2)l=l||to(u[d]),c.push(u[d+1]);c.push(u[u.length-1])}else if(u[0]==="match"){l=l||to(u[1]);for(let d=2;d<u.length-1;d+=2)c.push(u[d+1]);c.push(u[u.length-1])}else if(u[0]==="step"){l=l||to(u[1]);for(let d=1;d<u.length-1;d+=2)c.push(u[d+1])}l&&(u.length=0,u.push("any",...c));for(let d=1;d<u.length;d++)Yh(u[d])}function to(u){if(!Array.isArray(u))return!1;if((l=u[0])==="pitch"||l==="distance-from-center")return!0;var l;for(let c=1;c<u.length;c++)if(to(u[c]))return!0;return!1}const Am=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function bI(u,l){return u<l?-1:u>l?1:0}function rE(u){if(!Array.isArray(u))return!1;if(u[0]==="within")return!0;for(let l=1;l<u.length;l++)if(rE(u[l]))return!0;return!1}function Im(u){if(!u)return!0;const l=u[0];return u.length<=1?l!=="any":l==="=="?Fb(u[1],u[2],"=="):l==="!="?tf(Fb(u[1],u[2],"==")):l==="<"||l===">"||l==="<="||l===">="?Fb(u[1],u[2],l):l==="any"?(c=u.slice(1),["any"].concat(c.map(Im))):l==="all"?["all"].concat(u.slice(1).map(Im)):l==="none"?["all"].concat(u.slice(1).map(Im).map(tf)):l==="in"?Mm(u[1],u.slice(2)):l==="!in"?tf(Mm(u[1],u.slice(2))):l==="has"?nE(u[1]):l==="!has"?tf(nE(u[1])):l!=="within"||u;var c}function Fb(u,l,c){switch(u){case"$type":return[`filter-type-${c}`,l];case"$id":return[`filter-id-${c}`,l];default:return[`filter-${c}`,u,l]}}function Mm(u,l){if(l.length===0)return!1;switch(u){case"$type":return["filter-type-in",["literal",l]];case"$id":return["filter-id-in",["literal",l]];default:return l.length>200&&!l.some(c=>typeof c!=typeof l[0])?["filter-in-large",u,["literal",l.sort(bI)]]:["filter-in-small",u,["literal",l]]}}function nE(u){switch(u){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",u]}}function tf(u){return["!",u]}function Hb(u){return zb(wl(u.value))?ef(Sa({},u,{expressionContext:"filter",valueSpec:u.styleSpec[`filter_${u.layerType||"fill"}`]})):iE(u)}function iE(u){const l=u.value,c=u.key;if(un(l)!=="array")return[new Qt(c,l,`array expected, ${un(l)} found`)];const d=u.styleSpec;let y,_=[];if(l.length<1)return[new Qt(c,l,"filter array must have at least 1 element")];switch(_=_.concat(km({key:`${c}[0]`,value:l[0],valueSpec:d.filter_operator,style:u.style,styleSpec:u.styleSpec})),bi(l[0])){case"<":case"<=":case">":case">=":l.length>=2&&bi(l[1])==="$type"&&_.push(new Qt(c,l,`"$type" cannot be use with operator "${l[0]}"`));case"==":case"!=":l.length!==3&&_.push(new Qt(c,l,`filter array for operator "${l[0]}" must have 3 elements`));case"in":case"!in":l.length>=2&&(y=un(l[1]),y!=="string"&&_.push(new Qt(`${c}[1]`,l[1],`string expected, ${y} found`)));for(let w=2;w<l.length;w++)y=un(l[w]),bi(l[1])==="$type"?_=_.concat(km({key:`${c}[${w}]`,value:l[w],valueSpec:d.geometry_type,style:u.style,styleSpec:u.styleSpec})):y!=="string"&&y!=="number"&&y!=="boolean"&&_.push(new Qt(`${c}[${w}]`,l[w],`string, number, or boolean expected, ${y} found`));break;case"any":case"all":case"none":for(let w=1;w<l.length;w++)_=_.concat(iE({key:`${c}[${w}]`,value:l[w],style:u.style,styleSpec:u.styleSpec}));break;case"has":case"!has":y=un(l[1]),l.length!==2?_.push(new Qt(c,l,`filter array for "${l[0]}" operator must have 2 elements`)):y!=="string"&&_.push(new Qt(`${c}[1]`,l[1],`string expected, ${y} found`));break;case"within":y=un(l[1]),l.length!==2?_.push(new Qt(c,l,`filter array for "${l[0]}" operator must have 2 elements`)):y!=="object"&&_.push(new Qt(`${c}[1]`,l[1],`object expected, ${y} found`))}return _}function Dm(u,l){const c=u.key,d=u.style,y=u.styleSpec,_=u.value,w=u.objectKey,C=y[`${l}_${u.layerType}`];if(!C)return[];const O=w.match(/^(.*)-transition$/);if(l==="paint"&&O&&C[O[1]]&&C[O[1]].transition)return _o({key:c,value:_,valueSpec:y.transition,style:d,styleSpec:y});const k=u.valueSpec||C[w];if(!k)return[new Qt(c,_,`unknown property "${w}"`)];let M;if(un(_)==="string"&&Zc(k)&&!k.tokens&&(M=/^{([^}]+)}$/.exec(_))){const B=`\`{ "type": "identity", "property": ${M?JSON.stringify(M[1]):'"_"'} }\``;return[new Qt(c,_,`"${w}" does not support interpolation syntax
Use an identity property function instead: ${B}.`)]}const N=[];return u.layerType==="symbol"&&(w==="text-field"&&d&&!d.glyphs&&N.push(new Qt(c,_,'use of "text-field" requires a style "glyphs" property')),w==="text-font"&&Em(wl(_))&&bi(_.type)==="identity"&&N.push(new Qt(c,_,'"text-font" does not support identity functions'))),N.concat(_o({key:u.key,value:_,valueSpec:k,style:d,styleSpec:y,expressionContext:"property",propertyType:l,propertyKey:w}))}function oE(u){return Dm(u,"paint")}function Vb(u){return Dm(u,"layout")}function Ub(u){let l=[];const c=u.value,d=u.key,y=u.style,_=u.styleSpec;c.type||c.ref||l.push(new Qt(d,c,'either "type" or "ref" is required'));let w=bi(c.type);const C=bi(c.ref);if(c.id){const O=bi(c.id);for(let k=0;k<u.arrayIndex;k++){const M=y.layers[k];bi(M.id)===O&&l.push(new Qt(d,c.id,`duplicate layer id "${c.id}", previously used at line ${M.id.__line__}`))}}if("ref"in c){let O;["type","source","source-layer","filter","layout"].forEach(k=>{k in c&&l.push(new Qt(d,c[k],`"${k}" is prohibited for ref layers`))}),y.layers.forEach(k=>{bi(k.id)===C&&(O=k)}),O?O.ref?l.push(new Qt(d,c.ref,"ref cannot reference another ref layer")):w=bi(O.type):typeof C=="string"&&l.push(new Qt(d,c.ref,`ref layer "${C}" not found`))}else if(w!=="background"&&w!=="sky")if(c.source){const O=y.sources&&y.sources[c.source],k=O&&bi(O.type);O?k==="vector"&&w==="raster"?l.push(new Qt(d,c.source,`layer "${c.id}" requires a raster source`)):k==="raster"&&w!=="raster"?l.push(new Qt(d,c.source,`layer "${c.id}" requires a vector source`)):k!=="vector"||c["source-layer"]?k==="raster-dem"&&w!=="hillshade"?l.push(new Qt(d,c.source,"raster-dem source can only be used with layer type 'hillshade'.")):w!=="line"||!c.paint||!c.paint["line-gradient"]&&!c.paint["line-trim-offset"]||k==="geojson"&&O.lineMetrics||l.push(new Qt(d,c,`layer "${c.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):l.push(new Qt(d,c,`layer "${c.id}" must specify a "source-layer"`)):l.push(new Qt(d,c.source,`source "${c.source}" not found`))}else l.push(new Qt(d,c,'missing required property "source"'));return l=l.concat(Ca({key:d,value:c,valueSpec:_.layer,style:u.style,styleSpec:u.styleSpec,objectElementValidators:{"*":()=>[],type:()=>_o({key:`${d}.type`,value:c.type,valueSpec:_.layer.type,style:u.style,styleSpec:u.styleSpec,object:c,objectKey:"type"}),filter:O=>Hb(Sa({layerType:w},O)),layout:O=>Ca({layer:c,key:O.key,value:O.value,valueSpec:{},style:O.style,styleSpec:O.styleSpec,objectElementValidators:{"*":k=>Vb(Sa({layerType:w},k))}}),paint:O=>Ca({layer:c,key:O.key,value:O.value,valueSpec:{},style:O.style,styleSpec:O.styleSpec,objectElementValidators:{"*":k=>oE(Sa({layerType:w},k))}})}})),l}function rf(u){const l=u.value,c=u.key,d=un(l);return d!=="string"?[new Qt(c,l,`string expected, ${d} found`)]:[]}const $m={promoteId:function({key:u,value:l}){if(un(l)==="string")return rf({key:u,value:l});{const c=[];for(const d in l)c.push(...rf({key:`${u}.${d}`,value:l[d]}));return c}}};function Kh(u){const l=u.value,c=u.key,d=u.styleSpec,y=u.style;if(!l.type)return[new Qt(c,l,'"type" is required')];const _=bi(l.type);let w;switch(_){case"vector":case"raster":case"raster-dem":return w=Ca({key:c,value:l,valueSpec:d[`source_${_.replace("-","_")}`],style:u.style,styleSpec:d,objectElementValidators:$m}),w;case"geojson":if(w=Ca({key:c,value:l,valueSpec:d.source_geojson,style:y,styleSpec:d,objectElementValidators:$m}),l.cluster)for(const C in l.clusterProperties){const[O,k]=l.clusterProperties[C],M=typeof O=="string"?[O,["accumulated"],["get",C]]:O;w.push(...ef({key:`${c}.${C}.map`,value:k,expressionContext:"cluster-map"})),w.push(...ef({key:`${c}.${C}.reduce`,value:M,expressionContext:"cluster-reduce"}))}return w;case"video":return Ca({key:c,value:l,valueSpec:d.source_video,style:y,styleSpec:d});case"image":return Ca({key:c,value:l,valueSpec:d.source_image,style:y,styleSpec:d});case"canvas":return[new Qt(c,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return km({key:`${c}.type`,value:l.type,valueSpec:{values:aE(d)},style:y,styleSpec:d})}}function aE(u){return u.source.reduce((l,c)=>{const d=u[c];return d.type.type==="enum"&&(l=l.concat(Object.keys(d.type.values))),l},[])}function sE(u){const l=u.value,c=u.styleSpec,d=c.light,y=u.style;let _=[];const w=un(l);if(l===void 0)return _;if(w!=="object")return _=_.concat([new Qt("light",l,`object expected, ${w} found`)]),_;for(const C in l){const O=C.match(/^(.*)-transition$/);_=_.concat(O&&d[O[1]]&&d[O[1]].transition?_o({key:C,value:l[C],valueSpec:c.transition,style:y,styleSpec:c}):d[C]?_o({key:C,value:l[C],valueSpec:d[C],style:y,styleSpec:c}):[new Qt(C,l[C],`unknown property "${C}"`)])}return _}function Wb(u){const l=u.value,c=u.key,d=u.style,y=u.styleSpec,_=y.terrain;let w=[];const C=un(l);if(l===void 0)return w;if(C!=="object")return w=w.concat([new Qt("terrain",l,`object expected, ${C} found`)]),w;for(const O in l){const k=O.match(/^(.*)-transition$/);w=w.concat(k&&_[k[1]]&&_[k[1]].transition?_o({key:O,value:l[O],valueSpec:y.transition,style:d,styleSpec:y}):_[O]?_o({key:O,value:l[O],valueSpec:_[O],style:d,styleSpec:y}):[new Qt(O,l[O],`unknown property "${O}"`)])}if(l.source){const O=d.sources&&d.sources[l.source],k=O&&bi(O.type);O?k!=="raster-dem"&&w.push(new Qt(c,l.source,`terrain cannot be used with a source of type ${String(k)}, it only be used with a "raster-dem" source type`)):w.push(new Qt(c,l.source,`source "${l.source}" not found`))}else w.push(new Qt(c,l,'terrain is missing required property "source"'));return w}function lE(u){const l=u.value,c=u.style,d=u.styleSpec,y=d.fog;let _=[];const w=un(l);if(l===void 0)return _;if(w!=="object")return _=_.concat([new Qt("fog",l,`object expected, ${w} found`)]),_;for(const C in l){const O=C.match(/^(.*)-transition$/);_=_.concat(O&&y[O[1]]&&y[O[1]].transition?_o({key:C,value:l[C],valueSpec:d.transition,style:c,styleSpec:d}):y[C]?_o({key:C,value:l[C],valueSpec:y[C],style:c,styleSpec:d}):[new Qt(C,l[C],`unknown property "${C}"`)])}return _}const Lm={"*":()=>[],array:eE,boolean:function(u){const l=u.value,c=u.key,d=un(l);return d!=="boolean"?[new Qt(c,l,`boolean expected, ${d} found`)]:[]},number:jb,color:function(u){const l=u.key,c=u.value,d=un(c);return d!=="string"?[new Qt(l,c,`color expected, ${d} found`)]:fb(c)===null?[new Qt(l,c,`color expected, "${c}" found`)]:[]},enum:km,filter:Hb,function:Wh,layer:Ub,object:Ca,source:Kh,light:sE,terrain:Wb,fog:lE,string:rf,formatted:function(u){return rf(u).length===0?[]:ef(u)},resolvedImage:function(u){return rf(u).length===0?[]:ef(u)},projection:function(u){const l=u.value,c=u.styleSpec,d=c.projection,y=u.style;let _=[];const w=un(l);if(w==="object")for(const C in l)_=_.concat(_o({key:C,value:l[C],valueSpec:d[C],style:y,styleSpec:c}));else w!=="string"&&(_=_.concat([new Qt("projection",l,`object or string expected, ${w} found`)]));return _}};function _o(u){const l=u.value,c=u.valueSpec,d=u.styleSpec;return c.expression&&Em(bi(l))?Wh(u):c.expression&&Jc(wl(l))?ef(u):c.type&&Lm[c.type]?Lm[c.type](u):Ca(Sa({},u,{valueSpec:c.type?d[c.type]:c}))}function wI(u){const l=u.value,c=u.key,d=rf(u);return d.length||(l.indexOf("{fontstack}")===-1&&d.push(new Qt(c,l,'"glyphs" url must include a "{fontstack}" token')),l.indexOf("{range}")===-1&&d.push(new Qt(c,l,'"glyphs" url must include a "{range}" token'))),d}function uE(u,l=yt){return Us(_o({key:"",value:u,valueSpec:l.$root,styleSpec:l,style:u,objectElementValidators:{glyphs:wI,"*":()=>[]}}))}const SI=u=>Us(oE(u)),cE=u=>Us(Vb(u));function Us(u){return u.slice().sort((l,c)=>l.line&&c.line?l.line-c.line:0)}function fE(u,l){let c=!1;if(l&&l.length)for(const d of l)u.fire(new oa(new Error(d.message))),c=!0;return c}var nf=ys;function ys(u,l,c){var d=this.cells=[];if(u instanceof ArrayBuffer){this.arrayBuffer=u;var y=new Int32Array(this.arrayBuffer);u=y[0],this.d=(l=y[1])+2*(c=y[2]);for(var _=0;_<this.d*this.d;_++){var w=y[3+_],C=y[3+_+1];d.push(w===C?null:y.subarray(w,C))}var O=y[3+d.length+1];this.keys=y.subarray(y[3+d.length],O),this.bboxes=y.subarray(O),this.insert=this._insertReadonly}else{this.d=l+2*c;for(var k=0;k<this.d*this.d;k++)d.push([]);this.keys=[],this.bboxes=[]}this.n=l,this.extent=u,this.padding=c,this.scale=l/u,this.uid=0;var M=c/l*u;this.min=-M,this.max=u+M}ys.prototype.insert=function(u,l,c,d,y){this._forEachCell(l,c,d,y,this._insertCell,this.uid++),this.keys.push(u),this.bboxes.push(l),this.bboxes.push(c),this.bboxes.push(d),this.bboxes.push(y)},ys.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},ys.prototype._insertCell=function(u,l,c,d,y,_){this.cells[y].push(_)},ys.prototype.query=function(u,l,c,d,y){var _=this.min,w=this.max;if(u<=_&&l<=_&&w<=c&&w<=d&&!y)return Array.prototype.slice.call(this.keys);var C=[];return this._forEachCell(u,l,c,d,this._queryCell,C,{},y),C},ys.prototype._queryCell=function(u,l,c,d,y,_,w,C){var O=this.cells[y];if(O!==null)for(var k=this.keys,M=this.bboxes,N=0;N<O.length;N++){var B=O[N];if(w[B]===void 0){var W=4*B;(C?C(M[W+0],M[W+1],M[W+2],M[W+3]):u<=M[W+2]&&l<=M[W+3]&&c>=M[W+0]&&d>=M[W+1])?(w[B]=!0,_.push(k[B])):w[B]=!1}}},ys.prototype._forEachCell=function(u,l,c,d,y,_,w,C){for(var O=this._convertToCellCoord(u),k=this._convertToCellCoord(l),M=this._convertToCellCoord(c),N=this._convertToCellCoord(d),B=O;B<=M;B++)for(var W=k;W<=N;W++){var Y=this.d*W+B;if((!C||C(this._convertFromCellCoord(B),this._convertFromCellCoord(W),this._convertFromCellCoord(B+1),this._convertFromCellCoord(W+1)))&&y.call(this,u,l,c,d,Y,_,w,C))return}},ys.prototype._convertFromCellCoord=function(u){return(u-this.padding)/this.scale},ys.prototype._convertToCellCoord=function(u){return Math.max(0,Math.min(this.d-1,Math.floor(u*this.scale)+this.padding))},ys.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var u=this.cells,l=3+this.cells.length+1+1,c=0,d=0;d<this.cells.length;d++)c+=this.cells[d].length;var y=new Int32Array(l+c+this.keys.length+this.bboxes.length);y[0]=this.extent,y[1]=this.n,y[2]=this.padding;for(var _=l,w=0;w<u.length;w++){var C=u[w];y[3+w]=_,y.set(C,_),_+=C.length}return y[3+u.length]=_,y.set(this.keys,_),y[3+u.length+1]=_+=this.keys.length,y.set(this.bboxes,_),_+=this.bboxes.length,y.buffer};const Nm={};function tr(u,l,c={}){Object.defineProperty(u,"_classRegistryKey",{value:l,writeable:!1}),Nm[l]={klass:u,omit:c.omit||[]}}tr(Object,"Object"),nf.serialize=function(u,l){const c=u.toArrayBuffer();return l&&l.push(c),{buffer:c}},nf.deserialize=function(u){return new nf(u.buffer)},Object.defineProperty(nf,"name",{value:"Grid"}),tr(nf,"Grid"),tr(wi,"Color"),tr(Error,"Error"),tr(zt,"AJAXError"),tr(Do,"ResolvedImage"),tr(Vh,"StylePropertyFunction"),tr(Om,"StyleExpression",{omit:["_evaluator"]}),tr(wu,"ZoomDependentExpression"),tr(Rm,"ZoomConstantExpression"),tr(Sl,"CompoundExpression",{omit:["_evaluate"]});for(const u in qc)Nm[qc[u]._classRegistryKey]||tr(qc[u],`Expression${u}`);function hE(u){return u&&typeof ArrayBuffer<"u"&&(u instanceof ArrayBuffer||u.constructor&&u.constructor.name==="ArrayBuffer")}function qh(u){return h.ImageBitmap&&u instanceof h.ImageBitmap}function Xh(u,l){if(u==null||typeof u=="boolean"||typeof u=="number"||typeof u=="string"||u instanceof Boolean||u instanceof Number||u instanceof String||u instanceof Date||u instanceof RegExp)return u;if(hE(u)||qh(u))return l&&l.push(u),u;if(ArrayBuffer.isView(u)){const c=u;return l&&l.push(c.buffer),c}if(u instanceof h.ImageData)return l&&l.push(u.data.buffer),u;if(Array.isArray(u)){const c=[];for(const d of u)c.push(Xh(d,l));return c}if(typeof u=="object"){const c=u.constructor,d=c._classRegistryKey;if(!d)throw new Error(`can't serialize object of unregistered class ${d}`);const y=c.serialize?c.serialize(u,l):{};if(!c.serialize){for(const _ in u)u.hasOwnProperty(_)&&(Nm[d].omit.indexOf(_)>=0||(y[_]=Xh(u[_],l)));u instanceof Error&&(y.message=u.message)}if(y.$name)throw new Error("$name property is reserved for worker serialization logic.");return d!=="Object"&&(y.$name=d),y}throw new Error("can't serialize object of type "+typeof u)}function Zh(u){if(u==null||typeof u=="boolean"||typeof u=="number"||typeof u=="string"||u instanceof Boolean||u instanceof Number||u instanceof String||u instanceof Date||u instanceof RegExp||hE(u)||qh(u)||ArrayBuffer.isView(u)||u instanceof h.ImageData)return u;if(Array.isArray(u))return u.map(Zh);if(typeof u=="object"){const l=u.$name||"Object",{klass:c}=Nm[l];if(!c)throw new Error(`can't deserialize unregistered class ${l}`);if(c.deserialize)return c.deserialize(u);const d=Object.create(c.prototype);for(const y of Object.keys(u))y!=="$name"&&(d[y]=Zh(u[y]));return d}throw new Error("can't deserialize object of type "+typeof u)}const Jh=u=>u>=1536&&u<=1791,dE=u=>u>=1872&&u<=1919,Gb=u=>u>=2208&&u<=2303,pE=u=>u>=11904&&u<=12031,Yb=u=>u>=12032&&u<=12255,Kb=u=>u>=12272&&u<=12287,Qh=u=>u>=12288&&u<=12351,Bm=u=>u>=12352&&u<=12447,of=u=>u>=12448&&u<=12543,jm=u=>u>=12544&&u<=12591,mE=u=>u>=12704&&u<=12735,yE=u=>u>=12736&&u<=12783,qb=u=>u>=12784&&u<=12799,gE=u=>u>=12800&&u<=13055,vE=u=>u>=13056&&u<=13311,_E=u=>u>=13312&&u<=19903,Xb=u=>u>=19968&&u<=40959,bE=u=>u>=40960&&u<=42127,wE=u=>u>=42128&&u<=42191,SE=u=>u>=44032&&u<=55215,xE=u=>u>=63744&&u<=64255,zm=u=>u>=64336&&u<=65023,ed=u=>u>=65040&&u<=65055,v=u=>u>=65072&&u<=65103,f=u=>u>=65104&&u<=65135,m=u=>u>=65136&&u<=65279,b=u=>u>=65280&&u<=65519;function x(u){for(const l of u)if(I(l.charCodeAt(0)))return!0;return!1}function E(u){for(const l of u)if(!P(l.charCodeAt(0)))return!1;return!0}function P(u){return!(Jh(u)||dE(u)||Gb(u)||zm(u)||m(u))}function I(u){return!(u!==746&&u!==747&&(u<4352||!(mE(u)||jm(u)||v(u)&&!(u>=65097&&u<=65103)||xE(u)||vE(u)||pE(u)||yE(u)||!(!Qh(u)||u>=12296&&u<=12305||u>=12308&&u<=12319||u===12336)||_E(u)||Xb(u)||gE(u)||(l=>l>=12592&&l<=12687)(u)||(l=>l>=43360&&l<=43391)(u)||(l=>l>=55216&&l<=55295)(u)||(l=>l>=4352&&l<=4607)(u)||SE(u)||Bm(u)||Kb(u)||(l=>l>=12688&&l<=12703)(u)||Yb(u)||qb(u)||of(u)&&u!==12540||!(!b(u)||u===65288||u===65289||u===65293||u>=65306&&u<=65310||u===65339||u===65341||u===65343||u>=65371&&u<=65503||u===65507||u>=65512&&u<=65519)||!(!f(u)||u>=65112&&u<=65118||u>=65123&&u<=65126)||(l=>l>=5120&&l<=5759)(u)||(l=>l>=6320&&l<=6399)(u)||ed(u)||(l=>l>=19904&&l<=19967)(u)||bE(u)||wE(u))))}function L(u){return!(I(u)||function(l){return!!((c=>c>=128&&c<=255)(l)&&(l===167||l===169||l===174||l===177||l===188||l===189||l===190||l===215||l===247)||(c=>c>=8192&&c<=8303)(l)&&(l===8214||l===8224||l===8225||l===8240||l===8241||l===8251||l===8252||l===8258||l===8263||l===8264||l===8265||l===8273)||(c=>c>=8448&&c<=8527)(l)||(c=>c>=8528&&c<=8591)(l)||(c=>c>=8960&&c<=9215)(l)&&(l>=8960&&l<=8967||l>=8972&&l<=8991||l>=8996&&l<=9e3||l===9003||l>=9085&&l<=9114||l>=9150&&l<=9165||l===9167||l>=9169&&l<=9179||l>=9186&&l<=9215)||(c=>c>=9216&&c<=9279)(l)&&l!==9251||(c=>c>=9280&&c<=9311)(l)||(c=>c>=9312&&c<=9471)(l)||(c=>c>=9632&&c<=9727)(l)||(c=>c>=9728&&c<=9983)(l)&&!(l>=9754&&l<=9759)||(c=>c>=11008&&c<=11263)(l)&&(l>=11026&&l<=11055||l>=11088&&l<=11097||l>=11192&&l<=11243)||Qh(l)||of(l)||(c=>c>=57344&&c<=63743)(l)||v(l)||f(l)||b(l)||l===8734||l===8756||l===8757||l>=9984&&l<=10087||l>=10102&&l<=10131||l===65532||l===65533)}(u))}function H(u){return u>=1424&&u<=2303||zm(u)||m(u)}function F(u,l){return!(!l&&H(u)||u>=2304&&u<=3583||u>=3840&&u<=4255||(c=>c>=6016&&c<=6143)(u))}function X(u){for(const l of u)if(H(l.charCodeAt(0)))return!0;return!1}const re="deferred",oe="loading",le="loaded";let ue=null,ce="unavailable",te=null;const ge=function(u){u&&typeof u=="string"&&u.indexOf("NetworkError")>-1&&(ce="error"),ue&&ue(u)};function me(){be.fire(new Lr("pluginStateChange",{pluginStatus:ce,pluginURL:te}))}const be=new Gn,Pe=function(){return ce},Oe=function(){if(ce!==re||!te)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");ce=oe,me(),te&&Pr({url:te},u=>{u?ge(u):(ce=le,me())})},De={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>ce===le||De.applyArabicShaping!=null,isLoading:()=>ce===oe,setState(u){ce=u.pluginStatus,te=u.pluginURL},isParsed:()=>De.applyArabicShaping!=null&&De.processBidirectionalText!=null&&De.processStyledBidirectionalText!=null,getPluginURL:()=>te};class Xe{constructor(l,c){this.zoom=l,c?(this.now=c.now,this.fadeDuration=c.fadeDuration,this.transition=c.transition,this.pitch=c.pitch):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0)}isSupportedScript(l){return function(c,d){for(const y of c)if(!F(y.charCodeAt(0),d))return!1;return!0}(l,De.isLoaded())}}class ot{constructor(l,c){this.property=l,this.value=c,this.expression=function(d,y){if(Em(d))return new Vh(d,y);if(Jc(d)){const _=Su(d,y);if(_.result==="error")throw new Error(_.value.map(w=>`${w.key}: ${w.message}`).join(", "));return _.value}{let _=d;return typeof d=="string"&&y.type==="color"&&(_=wi.parse(d)),{kind:"constant",evaluate:()=>_}}}(c===void 0?l.specification.default:c,l.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(l,c,d){return this.property.possiblyEvaluate(this,l,c,d)}}class ut{constructor(l){this.property=l,this.value=new ot(l,void 0)}transitioned(l,c){return new tt(this.property,this.value,c,U({},l.transition,this.transition),l.now)}untransitioned(){return new tt(this.property,this.value,null,{},0)}}class Bt{constructor(l){this._properties=l,this._values=Object.create(l.defaultTransitionablePropertyValues)}getValue(l){return jt(this._values[l].value.value)}setValue(l,c){this._values.hasOwnProperty(l)||(this._values[l]=new ut(this._values[l].property)),this._values[l].value=new ot(this._values[l].property,c===null?void 0:jt(c))}getTransition(l){return jt(this._values[l].transition)}setTransition(l,c){this._values.hasOwnProperty(l)||(this._values[l]=new ut(this._values[l].property)),this._values[l].transition=jt(c)||void 0}serialize(){const l={};for(const c of Object.keys(this._values)){const d=this.getValue(c);d!==void 0&&(l[c]=d);const y=this.getTransition(c);y!==void 0&&(l[`${c}-transition`]=y)}return l}transitioned(l,c){const d=new wt(this._properties);for(const y of Object.keys(this._values))d._values[y]=this._values[y].transitioned(l,c._values[y]);return d}untransitioned(){const l=new wt(this._properties);for(const c of Object.keys(this._values))l._values[c]=this._values[c].untransitioned();return l}}class tt{constructor(l,c,d,y,_){const w=y.delay||0,C=y.duration||0;_=_||0,this.property=l,this.value=c,this.begin=_+w,this.end=this.begin+C,l.specification.transition&&(y.delay||y.duration)&&(this.prior=d)}possiblyEvaluate(l,c,d){const y=l.now||0,_=this.value.possiblyEvaluate(l,c,d),w=this.prior;if(w){if(y>this.end)return this.prior=null,_;if(this.value.isDataDriven())return this.prior=null,_;if(y<this.begin)return w.possiblyEvaluate(l,c,d);{const C=(y-this.begin)/(this.end-this.begin);return this.property.interpolate(w.possiblyEvaluate(l,c,d),_,Lt(C))}}return _}}class wt{constructor(l){this._properties=l,this._values=Object.create(l.defaultTransitioningPropertyValues)}possiblyEvaluate(l,c,d){const y=new at(this._properties);for(const _ of Object.keys(this._values))y._values[_]=this._values[_].possiblyEvaluate(l,c,d);return y}hasTransition(){for(const l of Object.keys(this._values))if(this._values[l].prior)return!0;return!1}}class pt{constructor(l){this._properties=l,this._values=Object.create(l.defaultPropertyValues)}getValue(l){return jt(this._values[l].value)}setValue(l,c){this._values[l]=new ot(this._values[l].property,c===null?void 0:jt(c))}serialize(){const l={};for(const c of Object.keys(this._values)){const d=this.getValue(c);d!==void 0&&(l[c]=d)}return l}possiblyEvaluate(l,c,d){const y=new at(this._properties);for(const _ of Object.keys(this._values))y._values[_]=this._values[_].possiblyEvaluate(l,c,d);return y}}class Ot{constructor(l,c,d){this.property=l,this.value=c,this.parameters=d}isConstant(){return this.value.kind==="constant"}constantOr(l){return this.value.kind==="constant"?this.value.value:l}evaluate(l,c,d,y){return this.property.evaluate(this.value,this.parameters,l,c,d,y)}}class at{constructor(l){this._properties=l,this._values=Object.create(l.defaultPossiblyEvaluatedValues)}get(l){return this._values[l]}}class Ye{constructor(l){this.specification=l}possiblyEvaluate(l,c){return l.expression.evaluate(c)}interpolate(l,c,d){const y=Lh[this.specification.type];return y?y(l,c,d):l}}class ct{constructor(l,c){this.specification=l,this.overrides=c}possiblyEvaluate(l,c,d,y){return new Ot(this,l.expression.kind==="constant"||l.expression.kind==="camera"?{kind:"constant",value:l.expression.evaluate(c,null,{},d,y)}:l.expression,c)}interpolate(l,c,d){if(l.value.kind!=="constant"||c.value.kind!=="constant")return l;if(l.value.value===void 0||c.value.value===void 0)return new Ot(this,{kind:"constant",value:void 0},l.parameters);const y=Lh[this.specification.type];return y?new Ot(this,{kind:"constant",value:y(l.value.value,c.value.value,d)},l.parameters):l}evaluate(l,c,d,y,_,w){return l.kind==="constant"?l.value:l.evaluate(c,d,y,_,w)}}class Et{constructor(l){this.specification=l}possiblyEvaluate(l,c,d,y){return!!l.expression.evaluate(c,null,{},d,y)}interpolate(){return!1}}class Mt{constructor(l){this.properties=l,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const c=new Xe(0,{});for(const d in l){const y=l[d];y.specification.overridable&&this.overridableProperties.push(d);const _=this.defaultPropertyValues[d]=new ot(y,void 0),w=this.defaultTransitionablePropertyValues[d]=new ut(y);this.defaultTransitioningPropertyValues[d]=w.untransitioned(),this.defaultPossiblyEvaluatedValues[d]=_.possiblyEvaluate(c)}}}function ur(u,l){return 256*(u=Fe(Math.floor(u),0,255))+Fe(Math.floor(l),0,255)}tr(ct,"DataDrivenProperty"),tr(Ye,"DataConstantProperty"),tr(Et,"ColorRampProperty");const Hr={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class rr{constructor(l,c){this._structArray=l,this._pos1=c*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class er{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(l,c){return l._trim(),c&&(l.isTransferred=!0,c.push(l.arrayBuffer)),{length:l.length,arrayBuffer:l.arrayBuffer}}static deserialize(l){const c=Object.create(this.prototype);return c.arrayBuffer=l.arrayBuffer,c.length=l.length,c.capacity=l.arrayBuffer.byteLength/c.bytesPerElement,c._refreshViews(),c}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(l){this.reserve(l),this.length=l}reserve(l){if(l>this.capacity){this.capacity=Math.max(l,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const c=this.uint8;this._refreshViews(),c&&this.uint8.set(c)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function fr(u,l=1){let c=0,d=0;return{members:u.map(y=>{const _=Hr[y.type].BYTES_PER_ELEMENT,w=c=Xr(c,Math.max(l,_)),C=y.components||1;return d=Math.max(d,_),c+=_*C,{name:y.name,type:y.type,components:C,offset:w}}),size:Xr(c,Math.max(d,l)),alignment:l}}function Xr(u,l){return Math.ceil(u/l)*l}class gr extends er{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(l,c){const d=this.length;return this.resize(d+1),this.emplace(d,l,c)}emplace(l,c,d){const y=2*l;return this.int16[y+0]=c,this.int16[y+1]=d,l}}gr.prototype.bytesPerElement=4,tr(gr,"StructArrayLayout2i4");class En extends er{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(l,c,d){const y=this.length;return this.resize(y+1),this.emplace(y,l,c,d)}emplace(l,c,d,y){const _=3*l;return this.int16[_+0]=c,this.int16[_+1]=d,this.int16[_+2]=y,l}}En.prototype.bytesPerElement=6,tr(En,"StructArrayLayout3i6");class On extends er{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(l,c,d,y){const _=this.length;return this.resize(_+1),this.emplace(_,l,c,d,y)}emplace(l,c,d,y,_){const w=4*l;return this.int16[w+0]=c,this.int16[w+1]=d,this.int16[w+2]=y,this.int16[w+3]=_,l}}On.prototype.bytesPerElement=8,tr(On,"StructArrayLayout4i8");class Fn extends er{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(l,c,d,y,_,w,C){const O=this.length;return this.resize(O+1),this.emplace(O,l,c,d,y,_,w,C)}emplace(l,c,d,y,_,w,C,O){const k=6*l,M=12*l,N=3*l;return this.int16[k+0]=c,this.int16[k+1]=d,this.uint8[M+4]=y,this.uint8[M+5]=_,this.uint8[M+6]=w,this.uint8[M+7]=C,this.float32[N+2]=O,l}}Fn.prototype.bytesPerElement=12,tr(Fn,"StructArrayLayout2i4ub1f12");class $n extends er{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(l,c,d,y){const _=this.length;return this.resize(_+1),this.emplace(_,l,c,d,y)}emplace(l,c,d,y,_){const w=4*l;return this.float32[w+0]=c,this.float32[w+1]=d,this.float32[w+2]=y,this.float32[w+3]=_,l}}$n.prototype.bytesPerElement=16,tr($n,"StructArrayLayout4f16");class Ti extends er{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(l,c,d,y,_){const w=this.length;return this.resize(w+1),this.emplace(w,l,c,d,y,_)}emplace(l,c,d,y,_,w){const C=6*l,O=3*l;return this.uint16[C+0]=c,this.uint16[C+1]=d,this.uint16[C+2]=y,this.uint16[C+3]=_,this.float32[O+2]=w,l}}Ti.prototype.bytesPerElement=12,tr(Ti,"StructArrayLayout4ui1f12");class Vo extends er{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(l,c,d,y){const _=this.length;return this.resize(_+1),this.emplace(_,l,c,d,y)}emplace(l,c,d,y,_){const w=4*l;return this.uint16[w+0]=c,this.uint16[w+1]=d,this.uint16[w+2]=y,this.uint16[w+3]=_,l}}Vo.prototype.bytesPerElement=8,tr(Vo,"StructArrayLayout4ui8");class Ua extends er{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(l,c,d,y,_,w){const C=this.length;return this.resize(C+1),this.emplace(C,l,c,d,y,_,w)}emplace(l,c,d,y,_,w,C){const O=6*l;return this.int16[O+0]=c,this.int16[O+1]=d,this.int16[O+2]=y,this.int16[O+3]=_,this.int16[O+4]=w,this.int16[O+5]=C,l}}Ua.prototype.bytesPerElement=12,tr(Ua,"StructArrayLayout6i12");class Ws extends er{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(l,c,d,y,_,w,C,O,k,M,N,B){const W=this.length;return this.resize(W+1),this.emplace(W,l,c,d,y,_,w,C,O,k,M,N,B)}emplace(l,c,d,y,_,w,C,O,k,M,N,B,W){const Y=12*l;return this.int16[Y+0]=c,this.int16[Y+1]=d,this.int16[Y+2]=y,this.int16[Y+3]=_,this.uint16[Y+4]=w,this.uint16[Y+5]=C,this.uint16[Y+6]=O,this.uint16[Y+7]=k,this.int16[Y+8]=M,this.int16[Y+9]=N,this.int16[Y+10]=B,this.int16[Y+11]=W,l}}Ws.prototype.bytesPerElement=24,tr(Ws,"StructArrayLayout4i4ui4i24");class Zn extends er{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(l,c,d,y,_,w){const C=this.length;return this.resize(C+1),this.emplace(C,l,c,d,y,_,w)}emplace(l,c,d,y,_,w,C){const O=10*l,k=5*l;return this.int16[O+0]=c,this.int16[O+1]=d,this.int16[O+2]=y,this.float32[k+2]=_,this.float32[k+3]=w,this.float32[k+4]=C,l}}Zn.prototype.bytesPerElement=20,tr(Zn,"StructArrayLayout3i3f20");class Ln extends er{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(l){const c=this.length;return this.resize(c+1),this.emplace(c,l)}emplace(l,c){return this.uint32[1*l+0]=c,l}}Ln.prototype.bytesPerElement=4,tr(Ln,"StructArrayLayout1ul4");class _n extends er{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(l,c,d,y,_,w,C,O,k,M,N,B,W){const Y=this.length;return this.resize(Y+1),this.emplace(Y,l,c,d,y,_,w,C,O,k,M,N,B,W)}emplace(l,c,d,y,_,w,C,O,k,M,N,B,W,Y){const J=20*l,ie=10*l;return this.int16[J+0]=c,this.int16[J+1]=d,this.int16[J+2]=y,this.int16[J+3]=_,this.int16[J+4]=w,this.float32[ie+3]=C,this.float32[ie+4]=O,this.float32[ie+5]=k,this.float32[ie+6]=M,this.int16[J+14]=N,this.uint32[ie+8]=B,this.uint16[J+18]=W,this.uint16[J+19]=Y,l}}_n.prototype.bytesPerElement=40,tr(_n,"StructArrayLayout5i4f1i1ul2ui40");class di extends er{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(l,c,d,y,_,w,C){const O=this.length;return this.resize(O+1),this.emplace(O,l,c,d,y,_,w,C)}emplace(l,c,d,y,_,w,C,O){const k=8*l;return this.int16[k+0]=c,this.int16[k+1]=d,this.int16[k+2]=y,this.int16[k+4]=_,this.int16[k+5]=w,this.int16[k+6]=C,this.int16[k+7]=O,l}}di.prototype.bytesPerElement=16,tr(di,"StructArrayLayout3i2i2i16");class bo extends er{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(l,c,d,y,_){const w=this.length;return this.resize(w+1),this.emplace(w,l,c,d,y,_)}emplace(l,c,d,y,_,w){const C=4*l,O=8*l;return this.float32[C+0]=c,this.float32[C+1]=d,this.float32[C+2]=y,this.int16[O+6]=_,this.int16[O+7]=w,l}}bo.prototype.bytesPerElement=16,tr(bo,"StructArrayLayout2f1f2i16");class Yn extends er{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(l,c,d,y){const _=this.length;return this.resize(_+1),this.emplace(_,l,c,d,y)}emplace(l,c,d,y,_){const w=12*l,C=3*l;return this.uint8[w+0]=c,this.uint8[w+1]=d,this.float32[C+1]=y,this.float32[C+2]=_,l}}Yn.prototype.bytesPerElement=12,tr(Yn,"StructArrayLayout2ub2f12");class wo extends er{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(l,c,d){const y=this.length;return this.resize(y+1),this.emplace(y,l,c,d)}emplace(l,c,d,y){const _=3*l;return this.float32[_+0]=c,this.float32[_+1]=d,this.float32[_+2]=y,l}}wo.prototype.bytesPerElement=12,tr(wo,"StructArrayLayout3f12");class So extends er{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(l,c,d){const y=this.length;return this.resize(y+1),this.emplace(y,l,c,d)}emplace(l,c,d,y){const _=3*l;return this.uint16[_+0]=c,this.uint16[_+1]=d,this.uint16[_+2]=y,l}}So.prototype.bytesPerElement=6,tr(So,"StructArrayLayout3ui6");class Tl extends er{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(l,c,d,y,_,w,C,O,k,M,N,B,W,Y,J,ie,pe,Ce,he,Se,ke){const Te=this.length;return this.resize(Te+1),this.emplace(Te,l,c,d,y,_,w,C,O,k,M,N,B,W,Y,J,ie,pe,Ce,he,Se,ke)}emplace(l,c,d,y,_,w,C,O,k,M,N,B,W,Y,J,ie,pe,Ce,he,Se,ke,Te){const lt=30*l,it=15*l,vt=60*l;return this.int16[lt+0]=c,this.int16[lt+1]=d,this.int16[lt+2]=y,this.float32[it+2]=_,this.float32[it+3]=w,this.uint16[lt+8]=C,this.uint16[lt+9]=O,this.uint32[it+5]=k,this.uint32[it+6]=M,this.uint32[it+7]=N,this.uint16[lt+16]=B,this.uint16[lt+17]=W,this.uint16[lt+18]=Y,this.float32[it+10]=J,this.float32[it+11]=ie,this.uint8[vt+48]=pe,this.uint8[vt+49]=Ce,this.uint8[vt+50]=he,this.uint32[it+13]=Se,this.int16[lt+28]=ke,this.uint8[vt+58]=Te,l}}Tl.prototype.bytesPerElement=60,tr(Tl,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class af extends er{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(l,c,d,y,_,w,C,O,k,M,N,B,W,Y,J,ie,pe,Ce,he,Se,ke,Te,lt,it,vt,$t,ht,bt,St,Pt){const Nt=this.length;return this.resize(Nt+1),this.emplace(Nt,l,c,d,y,_,w,C,O,k,M,N,B,W,Y,J,ie,pe,Ce,he,Se,ke,Te,lt,it,vt,$t,ht,bt,St,Pt)}emplace(l,c,d,y,_,w,C,O,k,M,N,B,W,Y,J,ie,pe,Ce,he,Se,ke,Te,lt,it,vt,$t,ht,bt,St,Pt,Nt){const dt=38*l,Wt=19*l;return this.int16[dt+0]=c,this.int16[dt+1]=d,this.int16[dt+2]=y,this.float32[Wt+2]=_,this.float32[Wt+3]=w,this.int16[dt+8]=C,this.int16[dt+9]=O,this.int16[dt+10]=k,this.int16[dt+11]=M,this.int16[dt+12]=N,this.int16[dt+13]=B,this.uint16[dt+14]=W,this.uint16[dt+15]=Y,this.uint16[dt+16]=J,this.uint16[dt+17]=ie,this.uint16[dt+18]=pe,this.uint16[dt+19]=Ce,this.uint16[dt+20]=he,this.uint16[dt+21]=Se,this.uint16[dt+22]=ke,this.uint16[dt+23]=Te,this.uint16[dt+24]=lt,this.uint16[dt+25]=it,this.uint16[dt+26]=vt,this.uint16[dt+27]=$t,this.uint16[dt+28]=ht,this.uint32[Wt+15]=bt,this.float32[Wt+16]=St,this.float32[Wt+17]=Pt,this.float32[Wt+18]=Nt,l}}af.prototype.bytesPerElement=76,tr(af,"StructArrayLayout3i2f6i15ui1ul3f76");class aa extends er{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(l){const c=this.length;return this.resize(c+1),this.emplace(c,l)}emplace(l,c){return this.float32[1*l+0]=c,l}}aa.prototype.bytesPerElement=4,tr(aa,"StructArrayLayout1f4");class Ea extends er{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(l,c,d,y,_){const w=this.length;return this.resize(w+1),this.emplace(w,l,c,d,y,_)}emplace(l,c,d,y,_,w){const C=5*l;return this.float32[C+0]=c,this.float32[C+1]=d,this.float32[C+2]=y,this.float32[C+3]=_,this.float32[C+4]=w,l}}Ea.prototype.bytesPerElement=20,tr(Ea,"StructArrayLayout5f20");class Gs extends er{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(l,c,d,y){const _=this.length;return this.resize(_+1),this.emplace(_,l,c,d,y)}emplace(l,c,d,y,_){const w=6*l;return this.uint32[3*l+0]=c,this.uint16[w+2]=d,this.uint16[w+3]=y,this.uint16[w+4]=_,l}}Gs.prototype.bytesPerElement=12,tr(Gs,"StructArrayLayout1ul3ui12");class Ol extends er{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(l,c){const d=this.length;return this.resize(d+1),this.emplace(d,l,c)}emplace(l,c,d){const y=2*l;return this.uint16[y+0]=c,this.uint16[y+1]=d,l}}Ol.prototype.bytesPerElement=4,tr(Ol,"StructArrayLayout2ui4");class Rl extends er{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(l){const c=this.length;return this.resize(c+1),this.emplace(c,l)}emplace(l,c){return this.uint16[1*l+0]=c,l}}Rl.prototype.bytesPerElement=2,tr(Rl,"StructArrayLayout1ui2");class sf extends er{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(l,c){const d=this.length;return this.resize(d+1),this.emplace(d,l,c)}emplace(l,c,d){const y=2*l;return this.float32[y+0]=c,this.float32[y+1]=d,l}}sf.prototype.bytesPerElement=8,tr(sf,"StructArrayLayout2f8");class TU extends rr{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}TU.prototype.size=40;class xI extends _n{get(l){return new TU(this,l)}}tr(xI,"CollisionBoxArray");class OU extends rr{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(l){this._structArray.uint8[this._pos1+49]=l}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(l){this._structArray.uint8[this._pos1+50]=l}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(l){this._structArray.uint32[this._pos4+13]=l}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(l){this._structArray.uint8[this._pos1+58]=l}}OU.prototype.size=60;class RU extends Tl{get(l){return new OU(this,l)}}tr(RU,"PlacedSymbolArray");class kU extends rr{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+11]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+13]}get key(){return this._structArray.uint16[this._pos2+14]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+17]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+19]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+21]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+22]}get featureIndex(){return this._structArray.uint16[this._pos2+23]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+25]}get numIconVertices(){return this._structArray.uint16[this._pos2+26]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+27]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+28]}get crossTileID(){return this._structArray.uint32[this._pos4+15]}set crossTileID(l){this._structArray.uint32[this._pos4+15]=l}get textOffset0(){return this._structArray.float32[this._pos4+16]}get textOffset1(){return this._structArray.float32[this._pos4+17]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+18]}}kU.prototype.size=76;class PU extends af{get(l){return new kU(this,l)}}tr(PU,"SymbolInstanceArray");class AU extends aa{getoffsetX(l){return this.float32[1*l+0]}}tr(AU,"GlyphOffsetArray");class IU extends gr{getx(l){return this.int16[2*l+0]}gety(l){return this.int16[2*l+1]}}tr(IU,"SymbolLineVertexArray");class MU extends rr{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}MU.prototype.size=12;class DU extends Gs{get(l){return new MU(this,l)}}tr(DU,"FeatureIndexArray");class $U extends Ol{geta_centroid_pos0(l){return this.uint16[2*l+0]}geta_centroid_pos1(l){return this.uint16[2*l+1]}}tr($U,"FillExtrusionCentroidArray");const Sce=fr([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),xce=fr([{name:"a_dash",components:4,type:"Uint16"}]);var td={},Cce={get exports(){return td},set exports(u){td=u}},CI={};({get exports(){return CI},set exports(u){CI=u}}).exports=function(u,l){var c,d,y,_,w,C,O,k;for(d=u.length-(c=3&u.length),y=l,w=3432918353,C=461845907,k=0;k<d;)O=255&u.charCodeAt(k)|(255&u.charCodeAt(++k))<<8|(255&u.charCodeAt(++k))<<16|(255&u.charCodeAt(++k))<<24,++k,y=27492+(65535&(_=5*(65535&(y=(y^=O=(65535&(O=(O=(65535&O)*w+(((O>>>16)*w&65535)<<16)&4294967295)<<15|O>>>17))*C+(((O>>>16)*C&65535)<<16)&4294967295)<<13|y>>>19))+((5*(y>>>16)&65535)<<16)&4294967295))+((58964+(_>>>16)&65535)<<16);switch(O=0,c){case 3:O^=(255&u.charCodeAt(k+2))<<16;case 2:O^=(255&u.charCodeAt(k+1))<<8;case 1:y^=O=(65535&(O=(O=(65535&(O^=255&u.charCodeAt(k)))*w+(((O>>>16)*w&65535)<<16)&4294967295)<<15|O>>>17))*C+(((O>>>16)*C&65535)<<16)&4294967295}return y^=u.length,y=2246822507*(65535&(y^=y>>>16))+((2246822507*(y>>>16)&65535)<<16)&4294967295,y=3266489909*(65535&(y^=y>>>13))+((3266489909*(y>>>16)&65535)<<16)&4294967295,(y^=y>>>16)>>>0};var EI={};({get exports(){return EI},set exports(u){EI=u}}).exports=function(u,l){for(var c,d=u.length,y=l^d,_=0;d>=4;)c=1540483477*(65535&(c=255&u.charCodeAt(_)|(255&u.charCodeAt(++_))<<8|(255&u.charCodeAt(++_))<<16|(255&u.charCodeAt(++_))<<24))+((1540483477*(c>>>16)&65535)<<16),y=1540483477*(65535&y)+((1540483477*(y>>>16)&65535)<<16)^(c=1540483477*(65535&(c^=c>>>24))+((1540483477*(c>>>16)&65535)<<16)),d-=4,++_;switch(d){case 3:y^=(255&u.charCodeAt(_+2))<<16;case 2:y^=(255&u.charCodeAt(_+1))<<8;case 1:y=1540483477*(65535&(y^=255&u.charCodeAt(_)))+((1540483477*(y>>>16)&65535)<<16)}return y=1540483477*(65535&(y^=y>>>13))+((1540483477*(y>>>16)&65535)<<16),(y^=y>>>15)>>>0};var LU=CI,Ece=EI;Cce.exports=LU,td.murmur3=LU,td.murmur2=Ece;class CE{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(l,c,d,y){this.ids.push(NU(l)),this.positions.push(c,d,y)}getPositions(l){const c=NU(l);let d=0,y=this.ids.length-1;for(;d<y;){const w=d+y>>1;this.ids[w]>=c?y=w:d=w+1}const _=[];for(;this.ids[d]===c;)_.push({index:this.positions[3*d],start:this.positions[3*d+1],end:this.positions[3*d+2]}),d++;return _}static serialize(l,c){const d=new Float64Array(l.ids),y=new Uint32Array(l.positions);return TI(d,y,0,d.length-1),c&&c.push(d.buffer,y.buffer),{ids:d,positions:y}}static deserialize(l){const c=new CE;return c.ids=l.ids,c.positions=l.positions,c.indexed=!0,c}}function NU(u){const l=+u;return!isNaN(l)&&Number.MIN_SAFE_INTEGER<=l&&l<=Number.MAX_SAFE_INTEGER?l:td(String(u))}function TI(u,l,c,d){for(;c<d;){const y=u[c+d>>1];let _=c-1,w=d+1;for(;;){do _++;while(u[_]<y);do w--;while(u[w]>y);if(_>=w)break;EE(u,_,w),EE(l,3*_,3*w),EE(l,3*_+1,3*w+1),EE(l,3*_+2,3*w+2)}w-c<d-w?(TI(u,l,c,w),c=w+1):(TI(u,l,w+1,d),d=w)}}function EE(u,l,c){const d=u[l];u[l]=u[c],u[c]=d}tr(CE,"FeaturePositionMap");class xu{constructor(l){this.gl=l.gl,this.initialized=!1}fetchUniformLocation(l,c){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(l,c),this.initialized=!0),!!this.location}}class TE extends xu{constructor(l){super(l),this.current=0}set(l,c,d){this.fetchUniformLocation(l,c)&&this.current!==d&&(this.current=d,this.gl.uniform1f(this.location,d))}}class BU extends xu{constructor(l){super(l),this.current=[0,0,0,0]}set(l,c,d){this.fetchUniformLocation(l,c)&&(d[0]===this.current[0]&&d[1]===this.current[1]&&d[2]===this.current[2]&&d[3]===this.current[3]||(this.current=d,this.gl.uniform4f(this.location,d[0],d[1],d[2],d[3])))}}class jU extends xu{constructor(l){super(l),this.current=wi.transparent}set(l,c,d){this.fetchUniformLocation(l,c)&&(d.r===this.current.r&&d.g===this.current.g&&d.b===this.current.b&&d.a===this.current.a||(this.current=d,this.gl.uniform4f(this.location,d.r,d.g,d.b,d.a)))}}const Tce=new Float32Array(16),Oce=new Float32Array(9),Rce=new Float32Array(4);function OI(u){return[ur(255*u.r,255*u.g),ur(255*u.b,255*u.a)]}class Zb{constructor(l,c,d){this.value=l,this.uniformNames=c.map(y=>`u_${y}`),this.type=d}setUniform(l,c,d,y,_){c.set(l,_,y.constantOr(this.value))}getBinding(l,c){return this.type==="color"?new jU(l):new TE(l)}}class Fm{constructor(l,c){this.uniformNames=c.map(d=>`u_${d}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(l){this.pixelRatio=l.pixelRatio||1,this.pattern=l.tl.concat(l.br)}setUniform(l,c,d,y,_){const w=_==="u_pattern"||_==="u_dash"?this.pattern:_==="u_pixel_ratio"?this.pixelRatio:null;w&&c.set(l,_,w)}getBinding(l,c){return c==="u_pattern"||c==="u_dash"?new BU(l):new TE(l)}}class Cu{constructor(l,c,d,y){this.expression=l,this.type=d,this.maxValue=0,this.paintVertexAttributes=c.map(_=>({name:`a_${_}`,type:"Float32",components:d==="color"?2:1,offset:0})),this.paintVertexArray=new y}populatePaintArray(l,c,d,y,_,w){const C=this.paintVertexArray.length,O=this.expression.evaluate(new Xe(0),c,{},_,y,w);this.paintVertexArray.resize(l),this._setPaintValue(C,l,O)}updatePaintArray(l,c,d,y,_){const w=this.expression.evaluate({zoom:0},d,y,void 0,_);this._setPaintValue(l,c,w)}_setPaintValue(l,c,d){if(this.type==="color"){const y=OI(d);for(let _=l;_<c;_++)this.paintVertexArray.emplace(_,y[0],y[1])}else{for(let y=l;y<c;y++)this.paintVertexArray.emplace(y,d);this.maxValue=Math.max(this.maxValue,Math.abs(d))}}upload(l){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=l.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Ys{constructor(l,c,d,y,_,w){this.expression=l,this.uniformNames=c.map(C=>`u_${C}_t`),this.type=d,this.useIntegerZoom=y,this.zoom=_,this.maxValue=0,this.paintVertexAttributes=c.map(C=>({name:`a_${C}`,type:"Float32",components:d==="color"?4:2,offset:0})),this.paintVertexArray=new w}populatePaintArray(l,c,d,y,_,w){const C=this.expression.evaluate(new Xe(this.zoom),c,{},_,y,w),O=this.expression.evaluate(new Xe(this.zoom+1),c,{},_,y,w),k=this.paintVertexArray.length;this.paintVertexArray.resize(l),this._setPaintValue(k,l,C,O)}updatePaintArray(l,c,d,y,_){const w=this.expression.evaluate({zoom:this.zoom},d,y,void 0,_),C=this.expression.evaluate({zoom:this.zoom+1},d,y,void 0,_);this._setPaintValue(l,c,w,C)}_setPaintValue(l,c,d,y){if(this.type==="color"){const _=OI(d),w=OI(y);for(let C=l;C<c;C++)this.paintVertexArray.emplace(C,_[0],_[1],w[0],w[1])}else{for(let _=l;_<c;_++)this.paintVertexArray.emplace(_,d,y);this.maxValue=Math.max(this.maxValue,Math.abs(d),Math.abs(y))}}upload(l){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=l.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(l,c,d,y,_){const w=this.useIntegerZoom?Math.floor(d.zoom):d.zoom,C=Fe(this.expression.interpolationFactor(w,this.zoom,this.zoom+1),0,1);c.set(l,_,C)}getBinding(l,c){return new TE(l)}}class lf{constructor(l,c,d,y,_){this.expression=l,this.layerId=_,this.paintVertexAttributes=(d==="array"?xce:Sce).members;for(let w=0;w<c.length;++w);this.paintVertexArray=new y}populatePaintArray(l,c,d){const y=this.paintVertexArray.length;this.paintVertexArray.resize(l),this._setPaintValues(y,l,c.patterns&&c.patterns[this.layerId],d)}updatePaintArray(l,c,d,y,_,w){this._setPaintValues(l,c,d.patterns&&d.patterns[this.layerId],w)}_setPaintValues(l,c,d,y){if(!y||!d)return;const _=y[d];if(!_)return;const{tl:w,br:C,pixelRatio:O}=_;for(let k=l;k<c;k++)this.paintVertexArray.emplace(k,w[0],w[1],C[0],C[1],O)}upload(l){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=l.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class uf{constructor(l,c,d=()=>!0){this.binders={},this._buffers=[];const y=[];for(const _ in l.paint._values){if(!d(_))continue;const w=l.paint.get(_);if(!(w instanceof Ot&&Zc(w.property.specification)))continue;const C=Pce(_,l.type),O=w.value,k=w.property.specification.type,M=!!w.property.useIntegerZoom,N=_==="line-dasharray"||_.endsWith("pattern"),B=_==="line-dasharray"&&l.layout.get("line-cap").value.kind!=="constant";if(O.kind!=="constant"||B)if(O.kind==="source"||B||N){const W=zU(_,k,"source");this.binders[_]=N?new lf(O,C,k,W,l.id):new Cu(O,C,k,W),y.push(`/a_${_}`)}else{const W=zU(_,k,"composite");this.binders[_]=new Ys(O,C,k,M,c,W),y.push(`/z_${_}`)}else this.binders[_]=N?new Fm(O.value,C):new Zb(O.value,C,k),y.push(`/u_${_}`)}this.cacheKey=y.sort().join("")}getMaxValue(l){const c=this.binders[l];return c instanceof Cu||c instanceof Ys?c.maxValue:0}populatePaintArrays(l,c,d,y,_,w){for(const C in this.binders){const O=this.binders[C];(O instanceof Cu||O instanceof Ys||O instanceof lf)&&O.populatePaintArray(l,c,d,y,_,w)}}setConstantPatternPositions(l){for(const c in this.binders){const d=this.binders[c];d instanceof Fm&&d.setConstantPatternPositions(l)}}updatePaintArrays(l,c,d,y,_,w){let C=!1;for(const O in l){const k=c.getPositions(O);for(const M of k){const N=d.feature(M.index);for(const B in this.binders){const W=this.binders[B];if((W instanceof Cu||W instanceof Ys||W instanceof lf)&&W.expression.isStateDependent===!0){const Y=y.paint.get(B);W.expression=Y.value,W.updatePaintArray(M.start,M.end,N,l[O],_,w),C=!0}}}}return C}defines(){const l=[];for(const c in this.binders){const d=this.binders[c];(d instanceof Zb||d instanceof Fm)&&l.push(...d.uniformNames.map(y=>`#define HAS_UNIFORM_${y}`))}return l}getBinderAttributes(){const l=[];for(const c in this.binders){const d=this.binders[c];if(d instanceof Cu||d instanceof Ys||d instanceof lf)for(let y=0;y<d.paintVertexAttributes.length;y++)l.push(d.paintVertexAttributes[y].name)}return l}getBinderUniforms(){const l=[];for(const c in this.binders){const d=this.binders[c];if(d instanceof Zb||d instanceof Fm||d instanceof Ys)for(const y of d.uniformNames)l.push(y)}return l}getPaintVertexBuffers(){return this._buffers}getUniforms(l){const c=[];for(const d in this.binders){const y=this.binders[d];if(y instanceof Zb||y instanceof Fm||y instanceof Ys)for(const _ of y.uniformNames)c.push({name:_,property:d,binding:y.getBinding(l,_)})}return c}setUniforms(l,c,d,y,_){for(const{name:w,property:C,binding:O}of d)this.binders[C].setUniform(l,O,_,y.get(C),w)}updatePaintBuffers(){this._buffers=[];for(const l in this.binders){const c=this.binders[l];(c instanceof Cu||c instanceof Ys||c instanceof lf)&&c.paintVertexBuffer&&this._buffers.push(c.paintVertexBuffer)}}upload(l){for(const c in this.binders){const d=this.binders[c];(d instanceof Cu||d instanceof Ys||d instanceof lf)&&d.upload(l)}this.updatePaintBuffers()}destroy(){for(const l in this.binders){const c=this.binders[l];(c instanceof Cu||c instanceof Ys||c instanceof lf)&&c.destroy()}}}class rd{constructor(l,c,d=()=>!0){this.programConfigurations={};for(const y of l)this.programConfigurations[y.id]=new uf(y,c,d);this.needsUpload=!1,this._featureMap=new CE,this._bufferOffset=0}populatePaintArrays(l,c,d,y,_,w,C){for(const O in this.programConfigurations)this.programConfigurations[O].populatePaintArrays(l,c,y,_,w,C);c.id!==void 0&&this._featureMap.add(c.id,d,this._bufferOffset,l),this._bufferOffset=l,this.needsUpload=!0}updatePaintArrays(l,c,d,y,_){for(const w of d)this.needsUpload=this.programConfigurations[w.id].updatePaintArrays(l,this._featureMap,c,w,y,_)||this.needsUpload}get(l){return this.programConfigurations[l]}upload(l){if(this.needsUpload){for(const c in this.programConfigurations)this.programConfigurations[c].upload(l);this.needsUpload=!1}}destroy(){for(const l in this.programConfigurations)this.programConfigurations[l].destroy()}}const kce={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function Pce(u,l){return kce[u]||[u.replace(`${l}-`,"").replace(/-/g,"_")]}const Ace={"line-pattern":{source:Ti,composite:Ti},"fill-pattern":{source:Ti,composite:Ti},"fill-extrusion-pattern":{source:Ti,composite:Ti},"line-dasharray":{source:Vo,composite:Vo}},Ice={color:{source:sf,composite:$n},number:{source:aa,composite:sf}};function zU(u,l,c){const d=Ace[u];return d&&d[c]||Ice[l][c]}tr(Zb,"ConstantBinder"),tr(Fm,"PatternConstantBinder"),tr(Cu,"SourceExpressionBinder"),tr(lf,"PatternCompositeBinder"),tr(Ys,"CompositeExpressionBinder"),tr(uf,"ProgramConfiguration",{omit:["_buffers"]}),tr(rd,"ProgramConfigurationSet");const OE="-transition";class Ks extends Gn{constructor(l,c){if(super(),this.id=l.id,this.type=l.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,l.type!=="custom"&&(this.metadata=l.metadata,this.minzoom=l.minzoom,this.maxzoom=l.maxzoom,l.type!=="background"&&l.type!=="sky"&&(this.source=l.source,this.sourceLayer=l["source-layer"],this.filter=l.filter),c.layout&&(this._unevaluatedLayout=new pt(c.layout)),c.paint)){this._transitionablePaint=new Bt(c.paint);for(const d in l.paint)this.setPaintProperty(d,l.paint[d],{validate:!1});for(const d in l.layout)this.setLayoutProperty(d,l.layout[d],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new at(c.paint)}}getLayoutProperty(l){return l==="visibility"?this.visibility:this._unevaluatedLayout.getValue(l)}setLayoutProperty(l,c,d={}){c!=null&&this._validate(cE,`layers.${this.id}.layout.${l}`,l,c,d)||(l!=="visibility"?this._unevaluatedLayout.setValue(l,c):this.visibility=c)}getPaintProperty(l){return Je(l,OE)?this._transitionablePaint.getTransition(l.slice(0,-OE.length)):this._transitionablePaint.getValue(l)}setPaintProperty(l,c,d={}){if(c!=null&&this._validate(SI,`layers.${this.id}.paint.${l}`,l,c,d))return!1;if(Je(l,OE))return this._transitionablePaint.setTransition(l.slice(0,-OE.length),c||void 0),!1;{const y=this._transitionablePaint._values[l],_=y.value.isDataDriven(),w=y.value;this._transitionablePaint.setValue(l,c),this._handleSpecialPaintPropertyUpdate(l);const C=this._transitionablePaint._values[l].value,O=C.isDataDriven(),k=Je(l,"pattern")||l==="line-dasharray";return O||_||k||this._handleOverridablePaintPropertyUpdate(l,w,C)}}_handleSpecialPaintPropertyUpdate(l){}getProgramIds(){return null}getProgramConfiguration(l){return null}_handleOverridablePaintPropertyUpdate(l,c,d){return!1}isHidden(l){return!!(this.minzoom&&l<this.minzoom)||!!(this.maxzoom&&l>=this.maxzoom)||this.visibility==="none"}updateTransitions(l){this._transitioningPaint=this._transitionablePaint.transitioned(l,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(l,c){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(l,void 0,c)),this.paint=this._transitioningPaint.possiblyEvaluate(l,void 0,c)}serialize(){const l={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(l.layout=l.layout||{},l.layout.visibility=this.visibility),kt(l,(c,d)=>!(c===void 0||d==="layout"&&!Object.keys(c).length||d==="paint"&&!Object.keys(c).length))}_validate(l,c,d,y,_={}){return(!_||_.validate!==!1)&&fE(this,l.call(uE,{key:c,layerType:this.type,objectKey:d,value:y,styleSpec:yt,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const l in this.paint._values){const c=this.paint.get(l);if(c instanceof Ot&&Zc(c.property.specification)&&(c.value.kind==="source"||c.value.kind==="composite")&&c.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=Pm(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}}const Mce=fr([{name:"a_pos",components:2,type:"Int16"}],4),Dce=fr([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class Oi{constructor(l=[]){this.segments=l}prepareSegment(l,c,d,y){let _=this.segments[this.segments.length-1];return l>Oi.MAX_VERTEX_ARRAY_LENGTH&&Ft(`Max vertices per segment is ${Oi.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${l}`),(!_||_.vertexLength+l>Oi.MAX_VERTEX_ARRAY_LENGTH||_.sortKey!==y)&&(_={vertexOffset:c.length,primitiveOffset:d.length,vertexLength:0,primitiveLength:0},y!==void 0&&(_.sortKey=y),this.segments.push(_)),_}get(){return this.segments}destroy(){for(const l of this.segments)for(const c in l.vaos)l.vaos[c].destroy()}static simpleSegment(l,c,d,y){return new Oi([{vertexOffset:l,primitiveOffset:c,vertexLength:d,primitiveLength:y,vaos:{},sortKey:0}])}}Oi.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,tr(Oi,"SegmentVector");var kr=8192;class cf{constructor(l,c){l&&(c?this.setSouthWest(l).setNorthEast(c):l.length===4?this.setSouthWest([l[0],l[1]]).setNorthEast([l[2],l[3]]):this.setSouthWest(l[0]).setNorthEast(l[1]))}setNorthEast(l){return this._ne=l instanceof vn?new vn(l.lng,l.lat):vn.convert(l),this}setSouthWest(l){return this._sw=l instanceof vn?new vn(l.lng,l.lat):vn.convert(l),this}extend(l){const c=this._sw,d=this._ne;let y,_;if(l instanceof vn)y=l,_=l;else{if(!(l instanceof cf))return Array.isArray(l)?l.length===4||l.every(Array.isArray)?this.extend(cf.convert(l)):this.extend(vn.convert(l)):typeof l=="object"&&l!==null&&l.hasOwnProperty("lat")&&(l.hasOwnProperty("lon")||l.hasOwnProperty("lng"))?this.extend(vn.convert(l)):this;if(y=l._sw,_=l._ne,!y||!_)return this}return c||d?(c.lng=Math.min(y.lng,c.lng),c.lat=Math.min(y.lat,c.lat),d.lng=Math.max(_.lng,d.lng),d.lat=Math.max(_.lat,d.lat)):(this._sw=new vn(y.lng,y.lat),this._ne=new vn(_.lng,_.lat)),this}getCenter(){return new vn((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new vn(this.getWest(),this.getNorth())}getSouthEast(){return new vn(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(l){const{lng:c,lat:d}=vn.convert(l);let y=this._sw.lng<=c&&c<=this._ne.lng;return this._sw.lng>this._ne.lng&&(y=this._sw.lng>=c&&c>=this._ne.lng),this._sw.lat<=d&&d<=this._ne.lat&&y}static convert(l){return!l||l instanceof cf?l:new cf(l)}}var RE=1e-6,Ta=typeof Float32Array<"u"?Float32Array:Array;function FU(){var u=new Ta(9);return Ta!=Float32Array&&(u[1]=0,u[2]=0,u[3]=0,u[5]=0,u[6]=0,u[7]=0),u[0]=1,u[4]=1,u[8]=1,u}function HU(u,l,c){var d=l[0],y=l[1],_=l[2],w=l[3],C=l[4],O=l[5],k=l[6],M=l[7],N=l[8],B=c[0],W=c[1],Y=c[2],J=c[3],ie=c[4],pe=c[5],Ce=c[6],he=c[7],Se=c[8];return u[0]=B*d+W*w+Y*k,u[1]=B*y+W*C+Y*M,u[2]=B*_+W*O+Y*N,u[3]=J*d+ie*w+pe*k,u[4]=J*y+ie*C+pe*M,u[5]=J*_+ie*O+pe*N,u[6]=Ce*d+he*w+Se*k,u[7]=Ce*y+he*C+Se*M,u[8]=Ce*_+he*O+Se*N,u}function qs(u){return u[0]=1,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=1,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=1,u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1,u}function RI(u,l){var c=l[0],d=l[1],y=l[2],_=l[3],w=l[4],C=l[5],O=l[6],k=l[7],M=l[8],N=l[9],B=l[10],W=l[11],Y=l[12],J=l[13],ie=l[14],pe=l[15],Ce=c*C-d*w,he=c*O-y*w,Se=c*k-_*w,ke=d*O-y*C,Te=d*k-_*C,lt=y*k-_*O,it=M*J-N*Y,vt=M*ie-B*Y,$t=M*pe-W*Y,ht=N*ie-B*J,bt=N*pe-W*J,St=B*pe-W*ie,Pt=Ce*St-he*bt+Se*ht+ke*$t-Te*vt+lt*it;return Pt?(u[0]=(C*St-O*bt+k*ht)*(Pt=1/Pt),u[1]=(y*bt-d*St-_*ht)*Pt,u[2]=(J*lt-ie*Te+pe*ke)*Pt,u[3]=(B*Te-N*lt-W*ke)*Pt,u[4]=(O*$t-w*St-k*vt)*Pt,u[5]=(c*St-y*$t+_*vt)*Pt,u[6]=(ie*Se-Y*lt-pe*he)*Pt,u[7]=(M*lt-B*Se+W*he)*Pt,u[8]=(w*bt-C*$t+k*it)*Pt,u[9]=(d*$t-c*bt-_*it)*Pt,u[10]=(Y*Te-J*Se+pe*Ce)*Pt,u[11]=(N*Se-M*Te-W*Ce)*Pt,u[12]=(C*vt-w*ht-O*it)*Pt,u[13]=(c*ht-d*vt+y*it)*Pt,u[14]=(J*he-Y*ke-ie*Ce)*Pt,u[15]=(M*ke-N*he+B*Ce)*Pt,u):null}function nd(u,l,c){var d=l[0],y=l[1],_=l[2],w=l[3],C=l[4],O=l[5],k=l[6],M=l[7],N=l[8],B=l[9],W=l[10],Y=l[11],J=l[12],ie=l[13],pe=l[14],Ce=l[15],he=c[0],Se=c[1],ke=c[2],Te=c[3];return u[0]=he*d+Se*C+ke*N+Te*J,u[1]=he*y+Se*O+ke*B+Te*ie,u[2]=he*_+Se*k+ke*W+Te*pe,u[3]=he*w+Se*M+ke*Y+Te*Ce,u[4]=(he=c[4])*d+(Se=c[5])*C+(ke=c[6])*N+(Te=c[7])*J,u[5]=he*y+Se*O+ke*B+Te*ie,u[6]=he*_+Se*k+ke*W+Te*pe,u[7]=he*w+Se*M+ke*Y+Te*Ce,u[8]=(he=c[8])*d+(Se=c[9])*C+(ke=c[10])*N+(Te=c[11])*J,u[9]=he*y+Se*O+ke*B+Te*ie,u[10]=he*_+Se*k+ke*W+Te*pe,u[11]=he*w+Se*M+ke*Y+Te*Ce,u[12]=(he=c[12])*d+(Se=c[13])*C+(ke=c[14])*N+(Te=c[15])*J,u[13]=he*y+Se*O+ke*B+Te*ie,u[14]=he*_+Se*k+ke*W+Te*pe,u[15]=he*w+Se*M+ke*Y+Te*Ce,u}function Jb(u,l,c){var d,y,_,w,C,O,k,M,N,B,W,Y,J=c[0],ie=c[1],pe=c[2];return l===u?(u[12]=l[0]*J+l[4]*ie+l[8]*pe+l[12],u[13]=l[1]*J+l[5]*ie+l[9]*pe+l[13],u[14]=l[2]*J+l[6]*ie+l[10]*pe+l[14],u[15]=l[3]*J+l[7]*ie+l[11]*pe+l[15]):(y=l[1],_=l[2],w=l[3],C=l[4],O=l[5],k=l[6],M=l[7],N=l[8],B=l[9],W=l[10],Y=l[11],u[0]=d=l[0],u[1]=y,u[2]=_,u[3]=w,u[4]=C,u[5]=O,u[6]=k,u[7]=M,u[8]=N,u[9]=B,u[10]=W,u[11]=Y,u[12]=d*J+C*ie+N*pe+l[12],u[13]=y*J+O*ie+B*pe+l[13],u[14]=_*J+k*ie+W*pe+l[14],u[15]=w*J+M*ie+Y*pe+l[15]),u}function id(u,l,c){var d=c[0],y=c[1],_=c[2];return u[0]=l[0]*d,u[1]=l[1]*d,u[2]=l[2]*d,u[3]=l[3]*d,u[4]=l[4]*y,u[5]=l[5]*y,u[6]=l[6]*y,u[7]=l[7]*y,u[8]=l[8]*_,u[9]=l[9]*_,u[10]=l[10]*_,u[11]=l[11]*_,u[12]=l[12],u[13]=l[13],u[14]=l[14],u[15]=l[15],u}function kI(u,l,c){var d=Math.sin(c),y=Math.cos(c),_=l[4],w=l[5],C=l[6],O=l[7],k=l[8],M=l[9],N=l[10],B=l[11];return l!==u&&(u[0]=l[0],u[1]=l[1],u[2]=l[2],u[3]=l[3],u[12]=l[12],u[13]=l[13],u[14]=l[14],u[15]=l[15]),u[4]=_*y+k*d,u[5]=w*y+M*d,u[6]=C*y+N*d,u[7]=O*y+B*d,u[8]=k*y-_*d,u[9]=M*y-w*d,u[10]=N*y-C*d,u[11]=B*y-O*d,u}function kE(u,l,c){var d=Math.sin(c),y=Math.cos(c),_=l[0],w=l[1],C=l[2],O=l[3],k=l[8],M=l[9],N=l[10],B=l[11];return l!==u&&(u[4]=l[4],u[5]=l[5],u[6]=l[6],u[7]=l[7],u[12]=l[12],u[13]=l[13],u[14]=l[14],u[15]=l[15]),u[0]=_*y-k*d,u[1]=w*y-M*d,u[2]=C*y-N*d,u[3]=O*y-B*d,u[8]=_*d+k*y,u[9]=w*d+M*y,u[10]=C*d+N*y,u[11]=O*d+B*y,u}function VU(u,l){return u[0]=l[0],u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=l[1],u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=l[2],u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1,u}function UU(u,l,c){var d,y,_,w=c[0],C=c[1],O=c[2],k=Math.hypot(w,C,O);return k<RE?null:(w*=k=1/k,C*=k,O*=k,d=Math.sin(l),y=Math.cos(l),u[0]=w*w*(_=1-y)+y,u[1]=C*w*_+O*d,u[2]=O*w*_-C*d,u[3]=0,u[4]=w*C*_-O*d,u[5]=C*C*_+y,u[6]=O*C*_+w*d,u[7]=0,u[8]=w*O*_+C*d,u[9]=C*O*_-w*d,u[10]=O*O*_+y,u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1,u)}Math.hypot||(Math.hypot=function(){for(var u=0,l=arguments.length;l--;)u+=arguments[l]*arguments[l];return Math.sqrt(u)});var $ce=nd;function PI(){var u=new Ta(3);return Ta!=Float32Array&&(u[0]=0,u[1]=0,u[2]=0),u}function WU(u){var l=new Ta(3);return l[0]=u[0],l[1]=u[1],l[2]=u[2],l}function Qb(u){return Math.hypot(u[0],u[1],u[2])}function Hm(u,l,c){var d=new Ta(3);return d[0]=u,d[1]=l,d[2]=c,d}function Eu(u,l,c){return u[0]=l[0]+c[0],u[1]=l[1]+c[1],u[2]=l[2]+c[2],u}function AI(u,l,c){return u[0]=l[0]-c[0],u[1]=l[1]-c[1],u[2]=l[2]-c[2],u}function GU(u,l,c){return u[0]=l[0]*c[0],u[1]=l[1]*c[1],u[2]=l[2]*c[2],u}function ew(u,l,c){return u[0]=Math.min(l[0],c[0]),u[1]=Math.min(l[1],c[1]),u[2]=Math.min(l[2],c[2]),u}function tw(u,l,c){return u[0]=Math.max(l[0],c[0]),u[1]=Math.max(l[1],c[1]),u[2]=Math.max(l[2],c[2]),u}function Wa(u,l,c){return u[0]=l[0]*c,u[1]=l[1]*c,u[2]=l[2]*c,u}function rw(u,l,c,d){return u[0]=l[0]+c[0]*d,u[1]=l[1]+c[1]*d,u[2]=l[2]+c[2]*d,u}function Uo(u,l){var c=l[0],d=l[1],y=l[2],_=c*c+d*d+y*y;return _>0&&(_=1/Math.sqrt(_)),u[0]=l[0]*_,u[1]=l[1]*_,u[2]=l[2]*_,u}function gs(u,l){return u[0]*l[0]+u[1]*l[1]+u[2]*l[2]}function II(u,l,c){var d=l[0],y=l[1],_=l[2],w=c[0],C=c[1],O=c[2];return u[0]=y*O-_*C,u[1]=_*w-d*O,u[2]=d*C-y*w,u}function Si(u,l,c){var d=l[0],y=l[1],_=l[2],w=c[3]*d+c[7]*y+c[11]*_+c[15];return u[0]=(c[0]*d+c[4]*y+c[8]*_+c[12])/(w=w||1),u[1]=(c[1]*d+c[5]*y+c[9]*_+c[13])/w,u[2]=(c[2]*d+c[6]*y+c[10]*_+c[14])/w,u}function YU(u,l,c){var d=c[0],y=c[1],_=c[2],w=l[0],C=l[1],O=l[2],k=y*O-_*C,M=_*w-d*O,N=d*C-y*w,B=y*N-_*M,W=_*k-d*N,Y=d*M-y*k,J=2*c[3];return M*=J,N*=J,W*=2,Y*=2,u[0]=w+(k*=J)+(B*=2),u[1]=C+M+W,u[2]=O+N+Y,u}var nw,Xs=AI,Lce=GU,Nce=Qb;function KU(u,l,c){return u[0]=l[0]*c,u[1]=l[1]*c,u[2]=l[2]*c,u[3]=l[3]*c,u}function qU(u,l){var c=l[0],d=l[1],y=l[2],_=l[3],w=c*c+d*d+y*y+_*_;return w>0&&(w=1/Math.sqrt(w)),u[0]=c*w,u[1]=d*w,u[2]=y*w,u[3]=_*w,u}function od(u,l,c){var d=l[0],y=l[1],_=l[2],w=l[3];return u[0]=c[0]*d+c[4]*y+c[8]*_+c[12]*w,u[1]=c[1]*d+c[5]*y+c[9]*_+c[13]*w,u[2]=c[2]*d+c[6]*y+c[10]*_+c[14]*w,u[3]=c[3]*d+c[7]*y+c[11]*_+c[15]*w,u}function XU(){var u=new Ta(4);return Ta!=Float32Array&&(u[0]=0,u[1]=0,u[2]=0),u[3]=1,u}function ZU(u){return u[0]=0,u[1]=0,u[2]=0,u[3]=1,u}function JU(u,l,c){c*=.5;var d=l[0],y=l[1],_=l[2],w=l[3],C=Math.sin(c),O=Math.cos(c);return u[0]=d*O+w*C,u[1]=y*O+_*C,u[2]=_*O-y*C,u[3]=w*O-d*C,u}function QU(u,l,c){c*=.5;var d=l[0],y=l[1],_=l[2],w=l[3],C=Math.sin(c),O=Math.cos(c);return u[0]=d*O-_*C,u[1]=y*O+w*C,u[2]=_*O+d*C,u[3]=w*O-y*C,u}PI(),nw=new Ta(4),Ta!=Float32Array&&(nw[0]=0,nw[1]=0,nw[2]=0,nw[3]=0);var Bce=qU;PI(),Hm(1,0,0),Hm(0,1,0),XU(),XU(),FU();const jce=fr([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:e4}=jce,t4=fr([{name:"a_pos_3",components:3,type:"Int16"}]);var iw=fr([{name:"a_pos",type:"Int16",components:2}]);class MI{constructor(l,c){this.pos=l,this.dir=c}intersectsPlane(l,c,d){const y=gs(c,this.dir);if(Math.abs(y)<1e-6)return!1;const _=((l[0]-this.pos[0])*c[0]+(l[1]-this.pos[1])*c[1]+(l[2]-this.pos[2])*c[2])/y;return d[0]=this.pos[0]+this.dir[0]*_,d[1]=this.pos[1]+this.dir[1]*_,d[2]=this.pos[2]+this.dir[2]*_,!0}closestPointOnSphere(l,c,d){if(function(W,Y){var J=W[0],ie=W[1],pe=W[2],Ce=Y[0],he=Y[1],Se=Y[2];return Math.abs(J-Ce)<=RE*Math.max(1,Math.abs(J),Math.abs(Ce))&&Math.abs(ie-he)<=RE*Math.max(1,Math.abs(ie),Math.abs(he))&&Math.abs(pe-Se)<=RE*Math.max(1,Math.abs(pe),Math.abs(Se))}(this.pos,l)||c===0)return d[0]=d[1]=d[2]=0,!1;const[y,_,w]=this.dir,C=this.pos[0]-l[0],O=this.pos[1]-l[1],k=this.pos[2]-l[2],M=y*y+_*_+w*w,N=2*(C*y+O*_+k*w),B=N*N-4*M*(C*C+O*O+k*k-c*c);if(B<0){const W=Math.max(-N/2,0),Y=C+y*W,J=O+_*W,ie=k+w*W,pe=Math.hypot(Y,J,ie);return d[0]=Y*c/pe,d[1]=J*c/pe,d[2]=ie*c/pe,!1}{const W=(-N-Math.sqrt(B))/(2*M);if(W<0){const Y=Math.hypot(C,O,k);return d[0]=C*c/Y,d[1]=O*c/Y,d[2]=k*c/Y,!1}return d[0]=C+y*W,d[1]=O+_*W,d[2]=k+w*W,!0}}}class DI{constructor(l,c,d,y,_){this.TL=l,this.TR=c,this.BR=d,this.BL=y,this.horizon=_}static fromInvProjectionMatrix(l,c,d){const y=[-1,1,1],_=[1,1,1],w=[1,-1,1],C=[-1,-1,1],O=Si(y,y,l),k=Si(_,_,l),M=Si(w,w,l),N=Si(C,C,l);return new DI(O,k,M,N,c/d)}}class $I{constructor(l,c){this.points=l,this.planes=c}static fromInvProjectionMatrix(l,c,d,y){const _=Math.pow(2,d),w=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(O=>{const k=od([],O,l),M=1/k[3]/c*_;return function(N,B,W){return N[0]=B[0]*W[0],N[1]=B[1]*W[1],N[2]=B[2]*W[2],N[3]=B[3]*W[3],N}(k,k,[M,M,y?1/k[3]:M,M])}),C=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(O=>{const k=Uo([],II([],Xs([],w[O[0]],w[O[1]]),Xs([],w[O[2]],w[O[1]]))),M=-gs(k,w[O[1]]);return k.concat(M)});return new $I(w,C)}}class Wo{static fromPoints(l){const c=[1/0,1/0,1/0],d=[-1/0,-1/0,-1/0];for(const y of l)ew(c,c,y),tw(d,d,y);return new Wo(c,d)}static applyTransform(l,c){const d=l.getCorners();for(let y=0;y<d.length;++y)Si(d[y],d[y],c);return Wo.fromPoints(d)}constructor(l,c){this.min=l,this.max=c,this.center=Wa([],Eu([],this.min,this.max),.5)}quadrant(l){const c=[l%2==0,l<2],d=WU(this.min),y=WU(this.max);for(let _=0;_<c.length;_++)d[_]=c[_]?this.min[_]:this.center[_],y[_]=c[_]?this.center[_]:this.max[_];return y[2]=this.max[2],new Wo(d,y)}distanceX(l){return Math.max(Math.min(this.max[0],l[0]),this.min[0])-l[0]}distanceY(l){return Math.max(Math.min(this.max[1],l[1]),this.min[1])-l[1]}distanceZ(l){return Math.max(Math.min(this.max[2],l[2]),this.min[2])-l[2]}getCorners(){const l=this.min,c=this.max;return[[l[0],l[1],l[2]],[c[0],l[1],l[2]],[c[0],c[1],l[2]],[l[0],c[1],l[2]],[l[0],l[1],c[2]],[c[0],l[1],c[2]],[c[0],c[1],c[2]],[l[0],c[1],c[2]]]}intersects(l){const c=this.getCorners();let d=!0;for(let y=0;y<l.planes.length;y++){const _=l.planes[y];let w=0;for(let C=0;C<c.length;C++)w+=gs(_,c[C])+_[3]>=0;if(w===0)return 0;w!==c.length&&(d=!1)}if(d)return 2;for(let y=0;y<3;y++){let _=Number.MAX_VALUE,w=-Number.MAX_VALUE;for(let C=0;C<l.points.length;C++){const O=l.points[C][y]-this.min[y];_=Math.min(_,O),w=Math.max(w,O)}if(w<0||_>this.max[y]-this.min[y])return 0}return 1}}const kl=kr/Math.PI/2,ad=64,ow=[ad,32,16],vs=-kl,_s=kl,zce=[new Wo([vs,vs,vs],[_s,_s,_s]),new Wo([vs,vs,vs],[0,0,_s]),new Wo([0,vs,vs],[_s,0,_s]),new Wo([vs,0,vs],[0,_s,_s]),new Wo([0,0,vs],[_s,_s,_s])];function PE(u){return u*kl/lw}function r4(u,l,c,d=!0){const y=Wa([],u._camera.position,u.worldSize),_=[l,c,1,1];od(_,_,u.pixelMatrixInverse),KU(_,_,1/_[3]);const w=Uo([],Xs([],_,y)),C=u.globeMatrix,O=[C[12],C[13],C[14]],k=Xs([],O,y),M=Qb(k),N=Uo([],k),B=u.worldSize/(2*Math.PI),W=gs(N,w),Y=Math.asin(B/M);if(Y<Math.acos(W)){if(!d)return null;const $t=[],ht=[];Wa($t,w,M/W),Uo(ht,Xs(ht,$t,k)),Uo(w,Eu(w,k,Wa(w,ht,Math.tan(Y)*M)))}const J=[];new MI(y,w).closestPointOnSphere(O,B,J);const ie=Uo([],se(C,0)),pe=Uo([],se(C,1)),Ce=Uo([],se(C,2)),he=gs(ie,J),Se=gs(pe,J),ke=gs(Ce,J),Te=We(Math.asin(-Se/B));let lt=We(Math.atan2(he,ke));lt=u.center.lng+function($t,ht){const bt=(ht-$t+180)%360-180;return bt<-180?bt+360:bt}(u.center.lng,lt);const it=Al(lt),vt=Fe(Il(Te),0,1);return new Gm(it,vt)}class Fce{constructor(l,c,d){this.a=Xs([],l,d),this.b=Xs([],c,d),this.center=d;const y=Uo([],this.a),_=Uo([],this.b);this.angle=Math.acos(gs(y,_))}}function LI(u,l){if(u.angle===0)return null;let c;return c=u.a[l]===0?1/u.angle*.5*Math.PI:1/u.angle*Math.atan(u.b[l]/u.a[l]/Math.sin(u.angle)-1/Math.tan(u.angle)),c<0||c>1?null:function(d,y,_,w){const C=Math.sin(_);return d*(Math.sin((1-w)*_)/C)+y*(Math.sin(w*_)/C)}(u.a[l],u.b[l],u.angle,Fe(c,0,1))+u.center[l]}function Pl(u){if(u.z<=1)return zce[u.z+2*u.y+u.x];const l=NI(AE(u));return Wo.fromPoints(l)}function sd(u,l,c){return Wa(u,u,1-c),rw(u,u,l,c)}function n4(u,l){const c=Wm(l.zoom);if(c===0)return Pl(u);const d=AE(u),y=NI(d),_=Al(d.getWest())*l.worldSize,w=Al(d.getEast())*l.worldSize,C=Il(d.getNorth())*l.worldSize,O=Il(d.getSouth())*l.worldSize,k=[_,C,0],M=[w,C,0],N=[_,O,0],B=[w,O,0],W=RI([],l.globeMatrix);return Si(k,k,W),Si(M,M,W),Si(N,N,W),Si(B,B,W),y[0]=sd(y[0],N,c),y[1]=sd(y[1],B,c),y[2]=sd(y[2],M,c),y[3]=sd(y[3],k,c),Wo.fromPoints(y)}function i4(u,l,c){for(const d of u)Si(d,d,l),Wa(d,d,c)}function Hce(u,l,c){const d=l/u.worldSize,y=u.globeMatrix;if(c.z<=1){const it=Pl(c).getCorners();return i4(it,y,d),Wo.fromPoints(it)}const _=AE(c),w=NI(_);i4(w,y,d);const C=Number.MAX_VALUE,O=[-C,-C,-C],k=[C,C,C];if(_.contains(u.center)){for(const $t of w)ew(k,k,$t),tw(O,O,$t);O[2]=0;const it=u.point,vt=[it.x*d,it.y*d,0];return ew(k,k,vt),tw(O,O,vt),new Wo(k,O)}const M=[y[12]*d,y[13]*d,y[14]*d],N=_.getCenter(),B=Fe(u.center.lat,-Co,Co),W=Fe(N.lat,-Co,Co),Y=Al(u.center.lng),J=Il(B);let ie=Y-Al(N.lng);const pe=J-Il(W);ie>.5?ie-=1:ie<-.5&&(ie+=1);let Ce=0;Math.abs(ie)>Math.abs(pe)?Ce=ie>=0?1:3:(Ce=pe>=0?0:2,rw(M,M,[y[4]*d,y[5]*d,y[6]*d],-Math.sin(Ne(pe>=0?_.getSouth():_.getNorth()))*kl));const he=w[Ce],Se=w[(Ce+1)%4],ke=new Fce(he,Se,M),Te=[LI(ke,0)||he[0],LI(ke,1)||he[1],LI(ke,2)||he[2]],lt=Wm(u.zoom);if(lt>0){const it=function({x:$t,y:ht,z:bt},St,Pt,Nt,dt){const Wt=1/(1<<bt);let xr=$t*Wt,Zt=xr+Wt,ar=ht*Wt,Yt=ar+Wt,Tr=0;const Zr=(xr+Zt)/2-Nt;return Zr>.5?Tr=-1:Zr<-.5&&(Tr=1),xr=((xr+Tr)*St-(Nt*=St))*Pt+Nt,Zt=((Zt+Tr)*St-Nt)*Pt+Nt,ar=(ar*St-(dt*=St))*Pt+dt,Yt=(Yt*St-dt)*Pt+dt,[[xr,Yt,0],[Zt,Yt,0],[Zt,ar,0],[xr,ar,0]]}(c,l,u._pixelsPerMercatorPixel,Y,J);for(let $t=0;$t<w.length;$t++)sd(w[$t],it[$t],lt);const vt=Eu([],it[Ce],it[(Ce+1)%4]);Wa(vt,vt,.5),sd(Te,vt,lt)}for(const it of w)ew(k,k,it),tw(O,O,it);return k[2]=Math.min(he[2],Se[2]),ew(k,k,Te),tw(O,O,Te),new Wo(k,O)}function AE({x:u,y:l,z:c}){const d=1/(1<<c),y=new vn(Ga(u*d),xo((l+1)*d)),_=new vn(Ga((u+1)*d),xo(l*d));return new cf(y,_)}function NI(u){const l=Ne(u.getNorth()),c=Ne(u.getSouth()),d=Math.cos(l),y=Math.cos(c),_=Math.sin(l),w=Math.sin(c),C=u.getWest(),O=u.getEast();return[Vm(y,w,C),Vm(y,w,O),Vm(d,_,O),Vm(d,_,C)]}function Vm(u,l,c,d=kl){return c=Ne(c),[u*Math.sin(c)*d,-l*d,u*Math.cos(c)*d]}function Um(u,l,c){return Vm(Math.cos(Ne(u)),Math.sin(Ne(u)),l,c)}function aw(u,l,c,d){const y=1<<c.z,_=(u/kr+c.x)/y;return Um(xo((l/kr+c.y)/y),Ga(_),d)}function IE({min:u,max:l}){return 16383/Math.max(l[0]-u[0],l[1]-u[1],l[2]-u[2])}const o4=new Float64Array(16);function sw(u){const l=IE(u),c=VU(o4,[l,l,l]);return Jb(c,c,((d=[])[0]=-(y=u.min)[0],d[1]=-y[1],d[2]=-y[2],d));var d,y}function BI(u){const l=(d=u.min,(c=o4)[0]=1,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=1,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=1,c[11]=0,c[12]=d[0],c[13]=d[1],c[14]=d[2],c[15]=1,c);var c,d;const y=1/IE(u);return id(l,l,[y,y,y])}function a4(u,l,c,d,y){const _=function(O){const k=kr/(2*Math.PI);return O/(2*Math.PI)/k}(c),w=[u,l,-c/(2*Math.PI)],C=qs(new Float64Array(16));return Jb(C,C,w),id(C,C,[_,_,_]),kI(C,C,Ne(-y)),kE(C,C,Ne(-d)),C}function Wm(u){return At(5,6,u)}function s4(u,l){const c=Um(l.lat,l.lng),d=function(Y){const J=Um(Y._center.lat,Y._center.lng);let ie=II([],Hm(0,1,0),J);const pe=UU([],-Y.angle,J);ie=Si(ie,ie,pe),UU(pe,-Y._pitch,ie);const Ce=Uo([],J);return Wa(Ce,Ce,PE(Y.cameraToCenterDistance/Y.pixelsPerMeter)),Si(Ce,Ce,pe),Eu([],J,Ce)}(u);return w=(y=AI([],d,c))[0],C=y[1],O=y[2],k=(_=c)[0],M=_[1],N=_[2],W=(B=Math.sqrt(w*w+C*C+O*O)*Math.sqrt(k*k+M*M+N*N))&&gs(y,_)/B,Math.acos(Math.min(Math.max(W,-1),1));var y,_,w,C,O,k,M,N,B,W}function jI(u,l){return s4(u,l)>Math.PI/2*1.01}const l4=Ne(85),Vce=Math.cos(l4),Uce=Math.sin(l4),lw=63710088e-1,u4=2*Math.PI*lw;class vn{constructor(l,c){if(isNaN(l)||isNaN(c))throw new Error(`Invalid LngLat object: (${l}, ${c})`);if(this.lng=+l,this.lat=+c,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new vn(Gt(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(l){const c=Math.PI/180,d=this.lat*c,y=l.lat*c,_=Math.sin(d)*Math.sin(y)+Math.cos(d)*Math.cos(y)*Math.cos((l.lng-this.lng)*c);return lw*Math.acos(Math.min(_,1))}toBounds(l=0){const c=360*l/40075017,d=c/Math.cos(Math.PI/180*this.lat);return new cf(new vn(this.lng-d,this.lat-c),new vn(this.lng+d,this.lat+c))}toEcef(l){const c=PE(l);return Um(this.lat,this.lng,kl+c)}static convert(l){if(l instanceof vn)return l;if(Array.isArray(l)&&(l.length===2||l.length===3))return new vn(Number(l[0]),Number(l[1]));if(!Array.isArray(l)&&typeof l=="object"&&l!==null)return new vn(Number("lng"in l?l.lng:l.lon),Number(l.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}function zI(u){return u4*Math.cos(u*Math.PI/180)}function Al(u){return(180+u)/360}function Il(u){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+u*Math.PI/360)))/360}function Zs(u,l){return u/zI(l)}function Ga(u){return 360*u-180}function xo(u){return 360/Math.PI*Math.atan(Math.exp((180-360*u)*Math.PI/180))-90}function c4(u,l){return u*zI(xo(l))}const Co=85.051129;function f4(u){return 1/Math.cos(u*Math.PI/180)}class Gm{constructor(l,c,d=0){this.x=+l,this.y=+c,this.z=+d}static fromLngLat(l,c=0){const d=vn.convert(l);return new Gm(Al(d.lng),Il(d.lat),Zs(c,d.lat))}toLngLat(){return new vn(Ga(this.x),xo(this.y))}toAltitude(){return c4(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/u4*f4(xo(this.y))}}function FI(u,l,c,d,y,_,w,C,O){const k=(l+d)/2,M=(c+y)/2,N=new K(k,M);C(N),function(B,W,Y,J,ie,pe){const Ce=Y-ie,he=J-pe;return Math.abs((J-W)*Ce-(Y-B)*he)/Math.hypot(Ce,he)}(N.x,N.y,_.x,_.y,w.x,w.y)>=O?(FI(u,l,c,k,M,_,N,C,O),FI(u,k,M,d,y,N,w,C,O)):u.push(w)}function h4(u,l,c){let d=u[0],y=d.x,_=d.y;l(d);const w=[d];for(let C=1;C<u.length;C++){const O=u[C],{x:k,y:M}=O;l(O),FI(w,y,_,k,M,d,O,l,c),y=k,_=M,d=O}return w}function HI(u,l,c,d){if(d(l,c)){const y=l.add(c)._mult(.5);HI(u,l,y,d),HI(u,y,c,d)}else u.push(c)}function Wce(u,l){let c=u[0];const d=[c];for(let y=1;y<u.length;y++){const _=u[y];HI(d,c,_,l),c=_}return d}const VI=Math.pow(2,14)-1,d4=-VI-1;function Gce(u,l){const c=Math.round(u.x*l),d=Math.round(u.y*l);return u.x=Fe(c,d4,VI),u.y=Fe(d,d4,VI),(c<u.x||c>u.x+1||d<u.y||d>u.y+1)&&Ft("Geometry exceeds allowed extent, reduce your vector tile buffer size"),u}function Tu(u,l,c){const d=u.loadGeometry(),y=u.extent,_=kr/y;if(l&&c&&c.projection.isReprojectedInTileSpace){const w=1<<l.z,{scale:C,x:O,y:k,projection:M}=c,N=B=>{const W=Ga((l.x+B.x/y)/w),Y=xo((l.y+B.y/y)/w),J=M.project(W,Y);B.x=(J.x*C-O)*y,B.y=(J.y*C-k)*y};for(let B=0;B<d.length;B++)if(u.type!==1)d[B]=h4(d[B],N,1);else{const W=[];for(const Y of d[B])Y.x<0||Y.x>=y||Y.y<0||Y.y>=y||(N(Y),W.push(Y));d[B]=W}}for(const w of d)for(const C of w)Gce(C,_);return d}function ld(u,l){return{type:u.type,id:u.id,properties:u.properties,geometry:l?Tu(u):[]}}function ME(u,l,c,d,y){u.emplaceBack(2*l+(d+1)/2,2*c+(y+1)/2)}function DE(u,l,c){u.emplaceBack(l.x,l.y,l.z,c[0]*16384,c[1]*16384,c[2]*16384)}class UI{constructor(l){this.zoom=l.zoom,this.overscaling=l.overscaling,this.layers=l.layers,this.layerIds=this.layers.map(c=>c.id),this.index=l.index,this.hasPattern=!1,this.projection=l.projection,this.layoutVertexArray=new gr,this.indexArray=new So,this.segments=new Oi,this.programConfigurations=new rd(l.layers,l.zoom),this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id)}populate(l,c,d,y){const _=this.layers[0],w=[];let C=null;_.type==="circle"&&(C=_.layout.get("circle-sort-key"));for(const{feature:k,id:M,index:N,sourceLayerIndex:B}of l){const W=this.layers[0]._featureFilter.needGeometry,Y=ld(k,W);if(!this.layers[0]._featureFilter.filter(new Xe(this.zoom),Y,d))continue;const J=C?C.evaluate(Y,{},d):void 0,ie={id:M,properties:k.properties,type:k.type,sourceLayerIndex:B,index:N,geometry:W?Y.geometry:Tu(k,d,y),patterns:{},sortKey:J};w.push(ie)}C&&w.sort((k,M)=>k.sortKey-M.sortKey);let O=null;y.projection.name==="globe"&&(this.globeExtVertexArray=new Ua,O=y.projection);for(const k of w){const{geometry:M,index:N,sourceLayerIndex:B}=k,W=l[N].feature;this.addFeature(k,M,N,c.availableImages,d,O),c.featureIndex.insert(W,M,N,B,this.index)}}update(l,c,d,y){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(l,c,this.stateDependentLayers,d,y)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(l){this.uploaded||(this.layoutVertexBuffer=l.createVertexBuffer(this.layoutVertexArray,Mce.members),this.indexBuffer=l.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=l.createVertexBuffer(this.globeExtVertexArray,Dce.members))),this.programConfigurations.upload(l),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(l,c,d,y,_,w){for(const C of c)for(const O of C){const k=O.x,M=O.y;if(k<0||k>=kr||M<0||M>=kr)continue;if(w){const W=w.projectTilePoint(k,M,_),Y=w.upVector(_,k,M),J=this.globeExtVertexArray;DE(J,W,Y),DE(J,W,Y),DE(J,W,Y),DE(J,W,Y)}const N=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,l.sortKey),B=N.vertexLength;ME(this.layoutVertexArray,k,M,-1,-1),ME(this.layoutVertexArray,k,M,1,-1),ME(this.layoutVertexArray,k,M,1,1),ME(this.layoutVertexArray,k,M,-1,1),this.indexArray.emplaceBack(B,B+1,B+2),this.indexArray.emplaceBack(B,B+2,B+3),N.vertexLength+=4,N.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,l,d,{},y,_)}}function p4(u,l){for(let c=0;c<u.length;c++)if(ud(l,u[c]))return!0;for(let c=0;c<l.length;c++)if(ud(u,l[c]))return!0;return!!WI(u,l)}function Yce(u,l,c){return!!ud(u,l)||!!GI(l,u,c)}function m4(u,l){if(u.length===1)return g4(l,u[0]);for(let c=0;c<l.length;c++){const d=l[c];for(let y=0;y<d.length;y++)if(ud(u,d[y]))return!0}for(let c=0;c<u.length;c++)if(g4(l,u[c]))return!0;for(let c=0;c<l.length;c++)if(WI(u,l[c]))return!0;return!1}function Kce(u,l,c){if(u.length>1){if(WI(u,l))return!0;for(let d=0;d<l.length;d++)if(GI(l[d],u,c))return!0}for(let d=0;d<u.length;d++)if(GI(u[d],l,c))return!0;return!1}function WI(u,l){if(u.length===0||l.length===0)return!1;for(let c=0;c<u.length-1;c++){const d=u[c],y=u[c+1];for(let _=0;_<l.length-1;_++)if(qce(d,y,l[_],l[_+1]))return!0}return!1}function qce(u,l,c,d){return Jt(u,c,d)!==Jt(l,c,d)&&Jt(u,l,c)!==Jt(u,l,d)}function GI(u,l,c){const d=c*c;if(l.length===1)return u.distSqr(l[0])<d;for(let y=1;y<l.length;y++)if(y4(u,l[y-1],l[y])<d)return!0;return!1}function y4(u,l,c){const d=l.distSqr(c);if(d===0)return u.distSqr(l);const y=((u.x-l.x)*(c.x-l.x)+(u.y-l.y)*(c.y-l.y))/d;return u.distSqr(y<0?l:y>1?c:c.sub(l)._mult(y)._add(l))}function g4(u,l){let c,d,y,_=!1;for(let w=0;w<u.length;w++){c=u[w];for(let C=0,O=c.length-1;C<c.length;O=C++)d=c[C],y=c[O],d.y>l.y!=y.y>l.y&&l.x<(y.x-d.x)*(l.y-d.y)/(y.y-d.y)+d.x&&(_=!_)}return _}function ud(u,l){let c=!1;for(let d=0,y=u.length-1;d<u.length;y=d++){const _=u[d],w=u[y];_.y>l.y!=w.y>l.y&&l.x<(w.x-_.x)*(l.y-_.y)/(w.y-_.y)+_.x&&(c=!c)}return c}function v4(u,l,c,d,y){for(const w of u)if(l<=w.x&&c<=w.y&&d>=w.x&&y>=w.y)return!0;const _=[new K(l,c),new K(l,y),new K(d,y),new K(d,c)];if(u.length>2){for(const w of _)if(ud(u,w))return!0}for(let w=0;w<u.length-1;w++)if(Xce(u[w],u[w+1],_))return!0;return!1}function Xce(u,l,c){const d=c[0],y=c[2];if(u.x<d.x&&l.x<d.x||u.x>y.x&&l.x>y.x||u.y<d.y&&l.y<d.y||u.y>y.y&&l.y>y.y)return!1;const _=Jt(u,l,c[0]);return _!==Jt(u,l,c[1])||_!==Jt(u,l,c[2])||_!==Jt(u,l,c[3])}function Ym(u,l,c){const d=l.paint.get(u).value;return d.kind==="constant"?d.value:c.programConfigurations.get(l.id).getMaxValue(u)}function $E(u){return Math.sqrt(u[0]*u[0]+u[1]*u[1])}function _4(u,l,c,d,y){if(!l[0]&&!l[1])return u;const _=K.convert(l)._mult(y);c==="viewport"&&_._rotate(-d);const w=[];for(let C=0;C<u.length;C++)w.push(u[C].sub(_));return w}function b4(u,l,c,d){const y=K.convert(u)._mult(d);return l==="viewport"&&y._rotate(-c),y}tr(UI,"CircleBucket",{omit:["layers"]});const Zce=new Mt({"circle-sort-key":new ct(yt.layout_circle["circle-sort-key"])});var Jce={paint:new Mt({"circle-radius":new ct(yt.paint_circle["circle-radius"]),"circle-color":new ct(yt.paint_circle["circle-color"]),"circle-blur":new ct(yt.paint_circle["circle-blur"]),"circle-opacity":new ct(yt.paint_circle["circle-opacity"]),"circle-translate":new Ye(yt.paint_circle["circle-translate"]),"circle-translate-anchor":new Ye(yt.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Ye(yt.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Ye(yt.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new ct(yt.paint_circle["circle-stroke-width"]),"circle-stroke-color":new ct(yt.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new ct(yt.paint_circle["circle-stroke-opacity"])}),layout:Zce};function w4(u,l,c,d,y,_,w,C,O){if(_&&u.queryGeometry.isAboveHorizon)return!1;_&&(O*=u.pixelToTileUnitsFactor);const k=u.tileID.canonical,M=c.projection.upVectorScale(k,c.center.lat,c.worldSize).metersToTile;for(const N of l)for(const B of N){const W=B.add(C),Y=y&&c.elevation?c.elevation.exaggeration()*y.getElevationAt(W.x,W.y,!0):0,J=c.projection.projectTilePoint(W.x,W.y,k);if(Y>0){const he=c.projection.upVector(k,W.x,W.y);J.x+=he[0]*M*Y,J.y+=he[1]*M*Y,J.z+=he[2]*M*Y}const ie=_?W:Qce(J.x,J.y,J.z,d),pe=_?u.tilespaceRays.map(he=>tfe(he,Y)):u.queryGeometry.screenGeometry,Ce=od([],[J.x,J.y,J.z,1],d);if(!w&&_?O*=Ce[3]/c.cameraToCenterDistance:w&&!_&&(O*=c.cameraToCenterDistance/Ce[3]),_){const he=xo((B.y/kr+k.y)/(1<<k.z));O/=c.projection.pixelsPerMeter(he,1)/Zs(1,he)}if(Yce(pe,ie,O))return!0}return!1}function Qce(u,l,c,d){const y=od([],[u,l,c,1],d);return new K(y[0]/y[3],y[1]/y[3])}const S4=Hm(0,0,0),efe=Hm(0,0,1);function tfe(u,l){const c=PI();return S4[2]=l,u.intersectsPlane(S4,efe,c),new K(c[0],c[1])}class x4 extends UI{}function C4(u,{width:l,height:c},d,y){if(y){if(y instanceof Uint8ClampedArray)y=new Uint8Array(y.buffer);else if(y.length!==l*c*d)throw new RangeError("mismatched image size")}else y=new Uint8Array(l*c*d);return u.width=l,u.height=c,u.data=y,u}function E4(u,l,c){const{width:d,height:y}=l;d===u.width&&y===u.height||(YI(u,l,{x:0,y:0},{x:0,y:0},{width:Math.min(u.width,d),height:Math.min(u.height,y)},c),u.width=d,u.height=y,u.data=l.data)}function YI(u,l,c,d,y,_){if(y.width===0||y.height===0)return l;if(y.width>u.width||y.height>u.height||c.x>u.width-y.width||c.y>u.height-y.height)throw new RangeError("out of range source coordinates for image copy");if(y.width>l.width||y.height>l.height||d.x>l.width-y.width||d.y>l.height-y.height)throw new RangeError("out of range destination coordinates for image copy");const w=u.data,C=l.data;for(let O=0;O<y.height;O++){const k=((c.y+O)*u.width+c.x)*_,M=((d.y+O)*l.width+d.x)*_;for(let N=0;N<y.width*_;N++)C[M+N]=w[k+N]}return l}tr(x4,"HeatmapBucket",{omit:["layers"]});class Ou{constructor(l,c){C4(this,l,1,c)}resize(l){E4(this,new Ou(l),1)}clone(){return new Ou({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(l,c,d,y,_){YI(l,c,d,y,_,1)}}class Oa{constructor(l,c){C4(this,l,4,c)}resize(l){E4(this,new Oa(l),4)}replace(l,c){c?this.data.set(l):this.data=l instanceof Uint8ClampedArray?new Uint8Array(l.buffer):l}clone(){return new Oa({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(l,c,d,y,_){YI(l,c,d,y,_,4)}}tr(Ou,"AlphaImage"),tr(Oa,"RGBAImage");var rfe={paint:new Mt({"heatmap-radius":new ct(yt.paint_heatmap["heatmap-radius"]),"heatmap-weight":new ct(yt.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Ye(yt.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Et(yt.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Ye(yt.paint_heatmap["heatmap-opacity"])})};function KI(u){const l={},c=u.resolution||256,d=u.clips?u.clips.length:1,y=u.image||new Oa({width:c,height:d}),_=(w,C,O)=>{l[u.evaluationKey]=O;const k=u.expression.evaluate(l);y.data[w+C+0]=Math.floor(255*k.r/k.a),y.data[w+C+1]=Math.floor(255*k.g/k.a),y.data[w+C+2]=Math.floor(255*k.b/k.a),y.data[w+C+3]=Math.floor(255*k.a)};if(u.clips)for(let w=0,C=0;w<d;++w,C+=4*c)for(let O=0,k=0;O<c;O++,k+=4){const M=O/(c-1),{start:N,end:B}=u.clips[w];_(C,k,N*(1-M)+B*M)}else for(let w=0,C=0;w<c;w++,C+=4)_(0,C,w/(c-1));return y}var nfe={paint:new Mt({"hillshade-illumination-direction":new Ye(yt.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Ye(yt.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Ye(yt.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Ye(yt.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Ye(yt.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Ye(yt.paint_hillshade["hillshade-accent-color"])})};const ife=fr([{name:"a_pos",components:2,type:"Int16"}],4),{members:ofe}=ife;var Km={};function LE(u,l,c){c=c||2;var d,y,_,w,C,O,k,M=l&&l.length,N=M?l[0]*c:u.length,B=T4(u,0,N,c,!0),W=[];if(!B||B.next===B.prev)return W;if(M&&(B=function(J,ie,pe,Ce){var he,Se,ke,Te=[];for(he=0,Se=ie.length;he<Se;he++)(ke=T4(J,ie[he]*Ce,he<Se-1?ie[he+1]*Ce:J.length,Ce,!1))===ke.next&&(ke.steiner=!0),Te.push(dfe(ke));for(Te.sort(cfe),he=0;he<Te.length;he++)pe=ffe(Te[he],pe);return pe}(u,l,B,c)),u.length>80*c){d=_=u[0],y=w=u[1];for(var Y=c;Y<N;Y+=c)(C=u[Y])<d&&(d=C),(O=u[Y+1])<y&&(y=O),C>_&&(_=C),O>w&&(w=O);k=(k=Math.max(_-d,w-y))!==0?32767/k:0}return uw(B,W,c,d,y,k,0),W}function T4(u,l,c,d,y){var _,w;if(y===ZI(u,l,c,d)>0)for(_=l;_<c;_+=d)w=k4(_,u[_],u[_+1],w);else for(_=c-d;_>=l;_-=d)w=k4(_,u[_],u[_+1],w);return w&&NE(w,w.next)&&(fw(w),w=w.next),w}function cd(u,l){if(!u)return u;l||(l=u);var c,d=u;do if(c=!1,d.steiner||!NE(d,d.next)&&Ri(d.prev,d,d.next)!==0)d=d.next;else{if(fw(d),(d=l=d.prev)===d.next)break;c=!0}while(c||d!==l);return l}function uw(u,l,c,d,y,_,w){if(u){!w&&_&&function(M,N,B,W){var Y=M;do Y.z===0&&(Y.z=qI(Y.x,Y.y,N,B,W)),Y.prevZ=Y.prev,Y.nextZ=Y.next,Y=Y.next;while(Y!==M);Y.prevZ.nextZ=null,Y.prevZ=null,function(J){var ie,pe,Ce,he,Se,ke,Te,lt,it=1;do{for(pe=J,J=null,Se=null,ke=0;pe;){for(ke++,Ce=pe,Te=0,ie=0;ie<it&&(Te++,Ce=Ce.nextZ);ie++);for(lt=it;Te>0||lt>0&&Ce;)Te!==0&&(lt===0||!Ce||pe.z<=Ce.z)?(he=pe,pe=pe.nextZ,Te--):(he=Ce,Ce=Ce.nextZ,lt--),Se?Se.nextZ=he:J=he,he.prevZ=Se,Se=he;pe=Ce}Se.nextZ=null,it*=2}while(ke>1)}(Y)}(u,d,y,_);for(var C,O,k=u;u.prev!==u.next;)if(C=u.prev,O=u.next,_?sfe(u,d,y,_):afe(u))l.push(C.i/c|0),l.push(u.i/c|0),l.push(O.i/c|0),fw(u),u=O.next,k=O.next;else if((u=O)===k){w?w===1?uw(u=lfe(cd(u),l,c),l,c,d,y,_,2):w===2&&ufe(u,l,c,d,y,_):uw(cd(u),l,c,d,y,_,1);break}}}function afe(u){var l=u.prev,c=u,d=u.next;if(Ri(l,c,d)>=0)return!1;for(var y=l.x,_=c.x,w=d.x,C=l.y,O=c.y,k=d.y,M=y<_?y<w?y:w:_<w?_:w,N=C<O?C<k?C:k:O<k?O:k,B=y>_?y>w?y:w:_>w?_:w,W=C>O?C>k?C:k:O>k?O:k,Y=d.next;Y!==l;){if(Y.x>=M&&Y.x<=B&&Y.y>=N&&Y.y<=W&&qm(y,C,_,O,w,k,Y.x,Y.y)&&Ri(Y.prev,Y,Y.next)>=0)return!1;Y=Y.next}return!0}function sfe(u,l,c,d){var y=u.prev,_=u,w=u.next;if(Ri(y,_,w)>=0)return!1;for(var C=y.x,O=_.x,k=w.x,M=y.y,N=_.y,B=w.y,W=C<O?C<k?C:k:O<k?O:k,Y=M<N?M<B?M:B:N<B?N:B,J=C>O?C>k?C:k:O>k?O:k,ie=M>N?M>B?M:B:N>B?N:B,pe=qI(W,Y,l,c,d),Ce=qI(J,ie,l,c,d),he=u.prevZ,Se=u.nextZ;he&&he.z>=pe&&Se&&Se.z<=Ce;){if(he.x>=W&&he.x<=J&&he.y>=Y&&he.y<=ie&&he!==y&&he!==w&&qm(C,M,O,N,k,B,he.x,he.y)&&Ri(he.prev,he,he.next)>=0||(he=he.prevZ,Se.x>=W&&Se.x<=J&&Se.y>=Y&&Se.y<=ie&&Se!==y&&Se!==w&&qm(C,M,O,N,k,B,Se.x,Se.y)&&Ri(Se.prev,Se,Se.next)>=0))return!1;Se=Se.nextZ}for(;he&&he.z>=pe;){if(he.x>=W&&he.x<=J&&he.y>=Y&&he.y<=ie&&he!==y&&he!==w&&qm(C,M,O,N,k,B,he.x,he.y)&&Ri(he.prev,he,he.next)>=0)return!1;he=he.prevZ}for(;Se&&Se.z<=Ce;){if(Se.x>=W&&Se.x<=J&&Se.y>=Y&&Se.y<=ie&&Se!==y&&Se!==w&&qm(C,M,O,N,k,B,Se.x,Se.y)&&Ri(Se.prev,Se,Se.next)>=0)return!1;Se=Se.nextZ}return!0}function lfe(u,l,c){var d=u;do{var y=d.prev,_=d.next.next;!NE(y,_)&&O4(y,d,d.next,_)&&cw(y,_)&&cw(_,y)&&(l.push(y.i/c|0),l.push(d.i/c|0),l.push(_.i/c|0),fw(d),fw(d.next),d=u=_),d=d.next}while(d!==u);return cd(d)}function ufe(u,l,c,d,y,_){var w=u;do{for(var C=w.next.next;C!==w.prev;){if(w.i!==C.i&&pfe(w,C)){var O=R4(w,C);return w=cd(w,w.next),O=cd(O,O.next),uw(w,l,c,d,y,_,0),void uw(O,l,c,d,y,_,0)}C=C.next}w=w.next}while(w!==u)}function cfe(u,l){return u.x-l.x}function ffe(u,l){var c=function(y,_){var w,C=_,O=y.x,k=y.y,M=-1/0;do{if(k<=C.y&&k>=C.next.y&&C.next.y!==C.y){var N=C.x+(k-C.y)*(C.next.x-C.x)/(C.next.y-C.y);if(N<=O&&N>M&&(M=N,w=C.x<C.next.x?C:C.next,N===O))return w}C=C.next}while(C!==_);if(!w)return null;var B,W=w,Y=w.x,J=w.y,ie=1/0;C=w;do O>=C.x&&C.x>=Y&&O!==C.x&&qm(k<J?O:M,k,Y,J,k<J?M:O,k,C.x,C.y)&&(B=Math.abs(k-C.y)/(O-C.x),cw(C,y)&&(B<ie||B===ie&&(C.x>w.x||C.x===w.x&&hfe(w,C)))&&(w=C,ie=B)),C=C.next;while(C!==W);return w}(u,l);if(!c)return l;var d=R4(c,u);return cd(d,d.next),cd(c,c.next)}function hfe(u,l){return Ri(u.prev,u,l.prev)<0&&Ri(l.next,u,u.next)<0}function qI(u,l,c,d,y){return(u=1431655765&((u=858993459&((u=252645135&((u=16711935&((u=(u-c)*y|0)|u<<8))|u<<4))|u<<2))|u<<1))|(l=1431655765&((l=858993459&((l=252645135&((l=16711935&((l=(l-d)*y|0)|l<<8))|l<<4))|l<<2))|l<<1))<<1}function dfe(u){var l=u,c=u;do(l.x<c.x||l.x===c.x&&l.y<c.y)&&(c=l),l=l.next;while(l!==u);return c}function qm(u,l,c,d,y,_,w,C){return(y-w)*(l-C)>=(u-w)*(_-C)&&(u-w)*(d-C)>=(c-w)*(l-C)&&(c-w)*(_-C)>=(y-w)*(d-C)}function pfe(u,l){return u.next.i!==l.i&&u.prev.i!==l.i&&!function(c,d){var y=c;do{if(y.i!==c.i&&y.next.i!==c.i&&y.i!==d.i&&y.next.i!==d.i&&O4(y,y.next,c,d))return!0;y=y.next}while(y!==c);return!1}(u,l)&&(cw(u,l)&&cw(l,u)&&function(c,d){var y=c,_=!1,w=(c.x+d.x)/2,C=(c.y+d.y)/2;do y.y>C!=y.next.y>C&&y.next.y!==y.y&&w<(y.next.x-y.x)*(C-y.y)/(y.next.y-y.y)+y.x&&(_=!_),y=y.next;while(y!==c);return _}(u,l)&&(Ri(u.prev,u,l.prev)||Ri(u,l.prev,l))||NE(u,l)&&Ri(u.prev,u,u.next)>0&&Ri(l.prev,l,l.next)>0)}function Ri(u,l,c){return(l.y-u.y)*(c.x-l.x)-(l.x-u.x)*(c.y-l.y)}function NE(u,l){return u.x===l.x&&u.y===l.y}function O4(u,l,c,d){var y=jE(Ri(u,l,c)),_=jE(Ri(u,l,d)),w=jE(Ri(c,d,u)),C=jE(Ri(c,d,l));return y!==_&&w!==C||!(y!==0||!BE(u,c,l))||!(_!==0||!BE(u,d,l))||!(w!==0||!BE(c,u,d))||!(C!==0||!BE(c,l,d))}function BE(u,l,c){return l.x<=Math.max(u.x,c.x)&&l.x>=Math.min(u.x,c.x)&&l.y<=Math.max(u.y,c.y)&&l.y>=Math.min(u.y,c.y)}function jE(u){return u>0?1:u<0?-1:0}function cw(u,l){return Ri(u.prev,u,u.next)<0?Ri(u,l,u.next)>=0&&Ri(u,u.prev,l)>=0:Ri(u,l,u.prev)<0||Ri(u,u.next,l)<0}function R4(u,l){var c=new XI(u.i,u.x,u.y),d=new XI(l.i,l.x,l.y),y=u.next,_=l.prev;return u.next=l,l.prev=u,c.next=y,y.prev=c,d.next=c,c.prev=d,_.next=d,d.prev=_,d}function k4(u,l,c,d){var y=new XI(u,l,c);return d?(y.next=d.next,y.prev=d,d.next.prev=y,d.next=y):(y.prev=y,y.next=y),y}function fw(u){u.next.prev=u.prev,u.prev.next=u.next,u.prevZ&&(u.prevZ.nextZ=u.nextZ),u.nextZ&&(u.nextZ.prevZ=u.prevZ)}function XI(u,l,c){this.i=u,this.x=l,this.y=c,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function ZI(u,l,c,d){for(var y=0,_=l,w=c-d;_<c;_+=d)y+=(u[w]-u[_])*(u[_+1]+u[w+1]),w=_;return y}function mfe(u,l,c,d,y){P4(u,l,c||0,d||u.length-1,y||yfe)}function P4(u,l,c,d,y){for(;d>c;){if(d-c>600){var _=d-c+1,w=l-c+1,C=Math.log(_),O=.5*Math.exp(2*C/3),k=.5*Math.sqrt(C*O*(_-O)/_)*(w-_/2<0?-1:1);P4(u,l,Math.max(c,Math.floor(l-w*O/_+k)),Math.min(d,Math.floor(l+(_-w)*O/_+k)),y)}var M=u[l],N=c,B=d;for(hw(u,c,l),y(u[d],M)>0&&hw(u,c,d);N<B;){for(hw(u,N,B),N++,B--;y(u[N],M)<0;)N++;for(;y(u[B],M)>0;)B--}y(u[c],M)===0?hw(u,c,B):hw(u,++B,d),B<=l&&(c=B+1),l<=B&&(d=B-1)}}function hw(u,l,c){var d=u[l];u[l]=u[c],u[c]=d}function yfe(u,l){return u<l?-1:u>l?1:0}function JI(u,l){const c=u.length;if(c<=1)return[u];const d=[];let y,_;for(let w=0;w<c;w++){const C=et(u[w]);C!==0&&(u[w].area=Math.abs(C),_===void 0&&(_=C<0),_===C<0?(y&&d.push(y),y=[u[w]]):y.push(u[w]))}if(y&&d.push(y),l>1)for(let w=0;w<d.length;w++)d[w].length<=l||(mfe(d[w],l,1,d[w].length-1,gfe),d[w]=d[w].slice(0,l));return d}function gfe(u,l){return l.area-u.area}function QI(u,l,c){const d=c.patternDependencies;let y=!1;for(const _ of l){const w=_.paint.get(`${u}-pattern`);w.isConstant()||(y=!0);const C=w.constantOr(null);C&&(y=!0,d[C]=!0)}return y}function eM(u,l,c,d,y){const _=y.patternDependencies;for(const w of l){const C=w.paint.get(`${u}-pattern`).value;if(C.kind!=="constant"){let O=C.evaluate({zoom:d},c,{},y.availableImages);O=O&&O.name?O.name:O,_[O]=!0,c.patterns[w.id]=O}}return c}({get exports(){return Km},set exports(u){Km=u}}).exports=LE,Km.default=LE,LE.deviation=function(u,l,c,d){var y=l&&l.length,_=Math.abs(ZI(u,0,y?l[0]*c:u.length,c));if(y)for(var w=0,C=l.length;w<C;w++)_-=Math.abs(ZI(u,l[w]*c,w<C-1?l[w+1]*c:u.length,c));var O=0;for(w=0;w<d.length;w+=3){var k=d[w]*c,M=d[w+1]*c,N=d[w+2]*c;O+=Math.abs((u[k]-u[N])*(u[M+1]-u[k+1])-(u[k]-u[M])*(u[N+1]-u[k+1]))}return _===0&&O===0?0:Math.abs((O-_)/_)},LE.flatten=function(u){for(var l=u[0][0].length,c={vertices:[],holes:[],dimensions:l},d=0,y=0;y<u.length;y++){for(var _=0;_<u[y].length;_++)for(var w=0;w<l;w++)c.vertices.push(u[y][_][w]);y>0&&c.holes.push(d+=u[y-1].length)}return c};class zE{constructor(l){this.zoom=l.zoom,this.overscaling=l.overscaling,this.layers=l.layers,this.layerIds=this.layers.map(c=>c.id),this.index=l.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new gr,this.indexArray=new So,this.indexArray2=new Ol,this.programConfigurations=new rd(l.layers,l.zoom),this.segments=new Oi,this.segments2=new Oi,this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id),this.projection=l.projection}populate(l,c,d,y){this.hasPattern=QI("fill",this.layers,c);const _=this.layers[0].layout.get("fill-sort-key"),w=[];for(const{feature:C,id:O,index:k,sourceLayerIndex:M}of l){const N=this.layers[0]._featureFilter.needGeometry,B=ld(C,N);if(!this.layers[0]._featureFilter.filter(new Xe(this.zoom),B,d))continue;const W=_?_.evaluate(B,{},d,c.availableImages):void 0,Y={id:O,properties:C.properties,type:C.type,sourceLayerIndex:M,index:k,geometry:N?B.geometry:Tu(C,d,y),patterns:{},sortKey:W};w.push(Y)}_&&w.sort((C,O)=>C.sortKey-O.sortKey);for(const C of w){const{geometry:O,index:k,sourceLayerIndex:M}=C;if(this.hasPattern){const N=eM("fill",this.layers,C,this.zoom,c);this.patternFeatures.push(N)}else this.addFeature(C,O,k,d,{},c.availableImages);c.featureIndex.insert(l[k].feature,O,k,M,this.index)}}update(l,c,d,y){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(l,c,this.stateDependentLayers,d,y)}addFeatures(l,c,d,y,_){for(const w of this.patternFeatures)this.addFeature(w,w.geometry,w.index,c,d,y)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(l){this.uploaded||(this.layoutVertexBuffer=l.createVertexBuffer(this.layoutVertexArray,ofe),this.indexBuffer=l.createIndexBuffer(this.indexArray),this.indexBuffer2=l.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(l),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(l,c,d,y,_,w=[]){for(const C of JI(c,500)){let O=0;for(const Y of C)O+=Y.length;const k=this.segments.prepareSegment(O,this.layoutVertexArray,this.indexArray),M=k.vertexLength,N=[],B=[];for(const Y of C){if(Y.length===0)continue;Y!==C[0]&&B.push(N.length/2);const J=this.segments2.prepareSegment(Y.length,this.layoutVertexArray,this.indexArray2),ie=J.vertexLength;this.layoutVertexArray.emplaceBack(Y[0].x,Y[0].y),this.indexArray2.emplaceBack(ie+Y.length-1,ie),N.push(Y[0].x),N.push(Y[0].y);for(let pe=1;pe<Y.length;pe++)this.layoutVertexArray.emplaceBack(Y[pe].x,Y[pe].y),this.indexArray2.emplaceBack(ie+pe-1,ie+pe),N.push(Y[pe].x),N.push(Y[pe].y);J.vertexLength+=Y.length,J.primitiveLength+=Y.length}const W=Km(N,B);for(let Y=0;Y<W.length;Y+=3)this.indexArray.emplaceBack(M+W[Y],M+W[Y+1],M+W[Y+2]);k.vertexLength+=O,k.primitiveLength+=W.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,l,d,_,w,y)}}tr(zE,"FillBucket",{omit:["layers","patternFeatures"]});const vfe=new Mt({"fill-sort-key":new ct(yt.layout_fill["fill-sort-key"])});var _fe={paint:new Mt({"fill-antialias":new Ye(yt.paint_fill["fill-antialias"]),"fill-opacity":new ct(yt.paint_fill["fill-opacity"]),"fill-color":new ct(yt.paint_fill["fill-color"]),"fill-outline-color":new ct(yt.paint_fill["fill-outline-color"]),"fill-translate":new Ye(yt.paint_fill["fill-translate"]),"fill-translate-anchor":new Ye(yt.paint_fill["fill-translate-anchor"]),"fill-pattern":new ct(yt.paint_fill["fill-pattern"])}),layout:vfe};const bfe=fr([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),wfe=fr([{name:"a_centroid_pos",components:2,type:"Uint16"}]),Sfe=fr([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:xfe}=bfe;var FE={},Cfe=K,A4=Xm;function Xm(u,l,c,d,y){this.properties={},this.extent=c,this.type=0,this._pbf=u,this._geometry=-1,this._keys=d,this._values=y,u.readFields(Efe,this,l)}function Efe(u,l,c){u==1?l.id=c.readVarint():u==2?function(d,y){for(var _=d.readVarint()+d.pos;d.pos<_;){var w=y._keys[d.readVarint()],C=y._values[d.readVarint()];y.properties[w]=C}}(c,l):u==3?l.type=c.readVarint():u==4&&(l._geometry=c.pos)}function Tfe(u){for(var l,c,d=0,y=0,_=u.length,w=_-1;y<_;w=y++)d+=((c=u[w]).x-(l=u[y]).x)*(l.y+c.y);return d}Xm.types=["Unknown","Point","LineString","Polygon"],Xm.prototype.loadGeometry=function(){var u=this._pbf;u.pos=this._geometry;for(var l,c=u.readVarint()+u.pos,d=1,y=0,_=0,w=0,C=[];u.pos<c;){if(y<=0){var O=u.readVarint();d=7&O,y=O>>3}if(y--,d===1||d===2)_+=u.readSVarint(),w+=u.readSVarint(),d===1&&(l&&C.push(l),l=[]),l.push(new Cfe(_,w));else{if(d!==7)throw new Error("unknown command "+d);l&&l.push(l[0].clone())}}return l&&C.push(l),C},Xm.prototype.bbox=function(){var u=this._pbf;u.pos=this._geometry;for(var l=u.readVarint()+u.pos,c=1,d=0,y=0,_=0,w=1/0,C=-1/0,O=1/0,k=-1/0;u.pos<l;){if(d<=0){var M=u.readVarint();c=7&M,d=M>>3}if(d--,c===1||c===2)(y+=u.readSVarint())<w&&(w=y),y>C&&(C=y),(_+=u.readSVarint())<O&&(O=_),_>k&&(k=_);else if(c!==7)throw new Error("unknown command "+c)}return[w,O,C,k]},Xm.prototype.toGeoJSON=function(u,l,c){var d,y,_=this.extent*Math.pow(2,c),w=this.extent*u,C=this.extent*l,O=this.loadGeometry(),k=Xm.types[this.type];function M(W){for(var Y=0;Y<W.length;Y++){var J=W[Y];W[Y]=[360*(J.x+w)/_-180,360/Math.PI*Math.atan(Math.exp((180-360*(J.y+C)/_)*Math.PI/180))-90]}}switch(this.type){case 1:var N=[];for(d=0;d<O.length;d++)N[d]=O[d][0];M(O=N);break;case 2:for(d=0;d<O.length;d++)M(O[d]);break;case 3:for(O=function(W){var Y=W.length;if(Y<=1)return[W];for(var J,ie,pe=[],Ce=0;Ce<Y;Ce++){var he=Tfe(W[Ce]);he!==0&&(ie===void 0&&(ie=he<0),ie===he<0?(J&&pe.push(J),J=[W[Ce]]):J.push(W[Ce]))}return J&&pe.push(J),pe}(O),d=0;d<O.length;d++)for(y=0;y<O[d].length;y++)M(O[d][y])}O.length===1?O=O[0]:k="Multi"+k;var B={type:"Feature",geometry:{type:k,coordinates:O},properties:this.properties};return"id"in this&&(B.id=this.id),B};var Ofe=A4,I4=M4;function M4(u,l){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=u,this._keys=[],this._values=[],this._features=[],u.readFields(Rfe,this,l),this.length=this._features.length}function Rfe(u,l,c){u===15?l.version=c.readVarint():u===1?l.name=c.readString():u===5?l.extent=c.readVarint():u===2?l._features.push(c.pos):u===3?l._keys.push(c.readString()):u===4&&l._values.push(function(d){for(var y=null,_=d.readVarint()+d.pos;d.pos<_;){var w=d.readVarint()>>3;y=w===1?d.readString():w===2?d.readFloat():w===3?d.readDouble():w===4?d.readVarint64():w===5?d.readVarint():w===6?d.readSVarint():w===7?d.readBoolean():null}return y}(c))}M4.prototype.feature=function(u){if(u<0||u>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[u];var l=this._pbf.readVarint()+this._pbf.pos;return new Ofe(this._pbf,l,this.extent,this._keys,this._values)};var kfe=I4;function Pfe(u,l,c){if(u===3){var d=new kfe(c,c.readVarint()+c.pos);d.length&&(l[d.name]=d)}}var tM=FE.VectorTile=function(u,l){this.layers=u.readFields(Pfe,{},l)},HE=FE.VectorTileFeature=A4;function VE(u,l,c,d){const y=[],_=d===0?(w,C,O,k,M,N)=>{w.push(new K(N,O+(N-C)/(k-C)*(M-O)))}:(w,C,O,k,M,N)=>{w.push(new K(C+(N-O)/(M-O)*(k-C),N))};for(const w of u){const C=[];for(const O of w){if(O.length<=2)continue;const k=[];for(let B=0;B<O.length-1;B++){const W=O[B].x,Y=O[B].y,J=O[B+1].x,ie=O[B+1].y,pe=d===0?W:Y,Ce=d===0?J:ie;pe<l?Ce>l&&_(k,W,Y,J,ie,l):pe>c?Ce<c&&_(k,W,Y,J,ie,c):k.push(O[B]),Ce<l&&pe>=l&&_(k,W,Y,J,ie,l),Ce>c&&pe<=c&&_(k,W,Y,J,ie,c)}let M=O[O.length-1];const N=d===0?M.x:M.y;N>=l&&N<=c&&k.push(M),k.length&&(M=k[k.length-1],k[0].x===M.x&&k[0].y===M.y||k.push(k[0]),C.push(k))}C.length&&y.push(C)}return y}FE.VectorTileLayer=I4;const Afe=HE.types,Ife=Math.pow(2,13);function dw(u,l,c,d,y,_,w,C){u.emplaceBack((l<<1)+w,(c<<1)+_,(Math.floor(d*Ife)<<1)+y,Math.round(C))}function pw(u,l,c){u.emplaceBack(l.x,l.y,l.z,c[0]*16384,c[1]*16384,c[2]*16384)}class D4{constructor(){this.acc=new K(0,0),this.polyCount=[]}startRing(l){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new K(l.x,l.y),this.max=new K(l.x,l.y))}append(l,c){this.currentPolyCount.edges++,this.acc._add(l);const d=this.min,y=this.max;l.x<d.x?d.x=l.x:l.x>y.x&&(y.x=l.x),l.y<d.y?d.y=l.y:l.y>y.y&&(y.y=l.y),((l.x===0||l.x===kr)&&l.x===c.x)!=((l.y===0||l.y===kr)&&l.y===c.y)&&this.processBorderOverlap(l,c),c.x<0!=l.x<0&&this.addBorderIntersection(0,mn(c.y,l.y,(0-c.x)/(l.x-c.x))),c.x>kr!=l.x>kr&&this.addBorderIntersection(1,mn(c.y,l.y,(kr-c.x)/(l.x-c.x))),c.y<0!=l.y<0&&this.addBorderIntersection(2,mn(c.x,l.x,(0-c.y)/(l.y-c.y))),c.y>kr!=l.y>kr&&this.addBorderIntersection(3,mn(c.x,l.x,(kr-c.y)/(l.y-c.y)))}addBorderIntersection(l,c){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const d=this.borders[l];c<d[0]&&(d[0]=c),c>d[1]&&(d[1]=c)}processBorderOverlap(l,c){if(l.x===c.x){if(l.y===c.y)return;const d=l.x===0?0:1;this.addBorderIntersection(d,c.y),this.addBorderIntersection(d,l.y)}else{const d=l.y===0?2:3;this.addBorderIntersection(d,c.x),this.addBorderIntersection(d,l.x)}}centroid(){const l=this.polyCount.reduce((c,d)=>c+d.edges,0);return l!==0?this.acc.div(l)._round():new K(0,0)}span(){return new K(this.max.x-this.min.x,this.max.y-this.min.y)}intersectsCount(){return this.borders.reduce((l,c)=>l+ +(c[0]!==Number.MAX_VALUE),0)}}class mw{constructor(l){this.zoom=l.zoom,this.canonical=l.canonical,this.overscaling=l.overscaling,this.layers=l.layers,this.layerIds=this.layers.map(c=>c.id),this.index=l.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=l.projection,this.layoutVertexArray=new On,this.centroidVertexArray=new $U,this.indexArray=new So,this.programConfigurations=new rd(l.layers,l.zoom),this.segments=new Oi,this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id),this.enableTerrain=l.enableTerrain}populate(l,c,d,y){this.features=[],this.hasPattern=QI("fill-extrusion",this.layers,c),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=function(_){const w=Math.exp(Math.PI*(1-_.y/(1<<_.z)*2));return 80150034*w/(w*w+1)/kr/(1<<_.z)}(d),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter;for(const{feature:_,id:w,index:C,sourceLayerIndex:O}of l){const k=this.layers[0]._featureFilter.needGeometry,M=ld(_,k);if(!this.layers[0]._featureFilter.filter(new Xe(this.zoom),M,d))continue;const N={id:w,sourceLayerIndex:O,index:C,geometry:k?M.geometry:Tu(_,d,y),properties:_.properties,type:_.type,patterns:{}},B=this.layoutVertexArray.length;this.hasPattern?this.features.push(eM("fill-extrusion",this.layers,N,this.zoom,c)):this.addFeature(N,N.geometry,C,d,{},c.availableImages,y),c.featureIndex.insert(_,N.geometry,C,O,this.index,B)}this.sortBorders()}addFeatures(l,c,d,y,_){for(const w of this.features){const{geometry:C}=w;this.addFeature(w,C,w.index,c,d,y,_)}this.sortBorders()}update(l,c,d,y){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(l,c,this.stateDependentLayers,d,y)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(l){this.uploaded||(this.layoutVertexBuffer=l.createVertexBuffer(this.layoutVertexArray,xfe),this.indexBuffer=l.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=l.createVertexBuffer(this.layoutVertexExtArray,Sfe.members,!0))),this.programConfigurations.upload(l),this.uploaded=!0}uploadCentroid(l){this.centroidVertexArray.length!==0&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=l.createVertexBuffer(this.centroidVertexArray,wfe.members,!0),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(l,c,d,y,_,w,C){const O=[new K(0,0),new K(kr,kr)],k=C.projection,M=k.name==="globe",N=this.enableTerrain&&!M?new D4:null,B=Afe[l.type]==="Polygon";M&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new Ua);const W=JI(c,500);for(let pe=W.length-1;pe>=0;pe--){const Ce=W[pe];(Ce.length===0||(Y=Ce[0]).every(he=>he.x<=0)||Y.every(he=>he.x>=kr)||Y.every(he=>he.y<=0)||Y.every(he=>he.y>=kr))&&W.splice(pe,1)}var Y;let J;if(M)J=F4(W,O,y);else{J=[];for(const pe of W)J.push({polygon:pe,bounds:O})}const ie=B?this.edgeRadius:0;for(const{polygon:pe,bounds:Ce}of J){let he=0,Se=0;for(const Te of pe)B&&!Te[0].equals(Te[Te.length-1])&&Te.push(Te[0]),Se+=B?Te.length-1:Te.length;const ke=this.segments.prepareSegment((B?5:4)*Se,this.layoutVertexArray,this.indexArray);if(B){const Te=[],lt=[];he=ke.vertexLength;for(const vt of pe){let $t,ht;vt.length&&vt!==pe[0]&&lt.push(Te.length/2),$t=vt[1].sub(vt[0])._perp()._unit();for(let bt=1;bt<vt.length;bt++){const St=vt[bt],Pt=vt[bt===vt.length-1?1:bt+1];let{x:Nt,y:dt}=St;if(ie){ht=Pt.sub(St)._perp()._unit();const Wt=$t.add(ht)._unit(),xr=ie*Math.min(4,1/($t.x*Wt.x+$t.y*Wt.y));Nt+=xr*Wt.x,dt+=xr*Wt.y,$t=ht}dw(this.layoutVertexArray,Nt,dt,0,0,1,1,0),ke.vertexLength++,Te.push(St.x,St.y),M&&pw(this.layoutVertexExtArray,k.projectTilePoint(Nt,dt,y),k.upVector(y,Nt,dt))}}const it=Km(Te,lt);for(let vt=0;vt<it.length;vt+=3)this.indexArray.emplaceBack(he+it[vt],he+it[vt+2],he+it[vt+1]),ke.primitiveLength++}for(const Te of pe){N&&Te.length&&N.startRing(Te[0]);let lt,it,vt,$t=Te.length>4&&B4(Te[Te.length-2],Te[0],Te[1]),ht=ie?Mfe(Te[Te.length-2],Te[0],Te[1],ie):0;it=Te[1].sub(Te[0])._perp()._unit();let bt=!0;for(let St=1,Pt=0;St<Te.length;St++){let Nt=Te[St-1],dt=Te[St];const Wt=Te[St===Te.length-1?1:St+1];if(N&&B&&N.currentPolyCount.top++,N4(dt,Nt,Ce)){ie&&(it=Wt.sub(dt)._perp()._unit(),bt=!bt);continue}N&&N.append(dt,Nt);const xr=dt.sub(Nt)._perp(),Zt=xr.x/(Math.abs(xr.x)+Math.abs(xr.y)),ar=xr.y>0?1:0,Yt=Nt.dist(dt);if(Pt+Yt>32768&&(Pt=0),ie){vt=Wt.sub(dt)._perp()._unit();let Wr=L4(Nt,dt,Wt,$4(it,vt),ie);isNaN(Wr)&&(Wr=0);const Rr=dt.sub(Nt)._unit();Nt=Nt.add(Rr.mult(ht))._round(),dt=dt.add(Rr.mult(-Wr))._round(),ht=Wr,it=vt}const Tr=ke.vertexLength,Zr=Te.length>4&&B4(Nt,dt,Wt);let Yr=j4(Pt,$t,bt);if(dw(this.layoutVertexArray,Nt.x,Nt.y,Zt,ar,0,0,Yr),dw(this.layoutVertexArray,Nt.x,Nt.y,Zt,ar,0,1,Yr),Pt+=Yt,Yr=j4(Pt,Zr,!bt),$t=Zr,dw(this.layoutVertexArray,dt.x,dt.y,Zt,ar,0,0,Yr),dw(this.layoutVertexArray,dt.x,dt.y,Zt,ar,0,1,Yr),ke.vertexLength+=4,this.indexArray.emplaceBack(Tr+0,Tr+1,Tr+2),this.indexArray.emplaceBack(Tr+1,Tr+3,Tr+2),ke.primitiveLength+=2,ie){const Wr=he+(St===1?Te.length-2:St-2),Rr=St===1?he:Wr+1;if(this.indexArray.emplaceBack(Tr+1,Wr,Tr+3),this.indexArray.emplaceBack(Wr,Rr,Tr+3),ke.primitiveLength+=2,lt===void 0&&(lt=Tr),!N4(Wt,Te[St],Ce)){const Rn=St===Te.length-1?lt:ke.vertexLength;this.indexArray.emplaceBack(Tr+2,Tr+3,Rn),this.indexArray.emplaceBack(Tr+3,Rn+1,Rn),this.indexArray.emplaceBack(Tr+3,Rr,Rn+1),ke.primitiveLength+=3}bt=!bt}if(M){const Wr=this.layoutVertexExtArray,Rr=k.projectTilePoint(Nt.x,Nt.y,y),Rn=k.projectTilePoint(dt.x,dt.y,y),Dr=k.upVector(y,Nt.x,Nt.y),Jr=k.upVector(y,dt.x,dt.y);pw(Wr,Rr,Dr),pw(Wr,Rr,Dr),pw(Wr,Rn,Jr),pw(Wr,Rn,Jr)}}B&&(he+=Te.length-1)}}if(N&&N.polyCount.length>0){if(N.borders){N.vertexArrayOffset=this.centroidVertexArray.length;const pe=N.borders,Ce=this.featuresOnBorder.push(N)-1;for(let he=0;he<4;he++)pe[he][0]!==Number.MAX_VALUE&&this.borders[he].push(Ce)}this.encodeCentroid(N.borders?void 0:N.centroid(),N)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,l,d,_,w,y)}sortBorders(){for(let l=0;l<4;l++)this.borders[l].sort((c,d)=>this.featuresOnBorder[c].borders[l][0]-this.featuresOnBorder[d].borders[l][0])}encodeCentroid(l,c,d=!0){let y,_;if(l)if(l.y!==0){const C=c.span()._mult(this.tileToMeter);y=(Math.max(l.x,1)<<3)+Math.min(7,Math.round(C.x/10)),_=(Math.max(l.y,1)<<3)+Math.min(7,Math.round(C.y/10))}else y=Math.ceil(7*(l.x+450)),_=0;else y=0,_=+d;let w=d?this.centroidVertexArray.length:c.vertexArrayOffset;for(const C of c.polyCount){d&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*C.edges+C.top);for(let O=0;O<C.top;O++)this.centroidVertexArray.emplace(w++,y,_);for(let O=0;O<2*C.edges;O++)this.centroidVertexArray.emplace(w++,0,_),this.centroidVertexArray.emplace(w++,y,_)}}}function $4(u,l){const c=u.add(l)._unit();return u.x*c.x+u.y*c.y}function Mfe(u,l,c,d){const y=l.sub(u)._perp()._unit(),_=c.sub(l)._perp()._unit();return L4(u,l,c,$4(y,_),d)}function L4(u,l,c,d,y){const _=Math.sqrt(1-d*d);return Math.min(u.dist(l)/3,l.dist(c)/3,y*_/d)}function N4(u,l,c){return u.x<c[0].x&&l.x<c[0].x||u.x>c[1].x&&l.x>c[1].x||u.y<c[0].y&&l.y<c[0].y||u.y>c[1].y&&l.y>c[1].y}function B4(u,l,c){if(u.x<0||u.x>=kr||l.x<0||l.x>=kr||c.x<0||c.x>=kr)return!1;const d=c.sub(l),y=d.perp(),_=u.sub(l);return(d.x*_.x+d.y*_.y)/Math.sqrt((d.x*d.x+d.y*d.y)*(_.x*_.x+_.y*_.y))>-.866&&y.x*_.x+y.y*_.y<0}function j4(u,l,c){const d=l?2|u:-3&u;return c?1|d:-2&d}function z4(){const u=Math.PI/32,l=Math.tan(u),c=lw;return c*Math.sqrt(1+2*l*l)-c}function F4(u,l,c){const d=1<<c.z,y=Ga(c.x/d),_=Ga((c.x+1)/d),w=xo(c.y/d),C=xo((c.y+1)/d);return function(O,k,M,N,B=0,W){const Y=[];if(!O.length||!M||!N)return Y;const J=(Te,lt)=>{for(const it of Te)Y.push({polygon:it,bounds:lt})},ie=Math.ceil(Math.log2(M)),pe=Math.ceil(Math.log2(N)),Ce=ie-pe,he=[];for(let Te=0;Te<Math.abs(Ce);Te++)he.push(Ce>0?0:1);for(let Te=0;Te<Math.min(ie,pe);Te++)he.push(0),he.push(1);let Se=O;if(Se=VE(Se,k[0].y-B,k[1].y+B,1),Se=VE(Se,k[0].x-B,k[1].x+B,0),!Se.length)return Y;const ke=[];for(he.length?ke.push({polygons:Se,bounds:k,depth:0}):J(Se,k);ke.length;){const Te=ke.pop(),lt=Te.depth,it=he[lt],vt=Te.bounds[0],$t=Te.bounds[1],ht=it===0?vt.x:vt.y,bt=it===0?$t.x:$t.y,St=W?W(it,ht,bt):.5*(ht+bt),Pt=VE(Te.polygons,ht-B,St+B,it),Nt=VE(Te.polygons,St-B,bt+B,it);if(Pt.length){const dt=[vt,new K(it===0?St:$t.x,it===1?St:$t.y)];he.length>lt+1?ke.push({polygons:Pt,bounds:dt,depth:lt+1}):J(Pt,dt)}if(Nt.length){const dt=[new K(it===0?St:vt.x,it===1?St:vt.y),$t];he.length>lt+1?ke.push({polygons:Nt,bounds:dt,depth:lt+1}):J(Nt,dt)}}return Y}(u,l,Math.ceil((_-y)/11.25),Math.ceil((w-C)/11.25),1,(O,k,M)=>{if(O===0)return .5*(k+M);{const N=xo((c.y+k/kr)/d);return(Il(.5*(xo((c.y+M/kr)/d)+N))*d-c.y)*kr}})}tr(mw,"FillExtrusionBucket",{omit:["layers","features"]}),tr(D4,"PartMetadata");const Dfe=new Mt({"fill-extrusion-edge-radius":new Ye(yt["layout_fill-extrusion"]["fill-extrusion-edge-radius"])});var $fe={paint:new Mt({"fill-extrusion-opacity":new Ye(yt["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new ct(yt["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Ye(yt["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Ye(yt["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new ct(yt["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new ct(yt["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new ct(yt["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Ye(yt["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new Ye(yt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new Ye(yt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"])}),layout:Dfe};function H4(u,l,c){var d=2*Math.PI*6378137/256/Math.pow(2,c);return[u*d-2*Math.PI*6378137/2,l*d-2*Math.PI*6378137/2]}class UE{constructor(l,c,d){this.z=l,this.x=c,this.y=d,this.key=yw(0,l,l,c,d)}equals(l){return this.z===l.z&&this.x===l.x&&this.y===l.y}url(l,c){const d=function(_,w,C){var O=H4(256*_,256*(w=Math.pow(2,C)-w-1),C),k=H4(256*(_+1),256*(w+1),C);return O[0]+","+O[1]+","+k[0]+","+k[1]}(this.x,this.y,this.z),y=function(_,w,C){let O,k="";for(let M=_;M>0;M--)O=1<<M-1,k+=(w&O?1:0)+(C&O?2:0);return k}(this.z,this.x,this.y);return l[(this.x+this.y)%l.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(c==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",y).replace("{bbox-epsg-3857}",d)}toString(){return`${this.z}/${this.x}/${this.y}`}}class V4{constructor(l,c){this.wrap=l,this.canonical=c,this.key=yw(l,c.z,c.z,c.x,c.y)}}class Go{constructor(l,c,d,y,_){this.overscaledZ=l,this.wrap=c,this.canonical=new UE(d,+y,+_),this.key=c===0&&l===d?this.canonical.key:yw(c,l,d,y,_)}equals(l){return this.overscaledZ===l.overscaledZ&&this.wrap===l.wrap&&this.canonical.equals(l.canonical)}scaledTo(l){const c=this.canonical.z-l;return l>this.canonical.z?new Go(l,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Go(l,this.wrap,l,this.canonical.x>>c,this.canonical.y>>c)}calculateScaledKey(l,c=!0){if(this.overscaledZ===l&&c)return this.key;if(l>this.canonical.z)return yw(this.wrap*+c,l,this.canonical.z,this.canonical.x,this.canonical.y);{const d=this.canonical.z-l;return yw(this.wrap*+c,l,l,this.canonical.x>>d,this.canonical.y>>d)}}isChildOf(l){if(l.wrap!==this.wrap)return!1;const c=this.canonical.z-l.canonical.z;return l.overscaledZ===0||l.overscaledZ<this.overscaledZ&&l.canonical.x===this.canonical.x>>c&&l.canonical.y===this.canonical.y>>c}children(l){if(this.overscaledZ>=l)return[new Go(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const c=this.canonical.z+1,d=2*this.canonical.x,y=2*this.canonical.y;return[new Go(c,this.wrap,c,d,y),new Go(c,this.wrap,c,d+1,y),new Go(c,this.wrap,c,d,y+1),new Go(c,this.wrap,c,d+1,y+1)]}isLessThan(l){return this.wrap<l.wrap||!(this.wrap>l.wrap)&&(this.overscaledZ<l.overscaledZ||!(this.overscaledZ>l.overscaledZ)&&(this.canonical.x<l.canonical.x||!(this.canonical.x>l.canonical.x)&&this.canonical.y<l.canonical.y))}wrapped(){return new Go(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(l){return new Go(this.overscaledZ,l,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new V4(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function yw(u,l,c,d,y){const _=1<<Math.min(c,22);let w=_*(y%_)+d%_;return u&&c<22&&(w+=_*_*((u<0?-2*u-1:2*u)%(1<<2*(22-c)))),16*(32*w+c)+(l-c)}tr(UE,"CanonicalTileID"),tr(Go,"OverscaledTileID",{omit:["projMatrix"]});class Zm extends K{constructor(l,c,d){super(l,c),this.z=d}}function gw(u,l){return u.x*l.x+u.y*l.y}function U4(u,l){if(u.length===1){let c=0;const d=l[c++];let y;for(;!y||d.equals(y);)if(y=l[c++],!y)return 1/0;for(;c<l.length;c++){const _=l[c],w=u[0],C=y.sub(d),O=_.sub(d),k=w.sub(d),M=gw(C,C),N=gw(C,O),B=gw(O,O),W=gw(k,C),Y=gw(k,O),J=M*B-N*N,ie=(B*W-N*Y)/J,pe=(M*Y-N*W)/J,Ce=d.z*(1-ie-pe)+y.z*ie+_.z*pe;if(isFinite(Ce))return Ce}return 1/0}{let c=1/0;for(const d of l)c=Math.min(c,d.z);return c}}function W4(u,l,c,d,y,_,w,C){const O=w*y.getElevationAt(u,l,!0,!0),k=_[0]!==0,M=k?_[1]===0?w*(_[0]/7-450):w*function(N,B,W){const Y=Math.floor(B[0]/8),J=Math.floor(B[1]/8),ie=10*(B[0]-8*Y),pe=10*(B[1]-8*J),Ce=N.getElevationAt(Y,J,!0,!0),he=N.getMeterToDEM(W),Se=Math.floor(.5*(ie*he-1)),ke=Math.floor(.5*(pe*he-1)),Te=N.tileCoordToPixel(Y,J),lt=2*Se+1,it=2*ke+1,vt=function(Nt,dt,Wt,xr,Zt){return[Nt.getElevationAtPixel(dt,Wt,!0),Nt.getElevationAtPixel(dt+Zt,Wt,!0),Nt.getElevationAtPixel(dt,Wt+Zt,!0),Nt.getElevationAtPixel(dt+xr,Wt+Zt,!0)]}(N,Te.x-Se,Te.y-ke,lt,it),$t=Math.abs(vt[0]-vt[1]),ht=Math.abs(vt[2]-vt[3]),bt=Math.abs(vt[0]-vt[2])+Math.abs(vt[1]-vt[3]),St=Math.min(.25,.5*he*($t+ht)/lt),Pt=Math.min(.25,.5*he*bt/it);return Ce+Math.max(St*ie,Pt*pe)}(y,_,C):O;return{base:O+(c===0)?-1:c,top:k?Math.max(M+d,O+c+2):O+d}}const Lfe=fr([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:Nfe}=Lfe,Bfe=fr([{name:"a_packed",components:4,type:"Float32"}]),{members:jfe}=Bfe,zfe=HE.types,Ffe=Math.cos(Math.PI/180*37.5);class WE{constructor(l){this.zoom=l.zoom,this.overscaling=l.overscaling,this.layers=l.layers,this.layerIds=this.layers.map(c=>c.id),this.index=l.index,this.projection=l.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(c=>{this.gradients[c.id]={}}),this.layoutVertexArray=new Fn,this.layoutVertexArray2=new $n,this.indexArray=new So,this.programConfigurations=new rd(l.layers,l.zoom),this.segments=new Oi,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id)}populate(l,c,d,y){this.hasPattern=QI("line",this.layers,c);const _=this.layers[0].layout.get("line-sort-key"),w=[];for(const{feature:M,id:N,index:B,sourceLayerIndex:W}of l){const Y=this.layers[0]._featureFilter.needGeometry,J=ld(M,Y);if(!this.layers[0]._featureFilter.filter(new Xe(this.zoom),J,d))continue;const ie=_?_.evaluate(J,{},d):void 0,pe={id:N,properties:M.properties,type:M.type,sourceLayerIndex:W,index:B,geometry:Y?J.geometry:Tu(M,d,y),patterns:{},sortKey:ie};w.push(pe)}_&&w.sort((M,N)=>M.sortKey-N.sortKey);const{lineAtlas:C,featureIndex:O}=c,k=this.addConstantDashes(C);for(const M of w){const{geometry:N,index:B,sourceLayerIndex:W}=M;if(k&&this.addFeatureDashes(M,C),this.hasPattern){const Y=eM("line",this.layers,M,this.zoom,c);this.patternFeatures.push(Y)}else this.addFeature(M,N,B,d,C.positions,c.availableImages);O.insert(l[B].feature,N,B,W,this.index)}}addConstantDashes(l){let c=!1;for(const d of this.layers){const y=d.paint.get("line-dasharray").value,_=d.layout.get("line-cap").value;if(y.kind!=="constant"||_.kind!=="constant")c=!0;else{const w=_.value,C=y.value;if(!C)continue;l.addDash(C,w)}}return c}addFeatureDashes(l,c){const d=this.zoom;for(const y of this.layers){const _=y.paint.get("line-dasharray").value,w=y.layout.get("line-cap").value;if(_.kind==="constant"&&w.kind==="constant")continue;let C,O;if(_.kind==="constant"){if(C=_.value,!C)continue}else C=_.evaluate({zoom:d},l);O=w.kind==="constant"?w.value:w.evaluate({zoom:d},l),c.addDash(C,O),l.patterns[y.id]=c.getKey(C,O)}}update(l,c,d,y){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(l,c,this.stateDependentLayers,d,y)}addFeatures(l,c,d,y,_){for(const w of this.patternFeatures)this.addFeature(w,w.geometry,w.index,c,d,y)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(l){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=l.createVertexBuffer(this.layoutVertexArray2,jfe)),this.layoutVertexBuffer=l.createVertexBuffer(this.layoutVertexArray,Nfe),this.indexBuffer=l.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(l),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(l){if(l.properties&&l.properties.hasOwnProperty("mapbox_clip_start")&&l.properties.hasOwnProperty("mapbox_clip_end"))return{start:+l.properties.mapbox_clip_start,end:+l.properties.mapbox_clip_end}}addFeature(l,c,d,y,_,w){const C=this.layers[0].layout,O=C.get("line-join").evaluate(l,{}),k=C.get("line-cap").evaluate(l,{}),M=C.get("line-miter-limit"),N=C.get("line-round-limit");this.lineClips=this.lineFeatureClips(l);for(const B of c)this.addLine(B,l,O,k,M,N);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,l,d,_,w,y)}addLine(l,c,d,y,_,w){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let pe=0;pe<l.length-1;pe++)this.totalDistance+=l[pe].dist(l[pe+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const C=zfe[c.type]==="Polygon";let O=l.length;for(;O>=2&&l[O-1].equals(l[O-2]);)O--;let k=0;for(;k<O-1&&l[k].equals(l[k+1]);)k++;if(O<(C?3:2))return;d==="bevel"&&(_=1.05);const M=this.overscaling<=16?122880/(512*this.overscaling):0,N=this.segments.prepareSegment(10*O,this.layoutVertexArray,this.indexArray);let B,W,Y,J,ie;this.e1=this.e2=-1,C&&(B=l[O-2],ie=l[k].sub(B)._unit()._perp());for(let pe=k;pe<O;pe++){if(Y=pe===O-1?C?l[k+1]:void 0:l[pe+1],Y&&l[pe].equals(Y))continue;ie&&(J=ie),B&&(W=B),B=l[pe],ie=Y?Y.sub(B)._unit()._perp():J,J=J||ie;let Ce=J.add(ie);Ce.x===0&&Ce.y===0||Ce._unit();const he=J.x*ie.x+J.y*ie.y,Se=Ce.x*ie.x+Ce.y*ie.y,ke=Se!==0?1/Se:1/0,Te=2*Math.sqrt(2-2*Se),lt=Se<Ffe&&W&&Y,it=J.x*ie.y-J.y*ie.x>0;if(lt&&pe>k){const ht=B.dist(W);if(ht>2*M){const bt=B.sub(B.sub(W)._mult(M/ht)._round());this.updateDistance(W,bt),this.addCurrentVertex(bt,J,0,0,N),W=bt}}const vt=W&&Y;let $t=vt?d:C?"butt":y;if(vt&&$t==="round"&&(ke<w?$t="miter":ke<=2&&($t="fakeround")),$t==="miter"&&ke>_&&($t="bevel"),$t==="bevel"&&(ke>2&&($t="flipbevel"),ke<_&&($t="miter")),W&&this.updateDistance(W,B),$t==="miter")Ce._mult(ke),this.addCurrentVertex(B,Ce,0,0,N);else if($t==="flipbevel"){if(ke>100)Ce=ie.mult(-1);else{const ht=ke*J.add(ie).mag()/J.sub(ie).mag();Ce._perp()._mult(ht*(it?-1:1))}this.addCurrentVertex(B,Ce,0,0,N),this.addCurrentVertex(B,Ce.mult(-1),0,0,N)}else if($t==="bevel"||$t==="fakeround"){const ht=-Math.sqrt(ke*ke-1),bt=it?ht:0,St=it?0:ht;if(W&&this.addCurrentVertex(B,J,bt,St,N),$t==="fakeround"){const Pt=Math.round(180*Te/Math.PI/20);for(let Nt=1;Nt<Pt;Nt++){let dt=Nt/Pt;if(dt!==.5){const xr=dt-.5;dt+=dt*xr*(dt-1)*((1.0904+he*(he*(3.55645-1.43519*he)-3.2452))*xr*xr+(.848013+he*(.215638*he-1.06021)))}const Wt=ie.sub(J)._mult(dt)._add(J)._unit()._mult(it?-1:1);this.addHalfVertex(B,Wt.x,Wt.y,!1,it,0,N)}}Y&&this.addCurrentVertex(B,ie,-bt,-St,N)}else if($t==="butt")this.addCurrentVertex(B,Ce,0,0,N);else if($t==="square"){const ht=W?1:-1;W||this.addCurrentVertex(B,Ce,ht,ht,N),this.addCurrentVertex(B,Ce,0,0,N),W&&this.addCurrentVertex(B,Ce,ht,ht,N)}else $t==="round"&&(W&&(this.addCurrentVertex(B,J,0,0,N),this.addCurrentVertex(B,J,1,1,N,!0)),Y&&(this.addCurrentVertex(B,ie,-1,-1,N,!0),this.addCurrentVertex(B,ie,0,0,N)));if(lt&&pe<O-1){const ht=B.dist(Y);if(ht>2*M){const bt=B.add(Y.sub(B)._mult(M/ht)._round());this.updateDistance(B,bt),this.addCurrentVertex(bt,ie,0,0,N),B=bt}}}}addCurrentVertex(l,c,d,y,_,w=!1){const C=c.y*y-c.x,O=-c.y-c.x*y;this.addHalfVertex(l,c.x+c.y*d,c.y-c.x*d,w,!1,d,_),this.addHalfVertex(l,C,O,w,!0,-y,_)}addHalfVertex({x:l,y:c},d,y,_,w,C,O){this.layoutVertexArray.emplaceBack((l<<1)+(_?1:0),(c<<1)+(w?1:0),Math.round(63*d)+128,Math.round(63*y)+128,1+(C===0?0:C<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const k=O.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,k),O.primitiveLength++),w?this.e2=k:this.e1=k}updateScaledDistance(){if(this.lineClips){const l=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=l*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(l,c){this.distance+=l.dist(c),this.updateScaledDistance()}}tr(WE,"LineBucket",{omit:["layers","patternFeatures"]});const Hfe=new Mt({"line-cap":new ct(yt.layout_line["line-cap"]),"line-join":new ct(yt.layout_line["line-join"]),"line-miter-limit":new Ye(yt.layout_line["line-miter-limit"]),"line-round-limit":new Ye(yt.layout_line["line-round-limit"]),"line-sort-key":new ct(yt.layout_line["line-sort-key"])});var G4={paint:new Mt({"line-opacity":new ct(yt.paint_line["line-opacity"]),"line-color":new ct(yt.paint_line["line-color"]),"line-translate":new Ye(yt.paint_line["line-translate"]),"line-translate-anchor":new Ye(yt.paint_line["line-translate-anchor"]),"line-width":new ct(yt.paint_line["line-width"]),"line-gap-width":new ct(yt.paint_line["line-gap-width"]),"line-offset":new ct(yt.paint_line["line-offset"]),"line-blur":new ct(yt.paint_line["line-blur"]),"line-dasharray":new ct(yt.paint_line["line-dasharray"]),"line-pattern":new ct(yt.paint_line["line-pattern"]),"line-gradient":new Et(yt.paint_line["line-gradient"]),"line-trim-offset":new Ye(yt.paint_line["line-trim-offset"])}),layout:Hfe};const Y4=new class extends ct{possiblyEvaluate(u,l){return l=new Xe(Math.floor(l.zoom),{now:l.now,fadeDuration:l.fadeDuration,transition:l.transition}),super.possiblyEvaluate(u,l)}evaluate(u,l,c,d){return l=U({},l,{zoom:Math.floor(l.zoom)}),super.evaluate(u,l,c,d)}}(G4.paint.properties["line-width"].specification);function K4(u,l){return l>0?l+2*u:u}Y4.useIntegerZoom=!0;const Vfe=fr([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Ufe=fr([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),Wfe=fr([{name:"a_projected_pos",components:4,type:"Float32"}],4);fr([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Gfe=fr([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),Yfe=fr([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);fr([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const q4=fr([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Kfe=fr([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);fr([{name:"triangle",components:3,type:"Uint16"}]),fr([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),fr([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),fr([{type:"Float32",name:"offsetX"}]),fr([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var Eo=24;const Ml=128;function rM(u,l){const{expression:c}=l;if(c.kind==="constant")return{kind:"constant",layoutSize:c.evaluate(new Xe(u+1))};if(c.kind==="source")return{kind:"source"};{const{zoomStops:d,interpolationType:y}=c;let _=0;for(;_<d.length&&d[_]<=u;)_++;_=Math.max(0,_-1);let w=_;for(;w<d.length&&d[w]<u+1;)w++;w=Math.min(d.length-1,w);const C=d[_],O=d[w];return c.kind==="composite"?{kind:"composite",minZoom:C,maxZoom:O,interpolationType:y}:{kind:"camera",minZoom:C,maxZoom:O,minSize:c.evaluate(new Xe(C)),maxSize:c.evaluate(new Xe(O)),interpolationType:y}}}function GE(u,{uSize:l,uSizeT:c},{lowerSize:d,upperSize:y}){return u.kind==="source"?d/Ml:u.kind==="composite"?mn(d/Ml,y/Ml,c):l}function Jm(u,l){let c=0,d=0;if(u.kind==="constant")d=u.layoutSize;else if(u.kind!=="source"){const{interpolationType:y,minZoom:_,maxZoom:w}=u,C=y?Fe(ms.interpolationFactor(y,l,_,w),0,1):0;u.kind==="camera"?d=mn(u.minSize,u.maxSize,C):c=C}return{uSizeT:c,uSize:d}}var qfe=Object.freeze({__proto__:null,getSizeData:rM,evaluateSizeForFeature:GE,evaluateSizeForZoom:Jm,SIZE_PACK_FACTOR:Ml});function Xfe(u,l,c){return u.sections.forEach(d=>{d.text=function(y,_,w){const C=_.layout.get("text-transform").evaluate(w,{});return C==="uppercase"?y=y.toLocaleUpperCase():C==="lowercase"&&(y=y.toLocaleLowerCase()),De.applyArabicShaping&&(y=De.applyArabicShaping(y)),y}(d.text,l,c)}),u}const vw={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};function Zfe(u){return u===""||u===""||u===""||u===""||u===""||u===""||u===""||u===""||u===""||u===""||u===""||u===""||u===""||u===""||u===""||u===""||u===""}function Jfe(u){return u===""||u===""||u===""||u===""||u===""||u===""||u===""||u===""||u===""||u===""}var _w=Hn,X4=function(u,l,c,d,y){var _,w,C=8*y-d-1,O=(1<<C)-1,k=O>>1,M=-7,N=c?y-1:0,B=c?-1:1,W=u[l+N];for(N+=B,_=W&(1<<-M)-1,W>>=-M,M+=C;M>0;_=256*_+u[l+N],N+=B,M-=8);for(w=_&(1<<-M)-1,_>>=-M,M+=d;M>0;w=256*w+u[l+N],N+=B,M-=8);if(_===0)_=1-k;else{if(_===O)return w?NaN:1/0*(W?-1:1);w+=Math.pow(2,d),_-=k}return(W?-1:1)*w*Math.pow(2,_-d)},Z4=function(u,l,c,d,y,_){var w,C,O,k=8*_-y-1,M=(1<<k)-1,N=M>>1,B=y===23?Math.pow(2,-24)-Math.pow(2,-77):0,W=d?0:_-1,Y=d?1:-1,J=l<0||l===0&&1/l<0?1:0;for(l=Math.abs(l),isNaN(l)||l===1/0?(C=isNaN(l)?1:0,w=M):(w=Math.floor(Math.log(l)/Math.LN2),l*(O=Math.pow(2,-w))<1&&(w--,O*=2),(l+=w+N>=1?B/O:B*Math.pow(2,1-N))*O>=2&&(w++,O/=2),w+N>=M?(C=0,w=M):w+N>=1?(C=(l*O-1)*Math.pow(2,y),w+=N):(C=l*Math.pow(2,N-1)*Math.pow(2,y),w=0));y>=8;u[c+W]=255&C,W+=Y,C/=256,y-=8);for(w=w<<y|C,k+=y;k>0;u[c+W]=255&w,W+=Y,w/=256,k-=8);u[c+W-Y]|=128*J};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */function Hn(u){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(u)?u:new Uint8Array(u||0),this.pos=0,this.type=0,this.length=this.buf.length}Hn.Varint=0,Hn.Fixed64=1,Hn.Bytes=2,Hn.Fixed32=5;var nM=4294967296,J4=1/nM,Q4=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function Ru(u){return u.type===Hn.Bytes?u.readVarint()+u.pos:u.pos+1}function Qm(u,l,c){return c?4294967296*l+(u>>>0):4294967296*(l>>>0)+(u>>>0)}function eW(u,l,c){var d=l<=16383?1:l<=2097151?2:l<=268435455?3:Math.floor(Math.log(l)/(7*Math.LN2));c.realloc(d);for(var y=c.pos-1;y>=u;y--)c.buf[y+d]=c.buf[y]}function Qfe(u,l){for(var c=0;c<u.length;c++)l.writeVarint(u[c])}function ehe(u,l){for(var c=0;c<u.length;c++)l.writeSVarint(u[c])}function the(u,l){for(var c=0;c<u.length;c++)l.writeFloat(u[c])}function rhe(u,l){for(var c=0;c<u.length;c++)l.writeDouble(u[c])}function nhe(u,l){for(var c=0;c<u.length;c++)l.writeBoolean(u[c])}function ihe(u,l){for(var c=0;c<u.length;c++)l.writeFixed32(u[c])}function ohe(u,l){for(var c=0;c<u.length;c++)l.writeSFixed32(u[c])}function ahe(u,l){for(var c=0;c<u.length;c++)l.writeFixed64(u[c])}function she(u,l){for(var c=0;c<u.length;c++)l.writeSFixed64(u[c])}function YE(u,l){return(u[l]|u[l+1]<<8|u[l+2]<<16)+16777216*u[l+3]}function ey(u,l,c){u[c]=l,u[c+1]=l>>>8,u[c+2]=l>>>16,u[c+3]=l>>>24}function tW(u,l){return(u[l]|u[l+1]<<8|u[l+2]<<16)+(u[l+3]<<24)}function lhe(u,l,c){l.glyphs=[],u===1&&c.readMessage(uhe,l)}function uhe(u,l,c){if(u===3){const{id:d,bitmap:y,width:_,height:w,left:C,top:O,advance:k}=c.readMessage(che,{});l.glyphs.push({id:d,bitmap:new Ou({width:_+6,height:w+6},y),metrics:{width:_,height:w,left:C,top:O,advance:k}})}else u===4?l.ascender=c.readSVarint():u===5&&(l.descender=c.readSVarint())}function che(u,l,c){u===1?l.id=c.readVarint():u===2?l.bitmap=c.readBytes():u===3?l.width=c.readVarint():u===4?l.height=c.readVarint():u===5?l.left=c.readSVarint():u===6?l.top=c.readSVarint():u===7&&(l.advance=c.readVarint())}function iM(u){let l=0,c=0;for(const w of u)l+=w.w*w.h,c=Math.max(c,w.w);u.sort((w,C)=>C.h-w.h);const d=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(l/.95)),c),h:1/0}];let y=0,_=0;for(const w of u)for(let C=d.length-1;C>=0;C--){const O=d[C];if(!(w.w>O.w||w.h>O.h)){if(w.x=O.x,w.y=O.y,_=Math.max(_,w.y+w.h),y=Math.max(y,w.x+w.w),w.w===O.w&&w.h===O.h){const k=d.pop();C<d.length&&(d[C]=k)}else w.h===O.h?(O.x+=w.w,O.w-=w.w):w.w===O.w?(O.y+=w.h,O.h-=w.h):(d.push({x:O.x+w.w,y:O.y,w:O.w-w.w,h:w.h}),O.y+=w.h,O.h-=w.h);break}}return{w:y,h:_,fill:l/(y*_)||0}}Hn.prototype={destroy:function(){this.buf=null},readFields:function(u,l,c){for(c=c||this.length;this.pos<c;){var d=this.readVarint(),y=d>>3,_=this.pos;this.type=7&d,u(y,l,this),this.pos===_&&this.skip(d)}return l},readMessage:function(u,l){return this.readFields(u,l,this.readVarint()+this.pos)},readFixed32:function(){var u=YE(this.buf,this.pos);return this.pos+=4,u},readSFixed32:function(){var u=tW(this.buf,this.pos);return this.pos+=4,u},readFixed64:function(){var u=YE(this.buf,this.pos)+YE(this.buf,this.pos+4)*nM;return this.pos+=8,u},readSFixed64:function(){var u=YE(this.buf,this.pos)+tW(this.buf,this.pos+4)*nM;return this.pos+=8,u},readFloat:function(){var u=X4(this.buf,this.pos,!0,23,4);return this.pos+=4,u},readDouble:function(){var u=X4(this.buf,this.pos,!0,52,8);return this.pos+=8,u},readVarint:function(u){var l,c,d=this.buf;return l=127&(c=d[this.pos++]),c<128?l:(l|=(127&(c=d[this.pos++]))<<7,c<128?l:(l|=(127&(c=d[this.pos++]))<<14,c<128?l:(l|=(127&(c=d[this.pos++]))<<21,c<128?l:function(y,_,w){var C,O,k=w.buf;if(C=(112&(O=k[w.pos++]))>>4,O<128||(C|=(127&(O=k[w.pos++]))<<3,O<128)||(C|=(127&(O=k[w.pos++]))<<10,O<128)||(C|=(127&(O=k[w.pos++]))<<17,O<128)||(C|=(127&(O=k[w.pos++]))<<24,O<128)||(C|=(1&(O=k[w.pos++]))<<31,O<128))return Qm(y,C,_);throw new Error("Expected varint not more than 10 bytes")}(l|=(15&(c=d[this.pos]))<<28,u,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var u=this.readVarint();return u%2==1?(u+1)/-2:u/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var u=this.readVarint()+this.pos,l=this.pos;return this.pos=u,u-l>=12&&Q4?function(c,d,y){return Q4.decode(c.subarray(d,y))}(this.buf,l,u):function(c,d,y){for(var _="",w=d;w<y;){var C,O,k,M=c[w],N=null,B=M>239?4:M>223?3:M>191?2:1;if(w+B>y)break;B===1?M<128&&(N=M):B===2?(192&(C=c[w+1]))==128&&(N=(31&M)<<6|63&C)<=127&&(N=null):B===3?(O=c[w+2],(192&(C=c[w+1]))==128&&(192&O)==128&&((N=(15&M)<<12|(63&C)<<6|63&O)<=2047||N>=55296&&N<=57343)&&(N=null)):B===4&&(O=c[w+2],k=c[w+3],(192&(C=c[w+1]))==128&&(192&O)==128&&(192&k)==128&&((N=(15&M)<<18|(63&C)<<12|(63&O)<<6|63&k)<=65535||N>=1114112)&&(N=null)),N===null?(N=65533,B=1):N>65535&&(N-=65536,_+=String.fromCharCode(N>>>10&1023|55296),N=56320|1023&N),_+=String.fromCharCode(N),w+=B}return _}(this.buf,l,u)},readBytes:function(){var u=this.readVarint()+this.pos,l=this.buf.subarray(this.pos,u);return this.pos=u,l},readPackedVarint:function(u,l){if(this.type!==Hn.Bytes)return u.push(this.readVarint(l));var c=Ru(this);for(u=u||[];this.pos<c;)u.push(this.readVarint(l));return u},readPackedSVarint:function(u){if(this.type!==Hn.Bytes)return u.push(this.readSVarint());var l=Ru(this);for(u=u||[];this.pos<l;)u.push(this.readSVarint());return u},readPackedBoolean:function(u){if(this.type!==Hn.Bytes)return u.push(this.readBoolean());var l=Ru(this);for(u=u||[];this.pos<l;)u.push(this.readBoolean());return u},readPackedFloat:function(u){if(this.type!==Hn.Bytes)return u.push(this.readFloat());var l=Ru(this);for(u=u||[];this.pos<l;)u.push(this.readFloat());return u},readPackedDouble:function(u){if(this.type!==Hn.Bytes)return u.push(this.readDouble());var l=Ru(this);for(u=u||[];this.pos<l;)u.push(this.readDouble());return u},readPackedFixed32:function(u){if(this.type!==Hn.Bytes)return u.push(this.readFixed32());var l=Ru(this);for(u=u||[];this.pos<l;)u.push(this.readFixed32());return u},readPackedSFixed32:function(u){if(this.type!==Hn.Bytes)return u.push(this.readSFixed32());var l=Ru(this);for(u=u||[];this.pos<l;)u.push(this.readSFixed32());return u},readPackedFixed64:function(u){if(this.type!==Hn.Bytes)return u.push(this.readFixed64());var l=Ru(this);for(u=u||[];this.pos<l;)u.push(this.readFixed64());return u},readPackedSFixed64:function(u){if(this.type!==Hn.Bytes)return u.push(this.readSFixed64());var l=Ru(this);for(u=u||[];this.pos<l;)u.push(this.readSFixed64());return u},skip:function(u){var l=7&u;if(l===Hn.Varint)for(;this.buf[this.pos++]>127;);else if(l===Hn.Bytes)this.pos=this.readVarint()+this.pos;else if(l===Hn.Fixed32)this.pos+=4;else{if(l!==Hn.Fixed64)throw new Error("Unimplemented type: "+l);this.pos+=8}},writeTag:function(u,l){this.writeVarint(u<<3|l)},realloc:function(u){for(var l=this.length||16;l<this.pos+u;)l*=2;if(l!==this.length){var c=new Uint8Array(l);c.set(this.buf),this.buf=c,this.length=l}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(u){this.realloc(4),ey(this.buf,u,this.pos),this.pos+=4},writeSFixed32:function(u){this.realloc(4),ey(this.buf,u,this.pos),this.pos+=4},writeFixed64:function(u){this.realloc(8),ey(this.buf,-1&u,this.pos),ey(this.buf,Math.floor(u*J4),this.pos+4),this.pos+=8},writeSFixed64:function(u){this.realloc(8),ey(this.buf,-1&u,this.pos),ey(this.buf,Math.floor(u*J4),this.pos+4),this.pos+=8},writeVarint:function(u){(u=+u||0)>268435455||u<0?function(l,c){var d,y;if(l>=0?(d=l%4294967296|0,y=l/4294967296|0):(y=~(-l/4294967296),4294967295^(d=~(-l%4294967296))?d=d+1|0:(d=0,y=y+1|0)),l>=18446744073709552e3||l<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");c.realloc(10),function(_,w,C){C.buf[C.pos++]=127&_|128,_>>>=7,C.buf[C.pos++]=127&_|128,_>>>=7,C.buf[C.pos++]=127&_|128,_>>>=7,C.buf[C.pos++]=127&_|128,C.buf[C.pos]=127&(_>>>=7)}(d,0,c),function(_,w){var C=(7&_)<<4;w.buf[w.pos++]|=C|((_>>>=3)?128:0),_&&(w.buf[w.pos++]=127&_|((_>>>=7)?128:0),_&&(w.buf[w.pos++]=127&_|((_>>>=7)?128:0),_&&(w.buf[w.pos++]=127&_|((_>>>=7)?128:0),_&&(w.buf[w.pos++]=127&_|((_>>>=7)?128:0),_&&(w.buf[w.pos++]=127&_)))))}(y,c)}(u,this):(this.realloc(4),this.buf[this.pos++]=127&u|(u>127?128:0),u<=127||(this.buf[this.pos++]=127&(u>>>=7)|(u>127?128:0),u<=127||(this.buf[this.pos++]=127&(u>>>=7)|(u>127?128:0),u<=127||(this.buf[this.pos++]=u>>>7&127))))},writeSVarint:function(u){this.writeVarint(u<0?2*-u-1:2*u)},writeBoolean:function(u){this.writeVarint(!!u)},writeString:function(u){u=String(u),this.realloc(4*u.length),this.pos++;var l=this.pos;this.pos=function(d,y,_){for(var w,C,O=0;O<y.length;O++){if((w=y.charCodeAt(O))>55295&&w<57344){if(!C){w>56319||O+1===y.length?(d[_++]=239,d[_++]=191,d[_++]=189):C=w;continue}if(w<56320){d[_++]=239,d[_++]=191,d[_++]=189,C=w;continue}w=C-55296<<10|w-56320|65536,C=null}else C&&(d[_++]=239,d[_++]=191,d[_++]=189,C=null);w<128?d[_++]=w:(w<2048?d[_++]=w>>6|192:(w<65536?d[_++]=w>>12|224:(d[_++]=w>>18|240,d[_++]=w>>12&63|128),d[_++]=w>>6&63|128),d[_++]=63&w|128)}return _}(this.buf,u,this.pos);var c=this.pos-l;c>=128&&eW(l,c,this),this.pos=l-1,this.writeVarint(c),this.pos+=c},writeFloat:function(u){this.realloc(4),Z4(this.buf,u,this.pos,!0,23,4),this.pos+=4},writeDouble:function(u){this.realloc(8),Z4(this.buf,u,this.pos,!0,52,8),this.pos+=8},writeBytes:function(u){var l=u.length;this.writeVarint(l),this.realloc(l);for(var c=0;c<l;c++)this.buf[this.pos++]=u[c]},writeRawMessage:function(u,l){this.pos++;var c=this.pos;u(l,this);var d=this.pos-c;d>=128&&eW(c,d,this),this.pos=c-1,this.writeVarint(d),this.pos+=d},writeMessage:function(u,l,c){this.writeTag(u,Hn.Bytes),this.writeRawMessage(l,c)},writePackedVarint:function(u,l){l.length&&this.writeMessage(u,Qfe,l)},writePackedSVarint:function(u,l){l.length&&this.writeMessage(u,ehe,l)},writePackedBoolean:function(u,l){l.length&&this.writeMessage(u,nhe,l)},writePackedFloat:function(u,l){l.length&&this.writeMessage(u,the,l)},writePackedDouble:function(u,l){l.length&&this.writeMessage(u,rhe,l)},writePackedFixed32:function(u,l){l.length&&this.writeMessage(u,ihe,l)},writePackedSFixed32:function(u,l){l.length&&this.writeMessage(u,ohe,l)},writePackedFixed64:function(u,l){l.length&&this.writeMessage(u,ahe,l)},writePackedSFixed64:function(u,l){l.length&&this.writeMessage(u,she,l)},writeBytesField:function(u,l){this.writeTag(u,Hn.Bytes),this.writeBytes(l)},writeFixed32Field:function(u,l){this.writeTag(u,Hn.Fixed32),this.writeFixed32(l)},writeSFixed32Field:function(u,l){this.writeTag(u,Hn.Fixed32),this.writeSFixed32(l)},writeFixed64Field:function(u,l){this.writeTag(u,Hn.Fixed64),this.writeFixed64(l)},writeSFixed64Field:function(u,l){this.writeTag(u,Hn.Fixed64),this.writeSFixed64(l)},writeVarintField:function(u,l){this.writeTag(u,Hn.Varint),this.writeVarint(l)},writeSVarintField:function(u,l){this.writeTag(u,Hn.Varint),this.writeSVarint(l)},writeStringField:function(u,l){this.writeTag(u,Hn.Bytes),this.writeString(l)},writeFloatField:function(u,l){this.writeTag(u,Hn.Fixed32),this.writeFloat(l)},writeDoubleField:function(u,l){this.writeTag(u,Hn.Fixed64),this.writeDouble(l)},writeBooleanField:function(u,l){this.writeVarintField(u,!!l)}};class oM{constructor(l,{pixelRatio:c,version:d,stretchX:y,stretchY:_,content:w}){this.paddedRect=l,this.pixelRatio=c,this.stretchX=y,this.stretchY=_,this.content=w,this.version=d}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class rW{constructor(l,c){const d={},y={};this.haveRenderCallbacks=[];const _=[];this.addImages(l,d,_),this.addImages(c,y,_);const{w,h:C}=iM(_),O=new Oa({width:w||1,height:C||1});for(const k in l){const M=l[k],N=d[k].paddedRect;Oa.copy(M.data,O,{x:0,y:0},{x:N.x+1,y:N.y+1},M.data)}for(const k in c){const M=c[k],N=y[k].paddedRect,B=N.x+1,W=N.y+1,Y=M.data.width,J=M.data.height;Oa.copy(M.data,O,{x:0,y:0},{x:B,y:W},M.data),Oa.copy(M.data,O,{x:0,y:J-1},{x:B,y:W-1},{width:Y,height:1}),Oa.copy(M.data,O,{x:0,y:0},{x:B,y:W+J},{width:Y,height:1}),Oa.copy(M.data,O,{x:Y-1,y:0},{x:B-1,y:W},{width:1,height:J}),Oa.copy(M.data,O,{x:0,y:0},{x:B+Y,y:W},{width:1,height:J})}this.image=O,this.iconPositions=d,this.patternPositions=y}addImages(l,c,d){for(const y in l){const _=l[y],w={x:0,y:0,w:_.data.width+2,h:_.data.height+2};d.push(w),c[y]=new oM(w,_),_.hasRenderCallback&&this.haveRenderCallbacks.push(y)}}patchUpdatedImages(l,c){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(d=>l.hasImage(d)),l.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const d in l.updatedImages)this.patchUpdatedImage(this.iconPositions[d],l.getImage(d),c),this.patchUpdatedImage(this.patternPositions[d],l.getImage(d),c)}patchUpdatedImage(l,c,d){if(!l||!c||l.version===c.version)return;l.version=c.version;const[y,_]=l.tl;d.update(c.data,void 0,{x:y,y:_})}}tr(oM,"ImagePosition"),tr(rW,"ImageAtlas");const Ya={horizontal:1,vertical:2,horizontalOnly:3};class bw{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(l,c){const d=new bw;return d.scale=l||1,d.fontStack=c,d}static forImage(l){const c=new bw;return c.imageName=l,c}}class ty{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(l,c){const d=new ty;for(let y=0;y<l.sections.length;y++){const _=l.sections[y];_.image?d.addImageSection(_):d.addTextSection(_,c)}return d}length(){return this.text.length}getSection(l){return this.sections[this.sectionIndex[l]]}getSections(){return this.sections}getSectionIndex(l){return this.sectionIndex[l]}getCharCode(l){return this.text.charCodeAt(l)}verticalizePunctuation(l){this.text=function(c,d){let y="";for(let _=0;_<c.length;_++){const w=c.charCodeAt(_+1)||null,C=c.charCodeAt(_-1)||null;y+=!d&&(w&&L(w)&&!vw[c[_+1]]||C&&L(C)&&!vw[c[_-1]])||!vw[c[_]]?c[_]:vw[c[_]]}return y}(this.text,l)}trim(){let l=0;for(let d=0;d<this.text.length&&KE[this.text.charCodeAt(d)];d++)l++;let c=this.text.length;for(let d=this.text.length-1;d>=0&&d>=l&&KE[this.text.charCodeAt(d)];d--)c--;this.text=this.text.substring(l,c),this.sectionIndex=this.sectionIndex.slice(l,c)}substring(l,c){const d=new ty;return d.text=this.text.substring(l,c),d.sectionIndex=this.sectionIndex.slice(l,c),d.sections=this.sections,d}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((l,c)=>Math.max(l,this.sections[c].scale),0)}addTextSection(l,c){this.text+=l.text,this.sections.push(bw.forText(l.scale,l.fontStack||c));const d=this.sections.length-1;for(let y=0;y<l.text.length;++y)this.sectionIndex.push(d)}addImageSection(l){const c=l.image?l.image.name:"";if(c.length===0)return void Ft("Can't add FormattedSection with an empty image.");const d=this.getNextImageSectionCharCode();d?(this.text+=String.fromCharCode(d),this.sections.push(bw.forImage(c)),this.sectionIndex.push(this.sections.length-1)):Ft("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function aM(u,l,c,d,y,_,w,C,O,k,M,N,B,W,Y){const J=ty.fromFeature(u,y);N===Ya.vertical&&J.verticalizePunctuation(B);let ie=[];const pe=function(Te,lt,it,vt,$t,ht){if(!Te)return[];const bt=[],St=function(Wt,xr,Zt,ar,Yt,Tr){let Zr=0;for(let Yr=0;Yr<Wt.length();Yr++){const Wr=Wt.getSection(Yr);Zr+=nW(Wt.getCharCode(Yr),Wr,ar,Yt,xr,Tr)}return Zr/Math.max(1,Math.ceil(Zr/Zt))}(Te,lt,it,vt,$t,ht),Pt=Te.text.indexOf("")>=0;let Nt=0;for(let Wt=0;Wt<Te.length();Wt++){const xr=Te.getSection(Wt),Zt=Te.getCharCode(Wt);if(KE[Zt]||(Nt+=nW(Zt,xr,vt,$t,lt,ht)),Wt<Te.length()-1){const ar=!((dt=Zt)<11904||!(mE(dt)||jm(dt)||v(dt)||xE(dt)||vE(dt)||pE(dt)||yE(dt)||Qh(dt)||_E(dt)||Xb(dt)||gE(dt)||b(dt)||Bm(dt)||Kb(dt)||Yb(dt)||qb(dt)||of(dt)||ed(dt)||wE(dt)||bE(dt)));(fhe[Zt]||ar||xr.imageName)&&bt.push(oW(Wt+1,Nt,St,bt,hhe(Zt,Te.getCharCode(Wt+1),ar&&Pt),!1))}}var dt;return aW(oW(Te.length(),Nt,St,bt,0,!0))}(J,k,_,l,d,W),{processBidirectionalText:Ce,processStyledBidirectionalText:he}=De;if(Ce&&J.sections.length===1){const Te=Ce(J.toString(),pe);for(const lt of Te){const it=new ty;it.text=lt,it.sections=J.sections;for(let vt=0;vt<lt.length;vt++)it.sectionIndex.push(0);ie.push(it)}}else if(he){const Te=he(J.text,J.sectionIndex,pe);for(const lt of Te){const it=new ty;it.text=lt[0],it.sectionIndex=lt[1],it.sections=J.sections,ie.push(it)}}else ie=function(Te,lt){const it=[],vt=Te.text;let $t=0;for(const ht of lt)it.push(Te.substring($t,ht)),$t=ht;return $t<vt.length&&it.push(Te.substring($t,vt.length)),it}(J,pe);const Se=[],ke={positionedLines:Se,text:J.toString(),top:M[1],bottom:M[1],left:M[0],right:M[0],writingMode:N,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(Te,lt,it,vt,$t,ht,bt,St,Pt,Nt,dt,Wt){let xr=0,Zt=0,ar=0;const Yt=St==="right"?1:St==="left"?0:.5;let Tr=!1;for(const Dr of $t){const Jr=Dr.getSections();for(const An of Jr){if(An.imageName)continue;const Kn=lt[An.fontStack];if(Kn&&(Tr=Kn.ascender!==void 0&&Kn.descender!==void 0,!Tr))break}if(!Tr)break}let Zr=0;for(const Dr of $t){Dr.trim();const Jr=Dr.getMaxScale(),An=(Jr-1)*Eo,Kn={positionedGlyphs:[],lineOffset:0};Te.positionedLines[Zr]=Kn;const Vn=Kn.positionedGlyphs;let qn=0;if(!Dr.length()){Zt+=ht,++Zr;continue}let Jn=0,pi=0;for(let kn=0;kn<Dr.length();kn++){const Fi=Dr.getSection(kn),ki=Dr.getSectionIndex(kn),bn=Dr.getCharCode(kn);let ai=Fi.scale,Gi=null,In=null,xi=null,$o=Eo,co=0;const fo=!(Pt===Ya.horizontal||!dt&&!I(bn)||dt&&(KE[bn]||(Yr=bn,Jh(Yr)||dE(Yr)||Gb(Yr)||zm(Yr)||m(Yr))));if(Fi.imageName){const Yo=vt[Fi.imageName];if(!Yo)continue;xi=Fi.imageName,Te.iconsInText=Te.iconsInText||!0,In=Yo.paddedRect;const ho=Yo.displaySize;ai=ai*Eo/Wt,Gi={width:ho[0],height:ho[1],left:1,top:-3,advance:fo?ho[1]:ho[0],localGlyph:!1},co=Tr?-Gi.height*ai:Jr*Eo-17-ho[1]*ai,$o=Gi.advance;const Pu=(fo?ho[0]:ho[1])*ai-Eo*Jr;Pu>0&&Pu>qn&&(qn=Pu)}else{const Yo=it[Fi.fontStack];if(!Yo)continue;Yo[bn]&&(In=Yo[bn]);const ho=lt[Fi.fontStack];if(!ho)continue;const Pu=ho.glyphs[bn];if(!Pu)continue;if(Gi=Pu.metrics,$o=bn!==8203?Eo:0,Tr){const ay=ho.ascender!==void 0?Math.abs(ho.ascender):0,Rw=ho.descender!==void 0?Math.abs(ho.descender):0,kw=(ay+Rw)*ai;Jn<kw&&(Jn=kw,pi=(ay-Rw)/2*ai),co=-ay*ai}else co=(Jr-ai)*Eo-17}fo?(Te.verticalizable=!0,Vn.push({glyph:bn,imageName:xi,x:xr,y:Zt+co,vertical:fo,scale:ai,localGlyph:Gi.localGlyph,fontStack:Fi.fontStack,sectionIndex:ki,metrics:Gi,rect:In}),xr+=$o*ai+Nt):(Vn.push({glyph:bn,imageName:xi,x:xr,y:Zt+co,vertical:fo,scale:ai,localGlyph:Gi.localGlyph,fontStack:Fi.fontStack,sectionIndex:ki,metrics:Gi,rect:In}),xr+=Gi.advance*ai+Nt)}Vn.length!==0&&(ar=Math.max(xr-Nt,ar),Tr?sW(Vn,Yt,qn,pi,ht*Jr/2):sW(Vn,Yt,qn,0,ht/2)),xr=0;const uo=ht*Jr+qn;Kn.lineOffset=Math.max(qn,An),Zt+=uo,++Zr}var Yr;const Wr=Zt,{horizontalAlign:Rr,verticalAlign:Rn}=sM(bt);(function(Dr,Jr,An,Kn,Vn,qn){const Jn=(Jr-An)*Vn,pi=-qn*Kn;for(const uo of Dr)for(const kn of uo.positionedGlyphs)kn.x+=Jn,kn.y+=pi})(Te.positionedLines,Yt,Rr,Rn,ar,Wr),Te.top+=-Rn*Wr,Te.bottom=Te.top+Wr,Te.left+=-Rr*ar,Te.right=Te.left+ar,Te.hasBaseline=Tr}(ke,l,c,d,ie,w,C,O,N,k,B,Y),!function(Te){for(const lt of Te)if(lt.positionedGlyphs.length!==0)return!1;return!0}(Se)&&ke}const KE={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},fhe={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function nW(u,l,c,d,y,_){if(l.imageName){const w=d[l.imageName];return w?w.displaySize[0]*l.scale*Eo/_+y:0}{const w=c[l.fontStack],C=w&&w.glyphs[u];return C?C.metrics.advance*l.scale+y:0}}function iW(u,l,c,d){const y=Math.pow(u-l,2);return d?u<l?y/2:2*y:y+Math.abs(c)*c}function hhe(u,l,c){let d=0;return u===10&&(d-=1e4),c&&(d+=150),u!==40&&u!==65288||(d+=50),l!==41&&l!==65289||(d+=50),d}function oW(u,l,c,d,y,_){let w=null,C=iW(l,c,y,_);for(const O of d){const k=iW(l-O.x,c,y,_)+O.badness;k<=C&&(w=O,C=k)}return{index:u,x:l,priorBreak:w,badness:C}}function aW(u){return u?aW(u.priorBreak).concat(u.index):[]}function sM(u){let l=.5,c=.5;switch(u){case"right":case"top-right":case"bottom-right":l=1;break;case"left":case"top-left":case"bottom-left":l=0}switch(u){case"bottom":case"bottom-right":case"bottom-left":c=1;break;case"top":case"top-right":case"top-left":c=0}return{horizontalAlign:l,verticalAlign:c}}function sW(u,l,c,d,y){if(!(l||c||d||y))return;const _=u.length-1,w=u[_],C=(w.x+w.metrics.advance*w.scale)*l;for(let O=0;O<=_;O++)u[O].x-=C,u[O].y+=c+d+y}function dhe(u,l,c){const{horizontalAlign:d,verticalAlign:y}=sM(c),_=l[0]-u.displaySize[0]*d,w=l[1]-u.displaySize[1]*y;return{image:u,top:w,bottom:w+u.displaySize[1],left:_,right:_+u.displaySize[0]}}function lW(u,l,c,d,y,_){const w=u.image;let C;if(w.content){const ie=w.content,pe=w.pixelRatio||1;C=[ie[0]/pe,ie[1]/pe,w.displaySize[0]-ie[2]/pe,w.displaySize[1]-ie[3]/pe]}const O=l.left*_,k=l.right*_;let M,N,B,W;c==="width"||c==="both"?(W=y[0]+O-d[3],N=y[0]+k+d[1]):(W=y[0]+(O+k-w.displaySize[0])/2,N=W+w.displaySize[0]);const Y=l.top*_,J=l.bottom*_;return c==="height"||c==="both"?(M=y[1]+Y-d[0],B=y[1]+J+d[2]):(M=y[1]+(Y+J-w.displaySize[1])/2,B=M+w.displaySize[1]),{image:w,top:M,right:N,bottom:B,left:W,collisionPadding:C}}class ku extends K{constructor(l,c,d,y,_){super(l,c),this.angle=y,this.z=d,_!==void 0&&(this.segment=_)}clone(){return new ku(this.x,this.y,this.z,this.angle,this.segment)}}function uW(u,l,c,d,y){if(l.segment===void 0)return!0;let _=l,w=l.segment+1,C=0;for(;C>-c/2;){if(w--,w<0)return!1;C-=u[w].dist(_),_=u[w]}C+=u[w].dist(u[w+1]),w++;const O=[];let k=0;for(;C<c/2;){const M=u[w],N=u[w+1];if(!N)return!1;let B=u[w-1].angleTo(M)-M.angleTo(N);for(B=Math.abs((B+3*Math.PI)%(2*Math.PI)-Math.PI),O.push({distance:C,angleDelta:B}),k+=B;C-O[0].distance>d;)k-=O.shift().angleDelta;if(k>y)return!1;w++,C+=M.dist(N)}return!0}function cW(u){let l=0;for(let c=0;c<u.length-1;c++)l+=u[c].dist(u[c+1]);return l}function fW(u,l,c){return u?.6*l*c:0}function hW(u,l){return Math.max(u?u.right-u.left:0,l?l.right-l.left:0)}function phe(u,l,c,d,y,_){const w=fW(c,y,_),C=hW(c,d)*_;let O=0;const k=cW(u)/2;for(let M=0;M<u.length-1;M++){const N=u[M],B=u[M+1],W=N.dist(B);if(O+W>k){const Y=(k-O)/W,J=mn(N.x,B.x,Y),ie=mn(N.y,B.y,Y),pe=new ku(J,ie,0,B.angleTo(N),M);return!w||uW(u,pe,C,w,l)?pe:void 0}O+=W}}function mhe(u,l,c,d,y,_,w,C,O){const k=fW(d,_,w),M=hW(d,y),N=M*w,B=u[0].x===0||u[0].x===O||u[0].y===0||u[0].y===O;return l-N<l/4&&(l=N+l/4),dW(u,B?l/2*C%l:(M/2+2*_)*w*C%l,l,k,c,N,B,!1,O)}function dW(u,l,c,d,y,_,w,C,O){const k=_/2,M=cW(u);let N=0,B=l-c,W=[];for(let Y=0;Y<u.length-1;Y++){const J=u[Y],ie=u[Y+1],pe=J.dist(ie),Ce=ie.angleTo(J);for(;B+c<N+pe;){B+=c;const he=(B-N)/pe,Se=mn(J.x,ie.x,he),ke=mn(J.y,ie.y,he);if(Se>=0&&Se<O&&ke>=0&&ke<O&&B-k>=0&&B+k<=M){const Te=new ku(Se,ke,0,Ce,Y);Te._round(),d&&!uW(u,Te,_,d,y)||W.push(Te)}}N+=pe}return C||W.length||w||(W=dW(u,N/2,c,d,y,_,w,!0,O)),W}function pW(u,l,c,d,y){const _=[];for(let w=0;w<u.length;w++){const C=u[w];let O;for(let k=0;k<C.length-1;k++){let M=C[k],N=C[k+1];M.x<l&&N.x<l||(M.x<l?M=new K(l,M.y+(l-M.x)/(N.x-M.x)*(N.y-M.y))._round():N.x<l&&(N=new K(l,M.y+(l-M.x)/(N.x-M.x)*(N.y-M.y))._round()),M.y<c&&N.y<c||(M.y<c?M=new K(M.x+(c-M.y)/(N.y-M.y)*(N.x-M.x),c)._round():N.y<c&&(N=new K(M.x+(c-M.y)/(N.y-M.y)*(N.x-M.x),c)._round()),M.x>=d&&N.x>=d||(M.x>=d?M=new K(d,M.y+(d-M.x)/(N.x-M.x)*(N.y-M.y))._round():N.x>=d&&(N=new K(d,M.y+(d-M.x)/(N.x-M.x)*(N.y-M.y))._round()),M.y>=y&&N.y>=y||(M.y>=y?M=new K(M.x+(y-M.y)/(N.y-M.y)*(N.x-M.x),y)._round():N.y>=y&&(N=new K(M.x+(y-M.y)/(N.y-M.y)*(N.x-M.x),y)._round()),O&&M.equals(O[O.length-1])||(O=[M],_.push(O)),O.push(N)))))}}return _}tr(ku,"Anchor");const ww=1e20;function mW(u,l,c,d,y,_,w,C,O){for(let k=l;k<l+d;k++)yW(u,c*_+k,_,y,w,C,O);for(let k=c;k<c+y;k++)yW(u,k*_+l,1,d,w,C,O)}function yW(u,l,c,d,y,_,w){_[0]=0,w[0]=-ww,w[1]=ww,y[0]=u[l];for(let C=1,O=0,k=0;C<d;C++){y[C]=u[l+C*c];const M=C*C;do{const N=_[O];k=(y[C]-y[N]+M-N*N)/(C-N)/2}while(k<=w[O]&&--O>-1);O++,_[O]=C,w[O]=k,w[O+1]=ww}for(let C=0,O=0;C<d;C++){for(;w[O+1]<C;)O++;const k=_[O],M=C-k;u[l+C*c]=y[k]+M*M}}const lM={none:0,ideographs:1,all:2};class ry{constructor(l,c,d){this.requestManager=l,this.localGlyphMode=c,this.localFontFamily=d,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(l){this.url=l}getGlyphs(l,c){const d=[];for(const y in l)for(const _ of l[y])d.push({stack:y,id:_});ae(d,({stack:y,id:_},w)=>{let C=this.entries[y];C||(C=this.entries[y]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let O=C.glyphs[_];if(O!==void 0)return void w(null,{stack:y,id:_,glyph:O});if(O=this._tinySDF(C,y,_),O)return C.glyphs[_]=O,void w(null,{stack:y,id:_,glyph:O});const k=Math.floor(_/256);if(256*k>65535)return void w(new Error("glyphs > 65535 not supported"));if(C.ranges[k])return void w(null,{stack:y,id:_,glyph:O});let M=C.requests[k];M||(M=C.requests[k]=[],ry.loadGlyphRange(y,k,this.url,this.requestManager,(N,B)=>{if(B){C.ascender=B.ascender,C.descender=B.descender;for(const W in B.glyphs)this._doesCharSupportLocalGlyph(+W)||(C.glyphs[+W]=B.glyphs[+W]);C.ranges[k]=!0}for(const W of M)W(N,B);delete C.requests[k]})),M.push((N,B)=>{N?w(N):B&&w(null,{stack:y,id:_,glyph:B.glyphs[_]||null})})},(y,_)=>{if(y)c(y);else if(_){const w={};for(const{stack:C,id:O,glyph:k}of _)w[C]===void 0&&(w[C]={}),w[C].glyphs===void 0&&(w[C].glyphs={}),w[C].glyphs[O]=k&&{id:k.id,bitmap:k.bitmap.clone(),metrics:k.metrics},w[C].ascender=this.entries[C].ascender,w[C].descender=this.entries[C].descender;c(null,w)}})}_doesCharSupportLocalGlyph(l){return this.localGlyphMode!==lM.none&&(this.localGlyphMode===lM.all?!!this.localFontFamily:!!this.localFontFamily&&(Xb(l)||SE(l)||Bm(l)||of(l)||Qh(l)))}_tinySDF(l,c,d){const y=this.localFontFamily;if(!y||!this._doesCharSupportLocalGlyph(d))return;let _=l.tinySDF;if(!_){let J="400";/bold/i.test(c)?J="900":/medium/i.test(c)?J="500":/light/i.test(c)&&(J="200"),_=l.tinySDF=new ry.TinySDF({fontFamily:y,fontWeight:J,fontSize:48,buffer:6,radius:16}),_.fontWeight=J}if(this.localGlyphs[_.fontWeight][d])return this.localGlyphs[_.fontWeight][d];const w=String.fromCharCode(d),{data:C,width:O,height:k,glyphWidth:M,glyphHeight:N,glyphLeft:B,glyphTop:W,glyphAdvance:Y}=_.draw(w);return this.localGlyphs[_.fontWeight][d]={id:d,bitmap:new Ou({width:O,height:k},C),metrics:{width:M/2,height:N/2,left:B/2,top:W/2-27,advance:Y/2,localGlyph:!0}}}}function gW(u,l,c,d){const y=[],_=u.image,w=_.pixelRatio,C=_.paddedRect.w-2,O=_.paddedRect.h-2,k=u.right-u.left,M=u.bottom-u.top,N=_.stretchX||[[0,C]],B=_.stretchY||[[0,O]],W=(ht,bt)=>ht+bt[1]-bt[0],Y=N.reduce(W,0),J=B.reduce(W,0),ie=C-Y,pe=O-J;let Ce=0,he=Y,Se=0,ke=J,Te=0,lt=ie,it=0,vt=pe;if(_.content&&d){const ht=_.content;Ce=qE(N,0,ht[0]),Se=qE(B,0,ht[1]),he=qE(N,ht[0],ht[2]),ke=qE(B,ht[1],ht[3]),Te=ht[0]-Ce,it=ht[1]-Se,lt=ht[2]-ht[0]-he,vt=ht[3]-ht[1]-ke}const $t=(ht,bt,St,Pt)=>{const Nt=XE(ht.stretch-Ce,he,k,u.left),dt=ZE(ht.fixed-Te,lt,ht.stretch,Y),Wt=XE(bt.stretch-Se,ke,M,u.top),xr=ZE(bt.fixed-it,vt,bt.stretch,J),Zt=XE(St.stretch-Ce,he,k,u.left),ar=ZE(St.fixed-Te,lt,St.stretch,Y),Yt=XE(Pt.stretch-Se,ke,M,u.top),Tr=ZE(Pt.fixed-it,vt,Pt.stretch,J),Zr=new K(Nt,Wt),Yr=new K(Zt,Wt),Wr=new K(Zt,Yt),Rr=new K(Nt,Yt),Rn=new K(dt/w,xr/w),Dr=new K(ar/w,Tr/w),Jr=l*Math.PI/180;if(Jr){const Vn=Math.sin(Jr),qn=Math.cos(Jr),Jn=[qn,-Vn,Vn,qn];Zr._matMult(Jn),Yr._matMult(Jn),Rr._matMult(Jn),Wr._matMult(Jn)}const An=ht.stretch+ht.fixed,Kn=bt.stretch+bt.fixed;return{tl:Zr,tr:Yr,bl:Rr,br:Wr,tex:{x:_.paddedRect.x+1+An,y:_.paddedRect.y+1+Kn,w:St.stretch+St.fixed-An,h:Pt.stretch+Pt.fixed-Kn},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Rn,pixelOffsetBR:Dr,minFontScaleX:lt/w/k,minFontScaleY:vt/w/M,isSDF:c}};if(d&&(_.stretchX||_.stretchY)){const ht=vW(N,ie,Y),bt=vW(B,pe,J);for(let St=0;St<ht.length-1;St++){const Pt=ht[St],Nt=ht[St+1];for(let dt=0;dt<bt.length-1;dt++)y.push($t(Pt,bt[dt],Nt,bt[dt+1]))}}else y.push($t({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:C+1},{fixed:0,stretch:O+1}));return y}function qE(u,l,c){let d=0;for(const y of u)d+=Math.max(l,Math.min(c,y[1]))-Math.max(l,Math.min(c,y[0]));return d}function vW(u,l,c){const d=[{fixed:-1,stretch:0}];for(const[y,_]of u){const w=d[d.length-1];d.push({fixed:y-w.stretch,stretch:w.stretch}),d.push({fixed:y-w.stretch,stretch:w.stretch+(_-y)})}return d.push({fixed:l+1,stretch:c}),d}function XE(u,l,c,d){return u/l*c+d}function ZE(u,l,c,d){return u-l*c/d}function yhe(u,l,c,d){const y=l+u.positionedLines[d].lineOffset;return d===0?c+y/2:c+(y+(l+u.positionedLines[d-1].lineOffset))/2}ry.loadGlyphRange=function(u,l,c,d,y){const _=256*l,w=_+255,C=d.transformRequest(d.normalizeGlyphsURL(c).replace("{fontstack}",u).replace("{range}",`${_}-${w}`),ft.Glyphs);Pr(C,(O,k)=>{if(O)y(O);else if(k){const M={},N=function(B){return new _w(B).readFields(lhe,{})}(k);for(const B of N.glyphs)M[B.id]=B;y(null,{glyphs:M,ascender:N.ascender,descender:N.descender})}})},ry.TinySDF=class{constructor({fontSize:u=24,buffer:l=3,radius:c=8,cutoff:d=.25,fontFamily:y="sans-serif",fontWeight:_="normal",fontStyle:w="normal"}={}){this.buffer=l,this.cutoff=d,this.radius=c;const C=this.size=u+4*l,O=this._createCanvas(C),k=this.ctx=O.getContext("2d",{willReadFrequently:!0});k.font=`${w} ${_} ${u}px ${y}`,k.textBaseline="alphabetic",k.textAlign="left",k.fillStyle="black",this.gridOuter=new Float64Array(C*C),this.gridInner=new Float64Array(C*C),this.f=new Float64Array(C),this.z=new Float64Array(C+1),this.v=new Uint16Array(C)}_createCanvas(u){const l=document.createElement("canvas");return l.width=l.height=u,l}draw(u){const{width:l,actualBoundingBoxAscent:c,actualBoundingBoxDescent:d,actualBoundingBoxLeft:y,actualBoundingBoxRight:_}=this.ctx.measureText(u),w=Math.ceil(c),C=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(_-y))),O=Math.min(this.size-this.buffer,w+Math.ceil(d)),k=C+2*this.buffer,M=O+2*this.buffer,N=Math.max(k*M,0),B=new Uint8ClampedArray(N),W={data:B,width:k,height:M,glyphWidth:C,glyphHeight:O,glyphTop:w,glyphLeft:0,glyphAdvance:l};if(C===0||O===0)return W;const{ctx:Y,buffer:J,gridInner:ie,gridOuter:pe}=this;Y.clearRect(J,J,C,O),Y.fillText(u,J,J+w);const Ce=Y.getImageData(J,J,C,O);pe.fill(ww,0,N),ie.fill(0,0,N);for(let he=0;he<O;he++)for(let Se=0;Se<C;Se++){const ke=Ce.data[4*(he*C+Se)+3]/255;if(ke===0)continue;const Te=(he+J)*k+Se+J;if(ke===1)pe[Te]=0,ie[Te]=ww;else{const lt=.5-ke;pe[Te]=lt>0?lt*lt:0,ie[Te]=lt<0?lt*lt:0}}mW(pe,0,0,k,M,k,this.f,this.v,this.z),mW(ie,J,J,C,O,k,this.f,this.v,this.z);for(let he=0;he<N;he++){const Se=Math.sqrt(pe[he])-Math.sqrt(ie[he]);B[he]=Math.round(255-255*(Se/this.radius+this.cutoff))}return W}};class ghe{constructor(l=[],c=vhe){if(this.data=l,this.length=this.data.length,this.compare=c,this.length>0)for(let d=(this.length>>1)-1;d>=0;d--)this._down(d)}push(l){this.data.push(l),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const l=this.data[0],c=this.data.pop();return this.length--,this.length>0&&(this.data[0]=c,this._down(0)),l}peek(){return this.data[0]}_up(l){const{data:c,compare:d}=this,y=c[l];for(;l>0;){const _=l-1>>1,w=c[_];if(d(y,w)>=0)break;c[l]=w,l=_}c[l]=y}_down(l){const{data:c,compare:d}=this,y=this.length>>1,_=c[l];for(;l<y;){let w=1+(l<<1),C=c[w];const O=w+1;if(O<this.length&&d(c[O],C)<0&&(w=O,C=c[O]),d(C,_)>=0)break;c[l]=C,l=w}c[l]=_}}function vhe(u,l){return u<l?-1:u>l?1:0}function _he(u,l=1,c=!1){let d=1/0,y=1/0,_=-1/0,w=-1/0;const C=u[0];for(let W=0;W<C.length;W++){const Y=C[W];(!W||Y.x<d)&&(d=Y.x),(!W||Y.y<y)&&(y=Y.y),(!W||Y.x>_)&&(_=Y.x),(!W||Y.y>w)&&(w=Y.y)}const O=Math.min(_-d,w-y);let k=O/2;const M=new ghe([],bhe);if(O===0)return new K(d,y);for(let W=d;W<_;W+=O)for(let Y=y;Y<w;Y+=O)M.push(new ny(W+k,Y+k,k,u));let N=function(W){let Y=0,J=0,ie=0;const pe=W[0];for(let Ce=0,he=pe.length,Se=he-1;Ce<he;Se=Ce++){const ke=pe[Ce],Te=pe[Se],lt=ke.x*Te.y-Te.x*ke.y;J+=(ke.x+Te.x)*lt,ie+=(ke.y+Te.y)*lt,Y+=3*lt}return new ny(J/Y,ie/Y,0,W)}(u),B=M.length;for(;M.length;){const W=M.pop();(W.d>N.d||!N.d)&&(N=W,c&&console.log("found best %d after %d probes",Math.round(1e4*W.d)/1e4,B)),W.max-N.d<=l||(k=W.h/2,M.push(new ny(W.p.x-k,W.p.y-k,k,u)),M.push(new ny(W.p.x+k,W.p.y-k,k,u)),M.push(new ny(W.p.x-k,W.p.y+k,k,u)),M.push(new ny(W.p.x+k,W.p.y+k,k,u)),B+=4)}return c&&(console.log(`num probes: ${B}`),console.log(`best distance: ${N.d}`)),N.p}function bhe(u,l){return l.max-u.max}class ny{constructor(l,c,d,y){this.p=new K(l,c),this.h=d,this.d=function(_,w){let C=!1,O=1/0;for(let k=0;k<w.length;k++){const M=w[k];for(let N=0,B=M.length,W=B-1;N<B;W=N++){const Y=M[N],J=M[W];Y.y>_.y!=J.y>_.y&&_.x<(J.x-Y.x)*(_.y-Y.y)/(J.y-Y.y)+Y.x&&(C=!C),O=Math.min(O,y4(_,Y,J))}}return(C?1:-1)*Math.sqrt(O)}(this.p,y),this.max=this.d+this.h*Math.SQRT2}}const uM=Number.POSITIVE_INFINITY,whe=Math.sqrt(2);function _W(u,[l,c]){let d=0,y=0;if(c===uM){l<0&&(l=0);const _=l/whe;switch(u){case"top-right":case"top-left":y=_-7;break;case"bottom-right":case"bottom-left":y=7-_;break;case"bottom":y=7-l;break;case"top":y=l-7}switch(u){case"top-right":case"bottom-right":d=-_;break;case"top-left":case"bottom-left":d=_;break;case"left":d=l;break;case"right":d=-l}}else{switch(l=Math.abs(l),c=Math.abs(c),u){case"top-right":case"top-left":case"top":y=c-7;break;case"bottom-right":case"bottom-left":case"bottom":y=7-c}switch(u){case"top-right":case"bottom-right":case"right":d=-l;break;case"top-left":case"bottom-left":case"left":d=l}}return[d,y]}function She(u,l,c,d,y,_,w,C,O,k){u.createArrays(),u.tilePixelRatio=kr/(512*u.overscaling),u.compareText={},u.iconsNeedLinear=!1;const M=u.layers[0].layout,N=u.layers[0]._unevaluatedLayout._values,B={};if(u.textSizeData.kind==="composite"){const{minZoom:J,maxZoom:ie}=u.textSizeData;B.compositeTextSizes=[N["text-size"].possiblyEvaluate(new Xe(J),C),N["text-size"].possiblyEvaluate(new Xe(ie),C)]}if(u.iconSizeData.kind==="composite"){const{minZoom:J,maxZoom:ie}=u.iconSizeData;B.compositeIconSizes=[N["icon-size"].possiblyEvaluate(new Xe(J),C),N["icon-size"].possiblyEvaluate(new Xe(ie),C)]}B.layoutTextSize=N["text-size"].possiblyEvaluate(new Xe(O+1),C),B.layoutIconSize=N["icon-size"].possiblyEvaluate(new Xe(O+1),C),B.textMaxSize=N["text-size"].possiblyEvaluate(new Xe(18),C);const W=M.get("text-rotation-alignment")==="map"&&M.get("symbol-placement")!=="point",Y=M.get("text-size");for(const J of u.features){const ie=M.get("text-font").evaluate(J,{},C).join(","),pe=Y.evaluate(J,{},C),Ce=B.layoutTextSize.evaluate(J,{},C),he=(B.layoutIconSize.evaluate(J,{},C),{horizontal:{},vertical:void 0}),Se=J.text;let ke,Te=[0,0];if(Se){const vt=Se.toString(),$t=M.get("text-letter-spacing").evaluate(J,{},C)*Eo,ht=M.get("text-line-height").evaluate(J,{},C)*Eo,bt=E(vt)?$t:0,St=M.get("text-anchor").evaluate(J,{},C),Pt=M.get("text-variable-anchor");if(!Pt){const Zt=M.get("text-radial-offset").evaluate(J,{},C);Te=Zt?_W(St,[Zt*Eo,uM]):M.get("text-offset").evaluate(J,{},C).map(ar=>ar*Eo)}let Nt=W?"center":M.get("text-justify").evaluate(J,{},C);const dt=M.get("symbol-placement")==="point",Wt=dt?M.get("text-max-width").evaluate(J,{},C)*Eo:1/0,xr=Zt=>{u.allowVerticalPlacement&&x(vt)&&(he.vertical=aM(Se,l,c,y,ie,Wt,ht,St,Zt,bt,Te,Ya.vertical,!0,Ce,pe))};if(!W&&Pt){const Zt=Nt==="auto"?Pt.map(Yt=>cM(Yt)):[Nt];let ar=!1;for(let Yt=0;Yt<Zt.length;Yt++){const Tr=Zt[Yt];if(!he.horizontal[Tr])if(ar)he.horizontal[Tr]=he.horizontal[0];else{const Zr=aM(Se,l,c,y,ie,Wt,ht,"center",Tr,bt,Te,Ya.horizontal,!1,Ce,pe);Zr&&(he.horizontal[Tr]=Zr,ar=Zr.positionedLines.length===1)}}xr("left")}else{if(Nt==="auto"&&(Nt=cM(St)),dt||M.get("text-writing-mode").indexOf("horizontal")>=0||!x(vt)){const Zt=aM(Se,l,c,y,ie,Wt,ht,St,Nt,bt,Te,Ya.horizontal,!1,Ce,pe);Zt&&(he.horizontal[Nt]=Zt)}xr(dt?"left":Nt)}}let lt=!1;if(J.icon&&J.icon.name){const vt=d[J.icon.name];vt&&(ke=dhe(y[J.icon.name],M.get("icon-offset").evaluate(J,{},C),M.get("icon-anchor").evaluate(J,{},C)),lt=vt.sdf,u.sdfIcons===void 0?u.sdfIcons=vt.sdf:u.sdfIcons!==vt.sdf&&Ft("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(vt.pixelRatio!==u.pixelRatio||M.get("icon-rotate").constantOr(1)!==0)&&(u.iconsNeedLinear=!0))}const it=wW(he.horizontal)||he.vertical;u.iconsInText||(u.iconsInText=!!it&&it.iconsInText),(it||ke)&&xhe(u,J,he,ke,d,B,Ce,0,Te,lt,w,C,k)}_&&u.generateCollisionDebugBuffers(O,u.collisionBoxArray)}function cM(u){switch(u){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function xhe(u,l,c,d,y,_,w,C,O,k,M,N,B){let W=_.textMaxSize.evaluate(l,{},N);W===void 0&&(W=w);const Y=u.layers[0].layout,J=Y.get("icon-offset").evaluate(l,{},N),ie=wW(c.horizontal)||c.vertical,pe=B.name==="globe",Ce=w/24,he=u.tilePixelRatio*W/24,Se=(bt=u.overscaling,u.zoom>18&&bt>2&&(bt>>=1),Math.max(kr/(512*bt),1)*Y.get("symbol-spacing")),ke=Y.get("text-padding")*u.tilePixelRatio,Te=Y.get("icon-padding")*u.tilePixelRatio,lt=Ne(Y.get("text-max-angle")),it=Y.get("text-rotation-alignment")==="map"&&Y.get("symbol-placement")!=="point",vt=Y.get("icon-rotation-alignment")==="map"&&Y.get("symbol-placement")!=="point",$t=Y.get("symbol-placement"),ht=Se/2;var bt;const St=Y.get("icon-text-fit");let Pt;d&&St!=="none"&&(u.allowVerticalPlacement&&c.vertical&&(Pt=lW(d,c.vertical,St,Y.get("icon-text-fit-padding"),J,Ce)),ie&&(d=lW(d,ie,St,Y.get("icon-text-fit-padding"),J,Ce)));const Nt=(dt,Wt,xr)=>{if(Wt.x<0||Wt.x>=kr||Wt.y<0||Wt.y>=kr)return;let Zt=null;if(pe){const{x:ar,y:Yt,z:Tr}=B.projectTilePoint(Wt.x,Wt.y,xr);Zt={anchor:new ku(ar,Yt,Tr,0,void 0),up:B.upVector(xr,Wt.x,Wt.y)}}(function(ar,Yt,Tr,Zr,Yr,Wr,Rr,Rn,Dr,Jr,An,Kn,Vn,qn,Jn,pi,uo,kn,Fi,ki,bn,ai,Gi,In,xi){const $o=ar.addToLineVertexArray(Yt,Zr);let co,fo,Yo,ho,Pu,ay,Rw,kw=0,XW=0,ZW=0,JW=0,SM=-1,xM=-1;const Nl={};let QW=td("");const dd=Tr?Tr.anchor:Yt;let CM=0,EM=0;if(Dr._unevaluatedLayout.getValue("text-radial-offset")===void 0?[CM,EM]=Dr.layout.get("text-offset").evaluate(bn,{},xi).map(Ra=>Ra*Eo):(CM=Dr.layout.get("text-radial-offset").evaluate(bn,{},xi)*Eo,EM=uM),ar.allowVerticalPlacement&&Yr.vertical){const Ra=Yr.vertical;if(Jn)ay=fM(Ra),Rn&&(Rw=fM(Rn));else{const ka=Dr.layout.get("text-rotate").evaluate(bn,{},xi)+90;Yo=JE(Jr,dd,Yt,An,Kn,Vn,Ra,qn,ka,pi),Rn&&(ho=JE(Jr,dd,Yt,An,Kn,Vn,Rn,kn,ka))}}if(Wr){const Ra=Dr.layout.get("icon-rotate").evaluate(bn,{},xi),ka=Dr.layout.get("icon-text-fit")!=="none",Pw=gW(Wr,Ra,Gi,ka),OM=Rn?gW(Rn,Ra,Gi,ka):void 0;fo=JE(Jr,dd,Yt,An,Kn,Vn,Wr,kn,Ra),kw=4*Pw.length;const e5=ar.iconSizeData;let pd=null;e5.kind==="source"?(pd=[Ml*Dr.layout.get("icon-size").evaluate(bn,{},xi)],pd[0]>ff&&Ft(`${ar.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):e5.kind==="composite"&&(pd=[Ml*ai.compositeIconSizes[0].evaluate(bn,{},xi),Ml*ai.compositeIconSizes[1].evaluate(bn,{},xi)],(pd[0]>ff||pd[1]>ff)&&Ft(`${ar.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),ar.addSymbols(ar.icon,Pw,pd,ki,Fi,bn,!1,Tr,Yt,$o.lineStartIndex,$o.lineLength,-1,In,xi),SM=ar.icon.placedSymbolArray.length-1,OM&&(XW=4*OM.length,ar.addSymbols(ar.icon,OM,pd,ki,Fi,bn,Ya.vertical,Tr,Yt,$o.lineStartIndex,$o.lineLength,-1,In,xi),xM=ar.icon.placedSymbolArray.length-1)}for(const Ra in Yr.horizontal){const ka=Yr.horizontal[Ra];co||(QW=td(ka.text),Jn?Pu=fM(ka):co=JE(Jr,dd,Yt,An,Kn,Vn,ka,qn,Dr.layout.get("text-rotate").evaluate(bn,{},xi),pi));const Pw=ka.positionedLines.length===1;if(ZW+=bW(ar,Tr,Yt,ka,Rr,Dr,Jn,bn,pi,$o,Yr.vertical?Ya.horizontal:Ya.horizontalOnly,Pw?Object.keys(Yr.horizontal):[Ra],Nl,SM,ai,In,xi),Pw)break}Yr.vertical&&(JW+=bW(ar,Tr,Yt,Yr.vertical,Rr,Dr,Jn,bn,pi,$o,Ya.vertical,["vertical"],Nl,xM,ai,In,xi));let gf=-1;const TM=(Ra,ka)=>Ra?Math.max(Ra,ka):ka;gf=TM(Pu,gf),gf=TM(ay,gf),gf=TM(Rw,gf);const Zhe=gf>-1?1:0;ar.glyphOffsetArray.length>=df.MAX_GLYPHS&&Ft("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),bn.sortKey!==void 0&&ar.addToSortKeyRanges(ar.symbolInstances.length,bn.sortKey),ar.symbolInstances.emplaceBack(dd.x,dd.y,dd.z,Yt.x,Yt.y,Nl.right>=0?Nl.right:-1,Nl.center>=0?Nl.center:-1,Nl.left>=0?Nl.left:-1,Nl.vertical>=0?Nl.vertical:-1,SM,xM,QW,co!==void 0?co:ar.collisionBoxArray.length,co!==void 0?co+1:ar.collisionBoxArray.length,Yo!==void 0?Yo:ar.collisionBoxArray.length,Yo!==void 0?Yo+1:ar.collisionBoxArray.length,fo!==void 0?fo:ar.collisionBoxArray.length,fo!==void 0?fo+1:ar.collisionBoxArray.length,ho||ar.collisionBoxArray.length,ho?ho+1:ar.collisionBoxArray.length,An,ZW,JW,kw,XW,Zhe,0,CM,EM,gf)})(u,Wt,Zt,dt,c,d,y,Pt,u.layers[0],u.collisionBoxArray,l.index,l.sourceLayerIndex,u.index,ke,it,O,0,Te,vt,J,l,_,k,M,N)};if($t==="line")for(const dt of pW(l.geometry,0,0,kr,kr)){const Wt=mhe(dt,Se,lt,c.vertical||ie,d,24,he,u.overscaling,kr);for(const xr of Wt){const Zt=ie;Zt&&Che(u,Zt.text,ht,xr)||Nt(dt,xr,N)}}else if($t==="line-center"){for(const dt of l.geometry)if(dt.length>1){const Wt=phe(dt,lt,c.vertical||ie,d,24,he);Wt&&Nt(dt,Wt,N)}}else if(l.type==="Polygon")for(const dt of JI(l.geometry,0)){const Wt=_he(dt,16);Nt(dt[0],new ku(Wt.x,Wt.y,0,0,void 0),N)}else if(l.type==="LineString")for(const dt of l.geometry)Nt(dt,new ku(dt[0].x,dt[0].y,0,0,void 0),N);else if(l.type==="Point")for(const dt of l.geometry)for(const Wt of dt)Nt([Wt],new ku(Wt.x,Wt.y,0,0,void 0),N)}const ff=32640;function bW(u,l,c,d,y,_,w,C,O,k,M,N,B,W,Y,J,ie){const pe=function(Se,ke,Te,lt,it,vt,$t,ht){const bt=[];if(ke.positionedLines.length===0)return bt;const St=lt.layout.get("text-rotate").evaluate(vt,{})*Math.PI/180,Pt=function(Zt){const ar=Zt[0],Yt=Zt[1],Tr=ar*Yt;return Tr>0?[ar,-Yt]:Tr<0?[-ar,Yt]:ar===0?[Yt,ar]:[Yt,-ar]}(Te);let Nt=Math.abs(ke.top-ke.bottom);for(const Zt of ke.positionedLines)Nt-=Zt.lineOffset;const dt=ke.positionedLines.length,Wt=Nt/dt;let xr=ke.top-Te[1];for(let Zt=0;Zt<dt;++Zt){const ar=ke.positionedLines[Zt];xr=yhe(ke,Wt,xr,Zt);for(const Yt of ar.positionedGlyphs){if(!Yt.rect)continue;const Tr=Yt.rect||{};let Zr=4,Yr=!0,Wr=1,Rr=0;if(Yt.imageName){const In=$t[Yt.imageName];if(!In)continue;if(In.sdf){Ft("SDF images are not supported in formatted text and will be ignored.");continue}Yr=!1,Wr=In.pixelRatio,Zr=1/Wr}const Rn=(it||ht)&&Yt.vertical,Dr=Yt.metrics.advance*Yt.scale/2,Jr=Yt.metrics,An=Yt.rect;if(An===null)continue;ht&&ke.verticalizable&&(Rr=Yt.imageName?Dr-Yt.metrics.width*Yt.scale/2:0);const Kn=it?[Yt.x+Dr,Yt.y]:[0,0];let Vn=[0,0],qn=[0,0],Jn=!1;it||(Rn?(qn=[Yt.x+Dr+Pt[0],Yt.y+Pt[1]-Rr],Jn=!0):Vn=[Yt.x+Dr+Te[0],Yt.y+Te[1]-Rr]);const pi=An.w*Yt.scale/(Wr*(Yt.localGlyph?2:1)),uo=An.h*Yt.scale/(Wr*(Yt.localGlyph?2:1));let kn,Fi,ki,bn;if(Rn){const In=Yt.y-xr,xi=new K(-Dr,Dr-In),$o=-Math.PI/2,co=new K(...qn);kn=new K(-Dr+Vn[0],Vn[1]),kn._rotateAround($o,xi)._add(co),kn.x+=-In+Dr,kn.y-=(Jr.left-Zr)*Yt.scale;const fo=Yt.imageName?Jr.advance*Yt.scale:Eo*Yt.scale,Yo=String.fromCharCode(Yt.glyph);Zfe(Yo)?kn.x+=(1-Zr)*Yt.scale:Jfe(Yo)?kn.x+=fo-Jr.height*Yt.scale+(-Zr-1)*Yt.scale:kn.x+=Yt.imageName||Jr.width+2*Zr===An.w&&Jr.height+2*Zr===An.h?(fo-uo)/2:(fo-(Jr.height+2*Zr)*Yt.scale)/2,Fi=new K(kn.x,kn.y-pi),ki=new K(kn.x+uo,kn.y),bn=new K(kn.x+uo,kn.y-pi)}else{const In=(Jr.left-Zr)*Yt.scale-Dr+Vn[0],xi=(-Jr.top-Zr)*Yt.scale+Vn[1],$o=In+pi,co=xi+uo;kn=new K(In,xi),Fi=new K($o,xi),ki=new K(In,co),bn=new K($o,co)}if(St){let In;In=it?new K(0,0):Jn?new K(Pt[0],Pt[1]):new K(Te[0],Te[1]),kn._rotateAround(St,In),Fi._rotateAround(St,In),ki._rotateAround(St,In),bn._rotateAround(St,In)}const ai=new K(0,0),Gi=new K(0,0);bt.push({tl:kn,tr:Fi,bl:ki,br:bn,tex:Tr,writingMode:ke.writingMode,glyphOffset:Kn,sectionIndex:Yt.sectionIndex,isSDF:Yr,pixelOffsetTL:ai,pixelOffsetBR:Gi,minFontScaleX:0,minFontScaleY:0})}}return bt}(0,d,O,_,w,C,y,u.allowVerticalPlacement),Ce=u.textSizeData;let he=null;Ce.kind==="source"?(he=[Ml*_.layout.get("text-size").evaluate(C,{},ie)],he[0]>ff&&Ft(`${u.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):Ce.kind==="composite"&&(he=[Ml*Y.compositeTextSizes[0].evaluate(C,{},ie),Ml*Y.compositeTextSizes[1].evaluate(C,{},ie)],(he[0]>ff||he[1]>ff)&&Ft(`${u.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),u.addSymbols(u.text,pe,he,O,w,C,M,l,c,k.lineStartIndex,k.lineLength,W,J,ie);for(const Se of N)B[Se]=u.text.placedSymbolArray.length-1;return 4*pe.length}function wW(u){for(const l in u)return u[l];return null}function JE(u,l,c,d,y,_,w,C,O,k){let M=w.top,N=w.bottom,B=w.left,W=w.right;const Y=w.collisionPadding;if(Y&&(B-=Y[0],M-=Y[1],W+=Y[2],N+=Y[3]),O){const J=new K(B,M),ie=new K(W,M),pe=new K(B,N),Ce=new K(W,N),he=Ne(O);let Se=new K(0,0);k&&(Se=new K(k[0],k[1])),J._rotateAround(he,Se),ie._rotateAround(he,Se),pe._rotateAround(he,Se),Ce._rotateAround(he,Se),B=Math.min(J.x,ie.x,pe.x,Ce.x),W=Math.max(J.x,ie.x,pe.x,Ce.x),M=Math.min(J.y,ie.y,pe.y,Ce.y),N=Math.max(J.y,ie.y,pe.y,Ce.y)}return u.emplaceBack(l.x,l.y,l.z,c.x,c.y,B,M,W,N,C,d,y,_),u.length-1}function fM(u){u.collisionPadding&&(u.top-=u.collisionPadding[1],u.bottom+=u.collisionPadding[3]);const l=u.bottom-u.top;return l>0?Math.max(10,l):null}function Che(u,l,c,d){const y=u.compareText;if(l in y){const _=y[l];for(let w=_.length-1;w>=0;w--)if(d.dist(_[w])<c)return!0}else y[l]=[];return y[l].push(d),!1}function SW(u,l){const c=u.fovAboveCenter,d=u.elevation?u.elevation.getMinElevationBelowMSL()*l:0,y=(u._camera.position[2]*u.worldSize-d)/Math.cos(u._pitch),_=Math.sin(c)*y/Math.sin(Math.max(Math.PI/2-u._pitch-c,.01)),w=Math.sin(u._pitch)*_+y;return Math.min(1.01*w,y*(1/u._horizonShift))}function fd(u,l){if(!l.isReprojectedInTileSpace)return{scale:1<<u.z,x:u.x,y:u.y,x2:u.x+1,y2:u.y+1,projection:l};const c=Math.pow(2,-u.z),d=u.x*c,y=(u.x+1)*c,_=u.y*c,w=(u.y+1)*c,C=Ga(d),O=Ga(y),k=xo(_),M=xo(w),N=l.project(C,k),B=l.project(O,k),W=l.project(O,M),Y=l.project(C,M);let J=Math.min(N.x,B.x,W.x,Y.x),ie=Math.min(N.y,B.y,W.y,Y.y),pe=Math.max(N.x,B.x,W.x,Y.x),Ce=Math.max(N.y,B.y,W.y,Y.y);const he=c/16;function Se(Te,lt,it,vt,$t,ht){const bt=(it+$t)/2,St=(vt+ht)/2,Pt=l.project(Ga(bt),xo(St)),Nt=Math.max(0,J-Pt.x,ie-Pt.y,Pt.x-pe,Pt.y-Ce);J=Math.min(J,Pt.x),pe=Math.max(pe,Pt.x),ie=Math.min(ie,Pt.y),Ce=Math.max(Ce,Pt.y),Nt>he&&(Se(Te,Pt,it,vt,bt,St),Se(Pt,lt,bt,St,$t,ht))}Se(N,B,d,_,y,_),Se(B,W,y,_,y,w),Se(W,Y,y,w,d,w),Se(Y,N,d,w,d,_),J-=he,ie-=he,pe+=he,Ce+=he;const ke=1/Math.max(pe-J,Ce-ie);return{scale:ke,x:J*ke,y:ie*ke,x2:pe*ke,y2:Ce*ke,projection:l}}const Ehe=qs(new Float32Array(16));class hf{constructor(l){this.spec=l,this.name=l.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(l,c){return{x:0,y:0,z:0}}unproject(l,c){return new vn(0,0)}projectTilePoint(l,c,d){return{x:l,y:c,z:0}}locationPoint(l,c,d=!0){return l._coordinatePoint(l.locationCoordinate(c),d)}pixelsPerMeter(l,c){return Zs(1,l)*c}pixelSpaceConversion(l,c,d){return 1}farthestPixelDistance(l){return SW(l,l.pixelsPerMeter)}pointCoordinate(l,c,d,y){const _=l.horizonLineFromTop(!1),w=new K(c,Math.max(_,d));return l.rayIntersectionCoordinate(l.pointRayIntersection(w,y))}pointCoordinate3D(l,c,d){const y=new K(c,d);if(l.elevation)return l.elevation.pointCoordinate(y);{const _=this.pointCoordinate(l,y.x,y.y,0);return[_.x,_.y,_.z]}}isPointAboveHorizon(l,c){if(l.elevation)return!this.pointCoordinate3D(l,c.x,c.y);const d=l.horizonLineFromTop();return c.y<d}createInversionMatrix(l,c){return Ehe}createTileMatrix(l,c,d){let y,_,w;const C=d.canonical,O=qs(new Float64Array(16));if(this.isReprojectedInTileSpace){const k=fd(C,this);y=1,_=k.x+d.wrap*k.scale,w=k.y,id(O,O,[y/k.scale,y/k.scale,l.pixelsPerMeter/c])}else y=c/l.zoomScale(C.z),_=(C.x+Math.pow(2,C.z)*d.wrap)*y,w=C.y*y;return Jb(O,O,[_,w,0]),id(O,O,[y/kr,y/kr,1]),O}upVector(l,c,d){return[0,0,1]}upVectorScale(l,c,d){return{metersToTile:1}}}class The extends hf{constructor(l){super(l),this.range=[4,7],this.center=l.center||[-96,37.5];const[c,d]=this.parallels=l.parallels||[29.5,45.5],y=Math.sin(Ne(c));this.n=(y+Math.sin(Ne(d)))/2,this.c=1+y*(2*this.n-y),this.r0=Math.sqrt(this.c)/this.n}project(l,c){const{n:d,c:y,r0:_}=this,w=Ne(l-this.center[0]),C=Ne(c),O=Math.sqrt(y-2*d*Math.sin(C))/d;return{x:O*Math.sin(w*d),y:O*Math.cos(w*d)-_,z:0}}unproject(l,c){const{n:d,c:y,r0:_}=this,w=_+c;let C=Math.atan2(l,Math.abs(w))*Math.sign(w);w*d<0&&(C-=Math.PI*Math.sign(l)*Math.sign(w));const O=Ne(this.center[0])*d;C=Gt(C,-Math.PI-O,Math.PI-O);const k=Fe(We(C/d)+this.center[0],-180,180),M=Math.asin(Fe((y-(l*l+w*w)*d*d)/(2*d),-1,1)),N=Fe(We(M),-Co,Co);return new vn(k,N)}}const Sw=1.340264,xw=-.081106,Cw=893e-6,Ew=.003796,QE=Math.sqrt(3)/2;class Ohe extends hf{project(l,c){c=c/180*Math.PI,l=l/180*Math.PI;const d=Math.asin(QE*Math.sin(c)),y=d*d,_=y*y*y;return{x:.5*(l*Math.cos(d)/(QE*(Sw+3*xw*y+_*(7*Cw+9*Ew*y)))/Math.PI+.5),y:1-.5*(d*(Sw+xw*y+_*(Cw+Ew*y))/Math.PI+1),z:0}}unproject(l,c){l=(2*l-.5)*Math.PI;let d=c=(2*(1-c)-1)*Math.PI,y=d*d,_=y*y*y;for(let M,N,B,W=0;W<12&&(N=d*(Sw+xw*y+_*(Cw+Ew*y))-c,B=Sw+3*xw*y+_*(7*Cw+9*Ew*y),M=N/B,d=Fe(d-M,-Math.PI/3,Math.PI/3),y=d*d,_=y*y*y,!(Math.abs(M)<1e-12));++W);const w=QE*l*(Sw+3*xw*y+_*(7*Cw+9*Ew*y))/Math.cos(d),C=Math.asin(Math.sin(d)/QE),O=Fe(180*w/Math.PI,-180,180),k=Fe(180*C/Math.PI,-Co,Co);return new vn(O,k)}}class Rhe extends hf{constructor(l){super(l),this.wrap=!0,this.supportsWorldCopies=!0}project(l,c){return{x:.5+l/360,y:.5-c/360,z:0}}unproject(l,c){const d=360*(l-.5),y=Fe(360*(.5-c),-Co,Co);return new vn(d,y)}}const iy=Math.PI/2;function eT(u){return Math.tan((iy+u)/2)}class khe extends hf{constructor(l){super(l),this.center=l.center||[0,30];const[c,d]=this.parallels=l.parallels||[30,30];let y=Ne(c),_=Ne(d);this.southernCenter=y+_<0,this.southernCenter&&(y=-y,_=-_);const w=Math.cos(y),C=eT(y);this.n=y===_?Math.sin(y):Math.log(w/Math.cos(_))/Math.log(eT(_)/C),this.f=w*Math.pow(eT(y),this.n)/this.n}project(l,c){c=Ne(c),this.southernCenter&&(c=-c),l=Ne(l-this.center[0]);const d=1e-6,{n:y,f:_}=this;_>0?c<-iy+d&&(c=-iy+d):c>iy-d&&(c=iy-d);const w=_/Math.pow(eT(c),y);let C=w*Math.sin(y*l),O=_-w*Math.cos(y*l);return C=.5*(C/Math.PI+.5),O=.5*(O/Math.PI+.5),{x:C,y:this.southernCenter?O:1-O,z:0}}unproject(l,c){l=(2*l-.5)*Math.PI,this.southernCenter&&(c=1-c),c=(2*(1-c)-.5)*Math.PI;const{n:d,f:y}=this,_=y-c,w=Math.sign(_),C=Math.sign(d)*Math.sqrt(l*l+_*_);let O=Math.atan2(l,Math.abs(_))*w;_*d<0&&(O-=Math.PI*Math.sign(l)*w);const k=Fe(We(O/d)+this.center[0],-180,180),M=Fe(We(2*Math.atan(Math.pow(y/C,1/d))-iy),-Co,Co);return new vn(k,this.southernCenter?-M:M)}}class xW extends hf{constructor(l){super(l),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(l,c){return{x:Al(l),y:Il(c),z:0}}unproject(l,c){const d=Ga(l),y=xo(c);return new vn(d,y)}}const CW=Ne(Co);class Phe extends hf{project(l,c){const d=(c=Ne(c))*c,y=d*d;return{x:.5*((l=Ne(l))*(.8707-.131979*d+y*(y*(.003971*d-.001529*y)-.013791))/Math.PI+.5),y:1-.5*(c*(1.007226+d*(.015085+y*(.028874*d-.044475-.005916*y)))/Math.PI+1),z:0}}unproject(l,c){l=(2*l-.5)*Math.PI;let d=c=(2*(1-c)-1)*Math.PI,y=25,_=0,w=d*d;do{w=d*d;const k=w*w;_=(d*(1.007226+w*(.015085+k*(.028874*w-.044475-.005916*k)))-c)/(1.007226+w*(.045255+k*(.259866*w-.311325-.005916*11*k))),d=Fe(d-_,-CW,CW)}while(Math.abs(_)>1e-6&&--y>0);w=d*d;const C=Fe(We(l/(.8707+w*(w*(w*w*w*(.003971-.001529*w)-.013791)-.131979))),-180,180),O=We(d);return new vn(C,O)}}const EW=Ne(Co);class Ahe extends hf{project(l,c){c=Ne(c),l=Ne(l);const d=Math.cos(c),y=2/Math.PI,_=Math.acos(d*Math.cos(l/2)),w=Math.sin(_)/_,C=.5*(l*y+2*d*Math.sin(l/2)/w)||0,O=.5*(c+Math.sin(c)/w)||0;return{x:.5*(C/Math.PI+.5),y:1-.5*(O/Math.PI+1),z:0}}unproject(l,c){let d=l=(2*l-.5)*Math.PI,y=c=(2*(1-c)-1)*Math.PI,_=25;const w=1e-6;let C=0,O=0;do{const k=Math.cos(y),M=Math.sin(y),N=2*M*k,B=M*M,W=k*k,Y=Math.cos(d/2),J=Math.sin(d/2),ie=2*Y*J,pe=J*J,Ce=1-W*Y*Y,he=Ce?1/Ce:0,Se=Ce?Math.acos(k*Y)*Math.sqrt(1/Ce):0,ke=.5*(2*Se*k*J+2*d/Math.PI)-l,Te=.5*(Se*M+y)-c,lt=.5*he*(W*pe+Se*k*Y*B)+1/Math.PI,it=he*(ie*N/4-Se*M*J),vt=.125*he*(N*J-Se*M*W*ie),$t=.5*he*(B*Y+Se*pe*k)+.5,ht=it*vt-$t*lt;C=(Te*it-ke*$t)/ht,O=(ke*vt-Te*lt)/ht,d=Fe(d-C,-Math.PI,Math.PI),y=Fe(y-O,-EW,EW)}while((Math.abs(C)>w||Math.abs(O)>w)&&--_>0);return new vn(We(d),We(y))}}class TW extends hf{constructor(l){super(l),this.center=l.center||[0,0],this.parallels=l.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(Ne(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(l,c){const{scale:d,cosPhi:y}=this;return{x:Ne(l)*y*d+.5,y:-Math.sin(Ne(c))/y*d+.5,z:0}}unproject(l,c){const{scale:d,cosPhi:y}=this,_=-(c-.5)/d,w=Fe(We((l-.5)/d)/y,-180,180),C=Math.asin(Fe(_*y,-1,1)),O=Fe(We(C),-Co,Co);return new vn(w,O)}}class Ihe extends xW{constructor(l){super(l),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(l,c,d){const y=aw(l,c,d);return Si(y,y,sw(Pl(d))),{x:y[0],y:y[1],z:y[2]}}locationPoint(l,c){const d=Um(c.lat,c.lng),y=Uo([],d),_=l.elevation?l.elevation.getAtPointOrZero(l.locationCoordinate(c),l._centerAltitude):l._centerAltitude;rw(d,d,y,Zs(1,0)*kr*_);const w=qs(new Float64Array(16));return nd(w,l.pixelMatrix,l.globeMatrix),Si(d,d,w),new K(d[0],d[1])}pixelsPerMeter(l,c){return Zs(1,0)*c}pixelSpaceConversion(l,c,d){const y=Zs(1,l)*c,_=mn(Zs(1,45)*c,y,d);return this.pixelsPerMeter(l,c)/_}createTileMatrix(l,c,d){const y=BI(Pl(d.canonical));return nd(new Float64Array(16),l.globeMatrix,y)}createInversionMatrix(l,c){const{center:d}=l,y=sw(Pl(c));return kE(y,y,Ne(d.lng)),kI(y,y,Ne(d.lat)),id(y,y,[l._pixelsPerMercatorPixel,l._pixelsPerMercatorPixel,1]),Float32Array.from(y)}pointCoordinate(l,c,d,y){return r4(l,c,d,!0)||new Gm(0,0)}pointCoordinate3D(l,c,d){const y=this.pointCoordinate(l,c,d,0);return[y.x,y.y,y.z]}isPointAboveHorizon(l,c){return!r4(l,c.x,c.y,!1)}farthestPixelDistance(l){const c=function(y,_){const w=y.cameraToCenterDistance,C=y._centerAltitude*_,O=y._camera,k=y._camera.forward(),M=Eu([],Wa([],k,-w),[0,0,C]),N=y.worldSize/(2*Math.PI),B=[0,0,-N],W=y.width/y.height,Y=Math.tan(y.fovAboveCenter),J=Wa([],O.up(),Y),ie=Wa([],O.right(),Y*W),pe=Uo([],Eu([],Eu([],k,J),ie)),Ce=[];let he;if(new MI(M,pe).closestPointOnSphere(B,N,Ce)){const Se=Eu([],Ce,B),ke=Xs([],Se,M);he=Math.cos(y.fovAboveCenter)*Qb(ke)}else{const Se=Xs([],M,B),ke=Xs([],B,M);Uo(ke,ke);const Te=Qb(Se)-N;he=Math.sqrt(Te*(Te+2*N));const lt=Math.acos(he/(N+Te))-Math.acos(gs(k,ke));he*=Math.cos(lt)}return 1.01*he}(l,this.pixelsPerMeter(l.center.lat,l.worldSize)),d=Wm(l.zoom);if(d>0){const y=SW(l,Zs(1,l.center.lat)*l.worldSize),_=l.worldSize/(2*Math.PI),w=Math.max(l.width,l.height)/l.worldSize*Math.PI;return mn(c,y+_*(1-Math.cos(w)),Math.pow(d,10))}return c}upVector(l,c,d){return aw(c,d,l,1)}upVectorScale(l){return{metersToTile:PE(IE(Pl(l)))}}}function OW(u){const l=u.parallels,c=!!l&&Math.abs(l[0]+l[1])<.01;switch(u.name){case"mercator":return new xW(u);case"equirectangular":return new Rhe(u);case"naturalEarth":return new Phe(u);case"equalEarth":return new Ohe(u);case"winkelTripel":return new Ahe(u);case"albers":return c?new TW(u):new The(u);case"lambertConformalConic":return c?new TW(u):new khe(u);case"globe":return new Ihe(u)}throw new Error(`Invalid projection name: ${u.name}`)}const Mhe=HE.types,Dhe=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function tT(u,l,c,d,y,_,w,C,O,k,M,N,B){const W=C?Math.min(ff,Math.round(C[0])):0,Y=C?Math.min(ff,Math.round(C[1])):0;u.emplaceBack(l,c,Math.round(32*d),Math.round(32*y),_,w,(W<<1)+(O?1:0),Y,16*k,16*M,256*N,256*B)}function rT(u,l,c,d,y,_,w){u.emplaceBack(l,c,d,y,_,w)}function nT(u,l,c,d,y){u.emplaceBack(l,c,d,y),u.emplaceBack(l,c,d,y),u.emplaceBack(l,c,d,y),u.emplaceBack(l,c,d,y)}function $he(u){for(const l of u.sections)if(X(l.text))return!0;return!1}class hM{constructor(l){this.layoutVertexArray=new Ws,this.indexArray=new So,this.programConfigurations=l,this.segments=new Oi,this.dynamicLayoutVertexArray=new $n,this.opacityVertexArray=new Ln,this.placedSymbolArray=new RU,this.globeExtVertexArray=new Zn}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(l,c,d,y){this.isEmpty()||(d&&(this.layoutVertexBuffer=l.createVertexBuffer(this.layoutVertexArray,Vfe.members),this.indexBuffer=l.createIndexBuffer(this.indexArray,c),this.dynamicLayoutVertexBuffer=l.createVertexBuffer(this.dynamicLayoutVertexArray,Wfe.members,!0),this.opacityVertexBuffer=l.createVertexBuffer(this.opacityVertexArray,Dhe,!0),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=l.createVertexBuffer(this.globeExtVertexArray,Ufe.members,!0)),this.opacityVertexBuffer.itemSize=1),(d||y)&&this.programConfigurations.upload(l))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}}tr(hM,"SymbolBuffers");class dM{constructor(l,c,d){this.layoutVertexArray=new l,this.layoutAttributes=c,this.indexArray=new d,this.segments=new Oi,this.collisionVertexArray=new Yn,this.collisionVertexArrayExt=new wo}upload(l){this.layoutVertexBuffer=l.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=l.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=l.createVertexBuffer(this.collisionVertexArray,Gfe.members,!0),this.collisionVertexBufferExt=l.createVertexBuffer(this.collisionVertexArrayExt,Yfe.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}tr(dM,"CollisionBuffers");class df{constructor(l){this.collisionBoxArray=l.collisionBoxArray,this.zoom=l.zoom,this.overscaling=l.overscaling,this.layers=l.layers,this.layerIds=this.layers.map(w=>w.id),this.index=l.index,this.pixelRatio=l.pixelRatio,this.sourceLayerIndex=l.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=qs([]),this.placementViewportMatrix=qs([]);const c=this.layers[0]._unevaluatedLayout._values;this.textSizeData=rM(this.zoom,c["text-size"]),this.iconSizeData=rM(this.zoom,c["icon-size"]);const d=this.layers[0].layout,y=d.get("symbol-sort-key"),_=d.get("symbol-z-order");this.canOverlap=d.get("text-allow-overlap")||d.get("icon-allow-overlap")||d.get("text-ignore-placement")||d.get("icon-ignore-placement"),this.sortFeaturesByKey=_!=="viewport-y"&&y.constantOr(1)!==void 0,this.sortFeaturesByY=(_==="viewport-y"||_==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=d.get("text-writing-mode").map(w=>Ya[w]),this.stateDependentLayerIds=this.layers.filter(w=>w.isStateDependent()).map(w=>w.id),this.sourceID=l.sourceID,this.projection=l.projection}createArrays(){this.text=new hM(new rd(this.layers,this.zoom,l=>/^text/.test(l))),this.icon=new hM(new rd(this.layers,this.zoom,l=>/^icon/.test(l))),this.glyphOffsetArray=new AU,this.lineVertexArray=new IU,this.symbolInstances=new PU}calculateGlyphDependencies(l,c,d,y,_){for(let w=0;w<l.length;w++)if(c[l.charCodeAt(w)]=!0,y&&_){const C=vw[l.charAt(w)];C&&(c[C.charCodeAt(0)]=!0)}}populate(l,c,d,y){const _=this.layers[0],w=_.layout,C=this.projection.name==="globe",O=w.get("text-font"),k=w.get("text-field"),M=w.get("icon-image"),N=(k.value.kind!=="constant"||k.value.value instanceof Ho&&!k.value.value.isEmpty()||k.value.value.toString().length>0)&&(O.value.kind!=="constant"||O.value.value.length>0),B=M.value.kind!=="constant"||!!M.value.value||Object.keys(M.parameters).length>0,W=w.get("symbol-sort-key");if(this.features=[],!N&&!B)return;const Y=c.iconDependencies,J=c.glyphDependencies,ie=c.availableImages,pe=new Xe(this.zoom);for(const{feature:Ce,id:he,index:Se,sourceLayerIndex:ke}of l){const Te=_._featureFilter.needGeometry,lt=ld(Ce,Te);if(!_._featureFilter.filter(pe,lt,d))continue;if(Te||(lt.geometry=Tu(Ce,d,y)),C&&Ce.type!==1&&d.z<=5){const ht=lt.geometry,bt=.98078528056,St=(Pt,Nt)=>gs(aw(Pt.x,Pt.y,d,1),aw(Nt.x,Nt.y,d,1))<bt;for(let Pt=0;Pt<ht.length;Pt++)ht[Pt]=Wce(ht[Pt],St)}let it,vt;if(N){const ht=_.getValueAndResolveTokens("text-field",lt,d,ie),bt=Ho.factory(ht);$he(bt)&&(this.hasRTLText=!0),(!this.hasRTLText||Pe()==="unavailable"||this.hasRTLText&&De.isParsed())&&(it=Xfe(bt,_,lt))}if(B){const ht=_.getValueAndResolveTokens("icon-image",lt,d,ie);vt=ht instanceof Do?ht:Do.fromString(ht)}if(!it&&!vt)continue;const $t=this.sortFeaturesByKey?W.evaluate(lt,{},d):void 0;if(this.features.push({id:he,text:it,icon:vt,index:Se,sourceLayerIndex:ke,geometry:lt.geometry,properties:Ce.properties,type:Mhe[Ce.type],sortKey:$t}),vt&&(Y[vt.name]=!0),it){const ht=O.evaluate(lt,{},d).join(","),bt=w.get("text-rotation-alignment")==="map"&&w.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Ya.vertical)>=0;for(const St of it.sections)if(St.image)Y[St.image.name]=!0;else{const Pt=x(it.toString()),Nt=St.fontStack||ht,dt=J[Nt]=J[Nt]||{};this.calculateGlyphDependencies(St.text,dt,bt,this.allowVerticalPlacement,Pt)}}}w.get("symbol-placement")==="line"&&(this.features=function(Ce){const he={},Se={},ke=[];let Te=0;function lt(ht){ke.push(Ce[ht]),Te++}function it(ht,bt,St){const Pt=Se[ht];return delete Se[ht],Se[bt]=Pt,ke[Pt].geometry[0].pop(),ke[Pt].geometry[0]=ke[Pt].geometry[0].concat(St[0]),Pt}function vt(ht,bt,St){const Pt=he[bt];return delete he[bt],he[ht]=Pt,ke[Pt].geometry[0].shift(),ke[Pt].geometry[0]=St[0].concat(ke[Pt].geometry[0]),Pt}function $t(ht,bt,St){const Pt=St?bt[0][bt[0].length-1]:bt[0][0];return`${ht}:${Pt.x}:${Pt.y}`}for(let ht=0;ht<Ce.length;ht++){const bt=Ce[ht],St=bt.geometry,Pt=bt.text?bt.text.toString():null;if(!Pt){lt(ht);continue}const Nt=$t(Pt,St),dt=$t(Pt,St,!0);if(Nt in Se&&dt in he&&Se[Nt]!==he[dt]){const Wt=vt(Nt,dt,St),xr=it(Nt,dt,ke[Wt].geometry);delete he[Nt],delete Se[dt],Se[$t(Pt,ke[xr].geometry,!0)]=xr,ke[Wt].geometry=null}else Nt in Se?it(Nt,dt,St):dt in he?vt(Nt,dt,St):(lt(ht),he[Nt]=Te-1,Se[dt]=Te-1)}return ke.filter(ht=>ht.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((Ce,he)=>Ce.sortKey-he.sortKey)}update(l,c,d,y){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(l,c,this.layers,d,y),this.icon.programConfigurations.updatePaintArrays(l,c,this.layers,d,y))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(l){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(l),this.iconCollisionBox.upload(l)),this.text.upload(l,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(l,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=OW(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(l,c){const d=this.lineVertexArray.length;if(l.segment!==void 0)for(const{x:y,y:_}of c)this.lineVertexArray.emplaceBack(y,_);return{lineStartIndex:d,lineLength:this.lineVertexArray.length-d}}addSymbols(l,c,d,y,_,w,C,O,k,M,N,B,W,Y){const J=l.indexArray,ie=l.layoutVertexArray,pe=l.globeExtVertexArray,Ce=l.segments.prepareSegment(4*c.length,ie,J,this.canOverlap?w.sortKey:void 0),he=this.glyphOffsetArray.length,Se=Ce.vertexLength,ke=this.allowVerticalPlacement&&C===Ya.vertical?Math.PI/2:0,Te=w.text&&w.text.sections;for(let it=0;it<c.length;it++){const{tl:vt,tr:$t,bl:ht,br:bt,tex:St,pixelOffsetTL:Pt,pixelOffsetBR:Nt,minFontScaleX:dt,minFontScaleY:Wt,glyphOffset:xr,isSDF:Zt,sectionIndex:ar}=c[it],Yt=Ce.vertexLength,Tr=xr[1];if(tT(ie,k.x,k.y,vt.x,Tr+vt.y,St.x,St.y,d,Zt,Pt.x,Pt.y,dt,Wt),tT(ie,k.x,k.y,$t.x,Tr+$t.y,St.x+St.w,St.y,d,Zt,Nt.x,Pt.y,dt,Wt),tT(ie,k.x,k.y,ht.x,Tr+ht.y,St.x,St.y+St.h,d,Zt,Pt.x,Nt.y,dt,Wt),tT(ie,k.x,k.y,bt.x,Tr+bt.y,St.x+St.w,St.y+St.h,d,Zt,Nt.x,Nt.y,dt,Wt),O){const{x:Zr,y:Yr,z:Wr}=O.anchor,[Rr,Rn,Dr]=O.up;rT(pe,Zr,Yr,Wr,Rr,Rn,Dr),rT(pe,Zr,Yr,Wr,Rr,Rn,Dr),rT(pe,Zr,Yr,Wr,Rr,Rn,Dr),rT(pe,Zr,Yr,Wr,Rr,Rn,Dr),nT(l.dynamicLayoutVertexArray,Zr,Yr,Wr,ke)}else nT(l.dynamicLayoutVertexArray,k.x,k.y,k.z,ke);J.emplaceBack(Yt,Yt+1,Yt+2),J.emplaceBack(Yt+1,Yt+2,Yt+3),Ce.vertexLength+=4,Ce.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(xr[0]),it!==c.length-1&&ar===c[it+1].sectionIndex||l.programConfigurations.populatePaintArrays(ie.length,w,w.index,{},W,Y,Te&&Te[ar])}const lt=O?O.anchor:k;l.placedSymbolArray.emplaceBack(lt.x,lt.y,lt.z,k.x,k.y,he,this.glyphOffsetArray.length-he,Se,M,N,k.segment,d?d[0]:0,d?d[1]:0,y[0],y[1],C,0,!1,0,B,0)}_commitLayoutVertex(l,c,d,y,_,w,C){l.emplaceBack(c,d,y,_,w,Math.round(C.x),Math.round(C.y))}_addCollisionDebugVertices(l,c,d,y,_,w,C){const O=d.segments.prepareSegment(4,d.layoutVertexArray,d.indexArray),k=O.vertexLength,M=C.tileAnchorX,N=C.tileAnchorY;for(let W=0;W<4;W++)d.collisionVertexArray.emplaceBack(0,0,0,0);d.collisionVertexArrayExt.emplaceBack(c,-l.padding,-l.padding),d.collisionVertexArrayExt.emplaceBack(c,l.padding,-l.padding),d.collisionVertexArrayExt.emplaceBack(c,l.padding,l.padding),d.collisionVertexArrayExt.emplaceBack(c,-l.padding,l.padding),this._commitLayoutVertex(d.layoutVertexArray,y,_,w,M,N,new K(l.x1,l.y1)),this._commitLayoutVertex(d.layoutVertexArray,y,_,w,M,N,new K(l.x2,l.y1)),this._commitLayoutVertex(d.layoutVertexArray,y,_,w,M,N,new K(l.x2,l.y2)),this._commitLayoutVertex(d.layoutVertexArray,y,_,w,M,N,new K(l.x1,l.y2)),O.vertexLength+=4;const B=d.indexArray;B.emplaceBack(k,k+1),B.emplaceBack(k+1,k+2),B.emplaceBack(k+2,k+3),B.emplaceBack(k+3,k),O.primitiveLength+=4}_addTextDebugCollisionBoxes(l,c,d,y,_,w){for(let C=y;C<_;C++){const O=d.get(C),k=this.getSymbolInstanceTextSize(l,w,c,C);this._addCollisionDebugVertices(O,k,this.textCollisionBox,O.projectedAnchorX,O.projectedAnchorY,O.projectedAnchorZ,w)}}_addIconDebugCollisionBoxes(l,c,d,y,_,w){for(let C=y;C<_;C++){const O=d.get(C),k=this.getSymbolInstanceIconSize(l,c,w.placedIconSymbolIndex);this._addCollisionDebugVertices(O,k,this.iconCollisionBox,O.projectedAnchorX,O.projectedAnchorY,O.projectedAnchorZ,w)}}generateCollisionDebugBuffers(l,c){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new dM(di,q4.members,Ol),this.iconCollisionBox=new dM(di,q4.members,Ol);const d=Jm(this.iconSizeData,l),y=Jm(this.textSizeData,l);for(let _=0;_<this.symbolInstances.length;_++){const w=this.symbolInstances.get(_);this._addTextDebugCollisionBoxes(y,l,c,w.textBoxStartIndex,w.textBoxEndIndex,w),this._addTextDebugCollisionBoxes(y,l,c,w.verticalTextBoxStartIndex,w.verticalTextBoxEndIndex,w),this._addIconDebugCollisionBoxes(d,l,c,w.iconBoxStartIndex,w.iconBoxEndIndex,w),this._addIconDebugCollisionBoxes(d,l,c,w.verticalIconBoxStartIndex,w.verticalIconBoxEndIndex,w)}}getSymbolInstanceTextSize(l,c,d,y){const _=this.text.placedSymbolArray.get(c.rightJustifiedTextSymbolIndex>=0?c.rightJustifiedTextSymbolIndex:c.centerJustifiedTextSymbolIndex>=0?c.centerJustifiedTextSymbolIndex:c.leftJustifiedTextSymbolIndex>=0?c.leftJustifiedTextSymbolIndex:c.verticalPlacedTextSymbolIndex>=0?c.verticalPlacedTextSymbolIndex:y),w=GE(this.textSizeData,l,_)/Eo;return this.tilePixelRatio*w}getSymbolInstanceIconSize(l,c,d){const y=this.icon.placedSymbolArray.get(d),_=GE(this.iconSizeData,l,y);return this.tilePixelRatio*_}_commitDebugCollisionVertexUpdate(l,c,d){l.emplaceBack(c,-d,-d),l.emplaceBack(c,d,-d),l.emplaceBack(c,d,d),l.emplaceBack(c,-d,d)}_updateTextDebugCollisionBoxes(l,c,d,y,_,w){for(let C=y;C<_;C++){const O=d.get(C),k=this.getSymbolInstanceTextSize(l,w,c,C);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,k,O.padding)}}_updateIconDebugCollisionBoxes(l,c,d,y,_,w){for(let C=y;C<_;C++){const O=d.get(C),k=this.getSymbolInstanceIconSize(l,c,w);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,k,O.padding)}}updateCollisionDebugBuffers(l,c){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const d=Jm(this.iconSizeData,l),y=Jm(this.textSizeData,l);for(let _=0;_<this.symbolInstances.length;_++){const w=this.symbolInstances.get(_);this._updateTextDebugCollisionBoxes(y,l,c,w.textBoxStartIndex,w.textBoxEndIndex,w),this._updateTextDebugCollisionBoxes(y,l,c,w.verticalTextBoxStartIndex,w.verticalTextBoxEndIndex,w),this._updateIconDebugCollisionBoxes(d,l,c,w.iconBoxStartIndex,w.iconBoxEndIndex,w.placedIconSymbolIndex),this._updateIconDebugCollisionBoxes(d,l,c,w.verticalIconBoxStartIndex,w.verticalIconBoxEndIndex,w.placedIconSymbolIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(l,c,d,y,_,w,C,O,k){const M={};if(c<d){const{x1:N,y1:B,x2:W,y2:Y,padding:J,projectedAnchorX:ie,projectedAnchorY:pe,projectedAnchorZ:Ce,tileAnchorX:he,tileAnchorY:Se,featureIndex:ke}=l.get(c);M.textBox={x1:N,y1:B,x2:W,y2:Y,padding:J,projectedAnchorX:ie,projectedAnchorY:pe,projectedAnchorZ:Ce,tileAnchorX:he,tileAnchorY:Se},M.textFeatureIndex=ke}if(y<_){const{x1:N,y1:B,x2:W,y2:Y,padding:J,projectedAnchorX:ie,projectedAnchorY:pe,projectedAnchorZ:Ce,tileAnchorX:he,tileAnchorY:Se,featureIndex:ke}=l.get(y);M.verticalTextBox={x1:N,y1:B,x2:W,y2:Y,padding:J,projectedAnchorX:ie,projectedAnchorY:pe,projectedAnchorZ:Ce,tileAnchorX:he,tileAnchorY:Se},M.verticalTextFeatureIndex=ke}if(w<C){const{x1:N,y1:B,x2:W,y2:Y,padding:J,projectedAnchorX:ie,projectedAnchorY:pe,projectedAnchorZ:Ce,tileAnchorX:he,tileAnchorY:Se,featureIndex:ke}=l.get(w);M.iconBox={x1:N,y1:B,x2:W,y2:Y,padding:J,projectedAnchorX:ie,projectedAnchorY:pe,projectedAnchorZ:Ce,tileAnchorX:he,tileAnchorY:Se},M.iconFeatureIndex=ke}if(O<k){const{x1:N,y1:B,x2:W,y2:Y,padding:J,projectedAnchorX:ie,projectedAnchorY:pe,projectedAnchorZ:Ce,tileAnchorX:he,tileAnchorY:Se,featureIndex:ke}=l.get(O);M.verticalIconBox={x1:N,y1:B,x2:W,y2:Y,padding:J,projectedAnchorX:ie,projectedAnchorY:pe,projectedAnchorZ:Ce,tileAnchorX:he,tileAnchorY:Se},M.verticalIconFeatureIndex=ke}return M}deserializeCollisionBoxes(l){this.collisionArrays=[];for(let c=0;c<this.symbolInstances.length;c++){const d=this.symbolInstances.get(c);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(l,d.textBoxStartIndex,d.textBoxEndIndex,d.verticalTextBoxStartIndex,d.verticalTextBoxEndIndex,d.iconBoxStartIndex,d.iconBoxEndIndex,d.verticalIconBoxStartIndex,d.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(l,c){const d=l.placedSymbolArray.get(c),y=d.vertexStartIndex+4*d.numGlyphs;for(let _=d.vertexStartIndex;_<y;_+=4)l.indexArray.emplaceBack(_,_+1,_+2),l.indexArray.emplaceBack(_+1,_+2,_+3)}getSortedSymbolIndexes(l){if(this.sortedAngle===l&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const c=Math.sin(l),d=Math.cos(l),y=[],_=[],w=[];for(let C=0;C<this.symbolInstances.length;++C){w.push(C);const O=this.symbolInstances.get(C);y.push(0|Math.round(c*O.tileAnchorX+d*O.tileAnchorY)),_.push(O.featureIndex)}return w.sort((C,O)=>y[C]-y[O]||_[O]-_[C]),w}addToSortKeyRanges(l,c){const d=this.sortKeyRanges[this.sortKeyRanges.length-1];d&&d.sortKey===c?d.symbolInstanceEnd=l+1:this.sortKeyRanges.push({sortKey:c,symbolInstanceStart:l,symbolInstanceEnd:l+1})}sortFeatures(l){if(this.sortFeaturesByY&&this.sortedAngle!==l&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(l),this.sortedAngle=l,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const c of this.symbolInstanceIndexes){const d=this.symbolInstances.get(c);this.featureSortOrder.push(d.featureIndex);const{rightJustifiedTextSymbolIndex:y,centerJustifiedTextSymbolIndex:_,leftJustifiedTextSymbolIndex:w,verticalPlacedTextSymbolIndex:C,placedIconSymbolIndex:O,verticalPlacedIconSymbolIndex:k}=d;y>=0&&this.addIndicesForPlacedSymbol(this.text,y),_>=0&&_!==y&&this.addIndicesForPlacedSymbol(this.text,_),w>=0&&w!==_&&w!==y&&this.addIndicesForPlacedSymbol(this.text,w),C>=0&&this.addIndicesForPlacedSymbol(this.text,C),O>=0&&this.addIndicesForPlacedSymbol(this.icon,O),k>=0&&this.addIndicesForPlacedSymbol(this.icon,k)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}tr(df,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),df.MAX_GLYPHS=65535,df.addDynamicAttributes=nT;const Lhe=new Mt({"symbol-placement":new Ye(yt.layout_symbol["symbol-placement"]),"symbol-spacing":new Ye(yt.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Ye(yt.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new ct(yt.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Ye(yt.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Ye(yt.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Ye(yt.layout_symbol["icon-ignore-placement"]),"icon-optional":new Ye(yt.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Ye(yt.layout_symbol["icon-rotation-alignment"]),"icon-size":new ct(yt.layout_symbol["icon-size"]),"icon-text-fit":new Ye(yt.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Ye(yt.layout_symbol["icon-text-fit-padding"]),"icon-image":new ct(yt.layout_symbol["icon-image"]),"icon-rotate":new ct(yt.layout_symbol["icon-rotate"]),"icon-padding":new Ye(yt.layout_symbol["icon-padding"]),"icon-keep-upright":new Ye(yt.layout_symbol["icon-keep-upright"]),"icon-offset":new ct(yt.layout_symbol["icon-offset"]),"icon-anchor":new ct(yt.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Ye(yt.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Ye(yt.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Ye(yt.layout_symbol["text-rotation-alignment"]),"text-field":new ct(yt.layout_symbol["text-field"]),"text-font":new ct(yt.layout_symbol["text-font"]),"text-size":new ct(yt.layout_symbol["text-size"]),"text-max-width":new ct(yt.layout_symbol["text-max-width"]),"text-line-height":new ct(yt.layout_symbol["text-line-height"]),"text-letter-spacing":new ct(yt.layout_symbol["text-letter-spacing"]),"text-justify":new ct(yt.layout_symbol["text-justify"]),"text-radial-offset":new ct(yt.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Ye(yt.layout_symbol["text-variable-anchor"]),"text-anchor":new ct(yt.layout_symbol["text-anchor"]),"text-max-angle":new Ye(yt.layout_symbol["text-max-angle"]),"text-writing-mode":new Ye(yt.layout_symbol["text-writing-mode"]),"text-rotate":new ct(yt.layout_symbol["text-rotate"]),"text-padding":new Ye(yt.layout_symbol["text-padding"]),"text-keep-upright":new Ye(yt.layout_symbol["text-keep-upright"]),"text-transform":new ct(yt.layout_symbol["text-transform"]),"text-offset":new ct(yt.layout_symbol["text-offset"]),"text-allow-overlap":new Ye(yt.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Ye(yt.layout_symbol["text-ignore-placement"]),"text-optional":new Ye(yt.layout_symbol["text-optional"])});var pM={paint:new Mt({"icon-opacity":new ct(yt.paint_symbol["icon-opacity"]),"icon-color":new ct(yt.paint_symbol["icon-color"]),"icon-halo-color":new ct(yt.paint_symbol["icon-halo-color"]),"icon-halo-width":new ct(yt.paint_symbol["icon-halo-width"]),"icon-halo-blur":new ct(yt.paint_symbol["icon-halo-blur"]),"icon-translate":new Ye(yt.paint_symbol["icon-translate"]),"icon-translate-anchor":new Ye(yt.paint_symbol["icon-translate-anchor"]),"text-opacity":new ct(yt.paint_symbol["text-opacity"]),"text-color":new ct(yt.paint_symbol["text-color"],{runtimeType:ps,getOverride:u=>u.textColor,hasOverride:u=>!!u.textColor}),"text-halo-color":new ct(yt.paint_symbol["text-halo-color"]),"text-halo-width":new ct(yt.paint_symbol["text-halo-width"]),"text-halo-blur":new ct(yt.paint_symbol["text-halo-blur"]),"text-translate":new Ye(yt.paint_symbol["text-translate"]),"text-translate-anchor":new Ye(yt.paint_symbol["text-translate-anchor"])}),layout:Lhe};class RW{constructor(l){this.type=l.property.overrides?l.property.overrides.runtimeType:zc,this.defaultValue=l}evaluate(l){if(l.formattedSection){const c=this.defaultValue.property.overrides;if(c&&c.hasOverride(l.formattedSection))return c.getOverride(l.formattedSection)}return l.feature&&l.featureState?this.defaultValue.evaluate(l.feature,l.featureState):this.defaultValue.property.specification.default}eachChild(l){this.defaultValue.isConstant()||l(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}tr(RW,"FormatSectionOverride",{omit:["defaultValue"]});class iT extends Ks{constructor(l){super(l,pM)}recalculate(l,c){super.recalculate(l,c),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const d=this.layout.get("text-writing-mode");if(d){const y=[];for(const _ of d)y.indexOf(_)<0&&y.push(_);this.layout._values["text-writing-mode"]=y}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(l,c,d,y){const _=this.layout.get(l).evaluate(c,{},d,y),w=this._unevaluatedLayout._values[l];return w.isDataDriven()||Jc(w.value)||!_?_:function(C,O){return O.replace(/{([^{}]+)}/g,(k,M)=>M in C?String(C[M]):"")}(c.properties,_)}createBucket(l){return new df(l)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const l of pM.paint.overridableProperties){if(!iT.hasPaintOverride(this.layout,l))continue;const c=this.paint.get(l),d=new RW(c),y=new Om(d,c.property.specification);let _=null;_=c.value.kind==="constant"||c.value.kind==="source"?new Rm("source",y):new wu("composite",y,c.value.zoomStops,c.value._interpolationType),this.paint._values[l]=new Ot(c.property,_,c.parameters)}}_handleOverridablePaintPropertyUpdate(l,c,d){return!(!this.layout||c.isDataDriven()||d.isDataDriven())&&iT.hasPaintOverride(this.layout,l)}static hasPaintOverride(l,c){const d=l.get("text-field"),y=pM.paint.properties[c];let _=!1;const w=C=>{for(const O of C)if(y.overrides&&y.overrides.hasOverride(O))return void(_=!0)};if(d.value.kind==="constant"&&d.value.value instanceof Ho)w(d.value.value.sections);else if(d.value.kind==="source"){const C=k=>{_||(k instanceof kh&&zi(k.value)===Fc?w(k.value.sections):k instanceof Ph?w(k.sections):k.eachChild(C))},O=d.value;O._styleExpression&&C(O._styleExpression.expression)}return _}getProgramConfiguration(l){return new uf(this,l)}}var Nhe={paint:new Mt({"background-color":new Ye(yt.paint_background["background-color"]),"background-pattern":new Ye(yt.paint_background["background-pattern"]),"background-opacity":new Ye(yt.paint_background["background-opacity"])})},Bhe={paint:new Mt({"raster-opacity":new Ye(yt.paint_raster["raster-opacity"]),"raster-hue-rotate":new Ye(yt.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Ye(yt.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Ye(yt.paint_raster["raster-brightness-max"]),"raster-saturation":new Ye(yt.paint_raster["raster-saturation"]),"raster-contrast":new Ye(yt.paint_raster["raster-contrast"]),"raster-resampling":new Ye(yt.paint_raster["raster-resampling"]),"raster-fade-duration":new Ye(yt.paint_raster["raster-fade-duration"])})};class jhe extends Ks{constructor(l){super(l,{}),this.implementation=l}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}isLayerDraped(){return this.implementation.renderToTile!==void 0}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(l){this.implementation.onAdd&&this.implementation.onAdd(l,l.painter.context.gl)}onRemove(l){this.implementation.onRemove&&this.implementation.onRemove(l,l.painter.context.gl)}}var zhe={paint:new Mt({"sky-type":new Ye(yt.paint_sky["sky-type"]),"sky-atmosphere-sun":new Ye(yt.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new Ye(yt.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new Ye(yt.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new Ye(yt.paint_sky["sky-gradient-radius"]),"sky-gradient":new Et(yt.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new Ye(yt.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new Ye(yt.paint_sky["sky-atmosphere-color"]),"sky-opacity":new Ye(yt.paint_sky["sky-opacity"])})};function mM(u,l,c){const d=[0,0,1],y=ZU([]);return QU(y,y,c?-Ne(u)+Math.PI:Ne(u)),JU(y,y,-Ne(l)),YU(d,d,y),Uo(d,d)}const Fhe={circle:class extends Ks{constructor(u){super(u,Jce)}createBucket(u){return new UI(u)}queryRadius(u){const l=u;return Ym("circle-radius",this,l)+Ym("circle-stroke-width",this,l)+$E(this.paint.get("circle-translate"))}queryIntersectsFeature(u,l,c,d,y,_,w,C){const O=b4(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),_.angle,u.pixelToTileUnitsFactor),k=this.paint.get("circle-radius").evaluate(l,c)+this.paint.get("circle-stroke-width").evaluate(l,c);return w4(u,d,_,w,C,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",O,k)}getProgramIds(){return["circle"]}getProgramConfiguration(u){return new uf(this,u)}},heatmap:class extends Ks{createBucket(u){return new x4(u)}constructor(u){super(u,rfe),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(u){u==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=KI({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(u){return Ym("heatmap-radius",this,u)}queryIntersectsFeature(u,l,c,d,y,_,w,C){const O=this.paint.get("heatmap-radius").evaluate(l,c);return w4(u,d,_,w,C,!0,!0,new K(0,0),O)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getProgramConfiguration(u){return new uf(this,u)}},hillshade:class extends Ks{constructor(u){super(u,nfe)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}},fill:class extends Ks{constructor(u){super(u,_fe)}getProgramIds(){const u=this.paint.get("fill-pattern"),l=u&&u.constantOr(1),c=[l?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&c.push(l&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),c}getProgramConfiguration(u){return new uf(this,u)}recalculate(u,l){super.recalculate(u,l);const c=this.paint._values["fill-outline-color"];c.value.kind==="constant"&&c.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(u){return new zE(u)}queryRadius(){return $E(this.paint.get("fill-translate"))}queryIntersectsFeature(u,l,c,d,y,_){return!u.queryGeometry.isAboveHorizon&&m4(_4(u.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),_.angle,u.pixelToTileUnitsFactor),d)}isTileClipped(){return!0}},"fill-extrusion":class extends Ks{constructor(u){super(u,$fe)}createBucket(u){return new mw(u)}queryRadius(){return $E(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(u){return new uf(this,u)}queryIntersectsFeature(u,l,c,d,y,_,w,C,O){const k=b4(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),_.angle,u.pixelToTileUnitsFactor),M=this.paint.get("fill-extrusion-height").evaluate(l,c),N=this.paint.get("fill-extrusion-base").evaluate(l,c),B=[0,0],W=C&&_.elevation,Y=_.elevation?_.elevation.exaggeration():1,J=u.tile.getBucket(this);if(W&&J instanceof mw){const Se=J.centroidVertexArray,ke=O+1;ke<Se.length&&(B[0]=Se.geta_centroid_pos0(ke),B[1]=Se.geta_centroid_pos1(ke))}if(B[0]===0&&B[1]===1)return!1;_.projection.name==="globe"&&(d=F4([d],[new K(0,0),new K(kr,kr)],u.tileID.canonical).map(Se=>Se.polygon).flat());const ie=W?C:null,[pe,Ce]=function(Se,ke,Te,lt,it,vt,$t,ht,bt,St,Pt){return Se.projection.name==="globe"?function(Nt,dt,Wt,xr,Zt,ar,Yt,Tr,Zr,Yr,Wr){const Rr=[],Rn=[],Dr=Nt.projection.upVectorScale(Wr,Nt.center.lat,Nt.worldSize).metersToTile,Jr=[0,0,0,1],An=[0,0,0,1],Kn=(qn,Jn,pi,uo)=>{qn[0]=Jn,qn[1]=pi,qn[2]=uo,qn[3]=1},Vn=z4();Wt>0&&(Wt+=Vn),xr+=Vn;for(const qn of dt){const Jn=[],pi=[];for(const uo of qn){const kn=uo.x+Zt.x,Fi=uo.y+Zt.y,ki=Nt.projection.projectTilePoint(kn,Fi,Wr),bn=Nt.projection.upVector(Wr,uo.x,uo.y);let ai=Wt,Gi=xr;if(Yt){const In=W4(kn,Fi,Wt,xr,Yt,Tr,Zr,Yr);ai+=In.base,Gi+=In.top}Wt!==0?Kn(Jr,ki.x+bn[0]*Dr*ai,ki.y+bn[1]*Dr*ai,ki.z+bn[2]*Dr*ai):Kn(Jr,ki.x,ki.y,ki.z),Kn(An,ki.x+bn[0]*Dr*Gi,ki.y+bn[1]*Dr*Gi,ki.z+bn[2]*Dr*Gi),Si(Jr,Jr,ar),Si(An,An,ar),Jn.push(new Zm(Jr[0],Jr[1],Jr[2])),pi.push(new Zm(An[0],An[1],An[2]))}Rr.push(Jn),Rn.push(pi)}return[Rr,Rn]}(Se,ke,Te,lt,it,vt,$t,ht,bt,St,Pt):$t?function(Nt,dt,Wt,xr,Zt,ar,Yt,Tr,Zr){const Yr=[],Wr=[],Rr=[0,0,0,1];for(const Rn of Nt){const Dr=[],Jr=[];for(const An of Rn){const Kn=An.x+xr.x,Vn=An.y+xr.y,qn=W4(Kn,Vn,dt,Wt,ar,Yt,Tr,Zr);Rr[0]=Kn,Rr[1]=Vn,Rr[2]=qn.base,Rr[3]=1,od(Rr,Rr,Zt),Rr[3]=Math.max(Rr[3],1e-5);const Jn=new Zm(Rr[0]/Rr[3],Rr[1]/Rr[3],Rr[2]/Rr[3]);Rr[0]=Kn,Rr[1]=Vn,Rr[2]=qn.top,Rr[3]=1,od(Rr,Rr,Zt),Rr[3]=Math.max(Rr[3],1e-5);const pi=new Zm(Rr[0]/Rr[3],Rr[1]/Rr[3],Rr[2]/Rr[3]);Dr.push(Jn),Jr.push(pi)}Yr.push(Dr),Wr.push(Jr)}return[Yr,Wr]}(ke,Te,lt,it,vt,$t,ht,bt,St):function(Nt,dt,Wt,xr,Zt){const ar=[],Yt=[],Tr=Zt[8]*dt,Zr=Zt[9]*dt,Yr=Zt[10]*dt,Wr=Zt[11]*dt,Rr=Zt[8]*Wt,Rn=Zt[9]*Wt,Dr=Zt[10]*Wt,Jr=Zt[11]*Wt;for(const An of Nt){const Kn=[],Vn=[];for(const qn of An){const Jn=qn.x+xr.x,pi=qn.y+xr.y,uo=Zt[0]*Jn+Zt[4]*pi+Zt[12],kn=Zt[1]*Jn+Zt[5]*pi+Zt[13],Fi=Zt[2]*Jn+Zt[6]*pi+Zt[14],ki=Zt[3]*Jn+Zt[7]*pi+Zt[15],bn=uo+Tr,ai=kn+Zr,Gi=Fi+Yr,In=Math.max(ki+Wr,1e-5),xi=uo+Rr,$o=kn+Rn,co=Fi+Dr,fo=Math.max(ki+Jr,1e-5);Kn.push(new Zm(bn/In,ai/In,Gi/In)),Vn.push(new Zm(xi/fo,$o/fo,co/fo))}ar.push(Kn),Yt.push(Vn)}return[ar,Yt]}(ke,Te,lt,it,vt)}(_,d,N,M,k,w,ie,B,Y,_.center.lat,u.tileID.canonical),he=u.queryGeometry;return function(Se,ke,Te){let lt=1/0;m4(Te,ke)&&(lt=U4(Te,ke[0]));for(let it=0;it<ke.length;it++){const vt=ke[it],$t=Se[it];for(let ht=0;ht<vt.length-1;ht++){const bt=vt[ht],St=[bt,vt[ht+1],$t[ht+1],$t[ht],bt];p4(Te,St)&&(lt=Math.min(lt,U4(Te,St)))}}return lt!==1/0&&lt}(pe,Ce,he.isPointQuery()?he.screenBounds:he.screenGeometry)}},line:class extends Ks{constructor(u){super(u,G4),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(u){if(u==="line-gradient"){const l=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=l._styleExpression&&l._styleExpression.expression instanceof wb,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(u,l){super.recalculate(u,l),this.paint._values["line-floorwidth"]=Y4.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,u)}createBucket(u){return new WE(u)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getProgramConfiguration(u){return new uf(this,u)}queryRadius(u){const l=u,c=K4(Ym("line-width",this,l),Ym("line-gap-width",this,l)),d=Ym("line-offset",this,l);return c/2+Math.abs(d)+$E(this.paint.get("line-translate"))}queryIntersectsFeature(u,l,c,d,y,_){if(u.queryGeometry.isAboveHorizon)return!1;const w=_4(u.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),_.angle,u.pixelToTileUnitsFactor),C=u.pixelToTileUnitsFactor/2*K4(this.paint.get("line-width").evaluate(l,c),this.paint.get("line-gap-width").evaluate(l,c)),O=this.paint.get("line-offset").evaluate(l,c);return O&&(d=function(k,M){const N=[],B=new K(0,0);for(let W=0;W<k.length;W++){const Y=k[W],J=[];for(let ie=0;ie<Y.length;ie++){const pe=Y[ie-1],Ce=Y[ie],he=Y[ie+1],Se=ie===0?B:Ce.sub(pe)._unit()._perp(),ke=ie===Y.length-1?B:he.sub(Ce)._unit()._perp(),Te=Se._add(ke)._unit();Te._mult(1/(Te.x*ke.x+Te.y*ke.y)),J.push(Te._mult(M)._add(Ce))}N.push(J)}return N}(d,O*u.pixelToTileUnitsFactor)),function(k,M,N){for(let B=0;B<M.length;B++){const W=M[B];if(k.length>=3){for(let Y=0;Y<W.length;Y++)if(ud(k,W[Y]))return!0}if(Kce(k,W,N))return!0}return!1}(w,d,C)}isTileClipped(){return!0}},symbol:iT,background:class extends Ks{constructor(u){super(u,Nhe)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends Ks{constructor(u){super(u,Bhe)}getProgramIds(){return["raster"]}},sky:class extends Ks{constructor(u){super(u,zhe),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(u){u==="sky-gradient"?this._updateColorRamp():u!=="sky-atmosphere-sun"&&u!=="sky-atmosphere-halo-color"&&u!=="sky-atmosphere-color"&&u!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=KI({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(u){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const l=u.style.light.properties.get("position");return this._lightPosition.azimuthal!==l.azimuthal||this._lightPosition.polar!==l.polar}return!1}getCenter(u,l){if(this.paint.get("sky-type")==="atmosphere"){const d=this.paint.get("sky-atmosphere-sun"),y=!d,_=u.style.light,w=_.properties.get("position");return y&&_.properties.get("anchor")==="viewport"&&Ft("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),y?mM(w.azimuthal,90-w.polar,l):mM(d[0],90-d[1],l)}const c=this.paint.get("sky-gradient-center");return mM(c[0],90-c[1],l)}is3D(){return!1}isSky(){return!0}markSkyboxValid(u){this._skyboxInvalidated=!1,this._lightPosition=u.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const u=this.paint.get("sky-type");return u==="atmosphere"?["skyboxCapture","skybox"]:u==="gradient"?["skyboxGradient"]:null}}};class Tw{constructor(l,c,d,y){this.context=l,this.format=d,this.texture=l.gl.createTexture(),this.update(c,y)}update(l,c,d){const{width:y,height:_}=l,{context:w}=this,{gl:C}=w,{HTMLImageElement:O,HTMLCanvasElement:k,HTMLVideoElement:M,ImageData:N,ImageBitmap:B}=h;if(C.bindTexture(C.TEXTURE_2D,this.texture),w.pixelStoreUnpackFlipY.set(!1),w.pixelStoreUnpack.set(1),w.pixelStoreUnpackPremultiplyAlpha.set(this.format===C.RGBA&&(!c||c.premultiply!==!1)),d||this.size&&this.size[0]===y&&this.size[1]===_){const{x:W,y:Y}=d||{x:0,y:0};l instanceof O||l instanceof k||l instanceof M||l instanceof N||B&&l instanceof B?C.texSubImage2D(C.TEXTURE_2D,0,W,Y,C.RGBA,C.UNSIGNED_BYTE,l):C.texSubImage2D(C.TEXTURE_2D,0,W,Y,y,_,C.RGBA,C.UNSIGNED_BYTE,l.data)}else this.size=[y,_],l instanceof O||l instanceof k||l instanceof M||l instanceof N||B&&l instanceof B?C.texImage2D(C.TEXTURE_2D,0,this.format,this.format,C.UNSIGNED_BYTE,l):C.texImage2D(C.TEXTURE_2D,0,this.format,y,_,0,this.format,C.UNSIGNED_BYTE,l.data);this.useMipmap=!!(c&&c.useMipmap&&this.isSizePowerOfTwo()),this.useMipmap&&C.generateMipmap(C.TEXTURE_2D)}bind(l,c){const{context:d}=this,{gl:y}=d;y.bindTexture(y.TEXTURE_2D,this.texture),l!==this.filter&&(y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MAG_FILTER,l),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MIN_FILTER,this.useMipmap?l===y.NEAREST?y.NEAREST_MIPMAP_NEAREST:y.LINEAR_MIPMAP_NEAREST:l),this.filter=l),c!==this.wrap&&(y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_S,c),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_T,c),this.wrap=c)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:l}=this.context;l.deleteTexture(this.texture),this.texture=null}}class Hhe{constructor(l){this._callback=l,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class Vhe{constructor(){this.tasks={},this.taskQueue=[],je(["process"],this),this.invoker=new Hhe(this.process),this.nextId=0}add(l,c){const d=this.nextId++,y=function({type:_,isSymbolTile:w,zoom:C}){return C=C||0,_==="message"?0:_!=="maybePrepare"||w?_!=="parseTile"||w?_==="parseTile"&&w?300-C:_==="maybePrepare"&&w?400-C:500:200-C:100-C}(c);if(y===0){wr();try{l()}finally{}return{cancel:()=>{}}}return this.tasks[d]={fn:l,metadata:c,priority:y,id:d},this.taskQueue.push(d),this.invoker.trigger(),{cancel:()=>{delete this.tasks[d]}}}process(){wr();try{if(this.taskQueue=this.taskQueue.filter(d=>!!this.tasks[d]),!this.taskQueue.length)return;const l=this.pick();if(l===null)return;const c=this.tasks[l];if(delete this.tasks[l],this.taskQueue.length&&this.invoker.trigger(),!c)return;c.fn()}finally{}}pick(){let l=null,c=1/0;for(let y=0;y<this.taskQueue.length;y++){const _=this.tasks[this.taskQueue[y]];_.priority<c&&(c=_.priority,l=y)}if(l===null)return null;const d=this.taskQueue[l];return this.taskQueue.splice(l,1),d}remove(){this.invoker.remove()}}class kW{constructor(l){this._stringToNumber={},this._numberToString=[];for(let c=0;c<l.length;c++){const d=l[c];this._stringToNumber[d]=c,this._numberToString[c]=d}}encode(l){return this._stringToNumber[l]}decode(l){return this._numberToString[l]}}const Uhe=["tile","layer","source","sourceLayer","state"];class PW{constructor(l,c,d,y,_){this.type="Feature",this._vectorTileFeature=l,this._z=c,this._x=d,this._y=y,this.properties=l.properties,this.id=_}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(l){this._geometry=l}toJSON(){const l={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};this.id!==void 0&&(l.id=this.id);for(const c of Uhe)this[c]!==void 0&&(l[c]=this[c]);return l}}const bs=32,Dl=33,pf=new Uint16Array(8184);for(let u=0;u<2046;u++){let l=u+2,c=0,d=0,y=0,_=0,w=0,C=0;for(1&l?y=_=w=bs:c=d=C=bs;(l>>=1)>1;){const k=c+y>>1,M=d+_>>1;1&l?(y=c,_=d,c=w,d=C):(c=y,d=_,y=w,_=C),w=k,C=M}const O=4*u;pf[O+0]=c,pf[O+1]=d,pf[O+2]=y,pf[O+3]=_}const $l=new Uint16Array(2178),mf=new Uint8Array(1089),oT=new Uint16Array(1089);function AW(u){return u===0?-.03125:u===32?.03125:0}var IW=fr([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const MW={type:2,extent:kr,loadGeometry:()=>[[new K(0,0),new K(8193,0),new K(8193,8193),new K(0,8193),new K(0,0)]]};class yM{constructor(l,c,d,y,_){this.tileID=l,this.uid=ne(),this.uses=0,this.tileSize=c,this.tileZoom=d,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=_,this.expiredRequestCount=0,this.state="loading",y&&y.transform&&(this.projection=y.transform.projection)}registerFadeDuration(l){const c=l+this.timeAdded;c<pr.now()||this.fadeEndTime&&c<this.fadeEndTime||(this.fadeEndTime=c)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=fd(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(l,c,d){if(this.unloadVectorData(),this.state="loaded",l){l.featureIndex&&(this.latestFeatureIndex=l.featureIndex,l.rawTileData?(this.latestRawTileData=l.rawTileData,this.latestFeatureIndex.rawTileData=l.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=l.collisionBoxArray,this.buckets=function(y,_){const w={};if(!_)return w;for(const C of y){const O=C.layerIds.map(k=>_.getLayer(k)).filter(Boolean);if(O.length!==0){C.layers=O,C.stateDependentLayerIds&&(C.stateDependentLayers=C.stateDependentLayerIds.map(k=>O.filter(M=>M.id===k)[0]));for(const k of O)w[k.id]=C}}return w}(l.buckets,c.style),this.hasSymbolBuckets=!1;for(const y in this.buckets){const _=this.buckets[y];if(_ instanceof df){if(this.hasSymbolBuckets=!0,!d)break;_.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const y in this.buckets){const _=this.buckets[y];if(_ instanceof df&&_.hasRTLText){this.hasRTLText=!0,De.isLoading()||De.isLoaded()||Pe()!=="deferred"||Oe();break}}this.queryPadding=0;for(const y in this.buckets){const _=this.buckets[y];this.queryPadding=Math.max(this.queryPadding,c.style.getLayer(y).queryRadius(_))}l.imageAtlas&&(this.imageAtlas=l.imageAtlas),l.glyphAtlasImage&&(this.glyphAtlasImage=l.glyphAtlasImage),l.lineAtlas&&(this.lineAtlas=l.lineAtlas)}else this.collisionBoxArray=new xI}unloadVectorData(){if(this.hasData()){for(const l in this.buckets)this.buckets[l].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(l){return this.buckets[l.id]}upload(l){for(const d in this.buckets){const y=this.buckets[d];y.uploadPending()&&y.upload(l)}const c=l.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Tw(l,this.imageAtlas.image,c.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Tw(l,this.glyphAtlasImage,c.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new Tw(l,this.lineAtlas.image,c.ALPHA),this.lineAtlas.uploaded=!0)}prepare(l){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(l,this.imageAtlasTexture)}queryRenderedFeatures(l,c,d,y,_,w,C,O){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:y,pixelPosMatrix:C,transform:w,params:_,tileTransform:this.tileTransform},l,c,d):{}}querySourceFeatures(l,c){const d=this.latestFeatureIndex;if(!d||!d.rawTileData)return;const y=d.loadVTLayers(),_=c?c.sourceLayer:"",w=y._geojsonTileLayer||y[_];if(!w)return;const C=Pm(c&&c.filter),{z:O,x:k,y:M}=this.tileID.canonical,N={z:O,x:k,y:M};for(let B=0;B<w.length;B++){const W=w.feature(B);if(C.needGeometry){const ie=ld(W,!0);if(!C.filter(new Xe(this.tileID.overscaledZ),ie,this.tileID.canonical))continue}else if(!C.filter(new Xe(this.tileID.overscaledZ),W))continue;const Y=d.getId(W,_),J=new PW(W,O,k,M,Y);J.tile=N,l.push(J)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(l){const c=this.expirationTime;if(l.cacheControl){const d=$r(l.cacheControl);d["max-age"]&&(this.expirationTime=Date.now()+1e3*d["max-age"])}else l.expires&&(this.expirationTime=new Date(l.expires).getTime());if(this.expirationTime){const d=Date.now();let y=!1;if(this.expirationTime>d)y=!1;else if(c)if(this.expirationTime<c)y=!0;else{const _=this.expirationTime-c;_?this.expirationTime=d+Math.max(_,3e4):y=!0}else y=!0;y?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(l,c){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(l).length===0||!c)return;const d=this.latestFeatureIndex.loadVTLayers(),y=c.style.listImages();for(const _ in this.buckets){if(!c.style.hasLayer(_))continue;const w=this.buckets[_],C=w.layers[0].sourceLayer||"_geojsonTileLayer",O=d[C],k=l[C];if(!O||!k||Object.keys(k).length===0)continue;if(w.update(k,O,y,this.imageAtlas&&this.imageAtlas.patternPositions||{}),w instanceof WE||w instanceof zE){const N=c.style._getSourceCache(w.layers[0].source);c._terrain&&c._terrain.enabled&&N&&w.programConfigurations.needsUpload&&c._terrain._clearRenderCacheForTile(N.id,this.tileID)}const M=c&&c.style&&c.style.getLayer(_);M&&(this.queryPadding=Math.max(this.queryPadding,M.queryRadius(w)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<pr.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(l){this.symbolFadeHoldUntil=pr.now()+l}setTexture(l,c){const d=c.context,y=d.gl;this.texture=this.texture||c.getTileTexture(l.width),this.texture?this.texture.update(l,{useMipmap:!0}):(this.texture=new Tw(d,l,y.RGBA,{useMipmap:!0}),this.texture.bind(y.LINEAR,y.CLAMP_TO_EDGE))}setDependencies(l,c){const d={};for(const y of c)d[y]=!0;this.dependencies[l]=d}hasDependency(l,c){for(const d of l){const y=this.dependencies[d];if(y){for(const _ of c)if(y[_])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(l,c){if(!c||c.name==="mercator"||this._tileDebugBuffer)return;const d=Tu(MW,this.tileID.canonical,this.tileTransform)[0],y=new gr,_=new Rl;for(let w=0;w<d.length;w++){const{x:C,y:O}=d[w];y.emplaceBack(C,O),_.emplaceBack(w)}_.emplaceBack(0),this._tileDebugIndexBuffer=l.createIndexBuffer(_),this._tileDebugBuffer=l.createVertexBuffer(y,iw.members),this._tileDebugSegments=Oi.simpleSegment(0,0,y.length,_.length)}_makeTileBoundsBuffers(l,c){if(this._tileBoundsBuffer||!c||c.name==="mercator")return;const d=Tu(MW,this.tileID.canonical,this.tileTransform)[0];let y,_;if(this.isRaster){const w=function(C,O){const k=fd(C,O),M=Math.pow(2,C.z);for(let ie=0;ie<Dl;ie++)for(let pe=0;pe<Dl;pe++){const Ce=Ga((C.x+(pe+AW(pe))/bs)/M),he=xo((C.y+(ie+AW(ie))/bs)/M),Se=O.project(Ce,he),ke=ie*Dl+pe;$l[2*ke+0]=Math.round((Se.x*k.scale-k.x)*kr),$l[2*ke+1]=Math.round((Se.y*k.scale-k.y)*kr)}mf.fill(0),oT.fill(0);for(let ie=2045;ie>=0;ie--){const pe=4*ie,Ce=pf[pe+0],he=pf[pe+1],Se=pf[pe+2],ke=pf[pe+3],Te=Ce+Se>>1,lt=he+ke>>1,it=Te+lt-he,vt=lt+Ce-Te,$t=he*Dl+Ce,ht=ke*Dl+Se,bt=lt*Dl+Te,St=Math.hypot(($l[2*$t+0]+$l[2*ht+0])/2-$l[2*bt+0],($l[2*$t+1]+$l[2*ht+1])/2-$l[2*bt+1])>=16;if(mf[bt]=mf[bt]||(St?1:0),ie<1022){const Pt=(he+vt>>1)*Dl+(Ce+it>>1),Nt=(ke+vt>>1)*Dl+(Se+it>>1);mf[bt]=mf[bt]||mf[Pt]||mf[Nt]}}const N=new On,B=new So;let W=0;function Y(ie,pe){const Ce=pe*Dl+ie;return oT[Ce]===0&&(N.emplaceBack($l[2*Ce+0],$l[2*Ce+1],ie*kr/bs,pe*kr/bs),oT[Ce]=++W),oT[Ce]-1}function J(ie,pe,Ce,he,Se,ke){const Te=ie+Ce>>1,lt=pe+he>>1;if(Math.abs(ie-Se)+Math.abs(pe-ke)>1&&mf[lt*Dl+Te])J(Se,ke,ie,pe,Te,lt),J(Ce,he,Se,ke,Te,lt);else{const it=Y(ie,pe),vt=Y(Ce,he),$t=Y(Se,ke);B.emplaceBack(it,vt,$t)}}return J(0,0,bs,bs,bs,0),J(bs,bs,0,0,0,bs),{vertices:N,indices:B}}(this.tileID.canonical,c);y=w.vertices,_=w.indices}else{y=new On,_=new So;for(const{x:C,y:O}of d)y.emplaceBack(C,O,0,0);const w=Km(y.int16,void 0,4);for(let C=0;C<w.length;C+=3)_.emplaceBack(w[C],w[C+1],w[C+2])}this._tileBoundsBuffer=l.createVertexBuffer(y,IW.members),this._tileBoundsIndexBuffer=l.createIndexBuffer(_),this._tileBoundsSegments=Oi.simpleSegment(0,0,y.length,_.length)}_makeGlobeTileDebugBuffers(l,c){const d=c.projection;if(!d||d.name!=="globe"||c.freezeTileCoverage)return;const y=this.tileID.canonical,_=sw(n4(y,c)),w=Wm(c.zoom);let C;w>0&&(C=RI(new Float64Array(16),c.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(l,y,c,_,C,w),this._makeGlobeTileDebugTextBuffer(l,y,c,_,C,w)}_globePoint(l,c,d,y,_,w,C){let O=aw(l,c,d);if(w){const k=1<<d.z,M=Al(y.center.lng),N=Il(y.center.lat),B=(d.x+.5)/k-M;let W=0;B>.5?W=-1:B<-.5&&(W=1);let Y=(l/kr+d.x)/k+W,J=(c/kr+d.y)/k;Y=(Y-M)*y._pixelsPerMercatorPixel+M,J=(J-N)*y._pixelsPerMercatorPixel+N;const ie=[Y*y.worldSize,J*y.worldSize,0];Si(ie,ie,w),O=sd(O,ie,C)}return Si(O,O,_)}_makeGlobeTileDebugBorderBuffer(l,c,d,y,_,w){const C=new gr,O=new Rl,k=new En,M=(B,W,Y,J,ie)=>{const pe=(Y-B)/(ie-1),Ce=(J-W)/(ie-1),he=C.length;for(let Se=0;Se<ie;Se++){const ke=B+Se*pe,Te=W+Se*Ce;C.emplaceBack(ke,Te);const lt=this._globePoint(ke,Te,c,d,y,_,w);k.emplaceBack(lt[0],lt[1],lt[2]),O.emplaceBack(he+Se)}},N=kr;M(0,0,N,0,16),M(N,0,N,N,16),M(N,N,0,N,16),M(0,N,0,0,16),this._tileDebugIndexBuffer=l.createIndexBuffer(O),this._tileDebugBuffer=l.createVertexBuffer(C,iw.members),this._globeTileDebugBorderBuffer=l.createVertexBuffer(k,t4.members),this._tileDebugSegments=Oi.simpleSegment(0,0,C.length,O.length)}_makeGlobeTileDebugTextBuffer(l,c,d,y,_,w){const C=new gr,O=new So,k=new En,M=25;O.reserve(32),C.reserve(M),k.reserve(M);const N=(B,W)=>M*B+W;for(let B=0;B<M;B++){const W=2048*B;for(let Y=0;Y<M;Y++){const J=2048*Y;C.emplaceBack(J,W);const ie=this._globePoint(J,W,c,d,y,_,w);k.emplaceBack(ie[0],ie[1],ie[2])}}for(let B=0;B<4;B++)for(let W=0;W<4;W++){const Y=N(B,W),J=N(B,W+1),ie=N(B+1,W),pe=N(B+1,W+1);O.emplaceBack(Y,J,ie),O.emplaceBack(ie,J,pe)}this._tileDebugTextIndexBuffer=l.createIndexBuffer(O),this._tileDebugTextBuffer=l.createVertexBuffer(C,iw.members),this._globeTileDebugTextBuffer=l.createVertexBuffer(k,t4.members),this._tileDebugTextSegments=Oi.simpleSegment(0,0,M,32)}}class Whe{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(l,c,d){const y=String(c);if(this.stateChanges[l]=this.stateChanges[l]||{},this.stateChanges[l][y]=this.stateChanges[l][y]||{},U(this.stateChanges[l][y],d),this.deletedStates[l]===null){this.deletedStates[l]={};for(const _ in this.state[l])_!==y&&(this.deletedStates[l][_]=null)}else if(this.deletedStates[l]&&this.deletedStates[l][y]===null){this.deletedStates[l][y]={};for(const _ in this.state[l][y])d[_]||(this.deletedStates[l][y][_]=null)}else for(const _ in d)this.deletedStates[l]&&this.deletedStates[l][y]&&this.deletedStates[l][y][_]===null&&delete this.deletedStates[l][y][_]}removeFeatureState(l,c,d){if(this.deletedStates[l]===null)return;const y=String(c);if(this.deletedStates[l]=this.deletedStates[l]||{},d&&c!==void 0)this.deletedStates[l][y]!==null&&(this.deletedStates[l][y]=this.deletedStates[l][y]||{},this.deletedStates[l][y][d]=null);else if(c!==void 0)if(this.stateChanges[l]&&this.stateChanges[l][y])for(d in this.deletedStates[l][y]={},this.stateChanges[l][y])this.deletedStates[l][y][d]=null;else this.deletedStates[l][y]=null;else this.deletedStates[l]=null}getState(l,c){const d=String(c),y=U({},(this.state[l]||{})[d],(this.stateChanges[l]||{})[d]);if(this.deletedStates[l]===null)return{};if(this.deletedStates[l]){const _=this.deletedStates[l][c];if(_===null)return{};for(const w in _)delete y[w]}return y}initializeTileState(l,c){l.setFeatureState(this.state,c)}coalesceChanges(l,c){const d={};for(const y in this.stateChanges){this.state[y]=this.state[y]||{};const _={};for(const w in this.stateChanges[y])this.state[y][w]||(this.state[y][w]={}),U(this.state[y][w],this.stateChanges[y][w]),_[w]=this.state[y][w];d[y]=_}for(const y in this.deletedStates){this.state[y]=this.state[y]||{};const _={};if(this.deletedStates[y]===null)for(const w in this.state[y])_[w]={},this.state[y][w]={};else for(const w in this.deletedStates[y]){if(this.deletedStates[y][w]===null)this.state[y][w]={};else if(this.state[y][w])for(const C of Object.keys(this.deletedStates[y][w]))delete this.state[y][w][C];_[w]=this.state[y][w]}d[y]=d[y]||{},U(d[y],_)}if(this.stateChanges={},this.deletedStates={},Object.keys(d).length!==0)for(const y in l)l[y].setFeatureState(d,c)}}class DW{constructor(l){this.size=l,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(l,c){const d=this.toIdx(l,c);return{min:this.minimums[d],max:this.maximums[d]}}isLeaf(l,c){return this.leaves[this.toIdx(l,c)]}toIdx(l,c){return c*this.size+l}}function $W(u,l,c,d){let y=0,_=Number.MAX_VALUE;for(let w=0;w<3;w++)if(Math.abs(d[w])<1e-15){if(c[w]<u[w]||c[w]>l[w])return null}else{const C=1/d[w];let O=(u[w]-c[w])*C,k=(l[w]-c[w])*C;if(O>k){const M=O;O=k,k=M}if(O>y&&(y=O),k<_&&(_=k),y>_)return null}return y}function LW(u,l,c,d,y,_,w,C,O,k,M){const N=d-u,B=y-l,W=_-c,Y=w-u,J=C-l,ie=O-c,pe=M[1]*ie-M[2]*J,Ce=M[2]*Y-M[0]*ie,he=M[0]*J-M[1]*Y,Se=N*pe+B*Ce+W*he;if(Math.abs(Se)<1e-15)return null;const ke=1/Se,Te=k[0]-u,lt=k[1]-l,it=k[2]-c,vt=(Te*pe+lt*Ce+it*he)*ke;if(vt<0||vt>1)return null;const $t=lt*W-it*B,ht=it*N-Te*W,bt=Te*B-lt*N,St=(M[0]*$t+M[1]*ht+M[2]*bt)*ke;return St<0||vt+St>1?null:(Y*$t+J*ht+ie*bt)*ke}function NW(u,l,c){return(u-l)/(c-l)}function BW(u,l,c,d,y,_,w,C,O){const k=1<<c,M=_-d,N=w-y,B=(u+1)/k*M+d,W=(l+0)/k*N+y,Y=(l+1)/k*N+y;C[0]=(u+0)/k*M+d,C[1]=W,O[0]=B,O[1]=Y}class jW{constructor(l){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=l,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const c=function(_){const w=Math.ceil(Math.log2(_.dim/8)),C=[];let O=Math.ceil(Math.pow(2,w));const k=1/O,M=(W,Y,J,ie,pe)=>{const Ce=ie?1:0,he=(W+1)*J-Ce,Se=Y*J,ke=(Y+1)*J-Ce;pe[0]=W*J,pe[1]=Se,pe[2]=he,pe[3]=ke};let N=new DW(O);const B=[];for(let W=0;W<O*O;W++){M(W%O,Math.floor(W/O),k,!1,B);const Y=yf(B[0],B[1],_),J=yf(B[2],B[1],_),ie=yf(B[2],B[3],_),pe=yf(B[0],B[3],_);N.minimums.push(Math.min(Y,J,ie,pe)),N.maximums.push(Math.max(Y,J,ie,pe)),N.leaves.push(1)}for(C.push(N),O/=2;O>=1;O/=2){const W=C[C.length-1];N=new DW(O);for(let Y=0;Y<O*O;Y++){M(Y%O,Math.floor(Y/O),2,!0,B);const J=W.getElevation(B[0],B[1]),ie=W.getElevation(B[2],B[1]),pe=W.getElevation(B[2],B[3]),Ce=W.getElevation(B[0],B[3]),he=W.isLeaf(B[0],B[1]),Se=W.isLeaf(B[2],B[1]),ke=W.isLeaf(B[2],B[3]),Te=W.isLeaf(B[0],B[3]),lt=Math.min(J.min,ie.min,pe.min,Ce.min),it=Math.max(J.max,ie.max,pe.max,Ce.max),vt=he&&Se&&ke&&Te;N.maximums.push(it),N.minimums.push(lt),N.leaves.push(it-lt<=5&&vt?1:0)}C.push(N)}return C}(this.dem),d=c.length-1,y=c[d];this._addNode(y.minimums[0],y.maximums[0],y.leaves[0]),this._construct(c,0,0,d,0)}raycastRoot(l,c,d,y,_,w,C=1){return $W([l,c,-100],[d,y,this.maximums[0]*C],_,w)}raycast(l,c,d,y,_,w,C=1){if(!this.nodeCount)return null;const O=this.raycastRoot(l,c,d,y,_,w,C);if(O==null)return null;const k=[],M=[],N=[],B=[],W=[{idx:0,t:O,nodex:0,nodey:0,depth:0}];for(;W.length>0;){const{idx:Y,t:J,nodex:ie,nodey:pe,depth:Ce}=W.pop();if(this.leaves[Y]){BW(ie,pe,Ce,l,c,d,y,N,B);const Se=1<<Ce,ke=(ie+0)/Se,Te=(ie+1)/Se,lt=(pe+0)/Se,it=(pe+1)/Se,vt=yf(ke,lt,this.dem)*C,$t=yf(Te,lt,this.dem)*C,ht=yf(Te,it,this.dem)*C,bt=yf(ke,it,this.dem)*C,St=LW(N[0],N[1],vt,B[0],N[1],$t,B[0],B[1],ht,_,w),Pt=LW(B[0],B[1],ht,N[0],B[1],bt,N[0],N[1],vt,_,w),Nt=Math.min(St!==null?St:Number.MAX_VALUE,Pt!==null?Pt:Number.MAX_VALUE);if(Nt!==Number.MAX_VALUE)return Nt;{const dt=rw([],_,w,J);if(zW(vt,$t,bt,ht,NW(dt[0],N[0],B[0]),NW(dt[1],N[1],B[1]))>=dt[2])return J}continue}let he=0;for(let Se=0;Se<this._siblingOffset.length;Se++){BW((ie<<1)+this._siblingOffset[Se][0],(pe<<1)+this._siblingOffset[Se][1],Ce+1,l,c,d,y,N,B),N[2]=-100,B[2]=this.maximums[this.childOffsets[Y]+Se]*C;const ke=$W(N,B,_,w);if(ke!=null){const Te=ke;k[Se]=Te;let lt=!1;for(let it=0;it<he&&!lt;it++)Te>=k[M[it]]&&(M.splice(it,0,Se),lt=!0);lt||(M[he]=Se),he++}}for(let Se=0;Se<he;Se++){const ke=M[Se];W.push({idx:this.childOffsets[Y]+ke,t:k[ke],nodex:(ie<<1)+this._siblingOffset[ke][0],nodey:(pe<<1)+this._siblingOffset[ke][1],depth:Ce+1})}}return null}_addNode(l,c,d){return this.minimums.push(l),this.maximums.push(c),this.leaves.push(d),this.childOffsets.push(0),this.nodeCount++}_construct(l,c,d,y,_){if(l[y].isLeaf(c,d)===1)return;this.childOffsets[_]||(this.childOffsets[_]=this.nodeCount);const w=y-1,C=l[w];let O=0,k=0;for(let M=0;M<this._siblingOffset.length;M++){const N=2*c+this._siblingOffset[M][0],B=2*d+this._siblingOffset[M][1],W=C.getElevation(N,B),Y=C.isLeaf(N,B),J=this._addNode(W.min,W.max,Y);Y&&(O|=1<<M),k||(k=J)}for(let M=0;M<this._siblingOffset.length;M++)O&1<<M||this._construct(l,2*c+this._siblingOffset[M][0],2*d+this._siblingOffset[M][1],w,k+M)}}function zW(u,l,c,d,y,_){return mn(mn(u,c,_),mn(l,d,_),y)}function yf(u,l,c){const d=c.dim,y=Fe(u*d-.5,0,d-1),_=Fe(l*d-.5,0,d-1),w=Math.floor(y),C=Math.floor(_),O=Math.min(w+1,d-1),k=Math.min(C+1,d-1);return zW(c.get(w,C),c.get(O,C),c.get(w,k),c.get(O,k),y-w,_-C)}const FW={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function Ghe(u,l,c){return(256*u*256+256*l+c)/10-1e4}function Yhe(u,l,c){return 256*u+l+c/256-32768}class aT{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(l,c,d,y=!1,_=!1){if(this.uid=l,c.height!==c.width)throw new RangeError("DEM tiles must be square");if(d&&d!=="mapbox"&&d!=="terrarium")return Ft(`"${d}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=c.height;const w=this.dim=c.height-2,C=new Uint32Array(c.data.buffer);if(this.pixels=new Uint8Array(c.data.buffer),this.encoding=d||"mapbox",this.borderReady=y,!y){for(let O=0;O<w;O++)C[this._idx(-1,O)]=C[this._idx(0,O)],C[this._idx(w,O)]=C[this._idx(w-1,O)],C[this._idx(O,-1)]=C[this._idx(O,0)],C[this._idx(O,w)]=C[this._idx(O,w-1)];C[this._idx(-1,-1)]=C[this._idx(0,0)],C[this._idx(w,-1)]=C[this._idx(w-1,0)],C[this._idx(-1,w)]=C[this._idx(0,w-1)],C[this._idx(w,w)]=C[this._idx(w-1,w-1)],_&&this._buildQuadTree()}}_buildQuadTree(){this._tree=new jW(this)}get(l,c,d=!1){d&&(l=Fe(l,-1,this.dim),c=Fe(c,-1,this.dim));const y=4*this._idx(l,c);return(this.encoding==="terrarium"?Yhe:Ghe)(this.pixels[y],this.pixels[y+1],this.pixels[y+2])}static getUnpackVector(l){return FW[l]}get unpackVector(){return FW[this.encoding]}_idx(l,c){if(l<-1||l>=this.dim+1||c<-1||c>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(c+1)*this.stride+(l+1)}static pack(l,c){const d=[0,0,0,0],y=aT.getUnpackVector(c);let _=Math.floor((l+y[3])/y[2]);return d[2]=_%256,_=Math.floor(_/256),d[1]=_%256,_=Math.floor(_/256),d[0]=_,d}getPixels(){return new Oa({width:this.stride,height:this.stride},this.pixels)}backfillBorder(l,c,d){if(this.dim!==l.dim)throw new Error("dem dimension mismatch");let y=c*this.dim,_=c*this.dim+this.dim,w=d*this.dim,C=d*this.dim+this.dim;switch(c){case-1:y=_-1;break;case 1:_=y+1}switch(d){case-1:w=C-1;break;case 1:C=w+1}const O=-c*this.dim,k=-d*this.dim;for(let M=w;M<C;M++)for(let N=y;N<_;N++){const B=4*this._idx(N,M),W=4*this._idx(N+O,M+k);this.pixels[B+0]=l.pixels[W+0],this.pixels[B+1]=l.pixels[W+1],this.pixels[B+2]=l.pixels[W+2],this.pixels[B+3]=l.pixels[W+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}tr(aT,"DEMData"),tr(jW,"DemMinMaxQuadTree",{omit:["dem"]});class Khe{constructor(l,c){this.max=l,this.onRemove=c,this.reset()}reset(){for(const l in this.data)for(const c of this.data[l])c.timeout&&clearTimeout(c.timeout),this.onRemove(c.value);return this.data={},this.order=[],this}add(l,c,d){const y=l.wrapped().key;this.data[y]===void 0&&(this.data[y]=[]);const _={value:c,timeout:void 0};if(d!==void 0&&(_.timeout=setTimeout(()=>{this.remove(l,_)},d)),this.data[y].push(_),this.order.push(y),this.order.length>this.max){const w=this._getAndRemoveByKey(this.order[0]);w&&this.onRemove(w)}return this}has(l){return l.wrapped().key in this.data}getAndRemove(l){return this.has(l)?this._getAndRemoveByKey(l.wrapped().key):null}_getAndRemoveByKey(l){const c=this.data[l].shift();return c.timeout&&clearTimeout(c.timeout),this.data[l].length===0&&delete this.data[l],this.order.splice(this.order.indexOf(l),1),c.value}getByKey(l){const c=this.data[l];return c?c[0].value:null}get(l){return this.has(l)?this.data[l.wrapped().key][0].value:null}remove(l,c){if(!this.has(l))return this;const d=l.wrapped().key,y=c===void 0?0:this.data[d].indexOf(c),_=this.data[d][y];return this.data[d].splice(y,1),_.timeout&&clearTimeout(_.timeout),this.data[d].length===0&&delete this.data[d],this.onRemove(_.value),this.order.splice(this.order.indexOf(d),1),this}setMaxSize(l){for(this.max=l;this.order.length>this.max;){const c=this._getAndRemoveByKey(this.order[0]);c&&this.onRemove(c)}return this}filter(l){const c=[];for(const d in this.data)for(const y of this.data[d])l(y.value)||c.push(y);for(const d of c)this.remove(d.value.tileID,d)}}class oy{constructor(l,c,d){this.func=l,this.mask=c,this.range=d}}oy.ReadOnly=!1,oy.ReadWrite=!0,oy.disabled=new oy(519,oy.ReadOnly,[0,1]);const gM=7680;class vM{constructor(l,c,d,y,_,w){this.test=l,this.ref=c,this.mask=d,this.fail=y,this.depthFail=_,this.pass=w}}vM.disabled=new vM({func:519,mask:0},0,0,gM,gM,gM);class Ll{constructor(l,c,d){this.blendFunction=l,this.blendColor=c,this.mask=d}}Ll.Replace=[1,0],Ll.disabled=new Ll(Ll.Replace,wi.transparent,[!1,!1,!1,!1]),Ll.unblended=new Ll(Ll.Replace,wi.transparent,[!0,!0,!0,!0]),Ll.alphaBlended=new Ll([1,771],wi.transparent,[!0,!0,!0,!0]);const _M=1029,bM=2305;class Js{constructor(l,c,d){this.enable=l,this.mode=c,this.frontFace=d}}Js.disabled=new Js(!1,_M,bM),Js.backCCW=new Js(!0,_M,bM),Js.backCW=new Js(!0,_M,2304),Js.frontCW=new Js(!0,1028,2304),Js.frontCCW=new Js(!0,1028,bM);class hd extends Gn{constructor(l,c,d){super(),this.id=l,this._onlySymbols=d,c.on("data",y=>{y.dataType==="source"&&y.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&y.dataType==="source"&&y.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),c.on("error",()=>{this._sourceErrored=!0}),this._source=c,this._tiles={},this._cache=new Khe(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=c.minTileCacheSize,this._maxTileCacheSize=c.maxTileCacheSize,this._loadedParentTiles={},this._coveredTiles={},this._state=new Whe,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(l){this.map=l,this._minTileCacheSize=this._minTileCacheSize===void 0&&l?l._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&l?l._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const l in this._tiles){const c=this._tiles[l];if(c.state!=="loaded"&&c.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const l=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,l&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(l,c){return l.isSymbolTile=this._onlySymbols,this._source.loadTile(l,c)}_unloadTile(l){if(this._source.unloadTile)return this._source.unloadTile(l,()=>{})}_abortTile(l){if(this._source.abortTile)return this._source.abortTile(l,()=>{})}serialize(){return this._source.serialize()}prepare(l){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const c in this._tiles){const d=this._tiles[c];d.upload(l),d.prepare(this.map.style.imageManager)}}getIds(){return D(this._tiles).map(l=>l.tileID).sort(HW).map(l=>l.key)}getRenderableIds(l){const c=[];for(const d in this._tiles)this._isIdRenderable(+d,l)&&c.push(this._tiles[d]);return l?c.sort((d,y)=>{const _=d.tileID,w=y.tileID,C=new K(_.canonical.x,_.canonical.y)._rotate(this.transform.angle),O=new K(w.canonical.x,w.canonical.y)._rotate(this.transform.angle);return _.overscaledZ-w.overscaledZ||O.y-C.y||O.x-C.x}).map(d=>d.tileID.key):c.map(d=>d.tileID).sort(HW).map(d=>d.key)}hasRenderableParent(l){const c=this.findLoadedParent(l,0);return!!c&&this._isIdRenderable(c.tileID.key)}_isIdRenderable(l,c){return this._tiles[l]&&this._tiles[l].hasData()&&!this._coveredTiles[l]&&(c||!this._tiles[l].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const l in this._tiles)this._tiles[l].state!=="errored"&&this._reloadTile(+l,"reloading")}}_reloadTile(l,c){const d=this._tiles[l];d&&(d.state!=="loading"&&(d.state=c),this._loadTile(d,this._tileLoaded.bind(this,d,l,c)))}_tileLoaded(l,c,d,y){if(y)if(l.state="errored",y.status!==404)this._source.fire(new oa(y,{tile:l}));else if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const _=this.map.painter.terrain;this.update(this.transform,_.getScaledDemTileSize(),!0),_.resetTileLookupCache(this.id)}else this.update(this.transform);else l.timeAdded=pr.now(),d==="expired"&&(l.refreshedUponExpiration=!0),this._setTileReloadTimer(c,l),this._source.type==="raster-dem"&&l.dem&&this._backfillDEM(l),this._state.initializeTileState(l,this.map?this.map.painter:null),this._source.fire(new Lr("data",{dataType:"source",tile:l,coord:l.tileID,sourceCacheId:this.id}))}_backfillDEM(l){const c=this.getRenderableIds();for(let y=0;y<c.length;y++){const _=c[y];if(l.neighboringTiles&&l.neighboringTiles[_]){const w=this.getTileByID(_);d(l,w),d(w,l)}}function d(y,_){if(!y.dem||y.dem.borderReady)return;y.needsHillshadePrepare=!0,y.needsDEMTextureUpload=!0;let w=_.tileID.canonical.x-y.tileID.canonical.x;const C=_.tileID.canonical.y-y.tileID.canonical.y,O=Math.pow(2,y.tileID.canonical.z),k=_.tileID.key;w===0&&C===0||Math.abs(C)>1||(Math.abs(w)>1&&(Math.abs(w+O)===1?w+=O:Math.abs(w-O)===1&&(w-=O)),_.dem&&y.dem&&(y.dem.backfillBorder(_.dem,w,C),y.neighboringTiles&&y.neighboringTiles[k]&&(y.neighboringTiles[k].backfilled=!0)))}}getTile(l){return this.getTileByID(l.key)}getTileByID(l){return this._tiles[l]}_retainLoadedChildren(l,c,d,y){for(const _ in this._tiles){let w=this._tiles[_];if(y[_]||!w.hasData()||w.tileID.overscaledZ<=c||w.tileID.overscaledZ>d)continue;let C=w.tileID;for(;w&&w.tileID.overscaledZ>c+1;){const k=w.tileID.scaledTo(w.tileID.overscaledZ-1);w=this._tiles[k.key],w&&w.hasData()&&(C=k)}let O=C;for(;O.overscaledZ>c;)if(O=O.scaledTo(O.overscaledZ-1),l[O.key]){y[C.key]=C;break}}}findLoadedParent(l,c){if(l.key in this._loadedParentTiles){const d=this._loadedParentTiles[l.key];return d&&d.tileID.overscaledZ>=c?d:null}for(let d=l.overscaledZ-1;d>=c;d--){const y=l.scaledTo(d),_=this._getLoadedTile(y);if(_)return _}}_getLoadedTile(l){const c=this._tiles[l.key];return c&&c.hasData()?c:this._cache.getByKey(this._source.reparseOverscaled?l.wrapped().key:l.canonical.key)}updateCacheSize(l,c){c=c||this._source.tileSize;const d=Math.ceil(l.width/c)+1,y=Math.ceil(l.height/c)+1,_=Math.floor(d*y*5),w=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,_):_,C=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,w):w;this._cache.setMaxSize(C)}handleWrapJump(l){const c=Math.round((l-(this._prevLng===void 0?l:this._prevLng))/360);if(this._prevLng=l,c){const d={};for(const y in this._tiles){const _=this._tiles[y];_.tileID=_.tileID.unwrapTo(_.tileID.wrap+c),d[_.tileID.key]=_}this._tiles=d;for(const y in this._timers)clearTimeout(this._timers[y]),delete this._timers[y];for(const y in this._tiles)this._setTileReloadTimer(+y,this._tiles[y])}}update(l,c,d){if(this.transform=l,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!d)return;let y;this.updateCacheSize(l,c),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?y=l.getVisibleUnwrappedCoordinates(this._source.tileID).map(C=>new Go(C.canonical.z,C.wrap,C.canonical.z,C.canonical.x,C.canonical.y)):(y=l.coveringTiles({tileSize:c||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!d,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(y=y.filter(C=>this._source.hasTile(C)))):y=[];const _=this._updateRetainedTiles(y);if(VW(this._source.type)&&y.length!==0){const C={},O={},k=Object.keys(_);for(const N of k){const B=_[N],W=this._tiles[N];if(!W||W.fadeEndTime&&W.fadeEndTime<=pr.now())continue;const Y=this.findLoadedParent(B,Math.max(B.overscaledZ-hd.maxOverzooming,this._source.minzoom));Y&&(this._addTile(Y.tileID),C[Y.tileID.key]=Y.tileID),O[N]=B}const M=y[y.length-1].overscaledZ;for(const N in this._tiles){const B=this._tiles[N];if(_[N]||!B.hasData())continue;let W=B.tileID;for(;W.overscaledZ>M;){W=W.scaledTo(W.overscaledZ-1);const Y=this._tiles[W.key];if(Y&&Y.hasData()&&O[W.key]){_[N]=B.tileID;break}}}for(const N in C)_[N]||(this._coveredTiles[N]=!0,_[N]=C[N])}for(const C in _)this._tiles[C].clearFadeHold();const w=function(C,O){const k=[];for(const M in C)M in O||k.push(M);return k}(this._tiles,_);for(const C of w){const O=this._tiles[C];O.hasSymbolBuckets&&!O.holdingForFade()?O.setHoldDuration(this.map._fadeDuration):O.hasSymbolBuckets&&!O.symbolFadeFinished()||this._removeTile(+C)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const l in this._tiles)this._tiles[l].holdingForFade()&&this._removeTile(+l)}_updateRetainedTiles(l){const c={};if(l.length===0)return c;const d={},y=l.reduce((k,M)=>Math.min(k,M.overscaledZ),1/0),_=l[0].overscaledZ,w=Math.max(_-hd.maxOverzooming,this._source.minzoom),C=Math.max(_+hd.maxUnderzooming,this._source.minzoom),O={};for(const k of l){const M=this._addTile(k);c[k.key]=k,M.hasData()||y<this._source.maxzoom&&(O[k.key]=k)}this._retainLoadedChildren(O,y,C,c);for(const k of l){let M=this._tiles[k.key];if(M.hasData())continue;if(k.canonical.z>=this._source.maxzoom){const B=k.children(this._source.maxzoom)[0],W=this.getTile(B);if(W&&W.hasData()){c[B.key]=B;continue}}else{const B=k.children(this._source.maxzoom);if(c[B[0].key]&&c[B[1].key]&&c[B[2].key]&&c[B[3].key])continue}let N=M.wasRequested();for(let B=k.overscaledZ-1;B>=w;--B){const W=k.scaledTo(B);if(d[W.key]||(d[W.key]=!0,M=this.getTile(W),!M&&N&&(M=this._addTile(W)),M&&(c[W.key]=W,N=M.wasRequested(),M.hasData())))break}}return c}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const l in this._tiles){const c=[];let d,y=this._tiles[l].tileID;for(;y.overscaledZ>0;){if(y.key in this._loadedParentTiles){d=this._loadedParentTiles[y.key];break}c.push(y.key);const _=y.scaledTo(y.overscaledZ-1);if(d=this._getLoadedTile(_),d)break;y=_}for(const _ of c)this._loadedParentTiles[_]=d}}_addTile(l){let c=this._tiles[l.key];if(c)return c;c=this._cache.getAndRemove(l),c&&(this._setTileReloadTimer(l.key,c),c.tileID=l,this._state.initializeTileState(c,this.map?this.map.painter:null),this._cacheTimers[l.key]&&(clearTimeout(this._cacheTimers[l.key]),delete this._cacheTimers[l.key],this._setTileReloadTimer(l.key,c)));const d=!!c;if(!d){const y=this.map?this.map.painter:null;c=new yM(l,this._source.tileSize*l.overscaleFactor(),this.transform.tileZoom,y,this._isRaster),this._loadTile(c,this._tileLoaded.bind(this,c,l.key,c.state))}return c?(c.uses++,this._tiles[l.key]=c,d||this._source.fire(new Lr("dataloading",{tile:c,coord:c.tileID,dataType:"source"})),c):null}_setTileReloadTimer(l,c){l in this._timers&&(clearTimeout(this._timers[l]),delete this._timers[l]);const d=c.getExpiryTimeout();d&&(this._timers[l]=setTimeout(()=>{this._reloadTile(l,"expired"),delete this._timers[l]},d))}_removeTile(l){const c=this._tiles[l];c&&(c.uses--,delete this._tiles[l],this._timers[l]&&(clearTimeout(this._timers[l]),delete this._timers[l]),c.uses>0||(c.hasData()&&c.state!=="reloading"?this._cache.add(c.tileID,c,c.getExpiryTimeout()):(c.aborted=!0,this._abortTile(c),this._unloadTile(c))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const l in this._tiles)this._removeTile(+l);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(l,c,d){const y=[],_=this.transform;if(!_)return y;const w=_.projection.name==="globe",C=Al(_.center.lng);for(const O in this._tiles){const k=this._tiles[O];if(d&&k.clearQueryDebugViz(),k.holdingForFade())continue;let M;if(w){const N=k.tileID.canonical;if(N.z===0){const B=[Math.abs(Fe(C,...Ow(N,-1))-C),Math.abs(Fe(C,...Ow(N,1))-C)];M=[0,2*B.indexOf(Math.min(...B))-1]}else{const B=[Math.abs(Fe(C,...Ow(N,-1))-C),Math.abs(Fe(C,...Ow(N,0))-C),Math.abs(Fe(C,...Ow(N,1))-C)];M=[B.indexOf(Math.min(...B))-1]}}else M=[0];for(const N of M){const B=l.containsTile(k,_,c,N);B&&y.push(B)}}return y}getVisibleCoordinates(l){const c=this.getRenderableIds(l).map(d=>this._tiles[d].tileID);for(const d of c)d.projMatrix=this.transform.calculateProjMatrix(d.toUnwrapped());return c}hasTransition(){if(this._source.hasTransition())return!0;if(VW(this._source.type))for(const l in this._tiles){const c=this._tiles[l];if(c.fadeEndTime!==void 0&&c.fadeEndTime>=pr.now())return!0}return!1}setFeatureState(l,c,d){this._state.updateState(l=l||"_geojsonTileLayer",c,d)}removeFeatureState(l,c,d){this._state.removeFeatureState(l=l||"_geojsonTileLayer",c,d)}getFeatureState(l,c){return this._state.getState(l=l||"_geojsonTileLayer",c)}setDependencies(l,c,d){const y=this._tiles[l];y&&y.setDependencies(c,d)}reloadTilesForDependencies(l,c){for(const d in this._tiles)this._tiles[d].hasDependency(l,c)&&this._reloadTile(+d,"reloading");this._cache.filter(d=>!d.hasDependency(l,c))}_preloadTiles(l,c){const d=new Map,y=Array.isArray(l)?l:[l],_=this.map.painter.terrain,w=this.usedForTerrain&&_?_.getScaledDemTileSize():this._source.tileSize;for(const C of y){const O=C.coveringTiles({tileSize:w,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const k of O)d.set(k.key,k);this.usedForTerrain&&C.updateElevation(!1)}ae(Array.from(d.values()),(C,O)=>{const k=new yM(C,this._source.tileSize*C.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(k,M=>{this._source.type==="raster-dem"&&k.dem&&this._backfillDEM(k),O(M,k)})},c)}}function HW(u,l){const c=Math.abs(2*u.wrap)-+(u.wrap<0),d=Math.abs(2*l.wrap)-+(l.wrap<0);return u.overscaledZ-l.overscaledZ||d-c||l.canonical.y-u.canonical.y||l.canonical.x-u.canonical.x}function VW(u){return u==="raster"||u==="image"||u==="video"||u==="custom"}function Ow(u,l){const c=1<<u.z;return[u.x/c+l,(u.x+1)/c+l]}hd.maxOverzooming=10,hd.maxUnderzooming=3;class sT{constructor(l,c,d){this._demTile=l,this._dem=this._demTile.dem,this._scale=c,this._offset=d}static create(l,c,d){const y=d||l.findDEMTileFor(c);if(!y||!y.dem)return;const _=y.dem,w=y.tileID,C=1<<c.canonical.z-w.canonical.z;return new sT(y,y.tileSize/kr/C,[(c.canonical.x/C-w.canonical.x)*_.dim,(c.canonical.y/C-w.canonical.y)*_.dim])}tileCoordToPixel(l,c){const d=c*this._scale+this._offset[1],y=Math.floor(l*this._scale+this._offset[0]),_=Math.floor(d);return new K(y,_)}getElevationAt(l,c,d,y){const _=l*this._scale+this._offset[0],w=c*this._scale+this._offset[1],C=Math.floor(_),O=Math.floor(w),k=this._dem;return y=!!y,d?mn(mn(k.get(C,O,y),k.get(C,O+1,y),w-O),mn(k.get(C+1,O,y),k.get(C+1,O+1,y),w-O),_-C):k.get(C,O,y)}getElevationAtPixel(l,c,d){return this._dem.get(l,c,!!d)}getMeterToDEM(l){return(1<<this._demTile.tileID.canonical.z)*Zs(1,l)*this._dem.stride}}class UW{constructor(l,c){this.tileID=l,this.x=l.canonical.x,this.y=l.canonical.y,this.z=l.canonical.z,this.grid=new nf(kr,16,0),this.featureIndexArray=new DU,this.promoteId=c}insert(l,c,d,y,_,w=0){const C=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(d,y,_,w);const O=this.grid;for(let k=0;k<c.length;k++){const M=c[k],N=[1/0,1/0,-1/0,-1/0];for(let B=0;B<M.length;B++){const W=M[B];N[0]=Math.min(N[0],W.x),N[1]=Math.min(N[1],W.y),N[2]=Math.max(N[2],W.x),N[3]=Math.max(N[3],W.y)}N[0]<kr&&N[1]<kr&&N[2]>=0&&N[3]>=0&&O.insert(C,N[0],N[1],N[2],N[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new tM(new _w(this.rawTileData)).layers,this.sourceLayerCoder=new kW(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const l in this.vtLayers)this.vtFeatures[l]=[]}return this.vtLayers}query(l,c,d,y){this.loadVTLayers();const _=l.params||{},w=Pm(_.filter),C=l.tileResult,O=l.transform,k=C.bufferedTilespaceBounds,M=this.grid.query(k.min.x,k.min.y,k.max.x,k.max.y,(Y,J,ie,pe)=>v4(C.bufferedTilespaceGeometry,Y,J,ie,pe));M.sort(qhe);let N=null;O.elevation&&M.length>0&&(N=sT.create(O.elevation,this.tileID));const B={};let W;for(let Y=0;Y<M.length;Y++){const J=M[Y];if(J===W)continue;W=J;const ie=this.featureIndexArray.get(J);let pe=null;this.loadMatchingFeature(B,ie,w,_.layers,_.availableImages,c,d,y,(Ce,he,Se,ke=0)=>(pe||(pe=Tu(Ce,this.tileID.canonical,l.tileTransform)),he.queryIntersectsFeature(C,Ce,Se,pe,this.z,l.transform,l.pixelPosMatrix,N,ke)))}return B}loadMatchingFeature(l,c,d,y,_,w,C,O,k){const{featureIndex:M,bucketIndex:N,sourceLayerIndex:B,layoutVertexArrayOffset:W}=c,Y=this.bucketLayerIDs[N];if(y&&!function(Ce,he){for(let Se=0;Se<Ce.length;Se++)if(he.indexOf(Ce[Se])>=0)return!0;return!1}(y,Y))return;const J=this.sourceLayerCoder.decode(B),ie=this.vtLayers[J].feature(M);if(d.needGeometry){const Ce=ld(ie,!0);if(!d.filter(new Xe(this.tileID.overscaledZ),Ce,this.tileID.canonical))return}else if(!d.filter(new Xe(this.tileID.overscaledZ),ie))return;const pe=this.getId(ie,J);for(let Ce=0;Ce<Y.length;Ce++){const he=Y[Ce];if(y&&y.indexOf(he)<0)continue;const Se=w[he];if(!Se)continue;let ke={};pe!==void 0&&O&&(ke=O.getState(Se.sourceLayer||"_geojsonTileLayer",pe));const Te=U({},C[he]);Te.paint=WW(Te.paint,Se.paint,ie,ke,_),Te.layout=WW(Te.layout,Se.layout,ie,ke,_);const lt=!k||k(ie,Se,ke,W);if(!lt)continue;const it=new PW(ie,this.z,this.x,this.y,pe);it.layer=Te;let vt=l[he];vt===void 0&&(vt=l[he]=[]),vt.push({featureIndex:M,feature:it,intersectionZ:lt})}}lookupSymbolFeatures(l,c,d,y,_,w,C,O){const k={};this.loadVTLayers();const M=Pm(_);for(const N of l)this.loadMatchingFeature(k,{bucketIndex:d,sourceLayerIndex:y,featureIndex:N,layoutVertexArrayOffset:0},M,w,C,O,c);return k}loadFeature(l){const{featureIndex:c,sourceLayerIndex:d}=l;this.loadVTLayers();const y=this.sourceLayerCoder.decode(d),_=this.vtFeatures[y];if(_[c])return _[c];const w=this.vtLayers[y].feature(c);return _[c]=w,w}hasLayer(l){for(const c of this.bucketLayerIDs)for(const d of c)if(l===d)return!0;return!1}getId(l,c){let d=l.id;if(this.promoteId){const y=typeof this.promoteId=="string"?this.promoteId:this.promoteId[c];y!=null&&(d=l.properties[y]),typeof d=="boolean"&&(d=Number(d))}return d}}function WW(u,l,c,d,y){return xt(u,(_,w)=>{const C=l instanceof at?l.get(w):null;return C&&C.evaluate?C.evaluate(c,d,y):C})}function qhe(u,l){return l-u}tr(UW,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});class GW{constructor(l,c){this.width=l,this.height=c,this.nextRow=0,this.image=new Ou({width:l,height:c}),this.positions={},this.uploaded=!1}getDash(l,c){const d=this.getKey(l,c);return this.positions[d]}trim(){const l=this.width,c=this.height=ve(this.nextRow);this.image.resize({width:l,height:c})}getKey(l,c){return l.join(",")+c}getDashRanges(l,c,d){const y=[];let _=l.length%2==1?-l[l.length-1]*d:0,w=l[0]*d,C=!0;y.push({left:_,right:w,isDash:C,zeroLength:l[0]===0});let O=l[0];for(let k=1;k<l.length;k++){C=!C;const M=l[k];_=O*d,O+=M,w=O*d,y.push({left:_,right:w,isDash:C,zeroLength:M===0})}return y}addRoundDash(l,c,d){const y=c/2;for(let _=-d;_<=d;_++){const w=this.width*(this.nextRow+d+_);let C=0,O=l[C];for(let k=0;k<this.width;k++){k/O.right>1&&(O=l[++C]);const M=Math.abs(k-O.left),N=Math.abs(k-O.right),B=Math.min(M,N);let W;const Y=_/d*(y+1);if(O.isDash){const J=y-Math.abs(Y);W=Math.sqrt(B*B+J*J)}else W=y-Math.sqrt(B*B+Y*Y);this.image.data[w+k]=Math.max(0,Math.min(255,W+128))}}}addRegularDash(l,c){for(let O=l.length-1;O>=0;--O){const k=l[O],M=l[O+1];k.zeroLength?l.splice(O,1):M&&M.isDash===k.isDash&&(M.left=k.left,l.splice(O,1))}const d=l[0],y=l[l.length-1];d.isDash===y.isDash&&(d.left=y.left-this.width,y.right=d.right+this.width);const _=this.width*this.nextRow;let w=0,C=l[w];for(let O=0;O<this.width;O++){O/C.right>1&&(C=l[++w]);const k=Math.abs(O-C.left),M=Math.abs(O-C.right),N=Math.min(k,M);this.image.data[_+O]=Math.max(0,Math.min(255,(C.isDash?N:-N)+c+128))}}addDash(l,c){const d=this.getKey(l,c);if(this.positions[d])return this.positions[d];const y=c==="round",_=y?7:0,w=2*_+1;if(this.nextRow+w>this.height)return Ft("LineAtlas out of space"),null;l.length===0&&l.push(1);let C=0;for(let M=0;M<l.length;M++)l[M]<0&&(Ft("Negative value is found in line dasharray, replacing values with 0"),l[M]=0),C+=l[M];if(C!==0){const M=this.width/C,N=this.getDashRanges(l,this.width,M);y?this.addRoundDash(N,M,_):this.addRegularDash(N,c==="square"?.5*M:0)}const O=this.nextRow+_;this.nextRow+=w;const k={tl:[O,_],br:[C,0]};return this.positions[d]=k,k}}tr(GW,"LineAtlas");class YW{constructor(l){const c={},d=[];for(const C in l){const O=l[C],k=c[C]={};for(const M in O.glyphs){const N=O.glyphs[+M];if(!N||N.bitmap.width===0||N.bitmap.height===0)continue;const B=N.metrics.localGlyph?2:1,W={x:0,y:0,w:N.bitmap.width+2*B,h:N.bitmap.height+2*B};d.push(W),k[M]=W}}const{w:y,h:_}=iM(d),w=new Ou({width:y||1,height:_||1});for(const C in l){const O=l[C];for(const k in O.glyphs){const M=O.glyphs[+k];if(!M||M.bitmap.width===0||M.bitmap.height===0)continue;const N=c[C][k],B=M.metrics.localGlyph?2:1;Ou.copy(M.bitmap,w,{x:0,y:0},{x:N.x+B,y:N.y+B},M.bitmap)}}this.image=w,this.positions=c}}tr(YW,"GlyphAtlas");class Xhe{constructor(l){this.tileID=new Go(l.tileID.overscaledZ,l.tileID.wrap,l.tileID.canonical.z,l.tileID.canonical.x,l.tileID.canonical.y),this.tileZoom=l.tileZoom,this.uid=l.uid,this.zoom=l.zoom,this.canonical=l.tileID.canonical,this.pixelRatio=l.pixelRatio,this.tileSize=l.tileSize,this.source=l.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=l.showCollisionBoxes,this.collectResourceTiming=!!l.collectResourceTiming,this.returnDependencies=!!l.returnDependencies,this.promoteId=l.promoteId,this.enableTerrain=!!l.enableTerrain,this.isSymbolTile=l.isSymbolTile,this.tileTransform=fd(l.tileID.canonical,l.projection),this.projection=l.projection}parse(l,c,d,y,_){this.status="parsing",this.data=l,this.collisionBoxArray=new xI;const w=new kW(Object.keys(l.layers).sort()),C=new UW(this.tileID,this.promoteId);C.bucketLayerIDs=[];const O={},k=new GW(256,256),M={featureIndex:C,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:k,availableImages:d},N=c.familiesBySource[this.source];for(const ke in N){const Te=l.layers[ke];if(!Te)continue;let lt=!1,it=!1;for(const ht of N[ke])ht[0].type==="symbol"?lt=!0:it=!0;if(this.isSymbolTile===!0&&!lt||this.isSymbolTile===!1&&!it)continue;Te.version===1&&Ft(`Vector tile source "${this.source}" layer "${ke}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const vt=w.encode(ke),$t=[];for(let ht=0;ht<Te.length;ht++){const bt=Te.feature(ht),St=C.getId(bt,ke);$t.push({feature:bt,id:St,index:ht,sourceLayerIndex:vt})}for(const ht of N[ke]){const bt=ht[0];this.isSymbolTile!==void 0&&bt.type==="symbol"!==this.isSymbolTile||bt.minzoom&&this.zoom<Math.floor(bt.minzoom)||bt.maxzoom&&this.zoom>=bt.maxzoom||bt.visibility!=="none"&&(wM(ht,this.zoom,d),(O[bt.id]=bt.createBucket({index:C.bucketLayerIDs.length,layers:ht,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:vt,sourceID:this.source,enableTerrain:this.enableTerrain,projection:this.projection.spec,availableImages:d})).populate($t,M,this.tileID.canonical,this.tileTransform),C.bucketLayerIDs.push(ht.map(St=>St.id)))}}let B,W,Y,J;k.trim();const ie={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},pe=xt(M.glyphDependencies,ke=>Object.keys(ke).map(Number));Object.keys(pe).length?y.send("getGlyphs",{uid:this.uid,stacks:pe},(ke,Te)=>{B||(B=ke,W=Te,Se.call(this))},void 0,!1,ie):W={};const Ce=Object.keys(M.iconDependencies);Ce.length?y.send("getImages",{icons:Ce,source:this.source,tileID:this.tileID,type:"icons"},(ke,Te)=>{B||(B=ke,Y=Te,Se.call(this))},void 0,!1,ie):Y={};const he=Object.keys(M.patternDependencies);function Se(){if(B)return _(B);if(W&&Y&&J){const ke=new YW(W),Te=new rW(Y,J);for(const lt in O){const it=O[lt];it instanceof df?(wM(it.layers,this.zoom,d),She(it,W,ke.positions,Y,Te.iconPositions,this.showCollisionBoxes,d,this.tileID.canonical,this.tileZoom,this.projection)):it.hasPattern&&(it instanceof WE||it instanceof zE||it instanceof mw)&&(wM(it.layers,this.zoom,d),it.addFeatures(M,this.tileID.canonical,Te.patternPositions,d,this.tileTransform))}this.status="done",_(null,{buckets:D(O).filter(lt=>!lt.isEmpty()),featureIndex:C,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:ke.image,lineAtlas:k,imageAtlas:Te,glyphMap:this.returnDependencies?W:null,iconMap:this.returnDependencies?Y:null,glyphPositions:this.returnDependencies?ke.positions:null})}}he.length?y.send("getImages",{icons:he,source:this.source,tileID:this.tileID,type:"patterns"},(ke,Te)=>{B||(B=ke,J=Te,Se.call(this))},void 0,!1,ie):J={},Se.call(this)}}function wM(u,l,c){const d=new Xe(l);for(const y of u)y.recalculate(d,c)}class KW{constructor(l){this.entries={},this.scheduler=l}request(l,c,d,y){const _=this.entries[l]=this.entries[l]||{callbacks:[]};if(_.result){const[w,C]=_.result;return this.scheduler?this.scheduler.add(()=>{y(w,C)},c):y(w,C),()=>{}}return _.callbacks.push(y),_.cancel||(_.cancel=d((w,C)=>{_.result=[w,C];for(const O of _.callbacks)this.scheduler?this.scheduler.add(()=>{O(w,C)},c):O(w,C);setTimeout(()=>delete this.entries[l],3e3)})),()=>{_.result||(_.callbacks=_.callbacks.filter(w=>w!==y),_.callbacks.length||(_.cancel(),delete this.entries[l]))}}}function qW(u,l,c){const d=JSON.stringify(u.request);return u.data&&(this.deduped.entries[d]={result:[null,u.data]}),this.deduped.request(d,{type:"parseTile",isSymbolTile:u.isSymbolTile,zoom:u.tileZoom},y=>{const _=Pr(u.request,(w,C,O,k)=>{w?y(w):C&&y(null,{vectorTile:c?void 0:new tM(new _w(C)),rawData:C,cacheControl:O,expires:k})});return()=>{_.cancel(),y()}},l)}a.ARRAY_TYPE=Ta,a.AUTH_ERR_MSG=on,a.Aabb=Wo,a.Actor=class{constructor(u,l,c){this.target=u,this.parent=l,this.mapId=c,this.callbacks={},this.cancelCallbacks={},je(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=wr()?u:h,this.scheduler=new Vhe}send(u,l,c,d,y=!1,_){const w=Math.round(1e18*Math.random()).toString(36).substring(0,10);c&&(c.metadata=_,this.callbacks[w]=c);const C=Sr(this.globalScope)?void 0:[];return this.target.postMessage({id:w,type:u,hasCallback:!!c,targetMapId:d,mustQueue:y,sourceMapId:this.mapId,data:Xh(l,C)},C),{cancel:()=>{c&&delete this.callbacks[w],this.target.postMessage({id:w,type:"<cancel>",targetMapId:d,sourceMapId:this.mapId})}}}receive(u){const l=u.data,c=l.id;if(c&&(!l.targetMapId||this.mapId===l.targetMapId))if(l.type==="<cancel>"){const d=this.cancelCallbacks[c];delete this.cancelCallbacks[c],d&&d.cancel()}else if(l.mustQueue||wr()){const d=this.callbacks[c];this.cancelCallbacks[c]=this.scheduler.add(()=>this.processTask(c,l),d&&d.metadata||{type:"message"})}else this.processTask(c,l)}processTask(u,l){if(l.type==="<response>"){const c=this.callbacks[u];delete this.callbacks[u],c&&(l.error?c(Zh(l.error)):c(null,Zh(l.data)))}else{const c=Sr(this.globalScope)?void 0:[],d=l.hasCallback?(_,w)=>{delete this.cancelCallbacks[u],this.target.postMessage({id:u,type:"<response>",sourceMapId:this.mapId,error:_?Xh(_):null,data:Xh(w,c)},c)}:_=>{},y=Zh(l.data);if(this.parent[l.type])this.parent[l.type](l.sourceMapId,y,d);else if(this.parent.getWorkerSource){const _=l.type.split(".");this.parent.getWorkerSource(l.sourceMapId,_[0],y.source)[_[1]](y,d)}else d(new Error(`Could not find function ${l.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}},a.CanonicalTileID=UE,a.Color=wi,a.ColorMode=Ll,a.CullFaceMode=Js,a.DEMData=aT,a.DataConstantProperty=Ye,a.DedupedRequest=KW,a.DepthMode=oy,a.EXTENT=kr,a.Elevation=class{isDataAvailableAtPoint(u){const l=this._source();if(this.isUsingMockSource()||!l||u.y<0||u.y>1)return!1;const c=l.getSource().maxzoom,d=1<<c,y=Math.floor(u.x),_=Math.floor((u.x-y)*d),w=Math.floor(u.y*d),C=this.findDEMTileFor(new Go(c,y,c,_,w));return!(!C||!C.dem)}getAtPointOrZero(u,l=0){return this.getAtPoint(u,l)||0}getAtPoint(u,l,c=!0){if(this.isUsingMockSource())return null;l==null&&(l=null);const d=this._source();if(!d||u.y<0||u.y>1)return l;const y=d.getSource().maxzoom,_=1<<y,w=Math.floor(u.x),C=u.x-w,O=new Go(y,w,y,Math.floor(C*_),Math.floor(u.y*_)),k=this.findDEMTileFor(O);if(!k||!k.dem)return l;const M=k.dem,N=1<<k.tileID.canonical.z,B=(C*N-k.tileID.canonical.x)*M.dim,W=(u.y*N-k.tileID.canonical.y)*M.dim,Y=Math.floor(B),J=Math.floor(W);return(c?this.exaggeration():1)*mn(mn(M.get(Y,J),M.get(Y,J+1),W-J),mn(M.get(Y+1,J),M.get(Y+1,J+1),W-J),B-Y)}getAtTileOffset(u,l,c){const d=1<<u.canonical.z;return this.getAtPointOrZero(new Gm(u.wrap+(u.canonical.x+l/kr)/d,(u.canonical.y+c/kr)/d))}getAtTileOffsetFunc(u,l,c,d){return y=>{const _=this.getAtTileOffset(u,y.x,y.y),w=d.upVector(u.canonical,y.x,y.y);return Wa(w,w,_*d.upVectorScale(u.canonical,l,c).metersToTile),w}}getForTilePoints(u,l,c,d){if(this.isUsingMockSource())return!1;const y=sT.create(this,u,d);return!!y&&(l.forEach(_=>{_[2]=this.exaggeration()*y.getElevationAt(_[0],_[1],c)}),!0)}getMinMaxForTile(u){if(this.isUsingMockSource())return null;const l=this.findDEMTileFor(u);if(!l||!l.dem)return null;const c=l.dem.tree,d=l.tileID,y=1<<u.canonical.z-d.canonical.z;let _=u.canonical.x/y-d.canonical.x,w=u.canonical.y/y-d.canonical.y,C=0;for(let O=0;O<u.canonical.z-d.canonical.z&&!c.leaves[C];O++){_*=2,w*=2;const k=2*Math.floor(w)+Math.floor(_);C=c.childOffsets[C]+k,_%=1,w%=1}return{min:this.exaggeration()*c.minimums[C],max:this.exaggeration()*c.maximums[C]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(u,l,c){throw new Error("Pure virtual method called.")}pointCoordinate(u){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(u){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}},a.ErrorEvent=oa,a.EvaluationParameters=Xe,a.Event=Lr,a.Evented=Gn,a.FillExtrusionBucket=mw,a.Frustum=$I,a.FrustumCorners=DI,a.GLOBE_RADIUS=kl,a.GLOBE_SCALE_MATCH_LATITUDE=45,a.GLOBE_ZOOM_THRESHOLD_MAX=6,a.GLOBE_ZOOM_THRESHOLD_MIN=5,a.GlobeSharedBuffers=class{constructor(u){this._createGrid(u),this._createPoles(u)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const u of this._poleSegments)u.destroy();for(const u of this._gridSegments)u.withSkirts.destroy(),u.withoutSkirts.destroy();if(this._wireframeIndexBuffer){this._wireframeIndexBuffer.destroy();for(const u of this._wireframeSegments)u.destroy()}}_fillGridMeshWithLods(u,l){const c=new gr,d=new So,y=[],_=u+1+2,w=l[0]+1,C=l[0]+1+(1+l.length),O=(k,M,N)=>{let B=k===_-1?k-2:k===0?k:k-1;return B+=N?24575:0,[B,M]};for(let k=0;k<_;++k)c.emplaceBack(...O(k,0,!0));for(let k=0;k<w;++k)for(let M=0;M<_;++M)c.emplaceBack(...O(M,k,(M===0||M===_-1)&&!0));for(let k=0;k<l.length;++k){const M=l[k];for(let N=0;N<_;++N)c.emplaceBack(...O(N,M,!0))}for(let k=0;k<l.length;++k){const M=d.length,N=l[k]+1+2,B=new So;for(let J=0;J<N-1;J++){const ie=J===N-2,pe=ie?_*(C-l.length+k-J):_;for(let Ce=0;Ce<_-1;Ce++){const he=J*_+Ce;J===0||ie||Ce===0||Ce===_-2?(B.emplaceBack(he+1,he,he+pe),B.emplaceBack(he+pe,he+pe+1,he+1)):(d.emplaceBack(he+1,he,he+pe),d.emplaceBack(he+pe,he+pe+1,he+1))}}const W=Oi.simpleSegment(0,M,c.length,d.length-M);for(let J=0;J<B.uint16.length;J+=3)d.emplaceBack(B.uint16[J],B.uint16[J+1],B.uint16[J+2]);const Y=Oi.simpleSegment(0,M,c.length,d.length-M);y.push({withoutSkirts:W,withSkirts:Y})}return{vertices:c,indices:d,segments:y}}_createGrid(u){const l=this._fillGridMeshWithLods(ad,ow);this._gridSegments=l.segments,this._gridBuffer=u.createVertexBuffer(l.vertices,iw.members),this._gridIndexBuffer=u.createIndexBuffer(l.indices,!0)}_createPoles(u){const l=new So;for(let y=0;y<=ad;y++)l.emplaceBack(0,y+1,y+2);this._poleIndexBuffer=u.createIndexBuffer(l,!0);const c=new Ea,d=new Ea;this._poleSegments=[];for(let y=0,_=0;y<5;y++){const w=360/(1<<y);c.emplaceBack(0,-kl,0,.5,0),d.emplaceBack(0,-kl,0,.5,1);for(let C=0;C<=ad;C++){const O=C/ad,k=mn(0,w,O),[M,N,B]=Vm(Vce,Uce,k,kl);c.emplaceBack(M,N,B,O,0),d.emplaceBack(M,N,B,O,1)}this._poleSegments.push(Oi.simpleSegment(_,0,66,64)),_+=66}this._poleNorthVertexBuffer=u.createVertexBuffer(c,e4,!1),this._poleSouthVertexBuffer=u.createVertexBuffer(d,e4,!1)}getGridBuffers(u,l){return[this._gridBuffer,this._gridIndexBuffer,l?this._gridSegments[u].withSkirts:this._gridSegments[u].withoutSkirts]}getPoleBuffers(u){return[this._poleNorthVertexBuffer,this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[u]]}getWirefameBuffers(u,l){if(!this._wireframeSegments){const c=new Ol,d=ad,y=d+1+2,_=1;this._wireframeSegments=[];for(let w=0,C=0;w<ow.length;w++){const O=ow[w];for(let M=_;M<O+_;M++)for(let N=_;N<d+_;N++){const B=M*y+N;c.emplaceBack(B,B+1),c.emplaceBack(B,B+y),c.emplaceBack(B,B+y+1)}const k=O*d*3;this._wireframeSegments.push(Oi.simpleSegment(0,C,(O+1)*y,k)),C+=k}this._wireframeIndexBuffer=u.createIndexBuffer(c)}return[this._gridBuffer,this._wireframeIndexBuffer,this._wireframeSegments[l]]}},a.GlyphManager=ry,a.ImagePosition=oM,a.LivePerformanceUtils=Ct,a.LngLat=vn,a.LngLatBounds=cf,a.LocalGlyphMode=lM,a.MAX_MERCATOR_LATITUDE=Co,a.MercatorCoordinate=Gm,a.ONE_EM=Eo,a.OverscaledTileID=Go,a.PerformanceMarkers=nt,a.Properties=Mt,a.RGBAImage=Oa,a.Ray=MI,a.RequestManager=class{constructor(u,l,c){this._transformRequestFn=u,this._customAccessToken=l,this._silenceAuthErrors=!!c,this._createSkuToken()}_createSkuToken(){const u=function(){let l="";for(let c=0;c<10;c++)l+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",V,l].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=u.token,this._skuTokenExpiresAt=u.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(u,l){return this._transformRequestFn&&this._transformRequestFn(u,l)||{url:u}}normalizeStyleURL(u,l){if(!Fr(u))return u;const c=zr(u);return c.path=`/styles/v1${c.path}`,this._makeAPIURL(c,this._customAccessToken||l)}normalizeGlyphsURL(u,l){if(!Fr(u))return u;const c=zr(u);return c.path=`/fonts/v1${c.path}`,this._makeAPIURL(c,this._customAccessToken||l)}normalizeSourceURL(u,l,c,d){if(!Fr(u))return u;const y=zr(u);return y.path=`/v4/${y.authority}.json`,y.params.push("secure"),c&&y.params.push(`language=${c}`),d&&y.params.push(`worldview=${d}`),this._makeAPIURL(y,this._customAccessToken||l)}normalizeSpriteURL(u,l,c,d){const y=zr(u);return Fr(u)?(y.path=`/styles/v1${y.path}/sprite${l}${c}`,this._makeAPIURL(y,this._customAccessToken||d)):(y.path+=`${l}${c}`,vo(y))}normalizeTileURL(u,l,c){if(this._isSkuTokenExpired()&&this._createSkuToken(),u&&!Fr(u))return u;const d=zr(u);d.path=d.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${l||c&&d.authority!=="raster"&&c===512?"@2x":""}${T.supported?".webp":"$1"}`),d.authority==="raster"?d.path=`/${S.RASTER_URL_PREFIX}${d.path}`:(d.path=d.path.replace(/^.+\/v4\//,"/"),d.path=`/${S.TILE_URL_VERSION}${d.path}`);const y=this._customAccessToken||function(_){for(const w of _){const C=w.match(/^access_token=(.*)$/);if(C)return C[1]}return null}(d.params)||S.ACCESS_TOKEN;return S.REQUIRE_ACCESS_TOKEN&&y&&this._skuToken&&d.params.push(`sku=${this._skuToken}`),this._makeAPIURL(d,y)}canonicalizeTileURL(u,l){const c=zr(u);if(!c.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!c.path.match(/\.[\w]+$/))return u;let d="mapbox://";c.path.match(/^\/raster\/v1\//)?d+=`raster/${c.path.replace(`/${S.RASTER_URL_PREFIX}/`,"")}`:d+=`tiles/${c.path.replace(`/${S.TILE_URL_VERSION}/`,"")}`;let y=c.params;return l&&(y=y.filter(_=>!_.match(/^access_token=/))),y.length&&(d+=`?${y.join("&")}`),d}canonicalizeTileset(u,l){const c=!!l&&Fr(l),d=[];for(const y of u.tiles||[])jr(y)?d.push(this.canonicalizeTileURL(y,c)):d.push(y);return d}_makeAPIURL(u,l){const c="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",d=zr(S.API_URL);if(u.protocol=d.protocol,u.authority=d.authority,u.protocol==="http"){const y=u.params.indexOf("secure");y>=0&&u.params.splice(y,1)}if(d.path!=="/"&&(u.path=`${d.path}${u.path}`),!S.REQUIRE_ACCESS_TOKEN)return vo(u);if(l=l||S.ACCESS_TOKEN,!this._silenceAuthErrors){if(!l)throw new Error(`An API access token is required to use Mapbox GL. ${c}`);if(l[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${c}`)}return u.params=u.params.filter(y=>y.indexOf("access_token")===-1),u.params.push(`access_token=${l||""}`),vo(u)}},a.ResourceType=ft,a.SegmentVector=Oi,a.SourceCache=hd,a.StencilMode=vM,a.StructArrayLayout1ui2=Rl,a.StructArrayLayout2f1f2i16=bo,a.StructArrayLayout2i4=gr,a.StructArrayLayout2ui4=Ol,a.StructArrayLayout3f12=wo,a.StructArrayLayout3ui6=So,a.StructArrayLayout4i8=On,a.StructArrayLayout5f20=Ea,a.Texture=Tw,a.Tile=yM,a.Transitionable=Bt,a.Uniform1f=TE,a.Uniform1i=class extends xu{constructor(u){super(u),this.current=0}set(u,l,c){this.fetchUniformLocation(u,l)&&this.current!==c&&(this.current=c,this.gl.uniform1i(this.location,c))}},a.Uniform2f=class extends xu{constructor(u){super(u),this.current=[0,0]}set(u,l,c){this.fetchUniformLocation(u,l)&&(c[0]===this.current[0]&&c[1]===this.current[1]||(this.current=c,this.gl.uniform2f(this.location,c[0],c[1])))}},a.Uniform3f=class extends xu{constructor(u){super(u),this.current=[0,0,0]}set(u,l,c){this.fetchUniformLocation(u,l)&&(c[0]===this.current[0]&&c[1]===this.current[1]&&c[2]===this.current[2]||(this.current=c,this.gl.uniform3f(this.location,c[0],c[1],c[2])))}},a.Uniform4f=BU,a.UniformColor=jU,a.UniformMatrix2f=class extends xu{constructor(u){super(u),this.current=Rce}set(u,l,c){if(this.fetchUniformLocation(u,l)){for(let d=0;d<4;d++)if(c[d]!==this.current[d]){this.current=c,this.gl.uniformMatrix2fv(this.location,!1,c);break}}}},a.UniformMatrix3f=class extends xu{constructor(u){super(u),this.current=Oce}set(u,l,c){if(this.fetchUniformLocation(u,l)){for(let d=0;d<9;d++)if(c[d]!==this.current[d]){this.current=c,this.gl.uniformMatrix3fv(this.location,!1,c);break}}}},a.UniformMatrix4f=class extends xu{constructor(u){super(u),this.current=Tce}set(u,l,c){if(this.fetchUniformLocation(u,l)){if(c[12]!==this.current[12]||c[0]!==this.current[0])return this.current=c,void this.gl.uniformMatrix4fv(this.location,!1,c);for(let d=1;d<16;d++)if(c[d]!==this.current[d]){this.current=c,this.gl.uniformMatrix4fv(this.location,!1,c);break}}}},a.UnwrappedTileID=V4,a.ValidationError=Qt,a.VectorTileFeature=HE,a.VectorTileWorkerSource=class extends Gn{constructor(u,l,c,d,y){super(),this.actor=u,this.layerIndex=l,this.availableImages=c,this.loadVectorData=y||qW,this.loading={},this.loaded={},this.deduped=new KW(u.scheduler),this.isSpriteLoaded=d,this.scheduler=u.scheduler}loadTile(u,l){const c=u.uid,d=u&&u.request,y=d&&d.collectResourceTiming,_=this.loading[c]=new Xhe(u);_.abort=this.loadVectorData(u,(w,C)=>{const O=!this.loading[c];if(delete this.loading[c],O||w||!C)return _.status="done",O||(this.loaded[c]=_),l(w);const k=C.rawData,M={};C.expires&&(M.expires=C.expires),C.cacheControl&&(M.cacheControl=C.cacheControl),_.vectorTile=C.vectorTile||new tM(new _w(k));const N=()=>{_.parse(_.vectorTile,this.layerIndex,this.availableImages,this.actor,(B,W)=>{if(B||!W)return l(B);const Y={};if(y){const J=_r(d);J.length>0&&(Y.resourceTiming=JSON.parse(JSON.stringify(J)))}l(null,U({rawTileData:k.slice(0)},W,M,Y))})};this.isSpriteLoaded?N():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(N,{type:"parseTile",isSymbolTile:u.isSymbolTile,zoom:u.tileZoom}):N()}),this.loaded=this.loaded||{},this.loaded[c]=_})}reloadTile(u,l){const c=this.loaded,d=u.uid,y=this;if(c&&c[d]){const _=c[d];_.showCollisionBoxes=u.showCollisionBoxes,_.enableTerrain=!!u.enableTerrain,_.projection=u.projection,_.tileTransform=fd(u.tileID.canonical,u.projection);const w=(C,O)=>{const k=_.reloadCallback;k&&(delete _.reloadCallback,_.parse(_.vectorTile,y.layerIndex,this.availableImages,y.actor,k)),l(C,O)};_.status==="parsing"?_.reloadCallback=w:_.status==="done"&&(_.vectorTile?_.parse(_.vectorTile,this.layerIndex,this.availableImages,this.actor,w):w())}}abortTile(u,l){const c=u.uid,d=this.loading[c];d&&(d.abort&&d.abort(),delete this.loading[c]),l()}removeTile(u,l){const c=this.loaded,d=u.uid;c&&c[d]&&delete c[d],l()}},a.WritingMode=Ya,a.ZoomDependentExpression=wu,a.add=Eu,a.addDynamicAttributes=nT,a.adjoint=function(u,l){var c=l[0],d=l[1],y=l[2],_=l[3],w=l[4],C=l[5],O=l[6],k=l[7],M=l[8];return u[0]=w*M-C*k,u[1]=y*k-d*M,u[2]=d*C-y*w,u[3]=C*O-_*M,u[4]=c*M-y*O,u[5]=y*_-c*C,u[6]=_*k-w*O,u[7]=d*O-c*k,u[8]=c*w-d*_,u},a.asyncAll=ae,a.bezier=_t,a.bindAll=je,a.boundsAttributes=IW,a.bufferConvexPolygon=function(u,l){const c=[];for(let d=0;d<u.length;d++){const y=Gt(d-1,-1,u.length-1),_=Gt(d+1,-1,u.length-1),w=u[d],C=u[_],O=u[y].sub(w).unit(),k=C.sub(w).unit(),M=k.angleWithSep(O.x,O.y),N=O.add(k).unit().mult(-1*l/Math.sin(M/2));c.push(w.add(N))}return c},a.cacheEntryPossiblyAdded=function(u){Ze++,Ze>rt&&(u.getActor().send("enforceCacheSizeLimit",Be),Ze=0)},a.calculateGlobeLabelMatrix=function(u,l){const{x:c,y:d}=u.point,y=a4(c,d,u.worldSize/u._pixelsPerMercatorPixel,0,0);return nd(y,y,BI(Pl(l)))},a.calculateGlobeMatrix=function(u){const{x:l,y:c}=u.point,{lng:d,lat:y}=u._center;return a4(l,c,u.worldSize,d,y)},a.calculateGlobeMercatorMatrix=function(u){const l=u.pixelsPerMeter,c=l/Zs(1,u.center.lat),d=qs(new Float64Array(16));return Jb(d,d,[u.point.x,u.point.y,0]),id(d,d,[c,c,l]),Float32Array.from(d)},a.circumferenceAtLatitude=zI,a.clamp=Fe,a.clearTileCache=function(u){if(!Ue())return;const l=h.caches.delete(_e);u&&l.catch(u).then(()=>u())},a.clipLine=pW,a.clone=function(u){var l=new Ta(16);return l[0]=u[0],l[1]=u[1],l[2]=u[2],l[3]=u[3],l[4]=u[4],l[5]=u[5],l[6]=u[6],l[7]=u[7],l[8]=u[8],l[9]=u[9],l[10]=u[10],l[11]=u[11],l[12]=u[12],l[13]=u[13],l[14]=u[14],l[15]=u[15],l},a.clone$1=jt,a.collisionCircleLayout=Kfe,a.config=S,a.conjugate=function(u,l){return u[0]=-l[0],u[1]=-l[1],u[2]=-l[2],u[3]=l[3],u},a.create=function(){var u=new Ta(16);return Ta!=Float32Array&&(u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[11]=0,u[12]=0,u[13]=0,u[14]=0),u[0]=1,u[5]=1,u[10]=1,u[15]=1,u},a.create$1=FU,a.createExpression=Qc,a.createLayout=fr,a.createStyleLayer=function(u){return u.type==="custom"?new jhe(u):new Fhe[u.type](u)},a.cross=II,a.degToRad=Ne,a.distance=function(u,l){return Math.hypot(l[0]-u[0],l[1]-u[1],l[2]-u[2])},a.div=function(u,l,c){return u[0]=l[0]/c[0],u[1]=l[1]/c[1],u[2]=l[2]/c[2],u},a.dot=gs,a.earthRadius=lw,a.ease=$e,a.easeCubicInOut=Lt,a.ecefToLatLng=function([u,l,c]){const d=Math.hypot(u,l,c),y=Math.atan2(u,c),_=.5*Math.PI-Math.acos(-l/d);return new vn(We(y),We(_))},a.emitValidationErrors=fE,a.endsWith=Je,a.enforceCacheSizeLimit=function(u){Ve(),Re&&Re.then(l=>{l.keys().then(c=>{for(let d=0;d<c.length-u;d++)l.delete(c[d])})})},a.evaluateSizeForFeature=GE,a.evaluateSizeForZoom=Jm,a.evaluateVariableOffset=_W,a.evented=be,a.exactEquals=function(u,l){return u[0]===l[0]&&u[1]===l[1]&&u[2]===l[2]&&u[3]===l[3]},a.exactEquals$1=function(u,l){return u[0]===l[0]&&u[1]===l[1]&&u[2]===l[2]},a.exported=pr,a.exported$1=T,a.extend=U,a.extend$1=Sa,a.fillExtrusionHeightLift=z4,a.filterObject=kt,a.fromMat4=function(u,l){return u[0]=l[0],u[1]=l[1],u[2]=l[2],u[3]=l[4],u[4]=l[5],u[5]=l[6],u[6]=l[8],u[7]=l[9],u[8]=l[10],u},a.fromQuat=function(u,l){var c=l[0],d=l[1],y=l[2],_=l[3],w=c+c,C=d+d,O=y+y,k=c*w,M=d*w,N=d*C,B=y*w,W=y*C,Y=y*O,J=_*w,ie=_*C,pe=_*O;return u[0]=1-N-Y,u[1]=M+pe,u[2]=B-ie,u[3]=0,u[4]=M-pe,u[5]=1-k-Y,u[6]=W+J,u[7]=0,u[8]=B+ie,u[9]=W-J,u[10]=1-k-N,u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1,u},a.fromRotation=function(u,l){var c=Math.sin(l),d=Math.cos(l);return u[0]=d,u[1]=c,u[2]=0,u[3]=-c,u[4]=d,u[5]=0,u[6]=0,u[7]=0,u[8]=1,u},a.fromScaling=VU,a.furthestTileCorner=function(u){const l=Math.round((u+45+360)%360/90)%4;return gt[l]},a.getAABBPointSquareDist=function(u,l,c){let d=0;for(let y=0;y<2;++y){const _=c?c[y]:0;u[y]>_&&(d+=(u[y]-_)*(u[y]-_)),l[y]<_&&(d+=(_-l[y])*(_-l[y]))}return d},a.getAnchorAlignment=sM,a.getAnchorJustification=cM,a.getBounds=function(u){let l=1/0,c=1/0,d=-1/0,y=-1/0;for(const _ of u)l=Math.min(l,_.x),c=Math.min(c,_.y),d=Math.max(d,_.x),y=Math.max(y,_.y);return{min:new K(l,c),max:new K(d,y)}},a.getColumn=se,a.getGridMatrix=function(u,l,c,d){const y=l.getNorth(),_=l.getSouth(),w=l.getWest(),C=l.getEast(),O=1<<u.z,k=C-w,M=y-_,N=k/ad,B=-M/ow[c],W=[0,N,0,B,0,0,y,w,0];if(u.z>0){const Y=180/d;HU(W,W,[Y/k+1,0,0,0,Y/M+1,0,-.5*Y/N,.5*Y/B,1])}return W[2]=O,W[5]=u.x,W[8]=u.y,W},a.getImage=sn,a.getJSON=function(u,l){return cr(U(u,{type:"json"}),l)},a.getLatitudinalLod=function(u){const l=Co-5;u=Fe(u,-l,l)/l*90;const c=Math.pow(Math.abs(Math.sin(Ne(u))),3);return Math.round(c*(ow.length-1))},a.getMapSessionAPI=Ge,a.getPerformanceMeasurement=_r,a.getProjection=OW,a.getRTLTextPluginStatus=Pe,a.getReferrer=nr,a.getTilePoint=function(u,{x:l,y:c},d=0){return new K(((l-d)*u.scale-u.x)*kr,(c*u.scale-u.y)*kr)},a.getTileVec3=function(u,l,c=0){return Hm(((l.x-c)*u.scale-u.x)*kr,(l.y*u.scale-u.y)*kr,c4(l.z,l.y))},a.getVideo=function(u,l){const c=h.document.createElement("video");c.muted=!0,c.onloadstart=function(){l(null,c)};for(let d=0;d<u.length;d++){const y=h.document.createElement("source");Vr(u[d])||(c.crossOrigin="Anonymous"),y.src=u[d],c.appendChild(y)}return{cancel:()=>{}}},a.globeCenterToScreenPoint=function(u){const l=[0,0,0],c=qs(new Float64Array(16));return nd(c,u.pixelMatrix,u.globeMatrix),Si(l,l,c),new K(l[0],l[1])},a.globeDenormalizeECEF=BI,a.globeECEFOrigin=function(u,l){const c=[0,0,0];return Si(c,c,sw(Pl(l.canonical))),Si(c,c,u),c},a.globeMetersToEcef=PE,a.globeNormalizeECEF=sw,a.globePixelsToTileUnits=function(u,l){return kr/(512*Math.pow(2,u))*IE(Pl(l))},a.globePoleMatrixForTile=function(u,l,c){const d=qs(new Float64Array(16)),y=(l/(1<<u)-.5)*Math.PI*2;return kE(d,c.globeMatrix,y),Float32Array.from(d)},a.globeTileBounds=Pl,a.globeTiltAtLngLat=s4,a.globeToMercatorTransition=Wm,a.globeUseCustomAntiAliasing=function(u,l,c){const d=Wm(c.zoom),y=u.style.map._antialias,_=!!l.extStandardDerivatives,w=l.extStandardDerivativesForceOff||u.terrain&&u.terrain.exaggeration()>0;return d===0&&!y&&!w&&_},a.identity=qs,a.identity$1=ZU,a.invert=RI,a.isFullscreen=function(){return!!h.document.fullscreenElement||!!h.document.webkitFullscreenElement},a.isLngLatBehindGlobe=jI,a.isMapAuthenticated=function(u){return Ie.has(u)},a.isMapboxURL=Fr,a.isSafariWithAntialiasingBug=function(u){const l=u.navigator?u.navigator.userAgent:null;return!!Sr(u)&&l&&(l.match("Version/15.4")||l.match("Version/15.5")||l.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},a.latFromMercatorY=xo,a.latLngToECEF=Um,a.len=Nce,a.length=Qb,a.length$1=function(u){return Math.hypot(u[0],u[1],u[2],u[3])},a.lngFromMercatorX=Ga,a.loadVectorTile=qW,a.makeRequest=cr,a.mapValue=function(u,l,c,d,y){return Fe((u-l)/(c-l)*(y-d)+d,d,y)},a.mercatorScale=f4,a.mercatorXfromLng=Al,a.mercatorYfromLat=Il,a.mercatorZfromAltitude=Zs,a.mul=$ce,a.mul$1=Lce,a.multiply=nd,a.multiply$1=HU,a.multiply$2=GU,a.nextPowerOfTwo=ve,a.normalize=Uo,a.normalize$1=Bce,a.normalize$2=qU,a.number=mn,a.ortho=function(u,l,c,d,y,_,w){var C=1/(l-c),O=1/(d-y),k=1/(_-w);return u[0]=-2*C,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=-2*O,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=2*k,u[11]=0,u[12]=(l+c)*C,u[13]=(y+d)*O,u[14]=(w+_)*k,u[15]=1,u},a.pbf=_w,a.perspective=function(u,l,c,d,y){var _,w=1/Math.tan(l/2);return u[0]=w/c,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=w,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[11]=-1,u[12]=0,u[13]=0,u[15]=0,y!=null&&y!==1/0?(u[10]=(y+d)*(_=1/(d-y)),u[14]=2*y*d*_):(u[10]=-1,u[14]=-2*d),u},a.pick=function(u,l){const c={};for(let d=0;d<l.length;d++){const y=l[d];y in u&&(c[y]=u[y])}return c},a.plugin=De,a.pointGeometry=K,a.polesInViewport=function(u){const l=qs(new Float64Array(16));nd(l,u.pixelMatrix,u.globeMatrix);const c=[0,vs,0],d=[0,_s,0];return Si(c,c,l),Si(d,d,l),[c[0]>0&&c[0]<=u.width&&c[1]>0&&c[1]<=u.height&&!jI(u,new vn(u.center.lat,90)),d[0]>0&&d[0]<=u.width&&d[1]>0&&d[1]<=u.height&&!jI(u,new vn(u.center.lat,-90))]},a.polygonContainsPoint=ud,a.polygonIntersectsBox=v4,a.polygonIntersectsPolygon=p4,a.polygonizeBounds=function(u,l,c=0,d=!0){const y=new K(c,c),_=u.sub(y),w=l.add(y),C=[_,new K(w.x,_.y),w,new K(_.x,w.y)];return d&&C.push(_.clone()),C},a.posAttributes=iw,a.postMapLoadEvent=fe,a.postPerformanceEvent=Ae,a.postTurnstileEvent=Z,a.potpack=iM,a.prevPowerOfTwo=function(u){return u<=1?1:Math.pow(2,Math.floor(Math.log(u)/Math.LN2))},a.radToDeg=We,a.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],a.registerForPluginStateChange=function(u){return u({pluginStatus:ce,pluginURL:te}),be.on("pluginStateChange",u),u},a.removeAuthState=function(u){Ie.delete(u)},a.renderColorRamp=KI,a.resample=h4,a.rotateX=kI,a.rotateX$1=JU,a.rotateY=kE,a.rotateY$1=QU,a.rotateZ=function(u,l,c){var d=Math.sin(c),y=Math.cos(c),_=l[0],w=l[1],C=l[2],O=l[3],k=l[4],M=l[5],N=l[6],B=l[7];return l!==u&&(u[8]=l[8],u[9]=l[9],u[10]=l[10],u[11]=l[11],u[12]=l[12],u[13]=l[13],u[14]=l[14],u[15]=l[15]),u[0]=_*y+k*d,u[1]=w*y+M*d,u[2]=C*y+N*d,u[3]=O*y+B*d,u[4]=k*y-_*d,u[5]=M*y-w*d,u[6]=N*y-C*d,u[7]=B*y-O*d,u},a.rotateZ$1=function(u,l,c){c*=.5;var d=l[0],y=l[1],_=l[2],w=l[3],C=Math.sin(c),O=Math.cos(c);return u[0]=d*O+y*C,u[1]=y*O-d*C,u[2]=_*O+w*C,u[3]=w*O-_*C,u},a.scale=id,a.scale$1=KU,a.scale$2=Wa,a.scaleAndAdd=rw,a.set=function(u,l,c,d){return u[0]=l,u[1]=c,u[2]=d,u},a.setCacheLimits=function(u,l){Be=u,rt=l},a.setColumn=function(u,l,c){u[4*l+0]=c[0],u[4*l+1]=c[1],u[4*l+2]=c[2],u[4*l+3]=c[3]},a.setRTLTextPlugin=function(u,l,c=!1){if(ce===re||ce===oe||ce===le)throw new Error("setRTLTextPlugin cannot be called multiple times.");te=pr.resolveURL(u),ce=re,ue=l,me(),c||Oe()},a.smoothstep=At,a.spec=yt,a.squaredLength=function(u){var l=u[0],c=u[1],d=u[2];return l*l+c*c+d*d},a.storeAuthState=function(u,l){l?Ie.add(u):Ie.delete(u)},a.sub=Xs,a.subtract=AI,a.symbolSize=qfe,a.tileAABB=function(u,l,c,d,y,_,w,C,O){if(O.name==="globe")return Hce(u,l,new UE(c,d,y));const k=fd({z:c,x:d,y},O);return new Wo([(_+k.x/k.scale)*l,l*(k.y/k.scale),w],[(_+k.x2/k.scale)*l,l*(k.y2/k.scale),C])},a.tileCornersToBounds=AE,a.tileTransform=fd,a.transformMat3=function(u,l,c){var d=l[0],y=l[1],_=l[2];return u[0]=d*c[0]+y*c[3]+_*c[6],u[1]=d*c[1]+y*c[4]+_*c[7],u[2]=d*c[2]+y*c[5]+_*c[8],u},a.transformMat4=Si,a.transformMat4$1=od,a.transformQuat=YU,a.transitionTileAABBinECEF=n4,a.translate=Jb,a.transpose=function(u,l){if(u===l){var c=l[1],d=l[2],y=l[5];u[1]=l[3],u[2]=l[6],u[3]=c,u[5]=l[7],u[6]=d,u[7]=y}else u[0]=l[0],u[1]=l[3],u[2]=l[6],u[3]=l[1],u[4]=l[4],u[5]=l[7],u[6]=l[2],u[7]=l[5],u[8]=l[8];return u},a.triggerPluginCompletionEvent=ge,a.uniqueId=ne,a.updateGlobeVertexNormal=function(u,l,c,d,y){const _=5*l+2;u.float32[_+0]=c,u.float32[_+1]=d,u.float32[_+2]=y},a.validateCustomStyleLayer=function(u){const l=[],c=u.id;return c===void 0&&l.push({message:`layers.${c}: missing required property "id"`}),u.render===void 0&&l.push({message:`layers.${c}: missing required method "render"`}),u.renderingMode&&u.renderingMode!=="2d"&&u.renderingMode!=="3d"&&l.push({message:`layers.${c}: property "renderingMode" must be either "2d" or "3d"`}),l},a.validateFilter=u=>Us(Hb(u)),a.validateFog=u=>Us(lE(u)),a.validateLayer=u=>Us(Ub(u)),a.validateLight=u=>Us(sE(u)),a.validateSource=u=>Us(Kh(u)),a.validateStyle=uE,a.validateTerrain=u=>Us(Wb(u)),a.values=D,a.vectorTile=FE,a.version=p,a.warnOnce=Ft,a.window=h,a.wrap=Gt}),o(["./shared"],function(a){function h(de){if(typeof de=="number"||typeof de=="boolean"||typeof de=="string"||de==null)return JSON.stringify(de);if(Array.isArray(de)){let Q="[";for(const fe of de)Q+=`${h(fe)},`;return`${Q}]`}let Z="{";for(const Q of Object.keys(de).sort())Z+=`${Q}:${h(de[Q])},`;return`${Z}}`}function p(de){let Z="";for(const Q of a.refProperties)Z+=`/${h(de[Q])}`;return Z}class g{constructor(Z){this.keyCache={},Z&&this.replace(Z)}replace(Z){this._layerConfigs={},this._layers={},this.update(Z,[])}update(Z,Q){for(const we of Z)this._layerConfigs[we.id]=we,(this._layers[we.id]=a.createStyleLayer(we)).compileFilter(),this.keyCache[we.id]&&delete this.keyCache[we.id];for(const we of Q)delete this.keyCache[we],delete this._layerConfigs[we],delete this._layers[we];this.familiesBySource={};const fe=function(we,Ae){const qe={};for(let Ie=0;Ie<we.length;Ie++){const nt=Ae&&Ae[we[Ie].id]||p(we[Ie]);Ae&&(Ae[we[Ie].id]=nt);let Ct=qe[nt];Ct||(Ct=qe[nt]=[]),Ct.push(we[Ie])}const Ge=[];for(const Ie in qe)Ge.push(qe[Ie]);return Ge}(a.values(this._layerConfigs),this.keyCache);for(const we of fe){const Ae=we.map(Xt=>this._layers[Xt.id]),qe=Ae[0];if(qe.visibility==="none")continue;const Ge=qe.source||"";let Ie=this.familiesBySource[Ge];Ie||(Ie=this.familiesBySource[Ge]={});const nt=qe.sourceLayer||"_geojsonTileLayer";let Ct=Ie[nt];Ct||(Ct=Ie[nt]=[]),Ct.push(Ae)}}}class S{loadTile(Z,Q){const{uid:fe,encoding:we,rawImageData:Ae,padding:qe,buildQuadTree:Ge}=Z,Ie=a.window.ImageBitmap&&Ae instanceof a.window.ImageBitmap?this.getImageData(Ae,qe):Ae;Q(null,new a.DEMData(fe,Ie,we,qe<1,Ge))}getImageData(Z,Q){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(Z.width,Z.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=Z.width,this.offscreenCanvas.height=Z.height,this.offscreenCanvasContext.drawImage(Z,0,0,Z.width,Z.height);const fe=this.offscreenCanvasContext.getImageData(-Q,-Q,Z.width+2*Q,Z.height+2*Q);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),fe}}var T=function de(Z,Q){var fe,we=Z&&Z.type;if(we==="FeatureCollection")for(fe=0;fe<Z.features.length;fe++)de(Z.features[fe],Q);else if(we==="GeometryCollection")for(fe=0;fe<Z.geometries.length;fe++)de(Z.geometries[fe],Q);else if(we==="Feature")de(Z.geometry,Q);else if(we==="Polygon")R(Z.coordinates,Q);else if(we==="MultiPolygon")for(fe=0;fe<Z.coordinates.length;fe++)R(Z.coordinates[fe],Q);return Z};function R(de,Z){if(de.length!==0){A(de[0],Z);for(var Q=1;Q<de.length;Q++)A(de[Q],!Z)}}function A(de,Z){for(var Q=0,fe=0,we=0,Ae=de.length,qe=Ae-1;we<Ae;qe=we++){var Ge=(de[we][0]-de[qe][0])*(de[qe][1]+de[we][1]),Ie=Q+Ge;fe+=Math.abs(Q)>=Math.abs(Ge)?Q-Ie+Ge:Ge-Ie+Q,Q=Ie}Q+fe>=0!=!!Z&&de.reverse()}const $=a.VectorTileFeature.prototype.toGeoJSON;class j{constructor(Z){this._feature=Z,this.extent=a.EXTENT,this.type=Z.type,this.properties=Z.tags,"id"in Z&&!isNaN(Z.id)&&(this.id=parseInt(Z.id,10))}loadGeometry(){if(this._feature.type===1){const Z=[];for(const Q of this._feature.geometry)Z.push([new a.pointGeometry(Q[0],Q[1])]);return Z}{const Z=[];for(const Q of this._feature.geometry){const fe=[];for(const we of Q)fe.push(new a.pointGeometry(we[0],we[1]));Z.push(fe)}return Z}}toGeoJSON(Z,Q,fe){return $.call(this,Z,Q,fe)}}class z{constructor(Z){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=a.EXTENT,this.length=Z.length,this._features=Z}feature(Z){return new j(this._features[Z])}}var V={},G={get exports(){return V},set exports(de){V=de}},ee=a.pointGeometry,K=a.vectorTile.VectorTileFeature,xe=Me;function Me(de,Z){this.options=Z||{},this.features=de,this.length=de.length}function He(de,Z){this.id=typeof de.id=="number"?de.id:void 0,this.type=de.type,this.rawGeometry=de.type===1?[de.geometry]:de.geometry,this.properties=de.tags,this.extent=Z||4096}Me.prototype.feature=function(de){return new He(this.features[de],this.options.extent)},He.prototype.loadGeometry=function(){var de=this.rawGeometry;this.geometry=[];for(var Z=0;Z<de.length;Z++){for(var Q=de[Z],fe=[],we=0;we<Q.length;we++)fe.push(new ee(Q[we][0],Q[we][1]));this.geometry.push(fe)}return this.geometry},He.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var de=this.geometry,Z=1/0,Q=-1/0,fe=1/0,we=-1/0,Ae=0;Ae<de.length;Ae++)for(var qe=de[Ae],Ge=0;Ge<qe.length;Ge++){var Ie=qe[Ge];Z=Math.min(Z,Ie.x),Q=Math.max(Q,Ie.x),fe=Math.min(fe,Ie.y),we=Math.max(we,Ie.y)}return[Z,fe,Q,we]},He.prototype.toGeoJSON=K.prototype.toGeoJSON;var Ne=a.pbf,We=xe;function gt(de){var Z=new Ne;return function(Q,fe){for(var we in Q.layers)fe.writeMessage(3,Lt,Q.layers[we])}(de,Z),Z.finish()}function Lt(de,Z){var Q;Z.writeVarintField(15,de.version||1),Z.writeStringField(1,de.name||""),Z.writeVarintField(5,de.extent||4096);var fe={keys:[],values:[],keycache:{},valuecache:{}};for(Q=0;Q<de.length;Q++)fe.feature=de.feature(Q),Z.writeMessage(2,_t,fe);var we=fe.keys;for(Q=0;Q<we.length;Q++)Z.writeStringField(3,we[Q]);var Ae=fe.values;for(Q=0;Q<Ae.length;Q++)Z.writeMessage(4,ae,Ae[Q])}function _t(de,Z){var Q=de.feature;Q.id!==void 0&&Z.writeVarintField(1,Q.id),Z.writeMessage(2,$e,de),Z.writeVarintField(3,Q.type),Z.writeMessage(4,Gt,Q)}function $e(de,Z){var Q=de.feature,fe=de.keys,we=de.values,Ae=de.keycache,qe=de.valuecache;for(var Ge in Q.properties){var Ie=Q.properties[Ge],nt=Ae[Ge];if(Ie!==null){nt===void 0&&(fe.push(Ge),Ae[Ge]=nt=fe.length-1),Z.writeVarint(nt);var Ct=typeof Ie;Ct!=="string"&&Ct!=="boolean"&&Ct!=="number"&&(Ie=JSON.stringify(Ie));var Xt=Ct+":"+Ie,Dt=qe[Xt];Dt===void 0&&(we.push(Ie),qe[Xt]=Dt=we.length-1),Z.writeVarint(Dt)}}}function Fe(de,Z){return(Z<<3)+(7&de)}function At(de){return de<<1^de>>31}function Gt(de,Z){for(var Q=de.loadGeometry(),fe=de.type,we=0,Ae=0,qe=Q.length,Ge=0;Ge<qe;Ge++){var Ie=Q[Ge],nt=1;fe===1&&(nt=Ie.length),Z.writeVarint(Fe(1,nt));for(var Ct=fe===3?Ie.length-1:Ie.length,Xt=0;Xt<Ct;Xt++){Xt===1&&fe!==1&&Z.writeVarint(Fe(2,Ct-1));var Dt=Ie[Xt].x-we,_r=Ie[Xt].y-Ae;Z.writeVarint(At(Dt)),Z.writeVarint(At(_r)),we+=Dt,Ae+=_r}fe===3&&Z.writeVarint(Fe(7,1))}}function ae(de,Z){var Q=typeof de;Q==="string"?Z.writeStringField(1,de):Q==="boolean"?Z.writeBooleanField(7,de):Q==="number"&&(de%1!=0?Z.writeDoubleField(3,de):de<0?Z.writeSVarintField(6,de):Z.writeVarintField(5,de))}function D(de,Z,Q,fe,we,Ae){if(we-fe<=Q)return;const qe=fe+we>>1;U(de,Z,qe,fe,we,Ae%2),D(de,Z,Q,fe,qe-1,Ae+1),D(de,Z,Q,qe+1,we,Ae+1)}function U(de,Z,Q,fe,we,Ae){for(;we>fe;){if(we-fe>600){const nt=we-fe+1,Ct=Q-fe+1,Xt=Math.log(nt),Dt=.5*Math.exp(2*Xt/3),_r=.5*Math.sqrt(Xt*Dt*(nt-Dt)/nt)*(Ct-nt/2<0?-1:1);U(de,Z,Q,Math.max(fe,Math.floor(Q-Ct*Dt/nt+_r)),Math.min(we,Math.floor(Q+(nt-Ct)*Dt/nt+_r)),Ae)}const qe=Z[2*Q+Ae];let Ge=fe,Ie=we;for(q(de,Z,fe,Q),Z[2*we+Ae]>qe&&q(de,Z,fe,we);Ge<Ie;){for(q(de,Z,Ge,Ie),Ge++,Ie--;Z[2*Ge+Ae]<qe;)Ge++;for(;Z[2*Ie+Ae]>qe;)Ie--}Z[2*fe+Ae]===qe?q(de,Z,fe,Ie):(Ie++,q(de,Z,Ie,we)),Ie<=Q&&(fe=Ie+1),Q<=Ie&&(we=Ie-1)}}function q(de,Z,Q,fe){ne(de,Q,fe),ne(Z,2*Q,2*fe),ne(Z,2*Q+1,2*fe+1)}function ne(de,Z,Q){const fe=de[Z];de[Z]=de[Q],de[Q]=fe}function ye(de,Z,Q,fe){const we=de-Q,Ae=Z-fe;return we*we+Ae*Ae}G.exports=gt,V.fromVectorTileJs=gt,V.fromGeojsonVt=function(de,Z){Z=Z||{};var Q={};for(var fe in de)Q[fe]=new We(de[fe].features,Z),Q[fe].name=fe,Q[fe].version=Z.version,Q[fe].extent=Z.extent;return gt({layers:Q})},V.GeoJSONWrapper=We;const ve=de=>de[0],ze=de=>de[1];class je{constructor(Z,Q=ve,fe=ze,we=64,Ae=Float64Array){this.nodeSize=we,this.points=Z;const qe=Z.length<65536?Uint16Array:Uint32Array,Ge=this.ids=new qe(Z.length),Ie=this.coords=new Ae(2*Z.length);for(let nt=0;nt<Z.length;nt++)Ge[nt]=nt,Ie[2*nt]=Q(Z[nt]),Ie[2*nt+1]=fe(Z[nt]);D(Ge,Ie,we,0,Ge.length-1,0)}range(Z,Q,fe,we){return function(Ae,qe,Ge,Ie,nt,Ct,Xt){const Dt=[0,Ae.length-1,0],_r=[];let Tt,Ee;for(;Dt.length;){const mt=Dt.pop(),It=Dt.pop(),pr=Dt.pop();if(It-pr<=Xt){for(let Lr=pr;Lr<=It;Lr++)Tt=qe[2*Lr],Ee=qe[2*Lr+1],Tt>=Ge&&Tt<=nt&&Ee>=Ie&&Ee<=Ct&&_r.push(Ae[Lr]);continue}const or=Math.floor((pr+It)/2);Tt=qe[2*or],Ee=qe[2*or+1],Tt>=Ge&&Tt<=nt&&Ee>=Ie&&Ee<=Ct&&_r.push(Ae[or]);const Nr=(mt+1)%2;(mt===0?Ge<=Tt:Ie<=Ee)&&(Dt.push(pr),Dt.push(or-1),Dt.push(Nr)),(mt===0?nt>=Tt:Ct>=Ee)&&(Dt.push(or+1),Dt.push(It),Dt.push(Nr))}return _r}(this.ids,this.coords,Z,Q,fe,we,this.nodeSize)}within(Z,Q,fe){return function(we,Ae,qe,Ge,Ie,nt){const Ct=[0,we.length-1,0],Xt=[],Dt=Ie*Ie;for(;Ct.length;){const _r=Ct.pop(),Tt=Ct.pop(),Ee=Ct.pop();if(Tt-Ee<=nt){for(let Nr=Ee;Nr<=Tt;Nr++)ye(Ae[2*Nr],Ae[2*Nr+1],qe,Ge)<=Dt&&Xt.push(we[Nr]);continue}const mt=Math.floor((Ee+Tt)/2),It=Ae[2*mt],pr=Ae[2*mt+1];ye(It,pr,qe,Ge)<=Dt&&Xt.push(we[mt]);const or=(_r+1)%2;(_r===0?qe-Ie<=It:Ge-Ie<=pr)&&(Ct.push(Ee),Ct.push(mt-1),Ct.push(or)),(_r===0?qe+Ie>=It:Ge+Ie>=pr)&&(Ct.push(mt+1),Ct.push(Tt),Ct.push(or))}return Xt}(this.ids,this.coords,Z,Q,fe,this.nodeSize)}}const Je={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:de=>de},xt=Math.fround||(kt=new Float32Array(1),de=>(kt[0]=+de,kt[0]));var kt;class jt{constructor(Z){this.options=Sr(Object.create(Je),Z),this.trees=new Array(this.options.maxZoom+1)}load(Z){const{log:Q,minZoom:fe,maxZoom:we,nodeSize:Ae}=this.options;Q&&console.time("total time");const qe=`prepare ${Z.length} points`;Q&&console.time(qe),this.points=Z;let Ge=[];for(let Ie=0;Ie<Z.length;Ie++)Z[Ie].geometry&&Ge.push(Ft(Z[Ie],Ie));this.trees[we+1]=new je(Ge,Or,se,Ae,Float32Array),Q&&console.timeEnd(qe);for(let Ie=we;Ie>=fe;Ie--){const nt=+Date.now();Ge=this._cluster(Ge,Ie),this.trees[Ie]=new je(Ge,Or,se,Ae,Float32Array),Q&&console.log("z%d: %d clusters in %dms",Ie,Ge.length,+Date.now()-nt)}return Q&&console.timeEnd("total time"),this}getClusters(Z,Q){let fe=((Z[0]+180)%360+360)%360-180;const we=Math.max(-90,Math.min(90,Z[1]));let Ae=Z[2]===180?180:((Z[2]+180)%360+360)%360-180;const qe=Math.max(-90,Math.min(90,Z[3]));if(Z[2]-Z[0]>=360)fe=-180,Ae=180;else if(fe>Ae){const Ct=this.getClusters([fe,we,180,qe],Q),Xt=this.getClusters([-180,we,Ae,qe],Q);return Ct.concat(Xt)}const Ge=this.trees[this._limitZoom(Q)],Ie=Ge.range(wr(fe),$r(qe),wr(Ae),$r(we)),nt=[];for(const Ct of Ie){const Xt=Ge.points[Ct];nt.push(Xt.numPoints?Jt(Xt):this.points[Xt.index])}return nt}getChildren(Z){const Q=this._getOriginId(Z),fe=this._getOriginZoom(Z),we="No cluster with the specified id.",Ae=this.trees[fe];if(!Ae)throw new Error(we);const qe=Ae.points[Q];if(!qe)throw new Error(we);const Ge=this.options.radius/(this.options.extent*Math.pow(2,fe-1)),Ie=Ae.within(qe.x,qe.y,Ge),nt=[];for(const Ct of Ie){const Xt=Ae.points[Ct];Xt.parentId===Z&&nt.push(Xt.numPoints?Jt(Xt):this.points[Xt.index])}if(nt.length===0)throw new Error(we);return nt}getLeaves(Z,Q,fe){const we=[];return this._appendLeaves(we,Z,Q=Q||10,fe=fe||0,0),we}getTile(Z,Q,fe){const we=this.trees[this._limitZoom(Z)],Ae=Math.pow(2,Z),{extent:qe,radius:Ge}=this.options,Ie=Ge/qe,nt=(fe-Ie)/Ae,Ct=(fe+1+Ie)/Ae,Xt={features:[]};return this._addTileFeatures(we.range((Q-Ie)/Ae,nt,(Q+1+Ie)/Ae,Ct),we.points,Q,fe,Ae,Xt),Q===0&&this._addTileFeatures(we.range(1-Ie/Ae,nt,1,Ct),we.points,Ae,fe,Ae,Xt),Q===Ae-1&&this._addTileFeatures(we.range(0,nt,Ie/Ae,Ct),we.points,-1,fe,Ae,Xt),Xt.features.length?Xt:null}getClusterExpansionZoom(Z){let Q=this._getOriginZoom(Z)-1;for(;Q<=this.options.maxZoom;){const fe=this.getChildren(Z);if(Q++,fe.length!==1)break;Z=fe[0].properties.cluster_id}return Q}_appendLeaves(Z,Q,fe,we,Ae){const qe=this.getChildren(Q);for(const Ge of qe){const Ie=Ge.properties;if(Ie&&Ie.cluster?Ae+Ie.point_count<=we?Ae+=Ie.point_count:Ae=this._appendLeaves(Z,Ie.cluster_id,fe,we,Ae):Ae<we?Ae++:Z.push(Ge),Z.length===fe)break}return Ae}_addTileFeatures(Z,Q,fe,we,Ae,qe){for(const Ge of Z){const Ie=Q[Ge],nt=Ie.numPoints;let Ct,Xt,Dt;if(nt)Ct=et(Ie),Xt=Ie.x,Dt=Ie.y;else{const Ee=this.points[Ie.index];Ct=Ee.properties,Xt=wr(Ee.geometry.coordinates[0]),Dt=$r(Ee.geometry.coordinates[1])}const _r={type:1,geometry:[[Math.round(this.options.extent*(Xt*Ae-fe)),Math.round(this.options.extent*(Dt*Ae-we))]],tags:Ct};let Tt;nt?Tt=Ie.id:this.options.generateId?Tt=Ie.index:this.points[Ie.index].id&&(Tt=this.points[Ie.index].id),Tt!==void 0&&(_r.id=Tt),qe.features.push(_r)}}_limitZoom(Z){return Math.max(this.options.minZoom,Math.min(Math.floor(+Z),this.options.maxZoom+1))}_cluster(Z,Q){const fe=[],{radius:we,extent:Ae,reduce:qe,minPoints:Ge}=this.options,Ie=we/(Ae*Math.pow(2,Q));for(let nt=0;nt<Z.length;nt++){const Ct=Z[nt];if(Ct.zoom<=Q)continue;Ct.zoom=Q;const Xt=this.trees[Q+1],Dt=Xt.within(Ct.x,Ct.y,Ie),_r=Ct.numPoints||1;let Tt=_r;for(const Ee of Dt){const mt=Xt.points[Ee];mt.zoom>Q&&(Tt+=mt.numPoints||1)}if(Tt>_r&&Tt>=Ge){let Ee=Ct.x*_r,mt=Ct.y*_r,It=qe&&_r>1?this._map(Ct,!0):null;const pr=(nt<<5)+(Q+1)+this.points.length;for(const or of Dt){const Nr=Xt.points[or];if(Nr.zoom<=Q)continue;Nr.zoom=Q;const Lr=Nr.numPoints||1;Ee+=Nr.x*Lr,mt+=Nr.y*Lr,Nr.parentId=pr,qe&&(It||(It=this._map(Ct,!0)),qe(It,this._map(Nr)))}Ct.parentId=pr,fe.push(yr(Ee/Tt,mt/Tt,pr,Tt,It))}else if(fe.push(Ct),Tt>1)for(const Ee of Dt){const mt=Xt.points[Ee];mt.zoom<=Q||(mt.zoom=Q,fe.push(mt))}}return fe}_getOriginId(Z){return Z-this.points.length>>5}_getOriginZoom(Z){return(Z-this.points.length)%32}_map(Z,Q){if(Z.numPoints)return Q?Sr({},Z.properties):Z.properties;const fe=this.points[Z.index].properties,we=this.options.map(fe);return Q&&we===fe?Sr({},we):we}}function yr(de,Z,Q,fe,we){return{x:xt(de),y:xt(Z),zoom:1/0,id:Q,parentId:-1,numPoints:fe,properties:we}}function Ft(de,Z){const[Q,fe]=de.geometry.coordinates;return{x:xt(wr(Q)),y:xt($r(fe)),zoom:1/0,index:Z,parentId:-1}}function Jt(de){return{type:"Feature",id:de.id,properties:et(de),geometry:{type:"Point",coordinates:[(Z=de.x,360*(Z-.5)),lr(de.y)]}};var Z}function et(de){const Z=de.numPoints,Q=Z>=1e4?`${Math.round(Z/1e3)}k`:Z>=1e3?Math.round(Z/100)/10+"k":Z;return Sr(Sr({},de.properties),{cluster:!0,cluster_id:de.id,point_count:Z,point_count_abbreviated:Q})}function wr(de){return de/360+.5}function $r(de){const Z=Math.sin(de*Math.PI/180),Q=.5-.25*Math.log((1+Z)/(1-Z))/Math.PI;return Q<0?0:Q>1?1:Q}function lr(de){const Z=(180-360*de)*Math.PI/180;return 360*Math.atan(Math.exp(Z))/Math.PI-90}function Sr(de,Z){for(const Q in Z)de[Q]=Z[Q];return de}function Or(de){return de.x}function se(de){return de.y}function _e(de,Z,Q,fe){for(var we,Ae=fe,qe=Q-Z>>1,Ge=Q-Z,Ie=de[Z],nt=de[Z+1],Ct=de[Q],Xt=de[Q+1],Dt=Z+3;Dt<Q;Dt+=3){var _r=Re(de[Dt],de[Dt+1],Ie,nt,Ct,Xt);if(_r>Ae)we=Dt,Ae=_r;else if(_r===Ae){var Tt=Math.abs(Dt-qe);Tt<Ge&&(we=Dt,Ge=Tt)}}Ae>fe&&(we-Z>3&&_e(de,Z,we,fe),de[we+2]=Ae,Q-we>3&&_e(de,we,Q,fe))}function Re(de,Z,Q,fe,we,Ae){var qe=we-Q,Ge=Ae-fe;if(qe!==0||Ge!==0){var Ie=((de-Q)*qe+(Z-fe)*Ge)/(qe*qe+Ge*Ge);Ie>1?(Q=we,fe=Ae):Ie>0&&(Q+=qe*Ie,fe+=Ge*Ie)}return(qe=de-Q)*qe+(Ge=Z-fe)*Ge}function Ke(de,Z,Q,fe){var we={id:de===void 0?null:de,type:Z,geometry:Q,tags:fe,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(Ae){var qe=Ae.geometry,Ge=Ae.type;if(Ge==="Point"||Ge==="MultiPoint"||Ge==="LineString")Be(Ae,qe);else if(Ge==="Polygon"||Ge==="MultiLineString")for(var Ie=0;Ie<qe.length;Ie++)Be(Ae,qe[Ie]);else if(Ge==="MultiPolygon")for(Ie=0;Ie<qe.length;Ie++)for(var nt=0;nt<qe[Ie].length;nt++)Be(Ae,qe[Ie][nt])}(we),we}function Be(de,Z){for(var Q=0;Q<Z.length;Q+=3)de.minX=Math.min(de.minX,Z[Q]),de.minY=Math.min(de.minY,Z[Q+1]),de.maxX=Math.max(de.maxX,Z[Q]),de.maxY=Math.max(de.maxY,Z[Q+1])}function rt(de,Z,Q,fe){if(Z.geometry){var we=Z.geometry.coordinates,Ae=Z.geometry.type,qe=Math.pow(Q.tolerance/((1<<Q.maxZoom)*Q.extent),2),Ge=[],Ie=Z.id;if(Q.promoteId?Ie=Z.properties[Q.promoteId]:Q.generateId&&(Ie=fe||0),Ae==="Point")Ue(we,Ge);else if(Ae==="MultiPoint")for(var nt=0;nt<we.length;nt++)Ue(we[nt],Ge);else if(Ae==="LineString")Ve(we,Ge,qe,!1);else if(Ae==="MultiLineString"){if(Q.lineMetrics){for(nt=0;nt<we.length;nt++)Ve(we[nt],Ge=[],qe,!1),de.push(Ke(Ie,"LineString",Ge,Z.properties));return}st(we,Ge,qe,!1)}else if(Ae==="Polygon")st(we,Ge,qe,!0);else{if(Ae!=="MultiPolygon"){if(Ae==="GeometryCollection"){for(nt=0;nt<Z.geometry.geometries.length;nt++)rt(de,{id:Ie,geometry:Z.geometry.geometries[nt],properties:Z.properties},Q,fe);return}throw new Error("Input data is not a valid GeoJSON object.")}for(nt=0;nt<we.length;nt++){var Ct=[];st(we[nt],Ct,qe,!0),Ge.push(Ct)}}de.push(Ke(Ie,Ae,Ge,Z.properties))}}function Ue(de,Z){Z.push(Ze(de[0])),Z.push(ft(de[1])),Z.push(0)}function Ve(de,Z,Q,fe){for(var we,Ae,qe=0,Ge=0;Ge<de.length;Ge++){var Ie=Ze(de[Ge][0]),nt=ft(de[Ge][1]);Z.push(Ie),Z.push(nt),Z.push(0),Ge>0&&(qe+=fe?(we*nt-Ie*Ae)/2:Math.sqrt(Math.pow(Ie-we,2)+Math.pow(nt-Ae,2))),we=Ie,Ae=nt}var Ct=Z.length-3;Z[2]=1,_e(Z,0,Ct,Q),Z[Ct+2]=1,Z.size=Math.abs(qe),Z.start=0,Z.end=Z.size}function st(de,Z,Q,fe){for(var we=0;we<de.length;we++){var Ae=[];Ve(de[we],Ae,Q,fe),Z.push(Ae)}}function Ze(de){return de/360+.5}function ft(de){var Z=Math.sin(de*Math.PI/180),Q=.5-.25*Math.log((1+Z)/(1-Z))/Math.PI;return Q<0?0:Q>1?1:Q}function zt(de,Z,Q,fe,we,Ae,qe,Ge){if(fe/=Z,Ae>=(Q/=Z)&&qe<fe)return de;if(qe<Q||Ae>=fe)return null;for(var Ie=[],nt=0;nt<de.length;nt++){var Ct=de[nt],Xt=Ct.geometry,Dt=Ct.type,_r=we===0?Ct.minX:Ct.minY,Tt=we===0?Ct.maxX:Ct.maxY;if(_r>=Q&&Tt<fe)Ie.push(Ct);else if(!(Tt<Q||_r>=fe)){var Ee=[];if(Dt==="Point"||Dt==="MultiPoint")nr(Xt,Ee,Q,fe,we);else if(Dt==="LineString")cr(Xt,Ee,Q,fe,we,!1,Ge.lineMetrics);else if(Dt==="MultiLineString")Vr(Xt,Ee,Q,fe,we,!1);else if(Dt==="Polygon")Vr(Xt,Ee,Q,fe,we,!0);else if(Dt==="MultiPolygon")for(var mt=0;mt<Xt.length;mt++){var It=[];Vr(Xt[mt],It,Q,fe,we,!0),It.length&&Ee.push(It)}if(Ee.length){if(Ge.lineMetrics&&Dt==="LineString"){for(mt=0;mt<Ee.length;mt++)Ie.push(Ke(Ct.id,Dt,Ee[mt],Ct.tags));continue}Dt!=="LineString"&&Dt!=="MultiLineString"||(Ee.length===1?(Dt="LineString",Ee=Ee[0]):Dt="MultiLineString"),Dt!=="Point"&&Dt!=="MultiPoint"||(Dt=Ee.length===3?"Point":"MultiPoint"),Ie.push(Ke(Ct.id,Dt,Ee,Ct.tags))}}}return Ie.length?Ie:null}function nr(de,Z,Q,fe,we){for(var Ae=0;Ae<de.length;Ae+=3){var qe=de[Ae+we];qe>=Q&&qe<=fe&&(Z.push(de[Ae]),Z.push(de[Ae+1]),Z.push(de[Ae+2]))}}function cr(de,Z,Q,fe,we,Ae,qe){for(var Ge,Ie,nt=Pr(de),Ct=we===0?Ir:Ar,Xt=de.start,Dt=0;Dt<de.length-3;Dt+=3){var _r=de[Dt],Tt=de[Dt+1],Ee=de[Dt+2],mt=de[Dt+3],It=de[Dt+4],pr=we===0?_r:Tt,or=we===0?mt:It,Nr=!1;qe&&(Ge=Math.sqrt(Math.pow(_r-mt,2)+Math.pow(Tt-It,2))),pr<Q?or>Q&&(Ie=Ct(nt,_r,Tt,mt,It,Q),qe&&(nt.start=Xt+Ge*Ie)):pr>fe?or<fe&&(Ie=Ct(nt,_r,Tt,mt,It,fe),qe&&(nt.start=Xt+Ge*Ie)):gn(nt,_r,Tt,Ee),or<Q&&pr>=Q&&(Ie=Ct(nt,_r,Tt,mt,It,Q),Nr=!0),or>fe&&pr<=fe&&(Ie=Ct(nt,_r,Tt,mt,It,fe),Nr=!0),!Ae&&Nr&&(qe&&(nt.end=Xt+Ge*Ie),Z.push(nt),nt=Pr(de)),qe&&(Xt+=Ge)}var Lr=de.length-3;_r=de[Lr],Tt=de[Lr+1],Ee=de[Lr+2],(pr=we===0?_r:Tt)>=Q&&pr<=fe&&gn(nt,_r,Tt,Ee),Lr=nt.length-3,Ae&&Lr>=3&&(nt[Lr]!==nt[0]||nt[Lr+1]!==nt[1])&&gn(nt,nt[0],nt[1],nt[2]),nt.length&&Z.push(nt)}function Pr(de){var Z=[];return Z.size=de.size,Z.start=de.start,Z.end=de.end,Z}function Vr(de,Z,Q,fe,we,Ae){for(var qe=0;qe<de.length;qe++)cr(de[qe],Z,Q,fe,we,Ae,!1)}function gn(de,Z,Q,fe){de.push(Z),de.push(Q),de.push(fe)}function Ir(de,Z,Q,fe,we,Ae){var qe=(Ae-Z)/(fe-Z);return de.push(Ae),de.push(Q+(we-Q)*qe),de.push(1),qe}function Ar(de,Z,Q,fe,we,Ae){var qe=(Ae-Q)/(we-Q);return de.push(Z+(fe-Z)*qe),de.push(Ae),de.push(1),qe}function sn(de,Z){for(var Q=[],fe=0;fe<de.length;fe++){var we,Ae=de[fe],qe=Ae.type;if(qe==="Point"||qe==="MultiPoint"||qe==="LineString")we=on(Ae.geometry,Z);else if(qe==="MultiLineString"||qe==="Polygon"){we=[];for(var Ge=0;Ge<Ae.geometry.length;Ge++)we.push(on(Ae.geometry[Ge],Z))}else if(qe==="MultiPolygon")for(we=[],Ge=0;Ge<Ae.geometry.length;Ge++){for(var Ie=[],nt=0;nt<Ae.geometry[Ge].length;nt++)Ie.push(on(Ae.geometry[Ge][nt],Z));we.push(Ie)}Q.push(Ke(Ae.id,qe,we,Ae.tags))}return Q}function on(de,Z){var Q=[];Q.size=de.size,de.start!==void 0&&(Q.start=de.start,Q.end=de.end);for(var fe=0;fe<de.length;fe+=3)Q.push(de[fe]+Z,de[fe+1],de[fe+2]);return Q}function Fr(de,Z){if(de.transformed)return de;var Q,fe,we,Ae=1<<de.z,qe=de.x,Ge=de.y;for(Q=0;Q<de.features.length;Q++){var Ie=de.features[Q],nt=Ie.geometry,Ct=Ie.type;if(Ie.geometry=[],Ct===1)for(fe=0;fe<nt.length;fe+=2)Ie.geometry.push(jr(nt[fe],nt[fe+1],Z,Ae,qe,Ge));else for(fe=0;fe<nt.length;fe++){var Xt=[];for(we=0;we<nt[fe].length;we+=2)Xt.push(jr(nt[fe][we],nt[fe][we+1],Z,Ae,qe,Ge));Ie.geometry.push(Xt)}}return de.transformed=!0,de}function jr(de,Z,Q,fe,we,Ae){return[Math.round(Q*(de*fe-we)),Math.round(Q*(Z*fe-Ae))]}function tn(de,Z,Q,fe,we){for(var Ae=Z===we.maxZoom?0:we.tolerance/((1<<Z)*we.extent),qe={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:Q,y:fe,z:Z,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Ge=0;Ge<de.length;Ge++){qe.numFeatures++,ei(qe,de[Ge],Ae,we);var Ie=de[Ge].minX,nt=de[Ge].minY,Ct=de[Ge].maxX,Xt=de[Ge].maxY;Ie<qe.minX&&(qe.minX=Ie),nt<qe.minY&&(qe.minY=nt),Ct>qe.maxX&&(qe.maxX=Ct),Xt>qe.maxY&&(qe.maxY=Xt)}return qe}function ei(de,Z,Q,fe){var we=Z.geometry,Ae=Z.type,qe=[];if(Ae==="Point"||Ae==="MultiPoint")for(var Ge=0;Ge<we.length;Ge+=3)qe.push(we[Ge]),qe.push(we[Ge+1]),de.numPoints++,de.numSimplified++;else if(Ae==="LineString")xn(qe,we,de,Q,!1,!1);else if(Ae==="MultiLineString"||Ae==="Polygon")for(Ge=0;Ge<we.length;Ge++)xn(qe,we[Ge],de,Q,Ae==="Polygon",Ge===0);else if(Ae==="MultiPolygon")for(var Ie=0;Ie<we.length;Ie++){var nt=we[Ie];for(Ge=0;Ge<nt.length;Ge++)xn(qe,nt[Ge],de,Q,!0,Ge===0)}if(qe.length){var Ct=Z.tags||null;if(Ae==="LineString"&&fe.lineMetrics){for(var Xt in Ct={},Z.tags)Ct[Xt]=Z.tags[Xt];Ct.mapbox_clip_start=we.start/we.size,Ct.mapbox_clip_end=we.end/we.size}var Dt={geometry:qe,type:Ae==="Polygon"||Ae==="MultiPolygon"?3:Ae==="LineString"||Ae==="MultiLineString"?2:1,tags:Ct};Z.id!==null&&(Dt.id=Z.id),de.features.push(Dt)}}function xn(de,Z,Q,fe,we,Ae){var qe=fe*fe;if(fe>0&&Z.size<(we?qe:fe))Q.numPoints+=Z.length/3;else{for(var Ge=[],Ie=0;Ie<Z.length;Ie+=3)(fe===0||Z[Ie+2]>qe)&&(Q.numSimplified++,Ge.push(Z[Ie]),Ge.push(Z[Ie+1])),Q.numPoints++;we&&function(nt,Ct){for(var Xt=0,Dt=0,_r=nt.length,Tt=_r-2;Dt<_r;Tt=Dt,Dt+=2)Xt+=(nt[Dt]-nt[Tt])*(nt[Dt+1]+nt[Tt+1]);if(Xt>0===Ct)for(Dt=0,_r=nt.length;Dt<_r/2;Dt+=2){var Ee=nt[Dt],mt=nt[Dt+1];nt[Dt]=nt[_r-2-Dt],nt[Dt+1]=nt[_r-1-Dt],nt[_r-2-Dt]=Ee,nt[_r-1-Dt]=mt}}(Ge,Ae),de.push(Ge)}}function ln(de,Z){var Q=(Z=this.options=function(we,Ae){for(var qe in Ae)we[qe]=Ae[qe];return we}(Object.create(this.options),Z)).debug;if(Q&&console.time("preprocess data"),Z.maxZoom<0||Z.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(Z.promoteId&&Z.generateId)throw new Error("promoteId and generateId cannot be used together.");var fe=function(we,Ae){var qe=[];if(we.type==="FeatureCollection")for(var Ge=0;Ge<we.features.length;Ge++)rt(qe,we.features[Ge],Ae,Ge);else rt(qe,we.type==="Feature"?we:{geometry:we},Ae);return qe}(de,Z);this.tiles={},this.tileCoords=[],Q&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",Z.indexMaxZoom,Z.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),fe=function(we,Ae){var qe=Ae.buffer/Ae.extent,Ge=we,Ie=zt(we,1,-1-qe,qe,0,-1,2,Ae),nt=zt(we,1,1-qe,2+qe,0,-1,2,Ae);return(Ie||nt)&&(Ge=zt(we,1,-qe,1+qe,0,-1,2,Ae)||[],Ie&&(Ge=sn(Ie,1).concat(Ge)),nt&&(Ge=Ge.concat(sn(nt,-1)))),Ge}(fe,Z),fe.length&&this.splitTile(fe,0,0,0),Q&&(fe.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function zr(de,Z,Q){return 32*((1<<de)*Q+Z)+de}function vo(de,Z){const Q=de.tileID.canonical;if(!this._geoJSONIndex)return Z(null,null);const fe=this._geoJSONIndex.getTile(Q.z,Q.x,Q.y);if(!fe)return Z(null,null);const we=new z(fe.features);let Ae=V(we);Ae.byteOffset===0&&Ae.byteLength===Ae.buffer.byteLength||(Ae=new Uint8Array(Ae)),Z(null,{vectorTile:we,rawData:Ae.buffer})}ln.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},ln.prototype.splitTile=function(de,Z,Q,fe,we,Ae,qe){for(var Ge=[de,Z,Q,fe],Ie=this.options,nt=Ie.debug;Ge.length;){fe=Ge.pop(),Q=Ge.pop(),Z=Ge.pop(),de=Ge.pop();var Ct=1<<Z,Xt=zr(Z,Q,fe),Dt=this.tiles[Xt];if(!Dt&&(nt>1&&console.time("creation"),Dt=this.tiles[Xt]=tn(de,Z,Q,fe,Ie),this.tileCoords.push({z:Z,x:Q,y:fe}),nt)){nt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",Z,Q,fe,Dt.numFeatures,Dt.numPoints,Dt.numSimplified),console.timeEnd("creation"));var _r="z"+Z;this.stats[_r]=(this.stats[_r]||0)+1,this.total++}if(Dt.source=de,we){if(Z===Ie.maxZoom||Z===we)continue;var Tt=1<<we-Z;if(Q!==Math.floor(Ae/Tt)||fe!==Math.floor(qe/Tt))continue}else if(Z===Ie.indexMaxZoom||Dt.numPoints<=Ie.indexMaxPoints)continue;if(Dt.source=null,de.length!==0){nt>1&&console.time("clipping");var Ee,mt,It,pr,or,Nr,Lr=.5*Ie.buffer/Ie.extent,oa=.5-Lr,Gn=.5+Lr,yt=1+Lr;Ee=mt=It=pr=null,or=zt(de,Ct,Q-Lr,Q+Gn,0,Dt.minX,Dt.maxX,Ie),Nr=zt(de,Ct,Q+oa,Q+yt,0,Dt.minX,Dt.maxX,Ie),de=null,or&&(Ee=zt(or,Ct,fe-Lr,fe+Gn,1,Dt.minY,Dt.maxY,Ie),mt=zt(or,Ct,fe+oa,fe+yt,1,Dt.minY,Dt.maxY,Ie),or=null),Nr&&(It=zt(Nr,Ct,fe-Lr,fe+Gn,1,Dt.minY,Dt.maxY,Ie),pr=zt(Nr,Ct,fe+oa,fe+yt,1,Dt.minY,Dt.maxY,Ie),Nr=null),nt>1&&console.timeEnd("clipping"),Ge.push(Ee||[],Z+1,2*Q,2*fe),Ge.push(mt||[],Z+1,2*Q,2*fe+1),Ge.push(It||[],Z+1,2*Q+1,2*fe),Ge.push(pr||[],Z+1,2*Q+1,2*fe+1)}}},ln.prototype.getTile=function(de,Z,Q){var fe=this.options,we=fe.extent,Ae=fe.debug;if(de<0||de>24)return null;var qe=1<<de,Ge=zr(de,Z=(Z%qe+qe)%qe,Q);if(this.tiles[Ge])return Fr(this.tiles[Ge],we);Ae>1&&console.log("drilling down to z%d-%d-%d",de,Z,Q);for(var Ie,nt=de,Ct=Z,Xt=Q;!Ie&&nt>0;)nt--,Ct=Math.floor(Ct/2),Xt=Math.floor(Xt/2),Ie=this.tiles[zr(nt,Ct,Xt)];return Ie&&Ie.source?(Ae>1&&console.log("found parent tile z%d-%d-%d",nt,Ct,Xt),Ae>1&&console.time("drilling down"),this.splitTile(Ie.source,nt,Ct,Xt,de,Z,Q),Ae>1&&console.timeEnd("drilling down"),this.tiles[Ge]?Fr(this.tiles[Ge],we):null):null};class ia extends a.VectorTileWorkerSource{constructor(Z,Q,fe,we,Ae){super(Z,Q,fe,we,vo),Ae&&(this.loadGeoJSON=Ae)}loadData(Z,Q){const fe=Z&&Z.request,we=fe&&fe.collectResourceTiming;this.loadGeoJSON(Z,(Ae,qe)=>{if(Ae||!qe)return Q(Ae);if(typeof qe!="object")return Q(new Error(`Input data given to '${Z.source}' is not a valid GeoJSON object.`));{T(qe,!0);try{if(Z.filter){const Ie=a.createExpression(Z.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Ie.result==="error")throw new Error(Ie.value.map(Ct=>`${Ct.key}: ${Ct.message}`).join(", "));qe={type:"FeatureCollection",features:qe.features.filter(Ct=>Ie.value.evaluate({zoom:0},Ct))}}this._geoJSONIndex=Z.cluster?new jt(function({superclusterOptions:Ie,clusterProperties:nt}){if(!nt||!Ie)return Ie;const Ct={},Xt={},Dt={accumulated:null,zoom:0},_r={properties:null},Tt=Object.keys(nt);for(const Ee of Tt){const[mt,It]=nt[Ee],pr=a.createExpression(It),or=a.createExpression(typeof mt=="string"?[mt,["accumulated"],["get",Ee]]:mt);Ct[Ee]=pr.value,Xt[Ee]=or.value}return Ie.map=Ee=>{_r.properties=Ee;const mt={};for(const It of Tt)mt[It]=Ct[It].evaluate(Dt,_r);return mt},Ie.reduce=(Ee,mt)=>{_r.properties=mt;for(const It of Tt)Dt.accumulated=Ee[It],Ee[It]=Xt[It].evaluate(Dt,_r)},Ie}(Z)).load(qe.features):function(Ie,nt){return new ln(Ie,nt)}(qe,Z.geojsonVtOptions)}catch(Ie){return Q(Ie)}this.loaded={};const Ge={};if(we){const Ie=a.getPerformanceMeasurement(fe);Ie&&(Ge.resourceTiming={},Ge.resourceTiming[Z.source]=JSON.parse(JSON.stringify(Ie)))}Q(null,Ge)}})}reloadTile(Z,Q){const fe=this.loaded;return fe&&fe[Z.uid]?super.reloadTile(Z,Q):this.loadTile(Z,Q)}loadGeoJSON(Z,Q){if(Z.request)a.getJSON(Z.request,Q);else{if(typeof Z.data!="string")return Q(new Error(`Input data given to '${Z.source}' is not a valid GeoJSON object.`));try{return Q(null,JSON.parse(Z.data))}catch{return Q(new Error(`Input data given to '${Z.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(Z,Q){try{Q(null,this._geoJSONIndex.getClusterExpansionZoom(Z.clusterId))}catch(fe){Q(fe)}}getClusterChildren(Z,Q){try{Q(null,this._geoJSONIndex.getChildren(Z.clusterId))}catch(fe){Q(fe)}}getClusterLeaves(Z,Q){try{Q(null,this._geoJSONIndex.getLeaves(Z.clusterId,Z.limit,Z.offset))}catch(fe){Q(fe)}}}class jo{constructor(Z){this.self=Z,this.actor=new a.Actor(Z,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=a.getProjection({name:"mercator"}),this.workerSourceTypes={vector:a.VectorTileWorkerSource,geojson:ia},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(Q,fe)=>{if(this.workerSourceTypes[Q])throw new Error(`Worker source with name "${Q}" already registered.`);this.workerSourceTypes[Q]=fe},this.self.registerRTLTextPlugin=Q=>{if(a.plugin.isParsed())throw new Error("RTL text plugin already registered.");a.plugin.applyArabicShaping=Q.applyArabicShaping,a.plugin.processBidirectionalText=Q.processBidirectionalText,a.plugin.processStyledBidirectionalText=Q.processStyledBidirectionalText}}clearCaches(Z,Q,fe){delete this.layerIndexes[Z],delete this.availableImages[Z],delete this.workerSources[Z],delete this.demWorkerSources[Z],fe()}checkIfReady(Z,Q,fe){fe()}setReferrer(Z,Q){this.referrer=Q}spriteLoaded(Z,Q){this.isSpriteLoaded[Z]=Q;for(const fe in this.workerSources[Z]){const we=this.workerSources[Z][fe];for(const Ae in we)we[Ae]instanceof a.VectorTileWorkerSource&&(we[Ae].isSpriteLoaded=Q,we[Ae].fire(new a.Event("isSpriteLoaded")))}}setImages(Z,Q,fe){this.availableImages[Z]=Q;for(const we in this.workerSources[Z]){const Ae=this.workerSources[Z][we];for(const qe in Ae)Ae[qe].availableImages=Q}fe()}enableTerrain(Z,Q,fe){this.terrain=Q,fe()}setProjection(Z,Q){this.projections[Z]=a.getProjection(Q)}setLayers(Z,Q,fe){this.getLayerIndex(Z).replace(Q),fe()}updateLayers(Z,Q,fe){this.getLayerIndex(Z).update(Q.layers,Q.removedIds),fe()}loadTile(Z,Q,fe){const we=this.enableTerrain?a.extend({enableTerrain:this.terrain},Q):Q;we.projection=this.projections[Z]||this.defaultProjection,this.getWorkerSource(Z,Q.type,Q.source).loadTile(we,fe)}loadDEMTile(Z,Q,fe){const we=this.enableTerrain?a.extend({buildQuadTree:this.terrain},Q):Q;this.getDEMWorkerSource(Z,Q.source).loadTile(we,fe)}reloadTile(Z,Q,fe){const we=this.enableTerrain?a.extend({enableTerrain:this.terrain},Q):Q;we.projection=this.projections[Z]||this.defaultProjection,this.getWorkerSource(Z,Q.type,Q.source).reloadTile(we,fe)}abortTile(Z,Q,fe){this.getWorkerSource(Z,Q.type,Q.source).abortTile(Q,fe)}removeTile(Z,Q,fe){this.getWorkerSource(Z,Q.type,Q.source).removeTile(Q,fe)}removeSource(Z,Q,fe){if(!this.workerSources[Z]||!this.workerSources[Z][Q.type]||!this.workerSources[Z][Q.type][Q.source])return;const we=this.workerSources[Z][Q.type][Q.source];delete this.workerSources[Z][Q.type][Q.source],we.removeSource!==void 0?we.removeSource(Q,fe):fe()}loadWorkerSource(Z,Q,fe){try{this.self.importScripts(Q.url),fe()}catch(we){fe(we.toString())}}syncRTLPluginState(Z,Q,fe){try{a.plugin.setState(Q);const we=a.plugin.getPluginURL();if(a.plugin.isLoaded()&&!a.plugin.isParsed()&&we!=null){this.self.importScripts(we);const Ae=a.plugin.isParsed();fe(Ae?void 0:new Error(`RTL Text Plugin failed to import scripts from ${we}`),Ae)}}catch(we){fe(we.toString())}}getAvailableImages(Z){let Q=this.availableImages[Z];return Q||(Q=[]),Q}getLayerIndex(Z){let Q=this.layerIndexes[Z];return Q||(Q=this.layerIndexes[Z]=new g),Q}getWorkerSource(Z,Q,fe){if(this.workerSources[Z]||(this.workerSources[Z]={}),this.workerSources[Z][Q]||(this.workerSources[Z][Q]={}),!this.workerSources[Z][Q][fe]){const we={send:(Ae,qe,Ge,Ie,nt,Ct)=>{this.actor.send(Ae,qe,Ge,Z,nt,Ct)},scheduler:this.actor.scheduler};this.workerSources[Z][Q][fe]=new this.workerSourceTypes[Q](we,this.getLayerIndex(Z),this.getAvailableImages(Z),this.isSpriteLoaded[Z])}return this.workerSources[Z][Q][fe]}getDEMWorkerSource(Z,Q){return this.demWorkerSources[Z]||(this.demWorkerSources[Z]={}),this.demWorkerSources[Z][Q]||(this.demWorkerSources[Z][Q]=new S),this.demWorkerSources[Z][Q]}enforceCacheSizeLimit(Z,Q){a.enforceCacheSizeLimit(Q)}getWorkerPerformanceMetrics(Z,Q,fe){fe(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new jo(self)),jo}),o(["./shared"],function(a){function h(v,f){if(Array.isArray(v)){if(!Array.isArray(f)||v.length!==f.length)return!1;for(let m=0;m<v.length;m++)if(!h(v[m],f[m]))return!1;return!0}if(typeof v=="object"&&v!==null&&f!==null){if(typeof f!="object"||Object.keys(v).length!==Object.keys(f).length)return!1;for(const m in v)if(!h(v[m],f[m]))return!1;return!0}return v===f}var p=g;function g(v){return!function(f){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var b,x,E=new Blob([""],{type:"text/javascript"}),P=URL.createObjectURL(E);try{x=new Worker(P),b=!0}catch{b=!1}return x&&x.terminate(),URL.revokeObjectURL(P),b}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var b=document.createElement("canvas");b.width=b.height=1;var x=b.getContext("2d");if(!x)return!1;var E=x.getImageData(0,0,1,1);return E&&E.width===b.width}()?(S[m=f&&f.failIfMajorPerformanceCaveat]===void 0&&(S[m]=function(b){var x,E=function(P){var I=document.createElement("canvas"),L=Object.create(g.webGLContextAttributes);return L.failIfMajorPerformanceCaveat=P,I.getContext("webgl",L)||I.getContext("experimental-webgl",L)}(b);if(!E)return!1;try{x=E.createShader(E.VERTEX_SHADER)}catch{return!1}return!(!x||E.isContextLost())&&(E.shaderSource(x,"void main() {}"),E.compileShader(x),E.getShaderParameter(x,E.COMPILE_STATUS)===!0)}(m)),S[m]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var m}(v)}var S={};function T(v,f,m){const b=a.window.document.createElement(v);return f!==void 0&&(b.className=f),m&&m.appendChild(b),b}function R(v,f,m){const b=a.window.document.createElementNS("http://www.w3.org/2000/svg",v);for(const x of Object.keys(f))b.setAttributeNS(null,x,f[x]);return m&&m.appendChild(b),b}g.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const A=a.window.document&&a.window.document.documentElement.style,$=A&&A.userSelect!==void 0?"userSelect":"WebkitUserSelect";let j;function z(){A&&$&&(j=A[$],A[$]="none")}function V(){A&&$&&(A[$]=j)}function G(v){v.preventDefault(),v.stopPropagation(),a.window.removeEventListener("click",G,!0)}function ee(){a.window.addEventListener("click",G,!0),a.window.setTimeout(()=>{a.window.removeEventListener("click",G,!0)},0)}function K(v,f){const m=v.getBoundingClientRect();return He(v,m,f)}function xe(v,f){const m=v.getBoundingClientRect(),b=[];for(let x=0;x<f.length;x++)b.push(He(v,m,f[x]));return b}function Me(v){return a.window.InstallTrigger!==void 0&&v.button===2&&v.ctrlKey&&a.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:v.button}function He(v,f,m){const b=v.offsetWidth===f.width?1:v.offsetWidth/f.width;return new a.pointGeometry((m.clientX-f.left)*b,(m.clientY-f.top)*b)}function Ne(v,f){var m=f[0],b=f[1],x=f[2],E=f[3],P=m*E-x*b;return P?(v[0]=E*(P=1/P),v[1]=-b*P,v[2]=-x*P,v[3]=m*P,v):null}function We(v){const{userImage:f}=v;return!!(f&&f.render&&f.render())&&(v.data.replace(new Uint8Array(f.data.buffer)),!0)}class gt extends a.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new a.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(f){if(this.loaded!==f&&(this.loaded=f,f)){for(const{ids:m,callback:b}of this.requestors)this._notify(m,b);this.requestors=[]}}hasImage(f){return!!this.getImage(f)}getImage(f){return this.images[f]}addImage(f,m){this._validate(f,m)&&(this.images[f]=m)}_validate(f,m){let b=!0;return this._validateStretch(m.stretchX,m.data&&m.data.width)||(this.fire(new a.ErrorEvent(new Error(`Image "${f}" has invalid "stretchX" value`))),b=!1),this._validateStretch(m.stretchY,m.data&&m.data.height)||(this.fire(new a.ErrorEvent(new Error(`Image "${f}" has invalid "stretchY" value`))),b=!1),this._validateContent(m.content,m)||(this.fire(new a.ErrorEvent(new Error(`Image "${f}" has invalid "content" value`))),b=!1),b}_validateStretch(f,m){if(!f)return!0;let b=0;for(const x of f){if(x[0]<b||x[1]<x[0]||m<x[1])return!1;b=x[1]}return!0}_validateContent(f,m){return!(f&&(f.length!==4||f[0]<0||m.data.width<f[0]||f[1]<0||m.data.height<f[1]||f[2]<0||m.data.width<f[2]||f[3]<0||m.data.height<f[3]||f[2]<f[0]||f[3]<f[1]))}updateImage(f,m){m.version=this.images[f].version+1,this.images[f]=m,this.updatedImages[f]=!0}removeImage(f){const m=this.images[f];delete this.images[f],delete this.patterns[f],m.userImage&&m.userImage.onRemove&&m.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(f,m){let b=!0;if(!this.isLoaded())for(const x of f)this.images[x]||(b=!1);this.isLoaded()||b?this._notify(f,m):this.requestors.push({ids:f,callback:m})}_notify(f,m){const b={};for(const x of f){this.images[x]||this.fire(new a.Event("styleimagemissing",{id:x}));const E=this.images[x];E?b[x]={data:E.data.clone(),pixelRatio:E.pixelRatio,sdf:E.sdf,version:E.version,stretchX:E.stretchX,stretchY:E.stretchY,content:E.content,hasRenderCallback:!!(E.userImage&&E.userImage.render)}:a.warnOnce(`Image "${x}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}m(null,b)}getPixelSize(){const{width:f,height:m}=this.atlasImage;return{width:f,height:m}}getPattern(f){const m=this.patterns[f],b=this.getImage(f);if(!b)return null;if(m&&m.position.version===b.version)return m.position;if(m)m.position.version=b.version;else{const x={w:b.data.width+2,h:b.data.height+2,x:0,y:0},E=new a.ImagePosition(x,b);this.patterns[f]={bin:x,position:E}}return this._updatePatternAtlas(),this.patterns[f].position}bind(f){const m=f.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new a.Texture(f,this.atlasImage,m.RGBA),this.atlasTexture&&this.atlasTexture.bind(m.LINEAR,m.CLAMP_TO_EDGE)}_updatePatternAtlas(){const f=[];for(const E in this.patterns)f.push(this.patterns[E].bin);const{w:m,h:b}=a.potpack(f),x=this.atlasImage;x.resize({width:m||1,height:b||1});for(const E in this.patterns){const{bin:P}=this.patterns[E],I=P.x+1,L=P.y+1,H=this.images[E].data,F=H.width,X=H.height;a.RGBAImage.copy(H,x,{x:0,y:0},{x:I,y:L},{width:F,height:X}),a.RGBAImage.copy(H,x,{x:0,y:X-1},{x:I,y:L-1},{width:F,height:1}),a.RGBAImage.copy(H,x,{x:0,y:0},{x:I,y:L+X},{width:F,height:1}),a.RGBAImage.copy(H,x,{x:F-1,y:0},{x:I-1,y:L},{width:1,height:X}),a.RGBAImage.copy(H,x,{x:0,y:0},{x:I+F,y:L},{width:1,height:X})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(f){for(const m of f){if(this.callbackDispatchedThisFrame[m])continue;this.callbackDispatchedThisFrame[m]=!0;const b=this.images[m];We(b)&&this.updateImage(m,b)}}}const Lt=new a.Properties({anchor:new a.DataConstantProperty(a.spec.light.anchor),position:new class{constructor(){this.specification=a.spec.light.position}possiblyEvaluate(v,f){return function([m,b,x]){const E=a.degToRad(b+90),P=a.degToRad(x);return{x:m*Math.cos(E)*Math.sin(P),y:m*Math.sin(E)*Math.sin(P),z:m*Math.cos(P),azimuthal:b,polar:x}}(v.expression.evaluate(f))}interpolate(v,f,m){return{x:a.number(v.x,f.x,m),y:a.number(v.y,f.y,m),z:a.number(v.z,f.z,m),azimuthal:a.number(v.azimuthal,f.azimuthal,m),polar:a.number(v.polar,f.polar,m)}}},color:new a.DataConstantProperty(a.spec.light.color),intensity:new a.DataConstantProperty(a.spec.light.intensity)}),_t="-transition";class $e extends a.Evented{constructor(f){super(),this._transitionable=new a.Transitionable(Lt),this.setLight(f),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(f,m={}){if(!this._validate(a.validateLight,f,m))for(const b in f){const x=f[b];a.endsWith(b,_t)?this._transitionable.setTransition(b.slice(0,-_t.length),x):this._transitionable.setValue(b,x)}}updateTransitions(f){this._transitioning=this._transitionable.transitioned(f,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(f){this.properties=this._transitioning.possiblyEvaluate(f)}_validate(f,m,b){return(!b||b.validate!==!1)&&a.emitValidationErrors(this,f.call(a.validateStyle,a.extend({value:m,style:{glyphs:!0,sprite:!0},styleSpec:a.spec})))}}const Fe=new a.Properties({source:new a.DataConstantProperty(a.spec.terrain.source),exaggeration:new a.DataConstantProperty(a.spec.terrain.exaggeration)}),At="-transition";class Gt extends a.Evented{constructor(f,m){super(),this._transitionable=new a.Transitionable(Fe),this.set(f),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=m}get(){return this._transitionable.serialize()}set(f){for(const m in f){const b=f[m];a.endsWith(m,At)?this._transitionable.setTransition(m.slice(0,-At.length),b):this._transitionable.setValue(m,b)}}updateTransitions(f){this._transitioning=this._transitionable.transitioned(f,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(f){this.properties=this._transitioning.possiblyEvaluate(f)}}function ae(v,f,m,b){const x=a.smoothstep(45,65,m),[E,P]=D(v,b),I=a.length(f);let L=1-Math.min(1,Math.exp((I-E)/(P-E)*-6));return L*=L*L,L=Math.min(1,1.00747*L),L*x*v.alpha}function D(v,f){const m=.5/Math.tan(.5*f);return[v.range[0]+m,v.range[1]+m]}const U=new a.Properties({range:new a.DataConstantProperty(a.spec.fog.range),color:new a.DataConstantProperty(a.spec.fog.color),"high-color":new a.DataConstantProperty(a.spec.fog["high-color"]),"space-color":new a.DataConstantProperty(a.spec.fog["space-color"]),"horizon-blend":new a.DataConstantProperty(a.spec.fog["horizon-blend"]),"star-intensity":new a.DataConstantProperty(a.spec.fog["star-intensity"])}),q="-transition";class ne extends a.Evented{constructor(f,m){super(),this._transitionable=new a.Transitionable(U),this.set(f),this._transitioning=this._transitionable.untransitioned(),this._transform=m}get state(){const f=this._transform,m=f.projection.name==="globe",b=a.globeToMercatorTransition(f.zoom),x=this.properties.get("range"),E=[.5,3];return{range:m?[a.number(E[0],x[0],b),a.number(E[1],x[1],b)]:x,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(f,m={}){if(!this._validate(a.validateFog,f,m)){for(const b of Object.keys(a.spec.fog))f&&f[b]===void 0&&(f[b]=a.spec.fog[b].default);for(const b in f){const x=f[b];a.endsWith(b,q)?this._transitionable.setTransition(b.slice(0,-q.length),x):this._transitionable.setValue(b,x)}}}getOpacity(f){if(!this._transform.projection.supportsFog)return 0;const m=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:a.smoothstep(45,65,f))*m.a}getOpacityAtLatLng(f,m){return this._transform.projection.supportsFog?function(b,x,E){const P=a.MercatorCoordinate.fromLngLat(x),I=E.elevation?E.elevation.getAtPointOrZero(P):0,L=[P.x,P.y,I];return a.transformMat4(L,L,E.mercatorFogMatrix),ae(b,L,E.pitch,E._fov)}(this.state,f,m):0}getFovAdjustedRange(f){return this._transform.projection.supportsFog?D(this.state,f):[0,1]}updateTransitions(f){this._transitioning=this._transitionable.transitioned(f,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(f){this.properties=this._transitioning.possiblyEvaluate(f)}_validate(f,m,b){return(!b||b.validate!==!1)&&a.emitValidationErrors(this,f.call(a.validateStyle,a.extend({value:m,style:{glyphs:!0,sprite:!0},styleSpec:a.spec})))}}class ye{constructor(f,m){this.workerPool=f,this.actors=[],this.currentActor=0,this.id=a.uniqueId();const b=this.workerPool.acquire(this.id);for(let x=0;x<b.length;x++){const E=new ye.Actor(b[x],m,this.id);E.name=`Worker ${x}`,this.actors.push(E)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(f,m,b){a.asyncAll(this.actors,(x,E)=>{x.send(f,m,E)},b=b||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(f=>{f.remove()}),this.actors=[],this.workerPool.release(this.id)}}function ve(v,f,m){return f*(a.EXTENT/(v.tileSize*Math.pow(2,m-v.tileID.overscaledZ)))}ye.Actor=a.Actor;class ze{constructor(f,m,b,x){this.screenBounds=f,this.cameraPoint=m,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=b,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,x)}static createFromScreenPoints(f,m){let b,x;if(f instanceof a.pointGeometry||typeof f[0]=="number"){const E=a.pointGeometry.convert(f);b=[E],x=m.isPointAboveHorizon(E)}else{const E=a.pointGeometry.convert(f[0]),P=a.pointGeometry.convert(f[1]);b=[E,P],x=a.polygonizeBounds(E,P).every(I=>m.isPointAboveHorizon(I))}return new ze(b,m.getCameraPoint(),x,m)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(f){return a.polygonizeBounds(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],f)}bufferedCameraGeometry(f){const m=this.screenBounds[0],b=this.screenBounds.length===1?this.screenBounds[0].add(new a.pointGeometry(1,1)):this.screenBounds[1],x=a.polygonizeBounds(m,b,0,!1);return this.cameraPoint.y>b.y&&(this.cameraPoint.x>m.x&&this.cameraPoint.x<b.x?x.splice(3,0,this.cameraPoint):this.cameraPoint.x>=b.x?x[2]=this.cameraPoint:this.cameraPoint.x<=m.x&&(x[3]=this.cameraPoint)),a.bufferConvexPolygon(x,f)}bufferedCameraGeometryGlobe(f){const m=this.screenBounds[0],b=this.screenBounds.length===1?this.screenBounds[0].add(new a.pointGeometry(1,1)):this.screenBounds[1],x=a.polygonizeBounds(m,b,f),E=this.cameraPoint.clone();switch(3*((E.y>m.y)+(E.y>b.y))+((E.x>m.x)+(E.x>b.x))){case 0:x[0]=E,x[4]=E.clone();break;case 1:x.splice(1,0,E);break;case 2:x[1]=E;break;case 3:x.splice(4,0,E);break;case 5:x.splice(2,0,E);break;case 6:x[3]=E;break;case 7:x.splice(3,0,E);break;case 8:x[2]=E}return x}containsTile(f,m,b,x=0){const E=f.queryPadding/m._pixelsPerMercatorPixel+1,P=b?this._bufferedCameraMercator(E,m):this._bufferedScreenMercator(E,m);let I=f.tileID.wrap+(P.unwrapped?x:0);const L=P.polygon.map(ce=>a.getTilePoint(f.tileTransform,ce,I));if(!a.polygonIntersectsBox(L,0,0,a.EXTENT,a.EXTENT))return;I=f.tileID.wrap+(this.screenGeometryMercator.unwrapped?x:0);const H=this.screenGeometryMercator.polygon.map(ce=>a.getTileVec3(f.tileTransform,ce,I)),F=H.map(ce=>new a.pointGeometry(ce[0],ce[1])),X=m.getFreeCameraOptions().position||new a.MercatorCoordinate(0,0,0),re=a.getTileVec3(f.tileTransform,X,I),oe=H.map(ce=>{const te=a.sub(ce,ce,re);return a.normalize(te,te),new a.Ray(re,te)}),le=ve(f,1,m.zoom)*m._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:F,tilespaceRays:oe,bufferedTilespaceGeometry:L,bufferedTilespaceBounds:(ue=a.getBounds(L),ue.min.x=a.clamp(ue.min.x,0,a.EXTENT),ue.min.y=a.clamp(ue.min.y,0,a.EXTENT),ue.max.x=a.clamp(ue.max.x,0,a.EXTENT),ue.max.y=a.clamp(ue.max.y,0,a.EXTENT),ue),tile:f,tileID:f.tileID,pixelToTileUnitsFactor:le};var ue}_bufferedScreenMercator(f,m){const b=xt(f);if(this._screenRaycastCache[b])return this._screenRaycastCache[b];{let x;return x=m.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(f),m):{polygon:this.bufferedScreenGeometry(f).map(E=>m.pointCoordinate3D(E)),unwrapped:!0},this._screenRaycastCache[b]=x,x}}_bufferedCameraMercator(f,m){const b=xt(f);if(this._cameraRaycastCache[b])return this._cameraRaycastCache[b];{let x;return x=m.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(f),m):{polygon:this.bufferedCameraGeometry(f).map(E=>m.pointCoordinate3D(E)),unwrapped:!0},this._cameraRaycastCache[b]=x,x}}_projectAndResample(f,m){const b=function(E,P){const I=a.multiply([],P.pixelMatrix,P.globeMatrix),L=[0,-a.GLOBE_RADIUS,0,1],H=[0,a.GLOBE_RADIUS,0,1],F=[0,0,0,1];a.transformMat4$1(L,L,I),a.transformMat4$1(H,H,I),a.transformMat4$1(F,F,I);const X=new a.pointGeometry(L[0]/L[3],L[1]/L[3]),re=new a.pointGeometry(H[0]/H[3],H[1]/H[3]),oe=a.polygonContainsPoint(E,X)&&L[3]<F[3],le=a.polygonContainsPoint(E,re)&&H[3]<F[3];if(!oe&&!le)return null;const ue=function(De,Xe,ot){for(let ut=1;ut<De.length;ut++){const Bt=Je(Xe.pointCoordinate3D(De[ut-1]).x),tt=Je(Xe.pointCoordinate3D(De[ut]).x);if(ot<0){if(Bt<tt)return{idx:ut,t:-Bt/(tt-1-Bt)}}else if(tt<Bt)return{idx:ut,t:(1-Bt)/(tt+1-Bt)}}return null}(E,P,oe?-1:1);if(!ue)return null;const{idx:ce,t:te}=ue;let ge=ce>1?je(E.slice(0,ce),P):[],me=ce<E.length?je(E.slice(ce),P):[];ge=ge.map(De=>new a.pointGeometry(Je(De.x),De.y)),me=me.map(De=>new a.pointGeometry(Je(De.x),De.y));const be=[...ge];be.length===0&&be.push(me[me.length-1]);const Pe=a.number(be[be.length-1].y,(me.length===0?ge[0]:me[0]).y,te);let Oe;return Oe=oe?[new a.pointGeometry(0,Pe),new a.pointGeometry(0,0),new a.pointGeometry(1,0),new a.pointGeometry(1,Pe)]:[new a.pointGeometry(1,Pe),new a.pointGeometry(1,1),new a.pointGeometry(0,1),new a.pointGeometry(0,Pe)],be.push(...Oe),me.length===0?be.push(ge[0]):be.push(...me),{polygon:be.map(De=>new a.MercatorCoordinate(De.x,De.y)),unwrapped:!1}}(f,m);if(b)return b;const x=function(E,P){let I=!1,L=-1/0,H=0;for(let X=0;X<E.length-1;X++)E[X].x>L&&(L=E[X].x,H=X);for(let X=0;X<E.length-1;X++){const re=(H+X)%(E.length-1),oe=E[re],le=E[re+1];Math.abs(oe.x-le.x)>.5&&(oe.x<le.x?(oe.x+=1,re===0&&(E[E.length-1].x+=1)):(le.x+=1,re+1===E.length-1&&(E[0].x+=1)),I=!0)}const F=a.mercatorXfromLng(P.center.lng);return I&&F<Math.abs(F-1)&&E.forEach(X=>{X.x-=1}),{polygon:E,unwrapped:I}}(je(f,m).map(E=>new a.pointGeometry(Je(E.x),E.y)),m);return{polygon:x.polygon.map(E=>new a.MercatorCoordinate(E.x,E.y)),unwrapped:x.unwrapped}}}function je(v,f){return a.resample(v,m=>{const b=f.pointCoordinate3D(m);m.x=b.x,m.y=b.y},1/256)}function Je(v){return v<0?1+v%1:v%1}function xt(v){return 100*v|0}function kt(v,f,m,b,x){const E=function(P,I){if(P)return x(P);if(I){v.url&&I.tiles&&v.tiles&&delete v.tiles;const L=a.pick(a.extend(I,v),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);I.vector_layers&&(L.vectorLayers=I.vector_layers,L.vectorLayerIds=L.vectorLayers.map(H=>H.id)),L.tiles=f.canonicalizeTileset(L,v.url),x(null,L)}};return v.url?a.getJSON(f.transformRequest(f.normalizeSourceURL(v.url,null,m,b),a.ResourceType.Source),E):a.exported.frame(()=>E(null,v))}class jt{constructor(f,m,b){this.bounds=a.LngLatBounds.convert(this.validateBounds(f)),this.minzoom=m||0,this.maxzoom=b||24}validateBounds(f){return Array.isArray(f)&&f.length===4?[Math.max(-180,f[0]),Math.max(-90,f[1]),Math.min(180,f[2]),Math.min(90,f[3])]:[-180,-90,180,90]}contains(f){const m=Math.pow(2,f.z),b=Math.floor(a.mercatorXfromLng(this.bounds.getWest())*m),x=Math.floor(a.mercatorYfromLat(this.bounds.getNorth())*m),E=Math.ceil(a.mercatorXfromLng(this.bounds.getEast())*m),P=Math.ceil(a.mercatorYfromLat(this.bounds.getSouth())*m);return f.x>=b&&f.x<E&&f.y>=x&&f.y<P}}class yr{constructor(f,m,b){this.context=f;const x=f.gl;this.buffer=x.createBuffer(),this.dynamicDraw=!!b,this.context.unbindVAO(),f.bindElementBuffer.set(this.buffer),x.bufferData(x.ELEMENT_ARRAY_BUFFER,m.arrayBuffer,this.dynamicDraw?x.DYNAMIC_DRAW:x.STATIC_DRAW),this.dynamicDraw||m.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(f){const m=this.context.gl;this.context.unbindVAO(),this.bind(),m.bufferSubData(m.ELEMENT_ARRAY_BUFFER,0,f.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Ft={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Jt{constructor(f,m,b,x){this.length=m.length,this.attributes=b,this.itemSize=m.bytesPerElement,this.dynamicDraw=x,this.context=f;const E=f.gl;this.buffer=E.createBuffer(),f.bindVertexBuffer.set(this.buffer),E.bufferData(E.ARRAY_BUFFER,m.arrayBuffer,this.dynamicDraw?E.DYNAMIC_DRAW:E.STATIC_DRAW),this.dynamicDraw||m.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(f){const m=this.context.gl;this.bind(),m.bufferSubData(m.ARRAY_BUFFER,0,f.arrayBuffer)}enableAttributes(f,m){for(let b=0;b<this.attributes.length;b++){const x=m.attributes[this.attributes[b].name];x!==void 0&&f.enableVertexAttribArray(x)}}setVertexAttribPointers(f,m,b){for(let x=0;x<this.attributes.length;x++){const E=this.attributes[x],P=m.attributes[E.name];P!==void 0&&f.vertexAttribPointer(P,E.components,f[Ft[E.type]],!1,this.itemSize,E.offset+this.itemSize*(b||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class et{constructor(f){this.gl=f.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(f){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class wr extends et{getDefault(){return a.Color.transparent}set(f){const m=this.current;(f.r!==m.r||f.g!==m.g||f.b!==m.b||f.a!==m.a||this.dirty)&&(this.gl.clearColor(f.r,f.g,f.b,f.a),this.current=f,this.dirty=!1)}}class $r extends et{getDefault(){return 1}set(f){(f!==this.current||this.dirty)&&(this.gl.clearDepth(f),this.current=f,this.dirty=!1)}}class lr extends et{getDefault(){return 0}set(f){(f!==this.current||this.dirty)&&(this.gl.clearStencil(f),this.current=f,this.dirty=!1)}}class Sr extends et{getDefault(){return[!0,!0,!0,!0]}set(f){const m=this.current;(f[0]!==m[0]||f[1]!==m[1]||f[2]!==m[2]||f[3]!==m[3]||this.dirty)&&(this.gl.colorMask(f[0],f[1],f[2],f[3]),this.current=f,this.dirty=!1)}}class Or extends et{getDefault(){return!0}set(f){(f!==this.current||this.dirty)&&(this.gl.depthMask(f),this.current=f,this.dirty=!1)}}class se extends et{getDefault(){return 255}set(f){(f!==this.current||this.dirty)&&(this.gl.stencilMask(f),this.current=f,this.dirty=!1)}}class _e extends et{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(f){const m=this.current;(f.func!==m.func||f.ref!==m.ref||f.mask!==m.mask||this.dirty)&&(this.gl.stencilFunc(f.func,f.ref,f.mask),this.current=f,this.dirty=!1)}}class Re extends et{getDefault(){const f=this.gl;return[f.KEEP,f.KEEP,f.KEEP]}set(f){const m=this.current;(f[0]!==m[0]||f[1]!==m[1]||f[2]!==m[2]||this.dirty)&&(this.gl.stencilOp(f[0],f[1],f[2]),this.current=f,this.dirty=!1)}}class Ke extends et{getDefault(){return!1}set(f){if(f===this.current&&!this.dirty)return;const m=this.gl;f?m.enable(m.STENCIL_TEST):m.disable(m.STENCIL_TEST),this.current=f,this.dirty=!1}}class Be extends et{getDefault(){return[0,1]}set(f){const m=this.current;(f[0]!==m[0]||f[1]!==m[1]||this.dirty)&&(this.gl.depthRange(f[0],f[1]),this.current=f,this.dirty=!1)}}class rt extends et{getDefault(){return!1}set(f){if(f===this.current&&!this.dirty)return;const m=this.gl;f?m.enable(m.DEPTH_TEST):m.disable(m.DEPTH_TEST),this.current=f,this.dirty=!1}}class Ue extends et{getDefault(){return this.gl.LESS}set(f){(f!==this.current||this.dirty)&&(this.gl.depthFunc(f),this.current=f,this.dirty=!1)}}class Ve extends et{getDefault(){return!1}set(f){if(f===this.current&&!this.dirty)return;const m=this.gl;f?m.enable(m.BLEND):m.disable(m.BLEND),this.current=f,this.dirty=!1}}class st extends et{getDefault(){const f=this.gl;return[f.ONE,f.ZERO]}set(f){const m=this.current;(f[0]!==m[0]||f[1]!==m[1]||this.dirty)&&(this.gl.blendFunc(f[0],f[1]),this.current=f,this.dirty=!1)}}class Ze extends et{getDefault(){return a.Color.transparent}set(f){const m=this.current;(f.r!==m.r||f.g!==m.g||f.b!==m.b||f.a!==m.a||this.dirty)&&(this.gl.blendColor(f.r,f.g,f.b,f.a),this.current=f,this.dirty=!1)}}class ft extends et{getDefault(){return this.gl.FUNC_ADD}set(f){(f!==this.current||this.dirty)&&(this.gl.blendEquation(f),this.current=f,this.dirty=!1)}}class zt extends et{getDefault(){return!1}set(f){if(f===this.current&&!this.dirty)return;const m=this.gl;f?m.enable(m.CULL_FACE):m.disable(m.CULL_FACE),this.current=f,this.dirty=!1}}class nr extends et{getDefault(){return this.gl.BACK}set(f){(f!==this.current||this.dirty)&&(this.gl.cullFace(f),this.current=f,this.dirty=!1)}}class cr extends et{getDefault(){return this.gl.CCW}set(f){(f!==this.current||this.dirty)&&(this.gl.frontFace(f),this.current=f,this.dirty=!1)}}class Pr extends et{getDefault(){return null}set(f){(f!==this.current||this.dirty)&&(this.gl.useProgram(f),this.current=f,this.dirty=!1)}}class Vr extends et{getDefault(){return this.gl.TEXTURE0}set(f){(f!==this.current||this.dirty)&&(this.gl.activeTexture(f),this.current=f,this.dirty=!1)}}class gn extends et{getDefault(){const f=this.gl;return[0,0,f.drawingBufferWidth,f.drawingBufferHeight]}set(f){const m=this.current;(f[0]!==m[0]||f[1]!==m[1]||f[2]!==m[2]||f[3]!==m[3]||this.dirty)&&(this.gl.viewport(f[0],f[1],f[2],f[3]),this.current=f,this.dirty=!1)}}class Ir extends et{getDefault(){return null}set(f){if(f===this.current&&!this.dirty)return;const m=this.gl;m.bindFramebuffer(m.FRAMEBUFFER,f),this.current=f,this.dirty=!1}}class Ar extends et{getDefault(){return null}set(f){if(f===this.current&&!this.dirty)return;const m=this.gl;m.bindRenderbuffer(m.RENDERBUFFER,f),this.current=f,this.dirty=!1}}class sn extends et{getDefault(){return null}set(f){if(f===this.current&&!this.dirty)return;const m=this.gl;m.bindTexture(m.TEXTURE_2D,f),this.current=f,this.dirty=!1}}class on extends et{getDefault(){return null}set(f){if(f===this.current&&!this.dirty)return;const m=this.gl;m.bindBuffer(m.ARRAY_BUFFER,f),this.current=f,this.dirty=!1}}class Fr extends et{getDefault(){return null}set(f){const m=this.gl;m.bindBuffer(m.ELEMENT_ARRAY_BUFFER,f),this.current=f,this.dirty=!1}}class jr extends et{constructor(f){super(f),this.vao=f.extVertexArrayObject}getDefault(){return null}set(f){this.vao&&(f!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(f),this.current=f,this.dirty=!1)}}class tn extends et{getDefault(){return 4}set(f){if(f===this.current&&!this.dirty)return;const m=this.gl;m.pixelStorei(m.UNPACK_ALIGNMENT,f),this.current=f,this.dirty=!1}}class ei extends et{getDefault(){return!1}set(f){if(f===this.current&&!this.dirty)return;const m=this.gl;m.pixelStorei(m.UNPACK_PREMULTIPLY_ALPHA_WEBGL,f),this.current=f,this.dirty=!1}}class xn extends et{getDefault(){return!1}set(f){if(f===this.current&&!this.dirty)return;const m=this.gl;m.pixelStorei(m.UNPACK_FLIP_Y_WEBGL,f),this.current=f,this.dirty=!1}}class ln extends et{constructor(f,m){super(f),this.context=f,this.parent=m}getDefault(){return null}}class zr extends ln{setDirty(){this.dirty=!0}set(f){if(f===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const m=this.gl;m.framebufferTexture2D(m.FRAMEBUFFER,m.COLOR_ATTACHMENT0,m.TEXTURE_2D,f,0),this.current=f,this.dirty=!1}}class vo extends ln{attachment(){return this.gl.DEPTH_ATTACHMENT}set(f){if(f===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const m=this.gl;m.framebufferRenderbuffer(m.FRAMEBUFFER,this.attachment(),m.RENDERBUFFER,f),this.current=f,this.dirty=!1}}class ia extends vo{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class jo{constructor(f,m,b,x){this.context=f,this.width=m,this.height=b;const E=this.framebuffer=f.gl.createFramebuffer();this.colorAttachment=new zr(f,E),x&&(this.depthAttachment=new vo(f,E))}destroy(){const f=this.context.gl,m=this.colorAttachment.get();if(m&&f.deleteTexture(m),this.depthAttachment){const b=this.depthAttachment.get();b&&f.deleteRenderbuffer(b)}f.deleteFramebuffer(this.framebuffer)}}class de{constructor(f,m=!1){if(this.gl=f,this.isWebGL2=m,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),m){const b=f;this.extVertexArrayObject={createVertexArrayOES:b.createVertexArray.bind(f),deleteVertexArrayOES:b.deleteVertexArray.bind(f),bindVertexArrayOES:b.bindVertexArray.bind(f)}}this.clearColor=new wr(this),this.clearDepth=new $r(this),this.clearStencil=new lr(this),this.colorMask=new Sr(this),this.depthMask=new Or(this),this.stencilMask=new se(this),this.stencilFunc=new _e(this),this.stencilOp=new Re(this),this.stencilTest=new Ke(this),this.depthRange=new Be(this),this.depthTest=new rt(this),this.depthFunc=new Ue(this),this.blend=new Ve(this),this.blendFunc=new st(this),this.blendColor=new Ze(this),this.blendEquation=new ft(this),this.cullFace=new zt(this),this.cullFaceSide=new nr(this),this.frontFace=new cr(this),this.program=new Pr(this),this.activeTexture=new Vr(this),this.viewport=new gn(this),this.bindFramebuffer=new Ir(this),this.bindRenderbuffer=new Ar(this),this.bindTexture=new sn(this),this.bindVertexBuffer=new on(this),this.bindElementBuffer=new Fr(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new jr(this),this.pixelStoreUnpack=new tn(this),this.pixelStoreUnpackPremultiplyAlpha=new ei(this),this.pixelStoreUnpackFlipY=new xn(this),this.extTextureFilterAnisotropic=f.getExtension("EXT_texture_filter_anisotropic")||f.getExtension("MOZ_EXT_texture_filter_anisotropic")||f.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=f.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extStandardDerivativesForceOff=!1,this.extDebugRendererInfo=f.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=f.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=f.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),m||(this.extTextureHalfFloat=f.getExtension("OES_texture_half_float")),(m||this.extTextureHalfFloat&&f.getExtension("OES_texture_half_float_linear"))&&(this.extRenderToTextureHalfFloat=f.getExtension("EXT_color_buffer_half_float")),this.extStandardDerivatives=m||f.getExtension("OES_standard_derivatives"),this.extTimerQuery=f.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=f.getParameter(f.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(f,m){return new yr(this,f,m)}createVertexBuffer(f,m,b){return new Jt(this,f,m,b)}createRenderbuffer(f,m,b){const x=this.gl,E=x.createRenderbuffer();return this.bindRenderbuffer.set(E),x.renderbufferStorage(x.RENDERBUFFER,f,m,b),this.bindRenderbuffer.set(null),E}createFramebuffer(f,m,b){return new jo(this,f,m,b)}clear({color:f,depth:m,stencil:b}){const x=this.gl;let E=0;f&&(E|=x.COLOR_BUFFER_BIT,this.clearColor.set(f),this.colorMask.set([!0,!0,!0,!0])),m!==void 0&&(E|=x.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(m),this.depthMask.set(!0)),b!==void 0&&(E|=x.STENCIL_BUFFER_BIT,this.clearStencil.set(b),this.stencilMask.set(255)),x.clear(E)}setCullFace(f){f.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(f.mode),this.frontFace.set(f.frontFace))}setDepthMode(f){f.func!==this.gl.ALWAYS||f.mask?(this.depthTest.set(!0),this.depthFunc.set(f.func),this.depthMask.set(f.mask),this.depthRange.set(f.range)):this.depthTest.set(!1)}setStencilMode(f){f.test.func!==this.gl.ALWAYS||f.mask?(this.stencilTest.set(!0),this.stencilMask.set(f.mask),this.stencilOp.set([f.fail,f.depthFail,f.pass]),this.stencilFunc.set({func:f.test.func,ref:f.ref,mask:f.test.mask})):this.stencilTest.set(!1)}setColorMode(f){h(f.blendFunction,a.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(f.blendFunction),this.blendColor.set(f.blendColor)),this.colorMask.set(f.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class Z extends a.Evented{constructor(f,m,b,x){if(super(),this.id=f,this.dispatcher=b,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,a.extend(this,a.pick(m,["url","scheme","tileSize","promoteId"])),this._options=a.extend({type:"vector"},m),this._collectResourceTiming=m.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(x),this._tileWorkers={},this._deduped=new a.DedupedRequest}load(f){this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"}));const m=Array.isArray(this.map._language)?this.map._language.join():this.map._language,b=this.map._worldview;this._tileJSONRequest=kt(this._options,this.map._requestManager,m,b,(x,E)=>{this._tileJSONRequest=null,this._loaded=!0,x?(m&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${m}`),b&&b.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${b}`),this.fire(new a.ErrorEvent(x))):E&&(a.extend(this,E),E.bounds&&(this.tileBounds=new jt(E.bounds,this.minzoom,this.maxzoom)),a.postTurnstileEvent(E.tiles,this.map._requestManager._customAccessToken),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"}))),f&&f(x)})}loaded(){return this._loaded}hasTile(f){return!this.tileBounds||this.tileBounds.contains(f.canonical)}onAdd(f){this.map=f,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(f){return this._options.tiles=f,this.reload(),this}setUrl(f){return this.url=f,this._options.url=f,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return a.extend({},this._options)}loadTile(f,m){const b=this.map._requestManager.normalizeTileURL(f.tileID.canonical.url(this.tiles,this.scheme)),x={request:this.map._requestManager.transformRequest(b,a.ResourceType.Tile),data:void 0,uid:f.uid,tileID:f.tileID,tileZoom:f.tileZoom,zoom:f.tileID.overscaledZ,tileSize:this.tileSize*f.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:a.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:f.isSymbolTile};if(x.request.collectResourceTiming=this._collectResourceTiming,f.actor&&f.state!=="expired")f.state==="loading"?f.reloadCallback=m:f.request=f.actor.send("reloadTile",x,E.bind(this));else if(f.actor=this._tileWorkers[b]=this._tileWorkers[b]||this.dispatcher.getActor(),this.dispatcher.ready)f.request=f.actor.send("loadTile",x,E.bind(this),void 0,!0);else{const P=a.loadVectorTile.call({deduped:this._deduped},x,(I,L)=>{I||!L?E.call(this,I):(x.data={cacheControl:L.cacheControl,expires:L.expires,rawData:L.rawData.slice(0)},f.actor&&f.actor.send("loadTile",x,E.bind(this),void 0,!0))},!0);f.request={cancel:P}}function E(P,I){return delete f.request,f.aborted?m(null):P&&P.status!==404?m(P):(I&&I.resourceTiming&&(f.resourceTiming=I.resourceTiming),this.map._refreshExpiredTiles&&I&&f.setExpiryData(I),f.loadVectorData(I,this.map.painter),a.cacheEntryPossiblyAdded(this.dispatcher),m(null),void(f.reloadCallback&&(this.loadTile(f,f.reloadCallback),f.reloadCallback=null)))}}abortTile(f){f.request&&(f.request.cancel(),delete f.request),f.actor&&f.actor.send("abortTile",{uid:f.uid,type:this.type,source:this.id})}unloadTile(f){f.unloadVectorData(),f.actor&&f.actor.send("removeTile",{uid:f.uid,type:this.type,source:this.id})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class Q extends a.Evented{constructor(f,m,b,x){super(),this.id=f,this.dispatcher=b,this.setEventedParent(x),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=a.extend({type:"raster"},m),a.extend(this,a.pick(m,["url","scheme","tileSize"]))}load(f){this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=kt(this._options,this.map._requestManager,null,null,(m,b)=>{this._tileJSONRequest=null,this._loaded=!0,m?this.fire(new a.ErrorEvent(m)):b&&(a.extend(this,b),b.bounds&&(this.tileBounds=new jt(b.bounds,this.minzoom,this.maxzoom)),a.postTurnstileEvent(b.tiles),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"}))),f&&f(m)})}loaded(){return this._loaded}onAdd(f){this.map=f,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(f){return this._options.tiles=f,this.reload(),this}setUrl(f){return this.url=f,this._options.url=f,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return a.extend({},this._options)}hasTile(f){return!this.tileBounds||this.tileBounds.contains(f.canonical)}loadTile(f,m){const b=a.exported.devicePixelRatio>=2,x=this.map._requestManager.normalizeTileURL(f.tileID.canonical.url(this.tiles,this.scheme),b,this.tileSize);f.request=a.getImage(this.map._requestManager.transformRequest(x,a.ResourceType.Tile),(E,P,I,L)=>(delete f.request,f.aborted?(f.state="unloaded",m(null)):E?(f.state="errored",m(E)):P?(this.map._refreshExpiredTiles&&f.setExpiryData({cacheControl:I,expires:L}),f.setTexture(P,this.map.painter),f.state="loaded",a.cacheEntryPossiblyAdded(this.dispatcher),void m(null)):m(null)))}static loadTileData(f,m,b){f.setTexture(m,b)}static unloadTileData(f,m){f.texture&&m.saveTileTexture(f.texture)}abortTile(f,m){f.request&&(f.request.cancel(),delete f.request),m()}unloadTile(f,m){f.texture&&this.map.painter.saveTileTexture(f.texture),m()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}let fe;function we(v,f,m,b,x,E,P,I){const L=[v,m,x,f,b,E,1,1,1],H=[P,I,1],F=a.adjoint([],L),[X,re,oe]=a.transformMat3(H,H,a.transpose(F,F));return a.multiply$1(L,[X,0,0,0,re,0,0,0,oe],L)}class Ae extends a.Evented{constructor(f,m,b,x){super(),this.id=f,this.dispatcher=b,this.coordinates=m.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(x),this.options=m,this._dirty=!1}load(f,m){this._loaded=m||!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this.url=this.options.url,this._imageRequest=a.getImage(this.map._requestManager.transformRequest(this.url,a.ResourceType.Image),(b,x)=>{if(this._imageRequest=null,this._loaded=!0,b)this.fire(new a.ErrorEvent(b));else if(x){const{HTMLImageElement:E}=a.window;this.image=x instanceof E?a.exported.getImageData(x):x,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,f&&(this.coordinates=f),this._finishLoading()}})}loaded(){return this._loaded}updateImage(f){return this.image&&f.url?(this._imageRequest&&f.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=f.url,this.load(f.coordinates,this._loaded),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(f){this.map=f,this.load()}onRemove(){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),this.texture&&this.texture.destroy()}setCoordinates(f){this.coordinates=f,this._boundsArray=void 0;const m=f.map(a.MercatorCoordinate.fromLngLat);return this.tileID=function(b){let x=1/0,E=1/0,P=-1/0,I=-1/0;for(const X of b)x=Math.min(x,X.x),E=Math.min(E,X.y),P=Math.max(P,X.x),I=Math.max(I,X.y);const L=Math.max(P-x,I-E),H=Math.max(0,Math.floor(-Math.log(L)/Math.LN2)),F=Math.pow(2,H);return new a.CanonicalTileID(H,Math.floor((x+P)/2*F),Math.floor((E+I)/2*F))}(m),this.minzoom=this.maxzoom=this.tileID.z,this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0}_prepareData(f){for(const L in this.tiles){const H=this.tiles[L];H.state!=="loaded"&&(H.state="loaded",H.texture=this.texture)}if(this._boundsArray)return;const m=a.tileTransform(this.tileID,this.map.transform.projection),[b,x,E,P]=this.coordinates.map(L=>{const H=m.projection.project(L[0],L[1]);return a.getTilePoint(m,H)._round()});this.perspectiveTransform=function(L,H,F,X,re,oe,le,ue,ce,te){const ge=we(0,0,L,0,0,H,L,H),me=we(F,X,re,oe,le,ue,ce,te);return a.multiply$1(me,a.adjoint(ge,ge),me),[me[6]/me[8]*L/a.EXTENT,me[7]/me[8]*H/a.EXTENT]}(this.width,this.height,b.x,b.y,x.x,x.y,P.x,P.y,E.x,E.y);const I=this._boundsArray=new a.StructArrayLayout4i8;I.emplaceBack(b.x,b.y,0,0),I.emplaceBack(x.x,x.y,a.EXTENT,0),I.emplaceBack(P.x,P.y,0,a.EXTENT),I.emplaceBack(E.x,E.y,a.EXTENT,a.EXTENT),this.boundsBuffer&&this.boundsBuffer.destroy(),this.boundsBuffer=f.createVertexBuffer(I,a.boundsAttributes.members),this.boundsSegments=a.SegmentVector.simpleSegment(0,0,4,2)}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const f=this.map.painter.context,m=f.gl;this._dirty&&(this.texture?this.texture.update(this.image):(this.texture=new a.Texture(f,this.image,m.RGBA),this.texture.bind(m.LINEAR,m.CLAMP_TO_EDGE)),this._dirty=!1),this._prepareData(f)}loadTile(f,m){this.tileID&&this.tileID.equals(f.tileID.canonical)?(this.tiles[String(f.tileID.wrap)]=f,f.buckets={},m(null)):(f.state="errored",m(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}const qe={vector:Z,raster:Q,"raster-dem":class extends Q{constructor(v,f,m,b){super(v,f,m,b),this.type="raster-dem",this.maxzoom=22,this._options=a.extend({type:"raster-dem"},f),this.encoding=f.encoding||"mapbox"}loadTile(v,f){const m=this.map._requestManager.normalizeTileURL(v.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function b(x,E){x&&(v.state="errored",f(x)),E&&(v.dem=E,v.dem.onDeserialize(),v.needsHillshadePrepare=!0,v.needsDEMTextureUpload=!0,v.state="loaded",f(null))}v.request=a.getImage(this.map._requestManager.transformRequest(m,a.ResourceType.Tile),function(x,E,P,I){if(delete v.request,v.aborted)v.state="unloaded",f(null);else if(x)v.state="errored",f(x);else if(E){this.map._refreshExpiredTiles&&v.setExpiryData({cacheControl:P,expires:I});const L=a.window.ImageBitmap&&E instanceof a.window.ImageBitmap&&(fe==null&&(fe=a.window.OffscreenCanvas&&new a.window.OffscreenCanvas(1,1).getContext("2d")&&typeof a.window.createImageBitmap=="function"),fe),H=1-(E.width-a.prevPowerOfTwo(E.width))/2;H<1||v.neighboringTiles||(v.neighboringTiles=this._getNeighboringTiles(v.tileID));const F=L?E:a.exported.getImageData(E,H),X={uid:v.uid,coord:v.tileID,source:this.id,rawImageData:F,encoding:this.encoding,padding:H};v.actor&&v.state!=="expired"||(v.actor=this.dispatcher.getActor(),v.actor.send("loadDEMTile",X,b.bind(this),void 0,!0))}}.bind(this))}_getNeighboringTiles(v){const f=v.canonical,m=Math.pow(2,f.z),b=(f.x-1+m)%m,x=f.x===0?v.wrap-1:v.wrap,E=(f.x+1+m)%m,P=f.x+1===m?v.wrap+1:v.wrap,I={};return I[new a.OverscaledTileID(v.overscaledZ,x,f.z,b,f.y).key]={backfilled:!1},I[new a.OverscaledTileID(v.overscaledZ,P,f.z,E,f.y).key]={backfilled:!1},f.y>0&&(I[new a.OverscaledTileID(v.overscaledZ,x,f.z,b,f.y-1).key]={backfilled:!1},I[new a.OverscaledTileID(v.overscaledZ,v.wrap,f.z,f.x,f.y-1).key]={backfilled:!1},I[new a.OverscaledTileID(v.overscaledZ,P,f.z,E,f.y-1).key]={backfilled:!1}),f.y+1<m&&(I[new a.OverscaledTileID(v.overscaledZ,x,f.z,b,f.y+1).key]={backfilled:!1},I[new a.OverscaledTileID(v.overscaledZ,v.wrap,f.z,f.x,f.y+1).key]={backfilled:!1},I[new a.OverscaledTileID(v.overscaledZ,P,f.z,E,f.y+1).key]={backfilled:!1}),I}unloadTile(v){v.demTexture&&this.map.painter.saveTileTexture(v.demTexture),v.fbo&&(v.fbo.destroy(),delete v.fbo),v.dem&&delete v.dem,delete v.neighboringTiles,v.state="unloaded"}},geojson:class extends a.Evented{constructor(v,f,m,b){super(),this.id=v,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=m.getActor(),this.setEventedParent(b),this._data=f.data,this._options=a.extend({},f),this._collectResourceTiming=f.collectResourceTiming,f.maxzoom!==void 0&&(this.maxzoom=f.maxzoom),f.type&&(this.type=f.type),f.attribution&&(this.attribution=f.attribution),this.promoteId=f.promoteId;const x=a.EXTENT/this.tileSize;this.workerOptions=a.extend({source:this.id,cluster:f.cluster||!1,geojsonVtOptions:{buffer:(f.buffer!==void 0?f.buffer:128)*x,tolerance:(f.tolerance!==void 0?f.tolerance:.375)*x,extent:a.EXTENT,maxZoom:this.maxzoom,lineMetrics:f.lineMetrics||!1,generateId:f.generateId||!1},superclusterOptions:{maxZoom:f.clusterMaxZoom!==void 0?f.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,f.clusterMinPoints||2),extent:a.EXTENT,radius:(f.clusterRadius!==void 0?f.clusterRadius:50)*x,log:!1,generateId:f.generateId||!1},clusterProperties:f.clusterProperties,filter:f.filter},f.workerOptions)}onAdd(v){this.map=v,this.setData(this._data)}setData(v){return this._data=v,this._updateWorkerData(),this}getClusterExpansionZoom(v,f){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:v,source:this.id},f),this}getClusterChildren(v,f){return this.actor.send("geojson.getClusterChildren",{clusterId:v,source:this.id},f),this}getClusterLeaves(v,f,m,b){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:v,limit:f,offset:m},b),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new a.Event("dataloading",{dataType:"source"})),this._loaded=!1;const v=a.extend({},this.workerOptions),f=this._data;typeof f=="string"?(v.request=this.map._requestManager.transformRequest(a.exported.resolveURL(f),a.ResourceType.Source),v.request.collectResourceTiming=this._collectResourceTiming):v.data=JSON.stringify(f),this._pendingLoad=this.actor.send(`${this.type}.loadData`,v,(m,b)=>{if(this._loaded=!0,this._pendingLoad=null,m)this.fire(new a.ErrorEvent(m));else{const x={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&b&&b.resourceTiming&&b.resourceTiming[this.id]&&(x.resourceTiming=b.resourceTiming[this.id]),this.fire(new a.Event("data",x)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(v,f){const m=v.actor?"reloadTile":"loadTile";v.actor=this.actor,v.request=this.actor.send(m,{type:this.type,uid:v.uid,tileID:v.tileID,tileZoom:v.tileZoom,zoom:v.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:a.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(b,x)=>(delete v.request,v.unloadVectorData(),v.aborted?f(null):b?f(b):(v.loadVectorData(x,this.map.painter,m==="reloadTile"),f(null))),void 0,m==="loadTile")}abortTile(v){v.request&&(v.request.cancel(),delete v.request),v.aborted=!0}unloadTile(v){v.unloadVectorData(),this.actor.send("removeTile",{uid:v.uid,type:this.type,source:this.id})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return a.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends Ae{constructor(v,f,m,b){super(v,f,m,b),this.roundZoom=!0,this.type="video",this.options=f}load(){this._loaded=!1;const v=this.options;this.urls=[];for(const f of v.urls)this.urls.push(this.map._requestManager.transformRequest(f,a.ResourceType.Source).url);a.getVideo(this.urls,(f,m)=>{this._loaded=!0,f?this.fire(new a.ErrorEvent(f)):m&&(this.video=m,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(v){if(this.video){const f=this.video.seekable;v<f.start(0)||v>f.end(0)?this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${f.start(0)} and ${f.end(0)}-second mark.`))):this.video.currentTime=v}}getVideo(){return this.video}onAdd(v){this.map||(this.map=v,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const v=this.map.painter.context,f=v.gl;this.texture?this.video.paused||(this.texture.bind(f.LINEAR,f.CLAMP_TO_EDGE),f.texSubImage2D(f.TEXTURE_2D,0,0,0,f.RGBA,f.UNSIGNED_BYTE,this.video)):(this.texture=new a.Texture(v,this.video,f.RGBA),this.texture.bind(f.LINEAR,f.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(v)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:Ae,canvas:class extends Ae{constructor(v,f,m,b){super(v,f,m,b),f.coordinates?Array.isArray(f.coordinates)&&f.coordinates.length===4&&!f.coordinates.some(x=>!Array.isArray(x)||x.length!==2||x.some(E=>typeof E!="number"))||this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${v}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${v}`,null,'missing required property "coordinates"'))),f.animate&&typeof f.animate!="boolean"&&this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${v}`,null,'optional "animate" property must be a boolean value'))),f.canvas?typeof f.canvas=="string"||f.canvas instanceof a.window.HTMLCanvasElement||this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${v}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${v}`,null,'missing required property "canvas"'))),this.options=f,this.animate=f.animate===void 0||f.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof a.window.HTMLCanvasElement?this.options.canvas:a.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new a.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(v){this.map=v,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let v=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,v=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,v=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const f=this.map.painter.context;this.texture?(v||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new a.Texture(f,this.canvas,f.gl.RGBA,{premultiply:!0}),this._prepareData(f)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const v of[this.canvas.width,this.canvas.height])if(isNaN(v)||v<=0)return!0;return!1}},custom:class extends a.Evented{constructor(v,f,m,b){super(),this.id=v,this.type="custom",this._dataType="raster",this._dispatcher=m,this._implementation=f,this.setEventedParent(b),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new a.ErrorEvent(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new a.ErrorEvent(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new jt(this._implementation.bounds,this.minzoom,this.maxzoom)),f.update=this._update.bind(this),f.clearTiles=this._clearTiles.bind(this),f.coveringTiles=this._coveringTiles.bind(this),a.extend(this,a.pick(f,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return a.pick(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(v){this._map=v,this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(v),this.load()}onRemove(v){this._implementation.onRemove&&this._implementation.onRemove(v)}hasTile(v){if(this._implementation.hasTile){const{x:f,y:m,z:b}=v.canonical;return this._implementation.hasTile({x:f,y:m,z:b})}return!this.tileBounds||this.tileBounds.contains(v.canonical)}loadTile(v,f){const{x:m,y:b,z:x}=v.tileID.canonical,E=new a.window.AbortController;v.request=Promise.resolve(this._implementation.loadTile({x:m,y:b,z:x},{signal:E.signal})).then(function(P){return delete v.request,v.aborted?(v.state="unloaded",f(null)):P===void 0?(v.state="errored",f(null)):P===null?(this.loadTileData(v,{width:this.tileSize,height:this.tileSize,data:null}),v.state="loaded",f(null)):function(I){return I instanceof a.window.ImageData||I instanceof a.window.HTMLCanvasElement||I instanceof a.window.ImageBitmap||I instanceof a.window.HTMLImageElement}(P)?(this.loadTileData(v,P),v.state="loaded",void f(null)):(v.state="errored",f(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}.bind(this)).catch(P=>{P.code!==20&&(v.state="errored",f(P))}),v.request.cancel=()=>E.abort()}loadTileData(v,f){Q.loadTileData(v,f,this._map.painter)}unloadTileData(v){Q.unloadTileData(v,this._map.painter)}unloadTile(v,f){if(this.unloadTileData(v),this._implementation.unloadTile){const{x:m,y:b,z:x}=v.tileID.canonical;this._implementation.unloadTile({x:m,y:b,z:x})}f()}abortTile(v,f){v.request&&v.request.cancel&&(v.request.cancel(),delete v.request),f()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(v=>({x:v.canonical.x,y:v.canonical.y,z:v.canonical.z}))}_clearTiles(){this._map.style._clearSource(this.id)}_update(){this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"}))}}},Ge=function(v,f,m,b){const x=new qe[f.type](v,f,m,b);if(x.id!==v)throw new Error(`Expected Source id to be ${v} instead of ${x.id}`);return a.bindAll(["load","abort","unload","serialize","prepare"],x),x};function Ie(v,f){const m=a.identity([]);return a.scale(m,m,[.5*v.width,.5*-v.height,1]),a.translate(m,m,[1,-1,0]),a.multiply(m,m,v.calculateProjMatrix(f.toUnwrapped())),Float32Array.from(m)}function nt(v,f,m,b,x,E,P,I=!1){const L=v.tilesIn(b,P,I);L.sort(Xt);const H=[];for(const X of L)H.push({wrappedTileID:X.tile.tileID.wrapped().key,queryResults:X.tile.queryRenderedFeatures(f,m,v._state,X,x,E,Ie(v.transform,X.tile.tileID),I)});const F=function(X){const re={},oe={};for(const le of X){const ue=le.queryResults,ce=le.wrappedTileID,te=oe[ce]=oe[ce]||{};for(const ge in ue){const me=ue[ge],be=te[ge]=te[ge]||{},Pe=re[ge]=re[ge]||[];for(const Oe of me)be[Oe.featureIndex]||(be[Oe.featureIndex]=!0,Pe.push(Oe))}}return re}(H);for(const X in F)F[X].forEach(re=>{const oe=re.feature,le=oe.layer;le&&le.type!=="background"&&le.type!=="sky"&&(oe.source=le.source,le["source-layer"]&&(oe.sourceLayer=le["source-layer"]),oe.state=oe.id!==void 0?v.getFeatureState(le["source-layer"],oe.id):{})});return F}function Ct(v,f){const m=v.getRenderableIds().map(E=>v.getTileByID(E)),b=[],x={};for(let E=0;E<m.length;E++){const P=m[E],I=P.tileID.canonical.key;x[I]||(x[I]=!0,P.querySourceFeatures(b,f))}return b}function Xt(v,f){const m=v.tileID,b=f.tileID;return m.overscaledZ-b.overscaledZ||m.canonical.y-b.canonical.y||m.wrap-b.wrap||m.canonical.x-b.canonical.x}function Dt(){return ed.workerClass!=null?new ed.workerClass:new a.window.Worker(ed.workerUrl)}const _r="mapboxgl_preloaded_worker_pool";class Tt{constructor(){this.active={}}acquire(f){if(!this.workers)for(this.workers=[];this.workers.length<Tt.workerCount;)this.workers.push(new Dt);return this.active[f]=!0,this.workers.slice()}release(f){delete this.active[f],this.numActive()===0&&(this.workers.forEach(m=>{m.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[_r]}numActive(){return Object.keys(this.active).length}}let Ee;function mt(){return Ee||(Ee=new Tt),Ee}function It(v,f){const m={};for(const b in v)b!=="ref"&&(m[b]=v[b]);return a.refProperties.forEach(b=>{b in f&&(m[b]=f[b])}),m}function pr(v){v=v.slice();const f=Object.create(null);for(let m=0;m<v.length;m++)f[v[m].id]=v[m];for(let m=0;m<v.length;m++)"ref"in v[m]&&(v[m]=It(v[m],f[v[m].ref]));return v}Tt.workerCount=2;const or={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setProjection:"setProjection"};function Nr(v,f,m){m.push({command:or.addSource,args:[v,f[v]]})}function Lr(v,f,m){f.push({command:or.removeSource,args:[v]}),m[v]=!0}function oa(v,f,m,b){Lr(v,m,b),Nr(v,f,m)}function Gn(v,f,m){let b;for(b in v[m])if(v[m].hasOwnProperty(b)&&b!=="data"&&!h(v[m][b],f[m][b]))return!1;for(b in f[m])if(f[m].hasOwnProperty(b)&&b!=="data"&&!h(v[m][b],f[m][b]))return!1;return!0}function yt(v,f,m,b,x,E){let P;for(P in f=f||{},v=v||{})v.hasOwnProperty(P)&&(h(v[P],f[P])||m.push({command:E,args:[b,P,f[P],x]}));for(P in f)f.hasOwnProperty(P)&&!v.hasOwnProperty(P)&&(h(v[P],f[P])||m.push({command:E,args:[b,P,f[P],x]}))}function Sa(v){return v.id}function bi(v,f){return v[f.id]=f,v}class wl{constructor(f,m){this.reset(f,m)}reset(f,m){this.points=f||[],this._distances=[0];for(let b=1;b<this.points.length;b++)this._distances[b]=this._distances[b-1]+this.points[b].dist(this.points[b-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(m||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(f){if(this.points.length===1)return this.points[0];f=a.clamp(f,0,1);let m=1,b=this._distances[m];const x=f*this.paddedLength+this.padding;for(;b<x&&m<this._distances.length;)b=this._distances[++m];const E=m-1,P=this._distances[E],I=b-P,L=I>0?(x-P)/I:0;return this.points[E].mult(1-L).add(this.points[m].mult(L))}}class TC{constructor(f,m,b){const x=this.boxCells=[],E=this.circleCells=[];this.xCellCount=Math.ceil(f/b),this.yCellCount=Math.ceil(m/b);for(let P=0;P<this.xCellCount*this.yCellCount;P++)x.push([]),E.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=f,this.height=m,this.xScale=this.xCellCount/f,this.yScale=this.yCellCount/m,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(f,m,b,x,E){this._forEachCell(m,b,x,E,this._insertBoxCell,this.boxUid++),this.boxKeys.push(f),this.bboxes.push(m),this.bboxes.push(b),this.bboxes.push(x),this.bboxes.push(E)}insertCircle(f,m,b,x){this._forEachCell(m-x,b-x,m+x,b+x,this._insertCircleCell,this.circleUid++),this.circleKeys.push(f),this.circles.push(m),this.circles.push(b),this.circles.push(x)}_insertBoxCell(f,m,b,x,E,P){this.boxCells[E].push(P)}_insertCircleCell(f,m,b,x,E,P){this.circleCells[E].push(P)}_query(f,m,b,x,E,P){if(b<0||f>this.width||x<0||m>this.height)return!E&&[];const I=[];if(f<=0&&m<=0&&this.width<=b&&this.height<=x){if(E)return!0;for(let L=0;L<this.boxKeys.length;L++)I.push({key:this.boxKeys[L],x1:this.bboxes[4*L],y1:this.bboxes[4*L+1],x2:this.bboxes[4*L+2],y2:this.bboxes[4*L+3]});for(let L=0;L<this.circleKeys.length;L++){const H=this.circles[3*L],F=this.circles[3*L+1],X=this.circles[3*L+2];I.push({key:this.circleKeys[L],x1:H-X,y1:F-X,x2:H+X,y2:F+X})}return P?I.filter(P):I}return this._forEachCell(f,m,b,x,this._queryCell,I,{hitTest:E,seenUids:{box:{},circle:{}}},P),E?I.length>0:I}_queryCircle(f,m,b,x,E){const P=f-b,I=f+b,L=m-b,H=m+b;if(I<0||P>this.width||H<0||L>this.height)return!x&&[];const F=[];return this._forEachCell(P,L,I,H,this._queryCellCircle,F,{hitTest:x,circle:{x:f,y:m,radius:b},seenUids:{box:{},circle:{}}},E),x?F.length>0:F}query(f,m,b,x,E){return this._query(f,m,b,x,!1,E)}hitTest(f,m,b,x,E){return this._query(f,m,b,x,!0,E)}hitTestCircle(f,m,b,x){return this._queryCircle(f,m,b,!0,x)}_queryCell(f,m,b,x,E,P,I,L){const H=I.seenUids,F=this.boxCells[E];if(F!==null){const re=this.bboxes;for(const oe of F)if(!H.box[oe]){H.box[oe]=!0;const le=4*oe;if(f<=re[le+2]&&m<=re[le+3]&&b>=re[le+0]&&x>=re[le+1]&&(!L||L(this.boxKeys[oe]))){if(I.hitTest)return P.push(!0),!0;P.push({key:this.boxKeys[oe],x1:re[le],y1:re[le+1],x2:re[le+2],y2:re[le+3]})}}}const X=this.circleCells[E];if(X!==null){const re=this.circles;for(const oe of X)if(!H.circle[oe]){H.circle[oe]=!0;const le=3*oe;if(this._circleAndRectCollide(re[le],re[le+1],re[le+2],f,m,b,x)&&(!L||L(this.circleKeys[oe]))){if(I.hitTest)return P.push(!0),!0;{const ue=re[le],ce=re[le+1],te=re[le+2];P.push({key:this.circleKeys[oe],x1:ue-te,y1:ce-te,x2:ue+te,y2:ce+te})}}}}}_queryCellCircle(f,m,b,x,E,P,I,L){const H=I.circle,F=I.seenUids,X=this.boxCells[E];if(X!==null){const oe=this.bboxes;for(const le of X)if(!F.box[le]){F.box[le]=!0;const ue=4*le;if(this._circleAndRectCollide(H.x,H.y,H.radius,oe[ue+0],oe[ue+1],oe[ue+2],oe[ue+3])&&(!L||L(this.boxKeys[le])))return P.push(!0),!0}}const re=this.circleCells[E];if(re!==null){const oe=this.circles;for(const le of re)if(!F.circle[le]){F.circle[le]=!0;const ue=3*le;if(this._circlesCollide(oe[ue],oe[ue+1],oe[ue+2],H.x,H.y,H.radius)&&(!L||L(this.circleKeys[le])))return P.push(!0),!0}}}_forEachCell(f,m,b,x,E,P,I,L){const H=this._convertToXCellCoord(f),F=this._convertToYCellCoord(m),X=this._convertToXCellCoord(b),re=this._convertToYCellCoord(x);for(let oe=H;oe<=X;oe++)for(let le=F;le<=re;le++)if(E.call(this,f,m,b,x,this.xCellCount*le+oe,P,I,L))return}_convertToXCellCoord(f){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(f*this.xScale)))}_convertToYCellCoord(f){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(f*this.yScale)))}_circlesCollide(f,m,b,x,E,P){const I=x-f,L=E-m,H=b+P;return H*H>I*I+L*L}_circleAndRectCollide(f,m,b,x,E,P,I){const L=(P-x)/2,H=Math.abs(f-(x+L));if(H>L+b)return!1;const F=(I-E)/2,X=Math.abs(m-(E+F));if(X>F+b)return!1;if(H<=L||X<=F)return!0;const re=H-L,oe=X-F;return re*re+oe*oe<=b*b}}const ds=Math.tan(85*Math.PI/180);function jc(v,f,m,b,x,E,P){const I=a.create();if(m)if(E.name==="globe"){const L=a.calculateGlobeLabelMatrix(x,f);a.multiply(I,I,L)}else{const L=Ne([],P);I[0]=L[0],I[1]=L[1],I[4]=L[2],I[5]=L[3],b||a.rotateZ(I,I,x.angle)}else a.multiply(I,x.labelPlaneMatrix,v);return I}function OC(v,f,m,b,x,E,P){const I=jc(v,f,m,b,x,E,P);return E.name==="globe"&&m||(I[2]=I[6]=I[10]=I[14]=0),I}function zc(v,f,m,b,x,E,P){if(m){if(E.name==="globe"){const I=jc(v,f,m,b,x,E,P);return a.invert(I,I),a.multiply(I,v,I),I}{const I=a.clone(v),L=a.identity([]);return L[0]=P[0],L[1]=P[1],L[4]=P[2],L[5]=P[3],a.multiply(I,I,L),b||a.rotateZ(I,I,-x.angle),I}}return x.glCoordMatrix}function Ut(v,f,m,b){const x=[v,f,m,1];m?a.transformMat4$1(x,x,b):RC(x,x,b);const E=x[3];return x[0]/=E,x[1]/=E,x[2]/=E,x}function rn(v,f){return Math.min(.5+v/f*.5,1.5)}function qr(v,f){const m=v[0]/v[3],b=v[1]/v[3];return m>=-f[0]&&m<=f[0]&&b>=-f[1]&&b<=f[1]}function ps(v,f,m,b,x,E,P,I,L,H){const F=m.transform,X=b?v.textSizeData:v.iconSizeData,re=a.evaluateSizeForZoom(X,m.transform.zoom),oe=F.projection.name==="globe",le=[256/m.width*2+1,256/m.height*2+1],ue=b?v.text.dynamicLayoutVertexArray:v.icon.dynamicLayoutVertexArray;ue.clear();let ce=null;oe&&(ce=b?v.text.globeExtVertexArray:v.icon.globeExtVertexArray);const te=v.lineVertexArray,ge=b?v.text.placedSymbolArray:v.icon.placedSymbolArray,me=m.transform.width/m.transform.height;let be,Pe=!1;for(let Oe=0;Oe<ge.length;Oe++){const De=ge.get(Oe),{numGlyphs:Xe,writingMode:ot}=De;if(ot!==a.WritingMode.vertical||Pe||be===a.WritingMode.horizontal||(Pe=!0),be=ot,(De.hidden||ot===a.WritingMode.vertical)&&!Pe){zn(Xe,ue);continue}Pe=!1;const ut=new a.pointGeometry(De.tileAnchorX,De.tileAnchorY);let{x:Bt,y:tt,z:wt}=F.projection.projectTilePoint(ut.x,ut.y,H.canonical);if(L){const[Hr,rr,er]=L(ut);Bt+=Hr,tt+=rr,wt+=er}const pt=[Bt,tt,wt,1];if(a.transformMat4$1(pt,pt,f),!qr(pt,le)){zn(Xe,ue);continue}const Ot=rn(m.transform.cameraToCenterDistance,pt[3]),at=a.evaluateSizeForFeature(X,re,De),Ye=P?at/Ot:at*Ot,ct=Ut(Bt,tt,wt,x);if(ct[3]<=0){zn(Xe,ue);continue}let Et={};const Mt=P?null:L,ur=Eh(De,Ye,!1,I,f,x,E,v.glyphOffsetArray,te,ue,ce,ct,ut,Et,me,Mt,F.projection,H,P);Pe=ur.useVertical,Mt&&ur.needsFlipping&&(Et={}),(ur.notEnoughRoom||Pe||ur.needsFlipping&&Eh(De,Ye,!0,I,f,x,E,v.glyphOffsetArray,te,ue,ce,ct,ut,Et,me,Mt,F.projection,H,P).notEnoughRoom)&&zn(Xe,ue)}b?(v.text.dynamicLayoutVertexBuffer.updateData(ue),ce&&v.text.globeExtVertexBuffer.updateData(ce)):(v.icon.dynamicLayoutVertexBuffer.updateData(ue),ce&&v.icon.globeExtVertexBuffer.updateData(ce))}function mu(v,f,m,b,x,E,P,I,L,H,F,X,re,oe,le,ue){const{lineStartIndex:ce,glyphStartIndex:te,segment:ge}=I,me=te+I.numGlyphs,be=ce+I.lineLength,Pe=f.getoffsetX(te),Oe=f.getoffsetX(me-1),De=Mo(v*Pe,m,b,x,E,P,ge,ce,be,L,H,F,X,re,!0,oe,le,ue);if(!De)return null;const Xe=Mo(v*Oe,m,b,x,E,P,ge,ce,be,L,H,F,X,re,!0,oe,le,ue);return Xe?{first:De,last:Xe}:null}function Gr(v,f,m,b){return v===a.WritingMode.horizontal&&Math.abs(b)>Math.abs(m)?{useVertical:!0}:v===a.WritingMode.vertical?b>0?{needsFlipping:!0}:null:f!==0&&function(x,E){return x===0||Math.abs(E/x)>ds}(m,b)?f===1?{needsFlipping:!0}:null:m<0?{needsFlipping:!0}:null}function Eh(v,f,m,b,x,E,P,I,L,H,F,X,re,oe,le,ue,ce,te,ge){const me=f/24,be=v.lineOffsetX*me,Pe=v.lineOffsetY*me,{lineStartIndex:Oe,glyphStartIndex:De,numGlyphs:Xe,segment:ot,writingMode:ut,flipState:Bt}=v,tt=Oe+v.lineLength,wt=pt=>{if(F){const[ct,Et,Mt]=pt.up,ur=H.length;a.updateGlobeVertexNormal(F,ur+0,ct,Et,Mt),a.updateGlobeVertexNormal(F,ur+1,ct,Et,Mt),a.updateGlobeVertexNormal(F,ur+2,ct,Et,Mt),a.updateGlobeVertexNormal(F,ur+3,ct,Et,Mt)}const[Ot,at,Ye]=pt.point;a.addDynamicAttributes(H,Ot,at,Ye,pt.angle)};if(Xe>1){const pt=mu(me,I,be,Pe,m,X,re,v,L,E,oe,ue,!1,ce,te,ge);if(!pt)return{notEnoughRoom:!0};if(b&&!m){let[Ot,at,Ye]=pt.first.point,[ct,Et,Mt]=pt.last.point;[Ot,at]=Ut(Ot,at,Ye,P),[ct,Et]=Ut(ct,Et,Mt,P);const ur=Gr(ut,Bt,(ct-Ot)*le,Et-at);if(v.flipState=ur&&ur.needsFlipping?1:2,ur)return ur}wt(pt.first);for(let Ot=De+1;Ot<De+Xe-1;Ot++){const at=Mo(me*I.getoffsetX(Ot),be,Pe,m,X,re,ot,Oe,tt,L,E,oe,ue,!1,!1,ce,te,ge);if(!at)return H.length-=4*(Ot-De),{notEnoughRoom:!0};wt(at)}wt(pt.last)}else{if(b&&!m){const Ot=Ut(re.x,re.y,0,x),at=Oe+ot+1,Ye=new a.pointGeometry(L.getx(at),L.gety(at)),ct=Ut(Ye.x,Ye.y,0,x),Et=ct[3]>0?ct:Hc(re,Ye,Ot,1,x,void 0,ce,te.canonical),Mt=Gr(ut,Bt,(Et[0]-Ot[0])*le,Et[1]-Ot[1]);if(v.flipState=Mt&&Mt.needsFlipping?1:2,Mt)return Mt}const pt=Mo(me*I.getoffsetX(De),be,Pe,m,X,re,ot,Oe,tt,L,E,oe,ue,!1,!1,ce,te,ge);if(!pt)return{notEnoughRoom:!0};wt(pt)}return{}}function Fc(v,f,m,b,x){const{x:E,y:P,z:I}=b.projectTilePoint(v.x,v.y,f);if(!x)return Ut(E,P,I,m);const[L,H,F]=x(v);return Ut(E+L,P+H,I+F,m)}function Hc(v,f,m,b,x,E,P,I){const L=Fc(v.sub(f)._unit()._add(v),I,x,P,E);return a.sub(L,m,L),a.normalize(L,L),a.scaleAndAdd(L,m,L,b)}function Mo(v,f,m,b,x,E,P,I,L,H,F,X,re,oe,le,ue,ce,te){const ge=b?v-f:v+f;let me=ge>0?1:-1,be=0;b&&(me*=-1,be=Math.PI),me<0&&(be+=Math.PI);let Pe=I+P+(me>0?0:1)|0,Oe=x,De=x,Xe=0,ot=0;const ut=Math.abs(ge),Bt=[],tt=[];let wt=E,pt=wt;const Ot=()=>Hc(pt,wt,De,ut-Xe+1,F,re,ue,ce.canonical);for(;Xe+ot<=ut;){if(Pe+=me,Pe<I||Pe>=L)return null;if(De=Oe,pt=wt,Bt.push(De),oe&&tt.push(pt),wt=new a.pointGeometry(H.getx(Pe),H.gety(Pe)),Oe=X[Pe],!Oe){const er=Fc(wt,ce.canonical,F,ue,re);Oe=er[3]>0?X[Pe]=er:Ot()}Xe+=ot,ot=a.distance(De,Oe)}le&&re&&(X[Pe]&&(Oe=Ot(),ot=a.distance(De,Oe)),X[Pe]=Oe);const at=(ut-Xe)/ot,Ye=wt.sub(pt)._mult(at)._add(pt),ct=a.sub([],Oe,De),Et=a.scaleAndAdd([],De,ct,at);let Mt=[0,0,1],ur=ct[0],Hr=ct[1];if(te&&(Mt=ue.upVector(ce.canonical,Ye.x,Ye.y),Mt[0]!==0||Mt[1]!==0||Mt[2]!==1)){const er=[Mt[2],0,-Mt[0]],fr=a.cross([],Mt,er);a.normalize(er,er),a.normalize(fr,fr),ur=a.dot(ct,er),Hr=a.dot(ct,fr)}if(m){const er=a.cross([],Mt,ct);a.normalize(er,er),a.scaleAndAdd(Et,Et,er,m*me)}const rr=be+Math.atan2(Hr,ur);return Bt.push(Et),oe&&tt.push(Ye),{point:Et,angle:rr,path:Bt,tilePath:tt,up:Mt}}function zn(v,f){const m=f.length,b=m+4*v;f.resize(b),f.float32.fill(-1/0,4*m,4*b)}function RC(v,f,m){const b=f[0],x=f[1];return v[0]=m[0]*b+m[4]*x+m[12],v[1]=m[1]*b+m[5]*x+m[13],v[3]=m[3]*b+m[7]*x+m[15],v}const zo=100;class cb{constructor(f,m,b=new TC(f.width+200,f.height+200,25),x=new TC(f.width+200,f.height+200,25)){this.transform=f,this.grid=b,this.ignoredGrid=x,this.pitchfactor=Math.cos(f._pitch)*f.cameraToCenterDistance,this.screenRightBoundary=f.width+zo,this.screenBottomBoundary=f.height+zo,this.gridRightBoundary=f.width+200,this.gridBottomBoundary=f.height+200,this.fogState=m}placeCollisionBox(f,m,b,x,E,P,I,L){let H=b.projectedAnchorX,F=b.projectedAnchorY,X=b.projectedAnchorZ;const re=b.elevation,oe=b.tileID,le=f.getProjection();if(re&&oe){const[Oe,De,Xe]=le.upVector(oe.canonical,b.tileAnchorX,b.tileAnchorY),ot=le.upVectorScale(oe.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;H+=Oe*re*ot,F+=De*re*ot,X+=Xe*re*ot}const ue=this.projectAndGetPerspectiveRatio(I,H,F,X,b.tileID,le.name==="globe"||!!re||this.transform.pitch>0,le),ce=P*ue.perspectiveRatio,te=(b.x1*m+x.x-b.padding)*ce+ue.point.x,ge=(b.y1*m+x.y-b.padding)*ce+ue.point.y,me=(b.x2*m+x.x+b.padding)*ce+ue.point.x,be=(b.y2*m+x.y+b.padding)*ce+ue.point.y,Pe=ue.perspectiveRatio<=.55||ue.occluded;return!this.isInsideGrid(te,ge,me,be)||!E&&this.grid.hitTest(te,ge,me,be,L)||Pe?{box:[],offscreen:!1,occluded:ue.occluded}:{box:[te,ge,me,be],offscreen:this.isOffscreen(te,ge,me,be),occluded:!1}}placeCollisionCircles(f,m,b,x,E,P,I,L,H,F,X,re,oe,le,ue){const ce=[],te=this.transform.elevation,ge=f.getProjection(),me=te?te.getAtTileOffsetFunc(ue,this.transform.center.lat,this.transform.worldSize,ge):null,be=new a.pointGeometry(b.tileAnchorX,b.tileAnchorY);let{x:Pe,y:Oe,z:De}=ge.projectTilePoint(be.x,be.y,ue.canonical);if(me){const[Ye,ct,Et]=me(be);Pe+=Ye,Oe+=ct,De+=Et}const Xe=ge.name==="globe",ot=this.projectAndGetPerspectiveRatio(I,Pe,Oe,De,ue,Xe||!!te||this.transform.pitch>0,ge),{perspectiveRatio:ut}=ot,Bt=(X?P/ut:P*ut)/a.ONE_EM,tt=Ut(Pe,Oe,De,L),wt=ot.signedDistanceFromCamera>0?mu(Bt,E,b.lineOffsetX*Bt,b.lineOffsetY*Bt,!1,tt,be,b,x,L,{},te&&!X?me:null,X&&!!te,ge,ue,X):null;let pt=!1,Ot=!1,at=!0;if(wt&&!ot.occluded){const Ye=.5*oe*ut+le,ct=new a.pointGeometry(-100,-100),Et=new a.pointGeometry(this.screenRightBoundary,this.screenBottomBoundary),Mt=new wl,{first:ur,last:Hr}=wt,rr=ur.path.length;let er=[];for(let gr=rr-1;gr>=1;gr--)er.push(ur.path[gr]);for(let gr=1;gr<Hr.path.length;gr++)er.push(Hr.path[gr]);const fr=2.5*Ye;H&&(er=er.map(([gr,En,On],Fn)=>(me&&!Xe&&(On=me(Fn<rr-1?ur.tilePath[rr-1-Fn]:Hr.tilePath[Fn-rr+2])[2]),Ut(gr,En,On,H))),er.some(gr=>gr[3]<=0)&&(er=[]));let Xr=[];if(er.length>0){let gr=1/0,En=-1/0,On=1/0,Fn=-1/0;for(const $n of er)gr=Math.min(gr,$n[0]),On=Math.min(On,$n[1]),En=Math.max(En,$n[0]),Fn=Math.max(Fn,$n[1]);En>=ct.x&&gr<=Et.x&&Fn>=ct.y&&On<=Et.y&&(Xr=[er.map($n=>new a.pointGeometry($n[0],$n[1]))],(gr<ct.x||En>Et.x||On<ct.y||Fn>Et.y)&&(Xr=a.clipLine(Xr,ct.x,ct.y,Et.x,Et.y)))}for(const gr of Xr){Mt.reset(gr,.25*Ye);let En=0;En=Mt.length<=.5*Ye?1:Math.ceil(Mt.paddedLength/fr)+1;for(let On=0;On<En;On++){const Fn=On/Math.max(En-1,1),$n=Mt.lerp(Fn),Ti=$n.x+zo,Vo=$n.y+zo;ce.push(Ti,Vo,Ye,0);const Ua=Ti-Ye,Ws=Vo-Ye,Zn=Ti+Ye,Ln=Vo+Ye;if(at=at&&this.isOffscreen(Ua,Ws,Zn,Ln),Ot=Ot||this.isInsideGrid(Ua,Ws,Zn,Ln),!m&&this.grid.hitTestCircle(Ti,Vo,Ye,re)&&(pt=!0,!F))return{circles:[],offscreen:!1,collisionDetected:pt,occluded:!1}}}}return{circles:!F&&pt||!Ot?[]:ce,offscreen:at,collisionDetected:pt,occluded:ot.occluded}}queryRenderedSymbols(f){if(f.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const m=[];let b=1/0,x=1/0,E=-1/0,P=-1/0;for(const F of f){const X=new a.pointGeometry(F.x+zo,F.y+zo);b=Math.min(b,X.x),x=Math.min(x,X.y),E=Math.max(E,X.x),P=Math.max(P,X.y),m.push(X)}const I=this.grid.query(b,x,E,P).concat(this.ignoredGrid.query(b,x,E,P)),L={},H={};for(const F of I){const X=F.key;if(L[X.bucketInstanceId]===void 0&&(L[X.bucketInstanceId]={}),L[X.bucketInstanceId][X.featureIndex])continue;const re=[new a.pointGeometry(F.x1,F.y1),new a.pointGeometry(F.x2,F.y1),new a.pointGeometry(F.x2,F.y2),new a.pointGeometry(F.x1,F.y2)];a.polygonIntersectsPolygon(m,re)&&(L[X.bucketInstanceId][X.featureIndex]=!0,H[X.bucketInstanceId]===void 0&&(H[X.bucketInstanceId]=[]),H[X.bucketInstanceId].push(X.featureIndex))}return H}insertCollisionBox(f,m,b,x,E){(m?this.ignoredGrid:this.grid).insert({bucketInstanceId:b,featureIndex:x,collisionGroupID:E},f[0],f[1],f[2],f[3])}insertCollisionCircles(f,m,b,x,E){const P=m?this.ignoredGrid:this.grid,I={bucketInstanceId:b,featureIndex:x,collisionGroupID:E};for(let L=0;L<f.length;L+=4)P.insertCircle(I,f[L],f[L+1],f[L+2])}projectAndGetPerspectiveRatio(f,m,b,x,E,P,I){const L=[m,b,x,1];let H=!1;if(x||this.transform.pitch>0){a.transformMat4$1(L,L,f);const X=I.name==="globe";this.fogState&&E&&!X&&(H=function(oe,le,ue,ce,te,ge){const me=ge.calculateFogTileMatrix(te),be=[le,ue,ce];return a.transformMat4(be,be,me),ae(oe,be,ge.pitch,ge._fov)}(this.fogState,m,b,x,E.toUnwrapped(),this.transform)>.9)}else RC(L,L,f);const F=L[3];return{point:new a.pointGeometry((L[0]/F+1)/2*this.transform.width+zo,(-L[1]/F+1)/2*this.transform.height+zo),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(I)/F*.5,1.5),signedDistanceFromCamera:F,occluded:P&&L[2]>F||H}}isOffscreen(f,m,b,x){return b<zo||f>=this.screenRightBoundary||x<zo||m>this.screenBottomBoundary}isInsideGrid(f,m,b,x){return b>=0&&f<this.gridRightBoundary&&x>=0&&m<this.gridBottomBoundary}getViewportMatrix(){const f=a.identity([]);return a.translate(f,f,[-100,-100,0]),f}}function yu(v,f,m){const b=f.createTileMatrix(v,v.worldSize,m.toUnwrapped());return a.multiply(new Float32Array(16),v.projMatrix,b)}function fb(v,f,m){if(f.projection.name===m.projection.name)return v.projMatrix;const b=m.clone();return b.setProjection(f.projection),yu(b,f.getProjection(),v)}function am(v,f,m){return f.name===m.projection.name?v.projMatrix:yu(m,f,v)}class Th{constructor(f,m,b,x){this.opacity=f?Math.max(0,Math.min(1,f.opacity+(f.placed?m:-m))):x&&b?1:0,this.placed=b}isHidden(){return this.opacity===0&&!this.placed}}class gu{constructor(f,m,b,x,E,P=!1){this.text=new Th(f?f.text:null,m,b,E),this.icon=new Th(f?f.icon:null,m,x,E),this.clipped=P}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Vc{constructor(f,m,b,x=!1){this.text=f,this.icon=m,this.skipFade=b,this.clipped=x}}class hb{constructor(){this.invProjMatrix=a.create(),this.viewportMatrix=a.create(),this.circles=[]}}class Fo{constructor(f,m,b,x,E){this.bucketInstanceId=f,this.featureIndex=m,this.sourceLayerIndex=b,this.bucketIndex=x,this.tileID=E}}class wi{constructor(f){this.crossSourceCollisions=f,this.maxGroupID=0,this.collisionGroups={}}get(f){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[f]){const m=++this.maxGroupID;this.collisionGroups[f]={ID:m,predicate:b=>b.collisionGroupID===m}}return this.collisionGroups[f]}}function sm(v,f,m,b,x){const{horizontalAlign:E,verticalAlign:P}=a.getAnchorAlignment(v),I=-(E-.5)*f,L=-(P-.5)*m,H=a.evaluateVariableOffset(v,b);return new a.pointGeometry(I+H[0]*x,L+H[1]*x)}function Oh(v,f,m,b,x){const E=new a.pointGeometry(v,f);return m&&E._rotate(b?x:-x),E}class Ho{constructor(f,m,b,x,E){this.transform=f.clone(),this.projection=f.projection.name,this.collisionIndex=new cb(this.transform,E),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=m,this.retainedQueryData={},this.collisionGroups=new wi(b),this.collisionCircleArrays={},this.prevPlacement=x,x&&(x.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(f,m,b,x){const E=b.getBucket(m),P=b.latestFeatureIndex;if(!E||!P||m.id!==E.layerIds[0])return;const I=E.layers[0].layout,L=b.collisionBoxArray,H=Math.pow(2,this.transform.zoom-b.tileID.overscaledZ),F=b.tileSize/a.EXTENT,X=b.tileID.toUnwrapped();this.transform.setProjection(E.projection);const re=(oe=b.tileID,le=E.getProjection(),ue=this.transform,le.name===this.projection?ue.calculateProjMatrix(oe.toUnwrapped()):yu(ue,le,oe));var oe,le,ue;const ce=I.get("text-pitch-alignment")==="map",te=I.get("text-rotation-alignment")==="map";m.compileFilter();const ge=m.dynamicFilter(),me=m.dynamicFilterNeedsFeature(),be=this.transform.calculatePixelsToTileUnitsMatrix(b),Pe=OC(re,b.tileID.canonical,ce,te,this.transform,E.getProjection(),be);let Oe=null;if(ce){const ot=zc(re,b.tileID.canonical,ce,te,this.transform,E.getProjection(),be);Oe=a.multiply([],this.transform.labelPlaneMatrix,ot)}let De=null;ge&&b.latestFeatureIndex&&(De={unwrappedTileID:X,dynamicFilter:ge,dynamicFilterNeedsFeature:me,featureIndex:b.latestFeatureIndex}),this.retainedQueryData[E.bucketInstanceId]=new Fo(E.bucketInstanceId,P,E.sourceLayerIndex,E.index,b.tileID);const Xe={bucket:E,layout:I,posMatrix:re,textLabelPlaneMatrix:Pe,labelToScreenMatrix:Oe,clippingData:De,scale:H,textPixelRatio:F,holdingForFade:b.holdingForFade(),collisionBoxArray:L,partiallyEvaluatedTextSize:a.evaluateSizeForZoom(E.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:a.evaluateSizeForZoom(E.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(E.sourceID)};if(x)for(const ot of E.sortKeyRanges){const{sortKey:ut,symbolInstanceStart:Bt,symbolInstanceEnd:tt}=ot;f.push({sortKey:ut,symbolInstanceStart:Bt,symbolInstanceEnd:tt,parameters:Xe})}else f.push({symbolInstanceStart:0,symbolInstanceEnd:E.symbolInstances.length,parameters:Xe})}attemptAnchorPlacement(f,m,b,x,E,P,I,L,H,F,X,re,oe,le,ue,ce,te,ge){const{textOffset0:me,textOffset1:be,crossTileID:Pe}=re,Oe=[me,be],De=sm(f,b,x,Oe,E),Xe=this.collisionIndex.placeCollisionBox(le,E,m,Oh(De.x,De.y,P,I,this.transform.angle),X,L,H,F.predicate);if(ce){const ot=le.getSymbolInstanceIconSize(ge,this.transform.zoom,re.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(le,ot,ce,Oh(De.x,De.y,P,I,this.transform.angle),X,L,H,F.predicate).box.length===0)return}if(Xe.box.length>0){let ot;return this.prevPlacement&&this.prevPlacement.variableOffsets[Pe]&&this.prevPlacement.placements[Pe]&&this.prevPlacement.placements[Pe].text&&(ot=this.prevPlacement.variableOffsets[Pe].anchor),this.variableOffsets[Pe]={textOffset:Oe,width:b,height:x,anchor:f,textScale:E,prevAnchor:ot},this.markUsedJustification(le,f,re,ue),le.allowVerticalPlacement&&(this.markUsedOrientation(le,ue,re),this.placedOrientations[Pe]=ue),{shift:De,placedGlyphBoxes:Xe}}}placeLayerBucketPart(f,m,b,x){const{bucket:E,layout:P,posMatrix:I,textLabelPlaneMatrix:L,labelToScreenMatrix:H,clippingData:F,textPixelRatio:X,holdingForFade:re,collisionBoxArray:oe,partiallyEvaluatedTextSize:le,partiallyEvaluatedIconSize:ue,collisionGroup:ce}=f.parameters,te=P.get("text-optional"),ge=P.get("icon-optional"),me=P.get("text-allow-overlap"),be=P.get("icon-allow-overlap"),Pe=P.get("text-rotation-alignment")==="map",Oe=P.get("text-pitch-alignment")==="map",De=P.get("icon-text-fit")!=="none",Xe=P.get("symbol-z-order")==="viewport-y";this.transform.setProjection(E.projection);let ot=me&&(be||!E.hasIconData()||ge),ut=be&&(me||!E.hasTextData()||te);!E.collisionArrays&&oe&&E.deserializeCollisionBoxes(oe),b&&x&&E.updateCollisionDebugBuffers(this.transform.zoom,oe);const Bt=(tt,wt,pt)=>{const{crossTileID:Ot,numVerticalGlyphVertices:at}=tt;if(F){const Zn={zoom:this.transform.zoom,pitch:this.transform.pitch};let Ln=null;if(F.dynamicFilterNeedsFeature){const _n=this.retainedQueryData[E.bucketInstanceId];Ln=F.featureIndex.loadFeature({featureIndex:tt.featureIndex,bucketIndex:_n.bucketIndex,sourceLayerIndex:_n.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,F.dynamicFilter)(Zn,Ln,this.retainedQueryData[E.bucketInstanceId].tileID.canonical,new a.pointGeometry(tt.tileAnchorX,tt.tileAnchorY),this.transform.calculateDistanceTileData(F.unwrappedTileID)))return this.placements[Ot]=new Vc(!1,!1,!1,!0),void(m[Ot]=!0)}if(m[Ot])return;if(re)return void(this.placements[Ot]=new Vc(!1,!1,!1));let Ye=!1,ct=!1,Et=!0,Mt=!1,ur=!1,Hr=null,rr={box:null,offscreen:null,occluded:null},er={box:null,offscreen:null,occluded:null},fr=null,Xr=null,gr=null,En=0,On=0,Fn=0;pt.textFeatureIndex?En=pt.textFeatureIndex:tt.useRuntimeCollisionCircles&&(En=tt.featureIndex),pt.verticalTextFeatureIndex&&(On=pt.verticalTextFeatureIndex);const $n=Zn=>{Zn.tileID=this.retainedQueryData[E.bucketInstanceId].tileID;const Ln=this.transform.elevation;(Ln||Zn.elevation)&&(Zn.elevation=Ln?Ln.getAtTileOffset(Zn.tileID,Zn.tileAnchorX,Zn.tileAnchorY):0)},Ti=pt.textBox;if(Ti){$n(Ti);const Zn=_n=>{let di=a.WritingMode.horizontal;if(E.allowVerticalPlacement&&!_n&&this.prevPlacement){const bo=this.prevPlacement.placedOrientations[Ot];bo&&(this.placedOrientations[Ot]=bo,di=bo,this.markUsedOrientation(E,di,tt))}return di},Ln=(_n,di)=>{if(E.allowVerticalPlacement&&at>0&&pt.verticalTextBox){for(const bo of E.writingModes)if(bo===a.WritingMode.vertical?(rr=di(),er=rr):rr=_n(),rr&&rr.box&&rr.box.length)break}else rr=_n()};if(P.get("text-variable-anchor")){let _n=P.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[Ot]){const Yn=this.prevPlacement.variableOffsets[Ot];_n.indexOf(Yn.anchor)>0&&(_n=_n.filter(wo=>wo!==Yn.anchor),_n.unshift(Yn.anchor))}const di=(Yn,wo,So)=>{const Tl=E.getSymbolInstanceTextSize(le,tt,this.transform.zoom,wt),af=(Yn.x2-Yn.x1)*Tl+2*Yn.padding,aa=(Yn.y2-Yn.y1)*Tl+2*Yn.padding,Ea=De&&!be?wo:null;Ea&&$n(Ea);let Gs={box:[],offscreen:!1,occluded:!1};const Ol=me?2*_n.length:_n.length;for(let Rl=0;Rl<Ol;++Rl){const sf=this.attemptAnchorPlacement(_n[Rl%_n.length],Yn,af,aa,Tl,Pe,Oe,X,I,ce,Rl>=_n.length,tt,wt,E,So,Ea,le,ue);if(sf&&(Gs=sf.placedGlyphBoxes,Gs&&Gs.box&&Gs.box.length)){Ye=!0,Hr=sf.shift;break}}return Gs};Ln(()=>di(Ti,pt.iconBox,a.WritingMode.horizontal),()=>{const Yn=pt.verticalTextBox;return Yn&&$n(Yn),E.allowVerticalPlacement&&!(rr&&rr.box&&rr.box.length)&&at>0&&Yn?di(Yn,pt.verticalIconBox,a.WritingMode.vertical):{box:null,offscreen:null,occluded:null}}),rr&&(Ye=rr.box,Et=rr.offscreen,Mt=rr.occluded);const bo=Zn(rr&&rr.box);if(!Ye&&this.prevPlacement){const Yn=this.prevPlacement.variableOffsets[Ot];Yn&&(this.variableOffsets[Ot]=Yn,this.markUsedJustification(E,Yn.anchor,tt,bo))}}else{const _n=(di,bo)=>{const Yn=E.getSymbolInstanceTextSize(le,tt,this.transform.zoom,wt),wo=this.collisionIndex.placeCollisionBox(E,Yn,di,new a.pointGeometry(0,0),me,X,I,ce.predicate);return wo&&wo.box&&wo.box.length&&(this.markUsedOrientation(E,bo,tt),this.placedOrientations[Ot]=bo),wo};Ln(()=>_n(Ti,a.WritingMode.horizontal),()=>{const di=pt.verticalTextBox;return E.allowVerticalPlacement&&at>0&&di?($n(di),_n(di,a.WritingMode.vertical)):{box:null,offscreen:null,occluded:null}}),Zn(rr&&rr.box&&rr.box.length)}}if(fr=rr,Ye=fr&&fr.box&&fr.box.length>0,Et=fr&&fr.offscreen,Mt=fr&&fr.occluded,tt.useRuntimeCollisionCircles){const Zn=E.text.placedSymbolArray.get(tt.centerJustifiedTextSymbolIndex>=0?tt.centerJustifiedTextSymbolIndex:tt.verticalPlacedTextSymbolIndex),Ln=a.evaluateSizeForFeature(E.textSizeData,le,Zn),_n=P.get("text-padding");Xr=this.collisionIndex.placeCollisionCircles(E,me,Zn,E.lineVertexArray,E.glyphOffsetArray,Ln,I,L,H,b,Oe,ce.predicate,tt.collisionCircleDiameter*Ln/a.ONE_EM,_n,this.retainedQueryData[E.bucketInstanceId].tileID),Ye=me||Xr.circles.length>0&&!Xr.collisionDetected,Et=Et&&Xr.offscreen,Mt=Xr.occluded}if(pt.iconFeatureIndex&&(Fn=pt.iconFeatureIndex),pt.iconBox){const Zn=Ln=>{$n(Ln);const _n=De&&Hr?Oh(Hr.x,Hr.y,Pe,Oe,this.transform.angle):new a.pointGeometry(0,0),di=E.getSymbolInstanceIconSize(ue,this.transform.zoom,tt.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(E,di,Ln,_n,be,X,I,ce.predicate)};er&&er.box&&er.box.length&&pt.verticalIconBox?(gr=Zn(pt.verticalIconBox),ct=gr.box.length>0):(gr=Zn(pt.iconBox),ct=gr.box.length>0),Et=Et&&gr.offscreen,ur=gr.occluded}const Vo=te||tt.numHorizontalGlyphVertices===0&&at===0,Ua=ge||tt.numIconVertices===0;if(Vo||Ua?Ua?Vo||(ct=ct&&Ye):Ye=ct&&Ye:ct=Ye=ct&&Ye,Ye&&fr&&fr.box&&this.collisionIndex.insertCollisionBox(fr.box,P.get("text-ignore-placement"),E.bucketInstanceId,er&&er.box&&On?On:En,ce.ID),ct&&gr&&this.collisionIndex.insertCollisionBox(gr.box,P.get("icon-ignore-placement"),E.bucketInstanceId,Fn,ce.ID),Xr&&(Ye&&this.collisionIndex.insertCollisionCircles(Xr.circles,P.get("text-ignore-placement"),E.bucketInstanceId,En,ce.ID),b)){const Zn=E.bucketInstanceId;let Ln=this.collisionCircleArrays[Zn];Ln===void 0&&(Ln=this.collisionCircleArrays[Zn]=new hb);for(let _n=0;_n<Xr.circles.length;_n+=4)Ln.circles.push(Xr.circles[_n+0]),Ln.circles.push(Xr.circles[_n+1]),Ln.circles.push(Xr.circles[_n+2]),Ln.circles.push(Xr.collisionDetected?1:0)}const Ws=E.projection.name!=="globe";ot=ot&&(Ws||!Mt),ut=ut&&(Ws||!ur),this.placements[Ot]=new Vc(Ye||ot,ct||ut,Et||E.justReloaded),m[Ot]=!0};if(Xe){const tt=E.getSortedSymbolIndexes(this.transform.angle);for(let wt=tt.length-1;wt>=0;--wt){const pt=tt[wt];Bt(E.symbolInstances.get(pt),pt,E.collisionArrays[pt])}}else for(let tt=f.symbolInstanceStart;tt<f.symbolInstanceEnd;tt++)Bt(E.symbolInstances.get(tt),tt,E.collisionArrays[tt]);if(b&&E.bucketInstanceId in this.collisionCircleArrays){const tt=this.collisionCircleArrays[E.bucketInstanceId];a.invert(tt.invProjMatrix,I),tt.viewportMatrix=this.collisionIndex.getViewportMatrix()}E.justReloaded=!1}markUsedJustification(f,m,b,x){const{leftJustifiedTextSymbolIndex:E,centerJustifiedTextSymbolIndex:P,rightJustifiedTextSymbolIndex:I,verticalPlacedTextSymbolIndex:L,crossTileID:H}=b,F=a.getAnchorJustification(m),X=x===a.WritingMode.vertical?L:F==="left"?E:F==="center"?P:F==="right"?I:-1;E>=0&&(f.text.placedSymbolArray.get(E).crossTileID=X>=0&&E!==X?0:H),P>=0&&(f.text.placedSymbolArray.get(P).crossTileID=X>=0&&P!==X?0:H),I>=0&&(f.text.placedSymbolArray.get(I).crossTileID=X>=0&&I!==X?0:H),L>=0&&(f.text.placedSymbolArray.get(L).crossTileID=X>=0&&L!==X?0:H)}markUsedOrientation(f,m,b){const x=m===a.WritingMode.horizontal||m===a.WritingMode.horizontalOnly?m:0,E=m===a.WritingMode.vertical?m:0,{leftJustifiedTextSymbolIndex:P,centerJustifiedTextSymbolIndex:I,rightJustifiedTextSymbolIndex:L,verticalPlacedTextSymbolIndex:H}=b,F=f.text.placedSymbolArray;P>=0&&(F.get(P).placedOrientation=x),I>=0&&(F.get(I).placedOrientation=x),L>=0&&(F.get(L).placedOrientation=x),H>=0&&(F.get(H).placedOrientation=E)}commit(f){this.commitTime=f,this.zoomAtLastRecencyCheck=this.transform.zoom;const m=this.prevPlacement;let b=!1;this.prevZoomAdjustment=m?m.zoomAdjustment(this.transform.zoom):0;const x=m?m.symbolFadeChange(f):1,E=m?m.opacities:{},P=m?m.variableOffsets:{},I=m?m.placedOrientations:{};for(const L in this.placements){const H=this.placements[L],F=E[L];F?(this.opacities[L]=new gu(F,x,H.text,H.icon,null,H.clipped),b=b||H.text!==F.text.placed||H.icon!==F.icon.placed):(this.opacities[L]=new gu(null,x,H.text,H.icon,H.skipFade,H.clipped),b=b||H.text||H.icon)}for(const L in E){const H=E[L];if(!this.opacities[L]){const F=new gu(H,x,!1,!1);F.isHidden()||(this.opacities[L]=F,b=b||H.text.placed||H.icon.placed)}}for(const L in P)this.variableOffsets[L]||!this.opacities[L]||this.opacities[L].isHidden()||(this.variableOffsets[L]=P[L]);for(const L in I)this.placedOrientations[L]||!this.opacities[L]||this.opacities[L].isHidden()||(this.placedOrientations[L]=I[L]);b?this.lastPlacementChangeTime=f:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=m?m.lastPlacementChangeTime:f)}updateLayerOpacities(f,m){const b={};for(const x of m){const E=x.getBucket(f);E&&x.latestFeatureIndex&&f.id===E.layerIds[0]&&this.updateBucketOpacities(E,b,x.collisionBoxArray)}}updateBucketOpacities(f,m,b){f.hasTextData()&&f.text.opacityVertexArray.clear(),f.hasIconData()&&f.icon.opacityVertexArray.clear(),f.hasIconCollisionBoxData()&&f.iconCollisionBox.collisionVertexArray.clear(),f.hasTextCollisionBoxData()&&f.textCollisionBox.collisionVertexArray.clear();const x=f.layers[0].layout,E=!!f.layers[0].dynamicFilter(),P=new gu(null,0,!1,!1,!0),I=x.get("text-allow-overlap"),L=x.get("icon-allow-overlap"),H=x.get("text-variable-anchor"),F=x.get("text-rotation-alignment")==="map",X=x.get("text-pitch-alignment")==="map",re=x.get("icon-text-fit")!=="none",oe=new gu(null,0,I&&(L||!f.hasIconData()||x.get("icon-optional")),L&&(I||!f.hasTextData()||x.get("text-optional")),!0);!f.collisionArrays&&b&&(f.hasIconCollisionBoxData()||f.hasTextCollisionBoxData())&&f.deserializeCollisionBoxes(b);const le=(ce,te,ge)=>{for(let me=0;me<te/4;me++)ce.opacityVertexArray.emplaceBack(ge)};let ue=0;for(let ce=0;ce<f.symbolInstances.length;ce++){const te=f.symbolInstances.get(ce),{numHorizontalGlyphVertices:ge,numVerticalGlyphVertices:me,crossTileID:be,numIconVertices:Pe}=te;let Oe=this.opacities[be];m[be]?Oe=P:Oe||(Oe=oe,this.opacities[be]=Oe),m[be]=!0;const De=ge>0||me>0,Xe=Pe>0,ot=this.placedOrientations[be],ut=ot===a.WritingMode.vertical,Bt=ot===a.WritingMode.horizontal||ot===a.WritingMode.horizontalOnly;if(!De&&!Xe||Oe.isHidden()||ue++,De){const tt=um(Oe.text);le(f.text,ge,ut?Uc:tt),le(f.text,me,Bt?Uc:tt);const wt=Oe.text.isHidden(),{leftJustifiedTextSymbolIndex:pt,centerJustifiedTextSymbolIndex:Ot,rightJustifiedTextSymbolIndex:at,verticalPlacedTextSymbolIndex:Ye}=te,ct=f.text.placedSymbolArray,Et=wt||ut?1:0;pt>=0&&(ct.get(pt).hidden=Et),Ot>=0&&(ct.get(Ot).hidden=Et),at>=0&&(ct.get(at).hidden=Et),Ye>=0&&(ct.get(Ye).hidden=wt||Bt?1:0);const Mt=this.variableOffsets[be];Mt&&this.markUsedJustification(f,Mt.anchor,te,ot);const ur=this.placedOrientations[be];ur&&(this.markUsedJustification(f,"left",te,ur),this.markUsedOrientation(f,ur,te))}if(Xe){const tt=um(Oe.icon),{placedIconSymbolIndex:wt,verticalPlacedIconSymbolIndex:pt}=te,Ot=f.icon.placedSymbolArray,at=Oe.icon.isHidden()?1:0;wt>=0&&(le(f.icon,Pe,ut?Uc:tt),Ot.get(wt).hidden=at),pt>=0&&(le(f.icon,te.numVerticalIconVertices,Bt?Uc:tt),Ot.get(pt).hidden=at)}if(f.hasIconCollisionBoxData()||f.hasTextCollisionBoxData()){const tt=f.collisionArrays[ce];if(tt){let wt=new a.pointGeometry(0,0),pt=!0;if(tt.textBox||tt.verticalTextBox){if(H){const at=this.variableOffsets[be];at?(wt=sm(at.anchor,at.width,at.height,at.textOffset,at.textScale),F&&wt._rotate(X?this.transform.angle:-this.transform.angle)):pt=!1}E&&(pt=!Oe.clipped),tt.textBox&&Do(f.textCollisionBox.collisionVertexArray,Oe.text.placed,!pt||ut,wt.x,wt.y),tt.verticalTextBox&&Do(f.textCollisionBox.collisionVertexArray,Oe.text.placed,!pt||Bt,wt.x,wt.y)}const Ot=pt&&!!(!Bt&&tt.verticalIconBox);tt.iconBox&&Do(f.iconCollisionBox.collisionVertexArray,Oe.icon.placed,Ot,re?wt.x:0,re?wt.y:0),tt.verticalIconBox&&Do(f.iconCollisionBox.collisionVertexArray,Oe.icon.placed,!Ot,re?wt.x:0,re?wt.y:0)}}}if(f.fullyClipped=ue===0,f.sortFeatures(this.transform.angle),this.retainedQueryData[f.bucketInstanceId]&&(this.retainedQueryData[f.bucketInstanceId].featureSortOrder=f.featureSortOrder),f.hasTextData()&&f.text.opacityVertexBuffer&&f.text.opacityVertexBuffer.updateData(f.text.opacityVertexArray),f.hasIconData()&&f.icon.opacityVertexBuffer&&f.icon.opacityVertexBuffer.updateData(f.icon.opacityVertexArray),f.hasIconCollisionBoxData()&&f.iconCollisionBox.collisionVertexBuffer&&f.iconCollisionBox.collisionVertexBuffer.updateData(f.iconCollisionBox.collisionVertexArray),f.hasTextCollisionBoxData()&&f.textCollisionBox.collisionVertexBuffer&&f.textCollisionBox.collisionVertexBuffer.updateData(f.textCollisionBox.collisionVertexArray),f.bucketInstanceId in this.collisionCircleArrays){const ce=this.collisionCircleArrays[f.bucketInstanceId];f.placementInvProjMatrix=ce.invProjMatrix,f.placementViewportMatrix=ce.viewportMatrix,f.collisionCircleArray=ce.circles,delete this.collisionCircleArrays[f.bucketInstanceId]}}symbolFadeChange(f){return this.fadeDuration===0?1:(f-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(f){return Math.max(0,(this.transform.zoom-f)/1.5)}hasTransitions(f){return this.stale||f-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(f,m){const b=this.zoomAtLastRecencyCheck===m?1-this.zoomAdjustment(m):1;return this.zoomAtLastRecencyCheck=m,this.commitTime+this.fadeDuration*b>f}setStale(){this.stale=!0}}function Do(v,f,m,b,x){v.emplaceBack(f?1:0,m?1:0,b||0,x||0),v.emplaceBack(f?1:0,m?1:0,b||0,x||0),v.emplaceBack(f?1:0,m?1:0,b||0,x||0),v.emplaceBack(f?1:0,m?1:0,b||0,x||0)}const kC=Math.pow(2,25),lm=Math.pow(2,24),zi=Math.pow(2,17),Rh=Math.pow(2,16),db=Math.pow(2,9),kh=Math.pow(2,8),lo=Math.pow(2,1);function um(v){if(v.opacity===0&&!v.placed)return 0;if(v.opacity===1&&v.placed)return 4294967295;const f=v.placed?1:0,m=Math.floor(127*v.opacity);return m*kC+f*lm+m*zi+f*Rh+m*db+f*kh+m*lo+f}const Uc=0;class Hs{constructor(f){this._sortAcrossTiles=f.layout.get("symbol-z-order")!=="viewport-y"&&f.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(f,m,b,x,E){const P=this._bucketParts;for(;this._currentTileIndex<f.length;)if(m.getBucketParts(P,x,f[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,E())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,P.sort((I,L)=>I.sortKey-L.sortKey));this._currentPartIndex<P.length;){const I=P[this._currentPartIndex];if(m.placeLayerBucketPart(I,this._seenCrossTileIDs,b,I.symbolInstanceStart===0),this._currentPartIndex++,E())return!0}return!1}}class Ph{constructor(f,m,b,x,E,P,I,L){this.placement=new Ho(f,E,P,I,L),this._currentPlacementIndex=m.length-1,this._forceFullPlacement=b,this._showCollisionBoxes=x,this._done=!1}isDone(){return this._done}continuePlacement(f,m,b){const x=a.exported.now(),E=()=>{const P=a.exported.now()-x;return!this._forceFullPlacement&&P>2};for(;this._currentPlacementIndex>=0;){const P=m[f[this._currentPlacementIndex]],I=this.placement.collisionIndex.transform.zoom;if(P.type==="symbol"&&(!P.minzoom||P.minzoom<=I)&&(!P.maxzoom||P.maxzoom>I)){if(this._inProgressLayer||(this._inProgressLayer=new Hs(P)),this._inProgressLayer.continuePlacement(b[P.source],this.placement,this._showCollisionBoxes,P,E))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(f){return this.placement.commit(f),this.placement}}const cm=512/a.EXTENT/2;class fI{constructor(f,m,b){this.tileID=f,this.indexedSymbolInstances={},this.bucketInstanceId=b;for(let x=0;x<m.length;x++){const E=m.get(x),P=E.key;this.indexedSymbolInstances[P]||(this.indexedSymbolInstances[P]=[]),this.indexedSymbolInstances[P].push({crossTileID:E.crossTileID,coord:this.getScaledCoordinates(E,f)})}}getScaledCoordinates(f,m){const b=cm/Math.pow(2,m.canonical.z-this.tileID.canonical.z);return{x:Math.floor((m.canonical.x*a.EXTENT+f.tileAnchorX)*b),y:Math.floor((m.canonical.y*a.EXTENT+f.tileAnchorY)*b)}}findMatches(f,m,b){const x=this.tileID.canonical.z<m.canonical.z?1:Math.pow(2,this.tileID.canonical.z-m.canonical.z);for(let E=0;E<f.length;E++){const P=f.get(E);if(P.crossTileID)continue;const I=this.indexedSymbolInstances[P.key];if(!I)continue;const L=this.getScaledCoordinates(P,m);for(const H of I)if(Math.abs(H.coord.x-L.x)<=x&&Math.abs(H.coord.y-L.y)<=x&&!b[H.crossTileID]){b[H.crossTileID]=!0,P.crossTileID=H.crossTileID;break}}}}class pb{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Wc{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(f){const m=Math.round((f-this.lng)/360);if(m!==0)for(const b in this.indexes){const x=this.indexes[b],E={};for(const P in x){const I=x[P];I.tileID=I.tileID.unwrapTo(I.tileID.wrap+m),E[I.tileID.key]=I}this.indexes[b]=E}this.lng=f}addBucket(f,m,b){if(this.indexes[f.overscaledZ]&&this.indexes[f.overscaledZ][f.key]){if(this.indexes[f.overscaledZ][f.key].bucketInstanceId===m.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(f.overscaledZ,this.indexes[f.overscaledZ][f.key])}for(let E=0;E<m.symbolInstances.length;E++)m.symbolInstances.get(E).crossTileID=0;this.usedCrossTileIDs[f.overscaledZ]||(this.usedCrossTileIDs[f.overscaledZ]={});const x=this.usedCrossTileIDs[f.overscaledZ];for(const E in this.indexes){const P=this.indexes[E];if(Number(E)>f.overscaledZ)for(const I in P){const L=P[I];L.tileID.isChildOf(f)&&L.findMatches(m.symbolInstances,f,x)}else{const I=P[f.scaledTo(Number(E)).key];I&&I.findMatches(m.symbolInstances,f,x)}}for(let E=0;E<m.symbolInstances.length;E++){const P=m.symbolInstances.get(E);P.crossTileID||(P.crossTileID=b.generate(),x[P.crossTileID]=!0)}return this.indexes[f.overscaledZ]===void 0&&(this.indexes[f.overscaledZ]={}),this.indexes[f.overscaledZ][f.key]=new fI(f,m.symbolInstances,m.bucketInstanceId),!0}removeBucketCrossTileIDs(f,m){for(const b in m.indexedSymbolInstances)for(const x of m.indexedSymbolInstances[b])delete this.usedCrossTileIDs[f][x.crossTileID]}removeStaleBuckets(f){let m=!1;for(const b in this.indexes){const x=this.indexes[b];for(const E in x)f[x[E].bucketInstanceId]||(this.removeBucketCrossTileIDs(b,x[E]),delete x[E],m=!0)}return m}}class PC{constructor(){this.layerIndexes={},this.crossTileIDs=new pb,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(f,m,b,x){let E=this.layerIndexes[f.id];E===void 0&&(E=this.layerIndexes[f.id]=new Wc);let P=!1;const I={};x.name!=="globe"&&E.handleWrapJump(b);for(const L of m){const H=L.getBucket(f);H&&f.id===H.layerIds[0]&&(H.bucketInstanceId||(H.bucketInstanceId=++this.maxBucketInstanceId),E.addBucket(L.tileID,H,this.crossTileIDs)&&(P=!0),I[H.bucketInstanceId]=!0)}return E.removeStaleBuckets(I)&&(P=!0),P}pruneUnusedLayers(f){const m={};f.forEach(b=>{m[b]=!0});for(const b in this.layerIndexes)m[b]||delete this.layerIndexes[b]}}const Ah=(v,f)=>a.emitValidationErrors(v,f&&f.filter(m=>m.identifier!=="source.canvas")),Gc=a.pick(or,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection"]),Sl=a.pick(or,["setCenter","setZoom","setBearing","setPitch"]),fm={version:8,layers:[],sources:{}},xl={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0};class xa extends a.Evented{constructor(f,m={}){super(),this.map=f,this.dispatcher=new ye(mt(),this),this.imageManager=new gt,this.imageManager.setEventedParent(this),this.glyphManager=new a.GlyphManager(f._requestManager,m.localFontFamily?a.LocalGlyphMode.all:m.localIdeographFontFamily?a.LocalGlyphMode.ideographs:a.LocalGlyphMode.none,m.localFontFamily||m.localIdeographFontFamily),this.crossTileSymbolIndex=new PC,this._layers={},this._num3DLayers=0,this._numSymbolLayers=0,this._numCircleLayers=0,this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._availableImages=[],this._order=[],this._drapedFirstOrder=[],this._markersNeedUpdate=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",a.getReferrer());const b=this;this._rtlTextPluginCallback=xa.registerForPluginStateChange(x=>{b.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:x.pluginStatus,pluginURL:x.pluginURL},(E,P)=>{if(a.triggerPluginCompletionEvent(E),P&&P.every(I=>I))for(const I in b._sourceCaches){const L=b._sourceCaches[I],H=L.getSource().type;H!=="vector"&&H!=="geojson"||L.reload()}})}),this.on("data",x=>{if(x.dataType!=="source"||x.sourceDataType!=="metadata")return;const E=this.getSource(x.sourceId);if(E&&E.vectorLayerIds)for(const P in this._layers){const I=this._layers[P];I.source===E.id&&this._validateLayer(I)}})}loadURL(f,m={}){this.fire(new a.Event("dataloading",{dataType:"style"}));const b=typeof m.validate=="boolean"?m.validate:!a.isMapboxURL(f);f=this.map._requestManager.normalizeStyleURL(f,m.accessToken);const x=this.map._requestManager.transformRequest(f,a.ResourceType.Style);this._request=a.getJSON(x,(E,P)=>{this._request=null,E?this.fire(new a.ErrorEvent(E)):P&&this._load(P,b)})}loadJSON(f,m={}){this.fire(new a.Event("dataloading",{dataType:"style"})),this._request=a.exported.frame(()=>{this._request=null,this._load(f,m.validate!==!1)})}loadEmpty(){this.fire(new a.Event("dataloading",{dataType:"style"})),this._load(fm,!1)}_updateLayerCount(f,m){const b=m?1:-1;f.is3D()&&(this._num3DLayers+=b),f.type==="circle"&&(this._numCircleLayers+=b),f.type==="symbol"&&(this._numSymbolLayers+=b)}_load(f,m){if(m&&Ah(this,a.validateStyle(f)))return;this._loaded=!0,this.stylesheet=a.clone$1(f),this._updateMapProjection();for(const x in f.sources)this.addSource(x,f.sources[x],{validate:!1});this._changed=!1,f.sprite?this._loadSprite(f.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(f.glyphs);const b=pr(this.stylesheet.layers);this._order=b.map(x=>x.id),this._layers={},this._serializedLayers={};for(const x of b){const E=a.createStyleLayer(x);E.setEventedParent(this,{layer:{id:E.id}}),this._layers[E.id]=E,this._serializedLayers[E.id]=E.serialize(),this._updateLayerCount(E,!0)}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new $e(this.stylesheet.light),this.stylesheet.terrain&&!this.terrainSetForDrapingOnly()&&this._createTerrain(this.stylesheet.terrain,1),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this._updateDrapeFirstLayers(),this.fire(new a.Event("data",{dataType:"style"})),this.fire(new a.Event("style.load"))}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}setProjection(f){f?this.stylesheet.projection=f:delete this.stylesheet.projection,this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null))}_updateMapProjection(){this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.stylesheet.projection)}_loadSprite(f){this._spriteRequest=function(m,b,x){let E,P,I;const L=a.exported.devicePixelRatio>1?"@2x":"";let H=a.getJSON(b.transformRequest(b.normalizeSpriteURL(m,L,".json"),a.ResourceType.SpriteJSON),(re,oe)=>{H=null,I||(I=re,E=oe,X())}),F=a.getImage(b.transformRequest(b.normalizeSpriteURL(m,L,".png"),a.ResourceType.SpriteImage),(re,oe)=>{F=null,I||(I=re,P=oe,X())});function X(){if(I)x(I);else if(E&&P){const re=a.exported.getImageData(P),oe={};for(const le in E){const{width:ue,height:ce,x:te,y:ge,sdf:me,pixelRatio:be,stretchX:Pe,stretchY:Oe,content:De}=E[le],Xe=new a.RGBAImage({width:ue,height:ce});a.RGBAImage.copy(re,Xe,{x:te,y:ge},{x:0,y:0},{width:ue,height:ce}),oe[le]={data:Xe,pixelRatio:be,sdf:me,stretchX:Pe,stretchY:Oe,content:De}}x(null,oe)}}return{cancel(){H&&(H.cancel(),H=null),F&&(F.cancel(),F=null)}}}(f,this.map._requestManager,(m,b)=>{if(this._spriteRequest=null,m)this.fire(new a.ErrorEvent(m));else if(b)for(const x in b)this.imageManager.addImage(x,b[x]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.dispatcher.broadcast("spriteLoaded",!0),this.fire(new a.Event("data",{dataType:"style"}))})}_validateLayer(f){const m=this.getSource(f.source);if(!m)return;const b=f.sourceLayer;b&&(m.type==="geojson"||m.vectorLayerIds&&m.vectorLayerIds.indexOf(b)===-1)&&this.fire(new a.ErrorEvent(new Error(`Source layer "${b}" does not exist on source "${m.id}" as specified by style layer "${f.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const f in this._sourceCaches)if(!this._sourceCaches[f].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(f){const m=[];for(const b of f){const x=this._layers[b];x.type!=="custom"&&m.push(x.serialize())}return m}hasTransitions(){if(this.light&&this.light.hasTransition()||this.fog&&this.fog.hasTransition())return!0;for(const f in this._sourceCaches)if(this._sourceCaches[f].hasTransition())return!0;for(const f in this._layers)if(this._layers[f].hasTransition())return!0;return!1}get order(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}isLayerDraped(f){return!!this.terrain&&(typeof f.isLayerDraped=="function"?f.isLayerDraped():xl[f.type])}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(f){if(!this._loaded)return;const m=this._changed;if(this._changed){const x=Object.keys(this._updatedLayers),E=Object.keys(this._removedLayers);(x.length||E.length)&&this._updateWorkerLayers(x,E);for(const P in this._updatedSources){const I=this._updatedSources[P];I==="reload"?this._reloadSource(P):I==="clear"&&this._clearSource(P)}this._updateTilesForChangedImages();for(const P in this._updatedPaintProps)this._layers[P].updateTransitions(f);this.light.updateTransitions(f),this.fog&&this.fog.updateTransitions(f),this._resetUpdates()}const b={};for(const x in this._sourceCaches){const E=this._sourceCaches[x];b[x]=E.used,E.used=!1}for(const x of this._order){const E=this._layers[x];if(E.recalculate(f,this._availableImages),!E.isHidden(f.zoom)){const I=this._getLayerSourceCache(E);I&&(I.used=!0)}const P=this.map.painter;if(P){const I=E.getProgramIds();if(!I)continue;const L=E.getProgramConfiguration(f.zoom);for(const H of I)P.useProgram(H,L)}}for(const x in b){const E=this._sourceCaches[x];b[x]!==E.used&&E.getSource().fire(new a.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:E.getSource().id}))}this.light.recalculate(f),this.terrain&&this.terrain.recalculate(f),this.fog&&this.fog.recalculate(f),this.z=f.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),m&&this.fire(new a.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const f=Object.keys(this._changedImages);if(f.length){for(const m in this._sourceCaches)this._sourceCaches[m].reloadTilesForDependencies(["icons","patterns"],f);this._changedImages={}}}_updateWorkerLayers(f,m){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(f),removedIds:m})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(f){if(this._checkLoaded(),Ah(this,a.validateStyle(f)))return!1;(f=a.clone$1(f)).layers=pr(f.layers);const m=function(x,E){if(!x)return[{command:or.setStyle,args:[E]}];let P=[];try{if(!h(x.version,E.version))return[{command:or.setStyle,args:[E]}];h(x.center,E.center)||P.push({command:or.setCenter,args:[E.center]}),h(x.zoom,E.zoom)||P.push({command:or.setZoom,args:[E.zoom]}),h(x.bearing,E.bearing)||P.push({command:or.setBearing,args:[E.bearing]}),h(x.pitch,E.pitch)||P.push({command:or.setPitch,args:[E.pitch]}),h(x.sprite,E.sprite)||P.push({command:or.setSprite,args:[E.sprite]}),h(x.glyphs,E.glyphs)||P.push({command:or.setGlyphs,args:[E.glyphs]}),h(x.transition,E.transition)||P.push({command:or.setTransition,args:[E.transition]}),h(x.light,E.light)||P.push({command:or.setLight,args:[E.light]}),h(x.fog,E.fog)||P.push({command:or.setFog,args:[E.fog]}),h(x.projection,E.projection)||P.push({command:or.setProjection,args:[E.projection]});const I={},L=[];(function(X,re,oe,le){let ue;for(ue in re=re||{},X=X||{})X.hasOwnProperty(ue)&&(re.hasOwnProperty(ue)||Lr(ue,oe,le));for(ue in re){if(!re.hasOwnProperty(ue))continue;const ce=re[ue];X.hasOwnProperty(ue)?h(X[ue],ce)||(X[ue].type==="geojson"&&ce.type==="geojson"&&Gn(X,re,ue)?oe.push({command:or.setGeoJSONSourceData,args:[ue,ce.data]}):oa(ue,re,oe,le)):Nr(ue,re,oe)}})(x.sources,E.sources,L,I);const H=[];x.layers&&x.layers.forEach(X=>{X.source&&I[X.source]?P.push({command:or.removeLayer,args:[X.id]}):H.push(X)});let F=x.terrain;F&&I[F.source]&&(P.push({command:or.setTerrain,args:[void 0]}),F=void 0),P=P.concat(L),h(F,E.terrain)||P.push({command:or.setTerrain,args:[E.terrain]}),function(X,re,oe){re=re||[];const le=(X=X||[]).map(Sa),ue=re.map(Sa),ce=X.reduce(bi,{}),te=re.reduce(bi,{}),ge=le.slice(),me=Object.create(null);let be,Pe,Oe,De,Xe,ot,ut;for(be=0,Pe=0;be<le.length;be++)Oe=le[be],te.hasOwnProperty(Oe)?Pe++:(oe.push({command:or.removeLayer,args:[Oe]}),ge.splice(ge.indexOf(Oe,Pe),1));for(be=0,Pe=0;be<ue.length;be++)Oe=ue[ue.length-1-be],ge[ge.length-1-be]!==Oe&&(ce.hasOwnProperty(Oe)?(oe.push({command:or.removeLayer,args:[Oe]}),ge.splice(ge.lastIndexOf(Oe,ge.length-Pe),1)):Pe++,ot=ge[ge.length-be],oe.push({command:or.addLayer,args:[te[Oe],ot]}),ge.splice(ge.length-be,0,Oe),me[Oe]=!0);for(be=0;be<ue.length;be++)if(Oe=ue[be],De=ce[Oe],Xe=te[Oe],!me[Oe]&&!h(De,Xe))if(h(De.source,Xe.source)&&h(De["source-layer"],Xe["source-layer"])&&h(De.type,Xe.type)){for(ut in yt(De.layout,Xe.layout,oe,Oe,null,or.setLayoutProperty),yt(De.paint,Xe.paint,oe,Oe,null,or.setPaintProperty),h(De.filter,Xe.filter)||oe.push({command:or.setFilter,args:[Oe,Xe.filter]}),h(De.minzoom,Xe.minzoom)&&h(De.maxzoom,Xe.maxzoom)||oe.push({command:or.setLayerZoomRange,args:[Oe,Xe.minzoom,Xe.maxzoom]}),De)De.hasOwnProperty(ut)&&ut!=="layout"&&ut!=="paint"&&ut!=="filter"&&ut!=="metadata"&&ut!=="minzoom"&&ut!=="maxzoom"&&(ut.indexOf("paint.")===0?yt(De[ut],Xe[ut],oe,Oe,ut.slice(6),or.setPaintProperty):h(De[ut],Xe[ut])||oe.push({command:or.setLayerProperty,args:[Oe,ut,Xe[ut]]}));for(ut in Xe)Xe.hasOwnProperty(ut)&&!De.hasOwnProperty(ut)&&ut!=="layout"&&ut!=="paint"&&ut!=="filter"&&ut!=="metadata"&&ut!=="minzoom"&&ut!=="maxzoom"&&(ut.indexOf("paint.")===0?yt(De[ut],Xe[ut],oe,Oe,ut.slice(6),or.setPaintProperty):h(De[ut],Xe[ut])||oe.push({command:or.setLayerProperty,args:[Oe,ut,Xe[ut]]}))}else oe.push({command:or.removeLayer,args:[Oe]}),ot=ge[ge.lastIndexOf(Oe)+1],oe.push({command:or.addLayer,args:[Xe,ot]})}(H,E.layers,P)}catch(I){console.warn("Unable to compute style diff:",I),P=[{command:or.setStyle,args:[E]}]}return P}(this.serialize(),f).filter(x=>!(x.command in Sl));if(m.length===0)return!1;const b=m.filter(x=>!(x.command in Gc));if(b.length>0)throw new Error(`Unimplemented: ${b.map(x=>x.command).join(", ")}.`);return m.forEach(x=>{x.command!=="setTransition"&&x.command!=="setProjection"&&this[x.command].apply(this,x.args)}),this.stylesheet=f,this._updateMapProjection(),!0}addImage(f,m){return this.getImage(f)?this.fire(new a.ErrorEvent(new Error("An image with this name already exists."))):(this.imageManager.addImage(f,m),this._afterImageUpdated(f),this)}updateImage(f,m){this.imageManager.updateImage(f,m)}getImage(f){return this.imageManager.getImage(f)}removeImage(f){return this.getImage(f)?(this.imageManager.removeImage(f),this._afterImageUpdated(f),this):this.fire(new a.ErrorEvent(new Error("No image with this name exists.")))}_afterImageUpdated(f){this._availableImages=this.imageManager.listImages(),this._changedImages[f]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new a.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addSource(f,m,b={}){if(this._checkLoaded(),this.getSource(f)!==void 0)throw new Error("There is already a source with this ID");if(!m.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(m).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(m.type)>=0&&this._validate(a.validateSource,`sources.${f}`,m,null,b))return;this.map&&this.map._collectResourceTiming&&(m.collectResourceTiming=!0);const x=Ge(f,m,this.dispatcher,this);x.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(f),source:x.serialize(),sourceId:f}));const E=P=>{const I=(P?"symbol:":"other:")+f,L=this._sourceCaches[I]=new a.SourceCache(I,x,P);(P?this._symbolSourceCaches:this._otherSourceCaches)[f]=L,L.style=this,L.onAdd(this.map)};E(!1),m.type!=="vector"&&m.type!=="geojson"||E(!0),x.onAdd&&x.onAdd(this.map),this._changed=!0}removeSource(f){this._checkLoaded();const m=this.getSource(f);if(!m)throw new Error("There is no source with this ID");for(const x in this._layers)if(this._layers[x].source===f)return this.fire(new a.ErrorEvent(new Error(`Source "${f}" cannot be removed while layer "${x}" is using it.`)));if(this.terrain&&this.terrain.get().source===f)return this.fire(new a.ErrorEvent(new Error(`Source "${f}" cannot be removed while terrain is using it.`)));const b=this._getSourceCaches(f);for(const x of b)delete this._sourceCaches[x.id],delete this._updatedSources[x.id],x.fire(new a.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:x.getSource().id})),x.setEventedParent(null),x.clearTiles();return delete this._otherSourceCaches[f],delete this._symbolSourceCaches[f],m.setEventedParent(null),m.onRemove&&m.onRemove(this.map),this._changed=!0,this}setGeoJSONSourceData(f,m){this._checkLoaded(),this.getSource(f).setData(m),this._changed=!0}getSource(f){const m=this._getSourceCache(f);return m&&m.getSource()}_getSources(){const f=[];for(const m in this._otherSourceCaches){const b=this._getSourceCache(m);b&&f.push(b.getSource())}return f}addLayer(f,m,b={}){this._checkLoaded();const x=f.id;if(this.getLayer(x))return void this.fire(new a.ErrorEvent(new Error(`Layer with id "${x}" already exists on this map`)));let E;if(f.type==="custom"){if(Ah(this,a.validateCustomStyleLayer(f)))return;E=a.createStyleLayer(f)}else{if(typeof f.source=="object"&&(this.addSource(x,f.source),f=a.clone$1(f),f=a.extend(f,{source:x})),this._validate(a.validateLayer,`layers.${x}`,f,{arrayIndex:-1},b))return;E=a.createStyleLayer(f),this._validateLayer(E),E.setEventedParent(this,{layer:{id:x}}),this._serializedLayers[E.id]=E.serialize(),this._updateLayerCount(E,!0)}const P=m?this._order.indexOf(m):this._order.length;if(m&&P===-1)return void this.fire(new a.ErrorEvent(new Error(`Layer with id "${m}" does not exist on this map.`)));this._order.splice(P,0,x),this._layerOrderChanged=!0,this._layers[x]=E;const I=this._getLayerSourceCache(E);if(this._removedLayers[x]&&E.source&&I&&E.type!=="custom"){const L=this._removedLayers[x];delete this._removedLayers[x],L.type!==E.type?this._updatedSources[E.source]="clear":(this._updatedSources[E.source]="reload",I.pause())}this._updateLayer(E),E.onAdd&&E.onAdd(this.map),this._updateDrapeFirstLayers()}moveLayer(f,m){if(this._checkLoaded(),this._changed=!0,!this._layers[f])return void this.fire(new a.ErrorEvent(new Error(`The layer '${f}' does not exist in the map's style and cannot be moved.`)));if(f===m)return;const b=this._order.indexOf(f);this._order.splice(b,1);const x=m?this._order.indexOf(m):this._order.length;m&&x===-1?this.fire(new a.ErrorEvent(new Error(`Layer with id "${m}" does not exist on this map.`))):(this._order.splice(x,0,f),this._layerOrderChanged=!0,this._updateDrapeFirstLayers())}removeLayer(f){this._checkLoaded();const m=this._layers[f];if(!m)return void this.fire(new a.ErrorEvent(new Error(`The layer '${f}' does not exist in the map's style and cannot be removed.`)));m.setEventedParent(null),this._updateLayerCount(m,!1);const b=this._order.indexOf(f);this._order.splice(b,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[f]=m,delete this._layers[f],delete this._serializedLayers[f],delete this._updatedLayers[f],delete this._updatedPaintProps[f],m.onRemove&&m.onRemove(this.map),this._updateDrapeFirstLayers()}getLayer(f){return this._layers[f]}hasLayer(f){return f in this._layers}hasLayerType(f){for(const m in this._layers)if(this._layers[m].type===f)return!0;return!1}setLayerZoomRange(f,m,b){this._checkLoaded();const x=this.getLayer(f);x?x.minzoom===m&&x.maxzoom===b||(m!=null&&(x.minzoom=m),b!=null&&(x.maxzoom=b),this._updateLayer(x)):this.fire(new a.ErrorEvent(new Error(`The layer '${f}' does not exist in the map's style and cannot have zoom extent.`)))}setFilter(f,m,b={}){this._checkLoaded();const x=this.getLayer(f);if(x){if(!h(x.filter,m))return m==null?(x.filter=void 0,void this._updateLayer(x)):void(this._validate(a.validateFilter,`layers.${x.id}.filter`,m,{layerType:x.type},b)||(x.filter=a.clone$1(m),this._updateLayer(x)))}else this.fire(new a.ErrorEvent(new Error(`The layer '${f}' does not exist in the map's style and cannot be filtered.`)))}getFilter(f){const m=this.getLayer(f);return m&&a.clone$1(m.filter)}setLayoutProperty(f,m,b,x={}){this._checkLoaded();const E=this.getLayer(f);E?h(E.getLayoutProperty(m),b)||(E.setLayoutProperty(m,b,x),this._updateLayer(E)):this.fire(new a.ErrorEvent(new Error(`The layer '${f}' does not exist in the map's style and cannot be styled.`)))}getLayoutProperty(f,m){const b=this.getLayer(f);if(b)return b.getLayoutProperty(m);this.fire(new a.ErrorEvent(new Error(`The layer '${f}' does not exist in the map's style.`)))}setPaintProperty(f,m,b,x={}){this._checkLoaded();const E=this.getLayer(f);E?h(E.getPaintProperty(m),b)||(E.setPaintProperty(m,b,x)&&this._updateLayer(E),this._changed=!0,this._updatedPaintProps[f]=!0):this.fire(new a.ErrorEvent(new Error(`The layer '${f}' does not exist in the map's style and cannot be styled.`)))}getPaintProperty(f,m){const b=this.getLayer(f);return b&&b.getPaintProperty(m)}setFeatureState(f,m){this._checkLoaded();const b=f.source,x=f.sourceLayer,E=this.getSource(b);if(!E)return void this.fire(new a.ErrorEvent(new Error(`The source '${b}' does not exist in the map's style.`)));const P=E.type;if(P==="geojson"&&x)return void this.fire(new a.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(P==="vector"&&!x)return void this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));f.id===void 0&&this.fire(new a.ErrorEvent(new Error("The feature id parameter must be provided.")));const I=this._getSourceCaches(b);for(const L of I)L.setFeatureState(x,f.id,m)}removeFeatureState(f,m){this._checkLoaded();const b=f.source,x=this.getSource(b);if(!x)return void this.fire(new a.ErrorEvent(new Error(`The source '${b}' does not exist in the map's style.`)));const E=x.type,P=E==="vector"?f.sourceLayer:void 0;if(E==="vector"&&!P)return void this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));if(m&&typeof f.id!="string"&&typeof f.id!="number")return void this.fire(new a.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));const I=this._getSourceCaches(b);for(const L of I)L.removeFeatureState(P,f.id,m)}getFeatureState(f){this._checkLoaded();const m=f.source,b=f.sourceLayer,x=this.getSource(m);if(x){if(x.type!=="vector"||b)return f.id===void 0&&this.fire(new a.ErrorEvent(new Error("The feature id parameter must be provided."))),this._getSourceCaches(m)[0].getFeatureState(b,f.id);this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new a.ErrorEvent(new Error(`The source '${m}' does not exist in the map's style.`)))}getTransition(){return a.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const f={};for(const m in this._sourceCaches){const b=this._sourceCaches[m].getSource();f[b.id]||(f[b.id]=b.serialize())}return a.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.getTerrain()||void 0,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:f,layers:this._serializeLayers(this._order)},m=>m!==void 0)}_updateLayer(f){this._updatedLayers[f.id]=!0;const m=this._getLayerSourceCache(f);f.source&&!this._updatedSources[f.source]&&m&&m.getSource().type!=="raster"&&(this._updatedSources[f.source]="reload",m.pause()),this._changed=!0,f.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(f){const m=P=>this._layers[P].type==="fill-extrusion",b={},x=[];for(let P=this._order.length-1;P>=0;P--){const I=this._order[P];if(m(I)){b[I]=P;for(const L of f){const H=L[I];if(H)for(const F of H)x.push(F)}}}x.sort((P,I)=>I.intersectionZ-P.intersectionZ);const E=[];for(let P=this._order.length-1;P>=0;P--){const I=this._order[P];if(m(I))for(let L=x.length-1;L>=0;L--){const H=x[L].feature;if(b[H.layer.id]<P)break;E.push(H),x.pop()}else for(const L of f){const H=L[I];if(H)for(const F of H)E.push(F.feature)}}return E}queryRenderedFeatures(f,m,b){m&&m.filter&&this._validate(a.validateFilter,"queryRenderedFeatures.filter",m.filter,null,m);const x={};if(m&&m.layers){if(!Array.isArray(m.layers))return this.fire(new a.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const L of m.layers){const H=this._layers[L];if(!H)return this.fire(new a.ErrorEvent(new Error(`The layer '${L}' does not exist in the map's style and cannot be queried for features.`))),[];x[H.source]=!0}}const E=[];m.availableImages=this._availableImages;const P=m&&m.layers?m.layers.some(L=>{const H=this.getLayer(L);return H&&H.is3D()}):this.has3DLayers(),I=ze.createFromScreenPoints(f,b);for(const L in this._sourceCaches){const H=this._sourceCaches[L].getSource().id;m.layers&&!x[H]||E.push(nt(this._sourceCaches[L],this._layers,this._serializedLayers,I,m,b,P,!!this.map._showQueryGeometry))}return this.placement&&E.push(function(L,H,F,X,re,oe,le){const ue={},ce=oe.queryRenderedSymbols(X),te=[];for(const ge of Object.keys(ce).map(Number))te.push(le[ge]);te.sort(Xt);for(const ge of te){const me=ge.featureIndex.lookupSymbolFeatures(ce[ge.bucketInstanceId],H,ge.bucketIndex,ge.sourceLayerIndex,re.filter,re.layers,re.availableImages,L);for(const be in me){const Pe=ue[be]=ue[be]||[],Oe=me[be];Oe.sort((De,Xe)=>{const ot=ge.featureSortOrder;if(ot){const ut=ot.indexOf(De.featureIndex);return ot.indexOf(Xe.featureIndex)-ut}return Xe.featureIndex-De.featureIndex});for(const De of Oe)Pe.push(De)}}for(const ge in ue)ue[ge].forEach(me=>{const be=me.feature,Pe=F(L[ge]);if(!Pe)return;const Oe=Pe.getFeatureState(be.layer["source-layer"],be.id);be.source=be.layer.source,be.layer["source-layer"]&&(be.sourceLayer=be.layer["source-layer"]),be.state=Oe});return ue}(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),I.screenGeometry,m,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(E)}querySourceFeatures(f,m){m&&m.filter&&this._validate(a.validateFilter,"querySourceFeatures.filter",m.filter,null,m);const b=this._getSourceCaches(f);let x=[];for(const E of b)x=x.concat(Ct(E,m));return x}addSourceType(f,m,b){return xa.getSourceType(f)?b(new Error(`A source type called "${f}" already exists.`)):(xa.setSourceType(f,m),m.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:f,url:m.workerSourceURL},b):b(null,null))}getLight(){return this.light.getLight()}setLight(f,m={}){this._checkLoaded();const b=this.light.getLight();let x=!1;for(const P in f)if(!h(f[P],b[P])){x=!0;break}if(!x)return;const E=this._setTransitionParameters({duration:300,delay:0});this.light.setLight(f,m),this.light.updateTransitions(E)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(f,m=1){if(this._checkLoaded(),!f)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);let b=f;if(m===1){if(typeof b.source=="object"){const x="terrain-dem-src";this.addSource(x,b.source),b=a.clone$1(b),b=a.extend(b,{source:x})}if(this._validate(a.validateTerrain,"terrain",b))return}if(!this.terrain||this.terrain&&m!==this.terrain.drapeRenderMode){if(!b)return;this._createTerrain(b,m)}else{const x=this.terrain,E=x.get();for(const P of Object.keys(a.spec.terrain))!b.hasOwnProperty(P)&&a.spec.terrain[P].default&&(b[P]=a.spec.terrain[P].default);for(const P in b)if(!h(b[P],E[P])){x.set(b),this.stylesheet.terrain=b;const I=this._setTransitionParameters({duration:0});x.updateTransitions(I);break}}this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(f){const m=this.fog=new ne(f,this.map.transform);this.stylesheet.fog=f;const b=this._setTransitionParameters({duration:0});m.updateTransitions(b)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const f of this.map._markers)f._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(f){if(this._checkLoaded(),!f)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const m=this.fog,b=m.get();Object.keys(f).length===0&&m.set(f);for(const x in f)if(!h(f[x],b[x])){m.set(f),this.stylesheet.fog=f;const E=this._setTransitionParameters({duration:0});m.updateTransitions(E);break}}else this._createFog(f);this._markersNeedUpdate=!0}_setTransitionParameters(f){return{now:a.exported.now(),transition:a.extend(f,this.stylesheet.transition)}}_updateDrapeFirstLayers(){if(!this.map._optimizeForTerrain||!this.terrain)return;const f=this._order.filter(b=>this.isLayerDraped(this._layers[b])),m=this._order.filter(b=>!this.isLayerDraped(this._layers[b]));this._drapedFirstOrder=[],this._drapedFirstOrder.push(...f),this._drapedFirstOrder.push(...m)}_createTerrain(f,m){const b=this.terrain=new Gt(f,m);this.stylesheet.terrain=f,this.dispatcher.broadcast("enableTerrain",!this.terrainSetForDrapingOnly()),this._force3DLayerUpdate();const x=this._setTransitionParameters({duration:0});b.updateTransitions(x)}_force3DLayerUpdate(){for(const f in this._layers){const m=this._layers[f];m.type==="fill-extrusion"&&this._updateLayer(m)}}_forceSymbolLayerUpdate(){for(const f in this._layers){const m=this._layers[f];m.type==="symbol"&&this._updateLayer(m)}}_validate(f,m,b,x,E={}){return(!E||E.validate!==!1)&&Ah(this,f.call(a.validateStyle,a.extend({key:m,style:this.serialize(),value:b,styleSpec:a.spec},x)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),a.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const f in this._layers)this._layers[f].setEventedParent(null);for(const f in this._sourceCaches)this._sourceCaches[f].clearTiles(),this._sourceCaches[f].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(f){const m=this._getSourceCaches(f);for(const b of m)b.clearTiles()}_reloadSource(f){const m=this._getSourceCaches(f);for(const b of m)b.resume(),b.reload()}_reloadSources(){for(const f of this._getSources())f.reload&&f.reload()}_updateSources(f){for(const m in this._sourceCaches)this._sourceCaches[m].update(f)}_generateCollisionBoxes(){for(const f in this._sourceCaches){const m=this._sourceCaches[f];m.resume(),m.reload()}}_updatePlacement(f,m,b,x,E=!1){let P=!1,I=!1;const L={};for(const H of this._order){const F=this._layers[H];if(F.type!=="symbol")continue;if(!L[F.source]){const re=this._getLayerSourceCache(F);if(!re)continue;L[F.source]=re.getRenderableIds(!0).map(oe=>re.getTileByID(oe)).sort((oe,le)=>le.tileID.overscaledZ-oe.tileID.overscaledZ||(oe.tileID.isLessThan(le.tileID)?-1:1))}const X=this.crossTileSymbolIndex.addLayer(F,L[F.source],f.center.lng,f.projection);P=P||X}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),E=E||this._layerOrderChanged||b===0,this._layerOrderChanged&&this.fire(new a.Event("neworder")),(E||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(a.exported.now(),f.zoom))&&(this.pauseablePlacement=new Ph(f,this._order,E,m,b,x,this.placement,this.fog&&f.projection.supportsFog?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,L),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(a.exported.now()),I=!0),P&&this.pauseablePlacement.placement.setStale()),I||P)for(const H of this._order){const F=this._layers[H];F.type==="symbol"&&this.placement.updateLayerOpacities(F,L[F.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(a.exported.now())}_releaseSymbolFadeTiles(){for(const f in this._sourceCaches)this._sourceCaches[f].releaseSymbolFadeTiles()}getImages(f,m,b){this.imageManager.getImages(m.icons,b),this._updateTilesForChangedImages();const x=E=>{E&&E.setDependencies(m.tileID.key,m.type,m.icons)};x(this._otherSourceCaches[m.source]),x(this._symbolSourceCaches[m.source])}getGlyphs(f,m,b){this.glyphManager.getGlyphs(m.stacks,b)}getResource(f,m,b){return a.makeRequest(m,b)}_getSourceCache(f){return this._otherSourceCaches[f]}_getLayerSourceCache(f){return f.type==="symbol"?this._symbolSourceCaches[f.source]:this._otherSourceCaches[f.source]}_getSourceCaches(f){const m=[];return this._otherSourceCaches[f]&&m.push(this._otherSourceCaches[f]),this._symbolSourceCaches[f]&&m.push(this._symbolSourceCaches[f]),m}_isSourceCacheLoaded(f){const m=this._getSourceCaches(f);return m.length===0?(this.fire(new a.ErrorEvent(new Error(`There is no source with ID '${f}'`))),!1):m.every(b=>b.loaded())}has3DLayers(){return this._num3DLayers>0}hasSymbolLayers(){return this._numSymbolLayers>0}hasCircleLayers(){return this._numCircleLayers>0}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}xa.getSourceType=function(v){return qe[v]},xa.setSourceType=function(v,f){qe[v]=f},xa.registerForPluginStateChange=a.registerForPluginStateChange;var Ih=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#define EXTENT 8192.0
#define HALF_PI PI/2.0
#define QUARTER_PI PI/4.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0`,AC="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",IC=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)
{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}
#ifdef TERRAIN
#ifdef TERRAIN_DEM_FLOAT_FORMAT
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;
#else
uniform sampler2D u_dem;uniform sampler2D u_dem_prev;
#endif
uniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));
#ifdef TERRAIN_DEM_NEAREST_FILTER
return u_exaggeration*tl;
#endif
float tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(
unpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))
);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
float tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;
#else
vec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);
#endif
return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }
#endif`,hm=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,MC=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump float u_fog_temporal_offset;varying vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`;let mb={},yb={};const Yc=[];vu(Ih,Yc),vu(IC,Yc),vu(hm,Yc),vu(MC,Yc),mb=Cn("",IC),yb=Cn(MC,hm);const DC=Cn(`
#if __VERSION__ >=300
#define varying in
#define gl_FragColor glFragColor
#define texture2D texture
#define textureCube texture
out vec4 glFragColor;
#endif
highp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}`,`
#if __VERSION__ >=300
#define attribute in
#define varying out
#define texture2D texture
#endif
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered.`),dm=Ih,pm=`
#ifdef GL_ES
precision mediump float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`;var gb={background:Cn(`uniform vec4 u_color;uniform float u_opacity;
#ifdef LIGHTING_3D_MODE
varying vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#ifdef LIGHTING_3D_MODE
uniform vec4 u_color;varying vec4 v_color;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting(u_color);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:Cn(`uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos;void main() {vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),circle:Cn(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
gl_FragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:Cn("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Cn(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {gl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:Cn(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:Cn("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:Cn("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}",`attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:Cn("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}",`attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;
#endif
varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),fill:Cn(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutline:Cn(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:Cn(`uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;varying vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;varying vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:Cn(`uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:Cn(`varying vec4 v_color;
#ifdef RENDER_SHADOWS
varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef ZERO_ROOF_RADIUS
varying vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
varying highp vec3 v_normal;
#endif
void main() {
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
vec3 normal=v_normal;
#endif
float z;vec4 color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);color=mix(v_color,v_roof_color,z);
#else
color=v_color;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);color.rgb=color.rgb*shade;
#endif
#ifdef RENDER_SHADOWS
#ifdef ZERO_ROOF_RADIUS
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#endif
color.xyz=shadowed_color_normal(color.xyz,normalize(normal),v_pos_light_view_0,v_pos_light_view_1,v_depth);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec4 v_color;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;
#endif
#ifdef ZERO_ROOF_RADIUS
varying vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
varying highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
v_normal=normal;
#endif
base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele;vec3 pos;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);
#ifdef RENDER_SHADOWS
v_pos_light_view_0=u_light_matrix_0*vec4(pos,1);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1);v_depth=gl_Position.w;
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}v_color=vec4(0.0,0.0,0.0,1.0);
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting(color,NdotL);
#else
v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));
#endif
v_color*=u_opacity;
#ifdef ZERO_ROOF_RADIUS
v_roof_color=vec4(0.0,0.0,0.0,1.0);
#ifdef LIGHTING_3D_MODE
v_roof_color=apply_lighting(color,calculate_NdotL(vec3(0.0,0.0,1.0)));
#else
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));
#endif
v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionPattern:Cn(`uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
varying float v_NdotL;
#endif
varying vec2 v_pos;varying vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,v_NdotL)*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec2 v_pos;varying vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
varying float v_NdotL;
#endif
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_NdotL=NdotL;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif 
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),hillshadePrepare:Cn(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
return texture2D(u_image,coord).a/4.0;
#else
vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;
#endif
}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Cn(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
gl_FragColor=apply_lighting(gl_FragColor);
#endif
#ifdef FOG
gl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:Cn(`uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;varying vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
uniform float u_border_width;uniform vec4 u_border_color;float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist=texture2D(u_dash_image,v_tex).a;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture2D(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
float trimmed=1.0;
#ifdef RENDER_LINE_TRIM_OFFSET
highp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {out_color=vec4(0,0,0,0);trimmed=0.0;}}
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef RENDER_LINE_ALPHA_DISCARD
if (alpha < u_alpha_discard_threshold) {discard;}
#endif
#ifdef RENDER_LINE_BORDER
float edgeBlur=(u_border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);
#ifdef RENDER_LINE_BORDER_AUTO
float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}
#else
out_color.rgb=mix(u_border_color.rgb*u_border_color.a*trimmed,out_color.rgb,smoothAlpha);
#endif
}
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define EXTRUDE_SCALE 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
attribute highp vec4 a_packed;
#endif
#ifdef RENDER_LINE_DASH
attribute float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;varying vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);
#else
v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),linePattern:Cn(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;vec2 pattern_size=vec2(display_size.x/u_tile_units_to_pixels,display_size.y);float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x=mod(v_linesofar/pattern_size.x*aspect,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));vec4 color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
color=apply_lighting(color);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),raster:Cn(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply(out_color,v_fog_pos));
#endif
gl_FragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {float w=1.0+dot(a_texture_pos,u_perspective_transform);gl_Position=u_matrix*vec4(a_pos*w,0,w);v_pos0=a_texture_pos/8192.0;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),symbolIcon:Cn(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;}`),symbolSDF:Cn(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float gamma_scale=gl_Position.w;float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade);}`),symbolTextAndIcon:Cn(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade,is_sdf);}`),terrainRaster:Cn(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#endif
void main() {vec4 color=texture2D(u_image0,v_pos0);
#ifdef RENDER_SHADOWS
color.xyz=shadowed_color(color.xyz,v_pos_light_view_0,v_pos_light_view_1,v_depth);
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#endif
const float wireframeOffset=0.00015;void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;
#ifdef TERRAIN_WIREFRAME
elevation+=wireframeOffset;
#endif
v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);v_depth=gl_Position.w;
#endif
}`),terrainDepth:Cn(`#ifdef GL_ES
precision highp float;
#endif
varying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}`,"uniform mat4 u_matrix;attribute vec2 a_pos;varying float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:Cn(`
varying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,AC),skyboxGradient:Cn(`varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,AC),skyboxCapture:Cn(`
varying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;
#ifdef GL_ES
precision highp float;
#endif
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}`,"attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:Cn(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture2D(u_image0,v_pos0);color=vec4(raster.rgb*antialias,raster.a*antialias);
#else
color=texture2D(u_image0,v_pos0);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;
#ifdef GLOBE_POLES
attribute vec3 a_globe_pos;attribute vec2 a_uv;
#else
attribute vec2 a_pos;
#endif
varying vec2 v_pos0;const float wireframeOffset=1e3;float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(QUARTER_PI+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;
#ifdef GLOBE_POLES
vec3 up_vector=globe_derived_up_vector;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);
#ifdef TERRAIN_WIREFRAME
height+=wireframeOffset;
#endif
globe_pos+=up_vector*height;
#ifndef GLOBE_POLES
globe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;
#endif
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:Cn(`uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec3 u_start_color;uniform vec4 u_color;uniform vec4 u_space_color;uniform vec4 u_high_color;uniform float u_star_intensity;uniform float u_star_size;uniform float u_star_density;uniform float u_horizon_angle;uniform mat4 u_rotation_matrix;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;highp float random(highp vec3 p) {p=fract(p*vec3(23.2342,97.1231,91.2342));p+=dot(p.zxy,p.yxz+123.1234);return fract(p.x*p.y);}float stars(vec3 p,float scale,vec2 offset) {vec2 uv_scale=(u_viewport/u_star_size)*scale;vec3 position=vec3(p.xy*uv_scale+offset*u_viewport,p.z);vec3 q=fract(position)-0.5;vec3 id=floor(position);float random_visibility=step(random(id),u_star_density);float circle=smoothstep(0.5+u_star_intensity,0.5,length(q));return circle*random_visibility;}void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {discard;return;}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(dot(dir,horizon_dir)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;float closest_point_to_center=length(closest_point-u_globe_pos);float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c =mix(color_stop_2,c2,t);float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);vec2 uv=gl_FragCoord.xy/u_viewport-0.5;float aspect_ratio=u_viewport.x/u_viewport.y;vec4 uv_dir=vec4(normalize(vec3(uv.x*aspect_ratio,uv.y,1.0)),1.0);uv_dir=u_rotation_matrix*uv_dir;vec3 n=abs(uv_dir.xyz);vec2 uv_remap=(n.x > n.y && n.x > n.z) ? uv_dir.yz/uv_dir.x:
(n.y > n.x && n.y > n.z) ? uv_dir.zx/uv_dir.y:
uv_dir.xy/uv_dir.z;uv_remap.x/=aspect_ratio;vec3 D=vec3(uv_remap,1.0);highp float star_field=0.0;if (u_star_intensity > 0.0) {star_field+=stars(D,1.2,vec2(0.0,0.0));star_field+=stars(D,1.0,vec2(1.0,0.0));star_field+=stars(D,0.8,vec2(0.0,1.0));star_field+=stars(D,0.6,vec2(1.0,1.0));star_field*=(1.0-pow(t,0.25+(1.0-u_high_color.a)*0.75));c+=star_field*alpha_2;}c=dither(c,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=vec4(c,a);}`,`attribute vec3 a_pos;attribute vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`)};function vu(v,f){const m=v.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let b of m)if(b=b.trim(),b[0]==="#"&&b.includes("if")&&!b.includes("endif")){b=b.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const x=b.split(" ");for(const E of x)f.includes(E)||f.push(E)}}function Cn(v,f){const m=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,b=f.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),x={},E=[...Yc];return vu(v,E),vu(f,E),{fragmentSource:v=v.replace(m,(P,I,L,H,F)=>(x[F]=!0,I==="define"?`
#ifndef HAS_UNIFORM_u_${F}
varying ${L} ${H} ${F};
#else
uniform ${L} ${H} u_${F};
#endif
`:`
#ifdef HAS_UNIFORM_u_${F}
    ${L} ${H} ${F} = u_${F};
#endif
`)),vertexSource:f=f.replace(m,(P,I,L,H,F)=>{const X=H==="float"?"vec2":"vec4",re=F.match(/color/)?"color":X;return x[F]?I==="define"?`
#ifndef HAS_UNIFORM_u_${F}
uniform lowp float u_${F}_t;
attribute ${L} ${X} a_${F};
varying ${L} ${H} ${F};
#else
uniform ${L} ${H} u_${F};
#endif
`:re==="vec4"?`
#ifndef HAS_UNIFORM_u_${F}
    ${F} = a_${F};
#else
    ${L} ${H} ${F} = u_${F};
#endif
`:`
#ifndef HAS_UNIFORM_u_${F}
    ${F} = unpack_mix_${re}(a_${F}, u_${F}_t);
#else
    ${L} ${H} ${F} = u_${F};
#endif
`:I==="define"?`
#ifndef HAS_UNIFORM_u_${F}
uniform lowp float u_${F}_t;
attribute ${L} ${X} a_${F};
#else
uniform ${L} ${H} u_${F};
#endif
`:re==="vec4"?`
#ifndef HAS_UNIFORM_u_${F}
    ${L} ${H} ${F} = a_${F};
#else
    ${L} ${H} ${F} = u_${F};
#endif
`:`
#ifndef HAS_UNIFORM_u_${F}
    ${L} ${H} ${F} = unpack_mix_${re}(a_${F}, u_${F}_t);
#else
    ${L} ${H} ${F} = u_${F};
#endif
`}),staticAttributes:b,usedDefines:E}}class Mh{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(f,m,b,x,E,P,I){this.context=f;let L=this.boundPaintVertexBuffers.length!==x.length;for(let F=0;!L&&F<x.length;F++)this.boundPaintVertexBuffers[F]!==x[F]&&(L=!0);let H=this.boundDynamicVertexBuffers.length!==I.length;for(let F=0;!H&&F<I.length;F++)this.boundDynamicVertexBuffers[F]!==I[F]&&(H=!0);if(!f.extVertexArrayObject||!this.vao||this.boundProgram!==m||this.boundLayoutVertexBuffer!==b||L||H||this.boundIndexBuffer!==E||this.boundVertexOffset!==P)this.freshBind(m,b,x,E,P,I);else{f.bindVertexArrayOES.set(this.vao);for(const F of I)F&&F.bind();E&&E.dynamicDraw&&E.bind()}}freshBind(f,m,b,x,E,P){let I;const L=f.numAttributes,H=this.context,F=H.gl;if(H.extVertexArrayObject)this.vao&&this.destroy(),this.vao=H.extVertexArrayObject.createVertexArrayOES(),H.bindVertexArrayOES.set(this.vao),I=0,this.boundProgram=f,this.boundLayoutVertexBuffer=m,this.boundPaintVertexBuffers=b,this.boundIndexBuffer=x,this.boundVertexOffset=E,this.boundDynamicVertexBuffers=P;else{I=H.currentNumAttributes||0;for(let X=L;X<I;X++)F.disableVertexAttribArray(X)}m.enableAttributes(F,f),m.bind(),m.setVertexAttribPointers(F,f,E);for(const X of b)X.enableAttributes(F,f),X.bind(),X.setVertexAttribPointers(F,f,E);for(const X of P)X&&(X.enableAttributes(F,f),X.bind(),X.setVertexAttribPointers(F,f,E));x&&x.bind(),H.currentNumAttributes=L}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function vb(v,f){const m=Math.pow(2,f.canonical.z),b=f.canonical.y;return[new a.MercatorCoordinate(0,b/m).toLngLat().lat,new a.MercatorCoordinate(0,(b+1)/m).toLngLat().lat]}function Dh(v,f,m,b,x,E,P){const I=v.context,L=I.gl,H=m.fbo;if(!H)return;v.prepareDrawTile();const F=v.useProgram("hillshade");I.activeTexture.set(L.TEXTURE0),L.bindTexture(L.TEXTURE_2D,H.colorAttachment.get());const X=((ue,ce,te,ge)=>{const me=te.paint.get("hillshade-shadow-color"),be=te.paint.get("hillshade-highlight-color"),Pe=te.paint.get("hillshade-accent-color");let Oe=te.paint.get("hillshade-illumination-direction")*(Math.PI/180);te.paint.get("hillshade-illumination-anchor")==="viewport"&&(Oe-=ue.transform.angle);const De=!ue.options.moving;return{u_matrix:ge||ue.transform.calculateProjMatrix(ce.tileID.toUnwrapped(),De),u_image:0,u_latrange:vb(0,ce.tileID),u_light:[te.paint.get("hillshade-exaggeration"),Oe],u_shadow:me,u_highlight:be,u_accent:Pe}})(v,m,b,v.terrain?f.projMatrix:null);v.prepareDrawProgram(I,F,f.toUnwrapped());const{tileBoundsBuffer:re,tileBoundsIndexBuffer:oe,tileBoundsSegments:le}=v.getTileBoundsBuffers(m);F.draw(I,L.TRIANGLES,x,E,P,a.CullFaceMode.disabled,X,b.id,re,oe,le)}function $h(v,f,m){if(!f.needsDEMTextureUpload)return;const b=v.context,x=b.gl;b.pixelStoreUnpackPremultiplyAlpha.set(!1),f.demTexture=f.demTexture||v.getTileTexture(m.stride);const E=m.getPixels();f.demTexture?f.demTexture.update(E,{premultiply:!1}):f.demTexture=new a.Texture(b,E,x.RGBA,{premultiply:!1}),f.needsDEMTextureUpload=!1}function mm(v,f,m,b,x,E){const P=v.context,I=P.gl;if(!f.dem)return;const L=f.dem;if(P.activeTexture.set(I.TEXTURE1),$h(v,f,L),!f.demTexture)return;f.demTexture.bind(I.NEAREST,I.CLAMP_TO_EDGE);const H=L.dim;P.activeTexture.set(I.TEXTURE0);let F=f.fbo;if(!F){const le=new a.Texture(P,{width:H,height:H,data:null},I.RGBA);le.bind(I.LINEAR,I.CLAMP_TO_EDGE),F=f.fbo=P.createFramebuffer(H,H,!0),F.colorAttachment.set(le.texture)}P.bindFramebuffer.set(F.framebuffer),P.viewport.set([0,0,H,H]);const{tileBoundsBuffer:X,tileBoundsIndexBuffer:re,tileBoundsSegments:oe}=v.getMercatorTileBoundsBuffers();v.useProgram("hillshadePrepare").draw(P,I.TRIANGLES,b,x,E,a.CullFaceMode.disabled,((le,ue)=>{const ce=ue.stride,te=a.create();return a.ortho(te,0,a.EXTENT,-a.EXTENT,0,0,1),a.translate(te,te,[0,-a.EXTENT,0]),{u_matrix:te,u_image:1,u_dimension:[ce,ce],u_zoom:le.overscaledZ,u_unpack:ue.unpackVector}})(f.tileID,L),m.id,X,re,oe),f.needsHillshadePrepare=!1}const ym=v=>({u_matrix:new a.UniformMatrix4f(v),u_image0:new a.Uniform1i(v),u_skirt_height:new a.Uniform1f(v)}),_b=(v,f)=>({u_matrix:v,u_image0:0,u_skirt_height:f}),gm=(v,f,m,b,x,E,P,I,L,H,F,X,re,oe,le)=>({u_proj_matrix:Float32Array.from(v),u_globe_matrix:f,u_normalize_matrix:Float32Array.from(b),u_merc_matrix:m,u_zoom_transition:x,u_merc_center:E,u_image0:0,u_frustum_tl:P,u_frustum_tr:I,u_frustum_br:L,u_frustum_bl:H,u_globe_pos:F,u_globe_radius:X,u_viewport:re,u_grid_matrix:le?Float32Array.from(le):new Float32Array(9),u_skirt_height:oe});function bb(v,f){return v!=null&&f!=null&&!(!v.hasData()||!f.hasData())&&v.demTexture!=null&&f.demTexture!=null&&v.tileID.key!==f.tileID.key}const Cl=new class{constructor(){this.operations={}}newMorphing(v,f,m,b,x){if(v in this.operations){const E=this.operations[v];E.to.tileID.key!==m.tileID.key&&(E.queued=m)}else this.operations[v]={startTime:b,phase:0,duration:x,from:f,to:m,queued:null}}getMorphValuesForProxy(v){if(!(v in this.operations))return null;const f=this.operations[v];return{from:f.from,to:f.to,phase:f.phase}}update(v){for(const f in this.operations){const m=this.operations[f];for(m.phase=(v-m.startTime)/m.duration;m.phase>=1||!this._validOp(m);)if(!this._nextOp(m,v)){delete this.operations[f];break}}}_nextOp(v,f){return!!v.queued&&(v.from=v.to,v.to=v.queued,v.queued=null,v.phase=0,v.startTime=f,!0)}_validOp(v){return v.from.hasData()&&v.to.hasData()}},_u={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function vm(v){return 6*Math.pow(1.5,22-v)}function wb(v,f){const m=1<<v.z;return!f&&(v.x===0||v.x===m-1)||v.y===0||v.y===m-1}const mn=v=>({u_matrix:v});function Lh(v,f,m,b,x){if(x>0){const E=a.exported.now(),P=(E-v.timeAdded)/x,I=f?(E-f.timeAdded)/x:-1,L=m.getSource(),H=b.coveringZoomLevel({tileSize:L.tileSize,roundZoom:L.roundZoom}),F=!f||Math.abs(f.tileID.overscaledZ-H)>Math.abs(v.tileID.overscaledZ-H),X=F&&v.refreshedUponExpiration?1:a.clamp(F?P:1-I,0,1);return v.refreshedUponExpiration&&P>=1&&(v.refreshedUponExpiration=!1),f?{opacity:1,mix:1-X}:{opacity:X,mix:0}}return{opacity:1,mix:0}}class $C extends a.SourceCache{constructor(f){const m={type:"raster-dem",maxzoom:f.transform.maxZoom},b=new ye(mt(),null),x=Ge("mock-dem",m,b,f.style);super("mock-dem",x,!1),x.setEventedParent(this),this._sourceLoaded=!0}_loadTile(f,m){f.state="loaded",m(null)}}class LC extends a.SourceCache{constructor(f){const m=Ge("proxy",{type:"geojson",maxzoom:f.transform.maxZoom},new ye(mt(),null),f.style);super("proxy",m,!1),m.setEventedParent(this),this.map=this.getSource().map=f,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(f,m,b){if(f.freezeTileCoverage)return;this.transform=f;const x=f.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((E,P)=>{if(E[P.key]="",!this._tiles[P.key]){const I=new a.Tile(P,this._source.tileSize*P.overscaleFactor(),f.tileZoom);I.state="loaded",this._tiles[P.key]=I}return E},{});for(const E in this._tiles)E in x||(this.freeFBO(E),this._tiles[E].unloadVectorData(),delete this._tiles[E])}freeFBO(f){const m=this.proxyCachedFBO[f];if(m!==void 0){const b=Object.values(m);this.renderCachePool.push(...b),delete this.proxyCachedFBO[f]}}deallocRenderCache(){this.renderCache.forEach(f=>f.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class Sb extends a.OverscaledTileID{constructor(f,m,b){super(f.overscaledZ,f.wrap,f.canonical.z,f.canonical.x,f.canonical.y),this.proxyTileKey=m,this.projMatrix=b}}class xb extends a.Elevation{constructor(f,m){super(),this.painter=f,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[b,x,E]=function(L){const H=new a.StructArrayLayout2i4,F=new a.StructArrayLayout3ui6,X=131;H.reserve(17161),F.reserve(33800);const re=a.EXTENT/128,oe=a.EXTENT+re/2,le=oe+re;for(let ce=-re;ce<le;ce+=re)for(let te=-re;te<le;te+=re){const ge=te<0||te>oe||ce<0||ce>oe?24575:0,me=a.clamp(Math.round(te),0,a.EXTENT),be=a.clamp(Math.round(ce),0,a.EXTENT);H.emplaceBack(me+ge,be)}const ue=(ce,te)=>{const ge=te*X+ce;F.emplaceBack(ge+1,ge,ge+X),F.emplaceBack(ge+X,ge+X+1,ge+1)};for(let ce=1;ce<129;ce++)for(let te=1;te<129;te++)ue(te,ce);return[0,129].forEach(ce=>{for(let te=0;te<130;te++)ue(te,ce),ue(ce,te)}),[H,F,32768]}(),P=f.context;this.gridBuffer=P.createVertexBuffer(b,a.posAttributes.members),this.gridIndexBuffer=P.createIndexBuffer(x),this.gridSegments=a.SegmentVector.simpleSegment(0,0,b.length,x.length),this.gridNoSkirtSegments=a.SegmentVector.simpleSegment(0,0,b.length,E),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new LC(m.map),this.orthoMatrix=a.create(),a.ortho(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,a.EXTENT,0,a.EXTENT,0,1);const I=P.gl;this._overlapStencilMode=new a.StencilMode({func:I.GEQUAL,mask:255},0,255,I.KEEP,I.KEEP,I.REPLACE),this._previousZoom=f.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=m,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new $C(m.map)}set style(f){f.on("data",this._onStyleDataEvent.bind(this)),f.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=f,this._checkRenderCacheEfficiency(),this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(f,m,b){if(f&&f.terrain){this._style!==f&&(this.style=f),this.enabled=!0;const x=f.terrain.properties;this.sourceCache=f.terrain.drapeRenderMode===0?this._mockSourceCache:f._getSourceCache(x.get("source")),this._exaggeration=x.get("exaggeration");const E=()=>{this.sourceCache.used&&a.warnOnce(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const P=this.getScaledDemTileSize();this.sourceCache.update(m,P,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,E(),this._initializing=!0),E(),m.updateElevation(!0,b),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(m),this._emptyDEMTextureDirty=!0}else this._disable()}resetTileLookupCache(f){this._findCoveringTileCache[f]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_checkRenderCacheEfficiency(){const f=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||f.efficiency!==100&&a.warnOnce(`Terrain render cache efficiency is not optimal (${f.efficiency}%) and performance
                may be affected negatively, consider placing all background, fill and line layers before layer
                with id '${f.firstUndrapedLayer}' or create a map using optimizeForTerrain: true option.`)}_onStyleDataEvent(f){f.coord&&f.dataType==="source"?this._clearRenderCacheForTile(f.sourceCacheId,f.coord):f.dataType==="style"&&(this._invalidateRenderCache=!0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const f in this._style._sourceCaches)this._style._sourceCaches[f].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(f=>f.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0)}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const f=2*this.proxySourceCache.getSource().tileSize;return[f,f]}set useVertexMorphing(f){this._useVertexMorphing=f}updateTileBinding(f){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const m=this.proxySourceCache,b=this.painter.transform;this._initializing&&(this._initializing=b._centerAltitude===0&&this.getAtPointOrZero(a.MercatorCoordinate.fromLngLat(b.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const x=this.proxyCoords=m.getIds().map(L=>{const H=m.getTileByID(L).tileID;return H.projMatrix=b.calculateProjMatrix(H.toUnwrapped()),H});(function(L,H){const F=H.transform.pointCoordinate(H.transform.getCameraPoint()),X=new a.pointGeometry(F.x,F.y);L.sort((re,oe)=>{if(oe.overscaledZ-re.overscaledZ)return oe.overscaledZ-re.overscaledZ;const le=new a.pointGeometry(re.canonical.x+(1<<re.canonical.z)*re.wrap,re.canonical.y),ue=new a.pointGeometry(oe.canonical.x+(1<<oe.canonical.z)*oe.wrap,oe.canonical.y),ce=X.mult(1<<re.canonical.z);return ce.x-=.5,ce.y-=.5,ce.distSqr(le)-ce.distSqr(ue)})})(x,this.painter),this._previousZoom=b.zoom;const E=this.proxyToSource||{};this.proxyToSource={},x.forEach(L=>{this.proxyToSource[L.key]={}}),this.terrainTileForTile={};const P=this._style._sourceCaches;for(const L in P){const H=P[L];if(!H.used||(H!==this.sourceCache&&this.resetTileLookupCache(H.id),this._setupProxiedCoordsForOrtho(H,f[L],E),H.usedForTerrain))continue;const F=f[L];H.getSource().reparseOverscaled&&this._assignTerrainTiles(F)}this.proxiedCoords[m.id]=x.map(L=>new Sb(L,L.key,this.orthoMatrix)),this._assignTerrainTiles(x),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(E),this.renderingToTexture=!1,this._updateTimestamp=a.exported.now();const I={};this._visibleDemTiles=[];for(const L of this.proxyCoords){const H=this.terrainTileForTile[L.key];if(!H)continue;const F=H.tileID.key;F in I||(this._visibleDemTiles.push(H),I[F]=F)}}_assignTerrainTiles(f){this._initializing||f.forEach(m=>{if(this.terrainTileForTile[m.key])return;const b=this._findTileCoveringTileID(m,this.sourceCache);b&&(this.terrainTileForTile[m.key]=b)})}_prepareDEMTextures(){const f=this.painter.context,m=f.gl;for(const b in this.terrainTileForTile){const x=this.terrainTileForTile[b],E=x.dem;!E||x.demTexture&&!x.needsDEMTextureUpload||(f.activeTexture.set(m.TEXTURE1),$h(this.painter,x,E))}}_prepareDemTileUniforms(f,m,b,x){if(!m||m.demTexture==null)return!1;const E=f.tileID.canonical,P=Math.pow(2,m.tileID.canonical.z-E.z),I=x||"";return b[`u_dem_tl${I}`]=[E.x*P%1,E.y*P%1],b[`u_dem_scale${I}`]=P,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const f=this.painter.context,m=f.gl;if(!this._emptyDepthBufferTexture){const b=new a.RGBAImage({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new a.Texture(f,b,m.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let f=0;const m=this._visibleDemTiles.reduce((b,x)=>{if(!x.dem)return b;const E=x.dem.tree.minimums[0];return E>0&&f++,b+E},0);return f?m/f:0}_updateEmptyDEMTexture(){const f=this.painter.context,m=f.gl;f.activeTexture.set(m.TEXTURE2);const b=this._getLoadedAreaMinimum(),x=new a.RGBAImage({width:1,height:1},new Uint8Array(a.DEMData.pack(b,this.sourceCache.getSource().encoding)));this._emptyDEMTextureDirty=!1;let E=this._emptyDEMTexture;return E?E.update(x,{premultiply:!1}):E=this._emptyDEMTexture=new a.Texture(f,x,m.RGBA,{premultiply:!1}),E}setupElevationDraw(f,m,b){const x=this.painter.context,E=x.gl,P=(I=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:a.DEMData.getUnpackVector(I),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0});var I;P.u_dem_size=this.sourceCache.getSource().tileSize,P.u_exaggeration=this.exaggeration();let L=null,H=null,F=1;if(b&&b.morphing&&this._useVertexMorphing){const X=b.morphing.srcDemTile,re=b.morphing.dstDemTile;F=b.morphing.phase,X&&re&&(this._prepareDemTileUniforms(f,X,P,"_prev")&&(H=X),this._prepareDemTileUniforms(f,re,P)&&(L=re))}if(H&&L?(x.activeTexture.set(E.TEXTURE2),L.demTexture.bind(E.NEAREST,E.CLAMP_TO_EDGE,E.NEAREST),x.activeTexture.set(E.TEXTURE4),H.demTexture.bind(E.NEAREST,E.CLAMP_TO_EDGE,E.NEAREST),P.u_dem_lerp=F):(L=this.terrainTileForTile[f.tileID.key],x.activeTexture.set(E.TEXTURE2),(this._prepareDemTileUniforms(f,L,P)?L.demTexture:this.emptyDEMTexture).bind(E.NEAREST,E.CLAMP_TO_EDGE)),x.activeTexture.set(E.TEXTURE3),b&&b.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(E.NEAREST,E.CLAMP_TO_EDGE),this._depthFBO&&(P.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(E.NEAREST,E.CLAMP_TO_EDGE),P.u_depth_size_inv=[1,1]),b&&b.useMeterToDem&&L){const X=(1<<L.tileID.canonical.z)*a.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;P.u_meter_to_dem=X}if(b&&b.labelPlaneMatrixInv&&(P.u_label_plane_matrix_inv=b.labelPlaneMatrixInv),m.setTerrainUniformValues(x,P),this.painter.transform.projection.name==="globe"){const X=this.globeUniformValues(this.painter.transform,f.tileID.canonical,b&&b.useDenormalizedUpVectorScale);m.setGlobeUniformValues(x,X)}}globeUniformValues(f,m,b){const x=f.projection;return{u_tile_tl_up:x.upVector(m,0,0),u_tile_tr_up:x.upVector(m,a.EXTENT,0),u_tile_br_up:x.upVector(m,a.EXTENT,a.EXTENT),u_tile_bl_up:x.upVector(m,0,a.EXTENT),u_tile_up_scale:b?a.globeMetersToEcef(1):x.upVectorScale(m,f.center.lat,f.worldSize).metersToTile}}renderToBackBuffer(f){const m=this.painter,b=this.painter.context;f.length!==0&&(b.bindFramebuffer.set(null),b.viewport.set([0,0,m.width,m.height]),m.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(x,E,P,I,L){if(x.transform.projection.name==="globe")(function(H,F,X,re,oe){const le=H.context,ue=le.gl;let ce,te;const ge=H.options.showTerrainWireframe?2:0,me=H.transform,be=a.globeUseCustomAntiAliasing(H,le,me),Pe=(Ot,at)=>{if(te===Ot)return;const Ye=[_u[Ot],"PROJECTION_GLOBE_VIEW"];be&&Ye.push("CUSTOM_ANTIALIASING"),at&&Ye.push(_u[ge]),ce=H.useProgram("globeRaster",null,Ye),te=Ot},Oe=H.colorModeForRenderPass(),De=new a.DepthMode(ue.LEQUAL,a.DepthMode.ReadWrite,H.depthRangeFor3D);Cl.update(oe);const Xe=a.calculateGlobeMercatorMatrix(me),ot=[a.mercatorXfromLng(me.center.lng),a.mercatorYfromLat(me.center.lat)],ut=ge?[!1,!0]:[!1],Bt=H.globeSharedBuffers,tt=[me.width*a.exported.devicePixelRatio,me.height*a.exported.devicePixelRatio],wt=Float32Array.from(me.globeMatrix),pt={useDenormalizedUpVectorScale:!0};if(ut.forEach(Ot=>{const at=H.transform,Ye=vm(at.zoom)*F.exaggeration();te=-1;const ct=Ot?ue.LINES:ue.TRIANGLES;for(const Et of re){const Mt=X.getTile(Et),ur=a.StencilMode.disabled,Hr=F.prevTerrainTileForTile[Et.key],rr=F.terrainTileForTile[Et.key];bb(Hr,rr)&&Cl.newMorphing(Et.key,Hr,rr,oe,250),le.activeTexture.set(ue.TEXTURE0),Mt.texture.bind(ue.LINEAR,ue.CLAMP_TO_EDGE);const er=Cl.getMorphValuesForProxy(Et.key),fr=er?1:0;er&&a.extend$1(pt,{morphing:{srcDemTile:er.from,dstDemTile:er.to,phase:a.easeCubicInOut(er.phase)}});const Xr=a.tileCornersToBounds(Et.canonical),gr=a.getLatitudinalLod(Xr.getCenter().lat),En=a.getGridMatrix(Et.canonical,Xr,gr,at.worldSize/at._pixelsPerMercatorPixel),On=a.globeNormalizeECEF(a.globeTileBounds(Et.canonical)),Fn=gm(at.projMatrix,wt,Xe,On,a.globeToMercatorTransition(at.zoom),ot,at.frustumCorners.TL,at.frustumCorners.TR,at.frustumCorners.BR,at.frustumCorners.BL,at.globeCenterInViewSpace,at.globeRadius,tt,Ye,En);if(Pe(fr,Ot),F.setupElevationDraw(Mt,ce,pt),H.prepareDrawProgram(le,ce,Et.toUnwrapped()),Bt){const[$n,Ti,Vo]=Ot?Bt.getWirefameBuffers(H.context,gr):Bt.getGridBuffers(gr,Ye!==0);ce.draw(le,ct,De,ur,Oe,a.CullFaceMode.backCCW,Fn,"globe_raster",$n,Ti,Vo)}}}),Bt){const Ot=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];be&&Ot.push("CUSTOM_ANTIALIASING"),ce=H.useProgram("globeRaster",null,Ot);for(const at of re){const{x:Ye,y:ct,z:Et}=at.canonical,Mt=ct===0,ur=ct===(1<<Et)-1,[Hr,rr,er,fr]=Bt.getPoleBuffers(Et);if(fr&&(Mt||ur)){const Xr=X.getTile(at);le.activeTexture.set(ue.TEXTURE0),Xr.texture.bind(ue.LINEAR,ue.CLAMP_TO_EDGE);let gr=a.globePoleMatrixForTile(Et,Ye,me);const En=a.globeNormalizeECEF(a.globeTileBounds(at.canonical)),On=(Fn,$n)=>Fn.draw(le,ue.TRIANGLES,De,a.StencilMode.disabled,Oe,a.CullFaceMode.disabled,gm(me.projMatrix,gr,gr,En,0,ot,me.frustumCorners.TL,me.frustumCorners.TR,me.frustumCorners.BR,me.frustumCorners.BL,me.globeCenterInViewSpace,me.globeRadius,tt,0),"globe_pole_raster",$n,er,fr);F.setupElevationDraw(Xr,ce,pt),H.prepareDrawProgram(le,ce,at.toUnwrapped()),Mt&&On(ce,Hr),ur&&(gr=a.scale(a.create(),gr,[1,-1,1]),On(ce,rr))}}}})(x,E,P,I,L);else{const H=x.context,F=H.gl;let X,re;const oe=x.options.showTerrainWireframe?2:0,le=(me,be)=>{if(re===me)return;const Pe=[_u[me]];be&&Pe.push(_u[oe]),X=x.useProgram("terrainRaster",null,Pe),re=me},ue=x.colorModeForRenderPass(),ce=new a.DepthMode(F.LEQUAL,a.DepthMode.ReadWrite,x.depthRangeFor3D);Cl.update(L);const te=x.transform,ge=vm(te.zoom)*E.exaggeration();(oe?[!1,!0]:[!1]).forEach(me=>{re=-1;const be=me?F.LINES:F.TRIANGLES,[Pe,Oe]=me?E.getWirefameBuffer():[E.gridIndexBuffer,E.gridSegments];for(const De of I){const Xe=P.getTile(De),ot=a.StencilMode.disabled,ut=E.prevTerrainTileForTile[De.key],Bt=E.terrainTileForTile[De.key];bb(ut,Bt)&&Cl.newMorphing(De.key,ut,Bt,L,250),H.activeTexture.set(F.TEXTURE0),Xe.texture.bind(F.LINEAR,F.CLAMP_TO_EDGE,F.LINEAR_MIPMAP_NEAREST);const tt=Cl.getMorphValuesForProxy(De.key),wt=tt?1:0;let pt;tt&&(pt={morphing:{srcDemTile:tt.from,dstDemTile:tt.to,phase:a.easeCubicInOut(tt.phase)}});const Ot=_b(De.projMatrix,wb(De.canonical,te.renderWorldCopies)?ge/10:ge);le(wt,me),E.setupElevationDraw(Xe,X,pt),x.prepareDrawProgram(H,X,De.toUnwrapped()),X.draw(H,be,ce,ot,ue,a.CullFaceMode.backCCW,Ot,"terrain_raster",E.gridBuffer,Pe,Oe)}})}}(m,this,this.proxySourceCache,f,this._updateTimestamp),this.renderingToTexture=!0,m.gpuTimingDeferredRenderEnd(),f.splice(0,f.length))}renderBatch(f){if(this._drapedRenderBatches.length===0)return f+1;this.renderingToTexture=!0;const m=this.painter,b=this.painter.context,x=this.proxySourceCache,E=this.proxiedCoords[x.id],P=this._drapedRenderBatches.shift(),I=[],L=m.style.order;let H=0;for(const F of E){const X=x.getTileByID(F.proxyTileKey),re=x.proxyCachedFBO[F.key]?x.proxyCachedFBO[F.key][f]:void 0,oe=re!==void 0?x.renderCache[re]:this.pool[H++],le=re!==void 0;if(X.texture=oe.tex,le&&!oe.dirty){I.push(X.tileID);continue}let ue;b.bindFramebuffer.set(oe.fb.framebuffer),this.renderedToTile=!1,oe.dirty&&(b.clear({color:a.Color.transparent,stencil:0}),oe.dirty=!1);for(let ce=P.start;ce<=P.end;++ce){const te=m.style._layers[L[ce]];if(te.isHidden(m.transform.zoom))continue;const ge=m.style._getLayerSourceCache(te),me=ge?this.proxyToSource[F.key][ge.id]:[F];if(!me)continue;const be=me;b.viewport.set([0,0,oe.fb.width,oe.fb.height]),ue!==(ge?ge.id:null)&&(this._setupStencil(oe,me,te,ge),ue=ge?ge.id:null),m.renderLayer(m,ge,te,be)}this.renderedToTile?(oe.dirty=!0,I.push(X.tileID)):le||--H,H===5&&(H=0,this.renderToBackBuffer(I))}return this.renderToBackBuffer(I),this.renderingToTexture=!1,b.bindFramebuffer.set(null),b.viewport.set([0,0,m.width,m.height]),P.end+1}postRender(){}renderCacheEfficiency(f){const m=f.order.length;if(m===0)return{efficiency:100};let b,x=0,E=0,P=!1;for(let I=0;I<m;++I){const L=f._layers[f.order[I]];this._style.isLayerDraped(L)?(P&&++x,++E):P||(P=!0,b=L.id)}return E===0?{efficiency:100}:{efficiency:100*(1-x/E),firstUndrapedLayer:b}}getMinElevationBelowMSL(){let f=0;return this._visibleDemTiles.filter(m=>m.dem).forEach(m=>{f=Math.min(f,m.dem.tree.minimums[0])}),f===0?f:(f-30)*this._exaggeration}raycast(f,m,b){if(!this._visibleDemTiles)return null;const x=this._visibleDemTiles.filter(E=>E.dem).map(E=>{const P=E.tileID,I=1<<P.overscaledZ,{x:L,y:H}=P.canonical,F=L/I,X=(L+1)/I,re=H/I,oe=(H+1)/I;return{minx:F,miny:re,maxx:X,maxy:oe,t:E.dem.tree.raycastRoot(F,re,X,oe,f,m,b),tile:E}});x.sort((E,P)=>(E.t!==null?E.t:Number.MAX_VALUE)-(P.t!==null?P.t:Number.MAX_VALUE));for(const E of x){if(E.t==null)return null;const P=E.tile.dem.tree.raycast(E.minx,E.miny,E.maxx,E.maxy,f,m,b);if(P!=null)return P}return null}_createFBO(){const f=this.painter.context,m=f.gl,b=this.drapeBufferSize;f.activeTexture.set(m.TEXTURE0);const x=new a.Texture(f,{width:b[0],height:b[1],data:null},m.RGBA);x.bind(m.LINEAR,m.CLAMP_TO_EDGE);const E=f.createFramebuffer(b[0],b[1],!1);return E.colorAttachment.set(x.texture),E.depthAttachment=new ia(f,E.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=f.createRenderbuffer(f.gl.DEPTH_STENCIL,b[0],b[1]),this._stencilRef=0,E.depthAttachment.set(this._sharedDepthStencil),f.clear({stencil:0})):E.depthAttachment.set(this._sharedDepthStencil),f.extTextureFilterAnisotropic&&!f.extTextureFilterAnisotropicForceOff&&m.texParameterf(m.TEXTURE_2D,f.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,f.extTextureFilterAnisotropicMax),{fb:E,tex:x,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.light&&this._style.light.hasTransition())return!0;for(const f in this._style._sourceCaches)if(this._style._sourceCaches[f].hasTransition())return!0;return this._style.order.some(f=>{const m=this._style._layers[f],b=m.isHidden(this.painter.transform.zoom);return m.type==="custom"?!b&&m.shouldRedrape():!b&&m.hasTransition()})}_clearLineLayersFromRenderCache(){let f=!1;for(const b of this._style._getSources())if(b instanceof Z){f=!0;break}if(!f)return;const m={};for(let b=0;b<this._style.order.length;++b){const x=this._style._layers[this._style.order[b]],E=this._style._getLayerSourceCache(x);if(E&&!m[E.id]&&!x.isHidden(this.painter.transform.zoom)&&x.type==="line"&&x.widthExpression()instanceof a.ZoomDependentExpression){m[E.id]=!0;for(const P of this.proxyCoords){const I=this.proxyToSource[P.key][E.id];if(I)for(const L of I)this._clearRenderCacheForTile(E.id,L)}}}}_clearRasterLayersFromRenderCache(){let f=!1;for(const b in this._style._sourceCaches)if(this._style._sourceCaches[b]._source instanceof Q){f=!0;break}if(!f)return;const m={};for(let b=0;b<this._style.order.length;++b){const x=this._style._layers[this._style.order[b]],E=this._style._getLayerSourceCache(x);if(!E||m[E.id]||x.isHidden(this.painter.transform.zoom)||x.type!=="raster")continue;const P=x.paint.get("raster-fade-duration");for(const I of this.proxyCoords){const L=this.proxyToSource[I.key][E.id];if(L)for(const H of L){const F=Lh(E.getTile(H),E.findLoadedParent(H,0),E,this.painter.transform,P);(F.opacity!==1||F.mix!==0)&&this._clearRenderCacheForTile(E.id,H)}}}}_setupDrapedRenderBatches(){const f=this._style.order,m=f.length;if(m===0)return;const b=[];let x,E=0,P=this._style._layers[f[E]];for(;!this._style.isLayerDraped(P)&&P.isHidden(this.painter.transform.zoom)&&++E<m;)P=this._style._layers[f[E]];for(;E<m;++E){const I=this._style._layers[f[E]];I.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(I)?x===void 0&&(x=E):x!==void 0&&(b.push({start:x,end:E-1}),x=void 0))}x!==void 0&&b.push({start:x,end:E-1}),this._drapedRenderBatches=b}_setupRenderCache(f){const m=this.proxySourceCache;if(this._shouldDisableRenderCache()||this._invalidateRenderCache){if(this._invalidateRenderCache=!1,m.renderCache.length>m.renderCachePool.length){const P=Object.values(m.proxyCachedFBO);m.proxyCachedFBO={};for(let I=0;I<P.length;++I){const L=Object.values(P[I]);m.renderCachePool.push(...L)}}return}this._clearRasterLayersFromRenderCache();const b=this.proxyCoords,x=this._tilesDirty;for(let P=b.length-1;P>=0;P--){const I=b[P];if(m.getTileByID(I.key),m.proxyCachedFBO[I.key]!==void 0){const L=f[I.key],H=this.proxyToSource[I.key];let F=0;for(const X in H){const re=H[X],oe=L[X];if(!oe||oe.length!==re.length||re.some((le,ue)=>le!==oe[ue]||x[X]&&x[X].hasOwnProperty(le.key))){F=-1;break}++F}for(const X in m.proxyCachedFBO[I.key])m.renderCache[m.proxyCachedFBO[I.key][X]].dirty=F<0||F!==Object.values(L).length}}const E=[...this._drapedRenderBatches];E.sort((P,I)=>I.end-I.start-(P.end-P.start));for(const P of E)for(const I of b){if(m.proxyCachedFBO[I.key])continue;let L=m.renderCachePool.pop();L===void 0&&m.renderCache.length<50&&(L=m.renderCache.length,m.renderCache.push(this._createFBO())),L!==void 0&&(m.proxyCachedFBO[I.key]={},m.proxyCachedFBO[I.key][P.start]=L,m.renderCache[L].dirty=!0)}this._tilesDirty={}}_setupStencil(f,m,b,x){if(!x||!this._sourceTilesOverlap[x.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const E=this.painter.context,P=E.gl;if(m.length<=1)return void(this._overlapStencilType=!1);let I;if(b.isTileClipped())I=m.length,this._overlapStencilMode.test={func:P.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(m[0].overscaledZ>m[m.length-1].overscaledZ))return void(this._overlapStencilType=!1);I=1,this._overlapStencilMode.test={func:P.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+I>255&&(E.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=I,this._overlapStencilMode.ref=this._stencilRef,b.isTileClipped()&&this._renderTileClippingMasks(m,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(f){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[f.key]),this._overlapStencilMode):a.StencilMode.disabled}_renderTileClippingMasks(f,m){const b=this.painter,x=this.painter.context,E=x.gl;b._tileClippingMaskIDs={},x.setColorMode(a.ColorMode.disabled),x.setDepthMode(a.DepthMode.disabled);const P=b.useProgram("clippingMask");for(const I of f){const L=b._tileClippingMaskIDs[I.key]=--m;P.draw(x,E.TRIANGLES,a.DepthMode.disabled,new a.StencilMode({func:E.ALWAYS,mask:0},L,255,E.KEEP,E.KEEP,E.REPLACE),a.ColorMode.disabled,a.CullFaceMode.disabled,mn(I.projMatrix),"$clipping",b.tileExtentBuffer,b.quadTriangleIndexBuffer,b.tileExtentSegments)}}pointCoordinate(f){const m=this.painter.transform;if(f.x<0||f.x>m.width||f.y<0||f.y>m.height)return null;const b=[f.x,f.y,1,1];a.transformMat4$1(b,b,m.pixelMatrixInverse),a.scale$1(b,b,1/b[3]),b[0]/=m.worldSize,b[1]/=m.worldSize;const x=m._camera.position,E=a.mercatorZfromAltitude(1,m.center.lat),P=[x[0],x[1],x[2]/E,0],I=a.subtract([],b.slice(0,3),P);a.normalize(I,I);const L=this.raycast(P,I,this._exaggeration);return L!==null&&L?(a.scaleAndAdd(P,P,I,L),P[3]=P[2],P[2]*=E,P):null}drawDepth(){const f=this.painter,m=f.context,b=this.proxySourceCache,x=Math.ceil(f.width),E=Math.ceil(f.height);if(!this._depthFBO||this._depthFBO.width===x&&this._depthFBO.height===E||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const P=m.gl,I=m.createFramebuffer(x,E,!0);m.activeTexture.set(P.TEXTURE0);const L=new a.Texture(m,{width:x,height:E,data:null},P.RGBA);L.bind(P.NEAREST,P.CLAMP_TO_EDGE),I.colorAttachment.set(L.texture);const H=m.createRenderbuffer(m.gl.DEPTH_COMPONENT16,x,E);I.depthAttachment.set(H),this._depthFBO=I,this._depthTexture=L}m.bindFramebuffer.set(this._depthFBO.framebuffer),m.viewport.set([0,0,x,E]),function(P,I,L,H){if(P.transform.projection.name==="globe")return;const F=P.context,X=F.gl;F.clear({depth:1});const re=P.useProgram("terrainDepth"),oe=new a.DepthMode(X.LESS,a.DepthMode.ReadWrite,P.depthRangeFor3D);for(const le of H){const ue=L.getTile(le),ce=_b(le.projMatrix,0);I.setupElevationDraw(ue,re),re.draw(F,X.TRIANGLES,oe,a.StencilMode.disabled,a.ColorMode.unblended,a.CullFaceMode.backCCW,ce,"terrain_depth",I.gridBuffer,I.gridIndexBuffer,I.gridNoSkirtSegments)}}(f,this,b,this.proxyCoords)}_setupProxiedCoordsForOrtho(f,m,b){if(f.getSource()instanceof Ae)return this._setupProxiedCoordsForImageSource(f,m,b);this._findCoveringTileCache[f.id]=this._findCoveringTileCache[f.id]||{};const x=this.proxiedCoords[f.id]=[],E=this.proxyCoords;for(let I=0;I<E.length;I++){const L=E[I],H=this._findTileCoveringTileID(L,f);if(H){const F=this._createProxiedId(L,H,b[L.key]&&b[L.key][f.id]);x.push(F),this.proxyToSource[L.key][f.id]=[F]}}let P=!1;for(let I=0;I<m.length;I++){const L=f.getTile(m[I]);if(!L||!L.hasData())continue;const H=this._findTileCoveringTileID(L.tileID,this.proxySourceCache);if(H&&H.tileID.canonical.z!==L.tileID.canonical.z){const F=this.proxyToSource[H.tileID.key][f.id],X=this._createProxiedId(H.tileID,L,b[H.tileID.key]&&b[H.tileID.key][f.id]);F?F.splice(F.length-1,0,X):this.proxyToSource[H.tileID.key][f.id]=[X],x.push(X),P=!0}}this._sourceTilesOverlap[f.id]=P}_setupProxiedCoordsForImageSource(f,m,b){if(!f.getSource().loaded())return;const x=this.proxiedCoords[f.id]=[],E=this.proxyCoords,P=f.getSource(),I=new a.pointGeometry(P.tileID.x,P.tileID.y)._div(1<<P.tileID.z),L=P.coordinates.map(a.MercatorCoordinate.fromLngLat).reduce((F,X)=>(F.min.x=Math.min(F.min.x,X.x-I.x),F.min.y=Math.min(F.min.y,X.y-I.y),F.max.x=Math.max(F.max.x,X.x-I.x),F.max.y=Math.max(F.max.y,X.y-I.y),F),{min:new a.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE),max:new a.pointGeometry(-Number.MAX_VALUE,-Number.MAX_VALUE)}),H=(F,X)=>{const re=F.wrap+F.canonical.x/(1<<F.canonical.z),oe=F.canonical.y/(1<<F.canonical.z),le=a.EXTENT/(1<<F.canonical.z),ue=X.wrap+X.canonical.x/(1<<X.canonical.z),ce=X.canonical.y/(1<<X.canonical.z);return re+le<ue+L.min.x||re>ue+L.max.x||oe+le<ce+L.min.y||oe>ce+L.max.y};for(let F=0;F<E.length;F++){const X=E[F];for(let re=0;re<m.length;re++){const oe=f.getTile(m[re]);if(!oe||!oe.hasData()||H(X,oe.tileID))continue;const le=this._createProxiedId(X,oe,b[X.key]&&b[X.key][f.id]),ue=this.proxyToSource[X.key][f.id];ue?ue.push(le):this.proxyToSource[X.key][f.id]=[le],x.push(le)}}}_createProxiedId(f,m,b){let x=this.orthoMatrix;if(b){const E=b.find(P=>P.key===m.tileID.key);if(E)return E}if(m.tileID.key!==f.key){const E=f.canonical.z-m.tileID.canonical.z;let P,I,L;x=a.create();const H=m.tileID.wrap-f.wrap<<f.overscaledZ;E>0?(P=a.EXTENT>>E,I=P*((m.tileID.canonical.x<<E)-f.canonical.x+H),L=P*((m.tileID.canonical.y<<E)-f.canonical.y)):(P=a.EXTENT<<-E,I=a.EXTENT*(m.tileID.canonical.x-(f.canonical.x+H<<-E)),L=a.EXTENT*(m.tileID.canonical.y-(f.canonical.y<<-E))),a.ortho(x,0,P,0,P,0,1),a.translate(x,x,[I,L,0])}return new Sb(m.tileID,f.key,x)}_findTileCoveringTileID(f,m){let b=m.getTile(f);if(b&&b.hasData())return b;const x=this._findCoveringTileCache[m.id],E=x[f.key];if(b=E?m.getTileByID(E):null,b&&b.hasData()||E===null)return b;let P=b?b.tileID:f,I=P.overscaledZ;const L=m.getSource().minzoom,H=[];if(!E){const X=m.getSource().maxzoom;if(f.canonical.z>=X){const re=f.canonical.z-X;m.getSource().reparseOverscaled?(I=Math.max(f.canonical.z+2,m.transform.tileZoom),P=new a.OverscaledTileID(I,f.wrap,X,f.canonical.x>>re,f.canonical.y>>re)):re!==0&&(I=X,P=new a.OverscaledTileID(I,f.wrap,X,f.canonical.x>>re,f.canonical.y>>re))}P.key!==f.key&&(H.push(P.key),b=m.getTile(P))}const F=X=>{H.forEach(re=>{x[re]=X}),H.length=0};for(I-=1;I>=L&&(!b||!b.hasData());I--){b&&F(b.tileID.key);const X=P.calculateScaledKey(I);if(b=m.getTileByID(X),b&&b.hasData())break;const re=x[X];if(re===null)break;re===void 0?H.push(X):b=m.getTileByID(re)}return F(b?b.tileID.key:null),b&&b.hasData()?b:null}findDEMTileFor(f){return this.enabled?this._findTileCoveringTileID(f,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(f,m){let b=this._tilesDirty[f];b||(b=this._tilesDirty[f]={}),b[m.key]=!0}getWirefameBuffer(){if(!this.wireframeSegments){const f=function(m){let b=0;const x=new a.StructArrayLayout2ui4,E=131;for(let P=1;P<129;P++){for(let I=1;I<129;I++)b=P*E+I,x.emplaceBack(b,b+1),x.emplaceBack(b,b+E),x.emplaceBack(b+1,b+E),P===128&&x.emplaceBack(b+E,b+E+1);x.emplaceBack(b+1,b+1+E)}return x}();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(f),this.wireframeSegments=a.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,f.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}}class Cb{static cacheKey(f,m,b,x){let E=`${m}${x?x.cacheKey:""}`;for(const P of b)f.usedDefines.includes(P)&&(E+=`/${P}`);return E}constructor(f,m,b,x,E,P){const I=f.gl;this.program=I.createProgram();const L=function(te){const ge=[];for(let me=0;me<te.length;me++){if(te[me]===null)continue;const be=te[me].split(" ");ge.push(be.pop())}return ge}(b.staticAttributes),H=x?x.getBinderAttributes():[],F=L.concat(H);let X=x?x.defines():[];X=X.concat(P.map(te=>`#define ${te}`));const re=f.isWebGL2?`#version 300 es
`:"",oe=re+X.concat(f.extStandardDerivatives&&re.length===0?`#extension GL_OES_standard_derivatives : enable
`.concat(pm):pm,pm,dm,DC.fragmentSource,yb.fragmentSource,b.fragmentSource).join(`
`),le=re+X.concat(`
#ifdef GL_ES
precision highp float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`,dm,DC.vertexSource,yb.vertexSource,mb.vertexSource,b.vertexSource).join(`
`),ue=I.createShader(I.FRAGMENT_SHADER);if(I.isContextLost())return void(this.failedToCreate=!0);I.shaderSource(ue,oe),I.compileShader(ue),I.attachShader(this.program,ue);const ce=I.createShader(I.VERTEX_SHADER);if(I.isContextLost())this.failedToCreate=!0;else{I.shaderSource(ce,le),I.compileShader(ce),I.attachShader(this.program,ce),this.attributes={},this.numAttributes=F.length;for(let te=0;te<this.numAttributes;te++)F[te]&&(I.bindAttribLocation(this.program,te,F[te]),this.attributes[F[te]]=te);I.linkProgram(this.program),I.deleteShader(ce),I.deleteShader(ue),this.fixedUniforms=E(f),this.binderUniforms=x?x.getUniforms(f):[],P.includes("TERRAIN")&&(this.terrainUniforms=(te=>({u_dem:new a.Uniform1i(te),u_dem_prev:new a.Uniform1i(te),u_dem_unpack:new a.Uniform4f(te),u_dem_tl:new a.Uniform2f(te),u_dem_scale:new a.Uniform1f(te),u_dem_tl_prev:new a.Uniform2f(te),u_dem_scale_prev:new a.Uniform1f(te),u_dem_size:new a.Uniform1f(te),u_dem_lerp:new a.Uniform1f(te),u_exaggeration:new a.Uniform1f(te),u_depth:new a.Uniform1i(te),u_depth_size_inv:new a.Uniform2f(te),u_meter_to_dem:new a.Uniform1f(te),u_label_plane_matrix_inv:new a.UniformMatrix4f(te)}))(f)),P.includes("GLOBE")&&(this.globeUniforms=(te=>({u_tile_tl_up:new a.Uniform3f(te),u_tile_tr_up:new a.Uniform3f(te),u_tile_br_up:new a.Uniform3f(te),u_tile_bl_up:new a.Uniform3f(te),u_tile_up_scale:new a.Uniform1f(te)}))(f)),P.includes("FOG")&&(this.fogUniforms=(te=>({u_fog_matrix:new a.UniformMatrix4f(te),u_fog_range:new a.Uniform2f(te),u_fog_color:new a.Uniform4f(te),u_fog_horizon_blend:new a.Uniform1f(te),u_fog_temporal_offset:new a.Uniform1f(te),u_frustum_tl:new a.Uniform3f(te),u_frustum_tr:new a.Uniform3f(te),u_frustum_br:new a.Uniform3f(te),u_frustum_bl:new a.Uniform3f(te),u_globe_pos:new a.Uniform3f(te),u_globe_radius:new a.Uniform1f(te),u_globe_transition:new a.Uniform1f(te),u_is_globe:new a.Uniform1i(te),u_viewport:new a.Uniform2f(te)}))(f))}}setTerrainUniformValues(f,m){if(!this.terrainUniforms)return;const b=this.terrainUniforms;if(!this.failedToCreate){f.program.set(this.program);for(const x in m)b[x]&&b[x].set(this.program,x,m[x])}}setGlobeUniformValues(f,m){if(!this.globeUniforms)return;const b=this.globeUniforms;if(!this.failedToCreate){f.program.set(this.program);for(const x in m)b[x]&&b[x].set(this.program,x,m[x])}}setFogUniformValues(f,m){if(!this.fogUniforms)return;const b=this.fogUniforms;if(!this.failedToCreate){f.program.set(this.program);for(const x in m)b[x].set(this.program,x,m[x])}}draw(f,m,b,x,E,P,I,L,H,F,X,re,oe,le,ue){const ce=f.gl;if(this.failedToCreate)return;f.program.set(this.program),f.setDepthMode(b),f.setStencilMode(x),f.setColorMode(E),f.setCullFace(P);for(const ge of Object.keys(this.fixedUniforms))this.fixedUniforms[ge].set(this.program,ge,I[ge]);le&&le.setUniforms(this.program,f,this.binderUniforms,re,{zoom:oe});const te={[ce.LINES]:2,[ce.TRIANGLES]:3,[ce.LINE_STRIP]:1}[m];for(const ge of X.get()){const me=ge.vaos||(ge.vaos={});(me[L]||(me[L]=new Mh)).bind(f,this,H,le?le.getPaintVertexBuffers():[],F,ge.vertexOffset,ue||[]),ce.drawElements(m,ge.primitiveLength*te,ce.UNSIGNED_SHORT,ge.primitiveOffset*te*2)}}}function NC(v,f){const m=Math.pow(2,f.tileID.overscaledZ),b=f.tileSize*Math.pow(2,v.transform.tileZoom)/m,x=b*(f.tileID.canonical.x+f.tileID.wrap*m),E=b*f.tileID.canonical.y;return{u_image:0,u_texsize:f.imageAtlasTexture.size,u_tile_units_to_pixels:1/ve(f,1,v.transform.tileZoom),u_pixel_coord_upper:[x>>16,E>>16],u_pixel_coord_lower:[65535&x,65535&E]}}const hI=a.create(),_m=(v,f,m,b,x,E,P,I,L,H,F)=>{const X=f.style.light,re=X.properties.get("position"),oe=[re.x,re.y,re.z],le=a.create$1();X.properties.get("anchor")==="viewport"&&(a.fromRotation(le,-f.transform.angle),a.transformMat3(oe,oe,le));const ue=X.properties.get("color"),ce=f.transform,te={u_matrix:v,u_lightpos:oe,u_lightintensity:X.properties.get("intensity"),u_lightcolor:[ue.r,ue.g,ue.b],u_vertical_gradient:+m,u_opacity:b,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:hI,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:x,u_edge_radius:E};return ce.projection.name==="globe"&&(te.u_tile_id=[P.canonical.x,P.canonical.y,1<<P.canonical.z],te.u_zoom_transition=L,te.u_inv_rot_matrix=F,te.u_merc_center=H,te.u_up_dir=ce.projection.upVector(new a.CanonicalTileID(0,0,0),H[0]*a.EXTENT,H[1]*a.EXTENT),te.u_height_lift=I),te},Eb=(v,f,m,b,x,E,P,I,L,H,F,X)=>{const re=_m(v,f,m,b,x,E,P,L,H,F,X),oe={u_height_factor:-Math.pow(2,P.overscaledZ)/I.tileSize/8};return a.extend(re,NC(f,I),oe)},bm=v=>({u_matrix:v}),wm=(v,f,m)=>a.extend(bm(v),NC(f,m)),BC=(v,f)=>({u_matrix:v,u_world:f}),jC=(v,f,m,b)=>a.extend(wm(v,f,m),{u_world:b}),dI=a.create(),Nh=(v,f,m,b,x,E)=>{const P=v.transform,I=P.projection.name==="globe";let L;if(E.paint.get("circle-pitch-alignment")==="map")if(I){const F=a.globePixelsToTileUnits(P.zoom,f.canonical)*P._pixelsPerMercatorPixel;L=Float32Array.from([F,0,0,F])}else L=P.calculatePixelsToTileUnitsMatrix(m);else L=new Float32Array([P.pixelsToGLUnits[0],0,0,P.pixelsToGLUnits[1]]);const H={u_camera_to_center_distance:P.cameraToCenterDistance,u_matrix:v.translatePosMatrix(f.projMatrix,m,E.paint.get("circle-translate"),E.paint.get("circle-translate-anchor")),u_device_pixel_ratio:a.exported.devicePixelRatio,u_extrude_scale:L,u_inv_rot_matrix:dI,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(I){H.u_inv_rot_matrix=b,H.u_merc_center=x,H.u_tile_id=[f.canonical.x,f.canonical.y,1<<f.canonical.z],H.u_zoom_transition=a.globeToMercatorTransition(P.zoom);const F=x[0]*a.EXTENT,X=x[1]*a.EXTENT;H.u_up_dir=P.projection.upVector(new a.CanonicalTileID(0,0,0),F,X)}return H},Bh=v=>{const f=[];return v.paint.get("circle-pitch-alignment")==="map"&&f.push("PITCH_WITH_MAP"),v.paint.get("circle-pitch-scale")==="map"&&f.push("SCALE_WITH_MAP"),f},zC=(v,f,m,b)=>{const x=a.EXTENT/m.tileSize;return{u_matrix:v,u_camera_to_center_distance:f.getCameraToCenterDistance(b),u_extrude_scale:[f.pixelsToGLUnits[0]/x,f.pixelsToGLUnits[1]/x]}},jh=(v,f,m=1)=>({u_matrix:v,u_color:f,u_overlay:0,u_overlay_scale:m}),Tb=a.create(),ms=(v,f,m,b,x,E,P)=>{const I=v.transform,L=I.projection.name==="globe",H=L?a.globePixelsToTileUnits(I.zoom,f.canonical)*I._pixelsPerMercatorPixel:ve(m,1,E),F={u_matrix:f.projMatrix,u_extrude_scale:H,u_intensity:P,u_inv_rot_matrix:Tb,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(L){F.u_inv_rot_matrix=b,F.u_merc_center=x,F.u_tile_id=[f.canonical.x,f.canonical.y,1<<f.canonical.z],F.u_zoom_transition=a.globeToMercatorTransition(I.zoom);const X=x[0]*a.EXTENT,re=x[1]*a.EXTENT;F.u_up_dir=I.projection.upVector(new a.CanonicalTileID(0,0,0),X,re)}return F},Ob=(v,f,m,b,x,E,P)=>{const I=v.transform,L=I.calculatePixelsToTileUnitsMatrix(f);return{u_matrix:Rb(v,f,m,b),u_pixels_to_tile_units:L,u_device_pixel_ratio:E,u_units_to_pixels:[1/I.pixelsToGLUnits[0],1/I.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:x,u_texsize:xm(m)?f.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:Sm(f,v.transform),u_alpha_discard_threshold:0,u_trim_offset:P}},FC=(v,f,m,b,x)=>{const E=v.transform;return{u_matrix:Rb(v,f,m,b),u_texsize:f.imageAtlasTexture.size,u_pixels_to_tile_units:E.calculatePixelsToTileUnitsMatrix(f),u_device_pixel_ratio:x,u_image:0,u_tile_units_to_pixels:Sm(f,E),u_units_to_pixels:[1/E.pixelsToGLUnits[0],1/E.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}};function Sm(v,f){return 1/ve(v,1,f.tileZoom)}function Rb(v,f,m,b){return v.translatePosMatrix(b||f.tileID.projMatrix,f,m.paint.get("line-translate"),m.paint.get("line-translate-anchor"))}function xm(v){const f=v.paint.get("line-dasharray").value;return f.value||f.kind!=="constant"}const pI=(v,f,m,b,x,E)=>{return{u_matrix:v,u_tl_parent:f,u_scale_parent:m,u_fade_t:b.mix,u_opacity:b.opacity*x.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:x.paint.get("raster-brightness-min"),u_brightness_high:x.paint.get("raster-brightness-max"),u_saturation_factor:(I=x.paint.get("raster-saturation"),I>0?1-1/(1.001-I):-I),u_contrast_factor:(P=x.paint.get("raster-contrast"),P>0?1/(1-P):1+P),u_spin_weights:kb(x.paint.get("raster-hue-rotate")),u_perspective_transform:E};var P,I};function kb(v){v*=Math.PI/180;const f=Math.sin(v),m=Math.cos(v);return[(2*m+1)/3,(-Math.sqrt(3)*f-m+1)/3,(Math.sqrt(3)*f-m+1)/3]}const HC=a.create(),zh=(v,f,m,b,x,E,P,I,L,H,F,X,re,oe,le,ue)=>{const ce=x.transform,te={u_is_size_zoom_constant:+(v==="constant"||v==="source"),u_is_size_feature_constant:+(v==="constant"||v==="camera"),u_size_t:f?f.uSizeT:0,u_size:f?f.uSize:0,u_camera_to_center_distance:ce.cameraToCenterDistance,u_rotate_symbol:+m,u_aspect_ratio:ce.width/ce.height,u_fade_change:x.options.fadeDuration?x.symbolFadeChange:1,u_matrix:E,u_label_plane_matrix:P,u_coord_matrix:I,u_is_text:+L,u_pitch_with_map:+b,u_texsize:H,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:HC,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:HC,u_up_vector:[0,-1,0]};return ue.name==="globe"&&(te.u_tile_id=[F.canonical.x,F.canonical.y,1<<F.canonical.z],te.u_zoom_transition=X,te.u_inv_rot_matrix=oe,te.u_merc_center=re,te.u_camera_forward=ce._camera.forward(),te.u_ecef_origin=a.globeECEFOrigin(ce.globeMatrix,F.toUnwrapped()),te.u_tile_matrix=Float32Array.from(ce.globeMatrix),te.u_up_vector=le),te},VC=(v,f,m,b,x,E,P,I,L,H,F,X,re,oe,le,ue,ce)=>a.extend(zh(v,f,m,b,x,E,P,I,L,H,X,re,oe,le,ue,ce),{u_gamma_scale:b?x.transform.cameraToCenterDistance*Math.cos(x.terrain?0:x.transform._pitch):1,u_device_pixel_ratio:a.exported.devicePixelRatio,u_is_halo:+F}),Pb=(v,f,m,b,x,E,P,I,L,H,F,X,re,oe,le,ue)=>a.extend(VC(v,f,m,b,x,E,P,I,!0,L,!0,F,X,re,oe,le,ue),{u_texsize_icon:H,u_texture_icon:1}),mI=(v,f,m)=>({u_matrix:v,u_opacity:f,u_color:m}),Ab=(v,f,m,b,x)=>a.extend(function(E,P,I){const L=P.imageManager.getPattern(E.toString()),{width:H,height:F}=P.imageManager.getPixelSize(),X=Math.pow(2,I.tileID.overscaledZ),re=I.tileSize*Math.pow(2,P.transform.tileZoom)/X,oe=re*(I.tileID.canonical.x+I.tileID.wrap*X),le=re*I.tileID.canonical.y;return{u_image:0,u_pattern_tl:L.tl,u_pattern_br:L.br,u_texsize:[H,F],u_pattern_size:L.displaySize,u_tile_units_to_pixels:1/ve(I,1,P.transform.tileZoom),u_pixel_coord_upper:[oe>>16,le>>16],u_pixel_coord_lower:[65535&oe,65535&le]}}(b,m,x),{u_matrix:v,u_opacity:f}),yI={fillExtrusion:v=>({u_matrix:new a.UniformMatrix4f(v),u_lightpos:new a.Uniform3f(v),u_lightintensity:new a.Uniform1f(v),u_lightcolor:new a.Uniform3f(v),u_vertical_gradient:new a.Uniform1f(v),u_opacity:new a.Uniform1f(v),u_edge_radius:new a.Uniform1f(v),u_ao:new a.Uniform2f(v),u_tile_id:new a.Uniform3f(v),u_zoom_transition:new a.Uniform1f(v),u_inv_rot_matrix:new a.UniformMatrix4f(v),u_merc_center:new a.Uniform2f(v),u_up_dir:new a.Uniform3f(v),u_height_lift:new a.Uniform1f(v)}),fillExtrusionPattern:v=>({u_matrix:new a.UniformMatrix4f(v),u_lightpos:new a.Uniform3f(v),u_lightintensity:new a.Uniform1f(v),u_lightcolor:new a.Uniform3f(v),u_vertical_gradient:new a.Uniform1f(v),u_height_factor:new a.Uniform1f(v),u_edge_radius:new a.Uniform1f(v),u_ao:new a.Uniform2f(v),u_tile_id:new a.Uniform3f(v),u_zoom_transition:new a.Uniform1f(v),u_inv_rot_matrix:new a.UniformMatrix4f(v),u_merc_center:new a.Uniform2f(v),u_up_dir:new a.Uniform3f(v),u_height_lift:new a.Uniform1f(v),u_image:new a.Uniform1i(v),u_texsize:new a.Uniform2f(v),u_pixel_coord_upper:new a.Uniform2f(v),u_pixel_coord_lower:new a.Uniform2f(v),u_tile_units_to_pixels:new a.Uniform1f(v),u_opacity:new a.Uniform1f(v)}),fill:v=>({u_matrix:new a.UniformMatrix4f(v)}),fillPattern:v=>({u_matrix:new a.UniformMatrix4f(v),u_image:new a.Uniform1i(v),u_texsize:new a.Uniform2f(v),u_pixel_coord_upper:new a.Uniform2f(v),u_pixel_coord_lower:new a.Uniform2f(v),u_tile_units_to_pixels:new a.Uniform1f(v)}),fillOutline:v=>({u_matrix:new a.UniformMatrix4f(v),u_world:new a.Uniform2f(v)}),fillOutlinePattern:v=>({u_matrix:new a.UniformMatrix4f(v),u_world:new a.Uniform2f(v),u_image:new a.Uniform1i(v),u_texsize:new a.Uniform2f(v),u_pixel_coord_upper:new a.Uniform2f(v),u_pixel_coord_lower:new a.Uniform2f(v),u_tile_units_to_pixels:new a.Uniform1f(v)}),circle:v=>({u_camera_to_center_distance:new a.Uniform1f(v),u_extrude_scale:new a.UniformMatrix2f(v),u_device_pixel_ratio:new a.Uniform1f(v),u_matrix:new a.UniformMatrix4f(v),u_inv_rot_matrix:new a.UniformMatrix4f(v),u_merc_center:new a.Uniform2f(v),u_tile_id:new a.Uniform3f(v),u_zoom_transition:new a.Uniform1f(v),u_up_dir:new a.Uniform3f(v)}),collisionBox:v=>({u_matrix:new a.UniformMatrix4f(v),u_camera_to_center_distance:new a.Uniform1f(v),u_extrude_scale:new a.Uniform2f(v)}),collisionCircle:v=>({u_matrix:new a.UniformMatrix4f(v),u_inv_matrix:new a.UniformMatrix4f(v),u_camera_to_center_distance:new a.Uniform1f(v),u_viewport_size:new a.Uniform2f(v)}),debug:v=>({u_color:new a.UniformColor(v),u_matrix:new a.UniformMatrix4f(v),u_overlay:new a.Uniform1i(v),u_overlay_scale:new a.Uniform1f(v)}),clippingMask:v=>({u_matrix:new a.UniformMatrix4f(v)}),heatmap:v=>({u_extrude_scale:new a.Uniform1f(v),u_intensity:new a.Uniform1f(v),u_matrix:new a.UniformMatrix4f(v),u_inv_rot_matrix:new a.UniformMatrix4f(v),u_merc_center:new a.Uniform2f(v),u_tile_id:new a.Uniform3f(v),u_zoom_transition:new a.Uniform1f(v),u_up_dir:new a.Uniform3f(v)}),heatmapTexture:v=>({u_image:new a.Uniform1i(v),u_color_ramp:new a.Uniform1i(v),u_opacity:new a.Uniform1f(v)}),hillshade:v=>({u_matrix:new a.UniformMatrix4f(v),u_image:new a.Uniform1i(v),u_latrange:new a.Uniform2f(v),u_light:new a.Uniform2f(v),u_shadow:new a.UniformColor(v),u_highlight:new a.UniformColor(v),u_accent:new a.UniformColor(v)}),hillshadePrepare:v=>({u_matrix:new a.UniformMatrix4f(v),u_image:new a.Uniform1i(v),u_dimension:new a.Uniform2f(v),u_zoom:new a.Uniform1f(v),u_unpack:new a.Uniform4f(v)}),line:v=>({u_matrix:new a.UniformMatrix4f(v),u_pixels_to_tile_units:new a.UniformMatrix2f(v),u_device_pixel_ratio:new a.Uniform1f(v),u_units_to_pixels:new a.Uniform2f(v),u_dash_image:new a.Uniform1i(v),u_gradient_image:new a.Uniform1i(v),u_image_height:new a.Uniform1f(v),u_texsize:new a.Uniform2f(v),u_tile_units_to_pixels:new a.Uniform1f(v),u_alpha_discard_threshold:new a.Uniform1f(v),u_trim_offset:new a.Uniform2f(v)}),linePattern:v=>({u_matrix:new a.UniformMatrix4f(v),u_texsize:new a.Uniform2f(v),u_pixels_to_tile_units:new a.UniformMatrix2f(v),u_device_pixel_ratio:new a.Uniform1f(v),u_image:new a.Uniform1i(v),u_units_to_pixels:new a.Uniform2f(v),u_tile_units_to_pixels:new a.Uniform1f(v),u_alpha_discard_threshold:new a.Uniform1f(v)}),raster:v=>({u_matrix:new a.UniformMatrix4f(v),u_tl_parent:new a.Uniform2f(v),u_scale_parent:new a.Uniform1f(v),u_fade_t:new a.Uniform1f(v),u_opacity:new a.Uniform1f(v),u_image0:new a.Uniform1i(v),u_image1:new a.Uniform1i(v),u_brightness_low:new a.Uniform1f(v),u_brightness_high:new a.Uniform1f(v),u_saturation_factor:new a.Uniform1f(v),u_contrast_factor:new a.Uniform1f(v),u_spin_weights:new a.Uniform3f(v),u_perspective_transform:new a.Uniform2f(v)}),symbolIcon:v=>({u_is_size_zoom_constant:new a.Uniform1i(v),u_is_size_feature_constant:new a.Uniform1i(v),u_size_t:new a.Uniform1f(v),u_size:new a.Uniform1f(v),u_camera_to_center_distance:new a.Uniform1f(v),u_rotate_symbol:new a.Uniform1i(v),u_aspect_ratio:new a.Uniform1f(v),u_fade_change:new a.Uniform1f(v),u_matrix:new a.UniformMatrix4f(v),u_label_plane_matrix:new a.UniformMatrix4f(v),u_coord_matrix:new a.UniformMatrix4f(v),u_is_text:new a.Uniform1i(v),u_pitch_with_map:new a.Uniform1i(v),u_texsize:new a.Uniform2f(v),u_tile_id:new a.Uniform3f(v),u_zoom_transition:new a.Uniform1f(v),u_inv_rot_matrix:new a.UniformMatrix4f(v),u_merc_center:new a.Uniform2f(v),u_camera_forward:new a.Uniform3f(v),u_tile_matrix:new a.UniformMatrix4f(v),u_up_vector:new a.Uniform3f(v),u_ecef_origin:new a.Uniform3f(v),u_texture:new a.Uniform1i(v)}),symbolSDF:v=>({u_is_size_zoom_constant:new a.Uniform1i(v),u_is_size_feature_constant:new a.Uniform1i(v),u_size_t:new a.Uniform1f(v),u_size:new a.Uniform1f(v),u_camera_to_center_distance:new a.Uniform1f(v),u_rotate_symbol:new a.Uniform1i(v),u_aspect_ratio:new a.Uniform1f(v),u_fade_change:new a.Uniform1f(v),u_matrix:new a.UniformMatrix4f(v),u_label_plane_matrix:new a.UniformMatrix4f(v),u_coord_matrix:new a.UniformMatrix4f(v),u_is_text:new a.Uniform1i(v),u_pitch_with_map:new a.Uniform1i(v),u_texsize:new a.Uniform2f(v),u_texture:new a.Uniform1i(v),u_gamma_scale:new a.Uniform1f(v),u_device_pixel_ratio:new a.Uniform1f(v),u_tile_id:new a.Uniform3f(v),u_zoom_transition:new a.Uniform1f(v),u_inv_rot_matrix:new a.UniformMatrix4f(v),u_merc_center:new a.Uniform2f(v),u_camera_forward:new a.Uniform3f(v),u_tile_matrix:new a.UniformMatrix4f(v),u_up_vector:new a.Uniform3f(v),u_ecef_origin:new a.Uniform3f(v),u_is_halo:new a.Uniform1i(v)}),symbolTextAndIcon:v=>({u_is_size_zoom_constant:new a.Uniform1i(v),u_is_size_feature_constant:new a.Uniform1i(v),u_size_t:new a.Uniform1f(v),u_size:new a.Uniform1f(v),u_camera_to_center_distance:new a.Uniform1f(v),u_rotate_symbol:new a.Uniform1i(v),u_aspect_ratio:new a.Uniform1f(v),u_fade_change:new a.Uniform1f(v),u_matrix:new a.UniformMatrix4f(v),u_label_plane_matrix:new a.UniformMatrix4f(v),u_coord_matrix:new a.UniformMatrix4f(v),u_is_text:new a.Uniform1i(v),u_pitch_with_map:new a.Uniform1i(v),u_texsize:new a.Uniform2f(v),u_texsize_icon:new a.Uniform2f(v),u_texture:new a.Uniform1i(v),u_texture_icon:new a.Uniform1i(v),u_gamma_scale:new a.Uniform1f(v),u_device_pixel_ratio:new a.Uniform1f(v),u_is_halo:new a.Uniform1i(v)}),background:v=>({u_matrix:new a.UniformMatrix4f(v),u_opacity:new a.Uniform1f(v),u_color:new a.UniformColor(v)}),backgroundPattern:v=>({u_matrix:new a.UniformMatrix4f(v),u_opacity:new a.Uniform1f(v),u_image:new a.Uniform1i(v),u_pattern_tl:new a.Uniform2f(v),u_pattern_br:new a.Uniform2f(v),u_texsize:new a.Uniform2f(v),u_pattern_size:new a.Uniform2f(v),u_pixel_coord_upper:new a.Uniform2f(v),u_pixel_coord_lower:new a.Uniform2f(v),u_tile_units_to_pixels:new a.Uniform1f(v)}),terrainRaster:ym,terrainDepth:ym,skybox:v=>({u_matrix:new a.UniformMatrix4f(v),u_sun_direction:new a.Uniform3f(v),u_cubemap:new a.Uniform1i(v),u_opacity:new a.Uniform1f(v),u_temporal_offset:new a.Uniform1f(v)}),skyboxGradient:v=>({u_matrix:new a.UniformMatrix4f(v),u_color_ramp:new a.Uniform1i(v),u_center_direction:new a.Uniform3f(v),u_radius:new a.Uniform1f(v),u_opacity:new a.Uniform1f(v),u_temporal_offset:new a.Uniform1f(v)}),skyboxCapture:v=>({u_matrix_3f:new a.UniformMatrix3f(v),u_sun_direction:new a.Uniform3f(v),u_sun_intensity:new a.Uniform1f(v),u_color_tint_r:new a.Uniform4f(v),u_color_tint_m:new a.Uniform4f(v),u_luminance:new a.Uniform1f(v)}),globeRaster:v=>({u_proj_matrix:new a.UniformMatrix4f(v),u_globe_matrix:new a.UniformMatrix4f(v),u_normalize_matrix:new a.UniformMatrix4f(v),u_merc_matrix:new a.UniformMatrix4f(v),u_zoom_transition:new a.Uniform1f(v),u_merc_center:new a.Uniform2f(v),u_image0:new a.Uniform1i(v),u_grid_matrix:new a.UniformMatrix3f(v),u_skirt_height:new a.Uniform1f(v),u_frustum_tl:new a.Uniform3f(v),u_frustum_tr:new a.Uniform3f(v),u_frustum_br:new a.Uniform3f(v),u_frustum_bl:new a.Uniform3f(v),u_globe_pos:new a.Uniform3f(v),u_globe_radius:new a.Uniform1f(v),u_viewport:new a.Uniform2f(v)}),globeAtmosphere:v=>({u_frustum_tl:new a.Uniform3f(v),u_frustum_tr:new a.Uniform3f(v),u_frustum_br:new a.Uniform3f(v),u_frustum_bl:new a.Uniform3f(v),u_horizon:new a.Uniform1f(v),u_transition:new a.Uniform1f(v),u_fadeout_range:new a.Uniform1f(v),u_color:new a.Uniform4f(v),u_high_color:new a.Uniform4f(v),u_space_color:new a.Uniform4f(v),u_star_intensity:new a.Uniform1f(v),u_star_density:new a.Uniform1f(v),u_star_size:new a.Uniform1f(v),u_temporal_offset:new a.Uniform1f(v),u_horizon_angle:new a.Uniform1f(v),u_rotation_matrix:new a.UniformMatrix4f(v)})};let bu;function UC(v,f,m,b,x,E,P){const I=v.context,L=I.gl,H=v.transform,F=v.useProgram("collisionBox"),X=[];let re=0,oe=0;for(let be=0;be<b.length;be++){const Pe=b[be],Oe=f.getTile(Pe),De=Oe.getBucket(m);if(!De)continue;const Xe=fb(Pe,De,H);let ot=Xe;x[0]===0&&x[1]===0||(ot=v.translatePosMatrix(Xe,Oe,x,E));const ut=P?De.textCollisionBox:De.iconCollisionBox,Bt=De.collisionCircleArray;if(Bt.length>0){const tt=a.create(),wt=ot;a.mul(tt,De.placementInvProjMatrix,H.glCoordMatrix),a.mul(tt,tt,De.placementViewportMatrix),X.push({circleArray:Bt,circleOffset:oe,transform:wt,invTransform:tt,projection:De.getProjection()}),re+=Bt.length/4,oe=re}ut&&(v.terrain&&v.terrain.setupElevationDraw(Oe,F),F.draw(I,L.LINES,a.DepthMode.disabled,a.StencilMode.disabled,v.colorModeForRenderPass(),a.CullFaceMode.disabled,zC(ot,H,Oe,De.getProjection()),m.id,ut.layoutVertexBuffer,ut.indexBuffer,ut.segments,null,H.zoom,null,[ut.collisionVertexBuffer,ut.collisionVertexBufferExt]))}if(!P||!X.length)return;const le=v.useProgram("collisionCircle"),ue=new a.StructArrayLayout2f1f2i16;ue.resize(4*re),ue._trim();let ce=0;for(const be of X)for(let Pe=0;Pe<be.circleArray.length/4;Pe++){const Oe=4*Pe,De=be.circleArray[Oe+0],Xe=be.circleArray[Oe+1],ot=be.circleArray[Oe+2],ut=be.circleArray[Oe+3];ue.emplace(ce++,De,Xe,ot,ut,0),ue.emplace(ce++,De,Xe,ot,ut,1),ue.emplace(ce++,De,Xe,ot,ut,2),ue.emplace(ce++,De,Xe,ot,ut,3)}(!bu||bu.length<2*re)&&(bu=function(be){const Pe=2*be,Oe=new a.StructArrayLayout3ui6;Oe.resize(Pe),Oe._trim();for(let De=0;De<Pe;De++){const Xe=6*De;Oe.uint16[Xe+0]=4*De+0,Oe.uint16[Xe+1]=4*De+1,Oe.uint16[Xe+2]=4*De+2,Oe.uint16[Xe+3]=4*De+2,Oe.uint16[Xe+4]=4*De+3,Oe.uint16[Xe+5]=4*De+0}return Oe}(re));const te=I.createIndexBuffer(bu,!0),ge=I.createVertexBuffer(ue,a.collisionCircleLayout.members,!0);for(const be of X){const Pe={u_matrix:be.transform,u_inv_matrix:be.invTransform,u_camera_to_center_distance:(me=H).getCameraToCenterDistance(be.projection),u_viewport_size:[me.width,me.height]};le.draw(I,L.TRIANGLES,a.DepthMode.disabled,a.StencilMode.disabled,v.colorModeForRenderPass(),a.CullFaceMode.disabled,Pe,m.id,ge,te,a.SegmentVector.simpleSegment(0,2*be.circleOffset,be.circleArray.length,be.circleArray.length/2),null,H.zoom)}var me;ge.destroy(),te.destroy()}const Ib=a.create();function WC({width:v,height:f,anchor:m,textOffset:b,textScale:x},E){const{horizontalAlign:P,verticalAlign:I}=a.getAnchorAlignment(m),L=-(P-.5)*v,H=-(I-.5)*f,F=a.evaluateVariableOffset(m,b);return new a.pointGeometry((L/x+F[0])*E,(H/x+F[1])*E)}function Kc(v,f,m,b,x,E,P,I,L,H,F){const X=v.text.placedSymbolArray,re=v.text.dynamicLayoutVertexArray,oe=v.icon.dynamicLayoutVertexArray,le={},ue=v.getProjection(),ce=am(I,ue,E),te=E.elevation,ge=ue.upVectorScale(I.canonical,E.center.lat,E.worldSize).metersToTile;re.clear();for(let me=0;me<X.length;me++){const be=X.get(me),{tileAnchorX:Pe,tileAnchorY:Oe,numGlyphs:De}=be,Xe=v.allowVerticalPlacement&&!be.placedOrientation,ot=be.hidden||!be.crossTileID||Xe?null:b[be.crossTileID];if(ot){let ut=0,Bt=0,tt=0;if(te){const ur=te?te.getAtTileOffset(I,Pe,Oe):0,[Hr,rr,er]=ue.upVector(I.canonical,Pe,Oe);ut=ur*Hr*ge,Bt=ur*rr*ge,tt=ur*er*ge}let[wt,pt,Ot,at]=Ut(be.projectedAnchorX+ut,be.projectedAnchorY+Bt,be.projectedAnchorZ+tt,m?ce:P);const Ye=rn(E.getCameraToCenterDistance(ue),at);let ct=x.evaluateSizeForFeature(v.textSizeData,H,be)*Ye/a.ONE_EM;m&&(ct*=v.tilePixelRatio/L);const Et=WC(ot,ct);m?({x:wt,y:pt,z:Ot}=ue.projectTilePoint(Pe+Et.x,Oe+Et.y,I.canonical),[wt,pt,Ot]=Ut(wt+ut,pt+Bt,Ot+tt,P)):(f&&Et._rotate(-E.angle),wt+=Et.x,pt+=Et.y,Ot=0);const Mt=v.allowVerticalPlacement&&be.placedOrientation===a.WritingMode.vertical?Math.PI/2:0;for(let ur=0;ur<De;ur++)a.addDynamicAttributes(re,wt,pt,Ot,Mt);F&&be.associatedIconIndex>=0&&(le[be.associatedIconIndex]={x:wt,y:pt,z:Ot,angle:Mt})}else zn(De,re)}if(F){oe.clear();const me=v.icon.placedSymbolArray;for(let be=0;be<me.length;be++){const Pe=me.get(be),{numGlyphs:Oe}=Pe,De=le[be];if(Pe.hidden||!De)zn(Oe,oe);else{const{x:Xe,y:ot,z:ut,angle:Bt}=De;for(let tt=0;tt<Oe;tt++)a.addDynamicAttributes(oe,Xe,ot,ut,Bt)}}v.icon.dynamicLayoutVertexBuffer.updateData(oe)}v.text.dynamicLayoutVertexBuffer.updateData(re)}function gI(v,f,m){return m.iconsInText&&f?"symbolTextAndIcon":v?"symbolSDF":"symbolIcon"}function GC(v,f,m,b,x,E,P,I,L,H,F,X){const re=v.context,oe=re.gl,le=v.transform,ue=I==="map",ce=L==="map",te=ue&&m.layout.get("symbol-placement")!=="point",ge=ue&&!ce&&!te,me=m.layout.get("symbol-sort-key").constantOr(1)!==void 0;let be=!1;const Pe=v.depthModeForSublayer(0,a.DepthMode.ReadOnly),Oe=[a.mercatorXfromLng(le.center.lng),a.mercatorYfromLat(le.center.lat)],De=m.layout.get("text-variable-anchor"),Xe=le.projection.name==="globe",ot=[],ut=[0,-1,0];let Bt=ut;!Xe&&!le.mercatorFromTransition||ue||(Bt=function(tt){const wt=tt._camera.getWorldToCamera(tt.worldSize,1),pt=a.multiply([],wt,tt.globeMatrix);a.invert(pt,pt);const Ot=[0,0,0],at=[0,1,0,0];return a.transformMat4$1(at,at,pt),Ot[0]=at[0],Ot[1]=at[1],Ot[2]=at[2],a.normalize(Ot,Ot),Ot}(le));for(const tt of b){const wt=f.getTile(tt),pt=wt.getBucket(m);if(!pt||pt.projection.name==="mercator"&&Xe)continue;const Ot=x?pt.text:pt.icon;if(!Ot||pt.fullyClipped||!Ot.segments.get().length)continue;const at=Ot.programConfigurations.get(m.id),Ye=x||pt.sdfIcons,ct=x?pt.textSizeData:pt.iconSizeData,Et=ce||le.pitch!==0,Mt=a.evaluateSizeForZoom(ct,le.zoom);let ur,Hr,rr,er,fr=[0,0],Xr=null;if(x){if(Hr=wt.glyphAtlasTexture,rr=oe.LINEAR,ur=wt.glyphAtlasTexture.size,pt.iconsInText){fr=wt.imageAtlasTexture.size,Xr=wt.imageAtlasTexture;const aa=ct.kind==="composite"||ct.kind==="camera";er=Et||v.options.rotating||v.options.zooming||aa?oe.LINEAR:oe.NEAREST}}else{const aa=m.layout.get("icon-size").constantOr(0)!==1||pt.iconsNeedLinear;Hr=wt.imageAtlasTexture,rr=Ye||v.options.rotating||v.options.zooming||aa||Et?oe.LINEAR:oe.NEAREST,ur=wt.imageAtlasTexture.size}const gr=pt.projection.name==="globe",En=gr?Bt:ut,On=gr?a.globeToMercatorTransition(le.zoom):0,Fn=am(tt,pt.getProjection(),le),$n=le.calculatePixelsToTileUnitsMatrix(wt),Ti=jc(Fn,wt.tileID.canonical,ce,ue,le,pt.getProjection(),$n),Vo=v.terrain&&ce&&te?a.invert(a.create(),Ti):Ib,Ua=zc(Fn,wt.tileID.canonical,ce,ue,le,pt.getProjection(),$n),Ws=De&&pt.hasTextData(),Zn=m.layout.get("icon-text-fit")!=="none"&&Ws&&pt.hasIconData();if(te){const aa=le.elevation,Ea=aa?aa.getAtTileOffsetFunc(tt,le.center.lat,le.worldSize,pt.getProjection()):null,Gs=OC(Fn,wt.tileID.canonical,ce,ue,le,pt.getProjection(),$n);ps(pt,Fn,v,x,Gs,Ua,ce,H,Ea,tt)}const Ln=te||x&&De||Zn,_n=v.translatePosMatrix(Fn,wt,E,P),di=Ln?Ib:Ti,bo=v.translatePosMatrix(Ua,wt,E,P,!0),Yn=pt.getProjection().createInversionMatrix(le,tt.canonical),wo=[];v.terrainRenderModeElevated()&&ce&&wo.push("PITCH_WITH_MAP_TERRAIN"),gr&&wo.push("PROJECTION_GLOBE_VIEW"),Ln&&wo.push("PROJECTED_POS_ON_VIEWPORT");const So=Ye&&m.paint.get(x?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let Tl;Tl=Ye?pt.iconsInText?Pb(ct.kind,Mt,ge,ce,v,_n,di,bo,ur,fr,tt,On,Oe,Yn,En,pt.getProjection()):VC(ct.kind,Mt,ge,ce,v,_n,di,bo,x,ur,!0,tt,On,Oe,Yn,En,pt.getProjection()):zh(ct.kind,Mt,ge,ce,v,_n,di,bo,x,ur,tt,On,Oe,Yn,En,pt.getProjection());const af={program:v.useProgram(gI(Ye,x,pt),at,wo),buffers:Ot,uniformValues:Tl,atlasTexture:Hr,atlasTextureIcon:Xr,atlasInterpolation:rr,atlasInterpolationIcon:er,isSDF:Ye,hasHalo:So,tile:wt,labelPlaneMatrixInv:Vo};if(me&&pt.canOverlap){be=!0;const aa=Ot.segments.get();for(const Ea of aa)ot.push({segments:new a.SegmentVector([Ea]),sortKey:Ea.sortKey,state:af})}else ot.push({segments:Ot.segments,sortKey:0,state:af})}be&&ot.sort((tt,wt)=>tt.sortKey-wt.sortKey);for(const tt of ot){const wt=tt.state;if(v.terrain&&v.terrain.setupElevationDraw(wt.tile,wt.program,{useDepthForOcclusion:!Xe,labelPlaneMatrixInv:wt.labelPlaneMatrixInv}),re.activeTexture.set(oe.TEXTURE0),wt.atlasTexture.bind(wt.atlasInterpolation,oe.CLAMP_TO_EDGE),wt.atlasTextureIcon&&(re.activeTexture.set(oe.TEXTURE1),wt.atlasTextureIcon&&wt.atlasTextureIcon.bind(wt.atlasInterpolationIcon,oe.CLAMP_TO_EDGE)),wt.isSDF){const pt=wt.uniformValues;wt.hasHalo&&(pt.u_is_halo=1,YC(wt.buffers,tt.segments,m,v,wt.program,Pe,F,X,pt)),pt.u_is_halo=0}YC(wt.buffers,tt.segments,m,v,wt.program,Pe,F,X,wt.uniformValues)}}function YC(v,f,m,b,x,E,P,I,L){const H=b.context,F=[v.dynamicLayoutVertexBuffer,v.opacityVertexBuffer,v.globeExtVertexBuffer];x.draw(H,H.gl.TRIANGLES,E,P,I,a.CullFaceMode.disabled,L,m.id,v.layoutVertexBuffer,v.indexBuffer,f,m.paint,b.transform.zoom,v.programConfigurations.get(m.id),F)}function KC(v,f,m,b,x,E,P){const I=v.context.gl,L=m.paint.get("fill-pattern"),H=L&&L.constantOr(1);let F,X,re,oe,le;P?(X=H&&!m.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",F=I.LINES):(X=H?"fillPattern":"fill",F=I.TRIANGLES);for(const ue of b){const ce=f.getTile(ue);if(H&&!ce.patternsLoaded())continue;const te=ce.getBucket(m);if(!te)continue;v.prepareDrawTile();const ge=te.programConfigurations.get(m.id),me=v.useProgram(X,ge);H&&(v.context.activeTexture.set(I.TEXTURE0),ce.imageAtlasTexture.bind(I.LINEAR,I.CLAMP_TO_EDGE),ge.updatePaintBuffers());const be=L.constantOr(null);if(be&&ce.imageAtlas){const Oe=ce.imageAtlas.patternPositions[be.toString()];Oe&&ge.setConstantPatternPositions(Oe)}const Pe=v.translatePosMatrix(ue.projMatrix,ce,m.paint.get("fill-translate"),m.paint.get("fill-translate-anchor"));if(P){oe=te.indexBuffer2,le=te.segments2;const Oe=v.terrain&&v.terrain.renderingToTexture?v.terrain.drapeBufferSize:[I.drawingBufferWidth,I.drawingBufferHeight];re=X==="fillOutlinePattern"&&H?jC(Pe,v,ce,Oe):BC(Pe,Oe)}else oe=te.indexBuffer,le=te.segments,re=H?wm(Pe,v,ce):bm(Pe);v.prepareDrawProgram(v.context,me,ue.toUnwrapped()),me.draw(v.context,F,x,v.stencilModeForClipping(ue),E,a.CullFaceMode.disabled,re,m.id,te.layoutVertexBuffer,oe,le,m.paint,v.transform.zoom,ge)}}function Mb(v,f,m,b,x,E,P){const I=v.context,L=I.gl,H=v.transform,F=m.paint.get("fill-extrusion-pattern"),X=F.constantOr(1),re=m.paint.get("fill-extrusion-opacity"),oe=[m.paint.get("fill-extrusion-ambient-occlusion-intensity"),m.paint.get("fill-extrusion-ambient-occlusion-radius")],le=m.layout.get("fill-extrusion-edge-radius"),ue=H.projection.name==="globe"?a.fillExtrusionHeightLift():0,ce=H.projection.name==="globe",te=ce?a.globeToMercatorTransition(H.zoom):0,ge=[a.mercatorXfromLng(H.center.lng),a.mercatorYfromLat(H.center.lat)],me=[];ce&&me.push("PROJECTION_GLOBE_VIEW"),oe[0]>0&&me.push("FAUX_AO");for(const be of b){const Pe=f.getTile(be),Oe=Pe.getBucket(m);if(!Oe||Oe.projection.name!==H.projection.name)continue;const De=Oe.programConfigurations.get(m.id),Xe=v.useProgram(X?"fillExtrusionPattern":"fillExtrusion",De,me);if(v.terrain){const Ot=v.terrain;if(v.style.terrainSetForDrapingOnly())Ot.setupElevationDraw(Pe,Xe,{useMeterToDem:!0});else{if(!Oe.enableTerrain)continue;if(Ot.setupElevationDraw(Pe,Xe,{useMeterToDem:!0}),vI(I,f,be,Oe,m,Ot),!Oe.centroidVertexBuffer){const at=Xe.attributes.a_centroid_pos;at!==void 0&&L.vertexAttrib2f(at,0,0)}}}X&&(v.context.activeTexture.set(L.TEXTURE0),Pe.imageAtlasTexture.bind(L.LINEAR,L.CLAMP_TO_EDGE),De.updatePaintBuffers());const ot=F.constantOr(null);if(ot&&Pe.imageAtlas){const Ot=Pe.imageAtlas.patternPositions[ot.toString()];Ot&&De.setConstantPatternPositions(Ot)}const ut=v.translatePosMatrix(be.projMatrix,Pe,m.paint.get("fill-extrusion-translate"),m.paint.get("fill-extrusion-translate-anchor")),Bt=H.projection.createInversionMatrix(H,be.canonical),tt=m.paint.get("fill-extrusion-vertical-gradient"),wt=X?Eb(ut,v,tt,re,oe,le,be,Pe,ue,te,ge,Bt):_m(ut,v,tt,re,oe,le,be,ue,te,ge,Bt);v.prepareDrawProgram(I,Xe,be.toUnwrapped());const pt=[];v.terrain&&pt.push(Oe.centroidVertexBuffer),ce&&pt.push(Oe.layoutVertexExtBuffer),Xe.draw(I,I.gl.TRIANGLES,x,E,P,a.CullFaceMode.backCCW,wt,m.id,Oe.layoutVertexBuffer,Oe.indexBuffer,Oe.segments,m.paint,v.transform.zoom,De,pt)}}function vI(v,f,m,b,x,E){const P=[te=>{let ge=te.canonical.x-1,me=te.wrap;return ge<0&&(ge=(1<<te.canonical.z)-1,me--),new a.OverscaledTileID(te.overscaledZ,me,te.canonical.z,ge,te.canonical.y)},te=>{let ge=te.canonical.x+1,me=te.wrap;return ge===1<<te.canonical.z&&(ge=0,me++),new a.OverscaledTileID(te.overscaledZ,me,te.canonical.z,ge,te.canonical.y)},te=>new a.OverscaledTileID(te.overscaledZ,te.wrap,te.canonical.z,te.canonical.x,(te.canonical.y===0?1<<te.canonical.z:te.canonical.y)-1),te=>new a.OverscaledTileID(te.overscaledZ,te.wrap,te.canonical.z,te.canonical.x,te.canonical.y===(1<<te.canonical.z)-1?0:te.canonical.y+1)],I=te=>{const ge=f.getSource().minzoom,me=Pe=>{const Oe=f.getTileByID(Pe);if(Oe&&Oe.hasData())return Oe.getBucket(x)},be=[0,-1,1];for(const Pe of be){if(te.overscaledZ+Pe<ge)continue;const Oe=me(te.calculateScaledKey(te.overscaledZ+Pe));if(Oe)return Oe}},L=[0,0,0],H=(te,ge)=>(L[0]=Math.min(te.min.y,ge.min.y),L[1]=Math.max(te.max.y,ge.max.y),L[2]=a.EXTENT-ge.min.x>te.max.x?ge.min.x-a.EXTENT:te.max.x,L),F=(te,ge)=>(L[0]=Math.min(te.min.x,ge.min.x),L[1]=Math.max(te.max.x,ge.max.x),L[2]=a.EXTENT-ge.min.y>te.max.y?ge.min.y-a.EXTENT:te.max.y,L),X=[(te,ge)=>H(te,ge),(te,ge)=>H(ge,te),(te,ge)=>F(te,ge),(te,ge)=>F(ge,te)],re=new a.pointGeometry(0,0);let oe,le,ue;const ce=(te,ge,me,be,Pe)=>{const Oe=[[be?me:te,be?te:me,0],[be?me:ge,be?ge:me,0]],De=Pe<0?a.EXTENT+Pe:Pe,Xe=[be?De:(te+ge)/2,be?(te+ge)/2:De,0];return me===0&&Pe<0||me!==0&&Pe>0?E.getForTilePoints(ue,[Xe],!0,le):Oe.push(Xe),E.getForTilePoints(m,Oe,!0,oe),Math.max(Oe[0][2],Oe[1][2],Xe[2])/E.exaggeration()};for(let te=0;te<4;te++){const ge=(te<2?1:5)-te,me=b.borders[te];if(me.length===0)continue;const be=ue=P[te](m),Pe=I(be);if(!(Pe&&Pe instanceof a.FillExtrusionBucket&&Pe.enableTerrain)||b.borderDoneWithNeighborZ[te]===Pe.canonical.z&&Pe.borderDoneWithNeighborZ[ge]===b.canonical.z||(le=E.findDEMTileFor(be),!le||!le.dem))continue;if(!oe){const ot=E.findDEMTileFor(m);if(!ot||!ot.dem)return;oe=ot}const Oe=Pe.borders[ge];let De=0;const Xe=Pe.borderDoneWithNeighborZ[ge]!==b.canonical.z;if(b.canonical.z===Pe.canonical.z){for(let ot=0;ot<me.length;ot++){const ut=b.featuresOnBorder[me[ot]],Bt=ut.borders[te];let tt;for(;De<Oe.length&&(tt=Pe.featuresOnBorder[Oe[De]],!(tt.borders[ge][1]>Bt[0]+3));)Xe&&Pe.encodeCentroid(void 0,tt,!1),De++;if(tt&&De<Oe.length){const wt=De;let pt=0;for(;!(tt.borders[ge][0]>Bt[1]-3)&&(pt++,++De!==Oe.length);)tt=Pe.featuresOnBorder[Oe[De]];if(tt=Pe.featuresOnBorder[Oe[wt]],ut.intersectsCount()>1||tt.intersectsCount()>1||pt!==1){pt!==1&&(De=wt),b.encodeCentroid(void 0,ut,!1),Xe&&Pe.encodeCentroid(void 0,tt,!1);continue}const Ot=X[te](ut,tt),at=te%2?a.EXTENT-1:0;re.x=ce(Ot[0],Math.min(a.EXTENT-1,Ot[1]),at,te<2,Ot[2]),re.y=0,b.encodeCentroid(re,ut,!1),Xe&&Pe.encodeCentroid(re,tt,!1)}else b.encodeCentroid(void 0,ut,!1)}b.borderDoneWithNeighborZ[te]=Pe.canonical.z,b.needsCentroidUpdate=!0,Xe&&(Pe.borderDoneWithNeighborZ[ge]=b.canonical.z,Pe.needsCentroidUpdate=!0)}else{for(const ot of me)b.encodeCentroid(void 0,b.featuresOnBorder[ot],!1);if(Xe){for(const ot of Oe)Pe.encodeCentroid(void 0,Pe.featuresOnBorder[ot],!1);Pe.borderDoneWithNeighborZ[ge]=b.canonical.z,Pe.needsCentroidUpdate=!0}b.borderDoneWithNeighborZ[te]=Pe.canonical.z,b.needsCentroidUpdate=!0}}(b.needsCentroidUpdate||!b.centroidVertexBuffer&&b.centroidVertexArray.length!==0)&&b.uploadCentroid(v)}const Db=new a.Color(1,0,0,1),$b=new a.Color(0,1,0,1),qC=new a.Color(0,0,1,1),XC=new a.Color(1,0,1,1),ZC=new a.Color(0,1,1,1);function Lb(v,f,m){const b=v.context,x=v.transform,E=b.gl,P=x.projection.name==="globe",I=P?["PROJECTION_GLOBE_VIEW"]:null;let L=m.projMatrix;if(P&&a.globeToMercatorTransition(x.zoom)>0){const ut=a.transitionTileAABBinECEF(m.canonical,x),Bt=a.globeDenormalizeECEF(ut);L=a.multiply(new Float32Array(16),x.globeMatrix,Bt),a.multiply(L,x.projMatrix,L)}const H=v.useProgram("debug",null,I),F=f.getTileByID(m.key);v.terrain&&v.terrain.setupElevationDraw(F,H);const X=a.DepthMode.disabled,re=a.StencilMode.disabled,oe=v.colorModeForRenderPass(),le="$debug";b.activeTexture.set(E.TEXTURE0),v.emptyTexture.bind(E.LINEAR,E.CLAMP_TO_EDGE),P?F._makeGlobeTileDebugBuffers(v.context,x):F._makeDebugTileBoundsBuffers(v.context,x.projection);const ue=F._tileDebugBuffer||v.debugBuffer,ce=F._tileDebugIndexBuffer||v.debugIndexBuffer,te=F._tileDebugSegments||v.debugSegments;H.draw(b,E.LINE_STRIP,X,re,oe,a.CullFaceMode.disabled,jh(L,a.Color.red),le,ue,ce,te,null,null,null,[F._globeTileDebugBorderBuffer]);const ge=F.latestRawTileData,me=Math.floor((ge&&ge.byteLength||0)/1024),be=f.getTile(m).tileSize,Pe=512/Math.min(be,512)*(m.overscaledZ/x.zoom)*.5;let Oe=m.canonical.toString();m.overscaledZ!==m.canonical.z&&(Oe+=` => ${m.overscaledZ}`),Oe+=` ${me}kb`,function(ut,Bt){ut.initDebugOverlayCanvas();const tt=ut.debugOverlayCanvas,wt=ut.context.gl,pt=ut.debugOverlayCanvas.getContext("2d");pt.clearRect(0,0,tt.width,tt.height),pt.shadowColor="white",pt.shadowBlur=2,pt.lineWidth=1.5,pt.strokeStyle="white",pt.textBaseline="top",pt.font="bold 36px Open Sans, sans-serif",pt.fillText(Bt,5,5),pt.strokeText(Bt,5,5),ut.debugOverlayTexture.update(tt),ut.debugOverlayTexture.bind(wt.LINEAR,wt.CLAMP_TO_EDGE)}(v,Oe);const De=F._tileDebugTextBuffer||v.debugBuffer,Xe=F._tileDebugTextIndexBuffer||v.quadTriangleIndexBuffer,ot=F._tileDebugTextSegments||v.debugSegments;H.draw(b,E.TRIANGLES,X,re,a.ColorMode.alphaBlended,a.CullFaceMode.disabled,jh(L,a.Color.transparent,Pe),le,De,Xe,ot,null,null,null,[F._globeTileDebugTextBuffer])}function El(v,f,m,b){Fh(v,0,f+m/2,v.transform.width,m,b)}function qc(v,f,m,b){Fh(v,f-m/2,0,m,v.transform.height,b)}function Fh(v,f,m,b,x,E){const P=v.context,I=P.gl;I.enable(I.SCISSOR_TEST),I.scissor(f*a.exported.devicePixelRatio,m*a.exported.devicePixelRatio,b*a.exported.devicePixelRatio,x*a.exported.devicePixelRatio),P.clear({color:E}),I.disable(I.SCISSOR_TEST)}const Xc=a.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:Zc}=Xc;function Vs(v,f,m,b){v.emplaceBack(f,m,b)}class Cm{constructor(f){this.vertexArray=new a.StructArrayLayout3f12,this.indices=new a.StructArrayLayout3ui6,Vs(this.vertexArray,-1,-1,1),Vs(this.vertexArray,1,-1,1),Vs(this.vertexArray,-1,1,1),Vs(this.vertexArray,1,1,1),Vs(this.vertexArray,-1,-1,-1),Vs(this.vertexArray,1,-1,-1),Vs(this.vertexArray,-1,1,-1),Vs(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=f.createVertexBuffer(this.vertexArray,Zc),this.indexBuffer=f.createIndexBuffer(this.indices),this.segment=a.SegmentVector.simpleSegment(0,0,36,12)}}function un(v,f,m,b,x,E){const P=v.gl,I=f.paint.get("sky-atmosphere-color"),L=f.paint.get("sky-atmosphere-halo-color"),H=f.paint.get("sky-atmosphere-sun-intensity"),F=((X,re,oe,le,ue)=>({u_matrix_3f:X,u_sun_direction:re,u_sun_intensity:oe,u_color_tint_r:[le.r,le.g,le.b,le.a],u_color_tint_m:[ue.r,ue.g,ue.b,ue.a],u_luminance:5e-5}))(a.fromMat4(a.create$1(),b),x,H,I,L);P.framebufferTexture2D(P.FRAMEBUFFER,P.COLOR_ATTACHMENT0,P.TEXTURE_CUBE_MAP_POSITIVE_X+E,f.skyboxTexture,0),m.draw(v,P.TRIANGLES,a.DepthMode.disabled,a.StencilMode.disabled,a.ColorMode.unblended,a.CullFaceMode.frontCW,F,"skyboxCapture",f.skyboxGeometry.vertexBuffer,f.skyboxGeometry.indexBuffer,f.skyboxGeometry.segment)}const Em=a.createLayout([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class _I{constructor(f){const m=new a.StructArrayLayout5f20;m.emplaceBack(-1,1,1,0,0),m.emplaceBack(1,1,1,1,0),m.emplaceBack(1,-1,1,1,1),m.emplaceBack(-1,-1,1,0,1);const b=new a.StructArrayLayout3ui6;b.emplaceBack(0,1,2),b.emplaceBack(2,3,0),this.vertexBuffer=f.createVertexBuffer(m,Em.members),this.indexBuffer=f.createIndexBuffer(b),this.segments=a.SegmentVector.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const Nb={symbol:function(v,f,m,b,x){if(v.renderPass!=="translucent")return;const E=a.StencilMode.disabled,P=v.colorModeForRenderPass();m.layout.get("text-variable-anchor")&&function(I,L,H,F,X,re,oe){const le=L.transform,ue=X==="map",ce=re==="map";for(const te of I){const ge=F.getTile(te),me=ge.getBucket(H);if(!me||!me.text||!me.text.segments.get().length)continue;const be=a.evaluateSizeForZoom(me.textSizeData,le.zoom),Pe=am(te,me.getProjection(),le),Oe=le.calculatePixelsToTileUnitsMatrix(ge),De=jc(Pe,ge.tileID.canonical,ce,ue,le,me.getProjection(),Oe),Xe=H.layout.get("icon-text-fit")!=="none"&&me.hasIconData();if(be){const ot=Math.pow(2,le.zoom-ge.tileID.overscaledZ);Kc(me,ue,ce,oe,a.symbolSize,le,De,te,ot,be,Xe)}}}(b,v,m,f,m.layout.get("text-rotation-alignment"),m.layout.get("text-pitch-alignment"),x),m.paint.get("icon-opacity").constantOr(1)!==0&&GC(v,f,m,b,!1,m.paint.get("icon-translate"),m.paint.get("icon-translate-anchor"),m.layout.get("icon-rotation-alignment"),m.layout.get("icon-pitch-alignment"),m.layout.get("icon-keep-upright"),E,P),m.paint.get("text-opacity").constantOr(1)!==0&&GC(v,f,m,b,!0,m.paint.get("text-translate"),m.paint.get("text-translate-anchor"),m.layout.get("text-rotation-alignment"),m.layout.get("text-pitch-alignment"),m.layout.get("text-keep-upright"),E,P),f.map.showCollisionBoxes&&(UC(v,f,m,b,m.paint.get("text-translate"),m.paint.get("text-translate-anchor"),!0),UC(v,f,m,b,m.paint.get("icon-translate"),m.paint.get("icon-translate-anchor"),!1))},circle:function(v,f,m,b){if(v.renderPass!=="translucent")return;const x=m.paint.get("circle-opacity"),E=m.paint.get("circle-stroke-width"),P=m.paint.get("circle-stroke-opacity"),I=m.layout.get("circle-sort-key").constantOr(1)!==void 0;if(x.constantOr(1)===0&&(E.constantOr(1)===0||P.constantOr(1)===0))return;const L=v.context,H=L.gl,F=v.transform,X=v.depthModeForSublayer(0,a.DepthMode.ReadOnly),re=a.StencilMode.disabled,oe=v.colorModeForRenderPass(),le=F.projection.name==="globe",ue=[a.mercatorXfromLng(F.center.lng),a.mercatorYfromLat(F.center.lat)],ce=[];for(let ge=0;ge<b.length;ge++){const me=b[ge],be=f.getTile(me),Pe=be.getBucket(m);if(!Pe||Pe.projection.name!==F.projection.name)continue;const Oe=Pe.programConfigurations.get(m.id),De=Bh(m);le&&De.push("PROJECTION_GLOBE_VIEW");const Xe=v.useProgram("circle",Oe,De),ot=Pe.layoutVertexBuffer,ut=Pe.globeExtVertexBuffer,Bt=Pe.indexBuffer,tt=F.projection.createInversionMatrix(F,me.canonical),wt={programConfiguration:Oe,program:Xe,layoutVertexBuffer:ot,globeExtVertexBuffer:ut,indexBuffer:Bt,uniformValues:Nh(v,me,be,tt,ue,m),tile:be};if(I){const pt=Pe.segments.get();for(const Ot of pt)ce.push({segments:new a.SegmentVector([Ot]),sortKey:Ot.sortKey,state:wt})}else ce.push({segments:Pe.segments,sortKey:0,state:wt})}I&&ce.sort((ge,me)=>ge.sortKey-me.sortKey);const te={useDepthForOcclusion:!le};for(const ge of ce){const{programConfiguration:me,program:be,layoutVertexBuffer:Pe,globeExtVertexBuffer:Oe,indexBuffer:De,uniformValues:Xe,tile:ot}=ge.state,ut=ge.segments;v.terrain&&v.terrain.setupElevationDraw(ot,be,te),v.prepareDrawProgram(L,be,ot.tileID.toUnwrapped()),be.draw(L,H.TRIANGLES,X,re,oe,a.CullFaceMode.disabled,Xe,m.id,Pe,De,ut,m.paint,F.zoom,me,[Oe])}},heatmap:function(v,f,m,b){if(m.paint.get("heatmap-opacity")!==0)if(v.renderPass==="offscreen"){const x=v.context,E=x.gl,P=a.StencilMode.disabled,I=new a.ColorMode([E.ONE,E.ONE],a.Color.transparent,[!0,!0,!0,!0]);(function(oe,le,ue,ce){const te=oe.gl,ge=le.width*ce,me=le.height*ce;oe.activeTexture.set(te.TEXTURE1),oe.viewport.set([0,0,ge,me]);let be=ue.heatmapFbo;if(!be||be&&(be.width!==ge||be.height!==me)){be&&be.destroy();const Pe=te.createTexture();te.bindTexture(te.TEXTURE_2D,Pe),te.texParameteri(te.TEXTURE_2D,te.TEXTURE_WRAP_S,te.CLAMP_TO_EDGE),te.texParameteri(te.TEXTURE_2D,te.TEXTURE_WRAP_T,te.CLAMP_TO_EDGE),te.texParameteri(te.TEXTURE_2D,te.TEXTURE_MIN_FILTER,te.LINEAR),te.texParameteri(te.TEXTURE_2D,te.TEXTURE_MAG_FILTER,te.LINEAR),be=ue.heatmapFbo=oe.createFramebuffer(ge,me,!1),function(Oe,De,Xe,ot,ut,Bt){const tt=Oe.gl;tt.texImage2D(tt.TEXTURE_2D,0,Oe.isWebGL2&&Oe.extRenderToTextureHalfFloat?tt.RGBA16F:tt.RGBA,ut,Bt,0,tt.RGBA,Oe.extRenderToTextureHalfFloat?Oe.isWebGL2?tt.HALF_FLOAT:Oe.extTextureHalfFloat.HALF_FLOAT_OES:tt.UNSIGNED_BYTE,null),ot.colorAttachment.set(Xe)}(oe,0,Pe,be,ge,me)}else te.bindTexture(te.TEXTURE_2D,be.colorAttachment.get()),oe.bindFramebuffer.set(be.framebuffer)})(x,v,m,v.transform.projection.name==="globe"?.5:.25),x.clear({color:a.Color.transparent});const L=v.transform,H=L.projection.name==="globe",F=H?["PROJECTION_GLOBE_VIEW"]:null,X=H?a.CullFaceMode.frontCCW:a.CullFaceMode.disabled,re=[a.mercatorXfromLng(L.center.lng),a.mercatorYfromLat(L.center.lat)];for(let oe=0;oe<b.length;oe++){const le=b[oe];if(f.hasRenderableParent(le))continue;const ue=f.getTile(le),ce=ue.getBucket(m);if(!ce||ce.projection.name!==L.projection.name)continue;const te=ce.programConfigurations.get(m.id),ge=v.useProgram("heatmap",te,F),{zoom:me}=v.transform;v.terrain&&v.terrain.setupElevationDraw(ue,ge),v.prepareDrawProgram(x,ge,le.toUnwrapped());const be=L.projection.createInversionMatrix(L,le.canonical);ge.draw(x,E.TRIANGLES,a.DepthMode.disabled,P,I,X,ms(v,le,ue,be,re,me,m.paint.get("heatmap-intensity")),m.id,ce.layoutVertexBuffer,ce.indexBuffer,ce.segments,m.paint,v.transform.zoom,te,H?[ce.globeExtVertexBuffer]:null)}x.viewport.set([0,0,v.width,v.height])}else v.renderPass==="translucent"&&(v.context.setColorMode(v.colorModeForRenderPass()),function(x,E){const P=x.context,I=P.gl,L=E.heatmapFbo;if(!L)return;P.activeTexture.set(I.TEXTURE0),I.bindTexture(I.TEXTURE_2D,L.colorAttachment.get()),P.activeTexture.set(I.TEXTURE1);let H=E.colorRampTexture;H||(H=E.colorRampTexture=new a.Texture(P,E.colorRamp,I.RGBA)),H.bind(I.LINEAR,I.CLAMP_TO_EDGE),x.useProgram("heatmapTexture").draw(P,I.TRIANGLES,a.DepthMode.disabled,a.StencilMode.disabled,x.colorModeForRenderPass(),a.CullFaceMode.disabled,((F,X,re,oe)=>({u_image:0,u_color_ramp:1,u_opacity:X.paint.get("heatmap-opacity")}))(0,E),E.id,x.viewportBuffer,x.quadTriangleIndexBuffer,x.viewportSegments,E.paint,x.transform.zoom)}(v,m))},line:function(v,f,m,b){if(v.renderPass!=="translucent")return;const x=m.paint.get("line-opacity"),E=m.paint.get("line-width");if(x.constantOr(1)===0||E.constantOr(1)===0)return;const P=v.depthModeForSublayer(0,a.DepthMode.ReadOnly),I=v.colorModeForRenderPass(),L=v.terrain&&v.terrain.renderingToTexture?1:a.exported.devicePixelRatio,H=m.paint.get("line-dasharray"),F=H.constantOr(1),X=m.layout.get("line-cap"),re=m.paint.get("line-pattern"),oe=re.constantOr(1),le=m.paint.get("line-gradient"),ue=oe?"linePattern":"line",ce=v.context,te=ce.gl,ge=(be=>{const Pe=[];xm(be)&&Pe.push("RENDER_LINE_DASH"),be.paint.get("line-gradient")&&Pe.push("RENDER_LINE_GRADIENT");const Oe=be.paint.get("line-trim-offset");Oe[0]===0&&Oe[1]===0||Pe.push("RENDER_LINE_TRIM_OFFSET");const De=be.paint.get("line-pattern").constantOr(1),Xe=be.paint.get("line-opacity").constantOr(1)!==1;return!De&&Xe&&Pe.push("RENDER_LINE_ALPHA_DISCARD"),Pe})(m);let me=ge.includes("RENDER_LINE_ALPHA_DISCARD");v.terrain&&v.terrain.clipOrMaskOverlapStencilType()&&(me=!1);for(const be of b){const Pe=f.getTile(be);if(oe&&!Pe.patternsLoaded())continue;const Oe=Pe.getBucket(m);if(!Oe)continue;v.prepareDrawTile();const De=Oe.programConfigurations.get(m.id),Xe=v.useProgram(ue,De,ge),ot=re.constantOr(null);if(ot&&Pe.imageAtlas){const Ye=Pe.imageAtlas.patternPositions[ot.toString()];Ye&&De.setConstantPatternPositions(Ye)}const ut=H.constantOr(null),Bt=X.constantOr(null);if(!oe&&ut&&Bt&&Pe.lineAtlas){const Ye=Pe.lineAtlas.getDash(ut,Bt);Ye&&De.setConstantPatternPositions(Ye)}let[tt,wt]=m.paint.get("line-trim-offset");(Bt==="round"||Bt==="square")&&tt!==wt&&(tt===0&&(tt-=1),wt===1&&(wt+=1));const pt=v.terrain?be.projMatrix:null,Ot=oe?FC(v,Pe,m,pt,L):Ob(v,Pe,m,pt,Oe.lineClipsArray.length,L,[tt,wt]);if(le){const Ye=Oe.gradients[m.id];let ct=Ye.texture;if(m.gradientVersion!==Ye.version){let Et=256;if(m.stepInterpolant){const Mt=f.getSource().maxzoom,ur=be.canonical.z===Mt?Math.ceil(1<<v.transform.maxZoom-be.canonical.z):1;Et=a.clamp(a.nextPowerOfTwo(Oe.maxLineLength/a.EXTENT*1024*ur),256,ce.maxTextureSize)}Ye.gradient=a.renderColorRamp({expression:m.gradientExpression(),evaluationKey:"lineProgress",resolution:Et,image:Ye.gradient||void 0,clips:Oe.lineClipsArray}),Ye.texture?Ye.texture.update(Ye.gradient):Ye.texture=new a.Texture(ce,Ye.gradient,te.RGBA),Ye.version=m.gradientVersion,ct=Ye.texture}ce.activeTexture.set(te.TEXTURE1),ct.bind(m.stepInterpolant?te.NEAREST:te.LINEAR,te.CLAMP_TO_EDGE)}F&&(ce.activeTexture.set(te.TEXTURE0),Pe.lineAtlasTexture.bind(te.LINEAR,te.REPEAT),De.updatePaintBuffers()),oe&&(ce.activeTexture.set(te.TEXTURE0),Pe.imageAtlasTexture.bind(te.LINEAR,te.CLAMP_TO_EDGE),De.updatePaintBuffers()),v.prepareDrawProgram(ce,Xe,be.toUnwrapped());const at=Ye=>{Xe.draw(ce,te.TRIANGLES,P,Ye,I,a.CullFaceMode.disabled,Ot,m.id,Oe.layoutVertexBuffer,Oe.indexBuffer,Oe.segments,m.paint,v.transform.zoom,De,[Oe.layoutVertexBuffer2])};if(me){const Ye=v.stencilModeForClipping(be).ref;Ye===0&&v.terrain&&ce.clear({stencil:0});const ct={func:te.EQUAL,mask:255};Ot.u_alpha_discard_threshold=.8,at(new a.StencilMode(ct,Ye,255,te.KEEP,te.KEEP,te.INVERT)),Ot.u_alpha_discard_threshold=0,at(new a.StencilMode(ct,Ye,255,te.KEEP,te.KEEP,te.KEEP))}else at(v.stencilModeForClipping(be))}me&&(v.resetStencilClippingMasks(),v.terrain&&ce.clear({stencil:0}))},fill:function(v,f,m,b){const x=m.paint.get("fill-color"),E=m.paint.get("fill-opacity");if(E.constantOr(1)===0)return;const P=v.colorModeForRenderPass(),I=m.paint.get("fill-pattern"),L=v.opaquePassEnabledForLayer()&&!I.constantOr(1)&&x.constantOr(a.Color.transparent).a===1&&E.constantOr(0)===1?"opaque":"translucent";if(v.renderPass===L){const H=v.depthModeForSublayer(1,v.renderPass==="opaque"?a.DepthMode.ReadWrite:a.DepthMode.ReadOnly);KC(v,f,m,b,H,P,!1)}if(v.renderPass==="translucent"&&m.paint.get("fill-antialias")){const H=v.depthModeForSublayer(m.getPaintProperty("fill-outline-color")?2:0,a.DepthMode.ReadOnly);KC(v,f,m,b,H,P,!0)}},"fill-extrusion":function(v,f,m,b){const x=m.paint.get("fill-extrusion-opacity");if(x!==0&&v.renderPass==="translucent"){const E=new a.DepthMode(v.context.gl.LEQUAL,a.DepthMode.ReadWrite,v.depthRangeFor3D);if(x!==1||m.paint.get("fill-extrusion-pattern").constantOr(1))Mb(v,f,m,b,E,a.StencilMode.disabled,a.ColorMode.disabled),Mb(v,f,m,b,E,v.stencilModeFor3D(),v.colorModeForRenderPass()),v.resetStencilClippingMasks();else{const P=v.colorModeForRenderPass();Mb(v,f,m,b,E,a.StencilMode.disabled,P)}}},hillshade:function(v,f,m,b){if(v.renderPass!=="offscreen"&&v.renderPass!=="translucent")return;const x=v.context,E=v.depthModeForSublayer(0,a.DepthMode.ReadOnly),P=v.colorModeForRenderPass(),I=v.terrain&&v.terrain.renderingToTexture,[L,H]=v.renderPass!=="translucent"||I?[{},b]:v.stencilConfigForOverlap(b);for(const F of H){const X=f.getTile(F);if(X.needsHillshadePrepare&&v.renderPass==="offscreen")mm(v,X,m,E,a.StencilMode.disabled,P);else if(v.renderPass==="translucent"){const re=I&&v.terrain?v.terrain.stencilModeForRTTOverlap(F):L[F.overscaledZ];Dh(v,F,X,m,E,re,P)}}x.viewport.set([0,0,v.width,v.height]),v.resetStencilClippingMasks()},raster:function(v,f,m,b,x,E){if(v.renderPass!=="translucent"||m.paint.get("raster-opacity")===0||!b.length)return;const P=v.context,I=P.gl,L=f.getSource(),H=v.useProgram("raster"),F=v.colorModeForRenderPass(),X=v.terrain&&v.terrain.renderingToTexture,[re,oe]=L instanceof Ae||X?[{},b]:v.stencilConfigForOverlap(b),le=oe[oe.length-1].overscaledZ,ue=!v.options.moving;for(const ce of oe){const te=X?a.DepthMode.disabled:v.depthModeForSublayer(ce.overscaledZ-le,m.paint.get("raster-opacity")===1?a.DepthMode.ReadWrite:a.DepthMode.ReadOnly,I.LESS),ge=ce.toUnwrapped(),me=f.getTile(ce);if(X&&(!me||!me.hasData()))continue;const be=X?ce.projMatrix:v.transform.calculateProjMatrix(ge,ue),Pe=v.terrain&&X?v.terrain.stencilModeForRTTOverlap(ce):re[ce.overscaledZ],Oe=E?0:m.paint.get("raster-fade-duration");me.registerFadeDuration(Oe);const De=f.findLoadedParent(ce,0),Xe=Lh(me,De,f,v.transform,Oe);let ot,ut;v.terrain&&v.terrain.prepareDrawTile();const Bt=m.paint.get("raster-resampling")==="nearest"?I.NEAREST:I.LINEAR;P.activeTexture.set(I.TEXTURE0),me.texture.bind(Bt,I.CLAMP_TO_EDGE),P.activeTexture.set(I.TEXTURE1),De?(De.texture.bind(Bt,I.CLAMP_TO_EDGE),ot=Math.pow(2,De.tileID.overscaledZ-me.tileID.overscaledZ),ut=[me.tileID.canonical.x*ot%1,me.tileID.canonical.y*ot%1]):me.texture.bind(Bt,I.CLAMP_TO_EDGE),me.texture.useMipmap&&P.extTextureFilterAnisotropic&&v.transform.pitch>20&&I.texParameterf(I.TEXTURE_2D,P.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,P.extTextureFilterAnisotropicMax);const tt=pI(be,ut||[0,0],ot||1,Xe,m,L instanceof Ae?L.perspectiveTransform:[0,0]);if(v.prepareDrawProgram(P,H,ge),L instanceof Ae)L.boundsBuffer&&L.boundsSegments&&H.draw(P,I.TRIANGLES,te,a.StencilMode.disabled,F,a.CullFaceMode.disabled,tt,m.id,L.boundsBuffer,v.quadTriangleIndexBuffer,L.boundsSegments);else{const{tileBoundsBuffer:wt,tileBoundsIndexBuffer:pt,tileBoundsSegments:Ot}=v.getTileBoundsBuffers(me);H.draw(P,I.TRIANGLES,te,Pe,F,a.CullFaceMode.disabled,tt,m.id,wt,pt,Ot)}}v.resetStencilClippingMasks()},background:function(v,f,m,b){const x=m.paint.get("background-color"),E=m.paint.get("background-opacity");if(E===0)return;const P=v.context,I=P.gl,L=v.transform,H=L.tileSize,F=m.paint.get("background-pattern");if(v.isPatternMissing(F))return;const X=!F&&x.a===1&&E===1&&v.opaquePassEnabledForLayer()?"opaque":"translucent";if(v.renderPass!==X)return;const re=a.StencilMode.disabled,oe=v.depthModeForSublayer(0,X==="opaque"?a.DepthMode.ReadWrite:a.DepthMode.ReadOnly),le=v.colorModeForRenderPass(),ue=v.useProgram(F?"backgroundPattern":"background");let ce,te=b;te||(ce=v.getBackgroundTiles(),te=Object.values(ce).map(ge=>ge.tileID)),F&&(P.activeTexture.set(I.TEXTURE0),v.imageManager.bind(v.context));for(const ge of te){const me=ge.toUnwrapped(),be=b?ge.projMatrix:v.transform.calculateProjMatrix(me);v.prepareDrawTile();const Pe=f?f.getTile(ge):ce?ce[ge.key]:new a.Tile(ge,H,L.zoom,v),Oe=F?Ab(be,E,v,F,{tileID:ge,tileSize:H}):mI(be,E,x);v.prepareDrawProgram(P,ue,me);const{tileBoundsBuffer:De,tileBoundsIndexBuffer:Xe,tileBoundsSegments:ot}=v.getTileBoundsBuffers(Pe);ue.draw(P,I.TRIANGLES,oe,re,le,a.CullFaceMode.disabled,Oe,m.id,De,Xe,ot)}},sky:function(v,f,m){const b=v.transform,x=b.projection.name==="mercator"||b.projection.name==="globe"?1:a.smoothstep(7,8,b.zoom),E=m.paint.get("sky-opacity")*x;if(E===0)return;const P=v.context,I=m.paint.get("sky-type"),L=new a.DepthMode(P.gl.LEQUAL,a.DepthMode.ReadOnly,[0,1]),H=v.frameCounter/1e3%1;I==="atmosphere"?v.renderPass==="offscreen"?m.needsSkyboxCapture(v)&&(function(F,X,re,oe){const le=F.context,ue=le.gl;let ce=X.skyboxFbo;if(!ce){ce=X.skyboxFbo=le.createFramebuffer(32,32,!1),X.skyboxGeometry=new Cm(le),X.skyboxTexture=le.gl.createTexture(),ue.bindTexture(ue.TEXTURE_CUBE_MAP,X.skyboxTexture),ue.texParameteri(ue.TEXTURE_CUBE_MAP,ue.TEXTURE_WRAP_S,ue.CLAMP_TO_EDGE),ue.texParameteri(ue.TEXTURE_CUBE_MAP,ue.TEXTURE_WRAP_T,ue.CLAMP_TO_EDGE),ue.texParameteri(ue.TEXTURE_CUBE_MAP,ue.TEXTURE_MIN_FILTER,ue.LINEAR),ue.texParameteri(ue.TEXTURE_CUBE_MAP,ue.TEXTURE_MAG_FILTER,ue.LINEAR);for(let be=0;be<6;++be)ue.texImage2D(ue.TEXTURE_CUBE_MAP_POSITIVE_X+be,0,ue.RGBA,32,32,0,ue.RGBA,ue.UNSIGNED_BYTE,null)}le.bindFramebuffer.set(ce.framebuffer),le.viewport.set([0,0,32,32]);const te=X.getCenter(F,!0),ge=F.useProgram("skyboxCapture"),me=new Float64Array(16);a.identity(me),a.rotateY(me,me,.5*-Math.PI),un(le,X,ge,me,te,0),a.identity(me),a.rotateY(me,me,.5*Math.PI),un(le,X,ge,me,te,1),a.identity(me),a.rotateX(me,me,.5*-Math.PI),un(le,X,ge,me,te,2),a.identity(me),a.rotateX(me,me,.5*Math.PI),un(le,X,ge,me,te,3),a.identity(me),un(le,X,ge,me,te,4),a.identity(me),a.rotateY(me,me,Math.PI),un(le,X,ge,me,te,5),le.viewport.set([0,0,F.width,F.height])}(v,m),m.markSkyboxValid(v)):v.renderPass==="sky"&&function(F,X,re,oe,le){const ue=F.context,ce=ue.gl,te=F.transform,ge=F.useProgram("skybox");ue.activeTexture.set(ce.TEXTURE0),ce.bindTexture(ce.TEXTURE_CUBE_MAP,X.skyboxTexture);const me=((be,Pe,Oe,De,Xe)=>({u_matrix:be,u_sun_direction:Pe,u_cubemap:0,u_opacity:De,u_temporal_offset:Xe}))(te.skyboxMatrix,X.getCenter(F,!1),0,oe,le);F.prepareDrawProgram(ue,ge),ge.draw(ue,ce.TRIANGLES,re,a.StencilMode.disabled,F.colorModeForRenderPass(),a.CullFaceMode.backCW,me,"skybox",X.skyboxGeometry.vertexBuffer,X.skyboxGeometry.indexBuffer,X.skyboxGeometry.segment)}(v,m,L,E,H):I==="gradient"&&v.renderPass==="sky"&&function(F,X,re,oe,le){const ue=F.context,ce=ue.gl,te=F.transform,ge=F.useProgram("skyboxGradient");X.skyboxGeometry||(X.skyboxGeometry=new Cm(ue)),ue.activeTexture.set(ce.TEXTURE0);let me=X.colorRampTexture;me||(me=X.colorRampTexture=new a.Texture(ue,X.colorRamp,ce.RGBA)),me.bind(ce.LINEAR,ce.CLAMP_TO_EDGE);const be=((Pe,Oe,De,Xe,ot)=>({u_matrix:Pe,u_color_ramp:0,u_center_direction:Oe,u_radius:a.degToRad(De),u_opacity:Xe,u_temporal_offset:ot}))(te.skyboxMatrix,X.getCenter(F,!1),X.paint.get("sky-gradient-radius"),oe,le);F.prepareDrawProgram(ue,ge),ge.draw(ue,ce.TRIANGLES,re,a.StencilMode.disabled,F.colorModeForRenderPass(),a.CullFaceMode.backCW,be,"skyboxGradient",X.skyboxGeometry.vertexBuffer,X.skyboxGeometry.indexBuffer,X.skyboxGeometry.segment)}(v,m,L,E,H)},debug:function(v,f,m){for(let b=0;b<m.length;b++)Lb(v,f,m[b])},custom:function(v,f,m,b){const x=v.context,E=m.implementation;if(!v.transform.projection.unsupportedLayers||!v.transform.projection.unsupportedLayers.includes("custom")||v.terrain&&(v.terrain.renderingToTexture||v.renderPass==="offscreen")&&m.isLayerDraped()){if(v.renderPass==="offscreen"){const P=E.prerender;if(P){if(v.setCustomLayerDefaults(),x.setColorMode(v.colorModeForRenderPass()),v.transform.projection.name==="globe"){const I=v.transform.pointMerc;P.call(E,x.gl,v.transform.customLayerMatrix(),v.transform.getProjection(),v.transform.globeToMercatorMatrix(),a.globeToMercatorTransition(v.transform.zoom),[I.x,I.y],v.transform.pixelsPerMeterRatio)}else P.call(E,x.gl,v.transform.customLayerMatrix());x.setDirty(),v.setBaseState()}}else if(v.renderPass==="translucent"){if(v.terrain&&v.terrain.renderingToTexture){const I=E.renderToTile;if(I){const L=b[0].canonical,H=new a.MercatorCoordinate(L.x+b[0].wrap*(1<<L.z),L.y,L.z);x.setDepthMode(a.DepthMode.disabled),x.setStencilMode(a.StencilMode.disabled),x.setColorMode(v.colorModeForRenderPass()),v.setCustomLayerDefaults(),I.call(E,x.gl,H),x.setDirty(),v.setBaseState()}return}v.setCustomLayerDefaults(),x.setColorMode(v.colorModeForRenderPass()),x.setStencilMode(a.StencilMode.disabled);const P=E.renderingMode==="3d"?new a.DepthMode(v.context.gl.LEQUAL,a.DepthMode.ReadWrite,v.depthRangeFor3D):v.depthModeForSublayer(0,a.DepthMode.ReadOnly);if(x.setDepthMode(P),v.transform.projection.name==="globe"){const I=v.transform.pointMerc;E.render(x.gl,v.transform.customLayerMatrix(),v.transform.getProjection(),v.transform.globeToMercatorMatrix(),a.globeToMercatorTransition(v.transform.zoom),[I.x,I.y],v.transform.pixelsPerMeterRatio)}else E.render(x.gl,v.transform.customLayerMatrix());x.setDirty(),v.setBaseState(),x.bindFramebuffer.set(null)}}else a.warnOnce("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")}};class Hh{constructor(f,m,b=!1){this.context=new de(f,b),this.transform=m,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=a.SourceCache.maxUnderzooming+a.SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new PC,this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={}}updateTerrain(f,m){const b=!!f&&!!f.terrain&&this.transform.projection.supportsTerrain;if(!(b||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new xb(this,f));const x=this._terrain;this.transform.elevation=b?x:null,x.update(f,this.transform,m)}_updateFog(f){const m=f.fog;if(!m||this.transform.projection.name==="globe"||m.getOpacity(this.transform.pitch)<1||m.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[b,x]=m.getFovAdjustedRange(this.transform._fov);if(b>x)return void(this.transform.fogCullDistSq=null);const E=b+.78*(x-b);this.transform.fogCullDistSq=E*E}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}resize(f,m){if(this.width=f*a.exported.devicePixelRatio,this.height=m*a.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const b of this.style.order)this.style._layers[b].resize()}setup(){const f=this.context,m=new a.StructArrayLayout2i4;m.emplaceBack(0,0),m.emplaceBack(a.EXTENT,0),m.emplaceBack(0,a.EXTENT),m.emplaceBack(a.EXTENT,a.EXTENT),this.tileExtentBuffer=f.createVertexBuffer(m,a.posAttributes.members),this.tileExtentSegments=a.SegmentVector.simpleSegment(0,0,4,2);const b=new a.StructArrayLayout2i4;b.emplaceBack(0,0),b.emplaceBack(a.EXTENT,0),b.emplaceBack(0,a.EXTENT),b.emplaceBack(a.EXTENT,a.EXTENT),this.debugBuffer=f.createVertexBuffer(b,a.posAttributes.members),this.debugSegments=a.SegmentVector.simpleSegment(0,0,4,5);const x=new a.StructArrayLayout2i4;x.emplaceBack(-1,-1),x.emplaceBack(1,-1),x.emplaceBack(-1,1),x.emplaceBack(1,1),this.viewportBuffer=f.createVertexBuffer(x,a.posAttributes.members),this.viewportSegments=a.SegmentVector.simpleSegment(0,0,4,2);const E=new a.StructArrayLayout4i8;E.emplaceBack(0,0,0,0),E.emplaceBack(a.EXTENT,0,a.EXTENT,0),E.emplaceBack(0,a.EXTENT,0,a.EXTENT),E.emplaceBack(a.EXTENT,a.EXTENT,a.EXTENT,a.EXTENT),this.mercatorBoundsBuffer=f.createVertexBuffer(E,a.boundsAttributes.members),this.mercatorBoundsSegments=a.SegmentVector.simpleSegment(0,0,4,2);const P=new a.StructArrayLayout3ui6;P.emplaceBack(0,1,2),P.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=f.createIndexBuffer(P);const I=new a.StructArrayLayout1ui2;for(const H of[0,1,3,2,0])I.emplaceBack(H);this.debugIndexBuffer=f.createIndexBuffer(I),this.emptyTexture=new a.Texture(f,new a.RGBAImage({width:1,height:1},Uint8Array.of(0,0,0,0)),f.gl.RGBA),this.identityMat=a.create();const L=this.context.gl;this.stencilClearMode=new a.StencilMode({func:L.ALWAYS,mask:0},0,255,L.ZERO,L.ZERO,L.ZERO),this.loadTimeStamps.push(a.window.performance.now()),this.atmosphereBuffer=new _I(this.context)}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(f){return f._makeTileBoundsBuffers(this.context,this.transform.projection),f._tileBoundsBuffer?{tileBoundsBuffer:f._tileBoundsBuffer,tileBoundsIndexBuffer:f._tileBoundsIndexBuffer,tileBoundsSegments:f._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const f=this.context,m=f.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.useProgram("clippingMask").draw(f,m.TRIANGLES,a.DepthMode.disabled,this.stencilClearMode,a.ColorMode.disabled,a.CullFaceMode.disabled,mn(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(f,m,b){if(!m||this.currentStencilSource===m.id||!f.isTileClipped()||!b||b.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let I=!1;for(const L of b)if(this._tileClippingMaskIDs[L.key]===void 0){I=!0;break}if(!I)return}this.currentStencilSource=m.id;const x=this.context,E=x.gl;this.nextStencilID+b.length>256&&this.clearStencil(),x.setColorMode(a.ColorMode.disabled),x.setDepthMode(a.DepthMode.disabled);const P=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const I of b){const L=m.getTile(I),H=this._tileClippingMaskIDs[I.key]=this.nextStencilID++,{tileBoundsBuffer:F,tileBoundsIndexBuffer:X,tileBoundsSegments:re}=this.getTileBoundsBuffers(L);P.draw(x,E.TRIANGLES,a.DepthMode.disabled,new a.StencilMode({func:E.ALWAYS,mask:0},H,255,E.KEEP,E.KEEP,E.REPLACE),a.ColorMode.disabled,a.CullFaceMode.disabled,mn(I.projMatrix),"$clipping",F,X,re)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const f=this.nextStencilID++,m=this.context.gl;return new a.StencilMode({func:m.NOTEQUAL,mask:255},f,255,m.KEEP,m.KEEP,m.REPLACE)}stencilModeForClipping(f){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(f);const m=this.context.gl;return new a.StencilMode({func:m.EQUAL,mask:255},this._tileClippingMaskIDs[f.key],0,m.KEEP,m.KEEP,m.REPLACE)}stencilConfigForOverlap(f){const m=this.context.gl,b=f.sort((P,I)=>I.overscaledZ-P.overscaledZ),x=b[b.length-1].overscaledZ,E=b[0].overscaledZ-x+1;if(E>1){this.currentStencilSource=void 0,this.nextStencilID+E>256&&this.clearStencil();const P={};for(let I=0;I<E;I++)P[I+x]=new a.StencilMode({func:m.GEQUAL,mask:255},I+this.nextStencilID,255,m.KEEP,m.KEEP,m.REPLACE);return this.nextStencilID+=E,[P,b]}return[{[x]:a.StencilMode.disabled},b]}colorModeForRenderPass(){const f=this.context.gl;return this._showOverdrawInspector?new a.ColorMode([f.CONSTANT_COLOR,f.ONE],new a.Color(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?a.ColorMode.unblended:a.ColorMode.alphaBlended}depthModeForSublayer(f,m,b){if(!this.opaquePassEnabledForLayer())return a.DepthMode.disabled;const x=1-((1+this.currentLayer)*this.numSublayers+f)*this.depthEpsilon;return new a.DepthMode(b||this.context.gl.LEQUAL,m,[x,x])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(f,m){this.style=f,this.options=m,this.imageManager=f.imageManager,this.glyphManager=f.glyphManager,this.symbolFadeChange=f.placement.symbolFadeChange(a.exported.now()),this.imageManager.beginFrame();const b=this.style.order,x=this.style._sourceCaches;for(const H in x){const F=x[H];F.used&&F.prepare(this.context)}const E={},P={},I={};for(const H in x){const F=x[H];E[H]=F.getVisibleCoordinates(),P[H]=E[H].slice().reverse(),I[H]=F.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let H=0;H<b.length;H++)if(this.style._layers[b[H]].is3D()){this.opaquePassCutoff=H;break}if(this.terrain&&(this.terrain.updateTileBinding(I),this.opaquePassCutoff=0),this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new a.GlobeSharedBuffers(this.context)),!a.isMapAuthenticated(this.context.gl))return;this.renderPass="offscreen";for(const H of b){const F=this.style._layers[H],X=f._getLayerSourceCache(F);if(!F.hasOffscreenPass()||F.isHidden(this.transform.zoom))continue;const re=X?P[X.id]:void 0;(F.type==="custom"||F.isSky()||re&&re.length)&&this.renderLayer(this,X,F,re)}this.depthRangeFor3D=[0,1-(f.order.length+2)*this.numSublayers*this.depthEpsilon];const L=this.terrain;if(L&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&L.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]),this.context.clear({color:m.showOverdrawInspector?a.Color.black:a.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=m.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=b.length-1;this.currentLayer>=0;this.currentLayer--){const H=this.style._layers[b[this.currentLayer]],F=f._getLayerSourceCache(H);if(H.isSky())continue;const X=F?P[F.id]:void 0;this._renderTileClippingMasks(H,F,X),this.renderLayer(this,F,H,X)}if(this.style.fog&&this.transform.projection.supportsFog&&function(H,F){const X=H.context,re=X.gl,oe=H.transform,le=new a.DepthMode(re.LEQUAL,a.DepthMode.ReadOnly,[0,1]),ue=H.useProgram("globeAtmosphere",null,oe.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"]),ce=a.globeToMercatorTransition(oe.zoom),te=F.properties.get("color").toArray01(),ge=F.properties.get("high-color").toArray01(),me=F.properties.get("space-color").toArray01PremultipliedAlpha(),be=a.identity$1([]);a.rotateY$1(be,be,-a.degToRad(oe._center.lng)),a.rotateX$1(be,be,a.degToRad(oe._center.lat)),a.rotateZ$1(be,be,oe.angle),a.rotateX$1(be,be,-oe._pitch);const Pe=a.fromQuat(new Float32Array(16),be),Oe=a.mapValue(F.properties.get("star-intensity"),0,1,0,.25),De=5e-4,Xe=a.mapValue(F.properties.get("horizon-blend"),0,1,De,.25),ot=a.globeUseCustomAntiAliasing(H,X,oe)&&Xe===De?oe.worldSize/(2*Math.PI*1.025)-1:oe.globeRadius,ut=H.frameCounter/1e3%1,Bt=a.length(oe.globeCenterInViewSpace),tt=Math.sqrt(Math.pow(Bt,2)-Math.pow(ot,2)),wt=Math.acos(tt/Bt),pt=((at,Ye,ct,Et,Mt,ur,Hr,rr,er,fr,Xr,gr,En,On)=>({u_frustum_tl:at,u_frustum_tr:Ye,u_frustum_br:ct,u_frustum_bl:Et,u_horizon:Mt,u_transition:ur,u_fadeout_range:Hr,u_color:rr,u_high_color:er,u_space_color:fr,u_star_intensity:Xr,u_star_size:5*a.exported.devicePixelRatio,u_star_density:0,u_temporal_offset:gr,u_horizon_angle:En,u_rotation_matrix:On}))(oe.frustumCorners.TL,oe.frustumCorners.TR,oe.frustumCorners.BR,oe.frustumCorners.BL,oe.frustumCorners.horizon,ce,Xe,te,ge,me,Oe,ut,wt,Pe);H.prepareDrawProgram(X,ue);const Ot=H.atmosphereBuffer;Ot&&ue.draw(X,re.TRIANGLES,le,a.StencilMode.disabled,a.ColorMode.alphaBlended,a.CullFaceMode.backCW,pt,"skybox",Ot.vertexBuffer,Ot.indexBuffer,Ot.segments)}(this,this.style.fog),this.renderPass="sky",(a.globeToMercatorTransition(this.transform.zoom)>0||this.transform.projection.name!=="globe")&&this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<b.length;this.currentLayer++){const H=this.style._layers[b[this.currentLayer]],F=f._getLayerSourceCache(H);H.isSky()&&this.renderLayer(this,F,H,F?P[F.id]:void 0)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<b.length;){const H=this.style._layers[b[this.currentLayer]],F=f._getLayerSourceCache(H);if(H.isSky()){++this.currentLayer;continue}if(this.terrain&&this.style.isLayerDraped(H)){if(H.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer);continue}const X=F?(H.type==="symbol"?I:P)[F.id]:void 0;this._renderTileClippingMasks(H,F,F?E[F.id]:void 0),this.renderLayer(this,F,H,X),++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let H=null;a.values(this.style._layers).forEach(F=>{const X=f._getLayerSourceCache(F);X&&!F.isHidden(this.transform.zoom)&&(!H||H.getSource().maxzoom<X.getSource().maxzoom)&&(H=X)}),H&&this.options.showTileBoundaries&&Nb.debug(this,H,H.getVisibleCoordinates())}this.options.showPadding&&function(H){const F=H.transform.padding;El(H,H.transform.height-(F.top||0),3,Db),El(H,F.bottom||0,3,$b),qc(H,F.left||0,3,qC),qc(H,H.transform.width-(F.right||0),3,XC);const X=H.transform.centerPoint;(function(re,oe,le,ue){Fh(re,oe-1,le-10,2,20,ue),Fh(re,oe-10,le-1,20,2,ue)})(H,X.x,H.transform.height-X.y,ZC)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(a.window.performance.now()),this.saveCanvasCopy())}renderLayer(f,m,b,x){b.isHidden(this.transform.zoom)||(b.type==="background"||b.type==="sky"||b.type==="custom"||x&&x.length)&&(this.id=b.id,this.gpuTimingStart(b),(!f.transform.projection.unsupportedLayers||!f.transform.projection.unsupportedLayers.includes(b.type)||f.terrain&&b.type==="custom")&&Nb[b.type](f,m,b,x,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(f){if(!this.options.gpuTiming)return;const m=this.context.extTimerQuery;let b=this.gpuTimers[f.id];b||(b=this.gpuTimers[f.id]={calls:0,cpuTime:0,query:m.createQueryEXT()}),b.calls++,m.beginQueryEXT(m.TIME_ELAPSED_EXT,b.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const f=this.context.extTimerQuery,m=f.createQueryEXT();this.deferredRenderGpuTimeQueries.push(m),f.beginQueryEXT(f.TIME_ELAPSED_EXT,m)}}gpuTimingDeferredRenderEnd(){if(!this.options.gpuTimingDeferredRender)return;const f=this.context.extTimerQuery;f.endQueryEXT(f.TIME_ELAPSED_EXT)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const f=this.context.extTimerQuery;f.endQueryEXT(f.TIME_ELAPSED_EXT)}collectGpuTimers(){const f=this.gpuTimers;return this.gpuTimers={},f}collectDeferredRenderGpuQueries(){const f=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],f}queryGpuTimers(f){const m={};for(const b in f){const x=f[b],E=this.context.extTimerQuery,P=E.getQueryObjectEXT(x.query,E.QUERY_RESULT_EXT)/1e6;E.deleteQueryEXT(x.query),m[b]=P}return m}queryGpuTimeDeferredRender(f){if(!this.options.gpuTimingDeferredRender)return 0;const m=this.context.extTimerQuery;let b=0;for(const x of f)b+=m.getQueryObjectEXT(x,m.QUERY_RESULT_EXT)/1e6,m.deleteQueryEXT(x);return b}translatePosMatrix(f,m,b,x,E){if(!b[0]&&!b[1])return f;const P=E?x==="map"?this.transform.angle:0:x==="viewport"?-this.transform.angle:0;if(P){const H=Math.sin(P),F=Math.cos(P);b=[b[0]*F-b[1]*H,b[0]*H+b[1]*F]}const I=[E?b[0]:ve(m,b[0],this.transform.zoom),E?b[1]:ve(m,b[1],this.transform.zoom),0],L=new Float32Array(16);return a.translate(L,f,I),L}saveTileTexture(f){const m=this._tileTextures[f.size[0]];m?m.push(f):this._tileTextures[f.size[0]]=[f]}getTileTexture(f){const m=this._tileTextures[f];return m&&m.length>0?m.pop():null}isPatternMissing(f){return f===null||f!==void 0&&!this.imageManager.getPattern(f.toString())}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture}currentGlobalDefines(){const f=this.terrain&&this.terrain.renderingToTexture,m=this.terrain&&this.terrain.exaggeration()===0,b=this.style&&this.style.fog,x=[];return this.terrainRenderModeElevated()&&x.push("TERRAIN"),this.transform.projection.name==="globe"&&x.push("GLOBE"),m&&x.push("ZERO_EXAGGERATION"),b&&!f&&b.getOpacity(this.transform.pitch)!==0&&x.push("FOG"),f&&x.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&x.push("OVERDRAW_INSPECTOR"),x}useProgram(f,m,b){this.cache=this.cache||{};const x=b||[],E=this.currentGlobalDefines().concat(x),P=Cb.cacheKey(gb[f],f,E,m);return this.cache[P]||(this.cache[P]=new Cb(this.context,f,gb[f],m,yI[f],E)),this.cache[P]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const f=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(f.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=a.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new a.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this.atmosphereBuffer&&this.atmosphereBuffer.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}prepareDrawProgram(f,m,b){if(this.terrain&&this.terrain.renderingToTexture)return;const x=this.style.fog;if(x){const E=x.getOpacity(this.transform.pitch),P=((I,L,H,F,X,re,oe,le,ue,ce,te)=>{const ge=I.transform,me=L.properties.get("color").toArray01();me[3]=F;const be=I.frameCounter/1e3%1;return{u_fog_matrix:H?ge.calculateFogTileMatrix(H):I.identityMat,u_fog_range:L.getFovAdjustedRange(ge._fov),u_fog_color:me,u_fog_horizon_blend:L.properties.get("horizon-blend"),u_fog_temporal_offset:be,u_frustum_tl:X,u_frustum_tr:re,u_frustum_br:oe,u_frustum_bl:le,u_globe_pos:ue,u_globe_radius:ce,u_viewport:te,u_globe_transition:a.globeToMercatorTransition(ge.zoom),u_is_globe:+(ge.projection.name==="globe")}})(this,x,b,E,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*a.exported.devicePixelRatio,this.transform.height*a.exported.devicePixelRatio]);m.setFogUniformValues(f,P)}}setTileLoadedFlag(f){this.tileLoaded=f}saveCanvasCopy(){const f=this.canvasCopy();f&&(this.frameCopies.push(f),this.tileLoaded=!1)}canvasCopy(){const f=this.context.gl,m=f.createTexture();return f.bindTexture(f.TEXTURE_2D,m),f.copyTexImage2D(f.TEXTURE_2D,0,f.RGBA,0,0,f.drawingBufferWidth,f.drawingBufferHeight,0),m}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const f=this.style&&this.style.fog;return!!f&&f.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const f=this._backgroundTiles,m=this._backgroundTiles={},b=this.transform.coveringTiles({tileSize:512});for(const x of b)m[x.key]=f[x.key]||new a.Tile(x,512,this.transform.tileZoom,this);return m}clearBackgroundTiles(){this._backgroundTiles={}}}class Bb{constructor(f=0,m=0,b=0,x=0){if(isNaN(f)||f<0||isNaN(m)||m<0||isNaN(b)||b<0||isNaN(x)||x<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=f,this.bottom=m,this.left=b,this.right=x}interpolate(f,m,b){return m.top!=null&&f.top!=null&&(this.top=a.number(f.top,m.top,b)),m.bottom!=null&&f.bottom!=null&&(this.bottom=a.number(f.bottom,m.bottom,b)),m.left!=null&&f.left!=null&&(this.left=a.number(f.left,m.left,b)),m.right!=null&&f.right!=null&&(this.right=a.number(f.right,m.right,b)),this}getCenter(f,m){const b=a.clamp((this.left+f-this.right)/2,0,f),x=a.clamp((this.top+m-this.bottom)/2,0,m);return new a.pointGeometry(b,x)}equals(f){return this.top===f.top&&this.bottom===f.bottom&&this.left===f.left&&this.right===f.right}clone(){return new Bb(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function JC(v,f){const m=a.getColumn(v,3);a.fromQuat(v,f),a.setColumn(v,3,m)}function Tm(v,f){const m=a.identity$1([]);return a.rotateZ$1(m,m,-f),a.rotateX$1(m,m,-v),m}function QC(v,f){const m=[v[0],v[1],0],b=[f[0],f[1],0];if(a.length(m)>=1e-15){const P=a.normalize([],m);a.scale$2(b,P,a.dot(b,P)),f[0]=b[0],f[1]=b[1]}const x=a.cross([],f,v);if(a.len(x)<1e-15)return null;const E=Math.atan2(-x[1],x[0]);return Tm(Math.atan2(Math.sqrt(v[0]*v[0]+v[1]*v[1]),-v[2]),E)}class Om{constructor(f,m){this.position=f,this.orientation=m}get position(){return this._position}set position(f){if(f){const m=f instanceof a.MercatorCoordinate?f:new a.MercatorCoordinate(f[0],f[1],f[2]);this._renderWorldCopies&&(m.x=a.wrap(m.x,0,1)),this._position=m}else this._position=null}lookAtPoint(f,m){if(this.orientation=null,!this.position)return;const b=this.position,x=this._elevation?this._elevation.getAtPointOrZero(a.MercatorCoordinate.fromLngLat(f)):0,E=a.MercatorCoordinate.fromLngLat(f,x),P=[E.x-b.x,E.y-b.y,E.z-b.z];m||(m=[0,0,1]),m[2]=Math.abs(m[2]),this.orientation=QC(P,m)}setPitchBearing(f,m){this.orientation=Tm(a.degToRad(f),a.degToRad(-m))}}class Jc{constructor(f,m){this._transform=a.identity([]),this.orientation=m,this.position=f}get mercatorPosition(){const f=this.position;return new a.MercatorCoordinate(f[0],f[1],f[2])}get position(){const f=a.getColumn(this._transform,3);return[f[0],f[1],f[2]]}set position(f){var m;f&&a.setColumn(this._transform,3,[(m=f)[0],m[1],m[2],1])}get orientation(){return this._orientation}set orientation(f){this._orientation=f||a.identity$1([]),f&&JC(this._transform,this._orientation)}getPitchBearing(){const f=this.forward(),m=this.right();return{bearing:Math.atan2(-m[1],m[0]),pitch:Math.atan2(Math.sqrt(f[0]*f[0]+f[1]*f[1]),-f[2])}}setPitchBearing(f,m){this._orientation=Tm(f,m),JC(this._transform,this._orientation)}forward(){const f=a.getColumn(this._transform,2);return[-f[0],-f[1],-f[2]]}up(){const f=a.getColumn(this._transform,1);return[-f[0],-f[1],-f[2]]}right(){const f=a.getColumn(this._transform,0);return[f[0],f[1],f[2]]}getCameraToWorld(f,m){const b=new Float64Array(16);return a.invert(b,this.getWorldToCamera(f,m)),b}getWorldToCameraPosition(f,m,b){const x=this.position;a.scale$2(x,x,-f);const E=new Float64Array(16);return a.fromScaling(E,[b,b,b]),a.translate(E,E,x),E[10]*=m,E}getWorldToCamera(f,m){const b=new Float64Array(16),x=new Float64Array(4),E=this.position;return a.conjugate(x,this._orientation),a.scale$2(E,E,-f),a.fromQuat(b,x),a.translate(b,b,E),b[1]*=-1,b[5]*=-1,b[9]*=-1,b[13]*=-1,b[8]*=m,b[9]*=m,b[10]*=m,b[11]*=m,b}getCameraToClipPerspective(f,m,b,x){const E=new Float64Array(16);return a.perspective(E,f,m,b,x),E}getDistanceToElevation(f,m=!1){const b=f===0?0:a.mercatorZfromAltitude(f,m?a.latFromMercatorY(this.position[1]):this.position[1]),x=this.forward();return(b-this.position[2])/x[2]}clone(){return new Jc([...this.position],[...this.orientation])}}function Qc(v,f){const m=wu(v.projection,v.zoom,v.width,v.height),b=function(E,P,I,L,H){const F=new a.LngLat(I.lng-180*Su,I.lat),X=new a.LngLat(I.lng+180*Su,I.lat),re=E.project(F.lng,F.lat),oe=E.project(X.lng,X.lat),le=-Math.atan2(oe.y-re.y,oe.x-re.x),ue=a.MercatorCoordinate.fromLngLat(I);ue.y=a.clamp(ue.y,-.999975,.999975);const ce=ue.toLngLat(),te=E.project(ce.lng,ce.lat),ge=a.MercatorCoordinate.fromLngLat(ce);ge.x+=Su;const me=ge.toLngLat(),be=E.project(me.lng,me.lat),Pe=Uh(be.x-te.x,be.y-te.y,le),Oe=a.MercatorCoordinate.fromLngLat(ce);Oe.y+=Su;const De=Oe.toLngLat(),Xe=E.project(De.lng,De.lat),ot=Uh(Xe.x-te.x,Xe.y-te.y,le),ut=Math.abs(Pe.x)/Math.abs(ot.y),Bt=a.identity([]);a.rotateZ(Bt,Bt,-le*(1-(H?0:L)));const tt=a.identity([]);return a.scale(tt,tt,[1,1-(1-ut)*L,1]),tt[4]=-ot.x/ot.y*L,a.rotateZ(tt,tt,le),a.multiply(tt,Bt,tt),tt}(v.projection,0,v.center,m,f),x=Rm(v);return a.scale(b,b,[x,x,1]),b}function Rm(v){const f=v.projection,m=wu(v.projection,v.zoom,v.width,v.height),b=Vh(f,v.center),x=Vh(f,a.LngLat.convert(f.center));return Math.pow(2,b*m+(1-m)*x)}function wu(v,f,m,b,x=1/0){const E=v.range;if(!E)return 0;const P=Math.min(x,Math.max(m,b)),I=Math.log(P/1024)/Math.LN2;return a.smoothstep(E[0]+I,E[1]+I,f)}const Su=1/4e4;function Vh(v,f){const m=a.clamp(f.lat,-a.MAX_MERCATOR_LATITUDE,a.MAX_MERCATOR_LATITUDE),b=new a.LngLat(f.lng-180*Su,m),x=new a.LngLat(f.lng+180*Su,m),E=v.project(b.lng,m),P=v.project(x.lng,m),I=a.MercatorCoordinate.fromLngLat(b),L=a.MercatorCoordinate.fromLngLat(x),H=P.x-E.x,F=P.y-E.y,X=L.x-I.x,re=L.y-I.y,oe=Math.sqrt((X*X+re*re)/(H*H+F*F));return Math.log(oe)/Math.LN2}function Uh(v,f,m){const b=Math.cos(m),x=Math.sin(m);return{x:v*b-f*x,y:v*x+f*b}}class Qt{constructor(f,m,b,x,E,P,I){this.tileSize=512,this._renderWorldCopies=E===void 0||E,this._minZoom=f||0,this._maxZoom=m||22,this._minPitch=b??0,this._maxPitch=x??60,this.setProjection(P),this.setMaxBounds(I),this.width=0,this.height=0,this._center=new a.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new Bb,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._distanceTileDataCache={},this._camera=new Jc,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._horizonShift=.1}clone(){const f=new Qt(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return f._elevation=this._elevation,f._centerAltitude=this._centerAltitude,f._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,f.tileSize=this.tileSize,f.mercatorFromTransition=this.mercatorFromTransition,f.width=this.width,f.height=this.height,f.cameraElevationReference=this.cameraElevationReference,f._center=this._center,f._setZoom(this.zoom),f._seaLevelZoom=this._seaLevelZoom,f.angle=this.angle,f._fov=this._fov,f._pitch=this._pitch,f._nearZ=this._nearZ,f._farZ=this._farZ,f._averageElevation=this._averageElevation,f._unmodified=this._unmodified,f._edgeInsets=this._edgeInsets.clone(),f._camera=this._camera.clone(),f._calcMatrices(),f.freezeTileCoverage=this.freezeTileCoverage,f.frustumCorners=this.frustumCorners,f}get elevation(){return this._elevation}set elevation(f){this._elevation!==f&&(this._elevation=f,this._updateCameraOnTerrain(),this._calcMatrices())}updateElevation(f,m=!1){const b=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||b)&&this._updateCameraOnTerrain(),(f||b)&&this._constrainCamera(m),this._calcMatrices()}getProjection(){return a.pick(this.projection,["name","center","parallels"])}setProjection(f){this.projectionOptions=f||{name:"mercator"};const m=this.projection?this.getProjection():void 0;this.projection=a.getProjection(this.projectionOptions);const b=!h(m,this.getProjection());return b&&this._calcMatrices(),this.mercatorFromTransition=!1,b}setMercatorFromTransition(){const f=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=a.getProjection({name:"mercator"});const m=f!==this.projection.name;return m&&this._calcMatrices(),m}get minZoom(){return this._minZoom}set minZoom(f){this._minZoom!==f&&(this._minZoom=f,this.zoom=Math.max(this.zoom,f))}get maxZoom(){return this._maxZoom}set maxZoom(f){this._maxZoom!==f&&(this._maxZoom=f,this.zoom=Math.min(this.zoom,f))}get minPitch(){return this._minPitch}set minPitch(f){this._minPitch!==f&&(this._minPitch=f,this.pitch=Math.max(this.pitch,f))}get maxPitch(){return this._maxPitch}set maxPitch(f){this._maxPitch!==f&&(this._maxPitch=f,this.pitch=Math.min(this.pitch,f))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(f){f===void 0?f=!0:f===null&&(f=!1),this._renderWorldCopies=f}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const f=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(f))}get cameraWorldSize(){const f=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(f))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return a.mercatorZfromAltitude(this.center.lat,this.cameraWorldSizeForFog)}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new a.pointGeometry(this.width,this.height)}get bearing(){return a.wrap(this.rotation,-180,180)}set bearing(f){this.rotation=f}get rotation(){return-this.angle/Math.PI*180}set rotation(f){const m=-f*Math.PI/180;var b;this.angle!==m&&(this._unmodified=!1,this.angle=m,this._calcMatrices(),this.rotationMatrix=(b=new a.ARRAY_TYPE(4),a.ARRAY_TYPE!=Float32Array&&(b[1]=0,b[2]=0),b[0]=1,b[3]=1,b),function(x,E,P){var I=E[0],L=E[1],H=E[2],F=E[3],X=Math.sin(P),re=Math.cos(P);x[0]=I*re+H*X,x[1]=L*re+F*X,x[2]=I*-X+H*re,x[3]=L*-X+F*re}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(f){const m=a.clamp(f,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==m&&(this._unmodified=!1,this._pitch=m,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}get fovX(){return this._fov}get fovY(){const f=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/f)}set fov(f){f=Math.max(.01,Math.min(60,f)),this._fov!==f&&(this._unmodified=!1,this._fov=a.degToRad(f),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(f){this._averageElevation=f,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(f){const m=Math.min(Math.max(f,this.minZoom),this.maxZoom);this._zoom!==m&&(this._unmodified=!1,this._setZoom(m),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(f){this._zoom=f,this.scale=this.zoomScale(f),this.tileZoom=Math.floor(f),this.zoomFraction=f-this.tileZoom}_updateCameraOnTerrain(){if(!this._elevation||!this._elevation.isDataAvailableAtPoint(this.locationCoordinate(this.center)))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const f=this._elevation;this._centerAltitude=f.getAtPointOrZero(this.locationCoordinate(this.center)),this._centerAltitudeValidForExaggeration=f.exaggeration(),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){this._centerAltitudeValidForExaggeration!==void 0&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const f=this._elevation,m=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],b=this.horizonLineFromTop();let x=0,E=0;for(let P=0;P<m.length;P++){const I=new a.pointGeometry(m[P][0]*this.width,b+m[P][1]*(this.height-b)),L=f.pointCoordinate(I);if(!L)continue;const H=1/Math.hypot(L[0]-this._camera.position[0],L[1]-this._camera.position[1]);x+=L[3]*H,E+=H}return E===0?NaN:x/E}get center(){return this._center}set center(f){f.lat===this._center.lat&&f.lng===this._center.lng||(this._unmodified=!1,this._center=f,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const f=this._seaLevelZoom,m=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),b=this.pixelsPerMeter/this.worldSize*m,x=this._mercatorZfromZoom(f),E=this._mercatorZfromZoom(this._maxZoom),P=Math.max(x-b,E);this._setZoom(this._zoomFromMercatorZ(P))}get padding(){return this._edgeInsets.toJSON()}set padding(f){this._edgeInsets.equals(f)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,f,1),this._calcMatrices())}computeZoomRelativeTo(f){const m=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,f.toAltitude()));let b;b=f.z<this._camera.position[2]?[m.x,m.y,m.z]:[f.x,f.y,f.z];const x=a.length(a.sub([],this._camera.position,b));return a.clamp(this._zoomFromMercatorZ(x),this._minZoom,this._maxZoom)}setFreeCameraOptions(f){if(!this.height||!f.position&&!f.orientation)return;this._updateCameraState();let m=!1;if(f.orientation&&!a.exactEquals(f.orientation,this._camera.orientation)&&(m=this._setCameraOrientation(f.orientation)),f.position){const b=[f.position.x,f.position.y,f.position.z];a.exactEquals$1(b,this._camera.position)||(this._setCameraPosition(b),m=!0)}m&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const f=this._camera.position,m=new Om;return m.position=new a.MercatorCoordinate(f[0],f[1],f[2]),m.orientation=this._camera.orientation,m._elevation=this.elevation,m._renderWorldCopies=this.renderWorldCopies,m}_setCameraOrientation(f){if(!a.length$1(f))return!1;a.normalize$1(f,f);const m=a.transformQuat([],[0,0,-1],f),b=a.transformQuat([],[0,-1,0],f);if(b[2]<0)return!1;const x=QC(m,b);return!!x&&(this._camera.orientation=x,!0)}_setCameraPosition(f){const m=this.zoomScale(this.minZoom)*this.tileSize,b=this.zoomScale(this.maxZoom)*this.tileSize,x=this.cameraToCenterDistance;f[2]=a.clamp(f[2],x/b,x/m),this._camera.position=f}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(f){return this._edgeInsets.equals(f)}interpolatePadding(f,m,b){this._unmodified=!1,this._edgeInsets.interpolate(f,m,b),this._constrain(),this._calcMatrices()}coveringZoomLevel(f){const m=(f.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/f.tileSize));return Math.max(0,m)}getVisibleUnwrappedCoordinates(f){const m=[new a.UnwrappedTileID(0,f)];if(this.renderWorldCopies){const b=this.pointCoordinate(new a.pointGeometry(0,0)),x=this.pointCoordinate(new a.pointGeometry(this.width,0)),E=this.pointCoordinate(new a.pointGeometry(this.width,this.height)),P=this.pointCoordinate(new a.pointGeometry(0,this.height)),I=Math.floor(Math.min(b.x,x.x,E.x,P.x)),L=Math.floor(Math.max(b.x,x.x,E.x,P.x)),H=1;for(let F=I-H;F<=L+H;F++)F!==0&&m.push(new a.UnwrappedTileID(F,f))}return m}coveringTiles(f){let m=this.coveringZoomLevel(f);const b=m,x=this.elevation&&!f.isTerrainDEM,E=this.projection.name==="mercator";if(f.minzoom!==void 0&&m<f.minzoom)return[];f.maxzoom!==void 0&&m>f.maxzoom&&(m=f.maxzoom);const P=this.locationCoordinate(this.center),I=this.center.lat,L=1<<m,H=[L*P.x,L*P.y,0],F=this.projection.name==="globe",X=!F,re=a.Frustum.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,m,X),oe=F?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),le=L*a.mercatorZfromAltitude(1,this.center.lat),ue=this._camera.position[2]/a.mercatorZfromAltitude(1,this.center.lat),ce=[L*oe.x,L*oe.y,ue*(X?1:le)],te=this.cameraToCenterDistance/f.tileSize*(f.roundZoom?1:.502),ge=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace?m:0,me=f.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,be=f.isTerrainDEM?-me:this._elevation?this._elevation.getMinElevationBelowMSL():0,Pe=this.projection.isReprojectedInTileSpace?Rm(this):1,Oe=at=>{const ct=new a.MercatorCoordinate(at.x+25e-6,at.y,at.z),Et=new a.MercatorCoordinate(at.x,at.y+25e-6,at.z),Mt=at.toLngLat(),ur=ct.toLngLat(),Hr=Et.toLngLat(),rr=this.locationCoordinate(Mt),er=this.locationCoordinate(ur),fr=this.locationCoordinate(Hr),Xr=Math.hypot(er.x-rr.x,er.y-rr.y),gr=Math.hypot(fr.x-rr.x,fr.y-rr.y);return Math.sqrt(Xr*gr)*Pe/25e-6},De=at=>{const Ye=me,ct=be;return{aabb:a.tileAABB(this,L,0,0,0,at,ct,Ye,this.projection),zoom:0,x:0,y:0,minZ:ct,maxZ:Ye,wrap:at,fullyVisible:!1}},Xe=[];let ot=[];const ut=m,Bt=f.reparseOverscaled?b:m,tt=at=>at*at,wt=tt((ue-this._centerAltitude)*le),pt=at=>{if(!this._elevation||!at.tileID||!E)return;const Ye=this._elevation.getMinMaxForTile(at.tileID),ct=at.aabb;Ye?(ct.min[2]=Ye.min,ct.max[2]=Ye.max,ct.center[2]=(ct.min[2]+ct.max[2])/2):(at.shouldSplit=Ot(at),at.shouldSplit||(ct.min[2]=ct.max[2]=ct.center[2]=this._centerAltitude))},Ot=at=>{if(at.zoom<ge)return!0;if(at.zoom===ut)return!1;if(at.shouldSplit!=null)return at.shouldSplit;const Ye=at.aabb.distanceX(ce),ct=at.aabb.distanceY(ce);let Et=wt,Mt=1;if(F){Et=tt(at.aabb.distanceZ(ce));const rr=Math.pow(2,at.zoom),er=a.latFromMercatorY((at.y+1)/rr),fr=a.latFromMercatorY(at.y/rr),Xr=Math.min(Math.max(I,er),fr),gr=a.circumferenceAtLatitude(Xr)/a.circumferenceAtLatitude(I);if(Mt=Xr===I?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,gr/this._mercatorScaleRatio),this.zoom<=a.GLOBE_ZOOM_THRESHOLD_MIN&&at.zoom===ut-1&&gr>=.9)return!0}else if(x&&(Et=tt(at.aabb.distanceZ(ce)*le)),this.projection.isReprojectedInTileSpace&&b<=5){const rr=Math.pow(2,at.zoom),er=Oe(new a.MercatorCoordinate((at.x+.5)/rr,(at.y+.5)/rr));Mt=er>.85?1:er}const ur=Ye*Ye+ct*ct+Et,Hr=tt((1<<ut-at.zoom)*te*Mt*((rr,er)=>{if(er*tt(.707)<rr)return 1;const fr=Math.sqrt(er/rr);return fr/(1.4144271570014144+(Math.pow(1.1,fr-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(Et,wt),ur));return ur<Hr};if(this.renderWorldCopies)for(let at=1;at<=3;at++)Xe.push(De(-at)),Xe.push(De(at));for(Xe.push(De(0));Xe.length>0;){const at=Xe.pop(),Ye=at.x,ct=at.y;let Et=at.fullyVisible;if(!Et){const Mt=at.aabb.intersects(re);if(Mt===0)continue;Et=Mt===2}if(at.zoom!==ut&&Ot(at))for(let Mt=0;Mt<4;Mt++){const ur=(Ye<<1)+Mt%2,Hr=(ct<<1)+(Mt>>1),rr={aabb:E?at.aabb.quadrant(Mt):a.tileAABB(this,L,at.zoom+1,ur,Hr,at.wrap,at.minZ,at.maxZ,this.projection),zoom:at.zoom+1,x:ur,y:Hr,wrap:at.wrap,fullyVisible:Et,tileID:void 0,shouldSplit:void 0,minZ:at.minZ,maxZ:at.maxZ};x&&!F&&(rr.tileID=new a.OverscaledTileID(at.zoom+1===ut?Bt:at.zoom+1,at.wrap,at.zoom+1,ur,Hr),pt(rr)),Xe.push(rr)}else{const Mt=at.zoom===ut?Bt:at.zoom;if(f.minzoom&&f.minzoom>Mt)continue;const ur=H[0]-(.5+Ye+(at.wrap<<at.zoom))*(1<<m-at.zoom),Hr=H[1]-.5-ct,rr=at.tileID?at.tileID:new a.OverscaledTileID(Mt,at.wrap,at.zoom,Ye,ct);ot.push({tileID:rr,distanceSq:ur*ur+Hr*Hr})}}if(this.fogCullDistSq){const at=this.fogCullDistSq,Ye=this.horizonLineFromTop();ot=ot.filter(ct=>{const Et=[0,0,0,1],Mt=[a.EXTENT,a.EXTENT,0,1],ur=this.calculateFogTileMatrix(ct.tileID.toUnwrapped());a.transformMat4$1(Et,Et,ur),a.transformMat4$1(Mt,Mt,ur);const Hr=a.getAABBPointSquareDist(Et,Mt);if(Hr===0)return!0;let rr=!1;const er=this._elevation;if(er&&Hr>at&&Ye!==0){const fr=this.calculateProjMatrix(ct.tileID.toUnwrapped());let Xr;f.isTerrainDEM||(Xr=er.getMinMaxForTile(ct.tileID)),Xr||(Xr={min:be,max:me});const gr=a.furthestTileCorner(this.rotation),En=[gr[0]*a.EXTENT,gr[1]*a.EXTENT,Xr.max];a.transformMat4(En,En,fr),rr=(1-En[1])*this.height*.5<Ye}return Hr<at||rr})}return ot.sort((at,Ye)=>at.distanceSq-Ye.distanceSq).map(at=>at.tileID)}resize(f,m){this.width=f,this.height=m,this.pixelsToGLUnits=[2/f,-2/m],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(f){return Math.pow(2,f)}scaleZoom(f){return Math.log(f)/Math.LN2}project(f){const m=a.clamp(f.lat,-a.MAX_MERCATOR_LATITUDE,a.MAX_MERCATOR_LATITUDE),b=this.projection.project(f.lng,m);return new a.pointGeometry(b.x*this.worldSize,b.y*this.worldSize)}unproject(f){return this.projection.unproject(f.x/this.worldSize,f.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/a.mercatorZfromAltitude(1,this.center.lat)/this.worldSize}setLocationAtPoint(f,m){let b,x;const E=this.centerPoint;if(this.projection.name==="globe"){const I=this.worldSize;b=(m.x-E.x)/I,x=(m.y-E.y)/I}else{const I=this.pointCoordinate(m),L=this.pointCoordinate(E);b=I.x-L.x,x=I.y-L.y}const P=this.locationCoordinate(f);this.setLocation(new a.MercatorCoordinate(P.x-b,P.y-x))}setLocation(f){this.center=this.coordinateLocation(f),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(f){return this.projection.locationPoint(this,f)}locationPoint3D(f){return this.projection.locationPoint(this,f,!0)}pointLocation(f){return this.coordinateLocation(this.pointCoordinate(f))}pointLocation3D(f){return this.coordinateLocation(this.pointCoordinate3D(f))}locationCoordinate(f,m){const b=m?a.mercatorZfromAltitude(m,f.lat):void 0,x=this.projection.project(f.lng,f.lat);return new a.MercatorCoordinate(x.x,x.y,b)}coordinateLocation(f){return this.projection.unproject(f.x,f.y)}pointRayIntersection(f,m){const b=m??this._centerAltitude,x=[f.x,f.y,0,1],E=[f.x,f.y,1,1];a.transformMat4$1(x,x,this.pixelMatrixInverse),a.transformMat4$1(E,E,this.pixelMatrixInverse);const P=E[3];a.scale$1(x,x,1/x[3]),a.scale$1(E,E,1/P);const I=x[2],L=E[2];return{p0:x,p1:E,t:I===L?0:(b-I)/(L-I)}}screenPointToMercatorRay(f){const m=[f.x,f.y,0,1],b=[f.x,f.y,1,1];return a.transformMat4$1(m,m,this.pixelMatrixInverse),a.transformMat4$1(b,b,this.pixelMatrixInverse),a.scale$1(m,m,1/m[3]),a.scale$1(b,b,1/b[3]),m[2]=a.mercatorZfromAltitude(m[2],this._center.lat)*this.worldSize,b[2]=a.mercatorZfromAltitude(b[2],this._center.lat)*this.worldSize,a.scale$1(m,m,1/this.worldSize),a.scale$1(b,b,1/this.worldSize),new a.Ray([m[0],m[1],m[2]],a.normalize([],a.sub([],b,m)))}rayIntersectionCoordinate(f){const{p0:m,p1:b,t:x}=f,E=a.mercatorZfromAltitude(m[2],this._center.lat),P=a.mercatorZfromAltitude(b[2],this._center.lat);return new a.MercatorCoordinate(a.number(m[0],b[0],x)/this.worldSize,a.number(m[1],b[1],x)/this.worldSize,a.number(E,P,x))}pointCoordinate(f,m=this._centerAltitude){return this.projection.pointCoordinate(this,f.x,f.y,m)}pointCoordinate3D(f){if(!this.elevation)return this.pointCoordinate(f);let m=this.projection.pointCoordinate3D(this,f.x,f.y);if(m)return new a.MercatorCoordinate(m[0],m[1],m[2]);let b=0,x=this.horizonLineFromTop();if(f.y>x)return this.pointCoordinate(f);const E=.02*x,P=f.clone();for(let I=0;I<10&&x-b>E;I++){P.y=a.number(b,x,.66);const L=this.projection.pointCoordinate3D(this,P.x,P.y);L?(x=P.y,m=L):b=P.y}return m?new a.MercatorCoordinate(m[0],m[1],m[2]):this.pointCoordinate(f)}isPointAboveHorizon(f){return this.projection.isPointAboveHorizon(this,f)}_coordinatePoint(f,m){const b=m&&this.elevation?this.elevation.getAtPointOrZero(f,this._centerAltitude):this._centerAltitude,x=[f.x*this.worldSize,f.y*this.worldSize,b+f.toAltitude(),1];return a.transformMat4$1(x,x,this.pixelMatrix),x[3]>0?new a.pointGeometry(x[0]/x[3],x[1]/x[3]):new a.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:f,left:m}=this._edgeInsets,b=this.height-this._edgeInsets.bottom,x=this.width-this._edgeInsets.right,E=this.pointLocation3D(new a.pointGeometry(m,f)),P=this.pointLocation3D(new a.pointGeometry(x,f)),I=this.pointLocation3D(new a.pointGeometry(x,b)),L=this.pointLocation3D(new a.pointGeometry(m,b));let H=Math.min(E.lng,P.lng,I.lng,L.lng),F=Math.max(E.lng,P.lng,I.lng,L.lng),X=Math.min(E.lat,P.lat,I.lat,L.lat),re=Math.max(E.lat,P.lat,I.lat,L.lat);const oe=Math.pow(2,-this.zoom)/16*270,le=this.projection.name==="globe"?1:4,ue=(ce,te,ge,me,be)=>{const Pe=(ce+ge)/2,Oe=(te+me)/2,De=new a.pointGeometry(Pe,Oe),{lng:Xe,lat:ot}=this.pointLocation3D(De),ut=Math.max(0,H-Xe,X-ot,Xe-F,ot-re);H=Math.min(H,Xe),F=Math.max(F,Xe),X=Math.min(X,ot),re=Math.max(re,ot),(be<le||ut>oe)&&(ue(ce,te,Pe,Oe,be+1),ue(Pe,Oe,ge,me,be+1))};if(ue(m,f,x,f,1),ue(x,f,x,b,1),ue(x,b,m,b,1),ue(m,b,m,f,1),this.projection.name==="globe"){const[ce,te]=a.polesInViewport(this);ce?(re=90,F=180,H=-180):te&&(X=-90,F=180,H=-180)}return new a.LngLatBounds(new a.LngLat(H,X),new a.LngLat(F,re))}_getBoundsRectangular(f,m){const{top:b,left:x}=this._edgeInsets,E=this.height-this._edgeInsets.bottom,P=this.width-this._edgeInsets.right,I=new a.pointGeometry(x,b),L=new a.pointGeometry(P,b),H=new a.pointGeometry(P,E),F=new a.pointGeometry(x,E);let X=this.pointCoordinate(I,f),re=this.pointCoordinate(L,f);const oe=this.pointCoordinate(H,m),le=this.pointCoordinate(F,m),ue=(ce,te)=>(te.y-ce.y)/(te.x-ce.x);return X.y>1&&re.y>=0?X=new a.MercatorCoordinate((1-le.y)/ue(le,X)+le.x,1):X.y<0&&re.y<=1&&(X=new a.MercatorCoordinate(-le.y/ue(le,X)+le.x,0)),re.y>1&&X.y>=0?re=new a.MercatorCoordinate((1-oe.y)/ue(oe,re)+oe.x,1):re.y<0&&X.y<=1&&(re=new a.MercatorCoordinate(-oe.y/ue(oe,re)+oe.x,0)),new a.LngLatBounds().extend(this.coordinateLocation(X)).extend(this.coordinateLocation(re)).extend(this.coordinateLocation(le)).extend(this.coordinateLocation(oe))}_getBoundsRectangularTerrain(){const f=this.elevation;if(!f.visibleDemTiles.length||f.isUsingMockSource())return this._getBoundsRectangular(0,0);const m=f.visibleDemTiles.reduce((b,x)=>{if(x.dem){const E=x.dem.tree;b.min=Math.min(b.min,E.minimums[0]),b.max=Math.max(b.max,E.maximums[0])}return b},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(m.min*f.exaggeration(),m.max*f.exaggeration())}getBounds(){return this.projection.name==="mercator"||this.projection.name==="equirectangular"?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(f=!0){const m=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,b=this.height/2-m*(1-this._horizonShift);return f?Math.max(0,b):b}getMaxBounds(){return this.maxBounds}setMaxBounds(f){this.maxBounds=f,this.minLat=-a.MAX_MERCATOR_LATITUDE,this.maxLat=a.MAX_MERCATOR_LATITUDE,this.minLng=-180,this.maxLng=180,f&&(this.minLat=f.getSouth(),this.maxLat=f.getNorth(),this.minLng=f.getWest(),this.maxLng=f.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=a.mercatorXfromLng(this.minLng)*this.tileSize,this.worldMaxX=a.mercatorXfromLng(this.maxLng)*this.tileSize,this.worldMinY=a.mercatorYfromLat(this.maxLat)*this.tileSize,this.worldMaxY=a.mercatorYfromLat(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(f,m){return this.projection.createTileMatrix(this,m,f)}calculateDistanceTileData(f){const m=f.key,b=this._distanceTileDataCache;if(b[m])return b[m];const x=f.canonical,E=1/this.height,P=this.cameraWorldSize,I=P/this.zoomScale(x.z),L=(x.x+Math.pow(2,x.z)*f.wrap)*I,H=x.y*I,F=this.point;F.x*=P/this.worldSize,F.y*=P/this.worldSize;const X=this.angle,re=Math.sin(-X),oe=-Math.cos(-X);return b[m]={bearing:[re,oe],center:[(F.x-L)*E,(F.y-H)*E],scale:I/a.EXTENT*E},b[m]}calculateFogTileMatrix(f){const m=f.key,b=this._fogTileMatrixCache;if(b[m])return b[m];const x=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,f);return a.multiply(x,this.worldToFogMatrix,x),b[m]=new Float32Array(x),b[m]}calculateProjMatrix(f,m=!1){const b=f.key,x=m?this._alignedProjMatrixCache:this._projMatrixCache;if(x[b])return x[b];const E=this.calculatePosMatrix(f,this.worldSize);return a.multiply(E,this.projection.isReprojectedInTileSpace?this.mercatorMatrix:m?this.alignedProjMatrix:this.projMatrix,E),x[b]=new Float32Array(E),x[b]}calculatePixelsToTileUnitsMatrix(f){const m=f.tileID.key,b=this._pixelsToTileUnitsCache;if(b[m])return b[m];const x=function(E,P){const{scale:I}=E.tileTransform,L=I*a.EXTENT/(E.tileSize*Math.pow(2,P.zoom-E.tileID.overscaledZ+E.tileID.canonical.z));return H=new Float32Array(4),re=(F=P.inverseAdjustmentMatrix)[1],oe=F[2],le=F[3],ce=(X=[L,L])[1],H[0]=F[0]*(ue=X[0]),H[1]=re*ue,H[2]=oe*ce,H[3]=le*ce,H;var H,F,X,re,oe,le,ue,ce}(f,this);return b[m]=x,b[m]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if(this.projection.name==="globe"){const f=1/this.worldSize,m=a.fromScaling([],[f,f,f]);return a.multiply(m,m,this.globeMatrix),m}}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const f=this._elevation;this._updateCameraState();const m=a.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,b=this._computeCameraPosition(m),x=this._camera.forward(),E=a.mercatorZfromAltitude(1,this._center.lat);b[2]/=E,x[2]/=E,a.normalize(x,x);const P=f.raycast(b,x,f.exaggeration());if(P){const I=a.scaleAndAdd([],b,x,P),L=new a.MercatorCoordinate(I[0],I[1],a.mercatorZfromAltitude(I[2],a.latFromMercatorY(I[1]))),H=(L.z+a.length([L.x-b[0],L.y-b[1],L.z-b[2]*E]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(H),this._centerAltitude=L.toAltitude(),this._center=this.coordinateLocation(L),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(f=!1){if(!this._elevation)return;const m=this._elevation,b=a.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,x=this._computeCameraPosition(b),E=m.getAtPointOrZero(new a.MercatorCoordinate(...x)),P=this.pixelsPerMeter/this.worldSize*E,I=this._minimumHeightOverTerrain(),L=x[2]-P;if(L<=I)if(L<0||f){const H=this.locationCoordinate(this._center,this._centerAltitude),F=[x[0],x[1],H.z-x[2]],X=a.length(F);F[2]-=(I-L)/this._pixelsPerMercatorPixel;const re=a.length(F);if(re===0)return;a.scale$2(F,F,X/re*this._pixelsPerMercatorPixel),this._camera.position=[x[0],x[1],H.z*this._pixelsPerMercatorPixel-F[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const f=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||f){const re=this.center;return re.lat=a.clamp(re.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!f)&&(re.lng=a.clamp(re.lng,this.minLng,this.maxLng)),this.center=re,void(this._constraining=!1)}const m=this._unmodified,{x:b,y:x}=this.point;let E=0,P=b,I=x;const L=this.width/2,H=this.height/2,F=this.worldMinY*this.scale,X=this.worldMaxY*this.scale;if(x-H<F&&(I=F+H),x+H>X&&(I=X-H),X-F<this.height&&(E=Math.max(E,this.height/(X-F)),I=(X+F)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const re=this.worldMinX*this.scale,oe=this.worldMaxX*this.scale,le=this.worldSize/2-(re+oe)/2;P=(b+le+this.worldSize)%this.worldSize-le,P-L<re&&(P=re+L),P+L>oe&&(P=oe-L),oe-re<this.width&&(E=Math.max(E,this.width/(oe-re)),P=(oe+re)/2)}P===b&&I===x||(this.center=this.unproject(new a.pointGeometry(P,I))),E&&(this.zoom+=this.scaleZoom(E)),this._constrainCamera(),this._unmodified=m,this._constraining=!1}_minZoomForBounds(){let f=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(f=Math.max(f,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),f}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const f=this.centerOffset,m=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=a.mercatorZfromAltitude(1,this.center.lat)/a.mercatorZfromAltitude(1,a.GLOBE_SCALE_MATCH_LATITUDE));const b=wu(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,b),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const x=this.projection.zAxisUnit==="meters"?m:1,E=this._camera.getWorldToCamera(this.worldSize,x),P=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);P[8]=2*-f.x/this.width,P[9]=2*f.y/this.height;let I=a.mul([],P,E);if(this.projection.isReprojectedInTileSpace){const Oe=this.locationCoordinate(this.center),De=a.identity([]);a.translate(De,De,[Oe.x*this.worldSize,Oe.y*this.worldSize,0]),a.multiply(De,De,Qc(this)),a.translate(De,De,[-Oe.x*this.worldSize,-Oe.y*this.worldSize,0]),a.multiply(I,I,De),this.inverseAdjustmentMatrix=function(Xe){const ot=Qc(Xe,!0);return Ne([],[ot[0],ot[1],ot[4],ot[5]])}(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];this.mercatorMatrix=a.scale([],I,[this.worldSize,this.worldSize,this.worldSize/x,1]),this.projMatrix=I,this.invProjMatrix=a.invert(new Float64Array(16),this.projMatrix);const L=a.invert([],P);this.frustumCorners=a.FrustumCorners.fromInvProjectionMatrix(L,this.horizonLineFromTop(),this.height);const H=new Float32Array(16);a.identity(H),a.scale(H,H,[1,-1,1]),a.rotateX(H,H,this._pitch),a.rotateZ(H,H,this.angle);const F=a.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ),X=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;F[8]=2*-f.x/this.width,F[9]=2*(f.y+X)/this.height,this.skyboxMatrix=a.multiply(H,F,H);const re=this.point,oe=re.x,le=re.y,ue=this.width%2/2,ce=this.height%2/2,te=Math.cos(this.angle),ge=Math.sin(this.angle),me=oe-Math.round(oe)+te*ue+ge*ce,be=le-Math.round(le)+te*ce+ge*ue,Pe=new Float64Array(I);if(a.translate(Pe,Pe,[me>.5?me-1:me,be>.5?be-1:be,0]),this.alignedProjMatrix=Pe,I=a.create(),a.scale(I,I,[this.width/2,-this.height/2,1]),a.translate(I,I,[1,-1,0]),this.labelPlaneMatrix=I,I=a.create(),a.scale(I,I,[1,-1,1]),a.translate(I,I,[-1,-1,0]),a.scale(I,I,[2/this.width,2/this.height,1]),this.glCoordMatrix=I,this.pixelMatrix=a.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),this._calcFogMatrices(),this._distanceTileDataCache={},I=a.invert(new Float64Array(16),this.pixelMatrix),!I)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=I,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=a.calculateGlobeMatrix(this);const Oe=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=a.transformMat4(Oe,Oe,E),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=I;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const f=this.cameraWorldSizeForFog,m=this.cameraPixelsPerMeter,b=this._camera.position,x=1/this.height/this._pixelsPerMercatorPixel,E=[f,f,m];a.scale$2(E,E,x),a.scale$2(b,b,-1),a.multiply$2(b,b,E);const P=a.create();a.translate(P,P,b),a.scale(P,P,E),this.mercatorFogMatrix=P,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(f,m,x)}_computeCameraPosition(f){const m=(f=f||this.pixelsPerMeter)/this.pixelsPerMeter,b=this._camera.forward(),x=this.point,E=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*m-f/this.worldSize*this._centerAltitude;return[x.x/this.worldSize-b[0]*E,x.y/this.worldSize-b[1]*E,f/this.worldSize*this._centerAltitude-b[2]*E]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(f){const m=this._maxCameraBoundsDistance()*Math.cos(this._pitch),b=this._camera.position[2],x=f[2];let E=1;this.projection.wrap&&(this.center=this.center.wrap()),x>0&&(E=Math.min((m-b)/x,1)),this._camera.position=a.scaleAndAdd([],this._camera.position,f,E),this._updateStateFromCamera()}_updateStateFromCamera(){const f=this._camera.position,m=this._camera.forward(),{pitch:b,bearing:x}=this._camera.getPitchBearing(),E=a.mercatorZfromAltitude(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,P=this._mercatorZfromZoom(this._maxZoom)*Math.cos(a.degToRad(this._maxPitch)),I=Math.max((f[2]-E)/Math.cos(b),P),L=this._zoomFromMercatorZ(I);a.scaleAndAdd(f,f,m,I),this._pitch=a.clamp(b,a.degToRad(this.minPitch),a.degToRad(this.maxPitch)),this.angle=a.wrap(x,-Math.PI,Math.PI),this._setZoom(a.clamp(L,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new a.MercatorCoordinate(f[0],f[1],f[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(f){return Math.pow(2,f)*this.tileSize}_mercatorZfromZoom(f){return this.cameraToCenterDistance/this._worldSizeFromZoom(f)}_minimumHeightOverTerrain(){const f=Math.min((this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom)+4,this._maxZoom);return this._mercatorZfromZoom(f)}_zoomFromMercatorZ(f){return this.scaleZoom(this.cameraToCenterDistance/(f*this.tileSize))}zoomFromMercatorZAdjusted(f){let m=0,b=a.GLOBE_ZOOM_THRESHOLD_MAX,x=0,E=1/0;for(;b-m>1e-6&&b>m;){const P=m+.5*(b-m),I=this.tileSize*Math.pow(2,P),L=this.getCameraToCenterDistance(this.projection,P,I),H=this.scaleZoom(L/(f*this.tileSize)),F=Math.abs(P-H);F<E&&(E=F,x=P),P<H?m=P:b=P}return x}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(a.warnOnce("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(f,m){const b=Math.min(f.x,m.x),x=Math.max(f.x,m.x),E=Math.min(f.y,m.y),P=Math.max(f.y,m.y);if(E<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const I=[new a.pointGeometry(b,E),new a.pointGeometry(x,P),new a.pointGeometry(b,P),new a.pointGeometry(x,E)],L=this.renderWorldCopies?-3:0,H=this.renderWorldCopies?4:1;for(const F of I){const X=this.pointRayIntersection(F);if(X.t<0)return!0;const re=this.rayIntersectionCoordinate(X);if(re.x<L||re.y<0||re.x>H||re.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+a.radToDeg(this.fovAboveCenter)>88||this.anyCornerOffEdge(new a.pointGeometry(0,0),new a.pointGeometry(this.width,this.height))}zoomDeltaToMovement(f,m){const b=a.length(a.sub([],this._camera.position,f)),x=this._zoomFromMercatorZ(b)+m;return b-this._mercatorZfromZoom(x)}getCameraPoint(){if(this.projection.name==="globe"){const f=function([m,b,x],E){const P=[m,b,x,1];a.transformMat4$1(P,P,E);const I=P[3]=Math.max(P[3],1e-6);return P[0]/=I,P[1]/=I,P[2]/=I,P}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new a.pointGeometry(f[0],f[1])}{const f=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new a.pointGeometry(0,f))}}getCameraToCenterDistance(f,m=this.zoom,b=this.worldSize){const x=wu(f,m,this.width,this.height,1024),E=f.pixelSpaceConversion(this.center.lat,b,x);return .5/Math.tan(.5*this._fov)*this.height*E}getWorldToCameraMatrix(){const f=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&a.multiply(f,f,this.globeMatrix),f}}function Ca(v,f){let m=!1,b=null;const x=()=>{b=null,m&&(v(),b=setTimeout(x,f),m=!1)};return()=>(m=!0,b||x(),b)}class eE{constructor(f){this._hashName=f&&encodeURIComponent(f),a.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=Ca(this._updateHashUnthrottled.bind(this),300)}addTo(f){return this._map=f,a.window.addEventListener("hashchange",this._onHashChange,!1),f.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),a.window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const f=this._map;if(!f)return"";const m=jb(f);if(this._hashName){const b=this._hashName;let x=!1;const E=a.window.location.hash.slice(1).split("&").map(P=>{const I=P.split("=")[0];return I===b?(x=!0,`${I}=${m}`):P}).filter(P=>P);return x||E.push(`${b}=${m}`),`#${E.join("&")}`}return`#${m}`}_getCurrentHash(){const f=a.window.location.hash.replace("#","");if(this._hashName){let m;return f.split("&").map(b=>b.split("=")).forEach(b=>{b[0]===this._hashName&&(m=b)}),(m&&m[1]||"").split("/")}return f.split("/")}_onHashChange(){const f=this._map;if(!f)return!1;const m=this._getCurrentHash();if(m.length>=3&&!m.some(b=>isNaN(b))){const b=f.dragRotate.isEnabled()&&f.touchZoomRotate.isEnabled()?+(m[3]||0):f.getBearing();return f.jumpTo({center:[+m[2],+m[1]],zoom:+m[0],bearing:b,pitch:+(m[4]||0)}),!0}return!1}_updateHashUnthrottled(){const f=a.window.location.href.replace(/(#.+)?$/,this.getHashString());a.window.history.replaceState(a.window.history.state,null,f)}}function jb(v,f){const m=v.getCenter(),b=Math.round(100*v.getZoom())/100,x=Math.ceil((b*Math.LN2+Math.log(512/360/.5))/Math.LN10),E=Math.pow(10,x),P=Math.round(m.lng*E)/E,I=Math.round(m.lat*E)/E,L=v.getBearing(),H=v.getPitch();let F=f?`/${P}/${I}/${b}`:`${b}/${I}/${P}`;return(L||H)&&(F+="/"+Math.round(10*L)/10),H&&(F+=`/${Math.round(H)}`),F}const Wh={linearity:.3,easing:a.bezier(0,0,.3,1)},ef=a.extend({deceleration:2500,maxSpeed:1400},Wh),tE=a.extend({deceleration:20,maxSpeed:1400},Wh),km=a.extend({deceleration:1e3,maxSpeed:360},Wh),zb=a.extend({deceleration:1e3,maxSpeed:90},Wh);class Pm{constructor(f){this._map=f,this.clear()}clear(){this._inertiaBuffer=[]}record(f){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:a.exported.now(),settings:f})}_drainInertiaBuffer(){const f=this._inertiaBuffer,m=a.exported.now();for(;f.length>0&&m-f[0].time>160;)f.shift()}_onMoveEnd(f){if(a.exported.prefersReducedMotion||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const m={zoom:0,bearing:0,pitch:0,pan:new a.pointGeometry(0,0),pinchAround:void 0,around:void 0};for(const{settings:E}of this._inertiaBuffer)m.zoom+=E.zoomDelta||0,m.bearing+=E.bearingDelta||0,m.pitch+=E.pitchDelta||0,E.panDelta&&m.pan._add(E.panDelta),E.around&&(m.around=E.around),E.pinchAround&&(m.pinchAround=E.pinchAround);const b=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,x={};if(m.pan.mag()){const E=Yh(m.pan.mag(),b,a.extend({},ef,f||{}));x.offset=m.pan.mult(E.amount/m.pan.mag()),x.center=this._map.transform.center,Gh(x,E)}if(m.zoom){const E=Yh(m.zoom,b,tE);x.zoom=this._map.transform.zoom+E.amount,Gh(x,E)}if(m.bearing){const E=Yh(m.bearing,b,km);x.bearing=this._map.transform.bearing+a.clamp(E.amount,-179,179),Gh(x,E)}if(m.pitch){const E=Yh(m.pitch,b,zb);x.pitch=this._map.transform.pitch+E.amount,Gh(x,E)}if(x.zoom||x.bearing){const E=m.pinchAround===void 0?m.around:m.pinchAround;x.around=E?this._map.unproject(E):this._map.getCenter()}return this.clear(),x.noMoveStart=!0,x}}function Gh(v,f){(!v.duration||v.duration<f.duration)&&(v.duration=f.duration,v.easing=f.easing)}function Yh(v,f,m){const{maxSpeed:b,linearity:x,deceleration:E}=m,P=a.clamp(v*x/(f/1e3),-b,b),I=Math.abs(P)/(E*x);return{easing:m.easing,duration:1e3*I,amount:P*(I/2)}}class to extends a.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(f,m,b,x={}){const E=K(m.getCanvasContainer(),b),P=m.unproject(E);super(f,a.extend({point:E,lngLat:P,originalEvent:b},x)),this._defaultPrevented=!1,this.target=m}}class Am extends a.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(f,m,b){const x=f==="touchend"?b.changedTouches:b.touches,E=xe(m.getCanvasContainer(),x),P=E.map(L=>m.unproject(L)),I=E.reduce((L,H,F,X)=>L.add(H.div(X.length)),new a.pointGeometry(0,0));super(f,{points:E,point:I,lngLats:P,lngLat:m.unproject(I),originalEvent:b}),this._defaultPrevented=!1}}class bI extends a.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(f,m,b){super(f,{originalEvent:b}),this._defaultPrevented=!1}}class rE{constructor(f,m){this._map=f,this._clickTolerance=m.clickTolerance}reset(){this._mousedownPos=void 0}wheel(f){return this._firePreventable(new bI(f.type,this._map,f))}mousedown(f,m){return this._mousedownPos=m,this._firePreventable(new to(f.type,this._map,f))}mouseup(f){this._map.fire(new to(f.type,this._map,f))}preclick(f){const m=a.extend({},f);m.type="preclick",this._map.fire(new to(m.type,this._map,m))}click(f,m){this._mousedownPos&&this._mousedownPos.dist(m)>=this._clickTolerance||(this.preclick(f),this._map.fire(new to(f.type,this._map,f)))}dblclick(f){return this._firePreventable(new to(f.type,this._map,f))}mouseover(f){this._map.fire(new to(f.type,this._map,f))}mouseout(f){this._map.fire(new to(f.type,this._map,f))}touchstart(f){return this._firePreventable(new Am(f.type,this._map,f))}touchmove(f){this._map.fire(new Am(f.type,this._map,f))}touchend(f){this._map.fire(new Am(f.type,this._map,f))}touchcancel(f){this._map.fire(new Am(f.type,this._map,f))}_firePreventable(f){if(this._map.fire(f),f.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Im{constructor(f){this._map=f}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(f){this._map.fire(new to(f.type,this._map,f))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new to("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(f){this._delayContextMenu?this._contextMenuEvent=f:this._map.fire(new to(f.type,this._map,f)),this._map.listens("contextmenu")&&f.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Fb{constructor(f,m){this._map=f,this._el=f.getCanvasContainer(),this._container=f.getContainer(),this._clickTolerance=m.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(f,m){this.isEnabled()&&f.shiftKey&&f.button===0&&(z(),this._startPos=this._lastPos=m,this._active=!0)}mousemoveWindow(f,m){if(!this._active)return;const b=m,x=this._startPos,E=this._lastPos;if(!x||!E||E.equals(b)||!this._box&&b.dist(x)<this._clickTolerance)return;this._lastPos=b,this._box||(this._box=T("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",f));const P=Math.min(x.x,b.x),I=Math.max(x.x,b.x),L=Math.min(x.y,b.y),H=Math.max(x.y,b.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${P}px,${L}px)`,this._box.style.width=I-P+"px",this._box.style.height=H-L+"px")})}mouseupWindow(f,m){if(!this._active)return;const b=this._startPos,x=m;if(b&&f.button===0){if(this.reset(),ee(),b.x!==x.x||b.y!==x.y)return this._map.fire(new a.Event("boxzoomend",{originalEvent:f})),{cameraAnimation:E=>E.fitScreenCoordinates(b,x,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",f)}}keydown(f){this._active&&f.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",f))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),V(),delete this._startPos,delete this._lastPos}_fireEvent(f,m){return this._map.fire(new a.Event(f,{originalEvent:m}))}}function Mm(v,f){const m={};for(let b=0;b<v.length;b++)m[v[b].identifier]=f[b];return m}class nE{constructor(f){this.reset(),this.numTouches=f.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(f,m,b){(this.centroid||b.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=f.timeStamp),b.length===this.numTouches&&(this.centroid=function(x){const E=new a.pointGeometry(0,0);for(const P of x)E._add(P);return E.div(x.length)}(m),this.touches=Mm(b,m)))}touchmove(f,m,b){if(this.aborted||!this.centroid)return;const x=Mm(b,m);for(const E in this.touches){const P=this.touches[E],I=x[E];(!I||I.dist(P)>30)&&(this.aborted=!0)}}touchend(f,m,b){if((!this.centroid||f.timeStamp-this.startTime>500)&&(this.aborted=!0),b.length===0){const x=!this.aborted&&this.centroid;if(this.reset(),x)return x}}}class tf{constructor(f){this.singleTap=new nE(f),this.numTaps=f.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(f,m,b){this.singleTap.touchstart(f,m,b)}touchmove(f,m,b){this.singleTap.touchmove(f,m,b)}touchend(f,m,b){const x=this.singleTap.touchend(f,m,b);if(x){const E=f.timeStamp-this.lastTime<500,P=!this.lastTap||this.lastTap.dist(x)<30;if(E&&P||this.reset(),this.count++,this.lastTime=f.timeStamp,this.lastTap=x,this.count===this.numTaps)return this.reset(),x}}}class Hb{constructor(){this._zoomIn=new tf({numTouches:1,numTaps:2}),this._zoomOut=new tf({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(f,m,b){this._zoomIn.touchstart(f,m,b),this._zoomOut.touchstart(f,m,b)}touchmove(f,m,b){this._zoomIn.touchmove(f,m,b),this._zoomOut.touchmove(f,m,b)}touchend(f,m,b){const x=this._zoomIn.touchend(f,m,b),E=this._zoomOut.touchend(f,m,b);return x?(this._active=!0,f.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:P=>P.easeTo({duration:300,zoom:P.getZoom()+1,around:P.unproject(x)},{originalEvent:f})}):E?(this._active=!0,f.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:P=>P.easeTo({duration:300,zoom:P.getZoom()-1,around:P.unproject(E)},{originalEvent:f})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const iE={0:1,2:2};class Dm{constructor(f){this.reset(),this._clickTolerance=f.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(f,m){return!1}_move(f,m){return{}}mousedown(f,m){if(this._lastPoint)return;const b=Me(f);this._correctButton(f,b)&&(this._lastPoint=m,this._eventButton=b)}mousemoveWindow(f,m){const b=this._lastPoint;if(b){if(f.preventDefault(),this._eventButton!=null&&function(x,E){const P=iE[E];return x.buttons===void 0||(x.buttons&P)!==P}(f,this._eventButton))this.reset();else if(this._moved||!(m.dist(b)<this._clickTolerance))return this._moved=!0,this._lastPoint=m,this._move(b,m)}}mouseupWindow(f){this._lastPoint&&Me(f)===this._eventButton&&(this._moved&&ee(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class oE extends Dm{mousedown(f,m){super.mousedown(f,m),this._lastPoint&&(this._active=!0)}_correctButton(f,m){return m===0&&!f.ctrlKey}_move(f,m){return{around:m,panDelta:m.sub(f)}}}class Vb extends Dm{_correctButton(f,m){return m===0&&f.ctrlKey||m===2}_move(f,m){const b=.8*(m.x-f.x);if(b)return this._active=!0,{bearingDelta:b}}contextmenu(f){f.preventDefault()}}class Ub extends Dm{_correctButton(f,m){return m===0&&f.ctrlKey||m===2}_move(f,m){const b=-.5*(m.y-f.y);if(b)return this._active=!0,{pitchDelta:b}}contextmenu(f){f.preventDefault()}}class rf{constructor(f,m){this._map=f,this._el=f.getCanvasContainer(),this._minTouches=1,this._clickTolerance=m.clickTolerance||1,this.reset(),a.bindAll(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new a.pointGeometry(0,0)}touchstart(f,m,b){return this._calculateTransform(f,m,b)}touchmove(f,m,b){if(this._active&&!(b.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(b.length===1&&!a.isFullscreen())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return f.cancelable&&f.preventDefault(),this._calculateTransform(f,m,b)}}touchend(f,m,b){this._calculateTransform(f,m,b),this._active&&b.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(f,m,b){b.length>0&&(this._active=!0);const x=Mm(b,m),E=new a.pointGeometry(0,0),P=new a.pointGeometry(0,0);let I=0;for(const H in x){const F=x[H],X=this._touches[H];X&&(E._add(F),P._add(F.sub(X)),I++,x[H]=F)}if(this._touches=x,I<this._minTouches||!P.mag())return;const L=P.div(I);return this._sum._add(L),this._sum.mag()<this._clickTolerance?void 0:{around:E.div(I),panDelta:L}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=T("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","null")},500)}}class $m{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(f){}_move(f,m,b){return{}}touchstart(f,m,b){this._firstTwoTouches||b.length<2||(this._firstTwoTouches=[b[0].identifier,b[1].identifier],this._start([m[0],m[1]]))}touchmove(f,m,b){const x=this._firstTwoTouches;if(!x)return;f.preventDefault();const[E,P]=x,I=Kh(b,m,E),L=Kh(b,m,P);if(!I||!L)return;const H=this._aroundCenter?null:I.add(L).div(2);return this._move([I,L],H,f)}touchend(f,m,b){if(!this._firstTwoTouches)return;const[x,E]=this._firstTwoTouches,P=Kh(b,m,x),I=Kh(b,m,E);P&&I||(this._active&&ee(),this.reset())}touchcancel(){this.reset()}enable(f){this._enabled=!0,this._aroundCenter=!!f&&f.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Kh(v,f,m){for(let b=0;b<v.length;b++)if(v[b].identifier===m)return f[b]}function aE(v,f){return Math.log(v/f)/Math.LN2}class sE extends $m{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(f){this._startDistance=this._distance=f[0].dist(f[1])}_move(f,m){const b=this._distance;if(this._distance=f[0].dist(f[1]),this._active||!(Math.abs(aE(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:aE(this._distance,b),pinchAround:m}}}function Wb(v,f){return 180*v.angleWith(f)/Math.PI}class lE extends $m{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(f){this._startVector=this._vector=f[0].sub(f[1]),this._minDiameter=f[0].dist(f[1])}_move(f,m){const b=this._vector;if(this._vector=f[0].sub(f[1]),b&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:Wb(this._vector,b),pinchAround:m}}_isBelowThreshold(f){this._minDiameter=Math.min(this._minDiameter,f.mag());const m=25/(Math.PI*this._minDiameter)*360,b=this._startVector;if(!b)return!1;const x=Wb(f,b);return Math.abs(x)<m}}function Lm(v){return Math.abs(v.y)>Math.abs(v.x)}class _o extends $m{constructor(f){super(),this._map=f}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(f){this._lastPoints=f,Lm(f[0].sub(f[1]))&&(this._valid=!1)}_move(f,m,b){const x=this._lastPoints;if(!x)return;const E=f[0].sub(x[0]),P=f[1].sub(x[1]);return this._map._cooperativeGestures&&!a.isFullscreen()&&b.touches.length<3||(this._valid=this.gestureBeginsVertically(E,P,b.timeStamp),!this._valid)?void 0:(this._lastPoints=f,this._active=!0,{pitchDelta:(E.y+P.y)/2*-.5})}gestureBeginsVertically(f,m,b){if(this._valid!==void 0)return this._valid;const x=f.mag()>=2,E=m.mag()>=2;if(!x&&!E)return;if(!x||!E)return this._firstMove==null&&(this._firstMove=b),b-this._firstMove<100&&void 0;const P=f.y>0==m.y>0;return Lm(f)&&Lm(m)&&P}}const wI={panStep:100,bearingStep:15,pitchStep:10};class uE{constructor(){const f=wI;this._panStep=f.panStep,this._bearingStep=f.bearingStep,this._pitchStep=f.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(f){if(f.altKey||f.ctrlKey||f.metaKey)return;let m=0,b=0,x=0,E=0,P=0;switch(f.keyCode){case 61:case 107:case 171:case 187:m=1;break;case 189:case 109:case 173:m=-1;break;case 37:f.shiftKey?b=-1:(f.preventDefault(),E=-1);break;case 39:f.shiftKey?b=1:(f.preventDefault(),E=1);break;case 38:f.shiftKey?x=1:(f.preventDefault(),P=-1);break;case 40:f.shiftKey?x=-1:(f.preventDefault(),P=1);break;default:return}return this._rotationDisabled&&(b=0,x=0),{cameraAnimation:I=>{const L=I.getZoom();I.easeTo({duration:300,easeId:"keyboardHandler",easing:SI,zoom:m?Math.round(L)+m*(f.shiftKey?2:1):L,bearing:I.getBearing()+b*this._bearingStep,pitch:I.getPitch()+x*this._pitchStep,offset:[-E*this._panStep,-P*this._panStep],center:I.getCenter()},{originalEvent:f})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function SI(v){return v*(2-v)}const cE=4.000244140625;class Us{constructor(f,m){this._map=f,this._el=f.getCanvasContainer(),this._handler=m,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,a.bindAll(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(f){this._defaultZoomRate=f}setWheelZoomRate(f){this._wheelZoomRate=f}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(f){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!f&&f.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(f){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(f.ctrlKey||f.metaKey||this.isZooming()||a.isFullscreen()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let m=f.deltaMode===a.window.WheelEvent.DOM_DELTA_LINE?40*f.deltaY:f.deltaY;const b=a.exported.now(),x=b-(this._lastWheelEventTime||0);this._lastWheelEventTime=b,m!==0&&m%cE==0?this._type="wheel":m!==0&&Math.abs(m)<4?this._type="trackpad":x>400?(this._type=null,this._lastValue=m,this._timeout=setTimeout(this._onTimeout,40,f)):this._type||(this._type=Math.abs(x*m)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,m+=this._lastValue)),f.shiftKey&&m&&(m/=4),this._type&&(this._lastWheelEvent=f,this._delta-=m,this._active||this._start(f)),f.preventDefault()}_onTimeout(f){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(f)}_start(f){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const m=K(this._el,f);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:m,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const f=this._map.transform;this._type==="wheel"&&f.projection.wrap&&(f._center.lng>=180||f._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const m=()=>f._terrainEnabled()&&this._aroundCoord?f.computeZoomRelativeTo(this._aroundCoord):f.zoom;if(this._delta!==0){const L=this._type==="wheel"&&Math.abs(this._delta)>cE?this._wheelZoomRate:this._defaultZoomRate;let H=2/(1+Math.exp(-Math.abs(this._delta*L)));this._delta<0&&H!==0&&(H=1/H);const F=m(),X=Math.pow(2,F),re=typeof this._targetZoom=="number"?f.zoomScale(this._targetZoom):X;this._targetZoom=Math.min(f.maxZoom,Math.max(f.minZoom,f.scaleZoom(re*H))),this._type==="wheel"&&(this._startZoom=F,this._easing=this._smoothOutEasing(200)),this._delta=0}const b=typeof this._targetZoom=="number"?this._targetZoom:m(),x=this._startZoom,E=this._easing;let P,I=!1;if(this._type==="wheel"&&x&&E){const L=Math.min((a.exported.now()-this._lastWheelEventTime)/200,1),H=E(L);P=a.number(x,b,H),L<1?this._frameId||(this._frameId=!0):I=!0}else P=b,I=!0;return this._active=!0,I&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!I,zoomDelta:P-m(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(f){let m=a.ease;if(this._prevEase){const b=this._prevEase,x=(a.exported.now()-b.start)/b.duration,E=b.easing(x+.01)-b.easing(x),P=.27/Math.sqrt(E*E+1e-4)*.01,I=Math.sqrt(.0729-P*P);m=a.bezier(P,I,.25,1)}return this._prevEase={start:a.exported.now(),duration:f,easing:m},m}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=T("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(a.window.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","null")},200)}}class fE{constructor(f,m){this._clickZoom=f,this._tapZoom=m}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class nf{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(f,m){return f.preventDefault(),{cameraAnimation:b=>{b.easeTo({duration:300,zoom:b.getZoom()+(f.shiftKey?-1:1),around:b.unproject(m)},{originalEvent:f})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ys{constructor(){this._tap=new tf({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(f,m,b){this._swipePoint||(this._tapTime&&f.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?b.length>0&&(this._swipePoint=m[0],this._swipeTouch=b[0].identifier):this._tap.touchstart(f,m,b))}touchmove(f,m,b){if(this._tapTime){if(this._swipePoint){if(b[0].identifier!==this._swipeTouch)return;const x=m[0],E=x.y-this._swipePoint.y;return this._swipePoint=x,f.preventDefault(),this._active=!0,{zoomDelta:E/128}}}else this._tap.touchmove(f,m,b)}touchend(f,m,b){this._tapTime?this._swipePoint&&b.length===0&&this.reset():this._tap.touchend(f,m,b)&&(this._tapTime=f.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Nm{constructor(f,m,b){this._el=f,this._mousePan=m,this._touchPan=b}enable(f){this._inertiaOptions=f||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class tr{constructor(f,m,b){this._pitchWithRotate=f.pitchWithRotate,this._mouseRotate=m,this._mousePitch=b}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class hE{constructor(f,m,b,x){this._el=f,this._touchZoom=m,this._touchRotate=b,this._tapDragZoom=x,this._rotationDisabled=!1,this._enabled=!0}enable(f){this._touchZoom.enable(f),this._rotationDisabled||this._touchRotate.enable(f),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const qh=v=>v.zoom||v.drag||v.pitch||v.rotate;class Xh extends a.Event{}class Zh{constructor(){this.constants=[1,1,.01],this.radius=0}setup(f,m){const b=a.sub([],m,f);this.radius=a.length(b[2]<0?a.div([],b,this.constants):[b[0],b[1],0])}projectRay(f){a.div(f,f,this.constants),a.normalize(f,f),a.mul$1(f,f,this.constants);const m=a.scale$2([],f,this.radius);if(m[2]>0){const b=a.scale$2([],[0,0,1],a.dot(m,[0,0,1])),x=a.scale$2([],a.normalize([],[m[0],m[1],0]),this.radius),E=a.add([],m,a.scale$2([],a.sub([],a.add([],x,b),m),2));m[0]=E[0],m[1]=E[1]}return m}}function Jh(v){return v.panDelta&&v.panDelta.mag()||v.zoomDelta||v.bearingDelta||v.pitchDelta}class dE{constructor(f,m){this._map=f,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Pm(f),this._bearingSnap=m.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new Zh,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(m),a.bindAll(["handleEvent","handleWindowEvent"],this);const b=this._el;this._listeners=[[b,"touchstart",{passive:!0}],[b,"touchmove",{passive:!1}],[b,"touchend",void 0],[b,"touchcancel",void 0],[b,"mousedown",void 0],[b,"mousemove",void 0],[b,"mouseup",void 0],[a.window.document,"mousemove",{capture:!0}],[a.window.document,"mouseup",void 0],[b,"mouseover",void 0],[b,"mouseout",void 0],[b,"dblclick",void 0],[b,"click",void 0],[b,"keydown",{capture:!1}],[b,"keyup",void 0],[b,"wheel",{passive:!1}],[b,"contextmenu",void 0],[a.window,"blur",void 0]];for(const[x,E,P]of this._listeners)x.addEventListener(E,x===a.window.document?this.handleWindowEvent:this.handleEvent,P)}destroy(){for(const[f,m,b]of this._listeners)f.removeEventListener(m,f===a.window.document?this.handleWindowEvent:this.handleEvent,b)}_addDefaultHandlers(f){const m=this._map,b=m.getCanvasContainer();this._add("mapEvent",new rE(m,f));const x=m.boxZoom=new Fb(m,f);this._add("boxZoom",x);const E=new Hb,P=new nf;m.doubleClickZoom=new fE(P,E),this._add("tapZoom",E),this._add("clickZoom",P);const I=new ys;this._add("tapDragZoom",I);const L=m.touchPitch=new _o(m);this._add("touchPitch",L);const H=new Vb(f),F=new Ub(f);m.dragRotate=new tr(f,H,F),this._add("mouseRotate",H,["mousePitch"]),this._add("mousePitch",F,["mouseRotate"]);const X=new oE(f),re=new rf(m,f);m.dragPan=new Nm(b,X,re),this._add("mousePan",X),this._add("touchPan",re,["touchZoom","touchRotate"]);const oe=new lE,le=new sE;m.touchZoomRotate=new hE(b,le,oe,I),this._add("touchRotate",oe,["touchPan","touchZoom"]),this._add("touchZoom",le,["touchPan","touchRotate"]),this._add("blockableMapEvent",new Im(m));const ue=m.scrollZoom=new Us(m,this);this._add("scrollZoom",ue,["mousePan"]);const ce=m.keyboard=new uE;this._add("keyboard",ce);for(const te of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])f.interactive&&f[te]&&m[te].enable(f[te])}_add(f,m,b){this._handlers.push({handlerName:f,handler:m,allowed:b}),this._handlersById[f]=m}stop(f){if(!this._updatingCamera){for(const{handler:m}of this._handlers)m.reset();this._inertia.clear(),this._fireEvents({},{},f),this._changes=[]}}isActive(){for(const{handler:f}of this._handlers)if(f.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!qh(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(f,m,b){for(const x in f)if(x!==b&&(!m||m.indexOf(x)<0))return!0;return!1}handleWindowEvent(f){this.handleEvent(f,`${f.type}Window`)}_getMapTouches(f){const m=[];for(const b of f)this._el.contains(b.target)&&m.push(b);return m}handleEvent(f,m){this._updatingCamera=!0;const b=f.type==="renderFrame",x=b?void 0:f,E={needsRenderFrame:!1},P={},I={},L=f.touches?this._getMapTouches(f.touches):void 0,H=L?xe(this._el,L):b?void 0:K(this._el,f);for(const{handlerName:re,handler:oe,allowed:le}of this._handlers){if(!oe.isEnabled())continue;let ue;this._blockedByActive(I,le,re)?oe.reset():oe[m||f.type]&&(ue=oe[m||f.type](f,H,L),this.mergeHandlerResult(E,P,ue,re,x),ue&&ue.needsRenderFrame&&this._triggerRenderFrame()),(ue||oe.isActive())&&(I[re]=oe)}const F={};for(const re in this._previousActiveHandlers)I[re]||(F[re]=x);this._previousActiveHandlers=I,(Object.keys(F).length||Jh(E))&&(this._changes.push([E,P,F]),this._triggerRenderFrame()),(Object.keys(I).length||Jh(E))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:X}=E;X&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],X(this._map))}mergeHandlerResult(f,m,b,x,E){if(!b)return;a.extend(f,b);const P={handlerName:x,originalEvent:b.originalEvent||E};b.zoomDelta!==void 0&&(m.zoom=P),b.panDelta!==void 0&&(m.drag=P),b.pitchDelta!==void 0&&(m.pitch=P),b.bearingDelta!==void 0&&(m.rotate=P)}_applyChanges(){const f={},m={},b={};for(const[x,E,P]of this._changes)x.panDelta&&(f.panDelta=(f.panDelta||new a.pointGeometry(0,0))._add(x.panDelta)),x.zoomDelta&&(f.zoomDelta=(f.zoomDelta||0)+x.zoomDelta),x.bearingDelta&&(f.bearingDelta=(f.bearingDelta||0)+x.bearingDelta),x.pitchDelta&&(f.pitchDelta=(f.pitchDelta||0)+x.pitchDelta),x.around!==void 0&&(f.around=x.around),x.aroundCoord!==void 0&&(f.aroundCoord=x.aroundCoord),x.pinchAround!==void 0&&(f.pinchAround=x.pinchAround),x.noInertia&&(f.noInertia=x.noInertia),a.extend(m,E),a.extend(b,P);this._updateMapTransform(f,m,b),this._changes=[]}_updateMapTransform(f,m,b){const x=this._map,E=x.transform,P=ge=>[ge.x,ge.y,ge.z];if((ge=>{const me=this._eventsInProgress.drag;return me&&!this._handlersById[me.handlerName].isActive()})()&&!Jh(f)){const ge=E.zoom;E.cameraElevationReference="sea",E.recenterOnTerrain(),E.cameraElevationReference="ground",ge!==E.zoom&&this._map._update(!0)}if(E._isCameraConstrained&&x._stop(!0),!Jh(f))return void this._fireEvents(m,b,!0);let{panDelta:I,zoomDelta:L,bearingDelta:H,pitchDelta:F,around:X,aroundCoord:re,pinchAround:oe}=f;E._isCameraConstrained&&(L>0&&(L=0),E._isCameraConstrained=!1),oe!==void 0&&(X=oe),(L||(ge=>m.drag&&!this._eventsInProgress.drag)())&&X&&(this._dragOrigin=P(E.pointCoordinate3D(X)),this._trackingEllipsoid.setup(E._camera.position,this._dragOrigin)),E.cameraElevationReference="sea",x._stop(!0),X=X||x.transform.centerPoint,H&&(E.bearing+=H),F&&(E.pitch+=F),E._updateCameraState();const le=[0,0,0];if(I)if(E.projection.name==="mercator"){const ge=this._trackingEllipsoid.projectRay(E.screenPointToMercatorRay(X).dir),me=this._trackingEllipsoid.projectRay(E.screenPointToMercatorRay(X.sub(I)).dir);le[0]=me[0]-ge[0],le[1]=me[1]-ge[1]}else{const ge=E.pointCoordinate(X);if(E.projection.name==="globe"){I=I.rotate(-E.angle);const me=E._pixelsPerMercatorPixel/E.worldSize;le[0]=-I.x*a.mercatorScale(a.latFromMercatorY(ge.y))*me,le[1]=-I.y*a.mercatorScale(E.center.lat)*me}else{const me=E.pointCoordinate(X.sub(I));ge&&me&&(le[0]=me.x-ge.x,le[1]=me.y-ge.y)}}const ue=E.zoom,ce=[0,0,0];if(L){const ge=P(re||E.pointCoordinate3D(X)),me={dir:a.normalize([],a.sub([],ge,E._camera.position))};if(me.dir[2]<0){const be=E.zoomDeltaToMovement(ge,L);a.scale$2(ce,me.dir,be)}}const te=a.add(le,le,ce);E._translateCameraConstrained(te),L&&Math.abs(E.zoom-ue)>1e-4&&E.recenterOnTerrain(),E.cameraElevationReference="ground",this._map._update(),f.noInertia||this._inertia.record(f),this._fireEvents(m,b,!0)}_fireEvents(f,m,b){const x=qh(this._eventsInProgress),E=qh(f),P={};for(const F in f){const{originalEvent:X}=f[F];this._eventsInProgress[F]||(P[`${F}start`]=X),this._eventsInProgress[F]=f[F]}!x&&E&&this._fireEvent("movestart",E.originalEvent);for(const F in P)this._fireEvent(F,P[F]);E&&this._fireEvent("move",E.originalEvent);for(const F in f){const{originalEvent:X}=f[F];this._fireEvent(F,X)}const I={};let L;for(const F in this._eventsInProgress){const{handlerName:X,originalEvent:re}=this._eventsInProgress[F];this._handlersById[X].isActive()||(delete this._eventsInProgress[F],L=m[X]||re,I[`${F}end`]=L)}for(const F in I)this._fireEvent(F,I[F]);const H=qh(this._eventsInProgress);if(b&&(x||E)&&!H){this._updatingCamera=!0;const F=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),X=re=>re!==0&&-this._bearingSnap<re&&re<this._bearingSnap;F?(X(F.bearing||this._map.getBearing())&&(F.bearing=0),this._map.easeTo(F,{originalEvent:L})):(this._map.fire(new a.Event("moveend",{originalEvent:L})),X(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(f,m){this._map.fire(new a.Event(f,m?{originalEvent:m}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(f=>{this._frameId=void 0,this.handleEvent(new Xh("renderFrame",{timeStamp:f})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const Gb="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class pE extends a.Evented{constructor(f,m){super(),this._moving=!1,this._zooming=!1,this.transform=f,this._bearingSnap=m.bearingSnap,a.bindAll(["_renderFrameCallback"],this)}getCenter(){return new a.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(f,m){return this.jumpTo({center:f},m)}panBy(f,m,b){return f=a.pointGeometry.convert(f).mult(-1),this.panTo(this.transform.center,a.extend({offset:f},m),b)}panTo(f,m,b){return this.easeTo(a.extend({center:f},m),b)}getZoom(){return this.transform.zoom}setZoom(f,m){return this.jumpTo({zoom:f},m),this}zoomTo(f,m,b){return this.easeTo(a.extend({zoom:f},m),b)}zoomIn(f,m){return this.zoomTo(this.getZoom()+1,f,m),this}zoomOut(f,m){return this.zoomTo(this.getZoom()-1,f,m),this}getBearing(){return this.transform.bearing}setBearing(f,m){return this.jumpTo({bearing:f},m),this}getPadding(){return this.transform.padding}setPadding(f,m){return this.jumpTo({padding:f},m),this}rotateTo(f,m,b){return this.easeTo(a.extend({bearing:f},m),b)}resetNorth(f,m){return this.rotateTo(0,a.extend({duration:1e3},f),m),this}resetNorthPitch(f,m){return this.easeTo(a.extend({bearing:0,pitch:0,duration:1e3},f),m),this}snapToNorth(f,m){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(f,m):this}getPitch(){return this.transform.pitch}setPitch(f,m){return this.jumpTo({pitch:f},m),this}cameraForBounds(f,m){f=a.LngLatBounds.convert(f);const b=m&&m.bearing||0,x=m&&m.pitch||0,E=f.getNorthWest(),P=f.getSouthEast();return this._cameraForBounds(this.transform,E,P,b,x,m)}_extendCameraOptions(f){const m={top:0,bottom:0,right:0,left:0};if(typeof(f=a.extend({padding:m,offset:[0,0],maxZoom:this.transform.maxZoom},f)).padding=="number"){const b=f.padding;f.padding={top:b,bottom:b,right:b,left:b}}return f.padding=a.extend(m,f.padding),f}_minimumAABBFrustumDistance(f,m){const b=m.max[0]-m.min[0],x=m.max[1]-m.min[1];return b/x>f.aspect?b/(2*Math.tan(.5*f.fovX)*f.aspect):x/(2*Math.tan(.5*f.fovY)*f.aspect)}_cameraForBoundsOnGlobe(f,m,b,x,E,P){const I=f.clone(),L=this._extendCameraOptions(P);I.bearing=x,I.pitch=E;const H=a.LngLat.convert(m),F=a.LngLat.convert(b),X=.5*(H.lat+F.lat),re=.5*(H.lng+F.lng),oe=a.latLngToECEF(X,re),le=a.normalize([],oe),ue=a.normalize([],a.cross([],le,[0,1,0])),ce=a.cross([],ue,le),te=[ue[0],ue[1],ue[2],0,ce[0],ce[1],ce[2],0,le[0],le[1],le[2],0,0,0,0,1],ge=[oe,a.latLngToECEF(H.lat,H.lng),a.latLngToECEF(F.lat,H.lng),a.latLngToECEF(F.lat,F.lng),a.latLngToECEF(H.lat,F.lng),a.latLngToECEF(X,H.lng),a.latLngToECEF(X,F.lng),a.latLngToECEF(H.lat,re),a.latLngToECEF(F.lat,re)];let me=a.Aabb.fromPoints(ge.map(Et=>[a.dot(ue,Et),a.dot(ce,Et),a.dot(le,Et)]));const be=a.transformMat4([],me.center,te);a.squaredLength(be)===0&&a.set(be,0,0,1),a.normalize(be,be),a.scale$2(be,be,a.GLOBE_RADIUS),I.center=a.ecefToLatLng(be);const Pe=I.getWorldToCameraMatrix(),Oe=a.invert(new Float64Array(16),Pe);me=a.Aabb.applyTransform(me,a.multiply([],Pe,te)),a.transformMat4(be,be,Pe);const De=.5*(me.max[2]-me.min[2]),Xe=this._minimumAABBFrustumDistance(I,me),ot=a.scale$2([],[0,0,1],De),ut=a.add(ot,be,ot),Bt=Xe+(I.pitch===0?0:a.distance(be,ut)),tt=I.globeCenterInViewSpace,wt=a.sub([],be,[tt[0],tt[1],tt[2]]);a.normalize(wt,wt),a.scale$2(wt,wt,Bt);const pt=a.add([],be,wt);a.transformMat4(pt,pt,Oe);const Ot=a.earthRadius/a.GLOBE_RADIUS,at=a.length(pt),Ye=a.mercatorZfromAltitude(Math.max(at*Ot-a.earthRadius,Number.EPSILON),0),ct=Math.min(I.zoomFromMercatorZAdjusted(Ye),L.maxZoom);return ct>.5*(a.GLOBE_ZOOM_THRESHOLD_MIN+a.GLOBE_ZOOM_THRESHOLD_MAX)?(I.setProjection({name:"mercator"}),I.zoom=ct,this._cameraForBounds(I,m,b,x,E,P)):{center:I.center,zoom:ct,bearing:x,pitch:E}}queryTerrainElevation(f,m){const b=this.transform.elevation;return b?(m=a.extend({},{exaggerated:!0},m),b.getAtPoint(a.MercatorCoordinate.fromLngLat(f),null,m.exaggerated)):null}_cameraForBounds(f,m,b,x,E,P){if(f.projection.name==="globe")return this._cameraForBoundsOnGlobe(f,m,b,x,E,P);const I=f.clone(),L=this._extendCameraOptions(P),H=I.padding;I.bearing=x,I.pitch=E;const F=a.LngLat.convert(m),X=a.LngLat.convert(b),re=new a.LngLat(F.lng,X.lat),oe=new a.LngLat(X.lng,F.lat),le=I.project(F),ue=I.project(X),ce=this.queryTerrainElevation(F),te=this.queryTerrainElevation(X),ge=this.queryTerrainElevation(re),me=this.queryTerrainElevation(oe),be=[[le.x,le.y,Math.min(ce||0,te||0,ge||0,me||0)],[ue.x,ue.y,Math.max(ce||0,te||0,ge||0,me||0)]];let Pe=a.Aabb.fromPoints(be);const Oe=I.getWorldToCameraMatrix(),De=a.invert(new Float64Array(16),Oe);Pe=a.Aabb.applyTransform(Pe,Oe);const Xe=a.sub([],Pe.max,Pe.min),ot=H.left||0,ut=H.right||0,Bt=H.bottom||0,tt=H.top||0,{left:wt,right:pt,top:Ot,bottom:at}=L.padding,Ye=.5*(ot+ut),ct=.5*(tt+Bt),Et=Math.min(I.scaleZoom(I.scale*Math.min((I.width-(ot+ut+wt+pt))/Xe[0],(I.height-(Bt+tt+at+Ot))/Xe[1])),L.maxZoom),Mt=I.scale/I.zoomScale(Et);Pe=new a.Aabb([Pe.min[0]-(wt+Ye)*Mt,Pe.min[1]-(at+ct)*Mt,Pe.min[2]],[Pe.max[0]+(pt+Ye)*Mt,Pe.max[1]+(Ot+ct)*Mt,Pe.max[2]]);const ur=.5*Xe[2],Hr=this._minimumAABBFrustumDistance(I,Pe),rr=[0,0,1,0];a.transformMat4$1(rr,rr,Oe),a.normalize$2(rr,rr);const er=a.scale$2([],rr,Hr+ur),fr=a.add([],Pe.center,er),Xr=(typeof L.offset.x=="number"&&typeof L.offset.y=="number"?new a.pointGeometry(L.offset.x,L.offset.y):a.pointGeometry.convert(L.offset)).rotate(-a.degToRad(x));Pe.center[0]-=Xr.x*Mt,Pe.center[1]+=Xr.y*Mt,a.transformMat4(Pe.center,Pe.center,De),a.transformMat4(fr,fr,De);const gr=[Pe.center[0],Pe.center[1],fr[2]*I.pixelsPerMeter];a.scale$2(gr,gr,1/I.worldSize);const En=a.lngFromMercatorX(gr[0]),On=a.latFromMercatorY(gr[1]),Fn=Math.min(I._zoomFromMercatorZ(gr[2]),L.maxZoom),$n=new a.LngLat(En,On);return I.mercatorFromTransition&&Fn<.5*(a.GLOBE_ZOOM_THRESHOLD_MIN+a.GLOBE_ZOOM_THRESHOLD_MAX)?(I.setProjection({name:"globe"}),I.zoom=Fn,this._cameraForBounds(I,m,b,x,E,P)):{center:$n,zoom:Fn,bearing:x,pitch:E}}fitBounds(f,m,b){const x=this.cameraForBounds(f,m);return this._fitInternal(x,m,b)}fitScreenCoordinates(f,m,b,x,E){const P=a.pointGeometry.convert(f),I=a.pointGeometry.convert(m),L=new a.pointGeometry(Math.min(P.x,I.x),Math.min(P.y,I.y)),H=new a.pointGeometry(Math.max(P.x,I.x),Math.max(P.y,I.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(P,I))return this;const F=this.transform.pointLocation3D(L),X=this.transform.pointLocation3D(H),re=this.transform.pointLocation3D(new a.pointGeometry(L.x,H.y)),oe=this.transform.pointLocation3D(new a.pointGeometry(H.x,L.y)),le=[Math.min(F.lng,X.lng,re.lng,oe.lng),Math.min(F.lat,X.lat,re.lat,oe.lat)],ue=[Math.max(F.lng,X.lng,re.lng,oe.lng),Math.max(F.lat,X.lat,re.lat,oe.lat)],ce=x&&x.pitch?x.pitch:this.getPitch(),te=this._cameraForBounds(this.transform,le,ue,b,ce,x);return this._fitInternal(te,x,E)}_fitInternal(f,m,b){return f?(delete(m=a.extend(f,m)).padding,m.linear?this.easeTo(m,b):this.flyTo(m,b)):this}jumpTo(f,m){this.stop();const b=f.preloadOnly?this.transform.clone():this.transform;let x=!1,E=!1,P=!1;return"zoom"in f&&b.zoom!==+f.zoom&&(x=!0,b.zoom=+f.zoom),f.center!==void 0&&(b.center=a.LngLat.convert(f.center)),"bearing"in f&&b.bearing!==+f.bearing&&(E=!0,b.bearing=+f.bearing),"pitch"in f&&b.pitch!==+f.pitch&&(P=!0,b.pitch=+f.pitch),f.padding==null||b.isPaddingEqual(f.padding)||(b.padding=f.padding),f.preloadOnly?(this._preloadTiles(b),this):(this.fire(new a.Event("movestart",m)).fire(new a.Event("move",m)),x&&this.fire(new a.Event("zoomstart",m)).fire(new a.Event("zoom",m)).fire(new a.Event("zoomend",m)),E&&this.fire(new a.Event("rotatestart",m)).fire(new a.Event("rotate",m)).fire(new a.Event("rotateend",m)),P&&this.fire(new a.Event("pitchstart",m)).fire(new a.Event("pitch",m)).fire(new a.Event("pitchend",m)),this.fire(new a.Event("moveend",m)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||a.warnOnce(Gb),this.transform.getFreeCameraOptions()}setFreeCameraOptions(f,m){const b=this.transform;if(!b.projection.supportsFreeCamera)return a.warnOnce(Gb),this;this.stop();const x=b.zoom,E=b.pitch,P=b.bearing;b.setFreeCameraOptions(f);const I=x!==b.zoom,L=E!==b.pitch,H=P!==b.bearing;return this.fire(new a.Event("movestart",m)).fire(new a.Event("move",m)),I&&this.fire(new a.Event("zoomstart",m)).fire(new a.Event("zoom",m)).fire(new a.Event("zoomend",m)),H&&this.fire(new a.Event("rotatestart",m)).fire(new a.Event("rotate",m)).fire(new a.Event("rotateend",m)),L&&this.fire(new a.Event("pitchstart",m)).fire(new a.Event("pitch",m)).fire(new a.Event("pitchend",m)),this.fire(new a.Event("moveend",m)),this}easeTo(f,m){this._stop(!1,f.easeId),((f=a.extend({offset:[0,0],duration:500,easing:a.ease},f)).animate===!1||!f.essential&&a.exported.prefersReducedMotion)&&(f.duration=0);const b=this.transform,x=this.getZoom(),E=this.getBearing(),P=this.getPitch(),I=this.getPadding(),L="zoom"in f?+f.zoom:x,H="bearing"in f?this._normalizeBearing(f.bearing,E):E,F="pitch"in f?+f.pitch:P,X="padding"in f?f.padding:b.padding,re=a.pointGeometry.convert(f.offset);let oe,le,ue;if(b.projection.name==="globe"){const ot=a.MercatorCoordinate.fromLngLat(b.center),ut=re.rotate(-b.angle);ot.x+=ut.x/b.worldSize,ot.y+=ut.y/b.worldSize;const Bt=ot.toLngLat(),tt=a.LngLat.convert(f.center||Bt);this._normalizeCenter(tt),oe=b.centerPoint.add(ut),le=new a.pointGeometry(ot.x,ot.y).mult(b.worldSize),ue=new a.pointGeometry(a.mercatorXfromLng(tt.lng),a.mercatorYfromLat(tt.lat)).mult(b.worldSize).sub(le)}else{oe=b.centerPoint.add(re);const ot=b.pointLocation(oe),ut=a.LngLat.convert(f.center||ot);this._normalizeCenter(ut),le=b.project(ot),ue=b.project(ut).sub(le)}const ce=b.zoomScale(L-x);let te,ge;f.around&&(te=a.LngLat.convert(f.around),ge=b.locationPoint(te));const me=this._zooming||L!==x,be=this._rotating||E!==H,Pe=this._pitching||F!==P,Oe=!b.isPaddingEqual(X),De=ot=>ut=>{if(me&&(ot.zoom=a.number(x,L,ut)),be&&(ot.bearing=a.number(E,H,ut)),Pe&&(ot.pitch=a.number(P,F,ut)),Oe&&(ot.interpolatePadding(I,X,ut),oe=ot.centerPoint.add(re)),te)ot.setLocationAtPoint(te,ge);else{const Bt=ot.zoomScale(ot.zoom-x),tt=L>x?Math.min(2,ce):Math.max(.5,ce),wt=Math.pow(tt,1-ut),pt=ot.unproject(le.add(ue.mult(ut*wt)).mult(Bt));ot.setLocationAtPoint(ot.renderWorldCopies?pt.wrap():pt,oe)}return f.preloadOnly||this._fireMoveEvents(m),ot};if(f.preloadOnly){const ot=this._emulate(De,f.duration,b);return this._preloadTiles(ot),this}const Xe={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=me,this._rotating=be,this._pitching=Pe,this._padding=Oe,this._easeId=f.easeId,this._prepareEase(m,f.noMoveStart,Xe),this._ease(De(b),ot=>{b.recenterOnTerrain(),this._afterEase(m,ot)},f),this}_prepareEase(f,m,b={}){this._moving=!0,this.transform.cameraElevationReference="sea",m||b.moving||this.fire(new a.Event("movestart",f)),this._zooming&&!b.zooming&&this.fire(new a.Event("zoomstart",f)),this._rotating&&!b.rotating&&this.fire(new a.Event("rotatestart",f)),this._pitching&&!b.pitching&&this.fire(new a.Event("pitchstart",f))}_fireMoveEvents(f){this.fire(new a.Event("move",f)),this._zooming&&this.fire(new a.Event("zoom",f)),this._rotating&&this.fire(new a.Event("rotate",f)),this._pitching&&this.fire(new a.Event("pitch",f))}_afterEase(f,m){if(this._easeId&&m&&this._easeId===m)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const b=this._zooming,x=this._rotating,E=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,b&&this.fire(new a.Event("zoomend",f)),x&&this.fire(new a.Event("rotateend",f)),E&&this.fire(new a.Event("pitchend",f)),this.fire(new a.Event("moveend",f))}flyTo(f,m){if(!f.essential&&a.exported.prefersReducedMotion){const Et=a.pick(f,["center","zoom","bearing","pitch","around"]);return this.jumpTo(Et,m)}this.stop(),f=a.extend({offset:[0,0],speed:1.2,curve:1.42,easing:a.ease},f);const b=this.transform,x=this.getZoom(),E=this.getBearing(),P=this.getPitch(),I=this.getPadding(),L="zoom"in f?a.clamp(+f.zoom,b.minZoom,b.maxZoom):x,H="bearing"in f?this._normalizeBearing(f.bearing,E):E,F="pitch"in f?+f.pitch:P,X="padding"in f?f.padding:b.padding,re=b.zoomScale(L-x),oe=a.pointGeometry.convert(f.offset);let le=b.centerPoint.add(oe);const ue=b.pointLocation(le),ce=a.LngLat.convert(f.center||ue);this._normalizeCenter(ce);const te=b.project(ue),ge=b.project(ce).sub(te);let me=f.curve;const be=Math.max(b.width,b.height),Pe=be/re,Oe=ge.mag();if("minZoom"in f){const Et=a.clamp(Math.min(f.minZoom,x,L),b.minZoom,b.maxZoom),Mt=be/b.zoomScale(Et-x);me=Math.sqrt(Mt/Oe*2)}const De=me*me;function Xe(Et){const Mt=(Pe*Pe-be*be+(Et?-1:1)*De*De*Oe*Oe)/(2*(Et?Pe:be)*De*Oe);return Math.log(Math.sqrt(Mt*Mt+1)-Mt)}function ot(Et){return(Math.exp(Et)-Math.exp(-Et))/2}function ut(Et){return(Math.exp(Et)+Math.exp(-Et))/2}const Bt=Xe(0);let tt=function(Et){return ut(Bt)/ut(Bt+me*Et)},wt=function(Et){return be*((ut(Bt)*(ot(Mt=Bt+me*Et)/ut(Mt))-ot(Bt))/De)/Oe;var Mt},pt=(Xe(1)-Bt)/me;if(Math.abs(Oe)<1e-6||!isFinite(pt)){if(Math.abs(be-Pe)<1e-6)return this.easeTo(f,m);const Et=Pe<be?-1:1;pt=Math.abs(Math.log(Pe/be))/me,wt=function(){return 0},tt=function(Mt){return Math.exp(Et*me*Mt)}}f.duration="duration"in f?+f.duration:1e3*pt/("screenSpeed"in f?+f.screenSpeed/me:+f.speed),f.maxDuration&&f.duration>f.maxDuration&&(f.duration=0);const Ot=E!==H,at=F!==P,Ye=!b.isPaddingEqual(X),ct=Et=>Mt=>{const ur=Mt*pt,Hr=1/tt(ur);Et.zoom=Mt===1?L:x+Et.scaleZoom(Hr),Ot&&(Et.bearing=a.number(E,H,Mt)),at&&(Et.pitch=a.number(P,F,Mt)),Ye&&(Et.interpolatePadding(I,X,Mt),le=Et.centerPoint.add(oe));const rr=Mt===1?ce:Et.unproject(te.add(ge.mult(wt(ur))).mult(Hr));return Et.setLocationAtPoint(Et.renderWorldCopies?rr.wrap():rr,le),Et._updateCameraOnTerrain(),f.preloadOnly||this._fireMoveEvents(m),Et};if(f.preloadOnly){const Et=this._emulate(ct,f.duration,b);return this._preloadTiles(Et),this}return this._zooming=!0,this._rotating=Ot,this._pitching=at,this._padding=Ye,this._prepareEase(m,!1),this._ease(ct(b),()=>this._afterEase(m),f),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(f,m){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const b=this._onEaseEnd;this._onEaseEnd=void 0,b.call(this,m)}if(!f){const b=this.handlers;b&&b.stop(!1)}return this}_ease(f,m,b){b.animate===!1||b.duration===0?(f(1),m()):(this._easeStart=a.exported.now(),this._easeOptions=b,this._onEaseFrame=f,this._onEaseEnd=m,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const f=Math.min((a.exported.now()-this._easeStart)/this._easeOptions.duration,1),m=this._onEaseFrame;m&&m(this._easeOptions.easing(f)),f<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(f,m){f=a.wrap(f,-180,180);const b=Math.abs(f-m);return Math.abs(f-360-m)<b&&(f-=360),Math.abs(f+360-m)<b&&(f+=360),f}_normalizeCenter(f){const m=this.transform;if(!m.renderWorldCopies||m.maxBounds)return;const b=f.lng-m.center.lng;f.lng+=b>180?-360:b<-180?360:0}_emulate(f,m,b){const x=Math.ceil(15*m/1e3),E=[],P=f(b.clone());for(let I=0;I<=x;I++){const L=P(I/x);E.push(L.clone())}return E}}class Yb{constructor(f={}){this.options=f,a.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(f){const m=this.options&&this.options.compact;return this._map=f,this._container=T("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=T("button","mapboxgl-ctrl-attrib-button",this._container),T("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=T("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),m&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),m===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(f,m){const b=this._map._getUIString(`AttributionControl.${m}`);f.setAttribute("aria-label",b),f.removeAttribute("title"),f.firstElementChild&&f.firstElementChild.setAttribute("title",b)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let f=this._editLink;f||(f=this._editLink=this._container.querySelector(".mapbox-improve-map"));const m=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||a.config.ACCESS_TOKEN}];if(f){const b=m.reduce((x,E,P)=>(E.value&&(x+=`${E.key}=${E.value}${P<m.length-1?"&":""}`),x),"?");f.href=`${a.config.FEEDBACK_URL}/${b}#${jb(this._map,!0)}`,f.rel="noopener nofollow",this._setElementTitle(f,"MapFeedback")}}_updateData(f){!f||f.sourceDataType!=="metadata"&&f.sourceDataType!=="visibility"&&f.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let f=[];if(this._map.style.stylesheet){const x=this._map.style.stylesheet;this.styleOwner=x.owner,this.styleId=x.id}const m=this._map.style._sourceCaches;for(const x in m){const E=m[x];if(E.used){const P=E.getSource();P.attribution&&f.indexOf(P.attribution)<0&&f.push(P.attribution)}}f.sort((x,E)=>x.length-E.length),f=f.filter((x,E)=>{for(let P=E+1;P<f.length;P++)if(f[P].indexOf(x)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?f=[...this.options.customAttribution,...f]:f.unshift(this.options.customAttribution));const b=f.join(" | ");b!==this._attribHTML&&(this._attribHTML=b,f.length?(this._innerContainer.innerHTML=b,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class Kb{constructor(){a.bindAll(["_updateLogo","_updateCompact"],this)}onAdd(f){this._map=f,this._container=T("div","mapboxgl-ctrl");const m=T("a","mapboxgl-ctrl-logo");return m.target="_blank",m.rel="noopener nofollow",m.href="https://www.mapbox.com/",m.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),m.setAttribute("rel","noopener nofollow"),this._container.appendChild(m),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(f){f&&f.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const f=this._map.style._sourceCaches;if(Object.entries(f).length===0)return!0;for(const m in f){const b=f[m].getSource();if(b.hasOwnProperty("mapbox_logo")&&!b.mapbox_logo)return!1}return!0}_updateCompact(){const f=this._container.children;if(f.length){const m=f[0];this._map.getCanvasContainer().offsetWidth<250?m.classList.add("mapboxgl-compact"):m.classList.remove("mapboxgl-compact")}}}class Qh{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(f){const m=++this._id;return this._queue.push({callback:f,id:m,cancelled:!1}),m}remove(f){const m=this._currentlyRunning,b=m?this._queue.concat(m):this._queue;for(const x of b)if(x.id===f)return void(x.cancelled=!0)}run(f=0){const m=this._currentlyRunning=this._queue;this._queue=[];for(const b of m)if(!b.cancelled&&(b.callback(f),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function Bm(v,f,m){if(v=new a.LngLat(v.lng,v.lat),f){const b=new a.LngLat(v.lng-360,v.lat),x=new a.LngLat(v.lng+360,v.lat),E=360*Math.ceil(Math.abs(v.lng-m.center.lng)/360),P=m.locationPoint(v).distSqr(f),I=f.x<0||f.y<0||f.x>m.width||f.y>m.height;m.locationPoint(b).distSqr(f)<P&&(I||Math.abs(b.lng-m.center.lng)<E)?v=b:m.locationPoint(x).distSqr(f)<P&&(I||Math.abs(x.lng-m.center.lng)<E)&&(v=x)}for(;Math.abs(v.lng-m.center.lng)>180;){const b=m.locationPoint(v);if(b.x>=0&&b.y>=0&&b.x<=m.width&&b.y<=m.height)break;v.lng>m.center.lng?v.lng-=360:v.lng+=360}return v}const of={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class jm extends a.Evented{constructor(f,m){if(super(),(f instanceof a.window.HTMLElement||m)&&(f=a.extend({element:f},m)),a.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=f&&f.anchor||"center",this._color=f&&f.color||"#3FB1CE",this._scale=f&&f.scale||1,this._draggable=f&&f.draggable||!1,this._clickTolerance=f&&f.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=f&&f.rotation||0,this._rotationAlignment=f&&f.rotationAlignment||"auto",this._pitchAlignment=f&&f.pitchAlignment&&f.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=f&&f.occludedOpacity||.2,f&&f.element)this._element=f.element,this._offset=a.pointGeometry.convert(f&&f.offset||[0,0]);else{this._defaultMarker=!0,this._element=T("div");const x=41,E=27,P=R("svg",{display:"block",height:x*this._scale+"px",width:E*this._scale+"px",viewBox:`0 0 ${E} ${x}`},this._element),I=R("radialGradient",{id:"shadowGradient"},R("defs",{},P));R("stop",{offset:"10%","stop-opacity":.4},I),R("stop",{offset:"100%","stop-opacity":.05},I),R("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},P),R("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},P),R("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},P),R("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},P),this._offset=a.pointGeometry.convert(f&&f.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",x=>{x.preventDefault()}),this._element.addEventListener("mousedown",x=>{x.preventDefault()});const b=this._element.classList;for(const x in of)b.remove(`mapboxgl-marker-anchor-${x}`);b.add(`mapboxgl-marker-anchor-${this._anchor}`),this._popup=null}addTo(f){return f===this._map||(this.remove(),this._map=f,f.getCanvasContainer().appendChild(this._element),f.on("move",this._updateMoving),f.on("moveend",this._update),f.on("remove",this._clearFadeTimer),f._addMarker(this),this.setDraggable(this._draggable),this._update(),f.on("click",this._onMapClick)),this}remove(){const f=this._map;return f&&(f.off("click",this._onMapClick),f.off("move",this._updateMoving),f.off("moveend",this._update),f.off("mousedown",this._addDragHandler),f.off("touchstart",this._addDragHandler),f.off("mouseup",this._onUp),f.off("touchend",this._onUp),f.off("mousemove",this._onMove),f.off("touchmove",this._onMove),f.off("remove",this._clearFadeTimer),f._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(f){return this._lngLat=a.LngLat.convert(f),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(f){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),f){if(!("offset"in f.options)){const x=Math.sqrt(Math.pow(13.5,2)/2);f.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[x,-1*(38.1-13.5+x)],"bottom-right":[-x,-1*(38.1-13.5+x)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=f,f._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(f){const m=f.code,b=f.charCode||f.keyCode;m!=="Space"&&m!=="Enter"&&b!==32&&b!==13||this.togglePopup()}_onMapClick(f){const m=f.originalEvent.target,b=this._element;this._popup&&(m===b||b.contains(m))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const f=this._popup;return f?(f.isOpen()?(f.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(f.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const f=this._map,m=this._pos;if(!f||!m)return!1;const b=f.unproject(m),x=f.getFreeCameraOptions();if(!x.position)return!1;const E=x.position.toLngLat();return E.distanceTo(b)<.9*E.distanceTo(this._lngLat)}_evaluateOpacity(){const f=this._map;if(!f)return;const m=this._pos;if(!m||m.x<0||m.x>f.transform.width||m.y<0||m.y>f.transform.height)return void this._clearFadeTimer();const b=f.unproject(m);let x;f._showingGlobe()&&a.isLngLatBehindGlobe(f.transform,this._lngLat)?x=0:(x=1-f._queryFogOpacity(b),f.transform._terrainEnabled()&&f.getTerrain()&&this._behindTerrain()&&(x*=this._occludedOpacity)),this._element.style.opacity=`${x}`,this._element.style.pointerEvents=x>0?"auto":"none",this._popup&&this._popup._setOpacity(x),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const f=this._pos;if(!f||!this._map)return;const m=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${f.x}px,${f.y}px)
            ${of[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${m.x}px,${m.y}px)
        `}_calculateXYTransform(){const f=this._pos,m=this._map,b=this.getPitchAlignment();if(!m||!f||b!=="map")return"";if(!m._showingGlobe()){const L=m.getPitch();return L?`rotateX(${L}deg)`:""}const x=a.radToDeg(a.globeTiltAtLngLat(m.transform,this._lngLat)),E=f.sub(a.globeCenterToScreenPoint(m.transform)),P=Math.abs(E.x)+Math.abs(E.y);if(P===0)return"";const I=x/P;return`rotateX(${-E.y*I}deg) rotateY(${E.x*I}deg)`}_calculateZTransform(){const f=this._pos,m=this._map;if(!m||!f)return"";let b=0;const x=this.getRotationAlignment();if(x==="map")if(m._showingGlobe()){const E=m.project(new a.LngLat(this._lngLat.lng,this._lngLat.lat+.001)),P=m.project(new a.LngLat(this._lngLat.lng,this._lngLat.lat-.001)).sub(E);b=a.radToDeg(Math.atan2(P.y,P.x))-90}else b=-m.getBearing();else if(x==="horizon"){const E=a.smoothstep(4,6,m.getZoom()),P=a.globeCenterToScreenPoint(m.transform);P.y+=E*m.transform.height;const I=f.sub(P),L=a.radToDeg(Math.atan2(I.y,I.x));b=(L>90?L-270:L+90)*(1-E)}return b+=this._rotation,b?`rotateZ(${b}deg)`:""}_update(f){a.window.cancelAnimationFrame(this._updateFrameId);const m=this._map;m&&(m.transform.renderWorldCopies&&(this._lngLat=Bm(this._lngLat,this._pos,m.transform)),this._pos=m.project(this._lngLat),f===!0?this._updateFrameId=a.window.requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),m._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(m._showingGlobe()||m.getTerrain()||m.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(f){return this._offset=a.pointGeometry.convert(f),this._update(),this}_onMove(f){const m=this._map;if(!m)return;const b=this._pointerdownPos,x=this._positionDelta;if(b&&x){if(!this._isDragging){const E=this._clickTolerance||m._clickTolerance;if(f.point.dist(b)<E)return;this._isDragging=!0}this._pos=f.point.sub(x),this._lngLat=m.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new a.Event("dragstart"))),this.fire(new a.Event("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const f=this._map;f&&(f.off("mousemove",this._onMove),f.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new a.Event("dragend")),this._state="inactive"}_addDragHandler(f){const m=this._map,b=this._pos;m&&b&&this._element.contains(f.originalEvent.target)&&(f.preventDefault(),this._positionDelta=f.point.sub(b),this._pointerdownPos=f.point,this._state="pending",m.on("mousemove",this._onMove),m.on("touchmove",this._onMove),m.once("mouseup",this._onUp),m.once("touchend",this._onUp))}setDraggable(f){this._draggable=!!f;const m=this._map;return m&&(f?(m.on("mousedown",this._addDragHandler),m.on("touchstart",this._addDragHandler)):(m.off("mousedown",this._addDragHandler),m.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(f){return this._rotation=f||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(f){return this._rotationAlignment=f||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(f){return this._pitchAlignment=f||"auto",this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(f){return this._occludedOpacity=f||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const mE={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},yE=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function qb(v=new a.pointGeometry(0,0),f="bottom"){if(typeof v=="number"){const m=Math.round(Math.sqrt(.5*Math.pow(v,2)));switch(f){case"top":return new a.pointGeometry(0,v);case"top-left":return new a.pointGeometry(m,m);case"top-right":return new a.pointGeometry(-m,m);case"bottom":return new a.pointGeometry(0,-v);case"bottom-left":return new a.pointGeometry(m,-m);case"bottom-right":return new a.pointGeometry(-m,-m);case"left":return new a.pointGeometry(v,0);case"right":return new a.pointGeometry(-v,0)}return new a.pointGeometry(0,0)}return v instanceof a.pointGeometry||Array.isArray(v)?a.pointGeometry.convert(v):a.pointGeometry.convert(v[f]||[0,0])}class gE{constructor(f){this.jumpTo(f)}getValue(f){if(f<=this._startTime)return this._start;if(f>=this._endTime)return this._end;const m=a.easeCubicInOut((f-this._startTime)/(this._endTime-this._startTime));return this._start*(1-m)+this._end*m}isEasing(f){return f>=this._startTime&&f<=this._endTime}jumpTo(f){this._startTime=-1/0,this._endTime=-1/0,this._start=f,this._end=f}easeTo(f,m,b){this._start=this.getValue(m),this._end=f,this._startTime=m,this._endTime=m+b}}const vE={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use  + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},_E={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},Xb={showCompass:!0,showZoom:!0,visualizePitch:!1};class bE{constructor(f,m,b=!1){this._clickTolerance=10,this.element=m,this.mouseRotate=new Vb({clickTolerance:f.dragRotate._mouseRotate._clickTolerance}),this.map=f,b&&(this.mousePitch=new Ub({clickTolerance:f.dragRotate._mousePitch._clickTolerance})),a.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),m.addEventListener("mousedown",this.mousedown),m.addEventListener("touchstart",this.touchstart,{passive:!1}),m.addEventListener("touchmove",this.touchmove),m.addEventListener("touchend",this.touchend),m.addEventListener("touchcancel",this.reset)}down(f,m){this.mouseRotate.mousedown(f,m),this.mousePitch&&this.mousePitch.mousedown(f,m),z()}move(f,m){const b=this.map,x=this.mouseRotate.mousemoveWindow(f,m),E=x&&x.bearingDelta;if(E&&b.setBearing(b.getBearing()+E),this.mousePitch){const P=this.mousePitch.mousemoveWindow(f,m),I=P&&P.pitchDelta;I&&b.setPitch(b.getPitch()+I)}}off(){const f=this.element;f.removeEventListener("mousedown",this.mousedown),f.removeEventListener("touchstart",this.touchstart,{passive:!1}),f.removeEventListener("touchmove",this.touchmove),f.removeEventListener("touchend",this.touchend),f.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){V(),a.window.removeEventListener("mousemove",this.mousemove),a.window.removeEventListener("mouseup",this.mouseup)}mousedown(f){this.down(a.extend({},f,{ctrlKey:!0,preventDefault:()=>f.preventDefault()}),K(this.element,f)),a.window.addEventListener("mousemove",this.mousemove),a.window.addEventListener("mouseup",this.mouseup)}mousemove(f){this.move(f,K(this.element,f))}mouseup(f){this.mouseRotate.mouseupWindow(f),this.mousePitch&&this.mousePitch.mouseupWindow(f),this.offTemp()}touchstart(f){f.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=xe(this.element,f.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>f.preventDefault()},this._startPos))}touchmove(f){f.targetTouches.length!==1?this.reset():(this._lastPos=xe(this.element,f.targetTouches)[0],this.move({preventDefault:()=>f.preventDefault()},this._lastPos))}touchend(f){f.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const wE={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},SE={maxWidth:100,unit:"metric"};function xE(v,f,m){const b=zm(f),x=b/f,E={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"}[m];this._map._requestDomTask(()=>{this._container.style.width=v*x+"px",this._container.innerHTML=`${b}&nbsp;${E}`})}function zm(v){const f=Math.pow(10,`${Math.floor(v)}`.length-1);let m=v/f;return m=m>=10?10:m>=5?5:m>=3?3:m>=2?2:m>=1?1:function(b){const x=Math.pow(10,Math.ceil(-Math.log(b)/Math.LN10));return Math.round(b*x)/x}(m),f*m}const ed={version:a.version,supported:p,setRTLTextPlugin:a.setRTLTextPlugin,getRTLTextPluginStatus:a.getRTLTextPluginStatus,Map:class extends pE{constructor(v){if(a.LivePerformanceUtils.mark(a.PerformanceMarkers.create),(v=a.extend({},_E,v)).minZoom!=null&&v.maxZoom!=null&&v.minZoom>v.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(v.minPitch!=null&&v.maxPitch!=null&&v.minPitch>v.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(v.minPitch!=null&&v.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(v.maxPitch!=null&&v.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(v.antialias&&a.isSafariWithAntialiasingBug(a.window)&&(v.antialias=!1,a.warnOnce("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new Qt(v.minZoom,v.maxZoom,v.minPitch,v.maxPitch,v.renderWorldCopies),v),this._interactive=v.interactive,this._minTileCacheSize=v.minTileCacheSize,this._maxTileCacheSize=v.maxTileCacheSize,this._failIfMajorPerformanceCaveat=v.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=v.preserveDrawingBuffer,this._antialias=v.antialias,this._useWebGL2=v.useWebGL2,this._trackResize=v.trackResize,this._bearingSnap=v.bearingSnap,this._refreshExpiredTiles=v.refreshExpiredTiles,this._fadeDuration=v.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=v.crossSourceCollisions,this._collectResourceTiming=v.collectResourceTiming,this._optimizeForTerrain=v.optimizeForTerrain,this._language=this._parseLanguage(v.language),this._worldview=v.worldview,this._renderTaskQueue=new Qh,this._domRenderTaskQueue=new Qh,this._controls=[],this._markers=[],this._popups=[],this._mapId=a.uniqueId(),this._locale=a.extend({},vE,v.locale),this._clickTolerance=v.clickTolerance,this._cooperativeGestures=v.cooperativeGestures,this._performanceMetricsCollection=v.performanceMetricsCollection,this._containerWidth=0,this._containerHeight=0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new gE(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._requestManager=new a.RequestManager(v.transformRequest,v.accessToken,v.testMode),this._silenceAuthErrors=!!v.testMode,typeof v.container=="string"){if(this._container=a.window.document.getElementById(v.container),!this._container)throw new Error(`Container '${v.container}' not found.`)}else{if(!(v.container instanceof a.window.HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=v.container}if(this._container.childNodes.length>0&&a.warnOnce("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),v.maxBounds&&this.setMaxBounds(v.maxBounds),a.bindAll(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),a.window!==void 0&&(a.window.addEventListener("online",this._onWindowOnline,!1),a.window.addEventListener("resize",this._onWindowResize,!1),a.window.addEventListener("orientationchange",this._onWindowResize,!1),a.window.addEventListener("webkitfullscreenchange",this._onWindowResize,!1),a.window.addEventListener("visibilitychange",this._onVisibilityChange,!1)),this.handlers=new dE(this,v),this._localFontFamily=v.localFontFamily,this._localIdeographFontFamily=v.localIdeographFontFamily,v.style&&this.setStyle(v.style,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),v.projection&&this.setProjection(v.projection),this._hash=v.hash&&new eE(typeof v.hash=="string"&&v.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:v.center,zoom:v.zoom,bearing:v.bearing,pitch:v.pitch}),v.bounds&&(this.resize(),this.fitBounds(v.bounds,a.extend({},v.fitBoundsOptions,{duration:0})))),this.resize(),v.attributionControl&&this.addControl(new Yb({customAttribution:v.customAttribution})),this._logoControl=new Kb,this.addControl(this._logoControl,v.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",f=>{this._update(f.dataType==="style"),this.fire(new a.Event(`${f.dataType}data`,f))}),this.on("dataloading",f=>{this.fire(new a.Event(`${f.dataType}dataloading`,f))})}_getMapId(){return this._mapId}addControl(v,f){if(f===void 0&&(f=v.getDefaultPosition?v.getDefaultPosition():"top-right"),!v||!v.onAdd)return this.fire(new a.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const m=v.onAdd(this);this._controls.push(v);const b=this._controlPositions[f];return f.indexOf("bottom")!==-1?b.insertBefore(m,b.firstChild):b.appendChild(m),this}removeControl(v){if(!v||!v.onRemove)return this.fire(new a.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const f=this._controls.indexOf(v);return f>-1&&this._controls.splice(f,1),v.onRemove(this),this}hasControl(v){return this._controls.indexOf(v)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(v){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const f=!this._moving;return f&&this.fire(new a.Event("movestart",v)).fire(new a.Event("move",v)),this.fire(new a.Event("resize",v)),f&&this.fire(new a.Event("moveend",v)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(v){return this.transform.setMaxBounds(a.LngLatBounds.convert(v)),this._update()}setMinZoom(v){if((v=v??-2)>=-2&&v<=this.transform.maxZoom)return this.transform.minZoom=v,this._update(),this.getZoom()<v?this.setZoom(v):this.fire(new a.Event("zoomstart")).fire(new a.Event("zoom")).fire(new a.Event("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(v){if((v=v??22)>=this.transform.minZoom)return this.transform.maxZoom=v,this._update(),this.getZoom()>v?this.setZoom(v):this.fire(new a.Event("zoomstart")).fire(new a.Event("zoom")).fire(new a.Event("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(v){if((v=v??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(v>=0&&v<=this.transform.maxPitch)return this.transform.minPitch=v,this._update(),this.getPitch()<v?this.setPitch(v):this.fire(new a.Event("pitchstart")).fire(new a.Event("pitch")).fire(new a.Event("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(v){if((v=v??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(v>=this.transform.minPitch)return this.transform.maxPitch=v,this._update(),this.getPitch()>v?this.setPitch(v):this.fire(new a.Event("pitchstart")).fire(new a.Event("pitch")).fire(new a.Event("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(v){return this.transform.renderWorldCopies=v,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(v){return v==="auto"?a.window.navigator.language:Array.isArray(v)?v.length===0?void 0:v.map(f=>f==="auto"?a.window.navigator.language:f):v}setLanguage(v){const f=this._parseLanguage(v);if(!this.style||f===this._language)return this;this._language=f,this.style._reloadSources();for(const m of this._controls)m._setLanguage&&m._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(v){return this.style&&v!==this._worldview?(this._worldview=v,this.style._reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(v){return this._lazyInitEmptyStyle(),v?typeof v=="string"&&(v={name:v}):v=null,this._useExplicitProjection=!!v,this._prioritizeAndUpdateProjection(v,this.style.stylesheet?this.style.stylesheet.projection:null)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;const v=this.transform,f=v.projection.name;let m;f==="globe"&&v.zoom>=a.GLOBE_ZOOM_THRESHOLD_MAX?(v.setMercatorFromTransition(),m=!0):f==="mercator"&&v.zoom<a.GLOBE_ZOOM_THRESHOLD_MAX&&(v.setProjection({name:"globe"}),m=!0),m&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(v,f){return this._updateProjection(v||f||{name:"mercator"})}_updateProjection(v){let f;if(f=v.name==="globe"&&this.transform.zoom>=a.GLOBE_ZOOM_THRESHOLD_MAX?this.transform.setMercatorFromTransition():this.transform.setProjection(v),this.style.applyProjectionUpdate(),f){this.painter.clearBackgroundTiles();for(const m in this.style._sourceCaches)this.style._sourceCaches[m].clearTiles();this._update(!0),this._forceMarkerAndPopupUpdate(!0)}return this}project(v){return this.transform.locationPoint3D(a.LngLat.convert(v))}unproject(v){return this.transform.pointLocation3D(a.pointGeometry.convert(v))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(v,f,m){if(v==="mouseenter"||v==="mouseover"){let b=!1;const x=P=>{const I=f.filter(H=>this.getLayer(H)),L=I.length?this.queryRenderedFeatures(P.point,{layers:I}):[];L.length?b||(b=!0,m.call(this,new to(v,this,P.originalEvent,{features:L}))):b=!1},E=()=>{b=!1};return{layers:new Set(f),listener:m,delegates:{mousemove:x,mouseout:E}}}if(v==="mouseleave"||v==="mouseout"){let b=!1;const x=P=>{const I=f.filter(L=>this.getLayer(L));(I.length?this.queryRenderedFeatures(P.point,{layers:I}):[]).length?b=!0:b&&(b=!1,m.call(this,new to(v,this,P.originalEvent)))},E=P=>{b&&(b=!1,m.call(this,new to(v,this,P.originalEvent)))};return{layers:new Set(f),listener:m,delegates:{mousemove:x,mouseout:E}}}{const b=x=>{const E=f.filter(I=>this.getLayer(I)),P=E.length?this.queryRenderedFeatures(x.point,{layers:E}):[];P.length&&(x.features=P,m.call(this,x),delete x.features)};return{layers:new Set(f),listener:m,delegates:{[v]:b}}}}on(v,f,m){if(m===void 0)return super.on(v,f);Array.isArray(f)||(f=[f]);const b=this._createDelegatedListener(v,f,m);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[v]=this._delegatedListeners[v]||[],this._delegatedListeners[v].push(b);for(const x in b.delegates)this.on(x,b.delegates[x]);return this}once(v,f,m){if(m===void 0)return super.once(v,f);Array.isArray(f)||(f=[f]);const b=this._createDelegatedListener(v,f,m);for(const x in b.delegates)this.once(x,b.delegates[x]);return this}off(v,f,m){if(m===void 0)return super.off(v,f);f=new Set(Array.isArray(f)?f:[f]);const b=(E,P)=>{if(E.size!==P.size)return!1;for(const I of E)if(!P.has(I))return!1;return!0},x=this._delegatedListeners?this._delegatedListeners[v]:void 0;return x&&(E=>{for(let P=0;P<E.length;P++){const I=E[P];if(I.listener===m&&b(I.layers,f)){for(const L in I.delegates)this.off(L,I.delegates[L]);return E.splice(P,1),this}}})(x),this}queryRenderedFeatures(v,f){return this.style?(f!==void 0||v===void 0||v instanceof a.pointGeometry||Array.isArray(v)||(f=v,v=void 0),this.style.queryRenderedFeatures(v=v||[[0,0],[this.transform.width,this.transform.height]],f=f||{},this.transform)):[]}querySourceFeatures(v,f){return this.style.querySourceFeatures(v,f)}setStyle(v,f){return(f=a.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},f)).diff!==!1&&f.localIdeographFontFamily===this._localIdeographFontFamily&&f.localFontFamily===this._localFontFamily&&this.style&&v?(this._diffStyle(v,f),this):(this._localIdeographFontFamily=f.localIdeographFontFamily,this._localFontFamily=f.localFontFamily,this._updateStyle(v,f))}_getUIString(v){const f=this._locale[v];if(f==null)throw new Error(`Missing UI string '${v}'`);return f}_updateStyle(v,f){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),v&&(this.style=new xa(this,f||{}),this.style.setEventedParent(this,{style:this.style}),typeof v=="string"?this.style.loadURL(v):this.style.loadJSON(v)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new xa(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(v,f){if(typeof v=="string"){const m=this._requestManager.normalizeStyleURL(v),b=this._requestManager.transformRequest(m,a.ResourceType.Style);a.getJSON(b,(x,E)=>{x?this.fire(new a.ErrorEvent(x)):E&&this._updateDiff(E,f)})}else typeof v=="object"&&this._updateDiff(v,f)}_updateDiff(v,f){try{this.style.setState(v)&&this._update(!0)}catch(m){a.warnOnce(`Unable to perform style diff: ${m.message||m.error||m}.  Rebuilding the style from scratch.`),this._updateStyle(v,f)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(a.warnOnce("There is no style added to the map."),!1)}addSource(v,f){return this._lazyInitEmptyStyle(),this.style.addSource(v,f),this._update(!0)}isSourceLoaded(v){return!!this.style&&this.style._isSourceCacheLoaded(v)}areTilesLoaded(){const v=this.style&&this.style._sourceCaches;for(const f in v){const m=v[f]._tiles;for(const b in m){const x=m[b];if(x.state!=="loaded"&&x.state!=="errored")return!1}}return!0}addSourceType(v,f,m){this._lazyInitEmptyStyle(),this.style.addSourceType(v,f,m)}removeSource(v){return this.style.removeSource(v),this._updateTerrain(),this._update(!0)}getSource(v){return this.style.getSource(v)}addImage(v,f,{pixelRatio:m=1,sdf:b=!1,stretchX:x,stretchY:E,content:P}={}){if(this._lazyInitEmptyStyle(),f instanceof a.window.HTMLImageElement||a.window.ImageBitmap&&f instanceof a.window.ImageBitmap){const{width:I,height:L,data:H}=a.exported.getImageData(f);this.style.addImage(v,{data:new a.RGBAImage({width:I,height:L},H),pixelRatio:m,stretchX:x,stretchY:E,content:P,sdf:b,version:0})}else if(f.width===void 0||f.height===void 0)this.fire(new a.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:I,height:L}=f,H=f;this.style.addImage(v,{data:new a.RGBAImage({width:I,height:L},new Uint8Array(H.data)),pixelRatio:m,stretchX:x,stretchY:E,content:P,sdf:b,version:0,userImage:H}),H.onAdd&&H.onAdd(this,v)}}updateImage(v,f){const m=this.style.getImage(v);if(!m)return void this.fire(new a.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const b=f instanceof a.window.HTMLImageElement||a.window.ImageBitmap&&f instanceof a.window.ImageBitmap?a.exported.getImageData(f):f,{width:x,height:E}=b;x!==void 0&&E!==void 0?x===m.data.width&&E===m.data.height?(m.data.replace(b.data,!(f instanceof a.window.HTMLImageElement||a.window.ImageBitmap&&f instanceof a.window.ImageBitmap)),this.style.updateImage(v,m)):this.fire(new a.ErrorEvent(new Error(`The width and height of the updated image (${x}, ${E})
                must be that same as the previous version of the image
                (${m.data.width}, ${m.data.height})`))):this.fire(new a.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")))}hasImage(v){return v?!!this.style.getImage(v):(this.fire(new a.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(v){this.style.removeImage(v)}loadImage(v,f){a.getImage(this._requestManager.transformRequest(v,a.ResourceType.Image),(m,b)=>{f(m,b instanceof a.window.HTMLImageElement?a.exported.getImageData(b):b)})}listImages(){return this.style.listImages()}addLayer(v,f){return this._lazyInitEmptyStyle(),this.style.addLayer(v,f),this._update(!0)}moveLayer(v,f){return this.style.moveLayer(v,f),this._update(!0)}removeLayer(v){return this.style.removeLayer(v),this._update(!0)}getLayer(v){return this.style.getLayer(v)}setLayerZoomRange(v,f,m){return this.style.setLayerZoomRange(v,f,m),this._update(!0)}setFilter(v,f,m={}){return this.style.setFilter(v,f,m),this._update(!0)}getFilter(v){return this.style.getFilter(v)}setPaintProperty(v,f,m,b={}){return this.style.setPaintProperty(v,f,m,b),this._update(!0)}getPaintProperty(v,f){return this.style.getPaintProperty(v,f)}setLayoutProperty(v,f,m,b={}){return this.style.setLayoutProperty(v,f,m,b),this._update(!0)}getLayoutProperty(v,f){return this.style.getLayoutProperty(v,f)}setLight(v,f={}){return this._lazyInitEmptyStyle(),this.style.setLight(v,f),this._update(!0)}getLight(){return this.style.getLight()}setTerrain(v){return this._lazyInitEmptyStyle(),!v&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(v),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(v){return this._lazyInitEmptyStyle(),this.style.setFog(v),this._update(!0)}getFog(){return this.style?this.style.getFog():null}_queryFogOpacity(v){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(a.LngLat.convert(v),this.transform):0}setFeatureState(v,f){return this.style.setFeatureState(v,f),this._update()}removeFeatureState(v,f){return this.style.removeFeatureState(v,f),this._update()}getFeatureState(v){return this.style.getFeatureState(v)}_updateContainerDimensions(){if(!this._container)return;const v=this._container.getBoundingClientRect().width||400,f=this._container.getBoundingClientRect().height||300;let m,b,x,E=this._container;for(;E&&(!b||!x);){const P=a.window.getComputedStyle(E).transform;P&&P!=="none"&&(m=P.match(/matrix.*\((.+)\)/)[1].split(", "),m[0]&&m[0]!=="0"&&m[0]!=="1"&&(b=m[0]),m[3]&&m[3]!=="0"&&m[3]!=="1"&&(x=m[3])),E=E.parentElement}this._containerWidth=b?Math.abs(v/b):v,this._containerHeight=x?Math.abs(f/x):f}_detectMissingCSS(){a.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&a.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const v=this._container;v.classList.add("mapboxgl-map"),(this._missingCSSCanary=T("div","mapboxgl-canary",v)).style.visibility="hidden",this._detectMissingCSS();const f=this._canvasContainer=T("div","mapboxgl-canvas-container",v);this._interactive&&f.classList.add("mapboxgl-interactive"),this._canvas=T("canvas","mapboxgl-canvas",f),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const m=this._controlContainer=T("div","mapboxgl-control-container",v),b=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(x=>{b[x]=T("div",`mapboxgl-ctrl-${x}`,m)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(v,f){const m=a.exported.devicePixelRatio||1;this._canvas.width=m*Math.ceil(v),this._canvas.height=m*Math.ceil(f),this._canvas.style.width=`${v}px`,this._canvas.style.height=`${f}px`}_addMarker(v){this._markers.push(v)}_removeMarker(v){const f=this._markers.indexOf(v);f!==-1&&this._markers.splice(f,1)}_addPopup(v){this._popups.push(v)}_removePopup(v){const f=this._popups.indexOf(v);f!==-1&&this._popups.splice(f,1)}_setupPainter(){const v=a.extend({},p.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),f=this._useWebGL2&&this._canvas.getContext("webgl2",v),m=f||this._canvas.getContext("webgl",v)||this._canvas.getContext("experimental-webgl",v);m?(this._useWebGL2&&!f&&a.warnOnce("Failed to create WebGL 2 context. Using WebGL 1."),a.storeAuthState(m,!0),this.painter=new Hh(m,this.transform,!!f),this.on("data",b=>{b.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),a.exported$1.testSupport(m)):this.fire(new a.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(v){v.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new a.Event("webglcontextlost",{originalEvent:v}))}_contextRestored(v){this._setupPainter(),this.resize(),this._update(),this.fire(new a.Event("webglcontextrestored",{originalEvent:v}))}_onMapScroll(v){if(v.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(v){return this.style?(this._styleDirty=this._styleDirty||v,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(v){return this._update(),this._renderTaskQueue.add(v)}_cancelRenderFrame(v){this._renderTaskQueue.remove(v)}_requestDomTask(v){!this.loaded()||this.loaded()&&!this.isMoving()?v():this._domRenderTaskQueue.add(v)}_render(v){let f;const m=this.painter.context.extTimerQuery,b=a.exported.now();if(this.listens("gpu-timing-frame")&&(f=m.createQueryEXT(),m.beginQueryEXT(m.TIME_ELAPSED_EXT,f)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],a.window.performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],a.window.performance.now())),this._renderTaskQueue.run(v),this._domRenderTaskQueue.run(v),this._removed)return;this._updateProjectionTransition();const x=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const I=this.transform.zoom,L=this.transform.pitch,H=a.exported.now(),F=new a.EvaluationParameters(I,{now:H,fadeDuration:x,pitch:L,transition:this.style.getTransition()});this.style.update(F)}this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let E=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),E=this._updateAverageElevation(b),this.style._updateSources(this.transform),this._forceMarkerAndPopupUpdate()):E=this._updateAverageElevation(b),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,x,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:x,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new a.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new a.Event("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),f){const I=a.exported.now()-b;m.endQueryEXT(m.TIME_ELAPSED_EXT,f),setTimeout(()=>{const L=m.getQueryObjectEXT(f,m.QUERY_RESULT_EXT)/1e6;m.deleteQueryEXT(f),this.fire(new a.Event("gpu-timing-frame",{cpuTime:I,gpuTime:L})),a.window.performance.mark("frame-gpu",{startTime:b,detail:{gpuTime:L}})},50)}if(this.listens("gpu-timing-layer")){const I=this.painter.collectGpuTimers();setTimeout(()=>{const L=this.painter.queryGpuTimers(I);this.fire(new a.Event("gpu-timing-layer",{layerTimes:L}))},50)}if(this.listens("gpu-timing-deferred-render")){const I=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const L=this.painter.queryGpuTimeDeferredRender(I);this.fire(new a.Event("gpu-timing-deferred-render",{gpuTime:L}))},50)}const P=this._sourcesDirty||this._styleDirty||this._placementDirty||E;if(P||this._repaint)this.triggerRepaint();else{const I=!this.isMoving()&&this.loaded();if(I&&(E=this._updateAverageElevation(b,!0)),E)this.triggerRepaint();else if(this._triggerFrame(!1),I&&(this.fire(new a.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const L=this._calculateSpeedIndex();this.fire(new a.Event("speedindexcompleted",{speedIndex:L})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||P||(this._fullyLoaded=!0,a.LivePerformanceUtils.mark(a.PerformanceMarkers.fullLoad),this._performanceMetricsCollection&&a.postPerformanceEvent(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(v){for(const f of this._markers)v&&!this.getRenderWorldCopies()&&(f._lngLat=f._lngLat.wrap()),f._update();for(const f of this._popups)!v||this.getRenderWorldCopies()||f._trackPointer||(f._lngLat=f._lngLat.wrap()),f._update()}_updateAverageElevation(v,f=!1){const m=b=>(this.transform.averageElevation=b,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&m(0);if((f||v-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(v)){const b=this.transform.averageElevation;let x=this.transform.sampleAverageElevation(),E=!1;this.transform.elevation&&(E=this.transform.elevation.exaggeration()!==this._averageElevationExaggeration,this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(x)?x=0:this._averageElevationLastSampledAt=v;const P=Math.abs(b-x);if(P>1){if(this._isInitialLoad||E)return this._averageElevation.jumpTo(x),m(x);this._averageElevation.easeTo(x,v,300)}else if(P>1e-4)return this._averageElevation.jumpTo(x),m(x)}return!!this._averageElevation.isEasing(v)&&m(this._averageElevation.getValue(v))}_authenticate(){a.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,v=>{if(v&&(v.message===a.AUTH_ERR_MSG||v.status===401)){const f=this.painter.context.gl;a.storeAuthState(f,!1),this._logoControl instanceof Kb&&this._logoControl._updateLogo(),f&&f.clear(f.DEPTH_BUFFER_BIT|f.COLOR_BUFFER_BIT|f.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new a.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),a.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){const v=this._isDragging();this.painter.updateTerrain(this.style,v)}_calculateSpeedIndex(){const v=this.painter.canvasCopy(),f=this.painter.getCanvasCopiesAndTimestamps();f.timeStamps.push(performance.now());const m=this.painter.context.gl,b=m.createFramebuffer();function x(E){m.framebufferTexture2D(m.FRAMEBUFFER,m.COLOR_ATTACHMENT0,m.TEXTURE_2D,E,0);const P=new Uint8Array(m.drawingBufferWidth*m.drawingBufferHeight*4);return m.readPixels(0,0,m.drawingBufferWidth,m.drawingBufferHeight,m.RGBA,m.UNSIGNED_BYTE,P),P}return m.bindFramebuffer(m.FRAMEBUFFER,b),this._canvasPixelComparison(x(v),f.canvasCopies.map(x),f.timeStamps)}_canvasPixelComparison(v,f,m){let b=m[1]-m[0];const x=v.length/4;for(let E=0;E<f.length;E++){const P=f[E];let I=0;for(let L=0;L<P.length;L+=4)P[L]===v[L]&&P[L+1]===v[L+1]&&P[L+2]===v[L+2]&&P[L+3]===v[L+3]&&(I+=1);b+=(m[E+2]-m[E+1])*(1-I/x)}return b}remove(){this._hash&&this._hash.remove();for(const f of this._controls)f.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),a.window!==void 0&&(a.window.removeEventListener("resize",this._onWindowResize,!1),a.window.removeEventListener("orientationchange",this._onWindowResize,!1),a.window.removeEventListener("webkitfullscreenchange",this._onWindowResize,!1),a.window.removeEventListener("online",this._onWindowOnline,!1),a.window.removeEventListener("visibilitychange",this._onVisibilityChange,!1));const v=this.painter.context.gl.getExtension("WEBGL_lose_context");v&&v.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),a.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new a.Event("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(v){this._renderNextFrame=this._renderNextFrame||v,this.style&&!this._frame&&(this._frame=a.exported.frame(f=>{const m=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,m&&this._render(f)}))}_preloadTiles(v){const f=this.style?Object.values(this.style._sourceCaches):[];return a.asyncAll(f,(m,b)=>m._preloadTiles(v,b),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(v){this._trackResize&&this.resize({originalEvent:v})._update()}_onVisibilityChange(){a.window.document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(v){this._showTileBoundaries!==v&&(this._showTileBoundaries=v,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(v){this._showTerrainWireframe!==v&&(this._showTerrainWireframe=v,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(v){this._speedIndexTiming!==v&&(this._speedIndexTiming=v,this._update())}get showPadding(){return!!this._showPadding}set showPadding(v){this._showPadding!==v&&(this._showPadding=v,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(v){this._showCollisionBoxes!==v&&(this._showCollisionBoxes=v,v?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(v){this._showOverdrawInspector!==v&&(this._showOverdrawInspector=v,this._update())}get repaint(){return!!this._repaint}set repaint(v){this._repaint!==v&&(this._repaint=v,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(v){this._vertices=v,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(v){this._showTileAABBs!==v&&(this._showTileAABBs=v,v&&this._update())}_setCacheLimits(v,f){a.setCacheLimits(v,f)}get version(){return a.version}},NavigationControl:class{constructor(v){this.options=a.extend({},Xb,v),this._container=T("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",f=>f.preventDefault()),this.options.showZoom&&(a.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",f=>{this._map&&this._map.zoomIn({},{originalEvent:f})}),T("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",f=>{this._map&&this._map.zoomOut({},{originalEvent:f})}),T("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(a.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",f=>{const m=this._map;m&&(this.options.visualizePitch?m.resetNorthPitch({},{originalEvent:f}):m.resetNorth({},{originalEvent:f}))}),this._compassIcon=T("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const v=this._map;if(!v)return;const f=v.getZoom(),m=f===v.getMaxZoom(),b=f===v.getMinZoom();this._zoomInButton.disabled=m,this._zoomOutButton.disabled=b,this._zoomInButton.setAttribute("aria-disabled",m.toString()),this._zoomOutButton.setAttribute("aria-disabled",b.toString())}_rotateCompassArrow(){const v=this._map;if(!v)return;const f=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(v.transform.pitch*(Math.PI/180)),.5)}) rotateX(${v.transform.pitch}deg) rotateZ(${v.transform.angle*(180/Math.PI)}deg)`:`rotate(${v.transform.angle*(180/Math.PI)}deg)`;v._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=f)})}onAdd(v){return this._map=v,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),v.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&v.on("pitch",this._rotateCompassArrow),v.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new bE(v,this._compass,this.options.visualizePitch)),this._container}onRemove(){const v=this._map;v&&(this._container.remove(),this.options.showZoom&&v.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&v.off("pitch",this._rotateCompassArrow),v.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(v,f){const m=T("button",v,this._container);return m.type="button",m.addEventListener("click",f),m}_setButtonTitle(v,f){if(!this._map)return;const m=this._map._getUIString(`NavigationControl.${f}`);v.setAttribute("aria-label",m),v.firstElementChild&&v.firstElementChild.setAttribute("title",m)}},GeolocateControl:class extends a.Evented{constructor(v){super(),this.options=a.extend({geolocation:a.window.navigator.geolocation},wE,v),a.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=Ca(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(v){return this._map=v,this._container=T("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(v){const f=(m=!!this.options.geolocation)=>{this._supportsGeolocation=m,v(m)};this._supportsGeolocation!==void 0?v(this._supportsGeolocation):a.window.navigator.permissions!==void 0?a.window.navigator.permissions.query({name:"geolocation"}).then(m=>f(m.state!=="denied")).catch(()=>f()):f()}_isOutOfMapMaxBounds(v){const f=this._map.getMaxBounds(),m=v.coords;return!!f&&(m.longitude<f.getWest()||m.longitude>f.getEast()||m.latitude<f.getSouth()||m.latitude>f.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(v){if(this._map){if(this._isOutOfMapMaxBounds(v))return this._setErrorState(),this.fire(new a.Event("outofmaxbounds",v)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=v,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(v),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(v),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new a.Event("geolocate",v)),this._finish()}}_updateCamera(v){const f=new a.LngLat(v.coords.longitude,v.coords.latitude),m=v.coords.accuracy,b=this._map.getBearing(),x=a.extend({bearing:b},this.options.fitBoundsOptions);this._map.fitBounds(f.toBounds(m),x,{geolocateSource:!0})}_updateMarker(v){if(v){const f=new a.LngLat(v.coords.longitude,v.coords.latitude);this._accuracyCircleMarker.setLngLat(f).addTo(this._map),this._userLocationDotMarker.setLngLat(f).addTo(this._map),this._accuracy=v.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const v=this._map.transform,f=a.mercatorZfromAltitude(1,v._center.lat)*v.worldSize,m=Math.ceil(2*this._accuracy*f);this._circleElement.style.width=`${m}px`,this._circleElement.style.height=`${m}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._dotElement.classList.add("mapboxgl-user-location-show-heading")):(this._dotElement.classList.remove("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(v){if(this._map){if(this.options.trackUserLocation)if(v.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const f=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",f),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",f),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(v.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new a.Event("error",v)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(v){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",f=>f.preventDefault()),this._geolocateButton=T("button","mapboxgl-ctrl-geolocate",this._container),T("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",v===!1){a.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const f=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",f),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",f)}else{const f=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",f),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",f)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=T("div","mapboxgl-user-location"),this._dotElement.appendChild(T("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(T("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new jm({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=T("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new jm({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",f=>{f.geolocateSource||this._watchState!=="ACTIVE_LOCK"||f.originalEvent&&f.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new a.Event("trackuserlocationend")))})}}_onDeviceOrientation(v){this._userLocationDotMarker&&(v.webkitCompassHeading?this._heading=v.webkitCompassHeading:v.absolute===!0&&(this._heading=-1*v.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return a.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new a.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new a.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new a.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let v;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(v={maximumAge:6e5,timeout:0},this._noTimeout=!0):(v=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,v),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const v=()=>{a.window.addEventListener("ondeviceorientationabsolute"in a.window?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientation)};a.window.DeviceMotionEvent!==void 0&&typeof a.window.DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(f=>{f==="granted"&&v()}).catch(console.error):v()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),a.window.removeEventListener("deviceorientation",this._onDeviceOrientation),a.window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:Yb,ScaleControl:class{constructor(v){this.options=a.extend({},SE,v),function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"narrow",unit:"meter"}),!0}catch{return!1}}()||(this._setScale=xE.bind(this)),a.bindAll(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const v=this.options.maxWidth||100,f=this._map,m=f._containerHeight/2,b=f._containerWidth/2-v/2,x=f.unproject([b,m]),E=f.unproject([b+v,m]),P=x.distanceTo(E);if(this.options.unit==="imperial"){const I=3.2808*P;I>5280?this._setScale(v,I/5280,"mile"):this._setScale(v,I,"foot")}else this.options.unit==="nautical"?this._setScale(v,P/1852,"nautical-mile"):P>=1e3?this._setScale(v,P/1e3,"kilometer"):this._setScale(v,P,"meter")}_setScale(v,f,m){const b=zm(f),x=b/f;this._map._requestDomTask(()=>{this._container.style.width=v*x+"px",this._container.innerHTML=m!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"narrow",unit:m}).format(b):`${b}&nbsp;nm`})}onAdd(v){return this._map=v,this._language=v.getLanguage(),this._container=T("div","mapboxgl-ctrl mapboxgl-ctrl-scale",v.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(v){this._language=v,this._update()}setUnit(v){this.options.unit=v,this._update()}},FullscreenControl:class{constructor(v){this._fullscreen=!1,v&&v.container&&(v.container instanceof a.window.HTMLElement?this._container=v.container:a.warnOnce("Full screen control 'container' must be a DOM element.")),a.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in a.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in a.window.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(v){return this._map=v,this._container||(this._container=this._map.getContainer()),this._controlContainer=T("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",a.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,a.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!a.window.document.fullscreenEnabled&&!a.window.document.webkitFullscreenEnabled)}_setupUI(){const v=this._fullscreenButton=T("button","mapboxgl-ctrl-fullscreen",this._controlContainer);T("span","mapboxgl-ctrl-icon",v).setAttribute("aria-hidden","true"),v.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),a.window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const v=this._getTitle();this._fullscreenButton.setAttribute("aria-label",v),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",v)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(a.window.document.fullscreenElement||a.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?a.window.document.exitFullscreen?a.window.document.exitFullscreen():a.window.document.webkitCancelFullScreen&&a.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends a.Evented{constructor(v){super(),this.options=a.extend(Object.create(mE),v),a.bindAll(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(v&&v.className?v.className.trim().split(/\s+/):[])}addTo(v){return this._map&&this.remove(),this._map=v,this.options.closeOnClick&&v.on("preclick",this._onClose),this.options.closeOnMove&&v.on("move",this._onClose),v.on("remove",this.remove),this._update(),v._addPopup(this),this._focusFirstElement(),this._trackPointer?(v.on("mousemove",this._onMouseEvent),v.on("mouseup",this._onMouseEvent),v._canvasContainer.classList.add("mapboxgl-track-pointer")):v.on("move",this._update),this.fire(new a.Event("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const v=this._map;return v&&(v.off("move",this._update),v.off("move",this._onClose),v.off("preclick",this._onClose),v.off("click",this._onClose),v.off("remove",this.remove),v.off("mousemove",this._onMouseEvent),v.off("mouseup",this._onMouseEvent),v.off("drag",this._onMouseEvent),v._canvasContainer&&v._canvasContainer.classList.remove("mapboxgl-track-pointer"),v._removePopup(this),this._map=void 0),this.fire(new a.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(v){this._lngLat=a.LngLat.convert(v),this._pos=null,this._trackPointer=!1,this._update();const f=this._map;return f&&(f.on("move",this._update),f.off("mousemove",this._onMouseEvent),f._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const v=this._map;return v&&(v.off("move",this._update),v.on("mousemove",this._onMouseEvent),v.on("drag",this._onMouseEvent),v._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(v){return this.setDOMContent(a.window.document.createTextNode(v))}setHTML(v){const f=a.window.document.createDocumentFragment(),m=a.window.document.createElement("body");let b;for(m.innerHTML=v;b=m.firstChild,b;)f.appendChild(b);return this.setDOMContent(f)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(v){return this.options.maxWidth=v,this._update(),this}setDOMContent(v){let f=this._content;if(f)for(;f.hasChildNodes();)f.firstChild&&f.removeChild(f.firstChild);else f=this._content=T("div","mapboxgl-popup-content",this._container||void 0);if(f.appendChild(v),this.options.closeButton){const m=this._closeButton=T("button","mapboxgl-popup-close-button",f);m.type="button",m.setAttribute("aria-label","Close popup"),m.setAttribute("aria-hidden","true"),m.innerHTML="&#215;",m.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(v){return this._classList.add(v),this._updateClassList(),this}removeClassName(v){return this._classList.delete(v),this._updateClassList(),this}setOffset(v){return this.options.offset=v,this._update(),this}toggleClassName(v){let f;return this._classList.delete(v)?f=!1:(this._classList.add(v),f=!0),this._updateClassList(),f}_onMouseEvent(v){this._update(v.point)}_getAnchor(v){if(this.options.anchor)return this.options.anchor;const f=this._map,m=this._container,b=this._pos;if(!f||!m||!b)return"bottom";const x=m.offsetWidth,E=m.offsetHeight,P=b.x<x/2,I=b.x>f.transform.width-x/2;if(b.y+v<E)return P?"top-left":I?"top-right":"top";if(b.y>f.transform.height-E){if(P)return"bottom-left";if(I)return"bottom-right"}return P?"left":I?"right":"bottom"}_updateClassList(){const v=this._container;if(!v)return;const f=[...this._classList];f.push("mapboxgl-popup"),this._anchor&&f.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&f.push("mapboxgl-popup-track-pointer"),v.className=f.join(" ")}_update(v){const f=this._map,m=this._content;if(!f||!this._lngLat&&!this._trackPointer||!m)return;let b=this._container;if(b||(b=this._container=T("div","mapboxgl-popup",f.getContainer()),this._tip=T("div","mapboxgl-popup-tip",b),b.appendChild(m)),this.options.maxWidth&&b.style.maxWidth!==this.options.maxWidth&&(b.style.maxWidth=this.options.maxWidth),f.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Bm(this._lngLat,this._pos,f.transform)),!this._trackPointer||v){const x=this._pos=this._trackPointer&&v?v:f.project(this._lngLat),E=qb(this.options.offset),P=this._anchor=this._getAnchor(E.y),I=qb(this.options.offset,P),L=x.add(I).round();f._requestDomTask(()=>{this._container&&P&&(this._container.style.transform=`${of[P]} translate(${L.x}px,${L.y}px)`)})}if(!this._marker&&f._showingGlobe()){const x=a.isLngLatBehindGlobe(f.transform,this._lngLat)?0:1;this._setOpacity(x)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const v=this._container.querySelector(yE);v&&v.focus()}_onClose(){this.remove()}_setOpacity(v){this._container&&(this._container.style.opacity=`${v}`),this._content&&(this._content.style.pointerEvents=v?"auto":"none")}},Marker:jm,Style:xa,LngLat:a.LngLat,LngLatBounds:a.LngLatBounds,Point:a.pointGeometry,MercatorCoordinate:a.MercatorCoordinate,FreeCameraOptions:Om,Evented:a.Evented,config:a.config,prewarm:function(){mt().acquire(_r)},clearPrewarmedResources:function(){const v=Ee;v&&(v.isPreloaded()&&v.numActive()===1?(v.release(_r),Ee=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return a.config.ACCESS_TOKEN},set accessToken(v){a.config.ACCESS_TOKEN=v},get baseApiUrl(){return a.config.API_URL},set baseApiUrl(v){a.config.API_URL=v},get workerCount(){return Tt.workerCount},set workerCount(v){Tt.workerCount=v},get maxParallelImageRequests(){return a.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(v){a.config.MAX_PARALLEL_IMAGE_REQUESTS=v},clearStorage(v){a.clearTileCache(v)},workerUrl:"",workerClass:null,setNow:a.exported.setNow,restoreNow:a.exported.restoreNow};return ed});var s=i;return s})})(dre);var Tve=dre.exports;const Iu=V_(Tve),Ove=ro.memo(function({routeData:t}){Iu.accessToken="pk.eyJ1IjoibmV1cmFsbm9uZSIsImEiOiJjbGdiNGw0Y3ExMDZnM2xvdzlveTRidXdsIn0.FBhHUHf-tc6vVp0RDn4awQ";const r=Rt.useRef(null),n=Rt.useRef(null),[i,o]=Rt.useState(-111.8998),[s,a]=Rt.useState(33.2343),[h,p]=Rt.useState(8);let g=Rt.useRef(null);const S=[],T=[],R=ee=>{const K=ee.target.id;n.current.setStyle(K)};Rt.useEffect(()=>{if(t!=null)return n.current==null?setTimeout(()=>{A(),z()},200):(A(),z()),()=>{$()}},[t]);const A=()=>{const ee=t.qGeo.length;for(let K=0;K<ee;K++)V(K,K,t.qGeo,0),G(K,K,t.qGeo,0),n.current.addSource(K,{type:"geojson",data:t.qGeo[K].features}),j(K),n.current.addLayer({id:`${K}`,type:"line",source:`${K}`,layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#2387e4","line-width":6,"line-blur":1}})},$=()=>{const ee=t.qGeo.length;for(let K=0;K<ee;K++){const xe=ee+K;n.current.getLayer(K)&&(n.current.removeLayer(K),n.current.removeSource(K),S[K].remove(),T[K].remove()),n.current.getLayer(K+"border")&&n.current.removeLayer(K+"border"),n.current.getLayer(xe+"border")&&n.current.removeLayer(xe+"border"),n.current.getLayer(xe)&&(n.current.removeLayer(xe),n.current.removeSource(xe),S[xe].remove(),T[xe].remove())}},j=ee=>{n.current.addLayer({id:`${ee+"border"}`,type:"line",source:`${ee}`,layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#a8d5ff","line-width":8}})},z=()=>{const ee=t.rGeo.length;for(let K=0;K<ee;K++){const xe=ee+K;V(xe,K,t.rGeo,1),G(xe,K,t.rGeo,1),n.current.addSource(xe,{type:"geojson",data:t.rGeo[K].features}),j(xe),n.current.addLayer({id:`${xe}`,type:"line",source:`${xe}`,layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#2387e4","line-width":7,"line-blur":1}})}},V=(ee,K,xe,Me)=>{const He=xe[K].features.geometry.coordinates[0][0],Ne=xe[K].features.geometry.coordinates[0][1];let We=document.createElement("div");return We.className=Me==0?"marker-set":"marker-set-route",S[ee]=new Iu.Marker(We).setLngLat([He,Ne]).addTo(n.current),()=>{let gt=S.length;for(let Lt=0;Lt<gt;Lt++)S[Lt].remove()}};Rt.useEffect(()=>{S.length!=0&&S[1].on("click",()=>{console.log("clicked marker")})});const G=(ee,K,xe,Me)=>{const He=xe[K].features.geometry.coordinates.length-1,Ne=xe[K].features.geometry.coordinates[He][0],We=xe[K].features.geometry.coordinates[He][1];let gt=document.createElement("div");return gt.className=Me==0?"marker-set":"marker-set-route-pickup",T[ee]=new Iu.Marker(gt).setLngLat([Ne,We]).addTo(n.current),()=>{const Lt=T.length;for(let _t=0;_t<Lt;_t++)T[_t].remove()}};return Rt.useEffect(()=>{n.current=new Iu.Map({container:r.current,style:"mapbox://styles/mapbox/dark-v11",center:[i,s],zoom:h,attributionControl:!1});const ee=new Iu.AttributionControl({customAttribution:"Map Designed by Ahmed"}),K=new Iu.GeolocateControl({positionOptions:{enableHighAccuracy:!0},trackUserLocation:!0,showUserHeading:!0}),xe=new Iu.NavigationControl({visualizePitch:!0});g=new MapboxGeocoder({accessToken:Iu.accessToken,mapboxgl:Iu}),n.current.addControl(xe,"top-right"),n.current.addControl(ee),n.current.addControl(K),n.current.addControl(g,"top-left");const He=document.getElementById("stylemenu").getElementsByTagName("button");for(const Ne of He)Ne.addEventListener("click",R);return()=>{for(const Ne of He)Ne.removeEventListener("click",R)}},[]),Rt.useEffect(()=>{n.current&&n.current.on("move",()=>{o(n.current.getCenter().lng.toFixed(4)),a(n.current.getCenter().lat.toFixed(4)),p(n.current.getZoom().toFixed(2))})}),Qe.jsx(Qe.Fragment,{children:Qe.jsx("div",{ref:r,className:"map"})})});function Rve({fileName:e,selectFile:t,userFiles:r,queryRouteAPI:n,reformatDataForRouteQuery:i}){const[o,s]=Rt.useState(0),[a,h]=Rt.useState(0),p=()=>{s(o+1)};return Qe.jsx(Qe.Fragment,{children:Qe.jsxs("div",{className:"input-div",children:[Qe.jsx("button",{className:"input-button",onClick:p,children:"Select a schedule"}),Qe.jsx("div",{className:"create-schedule"+(o===0?"":o%2===0?" inactive":" active"),children:Qe.jsx("ul",{children:r.map((g,S)=>Qe.jsx("li",{id:g,className:e!=""&&(a==S||e==g)?"list-css list-css-active":"list-css",onMouseEnter:()=>h(S),onMouseLeave:()=>h(-1),onMouseDown:()=>t(g),children:Qe.jsxs("div",{className:"holder-hold-div",children:[Qe.jsx("div",{style:{display:"inline-block"},children:Qe.jsx("span",{className:"glyphicon glyphicon-th sched-glyph"})}),Qe.jsx("div",{className:"files-div",children:g})]})},S))})}),Qe.jsx("button",{className:"input-button-import",onClick:()=>i(),children:"Route schedule"})]})})}var nn=function(e){try{return!!e()}catch{return!0}},kve=nn,Lx=!kve(function(){var e=function(){}.bind();return typeof e!="function"||e.hasOwnProperty("prototype")}),mre=Lx,yre=Function.prototype,BL=yre.call,Pve=mre&&yre.bind.bind(BL,BL),an=mre?Pve:function(e){return function(){return BL.apply(e,arguments)}},gre=an,Ave=gre({}.toString),Ive=gre("".slice),cu=function(e){return Ive(Ave(e),8,-1)},Mve=an,Dve=nn,$ve=cu,uD=Object,Lve=Mve("".split),Nx=Dve(function(){return!uD("z").propertyIsEnumerable(0)})?function(e){return $ve(e)=="String"?Lve(e,""):uD(e)}:uD,_l=function(e){return e==null},Nve=_l,Bve=TypeError,Fa=function(e){if(Nve(e))throw Bve("Can't call method on "+e);return e},jve=Nx,zve=Fa,cs=function(e){return jve(zve(e))},PT=function(e){return e&&e.Math==Math&&e},ni=PT(typeof globalThis=="object"&&globalThis)||PT(typeof window=="object"&&window)||PT(typeof self=="object"&&self)||PT(typeof ug=="object"&&ug)||function(){return this}()||ug||Function("return this")(),vre={exports:{}},Fve=!1,kG=ni,Hve=Object.defineProperty,LF=function(e,t){try{Hve(kG,e,{value:t,configurable:!0,writable:!0})}catch{kG[e]=t}return t},Vve=ni,Uve=LF,PG="__core-js_shared__",Wve=Vve[PG]||Uve(PG,{}),NF=Wve,AG=NF;(vre.exports=function(e,t){return AG[e]||(AG[e]=t!==void 0?t:{})})("versions",[]).push({version:"3.30.2",mode:"global",copyright:" 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.30.2/LICENSE",source:"https://github.com/zloirock/core-js"});var q_=vre.exports,Gve=Fa,Yve=Object,Ha=function(e){return Yve(Gve(e))},Kve=an,qve=Ha,Xve=Kve({}.hasOwnProperty),Ni=Object.hasOwn||function(t,r){return Xve(qve(t),r)},Zve=an,Jve=0,Qve=Math.random(),e_e=Zve(1 .toString),qP=function(e){return"Symbol("+(e===void 0?"":e)+")_"+e_e(++Jve+Qve,36)},Kp=typeof navigator<"u"&&String(navigator.userAgent)||"",_re=ni,cD=Kp,IG=_re.process,MG=_re.Deno,DG=IG&&IG.versions||MG&&MG.version,$G=DG&&DG.v8,ul,uk;$G&&(ul=$G.split("."),uk=ul[0]>0&&ul[0]<4?1:+(ul[0]+ul[1]));!uk&&cD&&(ul=cD.match(/Edge\/(\d+)/),(!ul||ul[1]>=74)&&(ul=cD.match(/Chrome\/(\d+)/),ul&&(uk=+ul[1])));var Bx=uk,LG=Bx,t_e=nn,r_e=ni,n_e=r_e.String,X_=!!Object.getOwnPropertySymbols&&!t_e(function(){var e=Symbol();return!n_e(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&LG&&LG<41}),i_e=X_,bre=i_e&&!Symbol.sham&&typeof Symbol.iterator=="symbol",o_e=ni,a_e=q_,NG=Ni,s_e=qP,l_e=X_,u_e=bre,og=o_e.Symbol,fD=a_e("wks"),c_e=u_e?og.for||og:og&&og.withoutSetter||s_e,hi=function(e){return NG(fD,e)||(fD[e]=l_e&&NG(og,e)?og[e]:c_e("Symbol."+e)),fD[e]},jL=typeof document=="object"&&document.all,f_e=typeof jL>"u"&&jL!==void 0,wre={all:jL,IS_HTMLDDA:f_e},Sre=wre,h_e=Sre.all,vi=Sre.IS_HTMLDDA?function(e){return typeof e=="function"||e===h_e}:function(e){return typeof e=="function"},BG=vi,xre=wre,d_e=xre.all,Zi=xre.IS_HTMLDDA?function(e){return typeof e=="object"?e!==null:BG(e)||e===d_e}:function(e){return typeof e=="object"?e!==null:BG(e)},p_e=Zi,m_e=String,y_e=TypeError,Wi=function(e){if(p_e(e))return e;throw y_e(m_e(e)+" is not an object")},BF={},g_e=nn,Ji=!g_e(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7}),v_e=Ji,__e=nn,Cre=v_e&&__e(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!=42}),ba={},b_e=ni,jG=Zi,zL=b_e.document,w_e=jG(zL)&&jG(zL.createElement),XP=function(e){return w_e?zL.createElement(e):{}},S_e=Ji,x_e=nn,C_e=XP,Ere=!S_e&&!x_e(function(){return Object.defineProperty(C_e("div"),"a",{get:function(){return 7}}).a!=7}),E_e=Lx,AT=Function.prototype.call,so=E_e?AT.bind(AT):function(){return AT.apply(AT,arguments)},hD=ni,T_e=vi,O_e=function(e){return T_e(e)?e:void 0},Dc=function(e,t){return arguments.length<2?O_e(hD[e]):hD[e]&&hD[e][t]},R_e=an,bh=R_e({}.isPrototypeOf),k_e=Dc,P_e=vi,A_e=bh,I_e=bre,M_e=Object,jx=I_e?function(e){return typeof e=="symbol"}:function(e){var t=k_e("Symbol");return P_e(t)&&A_e(t.prototype,M_e(e))},D_e=String,Z_=function(e){try{return D_e(e)}catch{return"Object"}},$_e=vi,L_e=Z_,N_e=TypeError,qp=function(e){if($_e(e))return e;throw N_e(L_e(e)+" is not a function")},B_e=qp,j_e=_l,Xp=function(e,t){var r=e[t];return j_e(r)?void 0:B_e(r)},dD=so,pD=vi,mD=Zi,z_e=TypeError,Tre=function(e,t){var r,n;if(t==="string"&&pD(r=e.toString)&&!mD(n=dD(r,e))||pD(r=e.valueOf)&&!mD(n=dD(r,e))||t!=="string"&&pD(r=e.toString)&&!mD(n=dD(r,e)))return n;throw z_e("Can't convert object to primitive value")},F_e=so,zG=Zi,FG=jx,H_e=Xp,V_e=Tre,U_e=hi,W_e=TypeError,G_e=U_e("toPrimitive"),Ore=function(e,t){if(!zG(e)||FG(e))return e;var r=H_e(e,G_e),n;if(r){if(t===void 0&&(t="default"),n=F_e(r,e,t),!zG(n)||FG(n))return n;throw W_e("Can't convert object to primitive value")}return t===void 0&&(t="number"),V_e(e,t)},Y_e=Ore,K_e=jx,ZP=function(e){var t=Y_e(e,"string");return K_e(t)?t:t+""},q_e=Ji,X_e=Ere,Z_e=Cre,IT=Wi,HG=ZP,J_e=TypeError,yD=Object.defineProperty,Q_e=Object.getOwnPropertyDescriptor,gD="enumerable",vD="configurable",_D="writable";ba.f=q_e?Z_e?function(t,r,n){if(IT(t),r=HG(r),IT(n),typeof t=="function"&&r==="prototype"&&"value"in n&&_D in n&&!n[_D]){var i=Q_e(t,r);i&&i[_D]&&(t[r]=n.value,n={configurable:vD in n?n[vD]:i[vD],enumerable:gD in n?n[gD]:i[gD],writable:!1})}return yD(t,r,n)}:yD:function(t,r,n){if(IT(t),r=HG(r),IT(n),X_e)try{return yD(t,r,n)}catch{}if("get"in n||"set"in n)throw J_e("Accessors not supported");return"value"in n&&(t[r]=n.value),t};var ebe=Math.ceil,tbe=Math.floor,rbe=Math.trunc||function(t){var r=+t;return(r>0?tbe:ebe)(r)},nbe=rbe,wh=function(e){var t=+e;return t!==t||t===0?0:nbe(t)},ibe=wh,obe=Math.max,abe=Math.min,zx=function(e,t){var r=ibe(e);return r<0?obe(r+t,0):abe(r,t)},sbe=wh,lbe=Math.min,Zp=function(e){return e>0?lbe(sbe(e),9007199254740991):0},ube=Zp,Ns=function(e){return ube(e.length)},cbe=cs,fbe=zx,hbe=Ns,VG=function(e){return function(t,r,n){var i=cbe(t),o=hbe(i),s=fbe(n,o),a;if(e&&r!=r){for(;o>s;)if(a=i[s++],a!=a)return!0}else for(;o>s;s++)if((e||s in i)&&i[s]===r)return e||s||0;return!e&&-1}},jF={includes:VG(!0),indexOf:VG(!1)},Fx={},dbe=an,bD=Ni,pbe=cs,mbe=jF.indexOf,ybe=Fx,UG=dbe([].push),Rre=function(e,t){var r=pbe(e),n=0,i=[],o;for(o in r)!bD(ybe,o)&&bD(r,o)&&UG(i,o);for(;t.length>n;)bD(r,o=t[n++])&&(~mbe(i,o)||UG(i,o));return i},zF=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],gbe=Rre,vbe=zF,Hx=Object.keys||function(t){return gbe(t,vbe)},_be=Ji,bbe=Cre,wbe=ba,Sbe=Wi,xbe=cs,Cbe=Hx;BF.f=_be&&!bbe?Object.defineProperties:function(t,r){Sbe(t);for(var n=xbe(r),i=Cbe(r),o=i.length,s=0,a;o>s;)wbe.f(t,a=i[s++],n[a]);return t};var Ebe=Dc,kre=Ebe("document","documentElement"),Tbe=q_,Obe=qP,WG=Tbe("keys"),JP=function(e){return WG[e]||(WG[e]=Obe(e))},Rbe=Wi,kbe=BF,GG=zF,Pbe=Fx,Abe=kre,Ibe=XP,Mbe=JP,YG=">",KG="<",FL="prototype",HL="script",Pre=Mbe("IE_PROTO"),wD=function(){},Are=function(e){return KG+HL+YG+e+KG+"/"+HL+YG},qG=function(e){e.write(Are("")),e.close();var t=e.parentWindow.Object;return e=null,t},Dbe=function(){var e=Ibe("iframe"),t="java"+HL+":",r;return e.style.display="none",Abe.appendChild(e),e.src=String(t),r=e.contentWindow.document,r.open(),r.write(Are("document.F=Object")),r.close(),r.F},MT,KO=function(){try{MT=new ActiveXObject("htmlfile")}catch{}KO=typeof document<"u"?document.domain&&MT?qG(MT):Dbe():qG(MT);for(var e=GG.length;e--;)delete KO[FL][GG[e]];return KO()};Pbe[Pre]=!0;var J_=Object.create||function(t,r){var n;return t!==null?(wD[FL]=Rbe(t),n=new wD,wD[FL]=null,n[Pre]=t):n=KO(),r===void 0?n:kbe.f(n,r)},$be=hi,Lbe=J_,Nbe=ba.f,VL=$be("unscopables"),UL=Array.prototype;UL[VL]==null&&Nbe(UL,VL,{configurable:!0,value:Lbe(null)});var Vx=function(e){UL[VL][e]=!0},Ux={},Bbe=ni,jbe=vi,XG=Bbe.WeakMap,Ire=jbe(XG)&&/native code/.test(String(XG)),Wx=function(e,t){return{enumerable:!(e&1),configurable:!(e&2),writable:!(e&4),value:t}},zbe=Ji,Fbe=ba,Hbe=Wx,Jp=zbe?function(e,t,r){return Fbe.f(e,t,Hbe(1,r))}:function(e,t,r){return e[t]=r,e},Vbe=Ire,Mre=ni,Ube=Zi,Wbe=Jp,SD=Ni,xD=NF,Gbe=JP,Ybe=Fx,ZG="Object already initialized",WL=Mre.TypeError,Kbe=Mre.WeakMap,ck,_S,fk,qbe=function(e){return fk(e)?_S(e):ck(e,{})},Xbe=function(e){return function(t){var r;if(!Ube(t)||(r=_S(t)).type!==e)throw WL("Incompatible receiver, "+e+" required");return r}};if(Vbe||xD.state){var zl=xD.state||(xD.state=new Kbe);zl.get=zl.get,zl.has=zl.has,zl.set=zl.set,ck=function(e,t){if(zl.has(e))throw WL(ZG);return t.facade=e,zl.set(e,t),t},_S=function(e){return zl.get(e)||{}},fk=function(e){return zl.has(e)}}else{var cy=Gbe("state");Ybe[cy]=!0,ck=function(e,t){if(SD(e,cy))throw WL(ZG);return t.facade=e,Wbe(e,cy,t),t},_S=function(e){return SD(e,cy)?e[cy]:{}},fk=function(e){return SD(e,cy)}}var $c={set:ck,get:_S,has:fk,enforce:qbe,getterFor:Xbe},fu={},Gx={},Dre={}.propertyIsEnumerable,$re=Object.getOwnPropertyDescriptor,Zbe=$re&&!Dre.call({1:2},1);Gx.f=Zbe?function(t){var r=$re(this,t);return!!r&&r.enumerable}:Dre;var Jbe=Ji,Qbe=so,ewe=Gx,twe=Wx,rwe=cs,nwe=ZP,iwe=Ni,owe=Ere,JG=Object.getOwnPropertyDescriptor;fu.f=Jbe?JG:function(t,r){if(t=rwe(t),r=nwe(r),owe)try{return JG(t,r)}catch{}if(iwe(t,r))return twe(!Qbe(ewe.f,t,r),t[r])};var Lre={exports:{}},GL=Ji,awe=Ni,Nre=Function.prototype,swe=GL&&Object.getOwnPropertyDescriptor,FF=awe(Nre,"name"),lwe=FF&&function(){}.name==="something",uwe=FF&&(!GL||GL&&swe(Nre,"name").configurable),Yx={EXISTS:FF,PROPER:lwe,CONFIGURABLE:uwe},cwe=an,fwe=vi,YL=NF,hwe=cwe(Function.toString);fwe(YL.inspectSource)||(YL.inspectSource=function(e){return hwe(e)});var Bre=YL.inspectSource,HF=an,dwe=nn,pwe=vi,DT=Ni,KL=Ji,mwe=Yx.CONFIGURABLE,ywe=Bre,jre=$c,gwe=jre.enforce,vwe=jre.get,QG=String,qO=Object.defineProperty,_we=HF("".slice),bwe=HF("".replace),wwe=HF([].join),Swe=KL&&!dwe(function(){return qO(function(){},"length",{value:8}).length!==8}),xwe=String(String).split("String"),Cwe=Lre.exports=function(e,t,r){_we(QG(t),0,7)==="Symbol("&&(t="["+bwe(QG(t),/^Symbol\(([^)]*)\)/,"$1")+"]"),r&&r.getter&&(t="get "+t),r&&r.setter&&(t="set "+t),(!DT(e,"name")||mwe&&e.name!==t)&&(KL?qO(e,"name",{value:t,configurable:!0}):e.name=t),Swe&&r&&DT(r,"arity")&&e.length!==r.arity&&qO(e,"length",{value:r.arity});try{r&&DT(r,"constructor")&&r.constructor?KL&&qO(e,"prototype",{writable:!1}):e.prototype&&(e.prototype=void 0)}catch{}var n=gwe(e);return DT(n,"source")||(n.source=wwe(xwe,typeof t=="string"?t:"")),e};Function.prototype.toString=Cwe(function(){return pwe(this)&&vwe(this).source||ywe(this)},"toString");var zre=Lre.exports,Ewe=vi,Twe=ba,Owe=zre,Rwe=LF,Bs=function(e,t,r,n){n||(n={});var i=n.enumerable,o=n.name!==void 0?n.name:t;if(Ewe(r)&&Owe(r,o,n),n.global)i?e[t]=r:Rwe(t,r);else{try{n.unsafe?e[t]&&(i=!0):delete e[t]}catch{}i?e[t]=r:Twe.f(e,t,{value:r,enumerable:!1,configurable:!n.nonConfigurable,writable:!n.nonWritable})}return e},Qp={},kwe=Rre,Pwe=zF,Awe=Pwe.concat("length","prototype");Qp.f=Object.getOwnPropertyNames||function(t){return kwe(t,Awe)};var Kx={};Kx.f=Object.getOwnPropertySymbols;var Iwe=Dc,Mwe=an,Dwe=Qp,$we=Kx,Lwe=Wi,Nwe=Mwe([].concat),Fre=Iwe("Reflect","ownKeys")||function(t){var r=Dwe.f(Lwe(t)),n=$we.f;return n?Nwe(r,n(t)):r},e6=Ni,Bwe=Fre,jwe=fu,zwe=ba,Hre=function(e,t,r){for(var n=Bwe(t),i=zwe.f,o=jwe.f,s=0;s<n.length;s++){var a=n[s];!e6(e,a)&&!(r&&e6(r,a))&&i(e,a,o(t,a))}},Fwe=nn,Hwe=vi,Vwe=/#|\.prototype\./,qx=function(e,t){var r=Wwe[Uwe(e)];return r==Ywe?!0:r==Gwe?!1:Hwe(t)?Fwe(t):!!t},Uwe=qx.normalize=function(e){return String(e).replace(Vwe,".").toLowerCase()},Wwe=qx.data={},Gwe=qx.NATIVE="N",Ywe=qx.POLYFILL="P",QP=qx,CD=ni,Kwe=fu.f,qwe=Jp,Xwe=Bs,Zwe=LF,Jwe=Hre,Qwe=QP,Br=function(e,t){var r=e.target,n=e.global,i=e.stat,o,s,a,h,p,g;if(n?s=CD:i?s=CD[r]||Zwe(r,{}):s=(CD[r]||{}).prototype,s)for(a in t){if(p=t[a],e.dontCallGetSet?(g=Kwe(s,a),h=g&&g.value):h=s[a],o=Qwe(n?a:r+(i?".":"#")+a,e.forced),!o&&h!==void 0){if(typeof p==typeof h)continue;Jwe(p,h)}(e.sham||h&&h.sham)&&qwe(p,"sham",!0),Xwe(s,a,p,e)}},e0e=nn,Vre=!e0e(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}),t0e=Ni,r0e=vi,n0e=Ha,i0e=JP,o0e=Vre,t6=i0e("IE_PROTO"),qL=Object,a0e=qL.prototype,eA=o0e?qL.getPrototypeOf:function(e){var t=n0e(e);if(t0e(t,t6))return t[t6];var r=t.constructor;return r0e(r)&&t instanceof r?r.prototype:t instanceof qL?a0e:null},s0e=nn,l0e=vi,u0e=Zi,r6=eA,c0e=Bs,f0e=hi,XL=f0e("iterator"),Ure=!1,kp,ED,TD;[].keys&&(TD=[].keys(),"next"in TD?(ED=r6(r6(TD)),ED!==Object.prototype&&(kp=ED)):Ure=!0);var h0e=!u0e(kp)||s0e(function(){var e={};return kp[XL].call(e)!==e});h0e&&(kp={});l0e(kp[XL])||c0e(kp,XL,function(){return this});var Wre={IteratorPrototype:kp,BUGGY_SAFARI_ITERATORS:Ure},d0e=ba.f,p0e=Ni,m0e=hi,n6=m0e("toStringTag"),tA=function(e,t,r){e&&!r&&(e=e.prototype),e&&!p0e(e,n6)&&d0e(e,n6,{configurable:!0,value:t})},y0e=Wre.IteratorPrototype,g0e=J_,v0e=Wx,_0e=tA,b0e=Ux,w0e=function(){return this},S0e=function(e,t,r,n){var i=t+" Iterator";return e.prototype=g0e(y0e,{next:v0e(+!n,r)}),_0e(e,i,!1),b0e[i]=w0e,e},x0e=an,C0e=qp,E0e=function(e,t,r){try{return x0e(C0e(Object.getOwnPropertyDescriptor(e,t)[r]))}catch{}},T0e=vi,O0e=String,R0e=TypeError,k0e=function(e){if(typeof e=="object"||T0e(e))return e;throw R0e("Can't set "+O0e(e)+" as a prototype")},P0e=E0e,A0e=Wi,I0e=k0e,VF=Object.setPrototypeOf||("__proto__"in{}?function(){var e=!1,t={},r;try{r=P0e(Object.prototype,"__proto__","set"),r(t,[]),e=t instanceof Array}catch{}return function(i,o){return A0e(i),I0e(o),e?r(i,o):i.__proto__=o,i}}():void 0),M0e=Br,D0e=so,Gre=Yx,$0e=vi,L0e=S0e,i6=eA,o6=VF,N0e=tA,B0e=Jp,OD=Bs,j0e=hi,z0e=Ux,Yre=Wre,F0e=Gre.PROPER,H0e=Gre.CONFIGURABLE,a6=Yre.IteratorPrototype,$T=Yre.BUGGY_SAFARI_ITERATORS,zw=j0e("iterator"),s6="keys",Fw="values",l6="entries",V0e=function(){return this},UF=function(e,t,r,n,i,o,s){L0e(r,t,n);var a=function(z){if(z===i&&T)return T;if(!$T&&z in g)return g[z];switch(z){case s6:return function(){return new r(this,z)};case Fw:return function(){return new r(this,z)};case l6:return function(){return new r(this,z)}}return function(){return new r(this)}},h=t+" Iterator",p=!1,g=e.prototype,S=g[zw]||g["@@iterator"]||i&&g[i],T=!$T&&S||a(i),R=t=="Array"&&g.entries||S,A,$,j;if(R&&(A=i6(R.call(new e)),A!==Object.prototype&&A.next&&(i6(A)!==a6&&(o6?o6(A,a6):$0e(A[zw])||OD(A,zw,V0e)),N0e(A,h,!0))),F0e&&i==Fw&&S&&S.name!==Fw&&(H0e?B0e(g,"name",Fw):(p=!0,T=function(){return D0e(S,this)})),i)if($={values:a(Fw),keys:o?T:a(s6),entries:a(l6)},s)for(j in $)($T||p||!(j in g))&&OD(g,j,$[j]);else M0e({target:t,proto:!0,forced:$T||p},$);return g[zw]!==T&&OD(g,zw,T,{name:i}),z0e[t]=T,$},WF=function(e,t){return{value:e,done:t}},U0e=cs,GF=Vx,u6=Ux,Kre=$c,W0e=ba.f,G0e=UF,LT=WF,Y0e=Ji,qre="Array Iterator",K0e=Kre.set,q0e=Kre.getterFor(qre),X0e=G0e(Array,"Array",function(e,t){K0e(this,{type:qre,target:U0e(e),index:0,kind:t})},function(){var e=q0e(this),t=e.target,r=e.kind,n=e.index++;return!t||n>=t.length?(e.target=void 0,LT(void 0,!0)):r=="keys"?LT(n,!1):r=="values"?LT(t[n],!1):LT([n,t[n]],!1)},"values"),c6=u6.Arguments=u6.Array;GF("keys");GF("values");GF("entries");if(Y0e&&c6.name!=="values")try{W0e(c6,"name",{value:"values"})}catch{}var Z0e=hi,J0e=Z0e("toStringTag"),Xre={};Xre[J0e]="z";var YF=String(Xre)==="[object z]",Q0e=YF,eSe=vi,XO=cu,tSe=hi,rSe=tSe("toStringTag"),nSe=Object,iSe=XO(function(){return arguments}())=="Arguments",oSe=function(e,t){try{return e[t]}catch{}},rA=Q0e?XO:function(e){var t,r,n;return e===void 0?"Undefined":e===null?"Null":typeof(r=oSe(t=nSe(e),rSe))=="string"?r:iSe?XO(t):(n=XO(t))=="Object"&&eSe(t.callee)?"Arguments":n},aSe=YF,sSe=rA,lSe=aSe?{}.toString:function(){return"[object "+sSe(this)+"]"},uSe=YF,cSe=Bs,fSe=lSe;uSe||cSe(Object.prototype,"toString",fSe,{unsafe:!0});var hSe=rA,dSe=String,Qi=function(e){if(hSe(e)==="Symbol")throw TypeError("Cannot convert a Symbol value to a string");return dSe(e)},KF=an,pSe=wh,mSe=Qi,ySe=Fa,gSe=KF("".charAt),f6=KF("".charCodeAt),vSe=KF("".slice),h6=function(e){return function(t,r){var n=mSe(ySe(t)),i=pSe(r),o=n.length,s,a;return i<0||i>=o?e?"":void 0:(s=f6(n,i),s<55296||s>56319||i+1===o||(a=f6(n,i+1))<56320||a>57343?e?gSe(n,i):s:e?vSe(n,i,i+2):(s-55296<<10)+(a-56320)+65536)}},qF={codeAt:h6(!1),charAt:h6(!0)},_Se=qF.charAt,bSe=Qi,Zre=$c,wSe=UF,d6=WF,Jre="String Iterator",SSe=Zre.set,xSe=Zre.getterFor(Jre);wSe(String,"String",function(e){SSe(this,{type:Jre,string:bSe(e),index:0})},function(){var t=xSe(this),r=t.string,n=t.index,i;return n>=r.length?d6(void 0,!0):(i=_Se(r,n),t.index+=i.length,d6(i,!1))});var CSe=nn,XF=!CSe(function(){return Object.isExtensible(Object.preventExtensions({}))}),ESe=Bs,ZF=function(e,t,r){for(var n in t)ESe(e,n,t[n],r);return e},Qre={exports:{}},JF={},TSe=ZP,OSe=ba,RSe=Wx,Q_=function(e,t,r){var n=TSe(t);n in e?OSe.f(e,n,RSe(0,r)):e[n]=r},p6=zx,kSe=Ns,PSe=Q_,ASe=Array,ISe=Math.max,QF=function(e,t,r){for(var n=kSe(e),i=p6(t,n),o=p6(r===void 0?n:r,n),s=ASe(ISe(o-i,0)),a=0;i<o;i++,a++)PSe(s,a,e[i]);return s.length=a,s},MSe=cu,DSe=cs,ene=Qp.f,$Se=QF,tne=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],LSe=function(e){try{return ene(e)}catch{return $Se(tne)}};JF.f=function(t){return tne&&MSe(t)=="Window"?LSe(t):ene(DSe(t))};var NSe=nn,BSe=NSe(function(){if(typeof ArrayBuffer=="function"){var e=new ArrayBuffer(8);Object.isExtensible(e)&&Object.defineProperty(e,"a",{value:8})}}),jSe=nn,zSe=Zi,FSe=cu,m6=BSe,ZO=Object.isExtensible,HSe=jSe(function(){ZO(1)}),VSe=HSe||m6?function(t){return!zSe(t)||m6&&FSe(t)=="ArrayBuffer"?!1:ZO?ZO(t):!0}:ZO,USe=Br,WSe=an,GSe=Fx,YSe=Zi,eH=Ni,KSe=ba.f,y6=Qp,qSe=JF,tH=VSe,XSe=qP,ZSe=XF,rne=!1,Rc=XSe("meta"),JSe=0,rH=function(e){KSe(e,Rc,{value:{objectID:"O"+JSe++,weakData:{}}})},QSe=function(e,t){if(!YSe(e))return typeof e=="symbol"?e:(typeof e=="string"?"S":"P")+e;if(!eH(e,Rc)){if(!tH(e))return"F";if(!t)return"E";rH(e)}return e[Rc].objectID},e1e=function(e,t){if(!eH(e,Rc)){if(!tH(e))return!0;if(!t)return!1;rH(e)}return e[Rc].weakData},t1e=function(e){return ZSe&&rne&&tH(e)&&!eH(e,Rc)&&rH(e),e},r1e=function(){n1e.enable=function(){},rne=!0;var e=y6.f,t=WSe([].splice),r={};r[Rc]=1,e(r).length&&(y6.f=function(n){for(var i=e(n),o=0,s=i.length;o<s;o++)if(i[o]===Rc){t(i,o,1);break}return i},USe({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:qSe.f}))},n1e=Qre.exports={enable:r1e,fastKey:QSe,getWeakData:e1e,onFreeze:t1e};GSe[Rc]=!0;var Xx=Qre.exports,i1e=cu,o1e=an,Zx=function(e){if(i1e(e)==="Function")return o1e(e)},g6=Zx,a1e=qp,s1e=Lx,l1e=g6(g6.bind),Jx=function(e,t){return a1e(e),t===void 0?e:s1e?l1e(e,t):function(){return e.apply(t,arguments)}},u1e=hi,c1e=Ux,f1e=u1e("iterator"),h1e=Array.prototype,nne=function(e){return e!==void 0&&(c1e.Array===e||h1e[f1e]===e)},d1e=rA,v6=Xp,p1e=_l,m1e=Ux,y1e=hi,g1e=y1e("iterator"),nH=function(e){if(!p1e(e))return v6(e,g1e)||v6(e,"@@iterator")||m1e[d1e(e)]},v1e=so,_1e=qp,b1e=Wi,w1e=Z_,S1e=nH,x1e=TypeError,ine=function(e,t){var r=arguments.length<2?S1e(e):t;if(_1e(r))return b1e(v1e(r,e));throw x1e(w1e(e)+" is not iterable")},C1e=so,_6=Wi,E1e=Xp,one=function(e,t,r){var n,i;_6(e);try{if(n=E1e(e,"return"),!n){if(t==="throw")throw r;return r}n=C1e(n,e)}catch(o){i=!0,n=o}if(t==="throw")throw r;if(i)throw n;return _6(n),r},T1e=Jx,O1e=so,R1e=Wi,k1e=Z_,P1e=nne,A1e=Ns,b6=bh,I1e=ine,M1e=nH,w6=one,D1e=TypeError,JO=function(e,t){this.stopped=e,this.result=t},S6=JO.prototype,iH=function(e,t,r){var n=r&&r.that,i=!!(r&&r.AS_ENTRIES),o=!!(r&&r.IS_RECORD),s=!!(r&&r.IS_ITERATOR),a=!!(r&&r.INTERRUPTED),h=T1e(t,n),p,g,S,T,R,A,$,j=function(V){return p&&w6(p,"normal",V),new JO(!0,V)},z=function(V){return i?(R1e(V),a?h(V[0],V[1],j):h(V[0],V[1])):a?h(V,j):h(V)};if(o)p=e.iterator;else if(s)p=e;else{if(g=M1e(e),!g)throw D1e(k1e(e)+" is not iterable");if(P1e(g)){for(S=0,T=A1e(e);T>S;S++)if(R=z(e[S]),R&&b6(S6,R))return R;return new JO(!1)}p=I1e(e,g)}for(A=o?e.next:p.next;!($=O1e(A,p)).done;){try{R=z($.value)}catch(V){w6(p,"throw",V)}if(typeof R=="object"&&R&&b6(S6,R))return R}return new JO(!1)},$1e=bh,L1e=TypeError,oH=function(e,t){if($1e(t,e))return e;throw L1e("Incorrect invocation")},N1e=hi,ane=N1e("iterator"),sne=!1;try{var B1e=0,x6={next:function(){return{done:!!B1e++}},return:function(){sne=!0}};x6[ane]=function(){return this},Array.from(x6,function(){throw 2})}catch{}var lne=function(e,t){if(!t&&!sne)return!1;var r=!1;try{var n={};n[ane]=function(){return{next:function(){return{done:r=!0}}}},e(n)}catch{}return r},j1e=vi,z1e=Zi,C6=VF,aH=function(e,t,r){var n,i;return C6&&j1e(n=t.constructor)&&n!==r&&z1e(i=n.prototype)&&i!==r.prototype&&C6(e,i),e},F1e=Br,H1e=ni,V1e=an,E6=QP,U1e=Bs,W1e=Xx,G1e=iH,Y1e=oH,K1e=vi,q1e=_l,RD=Zi,kD=nn,X1e=lne,Z1e=tA,J1e=aH,nA=function(e,t,r){var n=e.indexOf("Map")!==-1,i=e.indexOf("Weak")!==-1,o=n?"set":"add",s=H1e[e],a=s&&s.prototype,h=s,p={},g=function(z){var V=V1e(a[z]);U1e(a,z,z=="add"?function(ee){return V(this,ee===0?0:ee),this}:z=="delete"?function(G){return i&&!RD(G)?!1:V(this,G===0?0:G)}:z=="get"?function(ee){return i&&!RD(ee)?void 0:V(this,ee===0?0:ee)}:z=="has"?function(ee){return i&&!RD(ee)?!1:V(this,ee===0?0:ee)}:function(ee,K){return V(this,ee===0?0:ee,K),this})},S=E6(e,!K1e(s)||!(i||a.forEach&&!kD(function(){new s().entries().next()})));if(S)h=r.getConstructor(t,e,n,o),W1e.enable();else if(E6(e,!0)){var T=new h,R=T[o](i?{}:-0,1)!=T,A=kD(function(){T.has(1)}),$=X1e(function(z){new s(z)}),j=!i&&kD(function(){for(var z=new s,V=5;V--;)z[o](V,V);return!z.has(-0)});$||(h=t(function(z,V){Y1e(z,a);var G=J1e(new s,z,h);return q1e(V)||G1e(V,G[o],{that:G,AS_ENTRIES:n}),G}),h.prototype=a,a.constructor=h),(A||j)&&(g("delete"),g("has"),n&&g("get")),(j||R)&&g(o),i&&a.clear&&delete a.clear}return p[e]=h,F1e({global:!0,constructor:!0,forced:h!=s},p),Z1e(h,e),i||r.setStrong(h,e,n),h},Q1e=cu,eb=Array.isArray||function(t){return Q1e(t)=="Array"},exe=an,txe=nn,une=vi,rxe=rA,nxe=Dc,ixe=Bre,cne=function(){},oxe=[],fne=nxe("Reflect","construct"),sH=/^\s*(?:class|function)\b/,axe=exe(sH.exec),sxe=!sH.exec(cne),Hw=function(t){if(!une(t))return!1;try{return fne(cne,oxe,t),!0}catch{return!1}},hne=function(t){if(!une(t))return!1;switch(rxe(t)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return sxe||!!axe(sH,ixe(t))}catch{return!0}};hne.sham=!0;var iA=!fne||txe(function(){var e;return Hw(Hw.call)||!Hw(Object)||!Hw(function(){e=!0})||e})?hne:Hw,T6=eb,lxe=iA,uxe=Zi,cxe=hi,fxe=cxe("species"),O6=Array,hxe=function(e){var t;return T6(e)&&(t=e.constructor,lxe(t)&&(t===O6||T6(t.prototype))?t=void 0:uxe(t)&&(t=t[fxe],t===null&&(t=void 0))),t===void 0?O6:t},dxe=hxe,lH=function(e,t){return new(dxe(e))(t===0?0:t)},pxe=Jx,mxe=an,yxe=Nx,gxe=Ha,vxe=Ns,_xe=lH,R6=mxe([].push),bf=function(e){var t=e==1,r=e==2,n=e==3,i=e==4,o=e==6,s=e==7,a=e==5||o;return function(h,p,g,S){for(var T=gxe(h),R=yxe(T),A=pxe(p,g),$=vxe(R),j=0,z=S||_xe,V=t?z(h,$):r||s?z(h,0):void 0,G,ee;$>j;j++)if((a||j in R)&&(G=R[j],ee=A(G,j,T),e))if(t)V[j]=ee;else if(ee)switch(e){case 3:return!0;case 5:return G;case 6:return j;case 2:R6(V,G)}else switch(e){case 4:return!1;case 7:R6(V,G)}return o?-1:n||i?i:V}},em={forEach:bf(0),map:bf(1),filter:bf(2),some:bf(3),every:bf(4),find:bf(5),findIndex:bf(6),filterReject:bf(7)},bxe=an,k6=ZF,NT=Xx.getWeakData,wxe=oH,Sxe=Wi,xxe=_l,PD=Zi,Cxe=iH,dne=em,P6=Ni,pne=$c,Exe=pne.set,Txe=pne.getterFor,Oxe=dne.find,Rxe=dne.findIndex,kxe=bxe([].splice),Pxe=0,BT=function(e){return e.frozen||(e.frozen=new mne)},mne=function(){this.entries=[]},AD=function(e,t){return Oxe(e.entries,function(r){return r[0]===t})};mne.prototype={get:function(e){var t=AD(this,e);if(t)return t[1]},has:function(e){return!!AD(this,e)},set:function(e,t){var r=AD(this,e);r?r[1]=t:this.entries.push([e,t])},delete:function(e){var t=Rxe(this.entries,function(r){return r[0]===e});return~t&&kxe(this.entries,t,1),!!~t}};var yne={getConstructor:function(e,t,r,n){var i=e(function(h,p){wxe(h,o),Exe(h,{type:t,id:Pxe++,frozen:void 0}),xxe(p)||Cxe(p,h[n],{that:h,AS_ENTRIES:r})}),o=i.prototype,s=Txe(t),a=function(h,p,g){var S=s(h),T=NT(Sxe(p),!0);return T===!0?BT(S).set(p,g):T[S.id]=g,h};return k6(o,{delete:function(h){var p=s(this);if(!PD(h))return!1;var g=NT(h);return g===!0?BT(p).delete(h):g&&P6(g,p.id)&&delete g[p.id]},has:function(p){var g=s(this);if(!PD(p))return!1;var S=NT(p);return S===!0?BT(g).has(p):S&&P6(S,g.id)}}),k6(o,r?{get:function(p){var g=s(this);if(PD(p)){var S=NT(p);return S===!0?BT(g).get(p):S?S[g.id]:void 0}},set:function(p,g){return a(this,p,g)}}:{add:function(p){return a(this,p,!0)}}),i}},Axe=XF,A6=ni,QO=an,I6=ZF,Ixe=Xx,Mxe=nA,gne=yne,jT=Zi,zT=$c.enforce,Dxe=nn,$xe=Ire,Qx=Object,Lxe=Array.isArray,FT=Qx.isExtensible,vne=Qx.isFrozen,Nxe=Qx.isSealed,_ne=Qx.freeze,Bxe=Qx.seal,M6={},D6={},jxe=!A6.ActiveXObject&&"ActiveXObject"in A6,Vw,bne=function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},wne=Mxe("WeakMap",bne,gne),Hy=wne.prototype,eR=QO(Hy.set),zxe=function(){return Axe&&Dxe(function(){var e=_ne([]);return eR(new wne,e,1),!vne(e)})};if($xe)if(jxe){Vw=gne.getConstructor(bne,"WeakMap",!0),Ixe.enable();var $6=QO(Hy.delete),HT=QO(Hy.has),L6=QO(Hy.get);I6(Hy,{delete:function(e){if(jT(e)&&!FT(e)){var t=zT(this);return t.frozen||(t.frozen=new Vw),$6(this,e)||t.frozen.delete(e)}return $6(this,e)},has:function(t){if(jT(t)&&!FT(t)){var r=zT(this);return r.frozen||(r.frozen=new Vw),HT(this,t)||r.frozen.has(t)}return HT(this,t)},get:function(t){if(jT(t)&&!FT(t)){var r=zT(this);return r.frozen||(r.frozen=new Vw),HT(this,t)?L6(this,t):r.frozen.get(t)}return L6(this,t)},set:function(t,r){if(jT(t)&&!FT(t)){var n=zT(this);n.frozen||(n.frozen=new Vw),HT(this,t)?eR(this,t,r):n.frozen.set(t,r)}else eR(this,t,r);return this}})}else zxe()&&I6(Hy,{set:function(t,r){var n;return Lxe(t)&&(vne(t)?n=M6:Nxe(t)&&(n=D6)),eR(this,t,r),n==M6&&_ne(t),n==D6&&Bxe(t),this}});var Sne={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},Fxe=XP,ID=Fxe("span").classList,N6=ID&&ID.constructor&&ID.constructor.prototype,xne=N6===Object.prototype?void 0:N6,B6=ni,Cne=Sne,Hxe=xne,b0=X0e,MD=Jp,Ene=hi,DD=Ene("iterator"),j6=Ene("toStringTag"),$D=b0.values,Tne=function(e,t){if(e){if(e[DD]!==$D)try{MD(e,DD,$D)}catch{e[DD]=$D}if(e[j6]||MD(e,j6,t),Cne[t]){for(var r in b0)if(e[r]!==b0[r])try{MD(e,r,b0[r])}catch{e[r]=b0[r]}}}};for(var LD in Cne)Tne(B6[LD]&&B6[LD].prototype,LD);Tne(Hxe,"DOMTokenList");var Vxe=nn,tb=function(e,t){var r=[][e];return!!r&&Vxe(function(){r.call(null,t||function(){return 1},1)})},Uxe=Br,Wxe=Zx,Gxe=jF.indexOf,Yxe=tb,ZL=Wxe([].indexOf),One=!!ZL&&1/ZL([1],1,-0)<0,Kxe=One||!Yxe("indexOf");Uxe({target:"Array",proto:!0,forced:Kxe},{indexOf:function(t){var r=arguments.length>1?arguments[1]:void 0;return One?ZL(this,t,r)||0:Gxe(this,t,r)}});var z6=Z_,qxe=TypeError,Rne=function(e,t){if(!delete e[t])throw qxe("Cannot delete property "+z6(t)+" of "+z6(e))},F6=QF,Xxe=Math.floor,JL=function(e,t){var r=e.length,n=Xxe(r/2);return r<8?Zxe(e,t):Jxe(e,JL(F6(e,0,n),t),JL(F6(e,n),t),t)},Zxe=function(e,t){for(var r=e.length,n=1,i,o;n<r;){for(o=n,i=e[n];o&&t(e[o-1],i)>0;)e[o]=e[--o];o!==n++&&(e[o]=i)}return e},Jxe=function(e,t,r,n){for(var i=t.length,o=r.length,s=0,a=0;s<i||a<o;)e[s+a]=s<i&&a<o?n(t[s],r[a])<=0?t[s++]:r[a++]:s<i?t[s++]:r[a++];return e},Qxe=JL,eCe=Kp,H6=eCe.match(/firefox\/(\d+)/i),tCe=!!H6&&+H6[1],rCe=Kp,nCe=/MSIE|Trident/.test(rCe),iCe=Kp,V6=iCe.match(/AppleWebKit\/(\d+)\./),oCe=!!V6&&+V6[1],aCe=Br,kne=an,sCe=qp,lCe=Ha,U6=Ns,uCe=Rne,W6=Qi,uH=nn,cCe=Qxe,fCe=tb,G6=tCe,hCe=nCe,Y6=Bx,K6=oCe,zf=[],q6=kne(zf.sort),dCe=kne(zf.push),pCe=uH(function(){zf.sort(void 0)}),mCe=uH(function(){zf.sort(null)}),yCe=fCe("sort"),Pne=!uH(function(){if(Y6)return Y6<70;if(!(G6&&G6>3)){if(hCe)return!0;if(K6)return K6<603;var e="",t,r,n,i;for(t=65;t<76;t++){switch(r=String.fromCharCode(t),t){case 66:case 69:case 70:case 72:n=3;break;case 68:case 71:n=4;break;default:n=2}for(i=0;i<47;i++)zf.push({k:r+i,v:n})}for(zf.sort(function(o,s){return s.v-o.v}),i=0;i<zf.length;i++)r=zf[i].k.charAt(0),e.charAt(e.length-1)!==r&&(e+=r);return e!=="DGBEFHACIJK"}}),gCe=pCe||!mCe||!yCe||!Pne,vCe=function(e){return function(t,r){return r===void 0?-1:t===void 0?1:e!==void 0?+e(t,r)||0:W6(t)>W6(r)?1:-1}};aCe({target:"Array",proto:!0,forced:gCe},{sort:function(t){t!==void 0&&sCe(t);var r=lCe(this);if(Pne)return t===void 0?q6(r):q6(r,t);var n=[],i=U6(r),o,s;for(s=0;s<i;s++)s in r&&dCe(n,r[s]);for(cCe(n,vCe(t)),o=U6(n),s=0;s<o;)r[s]=n[s++];for(;s<i;)uCe(r,s++);return r}});var _Ce=Br,bCe=em.find,wCe=Vx,QL="find",Ane=!0;QL in[]&&Array(1)[QL](function(){Ane=!1});_Ce({target:"Array",proto:!0,forced:Ane},{find:function(t){return bCe(this,t,arguments.length>1?arguments[1]:void 0)}});wCe(QL);var SCe=Wi,Ine=function(){var e=SCe(this),t="";return e.hasIndices&&(t+="d"),e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.unicodeSets&&(t+="v"),e.sticky&&(t+="y"),t},cH=nn,xCe=ni,fH=xCe.RegExp,hH=cH(function(){var e=fH("a","y");return e.lastIndex=2,e.exec("abcd")!=null}),CCe=hH||cH(function(){return!fH("a","y").sticky}),ECe=hH||cH(function(){var e=fH("^r","gy");return e.lastIndex=2,e.exec("str")!=null}),dH={BROKEN_CARET:ECe,MISSED_STICKY:CCe,UNSUPPORTED_Y:hH},TCe=nn,OCe=ni,RCe=OCe.RegExp,Mne=TCe(function(){var e=RCe(".","s");return!(e.dotAll&&e.exec(`
`)&&e.flags==="s")}),kCe=nn,PCe=ni,ACe=PCe.RegExp,Dne=kCe(function(){var e=ACe("(?<a>b)","g");return e.exec("b").groups.a!=="b"||"b".replace(e,"$<a>c")!=="bc"}),ag=so,oA=an,ICe=Qi,MCe=Ine,DCe=dH,$Ce=q_,LCe=J_,NCe=$c.get,BCe=Mne,jCe=Dne,zCe=$Ce("native-string-replace",String.prototype.replace),hk=RegExp.prototype.exec,eN=hk,FCe=oA("".charAt),HCe=oA("".indexOf),VCe=oA("".replace),ND=oA("".slice),tN=function(){var e=/a/,t=/b*/g;return ag(hk,e,"a"),ag(hk,t,"a"),e.lastIndex!==0||t.lastIndex!==0}(),$ne=DCe.BROKEN_CARET,rN=/()??/.exec("")[1]!==void 0,UCe=tN||rN||$ne||BCe||jCe;UCe&&(eN=function(t){var r=this,n=NCe(r),i=ICe(t),o=n.raw,s,a,h,p,g,S,T;if(o)return o.lastIndex=r.lastIndex,s=ag(eN,o,i),r.lastIndex=o.lastIndex,s;var R=n.groups,A=$ne&&r.sticky,$=ag(MCe,r),j=r.source,z=0,V=i;if(A&&($=VCe($,"y",""),HCe($,"g")===-1&&($+="g"),V=ND(i,r.lastIndex),r.lastIndex>0&&(!r.multiline||r.multiline&&FCe(i,r.lastIndex-1)!==`
`)&&(j="(?: "+j+")",V=" "+V,z++),a=new RegExp("^(?:"+j+")",$)),rN&&(a=new RegExp("^"+j+"$(?!\\s)",$)),tN&&(h=r.lastIndex),p=ag(hk,A?a:r,V),A?p?(p.input=ND(p.input,z),p[0]=ND(p[0],z),p.index=r.lastIndex,r.lastIndex+=p[0].length):r.lastIndex=0:tN&&p&&(r.lastIndex=r.global?p.index+p[0].length:h),rN&&p&&p.length>1&&ag(zCe,p[0],a,function(){for(g=1;g<arguments.length-2;g++)arguments[g]===void 0&&(p[g]=void 0)}),p&&R)for(p.groups=S=LCe(null),g=0;g<R.length;g++)T=R[g],S[T[0]]=p[T[1]];return p});var aA=eN,WCe=Br,X6=aA;WCe({target:"RegExp",proto:!0,forced:/./.exec!==X6},{exec:X6});var GCe=Lx,Lne=Function.prototype,Z6=Lne.apply,J6=Lne.call,tm=typeof Reflect=="object"&&Reflect.apply||(GCe?J6.bind(Z6):function(){return J6.apply(Z6,arguments)}),Q6=Zx,e8=Bs,YCe=aA,t8=nn,Nne=hi,KCe=Jp,qCe=Nne("species"),BD=RegExp.prototype,sA=function(e,t,r,n){var i=Nne(e),o=!t8(function(){var p={};return p[i]=function(){return 7},""[e](p)!=7}),s=o&&!t8(function(){var p=!1,g=/a/;return e==="split"&&(g={},g.constructor={},g.constructor[qCe]=function(){return g},g.flags="",g[i]=/./[i]),g.exec=function(){return p=!0,null},g[i](""),!p});if(!o||!s||r){var a=Q6(/./[i]),h=t(i,""[e],function(p,g,S,T,R){var A=Q6(p),$=g.exec;return $===YCe||$===BD.exec?o&&!R?{done:!0,value:a(g,S,T)}:{done:!0,value:A(S,g,T)}:{done:!1}});e8(String.prototype,e,h[0]),e8(BD,i,h[1])}n&&KCe(BD[i],"sham",!0)},XCe=qF.charAt,pH=function(e,t,r){return t+(r?XCe(e,t).length:1)},mH=an,ZCe=Ha,JCe=Math.floor,jD=mH("".charAt),QCe=mH("".replace),zD=mH("".slice),eEe=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,tEe=/\$([$&'`]|\d{1,2})/g,rEe=function(e,t,r,n,i,o){var s=r+e.length,a=n.length,h=tEe;return i!==void 0&&(i=ZCe(i),h=eEe),QCe(o,h,function(p,g){var S;switch(jD(g,0)){case"$":return"$";case"&":return e;case"`":return zD(t,0,r);case"'":return zD(t,s);case"<":S=i[zD(g,1,-1)];break;default:var T=+g;if(T===0)return p;if(T>a){var R=JCe(T/10);return R===0?p:R<=a?n[R-1]===void 0?jD(g,1):n[R-1]+jD(g,1):p}S=n[T-1]}return S===void 0?"":S})},r8=so,nEe=Wi,iEe=vi,oEe=cu,aEe=aA,sEe=TypeError,lA=function(e,t){var r=e.exec;if(iEe(r)){var n=r8(r,e,t);return n!==null&&nEe(n),n}if(oEe(e)==="RegExp")return r8(aEe,e,t);throw sEe("RegExp#exec called on incompatible receiver")},lEe=tm,n8=so,uA=an,uEe=sA,cEe=nn,fEe=Wi,hEe=vi,dEe=_l,pEe=wh,mEe=Zp,fy=Qi,yEe=Fa,gEe=pH,vEe=Xp,_Ee=rEe,bEe=lA,wEe=hi,nN=wEe("replace"),SEe=Math.max,xEe=Math.min,CEe=uA([].concat),FD=uA([].push),i8=uA("".indexOf),o8=uA("".slice),EEe=function(e){return e===void 0?e:String(e)},TEe=function(){return"a".replace(/./,"$0")==="$0"}(),a8=function(){return/./[nN]?/./[nN]("a","$0")==="":!1}(),OEe=!cEe(function(){var e=/./;return e.exec=function(){var t=[];return t.groups={a:"7"},t},"".replace(e,"$<a>")!=="7"});uEe("replace",function(e,t,r){var n=a8?"$":"$0";return[function(o,s){var a=yEe(this),h=dEe(o)?void 0:vEe(o,nN);return h?n8(h,o,a,s):n8(t,fy(a),o,s)},function(i,o){var s=fEe(this),a=fy(i);if(typeof o=="string"&&i8(o,n)===-1&&i8(o,"$<")===-1){var h=r(t,s,a,o);if(h.done)return h.value}var p=hEe(o);p||(o=fy(o));var g=s.global;if(g){var S=s.unicode;s.lastIndex=0}for(var T=[];;){var R=bEe(s,a);if(R===null||(FD(T,R),!g))break;var A=fy(R[0]);A===""&&(s.lastIndex=gEe(a,mEe(s.lastIndex),S))}for(var $="",j=0,z=0;z<T.length;z++){R=T[z];for(var V=fy(R[0]),G=SEe(xEe(pEe(R.index),a.length),0),ee=[],K=1;K<R.length;K++)FD(ee,EEe(R[K]));var xe=R.groups;if(p){var Me=CEe([V],ee,G,a);xe!==void 0&&FD(Me,xe);var He=fy(lEe(o,void 0,Me))}else He=_Ee(V,a,G,ee,xe,o);G>=j&&($+=o8(a,j,G)+He,j=G+V.length)}return $+o8(a,j)}]},!OEe||!TEe||a8);var REe=nn,kEe=hi,PEe=Bx,AEe=kEe("species"),eC=function(e){return PEe>=51||!REe(function(){var t=[],r=t.constructor={};return r[AEe]=function(){return{foo:1}},t[e](Boolean).foo!==1})},IEe=Br,MEe=em.filter,DEe=eC,$Ee=DEe("filter");IEe({target:"Array",proto:!0,forced:!$Ee},{filter:function(t){return MEe(this,t,arguments.length>1?arguments[1]:void 0)}});var LEe=ni,Bne=LEe,yH={},NEe=hi;yH.f=NEe;var s8=Bne,BEe=Ni,jEe=yH,zEe=ba.f,gH=function(e){var t=s8.Symbol||(s8.Symbol={});BEe(t,e)||zEe(t,e,{value:jEe.f(e)})},FEe=so,HEe=Dc,VEe=hi,UEe=Bs,jne=function(){var e=HEe("Symbol"),t=e&&e.prototype,r=t&&t.valueOf,n=VEe("toPrimitive");t&&!t[n]&&UEe(t,n,function(i){return FEe(r,this)},{arity:1})},WEe=gH,GEe=jne;WEe("toPrimitive");GEe();var YEe=Wi,KEe=Tre,qEe=TypeError,XEe=function(e){if(YEe(this),e==="string"||e==="default")e="string";else if(e!=="number")throw qEe("Incorrect hint");return KEe(this,e)},ZEe=Ni,JEe=Bs,QEe=XEe,eTe=hi,l8=eTe("toPrimitive"),u8=Date.prototype;ZEe(u8,l8)||JEe(u8,l8,QEe);var c8=zre,tTe=ba,tC=function(e,t,r){return r.get&&c8(r.get,t,{getter:!0}),r.set&&c8(r.set,t,{setter:!0}),tTe.f(e,t,r)},cA=Br,vH=ni,_H=so,rTe=an,Ng=Ji,Bg=X_,nTe=nn,ko=Ni,iTe=bh,iN=Wi,fA=cs,bH=ZP,oTe=Qi,oN=Wx,bS=J_,zne=Hx,aTe=Qp,Fne=JF,sTe=Kx,Hne=fu,Vne=ba,lTe=BF,Une=Gx,HD=Bs,uTe=tC,wH=q_,cTe=JP,Wne=Fx,f8=qP,fTe=hi,hTe=yH,dTe=gH,pTe=jne,mTe=tA,Gne=$c,hA=em.forEach,$a=cTe("hidden"),dA="Symbol",wS="prototype",yTe=Gne.set,h8=Gne.getterFor(dA),As=Object[wS],_p=vH.Symbol,w0=_p&&_p[wS],gTe=vH.TypeError,VD=vH.QObject,Yne=Hne.f,jd=Vne.f,Kne=Fne.f,vTe=Une.f,qne=rTe([].push),kc=wH("symbols"),rC=wH("op-symbols"),_Te=wH("wks"),aN=!VD||!VD[wS]||!VD[wS].findChild,sN=Ng&&nTe(function(){return bS(jd({},"a",{get:function(){return jd(this,"a",{value:7}).a}})).a!=7})?function(e,t,r){var n=Yne(As,t);n&&delete As[t],jd(e,t,r),n&&e!==As&&jd(As,t,n)}:jd,UD=function(e,t){var r=kc[e]=bS(w0);return yTe(r,{type:dA,tag:e,description:t}),Ng||(r.description=t),r},pA=function(t,r,n){t===As&&pA(rC,r,n),iN(t);var i=bH(r);return iN(n),ko(kc,i)?(n.enumerable?(ko(t,$a)&&t[$a][i]&&(t[$a][i]=!1),n=bS(n,{enumerable:oN(0,!1)})):(ko(t,$a)||jd(t,$a,oN(1,{})),t[$a][i]=!0),sN(t,i,n)):jd(t,i,n)},SH=function(t,r){iN(t);var n=fA(r),i=zne(n).concat(Jne(n));return hA(i,function(o){(!Ng||_H(lN,n,o))&&pA(t,o,n[o])}),t},bTe=function(t,r){return r===void 0?bS(t):SH(bS(t),r)},lN=function(t){var r=bH(t),n=_H(vTe,this,r);return this===As&&ko(kc,r)&&!ko(rC,r)?!1:n||!ko(this,r)||!ko(kc,r)||ko(this,$a)&&this[$a][r]?n:!0},Xne=function(t,r){var n=fA(t),i=bH(r);if(!(n===As&&ko(kc,i)&&!ko(rC,i))){var o=Yne(n,i);return o&&ko(kc,i)&&!(ko(n,$a)&&n[$a][i])&&(o.enumerable=!0),o}},Zne=function(t){var r=Kne(fA(t)),n=[];return hA(r,function(i){!ko(kc,i)&&!ko(Wne,i)&&qne(n,i)}),n},Jne=function(e){var t=e===As,r=Kne(t?rC:fA(e)),n=[];return hA(r,function(i){ko(kc,i)&&(!t||ko(As,i))&&qne(n,kc[i])}),n};Bg||(_p=function(){if(iTe(w0,this))throw gTe("Symbol is not a constructor");var t=!arguments.length||arguments[0]===void 0?void 0:oTe(arguments[0]),r=f8(t),n=function(i){this===As&&_H(n,rC,i),ko(this,$a)&&ko(this[$a],r)&&(this[$a][r]=!1),sN(this,r,oN(1,i))};return Ng&&aN&&sN(As,r,{configurable:!0,set:n}),UD(r,t)},w0=_p[wS],HD(w0,"toString",function(){return h8(this).tag}),HD(_p,"withoutSetter",function(e){return UD(f8(e),e)}),Une.f=lN,Vne.f=pA,lTe.f=SH,Hne.f=Xne,aTe.f=Fne.f=Zne,sTe.f=Jne,hTe.f=function(e){return UD(fTe(e),e)},Ng&&(uTe(w0,"description",{configurable:!0,get:function(){return h8(this).description}}),HD(As,"propertyIsEnumerable",lN,{unsafe:!0})));cA({global:!0,constructor:!0,wrap:!0,forced:!Bg,sham:!Bg},{Symbol:_p});hA(zne(_Te),function(e){dTe(e)});cA({target:dA,stat:!0,forced:!Bg},{useSetter:function(){aN=!0},useSimple:function(){aN=!1}});cA({target:"Object",stat:!0,forced:!Bg,sham:!Ng},{create:bTe,defineProperty:pA,defineProperties:SH,getOwnPropertyDescriptor:Xne});cA({target:"Object",stat:!0,forced:!Bg},{getOwnPropertyNames:Zne});pTe();mTe(_p,dA);Wne[$a]=!0;var wTe=X_,Qne=wTe&&!!Symbol.for&&!!Symbol.keyFor,STe=Br,xTe=Dc,CTe=Ni,ETe=Qi,eie=q_,TTe=Qne,WD=eie("string-to-symbol-registry"),OTe=eie("symbol-to-string-registry");STe({target:"Symbol",stat:!0,forced:!TTe},{for:function(e){var t=ETe(e);if(CTe(WD,t))return WD[t];var r=xTe("Symbol")(t);return WD[t]=r,OTe[r]=t,r}});var RTe=Br,kTe=Ni,PTe=jx,ATe=Z_,ITe=q_,MTe=Qne,d8=ITe("symbol-to-string-registry");RTe({target:"Symbol",stat:!0,forced:!MTe},{keyFor:function(t){if(!PTe(t))throw TypeError(ATe(t)+" is not a symbol");if(kTe(d8,t))return d8[t]}});var DTe=an,nC=DTe([].slice),$Te=an,p8=eb,LTe=vi,m8=cu,NTe=Qi,y8=$Te([].push),BTe=function(e){if(LTe(e))return e;if(p8(e)){for(var t=e.length,r=[],n=0;n<t;n++){var i=e[n];typeof i=="string"?y8(r,i):(typeof i=="number"||m8(i)=="Number"||m8(i)=="String")&&y8(r,NTe(i))}var o=r.length,s=!0;return function(a,h){if(s)return s=!1,h;if(p8(this))return h;for(var p=0;p<o;p++)if(r[p]===a)return h}}},jTe=Br,tie=Dc,rie=tm,zTe=so,iC=an,nie=nn,g8=vi,v8=jx,iie=nC,FTe=BTe,HTe=X_,VTe=String,Qf=tie("JSON","stringify"),VT=iC(/./.exec),_8=iC("".charAt),UTe=iC("".charCodeAt),WTe=iC("".replace),GTe=iC(1 .toString),YTe=/[\uD800-\uDFFF]/g,b8=/^[\uD800-\uDBFF]$/,w8=/^[\uDC00-\uDFFF]$/,S8=!HTe||nie(function(){var e=tie("Symbol")();return Qf([e])!="[null]"||Qf({a:e})!="{}"||Qf(Object(e))!="{}"}),x8=nie(function(){return Qf("\uDF06\uD834")!=='"\\udf06\\ud834"'||Qf("\uDEAD")!=='"\\udead"'}),KTe=function(e,t){var r=iie(arguments),n=FTe(t);if(!(!g8(n)&&(e===void 0||v8(e))))return r[1]=function(i,o){if(g8(n)&&(o=zTe(n,this,VTe(i),o)),!v8(o))return o},rie(Qf,null,r)},qTe=function(e,t,r){var n=_8(r,t-1),i=_8(r,t+1);return VT(b8,e)&&!VT(w8,i)||VT(w8,e)&&!VT(b8,n)?"\\u"+GTe(UTe(e,0),16):e};Qf&&jTe({target:"JSON",stat:!0,arity:3,forced:S8||x8},{stringify:function(t,r,n){var i=iie(arguments),o=rie(S8?KTe:Qf,null,i);return x8&&typeof o=="string"?WTe(o,YTe,qTe):o}});var XTe=Br,ZTe=X_,JTe=nn,oie=Kx,QTe=Ha,eOe=!ZTe||JTe(function(){oie.f(1)});XTe({target:"Object",stat:!0,forced:eOe},{getOwnPropertySymbols:function(t){var r=oie.f;return r?r(QTe(t)):[]}});var tOe=Br,rOe=Ji,nOe=ni,UT=an,iOe=Ni,oOe=vi,aOe=bh,sOe=Qi,lOe=tC,uOe=Hre,Fu=nOe.Symbol,yd=Fu&&Fu.prototype;if(rOe&&oOe(Fu)&&(!("description"in yd)||Fu().description!==void 0)){var C8={},WT=function(){var t=arguments.length<1||arguments[0]===void 0?void 0:sOe(arguments[0]),r=aOe(yd,this)?new Fu(t):t===void 0?Fu():Fu(t);return t===""&&(C8[r]=!0),r};uOe(WT,Fu),WT.prototype=yd,yd.constructor=WT;var cOe=String(Fu("test"))=="Symbol(test)",fOe=UT(yd.valueOf),hOe=UT(yd.toString),dOe=/^Symbol\((.*)\)[^)]+$/,pOe=UT("".replace),mOe=UT("".slice);lOe(yd,"description",{configurable:!0,get:function(){var t=fOe(this);if(iOe(C8,t))return"";var r=hOe(t),n=cOe?mOe(r,7,-1):pOe(r,dOe,"$1");return n===""?void 0:n}}),tOe({global:!0,constructor:!0,forced:!0},{Symbol:WT})}var yOe=an,aie=yOe(1 .valueOf),sie=`	
\v\f\r \u2028\u2029\uFEFF`,gOe=an,vOe=Fa,_Oe=Qi,uN=sie,E8=gOe("".replace),bOe=RegExp("^["+uN+"]+"),wOe=RegExp("(^|[^"+uN+"])["+uN+"]+$"),GD=function(e){return function(t){var r=_Oe(vOe(t));return e&1&&(r=E8(r,bOe,"")),e&2&&(r=E8(r,wOe,"$1")),r}},lie={start:GD(1),end:GD(2),trim:GD(3)},SOe=Br,uie=Fve,xOe=Ji,cie=ni,fie=Bne,hie=an,COe=QP,T8=Ni,EOe=aH,TOe=bh,OOe=jx,die=Ore,ROe=nn,kOe=Qp.f,POe=fu.f,AOe=ba.f,IOe=aie,MOe=lie.trim,mA="Number",yg=cie[mA];fie[mA];var xH=yg.prototype,DOe=cie.TypeError,$Oe=hie("".slice),GT=hie("".charCodeAt),LOe=function(e){var t=die(e,"number");return typeof t=="bigint"?t:NOe(t)},NOe=function(e){var t=die(e,"number"),r,n,i,o,s,a,h,p;if(OOe(t))throw DOe("Cannot convert a Symbol value to a number");if(typeof t=="string"&&t.length>2){if(t=MOe(t),r=GT(t,0),r===43||r===45){if(n=GT(t,2),n===88||n===120)return NaN}else if(r===48){switch(GT(t,1)){case 66:case 98:i=2,o=49;break;case 79:case 111:i=8,o=55;break;default:return+t}for(s=$Oe(t,2),a=s.length,h=0;h<a;h++)if(p=GT(s,h),p<48||p>o)return NaN;return parseInt(s,i)}}return+t},CH=COe(mA,!yg(" 0o1")||!yg("0b1")||yg("+0x1")),BOe=function(e){return TOe(xH,e)&&ROe(function(){IOe(e)})},yA=function(t){var r=arguments.length<1?0:yg(LOe(t));return BOe(this)?EOe(Object(r),this,yA):r};yA.prototype=xH;CH&&!uie&&(xH.constructor=yA);SOe({global:!0,constructor:!0,wrap:!0,forced:CH},{Number:yA});var jOe=function(e,t){for(var r=xOe?kOe(t):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),n=0,i;r.length>n;n++)T8(t,i=r[n])&&!T8(e,i)&&AOe(e,i,POe(t,i))};(CH||uie)&&jOe(fie[mA],yg);var zOe=Br,FOe=VF;zOe({target:"Object",stat:!0},{setPrototypeOf:FOe});var HOe=Br,VOe=nn,UOe=Ha,pie=eA,WOe=Vre,GOe=VOe(function(){pie(1)});HOe({target:"Object",stat:!0,forced:GOe,sham:!WOe},{getPrototypeOf:function(t){return pie(UOe(t))}});var mie=an,YOe=qp,KOe=Zi,qOe=Ni,O8=nC,XOe=Lx,yie=Function,ZOe=mie([].concat),JOe=mie([].join),YD={},QOe=function(e,t,r){if(!qOe(YD,t)){for(var n=[],i=0;i<t;i++)n[i]="a["+i+"]";YD[t]=yie("C,a","return new C("+JOe(n,",")+")")}return YD[t](e,r)},eRe=XOe?yie.bind:function(t){var r=YOe(this),n=r.prototype,i=O8(arguments,1),o=function(){var a=ZOe(i,O8(arguments));return this instanceof o?QOe(r,a.length,a):r.apply(t,a)};return KOe(n)&&(o.prototype=n),o},tRe=iA,rRe=Z_,nRe=TypeError,gie=function(e){if(tRe(e))return e;throw nRe(rRe(e)+" is not a constructor")},iRe=Br,oRe=Dc,KD=tm,aRe=eRe,R8=gie,sRe=Wi,k8=Zi,lRe=J_,vie=nn,EH=oRe("Reflect","construct"),uRe=Object.prototype,cRe=[].push,_ie=vie(function(){function e(){}return!(EH(function(){},[],e)instanceof e)}),bie=!vie(function(){EH(function(){})}),P8=_ie||bie;iRe({target:"Reflect",stat:!0,forced:P8,sham:P8},{construct:function(t,r){R8(t),sRe(r);var n=arguments.length<3?t:R8(arguments[2]);if(bie&&!_ie)return EH(t,r,n);if(t==n){switch(r.length){case 0:return new t;case 1:return new t(r[0]);case 2:return new t(r[0],r[1]);case 3:return new t(r[0],r[1],r[2]);case 4:return new t(r[0],r[1],r[2],r[3])}var i=[null];return KD(cRe,i,r),new(KD(aRe,t,i))}var o=n.prototype,s=lRe(k8(o)?o:uRe),a=KD(t,s,r);return k8(a)?a:s}});var A8=Ni,fRe=function(e){return e!==void 0&&(A8(e,"value")||A8(e,"writable"))},hRe=Br,dRe=so,pRe=Zi,mRe=Wi,yRe=fRe,gRe=fu,vRe=eA;function wie(e,t){var r=arguments.length<3?e:arguments[2],n,i;if(mRe(e)===r)return e[t];if(n=gRe.f(e,t),n)return yRe(n)?n.value:n.get===void 0?void 0:dRe(n.get,r);if(pRe(i=vRe(e)))return wie(i,t,r)}hRe({target:"Reflect",stat:!0},{get:wie});var _Re=Br,bRe=nn,wRe=cs,Sie=fu.f,xie=Ji,SRe=!xie||bRe(function(){Sie(1)});_Re({target:"Object",stat:!0,forced:SRe,sham:!xie},{getOwnPropertyDescriptor:function(t,r){return Sie(wRe(t),r)}});var xRe=gH;xRe("iterator");var CRe=Br,I8=eb,ERe=iA,TRe=Zi,M8=zx,ORe=Ns,RRe=cs,kRe=Q_,PRe=hi,ARe=eC,IRe=nC,MRe=ARe("slice"),DRe=PRe("species"),qD=Array,$Re=Math.max;CRe({target:"Array",proto:!0,forced:!MRe},{slice:function(t,r){var n=RRe(this),i=ORe(n),o=M8(t,i),s=M8(r===void 0?i:r,i),a,h,p;if(I8(n)&&(a=n.constructor,ERe(a)&&(a===qD||I8(a.prototype))?a=void 0:TRe(a)&&(a=a[DRe],a===null&&(a=void 0)),a===qD||a===void 0))return IRe(n,o,s);for(h=new(a===void 0?qD:a)($Re(s-o,0)),p=0;o<s;o++,p++)o in n&&kRe(h,p,n[o]);return h.length=p,h}});var LRe=Ji,NRe=Yx.EXISTS,Cie=an,BRe=tC,Eie=Function.prototype,jRe=Cie(Eie.toString),Tie=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,zRe=Cie(Tie.exec),FRe="name";LRe&&!NRe&&BRe(Eie,FRe,{configurable:!0,get:function(){try{return zRe(Tie,jRe(this))[1]}catch{return""}}});var HRe=Wi,VRe=one,URe=function(e,t,r,n){try{return n?t(HRe(r)[0],r[1]):t(r)}catch(i){VRe(e,"throw",i)}},WRe=Jx,GRe=so,YRe=Ha,KRe=URe,qRe=nne,XRe=iA,ZRe=Ns,D8=Q_,JRe=ine,QRe=nH,$8=Array,eke=function(t){var r=YRe(t),n=XRe(this),i=arguments.length,o=i>1?arguments[1]:void 0,s=o!==void 0;s&&(o=WRe(o,i>2?arguments[2]:void 0));var a=QRe(r),h=0,p,g,S,T,R,A;if(a&&!(this===$8&&qRe(a)))for(T=JRe(r,a),R=T.next,g=n?new this:[];!(S=GRe(R,T)).done;h++)A=s?KRe(T,o,[S.value,h],!0):S.value,D8(g,h,A);else for(p=ZRe(r),g=n?new this(p):$8(p);p>h;h++)A=s?o(r[h],h):r[h],D8(g,h,A);return g.length=h,g},tke=Br,rke=eke,nke=lne,ike=!nke(function(e){Array.from(e)});tke({target:"Array",stat:!0,forced:ike},{from:rke});var oke=Br,ake=XF,ske=nn,lke=Zi,uke=Xx.onFreeze,cN=Object.freeze,cke=ske(function(){cN(1)});oke({target:"Object",stat:!0,forced:cke,sham:!ake},{freeze:function(t){return cN&&lke(t)?cN(uke(t)):t}});var fke=Yx.PROPER,hke=nn,L8=sie,N8="",dke=function(e){return hke(function(){return!!L8[e]()||N8[e]()!==N8||fke&&L8[e].name!==e})},pke=Br,mke=lie.trim,yke=dke;pke({target:"String",proto:!0,forced:yke("trim")},{trim:function(){return mke(this)}});var gke=Br,vke=jF.includes,_ke=nn,bke=Vx,wke=_ke(function(){return!Array(1).includes()});gke({target:"Array",proto:!0,forced:wke},{includes:function(t){return vke(this,t,arguments.length>1?arguments[1]:void 0)}});bke("includes");var Ske=so,xke=Ni,Cke=bh,Eke=Ine,B8=RegExp.prototype,Oie=function(e){var t=e.flags;return t===void 0&&!("flags"in B8)&&!xke(e,"flags")&&Cke(B8,e)?Ske(Eke,e):t},Tke=Yx.PROPER,Oke=Bs,Rke=Wi,j8=Qi,kke=nn,Pke=Oie,TH="toString",Ake=RegExp.prototype,Rie=Ake[TH],Ike=kke(function(){return Rie.call({source:"a",flags:"b"})!="/a/b"}),Mke=Tke&&Rie.name!=TH;(Ike||Mke)&&Oke(RegExp.prototype,TH,function(){var t=Rke(this),r=j8(t.source),n=j8(Pke(t));return"/"+r+"/"+n},{unsafe:!0});var Dke=Br,$ke=qF.codeAt;Dke({target:"String",proto:!0},{codePointAt:function(t){return $ke(this,t)}});var Lke=wh,Nke=Qi,Bke=Fa,jke=RangeError,kie=function(t){var r=Nke(Bke(this)),n="",i=Lke(t);if(i<0||i==1/0)throw jke("Wrong number of repetitions");for(;i>0;(i>>>=1)&&(r+=r))i&1&&(n+=r);return n},Pie=an,zke=Zp,z8=Qi,Fke=kie,Hke=Fa,Vke=Pie(Fke),Uke=Pie("".slice),Wke=Math.ceil,F8=function(e){return function(t,r,n){var i=z8(Hke(t)),o=zke(r),s=i.length,a=n===void 0?" ":z8(n),h,p;return o<=s||a==""?i:(h=o-s,p=Vke(a,Wke(h/a.length)),p.length>h&&(p=Uke(p,0,h)),e?i+p:p+i)}},Gke={start:F8(!1),end:F8(!0)},Yke=Kp,Kke=/Version\/10(?:\.\d+){1,2}(?: [\w./]+)?(?: Mobile\/\w+)? Safari\//.test(Yke),qke=Br,Xke=Gke.start,Zke=Kke;qke({target:"String",proto:!0,forced:Zke},{padStart:function(t){return Xke(this,t,arguments.length>1?arguments[1]:void 0)}});//! moment.js
//! version : 2.29.4
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var Aie;function Vt(){return Aie.apply(null,arguments)}function Jke(e){Aie=e}function yl(e){return e instanceof Array||Object.prototype.toString.call(e)==="[object Array]"}function bp(e){return e!=null&&Object.prototype.toString.call(e)==="[object Object]"}function Bn(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function OH(e){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(e).length===0;var t;for(t in e)if(Bn(e,t))return!1;return!0}function Ia(e){return e===void 0}function Pc(e){return typeof e=="number"||Object.prototype.toString.call(e)==="[object Number]"}function oC(e){return e instanceof Date||Object.prototype.toString.call(e)==="[object Date]"}function Iie(e,t){var r=[],n,i=e.length;for(n=0;n<i;++n)r.push(t(e[n],n));return r}function Ff(e,t){for(var r in t)Bn(t,r)&&(e[r]=t[r]);return Bn(t,"toString")&&(e.toString=t.toString),Bn(t,"valueOf")&&(e.valueOf=t.valueOf),e}function hu(e,t,r,n){return roe(e,t,r,n,!0).utc()}function Qke(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function cn(e){return e._pf==null&&(e._pf=Qke()),e._pf}var fN;Array.prototype.some?fN=Array.prototype.some:fN=function(e){var t=Object(this),r=t.length>>>0,n;for(n=0;n<r;n++)if(n in t&&e.call(this,t[n],n,t))return!0;return!1};function RH(e){if(e._isValid==null){var t=cn(e),r=fN.call(t.parsedDateParts,function(i){return i!=null}),n=!isNaN(e._d.getTime())&&t.overflow<0&&!t.empty&&!t.invalidEra&&!t.invalidMonth&&!t.invalidWeekday&&!t.weekdayMismatch&&!t.nullInput&&!t.invalidFormat&&!t.userInvalidated&&(!t.meridiem||t.meridiem&&r);if(e._strict&&(n=n&&t.charsLeftOver===0&&t.unusedTokens.length===0&&t.bigHour===void 0),Object.isFrozen==null||!Object.isFrozen(e))e._isValid=n;else return n}return e._isValid}function gA(e){var t=hu(NaN);return e!=null?Ff(cn(t),e):cn(t).userInvalidated=!0,t}var H8=Vt.momentProperties=[],XD=!1;function kH(e,t){var r,n,i,o=H8.length;if(Ia(t._isAMomentObject)||(e._isAMomentObject=t._isAMomentObject),Ia(t._i)||(e._i=t._i),Ia(t._f)||(e._f=t._f),Ia(t._l)||(e._l=t._l),Ia(t._strict)||(e._strict=t._strict),Ia(t._tzm)||(e._tzm=t._tzm),Ia(t._isUTC)||(e._isUTC=t._isUTC),Ia(t._offset)||(e._offset=t._offset),Ia(t._pf)||(e._pf=cn(t)),Ia(t._locale)||(e._locale=t._locale),o>0)for(r=0;r<o;r++)n=H8[r],i=t[n],Ia(i)||(e[n]=i);return e}function aC(e){kH(this,e),this._d=new Date(e._d!=null?e._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),XD===!1&&(XD=!0,Vt.updateOffset(this),XD=!1)}function gl(e){return e instanceof aC||e!=null&&e._isAMomentObject!=null}function Mie(e){Vt.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+e)}function js(e,t){var r=!0;return Ff(function(){if(Vt.deprecationHandler!=null&&Vt.deprecationHandler(null,e),r){var n=[],i,o,s,a=arguments.length;for(o=0;o<a;o++){if(i="",typeof arguments[o]=="object"){i+=`
[`+o+"] ";for(s in arguments[0])Bn(arguments[0],s)&&(i+=s+": "+arguments[0][s]+", ");i=i.slice(0,-2)}else i=arguments[o];n.push(i)}Mie(e+`
Arguments: `+Array.prototype.slice.call(n).join("")+`
`+new Error().stack),r=!1}return t.apply(this,arguments)},t)}var V8={};function Die(e,t){Vt.deprecationHandler!=null&&Vt.deprecationHandler(e,t),V8[e]||(Mie(t),V8[e]=!0)}Vt.suppressDeprecationWarnings=!1;Vt.deprecationHandler=null;function du(e){return typeof Function<"u"&&e instanceof Function||Object.prototype.toString.call(e)==="[object Function]"}function ePe(e){var t,r;for(r in e)Bn(e,r)&&(t=e[r],du(t)?this[r]=t:this["_"+r]=t);this._config=e,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function hN(e,t){var r=Ff({},e),n;for(n in t)Bn(t,n)&&(bp(e[n])&&bp(t[n])?(r[n]={},Ff(r[n],e[n]),Ff(r[n],t[n])):t[n]!=null?r[n]=t[n]:delete r[n]);for(n in e)Bn(e,n)&&!Bn(t,n)&&bp(e[n])&&(r[n]=Ff({},r[n]));return r}function PH(e){e!=null&&this.set(e)}var dN;Object.keys?dN=Object.keys:dN=function(e){var t,r=[];for(t in e)Bn(e,t)&&r.push(t);return r};var tPe={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function rPe(e,t,r){var n=this._calendar[e]||this._calendar.sameElse;return du(n)?n.call(t,r):n}function su(e,t,r){var n=""+Math.abs(e),i=t-n.length,o=e>=0;return(o?r?"+":"":"-")+Math.pow(10,Math.max(0,i)).toString().substr(1)+n}var AH=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,YT=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,ZD={},gg={};function Mr(e,t,r,n){var i=n;typeof n=="string"&&(i=function(){return this[n]()}),e&&(gg[e]=i),t&&(gg[t[0]]=function(){return su(i.apply(this,arguments),t[1],t[2])}),r&&(gg[r]=function(){return this.localeData().ordinal(i.apply(this,arguments),e)})}function nPe(e){return e.match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function iPe(e){var t=e.match(AH),r,n;for(r=0,n=t.length;r<n;r++)gg[t[r]]?t[r]=gg[t[r]]:t[r]=nPe(t[r]);return function(i){var o="",s;for(s=0;s<n;s++)o+=du(t[s])?t[s].call(i,e):t[s];return o}}function tR(e,t){return e.isValid()?(t=$ie(t,e.localeData()),ZD[t]=ZD[t]||iPe(t),ZD[t](e)):e.localeData().invalidDate()}function $ie(e,t){var r=5;function n(i){return t.longDateFormat(i)||i}for(YT.lastIndex=0;r>=0&&YT.test(e);)e=e.replace(YT,n),YT.lastIndex=0,r-=1;return e}var oPe={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function aPe(e){var t=this._longDateFormat[e],r=this._longDateFormat[e.toUpperCase()];return t||!r?t:(this._longDateFormat[e]=r.match(AH).map(function(n){return n==="MMMM"||n==="MM"||n==="DD"||n==="dddd"?n.slice(1):n}).join(""),this._longDateFormat[e])}var sPe="Invalid date";function lPe(){return this._invalidDate}var uPe="%d",cPe=/\d{1,2}/;function fPe(e){return this._ordinal.replace("%d",e)}var hPe={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function dPe(e,t,r,n){var i=this._relativeTime[r];return du(i)?i(e,t,r,n):i.replace(/%d/i,e)}function pPe(e,t){var r=this._relativeTime[e>0?"future":"past"];return du(r)?r(t):r.replace(/%s/i,t)}var B0={};function ta(e,t){var r=e.toLowerCase();B0[r]=B0[r+"s"]=B0[t]=e}function zs(e){return typeof e=="string"?B0[e]||B0[e.toLowerCase()]:void 0}function IH(e){var t={},r,n;for(n in e)Bn(e,n)&&(r=zs(n),r&&(t[r]=e[n]));return t}var Lie={};function ra(e,t){Lie[e]=t}function mPe(e){var t=[],r;for(r in e)Bn(e,r)&&t.push({unit:r,priority:Lie[r]});return t.sort(function(n,i){return n.priority-i.priority}),t}function vA(e){return e%4===0&&e%100!==0||e%400===0}function Rs(e){return e<0?Math.ceil(e)||0:Math.floor(e)}function Sn(e){var t=+e,r=0;return t!==0&&isFinite(t)&&(r=Rs(t)),r}function rb(e,t){return function(r){return r!=null?(Nie(this,e,r),Vt.updateOffset(this,t),this):dk(this,e)}}function dk(e,t){return e.isValid()?e._d["get"+(e._isUTC?"UTC":"")+t]():NaN}function Nie(e,t,r){e.isValid()&&!isNaN(r)&&(t==="FullYear"&&vA(e.year())&&e.month()===1&&e.date()===29?(r=Sn(r),e._d["set"+(e._isUTC?"UTC":"")+t](r,e.month(),CA(r,e.month()))):e._d["set"+(e._isUTC?"UTC":"")+t](r))}function yPe(e){return e=zs(e),du(this[e])?this[e]():this}function gPe(e,t){if(typeof e=="object"){e=IH(e);var r=mPe(e),n,i=r.length;for(n=0;n<i;n++)this[r[n].unit](e[r[n].unit])}else if(e=zs(e),du(this[e]))return this[e](t);return this}var Bie=/\d/,fs=/\d\d/,jie=/\d{3}/,MH=/\d{4}/,_A=/[+-]?\d{6}/,_i=/\d\d?/,zie=/\d\d\d\d?/,Fie=/\d\d\d\d\d\d?/,bA=/\d{1,3}/,DH=/\d{1,4}/,wA=/[+-]?\d{1,6}/,nb=/\d+/,SA=/[+-]?\d+/,vPe=/Z|[+-]\d\d:?\d\d/gi,xA=/Z|[+-]\d\d(?::?\d\d)?/gi,_Pe=/[+-]?\d+(\.\d{1,3})?/,sC=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,pk;pk={};function vr(e,t,r){pk[e]=du(t)?t:function(n,i){return n&&r?r:t}}function bPe(e,t){return Bn(pk,e)?pk[e](t._strict,t._locale):new RegExp(wPe(e))}function wPe(e){return ns(e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(t,r,n,i,o){return r||n||i||o}))}function ns(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}var pN={};function ii(e,t){var r,n=t,i;for(typeof e=="string"&&(e=[e]),Pc(t)&&(n=function(o,s){s[t]=Sn(o)}),i=e.length,r=0;r<i;r++)pN[e[r]]=n}function lC(e,t){ii(e,function(r,n,i,o){i._w=i._w||{},t(r,i._w,i,o)})}function SPe(e,t,r){t!=null&&Bn(pN,e)&&pN[e](t,r._a,r,e)}var Qo=0,qu=1,tu=2,yo=3,hl=4,Xu=5,Ud=6,xPe=7,CPe=8;function EPe(e,t){return(e%t+t)%t}var Ki;Array.prototype.indexOf?Ki=Array.prototype.indexOf:Ki=function(e){var t;for(t=0;t<this.length;++t)if(this[t]===e)return t;return-1};function CA(e,t){if(isNaN(e)||isNaN(t))return NaN;var r=EPe(t,12);return e+=(t-r)/12,r===1?vA(e)?29:28:31-r%7%2}Mr("M",["MM",2],"Mo",function(){return this.month()+1});Mr("MMM",0,0,function(e){return this.localeData().monthsShort(this,e)});Mr("MMMM",0,0,function(e){return this.localeData().months(this,e)});ta("month","M");ra("month",8);vr("M",_i);vr("MM",_i,fs);vr("MMM",function(e,t){return t.monthsShortRegex(e)});vr("MMMM",function(e,t){return t.monthsRegex(e)});ii(["M","MM"],function(e,t){t[qu]=Sn(e)-1});ii(["MMM","MMMM"],function(e,t,r,n){var i=r._locale.monthsParse(e,n,r._strict);i!=null?t[qu]=i:cn(r).invalidMonth=e});var TPe="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),Hie="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),Vie=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,OPe=sC,RPe=sC;function kPe(e,t){return e?yl(this._months)?this._months[e.month()]:this._months[(this._months.isFormat||Vie).test(t)?"format":"standalone"][e.month()]:yl(this._months)?this._months:this._months.standalone}function PPe(e,t){return e?yl(this._monthsShort)?this._monthsShort[e.month()]:this._monthsShort[Vie.test(t)?"format":"standalone"][e.month()]:yl(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function APe(e,t,r){var n,i,o,s=e.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],n=0;n<12;++n)o=hu([2e3,n]),this._shortMonthsParse[n]=this.monthsShort(o,"").toLocaleLowerCase(),this._longMonthsParse[n]=this.months(o,"").toLocaleLowerCase();return r?t==="MMM"?(i=Ki.call(this._shortMonthsParse,s),i!==-1?i:null):(i=Ki.call(this._longMonthsParse,s),i!==-1?i:null):t==="MMM"?(i=Ki.call(this._shortMonthsParse,s),i!==-1?i:(i=Ki.call(this._longMonthsParse,s),i!==-1?i:null)):(i=Ki.call(this._longMonthsParse,s),i!==-1?i:(i=Ki.call(this._shortMonthsParse,s),i!==-1?i:null))}function IPe(e,t,r){var n,i,o;if(this._monthsParseExact)return APe.call(this,e,t,r);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),n=0;n<12;n++){if(i=hu([2e3,n]),r&&!this._longMonthsParse[n]&&(this._longMonthsParse[n]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i"),this._shortMonthsParse[n]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")),!r&&!this._monthsParse[n]&&(o="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[n]=new RegExp(o.replace(".",""),"i")),r&&t==="MMMM"&&this._longMonthsParse[n].test(e))return n;if(r&&t==="MMM"&&this._shortMonthsParse[n].test(e))return n;if(!r&&this._monthsParse[n].test(e))return n}}function Uie(e,t){var r;if(!e.isValid())return e;if(typeof t=="string"){if(/^\d+$/.test(t))t=Sn(t);else if(t=e.localeData().monthsParse(t),!Pc(t))return e}return r=Math.min(e.date(),CA(e.year(),t)),e._d["set"+(e._isUTC?"UTC":"")+"Month"](t,r),e}function Wie(e){return e!=null?(Uie(this,e),Vt.updateOffset(this,!0),this):dk(this,"Month")}function MPe(){return CA(this.year(),this.month())}function DPe(e){return this._monthsParseExact?(Bn(this,"_monthsRegex")||Gie.call(this),e?this._monthsShortStrictRegex:this._monthsShortRegex):(Bn(this,"_monthsShortRegex")||(this._monthsShortRegex=OPe),this._monthsShortStrictRegex&&e?this._monthsShortStrictRegex:this._monthsShortRegex)}function $Pe(e){return this._monthsParseExact?(Bn(this,"_monthsRegex")||Gie.call(this),e?this._monthsStrictRegex:this._monthsRegex):(Bn(this,"_monthsRegex")||(this._monthsRegex=RPe),this._monthsStrictRegex&&e?this._monthsStrictRegex:this._monthsRegex)}function Gie(){function e(s,a){return a.length-s.length}var t=[],r=[],n=[],i,o;for(i=0;i<12;i++)o=hu([2e3,i]),t.push(this.monthsShort(o,"")),r.push(this.months(o,"")),n.push(this.months(o,"")),n.push(this.monthsShort(o,""));for(t.sort(e),r.sort(e),n.sort(e),i=0;i<12;i++)t[i]=ns(t[i]),r[i]=ns(r[i]);for(i=0;i<24;i++)n[i]=ns(n[i]);this._monthsRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+t.join("|")+")","i")}Mr("Y",0,0,function(){var e=this.year();return e<=9999?su(e,4):"+"+e});Mr(0,["YY",2],0,function(){return this.year()%100});Mr(0,["YYYY",4],0,"year");Mr(0,["YYYYY",5],0,"year");Mr(0,["YYYYYY",6,!0],0,"year");ta("year","y");ra("year",1);vr("Y",SA);vr("YY",_i,fs);vr("YYYY",DH,MH);vr("YYYYY",wA,_A);vr("YYYYYY",wA,_A);ii(["YYYYY","YYYYYY"],Qo);ii("YYYY",function(e,t){t[Qo]=e.length===2?Vt.parseTwoDigitYear(e):Sn(e)});ii("YY",function(e,t){t[Qo]=Vt.parseTwoDigitYear(e)});ii("Y",function(e,t){t[Qo]=parseInt(e,10)});function j0(e){return vA(e)?366:365}Vt.parseTwoDigitYear=function(e){return Sn(e)+(Sn(e)>68?1900:2e3)};var Yie=rb("FullYear",!0);function LPe(){return vA(this.year())}function NPe(e,t,r,n,i,o,s){var a;return e<100&&e>=0?(a=new Date(e+400,t,r,n,i,o,s),isFinite(a.getFullYear())&&a.setFullYear(e)):a=new Date(e,t,r,n,i,o,s),a}function SS(e){var t,r;return e<100&&e>=0?(r=Array.prototype.slice.call(arguments),r[0]=e+400,t=new Date(Date.UTC.apply(null,r)),isFinite(t.getUTCFullYear())&&t.setUTCFullYear(e)):t=new Date(Date.UTC.apply(null,arguments)),t}function mk(e,t,r){var n=7+t-r,i=(7+SS(e,0,n).getUTCDay()-t)%7;return-i+n-1}function Kie(e,t,r,n,i){var o=(7+r-n)%7,s=mk(e,n,i),a=1+7*(t-1)+o+s,h,p;return a<=0?(h=e-1,p=j0(h)+a):a>j0(e)?(h=e+1,p=a-j0(e)):(h=e,p=a),{year:h,dayOfYear:p}}function xS(e,t,r){var n=mk(e.year(),t,r),i=Math.floor((e.dayOfYear()-n-1)/7)+1,o,s;return i<1?(s=e.year()-1,o=i+Sc(s,t,r)):i>Sc(e.year(),t,r)?(o=i-Sc(e.year(),t,r),s=e.year()+1):(s=e.year(),o=i),{week:o,year:s}}function Sc(e,t,r){var n=mk(e,t,r),i=mk(e+1,t,r);return(j0(e)-n+i)/7}Mr("w",["ww",2],"wo","week");Mr("W",["WW",2],"Wo","isoWeek");ta("week","w");ta("isoWeek","W");ra("week",5);ra("isoWeek",5);vr("w",_i);vr("ww",_i,fs);vr("W",_i);vr("WW",_i,fs);lC(["w","ww","W","WW"],function(e,t,r,n){t[n.substr(0,1)]=Sn(e)});function BPe(e){return xS(e,this._week.dow,this._week.doy).week}var jPe={dow:0,doy:6};function zPe(){return this._week.dow}function FPe(){return this._week.doy}function HPe(e){var t=this.localeData().week(this);return e==null?t:this.add((e-t)*7,"d")}function VPe(e){var t=xS(this,1,4).week;return e==null?t:this.add((e-t)*7,"d")}Mr("d",0,"do","day");Mr("dd",0,0,function(e){return this.localeData().weekdaysMin(this,e)});Mr("ddd",0,0,function(e){return this.localeData().weekdaysShort(this,e)});Mr("dddd",0,0,function(e){return this.localeData().weekdays(this,e)});Mr("e",0,0,"weekday");Mr("E",0,0,"isoWeekday");ta("day","d");ta("weekday","e");ta("isoWeekday","E");ra("day",11);ra("weekday",11);ra("isoWeekday",11);vr("d",_i);vr("e",_i);vr("E",_i);vr("dd",function(e,t){return t.weekdaysMinRegex(e)});vr("ddd",function(e,t){return t.weekdaysShortRegex(e)});vr("dddd",function(e,t){return t.weekdaysRegex(e)});lC(["dd","ddd","dddd"],function(e,t,r,n){var i=r._locale.weekdaysParse(e,n,r._strict);i!=null?t.d=i:cn(r).invalidWeekday=e});lC(["d","e","E"],function(e,t,r,n){t[n]=Sn(e)});function UPe(e,t){return typeof e!="string"?e:isNaN(e)?(e=t.weekdaysParse(e),typeof e=="number"?e:null):parseInt(e,10)}function WPe(e,t){return typeof e=="string"?t.weekdaysParse(e)%7||7:isNaN(e)?null:e}function $H(e,t){return e.slice(t,7).concat(e.slice(0,t))}var GPe="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),qie="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),YPe="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),KPe=sC,qPe=sC,XPe=sC;function ZPe(e,t){var r=yl(this._weekdays)?this._weekdays:this._weekdays[e&&e!==!0&&this._weekdays.isFormat.test(t)?"format":"standalone"];return e===!0?$H(r,this._week.dow):e?r[e.day()]:r}function JPe(e){return e===!0?$H(this._weekdaysShort,this._week.dow):e?this._weekdaysShort[e.day()]:this._weekdaysShort}function QPe(e){return e===!0?$H(this._weekdaysMin,this._week.dow):e?this._weekdaysMin[e.day()]:this._weekdaysMin}function eAe(e,t,r){var n,i,o,s=e.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],n=0;n<7;++n)o=hu([2e3,1]).day(n),this._minWeekdaysParse[n]=this.weekdaysMin(o,"").toLocaleLowerCase(),this._shortWeekdaysParse[n]=this.weekdaysShort(o,"").toLocaleLowerCase(),this._weekdaysParse[n]=this.weekdays(o,"").toLocaleLowerCase();return r?t==="dddd"?(i=Ki.call(this._weekdaysParse,s),i!==-1?i:null):t==="ddd"?(i=Ki.call(this._shortWeekdaysParse,s),i!==-1?i:null):(i=Ki.call(this._minWeekdaysParse,s),i!==-1?i:null):t==="dddd"?(i=Ki.call(this._weekdaysParse,s),i!==-1||(i=Ki.call(this._shortWeekdaysParse,s),i!==-1)?i:(i=Ki.call(this._minWeekdaysParse,s),i!==-1?i:null)):t==="ddd"?(i=Ki.call(this._shortWeekdaysParse,s),i!==-1||(i=Ki.call(this._weekdaysParse,s),i!==-1)?i:(i=Ki.call(this._minWeekdaysParse,s),i!==-1?i:null)):(i=Ki.call(this._minWeekdaysParse,s),i!==-1||(i=Ki.call(this._weekdaysParse,s),i!==-1)?i:(i=Ki.call(this._shortWeekdaysParse,s),i!==-1?i:null))}function tAe(e,t,r){var n,i,o;if(this._weekdaysParseExact)return eAe.call(this,e,t,r);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),n=0;n<7;n++){if(i=hu([2e3,1]).day(n),r&&!this._fullWeekdaysParse[n]&&(this._fullWeekdaysParse[n]=new RegExp("^"+this.weekdays(i,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[n]=new RegExp("^"+this.weekdaysShort(i,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[n]=new RegExp("^"+this.weekdaysMin(i,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[n]||(o="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[n]=new RegExp(o.replace(".",""),"i")),r&&t==="dddd"&&this._fullWeekdaysParse[n].test(e))return n;if(r&&t==="ddd"&&this._shortWeekdaysParse[n].test(e))return n;if(r&&t==="dd"&&this._minWeekdaysParse[n].test(e))return n;if(!r&&this._weekdaysParse[n].test(e))return n}}function rAe(e){if(!this.isValid())return e!=null?this:NaN;var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return e!=null?(e=UPe(e,this.localeData()),this.add(e-t,"d")):t}function nAe(e){if(!this.isValid())return e!=null?this:NaN;var t=(this.day()+7-this.localeData()._week.dow)%7;return e==null?t:this.add(e-t,"d")}function iAe(e){if(!this.isValid())return e!=null?this:NaN;if(e!=null){var t=WPe(e,this.localeData());return this.day(this.day()%7?t:t-7)}else return this.day()||7}function oAe(e){return this._weekdaysParseExact?(Bn(this,"_weekdaysRegex")||LH.call(this),e?this._weekdaysStrictRegex:this._weekdaysRegex):(Bn(this,"_weekdaysRegex")||(this._weekdaysRegex=KPe),this._weekdaysStrictRegex&&e?this._weekdaysStrictRegex:this._weekdaysRegex)}function aAe(e){return this._weekdaysParseExact?(Bn(this,"_weekdaysRegex")||LH.call(this),e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(Bn(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=qPe),this._weekdaysShortStrictRegex&&e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function sAe(e){return this._weekdaysParseExact?(Bn(this,"_weekdaysRegex")||LH.call(this),e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(Bn(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=XPe),this._weekdaysMinStrictRegex&&e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function LH(){function e(g,S){return S.length-g.length}var t=[],r=[],n=[],i=[],o,s,a,h,p;for(o=0;o<7;o++)s=hu([2e3,1]).day(o),a=ns(this.weekdaysMin(s,"")),h=ns(this.weekdaysShort(s,"")),p=ns(this.weekdays(s,"")),t.push(a),r.push(h),n.push(p),i.push(a),i.push(h),i.push(p);t.sort(e),r.sort(e),n.sort(e),i.sort(e),this._weekdaysRegex=new RegExp("^("+i.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+t.join("|")+")","i")}function NH(){return this.hours()%12||12}function lAe(){return this.hours()||24}Mr("H",["HH",2],0,"hour");Mr("h",["hh",2],0,NH);Mr("k",["kk",2],0,lAe);Mr("hmm",0,0,function(){return""+NH.apply(this)+su(this.minutes(),2)});Mr("hmmss",0,0,function(){return""+NH.apply(this)+su(this.minutes(),2)+su(this.seconds(),2)});Mr("Hmm",0,0,function(){return""+this.hours()+su(this.minutes(),2)});Mr("Hmmss",0,0,function(){return""+this.hours()+su(this.minutes(),2)+su(this.seconds(),2)});function Xie(e,t){Mr(e,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)})}Xie("a",!0);Xie("A",!1);ta("hour","h");ra("hour",13);function Zie(e,t){return t._meridiemParse}vr("a",Zie);vr("A",Zie);vr("H",_i);vr("h",_i);vr("k",_i);vr("HH",_i,fs);vr("hh",_i,fs);vr("kk",_i,fs);vr("hmm",zie);vr("hmmss",Fie);vr("Hmm",zie);vr("Hmmss",Fie);ii(["H","HH"],yo);ii(["k","kk"],function(e,t,r){var n=Sn(e);t[yo]=n===24?0:n});ii(["a","A"],function(e,t,r){r._isPm=r._locale.isPM(e),r._meridiem=e});ii(["h","hh"],function(e,t,r){t[yo]=Sn(e),cn(r).bigHour=!0});ii("hmm",function(e,t,r){var n=e.length-2;t[yo]=Sn(e.substr(0,n)),t[hl]=Sn(e.substr(n)),cn(r).bigHour=!0});ii("hmmss",function(e,t,r){var n=e.length-4,i=e.length-2;t[yo]=Sn(e.substr(0,n)),t[hl]=Sn(e.substr(n,2)),t[Xu]=Sn(e.substr(i)),cn(r).bigHour=!0});ii("Hmm",function(e,t,r){var n=e.length-2;t[yo]=Sn(e.substr(0,n)),t[hl]=Sn(e.substr(n))});ii("Hmmss",function(e,t,r){var n=e.length-4,i=e.length-2;t[yo]=Sn(e.substr(0,n)),t[hl]=Sn(e.substr(n,2)),t[Xu]=Sn(e.substr(i))});function uAe(e){return(e+"").toLowerCase().charAt(0)==="p"}var cAe=/[ap]\.?m?\.?/i,fAe=rb("Hours",!0);function hAe(e,t,r){return e>11?r?"pm":"PM":r?"am":"AM"}var Jie={calendar:tPe,longDateFormat:oPe,invalidDate:sPe,ordinal:uPe,dayOfMonthOrdinalParse:cPe,relativeTime:hPe,months:TPe,monthsShort:Hie,week:jPe,weekdays:GPe,weekdaysMin:YPe,weekdaysShort:qie,meridiemParse:cAe},Ci={},Uw={},CS;function dAe(e,t){var r,n=Math.min(e.length,t.length);for(r=0;r<n;r+=1)if(e[r]!==t[r])return r;return n}function U8(e){return e&&e.toLowerCase().replace("_","-")}function pAe(e){for(var t=0,r,n,i,o;t<e.length;){for(o=U8(e[t]).split("-"),r=o.length,n=U8(e[t+1]),n=n?n.split("-"):null;r>0;){if(i=EA(o.slice(0,r).join("-")),i)return i;if(n&&n.length>=r&&dAe(o,n)>=r-1)break;r--}t++}return CS}function mAe(e){return e.match("^[^/\\\\]*$")!=null}function EA(e){var t=null,r;if(Ci[e]===void 0&&typeof LR<"u"&&LR&&LR.exports&&mAe(e))try{t=CS._abbr,r=require,r("./locale/"+e),eh(t)}catch{Ci[e]=null}return Ci[e]}function eh(e,t){var r;return e&&(Ia(t)?r=Lc(e):r=BH(e,t),r?CS=r:typeof console<"u"&&console.warn&&console.warn("Locale "+e+" not found. Did you forget to load it?")),CS._abbr}function BH(e,t){if(t!==null){var r,n=Jie;if(t.abbr=e,Ci[e]!=null)Die("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),n=Ci[e]._config;else if(t.parentLocale!=null)if(Ci[t.parentLocale]!=null)n=Ci[t.parentLocale]._config;else if(r=EA(t.parentLocale),r!=null)n=r._config;else return Uw[t.parentLocale]||(Uw[t.parentLocale]=[]),Uw[t.parentLocale].push({name:e,config:t}),null;return Ci[e]=new PH(hN(n,t)),Uw[e]&&Uw[e].forEach(function(i){BH(i.name,i.config)}),eh(e),Ci[e]}else return delete Ci[e],null}function yAe(e,t){if(t!=null){var r,n,i=Jie;Ci[e]!=null&&Ci[e].parentLocale!=null?Ci[e].set(hN(Ci[e]._config,t)):(n=EA(e),n!=null&&(i=n._config),t=hN(i,t),n==null&&(t.abbr=e),r=new PH(t),r.parentLocale=Ci[e],Ci[e]=r),eh(e)}else Ci[e]!=null&&(Ci[e].parentLocale!=null?(Ci[e]=Ci[e].parentLocale,e===eh()&&eh(e)):Ci[e]!=null&&delete Ci[e]);return Ci[e]}function Lc(e){var t;if(e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr),!e)return CS;if(!yl(e)){if(t=EA(e),t)return t;e=[e]}return pAe(e)}function gAe(){return dN(Ci)}function jH(e){var t,r=e._a;return r&&cn(e).overflow===-2&&(t=r[qu]<0||r[qu]>11?qu:r[tu]<1||r[tu]>CA(r[Qo],r[qu])?tu:r[yo]<0||r[yo]>24||r[yo]===24&&(r[hl]!==0||r[Xu]!==0||r[Ud]!==0)?yo:r[hl]<0||r[hl]>59?hl:r[Xu]<0||r[Xu]>59?Xu:r[Ud]<0||r[Ud]>999?Ud:-1,cn(e)._overflowDayOfYear&&(t<Qo||t>tu)&&(t=tu),cn(e)._overflowWeeks&&t===-1&&(t=xPe),cn(e)._overflowWeekday&&t===-1&&(t=CPe),cn(e).overflow=t),e}var vAe=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,_Ae=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,bAe=/Z|[+-]\d\d(?::?\d\d)?/,KT=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],JD=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],wAe=/^\/?Date\((-?\d+)/i,SAe=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,xAe={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function Qie(e){var t,r,n=e._i,i=vAe.exec(n)||_Ae.exec(n),o,s,a,h,p=KT.length,g=JD.length;if(i){for(cn(e).iso=!0,t=0,r=p;t<r;t++)if(KT[t][1].exec(i[1])){s=KT[t][0],o=KT[t][2]!==!1;break}if(s==null){e._isValid=!1;return}if(i[3]){for(t=0,r=g;t<r;t++)if(JD[t][1].exec(i[3])){a=(i[2]||" ")+JD[t][0];break}if(a==null){e._isValid=!1;return}}if(!o&&a!=null){e._isValid=!1;return}if(i[4])if(bAe.exec(i[4]))h="Z";else{e._isValid=!1;return}e._f=s+(a||"")+(h||""),FH(e)}else e._isValid=!1}function CAe(e,t,r,n,i,o){var s=[EAe(e),Hie.indexOf(t),parseInt(r,10),parseInt(n,10),parseInt(i,10)];return o&&s.push(parseInt(o,10)),s}function EAe(e){var t=parseInt(e,10);return t<=49?2e3+t:t<=999?1900+t:t}function TAe(e){return e.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function OAe(e,t,r){if(e){var n=qie.indexOf(e),i=new Date(t[0],t[1],t[2]).getDay();if(n!==i)return cn(r).weekdayMismatch=!0,r._isValid=!1,!1}return!0}function RAe(e,t,r){if(e)return xAe[e];if(t)return 0;var n=parseInt(r,10),i=n%100,o=(n-i)/100;return o*60+i}function eoe(e){var t=SAe.exec(TAe(e._i)),r;if(t){if(r=CAe(t[4],t[3],t[2],t[5],t[6],t[7]),!OAe(t[1],r,e))return;e._a=r,e._tzm=RAe(t[8],t[9],t[10]),e._d=SS.apply(null,e._a),e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),cn(e).rfc2822=!0}else e._isValid=!1}function kAe(e){var t=wAe.exec(e._i);if(t!==null){e._d=new Date(+t[1]);return}if(Qie(e),e._isValid===!1)delete e._isValid;else return;if(eoe(e),e._isValid===!1)delete e._isValid;else return;e._strict?e._isValid=!1:Vt.createFromInputFallback(e)}Vt.createFromInputFallback=js("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))});function Vy(e,t,r){return e??t??r}function PAe(e){var t=new Date(Vt.now());return e._useUTC?[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()]:[t.getFullYear(),t.getMonth(),t.getDate()]}function zH(e){var t,r,n=[],i,o,s;if(!e._d){for(i=PAe(e),e._w&&e._a[tu]==null&&e._a[qu]==null&&AAe(e),e._dayOfYear!=null&&(s=Vy(e._a[Qo],i[Qo]),(e._dayOfYear>j0(s)||e._dayOfYear===0)&&(cn(e)._overflowDayOfYear=!0),r=SS(s,0,e._dayOfYear),e._a[qu]=r.getUTCMonth(),e._a[tu]=r.getUTCDate()),t=0;t<3&&e._a[t]==null;++t)e._a[t]=n[t]=i[t];for(;t<7;t++)e._a[t]=n[t]=e._a[t]==null?t===2?1:0:e._a[t];e._a[yo]===24&&e._a[hl]===0&&e._a[Xu]===0&&e._a[Ud]===0&&(e._nextDay=!0,e._a[yo]=0),e._d=(e._useUTC?SS:NPe).apply(null,n),o=e._useUTC?e._d.getUTCDay():e._d.getDay(),e._tzm!=null&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),e._nextDay&&(e._a[yo]=24),e._w&&typeof e._w.d<"u"&&e._w.d!==o&&(cn(e).weekdayMismatch=!0)}}function AAe(e){var t,r,n,i,o,s,a,h,p;t=e._w,t.GG!=null||t.W!=null||t.E!=null?(o=1,s=4,r=Vy(t.GG,e._a[Qo],xS(gi(),1,4).year),n=Vy(t.W,1),i=Vy(t.E,1),(i<1||i>7)&&(h=!0)):(o=e._locale._week.dow,s=e._locale._week.doy,p=xS(gi(),o,s),r=Vy(t.gg,e._a[Qo],p.year),n=Vy(t.w,p.week),t.d!=null?(i=t.d,(i<0||i>6)&&(h=!0)):t.e!=null?(i=t.e+o,(t.e<0||t.e>6)&&(h=!0)):i=o),n<1||n>Sc(r,o,s)?cn(e)._overflowWeeks=!0:h!=null?cn(e)._overflowWeekday=!0:(a=Kie(r,n,i,o,s),e._a[Qo]=a.year,e._dayOfYear=a.dayOfYear)}Vt.ISO_8601=function(){};Vt.RFC_2822=function(){};function FH(e){if(e._f===Vt.ISO_8601){Qie(e);return}if(e._f===Vt.RFC_2822){eoe(e);return}e._a=[],cn(e).empty=!0;var t=""+e._i,r,n,i,o,s,a=t.length,h=0,p,g;for(i=$ie(e._f,e._locale).match(AH)||[],g=i.length,r=0;r<g;r++)o=i[r],n=(t.match(bPe(o,e))||[])[0],n&&(s=t.substr(0,t.indexOf(n)),s.length>0&&cn(e).unusedInput.push(s),t=t.slice(t.indexOf(n)+n.length),h+=n.length),gg[o]?(n?cn(e).empty=!1:cn(e).unusedTokens.push(o),SPe(o,n,e)):e._strict&&!n&&cn(e).unusedTokens.push(o);cn(e).charsLeftOver=a-h,t.length>0&&cn(e).unusedInput.push(t),e._a[yo]<=12&&cn(e).bigHour===!0&&e._a[yo]>0&&(cn(e).bigHour=void 0),cn(e).parsedDateParts=e._a.slice(0),cn(e).meridiem=e._meridiem,e._a[yo]=IAe(e._locale,e._a[yo],e._meridiem),p=cn(e).era,p!==null&&(e._a[Qo]=e._locale.erasConvertYear(p,e._a[Qo])),zH(e),jH(e)}function IAe(e,t,r){var n;return r==null?t:e.meridiemHour!=null?e.meridiemHour(t,r):(e.isPM!=null&&(n=e.isPM(r),n&&t<12&&(t+=12),!n&&t===12&&(t=0)),t)}function MAe(e){var t,r,n,i,o,s,a=!1,h=e._f.length;if(h===0){cn(e).invalidFormat=!0,e._d=new Date(NaN);return}for(i=0;i<h;i++)o=0,s=!1,t=kH({},e),e._useUTC!=null&&(t._useUTC=e._useUTC),t._f=e._f[i],FH(t),RH(t)&&(s=!0),o+=cn(t).charsLeftOver,o+=cn(t).unusedTokens.length*10,cn(t).score=o,a?o<n&&(n=o,r=t):(n==null||o<n||s)&&(n=o,r=t,s&&(a=!0));Ff(e,r||t)}function DAe(e){if(!e._d){var t=IH(e._i),r=t.day===void 0?t.date:t.day;e._a=Iie([t.year,t.month,r,t.hour,t.minute,t.second,t.millisecond],function(n){return n&&parseInt(n,10)}),zH(e)}}function $Ae(e){var t=new aC(jH(toe(e)));return t._nextDay&&(t.add(1,"d"),t._nextDay=void 0),t}function toe(e){var t=e._i,r=e._f;return e._locale=e._locale||Lc(e._l),t===null||r===void 0&&t===""?gA({nullInput:!0}):(typeof t=="string"&&(e._i=t=e._locale.preparse(t)),gl(t)?new aC(jH(t)):(oC(t)?e._d=t:yl(r)?MAe(e):r?FH(e):LAe(e),RH(e)||(e._d=null),e))}function LAe(e){var t=e._i;Ia(t)?e._d=new Date(Vt.now()):oC(t)?e._d=new Date(t.valueOf()):typeof t=="string"?kAe(e):yl(t)?(e._a=Iie(t.slice(0),function(r){return parseInt(r,10)}),zH(e)):bp(t)?DAe(e):Pc(t)?e._d=new Date(t):Vt.createFromInputFallback(e)}function roe(e,t,r,n,i){var o={};return(t===!0||t===!1)&&(n=t,t=void 0),(r===!0||r===!1)&&(n=r,r=void 0),(bp(e)&&OH(e)||yl(e)&&e.length===0)&&(e=void 0),o._isAMomentObject=!0,o._useUTC=o._isUTC=i,o._l=r,o._i=e,o._f=t,o._strict=n,$Ae(o)}function gi(e,t,r,n){return roe(e,t,r,n,!1)}var NAe=js("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=gi.apply(null,arguments);return this.isValid()&&e.isValid()?e<this?this:e:gA()}),BAe=js("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=gi.apply(null,arguments);return this.isValid()&&e.isValid()?e>this?this:e:gA()});function noe(e,t){var r,n;if(t.length===1&&yl(t[0])&&(t=t[0]),!t.length)return gi();for(r=t[0],n=1;n<t.length;++n)(!t[n].isValid()||t[n][e](r))&&(r=t[n]);return r}function jAe(){var e=[].slice.call(arguments,0);return noe("isBefore",e)}function zAe(){var e=[].slice.call(arguments,0);return noe("isAfter",e)}var FAe=function(){return Date.now?Date.now():+new Date},Ww=["year","quarter","month","week","day","hour","minute","second","millisecond"];function HAe(e){var t,r=!1,n,i=Ww.length;for(t in e)if(Bn(e,t)&&!(Ki.call(Ww,t)!==-1&&(e[t]==null||!isNaN(e[t]))))return!1;for(n=0;n<i;++n)if(e[Ww[n]]){if(r)return!1;parseFloat(e[Ww[n]])!==Sn(e[Ww[n]])&&(r=!0)}return!0}function VAe(){return this._isValid}function UAe(){return bl(NaN)}function TA(e){var t=IH(e),r=t.year||0,n=t.quarter||0,i=t.month||0,o=t.week||t.isoWeek||0,s=t.day||0,a=t.hour||0,h=t.minute||0,p=t.second||0,g=t.millisecond||0;this._isValid=HAe(t),this._milliseconds=+g+p*1e3+h*6e4+a*1e3*60*60,this._days=+s+o*7,this._months=+i+n*3+r*12,this._data={},this._locale=Lc(),this._bubble()}function rR(e){return e instanceof TA}function mN(e){return e<0?Math.round(-1*e)*-1:Math.round(e)}function WAe(e,t,r){var n=Math.min(e.length,t.length),i=Math.abs(e.length-t.length),o=0,s;for(s=0;s<n;s++)(r&&e[s]!==t[s]||!r&&Sn(e[s])!==Sn(t[s]))&&o++;return o+i}function ioe(e,t){Mr(e,0,0,function(){var r=this.utcOffset(),n="+";return r<0&&(r=-r,n="-"),n+su(~~(r/60),2)+t+su(~~r%60,2)})}ioe("Z",":");ioe("ZZ","");vr("Z",xA);vr("ZZ",xA);ii(["Z","ZZ"],function(e,t,r){r._useUTC=!0,r._tzm=HH(xA,e)});var GAe=/([\+\-]|\d\d)/gi;function HH(e,t){var r=(t||"").match(e),n,i,o;return r===null?null:(n=r[r.length-1]||[],i=(n+"").match(GAe)||["-",0,0],o=+(i[1]*60)+Sn(i[2]),o===0?0:i[0]==="+"?o:-o)}function VH(e,t){var r,n;return t._isUTC?(r=t.clone(),n=(gl(e)||oC(e)?e.valueOf():gi(e).valueOf())-r.valueOf(),r._d.setTime(r._d.valueOf()+n),Vt.updateOffset(r,!1),r):gi(e).local()}function yN(e){return-Math.round(e._d.getTimezoneOffset())}Vt.updateOffset=function(){};function YAe(e,t,r){var n=this._offset||0,i;if(!this.isValid())return e!=null?this:NaN;if(e!=null){if(typeof e=="string"){if(e=HH(xA,e),e===null)return this}else Math.abs(e)<16&&!r&&(e=e*60);return!this._isUTC&&t&&(i=yN(this)),this._offset=e,this._isUTC=!0,i!=null&&this.add(i,"m"),n!==e&&(!t||this._changeInProgress?soe(this,bl(e-n,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,Vt.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?n:yN(this)}function KAe(e,t){return e!=null?(typeof e!="string"&&(e=-e),this.utcOffset(e,t),this):-this.utcOffset()}function qAe(e){return this.utcOffset(0,e)}function XAe(e){return this._isUTC&&(this.utcOffset(0,e),this._isUTC=!1,e&&this.subtract(yN(this),"m")),this}function ZAe(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var e=HH(vPe,this._i);e!=null?this.utcOffset(e):this.utcOffset(0,!0)}return this}function JAe(e){return this.isValid()?(e=e?gi(e).utcOffset():0,(this.utcOffset()-e)%60===0):!1}function QAe(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function eIe(){if(!Ia(this._isDSTShifted))return this._isDSTShifted;var e={},t;return kH(e,this),e=toe(e),e._a?(t=e._isUTC?hu(e._a):gi(e._a),this._isDSTShifted=this.isValid()&&WAe(e._a,t.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function tIe(){return this.isValid()?!this._isUTC:!1}function rIe(){return this.isValid()?this._isUTC:!1}function ooe(){return this.isValid()?this._isUTC&&this._offset===0:!1}var nIe=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,iIe=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function bl(e,t){var r=e,n=null,i,o,s;return rR(e)?r={ms:e._milliseconds,d:e._days,M:e._months}:Pc(e)||!isNaN(+e)?(r={},t?r[t]=+e:r.milliseconds=+e):(n=nIe.exec(e))?(i=n[1]==="-"?-1:1,r={y:0,d:Sn(n[tu])*i,h:Sn(n[yo])*i,m:Sn(n[hl])*i,s:Sn(n[Xu])*i,ms:Sn(mN(n[Ud]*1e3))*i}):(n=iIe.exec(e))?(i=n[1]==="-"?-1:1,r={y:gd(n[2],i),M:gd(n[3],i),w:gd(n[4],i),d:gd(n[5],i),h:gd(n[6],i),m:gd(n[7],i),s:gd(n[8],i)}):r==null?r={}:typeof r=="object"&&("from"in r||"to"in r)&&(s=oIe(gi(r.from),gi(r.to)),r={},r.ms=s.milliseconds,r.M=s.months),o=new TA(r),rR(e)&&Bn(e,"_locale")&&(o._locale=e._locale),rR(e)&&Bn(e,"_isValid")&&(o._isValid=e._isValid),o}bl.fn=TA.prototype;bl.invalid=UAe;function gd(e,t){var r=e&&parseFloat(e.replace(",","."));return(isNaN(r)?0:r)*t}function W8(e,t){var r={};return r.months=t.month()-e.month()+(t.year()-e.year())*12,e.clone().add(r.months,"M").isAfter(t)&&--r.months,r.milliseconds=+t-+e.clone().add(r.months,"M"),r}function oIe(e,t){var r;return e.isValid()&&t.isValid()?(t=VH(t,e),e.isBefore(t)?r=W8(e,t):(r=W8(t,e),r.milliseconds=-r.milliseconds,r.months=-r.months),r):{milliseconds:0,months:0}}function aoe(e,t){return function(r,n){var i,o;return n!==null&&!isNaN(+n)&&(Die(t,"moment()."+t+"(period, number) is deprecated. Please use moment()."+t+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),o=r,r=n,n=o),i=bl(r,n),soe(this,i,e),this}}function soe(e,t,r,n){var i=t._milliseconds,o=mN(t._days),s=mN(t._months);e.isValid()&&(n=n??!0,s&&Uie(e,dk(e,"Month")+s*r),o&&Nie(e,"Date",dk(e,"Date")+o*r),i&&e._d.setTime(e._d.valueOf()+i*r),n&&Vt.updateOffset(e,o||s))}var aIe=aoe(1,"add"),sIe=aoe(-1,"subtract");function loe(e){return typeof e=="string"||e instanceof String}function lIe(e){return gl(e)||oC(e)||loe(e)||Pc(e)||cIe(e)||uIe(e)||e===null||e===void 0}function uIe(e){var t=bp(e)&&!OH(e),r=!1,n=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],i,o,s=n.length;for(i=0;i<s;i+=1)o=n[i],r=r||Bn(e,o);return t&&r}function cIe(e){var t=yl(e),r=!1;return t&&(r=e.filter(function(n){return!Pc(n)&&loe(e)}).length===0),t&&r}function fIe(e){var t=bp(e)&&!OH(e),r=!1,n=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],i,o;for(i=0;i<n.length;i+=1)o=n[i],r=r||Bn(e,o);return t&&r}function hIe(e,t){var r=e.diff(t,"days",!0);return r<-6?"sameElse":r<-1?"lastWeek":r<0?"lastDay":r<1?"sameDay":r<2?"nextDay":r<7?"nextWeek":"sameElse"}function dIe(e,t){arguments.length===1&&(arguments[0]?lIe(arguments[0])?(e=arguments[0],t=void 0):fIe(arguments[0])&&(t=arguments[0],e=void 0):(e=void 0,t=void 0));var r=e||gi(),n=VH(r,this).startOf("day"),i=Vt.calendarFormat(this,n)||"sameElse",o=t&&(du(t[i])?t[i].call(this,r):t[i]);return this.format(o||this.localeData().calendar(i,this,gi(r)))}function pIe(){return new aC(this)}function mIe(e,t){var r=gl(e)?e:gi(e);return this.isValid()&&r.isValid()?(t=zs(t)||"millisecond",t==="millisecond"?this.valueOf()>r.valueOf():r.valueOf()<this.clone().startOf(t).valueOf()):!1}function yIe(e,t){var r=gl(e)?e:gi(e);return this.isValid()&&r.isValid()?(t=zs(t)||"millisecond",t==="millisecond"?this.valueOf()<r.valueOf():this.clone().endOf(t).valueOf()<r.valueOf()):!1}function gIe(e,t,r,n){var i=gl(e)?e:gi(e),o=gl(t)?t:gi(t);return this.isValid()&&i.isValid()&&o.isValid()?(n=n||"()",(n[0]==="("?this.isAfter(i,r):!this.isBefore(i,r))&&(n[1]===")"?this.isBefore(o,r):!this.isAfter(o,r))):!1}function vIe(e,t){var r=gl(e)?e:gi(e),n;return this.isValid()&&r.isValid()?(t=zs(t)||"millisecond",t==="millisecond"?this.valueOf()===r.valueOf():(n=r.valueOf(),this.clone().startOf(t).valueOf()<=n&&n<=this.clone().endOf(t).valueOf())):!1}function _Ie(e,t){return this.isSame(e,t)||this.isAfter(e,t)}function bIe(e,t){return this.isSame(e,t)||this.isBefore(e,t)}function wIe(e,t,r){var n,i,o;if(!this.isValid())return NaN;if(n=VH(e,this),!n.isValid())return NaN;switch(i=(n.utcOffset()-this.utcOffset())*6e4,t=zs(t),t){case"year":o=nR(this,n)/12;break;case"month":o=nR(this,n);break;case"quarter":o=nR(this,n)/3;break;case"second":o=(this-n)/1e3;break;case"minute":o=(this-n)/6e4;break;case"hour":o=(this-n)/36e5;break;case"day":o=(this-n-i)/864e5;break;case"week":o=(this-n-i)/6048e5;break;default:o=this-n}return r?o:Rs(o)}function nR(e,t){if(e.date()<t.date())return-nR(t,e);var r=(t.year()-e.year())*12+(t.month()-e.month()),n=e.clone().add(r,"months"),i,o;return t-n<0?(i=e.clone().add(r-1,"months"),o=(t-n)/(n-i)):(i=e.clone().add(r+1,"months"),o=(t-n)/(i-n)),-(r+o)||0}Vt.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";Vt.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function SIe(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function xIe(e){if(!this.isValid())return null;var t=e!==!0,r=t?this.clone().utc():this;return r.year()<0||r.year()>9999?tR(r,t?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):du(Date.prototype.toISOString)?t?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",tR(r,"Z")):tR(r,t?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function CIe(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var e="moment",t="",r,n,i,o;return this.isLocal()||(e=this.utcOffset()===0?"moment.utc":"moment.parseZone",t="Z"),r="["+e+'("]',n=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",i="-MM-DD[T]HH:mm:ss.SSS",o=t+'[")]',this.format(r+n+i+o)}function EIe(e){e||(e=this.isUtc()?Vt.defaultFormatUtc:Vt.defaultFormat);var t=tR(this,e);return this.localeData().postformat(t)}function TIe(e,t){return this.isValid()&&(gl(e)&&e.isValid()||gi(e).isValid())?bl({to:this,from:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function OIe(e){return this.from(gi(),e)}function RIe(e,t){return this.isValid()&&(gl(e)&&e.isValid()||gi(e).isValid())?bl({from:this,to:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function kIe(e){return this.to(gi(),e)}function uoe(e){var t;return e===void 0?this._locale._abbr:(t=Lc(e),t!=null&&(this._locale=t),this)}var coe=js("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(e){return e===void 0?this.localeData():this.locale(e)});function foe(){return this._locale}var yk=1e3,vg=60*yk,gk=60*vg,hoe=(365*400+97)*24*gk;function _g(e,t){return(e%t+t)%t}function doe(e,t,r){return e<100&&e>=0?new Date(e+400,t,r)-hoe:new Date(e,t,r).valueOf()}function poe(e,t,r){return e<100&&e>=0?Date.UTC(e+400,t,r)-hoe:Date.UTC(e,t,r)}function PIe(e){var t,r;if(e=zs(e),e===void 0||e==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?poe:doe,e){case"year":t=r(this.year(),0,1);break;case"quarter":t=r(this.year(),this.month()-this.month()%3,1);break;case"month":t=r(this.year(),this.month(),1);break;case"week":t=r(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":t=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":t=r(this.year(),this.month(),this.date());break;case"hour":t=this._d.valueOf(),t-=_g(t+(this._isUTC?0:this.utcOffset()*vg),gk);break;case"minute":t=this._d.valueOf(),t-=_g(t,vg);break;case"second":t=this._d.valueOf(),t-=_g(t,yk);break}return this._d.setTime(t),Vt.updateOffset(this,!0),this}function AIe(e){var t,r;if(e=zs(e),e===void 0||e==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?poe:doe,e){case"year":t=r(this.year()+1,0,1)-1;break;case"quarter":t=r(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":t=r(this.year(),this.month()+1,1)-1;break;case"week":t=r(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":t=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":t=r(this.year(),this.month(),this.date()+1)-1;break;case"hour":t=this._d.valueOf(),t+=gk-_g(t+(this._isUTC?0:this.utcOffset()*vg),gk)-1;break;case"minute":t=this._d.valueOf(),t+=vg-_g(t,vg)-1;break;case"second":t=this._d.valueOf(),t+=yk-_g(t,yk)-1;break}return this._d.setTime(t),Vt.updateOffset(this,!0),this}function IIe(){return this._d.valueOf()-(this._offset||0)*6e4}function MIe(){return Math.floor(this.valueOf()/1e3)}function DIe(){return new Date(this.valueOf())}function $Ie(){var e=this;return[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]}function LIe(){var e=this;return{years:e.year(),months:e.month(),date:e.date(),hours:e.hours(),minutes:e.minutes(),seconds:e.seconds(),milliseconds:e.milliseconds()}}function NIe(){return this.isValid()?this.toISOString():null}function BIe(){return RH(this)}function jIe(){return Ff({},cn(this))}function zIe(){return cn(this).overflow}function FIe(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}Mr("N",0,0,"eraAbbr");Mr("NN",0,0,"eraAbbr");Mr("NNN",0,0,"eraAbbr");Mr("NNNN",0,0,"eraName");Mr("NNNNN",0,0,"eraNarrow");Mr("y",["y",1],"yo","eraYear");Mr("y",["yy",2],0,"eraYear");Mr("y",["yyy",3],0,"eraYear");Mr("y",["yyyy",4],0,"eraYear");vr("N",UH);vr("NN",UH);vr("NNN",UH);vr("NNNN",JIe);vr("NNNNN",QIe);ii(["N","NN","NNN","NNNN","NNNNN"],function(e,t,r,n){var i=r._locale.erasParse(e,n,r._strict);i?cn(r).era=i:cn(r).invalidEra=e});vr("y",nb);vr("yy",nb);vr("yyy",nb);vr("yyyy",nb);vr("yo",eMe);ii(["y","yy","yyy","yyyy"],Qo);ii(["yo"],function(e,t,r,n){var i;r._locale._eraYearOrdinalRegex&&(i=e.match(r._locale._eraYearOrdinalRegex)),r._locale.eraYearOrdinalParse?t[Qo]=r._locale.eraYearOrdinalParse(e,i):t[Qo]=parseInt(e,10)});function HIe(e,t){var r,n,i,o=this._eras||Lc("en")._eras;for(r=0,n=o.length;r<n;++r){switch(typeof o[r].since){case"string":i=Vt(o[r].since).startOf("day"),o[r].since=i.valueOf();break}switch(typeof o[r].until){case"undefined":o[r].until=1/0;break;case"string":i=Vt(o[r].until).startOf("day").valueOf(),o[r].until=i.valueOf();break}}return o}function VIe(e,t,r){var n,i,o=this.eras(),s,a,h;for(e=e.toUpperCase(),n=0,i=o.length;n<i;++n)if(s=o[n].name.toUpperCase(),a=o[n].abbr.toUpperCase(),h=o[n].narrow.toUpperCase(),r)switch(t){case"N":case"NN":case"NNN":if(a===e)return o[n];break;case"NNNN":if(s===e)return o[n];break;case"NNNNN":if(h===e)return o[n];break}else if([s,a,h].indexOf(e)>=0)return o[n]}function UIe(e,t){var r=e.since<=e.until?1:-1;return t===void 0?Vt(e.since).year():Vt(e.since).year()+(t-e.offset)*r}function WIe(){var e,t,r,n=this.localeData().eras();for(e=0,t=n.length;e<t;++e)if(r=this.clone().startOf("day").valueOf(),n[e].since<=r&&r<=n[e].until||n[e].until<=r&&r<=n[e].since)return n[e].name;return""}function GIe(){var e,t,r,n=this.localeData().eras();for(e=0,t=n.length;e<t;++e)if(r=this.clone().startOf("day").valueOf(),n[e].since<=r&&r<=n[e].until||n[e].until<=r&&r<=n[e].since)return n[e].narrow;return""}function YIe(){var e,t,r,n=this.localeData().eras();for(e=0,t=n.length;e<t;++e)if(r=this.clone().startOf("day").valueOf(),n[e].since<=r&&r<=n[e].until||n[e].until<=r&&r<=n[e].since)return n[e].abbr;return""}function KIe(){var e,t,r,n,i=this.localeData().eras();for(e=0,t=i.length;e<t;++e)if(r=i[e].since<=i[e].until?1:-1,n=this.clone().startOf("day").valueOf(),i[e].since<=n&&n<=i[e].until||i[e].until<=n&&n<=i[e].since)return(this.year()-Vt(i[e].since).year())*r+i[e].offset;return this.year()}function qIe(e){return Bn(this,"_erasNameRegex")||WH.call(this),e?this._erasNameRegex:this._erasRegex}function XIe(e){return Bn(this,"_erasAbbrRegex")||WH.call(this),e?this._erasAbbrRegex:this._erasRegex}function ZIe(e){return Bn(this,"_erasNarrowRegex")||WH.call(this),e?this._erasNarrowRegex:this._erasRegex}function UH(e,t){return t.erasAbbrRegex(e)}function JIe(e,t){return t.erasNameRegex(e)}function QIe(e,t){return t.erasNarrowRegex(e)}function eMe(e,t){return t._eraYearOrdinalRegex||nb}function WH(){var e=[],t=[],r=[],n=[],i,o,s=this.eras();for(i=0,o=s.length;i<o;++i)t.push(ns(s[i].name)),e.push(ns(s[i].abbr)),r.push(ns(s[i].narrow)),n.push(ns(s[i].name)),n.push(ns(s[i].abbr)),n.push(ns(s[i].narrow));this._erasRegex=new RegExp("^("+n.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+t.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+e.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+r.join("|")+")","i")}Mr(0,["gg",2],0,function(){return this.weekYear()%100});Mr(0,["GG",2],0,function(){return this.isoWeekYear()%100});function OA(e,t){Mr(0,[e,e.length],0,t)}OA("gggg","weekYear");OA("ggggg","weekYear");OA("GGGG","isoWeekYear");OA("GGGGG","isoWeekYear");ta("weekYear","gg");ta("isoWeekYear","GG");ra("weekYear",1);ra("isoWeekYear",1);vr("G",SA);vr("g",SA);vr("GG",_i,fs);vr("gg",_i,fs);vr("GGGG",DH,MH);vr("gggg",DH,MH);vr("GGGGG",wA,_A);vr("ggggg",wA,_A);lC(["gggg","ggggg","GGGG","GGGGG"],function(e,t,r,n){t[n.substr(0,2)]=Sn(e)});lC(["gg","GG"],function(e,t,r,n){t[n]=Vt.parseTwoDigitYear(e)});function tMe(e){return moe.call(this,e,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function rMe(e){return moe.call(this,e,this.isoWeek(),this.isoWeekday(),1,4)}function nMe(){return Sc(this.year(),1,4)}function iMe(){return Sc(this.isoWeekYear(),1,4)}function oMe(){var e=this.localeData()._week;return Sc(this.year(),e.dow,e.doy)}function aMe(){var e=this.localeData()._week;return Sc(this.weekYear(),e.dow,e.doy)}function moe(e,t,r,n,i){var o;return e==null?xS(this,n,i).year:(o=Sc(e,n,i),t>o&&(t=o),sMe.call(this,e,t,r,n,i))}function sMe(e,t,r,n,i){var o=Kie(e,t,r,n,i),s=SS(o.year,0,o.dayOfYear);return this.year(s.getUTCFullYear()),this.month(s.getUTCMonth()),this.date(s.getUTCDate()),this}Mr("Q",0,"Qo","quarter");ta("quarter","Q");ra("quarter",7);vr("Q",Bie);ii("Q",function(e,t){t[qu]=(Sn(e)-1)*3});function lMe(e){return e==null?Math.ceil((this.month()+1)/3):this.month((e-1)*3+this.month()%3)}Mr("D",["DD",2],"Do","date");ta("date","D");ra("date",9);vr("D",_i);vr("DD",_i,fs);vr("Do",function(e,t){return e?t._dayOfMonthOrdinalParse||t._ordinalParse:t._dayOfMonthOrdinalParseLenient});ii(["D","DD"],tu);ii("Do",function(e,t){t[tu]=Sn(e.match(_i)[0])});var yoe=rb("Date",!0);Mr("DDD",["DDDD",3],"DDDo","dayOfYear");ta("dayOfYear","DDD");ra("dayOfYear",4);vr("DDD",bA);vr("DDDD",jie);ii(["DDD","DDDD"],function(e,t,r){r._dayOfYear=Sn(e)});function uMe(e){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return e==null?t:this.add(e-t,"d")}Mr("m",["mm",2],0,"minute");ta("minute","m");ra("minute",14);vr("m",_i);vr("mm",_i,fs);ii(["m","mm"],hl);var cMe=rb("Minutes",!1);Mr("s",["ss",2],0,"second");ta("second","s");ra("second",15);vr("s",_i);vr("ss",_i,fs);ii(["s","ss"],Xu);var fMe=rb("Seconds",!1);Mr("S",0,0,function(){return~~(this.millisecond()/100)});Mr(0,["SS",2],0,function(){return~~(this.millisecond()/10)});Mr(0,["SSS",3],0,"millisecond");Mr(0,["SSSS",4],0,function(){return this.millisecond()*10});Mr(0,["SSSSS",5],0,function(){return this.millisecond()*100});Mr(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});Mr(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});Mr(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});Mr(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});ta("millisecond","ms");ra("millisecond",16);vr("S",bA,Bie);vr("SS",bA,fs);vr("SSS",bA,jie);var Hf,goe;for(Hf="SSSS";Hf.length<=9;Hf+="S")vr(Hf,nb);function hMe(e,t){t[Ud]=Sn(("0."+e)*1e3)}for(Hf="S";Hf.length<=9;Hf+="S")ii(Hf,hMe);goe=rb("Milliseconds",!1);Mr("z",0,0,"zoneAbbr");Mr("zz",0,0,"zoneName");function dMe(){return this._isUTC?"UTC":""}function pMe(){return this._isUTC?"Coordinated Universal Time":""}var qt=aC.prototype;qt.add=aIe;qt.calendar=dIe;qt.clone=pIe;qt.diff=wIe;qt.endOf=AIe;qt.format=EIe;qt.from=TIe;qt.fromNow=OIe;qt.to=RIe;qt.toNow=kIe;qt.get=yPe;qt.invalidAt=zIe;qt.isAfter=mIe;qt.isBefore=yIe;qt.isBetween=gIe;qt.isSame=vIe;qt.isSameOrAfter=_Ie;qt.isSameOrBefore=bIe;qt.isValid=BIe;qt.lang=coe;qt.locale=uoe;qt.localeData=foe;qt.max=BAe;qt.min=NAe;qt.parsingFlags=jIe;qt.set=gPe;qt.startOf=PIe;qt.subtract=sIe;qt.toArray=$Ie;qt.toObject=LIe;qt.toDate=DIe;qt.toISOString=xIe;qt.inspect=CIe;typeof Symbol<"u"&&Symbol.for!=null&&(qt[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});qt.toJSON=NIe;qt.toString=SIe;qt.unix=MIe;qt.valueOf=IIe;qt.creationData=FIe;qt.eraName=WIe;qt.eraNarrow=GIe;qt.eraAbbr=YIe;qt.eraYear=KIe;qt.year=Yie;qt.isLeapYear=LPe;qt.weekYear=tMe;qt.isoWeekYear=rMe;qt.quarter=qt.quarters=lMe;qt.month=Wie;qt.daysInMonth=MPe;qt.week=qt.weeks=HPe;qt.isoWeek=qt.isoWeeks=VPe;qt.weeksInYear=oMe;qt.weeksInWeekYear=aMe;qt.isoWeeksInYear=nMe;qt.isoWeeksInISOWeekYear=iMe;qt.date=yoe;qt.day=qt.days=rAe;qt.weekday=nAe;qt.isoWeekday=iAe;qt.dayOfYear=uMe;qt.hour=qt.hours=fAe;qt.minute=qt.minutes=cMe;qt.second=qt.seconds=fMe;qt.millisecond=qt.milliseconds=goe;qt.utcOffset=YAe;qt.utc=qAe;qt.local=XAe;qt.parseZone=ZAe;qt.hasAlignedHourOffset=JAe;qt.isDST=QAe;qt.isLocal=tIe;qt.isUtcOffset=rIe;qt.isUtc=ooe;qt.isUTC=ooe;qt.zoneAbbr=dMe;qt.zoneName=pMe;qt.dates=js("dates accessor is deprecated. Use date instead.",yoe);qt.months=js("months accessor is deprecated. Use month instead",Wie);qt.years=js("years accessor is deprecated. Use year instead",Yie);qt.zone=js("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",KAe);qt.isDSTShifted=js("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",eIe);function mMe(e){return gi(e*1e3)}function yMe(){return gi.apply(null,arguments).parseZone()}function voe(e){return e}var jn=PH.prototype;jn.calendar=rPe;jn.longDateFormat=aPe;jn.invalidDate=lPe;jn.ordinal=fPe;jn.preparse=voe;jn.postformat=voe;jn.relativeTime=dPe;jn.pastFuture=pPe;jn.set=ePe;jn.eras=HIe;jn.erasParse=VIe;jn.erasConvertYear=UIe;jn.erasAbbrRegex=XIe;jn.erasNameRegex=qIe;jn.erasNarrowRegex=ZIe;jn.months=kPe;jn.monthsShort=PPe;jn.monthsParse=IPe;jn.monthsRegex=$Pe;jn.monthsShortRegex=DPe;jn.week=BPe;jn.firstDayOfYear=FPe;jn.firstDayOfWeek=zPe;jn.weekdays=ZPe;jn.weekdaysMin=QPe;jn.weekdaysShort=JPe;jn.weekdaysParse=tAe;jn.weekdaysRegex=oAe;jn.weekdaysShortRegex=aAe;jn.weekdaysMinRegex=sAe;jn.isPM=uAe;jn.meridiem=hAe;function vk(e,t,r,n){var i=Lc(),o=hu().set(n,t);return i[r](o,e)}function _oe(e,t,r){if(Pc(e)&&(t=e,e=void 0),e=e||"",t!=null)return vk(e,t,r,"month");var n,i=[];for(n=0;n<12;n++)i[n]=vk(e,n,r,"month");return i}function GH(e,t,r,n){typeof e=="boolean"?(Pc(t)&&(r=t,t=void 0),t=t||""):(t=e,r=t,e=!1,Pc(t)&&(r=t,t=void 0),t=t||"");var i=Lc(),o=e?i._week.dow:0,s,a=[];if(r!=null)return vk(t,(r+o)%7,n,"day");for(s=0;s<7;s++)a[s]=vk(t,(s+o)%7,n,"day");return a}function gMe(e,t){return _oe(e,t,"months")}function vMe(e,t){return _oe(e,t,"monthsShort")}function _Me(e,t,r){return GH(e,t,r,"weekdays")}function bMe(e,t,r){return GH(e,t,r,"weekdaysShort")}function wMe(e,t,r){return GH(e,t,r,"weekdaysMin")}eh("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10,r=Sn(e%100/10)===1?"th":t===1?"st":t===2?"nd":t===3?"rd":"th";return e+r}});Vt.lang=js("moment.lang is deprecated. Use moment.locale instead.",eh);Vt.langData=js("moment.langData is deprecated. Use moment.localeData instead.",Lc);var Mu=Math.abs;function SMe(){var e=this._data;return this._milliseconds=Mu(this._milliseconds),this._days=Mu(this._days),this._months=Mu(this._months),e.milliseconds=Mu(e.milliseconds),e.seconds=Mu(e.seconds),e.minutes=Mu(e.minutes),e.hours=Mu(e.hours),e.months=Mu(e.months),e.years=Mu(e.years),this}function boe(e,t,r,n){var i=bl(t,r);return e._milliseconds+=n*i._milliseconds,e._days+=n*i._days,e._months+=n*i._months,e._bubble()}function xMe(e,t){return boe(this,e,t,1)}function CMe(e,t){return boe(this,e,t,-1)}function G8(e){return e<0?Math.floor(e):Math.ceil(e)}function EMe(){var e=this._milliseconds,t=this._days,r=this._months,n=this._data,i,o,s,a,h;return e>=0&&t>=0&&r>=0||e<=0&&t<=0&&r<=0||(e+=G8(gN(r)+t)*864e5,t=0,r=0),n.milliseconds=e%1e3,i=Rs(e/1e3),n.seconds=i%60,o=Rs(i/60),n.minutes=o%60,s=Rs(o/60),n.hours=s%24,t+=Rs(s/24),h=Rs(woe(t)),r+=h,t-=G8(gN(h)),a=Rs(r/12),r%=12,n.days=t,n.months=r,n.years=a,this}function woe(e){return e*4800/146097}function gN(e){return e*146097/4800}function TMe(e){if(!this.isValid())return NaN;var t,r,n=this._milliseconds;if(e=zs(e),e==="month"||e==="quarter"||e==="year")switch(t=this._days+n/864e5,r=this._months+woe(t),e){case"month":return r;case"quarter":return r/3;case"year":return r/12}else switch(t=this._days+Math.round(gN(this._months)),e){case"week":return t/7+n/6048e5;case"day":return t+n/864e5;case"hour":return t*24+n/36e5;case"minute":return t*1440+n/6e4;case"second":return t*86400+n/1e3;case"millisecond":return Math.floor(t*864e5)+n;default:throw new Error("Unknown unit "+e)}}function OMe(){return this.isValid()?this._milliseconds+this._days*864e5+this._months%12*2592e6+Sn(this._months/12)*31536e6:NaN}function Nc(e){return function(){return this.as(e)}}var RMe=Nc("ms"),kMe=Nc("s"),PMe=Nc("m"),AMe=Nc("h"),IMe=Nc("d"),MMe=Nc("w"),DMe=Nc("M"),$Me=Nc("Q"),LMe=Nc("y");function NMe(){return bl(this)}function BMe(e){return e=zs(e),this.isValid()?this[e+"s"]():NaN}function rm(e){return function(){return this.isValid()?this._data[e]:NaN}}var jMe=rm("milliseconds"),zMe=rm("seconds"),FMe=rm("minutes"),HMe=rm("hours"),VMe=rm("days"),UMe=rm("months"),WMe=rm("years");function GMe(){return Rs(this.days()/7)}var Hu=Math.round,sg={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function YMe(e,t,r,n,i){return i.relativeTime(t||1,!!r,e,n)}function KMe(e,t,r,n){var i=bl(e).abs(),o=Hu(i.as("s")),s=Hu(i.as("m")),a=Hu(i.as("h")),h=Hu(i.as("d")),p=Hu(i.as("M")),g=Hu(i.as("w")),S=Hu(i.as("y")),T=o<=r.ss&&["s",o]||o<r.s&&["ss",o]||s<=1&&["m"]||s<r.m&&["mm",s]||a<=1&&["h"]||a<r.h&&["hh",a]||h<=1&&["d"]||h<r.d&&["dd",h];return r.w!=null&&(T=T||g<=1&&["w"]||g<r.w&&["ww",g]),T=T||p<=1&&["M"]||p<r.M&&["MM",p]||S<=1&&["y"]||["yy",S],T[2]=t,T[3]=+e>0,T[4]=n,YMe.apply(null,T)}function qMe(e){return e===void 0?Hu:typeof e=="function"?(Hu=e,!0):!1}function XMe(e,t){return sg[e]===void 0?!1:t===void 0?sg[e]:(sg[e]=t,e==="s"&&(sg.ss=t-1),!0)}function ZMe(e,t){if(!this.isValid())return this.localeData().invalidDate();var r=!1,n=sg,i,o;return typeof e=="object"&&(t=e,e=!1),typeof e=="boolean"&&(r=e),typeof t=="object"&&(n=Object.assign({},sg,t),t.s!=null&&t.ss==null&&(n.ss=t.s-1)),i=this.localeData(),o=KMe(this,!r,n,i),r&&(o=i.pastFuture(+this,o)),i.postformat(o)}var QD=Math.abs;function hy(e){return(e>0)-(e<0)||+e}function RA(){if(!this.isValid())return this.localeData().invalidDate();var e=QD(this._milliseconds)/1e3,t=QD(this._days),r=QD(this._months),n,i,o,s,a=this.asSeconds(),h,p,g,S;return a?(n=Rs(e/60),i=Rs(n/60),e%=60,n%=60,o=Rs(r/12),r%=12,s=e?e.toFixed(3).replace(/\.?0+$/,""):"",h=a<0?"-":"",p=hy(this._months)!==hy(a)?"-":"",g=hy(this._days)!==hy(a)?"-":"",S=hy(this._milliseconds)!==hy(a)?"-":"",h+"P"+(o?p+o+"Y":"")+(r?p+r+"M":"")+(t?g+t+"D":"")+(i||n||e?"T":"")+(i?S+i+"H":"")+(n?S+n+"M":"")+(e?S+s+"S":"")):"P0D"}var Pn=TA.prototype;Pn.isValid=VAe;Pn.abs=SMe;Pn.add=xMe;Pn.subtract=CMe;Pn.as=TMe;Pn.asMilliseconds=RMe;Pn.asSeconds=kMe;Pn.asMinutes=PMe;Pn.asHours=AMe;Pn.asDays=IMe;Pn.asWeeks=MMe;Pn.asMonths=DMe;Pn.asQuarters=$Me;Pn.asYears=LMe;Pn.valueOf=OMe;Pn._bubble=EMe;Pn.clone=NMe;Pn.get=BMe;Pn.milliseconds=jMe;Pn.seconds=zMe;Pn.minutes=FMe;Pn.hours=HMe;Pn.days=VMe;Pn.weeks=GMe;Pn.months=UMe;Pn.years=WMe;Pn.humanize=ZMe;Pn.toISOString=RA;Pn.toString=RA;Pn.toJSON=RA;Pn.locale=uoe;Pn.localeData=foe;Pn.toIsoString=js("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",RA);Pn.lang=coe;Mr("X",0,0,"unix");Mr("x",0,0,"valueOf");vr("x",SA);vr("X",_Pe);ii("X",function(e,t,r){r._d=new Date(parseFloat(e)*1e3)});ii("x",function(e,t,r){r._d=new Date(Sn(e))});//! moment.js
Vt.version="2.29.4";Jke(gi);Vt.fn=qt;Vt.min=jAe;Vt.max=zAe;Vt.now=FAe;Vt.utc=hu;Vt.unix=mMe;Vt.months=gMe;Vt.isDate=oC;Vt.locale=eh;Vt.invalid=gA;Vt.duration=bl;Vt.isMoment=gl;Vt.weekdays=_Me;Vt.parseZone=yMe;Vt.localeData=Lc;Vt.isDuration=rR;Vt.monthsShort=vMe;Vt.weekdaysMin=wMe;Vt.defineLocale=BH;Vt.updateLocale=yAe;Vt.locales=gAe;Vt.weekdaysShort=bMe;Vt.normalizeUnits=zs;Vt.relativeTimeRounding=qMe;Vt.relativeTimeThreshold=XMe;Vt.calendarFormat=hIe;Vt.prototype=qt;Vt.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};const JMe=Object.freeze(Object.defineProperty({__proto__:null,default:Vt},Symbol.toStringTag,{value:"Module"}));var QMe=TypeError,eDe=9007199254740991,Soe=function(e){if(e>eDe)throw QMe("Maximum allowed index exceeded");return e},tDe=Br,rDe=nn,nDe=eb,iDe=Zi,oDe=Ha,aDe=Ns,Y8=Soe,K8=Q_,sDe=lH,lDe=eC,uDe=hi,cDe=Bx,xoe=uDe("isConcatSpreadable"),fDe=cDe>=51||!rDe(function(){var e=[];return e[xoe]=!1,e.concat()[0]!==e}),hDe=function(e){if(!iDe(e))return!1;var t=e[xoe];return t!==void 0?!!t:nDe(e)},dDe=!fDe||!lDe("concat");tDe({target:"Array",proto:!0,arity:1,forced:dDe},{concat:function(t){var r=oDe(this),n=sDe(r,0),i=0,o,s,a,h,p;for(o=-1,a=arguments.length;o<a;o++)if(p=o===-1?r:arguments[o],hDe(p))for(h=aDe(p),Y8(i+h),s=0;s<h;s++,i++)s in p&&K8(n,i,p[s]);else Y8(i+1),K8(n,i++,p);return n.length=i,n}});var pDe=Zi,mDe=cu,yDe=hi,gDe=yDe("match"),YH=function(e){var t;return pDe(e)&&((t=e[gDe])!==void 0?!!t:mDe(e)=="RegExp")},vDe=YH,_De=TypeError,KH=function(e){if(vDe(e))throw _De("The method doesn't accept regular expressions");return e},bDe=hi,wDe=bDe("match"),qH=function(e){var t=/./;try{"/./"[e](t)}catch{try{return t[wDe]=!1,"/./"[e](t)}catch{}}return!1},SDe=Br,xDe=an,CDe=KH,EDe=Fa,q8=Qi,TDe=qH,ODe=xDe("".indexOf);SDe({target:"String",proto:!0,forced:!TDe("includes")},{includes:function(t){return!!~ODe(q8(EDe(this)),q8(CDe(t)),arguments.length>1?arguments[1]:void 0)}});var RDe=Dc,kDe=tC,PDe=hi,ADe=Ji,X8=PDe("species"),Coe=function(e){var t=RDe(e);ADe&&t&&!t[X8]&&kDe(t,X8,{configurable:!0,get:function(){return this}})},IDe=J_,MDe=tC,Z8=ZF,DDe=Jx,$De=oH,LDe=_l,NDe=iH,BDe=UF,qT=WF,jDe=Coe,Gw=Ji,J8=Xx.fastKey,Eoe=$c,Q8=Eoe.set,e$=Eoe.getterFor,Toe={getConstructor:function(e,t,r,n){var i=e(function(p,g){$De(p,o),Q8(p,{type:t,index:IDe(null),first:void 0,last:void 0,size:0}),Gw||(p.size=0),LDe(g)||NDe(g,p[n],{that:p,AS_ENTRIES:r})}),o=i.prototype,s=e$(t),a=function(p,g,S){var T=s(p),R=h(p,g),A,$;return R?R.value=S:(T.last=R={index:$=J8(g,!0),key:g,value:S,previous:A=T.last,next:void 0,removed:!1},T.first||(T.first=R),A&&(A.next=R),Gw?T.size++:p.size++,$!=="F"&&(T.index[$]=R)),p},h=function(p,g){var S=s(p),T=J8(g),R;if(T!=="F")return S.index[T];for(R=S.first;R;R=R.next)if(R.key==g)return R};return Z8(o,{clear:function(){for(var g=this,S=s(g),T=S.index,R=S.first;R;)R.removed=!0,R.previous&&(R.previous=R.previous.next=void 0),delete T[R.index],R=R.next;S.first=S.last=void 0,Gw?S.size=0:g.size=0},delete:function(p){var g=this,S=s(g),T=h(g,p);if(T){var R=T.next,A=T.previous;delete S.index[T.index],T.removed=!0,A&&(A.next=R),R&&(R.previous=A),S.first==T&&(S.first=R),S.last==T&&(S.last=A),Gw?S.size--:g.size--}return!!T},forEach:function(g){for(var S=s(this),T=DDe(g,arguments.length>1?arguments[1]:void 0),R;R=R?R.next:S.first;)for(T(R.value,R.key,this);R&&R.removed;)R=R.previous},has:function(g){return!!h(this,g)}}),Z8(o,r?{get:function(g){var S=h(this,g);return S&&S.value},set:function(g,S){return a(this,g===0?0:g,S)}}:{add:function(g){return a(this,g=g===0?0:g,g)}}),Gw&&MDe(o,"size",{configurable:!0,get:function(){return s(this).size}}),i},setStrong:function(e,t,r){var n=t+" Iterator",i=e$(t),o=e$(n);BDe(e,t,function(s,a){Q8(this,{type:n,target:s,state:i(s),kind:a,last:void 0})},function(){for(var s=o(this),a=s.kind,h=s.last;h&&h.removed;)h=h.previous;return!s.target||!(s.last=h=h?h.next:s.state.first)?(s.target=void 0,qT(void 0,!0)):a=="keys"?qT(h.key,!1):a=="values"?qT(h.value,!1):qT([h.key,h.value],!1)},r?"entries":"values",!r,!0),jDe(t)}},zDe=nA,FDe=Toe;zDe("Set",function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},FDe);var eY=Wi,HDe=gie,VDe=_l,UDe=hi,WDe=UDe("species"),GDe=function(e,t){var r=eY(e).constructor,n;return r===void 0||VDe(n=eY(r)[WDe])?t:HDe(n)},YDe=tm,Yw=so,XH=an,KDe=sA,qDe=Wi,XDe=_l,ZDe=YH,tY=Fa,JDe=GDe,QDe=pH,e$e=Zp,t$=Qi,t$e=Xp,rY=QF,nY=lA,r$e=aA,n$e=dH,i$e=nn,dy=n$e.UNSUPPORTED_Y,iY=4294967295,o$e=Math.min,Ooe=[].push,a$e=XH(/./.exec),py=XH(Ooe),Kw=XH("".slice),s$e=!i$e(function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var r="ab".split(e);return r.length!==2||r[0]!=="a"||r[1]!=="b"});KDe("split",function(e,t,r){var n;return"abbc".split(/(b)*/)[1]=="c"||"test".split(/(?:)/,-1).length!=4||"ab".split(/(?:ab)*/).length!=2||".".split(/(.?)(.?)/).length!=4||".".split(/()()/).length>1||"".split(/.?/).length?n=function(i,o){var s=t$(tY(this)),a=o===void 0?iY:o>>>0;if(a===0)return[];if(i===void 0)return[s];if(!ZDe(i))return Yw(t,s,i,a);for(var h=[],p=(i.ignoreCase?"i":"")+(i.multiline?"m":"")+(i.unicode?"u":"")+(i.sticky?"y":""),g=0,S=new RegExp(i.source,p+"g"),T,R,A;(T=Yw(r$e,S,s))&&(R=S.lastIndex,!(R>g&&(py(h,Kw(s,g,T.index)),T.length>1&&T.index<s.length&&YDe(Ooe,h,rY(T,1)),A=T[0].length,g=R,h.length>=a)));)S.lastIndex===T.index&&S.lastIndex++;return g===s.length?(A||!a$e(S,""))&&py(h,""):py(h,Kw(s,g)),h.length>a?rY(h,0,a):h}:"0".split(void 0,0).length?n=function(i,o){return i===void 0&&o===0?[]:Yw(t,this,i,o)}:n=t,[function(o,s){var a=tY(this),h=XDe(o)?void 0:t$e(o,e);return h?Yw(h,o,a,s):Yw(n,t$(a),o,s)},function(i,o){var s=qDe(this),a=t$(i),h=r(n,s,a,o,n!==t);if(h.done)return h.value;var p=JDe(s,RegExp),g=s.unicode,S=(s.ignoreCase?"i":"")+(s.multiline?"m":"")+(s.unicode?"u":"")+(dy?"g":"y"),T=new p(dy?"^(?:"+s.source+")":s,S),R=o===void 0?iY:o>>>0;if(R===0)return[];if(a.length===0)return nY(T,a)===null?[a]:[];for(var A=0,$=0,j=[];$<a.length;){T.lastIndex=dy?0:$;var z=nY(T,dy?Kw(a,$):a),V;if(z===null||(V=o$e(e$e(T.lastIndex+(dy?$:0)),a.length))===A)$=QDe(a,$,g);else{if(py(j,Kw(a,A,$)),j.length===R)return j;for(var G=1;G<=z.length-1;G++)if(py(j,z[G]),j.length===R)return j;$=A=V}}return py(j,Kw(a,A)),j}]},!s$e,dy);function l$e(e){for(var t=e.length,r=0;r<t;)e[r]=[e[r]],r+=1}function oY(e,t){for(var r=t.length,n=0;n<r;)e.push(t[n]),n+=1}function iR(e){var t=[];if(!e||e.length===0||!e[0]||e[0].length===0)return t;for(var r=e.length,n=e[0].length,i=0;i<r;i++)for(var o=0;o<n;o++)t[o]||(t[o]=[]),t[o][i]=e[i][o];return t}function na(e,t,r,n){var i=-1,o=e,s=r;Array.isArray(e)||(o=Array.from(e));var a=o.length;for(n&&a&&(i+=1,s=o[i]),i+=1;i<a;)s=t(s,o[i],i,o),i+=1;return s}function $s(e,t){var r=0,n=e;Array.isArray(e)||(n=Array.from(e));for(var i=n.length,o=[],s=-1;r<i;){var a=n[r];t(a,r,n)&&(s+=1,o[s]=a),r+=1}return o}function hn(e,t){var r=0,n=e;Array.isArray(e)||(n=Array.from(e));for(var i=n.length,o=[],s=-1;r<i;){var a=n[r];s+=1,o[s]=t(a,r,n),r+=1}return o}function Le(e,t){var r=0,n=e;Array.isArray(e)||(n=Array.from(e));for(var i=n.length;r<i&&t(n[r],r,n)!==!1;)r+=1;return e}function Roe(e){var t=[];return Le(e,function(r){t.indexOf(r)===-1&&t.push(r)}),t}function aY(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=[].concat(t),i=n[0],o=n.slice(1),s=i;return Le(o,function(a){s=s.filter(function(h){return!a.includes(h)})}),s}function sY(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return e.split(t)}function Xn(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var i=na(e,function(o,s,a){var h=s.replace(/\r?\n\s*/g,""),p=r[a]?r[a]:"";return o+h+p},"");return i.trim()}var lY,uY,cY,fY,hY,dY;function bg(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function vN(e){"@babel/helpers - typeof";return vN=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vN(e)}function Xi(e){var t;switch(vN(e)){case"string":case"number":t="".concat(e);break;case"object":t=e===null?"":e.toString();break;case"undefined":t="";break;default:t=e.toString();break}return t}function dr(e){return typeof e<"u"}function si(e){return typeof e>"u"}function go(e){return e===null||e===""||si(e)}function u$e(e){return Object.prototype.toString.call(e)==="[object RegExp]"}var S0="length",z0=function(t){return parseInt(t,16)},pY=function(t){return parseInt(t,10)},_k=function(t,r,n){return t.substr(r,n)},F0=function(t){return t.codePointAt(0)-65},_N=function(t){return"".concat(t).replace(/\-/g,"")},c$e=function(t){return z0(_k(_N(t),z0("12"),F0("F")))/(z0(_k(_N(t),F0("B"),~~![][S0]))||9)},f$e=function(){return typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host)},mY=!1,yY={invalid:function(){return Xn(lY||(lY=bg([`
    The license key for Handsontable is invalid. 
    If you need any help, contact us at support@handsontable.com.`],[`
    The license key for Handsontable is invalid.\\x20
    If you need any help, contact us at support@handsontable.com.`])))},expired:function(t){var r=t.keyValidityDate,n=t.hotVersion;return Xn(uY||(uY=bg([`
    The license key for Handsontable expired on `,`, and is not valid for the installed 
    version `,`. Renew your license key at handsontable.com or downgrade to a version released prior 
    to `,". If you need any help, contact us at sales@handsontable.com."],[`
    The license key for Handsontable expired on `,`, and is not valid for the installed\\x20
    version `,`. Renew your license key at handsontable.com or downgrade to a version released prior\\x20
    to `,". If you need any help, contact us at sales@handsontable.com."])),r,n,r)},missing:function(){return Xn(cY||(cY=bg([`
    The license key for Handsontable is missing. Use your purchased key to activate the product. 
    Alternatively, you can activate Handsontable to use for non-commercial purposes by 
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact 
    us at support@handsontable.com.`],[`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\\x20
    us at support@handsontable.com.`])))},non_commercial:function(){return""}},gY={invalid:function(){return Xn(fY||(fY=bg([`
    The license key for Handsontable is invalid. 
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to 
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`],[`
    The license key for Handsontable is invalid.\\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`])))},expired:function(t){var r=t.keyValidityDate,n=t.hotVersion;return Xn(hY||(hY=bg([`
    The license key for Handsontable expired on `,`, and is not valid for the installed 
    version `,`. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your 
    license key or downgrade to a version released prior to `,`. If you need any 
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`],[`
    The license key for Handsontable expired on `,`, and is not valid for the installed\\x20
    version `,`. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\\x20
    license key or downgrade to a version released prior to `,`. If you need any\\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`])),r,n,r)},missing:function(){return Xn(dY||(dY=bg([`
    The license key for Handsontable is missing. Use your purchased key to activate the product. 
    Alternatively, you can activate Handsontable to use for non-commercial purposes by 
    passing the key: 'non-commercial-and-evaluation'. 
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in 
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`],[`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\\x20
    passing the key: 'non-commercial-and-evaluation'.\\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`])))},non_commercial:function(){return""}};function h$e(e,t){var r=!go(e),n=typeof e=="string"&&e.toLowerCase()==="non-commercial-and-evaluation",i="12.3.3",o,s="invalid",a="invalid";e=_N(e||"");var h=d$e(e);if(r||n||h)if(h){var p=Vt("28/03/2023","DD/MM/YYYY"),g=Math.floor(p.toDate().getTime()/864e5),S=c$e(e);o=Vt((S+1)*864e5,"x").format("MMMM DD, YYYY"),g>S?(s="expired",a="expired"):(s="valid",a="valid")}else n?(s="non_commercial",a="valid"):(s="invalid",a="invalid");else s="missing",a="missing";if(f$e()&&(s="valid",a="valid"),!mY&&s!=="valid"){var T=yY[s]({keyValidityDate:o,hotVersion:i});T&&console[s==="non_commercial"?"info":"warn"](yY[s]({keyValidityDate:o,hotVersion:i})),mY=!0}if(a!=="valid"&&t.parentNode){var R=gY[a]({keyValidityDate:o,hotVersion:i});if(R){var A=document.createElement("div");A.className="hot-display-license-info",A.innerHTML=gY[a]({keyValidityDate:o,hotVersion:i}),t.parentNode.insertBefore(A,t.nextSibling)}}}function d$e(e){var t=[][S0],r=t;if(e[S0]!==F0("Z"))return!1;for(var n="",i="B<H4P+".split(""),o=F0(i.shift());o;o=F0(i.shift()||"A"))--o<""[S0]?r=r|(pY("".concat(pY(z0(n)+(z0(_k(e,Math.abs(o),2))+[]).padStart(2,"0"))))%97||2)>>1:n=_k(e,o,o?i[S0]===1?9:8:6);return r===t}var p$e=Ha,vY=zx,m$e=Ns,y$e=function(t){for(var r=p$e(this),n=m$e(r),i=arguments.length,o=vY(i>1?arguments[1]:void 0,n),s=i>2?arguments[2]:void 0,a=s===void 0?n:vY(s,n);a>o;)r[o++]=t;return r},g$e=Br,v$e=y$e,_$e=Vx;g$e({target:"Array",proto:!0},{fill:v$e});_$e("fill");var b$e=em.forEach,w$e=tb,S$e=w$e("forEach"),x$e=S$e?[].forEach:function(t){return b$e(this,t,arguments.length>1?arguments[1]:void 0)},_Y=ni,bY=Sne,C$e=xne,r$=x$e,E$e=Jp,koe=function(e){if(e&&e.forEach!==r$)try{E$e(e,"forEach",r$)}catch{e.forEach=r$}};for(var n$ in bY)bY[n$]&&koe(_Y[n$]&&_Y[n$].prototype);koe(C$e);function wY(e,t,r){return t=T$e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function T$e(e){var t=O$e(e,"string");return Ac(t)==="symbol"?t:String(t)}function O$e(e,t){if(Ac(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ac(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ac(e){"@babel/helpers - typeof";return Ac=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ac(e)}function ES(e){var t;return Array.isArray(e)?t=e.length?new Array(e.length).fill(null):[]:(t={},pn(e,function(r,n){n!=="__children"&&(r&&Ac(r)==="object"&&!Array.isArray(r)?t[n]=ES(r):Array.isArray(r)?r.length&&Ac(r[0])==="object"&&!Array.isArray(r[0])?t[n]=[ES(r[0])]:t[n]=[]:t[n]=null)})),t}function Sh(e,t){return t.prototype.constructor=t,e.prototype=new t,e.prototype.constructor=e,e}function ao(e,t,r){var n=Array.isArray(r);return pn(t,function(i,o){(n===!1||r.includes(o))&&(e[o]=i)}),e}function kA(e,t){pn(t,function(r,n){t[n]&&Ac(t[n])==="object"?(e[n]||(Array.isArray(t[n])?e[n]=[]:Object.prototype.toString.call(t[n])==="[object Date]"?e[n]=t[n]:e[n]={}),kA(e[n],t[n])):e[n]=t[n]})}function ya(e){return Ac(e)==="object"?JSON.parse(JSON.stringify(e)):e}function Na(e){var t={};return pn(e,function(r,n){t[n]=r}),t}function li(e){e.MIXINS||(e.MIXINS=[]);for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return Le(r,function(i){e.MIXINS.push(i.MIXIN_NAME),pn(i,function(o,s){if(e.prototype[s]!==void 0)throw new Error("Mixin conflict. Property '".concat(s,"' already exist and cannot be overwritten."));if(typeof o=="function")e.prototype[s]=o;else{var a=function(g,S){var T="_".concat(g),R=function($){var j=$;return(Array.isArray(j)||dn(j))&&(j=ya(j)),j};return function(){return this[T]===void 0&&(this[T]=R(S)),this[T]}},h=function(g){var S="_".concat(g);return function(T){this[S]=T}};Object.defineProperty(e.prototype,s,{get:a(s,o),set:h(s),configurable:!0})}})}),e}function Poe(e,t){return JSON.stringify(e)===JSON.stringify(t)}function dn(e){return Object.prototype.toString.call(e)==="[object Object]"}function Bc(e,t,r,n){n.value=r,n.writable=n.writable!==!1,n.enumerable=n.enumerable!==!1,n.configurable=n.configurable!==!1,Object.defineProperty(e,t,n)}function pn(e,t){for(var r in e)if((!e.hasOwnProperty||e.hasOwnProperty&&Object.prototype.hasOwnProperty.call(e,r))&&t(e[r],r,e)===!1)break;return e}function R$e(e,t){var r=t.split("."),n=e;return pn(r,function(i){if(n=n[i],n===void 0)return n=void 0,!1}),n}function i$(e,t,r){var n=t.split("."),i=e;n.forEach(function(o,s){s!==n.length-1?(Ui(i,o)||(i[o]={}),i=i[o]):i[o]=r})}function ZH(e){if(!dn(e))return 0;var t=function r(n){var i=0;return dn(n)?pn(n,function(o,s){s!=="__children"&&(i+=r(o))}):i+=1,i};return t(e)}function jg(e){var t,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value",n="_".concat(r),i=(t={_touched:!1},wY(t,n,e),wY(t,"isTouched",function(){return this._touched}),t);return Object.defineProperty(i,r,{get:function(){return this[n]},set:function(s){this._touched=!0,this[n]=s},enumerable:!0,configurable:!0}),i}function Ui(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var Ma=function(t){var r={value:!1};return r.test=function(n,i){r.value=t(n,i)},r},pu={chrome:Ma(function(e,t){return/Chrome/.test(e)&&/Google/.test(t)}),chromeWebKit:Ma(function(e){return/CriOS/.test(e)}),edge:Ma(function(e){return/Edge/.test(e)}),edgeWebKit:Ma(function(e){return/EdgiOS/.test(e)}),firefox:Ma(function(e){return/Firefox/.test(e)}),firefoxWebKit:Ma(function(e){return/FxiOS/.test(e)}),ie:Ma(function(e){return/Trident/.test(e)}),ie9:Ma(function(){return!!document.documentMode}),mobile:Ma(function(e){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(e)}),safari:Ma(function(e,t){return/Safari/.test(e)&&/Apple Computer/.test(t)})},uC={mac:Ma(function(e){return/^Mac/.test(e)}),win:Ma(function(e){return/^Win/.test(e)}),linux:Ma(function(e){return/^Linux/.test(e)}),ios:Ma(function(e){return/iPhone|iPad|iPod/i.test(e)})};function k$e(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.userAgent,r=t===void 0?navigator.userAgent:t,n=e.vendor,i=n===void 0?navigator.vendor:n;pn(pu,function(o){var s=o.test;return void s(r,i)})}function P$e(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.platform,r=t===void 0?navigator.platform:t;pn(uC,function(n){var i=n.test;return void i(r)})}k$e();P$e();function Aoe(){return pu.chrome.value}function A$e(){return pu.chromeWebKit.value}function o$(){return pu.firefox.value}function I$e(){return pu.firefoxWebKit.value}function M$e(){return pu.safari.value}function D$e(){return pu.edge.value}function $$e(){return pu.ie.value}function L$e(){return pu.ie9.value}function nu(){return pu.mobile.value}function Ioe(){return uC.ios.value}function Moe(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator,t=e.maxTouchPoints;return t>2&&uC.mac.value}function SY(){return uC.win.value}function xY(){return uC.mac.value}var Cr={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:o$()?182:174,AUDIO_MUTE:o$()?181:173,AUDIO_UP:o$()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},N$e=[Cr.ALT,Cr.ARROW_DOWN,Cr.ARROW_LEFT,Cr.ARROW_RIGHT,Cr.ARROW_UP,Cr.AUDIO_DOWN,Cr.AUDIO_MUTE,Cr.AUDIO_UP,Cr.BACKSPACE,Cr.CAPS_LOCK,Cr.DELETE,Cr.END,Cr.ENTER,Cr.ESCAPE,Cr.F1,Cr.F2,Cr.F3,Cr.F4,Cr.F5,Cr.F6,Cr.F7,Cr.F8,Cr.F9,Cr.F10,Cr.F11,Cr.F12,Cr.F13,Cr.F14,Cr.F15,Cr.F16,Cr.F17,Cr.F18,Cr.F19,Cr.HOME,Cr.INSERT,Cr.MEDIA_NEXT,Cr.MEDIA_PLAY_PAUSE,Cr.MEDIA_PREV,Cr.MEDIA_STOP,Cr.NULL,Cr.NUM_LOCK,Cr.PAGE_DOWN,Cr.PAGE_UP,Cr.PAUSE,Cr.SCROLL_LOCK,Cr.SHIFT,Cr.TAB];function B$e(e){return e===32||e>=48&&e<=57||e>=96&&e<=111||e>=186&&e<=192||e>=219&&e<=222||e>=226||e>=65&&e<=90}function Doe(e){return N$e.includes(e)}function j$e(e){return[Cr.CONTROL,Cr.COMMAND_LEFT,Cr.COMMAND_RIGHT,Cr.COMMAND_FIREFOX].includes(e)}function TS(e,t){var r=t.split("|"),n=!1;return Le(r,function(i){if(e===Cr[i])return n=!0,!1}),n}function lu(e){e.isImmediatePropagationEnabled=!1,e.cancelBubble=!0}function Uy(e){return e.isImmediatePropagationEnabled===!1}function Pp(e){return e.button===2}function JH(e){return e.button===0}var z$e=ba.f,F$e=function(e,t,r){r in e||z$e(e,r,{configurable:!0,get:function(){return t[r]},set:function(n){t[r]=n}})},H$e=Ji,QH=ni,cC=an,V$e=QP,U$e=aH,W$e=Jp,G$e=Qp.f,CY=bh,Y$e=YH,EY=Qi,K$e=Oie,$oe=dH,q$e=F$e,X$e=Bs,Z$e=nn,J$e=Ni,Q$e=$c.enforce,e2e=Coe,t2e=hi,Loe=Mne,Noe=Dne,r2e=t2e("match"),th=QH.RegExp,Wy=th.prototype,n2e=QH.SyntaxError,i2e=cC(Wy.exec),bk=cC("".charAt),TY=cC("".replace),OY=cC("".indexOf),o2e=cC("".slice),a2e=/^\?<[^\s\d!#%&*+<=>@^][^\s!#%&*+<=>@^]*>/,wp=/a/g,a$=/a/g,s2e=new th(wp)!==wp,Boe=$oe.MISSED_STICKY,l2e=$oe.UNSUPPORTED_Y,u2e=H$e&&(!s2e||Boe||Loe||Noe||Z$e(function(){return a$[r2e]=!1,th(wp)!=wp||th(a$)==a$||th(wp,"i")!="/a/i"})),c2e=function(e){for(var t=e.length,r=0,n="",i=!1,o;r<=t;r++){if(o=bk(e,r),o==="\\"){n+=o+bk(e,++r);continue}!i&&o==="."?n+="[\\s\\S]":(o==="["?i=!0:o==="]"&&(i=!1),n+=o)}return n},f2e=function(e){for(var t=e.length,r=0,n="",i=[],o={},s=!1,a=!1,h=0,p="",g;r<=t;r++){if(g=bk(e,r),g==="\\")g=g+bk(e,++r);else if(g==="]")s=!1;else if(!s)switch(!0){case g==="[":s=!0;break;case g==="(":i2e(a2e,o2e(e,r+1))&&(r+=2,a=!0),n+=g,h++;continue;case(g===">"&&a):if(p===""||J$e(o,p))throw new n2e("Invalid capture group name");o[p]=!0,i[i.length]=[p,h],a=!1,p="";continue}a?p+=g:n+=g}return[n,i]};if(V$e("RegExp",u2e)){for(var vd=function(t,r){var n=CY(Wy,this),i=Y$e(t),o=r===void 0,s=[],a=t,h,p,g,S,T,R;if(!n&&i&&o&&t.constructor===vd)return t;if((i||CY(Wy,t))&&(t=t.source,o&&(r=K$e(a))),t=t===void 0?"":EY(t),r=r===void 0?"":EY(r),a=t,Loe&&"dotAll"in wp&&(p=!!r&&OY(r,"s")>-1,p&&(r=TY(r,/s/g,""))),h=r,Boe&&"sticky"in wp&&(g=!!r&&OY(r,"y")>-1,g&&l2e&&(r=TY(r,/y/g,""))),Noe&&(S=f2e(t),t=S[0],s=S[1]),T=U$e(th(t,r),n?this:Wy,vd),(p||g||s.length)&&(R=Q$e(T),p&&(R.dotAll=!0,R.raw=vd(c2e(t),h)),g&&(R.sticky=!0),s.length&&(R.groups=s)),t!==a)try{W$e(T,"source",a===""?"(?:)":a)}catch{}return T},RY=G$e(th),kY=0;RY.length>kY;)q$e(vd,th,RY[kY++]);Wy.constructor=vd,vd.prototype=Wy,X$e(QH,"RegExp",vd,{constructor:!0})}e2e("RegExp");var h2e=Br,d2e=an,p2e=Nx,m2e=cs,y2e=tb,g2e=d2e([].join),v2e=p2e!=Object,_2e=v2e||!y2e("join",",");h2e({target:"Array",proto:!0,forced:_2e},{join:function(t){return g2e(m2e(this),t===void 0?",":t)}});function bN(e){"@babel/helpers - typeof";return bN=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bN(e)}function e3(e){return window.requestAnimationFrame(e)}function b2e(){return!!document.documentElement.classList}function w2e(){return!!document.createTextNode("test").textContent}function S2e(){return!!window.getComputedStyle}function wk(e){window.cancelAnimationFrame(e)}function joe(){return"ontouchstart"in window}var wN;function x2e(){var e=document.createElement("TABLE");e.style.borderSpacing="0",e.style.borderWidth="0",e.style.padding="0";var t=document.createElement("TBODY");e.appendChild(t),t.appendChild(document.createElement("TR")),t.firstChild.appendChild(document.createElement("TD")),t.firstChild.firstChild.innerHTML="<tr><td>t<br>t</td></tr>";var r=document.createElement("CAPTION");r.innerHTML="c<br>c<br>c<br>c",r.style.padding="0",r.style.margin="0",e.insertBefore(r,t),document.body.appendChild(e),wN=e.offsetHeight<2*e.lastChild.offsetHeight,document.body.removeChild(e)}function zoe(){return wN===void 0&&x2e(),wN}var my;function C2e(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return my||((typeof Intl>"u"?"undefined":bN(Intl))==="object"?my=new Intl.Collator(e,t).compare:typeof String.prototype.localeCompare=="function"?my=function(n,i){return"".concat(n).localeCompare(i)}:my=function(n,i){return n===i?0:n>i?-1:1},my)}var qw;function E2e(){if(qw!==void 0)return qw;try{var e={get passive(){qw=!0}};window.addEventListener("test",e,e),window.removeEventListener("test",e,e)}catch{qw=!1}return qw}/*! @license DOMPurify 2.4.5 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.4.5/LICENSE */function $f(e){"@babel/helpers - typeof";return $f=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$f(e)}function SN(e,t){return SN=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},SN(e,t)}function T2e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function oR(e,t,r){return T2e()?oR=Reflect.construct:oR=function(i,o,s){var a=[null];a.push.apply(a,o);var h=Function.bind.apply(i,a),p=new h;return s&&SN(p,s.prototype),p},oR.apply(null,arguments)}function nl(e){return O2e(e)||R2e(e)||k2e(e)||P2e()}function O2e(e){if(Array.isArray(e))return xN(e)}function R2e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function k2e(e,t){if(e){if(typeof e=="string")return xN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return xN(e,t)}}function xN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function P2e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var A2e=Object.hasOwnProperty,PY=Object.setPrototypeOf,I2e=Object.isFrozen,M2e=Object.getPrototypeOf,D2e=Object.getOwnPropertyDescriptor,ga=Object.freeze,vl=Object.seal,$2e=Object.create,Foe=typeof Reflect<"u"&&Reflect,Sk=Foe.apply,CN=Foe.construct;Sk||(Sk=function(t,r,n){return t.apply(r,n)});ga||(ga=function(t){return t});vl||(vl=function(t){return t});CN||(CN=function(t,r){return oR(t,nl(r))});var L2e=Ls(Array.prototype.forEach),AY=Ls(Array.prototype.pop),Xw=Ls(Array.prototype.push),aR=Ls(String.prototype.toLowerCase),s$=Ls(String.prototype.toString),N2e=Ls(String.prototype.match),el=Ls(String.prototype.replace),B2e=Ls(String.prototype.indexOf),j2e=Ls(String.prototype.trim),sa=Ls(RegExp.prototype.test),l$=z2e(TypeError);function Ls(e){return function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return Sk(e,t,n)}}function z2e(e){return function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return CN(e,r)}}function yn(e,t,r){r=r||aR,PY&&PY(e,null);for(var n=t.length;n--;){var i=t[n];if(typeof i=="string"){var o=r(i);o!==i&&(I2e(t)||(t[n]=o),i=o)}e[i]=!0}return e}function _d(e){var t=$2e(null),r;for(r in e)Sk(A2e,e,[r])===!0&&(t[r]=e[r]);return t}function XT(e,t){for(;e!==null;){var r=D2e(e,t);if(r){if(r.get)return Ls(r.get);if(typeof r.value=="function")return Ls(r.value)}e=M2e(e)}function n(i){return console.warn("fallback value for",i),null}return n}var IY=ga(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),u$=ga(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),c$=ga(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),F2e=ga(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),f$=ga(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),H2e=ga(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),MY=ga(["#text"]),DY=ga(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),h$=ga(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),$Y=ga(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),ZT=ga(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),V2e=vl(/\{\{[\w\W]*|[\w\W]*\}\}/gm),U2e=vl(/<%[\w\W]*|[\w\W]*%>/gm),W2e=vl(/\${[\w\W]*}/gm),G2e=vl(/^data-[\-\w.\u00B7-\uFFFF]/),Y2e=vl(/^aria-[\-\w]+$/),K2e=vl(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),q2e=vl(/^(?:\w+script|data):/i),X2e=vl(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Z2e=vl(/^html$/i),J2e=function(){return typeof window>"u"?null:window},Q2e=function(t,r){if($f(t)!=="object"||typeof t.createPolicy!="function")return null;var n=null,i="data-tt-policy-suffix";r.currentScript&&r.currentScript.hasAttribute(i)&&(n=r.currentScript.getAttribute(i));var o="dompurify"+(n?"#"+n:"");try{return t.createPolicy(o,{createHTML:function(a){return a},createScriptURL:function(a){return a}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}};function Hoe(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:J2e(),t=function(Ee){return Hoe(Ee)};if(t.version="2.4.5",t.removed=[],!e||!e.document||e.document.nodeType!==9)return t.isSupported=!1,t;var r=e.document,n=e.document,i=e.DocumentFragment,o=e.HTMLTemplateElement,s=e.Node,a=e.Element,h=e.NodeFilter,p=e.NamedNodeMap,g=p===void 0?e.NamedNodeMap||e.MozNamedAttrMap:p,S=e.HTMLFormElement,T=e.DOMParser,R=e.trustedTypes,A=a.prototype,$=XT(A,"cloneNode"),j=XT(A,"nextSibling"),z=XT(A,"childNodes"),V=XT(A,"parentNode");if(typeof o=="function"){var G=n.createElement("template");G.content&&G.content.ownerDocument&&(n=G.content.ownerDocument)}var ee=Q2e(R,r),K=ee?ee.createHTML(""):"",xe=n,Me=xe.implementation,He=xe.createNodeIterator,Ne=xe.createDocumentFragment,We=xe.getElementsByTagName,gt=r.importNode,Lt={};try{Lt=_d(n).documentMode?n.documentMode:{}}catch{}var _t={};t.isSupported=typeof V=="function"&&Me&&typeof Me.createHTMLDocument<"u"&&Lt!==9;var $e=V2e,Fe=U2e,At=W2e,Gt=G2e,ae=Y2e,D=q2e,U=X2e,q=K2e,ne=null,ye=yn({},[].concat(nl(IY),nl(u$),nl(c$),nl(f$),nl(MY))),ve=null,ze=yn({},[].concat(nl(DY),nl(h$),nl($Y),nl(ZT))),je=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Je=null,xt=null,kt=!0,jt=!0,yr=!1,Ft=!0,Jt=!1,et=!1,wr=!1,$r=!1,lr=!1,Sr=!1,Or=!1,se=!0,_e=!1,Re="user-content-",Ke=!0,Be=!1,rt={},Ue=null,Ve=yn({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),st=null,Ze=yn({},["audio","video","img","source","image","track"]),ft=null,zt=yn({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),nr="http://www.w3.org/1998/Math/MathML",cr="http://www.w3.org/2000/svg",Pr="http://www.w3.org/1999/xhtml",Vr=Pr,gn=!1,Ir=null,Ar=yn({},[nr,cr,Pr],s$),sn,on=["application/xhtml+xml","text/html"],Fr="text/html",jr,tn=null,ei=n.createElement("form"),xn=function(Ee){return Ee instanceof RegExp||Ee instanceof Function},ln=function(Ee){tn&&tn===Ee||((!Ee||$f(Ee)!=="object")&&(Ee={}),Ee=_d(Ee),sn=on.indexOf(Ee.PARSER_MEDIA_TYPE)===-1?sn=Fr:sn=Ee.PARSER_MEDIA_TYPE,jr=sn==="application/xhtml+xml"?s$:aR,ne="ALLOWED_TAGS"in Ee?yn({},Ee.ALLOWED_TAGS,jr):ye,ve="ALLOWED_ATTR"in Ee?yn({},Ee.ALLOWED_ATTR,jr):ze,Ir="ALLOWED_NAMESPACES"in Ee?yn({},Ee.ALLOWED_NAMESPACES,s$):Ar,ft="ADD_URI_SAFE_ATTR"in Ee?yn(_d(zt),Ee.ADD_URI_SAFE_ATTR,jr):zt,st="ADD_DATA_URI_TAGS"in Ee?yn(_d(Ze),Ee.ADD_DATA_URI_TAGS,jr):Ze,Ue="FORBID_CONTENTS"in Ee?yn({},Ee.FORBID_CONTENTS,jr):Ve,Je="FORBID_TAGS"in Ee?yn({},Ee.FORBID_TAGS,jr):{},xt="FORBID_ATTR"in Ee?yn({},Ee.FORBID_ATTR,jr):{},rt="USE_PROFILES"in Ee?Ee.USE_PROFILES:!1,kt=Ee.ALLOW_ARIA_ATTR!==!1,jt=Ee.ALLOW_DATA_ATTR!==!1,yr=Ee.ALLOW_UNKNOWN_PROTOCOLS||!1,Ft=Ee.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Jt=Ee.SAFE_FOR_TEMPLATES||!1,et=Ee.WHOLE_DOCUMENT||!1,lr=Ee.RETURN_DOM||!1,Sr=Ee.RETURN_DOM_FRAGMENT||!1,Or=Ee.RETURN_TRUSTED_TYPE||!1,$r=Ee.FORCE_BODY||!1,se=Ee.SANITIZE_DOM!==!1,_e=Ee.SANITIZE_NAMED_PROPS||!1,Ke=Ee.KEEP_CONTENT!==!1,Be=Ee.IN_PLACE||!1,q=Ee.ALLOWED_URI_REGEXP||q,Vr=Ee.NAMESPACE||Pr,je=Ee.CUSTOM_ELEMENT_HANDLING||{},Ee.CUSTOM_ELEMENT_HANDLING&&xn(Ee.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(je.tagNameCheck=Ee.CUSTOM_ELEMENT_HANDLING.tagNameCheck),Ee.CUSTOM_ELEMENT_HANDLING&&xn(Ee.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(je.attributeNameCheck=Ee.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),Ee.CUSTOM_ELEMENT_HANDLING&&typeof Ee.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(je.allowCustomizedBuiltInElements=Ee.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Jt&&(jt=!1),Sr&&(lr=!0),rt&&(ne=yn({},nl(MY)),ve=[],rt.html===!0&&(yn(ne,IY),yn(ve,DY)),rt.svg===!0&&(yn(ne,u$),yn(ve,h$),yn(ve,ZT)),rt.svgFilters===!0&&(yn(ne,c$),yn(ve,h$),yn(ve,ZT)),rt.mathMl===!0&&(yn(ne,f$),yn(ve,$Y),yn(ve,ZT))),Ee.ADD_TAGS&&(ne===ye&&(ne=_d(ne)),yn(ne,Ee.ADD_TAGS,jr)),Ee.ADD_ATTR&&(ve===ze&&(ve=_d(ve)),yn(ve,Ee.ADD_ATTR,jr)),Ee.ADD_URI_SAFE_ATTR&&yn(ft,Ee.ADD_URI_SAFE_ATTR,jr),Ee.FORBID_CONTENTS&&(Ue===Ve&&(Ue=_d(Ue)),yn(Ue,Ee.FORBID_CONTENTS,jr)),Ke&&(ne["#text"]=!0),et&&yn(ne,["html","head","body"]),ne.table&&(yn(ne,["tbody"]),delete Je.tbody),ga&&ga(Ee),tn=Ee)},zr=yn({},["mi","mo","mn","ms","mtext"]),vo=yn({},["foreignobject","desc","title","annotation-xml"]),ia=yn({},["title","style","font","a","script"]),jo=yn({},u$);yn(jo,c$),yn(jo,F2e);var de=yn({},f$);yn(de,H2e);var Z=function(Ee){var mt=V(Ee);(!mt||!mt.tagName)&&(mt={namespaceURI:Vr,tagName:"template"});var It=aR(Ee.tagName),pr=aR(mt.tagName);return Ir[Ee.namespaceURI]?Ee.namespaceURI===cr?mt.namespaceURI===Pr?It==="svg":mt.namespaceURI===nr?It==="svg"&&(pr==="annotation-xml"||zr[pr]):!!jo[It]:Ee.namespaceURI===nr?mt.namespaceURI===Pr?It==="math":mt.namespaceURI===cr?It==="math"&&vo[pr]:!!de[It]:Ee.namespaceURI===Pr?mt.namespaceURI===cr&&!vo[pr]||mt.namespaceURI===nr&&!zr[pr]?!1:!de[It]&&(ia[It]||!jo[It]):!!(sn==="application/xhtml+xml"&&Ir[Ee.namespaceURI]):!1},Q=function(Ee){Xw(t.removed,{element:Ee});try{Ee.parentNode.removeChild(Ee)}catch{try{Ee.outerHTML=K}catch{Ee.remove()}}},fe=function(Ee,mt){try{Xw(t.removed,{attribute:mt.getAttributeNode(Ee),from:mt})}catch{Xw(t.removed,{attribute:null,from:mt})}if(mt.removeAttribute(Ee),Ee==="is"&&!ve[Ee])if(lr||Sr)try{Q(mt)}catch{}else try{mt.setAttribute(Ee,"")}catch{}},we=function(Ee){var mt,It;if($r)Ee="<remove></remove>"+Ee;else{var pr=N2e(Ee,/^[\r\n\t ]+/);It=pr&&pr[0]}sn==="application/xhtml+xml"&&Vr===Pr&&(Ee='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+Ee+"</body></html>");var or=ee?ee.createHTML(Ee):Ee;if(Vr===Pr)try{mt=new T().parseFromString(or,sn)}catch{}if(!mt||!mt.documentElement){mt=Me.createDocument(Vr,"template",null);try{mt.documentElement.innerHTML=gn?K:or}catch{}}var Nr=mt.body||mt.documentElement;return Ee&&It&&Nr.insertBefore(n.createTextNode(It),Nr.childNodes[0]||null),Vr===Pr?We.call(mt,et?"html":"body")[0]:et?mt.documentElement:Nr},Ae=function(Ee){return He.call(Ee.ownerDocument||Ee,Ee,h.SHOW_ELEMENT|h.SHOW_COMMENT|h.SHOW_TEXT,null,!1)},qe=function(Ee){return Ee instanceof S&&(typeof Ee.nodeName!="string"||typeof Ee.textContent!="string"||typeof Ee.removeChild!="function"||!(Ee.attributes instanceof g)||typeof Ee.removeAttribute!="function"||typeof Ee.setAttribute!="function"||typeof Ee.namespaceURI!="string"||typeof Ee.insertBefore!="function"||typeof Ee.hasChildNodes!="function")},Ge=function(Ee){return $f(s)==="object"?Ee instanceof s:Ee&&$f(Ee)==="object"&&typeof Ee.nodeType=="number"&&typeof Ee.nodeName=="string"},Ie=function(Ee,mt,It){_t[Ee]&&L2e(_t[Ee],function(pr){pr.call(t,mt,It,tn)})},nt=function(Ee){var mt;if(Ie("beforeSanitizeElements",Ee,null),qe(Ee)||sa(/[\u0080-\uFFFF]/,Ee.nodeName))return Q(Ee),!0;var It=jr(Ee.nodeName);if(Ie("uponSanitizeElement",Ee,{tagName:It,allowedTags:ne}),Ee.hasChildNodes()&&!Ge(Ee.firstElementChild)&&(!Ge(Ee.content)||!Ge(Ee.content.firstElementChild))&&sa(/<[/\w]/g,Ee.innerHTML)&&sa(/<[/\w]/g,Ee.textContent)||It==="select"&&sa(/<template/i,Ee.innerHTML))return Q(Ee),!0;if(!ne[It]||Je[It]){if(!Je[It]&&Xt(It)&&(je.tagNameCheck instanceof RegExp&&sa(je.tagNameCheck,It)||je.tagNameCheck instanceof Function&&je.tagNameCheck(It)))return!1;if(Ke&&!Ue[It]){var pr=V(Ee)||Ee.parentNode,or=z(Ee)||Ee.childNodes;if(or&&pr)for(var Nr=or.length,Lr=Nr-1;Lr>=0;--Lr)pr.insertBefore($(or[Lr],!0),j(Ee))}return Q(Ee),!0}return Ee instanceof a&&!Z(Ee)||(It==="noscript"||It==="noembed")&&sa(/<\/no(script|embed)/i,Ee.innerHTML)?(Q(Ee),!0):(Jt&&Ee.nodeType===3&&(mt=Ee.textContent,mt=el(mt,$e," "),mt=el(mt,Fe," "),mt=el(mt,At," "),Ee.textContent!==mt&&(Xw(t.removed,{element:Ee.cloneNode()}),Ee.textContent=mt)),Ie("afterSanitizeElements",Ee,null),!1)},Ct=function(Ee,mt,It){if(se&&(mt==="id"||mt==="name")&&(It in n||It in ei))return!1;if(!(jt&&!xt[mt]&&sa(Gt,mt))){if(!(kt&&sa(ae,mt))){if(!ve[mt]||xt[mt]){if(!(Xt(Ee)&&(je.tagNameCheck instanceof RegExp&&sa(je.tagNameCheck,Ee)||je.tagNameCheck instanceof Function&&je.tagNameCheck(Ee))&&(je.attributeNameCheck instanceof RegExp&&sa(je.attributeNameCheck,mt)||je.attributeNameCheck instanceof Function&&je.attributeNameCheck(mt))||mt==="is"&&je.allowCustomizedBuiltInElements&&(je.tagNameCheck instanceof RegExp&&sa(je.tagNameCheck,It)||je.tagNameCheck instanceof Function&&je.tagNameCheck(It))))return!1}else if(!ft[mt]){if(!sa(q,el(It,U,""))){if(!((mt==="src"||mt==="xlink:href"||mt==="href")&&Ee!=="script"&&B2e(It,"data:")===0&&st[Ee])){if(!(yr&&!sa(D,el(It,U,"")))){if(It)return!1}}}}}}return!0},Xt=function(Ee){return Ee.indexOf("-")>0},Dt=function(Ee){var mt,It,pr,or;Ie("beforeSanitizeAttributes",Ee,null);var Nr=Ee.attributes;if(Nr){var Lr={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:ve};for(or=Nr.length;or--;){mt=Nr[or];var oa=mt,Gn=oa.name,yt=oa.namespaceURI;if(It=Gn==="value"?mt.value:j2e(mt.value),pr=jr(Gn),Lr.attrName=pr,Lr.attrValue=It,Lr.keepAttr=!0,Lr.forceKeepAttr=void 0,Ie("uponSanitizeAttribute",Ee,Lr),It=Lr.attrValue,!Lr.forceKeepAttr&&(fe(Gn,Ee),!!Lr.keepAttr)){if(!Ft&&sa(/\/>/i,It)){fe(Gn,Ee);continue}Jt&&(It=el(It,$e," "),It=el(It,Fe," "),It=el(It,At," "));var Sa=jr(Ee.nodeName);if(Ct(Sa,pr,It)){if(_e&&(pr==="id"||pr==="name")&&(fe(Gn,Ee),It=Re+It),ee&&$f(R)==="object"&&typeof R.getAttributeType=="function"&&!yt)switch(R.getAttributeType(Sa,pr)){case"TrustedHTML":It=ee.createHTML(It);break;case"TrustedScriptURL":It=ee.createScriptURL(It);break}try{yt?Ee.setAttributeNS(yt,Gn,It):Ee.setAttribute(Gn,It),AY(t.removed)}catch{}}}}Ie("afterSanitizeAttributes",Ee,null)}},_r=function Tt(Ee){var mt,It=Ae(Ee);for(Ie("beforeSanitizeShadowDOM",Ee,null);mt=It.nextNode();)Ie("uponSanitizeShadowNode",mt,null),!nt(mt)&&(mt.content instanceof i&&Tt(mt.content),Dt(mt));Ie("afterSanitizeShadowDOM",Ee,null)};return t.sanitize=function(Tt){var Ee=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},mt,It,pr,or,Nr;if(gn=!Tt,gn&&(Tt="<!-->"),typeof Tt!="string"&&!Ge(Tt)){if(typeof Tt.toString!="function")throw l$("toString is not a function");if(Tt=Tt.toString(),typeof Tt!="string")throw l$("dirty is not a string, aborting")}if(!t.isSupported){if($f(e.toStaticHTML)==="object"||typeof e.toStaticHTML=="function"){if(typeof Tt=="string")return e.toStaticHTML(Tt);if(Ge(Tt))return e.toStaticHTML(Tt.outerHTML)}return Tt}if(wr||ln(Ee),t.removed=[],typeof Tt=="string"&&(Be=!1),Be){if(Tt.nodeName){var Lr=jr(Tt.nodeName);if(!ne[Lr]||Je[Lr])throw l$("root node is forbidden and cannot be sanitized in-place")}}else if(Tt instanceof s)mt=we("<!---->"),It=mt.ownerDocument.importNode(Tt,!0),It.nodeType===1&&It.nodeName==="BODY"||It.nodeName==="HTML"?mt=It:mt.appendChild(It);else{if(!lr&&!Jt&&!et&&Tt.indexOf("<")===-1)return ee&&Or?ee.createHTML(Tt):Tt;if(mt=we(Tt),!mt)return lr?null:Or?K:""}mt&&$r&&Q(mt.firstChild);for(var oa=Ae(Be?Tt:mt);pr=oa.nextNode();)pr.nodeType===3&&pr===or||nt(pr)||(pr.content instanceof i&&_r(pr.content),Dt(pr),or=pr);if(or=null,Be)return Tt;if(lr){if(Sr)for(Nr=Ne.call(mt.ownerDocument);mt.firstChild;)Nr.appendChild(mt.firstChild);else Nr=mt;return(ve.shadowroot||ve.shadowrootmod)&&(Nr=gt.call(r,Nr,!0)),Nr}var Gn=et?mt.outerHTML:mt.innerHTML;return et&&ne["!doctype"]&&mt.ownerDocument&&mt.ownerDocument.doctype&&mt.ownerDocument.doctype.name&&sa(Z2e,mt.ownerDocument.doctype.name)&&(Gn="<!DOCTYPE "+mt.ownerDocument.doctype.name+`>
`+Gn),Jt&&(Gn=el(Gn,$e," "),Gn=el(Gn,Fe," "),Gn=el(Gn,At," ")),ee&&Or?ee.createHTML(Gn):Gn},t.setConfig=function(Tt){ln(Tt),wr=!0},t.clearConfig=function(){tn=null,wr=!1},t.isValidAttribute=function(Tt,Ee,mt){tn||ln({});var It=jr(Tt),pr=jr(Ee);return Ct(It,pr,mt)},t.addHook=function(Tt,Ee){typeof Ee=="function"&&(_t[Tt]=_t[Tt]||[],Xw(_t[Tt],Ee))},t.removeHook=function(Tt){if(_t[Tt])return AY(_t[Tt])},t.removeHooks=function(Tt){_t[Tt]&&(_t[Tt]=[])},t.removeAllHooks=function(){_t={}},t}var eLe=Hoe();function xc(e){return e[0].toUpperCase()+e.substr(1)}function Voe(){function e(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return e()+e()+e()+e()}function Uoe(e){return/^([0-9][0-9]?%$)|(^100%$)/.test(e)}function Woe(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return"".concat(e).replace(/(?:\\)?\[([^[\]]+)]/g,function(r,n){return r.charAt(0)==="\\"?r.substr(1,r.length-1):t[n]===void 0?"":t[n]})}function LY(e){return t3("".concat(e),{ALLOWED_TAGS:[]})}function t3(e,t){return eLe.sanitize(e,t)}function NY(e){return iLe(e)||nLe(e)||rLe(e)||tLe()}function tLe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function rLe(e,t){if(e){if(typeof e=="string")return EN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return EN(e,t)}}function nLe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function iLe(e){if(Array.isArray(e))return EN(e)}function EN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function oLe(e){for(var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=-1,n=null,i=e;i!==null;){if(r===t){n=i;break}i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:(r+=1,i=i.parentNode)}return n}function aLe(e){return Object.getPrototypeOf(e.parent)&&e.frameElement}function xk(e){return aLe(e)&&e.parent}function Sp(e){for(var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0,n=Node,i=n.ELEMENT_NODE,o=n.DOCUMENT_FRAGMENT_NODE,s=e;s!=null&&s!==r;){var a=s,h=a.nodeType,p=a.nodeName;if(h===i&&(t.includes(p)||t.includes(s)))return s;var g=s,S=g.host;S&&h===o?s=S:s=s.parentNode}return null}function JT(e,t,r){for(var n=[],i=e;i&&(i=Sp(i,t,r),!(!i||r&&!r.contains(i)));)n.push(i),i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:i=i.parentNode;var o=n.length;return o?n[o-1]:null}function xp(e,t){var r=e.parentNode,n=[];for(typeof t=="string"?e.defaultView?n=Array.prototype.slice.call(e.querySelectorAll(t),0):n=Array.prototype.slice.call(e.ownerDocument.querySelectorAll(t),0):n.push(t);r!==null;){if(n.indexOf(r)>-1)return!0;r=r.parentNode}return!1}function sLe(e){var t=0,r=e;if(r.previousSibling)for(;r=r.previousSibling;)t+=1;return t}function bd(e,t,r){var n=r.parentElement.querySelector(".ht_clone_".concat(e));return n?n.contains(t):null}var TN,ON,RN;function QT(e){return!e||!e.length?[]:e.filter(function(t){return!!t})}if(b2e()){var BY=function(t){var r=t.createElement("div");return r.classList.add("test","test2"),r.classList.contains("test2")};TN=function(t,r){return t.classList===void 0||typeof r!="string"||r===""?!1:t.classList.contains(r)},ON=function(t,r){var n=t.ownerDocument,i=r;if(typeof i=="string"&&(i=i.split(" ")),i=QT(i),i.length>0)if(BY(n)){var o;(o=t.classList).add.apply(o,NY(i))}else for(var s=0;i[s];)t.classList.add(i[s]),s+=1},RN=function(t,r){var n=t.ownerDocument,i=r;if(typeof i=="string"&&(i=i.split(" ")),i=QT(i),i.length>0)if(BY(n)){var o;(o=t.classList).remove.apply(o,NY(i))}else for(var s=0;i[s];)t.classList.remove(i[s]),s+=1}}else{var d$=function(t){return new RegExp("(\\s|^)".concat(t,"(\\s|$)"))};TN=function(t,r){return t.className!==void 0&&d$(r).test(t.className)},ON=function(t,r){var n=t.className,i=r;if(typeof i=="string"&&(i=i.split(" ")),i=QT(i),n==="")n=i.join(" ");else for(var o=0;o<i.length;o++)i[o]&&!d$(i[o]).test(n)&&(n+=" ".concat(i[o]));t.className=n},RN=function(t,r){var n=0,i=t.className,o=r;for(typeof o=="string"&&(o=o.split(" ")),o=QT(o);o[n];)i=i.replace(d$(o[n])," ").trim(),n+=1;t.className!==i&&(t.className=i)}}function Ur(e,t){return TN(e,t)}function Ht(e,t){ON(e,t)}function Kr(e,t){RN(e,t)}function Goe(e){if(e.nodeType===3)e.parentNode.removeChild(e);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(e.nodeName)>-1)for(var t=e.childNodes,r=t.length-1;r>=0;r--)Goe(t[r])}function uu(e){for(var t;t=e.lastChild;)e.removeChild(t)}var lLe=/(<(.*)>|&(.*);)/;function ib(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;lLe.test(t)?e.innerHTML=r?t3(t):t:Ap(e,t)}function Ap(e,t){var r=e.firstChild;r&&r.nodeType===3&&r.nextSibling===null?w2e?r.textContent=t:r.data=t:(uu(e),e.appendChild(e.ownerDocument.createTextNode(t)))}function OS(e){for(var t=e.ownerDocument.documentElement,r=e;r!==t;){if(r===null)return!1;if(r.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(r.host){if(r.host.impl)return OS(r.host.impl);if(r.host)return OS(r.host);throw new Error("Lost in Web Components world")}else return!1;else if(r.style&&r.style.display==="none")return!1;r=r.parentNode}return!0}function io(e){var t=e.ownerDocument,r=t.defaultView,n=t.documentElement,i=e,o,s,a,h;if(zoe()&&i.firstChild&&i.firstChild.nodeName==="CAPTION")return h=i.getBoundingClientRect(),{top:h.top+(r.pageYOffset||n.scrollTop)-(n.clientTop||0),left:h.left+(r.pageXOffset||n.scrollLeft)-(n.clientLeft||0)};for(o=i.offsetLeft,s=i.offsetTop,a=i;(i=i.offsetParent)&&i!==t.body;)o+=i.offsetLeft,s+=i.offsetTop,a=i;return a&&a.style.position==="fixed"&&(o+=r.pageXOffset||n.scrollLeft,s+=r.pageYOffset||n.scrollTop),{left:o,top:s}}function RS(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,t=e.scrollY;return t===void 0&&(t=e.document.documentElement.scrollTop),t}function zg(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,t=e.scrollX;return t===void 0&&(t=e.document.documentElement.scrollLeft),t}function Ck(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return e===t?RS(t):e.scrollTop}function kN(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return e===t?zg(t):e.scrollLeft}function Ek(e){var t=e.ownerDocument,r=t?t.defaultView:void 0;t||(t=e.document?e.document:e,r=t.defaultView);for(var n=["auto","scroll"],i=S2e(),o=e.parentNode;o&&o.style&&t.body!==o;){var s=o.style,a=s.overflow,h=s.overflowX,p=s.overflowY;if([a,h,p].includes("scroll"))return o;if(i){var g=r.getComputedStyle(o);if(a=g.overflow,h=g.overflowX,p=g.overflowY,n.includes(a)||n.includes(h)||n.includes(p))return o}if(o.clientHeight<=o.scrollHeight+1&&(n.includes(p)||n.includes(a))||o.clientWidth<=o.scrollWidth+1&&(n.includes(h)||n.includes(a)))return o;o=o.parentNode}return r}function kS(e){for(var t=e.ownerDocument,r=t.defaultView,n=e.parentNode;n&&n.style&&t.body!==n;){if(n.style.overflow!=="visible"&&n.style.overflow!=="")return n;var i=Ip(n,r),o=["scroll","hidden","auto"],s=i.getPropertyValue("overflow"),a=i.getPropertyValue("overflow-y"),h=i.getPropertyValue("overflow-x");if(o.includes(s)||o.includes(a)||o.includes(h))return n;n=n.parentNode}return r}function PS(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(e){if(e===r)return t==="width"?"".concat(r.innerWidth,"px"):t==="height"?"".concat(r.innerHeight,"px"):void 0}else return;var n=e.style[t];if(n!==""&&n!==void 0)return n;var i=Ip(e,r);if(i[t]!==""&&i[t]!==void 0)return i[t]}function Ip(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return e.currentStyle||t.getComputedStyle(e)}function ri(e){return e.offsetWidth}function $i(e){return zoe()&&e.firstChild&&e.firstChild.nodeName==="CAPTION"?e.offsetHeight+e.firstChild.offsetHeight:e.offsetHeight}function Vf(e){return e.clientHeight||e.innerHeight}function sR(e){return e.clientWidth||e.innerWidth}function Yoe(e){var t=e.ownerDocument;if(e.selectionStart)return e.selectionStart;if(t.selection){e.focus();var r=t.selection.createRange();if(r===null)return 0;var n=e.createTextRange(),i=n.duplicate();return n.moveToBookmark(r.getBookmark()),i.setEndPoint("EndToStart",n),i.text.length}return 0}function uLe(e){var t=e.ownerDocument;if(e.selectionEnd)return e.selectionEnd;if(t.selection){var r=t.selection.createRange();if(r===null)return 0;var n=e.createTextRange();return n.text.indexOf(r.text)+r.text.length}return 0}function cLe(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,t=e.document,r="";return e.getSelection?r=e.getSelection().toString():t.selection&&t.selection.type!=="Control"&&(r=t.selection.createRange().text),r}function jY(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,t=e.document;e.getSelection?e.getSelection().empty?e.getSelection().empty():e.getSelection().removeAllRanges&&e.getSelection().removeAllRanges():t.selection&&t.selection.empty()}function PA(e,t,r){if(r===void 0&&(r=t),e.setSelectionRange){e.focus();try{e.setSelectionRange(t,r)}catch{var n=e.parentNode,i=n.style.display;n.style.display="block",e.setSelectionRange(t,r),n.style.display=i}}}var p$;function fLe(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document,t=e.createElement("div");t.style.height="200px",t.style.width="100%";var r=e.createElement("div");r.style.boxSizing="content-box",r.style.height="150px",r.style.left="0px",r.style.overflow="hidden",r.style.position="absolute",r.style.top="0px",r.style.width="200px",r.style.visibility="hidden",r.appendChild(t),(e.body||e.documentElement).appendChild(r);var n=t.offsetWidth;r.style.overflow="scroll";var i=t.offsetWidth;return n===i&&(i=r.clientWidth),(e.body||e.documentElement).removeChild(r),n-i}function Ao(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return p$===void 0&&(p$=fLe(e)),p$}function hLe(e){return e.offsetWidth!==e.clientWidth}function dLe(e){return e.offsetHeight!==e.clientHeight}function r3(e,t,r){L$e()?(e.style.top=r,e.style.left=t):M$e()?e.style["-webkit-transform"]="translate3d(".concat(t,",").concat(r,",0)"):e.style.transform="translate3d(".concat(t,",").concat(r,",0)")}function AA(e){e.style.transform&&e.style.transform!==""?e.style.transform="":e.style["-webkit-transform"]&&e.style["-webkit-transform"]!==""&&(e.style["-webkit-transform"]="")}function Tk(e){var t=["INPUT","SELECT","TEXTAREA"];return e&&(t.indexOf(e.nodeName)>-1||e.contentEditable==="true")}function n3(e){return Tk(e)&&e.hasAttribute("data-hot-input")===!1}function pLe(e){var t=e.ownerDocument.activeElement;n3(t)||e.select()}function Koe(e){return!e.parentNode}function mLe(e,t){var r=new IntersectionObserver(function(n,i){n.forEach(function(o){o.isIntersecting&&e.offsetParent!==null&&(t(),i.unobserve(e))})},{root:e.ownerDocument.body});r.observe(e)}var yLe=nA,gLe=Toe;yLe("Map",function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},gLe);var vLe=Ji,_Le=eb,bLe=TypeError,wLe=Object.getOwnPropertyDescriptor,SLe=vLe&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(e){return e instanceof TypeError}}(),xLe=SLe?function(e,t){if(_Le(e)&&!wLe(e,"length").writable)throw bLe("Cannot set read only .length");return e.length=t}:function(e,t){return e.length=t},CLe=Br,ELe=Ha,TLe=zx,OLe=wh,RLe=Ns,kLe=xLe,PLe=Soe,ALe=lH,ILe=Q_,m$=Rne,MLe=eC,DLe=MLe("splice"),$Le=Math.max,LLe=Math.min;CLe({target:"Array",proto:!0,forced:!DLe},{splice:function(t,r){var n=ELe(this),i=RLe(n),o=TLe(t,i),s=arguments.length,a,h,p,g,S,T;for(s===0?a=h=0:s===1?(a=0,h=i-o):(a=s-2,h=LLe($Le(OLe(r),0),i-o)),PLe(i+a-h),p=ALe(n,h),g=0;g<h;g++)S=o+g,S in n&&ILe(p,g,n[S]);if(p.length=h,a<h){for(g=o;g<i-h;g++)S=g+h,T=g+a,S in n?n[T]=n[S]:m$(n,T);for(g=i;g>i-h+a;g--)m$(n,g-1)}else if(a>h)for(g=i-h;g>o;g--)S=g+h-1,T=g+a-1,S in n?n[T]=n[S]:m$(n,T);for(g=0;g<a;g++)n[g+o]=arguments[g+2];return kLe(n,i-h+a),p}});function ti(){if(dr(console)){var e;(e=console).warn.apply(e,arguments)}}function i3(){if(dr(console)){var e;(e=console).error.apply(e,arguments)}}var NLe=typeof Bun=="function"&&Bun&&typeof Bun.version=="string",BLe=TypeError,qoe=function(e,t){if(e<t)throw BLe("Not enough arguments");return e},Xoe=ni,jLe=tm,zLe=vi,FLe=NLe,HLe=Kp,VLe=nC,ULe=qoe,WLe=Xoe.Function,GLe=/MSIE .\./.test(HLe)||FLe&&function(){var e=Xoe.Bun.version.split(".");return e.length<3||e[0]==0&&(e[1]<3||e[1]==3&&e[2]==0)}(),o3=function(e,t){var r=t?2:1;return GLe?function(n,i){var o=ULe(arguments.length,1)>r,s=zLe(n)?n:WLe(n),a=o?VLe(arguments,r):[],h=o?function(){jLe(s,this,a)}:s;return t?e(h,i):e(h)}:e},YLe=Br,Zoe=ni,KLe=o3,zY=KLe(Zoe.setInterval,!0);YLe({global:!0,bind:!0,forced:Zoe.setInterval!==zY},{setInterval:zY});var qLe=Br,Joe=ni,XLe=o3,FY=XLe(Joe.setTimeout,!0);qLe({global:!0,bind:!0,forced:Joe.setTimeout!==FY},{setTimeout:FY});var ZLe=Br,JLe=an,QLe=eb,eNe=JLe([].reverse),HY=[1,2];ZLe({target:"Array",proto:!0,forced:String(HY)===String(HY.reverse())},{reverse:function(){return QLe(this)&&(this.length=this.length),eNe(this)}});function ci(e){return typeof e=="function"}function Qoe(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,r=null,n;function i(){for(var o=this,s=arguments.length,a=new Array(s),h=0;h<s;h++)a[h]=arguments[h];return r&&clearTimeout(r),r=setTimeout(function(){n=e.apply(o,a)},t),n}return i}function eae(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return e.apply(this,r.concat(s))}}function tNe(e){var t=e.length;function r(n){return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];var h=n.concat(s),p;return h.length>=t?p=e.apply(this,h):p=r(h),p}}return r([])}function PN(e,t,r,n,i,o,s,a){return dr(a)?e.call(t,r,n,i,o,s,a):dr(s)?e.call(t,r,n,i,o,s):dr(o)?e.call(t,r,n,i,o):dr(i)?e.call(t,r,n,i):dr(n)?e.call(t,r,n):dr(r)?e.call(t,r):e.call(t)}function AS(e){"@babel/helpers - typeof";return AS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},AS(e)}var VY;function rNe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function UY(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,iNe(n.key),n)}}function nNe(e,t,r){return t&&UY(e.prototype,t),r&&UY(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function iNe(e){var t=oNe(e,"string");return AS(t)==="symbol"?t:String(t)}function oNe(e,t){if(AS(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(AS(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function aNe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var yy=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterScrollHorizontally","afterScrollVertically","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeSetCellMeta","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyRowHeader","modifyRowHeight","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","beforeAutofillInsidePopulate","modifyTransformStart","modifyTransformEnd","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],sNe=Xn(VY||(VY=aNe([`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion]. 
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to 
  learn about the migration path.`],[`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\\x20
  learn about the migration path.`]))),y$=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),g$=new Map([["beforeAutofillInsidePopulate",'The plugin hook "beforeAutofillInsidePopulate" is deprecated and will be removed in the next major release.']]),tae=function(){function e(){rNe(this,e),this.globalBucket=this.createEmptyBucket()}return nNe(e,[{key:"createEmptyBucket",value:function(){var r=Object.create(null);return Le(yy,function(n){return r[n]=[]}),r}},{key:"getBucket",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return r?(r.pluginHookBucket||(r.pluginHookBucket=this.createEmptyBucket()),r.pluginHookBucket):this.globalBucket}},{key:"add",value:function(r,n){var i=this,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;if(Array.isArray(n))Le(n,function(h){return i.add(r,h,o)});else{y$.has(r)&&ti(Woe(sNe,{hookName:r,removedInVersion:y$.get(r)})),g$.has(r)&&ti(g$.get(r));var s=this.getBucket(o);if(typeof s[r]>"u"&&(this.register(r),s[r]=[]),n.skip=!1,s[r].indexOf(n)===-1){var a=!1;n.initialHook&&Le(s[r],function(h,p){if(h.initialHook)return s[r][p]=n,a=!0,!1}),a||s[r].push(n)}}return this}},{key:"once",value:function(r,n){var i=this,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;Array.isArray(n)?Le(n,function(s){return i.once(r,s,o)}):(n.runOnce=!0,this.add(r,n,o))}},{key:"remove",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,o=this.getBucket(i);return typeof o[r]<"u"&&o[r].indexOf(n)>=0?(n.skip=!0,!0):!1}},{key:"has",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,i=this.getBucket(n);return!!(i[r]!==void 0&&i[r].length)}},{key:"run",value:function(r,n,i,o,s,a,h,p){{var g=this.globalBucket[n],S=g?g.length:0,T=0;if(S)for(;T<S;){if(!g[T]||g[T].skip){T+=1;continue}var R=PN(g[T],r,i,o,s,a,h,p);R!==void 0&&(i=R),g[T]&&g[T].runOnce&&this.remove(n,g[T]),T+=1}}{var A=this.getBucket(r)[n],$=A?A.length:0,j=0;if($)for(;j<$;){if(!A[j]||A[j].skip){j+=1;continue}var z=PN(A[j],r,i,o,s,a,h,p);z!==void 0&&(i=z),A[j]&&A[j].runOnce&&this.remove(n,A[j],r),j+=1}}return i}},{key:"destroy",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;pn(this.getBucket(r),function(n,i,o){return o[i].length=0})}},{key:"register",value:function(r){this.isRegistered(r)||yy.push(r)}},{key:"deregister",value:function(r){this.isRegistered(r)&&yy.splice(yy.indexOf(r),1)}},{key:"isDeprecated",value:function(r){return g$.has(r)||y$.has(r)}},{key:"isRegistered",value:function(r){return yy.indexOf(r)>=0}},{key:"getRegistered",value:function(){return yy}}],[{key:"getSingleton",value:function(){return uNe()}}]),e}(),lNe=new tae;function uNe(){return lNe}const mr=tae;function WY(e){return dNe(e)||hNe(e)||fNe(e)||cNe()}function cNe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function fNe(e,t){if(e){if(typeof e=="string")return AN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return AN(e,t)}}function hNe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function dNe(e){if(Array.isArray(e))return AN(e)}function AN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var v$=new Map;function Fs(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";v$.has(e)||v$.set(e,new Map);var t=v$.get(e);function r(a,h){t.set(a,h)}function n(a){return t.get(a)}function i(a){return t.has(a)}function o(){return WY(t.keys())}function s(){return WY(t.values())}return{register:r,getItem:n,hasItem:i,getNames:o,getValues:s}}var IN=new WeakMap,fC=Fs("editors"),pNe=fC.register,rae=fC.getItem,nae=fC.hasItem;fC.getNames;fC.getValues;function mNe(e){var t={},r=e;this.getConstructor=function(){return e},this.getInstance=function(n){return n.guid in t||(t[n.guid]=new r(n)),t[n.guid]},mr.getSingleton().add("afterDestroy",function(){t[this.guid]=null})}function iae(e,t){var r;if(typeof e=="function")IN.get(e)||Qa(null,e),r=IN.get(e);else if(typeof e=="string")r=rae(e);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!r)throw Error('No editor registered under name "'.concat(e,'"'));return r.getInstance(t)}function GY(e){if(typeof e=="function")return e;if(!nae(e))throw Error('No registered editor found under "'.concat(e,'" name'));return rae(e).getConstructor()}function Qa(e,t){e&&typeof e!="string"&&(t=e,e=t.EDITOR_TYPE);var r=new mNe(t);typeof e=="string"&&pNe(e,r),IN.set(t,r)}function IS(e){"@babel/helpers - typeof";return IS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},IS(e)}function yNe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function YY(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,vNe(n.key),n)}}function gNe(e,t,r){return t&&YY(e.prototype,t),r&&YY(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function vNe(e){var t=_Ne(e,"string");return IS(t)==="symbol"?t:String(t)}function _Ne(e,t){if(IS(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(IS(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var bNe=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;yNe(this,e),this.context=t||this,this.context.eventListeners||(this.context.eventListeners=[])}return gNe(e,[{key:"addEventListener",value:function(r,n,i){var o=this,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function a(h){i.call(this,wNe(h))}return typeof s!="boolean"&&!E2e()&&(s=!1),this.context.eventListeners.push({element:r,event:n,callback:i,callbackProxy:a,options:s,eventManager:this}),r.addEventListener(n,a,s),function(){o.removeEventListener(r,n,i)}}},{key:"removeEventListener",value:function(r,n,i){for(var o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,s=this.context.eventListeners.length,a;s;)if(s-=1,a=this.context.eventListeners[s],a.event===n&&a.element===r){if(i&&i!==a.callback||o&&a.eventManager!==this)continue;this.context.eventListeners.splice(s,1),a.element.removeEventListener(a.event,a.callbackProxy,a.options)}}},{key:"clearEvents",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.context)for(var n=this.context.eventListeners.length;n;){n-=1;var i=this.context.eventListeners[n];r&&i.eventManager!==this||(this.context.eventListeners.splice(n,1),i.element.removeEventListener(i.event,i.callbackProxy,i.options))}}},{key:"clear",value:function(){this.clearEvents()}},{key:"destroy",value:function(){this.clearEvents(),this.context=null}},{key:"destroyWithOwnEventsOnly",value:function(){this.clearEvents(!0),this.context=null}},{key:"fireEvent",value:function(r,n){var i=r.document,o=r;i||(i=r.ownerDocument?r.ownerDocument:r,o=i.defaultView);var s={bubbles:!0,cancelable:n!=="mousemove",view:o,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0},a;i.createEvent?(a=i.createEvent("MouseEvents"),a.initMouseEvent(n,s.bubbles,s.cancelable,s.view,s.detail,s.screenX,s.screenY,s.clientX,s.clientY,s.ctrlKey,s.altKey,s.shiftKey,s.metaKey,s.button,i.body.parentNode)):a=i.createEventObject(),r.dispatchEvent?r.dispatchEvent(a):r.fireEvent("on".concat(n),a)}}]),e}();function wNe(e){var t=e.stopImmediatePropagation;return e.stopImmediatePropagation=function(){t.apply(this),lu(this)},e}const Bi=bNe;function MS(e){"@babel/helpers - typeof";return MS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},MS(e)}function SNe(e,t){return TNe(e)||ENe(e,t)||CNe(e,t)||xNe()}function xNe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function CNe(e,t){if(e){if(typeof e=="string")return KY(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return KY(e,t)}}function KY(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ENe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],h=!0,p=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;h=!1}else for(;!(h=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);h=!0);}catch(g){p=!0,i=g}finally{try{if(!h&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(p)throw i}}return a}}function TNe(e){if(Array.isArray(e))return e}function ONe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function qY(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,kNe(n.key),n)}}function RNe(e,t,r){return t&&qY(e.prototype,t),r&&qY(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function kNe(e){var t=PNe(e,"string");return MS(t)==="symbol"?t:String(t)}function PNe(e,t){if(MS(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(MS(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var IA="editorManager.navigation",H0="editorManager.handlingEditor",MN=function(){function e(t,r,n){var i=this;ONe(this,e),this.instance=t,this.tableMeta=r,this.selection=n,this.eventManager=new Bi(t),this.destroyed=!1,this.lock=!1,this.activeEditor=void 0,this.cellProperties=void 0;var o=this.instance.getShortcutManager();o.addContext("editor"),this.registerShortcuts(),this.instance.addHook("afterDocumentKeyDown",function(s){return i.onAfterDocumentKeyDown(s)}),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"compositionstart",function(s){!i.destroyed&&i.instance.isListening()&&i.openEditor("",s)}),this.instance.view._wt.update("onCellDblClick",function(s,a,h){return i.onCellDblClick(s,a,h)})}return RNe(e,[{key:"registerShortcuts",value:function(){var r=this,n=this.instance.getShortcutManager(),i=n.getContext("grid"),o=n.getContext("editor"),s={group:H0};o.addShortcuts([{keys:[["Enter"],["Enter","Shift"],["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],callback:function(h,p){r.closeEditorAndSaveChanges(n.isCtrlPressed()),r.moveSelectionAfterEnter(p.includes("shift"))}},{keys:[["Escape"],["Escape","Control/Meta"]],callback:function(){r.closeEditorAndRestoreOriginalValue(n.isCtrlPressed()),r.activeEditor.focus()}}],s),i.addShortcuts([{keys:[["F2"]],callback:function(h){r.openEditor(null,h,!0)}},{keys:[["Backspace"],["Delete"]],callback:function(){r.instance.emptySelectedCells(),r.prepareEditor()}},{keys:[["Enter"],["Enter","Shift"]],callback:function(h,p){r.instance.getSettings().enterBeginsEditing?r.cellProperties.readOnly?r.moveSelectionAfterEnter():r.openEditor(null,h,!0):r.moveSelectionAfterEnter(p.includes("shift")),lu(h)}}],s)}},{key:"lockEditor",value:function(){this.lock=!0}},{key:"unlockEditor",value:function(){this.lock=!1}},{key:"destroyEditor",value:function(r){this.lock||this.closeEditor(r)}},{key:"getActiveEditor",value:function(){return this.activeEditor}},{key:"prepareEditor",value:function(){var r=this;if(!this.lock){if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,function($){$&&r.prepareEditor()});return}var n=this.instance.getSelectedRangeLast().highlight,i=n.row,o=n.col,s=this.instance.runHooks("modifyGetCellCoords",i,o),a=i,h=o;if(Array.isArray(s)){var p=SNe(s,2);a=p[0],h=p[1]}this.cellProperties=this.instance.getCellMeta(a,h);var g=this.instance.rootDocument.activeElement;if(g&&n3(g)&&g.blur(),!this.isCellEditable()){this.clearActiveEditor();return}var S=this.instance.getCell(i,o,!0);if(S){var T=this.instance.getCellEditor(this.cellProperties),R=this.instance.colToProp(h),A=this.instance.getSourceDataAtCell(this.instance.toPhysicalRow(a),h);this.activeEditor=iae(T,this.instance),this.activeEditor.prepare(i,o,R,S,A,this.cellProperties)}}}},{key:"isEditorOpened",value:function(){return this.activeEditor&&this.activeEditor.isOpened()}},{key:"openEditor",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}if(!this.activeEditor){var o=this.instance.getSelectedRangeLast().highlight,s=o.row,a=o.col,h=this.instance.rowIndexMapper.getRenderableFromVisualIndex(s),p=this.instance.columnIndexMapper.getRenderableFromVisualIndex(a);this.instance.view.scrollViewport(this.instance._createCellCoords(h,p)),this.instance.view.render(),this.prepareEditor()}this.activeEditor&&(i&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(r,n))}},{key:"closeEditor",value:function(r,n,i){this.activeEditor?this.activeEditor.finishEditing(r,n,i):i&&i(!1)}},{key:"closeEditorAndSaveChanges",value:function(r){this.closeEditor(!1,r)}},{key:"closeEditorAndRestoreOriginalValue",value:function(r){this.closeEditor(!0,r)}},{key:"clearActiveEditor",value:function(){this.activeEditor=void 0}},{key:"isCellEditable",value:function(){var r=this.instance.getCellEditor(this.cellProperties),n=this.instance.getSelectedRangeLast().highlight,i=n.row,o=n.col,s=this.instance,a=s.rowIndexMapper,h=s.columnIndexMapper,p=a.isHidden(this.instance.toPhysicalRow(i))||h.isHidden(this.instance.toPhysicalColumn(o));return!(this.cellProperties.readOnly||!r||p)}},{key:"moveSelectionAfterEnter",value:function(r){var n=typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(event):this.tableMeta.enterMoves;r?this.selection.transformStart(-n.row,-n.col):this.selection.transformStart(n.row,n.col,!0)}},{key:"onAfterDocumentKeyDown",value:function(r){var n=this;if(this.instance.isListening()){var i=r.keyCode;if(this.selection.isSelected()){var o=(r.ctrlKey||r.metaKey)&&!r.altKey;if((!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!Doe(i)&&!j$e(i)&&!o&&!this.isEditorOpened()){var s=this.instance.getShortcutManager(),a=s.getContext("editor"),h={runOnlyIf:function(){return dr(n.instance.getSelected())},group:IA};a.addShortcuts([{keys:[["ArrowUp"]],callback:function(){n.instance.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:function(){n.instance.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:function(){n.instance.selection.transformStart(0,-1*n.instance.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:function(){n.instance.selection.transformStart(0,n.instance.getDirectionFactor())}}],h),this.openEditor("",r)}}}}},{key:"onCellDblClick",value:function(r,n,i){i.nodeName==="TD"&&this.openEditor(null,r,!0)}},{key:"destroy",value:function(){this.destroyed=!0,this.eventManager.destroy()}}]),e}(),XY=new WeakMap;MN.getInstance=function(e,t,r){var n=XY.get(e);return n||(n=new MN(e,t,r),XY.set(e,n)),n};const ANe=MN;var INe="hooksRefRegisterer",oae={_hooksStorage:Object.create(null),addHook:function(t,r){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,r),this._hooksStorage[t].push(r),this},removeHooksByKey:function(t){var r=this;Le(this._hooksStorage[t]||[],function(n){r.hot.removeHook(t,n)})},clearHooks:function(){var t=this;pn(this._hooksStorage,function(r,n){return t.removeHooksByKey(n)}),this._hooksStorage={}}};Bc(oae,"MIXIN_NAME",INe,{writable:!1,enumerable:!1});const MNe=oae;function Fg(e){"@babel/helpers - typeof";return Fg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fg(e)}function DNe(e,t){return BNe(e)||NNe(e,t)||LNe(e,t)||$Ne()}function $Ne(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function LNe(e,t){if(e){if(typeof e=="string")return ZY(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ZY(e,t)}}function ZY(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function NNe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],h=!0,p=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;h=!1}else for(;!(h=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);h=!0);}catch(g){p=!0,i=g}finally{try{if(!h&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(p)throw i}}return a}}function BNe(e){if(Array.isArray(e))return e}function jNe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&DN(e,t)}function DN(e,t){return DN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},DN(e,t)}function zNe(e){var t=VNe();return function(){var n=Ok(e),i;if(t){var o=Ok(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return FNe(this,i)}}function FNe(e,t){if(t&&(Fg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return HNe(e)}function HNe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function VNe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ok(e){return Ok=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ok(e)}function JY(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function QY(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,UNe(n.key),n)}}function eK(e,t,r){return t&&QY(e.prototype,t),r&&QY(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function UNe(e){var t=WNe(e,"string");return Fg(t)==="symbol"?t:String(t)}function WNe(e,t){if(Fg(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Fg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var GNe="base",To=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"}),$N="baseEditor",ob=function(){function e(t){JY(this,e),this.hot=t,this.instance=t,this.state=To.VIRGIN,this._opened=!1,this._fullEditMode=!1,this._closeCallback=null,this.TD=null,this.row=null,this.col=null,this.prop=null,this.originalValue=null,this.cellProperties=null,this.init()}return eK(e,[{key:"_fireCallbacks",value:function(r){this._closeCallback&&(this._closeCallback(r),this._closeCallback=null)}},{key:"init",value:function(){}},{key:"getValue",value:function(){throw Error("Editor getValue() method unimplemented")}},{key:"setValue",value:function(){throw Error("Editor setValue() method unimplemented")}},{key:"open",value:function(){throw Error("Editor open() method unimplemented")}},{key:"close",value:function(){throw Error("Editor close() method unimplemented")}},{key:"prepare",value:function(r,n,i,o,s,a){this.TD=o,this.row=r,this.col=n,this.prop=i,this.originalValue=s,this.cellProperties=a,this.state=To.VIRGIN}},{key:"extend",value:function(){return function(r){jNe(i,r);var n=zNe(i);function i(){return JY(this,i),n.apply(this,arguments)}return eK(i)}(this.constructor)}},{key:"saveValue",value:function(r,n){var i=this,o,s,a,h;if(n){var p=this.hot.getSelectedLast();o=Math.max(Math.min(p[0],p[2]),0),s=Math.max(Math.min(p[1],p[3]),0),a=Math.max(p[0],p[2]),h=Math.max(p[1],p[3])}else{var g=[this.row,this.col,null,null];o=g[0],s=g[1],a=g[2],h=g[3]}var S=this.hot.runHooks("modifyGetCellCoords",o,s);if(Array.isArray(S)){var T=DNe(S,2);o=T[0],s=T[1]}var R=this.hot.getShortcutManager(),A=R.getContext("editor"),$={runOnlyIf:function(){return dr(i.hot.getSelected())},group:$N};this.isInFullEditMode()&&A.addShortcuts([{keys:[["ArrowUp"]],callback:function(){i.hot.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:function(){i.hot.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:function(){i.hot.selection.transformStart(0,-1*i.hot.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:function(){i.hot.selection.transformStart(0,i.hot.getDirectionFactor())}}],$),this.hot.populateFromArray(o,s,r,a,h,"edit")}},{key:"beginEditing",value:function(r,n){if(this.state===To.VIRGIN){var i=this.hot,o=i.rowIndexMapper.getRenderableFromVisualIndex(this.row),s=i.columnIndexMapper.getRenderableFromVisualIndex(this.col);if(i.view.scrollViewport(i._createCellCoords(o,s)),this.state=To.EDITING,this.isInFullEditMode()){var a=typeof r=="string"?r:Xi(this.originalValue);this.setValue(a)}this.open(n),this._opened=!0,this.focus(),i.view.render(),i.runHooks("afterBeginEditing",this.row,this.col)}}},{key:"finishEditing",value:function(r,n,i){var o=this,s;if(i){var a=this._closeCallback;this._closeCallback=function(S){a&&a(S),i(S),o.hot.view.render()}}if(!this.isWaiting()){var h=this.hot.getShortcutManager(),p=h.getContext("editor");if(p.removeShortcutsByGroup($N),p.removeShortcutsByGroup(IA),this.state===To.VIRGIN){this.hot._registerTimeout(function(){o._fireCallbacks(!0)});return}if(this.state===To.EDITING){if(r){this.cancelChanges(),this.hot.view.render();return}var g=this.getValue();this.cellProperties.trimWhitespace?s=[[typeof g=="string"?String.prototype.trim.call(g||""):g]]:s=[[g]],this.state=To.WAITING,this.saveValue(s,n),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",function(S){o.state=To.FINISHED,o.discardEditor(S)}):(this.state=To.FINISHED,this.discardEditor(!0))}}}},{key:"cancelChanges",value:function(){this.state=To.FINISHED,this.discardEditor()}},{key:"discardEditor",value:function(r){if(this.state===To.FINISHED)if(r===!1&&this.cellProperties.allowInvalid!==!0)this.hot.selectCell(this.row,this.col),this.focus(),this.state=To.EDITING,this._fireCallbacks(!1);else{this.close(),this._opened=!1,this._fullEditMode=!1,this.state=To.VIRGIN,this._fireCallbacks(!0);var n=this.hot.getShortcutManager();n.setActiveContextName("grid")}}},{key:"enableFullEditMode",value:function(){this._fullEditMode=!0}},{key:"isInFullEditMode",value:function(){return this._fullEditMode}},{key:"isOpened",value:function(){return this._opened}},{key:"isWaiting",value:function(){return this.state===To.WAITING}},{key:"getEditedCellRect",value:function(){var r,n=this.getEditedCell();if(n){var i=this.hot.view._wt,o=i.wtOverlays,s=i.wtViewport,a=this.hot.rootWindow,h=io(n),p=ri(n),g=io(this.hot.rootElement),S=ri(this.hot.rootElement),T=o.topOverlay.holder,R=o.inlineStartOverlay.holder,A=T!==a?T.scrollTop:0,$=R!==a?R.scrollLeft:0,j=a.innerWidth-g.left-S,z=(r=o.getParentOverlay(n))!==null&&r!==void 0?r:this.hot.view._wt,V=z.wtTable,G=V.name,ee=["master","inline_start"].includes(G)?A:0,K=["master","top","bottom"].includes(G)?$:0,xe=h.top===g.top?0:1,Me=h.top-g.top-xe-ee,He=0;this.hot.isRtl()?He=a.innerWidth-h.left-p-j-1+K:He=h.left-g.left-1-K,["top","top_inline_start_corner"].includes(G)&&(Me+=o.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(G)&&(He+=Math.abs(o.inlineStartOverlay.getOverlayOffset()));var Ne=this.hot.hasColHeaders(),We=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),gt=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),Lt=this.hot.rowIndexMapper.getRenderableIndexesLength(),_t=Lt-this.hot.view._wt.getSetting("fixedRowsBottom");(Ne&&We<=0||We===_t)&&(Me+=1),gt<=0&&(He+=1);var $e=s.rowsRenderCalculator.startPosition,Fe=s.columnsRenderCalculator.startPosition,At=Math.abs(o.inlineStartOverlay.getScrollPosition()),Gt=o.topOverlay.getScrollPosition(),ae=Ao(this.hot.rootDocument),D=n.offsetTop+$e-Gt,U=0;if(this.hot.isRtl()){var q=n.offsetLeft;q>=0?U=V.getWidth()-n.offsetLeft:U=Math.abs(q),U+=Fe-At-p}else U=n.offsetLeft+Fe-At;var ne=Ip(this.TD,this.hot.rootWindow),ye=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",ve=parseInt(ne[ye],10)>0?0:1,ze=parseInt(ne.borderTopWidth,10)>0?0:1,je=ri(n)+ve,Je=$i(n)+ze,xt=hLe(T)?ae:0,kt=dLe(R)?ae:0,jt=this.hot.view.maximumVisibleElementWidth(U)-xt+ve,yr=Math.max(this.hot.view.maximumVisibleElementHeight(D)-kt+ze,23);return{top:Me,start:He,height:Je,maxHeight:yr,width:je,maxWidth:jt}}}},{key:"getEditedCellsLayerClass",value:function(){var r=this.checkEditorSection();switch(r){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}},{key:"getEditedCell",value:function(){return this.hot.getCell(this.row,this.col,!0)}},{key:"checkEditorSection",value:function(){var r=this.hot.countRows(),n="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?n="top-inline-start-corner":n="top":this.hot.getSettings().fixedRowsBottom&&this.row>=r-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?n="bottom-inline-start-corner":n="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(n="inline-start"),n}}],[{key:"EDITOR_TYPE",get:function(){return GNe}}]),e}();li(ob,MNe);var YNe=Br,KNe=em.map,qNe=eC,XNe=qNe("map");YNe({target:"Array",proto:!0,forced:!XNe},{map:function(t){return KNe(this,t,arguments.length>1?arguments[1]:void 0)}});function ZNe(e){return tBe(e)||eBe(e)||QNe(e)||JNe()}function JNe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function QNe(e,t){if(e){if(typeof e=="string")return LN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return LN(e,t)}}function eBe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function tBe(e){if(Array.isArray(e))return LN(e)}function LN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function NN(e){"@babel/helpers - typeof";return NN=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},NN(e)}function ks(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=NN(e);if(r==="number")return!isNaN(e)&&isFinite(e);if(r==="string"){if(e.length===0)return!1;if(e.length===1)return/\d/.test(e);var n=Array.from(new Set(["."].concat(ZNe(t)))).map(function(i){return"\\".concat(i)}).join("|");return new RegExp("^[+-]?\\s*(((".concat(n,")?\\d+((").concat(n,")\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$"),"i").test(e.trim())}else if(r==="object")return!!e&&typeof e.valueOf()=="number"&&!(e instanceof Date);return!1}function rBe(e){return ks(e,[","])}function Er(e,t,r){var n=-1;for(typeof t=="function"?(r=t,t=e):n=e-1;++n<=t&&r(n)!==!1;);}function BN(e,t,r){var n=e+1;for(typeof t=="function"&&(r=t,t=0);--n>=t&&r(n)!==!1;);}function aae(e,t){return t=parseInt(t.toString().replace("%",""),10),t=isNaN(t)?0:t,parseInt(e*t/100,10)}function nBe(){var e={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},t,r=document.body,n=document.createTextNode(""),i=document.createElement("SPAN"),o=function(R,A,$){R.addEventListener(A,$,!1)},s=function(R,A,$){R.removeEventListener(A,$,!1)},a=function(R){var A,$;R?/^[a-zA-Z \.,\\\/\|0-9]$/.test(R)||(R="."):R="",n.textContent!==void 0?n.textContent=t.value+R:n.data=t.value+R,i.style.position="absolute",i.style.fontSize=S(t).fontSize,i.style.fontFamily=S(t).fontFamily,i.style.whiteSpace="pre",r.appendChild(i),A=i.clientWidth+2,r.removeChild(i),t.style.height=e.minHeight+"px",e.minWidth>A?t.style.width=e.minWidth+"px":A>e.maxWidth?t.style.width=e.maxWidth+"px":t.style.width=A+"px",$=t.scrollHeight?t.scrollHeight-1:0,e.minHeight>$?t.style.height=e.minHeight+"px":e.maxHeight<$?(t.style.height=e.maxHeight+"px",t.style.overflowY="visible"):t.style.height=$+"px"},h=function(){window.setTimeout(a,0)},p=function(R){if(R&&R.minHeight)if(R.minHeight=="inherit")e.minHeight=t.clientHeight;else{var A=parseInt(R.minHeight);isNaN(A)||(e.minHeight=A)}if(R&&R.maxHeight)if(R.maxHeight=="inherit")e.maxHeight=t.clientHeight;else{var $=parseInt(R.maxHeight);isNaN($)||(e.maxHeight=$)}if(R&&R.minWidth)if(R.minWidth=="inherit")e.minWidth=t.clientWidth;else{var j=parseInt(R.minWidth);isNaN(j)||(e.minWidth=j)}if(R&&R.maxWidth)if(R.maxWidth=="inherit")e.maxWidth=t.clientWidth;else{var z=parseInt(R.maxWidth);isNaN(z)||(e.maxWidth=z)}i.firstChild||(i.className="autoResize",i.style.display="inline-block",i.appendChild(n))},g=function(R,A,$){t=R,p(A),t.nodeName=="TEXTAREA"&&(t.style.resize="none",t.style.overflowY="",t.style.height=e.minHeight+"px",t.style.minWidth=e.minWidth+"px",t.style.maxWidth=e.maxWidth+"px",t.style.overflowY="hidden"),$&&(o(t,"change",a),o(t,"cut",h),o(t,"paste",h),o(t,"drop",h),o(t,"keydown",h),o(t,"focus",a),o(t,"compositionstart",h),o(t,"compositionupdate",h),o(t,"compositionend",h)),a()};function S(T){return T.currentStyle||document.defaultView.getComputedStyle(T)}return{init:function(R,A,$){g(R,A,$)},unObserve:function(){s(t,"change",a),s(t,"cut",h),s(t,"paste",h),s(t,"drop",h),s(t,"keydown",h),s(t,"focus",a),s(t,"compositionstart",h),s(t,"compositionupdate",h),s(t,"compositionend",h)},resize:a}}function tK(e,t){for(var r=Yoe(t),n=t.value.split(`
`),i=r,o=0,s=0;s<n.length;s++){var a=n[s];s!==0&&(o+=n[s-1].length+1);var h=o+a.length;if(e==="home"?i=o:e==="end"&&(i=h),r<=h)break}PA(t,i)}function Hg(e){"@babel/helpers - typeof";return Hg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hg(e)}function rK(e,t){return sBe(e)||aBe(e,t)||oBe(e,t)||iBe()}function iBe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function oBe(e,t){if(e){if(typeof e=="string")return nK(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return nK(e,t)}}function nK(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function aBe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],h=!0,p=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;h=!1}else for(;!(h=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);h=!0);}catch(g){p=!0,i=g}finally{try{if(!h&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(p)throw i}}return a}}function sBe(e){if(Array.isArray(e))return e}function lBe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function iK(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,cBe(n.key),n)}}function uBe(e,t,r){return t&&iK(e.prototype,t),r&&iK(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function cBe(e){var t=fBe(e,"string");return Hg(t)==="symbol"?t:String(t)}function fBe(e,t){if(Hg(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Hg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function V0(){return typeof Reflect<"u"&&Reflect.get?V0=Reflect.get.bind():V0=function(t,r,n){var i=hBe(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},V0.apply(this,arguments)}function hBe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Mp(e),e!==null););return e}function dBe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&jN(e,t)}function jN(e,t){return jN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},jN(e,t)}function pBe(e){var t=yBe();return function(){var n=Mp(e),i;if(t){var o=Mp(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return mBe(this,i)}}function mBe(e,t){if(t&&(Hg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return sae(e)}function sae(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function yBe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Mp(e){return Mp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Mp(e)}var gBe="ht_editor_visible",eO="ht_editor_hidden",oK="textEditor",vBe="text",nm=function(e){dBe(r,e);var t=pBe(r);function r(n){var i;return lBe(this,r),i=t.call(this,n),i.eventManager=new Bi(sae(i)),i.autoResize=nBe(),i.TEXTAREA=void 0,i.textareaStyle=void 0,i.TEXTAREA_PARENT=void 0,i.textareaParentStyle=void 0,i.layerClass=void 0,i.createElements(),i.bindEvents(),i.hot.addHookOnce("afterDestroy",function(){return i.destroy()}),i}return uBe(r,[{key:"getValue",value:function(){return this.TEXTAREA.value}},{key:"setValue",value:function(i){this.TEXTAREA.value=i}},{key:"open",value:function(){var i=this;this.refreshDimensions(),this.showEditableElement();var o=this.hot.getShortcutManager();o.setActiveContextName("editor"),this.addHook("afterDocumentKeyDown",function(s){return i.onAfterDocumentKeyDown(s)}),this.registerShortcuts()}},{key:"close",value:function(){this.autoResize.unObserve(),this.hot.rootDocument.activeElement===this.TEXTAREA&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts(),this.removeHooksByKey("afterDocumentKeyDown")}},{key:"prepare",value:function(i,o,s,a,h,p){var g=this.state;if(V0(Mp(r.prototype),"prepare",this).call(this,i,o,s,a,h,p),!p.readOnly){this.refreshDimensions(!0);var S=p.allowInvalid,T=p.fragmentSelection;S&&(this.TEXTAREA.value=""),g!==To.FINISHED&&this.hideEditableElement();var R=!T;R&&!nu()&&this.focus()}}},{key:"beginEditing",value:function(i,o){this.state===To.VIRGIN&&(this.TEXTAREA.value="",V0(Mp(r.prototype),"beginEditing",this).call(this,i,o))}},{key:"focus",value:function(){this.TEXTAREA.select(),PA(this.TEXTAREA,this.TEXTAREA.value.length)}},{key:"createElements",value:function(){var i=this.hot.rootDocument;this.TEXTAREA=i.createElement("TEXTAREA"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.tabIndex=-1,Ht(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=i.createElement("DIV"),Ht(this.TEXTAREA_PARENT,"handsontableInputHolder"),Ur(this.TEXTAREA_PARENT,this.layerClass)&&Kr(this.TEXTAREA_PARENT,this.layerClass),Ht(this.TEXTAREA_PARENT,eO),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}},{key:"hideEditableElement",value:function(){($$e()||D$e())&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",Kr(this.TEXTAREA_PARENT,this.layerClass),Ht(this.TEXTAREA_PARENT,eO)}},{key:"showEditableElement",value:function(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="",this.textareaStyle.overflowY="hidden";var i=this.TEXTAREA_PARENT.childNodes,o=!1;Er(i.length-1,function(s){var a=i[s];if(Ur(a,"handsontableEditor"))return o=!0,!1}),Ur(this.TEXTAREA_PARENT,eO)&&Kr(this.TEXTAREA_PARENT,eO),o?(this.layerClass=gBe,Ht(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),Ht(this.TEXTAREA_PARENT,this.layerClass))}},{key:"refreshValue",value:function(){var i=this.hot.toPhysicalRow(this.row),o=this.hot.getSourceDataAtCell(i,this.col);this.originalValue=o,this.setValue(o),this.refreshDimensions()}},{key:"refreshDimensions",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!(this.state!==To.EDITING&&!i)){if(this.TD=this.getEditedCell(),!this.TD){i||this.close();return}var o=this.getEditedCellRect(),s=o.top,a=o.start,h=o.width,p=o.maxWidth,g=o.height,S=o.maxHeight;this.textareaParentStyle.top="".concat(s,"px"),this.textareaParentStyle[this.hot.isRtl()?"right":"left"]="".concat(a,"px"),this.showEditableElement();var T=Ip(this.TD,this.hot.rootWindow);this.TEXTAREA.style.fontSize=T.fontSize,this.TEXTAREA.style.fontFamily=T.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor;var R=Ip(this.TEXTAREA),A=parseInt(R.paddingLeft,10)+parseInt(R.paddingRight,10),$=parseInt(R.paddingTop,10)+parseInt(R.paddingBottom,10),j=h-A,z=g-$,V=p-A,G=S-$;this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(j,V),minHeight:Math.min(z,G),maxWidth:V,maxHeight:G},!0)}}},{key:"bindEvents",value:function(){var i=this;this.eventManager.addEventListener(this.TEXTAREA,"cut",function(o){return o.stopPropagation()}),this.eventManager.addEventListener(this.TEXTAREA,"paste",function(o){return o.stopPropagation()}),Ioe()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",function(){return i.finishEditing(!1)}),this.addHook("afterScrollHorizontally",function(){return i.refreshDimensions()}),this.addHook("afterScrollVertically",function(){return i.refreshDimensions()}),this.addHook("afterColumnResize",function(){i.refreshDimensions(),i.focus()}),this.addHook("afterRowResize",function(){i.refreshDimensions(),i.focus()})}},{key:"allowKeyEventPropagation",value:function(){}},{key:"destroy",value:function(){this.eventManager.destroy(),this.clearHooks()}},{key:"registerShortcuts",value:function(){var i=this,o=this.hot.getShortcutManager(),s=o.getContext("editor"),a={runOnlyIf:function(){return dr(i.hot.getSelected())},group:oK},h=function(){i.hot.rootDocument.execCommand("insertText",!1,`
`)};s.addShortcuts([{keys:[["Tab"]],callback:function(g){var S=i.hot.getSettings(),T=typeof S.tabMoves=="function"?S.tabMoves(g):S.tabMoves;i.hot.selection.transformStart(T.row,T.col,!0)}},{keys:[["Shift","Tab"]],callback:function(g){var S=i.hot.getSettings(),T=typeof S.tabMoves=="function"?S.tabMoves(g):S.tabMoves;i.hot.selection.transformStart(-T.row,-T.col)}},{keys:[["Control","Enter"]],callback:function(){return h(),!1},runOnlyIf:function(g){return!i.hot.selection.isMultiple()&&!g.altKey},relativeToGroup:H0,position:"before"},{keys:[["Meta","Enter"]],callback:function(){return h(),!1},runOnlyIf:function(){return!i.hot.selection.isMultiple()},relativeToGroup:H0,position:"before"},{keys:[["Alt","Enter"]],callback:function(){return h(),!1},relativeToGroup:H0,position:"before"},{keys:[["PageUp"]],callback:function(){i.hot.selection.transformStart(-i.hot.countVisibleRows(),0)}},{keys:[["PageDown"]],callback:function(){i.hot.selection.transformStart(i.hot.countVisibleRows(),0)}},{keys:[["Home"]],callback:function(g,S){var T=rK(S,1),R=T[0];tK(R,i.TEXTAREA)}},{keys:[["End"]],callback:function(g,S){var T=rK(S,1),R=T[0];tK(R,i.TEXTAREA)}},{keys:[["Control/Meta","Z"]],preventDefault:!1,callback:function(){i.hot._registerTimeout(function(){i.autoResize.resize()},10)}},{keys:[["Control/Meta","Shift","Z"]],preventDefault:!1,callback:function(){i.hot._registerTimeout(function(){i.autoResize.resize()},10)}}],a)}},{key:"unregisterShortcuts",value:function(){var i=this.hot.getShortcutManager(),o=i.getContext("editor");o.removeShortcutsByGroup(IA),o.removeShortcutsByGroup(oK),o.removeShortcutsByGroup($N)}},{key:"onAfterDocumentKeyDown",value:function(i){var o=[Cr.ARROW_UP,Cr.ARROW_RIGHT,Cr.ARROW_DOWN,Cr.ARROW_LEFT];o.indexOf(i.keyCode)===-1&&this.autoResize.resize(String.fromCharCode(i.keyCode))}}],[{key:"EDITOR_TYPE",get:function(){return vBe}}]),r}(ob);function Vg(e){"@babel/helpers - typeof";return Vg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vg(e)}function _Be(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function aK(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,wBe(n.key),n)}}function bBe(e,t,r){return t&&aK(e.prototype,t),r&&aK(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function wBe(e){var t=SBe(e,"string");return Vg(t)==="symbol"?t:String(t)}function SBe(e,t){if(Vg(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Vg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ol(){return typeof Reflect<"u"&&Reflect.get?ol=Reflect.get.bind():ol=function(t,r,n){var i=xBe(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},ol.apply(this,arguments)}function xBe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=rs(e),e!==null););return e}function CBe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&zN(e,t)}function zN(e,t){return zN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},zN(e,t)}function EBe(e){var t=RBe();return function(){var n=rs(e),i;if(t){var o=rs(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return TBe(this,i)}}function TBe(e,t){if(t&&(Vg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return OBe(e)}function OBe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function RBe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function rs(e){return rs=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},rs(e)}var sK="handsontableEditor",kBe="handsontable",a3=function(e){CBe(r,e);var t=EBe(r);function r(){return _Be(this,r),t.apply(this,arguments)}return bBe(r,[{key:"open",value:function(){ol(rs(r.prototype),"open",this).call(this),this.htEditor&&this.htEditor.destroy(),this.htContainer.style.display==="none"&&(this.htContainer.style.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),PA(this.TEXTAREA,0,this.TEXTAREA.value.length),this.refreshDimensions()}},{key:"close",value:function(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),ol(rs(r.prototype),"close",this).call(this)}},{key:"prepare",value:function(i,o,s,a,h,p){ol(rs(r.prototype),"prepare",this).call(this,i,o,s,a,h,p);var g=this,S={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,afterOnCellMouseDown:function(R,A){var $=this.getSourceData(A.row,A.col);$!==void 0&&g.setValue($),g.instance.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&ao(S,p.handsontable),this.htOptions=S}},{key:"beginEditing",value:function(i,o){var s=this.hot.getSettings().onBeginEditing;s&&s()===!1||ol(rs(r.prototype),"beginEditing",this).call(this,i,o)}},{key:"createElements",value:function(){ol(rs(r.prototype),"createElements",this).call(this);var i=this.hot.rootDocument.createElement("DIV");i.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(i),this.htContainer=i,this.assignHooks()}},{key:"finishEditing",value:function(i,o,s){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){var a=this.htEditor.getInstance().getValue();a!==void 0&&this.setValue(a)}ol(rs(r.prototype),"finishEditing",this).call(this,i,o,s)}},{key:"assignHooks",value:function(){var i=this;this.hot.addHook("afterDestroy",function(){i.htEditor&&i.htEditor.destroy()})}},{key:"registerShortcuts",value:function(){var i=this,o=this.hot.getShortcutManager(),s=o.getContext("editor");ol(rs(r.prototype),"registerShortcuts",this).call(this);var a={group:sK,relativeToGroup:IA,position:"before"},h=function(g,S){var T=i.htEditor.getInstance();if(g!==void 0&&(g<0||T.flipped&&g>T.countRows()-1?T.deselectCell():T.selectCell(g,0),T.getData().length))return S.preventDefault(),lu(S),i.hot.listen(),i.TEXTAREA.focus(),!1};s.addShortcuts([{keys:[["ArrowUp"]],callback:function(g){var S=i.htEditor.getInstance(),T,R;return!S.getSelectedLast()&&S.flipped?T=S.countRows()-1:S.getSelectedLast()&&(S.flipped?(R=S.getSelectedLast()[0],T=Math.max(0,R-1)):(R=S.getSelectedLast()[0],T=R-1)),h(T,g)},preventDefault:!1},{keys:[["ArrowDown"]],callback:function(g){var S=i.htEditor.getInstance(),T,R;if(!S.getSelectedLast()&&!S.flipped)T=0;else if(S.getSelectedLast()){if(S.flipped)T=S.getSelectedLast()[0]+1;else if(!S.flipped){var A=S.countRows()-1;R=S.getSelectedLast()[0],T=Math.min(A,R+1)}}return h(T,g)},preventDefault:!1}],a)}},{key:"unregisterShortcuts",value:function(){ol(rs(r.prototype),"unregisterShortcuts",this).call(this);var i=this.hot.getShortcutManager(),o=i.getContext("editor");o.removeShortcutsByGroup(sK)}}],[{key:"EDITOR_TYPE",get:function(){return kBe}}]),r}(nm),PBe="base";function hC(e,t,r,n,i,o,s){var a=[],h=[];s.className&&Ht(t,s.className),s.readOnly&&a.push(s.readOnlyCellClassName),s.valid===!1&&s.invalidCellClassName?a.push(s.invalidCellClassName):h.push(s.invalidCellClassName),s.wordWrap===!1&&s.noWordWrapClassName&&a.push(s.noWordWrapClassName),!o&&s.placeholder&&a.push(s.placeholderCellClassName),Kr(t,h),Ht(t,a)}hC.RENDERER_TYPE=PBe;var ABe="text";function xh(e,t,r,n,i,o,s){hC.apply(this,[e,t,r,n,i,o,s]);var a=o;if(!a&&s.placeholder&&(a=s.placeholder),a=Xi(a),s.trimWhitespace&&(a=a.trim()),s.rendererTemplate){uu(t);var h=e.rootDocument.createElement("TEMPLATE");h.setAttribute("bind","{{}}"),h.innerHTML=s.rendererTemplate,HTMLTemplateElement.decorate(h),h.model=e.getSourceDataAtRow(r),t.appendChild(h)}else Ap(t,a)}xh.RENDERER_TYPE=ABe;function Ug(e){"@babel/helpers - typeof";return Ug=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ug(e)}function IBe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function lK(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,lae(n.key),n)}}function MBe(e,t,r){return t&&lK(e.prototype,t),r&&lK(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Wd(){return typeof Reflect<"u"&&Reflect.get?Wd=Reflect.get.bind():Wd=function(t,r,n){var i=DBe(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Wd.apply(this,arguments)}function DBe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Zu(e),e!==null););return e}function $Be(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&FN(e,t)}function FN(e,t){return FN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},FN(e,t)}function LBe(e){var t=BBe();return function(){var n=Zu(e),i;if(t){var o=Zu(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return NBe(this,i)}}function NBe(e,t){if(t&&(Ug(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return HN(e)}function HN(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function BBe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Zu(e){return Zu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Zu(e)}function jBe(e,t,r){return t=lae(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function lae(e){var t=zBe(e,"string");return Ug(t)==="symbol"?t:String(t)}function zBe(e,t){if(Ug(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ug(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var _$=new WeakMap,FBe="autocomplete",s3=function(e){$Be(r,e);var t=LBe(r);function r(n){var i;return IBe(this,r),i=t.call(this,n),jBe(HN(i),"sortByRelevance",function(o,s,a){var h=[],p=[],g=o.length,S=s.length,T,R,A,$;if(g===0){for(A=0;A<S;A++)p.push(A);return p}for(A=0;A<S;A++){if(R=LY(Xi(s[A])),a)$=R.indexOf(o);else{var j=this.cellProperties.locale;$=R.toLocaleLowerCase(j).indexOf(o.toLocaleLowerCase(j))}$!==-1&&(T=R.length-$-g,h.push({baseIndex:A,index:$,charsLeft:T,value:R}))}for(h.sort(function(z,V){if(V.index===-1)return-1;if(z.index===-1)return 1;if(z.index<V.index)return-1;if(V.index<z.index)return 1;if(z.index===V.index){if(z.charsLeft<V.charsLeft)return-1;if(z.charsLeft>V.charsLeft)return 1}return 0}),A=0,S=h.length;A<S;A++)p.push(h[A].baseIndex);return p}),i.query=null,i.strippedChoices=[],i.rawChoices=[],_$.set(HN(i),{skipOne:!1,isMacOS:i.hot.rootWindow.navigator.platform.indexOf("Mac")>-1}),i}return MBe(r,[{key:"getValue",value:function(){var i=this,o=this.rawChoices.find(function(s){var a=i.stripValueIfNeeded(s);return a===i.TEXTAREA.value});return dr(o)?o:this.TEXTAREA.value}},{key:"createElements",value:function(){Wd(Zu(r.prototype),"createElements",this).call(this),Ht(this.htContainer,"autocompleteEditor"),Ht(this.htContainer,this.hot.rootWindow.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll")}},{key:"open",value:function(){var i=this,o=_$.get(this);Wd(Zu(r.prototype),"open",this).call(this);var s=this.htEditor.getInstance(),a=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown;this.showEditableElement(),this.focus();var h=Ao();h===0&&o.isMacOS&&(h+=15),this.addHook("beforeKeyDown",function(p){return i.onBeforeKeyDown(p)}),s.updateSettings({colWidths:a?[ri(this.TEXTAREA)-2]:void 0,width:a?ri(this.TEXTAREA)+h:void 0,renderer:function(g,S,T,R,A,$,j){xh(g,S,T,R,A,$,j);var z=i.cellProperties,V=z.filteringCaseSensitive,G=z.allowHtml,ee=z.locale,K=i.query,xe=Xi($),Me,He;xe&&!G&&(Me=V===!0?xe.indexOf(K):xe.toLocaleLowerCase(ee).indexOf(K.toLocaleLowerCase(ee)),Me!==-1&&(He=xe.substr(Me,K.length),xe=xe.replace(He,"<strong>".concat(He,"</strong>")))),S.innerHTML=xe},autoColumnSize:!0}),o.skipOne&&(o.skipOne=!1),this.hot._registerTimeout(function(){i.queryChoices(i.TEXTAREA.value)})}},{key:"close",value:function(){this.removeHooksByKey("beforeKeyDown"),Wd(Zu(r.prototype),"close",this).call(this)}},{key:"discardEditor",value:function(i){Wd(Zu(r.prototype),"discardEditor",this).call(this,i),this.hot.view.render()}},{key:"queryChoices",value:function(i){var o=this,s=this.cellProperties.source;this.query=i,typeof s=="function"?s.call(this.cellProperties,i,function(a){o.rawChoices=a,o.updateChoicesList(o.stripValuesIfNeeded(a))}):Array.isArray(s)?(this.rawChoices=s,this.updateChoicesList(this.stripValuesIfNeeded(s))):this.updateChoicesList([])}},{key:"updateChoicesList",value:function(i){var o=Yoe(this.TEXTAREA),s=uLe(this.TEXTAREA),a=this.cellProperties.sortByRelevance,h=this.cellProperties.filter,p=null,g=null,S=i;a&&(p=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),S,this.cellProperties.filteringCaseSensitive));var T=Array.isArray(p)?p.length:0;if(h===!1)T&&(g=p[0]);else{for(var R=[],A=0,$=S.length;A<$&&!(a&&T<=A);A++)T?R.push(S[p[A]]):R.push(S[A]);g=0,S=R}this.strippedChoices=S,this.htEditor.loadData(iR([S])),this.updateDropdownHeight(),this.flipDropdownIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(g),this.hot.listen(),PA(this.TEXTAREA,o,o===s?void 0:s)}},{key:"flipDropdownIfNeeded",value:function(){var i=kS(this.hot.view._wt.wtTable.TABLE),o=i===this.hot.rootWindow,s=this.cellProperties.preventOverflow;if(o||!o&&(s||s==="horizontal"))return!1;var a=io(this.TEXTAREA),h=$i(this.TEXTAREA),p=this.getDropdownHeight(),g=i.scrollTop,S=$i(this.hot.view._wt.wtTable.THEAD),T=io(i),R=a.top-T.top-S+g,A=i.scrollHeight-R-S-h,$=p>A&&R>A;return $?this.flipDropdown(p):this.unflipDropdown(),this.limitDropdownIfNeeded($?R:A,p),$}},{key:"limitDropdownIfNeeded",value:function(i,o){if(o>i){var s=0,a=0,h=0,p=null;do h=this.htEditor.getRowHeight(a)||this.htEditor.view._wt.getSetting("defaultRowHeight"),s+=h,a+=1;while(s<i);p=s-h,this.htEditor.flipped&&(this.htEditor.rootElement.style.top="".concat(parseInt(this.htEditor.rootElement.style.top,10)+o-p,"px")),this.setDropdownHeight(s-h)}}},{key:"flipDropdown",value:function(i){var o=this.htEditor.rootElement.style;o.position="absolute",o.top="".concat(-i,"px"),this.htEditor.flipped=!0}},{key:"unflipDropdown",value:function(){var i=this.htEditor.rootElement.style;i.position="absolute",i.top="",this.htEditor.flipped=void 0}},{key:"updateDropdownHeight",value:function(){var i=this.htEditor.getColWidth(0)+Ao(this.hot.rootDocument)+2,o=this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:o?void 0:i}),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}},{key:"setDropdownHeight",value:function(i){this.htEditor.updateSettings({height:i})}},{key:"highlightBestMatchingChoice",value:function(i){typeof i=="number"?this.htEditor.selectCell(i,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}},{key:"getDropdownHeight",value:function(){var i=this.htEditor.getInstance().getRowHeight(0)||23,o=this.cellProperties.visibleRows;return this.strippedChoices.length>=o?o*i:this.strippedChoices.length*i+8}},{key:"stripValueIfNeeded",value:function(i){return this.stripValuesIfNeeded([i])[0]}},{key:"stripValuesIfNeeded",value:function(i){var o=this.cellProperties.allowHtml,s=hn(i,function(h){return Xi(h)}),a=hn(s,function(h){return o?h:LY(h)});return a}},{key:"allowKeyEventPropagation",value:function(i){var o=this.htEditor.getSelectedRangeLast(),s={row:o?o.from.row:-1},a=!1;return i===Cr.ARROW_DOWN&&s.row>0&&s.row<this.htEditor.countRows()-1&&(a=!0),i===Cr.ARROW_UP&&s.row>-1&&(a=!0),a}},{key:"onBeforeKeyDown",value:function(i){var o=this,s=_$.get(this);if(s.skipOne=!1,B$e(i.keyCode)||i.keyCode===Cr.BACKSPACE||i.keyCode===Cr.DELETE||i.keyCode===Cr.INSERT){var a=10;if(i.keyCode===Cr.C&&(i.ctrlKey||i.metaKey))return;this.isOpened()||(a+=10),this.htEditor&&this.hot._registerTimeout(function(){o.queryChoices(o.TEXTAREA.value),s.skipOne=!0},a)}}}],[{key:"EDITOR_TYPE",get:function(){return FBe}}]),r}(a3);function Wg(e){"@babel/helpers - typeof";return Wg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wg(e)}function HBe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function uK(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,UBe(n.key),n)}}function VBe(e,t,r){return t&&uK(e.prototype,t),r&&uK(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function UBe(e){var t=WBe(e,"string");return Wg(t)==="symbol"?t:String(t)}function WBe(e,t){if(Wg(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Wg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function GBe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&VN(e,t)}function VN(e,t){return VN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},VN(e,t)}function YBe(e){var t=XBe();return function(){var n=Rk(e),i;if(t){var o=Rk(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return KBe(this,i)}}function KBe(e,t){if(t&&(Wg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return qBe(e)}function qBe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function XBe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Rk(e){return Rk=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Rk(e)}var ZBe="checkbox",uae=function(e){GBe(r,e);var t=YBe(r);function r(){return HBe(this,r),t.apply(this,arguments)}return VBe(r,[{key:"beginEditing",value:function(i,o){if(o&&o.type==="mouseup"){var s=this.TD.querySelector('input[type="checkbox"]');Ur(s,"htBadValue")||s.click()}}},{key:"finishEditing",value:function(){}},{key:"init",value:function(){}},{key:"open",value:function(){}},{key:"close",value:function(){}},{key:"getValue",value:function(){}},{key:"setValue",value:function(){}},{key:"focus",value:function(){}}],[{key:"EDITOR_TYPE",get:function(){return ZBe}}]),r}(ob),cae={exports:{}};const JBe=ede(JMe);/*!
 * Pikaday
 *
 * Copyright  2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
 */(function(e,t){(function(r,n){var i;{try{i=JBe}catch{}e.exports=n(i)}})(ug,function(r){var n=typeof r=="function",i=!!window.addEventListener,o=window.document,s=window.setTimeout,a=function(ae,D,U,q){i?ae.addEventListener(D,U,!!q):ae.attachEvent("on"+D,U)},h=function(ae,D,U,q){i?ae.removeEventListener(D,U,!!q):ae.detachEvent("on"+D,U)},p=function(ae){return ae.trim?ae.trim():ae.replace(/^\s+|\s+$/g,"")},g=function(ae,D){return(" "+ae.className+" ").indexOf(" "+D+" ")!==-1},S=function(ae,D){g(ae,D)||(ae.className=ae.className===""?D:ae.className+" "+D)},T=function(ae,D){ae.className=p((" "+ae.className+" ").replace(" "+D+" "," "))},R=function(ae){return/Array/.test(Object.prototype.toString.call(ae))},A=function(ae){return/Date/.test(Object.prototype.toString.call(ae))&&!isNaN(ae.getTime())},$=function(ae){var D=ae.getDay();return D===0||D===6},j=function(ae){return ae%4===0&&ae%100!==0||ae%400===0},z=function(ae,D){return[31,j(ae)?29:28,31,30,31,30,31,31,30,31,30,31][D]},V=function(ae){A(ae)&&ae.setHours(0,0,0,0)},G=function(ae,D){return ae.getTime()===D.getTime()},ee=function(ae,D,U){var q,ne;for(q in D)ne=ae[q]!==void 0,ne&&typeof D[q]=="object"&&D[q]!==null&&D[q].nodeName===void 0?A(D[q])?U&&(ae[q]=new Date(D[q].getTime())):R(D[q])?U&&(ae[q]=D[q].slice(0)):ae[q]=ee({},D[q],U):(U||!ne)&&(ae[q]=D[q]);return ae},K=function(ae,D,U){var q;o.createEvent?(q=o.createEvent("HTMLEvents"),q.initEvent(D,!0,!1),q=ee(q,U),ae.dispatchEvent(q)):o.createEventObject&&(q=o.createEventObject(),q=ee(q,U),ae.fireEvent("on"+D,q))},xe=function(ae){return ae.month<0&&(ae.year-=Math.ceil(Math.abs(ae.month)/12),ae.month+=12),ae.month>11&&(ae.year+=Math.floor(Math.abs(ae.month)/12),ae.month-=12),ae},Me={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},He=function(ae,D,U){for(D+=ae.firstDay;D>=7;)D-=7;return U?ae.i18n.weekdaysShort[D]:ae.i18n.weekdays[D]},Ne=function(ae){var D=[],U="false";if(ae.isEmpty)if(ae.showDaysInNextAndPreviousMonths)D.push("is-outside-current-month"),ae.enableSelectionDaysInNextAndPreviousMonths||D.push("is-selection-disabled");else return'<td class="is-empty"></td>';return ae.isDisabled&&D.push("is-disabled"),ae.isToday&&D.push("is-today"),ae.isSelected&&(D.push("is-selected"),U="true"),ae.hasEvent&&D.push("has-event"),ae.isInRange&&D.push("is-inrange"),ae.isStartRange&&D.push("is-startrange"),ae.isEndRange&&D.push("is-endrange"),'<td data-day="'+ae.day+'" class="'+D.join(" ")+'" aria-selected="'+U+'"><button class="pika-button pika-day" type="button" data-pika-year="'+ae.year+'" data-pika-month="'+ae.month+'" data-pika-day="'+ae.day+'">'+ae.day+"</button></td>"},We=function(ae,D){ae.setHours(0,0,0,0);var U=ae.getDate(),q=ae.getDay(),ne=D,ye=ne-1,ve=7,ze=function(jt){return(jt+ve-1)%ve};ae.setDate(U+ye-ze(q));var je=new Date(ae.getFullYear(),0,ne),Je=24*60*60*1e3,xt=(ae.getTime()-je.getTime())/Je,kt=1+Math.round((xt-ye+ze(je.getDay()))/ve);return kt},gt=function(ae,D,U,q){var ne=new Date(U,D,ae),ye=n?r(ne).isoWeek():We(ne,q);return'<td class="pika-week">'+ye+"</td>"},Lt=function(ae,D,U,q){return'<tr class="pika-row'+(U?" pick-whole-week":"")+(q?" is-selected":"")+'">'+(D?ae.reverse():ae).join("")+"</tr>"},_t=function(ae){return"<tbody>"+ae.join("")+"</tbody>"},$e=function(ae){var D,U=[];for(ae.showWeekNumber&&U.push("<th></th>"),D=0;D<7;D++)U.push('<th scope="col"><abbr title="'+He(ae,D)+'">'+He(ae,D,!0)+"</abbr></th>");return"<thead><tr>"+(ae.isRTL?U.reverse():U).join("")+"</tr></thead>"},Fe=function(ae,D,U,q,ne,ye){var ve,ze,je,Je=ae._o,xt=U===Je.minYear,kt=U===Je.maxYear,jt='<div id="'+ye+'" class="pika-title" role="heading" aria-live="assertive">',yr,Ft,Jt=!0,et=!0;for(je=[],ve=0;ve<12;ve++)je.push('<option value="'+(U===ne?ve-D:12+ve-D)+'"'+(ve===q?' selected="selected"':"")+(xt&&ve<Je.minMonth||kt&&ve>Je.maxMonth?' disabled="disabled"':"")+">"+Je.i18n.months[ve]+"</option>");for(yr='<div class="pika-label">'+Je.i18n.months[q]+'<select class="pika-select pika-select-month" tabindex="-1">'+je.join("")+"</select></div>",R(Je.yearRange)?(ve=Je.yearRange[0],ze=Je.yearRange[1]+1):(ve=U-Je.yearRange,ze=1+U+Je.yearRange),je=[];ve<ze&&ve<=Je.maxYear;ve++)ve>=Je.minYear&&je.push('<option value="'+ve+'"'+(ve===U?' selected="selected"':"")+">"+ve+"</option>");return Ft='<div class="pika-label">'+U+Je.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+je.join("")+"</select></div>",Je.showMonthAfterYear?jt+=Ft+yr:jt+=yr+Ft,xt&&(q===0||Je.minMonth>=q)&&(Jt=!1),kt&&(q===11||Je.maxMonth<=q)&&(et=!1),D===0&&(jt+='<button class="pika-prev'+(Jt?"":" is-disabled")+'" type="button">'+Je.i18n.previousMonth+"</button>"),D===ae._o.numberOfMonths-1&&(jt+='<button class="pika-next'+(et?"":" is-disabled")+'" type="button">'+Je.i18n.nextMonth+"</button>"),jt+="</div>"},At=function(ae,D,U){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+U+'">'+$e(ae)+_t(D)+"</table>"},Gt=function(ae){var D=this,U=D.config(ae);D._onMouseDown=function(ne){if(D._v){ne=ne||window.event;var ye=ne.target||ne.srcElement;if(ye)if(g(ye,"is-disabled")||(g(ye,"pika-button")&&!g(ye,"is-empty")&&!g(ye.parentNode,"is-disabled")?(D.setDate(new Date(ye.getAttribute("data-pika-year"),ye.getAttribute("data-pika-month"),ye.getAttribute("data-pika-day"))),U.bound&&s(function(){D.hide(),U.blurFieldOnSelect&&U.field&&U.field.blur()},100)):g(ye,"pika-prev")?D.prevMonth():g(ye,"pika-next")&&D.nextMonth()),g(ye,"pika-select"))D._c=!0;else if(ne.preventDefault)ne.preventDefault();else return ne.returnValue=!1,!1}},D._onChange=function(ne){ne=ne||window.event;var ye=ne.target||ne.srcElement;ye&&(g(ye,"pika-select-month")?D.gotoMonth(ye.value):g(ye,"pika-select-year")&&D.gotoYear(ye.value))},D._onKeyChange=function(ne){if(ne=ne||window.event,D.isVisible())switch(ne.keyCode){case 13:case 27:U.field&&U.field.blur();break;case 37:D.adjustDate("subtract",1);break;case 38:D.adjustDate("subtract",7);break;case 39:D.adjustDate("add",1);break;case 40:D.adjustDate("add",7);break;case 8:case 46:D.setDate(null);break}},D._parseFieldValue=function(){if(U.parse)return U.parse(U.field.value,U.format);if(n){var ne=r(U.field.value,U.format,U.formatStrict);return ne&&ne.isValid()?ne.toDate():null}else return new Date(Date.parse(U.field.value))},D._onInputChange=function(ne){var ye;ne.firedBy!==D&&(ye=D._parseFieldValue(),A(ye)&&D.setDate(ye),D._v||D.show())},D._onInputFocus=function(){D.show()},D._onInputClick=function(){D.show()},D._onInputBlur=function(){var ne=o.activeElement;do if(g(ne,"pika-single"))return;while(ne=ne.parentNode);D._c||(D._b=s(function(){D.hide()},50)),D._c=!1},D._onClick=function(ne){ne=ne||window.event;var ye=ne.target||ne.srcElement,ve=ye;if(ye){!i&&g(ye,"pika-select")&&(ye.onchange||(ye.setAttribute("onchange","return;"),a(ye,"change",D._onChange)));do if(g(ve,"pika-single")||ve===U.trigger)return;while(ve=ve.parentNode);D._v&&ye!==U.trigger&&ve!==U.trigger&&D.hide()}},D.el=o.createElement("div"),D.el.className="pika-single"+(U.isRTL?" is-rtl":"")+(U.theme?" "+U.theme:""),a(D.el,"mousedown",D._onMouseDown,!0),a(D.el,"touchend",D._onMouseDown,!0),a(D.el,"change",D._onChange),U.keyboardInput&&a(o,"keydown",D._onKeyChange),U.field&&(U.container?U.container.appendChild(D.el):U.bound?o.body.appendChild(D.el):U.field.parentNode.insertBefore(D.el,U.field.nextSibling),a(U.field,"change",D._onInputChange),U.defaultDate||(U.defaultDate=D._parseFieldValue(),U.setDefaultDate=!0));var q=U.defaultDate;A(q)?U.setDefaultDate?D.setDate(q,!0):D.gotoDate(q):D.gotoDate(new Date),U.bound?(this.hide(),D.el.className+=" is-bound",a(U.trigger,"click",D._onInputClick),a(U.trigger,"focus",D._onInputFocus),a(U.trigger,"blur",D._onInputBlur)):this.show()};return Gt.prototype={config:function(ae){this._o||(this._o=ee({},Me,!0));var D=ee(this._o,ae,!0);D.isRTL=!!D.isRTL,D.field=D.field&&D.field.nodeName?D.field:null,D.theme=typeof D.theme=="string"&&D.theme?D.theme:null,D.bound=!!(D.bound!==void 0?D.field&&D.bound:D.field),D.trigger=D.trigger&&D.trigger.nodeName?D.trigger:D.field,D.disableWeekends=!!D.disableWeekends,D.disableDayFn=typeof D.disableDayFn=="function"?D.disableDayFn:null;var U=parseInt(D.numberOfMonths,10)||1;if(D.numberOfMonths=U>4?4:U,A(D.minDate)||(D.minDate=!1),A(D.maxDate)||(D.maxDate=!1),D.minDate&&D.maxDate&&D.maxDate<D.minDate&&(D.maxDate=D.minDate=!1),D.minDate&&this.setMinDate(D.minDate),D.maxDate&&this.setMaxDate(D.maxDate),R(D.yearRange)){var q=new Date().getFullYear()-10;D.yearRange[0]=parseInt(D.yearRange[0],10)||q,D.yearRange[1]=parseInt(D.yearRange[1],10)||q}else D.yearRange=Math.abs(parseInt(D.yearRange,10))||Me.yearRange,D.yearRange>100&&(D.yearRange=100);return D},toString:function(ae){return ae=ae||this._o.format,A(this._d)?this._o.toString?this._o.toString(this._d,ae):n?r(this._d).format(ae):this._d.toDateString():""},getMoment:function(){return n?r(this._d):null},setMoment:function(ae,D){n&&r.isMoment(ae)&&this.setDate(ae.toDate(),D)},getDate:function(){return A(this._d)?new Date(this._d.getTime()):null},setDate:function(ae,D){if(!ae)return this._d=null,this._o.field&&(this._o.field.value="",K(this._o.field,"change",{firedBy:this})),this.draw();if(typeof ae=="string"&&(ae=new Date(Date.parse(ae))),!!A(ae)){var U=this._o.minDate,q=this._o.maxDate;A(U)&&ae<U?ae=U:A(q)&&ae>q&&(ae=q),this._d=new Date(ae.getTime()),V(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),K(this._o.field,"change",{firedBy:this})),!D&&typeof this._o.onSelect=="function"&&this._o.onSelect.call(this,this.getDate())}},clear:function(){this.setDate(null)},gotoDate:function(ae){var D=!0;if(A(ae)){if(this.calendars){var U=new Date(this.calendars[0].year,this.calendars[0].month,1),q=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),ne=ae.getTime();q.setMonth(q.getMonth()+1),q.setDate(q.getDate()-1),D=ne<U.getTime()||q.getTime()<ne}D&&(this.calendars=[{month:ae.getMonth(),year:ae.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(ae,D){var U=this.getDate()||new Date,q=parseInt(D)*24*60*60*1e3,ne;ae==="add"?ne=new Date(U.valueOf()+q):ae==="subtract"&&(ne=new Date(U.valueOf()-q)),this.setDate(ne)},adjustCalendars:function(){this.calendars[0]=xe(this.calendars[0]);for(var ae=1;ae<this._o.numberOfMonths;ae++)this.calendars[ae]=xe({month:this.calendars[0].month+ae,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(ae){isNaN(ae)||(this.calendars[0].month=parseInt(ae,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(ae){isNaN(ae)||(this.calendars[0].year=parseInt(ae,10),this.adjustCalendars())},setMinDate:function(ae){ae instanceof Date?(V(ae),this._o.minDate=ae,this._o.minYear=ae.getFullYear(),this._o.minMonth=ae.getMonth()):(this._o.minDate=Me.minDate,this._o.minYear=Me.minYear,this._o.minMonth=Me.minMonth,this._o.startRange=Me.startRange),this.draw()},setMaxDate:function(ae){ae instanceof Date?(V(ae),this._o.maxDate=ae,this._o.maxYear=ae.getFullYear(),this._o.maxMonth=ae.getMonth()):(this._o.maxDate=Me.maxDate,this._o.maxYear=Me.maxYear,this._o.maxMonth=Me.maxMonth,this._o.endRange=Me.endRange),this.draw()},setStartRange:function(ae){this._o.startRange=ae},setEndRange:function(ae){this._o.endRange=ae},draw:function(ae){if(!(!this._v&&!ae)){var D=this._o,U=D.minYear,q=D.maxYear,ne=D.minMonth,ye=D.maxMonth,ve="",ze;this._y<=U&&(this._y=U,!isNaN(ne)&&this._m<ne&&(this._m=ne)),this._y>=q&&(this._y=q,!isNaN(ye)&&this._m>ye&&(this._m=ye));for(var je=0;je<D.numberOfMonths;je++)ze="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),ve+='<div class="pika-lendar">'+Fe(this,je,this.calendars[je].year,this.calendars[je].month,this.calendars[0].year,ze)+this.render(this.calendars[je].year,this.calendars[je].month,ze)+"</div>";this.el.innerHTML=ve,D.bound&&D.field.type!=="hidden"&&s(function(){D.trigger.focus()},1),typeof this._o.onDraw=="function"&&this._o.onDraw(this),D.bound&&D.field.setAttribute("aria-label",D.ariaLabel)}},adjustPosition:function(){var ae,D,U,q,ne,ye,ve,ze,je,Je,xt,kt;if(!this._o.container){if(this.el.style.position="absolute",ae=this._o.trigger,D=ae,U=this.el.offsetWidth,q=this.el.offsetHeight,ne=window.innerWidth||o.documentElement.clientWidth,ye=window.innerHeight||o.documentElement.clientHeight,ve=window.pageYOffset||o.body.scrollTop||o.documentElement.scrollTop,xt=!0,kt=!0,typeof ae.getBoundingClientRect=="function")Je=ae.getBoundingClientRect(),ze=Je.left+window.pageXOffset,je=Je.bottom+window.pageYOffset;else for(ze=D.offsetLeft,je=D.offsetTop+D.offsetHeight;D=D.offsetParent;)ze+=D.offsetLeft,je+=D.offsetTop;(this._o.reposition&&ze+U>ne||this._o.position.indexOf("right")>-1&&ze-U+ae.offsetWidth>0)&&(ze=ze-U+ae.offsetWidth,xt=!1),(this._o.reposition&&je+q>ye+ve||this._o.position.indexOf("top")>-1&&je-q-ae.offsetHeight>0)&&(je=je-q-ae.offsetHeight,kt=!1),this.el.style.left=ze+"px",this.el.style.top=je+"px",S(this.el,xt?"left-aligned":"right-aligned"),S(this.el,kt?"bottom-aligned":"top-aligned"),T(this.el,xt?"right-aligned":"left-aligned"),T(this.el,kt?"top-aligned":"bottom-aligned")}},render:function(ae,D,U){var q=this._o,ne=new Date,ye=z(ae,D),ve=new Date(ae,D,1).getDay(),ze=[],je=[];V(ne),q.firstDay>0&&(ve-=q.firstDay,ve<0&&(ve+=7));for(var Je=D===0?11:D-1,xt=D===11?0:D+1,kt=D===0?ae-1:ae,jt=D===11?ae+1:ae,yr=z(kt,Je),Ft=ye+ve,Jt=Ft;Jt>7;)Jt-=7;Ft+=7-Jt;for(var et=!1,wr=0,$r=0;wr<Ft;wr++){var lr=new Date(ae,D,1+(wr-ve)),Sr=A(this._d)?G(lr,this._d):!1,Or=G(lr,ne),se=q.events.indexOf(lr.toDateString())!==-1,_e=wr<ve||wr>=ye+ve,Re=1+(wr-ve),Ke=D,Be=ae,rt=q.startRange&&G(q.startRange,lr),Ue=q.endRange&&G(q.endRange,lr),Ve=q.startRange&&q.endRange&&q.startRange<lr&&lr<q.endRange,st=q.minDate&&lr<q.minDate||q.maxDate&&lr>q.maxDate||q.disableWeekends&&$(lr)||q.disableDayFn&&q.disableDayFn(lr);_e&&(wr<ve?(Re=yr+Re,Ke=Je,Be=kt):(Re=Re-ye,Ke=xt,Be=jt));var Ze={day:Re,month:Ke,year:Be,hasEvent:se,isSelected:Sr,isToday:Or,isDisabled:st,isEmpty:_e,isStartRange:rt,isEndRange:Ue,isInRange:Ve,showDaysInNextAndPreviousMonths:q.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:q.enableSelectionDaysInNextAndPreviousMonths};q.pickWholeWeek&&Sr&&(et=!0),je.push(Ne(Ze)),++$r===7&&(q.showWeekNumber&&je.unshift(gt(wr-ve,D,ae,q.firstWeekOfYearMinDays)),ze.push(Lt(je,q.isRTL,q.pickWholeWeek,et)),je=[],$r=0,et=!1)}return At(q,ze,U)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),T(this.el,"is-hidden"),this._o.bound&&(a(o,"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){var ae=this._v;ae!==!1&&(this._o.bound&&h(o,"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),S(this.el,"is-hidden"),this._v=!1,ae!==void 0&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){var ae=this._o;this.hide(),h(this.el,"mousedown",this._onMouseDown,!0),h(this.el,"touchend",this._onMouseDown,!0),h(this.el,"change",this._onChange),ae.keyboardInput&&h(o,"keydown",this._onKeyChange),ae.field&&(h(ae.field,"change",this._onInputChange),ae.bound&&(h(ae.trigger,"click",this._onInputClick),h(ae.trigger,"focus",this._onInputFocus),h(ae.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}},Gt})})(cae);var QBe=cae.exports;const cK=V_(QBe);function Gg(e){"@babel/helpers - typeof";return Gg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gg(e)}function eje(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fK(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,rje(n.key),n)}}function tje(e,t,r){return t&&fK(e.prototype,t),r&&fK(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function rje(e){var t=nje(e,"string");return Gg(t)==="symbol"?t:String(t)}function nje(e,t){if(Gg(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Gg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Wu(){return typeof Reflect<"u"&&Reflect.get?Wu=Reflect.get.bind():Wu=function(t,r,n){var i=ije(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Wu.apply(this,arguments)}function ije(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=cl(e),e!==null););return e}function oje(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&UN(e,t)}function UN(e,t){return UN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},UN(e,t)}function aje(e){var t=uje();return function(){var n=cl(e),i;if(t){var o=cl(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return sje(this,i)}}function sje(e,t){if(t&&(Gg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return lje(e)}function lje(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function uje(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function cl(e){return cl=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},cl(e)}var fae="date",hK="dateEditor",hae=function(e){oje(r,e);var t=aje(r);function r(n){var i;return eje(this,r),i=t.call(this,n),i.defaultDateFormat="DD/MM/YYYY",i.isCellEdited=!1,i.parentDestroyed=!1,i.$datePicker=null,i}return tje(r,[{key:"init",value:function(){var i=this;if(typeof Vt!="function")throw new Error("You need to include moment.js to your project.");if(typeof cK!="function")throw new Error("You need to include Pikaday to your project.");Wu(cl(r.prototype),"init",this).call(this),this.instance.addHook("afterDestroy",function(){i.parentDestroyed=!0,i.destroyElements()})}},{key:"createElements",value:function(){Wu(cl(r.prototype),"createElements",this).call(this),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),Ht(this.datePicker,"htDatepickerHolder"),this.hot.rootDocument.body.appendChild(this.datePicker);var i=new Bi(this);i.addEventListener(this.datePicker,"mousedown",function(o){return o.stopPropagation()})}},{key:"destroyElements",value:function(){var i=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),i&&i.removeChild(this.datePicker)}},{key:"prepare",value:function(i,o,s,a,h,p){Wu(cl(r.prototype),"prepare",this).call(this,i,o,s,a,h,p)}},{key:"open",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,o=this.hot.getShortcutManager(),s=o.getContext("editor");Wu(cl(r.prototype),"open",this).call(this),this.showDatepicker(i),s.addShortcut({keys:[["Enter"]],callback:function(h){h.stopPropagation()},group:hK})}},{key:"close",value:function(){var i,o=this;this._opened=!1,(i=this.$datePicker)!==null&&i!==void 0&&i.destroy&&this.$datePicker.destroy(),this.instance._registerTimeout(function(){o.instance._refreshBorders()});var s=this.hot.getShortcutManager(),a=s.getContext("editor");a.removeShortcutsByGroup(hK),Wu(cl(r.prototype),"close",this).call(this)}},{key:"finishEditing",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(i){var s=this.originalValue;s!==void 0&&this.setValue(s)}Wu(cl(r.prototype),"finishEditing",this).call(this,i,o)}},{key:"showDatepicker",value:function(i){var o=this.TD.getBoundingClientRect(),s=this.cellProperties.dateFormat||this.defaultDateFormat,a=this.instance.view.isMouseDown(),h=i?Doe(i.keyCode):!1,p;this.datePicker.style.display="block",this.$datePicker=new cK(this.getDatePickerConfig()),this.$datePicker._onInputFocus=function(){},this.datePickerStyle.top="".concat(this.hot.rootWindow.pageYOffset+o.top+$i(this.TD),"px");var g=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?g=o.right-ri(this.datePicker):g=o.left,this.datePickerStyle.left="".concat(g,"px"),this.originalValue?(p=this.originalValue,Vt(p,s,!0).isValid()&&this.$datePicker.setMoment(Vt(p,s),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!h&&!a&&this.setValue("")):this.cellProperties.defaultDate?(p=this.cellProperties.defaultDate,Vt(p,s,!0).isValid()&&this.$datePicker.setMoment(Vt(p,s),!0),!h&&!a&&this.setValue("")):this.$datePicker.gotoToday()}},{key:"hideDatepicker",value:function(){this.datePickerStyle.display="none",this.$datePicker.hide()}},{key:"getDatePickerConfig",value:function(){var i=this,o=this.TEXTAREA,s={};this.cellProperties&&this.cellProperties.datePickerConfig&&kA(s,this.cellProperties.datePickerConfig);var a=s.onSelect,h=s.onClose;return s.field=o,s.trigger=o,s.container=this.datePicker,s.bound=!1,s.format=s.format||this.defaultDateFormat,s.reposition=s.reposition||!1,s.isRTL=!1,s.onSelect=function(p){var g=p;isNaN(g.getTime())||(g=Vt(g).format(i.cellProperties.dateFormat||i.defaultDateFormat)),i.setValue(g),i.hideDatepicker(),a&&a()},s.onClose=function(){i.parentDestroyed||i.finishEditing(!1),h&&h()},s}}],[{key:"EDITOR_TYPE",get:function(){return fae}}]),r}(nm);function Yg(e){"@babel/helpers - typeof";return Yg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yg(e)}function cje(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dK(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,hje(n.key),n)}}function fje(e,t,r){return t&&dK(e.prototype,t),r&&dK(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function hje(e){var t=dje(e,"string");return Yg(t)==="symbol"?t:String(t)}function dje(e,t){if(Yg(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Yg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function lR(){return typeof Reflect<"u"&&Reflect.get?lR=Reflect.get.bind():lR=function(t,r,n){var i=pje(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},lR.apply(this,arguments)}function pje(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Kg(e),e!==null););return e}function mje(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&WN(e,t)}function WN(e,t){return WN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},WN(e,t)}function yje(e){var t=_je();return function(){var n=Kg(e),i;if(t){var o=Kg(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return gje(this,i)}}function gje(e,t){if(t&&(Yg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return vje(e)}function vje(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _je(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Kg(e){return Kg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Kg(e)}var bje="dropdown",l3=function(e){mje(r,e);var t=yje(r);function r(){return cje(this,r),t.apply(this,arguments)}return fje(r,[{key:"prepare",value:function(i,o,s,a,h,p){lR(Kg(r.prototype),"prepare",this).call(this,i,o,s,a,h,p),this.cellProperties.filter=!1,this.cellProperties.strict=!0}}],[{key:"EDITOR_TYPE",get:function(){return bje}}]),r}(s3);mr.getSingleton().add("beforeValidate",function(e,t,r){var n=this.getCellMeta(t,this.propToCol(r));n.editor===l3&&n.strict===void 0&&(n.filter=!1,n.strict=!0)});function qg(e){"@babel/helpers - typeof";return qg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qg(e)}function wje(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pK(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,xje(n.key),n)}}function Sje(e,t,r){return t&&pK(e.prototype,t),r&&pK(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function xje(e){var t=Cje(e,"string");return qg(t)==="symbol"?t:String(t)}function Cje(e,t){if(qg(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(qg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Eje(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&GN(e,t)}function GN(e,t){return GN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},GN(e,t)}function Tje(e){var t=kje();return function(){var n=kk(e),i;if(t){var o=kk(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Oje(this,i)}}function Oje(e,t){if(t&&(qg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Rje(e)}function Rje(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function kje(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function kk(e){return kk=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},kk(e)}var Pje="numeric",dae=function(e){Eje(r,e);var t=Tje(r);function r(){return wje(this,r),t.apply(this,arguments)}return Sje(r,null,[{key:"EDITOR_TYPE",get:function(){return Pje}}]),r}(nm);function Xg(e){"@babel/helpers - typeof";return Xg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xg(e)}function Aje(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mK(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Mje(n.key),n)}}function Ije(e,t,r){return t&&mK(e.prototype,t),r&&mK(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Mje(e){var t=Dje(e,"string");return Xg(t)==="symbol"?t:String(t)}function Dje(e,t){if(Xg(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Xg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function uR(){return typeof Reflect<"u"&&Reflect.get?uR=Reflect.get.bind():uR=function(t,r,n){var i=$je(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},uR.apply(this,arguments)}function $je(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Zg(e),e!==null););return e}function Lje(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&YN(e,t)}function YN(e,t){return YN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},YN(e,t)}function Nje(e){var t=zje();return function(){var n=Zg(e),i;if(t){var o=Zg(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Bje(this,i)}}function Bje(e,t){if(t&&(Xg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return jje(e)}function jje(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function zje(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Zg(e){return Zg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Zg(e)}var Fje="password",pae=function(e){Lje(r,e);var t=Nje(r);function r(){return Aje(this,r),t.apply(this,arguments)}return Ije(r,[{key:"createElements",value:function(){uR(Zg(r.prototype),"createElements",this).call(this),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,uu(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}],[{key:"EDITOR_TYPE",get:function(){return Fje}}]),r}(nm);function Dp(e){"@babel/helpers - typeof";return Dp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dp(e)}function Hje(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yK(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Uje(n.key),n)}}function Vje(e,t,r){return t&&yK(e.prototype,t),r&&yK(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Uje(e){var t=Wje(e,"string");return Dp(t)==="symbol"?t:String(t)}function Wje(e,t){if(Dp(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Dp(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function cR(){return typeof Reflect<"u"&&Reflect.get?cR=Reflect.get.bind():cR=function(t,r,n){var i=Gje(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},cR.apply(this,arguments)}function Gje(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Jg(e),e!==null););return e}function Yje(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&KN(e,t)}function KN(e,t){return KN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},KN(e,t)}function Kje(e){var t=Zje();return function(){var n=Jg(e),i;if(t){var o=Jg(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return qje(this,i)}}function qje(e,t){if(t&&(Dp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Xje(e)}function Xje(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Zje(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Jg(e){return Jg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Jg(e)}var b$="ht_editor_visible",gK="selectEditor",Jje="select",Qje=function(e){Yje(r,e);var t=Kje(r);function r(){return Hje(this,r),t.apply(this,arguments)}return Vje(r,[{key:"init",value:function(){this.select=this.hot.rootDocument.createElement("SELECT"),Ht(this.select,"htSelectEditor"),this.select.style.display="none",this.hot.rootElement.appendChild(this.select),this.registerHooks()}},{key:"getValue",value:function(){return this.select.value}},{key:"setValue",value:function(i){this.select.value=i}},{key:"open",value:function(){this._opened=!0,this.refreshDimensions(),this.select.style.display="";var i=this.hot.getShortcutManager();i.setActiveContextName("editor"),this.registerShortcuts()}},{key:"close",value:function(){this._opened=!1,this.select.style.display="none",Ur(this.select,b$)&&Kr(this.select,b$),this.unregisterShortcuts(),this.clearHooks()}},{key:"focus",value:function(){this.select.focus()}},{key:"registerHooks",value:function(){var i=this;this.addHook("afterScrollHorizontally",function(){return i.refreshDimensions()}),this.addHook("afterScrollVertically",function(){return i.refreshDimensions()}),this.addHook("afterColumnResize",function(){return i.refreshDimensions()}),this.addHook("afterRowResize",function(){return i.refreshDimensions()})}},{key:"prepare",value:function(i,o,s,a,h,p){var g=this;cR(Jg(r.prototype),"prepare",this).call(this,i,o,s,a,h,p);var S=this.cellProperties.selectOptions,T;typeof S=="function"?T=this.prepareOptions(S(this.row,this.col,this.prop)):T=this.prepareOptions(S),uu(this.select),pn(T,function(R,A){var $=g.hot.rootDocument.createElement("OPTION");$.value=A,ib($,R),g.select.appendChild($)})}},{key:"prepareOptions",value:function(i){var o={};if(Array.isArray(i))for(var s=0,a=i.length;s<a;s++)o[i[s]]=i[s];else Dp(i)==="object"&&(o=i);return o}},{key:"refreshValue",value:function(){var i=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=i,this.setValue(i),this.refreshDimensions()}},{key:"refreshDimensions",value:function(){if(this.state===To.EDITING){if(this.TD=this.getEditedCell(),!this.TD){this.close();return}var i=this.getEditedCellRect(),o=i.top,s=i.start,a=i.width,h=i.height,p=this.select.style;p.height="".concat(h,"px"),p.width="".concat(a,"px"),p.top="".concat(o,"px"),p[this.hot.isRtl()?"right":"left"]="".concat(s,"px"),p.margin="0px",Ht(this.select,b$)}}},{key:"registerShortcuts",value:function(){var i=this,o=this.hot.getShortcutManager(),s=o.getContext("editor"),a={group:gK};this.isInFullEditMode()!==!1&&s.addShortcuts([{keys:[["ArrowUp"]],callback:function(){var p=i.select.selectedIndex-1;p>=0&&(i.select[p].selected=!0)}},{keys:[["ArrowDown"]],callback:function(){var p=i.select.selectedIndex+1;p<=i.select.length-1&&(i.select[p].selected=!0)}}],a)}},{key:"unregisterShortcuts",value:function(){var i=this.hot.getShortcutManager(),o=i.getContext("editor");o.removeShortcutsByGroup(gK)}}],[{key:"EDITOR_TYPE",get:function(){return Jje}}]),r}(ob);function Qg(e){"@babel/helpers - typeof";return Qg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qg(e)}function eze(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function vK(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,rze(n.key),n)}}function tze(e,t,r){return t&&vK(e.prototype,t),r&&vK(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function rze(e){var t=nze(e,"string");return Qg(t)==="symbol"?t:String(t)}function nze(e,t){if(Qg(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Qg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function fR(){return typeof Reflect<"u"&&Reflect.get?fR=Reflect.get.bind():fR=function(t,r,n){var i=ize(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},fR.apply(this,arguments)}function ize(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=ev(e),e!==null););return e}function oze(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&qN(e,t)}function qN(e,t){return qN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},qN(e,t)}function aze(e){var t=uze();return function(){var n=ev(e),i;if(t){var o=ev(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return sze(this,i)}}function sze(e,t){if(t&&(Qg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return lze(e)}function lze(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function uze(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ev(e){return ev=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ev(e)}var cze="time",mae=function(e){oze(r,e);var t=aze(r);function r(){return eze(this,r),t.apply(this,arguments)}return tze(r,[{key:"prepare",value:function(i,o,s,a,h,p){fR(ev(r.prototype),"prepare",this).call(this,i,o,s,a,h,p),this.TEXTAREA.dir="ltr"}}],[{key:"EDITOR_TYPE",get:function(){return cze}}]),r}(nm);function fze(){Qa(ob),Qa(s3),Qa(uae),Qa(hae),Qa(l3),Qa(a3),Qa(dae),Qa(pae),Qa(Qje),Qa(nm),Qa(mae)}var hze="html";function u3(e,t,r,n,i,o,s){hC.apply(this,[e,t,r,n,i,o,s]),ib(t,o??"",!1)}u3.RENDERER_TYPE=hze;var dze="autocomplete";function ab(e,t,r,n,i,o,s){var a=e.rootDocument,h=s.allowHtml?u3:xh,p=a.createElement("DIV");if(p.className="htAutocompleteArrow",p.appendChild(a.createTextNode(String.fromCharCode(9660))),h.apply(this,[e,t,r,n,i,o,s]),t.firstChild||t.appendChild(a.createTextNode(String.fromCharCode(160))),t.insertBefore(p,t.firstChild),Ht(t,"htAutocomplete"),!e.acArrowListener){var g=new Bi(e);e.acArrowListener=function(S){Ur(S.target,"htAutocompleteArrow")&&e.view._wt.getSetting("onCellDblClick",null,e._createCellCoords(r,n),t)},g.addEventListener(e.rootElement,"mousedown",e.acArrowListener),e.addHookOnce("afterDestroy",function(){g.destroy()})}}ab.RENDERER_TYPE=dze;var _K=new WeakMap,bK=new WeakMap,pze="htBadValue",tv="data-row",rv="data-col",mze="checkboxRenderer",yae="checkbox";mr.getSingleton().add("modifyAutoColumnSizeSeed",function(e,t,r){var n=t.label,i=t.type,o=t.row,s=t.column,a=t.prop;if(i===yae){if(n){var h=n.value,p=n.property,g=r;if(h)g=typeof h=="function"?h(o,s,a,r):h;else if(p){var S=this.getDataAtRowProp(o,p);g=S!==null?S:r}e=g}return e}});function c3(e,t,r,n,i,o,s){var a=e.rootDocument;hC.apply(this,[e,t,r,n,i,o,s]),yze(e);var h=gze(a),p=s.label,g=!1;if(typeof s.checkedTemplate>"u"&&(s.checkedTemplate=!0),typeof s.uncheckedTemplate>"u"&&(s.uncheckedTemplate=!1),uu(t),o===s.checkedTemplate||Xi(o).toLocaleLowerCase(s.locale)===Xi(s.checkedTemplate).toLocaleLowerCase(s.locale)?h.checked=!0:o===s.uncheckedTemplate||Xi(o).toLocaleLowerCase(s.locale)===Xi(s.uncheckedTemplate).toLocaleLowerCase(s.locale)?h.checked=!1:go(o)?Ht(h,"noValue"):(h.style.display="none",Ht(h,pze),g=!0),h.setAttribute(tv,r),h.setAttribute(rv,n),!g&&p){var S="";if(p.value)S=typeof p.value=="function"?p.value.call(this,r,n,i,o):p.value;else if(p.property){var T=e.getDataAtRowProp(r,p.property);S=T!==null?T:""}var R=vze(a,S,p.separated!==!0);p.position==="before"?p.separated?(t.appendChild(R),t.appendChild(h)):(R.appendChild(h),h=R):(!p.position||p.position==="after")&&(p.separated?(t.appendChild(h),t.appendChild(R)):(R.insertBefore(h,R.firstChild),h=R))}(!p||p&&!p.separated)&&t.appendChild(h),g&&t.appendChild(a.createTextNode("#bad-value#")),_K.has(e)||(_K.set(e,!0),A());function A(){var z=e.getShortcutManager(),V=z.getContext("grid"),G={group:mze};V.addShortcuts([{keys:[["space"]],callback:function(){return $(),!j()}},{keys:[["enter"]],callback:function(){return $(),!j()},runOnlyIf:function(){return e.getSettings().enterBeginsEditing}},{keys:[["delete"],["backspace"]],callback:function(){return $(!0),!j()},relativeToGroup:H0,position:"before"}],G)}function $(){var z=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,V=e.getSelectedRange();if(V)for(var G=0;G<V.length;G++){for(var ee=V[G].getTopStartCorner(),K=ee.row,xe=ee.col,Me=V[G].getBottomEndCorner(),He=Me.row,Ne=Me.col,We=[],gt=K;gt<=He;gt+=1)for(var Lt=xe;Lt<=Ne;Lt+=1){var _t=e.getCellMeta(gt,Lt);if(_t.type!=="checkbox")return;if(_t.readOnly!==!0){typeof _t.checkedTemplate>"u"&&(_t.checkedTemplate=!0),typeof _t.uncheckedTemplate>"u"&&(_t.uncheckedTemplate=!1);var $e=e.getDataAtCell(gt,Lt);z===!1?[_t.checkedTemplate,_t.checkedTemplate.toString()].includes($e)?We.push([gt,Lt,_t.uncheckedTemplate]):[_t.uncheckedTemplate,_t.uncheckedTemplate.toString(),null,void 0].includes($e)&&We.push([gt,Lt,_t.checkedTemplate]):We.push([gt,Lt,_t.uncheckedTemplate])}}We.length>0&&e.setDataAtCell(We)}}function j(){var z=e.getSelectedRange();if(z){for(var V=0;V<z.length;V++)for(var G=z[V].getTopStartCorner(),ee=z[V].getBottomEndCorner(),K=G.row;K<=ee.row;K++)for(var xe=G.col;xe<=ee.col;xe++){var Me=e.getCellMeta(K,xe);if(Me.type!=="checkbox")return!1;var He=e.getCell(K,xe);if(He==null)return!0;var Ne=He.querySelectorAll("input[type=checkbox]");if(Ne.length>0&&!Me.readOnly)return!0}return!1}}}c3.RENDERER_TYPE=yae;function yze(e){var t=bK.get(e);if(!t){var r=e.rootElement;t=new Bi(e),t.addEventListener(r,"click",function(n){return bze(n,e)}),t.addEventListener(r,"mouseup",function(n){return _ze(n,e)}),t.addEventListener(r,"change",function(n){return wze(n,e)}),bK.set(e,t)}return t}function gze(e){var t=e.createElement("input");return t.className="htCheckboxRendererInput",t.type="checkbox",t.setAttribute("autocomplete","off"),t.setAttribute("tabindex","-1"),t.cloneNode(!1)}function vze(e,t,r){var n=e.createElement("label");return n.className="htCheckboxRendererLabel ".concat(r?"fullWidth":""),n.appendChild(e.createTextNode(t)),n.cloneNode(!0)}function _ze(e,t){var r=e.target;f3(r)&&(!r.hasAttribute(tv)||!r.hasAttribute(rv)||setTimeout(t.listen,10))}function bze(e,t){var r=e.target;if(f3(r)&&!(!r.hasAttribute(tv)||!r.hasAttribute(rv))){var n=parseInt(r.getAttribute(tv),10),i=parseInt(r.getAttribute(rv),10),o=t.getCellMeta(n,i);o.readOnly&&e.preventDefault()}}function wze(e,t){var r=e.target;if(f3(r)&&!(!r.hasAttribute(tv)||!r.hasAttribute(rv))){var n=parseInt(r.getAttribute(tv),10),i=parseInt(r.getAttribute(rv),10),o=t.getCellMeta(n,i);if(!o.readOnly){var s=null;e.target.checked?s=o.uncheckedTemplate===void 0?!0:o.checkedTemplate:s=o.uncheckedTemplate===void 0?!1:o.uncheckedTemplate,t.setDataAtCell(n,i,s)}}}function f3(e){return e.tagName==="INPUT"&&e.getAttribute("type")==="checkbox"}function tO(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var gae={exports:{}};(function(e,t){(function(r){e.exports=r()})(function(){return function r(n,i,o){function s(p,g){if(!i[p]){if(!n[p]){var S=typeof tO=="function"&&tO;if(!g&&S)return S(p,!0);if(a)return a(p,!0);var T=new Error("Cannot find module '"+p+"'");throw T.code="MODULE_NOT_FOUND",T}var R=i[p]={exports:{}};n[p][0].call(R.exports,function(A){return s(n[p][1][A]||A)},R,R.exports,r,n,i,o)}return i[p].exports}for(var a=typeof tO=="function"&&tO,h=0;h<o.length;h++)s(o[h]);return s}({1:[function(r,n,i){(function(o){var s,a=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,h=Math.ceil,p=Math.floor,g="[BigNumber Error] ",S=g+"Number primitive has more than 15 significant digits: ",T=1e14,R=14,A=9007199254740991,$=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],j=1e7,z=1e9;function V(Ne){var We=0|Ne;return 0<Ne||Ne===We?We:We-1}function G(Ne){for(var We,gt,Lt=1,_t=Ne.length,$e=Ne[0]+"";Lt<_t;){for(We=Ne[Lt++]+"",gt=R-We.length;gt--;We="0"+We);$e+=We}for(_t=$e.length;$e.charCodeAt(--_t)===48;);return $e.slice(0,_t+1||1)}function ee(Ne,We){var gt,Lt,_t=Ne.c,$e=We.c,Fe=Ne.s,At=We.s,Gt=Ne.e,ae=We.e;if(!Fe||!At)return null;if(gt=_t&&!_t[0],Lt=$e&&!$e[0],gt||Lt)return gt?Lt?0:-At:Fe;if(Fe!=At)return Fe;if(gt=Fe<0,Lt=Gt==ae,!_t||!$e)return Lt?0:!_t^gt?1:-1;if(!Lt)return ae<Gt^gt?1:-1;for(At=(Gt=_t.length)<(ae=$e.length)?Gt:ae,Fe=0;Fe<At;Fe++)if(_t[Fe]!=$e[Fe])return _t[Fe]>$e[Fe]^gt?1:-1;return Gt==ae?0:ae<Gt^gt?1:-1}function K(Ne,We,gt,Lt){if(Ne<We||gt<Ne||Ne!==(Ne<0?h(Ne):p(Ne)))throw Error(g+(Lt||"Argument")+(typeof Ne=="number"?Ne<We||gt<Ne?" out of range: ":" not an integer: ":" not a primitive number: ")+String(Ne))}function xe(Ne){var We=Ne.c.length-1;return V(Ne.e/R)==We&&Ne.c[We]%2!=0}function Me(Ne,We){return(1<Ne.length?Ne.charAt(0)+"."+Ne.slice(1):Ne)+(We<0?"e":"e+")+We}function He(Ne,We,gt){var Lt,_t;if(We<0){for(_t=gt+".";++We;_t+=gt);Ne=_t+Ne}else if(++We>(Lt=Ne.length)){for(_t=gt,We-=Lt;--We;_t+=gt);Ne+=_t}else We<Lt&&(Ne=Ne.slice(0,We)+"."+Ne.slice(We));return Ne}(s=function Ne(We){var gt,Lt,_t,$e,Fe,At,Gt,ae,D,U,q=et.prototype={constructor:et,toString:null,valueOf:null},ne=new et(1),ye=20,ve=4,ze=-7,je=21,Je=-1e7,xt=1e7,kt=!1,jt=1,yr=0,Ft={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"",suffix:""},Jt="0123456789abcdefghijklmnopqrstuvwxyz";function et(se,_e){var Re,Ke,Be,rt,Ue,Ve,st,Ze,ft=this;if(!(ft instanceof et))return new et(se,_e);if(_e==null){if(se instanceof et)return ft.s=se.s,ft.e=se.e,void(ft.c=(se=se.c)?se.slice():se);if((Ve=typeof se=="number")&&0*se==0){if(ft.s=1/se<0?(se=-se,-1):1,se===~~se){for(rt=0,Ue=se;10<=Ue;Ue/=10,rt++);return ft.e=rt,void(ft.c=[se])}Ze=String(se)}else{if(Ze=String(se),!a.test(Ze))return _t(ft,Ze,Ve);ft.s=Ze.charCodeAt(0)==45?(Ze=Ze.slice(1),-1):1}-1<(rt=Ze.indexOf("."))&&(Ze=Ze.replace(".","")),0<(Ue=Ze.search(/e/i))?(rt<0&&(rt=Ue),rt+=+Ze.slice(Ue+1),Ze=Ze.substring(0,Ue)):rt<0&&(rt=Ze.length)}else{if(K(_e,2,Jt.length,"Base"),Ze=String(se),_e==10)return Sr(ft=new et(se instanceof et?se:Ze),ye+ft.e+1,ve);if(Ve=typeof se=="number"){if(0*se!=0)return _t(ft,Ze,Ve,_e);if(ft.s=1/se<0?(Ze=Ze.slice(1),-1):1,et.DEBUG&&15<Ze.replace(/^0\.0*|\./,"").length)throw Error(S+se);Ve=!1}else ft.s=Ze.charCodeAt(0)===45?(Ze=Ze.slice(1),-1):1;for(Re=Jt.slice(0,_e),rt=Ue=0,st=Ze.length;Ue<st;Ue++)if(Re.indexOf(Ke=Ze.charAt(Ue))<0){if(Ke=="."){if(rt<Ue){rt=st;continue}}else if(!Be&&(Ze==Ze.toUpperCase()&&(Ze=Ze.toLowerCase())||Ze==Ze.toLowerCase()&&(Ze=Ze.toUpperCase()))){Be=!0,Ue=-1,rt=0;continue}return _t(ft,String(se),Ve,_e)}-1<(rt=(Ze=Lt(Ze,_e,10,ft.s)).indexOf("."))?Ze=Ze.replace(".",""):rt=Ze.length}for(Ue=0;Ze.charCodeAt(Ue)===48;Ue++);for(st=Ze.length;Ze.charCodeAt(--st)===48;);if(Ze=Ze.slice(Ue,++st)){if(st-=Ue,Ve&&et.DEBUG&&15<st&&(A<se||se!==p(se)))throw Error(S+ft.s*se);if(xt<(rt=rt-Ue-1))ft.c=ft.e=null;else if(rt<Je)ft.c=[ft.e=0];else{if(ft.e=rt,ft.c=[],Ue=(rt+1)%R,rt<0&&(Ue+=R),Ue<st){for(Ue&&ft.c.push(+Ze.slice(0,Ue)),st-=R;Ue<st;)ft.c.push(+Ze.slice(Ue,Ue+=R));Ze=Ze.slice(Ue),Ue=R-Ze.length}else Ue-=st;for(;Ue--;Ze+="0");ft.c.push(+Ze)}}else ft.c=[ft.e=0]}function wr(se,_e,Re,Ke){var Be,rt,Ue,Ve,st;if(Re==null?Re=ve:K(Re,0,8),!se.c)return se.toString();if(Be=se.c[0],Ue=se.e,_e==null)st=G(se.c),st=Ke==1||Ke==2&&(Ue<=ze||je<=Ue)?Me(st,Ue):He(st,Ue,"0");else if(rt=(se=Sr(new et(se),_e,Re)).e,Ve=(st=G(se.c)).length,Ke==1||Ke==2&&(_e<=rt||rt<=ze)){for(;Ve<_e;st+="0",Ve++);st=Me(st,rt)}else if(_e-=Ue,st=He(st,rt,"0"),Ve<rt+1){if(0<--_e)for(st+=".";_e--;st+="0");}else if(0<(_e+=rt-Ve))for(rt+1==Ve&&(st+=".");_e--;st+="0");return se.s<0&&Be?"-"+st:st}function $r(se,_e){for(var Re,Ke=1,Be=new et(se[0]);Ke<se.length;Ke++){if(!(Re=new et(se[Ke])).s){Be=Re;break}_e.call(Be,Re)&&(Be=Re)}return Be}function lr(se,_e,Re){for(var Ke=1,Be=_e.length;!_e[--Be];_e.pop());for(Be=_e[0];10<=Be;Be/=10,Ke++);return(Re=Ke+Re*R-1)>xt?se.c=se.e=null:se.c=Re<Je?[se.e=0]:(se.e=Re,_e),se}function Sr(se,_e,Re,Ke){var Be,rt,Ue,Ve,st,Ze,ft,zt=se.c,nr=$;if(zt){e:{for(Be=1,Ve=zt[0];10<=Ve;Ve/=10,Be++);if((rt=_e-Be)<0)rt+=R,Ue=_e,ft=(st=zt[Ze=0])/nr[Be-Ue-1]%10|0;else if((Ze=h((rt+1)/R))>=zt.length){if(!Ke)break e;for(;zt.length<=Ze;zt.push(0));st=ft=0,Ue=(rt%=R)-R+(Be=1)}else{for(st=Ve=zt[Ze],Be=1;10<=Ve;Ve/=10,Be++);ft=(Ue=(rt%=R)-R+Be)<0?0:st/nr[Be-Ue-1]%10|0}if(Ke=Ke||_e<0||zt[Ze+1]!=null||(Ue<0?st:st%nr[Be-Ue-1]),Ke=Re<4?(ft||Ke)&&(Re==0||Re==(se.s<0?3:2)):5<ft||ft==5&&(Re==4||Ke||Re==6&&(0<rt?0<Ue?st/nr[Be-Ue]:0:zt[Ze-1])%10&1||Re==(se.s<0?8:7)),_e<1||!zt[0])return zt.length=0,Ke?(_e-=se.e+1,zt[0]=nr[(R-_e%R)%R],se.e=-_e||0):zt[0]=se.e=0,se;if(rt==0?(zt.length=Ze,Ve=1,Ze--):(zt.length=Ze+1,Ve=nr[R-rt],zt[Ze]=0<Ue?p(st/nr[Be-Ue]%nr[Ue])*Ve:0),Ke)for(;;){if(Ze==0){for(rt=1,Ue=zt[0];10<=Ue;Ue/=10,rt++);for(Ue=zt[0]+=Ve,Ve=1;10<=Ue;Ue/=10,Ve++);rt!=Ve&&(se.e++,zt[0]==T&&(zt[0]=1));break}if(zt[Ze]+=Ve,zt[Ze]!=T)break;zt[Ze--]=0,Ve=1}for(rt=zt.length;zt[--rt]===0;zt.pop());}se.e>xt?se.c=se.e=null:se.e<Je&&(se.c=[se.e=0])}return se}function Or(se){var _e,Re=se.e;return Re===null?se.toString():(_e=G(se.c),_e=Re<=ze||je<=Re?Me(_e,Re):He(_e,Re,"0"),se.s<0?"-"+_e:_e)}return et.clone=Ne,et.ROUND_UP=0,et.ROUND_DOWN=1,et.ROUND_CEIL=2,et.ROUND_FLOOR=3,et.ROUND_HALF_UP=4,et.ROUND_HALF_DOWN=5,et.ROUND_HALF_EVEN=6,et.ROUND_HALF_CEIL=7,et.ROUND_HALF_FLOOR=8,et.EUCLID=9,et.config=et.set=function(se){var _e,Re;if(se!=null){if(typeof se!="object")throw Error(g+"Object expected: "+se);if(se.hasOwnProperty(_e="DECIMAL_PLACES")&&(K(Re=se[_e],0,z,_e),ye=Re),se.hasOwnProperty(_e="ROUNDING_MODE")&&(K(Re=se[_e],0,8,_e),ve=Re),se.hasOwnProperty(_e="EXPONENTIAL_AT")&&((Re=se[_e])&&Re.pop?(K(Re[0],-z,0,_e),K(Re[1],0,z,_e),ze=Re[0],je=Re[1]):(K(Re,-z,z,_e),ze=-(je=Re<0?-Re:Re))),se.hasOwnProperty(_e="RANGE"))if((Re=se[_e])&&Re.pop)K(Re[0],-z,-1,_e),K(Re[1],1,z,_e),Je=Re[0],xt=Re[1];else{if(K(Re,-z,z,_e),!Re)throw Error(g+_e+" cannot be zero: "+Re);Je=-(xt=Re<0?-Re:Re)}if(se.hasOwnProperty(_e="CRYPTO")){if((Re=se[_e])!==!!Re)throw Error(g+_e+" not true or false: "+Re);if(Re){if(typeof crypto>"u"||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw kt=!Re,Error(g+"crypto unavailable");kt=Re}else kt=Re}if(se.hasOwnProperty(_e="MODULO_MODE")&&(K(Re=se[_e],0,9,_e),jt=Re),se.hasOwnProperty(_e="POW_PRECISION")&&(K(Re=se[_e],0,z,_e),yr=Re),se.hasOwnProperty(_e="FORMAT")){if(typeof(Re=se[_e])!="object")throw Error(g+_e+" not an object: "+Re);Ft=Re}if(se.hasOwnProperty(_e="ALPHABET")){if(typeof(Re=se[_e])!="string"||/^.$|[+-.\s]|(.).*\1/.test(Re))throw Error(g+_e+" invalid: "+Re);Jt=Re}}return{DECIMAL_PLACES:ye,ROUNDING_MODE:ve,EXPONENTIAL_AT:[ze,je],RANGE:[Je,xt],CRYPTO:kt,MODULO_MODE:jt,POW_PRECISION:yr,FORMAT:Ft,ALPHABET:Jt}},et.isBigNumber=function(se){return se instanceof et||se&&se._isBigNumber===!0||!1},et.maximum=et.max=function(){return $r(arguments,q.lt)},et.minimum=et.min=function(){return $r(arguments,q.gt)},et.random=($e=9007199254740992,Fe=Math.random()*$e&2097151?function(){return p(Math.random()*$e)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(se){var _e,Re,Ke,Be,rt,Ue=0,Ve=[],st=new et(ne);if(se==null?se=ye:K(se,0,z),Be=h(se/R),kt)if(crypto.getRandomValues){for(_e=crypto.getRandomValues(new Uint32Array(Be*=2));Ue<Be;)9e15<=(rt=131072*_e[Ue]+(_e[Ue+1]>>>11))?(Re=crypto.getRandomValues(new Uint32Array(2)),_e[Ue]=Re[0],_e[Ue+1]=Re[1]):(Ve.push(rt%1e14),Ue+=2);Ue=Be/2}else{if(!crypto.randomBytes)throw kt=!1,Error(g+"crypto unavailable");for(_e=crypto.randomBytes(Be*=7);Ue<Be;)9e15<=(rt=281474976710656*(31&_e[Ue])+1099511627776*_e[Ue+1]+4294967296*_e[Ue+2]+16777216*_e[Ue+3]+(_e[Ue+4]<<16)+(_e[Ue+5]<<8)+_e[Ue+6])?crypto.randomBytes(7).copy(_e,Ue):(Ve.push(rt%1e14),Ue+=7);Ue=Be/7}if(!kt)for(;Ue<Be;)(rt=Fe())<9e15&&(Ve[Ue++]=rt%1e14);for(Be=Ve[--Ue],se%=R,Be&&se&&(rt=$[R-se],Ve[Ue]=p(Be/rt)*rt);Ve[Ue]===0;Ve.pop(),Ue--);if(Ue<0)Ve=[Ke=0];else{for(Ke=-1;Ve[0]===0;Ve.splice(0,1),Ke-=R);for(Ue=1,rt=Ve[0];10<=rt;rt/=10,Ue++);Ue<R&&(Ke-=R-Ue)}return st.e=Ke,st.c=Ve,st}),et.sum=function(){for(var se=1,_e=arguments,Re=new et(_e[0]);se<_e.length;)Re=Re.plus(_e[se++]);return Re},Lt=function(){var se="0123456789";function _e(Re,Ke,Be,rt){for(var Ue,Ve,st=[0],Ze=0,ft=Re.length;Ze<ft;){for(Ve=st.length;Ve--;st[Ve]*=Ke);for(st[0]+=rt.indexOf(Re.charAt(Ze++)),Ue=0;Ue<st.length;Ue++)st[Ue]>Be-1&&(st[Ue+1]==null&&(st[Ue+1]=0),st[Ue+1]+=st[Ue]/Be|0,st[Ue]%=Be)}return st.reverse()}return function(Re,Ke,Be,rt,Ue){var Ve,st,Ze,ft,zt,nr,cr,Pr,Vr=Re.indexOf("."),gn=ye,Ir=ve;for(0<=Vr&&(ft=yr,yr=0,Re=Re.replace(".",""),nr=(Pr=new et(Ke)).pow(Re.length-Vr),yr=ft,Pr.c=_e(He(G(nr.c),nr.e,"0"),10,Be,se),Pr.e=Pr.c.length),Ze=ft=(cr=_e(Re,Ke,Be,Ue?(Ve=Jt,se):(Ve=se,Jt))).length;cr[--ft]==0;cr.pop());if(!cr[0])return Ve.charAt(0);if(Vr<0?--Ze:(nr.c=cr,nr.e=Ze,nr.s=rt,cr=(nr=gt(nr,Pr,gn,Ir,Be)).c,zt=nr.r,Ze=nr.e),Vr=cr[st=Ze+gn+1],ft=Be/2,zt=zt||st<0||cr[st+1]!=null,zt=Ir<4?(Vr!=null||zt)&&(Ir==0||Ir==(nr.s<0?3:2)):ft<Vr||Vr==ft&&(Ir==4||zt||Ir==6&&1&cr[st-1]||Ir==(nr.s<0?8:7)),st<1||!cr[0])Re=zt?He(Ve.charAt(1),-gn,Ve.charAt(0)):Ve.charAt(0);else{if(cr.length=st,zt)for(--Be;++cr[--st]>Be;)cr[st]=0,st||(++Ze,cr=[1].concat(cr));for(ft=cr.length;!cr[--ft];);for(Vr=0,Re="";Vr<=ft;Re+=Ve.charAt(cr[Vr++]));Re=He(Re,Ze,Ve.charAt(0))}return Re}}(),gt=function(){function se(Ke,Be,rt){var Ue,Ve,st,Ze,ft=0,zt=Ke.length,nr=Be%j,cr=Be/j|0;for(Ke=Ke.slice();zt--;)ft=((Ve=nr*(st=Ke[zt]%j)+(Ue=cr*st+(Ze=Ke[zt]/j|0)*nr)%j*j+ft)/rt|0)+(Ue/j|0)+cr*Ze,Ke[zt]=Ve%rt;return ft&&(Ke=[ft].concat(Ke)),Ke}function _e(Ke,Be,rt,Ue){var Ve,st;if(rt!=Ue)st=Ue<rt?1:-1;else for(Ve=st=0;Ve<rt;Ve++)if(Ke[Ve]!=Be[Ve]){st=Ke[Ve]>Be[Ve]?1:-1;break}return st}function Re(Ke,Be,rt,Ue){for(var Ve=0;rt--;)Ke[rt]-=Ve,Ve=Ke[rt]<Be[rt]?1:0,Ke[rt]=Ve*Ue+Ke[rt]-Be[rt];for(;!Ke[0]&&1<Ke.length;Ke.splice(0,1));}return function(Ke,Be,rt,Ue,Ve){var st,Ze,ft,zt,nr,cr,Pr,Vr,gn,Ir,Ar,sn,on,Fr,jr,tn,ei,xn=Ke.s==Be.s?1:-1,ln=Ke.c,zr=Be.c;if(!(ln&&ln[0]&&zr&&zr[0]))return new et(Ke.s&&Be.s&&(ln?!zr||ln[0]!=zr[0]:zr)?ln&&ln[0]==0||!zr?0*xn:xn/0:NaN);for(gn=(Vr=new et(xn)).c=[],xn=rt+(Ze=Ke.e-Be.e)+1,Ve||(Ve=T,Ze=V(Ke.e/R)-V(Be.e/R),xn=xn/R|0),ft=0;zr[ft]==(ln[ft]||0);ft++);if(zr[ft]>(ln[ft]||0)&&Ze--,xn<0)gn.push(1),zt=!0;else{for(Fr=ln.length,tn=zr.length,xn+=2,1<(nr=p(Ve/(zr[ft=0]+1)))&&(zr=se(zr,nr,Ve),ln=se(ln,nr,Ve),tn=zr.length,Fr=ln.length),on=tn,Ar=(Ir=ln.slice(0,tn)).length;Ar<tn;Ir[Ar++]=0);ei=zr.slice(),ei=[0].concat(ei),jr=zr[0],zr[1]>=Ve/2&&jr++;do{if(nr=0,(st=_e(zr,Ir,tn,Ar))<0){if(sn=Ir[0],tn!=Ar&&(sn=sn*Ve+(Ir[1]||0)),1<(nr=p(sn/jr)))for(Ve<=nr&&(nr=Ve-1),Pr=(cr=se(zr,nr,Ve)).length,Ar=Ir.length;_e(cr,Ir,Pr,Ar)==1;)nr--,Re(cr,tn<Pr?ei:zr,Pr,Ve),Pr=cr.length,st=1;else nr==0&&(st=nr=1),Pr=(cr=zr.slice()).length;if(Pr<Ar&&(cr=[0].concat(cr)),Re(Ir,cr,Ar,Ve),Ar=Ir.length,st==-1)for(;_e(zr,Ir,tn,Ar)<1;)nr++,Re(Ir,tn<Ar?ei:zr,Ar,Ve),Ar=Ir.length}else st===0&&(nr++,Ir=[0]);gn[ft++]=nr,Ir[0]?Ir[Ar++]=ln[on]||0:(Ir=[ln[on]],Ar=1)}while((on++<Fr||Ir[0]!=null)&&xn--);zt=Ir[0]!=null,gn[0]||gn.splice(0,1)}if(Ve==T){for(ft=1,xn=gn[0];10<=xn;xn/=10,ft++);Sr(Vr,rt+(Vr.e=ft+Ze*R-1)+1,Ue,zt)}else Vr.e=Ze,Vr.r=+zt;return Vr}}(),At=/^(-?)0([xbo])(?=\w[\w.]*$)/i,Gt=/^([^.]+)\.$/,ae=/^\.([^.]+)$/,D=/^-?(Infinity|NaN)$/,U=/^\s*\+(?=[\w.])|^\s+|\s+$/g,_t=function(se,_e,Re,Ke){var Be,rt=Re?_e:_e.replace(U,"");if(D.test(rt))se.s=isNaN(rt)?null:rt<0?-1:1,se.c=se.e=null;else{if(!Re&&(rt=rt.replace(At,function(Ue,Ve,st){return Be=(st=st.toLowerCase())=="x"?16:st=="b"?2:8,Ke&&Ke!=Be?Ue:Ve}),Ke&&(Be=Ke,rt=rt.replace(Gt,"$1").replace(ae,"0.$1")),_e!=rt))return new et(rt,Be);if(et.DEBUG)throw Error(g+"Not a"+(Ke?" base "+Ke:"")+" number: "+_e);se.c=se.e=se.s=null}},q.absoluteValue=q.abs=function(){var se=new et(this);return se.s<0&&(se.s=1),se},q.comparedTo=function(se,_e){return ee(this,new et(se,_e))},q.decimalPlaces=q.dp=function(se,_e){var Re,Ke,Be;if(se!=null)return K(se,0,z),_e==null?_e=ve:K(_e,0,8),Sr(new et(this),se+this.e+1,_e);if(!(Re=this.c))return null;if(Ke=((Be=Re.length-1)-V(this.e/R))*R,Be=Re[Be])for(;Be%10==0;Be/=10,Ke--);return Ke<0&&(Ke=0),Ke},q.dividedBy=q.div=function(se,_e){return gt(this,new et(se,_e),ye,ve)},q.dividedToIntegerBy=q.idiv=function(se,_e){return gt(this,new et(se,_e),0,1)},q.exponentiatedBy=q.pow=function(se,_e){var Re,Ke,Be,rt,Ue,Ve,st,Ze,ft=this;if((se=new et(se)).c&&!se.isInteger())throw Error(g+"Exponent not an integer: "+Or(se));if(_e!=null&&(_e=new et(_e)),Ue=14<se.e,!ft.c||!ft.c[0]||ft.c[0]==1&&!ft.e&&ft.c.length==1||!se.c||!se.c[0])return Ze=new et(Math.pow(+Or(ft),Ue?2-xe(se):+Or(se))),_e?Ze.mod(_e):Ze;if(Ve=se.s<0,_e){if(_e.c?!_e.c[0]:!_e.s)return new et(NaN);(Ke=!Ve&&ft.isInteger()&&_e.isInteger())&&(ft=ft.mod(_e))}else{if(9<se.e&&(0<ft.e||ft.e<-1||(ft.e==0?1<ft.c[0]||Ue&&24e7<=ft.c[1]:ft.c[0]<8e13||Ue&&ft.c[0]<=9999975e7)))return rt=ft.s<0&&xe(se)?-0:0,-1<ft.e&&(rt=1/rt),new et(Ve?1/rt:rt);yr&&(rt=h(yr/R+2))}for(st=Ue?(Re=new et(.5),Ve&&(se.s=1),xe(se)):(Be=Math.abs(+Or(se)))%2,Ze=new et(ne);;){if(st){if(!(Ze=Ze.times(ft)).c)break;rt?Ze.c.length>rt&&(Ze.c.length=rt):Ke&&(Ze=Ze.mod(_e))}if(Be){if((Be=p(Be/2))===0)break;st=Be%2}else if(Sr(se=se.times(Re),se.e+1,1),14<se.e)st=xe(se);else{if((Be=+Or(se))==0)break;st=Be%2}ft=ft.times(ft),rt?ft.c&&ft.c.length>rt&&(ft.c.length=rt):Ke&&(ft=ft.mod(_e))}return Ke?Ze:(Ve&&(Ze=ne.div(Ze)),_e?Ze.mod(_e):rt?Sr(Ze,yr,ve,void 0):Ze)},q.integerValue=function(se){var _e=new et(this);return se==null?se=ve:K(se,0,8),Sr(_e,_e.e+1,se)},q.isEqualTo=q.eq=function(se,_e){return ee(this,new et(se,_e))===0},q.isFinite=function(){return!!this.c},q.isGreaterThan=q.gt=function(se,_e){return 0<ee(this,new et(se,_e))},q.isGreaterThanOrEqualTo=q.gte=function(se,_e){return(_e=ee(this,new et(se,_e)))===1||_e===0},q.isInteger=function(){return!!this.c&&V(this.e/R)>this.c.length-2},q.isLessThan=q.lt=function(se,_e){return ee(this,new et(se,_e))<0},q.isLessThanOrEqualTo=q.lte=function(se,_e){return(_e=ee(this,new et(se,_e)))===-1||_e===0},q.isNaN=function(){return!this.s},q.isNegative=function(){return this.s<0},q.isPositive=function(){return 0<this.s},q.isZero=function(){return!!this.c&&this.c[0]==0},q.minus=function(se,_e){var Re,Ke,Be,rt,Ue=this,Ve=Ue.s;if(_e=(se=new et(se,_e)).s,!Ve||!_e)return new et(NaN);if(Ve!=_e)return se.s=-_e,Ue.plus(se);var st=Ue.e/R,Ze=se.e/R,ft=Ue.c,zt=se.c;if(!st||!Ze){if(!ft||!zt)return ft?(se.s=-_e,se):new et(zt?Ue:NaN);if(!ft[0]||!zt[0])return zt[0]?(se.s=-_e,se):new et(ft[0]?Ue:ve==3?-0:0)}if(st=V(st),Ze=V(Ze),ft=ft.slice(),Ve=st-Ze){for((Be=(rt=Ve<0)?(Ve=-Ve,ft):(Ze=st,zt)).reverse(),_e=Ve;_e--;Be.push(0));Be.reverse()}else for(Ke=(rt=(Ve=ft.length)<(_e=zt.length))?Ve:_e,Ve=_e=0;_e<Ke;_e++)if(ft[_e]!=zt[_e]){rt=ft[_e]<zt[_e];break}if(rt&&(Be=ft,ft=zt,zt=Be,se.s=-se.s),0<(_e=(Ke=zt.length)-(Re=ft.length)))for(;_e--;ft[Re++]=0);for(_e=T-1;Ve<Ke;){if(ft[--Ke]<zt[Ke]){for(Re=Ke;Re&&!ft[--Re];ft[Re]=_e);--ft[Re],ft[Ke]+=T}ft[Ke]-=zt[Ke]}for(;ft[0]==0;ft.splice(0,1),--Ze);return ft[0]?lr(se,ft,Ze):(se.s=ve==3?-1:1,se.c=[se.e=0],se)},q.modulo=q.mod=function(se,_e){var Re,Ke,Be=this;return se=new et(se,_e),!Be.c||!se.s||se.c&&!se.c[0]?new et(NaN):!se.c||Be.c&&!Be.c[0]?new et(Be):(jt==9?(Ke=se.s,se.s=1,Re=gt(Be,se,0,3),se.s=Ke,Re.s*=Ke):Re=gt(Be,se,0,jt),(se=Be.minus(Re.times(se))).c[0]||jt!=1||(se.s=Be.s),se)},q.multipliedBy=q.times=function(se,_e){var Re,Ke,Be,rt,Ue,Ve,st,Ze,ft,zt,nr,cr,Pr,Vr,gn,Ir=this,Ar=Ir.c,sn=(se=new et(se,_e)).c;if(!(Ar&&sn&&Ar[0]&&sn[0]))return!Ir.s||!se.s||Ar&&!Ar[0]&&!sn||sn&&!sn[0]&&!Ar?se.c=se.e=se.s=null:(se.s*=Ir.s,Ar&&sn?(se.c=[0],se.e=0):se.c=se.e=null),se;for(Ke=V(Ir.e/R)+V(se.e/R),se.s*=Ir.s,(st=Ar.length)<(zt=sn.length)&&(Pr=Ar,Ar=sn,sn=Pr,Be=st,st=zt,zt=Be),Be=st+zt,Pr=[];Be--;Pr.push(0));for(Vr=T,gn=j,Be=zt;0<=--Be;){for(Re=0,nr=sn[Be]%gn,cr=sn[Be]/gn|0,rt=Be+(Ue=st);Be<rt;)Re=((Ze=nr*(Ze=Ar[--Ue]%gn)+(Ve=cr*Ze+(ft=Ar[Ue]/gn|0)*nr)%gn*gn+Pr[rt]+Re)/Vr|0)+(Ve/gn|0)+cr*ft,Pr[rt--]=Ze%Vr;Pr[rt]=Re}return Re?++Ke:Pr.splice(0,1),lr(se,Pr,Ke)},q.negated=function(){var se=new et(this);return se.s=-se.s||null,se},q.plus=function(se,_e){var Re,Ke=this,Be=Ke.s;if(_e=(se=new et(se,_e)).s,!Be||!_e)return new et(NaN);if(Be!=_e)return se.s=-_e,Ke.minus(se);var rt=Ke.e/R,Ue=se.e/R,Ve=Ke.c,st=se.c;if(!rt||!Ue){if(!Ve||!st)return new et(Be/0);if(!Ve[0]||!st[0])return st[0]?se:new et(Ve[0]?Ke:0*Be)}if(rt=V(rt),Ue=V(Ue),Ve=Ve.slice(),Be=rt-Ue){for((Re=0<Be?(Ue=rt,st):(Be=-Be,Ve)).reverse();Be--;Re.push(0));Re.reverse()}for((Be=Ve.length)-(_e=st.length)<0&&(Re=st,st=Ve,Ve=Re,_e=Be),Be=0;_e;)Be=(Ve[--_e]=Ve[_e]+st[_e]+Be)/T|0,Ve[_e]=T===Ve[_e]?0:Ve[_e]%T;return Be&&(Ve=[Be].concat(Ve),++Ue),lr(se,Ve,Ue)},q.precision=q.sd=function(se,_e){var Re,Ke,Be;if(se!=null&&se!==!!se)return K(se,1,z),_e==null?_e=ve:K(_e,0,8),Sr(new et(this),se,_e);if(!(Re=this.c))return null;if(Ke=(Be=Re.length-1)*R+1,Be=Re[Be]){for(;Be%10==0;Be/=10,Ke--);for(Be=Re[0];10<=Be;Be/=10,Ke++);}return se&&this.e+1>Ke&&(Ke=this.e+1),Ke},q.shiftedBy=function(se){return K(se,-A,A),this.times("1e"+se)},q.squareRoot=q.sqrt=function(){var se,_e,Re,Ke,Be,rt=this,Ue=rt.c,Ve=rt.s,st=rt.e,Ze=ye+4,ft=new et("0.5");if(Ve!==1||!Ue||!Ue[0])return new et(!Ve||Ve<0&&(!Ue||Ue[0])?NaN:Ue?rt:1/0);if((Re=(Ve=Math.sqrt(+Or(rt)))==0||Ve==1/0?(((_e=G(Ue)).length+st)%2==0&&(_e+="0"),Ve=Math.sqrt(+_e),st=V((st+1)/2)-(st<0||st%2),new et(_e=Ve==1/0?"1e"+st:(_e=Ve.toExponential()).slice(0,_e.indexOf("e")+1)+st)):new et(Ve+"")).c[0]){for((Ve=(st=Re.e)+Ze)<3&&(Ve=0);;)if(Be=Re,Re=ft.times(Be.plus(gt(rt,Be,Ze,1))),G(Be.c).slice(0,Ve)===(_e=G(Re.c)).slice(0,Ve)){if(Re.e<st&&--Ve,(_e=_e.slice(Ve-3,Ve+1))!="9999"&&(Ke||_e!="4999")){+_e&&(+_e.slice(1)||_e.charAt(0)!="5")||(Sr(Re,Re.e+ye+2,1),se=!Re.times(Re).eq(rt));break}if(!Ke&&(Sr(Be,Be.e+ye+2,0),Be.times(Be).eq(rt))){Re=Be;break}Ze+=4,Ve+=4,Ke=1}}return Sr(Re,Re.e+ye+1,ve,se)},q.toExponential=function(se,_e){return se!=null&&(K(se,0,z),se++),wr(this,se,_e,1)},q.toFixed=function(se,_e){return se!=null&&(K(se,0,z),se=se+this.e+1),wr(this,se,_e)},q.toFormat=function(se,_e,Re){var Ke;if(Re==null)se!=null&&_e&&typeof _e=="object"?(Re=_e,_e=null):se&&typeof se=="object"?(Re=se,se=_e=null):Re=Ft;else if(typeof Re!="object")throw Error(g+"Argument not an object: "+Re);if(Ke=this.toFixed(se,_e),this.c){var Be,rt=Ke.split("."),Ue=+Re.groupSize,Ve=+Re.secondaryGroupSize,st=Re.groupSeparator||"",Ze=rt[0],ft=rt[1],zt=this.s<0,nr=zt?Ze.slice(1):Ze,cr=nr.length;if(Ve&&(Be=Ue,Ue=Ve,cr-=Ve=Be),0<Ue&&0<cr){for(Be=cr%Ue||Ue,Ze=nr.substr(0,Be);Be<cr;Be+=Ue)Ze+=st+nr.substr(Be,Ue);0<Ve&&(Ze+=st+nr.slice(Be)),zt&&(Ze="-"+Ze)}Ke=ft?Ze+(Re.decimalSeparator||"")+((Ve=+Re.fractionGroupSize)?ft.replace(new RegExp("\\d{"+Ve+"}\\B","g"),"$&"+(Re.fractionGroupSeparator||"")):ft):Ze}return(Re.prefix||"")+Ke+(Re.suffix||"")},q.toFraction=function(se){var _e,Re,Ke,Be,rt,Ue,Ve,st,Ze,ft,zt,nr,cr=this,Pr=cr.c;if(se!=null&&(!(Ve=new et(se)).isInteger()&&(Ve.c||Ve.s!==1)||Ve.lt(ne)))throw Error(g+"Argument "+(Ve.isInteger()?"out of range: ":"not an integer: ")+Or(Ve));if(!Pr)return new et(cr);for(_e=new et(ne),Ze=Re=new et(ne),Ke=st=new et(ne),nr=G(Pr),rt=_e.e=nr.length-cr.e-1,_e.c[0]=$[(Ue=rt%R)<0?R+Ue:Ue],se=!se||0<Ve.comparedTo(_e)?0<rt?_e:Ze:Ve,Ue=xt,xt=1/0,Ve=new et(nr),st.c[0]=0;ft=gt(Ve,_e,0,1),(Be=Re.plus(ft.times(Ke))).comparedTo(se)!=1;)Re=Ke,Ke=Be,Ze=st.plus(ft.times(Be=Ze)),st=Be,_e=Ve.minus(ft.times(Be=_e)),Ve=Be;return Be=gt(se.minus(Re),Ke,0,1),st=st.plus(Be.times(Ze)),Re=Re.plus(Be.times(Ke)),st.s=Ze.s=cr.s,zt=gt(Ze,Ke,rt*=2,ve).minus(cr).abs().comparedTo(gt(st,Re,rt,ve).minus(cr).abs())<1?[Ze,Ke]:[st,Re],xt=Ue,zt},q.toNumber=function(){return+Or(this)},q.toPrecision=function(se,_e){return se!=null&&K(se,1,z),wr(this,se,_e,2)},q.toString=function(se){var _e,Re=this,Ke=Re.s,Be=Re.e;return Be===null?Ke?(_e="Infinity",Ke<0&&(_e="-"+_e)):_e="NaN":(_e=se==null?Be<=ze||je<=Be?Me(G(Re.c),Be):He(G(Re.c),Be,"0"):se===10?He(G((Re=Sr(new et(Re),ye+Be+1,ve)).c),Re.e,"0"):(K(se,2,Jt.length,"Base"),Lt(He(G(Re.c),Be,"0"),10,se,Ke,!0)),Ke<0&&Re.c[0]&&(_e="-"+_e)),_e},q.valueOf=q.toJSON=function(){return Or(this)},q._isBigNumber=!0,typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"&&(q[Symbol.toStringTag]="BigNumber",q[Symbol.for("nodejs.util.inspect.custom")]=q.valueOf),We!=null&&et.set(We),et}()).default=s.BigNumber=s,n!==void 0&&n.exports?n.exports=s:(o||(o=typeof self<"u"&&self?self:window),o.BigNumber=s)})(this)},{}],2:[function(r,n,i){n.exports={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(o){var s=o%10;return~~(o%100/10)==1?"th":s===1?"st":s===2?"nd":s===3?"rd":"th"},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}},{}],3:[function(r,n,i){function o(V,G){return function(ee){if(Array.isArray(ee))return ee}(V)||function(ee,K){var xe=[],Me=!0,He=!1,Ne=void 0;try{for(var We,gt=ee[Symbol.iterator]();!(Me=(We=gt.next()).done)&&(xe.push(We.value),!K||xe.length!==K);Me=!0);}catch(Lt){He=!0,Ne=Lt}finally{try{Me||gt.return==null||gt.return()}finally{if(He)throw Ne}}return xe}(V,G)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var s=r("./globalState"),a=r("./validating"),h=r("./parsing"),p=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],g={general:{scale:1024,suffixes:p,marker:"bd"},binary:{scale:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],marker:"b"},decimal:{scale:1e3,suffixes:p,marker:"d"}},S={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1};function T(V){var G=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{},ee=2<arguments.length?arguments[2]:void 0;if(typeof G=="string"&&(G=h.parseFormat(G)),!a.validateFormat(G))return"ERROR: invalid format";var K=G.prefix||"",xe=G.postfix||"",Me=function(He,Ne,We){switch(Ne.output){case"currency":return Ne=z(Ne,s.currentCurrencyDefaultFormat()),function(Jt,et,wr){var $r=wr.currentCurrency(),lr=Object.assign({},S,et),Sr=void 0,Or="",se=!!lr.totalLength||!!lr.forceAverage||lr.average,_e=et.currencyPosition||$r.position,Re=et.currencySymbol||$r.symbol;lr.spaceSeparated&&(Or=" "),_e==="infix"&&(Sr=Or+Re+Or);var Ke=j({instance:Jt,providedFormat:et,state:wr,decimalSeparator:Sr});return _e==="prefix"&&(Ke=Jt._value<0&&lr.negative==="sign"?"-".concat(Or).concat(Re).concat(Ke.slice(1)):Re+Or+Ke),_e&&_e!=="postfix"||(Ke=Ke+(Or=se?"":Or)+Re),Ke}(He,Ne,s);case"percent":return Ne=z(Ne,s.currentPercentageDefaultFormat()),function(Jt,et,wr,$r){var lr=et.prefixSymbol,Sr=j({instance:$r(100*Jt._value),providedFormat:et,state:wr}),Or=Object.assign({},S,et);return lr?"%".concat(Or.spaceSeparated?" ":"").concat(Sr):"".concat(Sr).concat(Or.spaceSeparated?" ":"","%")}(He,Ne,s,We);case"byte":return Ne=z(Ne,s.currentByteDefaultFormat()),ne=He,ve=s,ze=We,je=(ye=Ne).base||"binary",Je=g[je],xt=R(ne._value,Je.suffixes,Je.scale),kt=xt.value,jt=xt.suffix,yr=j({instance:ze(kt),providedFormat:ye,state:ve,defaults:ve.currentByteDefaultFormat()}),Ft=ve.currentAbbreviations(),"".concat(yr).concat(Ft.spaced?" ":"").concat(jt);case"time":return Ne=z(Ne,s.currentTimeDefaultFormat()),ae=He,D=Math.floor(ae._value/60/60),U=Math.floor((ae._value-60*D*60)/60),q=Math.round(ae._value-60*D*60-60*U),"".concat(D,":").concat(U<10?"0":"").concat(U,":").concat(q<10?"0":"").concat(q);case"ordinal":return Ne=z(Ne,s.currentOrdinalDefaultFormat()),gt=He,Lt=Ne,$e=(_t=s).currentOrdinal(),Fe=Object.assign({},S,Lt),At=j({instance:gt,providedFormat:Lt,state:_t}),Gt=$e(gt._value),"".concat(At).concat(Fe.spaceSeparated?" ":"").concat(Gt);case"number":default:return j({instance:He,providedFormat:Ne,numbro:We})}var gt,Lt,_t,$e,Fe,At,Gt,ae,D,U,q,ne,ye,ve,ze,je,Je,xt,kt,jt,yr,Ft}(V,G,ee);return Me=(Me=K+Me)+xe}function R(V,G,ee){var K=G[0],xe=Math.abs(V);if(ee<=xe){for(var Me=1;Me<G.length;++Me){var He=Math.pow(ee,Me),Ne=Math.pow(ee,Me+1);if(He<=xe&&xe<Ne){K=G[Me],V/=He;break}}K===G[0]&&(V/=Math.pow(ee,G.length-1),K=G[G.length-1])}return{value:V,suffix:K}}function A(V){for(var G="",ee=0;ee<V;ee++)G+="0";return G}function $(V,G){return V.toString().indexOf("e")!==-1?function(ee,K){var xe=ee.toString(),Me=o(xe.split("e"),2),He=Me[0],Ne=Me[1],We=o(He.split("."),2),gt=We[0],Lt=We[1],_t=Lt===void 0?"":Lt;if(0<+Ne)xe=gt+_t+A(Ne-_t.length);else{var $e=".";$e=+gt<0?"-0".concat($e):"0".concat($e);var Fe=(A(-Ne-1)+Math.abs(gt)+_t).substr(0,K);Fe.length<K&&(Fe+=A(K-Fe.length)),xe=$e+Fe}return 0<+Ne&&0<K&&(xe+=".".concat(A(K))),xe}(V,G):(Math.round(+"".concat(V,"e+").concat(G))/Math.pow(10,G)).toFixed(G)}function j(V){var G=V.instance,ee=V.providedFormat,K=V.state,xe=K===void 0?s:K,Me=V.decimalSeparator,He=V.defaults,Ne=He===void 0?xe.currentDefaults():He,We=G._value;if(We===0&&xe.hasZeroFormat())return xe.getZeroFormat();if(!isFinite(We))return We.toString();var gt,Lt,_t,$e,Fe,At,Gt,ae,D=Object.assign({},S,Ne,ee),U=D.totalLength,q=U?0:D.characteristic,ne=D.optionalCharacteristic,ye=D.forceAverage,ve=!!U||!!ye||D.average,ze=U?-1:ve&&ee.mantissa===void 0?0:D.mantissa,je=!U&&(ee.optionalMantissa===void 0?ze===-1:D.optionalMantissa),Je=D.trimMantissa,xt=D.thousandSeparated,kt=D.spaceSeparated,jt=D.negative,yr=D.forceSign,Ft=D.exponential,Jt="";if(ve){var et=function(se){var _e=se.value,Re=se.forceAverage,Ke=se.abbreviations,Be=se.spaceSeparated,rt=Be!==void 0&&Be,Ue=se.totalLength,Ve=Ue===void 0?0:Ue,st="",Ze=Math.abs(_e),ft=-1;if(Ze>=Math.pow(10,12)&&!Re||Re==="trillion"?(st=Ke.trillion,_e/=Math.pow(10,12)):Ze<Math.pow(10,12)&&Ze>=Math.pow(10,9)&&!Re||Re==="billion"?(st=Ke.billion,_e/=Math.pow(10,9)):Ze<Math.pow(10,9)&&Ze>=Math.pow(10,6)&&!Re||Re==="million"?(st=Ke.million,_e/=Math.pow(10,6)):(Ze<Math.pow(10,6)&&Ze>=Math.pow(10,3)&&!Re||Re==="thousand")&&(st=Ke.thousand,_e/=Math.pow(10,3)),st&&(st=(rt?" ":"")+st),Ve){var zt=_e.toString().split(".")[0];ft=Math.max(Ve-zt.length,0)}return{value:_e,abbreviation:st,mantissaPrecision:ft}}({value:We,forceAverage:ye,abbreviations:xe.currentAbbreviations(),spaceSeparated:kt,totalLength:U});We=et.value,Jt+=et.abbreviation,U&&(ze=et.mantissaPrecision)}if(Ft){var wr=(Lt=(gt={value:We,characteristicPrecision:q}).value,_t=gt.characteristicPrecision,$e=_t===void 0?0:_t,Fe=o(Lt.toExponential().split("e"),2),At=Fe[0],Gt=Fe[1],ae=+At,$e&&1<$e&&(ae*=Math.pow(10,$e-1),Gt=0<=(Gt=+Gt-($e-1))?"+".concat(Gt):Gt),{value:ae,abbreviation:"e".concat(Gt)});We=wr.value,Jt=wr.abbreviation+Jt}var $r,lr,Sr,Or=function(se,_e,Re,Ke,Be){if(Ke===-1)return se;var rt=$(_e,Ke),Ue=o(rt.toString().split("."),2),Ve=Ue[0],st=Ue[1],Ze=st===void 0?"":st;if(Ze.match(/^0+$/)&&(Re||Be))return Ve;var ft=Ze.match(/0+$/);return Be&&ft?"".concat(Ve,".").concat(Ze.toString().slice(0,ft.index)):rt.toString()}(We.toString(),We,je,ze,Je);return Or=function(se,_e,Re,Ke,Be){var rt=Ke.currentDelimiters(),Ue=rt.thousands;Be=Be||rt.decimal;var Ve=rt.thousandsSize||3,st=se.toString(),Ze=st.split(".")[0],ft=st.split(".")[1];return Re&&(_e<0&&(Ze=Ze.slice(1)),function(zt,nr){for(var cr=[],Pr=0,Vr=zt;0<Vr;Vr--)Pr===nr&&(cr.unshift(Vr),Pr=0),Pr++;return cr}(Ze.length,Ve).forEach(function(zt,nr){Ze=Ze.slice(0,zt+nr)+Ue+Ze.slice(zt+nr)}),_e<0&&(Ze="-".concat(Ze))),st=ft?Ze+Be+ft:Ze}(Or=function(se,_e,Re,Ke){var Be=se,rt=o(Be.toString().split("."),2),Ue=rt[0],Ve=rt[1];if(Ue.match(/^-?0$/)&&Re)return Ve?"".concat(Ue.replace("0",""),".").concat(Ve):Ue.replace("0","");if(Ue.length<Ke)for(var st=Ke-Ue.length,Ze=0;Ze<st;Ze++)Be="0".concat(Be);return Be.toString()}(Or,0,ne,q),We,xt,xe,Me),(ve||Ft)&&(Or=Or+Jt),(yr||We<0)&&($r=Or,Sr=jt,Or=(lr=We)===0?$r:+$r==0?$r.replace("-",""):0<lr?"+".concat($r):Sr==="sign"?$r:"(".concat($r.replace("-",""),")")),Or}function z(V,G){if(!V)return G;var ee=Object.keys(V);return ee.length===1&&ee[0]==="output"?G:V}n.exports=function(V){return{format:function(){for(var G=arguments.length,ee=new Array(G),K=0;K<G;K++)ee[K]=arguments[K];return T.apply(void 0,ee.concat([V]))},getByteUnit:function(){for(var G=arguments.length,ee=new Array(G),K=0;K<G;K++)ee[K]=arguments[K];return function(xe){var Me=g.general;return R(xe._value,Me.suffixes,Me.scale).suffix}.apply(void 0,ee.concat([V]))},getBinaryByteUnit:function(){for(var G=arguments.length,ee=new Array(G),K=0;K<G;K++)ee[K]=arguments[K];return function(xe){var Me=g.binary;return R(xe._value,Me.suffixes,Me.scale).suffix}.apply(void 0,ee.concat([V]))},getDecimalByteUnit:function(){for(var G=arguments.length,ee=new Array(G),K=0;K<G;K++)ee[K]=arguments[K];return function(xe){var Me=g.decimal;return R(xe._value,Me.suffixes,Me.scale).suffix}.apply(void 0,ee.concat([V]))},formatOrDefault:z}}},{"./globalState":4,"./parsing":8,"./validating":10}],4:[function(r,n,i){var o=r("./en-US"),s=r("./validating"),a=r("./parsing"),h={},p=void 0,g={},S=null,T={};function R($){p=$}function A(){return g[p]}h.languages=function(){return Object.assign({},g)},h.currentLanguage=function(){return p},h.currentCurrency=function(){return A().currency},h.currentAbbreviations=function(){return A().abbreviations},h.currentDelimiters=function(){return A().delimiters},h.currentOrdinal=function(){return A().ordinal},h.currentDefaults=function(){return Object.assign({},A().defaults,T)},h.currentOrdinalDefaultFormat=function(){return Object.assign({},h.currentDefaults(),A().ordinalFormat)},h.currentByteDefaultFormat=function(){return Object.assign({},h.currentDefaults(),A().byteFormat)},h.currentPercentageDefaultFormat=function(){return Object.assign({},h.currentDefaults(),A().percentageFormat)},h.currentCurrencyDefaultFormat=function(){return Object.assign({},h.currentDefaults(),A().currencyFormat)},h.currentTimeDefaultFormat=function(){return Object.assign({},h.currentDefaults(),A().timeFormat)},h.setDefaults=function($){$=a.parseFormat($),s.validateFormat($)&&(T=$)},h.getZeroFormat=function(){return S},h.setZeroFormat=function($){return S=typeof $=="string"?$:null},h.hasZeroFormat=function(){return S!==null},h.languageData=function($){if($){if(g[$])return g[$];throw new Error('Unknown tag "'.concat($,'"'))}return A()},h.registerLanguage=function($){var j=1<arguments.length&&arguments[1]!==void 0&&arguments[1];if(!s.validateLanguage($))throw new Error("Invalid language data");g[$.languageTag]=$,j&&R($.languageTag)},h.setLanguage=function($){var j=1<arguments.length&&arguments[1]!==void 0?arguments[1]:o.languageTag;if(!g[$]){var z=$.split("-")[0],V=Object.keys(g).find(function(G){return G.split("-")[0]===z});return g[V]?void R(V):void R(j)}R($)},h.registerLanguage(o),p=o.languageTag,n.exports=h},{"./en-US":2,"./parsing":8,"./validating":10}],5:[function(r,n,i){n.exports=function(o){return{loadLanguagesInNode:function(s){return a=o,void s.forEach(function(h){var p=void 0;try{p=r("../languages/".concat(h))}catch{console.error('Unable to load "'.concat(h,'". No matching language file found.'))}p&&a.registerLanguage(p)});var a}}}},{}],6:[function(r,n,i){var o=r("bignumber.js");function s(a,h,p){var g=new o(a._value),S=h;return p.isNumbro(h)&&(S=h._value),S=new o(S),a._value=g.minus(S).toNumber(),a}n.exports=function(a){return{add:function(h,p){return S=p,T=a,R=new o((g=h)._value),A=S,T.isNumbro(S)&&(A=S._value),A=new o(A),g._value=R.plus(A).toNumber(),g;var g,S,T,R,A},subtract:function(h,p){return s(h,p,a)},multiply:function(h,p){return S=p,T=a,R=new o((g=h)._value),A=S,T.isNumbro(S)&&(A=S._value),A=new o(A),g._value=R.times(A).toNumber(),g;var g,S,T,R,A},divide:function(h,p){return S=p,T=a,R=new o((g=h)._value),A=S,T.isNumbro(S)&&(A=S._value),A=new o(A),g._value=R.dividedBy(A).toNumber(),g;var g,S,T,R,A},set:function(h,p){return g=h,T=S=p,a.isNumbro(S)&&(T=S._value),g._value=T,g;var g,S,T},difference:function(h,p){return g=p,s(T=(S=a)(h._value),g,S),Math.abs(T._value);var g,S,T}}}},{"bignumber.js":1}],7:[function(r,n,i){function o(j,z){for(var V=0;V<z.length;V++){var G=z[V];G.enumerable=G.enumerable||!1,G.configurable=!0,"value"in G&&(G.writable=!0),Object.defineProperty(j,G.key,G)}}var s=r("./globalState"),a=r("./validating"),h=r("./loading")($),p=r("./unformatting"),g=r("./formatting")($),S=r("./manipulating")($),T=r("./parsing"),R=function(){function j(G){(function(ee,K){if(!(ee instanceof K))throw new TypeError("Cannot call a class as a function")})(this,j),this._value=G}var z,V;return z=j,(V=[{key:"clone",value:function(){return $(this._value)}},{key:"format",value:function(){var G=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return g.format(this,G)}},{key:"formatCurrency",value:function(G){return typeof G=="string"&&(G=T.parseFormat(G)),(G=g.formatOrDefault(G,s.currentCurrencyDefaultFormat())).output="currency",g.format(this,G)}},{key:"formatTime",value:function(){var G=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return G.output="time",g.format(this,G)}},{key:"binaryByteUnits",value:function(){return g.getBinaryByteUnit(this)}},{key:"decimalByteUnits",value:function(){return g.getDecimalByteUnit(this)}},{key:"byteUnits",value:function(){return g.getByteUnit(this)}},{key:"difference",value:function(G){return S.difference(this,G)}},{key:"add",value:function(G){return S.add(this,G)}},{key:"subtract",value:function(G){return S.subtract(this,G)}},{key:"multiply",value:function(G){return S.multiply(this,G)}},{key:"divide",value:function(G){return S.divide(this,G)}},{key:"set",value:function(G){return S.set(this,A(G))}},{key:"value",value:function(){return this._value}},{key:"valueOf",value:function(){return this._value}}])&&o(z.prototype,V),j}();function A(j){var z=j;return $.isNumbro(j)?z=j._value:typeof j=="string"?z=$.unformat(j):isNaN(j)&&(z=NaN),z}function $(j){return new R(A(j))}$.version="2.1.2",$.isNumbro=function(j){return j instanceof R},$.language=s.currentLanguage,$.registerLanguage=s.registerLanguage,$.setLanguage=s.setLanguage,$.languages=s.languages,$.languageData=s.languageData,$.zeroFormat=s.setZeroFormat,$.defaultFormat=s.currentDefaults,$.setDefaults=s.setDefaults,$.defaultCurrencyFormat=s.currentCurrencyDefaultFormat,$.validate=a.validate,$.loadLanguagesInNode=h.loadLanguagesInNode,$.unformat=p.unformat,n.exports=$},{"./formatting":3,"./globalState":4,"./loading":5,"./manipulating":6,"./parsing":8,"./unformatting":9,"./validating":10}],8:[function(r,n,i){n.exports={parseFormat:function(o){var s,a,h,p,g,S,T,R,A,$,j,z,V,G,ee,K,xe,Me,He,Ne,We=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{};return typeof o!="string"?o:(a=We,o=(h=(s=o).match(/^{([^}]*)}/))?(a.prefix=h[1],s.slice(h[0].length)):s,g=We,function(gt,Lt){if(gt.indexOf("$")===-1){if(gt.indexOf("%")===-1)return gt.indexOf("bd")!==-1?(Lt.output="byte",Lt.base="general"):gt.indexOf("b")!==-1?(Lt.output="byte",Lt.base="binary"):gt.indexOf("d")!==-1?(Lt.output="byte",Lt.base="decimal"):gt.indexOf(":")===-1?gt.indexOf("o")!==-1&&(Lt.output="ordinal"):Lt.output="time";Lt.output="percent"}else Lt.output="currency"}(o=(S=(p=o).match(/{([^}]*)}$/))?(g.postfix=S[1],p.slice(0,-S[0].length)):p,We),T=We,(R=o.match(/[1-9]+[0-9]*/))&&(T.totalLength=+R[0]),A=We,($=o.split(".")[0].match(/0+/))&&(A.characteristic=$[0].length),function(gt,Lt){if(gt.indexOf(".")!==-1){var _t=gt.split(".")[0];Lt.optionalCharacteristic=_t.indexOf("0")===-1}}(o,We),j=We,o.indexOf("a")!==-1&&(j.average=!0),V=We,(z=o).indexOf("K")!==-1?V.forceAverage="thousand":z.indexOf("M")!==-1?V.forceAverage="million":z.indexOf("B")!==-1?V.forceAverage="billion":z.indexOf("T")!==-1&&(V.forceAverage="trillion"),function(gt,Lt){var _t=gt.split(".")[1];if(_t){var $e=_t.match(/0+/);$e&&(Lt.mantissa=$e[0].length)}}(o,We),ee=We,(G=o).match(/\[\.]/)?ee.optionalMantissa=!0:G.match(/\./)&&(ee.optionalMantissa=!1),K=We,o.indexOf(",")!==-1&&(K.thousandSeparated=!0),xe=We,o.indexOf(" ")!==-1&&(xe.spaceSeparated=!0),He=We,(Me=o).match(/^\+?\([^)]*\)$/)&&(He.negative="parenthesis"),Me.match(/^\+?-/)&&(He.negative="sign"),Ne=We,o.match(/^\+/)&&(Ne.forceSign=!0),We)}}},{}],9:[function(r,n,i){var o=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function s(h){return h.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function a(h,p){var g=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",S=3<arguments.length?arguments[3]:void 0,T=4<arguments.length?arguments[4]:void 0,R=5<arguments.length?arguments[5]:void 0,A=6<arguments.length?arguments[6]:void 0;if(h!=="")return h===T?0:function $(j,z){var V=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",G=3<arguments.length?arguments[3]:void 0,ee=4<arguments.length?arguments[4]:void 0,K=5<arguments.length?arguments[5]:void 0,xe=6<arguments.length?arguments[6]:void 0;if(!isNaN(+j))return+j;var Me="",He=j.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(He!==j)return-1*$(He,z,V,G,ee,K,xe);for(var Ne=0;Ne<o.length;Ne++){var We=o[Ne];if((Me=j.replace(We.key,""))!==j)return $(Me,z,V,G,ee,K,xe)*We.factor}if((Me=j.replace("%",""))!==j)return $(Me,z,V,G,ee,K,xe)/100;var gt=parseFloat(j);if(!isNaN(gt)){var Lt=G(gt);if(Lt&&Lt!=="."&&(Me=j.replace(new RegExp("".concat(s(Lt),"$")),""))!==j)return $(Me,z,V,G,ee,K,xe);var _t={};Object.keys(K).forEach(function(U){_t[K[U]]=U});for(var $e=Object.keys(_t).sort().reverse(),Fe=$e.length,At=0;At<Fe;At++){var Gt=$e[At],ae=_t[Gt];if((Me=j.replace(Gt,""))!==j){var D=void 0;switch(ae){case"thousand":D=Math.pow(10,3);break;case"million":D=Math.pow(10,6);break;case"billion":D=Math.pow(10,9);break;case"trillion":D=Math.pow(10,12)}return $(Me,z,V,G,ee,K,xe)*D}}}}(function($,j){var z=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",V=$.replace(z,"");return V=(V=V.replace(new RegExp("([0-9])".concat(s(j.thousands),"([0-9])"),"g"),"$1$2")).replace(j.decimal,".")}(h,p,g),p,g,S,T,R,A)}n.exports={unformat:function(h,p){var g,S,T,R=r("./globalState"),A=R.currentDelimiters(),$=R.currentCurrency().symbol,j=R.currentOrdinal(),z=R.getZeroFormat(),V=R.currentAbbreviations(),G=void 0;if(typeof h=="string")G=function(ee,K){if(!ee.indexOf(":")||K.thousands===":")return!1;var xe=ee.split(":");if(xe.length!==3)return!1;var Me=+xe[0],He=+xe[1],Ne=+xe[2];return!isNaN(Me)&&!isNaN(He)&&!isNaN(Ne)}(h,A)?(g=h.split(":"),S=+g[0],T=+g[1],+g[2]+60*T+3600*S):a(h,A,$,j,z,V,p);else{if(typeof h!="number")return;G=h}if(G!==void 0)return G}}},{"./globalState":4}],10:[function(r,n,i){function o(A){return function($){if(Array.isArray($)){for(var j=0,z=new Array($.length);j<$.length;j++)z[j]=$[j];return z}}(A)||function($){if(Symbol.iterator in Object($)||Object.prototype.toString.call($)==="[object Arguments]")return Array.from($)}(A)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function s(A){return(s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function($){return typeof $}:function($){return $&&typeof Symbol=="function"&&$.constructor===Symbol&&$!==Symbol.prototype?"symbol":typeof $})(A)}var a=r("./unformatting"),h=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,p={output:{type:"string",validValues:["currency","percent","byte","time","ordinal","number"]},base:{type:"string",validValues:["decimal","binary","general"],restriction:function(A,$){return $.output==="byte"},message:"`base` must be provided only when the output is `byte`",mandatory:function(A){return A.output==="byte"}},characteristic:{type:"number",restriction:function(A){return 0<=A},message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:["trillion","billion","million","thousand"]},average:"boolean",currencyPosition:{type:"string",validValues:["prefix","infix","postfix"]},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:function(A){return 0<=A},message:"value must be positive"},{restriction:function(A,$){return!$.exponential},message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:function(A){return 0<=A},message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:["sign","parenthesis"]},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:function(A,$){return $.output==="percent"},message:"`prefixSymbol` can be provided only when the output is `percent`"}},g={languageTag:{type:"string",mandatory:!0,restriction:function(A){return A.match(h)},message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:{type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},spaceSeparated:"boolean",ordinal:{type:"function",mandatory:!0},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function S(A){return!!a.unformat(A)}function T(A,$,j){var z=3<arguments.length&&arguments[3]!==void 0&&arguments[3],V=Object.keys(A).map(function(G){if(!$[G])return console.error("".concat(j," Invalid key: ").concat(G)),!1;var ee=A[G],K=$[G];if(typeof K=="string"&&(K={type:K}),K.type==="format"){if(!T(ee,p,"[Validate ".concat(G,"]"),!0))return!1}else if(s(ee)!==K.type)return console.error("".concat(j," ").concat(G,' type mismatched: "').concat(K.type,'" expected, "').concat(s(ee),'" provided')),!1;if(K.restrictions&&K.restrictions.length)for(var xe=K.restrictions.length,Me=0;Me<xe;Me++){var He=K.restrictions[Me],Ne=He.restriction,We=He.message;if(!Ne(ee,A))return console.error("".concat(j," ").concat(G," invalid value: ").concat(We)),!1}return K.restriction&&!K.restriction(ee,A)?(console.error("".concat(j," ").concat(G," invalid value: ").concat(K.message)),!1):K.validValues&&K.validValues.indexOf(ee)===-1?(console.error("".concat(j," ").concat(G," invalid value: must be among ").concat(JSON.stringify(K.validValues),', "').concat(ee,'" provided')),!1):!(K.children&&!T(ee,K.children,"[Validate ".concat(G,"]")))});return z||V.push.apply(V,o(Object.keys($).map(function(G){var ee=$[G];if(typeof ee=="string"&&(ee={type:ee}),ee.mandatory){var K=ee.mandatory;if(typeof K=="function"&&(K=K(A)),K&&A[G]===void 0)return console.error("".concat(j,' Missing mandatory key "').concat(G,'"')),!1}return!0}))),V.reduce(function(G,ee){return G&&ee},!0)}function R(A){return T(A,p,"[Validate format]")}n.exports={validate:function(A,$){var j=S(A),z=R($);return j&&z},validateFormat:R,validateInput:S,validateLanguage:function(A){return T(A,g,"[Validate language]")}}},{"./unformatting":9}]},{},[7])(7)})})(gae);var Sze=gae.exports;const wd=V_(Sze);var xze="numeric";function h3(e,t,r,n,i,o,s){var a=o;if(ks(a)){var h=s.numericFormat,p=h&&h.culture||"-",g=h&&h.pattern,S=s.className||"",T=S.length?S.split(" "):[];if(typeof p<"u"&&!wd.languages()[p]){var R=p.replace("-",""),A=wd.allLanguages?wd.allLanguages[p]:wd[R];A&&wd.registerLanguage(A)}wd.setLanguage(p),a=wd(a).format(g||"0"),T.indexOf("htLeft")<0&&T.indexOf("htCenter")<0&&T.indexOf("htRight")<0&&T.indexOf("htJustify")<0&&T.push("htRight"),T.indexOf("htNumeric")<0&&T.push("htNumeric"),s.className=T.join(" "),t.dir="ltr"}xh(e,t,r,n,i,a,s)}h3.RENDERER_TYPE=xze;var Cze="password";function d3(e,t,r,n,i,o,s){xh.apply(this,[e,t,r,n,i,o,s]);var a=s.hashLength||t.innerHTML.length,h=s.hashSymbol||"*",p="";Er(a-1,function(){p+=h}),ib(t,p)}d3.RENDERER_TYPE=Cze;var Eze="time";function p3(e,t,r,n,i,o,s){xh.apply(this,[e,t,r,n,i,o,s]),t.dir="ltr"}p3.RENDERER_TYPE=Eze;var dC=Fs("renderers"),Tze=dC.register,Oze=dC.getItem,vae=dC.hasItem;dC.getNames;dC.getValues;function wK(e){if(typeof e=="function")return e;if(!vae(e))throw Error('No registered renderer found under "'.concat(e,'" name'));return Oze(e)}function ju(e,t){typeof e!="string"&&(t=e,e=t.RENDERER_TYPE),Tze(e,t)}function Rze(){ju(ab),ju(hC),ju(c3),ju(u3),ju(h3),ju(d3),ju(xh),ju(p3)}var kze="autocomplete";function MA(e,t){var r=e;if(r==null&&(r=""),this.allowEmpty&&r===""){t(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(r,SK(r,t)):SK(r,t)(this.source):t(!0)}MA.VALIDATOR_TYPE=kze;function SK(e,t){var r=e;return function(n){for(var i=!1,o=0,s=n.length;o<s;o++)if(r===n[o]){i=!0;break}t(i)}}var Pze=Object.is||function(t,r){return t===r?t!==0||1/t===1/r:t!=t&&r!=r},Aze=so,Ize=sA,Mze=Wi,Dze=_l,$ze=Fa,xK=Pze,CK=Qi,Lze=Xp,Nze=lA;Ize("search",function(e,t,r){return[function(i){var o=$ze(this),s=Dze(i)?void 0:Lze(i,e);return s?Aze(s,i,o):new RegExp(i)[e](CK(o))},function(n){var i=Mze(this),o=CK(n),s=r(t,i,o);if(s.done)return s.value;var a=i.lastIndex;xK(a,0)||(i.lastIndex=0);var h=Nze(i,o);return xK(i.lastIndex,a)||(i.lastIndex=a),h===null?-1:h.index}]});function Bze(e){var t=new Date(e);return isNaN(new Date("".concat(e,"T00:00")).getDate())?t:new Date(t.getTime()+t.getTimezoneOffset()*6e4)}var jze="date";function m3(e,t){var r=iae(fae,this.instance),n=e,i=!0;n==null&&(n="");var o=Vt(n,this.dateFormat||r.defaultDateFormat,!0).isValid(),s=Vt(new Date(n)).isValid()||o;if(this.allowEmpty&&n===""&&(s=!0,o=!0),s||(i=!1),!s&&o&&(i=!0),s&&!o)if(this.correctFormat===!0){var a=zze(n,this.dateFormat),h=this.instance.toVisualRow(this.row),p=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(h,p,a,"dateValidator"),i=!0}else i=!1;t(i)}m3.VALIDATOR_TYPE=jze;function zze(e,t){var r=Vt(Bze(e)),n=Vt(e,t),i=e.search(/[A-z]/g)>-1,o;return r.isValid()&&r.format("x")===n.format("x")||!n.isValid()||i?o=r:o=n,o.format(t)}var Fze="numeric";function y3(e,t){var r=e;r==null&&(r=""),this.allowEmpty&&r===""?t(!0):t(r===""?!1:ks(e))}y3.VALIDATOR_TYPE=Fze;var Hze=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],Vze="time";function g3(e,t){var r=this.timeFormat||"h:mm:ss a",n=!0,i=e;i===null&&(i=""),i=/^\d{3,}$/.test(i)?parseInt(i,10):i;var o=/^\d{1,2}$/.test(i);o&&(i+=":00");var s=Vt(i,Hze,!0).isValid()?Vt(i):Vt(i,r),a=s.isValid(),h=Vt(i,r,!0).isValid()&&!o;if(this.allowEmpty&&i===""&&(a=!0,h=!0),a||(n=!1),!a&&h&&(n=!0),a&&!h)if(this.correctFormat===!0){var p=s.format(r),g=this.instance.toVisualRow(this.row),S=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(g,S,p,"timeValidator"),n=!0}else n=!1;t(n)}g3.VALIDATOR_TYPE=Vze;var pC=Fs("validators"),Uze=pC.register,Wze=pC.getItem,_ae=pC.hasItem;pC.getNames;pC.getValues;function Gze(e){if(typeof e=="function")return e;if(!_ae(e))throw Error('No registered validator found under "'.concat(e,'" name'));return Wze(e)}function x0(e,t){typeof e!="string"&&(t=e,e=t.VALIDATOR_TYPE),Uze(e,t)}function Yze(){x0(MA),x0(m3),x0(y3),x0(g3)}var Kze="autocomplete",qze={CELL_TYPE:Kze,editor:s3,renderer:ab,validator:MA},Xze="checkbox",Zze={CELL_TYPE:Xze,editor:uae,renderer:c3},Jze="date",Qze={CELL_TYPE:Jze,editor:hae,renderer:ab,validator:m3},eFe="dropdown",tFe={CELL_TYPE:eFe,editor:l3,renderer:ab,validator:MA},rFe="handsontable",nFe={CELL_TYPE:rFe,editor:a3,renderer:ab},iFe="numeric",oFe={CELL_TYPE:iFe,editor:dae,renderer:h3,validator:y3,dataType:"number"},aFe="password",sFe={CELL_TYPE:aFe,editor:pae,renderer:d3,copyable:!1},lFe="text",bae={CELL_TYPE:lFe,editor:nm,renderer:xh},uFe="time",cFe={CELL_TYPE:uFe,editor:mae,renderer:p3,validator:g3},mC=Fs("cellTypes"),fFe=mC.register,hFe=mC.getItem,wae=mC.hasItem;mC.getNames;mC.getValues;function dFe(e){if(!wae(e))throw Error('You declared cell type "'.concat(e,`" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`));return hFe(e)}function Xl(e,t){typeof e!="string"&&(t=e,e=t.CELL_TYPE);var r=t,n=r.editor,i=r.renderer,o=r.validator;n&&Qa(e,n),i&&ju(e,i),o&&x0(e,o),fFe(e,t)}function pFe(){Xl(qze),Xl(Zze),Xl(Qze),Xl(tFe),Xl(nFe),Xl(oFe),Xl(sFe),Xl(bae),Xl(cFe)}var mFe=nA,yFe=yne;mFe("WeakSet",function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},yFe);function gFe(e){return bFe(e)||_Fe(e)||Sae(e)||vFe()}function vFe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _Fe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function bFe(e){if(Array.isArray(e))return XN(e)}function wFe(e,t){return CFe(e)||xFe(e,t)||Sae(e,t)||SFe()}function SFe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Sae(e,t){if(e){if(typeof e=="string")return XN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return XN(e,t)}}function XN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function xFe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],h=!0,p=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;h=!1}else for(;!(h=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);h=!0);}catch(g){p=!0,i=g}finally{try{if(!h&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(p)throw i}}return a}}function CFe(e){if(Array.isArray(e))return e}var ZN="asc",EFe="desc",EK=new Map([[ZN,[-1,1]],[EFe,[1,-1]]]),TFe=function(t){return"The priority '".concat(t,"' is already declared in a map.")},OFe=function(t){return"The priority '".concat(t,"' is not a number.")};function RFe(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.errorPriorityExists,r=e.errorPriorityNaN,n=new Map;t=ci(t)?t:TFe,r=ci(r)?r:OFe;function i(s,a){if(!ks(s))throw new Error(r(s));if(n.has(s))throw new Error(t(s));n.set(s,a)}function o(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ZN,a=EK.get(s)||EK.get(ZN),h=wFe(a,2),p=h[0],g=h[1];return gFe(n).sort(function(S,T){return S[0]<T[0]?p:g}).map(function(S){return S[1]})}return{addItem:i,getItems:o}}function kFe(e){return IFe(e)||AFe(e)||xae(e)||PFe()}function PFe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function AFe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function IFe(e){if(Array.isArray(e))return JN(e)}function TK(e,t){return $Fe(e)||DFe(e,t)||xae(e,t)||MFe()}function MFe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function xae(e,t){if(e){if(typeof e=="string")return JN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return JN(e,t)}}function JN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function DFe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],h=!0,p=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;h=!1}else for(;!(h=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);h=!0);}catch(g){p=!0,i=g}finally{try{if(!h&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(p)throw i}}return a}}function $Fe(e){if(Array.isArray(e))return e}var LFe=function(t){return"The id '".concat(t,"' is already declared in a map.")};function DA(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.errorIdExists,r=new Map;t=ci(t)?t:LFe;function n(g,S){if(p(g))throw new Error(t(g));r.set(g,S)}function i(g){return r.delete(g)}function o(){r.clear()}function s(g){var S=h().find(function(A){var $=TK(A,2),j=$[0],z=$[1];return g===z?j:!1})||[null],T=TK(S,1),R=T[0];return R}function a(g){return r.get(g)}function h(){return kFe(r)}function p(g){return r.has(g)}return{addItem:n,clear:o,getId:s,getItem:a,getItems:h,hasItem:p,removeItem:i}}function NFe(e){return FFe(e)||zFe(e)||jFe(e)||BFe()}function BFe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function jFe(e,t){if(e){if(typeof e=="string")return QN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return QN(e,t)}}function zFe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function FFe(e){if(Array.isArray(e))return QN(e)}function QN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var HFe=function(t){return"'".concat(t,"' value is already declared in a unique set.")};function VFe(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.errorItemExists,r=new Set;t=ci(t)?t:HFe;function n(s){if(r.has(s))throw new Error(t(s));r.add(s)}function i(){return NFe(r)}function o(){r.clear()}return{addItem:n,clear:o,getItems:i}}function UFe(e,t){return YFe(e)||GFe(e,t)||Cae(e,t)||WFe()}function WFe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function GFe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],h=!0,p=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;h=!1}else for(;!(h=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);h=!0);}catch(g){p=!0,i=g}finally{try{if(!h&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(p)throw i}}return a}}function YFe(e){if(Array.isArray(e))return e}function OK(e){return XFe(e)||qFe(e)||Cae(e)||KFe()}function KFe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Cae(e,t){if(e){if(typeof e=="string")return eB(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return eB(e,t)}}function qFe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function XFe(e){if(Array.isArray(e))return eB(e)}function eB(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var v3=function(t){return'There is already registered "'.concat(t,'" plugin.')},ZFe=function(t){return'There is already registered plugin on priority "'.concat(t,'".')},JFe=function(t){return'The priority "'.concat(t,'" is not a number.')},Eae=RFe({errorPriorityExists:ZFe,errorPriorityNaN:JFe}),Tae=VFe({errorItemExists:v3}),tB=DA({errorIdExists:v3});function Oae(){return[].concat(OK(Eae.getItems()),OK(Tae.getItems()))}function _3(e){var t=xc(e);return tB.getItem(t)}function QFe(e){return!!_3(e)}function Mn(e,t,r){var n=tHe(e,t,r),i=UFe(n,3);e=i[0],t=i[1],r=i[2],_3(e)===void 0&&eHe(e,t,r)}function eHe(e,t,r){var n=xc(e);if(tB.hasItem(n))throw new Error(v3(n));r===void 0?Tae.addItem(n):Eae.addItem(r,n),tB.addItem(n,t)}function tHe(e,t,r){return typeof e=="function"&&(t=e,e=t.PLUGIN_KEY,r=t.PLUGIN_PRIORITY),[e,t,r]}function DS(e){"@babel/helpers - typeof";return DS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},DS(e)}function rHe(e,t){return aHe(e)||oHe(e,t)||iHe(e,t)||nHe()}function nHe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function iHe(e,t){if(e){if(typeof e=="string")return RK(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return RK(e,t)}}function RK(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function oHe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],h=!0,p=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;h=!1}else for(;!(h=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);h=!0);}catch(g){p=!0,i=g}finally{try{if(!h&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(p)throw i}}return a}}function aHe(e){if(Array.isArray(e))return e}function sHe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kK(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,uHe(n.key),n)}}function lHe(e,t,r){return t&&kK(e.prototype,t),r&&kK(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function uHe(e){var t=cHe(e,"string");return DS(t)==="symbol"?t:String(t)}function cHe(e,t){if(DS(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(DS(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function fHe(e,t){hHe(e,t),t.add(e)}function hHe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function dHe(e,t,r){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return r}var PK=new Map([["plugin",QFe],["cell-type",wae],["editor",nae],["renderer",vae],["validator",_ae]]),pHe="base",Sd=new WeakMap,w$=[],Fl=null,AK=new WeakSet,Wn=function(){function e(t){var r=this;sHe(this,e),fHe(this,AK),Bc(this,"hot",t,{writable:!1}),Sd.set(this,{hooks:{}}),Fl=null,this.pluginName=null,this.pluginsInitializedCallbacks=[],this.isPluginsReady=!1,this.enabled=!1,this.initialized=!1,this.hot.addHook("afterPluginsInitialized",function(){return r.onAfterPluginsInitialized()}),this.hot.addHook("afterUpdateSettings",function(n){return r.onUpdateSettings(n)}),this.hot.addHook("beforeInit",function(){return r.init()})}return lHe(e,[{key:"init",value:function(){var r=this;this.pluginName=this.hot.getPluginName(this);var n=this.constructor.PLUGIN_DEPS,i=Array.isArray(n)?n:[];if(i.length>0){var o=[];if(i.forEach(function(p){var g=p.split(":"),S=rHe(g,2),T=S[0],R=S[1];if(!PK.has(T))throw new Error('Unknown plugin dependency type "'.concat(T,'" was found.'));PK.get(T)(R)||o.push(" - ".concat(R," (").concat(T,")"))}),o.length>0){var s=["The ".concat(this.pluginName,` plugin requires the following modules:
`),"".concat(o.join(`
`),`
`)].join("");w$.push(s)}}Fl||(Fl=Oae()),Fl.indexOf("UndoRedo")>=0&&Fl.splice(Fl.indexOf("UndoRedo"),1),Fl.indexOf(this.pluginName)>=0&&Fl.splice(Fl.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",function(){r.isEnabled&&r.isEnabled()&&r.enablePlugin()});var a=Fl.length===0;if(a){if(w$.length>0){var h=["".concat(w$.join(`
`),`
`),"You have to import and register them manually."].join("");throw new Error(h)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}},{key:"enablePlugin",value:function(){this.enabled=!0}},{key:"disablePlugin",value:function(){this.eventManager&&this.eventManager.clear(),this.clearHooks(),this.enabled=!1}},{key:"addHook",value:function(r,n){Sd.get(this).hooks[r]=Sd.get(this).hooks[r]||[];var i=Sd.get(this).hooks[r];this.hot.addHook(r,n),i.push(n),Sd.get(this).hooks[r]=i}},{key:"removeHooks",value:function(r){var n=this;Le(Sd.get(this).hooks[r]||[],function(i){n.hot.removeHook(r,i)})}},{key:"clearHooks",value:function(){var r=this,n=Sd.get(this).hooks;pn(n,function(i,o){return r.removeHooks(o)}),n.length=0}},{key:"callOnPluginsReady",value:function(r){this.isPluginsReady?r():this.pluginsInitializedCallbacks.push(r)}},{key:"onAfterPluginsInitialized",value:function(){Le(this.pluginsInitializedCallbacks,function(r){return r()}),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}},{key:"onUpdateSettings",value:function(r){var n=dHe(this,AK,mHe).call(this,r);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&n&&this.updatePlugin(r))}},{key:"updatePlugin",value:function(){}},{key:"destroy",value:function(){var r=this;this.eventManager&&this.eventManager.destroy(),this.clearHooks(),pn(this,function(n,i){i!=="hot"&&(r[i]=null)}),delete this.t,delete this.hot}}],[{key:"PLUGIN_KEY",get:function(){return pHe}},{key:"SETTING_KEYS",get:function(){return[this.PLUGIN_KEY]}}]),e}();function mHe(e){if(!e)return!1;var t=this.constructor.SETTING_KEYS;if(typeof t=="boolean")return t;for(var r=0;r<t.length;r++)if(e[t[r]]!==void 0)return!0;return!1}function $S(e){"@babel/helpers - typeof";return $S=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$S(e)}function yHe(e,t){return bHe(e)||_He(e,t)||vHe(e,t)||gHe()}function gHe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function vHe(e,t){if(e){if(typeof e=="string")return IK(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return IK(e,t)}}function IK(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _He(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],h=!0,p=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;h=!1}else for(;!(h=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);h=!0);}catch(g){p=!0,i=g}finally{try{if(!h&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(p)throw i}}return a}}function bHe(e){if(Array.isArray(e))return e}function wHe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function MK(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,xHe(n.key),n)}}function SHe(e,t,r){return t&&MK(e.prototype,t),r&&MK(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function xHe(e){var t=CHe(e,"string");return $S(t)==="symbol"?t:String(t)}function CHe(e,t){if($S(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if($S(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var EHe=function(){function e(t){wHe(this,e),this.hot=t,this.container=null,this.injected=!1,this.rows=[],this.columns=[],this.samples=null,this.settings={useHeaders:!0}}return SHe(e,[{key:"addRow",value:function(r,n){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));var i={row:r};this.rows.push(i),this.samples=n,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.table.tr.appendChild(this.createRow(r)),this.container.container.appendChild(this.table.fragment),i.table=this.table.table}},{key:"addColumnHeadersRow",value:function(r){var n=this.hot.getColHeader(0);if(n!=null){var i={row:-1};this.rows.push(i),this.container=this.createContainer(this.hot.rootElement.className),this.samples=r,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),i.table=this.table.table}}},{key:"addColumn",value:function(r,n){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));var i={col:r};this.columns.push(i),this.samples=n,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(r)!==null&&this.hot.view.appendColHeader(r,this.table.th),this.table.tBody.appendChild(this.createCol(r)),this.container.container.appendChild(this.table.fragment),i.table=this.table.table}},{key:"getHeights",value:function(r){this.injected||this.injectTable(),Le(this.rows,function(n){r(n.row,$i(n.table)-1)})}},{key:"getWidths",value:function(r){this.injected||this.injectTable(),Le(this.columns,function(n){var i=n.table.getBoundingClientRect(),o=i.width;r(n.col,Math.ceil(o))})}},{key:"setSettings",value:function(r){this.settings=r}},{key:"setSetting",value:function(r,n){this.settings||(this.settings={}),this.settings[r]=n}},{key:"getSettings",value:function(){return this.settings}},{key:"getSetting",value:function(r){return this.settings?this.settings[r]:null}},{key:"createColGroupsCol",value:function(){var r=this,n=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&n.appendChild(this.createColElement(-1)),this.samples.forEach(function(i){Le(i.strings,function(o){n.appendChild(r.createColElement(o.col))})}),n}},{key:"createRow",value:function(r){var n=this,i=this.hot.rootDocument,o=i.createDocumentFragment(),s=i.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(r,s),o.appendChild(s)),this.samples.forEach(function(a){Le(a.strings,function(h){var p=h.col,g=n.hot.getCellMeta(r,p);g.col=p,g.row=r;var S=n.hot.getCellRenderer(g),T=i.createElement("td");T.setAttribute("ghost-table",1),S(n.hot,T,r,p,n.hot.colToProp(p),h.value,g),o.appendChild(T)})}),o}},{key:"appendColumnHeadersRow",value:function(){var r=this,n=this.hot.rootDocument,i=n.createDocumentFragment(),o=[];if(this.hot.hasRowHeaders()){var s=n.createElement("th");o.push([-1,s]),i.appendChild(s)}this.samples.forEach(function(a){Le(a.strings,function(h){var p=h.col,g=n.createElement("th");o.push([p,g]),i.appendChild(g)})}),this.table.tHead.appendChild(i),Le(o,function(a){var h=yHe(a,2),p=h[0],g=h[1];r.hot.view.appendColHeader(p,g)})}},{key:"createCol",value:function(r){var n=this,i=this.hot.rootDocument,o=i.createDocumentFragment();return this.samples.forEach(function(s){Le(s.strings,function(a){var h=a.row,p=n.hot.getCellMeta(h,r);p.col=r,p.row=h;var g=n.hot.getCellRenderer(p),S=i.createElement("td"),T=i.createElement("tr");S.setAttribute("ghost-table",1),g(n.hot,S,h,r,n.hot.colToProp(r),a.value,p),T.appendChild(S),o.appendChild(T)})}),o}},{key:"clean",value:function(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}},{key:"injectTable",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((r||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}},{key:"removeTable",value:function(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}},{key:"createColElement",value:function(r){var n=this.hot.rootDocument.createElement("col");return n.style.width="".concat(this.hot.view._wt.wtTable.getStretchedColumnWidth(r),"px"),n}},{key:"createTable",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=this.hot.rootDocument,i=n.createDocumentFragment(),o=n.createElement("table"),s=n.createElement("thead"),a=n.createElement("tbody"),h=n.createElement("colgroup"),p=n.createElement("tr"),g=n.createElement("th");return this.isVertical()&&o.appendChild(h),this.isHorizontal()&&(p.appendChild(g),s.appendChild(p),o.style.tableLayout="auto",o.style.width="auto"),o.appendChild(s),this.isVertical()&&a.appendChild(p),o.appendChild(a),Ht(o,r),i.appendChild(o),{fragment:i,table:o,tHead:s,tBody:a,colGroup:h,tr:p,th:g}}},{key:"createContainer",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=this.hot.rootDocument,i=n.createDocumentFragment(),o=n.createElement("div"),s="htGhostTable htAutoSize ".concat(r.trim());return Ht(o,s),i.appendChild(o),{fragment:i,container:o}}},{key:"isVertical",value:function(){return!!(this.rows.length&&!this.columns.length)}},{key:"isHorizontal",value:function(){return!!(this.columns.length&&!this.rows.length)}}]),e}();const Rae=EHe;var THe=Br,OHe=Ha,kae=Hx,RHe=nn,kHe=RHe(function(){kae(1)});THe({target:"Object",stat:!0,forced:kHe},{keys:function(t){return kae(OHe(t))}});function LS(e){"@babel/helpers - typeof";return LS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},LS(e)}function PHe(e,t,r){return t=Pae(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function AHe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function DK(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Pae(n.key),n)}}function IHe(e,t,r){return t&&DK(e.prototype,t),r&&DK(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Pae(e){var t=MHe(e,"string");return LS(t)==="symbol"?t:String(t)}function MHe(e,t){if(LS(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(LS(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var DHe=function(){function e(t){AHe(this,e),this.samples=null,this.dataFactory=t,this.customSampleCount=null,this.allowDuplicates=!1}return IHe(e,[{key:"getSampleCount",value:function(){return this.customSampleCount?this.customSampleCount:e.SAMPLE_COUNT}},{key:"setSampleCount",value:function(r){this.customSampleCount=r}},{key:"setAllowDuplicates",value:function(r){this.allowDuplicates=r}},{key:"generateRowSamples",value:function(r,n){return this.generateSamples("row",n,r)}},{key:"generateColumnSamples",value:function(r,n){return this.generateSamples("col",n,r)}},{key:"generateSamples",value:function(r,n,i){var o=this,s=new Map,a=typeof i=="number"?{from:i,to:i}:i,h=a.from,p=a.to;return Er(h,p,function(g){var S=o.generateSample(r,n,g);s.set(g,S)}),s}},{key:"generateSample",value:function(r,n,i){var o=this;if(r!=="row"&&r!=="col")throw new Error("Unsupported sample type");var s=new Map,a=r==="row"?"col":"row",h=[];return Er(n.from,n.to,function(p){var g=r==="row"?o.dataFactory(i,p):o.dataFactory(p,i),S=g.value,T=g.bundleSeed,R=typeof T=="string"&&T.length>0,A;R?A=T:dn(S)?A="".concat(Object.keys(S).length):Array.isArray(S)?A="".concat(S.length):A="".concat(Xi(S).length),s.has(A)||s.set(A,{needed:o.getSampleCount(),strings:[]});var $=s.get(A);if($.needed){var j=h.indexOf(S)>-1;(!j||o.allowDuplicates||R)&&($.strings.push(PHe({value:S},a,p)),h.push(S),$.needed-=1)}}),s}}],[{key:"SAMPLE_COUNT",get:function(){return 3}}]),e}();const Aae=DHe;var zd=1,Jo=2;function NS(e){"@babel/helpers - typeof";return NS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},NS(e)}function $He(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $K(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,NHe(n.key),n)}}function LHe(e,t,r){return t&&$K(e.prototype,t),r&&$K(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function NHe(e){var t=BHe(e,"string");return NS(t)==="symbol"?t:String(t)}function BHe(e,t){if(NS(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(NS(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var gy=new WeakMap,jHe=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.viewportSize,n=t.scrollOffset,i=t.totalItems,o=t.itemSizeFn,s=t.overrideFn,a=t.calculationType,h=t.stretchMode,p=t.stretchingItemWidthFn,g=p===void 0?function(T){return T}:p,S=t.inlineStartOffset;$He(this,e),gy.set(this,{viewportWidth:r,scrollOffset:n,totalColumns:i,columnWidthFn:o,overrideFn:s,calculationType:a,stretchingColumnWidthFn:g,inlineStartOffset:S}),this.count=0,this.startColumn=null,this.endColumn=null,this.startPosition=null,this.isVisibleInTrimmingContainer=!1,this.stretchAllRatio=0,this.stretchLastWidth=0,this.stretch=h,this.totalTargetWidth=0,this.needVerifyLastColumnWidth=!0,this.stretchAllColumnsWidth=[],this.calculate()}return LHe(e,[{key:"calculate",value:function(){for(var r=0,n=!0,i=[],o,s=0,a=0,h=gy.get(this),p=h.calculationType,g=h.overrideFn,S=h.scrollOffset,T=Math.max(h.scrollOffset,0),R=h.totalColumns,A=h.viewportWidth,$=T>0?A+1:A,j=0;j<R;j++)if(o=this._getColumnWidth(j),r<=T&&p!==Jo&&(this.startColumn=j,s=o),r>=T&&r+(p===Jo?o:0)<=T+$&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=j,s=o),this.endColumn=j),i.push(r),r+=o,a=o,p!==Jo&&(this.endColumn=j),r>=T+A){n=!1;break}var z=S+A-$,V=p===Jo?0:a,G=p===Jo?s:0;if(z<-1*h.inlineStartOffset||S>i.at(-1)+V||-1*h.scrollOffset-h.viewportWidth>-1*G?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endColumn===R-1&&n)for(this.startColumn=this.endColumn;this.startColumn>0;){var ee=i[this.endColumn]+o-i[this.startColumn-1];if((ee<=A||p!==Jo)&&(this.startColumn-=1),ee>A)break}p===zd&&this.startColumn!==null&&g&&g(this),this.startPosition=i[this.startColumn],this.startPosition===void 0&&(this.startPosition=null),R<this.endColumn&&(this.endColumn=R-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}},{key:"refreshStretching",value:function(r){if(this.stretch!=="none"){var n=r;this.totalTargetWidth=n;for(var i=gy.get(this),o=i.totalColumns,s=0,a=0;a<o;a++){var h=this._getColumnWidth(a),p=i.stretchingColumnWidthFn(void 0,a);typeof p=="number"?n-=p:s+=h}var g=n-s;if(this.stretch==="all"&&g>0)this.stretchAllRatio=n/s,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if(this.stretch==="last"&&n!==1/0){var S=this._getColumnWidth(o-1),T=g+S;this.stretchLastWidth=T>=0?T:S}}}},{key:"getStretchedColumnWidth",value:function(r,n){var i=null;return this.stretch==="all"&&this.stretchAllRatio!==0?i=this._getStretchedAllColumnWidth(r,n):this.stretch==="last"&&this.stretchLastWidth!==0&&(i=this._getStretchedLastColumnWidth(r)),i}},{key:"_getStretchedAllColumnWidth",value:function(r,n){var i=0,o=gy.get(this),s=o.totalColumns;if(!this.stretchAllColumnsWidth[r]){var a=Math.round(n*this.stretchAllRatio),h=o.stretchingColumnWidthFn(a,r);h===void 0?this.stretchAllColumnsWidth[r]=a:this.stretchAllColumnsWidth[r]=isNaN(h)?this._getColumnWidth(r):h}if(this.stretchAllColumnsWidth.length===s&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(var p=0;p<this.stretchAllColumnsWidth.length;p++)i+=this.stretchAllColumnsWidth[p];i!==this.totalTargetWidth&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=this.totalTargetWidth-i)}return this.stretchAllColumnsWidth[r]}},{key:"_getStretchedLastColumnWidth",value:function(r){var n=gy.get(this),i=n.totalColumns;return r===i-1?this.stretchLastWidth:null}},{key:"_getColumnWidth",value:function(r){var n=gy.get(this).columnWidthFn(r);return isNaN(n)&&(n=e.DEFAULT_WIDTH),n}}],[{key:"DEFAULT_WIDTH",get:function(){return 50}}]),e}();const b3=jHe;function BS(e){"@babel/helpers - typeof";return BS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},BS(e)}function zHe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function LK(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,HHe(n.key),n)}}function FHe(e,t,r){return t&&LK(e.prototype,t),r&&LK(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function HHe(e){var t=VHe(e,"string");return BS(t)==="symbol"?t:String(t)}function VHe(e,t){if(BS(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(BS(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var NK=new WeakMap,UHe=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.viewportSize,n=t.scrollOffset,i=t.totalItems,o=t.itemSizeFn,s=t.overrideFn,a=t.calculationType,h=t.scrollbarHeight;zHe(this,e),NK.set(this,{viewportHeight:r,scrollOffset:n,totalRows:i,rowHeightFn:o,overrideFn:s,calculationType:a,horizontalScrollbarHeight:h}),this.count=0,this.startRow=null,this.endRow=null,this.startPosition=null,this.isVisibleInTrimmingContainer=!1,this.calculate()}return FHe(e,[{key:"calculate",value:function(){for(var r=NK.get(this),n=r.calculationType,i=r.overrideFn,o=r.rowHeightFn,s=r.scrollOffset,a=Math.max(r.scrollOffset,0),h=r.totalRows,p=r.viewportHeight,g=r.horizontalScrollbarHeight||0,S=0,T=!0,R=[],A,$=0,j=0,z=0;z<h;z++)if(A=o(z),isNaN(A)&&(A=e.DEFAULT_HEIGHT),S<=a&&n!==Jo&&(this.startRow=z,$=A),S>=a&&S+(n===Jo?A:0)<=a+p-g&&(this.startRow===null&&(this.startRow=z,$=A),this.endRow=z),R.push(S),S+=A,j=A,n!==Jo&&(this.endRow=z),S>=a+p-g){T=!1;break}var V=s+p-g,G=n===Jo?$:0,ee=n===Jo?0:j;if(V<G||s>R.at(-1)+ee?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endRow===h-1&&T)for(this.startRow=this.endRow;this.startRow>0;){var K=R[this.endRow]+A-R[this.startRow-1];if((K<=p-g||n!==Jo)&&(this.startRow-=1),K>=p-g)break}n===zd&&this.startRow!==null&&i&&i(this),this.startPosition=R[this.startRow],this.startPosition===void 0&&(this.startPosition=null),h<this.endRow&&(this.endRow=h-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}],[{key:"DEFAULT_HEIGHT",get:function(){return 23}}]),e}();const Iae=UHe;function jS(e){"@babel/helpers - typeof";return jS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jS(e)}function WHe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function BK(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Mae(n.key),n)}}function GHe(e,t,r){return t&&BK(e.prototype,t),r&&BK(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function YHe(e,t,r){KHe(e,t),t.set(e,r)}function KHe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function jK(e,t,r){return t=Mae(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Mae(e){var t=qHe(e,"string");return jS(t)==="symbol"?t:String(t)}function qHe(e,t){if(jS(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(jS(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Zw(e,t){var r=Dae(e,t,"get");return XHe(e,r)}function XHe(e,t){return t.get?t.get.call(e):t.value}function ZHe(e,t,r){var n=Dae(e,t,"set");return JHe(e,n,r),r}function Dae(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function JHe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var xd=new WeakMap,QHe=function(){function e(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;WHe(this,e),jK(this,"row",null),jK(this,"col",null),YHe(this,xd,{writable:!0,value:!1}),ZHe(this,xd,n),typeof t<"u"&&typeof r<"u"&&(this.row=t,this.col=r)}return GHe(e,[{key:"isValid",value:function(r){return!(this.row<0||this.col<0||this.row>=r.getSetting("totalRows")||this.col>=r.getSetting("totalColumns"))}},{key:"isEqual",value:function(r){return r===this?!0:this.row===r.row&&this.col===r.col}},{key:"isSouthEastOf",value:function(r){return this.row>=r.row&&(Zw(this,xd)?this.col<=r.col:this.col>=r.col)}},{key:"isNorthWestOf",value:function(r){return this.row<=r.row&&(Zw(this,xd)?this.col>=r.col:this.col<=r.col)}},{key:"isSouthWestOf",value:function(r){return this.row>=r.row&&(Zw(this,xd)?this.col>=r.col:this.col<=r.col)}},{key:"isNorthEastOf",value:function(r){return this.row<=r.row&&(Zw(this,xd)?this.col<=r.col:this.col>=r.col)}},{key:"normalize",value:function(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}},{key:"clone",value:function(){return new e(this.row,this.col,Zw(this,xd))}},{key:"toObject",value:function(){return{row:this.row,col:this.col}}}]),e}();const Pk=QHe;function zS(e){"@babel/helpers - typeof";return zS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zS(e)}function e3e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function zK(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,$ae(n.key),n)}}function t3e(e,t,r){return t&&zK(e.prototype,t),r&&zK(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function r3e(e,t,r){n3e(e,t),t.set(e,r)}function n3e(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function S$(e,t,r){return t=$ae(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $ae(e){var t=i3e(e,"string");return zS(t)==="symbol"?t:String(t)}function i3e(e,t){if(zS(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(zS(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Hl(e,t){var r=Lae(e,t,"get");return o3e(e,r)}function o3e(e,t){return t.get?t.get.call(e):t.value}function a3e(e,t,r){var n=Lae(e,t,"set");return s3e(e,n,r),r}function Lae(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function s3e(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var Ss=new WeakMap,l3e=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;e3e(this,e),S$(this,"highlight",null),S$(this,"from",null),S$(this,"to",null),r3e(this,Ss,{writable:!0,value:!1}),this.highlight=t.clone().normalize(),this.from=r.clone(),this.to=n.clone(),a3e(this,Ss,i)}return t3e(e,[{key:"setHighlight",value:function(r){return this.highlight=r.clone().normalize(),this}},{key:"setFrom",value:function(r){return this.from=r.clone(),this}},{key:"setTo",value:function(r){return this.to=r.clone(),this}},{key:"isValid",value:function(r){return this.from.isValid(r)&&this.to.isValid(r)}},{key:"isSingle",value:function(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}},{key:"getOuterHeight",value:function(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}},{key:"getOuterWidth",value:function(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}},{key:"getHeight",value:function(){if(this.from.row<0&&this.to.row<0)return 0;var r=Math.max(this.from.row,0),n=Math.max(this.to.row,0);return Math.max(r,n)-Math.min(r,n)+1}},{key:"getWidth",value:function(){if(this.from.col<0&&this.to.col<0)return 0;var r=Math.max(this.from.col,0),n=Math.max(this.to.col,0);return Math.max(r,n)-Math.min(r,n)+1}},{key:"getCellsCount",value:function(){return this.getWidth()*this.getHeight()}},{key:"includes",value:function(r){var n=r.row,i=r.col,o=this.getOuterTopStartCorner(),s=this.getOuterBottomEndCorner();return o.row<=n&&s.row>=n&&o.col<=i&&s.col>=i}},{key:"includesRange",value:function(r){return this.includes(r.getOuterTopStartCorner())&&this.includes(r.getOuterBottomEndCorner())}},{key:"isEqual",value:function(r){return Math.min(this.from.row,this.to.row)===Math.min(r.from.row,r.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(r.from.row,r.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(r.from.col,r.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(r.from.col,r.to.col)}},{key:"overlaps",value:function(r){return r.isSouthEastOf(this.getOuterTopLeftCorner())&&r.isNorthWestOf(this.getOuterBottomRightCorner())}},{key:"isSouthEastOf",value:function(r){return this.getOuterTopLeftCorner().isSouthEastOf(r)||this.getOuterBottomRightCorner().isSouthEastOf(r)}},{key:"isNorthWestOf",value:function(r){return this.getOuterTopLeftCorner().isNorthWestOf(r)||this.getOuterBottomRightCorner().isNorthWestOf(r)}},{key:"isOverlappingHorizontally",value:function(r){return this.getOuterTopRightCorner().col>=r.getOuterTopLeftCorner().col&&this.getOuterTopRightCorner().col<=r.getOuterTopRightCorner().col||this.getOuterTopLeftCorner().col<=r.getOuterTopRightCorner().col&&this.getOuterTopLeftCorner().col>=r.getOuterTopLeftCorner().col}},{key:"isOverlappingVertically",value:function(r){return this.getOuterBottomRightCorner().row>=r.getOuterTopRightCorner().row&&this.getOuterBottomRightCorner().row<=r.getOuterBottomRightCorner().row||this.getOuterTopRightCorner().row<=r.getOuterBottomRightCorner().row&&this.getOuterTopRightCorner().row>=r.getOuterTopRightCorner().row}},{key:"expand",value:function(r){var n=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner();return r.row<n.row||r.col<n.col||r.row>i.row||r.col>i.col?(this.from=this._createCellCoords(Math.min(n.row,r.row),Math.min(n.col,r.col)),this.to=this._createCellCoords(Math.max(i.row,r.row),Math.max(i.col,r.col)),!0):!1}},{key:"expandByRange",value:function(r){if(this.includesRange(r)||!this.overlaps(r))return!1;var n=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner(),o=this.getDirection(),s=r.getOuterTopStartCorner(),a=r.getOuterBottomEndCorner(),h=Math.min(n.row,s.row),p=Math.min(n.col,s.col),g=Math.max(i.row,a.row),S=Math.max(i.col,a.col),T=this._createCellCoords(h,p),R=this._createCellCoords(g,S);return this.from=T,this.to=R,this.setDirection(o),this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally(),!0}},{key:"getDirection",value:function(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}},{key:"setDirection",value:function(r){switch(r){case"NW-SE":var n=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];this.from=n[0],this.to=n[1];break;case"NE-SW":var i=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];this.from=i[0],this.to=i[1];break;case"SE-NW":var o=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];this.from=o[0],this.to=o[1];break;case"SW-NE":var s=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];this.from=s[0],this.to=s[1];break}}},{key:"getVerticalDirection",value:function(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}},{key:"getHorizontalDirection",value:function(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}},{key:"flipDirectionVertically",value:function(){var r=this.getDirection();switch(r){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}},{key:"flipDirectionHorizontally",value:function(){var r=this.getDirection();switch(r){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}},{key:"getTopStartCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}},{key:"getTopLeftCorner",value:function(){return Hl(this,Ss)?this.getTopEndCorner():this.getTopStartCorner()}},{key:"getBottomEndCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}},{key:"getBottomRightCorner",value:function(){return Hl(this,Ss)?this.getBottomStartCorner():this.getBottomEndCorner()}},{key:"getTopEndCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}},{key:"getTopRightCorner",value:function(){return Hl(this,Ss)?this.getTopStartCorner():this.getTopEndCorner()}},{key:"getBottomStartCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}},{key:"getBottomLeftCorner",value:function(){return Hl(this,Ss)?this.getBottomEndCorner():this.getBottomStartCorner()}},{key:"getOuterTopStartCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"getOuterTopLeftCorner",value:function(){return Hl(this,Ss)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}},{key:"getOuterBottomEndCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getOuterBottomRightCorner",value:function(){return Hl(this,Ss)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}},{key:"getOuterTopEndCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getOuterTopRightCorner",value:function(){return Hl(this,Ss)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}},{key:"getOuterBottomStartCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"getOuterBottomLeftCorner",value:function(){return Hl(this,Ss)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}},{key:"isCorner",value:function(r,n){return n&&n.includes(r)&&(this.getOuterTopLeftCorner().isEqual(this._createCellCoords(n.from.row,n.from.col))||this.getOuterTopRightCorner().isEqual(this._createCellCoords(n.from.row,n.to.col))||this.getOuterBottomLeftCorner().isEqual(this._createCellCoords(n.to.row,n.from.col))||this.getOuterBottomRightCorner().isEqual(this._createCellCoords(n.to.row,n.to.col)))?!0:r.isEqual(this.getOuterTopLeftCorner())||r.isEqual(this.getOuterTopRightCorner())||r.isEqual(this.getOuterBottomLeftCorner())||r.isEqual(this.getOuterBottomRightCorner())}},{key:"getOppositeCorner",value:function(r,n){if(!(r instanceof Pk))return!1;if(n){var i=n.from,o=n.to;if(n.includes(r)){if(this.getOuterTopStartCorner().isEqual(this._createCellCoords(i.row,i.col)))return this.getOuterBottomEndCorner();if(this.getOuterTopEndCorner().isEqual(this._createCellCoords(i.row,o.col)))return this.getOuterBottomStartCorner();if(this.getOuterBottomStartCorner().isEqual(this._createCellCoords(o.row,i.col)))return this.getOuterTopEndCorner();if(this.getOuterBottomEndCorner().isEqual(this._createCellCoords(o.row,o.col)))return this.getOuterTopStartCorner()}}if(r.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(r.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(r.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(r.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}},{key:"getBordersSharedWith",value:function(r){if(!this.includesRange(r))return[];var n={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},i={top:Math.min(r.from.row,r.to.row),bottom:Math.max(r.from.row,r.to.row),left:Math.min(r.from.col,r.to.col),right:Math.max(r.from.col,r.to.col)},o=[];return n.top===i.top&&o.push("top"),n.right===i.right&&o.push("right"),n.bottom===i.bottom&&o.push("bottom"),n.left===i.left&&o.push("left"),o}},{key:"getInner",value:function(){for(var r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),i=[],o=r.row;o<=n.row;o++)for(var s=r.col;s<=n.col;s++)!(this.from.row===o&&this.from.col===s)&&!(this.to.row===o&&this.to.col===s)&&i.push(this._createCellCoords(o,s));return i}},{key:"getAll",value:function(){for(var r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),i=[],o=r.row;o<=n.row;o++)for(var s=r.col;s<=n.col;s++)r.row===o&&r.col===s?i.push(r):n.row===o&&n.col===s?i.push(n):i.push(this._createCellCoords(o,s));return i}},{key:"forAll",value:function(r){for(var n=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner(),o=n.row;o<=i.row;o++)for(var s=n.col;s<=i.col;s++){var a=r(o,s);if(a===!1)return}}},{key:"clone",value:function(){return new e(this.highlight,this.from,this.to,Hl(this,Ss))}},{key:"toObject",value:function(){return{from:this.from.toObject(),to:this.to.toObject()}}},{key:"_createCellCoords",value:function(r,n){return new Pk(r,n,Hl(this,Ss))}}]),e}();const w3=l3e;function FS(e){"@babel/helpers - typeof";return FS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},FS(e)}function u3e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function FK(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,f3e(n.key),n)}}function c3e(e,t,r){return t&&FK(e.prototype,t),r&&FK(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function f3e(e){var t=h3e(e,"string");return FS(t)==="symbol"?t:String(t)}function h3e(e,t){if(FS(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(FS(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var vy=new WeakMap,d3e=function(){function e(t,r,n,i,o,s){var a=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;u3e(this,e),this.wtSettings=n,this.domBindings=r,this.wtTable=o,this.selections=s,this.parent=a,this.eventManager=i,this.facadeGetter=t,vy.set(this,{selectedCellBeforeTouchEnd:void 0,dblClickTimeout:[null,null],dblClickOrigin:[null,null]}),this.registerEvents()}return c3e(e,[{key:"registerEvents",value:function(){var r=this;this.eventManager.addEventListener(this.wtTable.holder,"contextmenu",function(o){return r.onContextMenu(o)}),this.eventManager.addEventListener(this.wtTable.TABLE,"mouseover",function(o){return r.onMouseOver(o)}),this.eventManager.addEventListener(this.wtTable.TABLE,"mouseout",function(o){return r.onMouseOut(o)});var n=function(){r.eventManager.addEventListener(r.wtTable.holder,"touchstart",function(s){return r.onTouchStart(s)}),r.eventManager.addEventListener(r.wtTable.holder,"touchend",function(s){return r.onTouchEnd(s)}),r.momentumScrolling||(r.momentumScrolling={}),r.eventManager.addEventListener(r.wtTable.holder,"scroll",function(){clearTimeout(r.momentumScrolling._timeout),r.momentumScrolling.ongoing||r.wtSettings.getSetting("onBeforeTouchScroll"),r.momentumScrolling.ongoing=!0,r.momentumScrolling._timeout=setTimeout(function(){r.touchApplied||(r.momentumScrolling.ongoing=!1,r.wtSettings.getSetting("onAfterMomentumScroll"))},200)})},i=function(){r.eventManager.addEventListener(r.wtTable.holder,"mouseup",function(s){return r.onMouseUp(s)}),r.eventManager.addEventListener(r.wtTable.holder,"mousedown",function(s){return r.onMouseDown(s)})};nu()?n():(joe()&&n(),i())}},{key:"selectedCellWasTouched",value:function(r){var n=vy.get(this),i=this.parentCell(r),o=i.coords;if(n.selectedCellBeforeTouchEnd&&o){var s=[o.row,n.selectedCellBeforeTouchEnd.from.row],a=s[0],h=s[1],p=[o.col,n.selectedCellBeforeTouchEnd.from.col],g=p[0],S=p[1];return a===h&&g===S}return!1}},{key:"parentCell",value:function(r){var n={},i=this.wtTable.TABLE,o=JT(r,["TD","TH"],i);return o?(n.coords=this.wtTable.getCoords(o),n.TD=o):Ur(r,"wtBorder")&&Ur(r,"current")?(n.coords=this.selections.getCell().cellRange.highlight,n.TD=this.wtTable.getCell(n.coords)):Ur(r,"wtBorder")&&Ur(r,"area")&&this.selections.createOrGetArea().cellRange&&(n.coords=this.selections.createOrGetArea().cellRange.to,n.TD=this.wtTable.getCell(n.coords)),n}},{key:"onMouseDown",value:function(r){var n=vy.get(this),i=this.domBindings.rootDocument.activeElement,o=eae(oLe,r.target),s=r.target;if(!(s===i||o(0)===i||o(1)===i)){var a=this.parentCell(s);Ur(s,"corner")?this.wtSettings.getSetting("onCellCornerMouseDown",r,s):a.TD&&this.wtSettings.has("onCellMouseDown")&&this.callListener("onCellMouseDown",r,a.coords,a.TD),(r.button===0||this.touchApplied)&&a.TD&&(n.dblClickOrigin[0]=a.TD,clearTimeout(n.dblClickTimeout[0]),n.dblClickTimeout[0]=setTimeout(function(){n.dblClickOrigin[0]=null},1e3))}}},{key:"onContextMenu",value:function(r){if(this.wtSettings.has("onCellContextMenu")){var n=this.parentCell(r.target);n.TD&&this.callListener("onCellContextMenu",r,n.coords,n.TD)}}},{key:"onMouseOver",value:function(r){if(this.wtSettings.has("onCellMouseOver")){var n=this.wtTable.TABLE,i=JT(r.target,["TD","TH"],n),o=this.parent||this;i&&i!==o.lastMouseOver&&xp(i,n)&&(o.lastMouseOver=i,this.callListener("onCellMouseOver",r,this.wtTable.getCoords(i),i))}}},{key:"onMouseOut",value:function(r){if(this.wtSettings.has("onCellMouseOut")){var n=this.wtTable.TABLE,i=JT(r.target,["TD","TH"],n),o=JT(r.relatedTarget,["TD","TH"],n);i&&i!==o&&xp(i,n)&&this.callListener("onCellMouseOut",r,this.wtTable.getCoords(i),i)}}},{key:"onMouseUp",value:function(r){var n=vy.get(this),i=this.parentCell(r.target);i.TD&&this.wtSettings.has("onCellMouseUp")&&this.callListener("onCellMouseUp",r,i.coords,i.TD),!(r.button!==0&&!this.touchApplied)&&(i.TD===n.dblClickOrigin[0]&&i.TD===n.dblClickOrigin[1]?(Ur(r.target,"corner")?this.callListener("onCellCornerDblClick",r,i.coords,i.TD):this.callListener("onCellDblClick",r,i.coords,i.TD),n.dblClickOrigin[0]=null,n.dblClickOrigin[1]=null):i.TD===n.dblClickOrigin[0]&&(n.dblClickOrigin[1]=i.TD,clearTimeout(n.dblClickTimeout[1]),n.dblClickTimeout[1]=setTimeout(function(){n.dblClickOrigin[1]=null},500)))}},{key:"onTouchStart",value:function(r){var n=vy.get(this);n.selectedCellBeforeTouchEnd=this.selections.getCell().cellRange,this.touchApplied=!0,this.onMouseDown(r)}},{key:"onTouchEnd",value:function(r){var n,i=r.target,o=(n=this.parentCell(i))===null||n===void 0?void 0:n.coords,s=dr(o)&&o.row>=0&&o.col>=0,a=r.cancelable&&s&&this.wtSettings.getSetting("isDataViewInstance");if(a){var h=["A","BUTTON","INPUT"];Ioe()&&(A$e()||I$e())&&this.selectedCellWasTouched(i)&&!h.includes(i.tagName)?r.preventDefault():this.selectedCellWasTouched(i)||r.preventDefault()}this.onMouseUp(r),this.touchApplied=!1}},{key:"callListener",value:function(r,n,i,o){var s=this.wtSettings.getSettingPure(r);s&&s(n,i,o,this.facadeGetter())}},{key:"destroy",value:function(){var r=vy.get(this);clearTimeout(r.dblClickTimeout[0]),clearTimeout(r.dblClickTimeout[1]),this.eventManager.destroy()}}]),e}();const Nae=d3e;function HS(e){"@babel/helpers - typeof";return HS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},HS(e)}function p3e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function HK(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,y3e(n.key),n)}}function m3e(e,t,r){return t&&HK(e.prototype,t),r&&HK(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function y3e(e){var t=g3e(e,"string");return HS(t)==="symbol"?t:String(t)}function g3e(e,t){if(HS(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(HS(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var v3e=function(){function e(t,r,n){p3e(this,e),this.offset=t,this.total=r,this.countTH=n}return m3e(e,[{key:"offsetted",value:function(r){return r+this.offset}},{key:"unOffsetted",value:function(r){return r-this.offset}},{key:"renderedToSource",value:function(r){return this.offsetted(r)}},{key:"sourceToRendered",value:function(r){return this.unOffsetted(r)}},{key:"offsettedTH",value:function(r){return r-this.countTH}},{key:"unOffsettedTH",value:function(r){return r+this.countTH}},{key:"visibleRowHeadedColumnToSourceColumn",value:function(r){return this.renderedToSource(this.offsettedTH(r))}},{key:"sourceColumnToVisibleRowHeadedColumn",value:function(r){return this.unOffsettedTH(this.sourceToRendered(r))}}]),e}();const _3e=v3e;function VS(e){"@babel/helpers - typeof";return VS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},VS(e)}function b3e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function VK(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,S3e(n.key),n)}}function w3e(e,t,r){return t&&VK(e.prototype,t),r&&VK(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function S3e(e){var t=x3e(e,"string");return VS(t)==="symbol"?t:String(t)}function x3e(e,t){if(VS(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(VS(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var C3e=function(){function e(t,r,n){b3e(this,e),this.offset=t,this.total=r,this.countTH=n}return w3e(e,[{key:"offsetted",value:function(r){return r+this.offset}},{key:"unOffsetted",value:function(r){return r-this.offset}},{key:"renderedToSource",value:function(r){return this.offsetted(r)}},{key:"sourceToRendered",value:function(r){return this.unOffsetted(r)}},{key:"offsettedTH",value:function(r){return r-this.countTH}},{key:"unOffsettedTH",value:function(r){return r+this.countTH}},{key:"visibleColHeadedRowToSourceRow",value:function(r){return this.renderedToSource(this.offsettedTH(r))}},{key:"sourceRowToVisibleColHeadedRow",value:function(r){return this.unOffsettedTH(this.sourceToRendered(r))}}]),e}();const E3e=C3e;var T3e=0,Ak=1,Ik=2;function US(e){"@babel/helpers - typeof";return US=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},US(e)}function O3e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function UK(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,k3e(n.key),n)}}function R3e(e,t,r){return t&&UK(e.prototype,t),r&&UK(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function k3e(e){var t=P3e(e,"string");return US(t)==="symbol"?t:String(t)}function P3e(e,t){if(US(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(US(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var WK=function(){function e(){O3e(this,e),this.currentSize=0,this.nextSize=0,this.currentOffset=0,this.nextOffset=0}return R3e(e,[{key:"setSize",value:function(r){this.currentSize=this.nextSize,this.nextSize=r}},{key:"setOffset",value:function(r){this.currentOffset=this.nextOffset,this.nextOffset=r}}]),e}();function WS(e){"@babel/helpers - typeof";return WS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},WS(e)}function A3e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function GK(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,M3e(n.key),n)}}function I3e(e,t,r){return t&&GK(e.prototype,t),r&&GK(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function M3e(e){var t=D3e(e,"string");return WS(t)==="symbol"?t:String(t)}function D3e(e,t){if(WS(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(WS(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var $3e=function(){function e(){A3e(this,e),this.size=new WK,this.workingSpace=T3e,this.sharedSize=null}return I3e(e,[{key:"setSize",value:function(r){this.size.setSize(r)}},{key:"setOffset",value:function(r){this.size.setOffset(r)}},{key:"getViewSize",value:function(){return this.size}},{key:"isShared",value:function(){return this.sharedSize instanceof WK}},{key:"isPlaceOn",value:function(r){return this.workingSpace===r}},{key:"append",value:function(r){this.workingSpace=Ak,r.workingSpace=Ik,this.sharedSize=r.getViewSize()}},{key:"prepend",value:function(r){this.workingSpace=Ik,r.workingSpace=Ak,this.sharedSize=r.getViewSize()}}]),e}();function GS(e){"@babel/helpers - typeof";return GS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},GS(e)}function L3e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function YK(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,B3e(n.key),n)}}function N3e(e,t,r){return t&&YK(e.prototype,t),r&&YK(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function B3e(e){var t=j3e(e,"string");return GS(t)==="symbol"?t:String(t)}function j3e(e,t){if(GS(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(GS(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Bae=function(){function e(t,r,n){L3e(this,e),this.rootNode=t,this.nodesPool=r,this.sizeSet=new $3e,this.childNodeType=n.toUpperCase(),this.visualIndex=0,this.collectedNodes=[]}return N3e(e,[{key:"setSize",value:function(r){return this.sizeSet.setSize(r),this}},{key:"setOffset",value:function(r){return this.sizeSet.setOffset(r),this}},{key:"isSharedViewSet",value:function(){return this.sizeSet.isShared()}},{key:"getNode",value:function(r){return r<this.collectedNodes.length?this.collectedNodes[r]:null}},{key:"getCurrentNode",value:function(){var r=this.collectedNodes.length;return r>0?this.collectedNodes[r-1]:null}},{key:"getRenderedChildCount",value:function(){var r=this.rootNode,n=this.sizeSet,i=0;if(this.isSharedViewSet())for(var o=r.firstElementChild;o;){if(o.tagName===this.childNodeType)i+=1;else if(n.isPlaceOn(Ak))break;o=o.nextElementSibling}else i=r.childElementCount;return i}},{key:"start",value:function(){this.collectedNodes.length=0,this.visualIndex=0;for(var r=this.rootNode,n=this.sizeSet,i=this.isSharedViewSet(),o=n.getViewSize(),s=o.nextSize,a=this.getRenderedChildCount();a<s;){var h=this.nodesPool();!i||i&&n.isPlaceOn(Ik)?r.appendChild(h):r.insertBefore(h,r.firstChild),a+=1}for(var p=i&&n.isPlaceOn(Ak);a>s;)r.removeChild(p?r.firstChild:r.lastChild),a-=1}},{key:"render",value:function(){var r=this.rootNode,n=this.sizeSet,i=this.visualIndex;this.isSharedViewSet()&&n.isPlaceOn(Ik)&&(i+=n.sharedSize.nextSize);var o=r.childNodes[i];if(o.tagName!==this.childNodeType){var s=this.nodesPool();r.replaceChild(s,o),o=s}this.collectedNodes.push(o),this.visualIndex+=1}},{key:"end",value:function(){}}]),e}();function nv(e){"@babel/helpers - typeof";return nv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nv(e)}function z3e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function KK(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,H3e(n.key),n)}}function F3e(e,t,r){return t&&KK(e.prototype,t),r&&KK(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function H3e(e){var t=V3e(e,"string");return nv(t)==="symbol"?t:String(t)}function V3e(e,t){if(nv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(nv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function U3e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&rB(e,t)}function rB(e,t){return rB=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},rB(e,t)}function W3e(e){var t=K3e();return function(){var n=Mk(e),i;if(t){var o=Mk(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return G3e(this,i)}}function G3e(e,t){if(t&&(nv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Y3e(e)}function Y3e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function K3e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Mk(e){return Mk=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Mk(e)}var jae=function(e){U3e(r,e);var t=W3e(r);function r(){return z3e(this,r),t.apply(this,arguments)}return F3e(r,[{key:"prependView",value:function(i){return this.sizeSet.prepend(i.sizeSet),i.sizeSet.append(this.sizeSet),this}},{key:"appendView",value:function(i){return this.sizeSet.append(i.sizeSet),i.sizeSet.prepend(this.sizeSet),this}}]),r}(Bae);function YS(e){"@babel/helpers - typeof";return YS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},YS(e)}function q3e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function qK(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Z3e(n.key),n)}}function X3e(e,t,r){return t&&qK(e.prototype,t),r&&qK(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Z3e(e){var t=J3e(e,"string");return YS(t)==="symbol"?t:String(t)}function J3e(e,t){if(YS(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(YS(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Q3e=function(){function e(t){q3e(this,e),this.nodeType=t.toUpperCase()}return X3e(e,[{key:"setRootDocument",value:function(r){this.rootDocument=r}},{key:"obtain",value:function(){return this.rootDocument.createElement(this.nodeType)}}]),e}();function KS(e){"@babel/helpers - typeof";return KS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},KS(e)}function eVe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function XK(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,rVe(n.key),n)}}function tVe(e,t,r){return t&&XK(e.prototype,t),r&&XK(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function rVe(e){var t=nVe(e,"string");return KS(t)==="symbol"?t:String(t)}function nVe(e,t){if(KS(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(KS(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var yC=function(){function e(t,r){eVe(this,e),this.nodesPool=typeof t=="string"?new Q3e(t):null,this.nodeType=t,this.rootNode=r,this.table=null,this.renderedNodes=0}return tVe(e,[{key:"setTable",value:function(r){this.nodesPool&&this.nodesPool.setRootDocument(r.rootDocument),this.table=r}},{key:"adjust",value:function(){}},{key:"render",value:function(){}}]),e}();function iv(e){"@babel/helpers - typeof";return iv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},iv(e)}function iVe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ZK(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,aVe(n.key),n)}}function oVe(e,t,r){return t&&ZK(e.prototype,t),r&&ZK(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function aVe(e){var t=sVe(e,"string");return iv(t)==="symbol"?t:String(t)}function sVe(e,t){if(iv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(iv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function lVe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&nB(e,t)}function nB(e,t){return nB=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},nB(e,t)}function uVe(e){var t=hVe();return function(){var n=Dk(e),i;if(t){var o=Dk(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return cVe(this,i)}}function cVe(e,t){if(t&&(iv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return fVe(e)}function fVe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function hVe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Dk(e){return Dk=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Dk(e)}var dVe=function(e){lVe(r,e);var t=uVe(r);function r(){var n;return iVe(this,r),n=t.call(this,"TH"),n.orderViews=new WeakMap,n.sourceRowIndex=0,n}return oVe(r,[{key:"obtainOrderView",value:function(i){var o=this,s;return this.orderViews.has(i)?s=this.orderViews.get(i):(s=new jae(i,function(a){return o.nodesPool.obtain(o.sourceRowIndex,a)},this.nodeType),this.orderViews.set(i,s)),s}},{key:"render",value:function(){for(var i=this.table,o=i.rowsToRender,s=i.rowHeaderFunctions,a=i.rowHeadersCount,h=i.rows,p=i.cells,g=0;g<o;g++){var S=this.table.renderedRowToSource(g),T=h.getRenderedNode(g);this.sourceRowIndex=S;var R=this.obtainOrderView(T),A=p.obtainOrderView(T);R.appendView(A).setSize(a).setOffset(this.table.renderedColumnToSource(0)).start();for(var $=0;$<a;$++){R.render();var j=R.getCurrentNode();j.className="",j.removeAttribute("style"),s[$](S,j,$)}R.end()}}}]),r}(yC);function ov(e){"@babel/helpers - typeof";return ov=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ov(e)}function pVe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function JK(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,yVe(n.key),n)}}function mVe(e,t,r){return t&&JK(e.prototype,t),r&&JK(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function yVe(e){var t=gVe(e,"string");return ov(t)==="symbol"?t:String(t)}function gVe(e,t){if(ov(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ov(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function vVe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&iB(e,t)}function iB(e,t){return iB=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},iB(e,t)}function _Ve(e){var t=SVe();return function(){var n=$k(e),i;if(t){var o=$k(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return bVe(this,i)}}function bVe(e,t){if(t&&(ov(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return wVe(e)}function wVe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function SVe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function $k(e){return $k=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},$k(e)}var xVe=function(e){vVe(r,e);var t=_Ve(r);function r(n){return pVe(this,r),t.call(this,null,n)}return mVe(r,[{key:"adjust",value:function(){var i=this.table,o=i.columnHeadersCount,s=i.rowHeadersCount,a=this.rootNode.firstChild;if(o){for(var h=this.table.columnsToRender,p=h+s,g=0,S=o;g<S;g++){for(a=this.rootNode.childNodes[g],a||(a=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(a)),this.renderedNodes=a.childNodes.length;this.renderedNodes<p;)a.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>p;)a.removeChild(a.lastChild),this.renderedNodes-=1}var T=this.rootNode.childNodes.length;if(T>o)for(var R=o;R<T;R++)this.rootNode.removeChild(this.rootNode.lastChild)}else a&&uu(a)}},{key:"render",value:function(){for(var i=this.table.columnHeadersCount,o=0;o<i;o+=1)for(var s=this.table,a=s.columnHeaderFunctions,h=s.columnsToRender,p=s.rowHeadersCount,g=this.rootNode.childNodes[o],S=-1*p;S<h;S+=1){var T=this.table.renderedColumnToSource(S),R=g.childNodes[S+p];R.className="",R.removeAttribute("style"),a[o](T,R,o)}}}]),r}(yC);function av(e){"@babel/helpers - typeof";return av=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},av(e)}function CVe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function QK(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,TVe(n.key),n)}}function EVe(e,t,r){return t&&QK(e.prototype,t),r&&QK(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function TVe(e){var t=OVe(e,"string");return av(t)==="symbol"?t:String(t)}function OVe(e,t){if(av(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(av(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function RVe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&oB(e,t)}function oB(e,t){return oB=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},oB(e,t)}function kVe(e){var t=IVe();return function(){var n=Lk(e),i;if(t){var o=Lk(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return PVe(this,i)}}function PVe(e,t){if(t&&(av(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return AVe(e)}function AVe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function IVe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Lk(e){return Lk=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Lk(e)}var MVe=function(e){RVe(r,e);var t=kVe(r);function r(n){return CVe(this,r),t.call(this,null,n)}return EVe(r,[{key:"adjust",value:function(){for(var i=this.table,o=i.columnsToRender,s=i.rowHeadersCount,a=o+s;this.renderedNodes<a;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>a;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}},{key:"render",value:function(){this.adjust();for(var i=this.table,o=i.columnsToRender,s=i.rowHeadersCount,a=0;a<s;a++){var h=this.table.renderedColumnToSource(a),p=this.table.columnUtils.getHeaderWidth(h);this.rootNode.childNodes[a].style.width="".concat(p,"px")}for(var g=0;g<o;g++){var S=this.table.renderedColumnToSource(g),T=this.table.columnUtils.getStretchedColumnWidth(S);this.rootNode.childNodes[g+s].style.width="".concat(T,"px")}var R=this.rootNode.firstChild;R&&Ht(R,"rowHeader")}}]),r}(yC);function sv(e){"@babel/helpers - typeof";return sv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sv(e)}var eq;function DVe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function $Ve(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function tq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,NVe(n.key),n)}}function LVe(e,t,r){return t&&tq(e.prototype,t),r&&tq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function NVe(e){var t=BVe(e,"string");return sv(t)==="symbol"?t:String(t)}function BVe(e,t){if(sv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(sv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function jVe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&aB(e,t)}function aB(e,t){return aB=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},aB(e,t)}function zVe(e){var t=VVe();return function(){var n=Nk(e),i;if(t){var o=Nk(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return FVe(this,i)}}function FVe(e,t){if(t&&(sv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return HVe(e)}function HVe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function VVe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Nk(e){return Nk=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Nk(e)}var rq=!1,UVe=function(e){jVe(r,e);var t=zVe(r);function r(n){var i;return $Ve(this,r),i=t.call(this,"TR",n),i.orderView=new Bae(n,function(o){return i.nodesPool.obtain(o)},i.nodeType),i}return LVe(r,[{key:"getRenderedNode",value:function(i){return this.orderView.getNode(i)}},{key:"render",value:function(){var i=this.table.rowsToRender;!rq&&i>1e3&&(rq=!0,ti(Xn(eq||(eq=DVe([`Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting 
        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.`],[`Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting\\x20
        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.`]))))),this.orderView.setSize(i).setOffset(this.table.renderedRowToSource(0)).start();for(var o=0;o<i;o++)this.orderView.render();this.orderView.end()}}]),r}(yC);function lv(e){"@babel/helpers - typeof";return lv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lv(e)}function WVe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function nq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,YVe(n.key),n)}}function GVe(e,t,r){return t&&nq(e.prototype,t),r&&nq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function YVe(e){var t=KVe(e,"string");return lv(t)==="symbol"?t:String(t)}function KVe(e,t){if(lv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(lv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function qVe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&sB(e,t)}function sB(e,t){return sB=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},sB(e,t)}function XVe(e){var t=QVe();return function(){var n=Bk(e),i;if(t){var o=Bk(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return ZVe(this,i)}}function ZVe(e,t){if(t&&(lv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return JVe(e)}function JVe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function QVe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Bk(e){return Bk=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Bk(e)}var eUe=function(e){qVe(r,e);var t=XVe(r);function r(){var n;return WVe(this,r),n=t.call(this,"TD"),n.orderViews=new WeakMap,n.sourceRowIndex=0,n}return GVe(r,[{key:"obtainOrderView",value:function(i){var o=this,s;return this.orderViews.has(i)?s=this.orderViews.get(i):(s=new jae(i,function(a){return o.nodesPool.obtain(o.sourceRowIndex,a)},this.nodeType),this.orderViews.set(i,s)),s}},{key:"render",value:function(){for(var i=this.table,o=i.rowsToRender,s=i.columnsToRender,a=i.rows,h=i.rowHeaders,p=0;p<o;p++){var g=this.table.renderedRowToSource(p),S=a.getRenderedNode(p);this.sourceRowIndex=g;var T=this.obtainOrderView(S),R=h.obtainOrderView(S);T.prependView(R).setSize(s).setOffset(this.table.renderedColumnToSource(0)).start();for(var A=0;A<s;A++){T.render();var $=T.getCurrentNode(),j=this.table.renderedColumnToSource(A);Ur($,"hide")||($.className=""),$.removeAttribute("style"),$.removeAttribute("dir"),this.table.cellRenderer(g,j,$)}T.end()}}}]),r}(yC);function qS(e){"@babel/helpers - typeof";return qS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qS(e)}function tUe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function iq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,nUe(n.key),n)}}function rUe(e,t,r){return t&&iq(e.prototype,t),r&&iq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function nUe(e){var t=iUe(e,"string");return qS(t)==="symbol"?t:String(t)}function iUe(e,t){if(qS(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(qS(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var oUe=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=r.cellRenderer;tUe(this,e),this.rootNode=t,this.rootDocument=this.rootNode.ownerDocument,this.rowHeaders=null,this.columnHeaders=null,this.colGroup=null,this.rows=null,this.cells=null,this.rowFilter=null,this.columnFilter=null,this.rowUtils=null,this.columnUtils=null,this.rowsToRender=0,this.columnsToRender=0,this.rowHeaderFunctions=[],this.rowHeadersCount=0,this.columnHeaderFunctions=[],this.columnHeadersCount=0,this.cellRenderer=n}return rUe(e,[{key:"setAxisUtils",value:function(r,n){this.rowUtils=r,this.columnUtils=n}},{key:"setViewportSize",value:function(r,n){this.rowsToRender=r,this.columnsToRender=n}},{key:"setFilters",value:function(r,n){this.rowFilter=r,this.columnFilter=n}},{key:"setHeaderContentRenderers",value:function(r,n){this.rowHeaderFunctions=r,this.rowHeadersCount=r.length,this.columnHeaderFunctions=n,this.columnHeadersCount=n.length}},{key:"setRenderers",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=r.rowHeaders,i=r.columnHeaders,o=r.colGroup,s=r.rows,a=r.cells;n.setTable(this),i.setTable(this),o.setTable(this),s.setTable(this),a.setTable(this),this.rowHeaders=n,this.columnHeaders=i,this.colGroup=o,this.rows=s,this.cells=a}},{key:"renderedRowToSource",value:function(r){return this.rowFilter.renderedToSource(r)}},{key:"renderedColumnToSource",value:function(r){return this.columnFilter.renderedToSource(r)}},{key:"render",value:function(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();for(var r=this.rowsToRender,n=this.rows,i=0;i<r;i++){var o=n.getRenderedNode(i);if(o.firstChild){var s=this.renderedRowToSource(i),a=this.rowUtils.getHeight(s);a?o.firstChild.style.height="".concat(a-1,"px"):o.firstChild.style.height=""}}}}]),e}();function XS(e){"@babel/helpers - typeof";return XS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},XS(e)}function aUe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function oq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,lUe(n.key),n)}}function sUe(e,t,r){return t&&oq(e.prototype,t),r&&oq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function lUe(e){var t=uUe(e,"string");return XS(t)==="symbol"?t:String(t)}function uUe(e,t){if(XS(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(XS(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var cUe=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.TABLE,n=t.THEAD,i=t.COLGROUP,o=t.TBODY,s=t.rowUtils,a=t.columnUtils,h=t.cellRenderer;aUe(this,e),this.renderer=new oUe(r,{cellRenderer:h}),this.renderer.setRenderers({rowHeaders:new dVe,columnHeaders:new xVe(n),colGroup:new MVe(i),rows:new UVe(o),cells:new eUe}),this.renderer.setAxisUtils(s,a)}return sUe(e,[{key:"setFilters",value:function(r,n){return this.renderer.setFilters(r,n),this}},{key:"setViewportSize",value:function(r,n){return this.renderer.setViewportSize(r,n),this}},{key:"setHeaderContentRenderers",value:function(r,n){return this.renderer.setHeaderContentRenderers(r,n),this}},{key:"adjust",value:function(){this.renderer.adjust()}},{key:"render",value:function(){this.renderer.render()}}]),e}();function ZS(e){"@babel/helpers - typeof";return ZS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ZS(e)}function fUe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function aq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,dUe(n.key),n)}}function hUe(e,t,r){return t&&aq(e.prototype,t),r&&aq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function dUe(e){var t=pUe(e,"string");return ZS(t)==="symbol"?t:String(t)}function pUe(e,t){if(ZS(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ZS(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var mUe=function(){function e(t,r){fUe(this,e),this.dataAccessObject=t,this.wtSettings=r,this.headerWidths=new Map}return hUe(e,[{key:"getWidth",value:function(r){return this.wtSettings.getSetting("columnWidth",r)||this.wtSettings.getSetting("defaultColumnWidth")}},{key:"getStretchedColumnWidth",value:function(r){var n=this.dataAccessObject.wtViewport.columnsRenderCalculator,i=this.getWidth(r);if(n){var o=n.getStretchedColumnWidth(r,i);o&&(i=o)}return i}},{key:"getHeaderHeight",value:function(r){var n=this.wtSettings.getSetting("defaultRowHeight"),i=this.dataAccessObject.wtViewport.oversizedColumnHeaders[r];return i!==void 0&&(n=n?Math.max(n,i):i),n}},{key:"getHeaderWidth",value:function(r){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(r))}},{key:"calculateWidths",value:function(){var r=this.wtSettings,n=this.dataAccessObject,i=n.wtTable,o=n.wtViewport,s=n.cloneSource,a=s?s.wtTable.holder:i.holder,h=a.offsetHeight<a.scrollHeight?Ao():0,p=r.getSetting("rowHeaderWidth");if(o.columnsRenderCalculator.refreshStretching(o.getViewportWidth()-h),p=r.getSetting("onModifyRowHeaderWidth",p),p!=null)for(var g=r.getSetting("rowHeaders").length,S=r.getSetting("defaultColumnWidth"),T=0;T<g;T++){var R=Array.isArray(p)?p[T]:p;R=R??S,this.headerWidths.set(T,R)}}}]),e}();function JS(e){"@babel/helpers - typeof";return JS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},JS(e)}function yUe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function sq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,vUe(n.key),n)}}function gUe(e,t,r){return t&&sq(e.prototype,t),r&&sq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function vUe(e){var t=_Ue(e,"string");return JS(t)==="symbol"?t:String(t)}function _Ue(e,t){if(JS(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(JS(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var bUe=function(){function e(t,r){yUe(this,e),this.dataAccessObject=t,this.wtSettings=r}return gUe(e,[{key:"getHeight",value:function(r){var n=this.wtSettings.getSetting("rowHeight",r),i=this.dataAccessObject.wtViewport.oversizedRows[r];return i!==void 0&&(n=n===void 0?i:Math.max(n,i)),n}}]),e}();function QS(e){"@babel/helpers - typeof";return QS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},QS(e)}function wUe(e){return CUe(e)||xUe(e)||zae(e)||SUe()}function SUe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function xUe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function CUe(e){if(Array.isArray(e))return lB(e)}function EUe(e,t){return RUe(e)||OUe(e,t)||zae(e,t)||TUe()}function TUe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zae(e,t){if(e){if(typeof e=="string")return lB(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return lB(e,t)}}function lB(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function OUe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],h=!0,p=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;h=!1}else for(;!(h=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);h=!0);}catch(g){p=!0,i=g}finally{try{if(!h&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(p)throw i}}return a}}function RUe(e){if(Array.isArray(e))return e}function kUe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function lq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Fae(n.key),n)}}function PUe(e,t,r){return t&&lq(e.prototype,t),r&&lq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Vl(e,t,r){return t=Fae(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Fae(e){var t=AUe(e,"string");return QS(t)==="symbol"?t:String(t)}function AUe(e,t){if(QS(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(QS(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var IUe=function(){function e(t,r,n,i,o){var s=this;kUe(this,e),Vl(this,"wtSettings",null),Vl(this,"domBindings",void 0),Vl(this,"TBODY",null),Vl(this,"THEAD",null),Vl(this,"COLGROUP",null),Vl(this,"hasTableHeight",!0),Vl(this,"hasTableWidth",!0),Vl(this,"isTableVisible",!1),Vl(this,"tableOffset",0),Vl(this,"holderOffset",0),this.domBindings=n,this.isMaster=o==="master",this.name=o,this.dataAccessObject=t,this.facadeGetter=r,this.wtSettings=i,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=n.rootTable,Goe(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;var a=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",function(){return s._modifyRowHeaderWidth(a)}),this.rowUtils=new bUe(this.dataAccessObject,this.wtSettings),this.columnUtils=new mUe(this.dataAccessObject,this.wtSettings),this.tableRenderer=new cUe({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer")})}return PUe(e,[{key:"is",value:function(r){return this.name===r}},{key:"fixTableDomTree",value:function(){var r=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=r.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=r.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=r.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}},{key:"createSpreader",value:function(r){var n=r.parentNode,i;return(!n||n.nodeType!==Node.ELEMENT_NODE||!Ur(n,"wtHolder"))&&(i=this.domBindings.rootDocument.createElement("div"),i.className="wtSpreader",n&&n.insertBefore(i,r),i.appendChild(r)),i.style.position="relative",i}},{key:"createHider",value:function(r){var n=r.parentNode,i;return(!n||n.nodeType!==Node.ELEMENT_NODE||!Ur(n,"wtHolder"))&&(i=this.domBindings.rootDocument.createElement("div"),i.className="wtHider",n&&n.insertBefore(i,r),i.appendChild(r)),i}},{key:"createHolder",value:function(r){var n=r.parentNode,i;return(!n||n.nodeType!==Node.ELEMENT_NODE||!Ur(n,"wtHolder"))&&(i=this.domBindings.rootDocument.createElement("div"),i.style.position="relative",i.className="wtHolder",n&&n.insertBefore(i,r),this.isMaster&&(i.parentNode.className+="ht_master handsontable",i.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr")),i.appendChild(r)),i}},{key:"draw",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.wtSettings,i=this.dataAccessObject,o=i.wtOverlays,s=i.wtViewport,a=n.getSetting("totalRows"),h=n.getSetting("totalColumns"),p=n.getSetting("rowHeaders"),g=p.length,S=n.getSetting("columnHeaders"),T=S.length,R=!1,A=r;if(this.isMaster&&(this.holderOffset=io(this.holder),A=s.createRenderCalculators(A),g&&!n.getSetting("fixedColumnsStart"))){var $=o.inlineStartOverlay.getScrollPosition(),j=this.correctHeaderWidth;this.correctHeaderWidth=$!==0,j!==this.correctHeaderWidth&&(A=!1)}if(this.isMaster&&(R=o.updateStateOfRendering()),A)this.isMaster&&s.createVisibleCalculators(),o&&o.refresh(!0);else{this.isMaster?this.tableOffset=io(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;var z=a>0?this.getFirstRenderedRow():0,V=h>0?this.getFirstRenderedColumn():0;this.rowFilter=new E3e(z,a,T),this.columnFilter=new _3e(V,h,g);var G=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();var ee={};this.wtSettings.getSetting("beforeDraw",!0,ee),G=ee.skipRender!==!0}if(G){this.tableRenderer.setHeaderContentRenderers(p,S),(this.is(ru)||this.is(rh))&&this.tableRenderer.setHeaderContentRenderers(p,[]),this.resetOversizedRows(),this.tableRenderer.setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render();var K;if(this.isMaster&&(K=this.dataAccessObject.workspaceWidth,this.dataAccessObject.wtViewport.containerWidth=null,this.markOversizedColumnHeaders()),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(ru))&&this.markOversizedRows(),this.isMaster){this.dataAccessObject.wtViewport.createVisibleCalculators(),this.dataAccessObject.wtOverlays.refresh(!1),this.dataAccessObject.wtOverlays.applyToDOM();var xe=ri(this.hider),Me=ri(this.TABLE);xe!==0&&Me!==xe&&(this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),K!==this.dataAccessObject.wtViewport.getWorkspaceWidth()&&(this.dataAccessObject.wtViewport.containerWidth=null,this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),this.wtSettings.getSetting("onDraw",!0)}else this.is(ru)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize()}}var He=!1;return this.isMaster&&(He=o.topOverlay.resetFixedPosition(),o.bottomOverlay.clone&&(He=o.bottomOverlay.resetFixedPosition()||He),He=o.inlineStartOverlay.resetFixedPosition()||He,o.topInlineStartCornerOverlay&&o.topInlineStartCornerOverlay.resetFixedPosition(),o.bottomInlineStartCornerOverlay&&o.bottomInlineStartCornerOverlay.clone&&o.bottomInlineStartCornerOverlay.resetFixedPosition()),He?(o.refreshAll(),o.adjustElementsSize()):this.refreshSelections(A),R&&o.syncScrollWithMaster(),this.dataAccessObject.drawn=!0,this}},{key:"markIfOversizedColumnHeader",value:function(r){for(var n=this.columnFilter.renderedToSource(r),i=this.wtSettings.getSetting("columnHeaders").length,o=this.wtSettings.getSetting("defaultRowHeight"),s,a,h,p=this.wtSettings.getSetting("columnHeaderHeight")||[];i;)i-=1,s=this.getColumnHeaderHeight(i),a=this.getColumnHeader(n,i),a&&(h=Vf(a),(!s&&o<h||s<h)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=h),Array.isArray(p)?p[i]!==null&&p[i]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=p[i]):isNaN(p)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=p),this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]<(p[i]||p)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=p[i]||p))}},{key:"adjustColumnHeaderHeights",value:function(){for(var r=this.wtSettings,n=this.THEAD.childNodes,i=this.dataAccessObject.wtViewport.oversizedColumnHeaders,o=r.getSetting("columnHeaders"),s=0,a=o.length;s<a;s++)if(i[s]){if(!n[s]||n[s].childNodes.length===0)return;n[s].childNodes[0].style.height="".concat(i[s],"px")}}},{key:"resetOversizedRows",value:function(){var r=this.wtSettings,n=this.dataAccessObject.wtViewport;if(!(!this.isMaster&&!this.is(ru))&&!r.getSetting("externalRowCalculator"))for(var i=this.getRenderedRowsCount(),o=0;o<i;o++){var s=this.rowFilter.renderedToSource(o);n.oversizedRows&&n.oversizedRows[s]&&(n.oversizedRows[s]=void 0)}}},{key:"removeClassFromCells",value:function(r){for(var n=this.TABLE.querySelectorAll(".".concat(r)),i=0,o=n.length;i<o;i++)Kr(n[i],r)}},{key:"refreshSelections",value:function(r){var n=this.wtSettings,i=this.dataAccessObject.selections;if(i){var o=Array.from(i),s=o.length;if(r){for(var a=[],h=0;h<s;h++){for(var p=o[h].settings,g=p.highlightHeaderClassName,S=p.highlightRowClassName,T=p.highlightColumnClassName,R=o[h].classNames,A=R.length,$=0;$<A;$++)a.includes(R[$])||a.push(R[$]);g&&!a.includes(g)&&a.push(g),S&&!a.includes(S)&&a.push(S),T&&!a.includes(T)&&a.push(T)}var j=n.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(j))for(var z=0;z<j.length;z++)a.push(j[z]);for(var V=a.length,G=0;G<V;G++)this.removeClassFromCells(a[G])}for(var ee=0;ee<s;ee++)o[ee].draw(this.facadeGetter(),r)}}},{key:"getCell",value:function(r){var n=r.row,i=r.col,o=this.wtSettings.getSetting("onModifyGetCellCoords",n,i);if(o&&Array.isArray(o)){var s=EUe(o,2);n=s[0],i=s[1]}if(this.isRowBeforeRenderedRows(n))return-1;if(this.isRowAfterRenderedRows(n))return-2;if(this.isColumnBeforeRenderedColumns(i))return-3;if(this.isColumnAfterRenderedColumns(i))return-4;var a=this.getRow(n);if(!a&&n>=0)throw new Error("TR was expected to be rendered but is not");var h=a.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(i)];if(!h&&i>=0)throw new Error("TD or TH was expected to be rendered but is not");return h}},{key:"getRow",value:function(r){var n=null,i=null;if(r<0){var o;n=(o=this.rowFilter)===null||o===void 0?void 0:o.sourceRowToVisibleColHeadedRow(r),i=this.THEAD}else{var s;n=(s=this.rowFilter)===null||s===void 0?void 0:s.sourceToRendered(r),i=this.TBODY}return n!==void 0&&i!==void 0?i.childNodes.length<n+1?!1:i.childNodes[n]:!1}},{key:"getColumnHeader",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=this.THEAD.childNodes[n];return i==null?void 0:i.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r)]}},{key:"getColumnHeaders",value:function(r){var n=[],i=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r);return this.THEAD.childNodes.forEach(function(o){var s=o.childNodes[i];s&&n.push(s)}),n}},{key:"getRowHeader",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0)!==0){var i=this.wtSettings.getSetting("rowHeaders").length;if(!(n>=i)){var o=this.TBODY.childNodes[this.rowFilter.sourceToRendered(r)];return o==null?void 0:o.childNodes[n]}}}},{key:"getRowHeaders",value:function(r){if(this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0)===0)return[];for(var n=[],i=this.wtSettings.getSetting("rowHeaders").length,o=0;o<i;o++){var s=this.TBODY.childNodes[this.rowFilter.sourceToRendered(r)],a=s==null?void 0:s.childNodes[o];a&&n.push(a)}return n}},{key:"getCoords",value:function(r){var n=r;if(n.nodeName!=="TD"&&n.nodeName!=="TH"&&(n=Sp(n,["TD","TH"])),n===null)return null;var i=n.parentNode,o=i.parentNode,s=sLe(i),a=n.cellIndex;if(bd(Np,n,this.wtRootElement)||bd($p,n,this.wtRootElement))o.nodeName==="THEAD"&&(s-=o.childNodes.length);else if(bd(rh,n,this.wtRootElement)||bd(ru,n,this.wtRootElement)){var h=this.wtSettings.getSetting("totalRows");s=h-o.childNodes.length+s}else o===this.THEAD?s=this.rowFilter.visibleColHeadedRowToSourceRow(s):s=this.rowFilter.renderedToSource(s);return bd(Np,n,this.wtRootElement)||bd(Lp,n,this.wtRootElement)||bd(rh,n,this.wtRootElement)?a=this.columnFilter.offsettedTH(a):a=this.columnFilter.visibleRowHeadedColumnToSourceColumn(a),this.wot.createCellCoords(s,a)}},{key:"markOversizedRows",value:function(){if(!this.wtSettings.getSetting("externalRowCalculator")){var r=this.TBODY.childNodes.length,n=r*this.wtSettings.getSetting("defaultRowHeight"),i=Vf(this.TBODY)-1,o,s,a,h,p;if(!(n===i&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;r;)r-=1,a=this.rowFilter.renderedToSource(r),o=this.getRowHeight(a),h=this.getTrForRow(a),p=h.querySelector("th"),p?s=Vf(p):s=Vf(h)-1,(!o&&this.wtSettings.getSetting("defaultRowHeight")<s||o<s)&&(s+=1,this.dataAccessObject.wtViewport.oversizedRows[a]=s)}}},{key:"getTrForRow",value:function(r){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(r)]}},{key:"isColumnHeaderRendered",value:function(r){if(r>=0)return!1;var n=this.wtSettings.getSetting("rowHeaders"),i=n.length;return Math.abs(r)<=i}},{key:"isRowHeaderRendered",value:function(r){if(r>=0)return!1;var n=this.wtSettings.getSetting("columnHeaders"),i=n.length;return Math.abs(r)<=i}},{key:"isRowBeforeRenderedRows",value:function(r){var n=this.getFirstRenderedRow();return r<0&&n<=0?!this.isRowHeaderRendered(r):r<n}},{key:"isRowAfterRenderedRows",value:function(r){return r>this.getLastRenderedRow()}},{key:"isColumnBeforeRenderedColumns",value:function(r){var n=this.getFirstRenderedColumn();return r<0&&n<=0?!this.isColumnHeaderRendered(r):r<n}},{key:"isColumnAfterRenderedColumns",value:function(r){return this.columnFilter&&r>this.getLastRenderedColumn()}},{key:"isColumnAfterViewport",value:function(r){return this.columnFilter&&r>this.getLastVisibleColumn()}},{key:"isRowAfterViewport",value:function(r){return this.rowFilter&&r>this.getLastVisibleRow()}},{key:"isColumnBeforeViewport",value:function(r){return this.columnFilter&&this.columnFilter.sourceToRendered(r)<0&&r>=0}},{key:"isLastRowFullyVisible",value:function(){return this.getLastVisibleRow()===this.getLastRenderedRow()}},{key:"isLastColumnFullyVisible",value:function(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}},{key:"allRowsInViewport",value:function(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}},{key:"allColumnsInViewport",value:function(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}},{key:"getRowHeight",value:function(r){return this.rowUtils.getHeight(r)}},{key:"getColumnHeaderHeight",value:function(r){return this.columnUtils.getHeaderHeight(r)}},{key:"getColumnWidth",value:function(r){return this.columnUtils.getWidth(r)}},{key:"getStretchedColumnWidth",value:function(r){return this.columnUtils.getStretchedColumnWidth(r)}},{key:"hasDefinedSize",value:function(){return this.hasTableHeight&&this.hasTableWidth}},{key:"getWidth",value:function(){return ri(this.TABLE)}},{key:"getHeight",value:function(){return $i(this.TABLE)}},{key:"getTotalWidth",value:function(){var r=ri(this.hider);return r!==0?r:this.getWidth()}},{key:"getTotalHeight",value:function(){var r=$i(this.hider);return r!==0?r:this.getHeight()}},{key:"isVisible",value:function(){return OS(this.TABLE)}},{key:"_modifyRowHeaderWidth",value:function(r){var n=ci(r)?r():null;return Array.isArray(n)?(n=wUe(n),n[n.length-1]=this._correctRowHeaderWidth(n[n.length-1])):n=this._correctRowHeaderWidth(n),n}},{key:"_correctRowHeaderWidth",value:function(r){var n=r;return typeof r!="number"&&(n=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(n+=1),n}}]),e}();const sb=IUe;var MUe="stickyRowsBottom",Hae={getFirstRenderedRow:function(){var t=this.wtSettings.getSetting("totalRows"),r=this.wtSettings.getSetting("fixedRowsBottom"),n=t-r;return t===0||r===0?-1:n<0?0:n},getFirstVisibleRow:function(){return this.getFirstRenderedRow()},getLastRenderedRow:function(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow:function(){return this.getLastRenderedRow()},getRenderedRowsCount:function(){var t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),t)},getVisibleRowsCount:function(){return this.getRenderedRowsCount()}};Bc(Hae,"MIXIN_NAME",MUe,{writable:!1,enumerable:!1});const Vae=Hae;var DUe="stickyColumnsStart",Uae={getFirstRenderedColumn:function(){var t=this.wtSettings.getSetting("totalColumns");return t===0?-1:0},getFirstVisibleColumn:function(){return this.getFirstRenderedColumn()},getLastRenderedColumn:function(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn:function(){return this.getLastRenderedColumn()},getRenderedColumnsCount:function(){var t=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),t)},getVisibleColumnsCount:function(){return this.getRenderedColumnsCount()}};Bc(Uae,"MIXIN_NAME",DUe,{writable:!1,enumerable:!1});const S3=Uae;function uv(e){"@babel/helpers - typeof";return uv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},uv(e)}function uq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,LUe(n.key),n)}}function $Ue(e,t,r){return t&&uq(e.prototype,t),r&&uq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function LUe(e){var t=NUe(e,"string");return uv(t)==="symbol"?t:String(t)}function NUe(e,t){if(uv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(uv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function BUe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jUe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&uB(e,t)}function uB(e,t){return uB=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},uB(e,t)}function zUe(e){var t=VUe();return function(){var n=jk(e),i;if(t){var o=jk(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return FUe(this,i)}}function FUe(e,t){if(t&&(uv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return HUe(e)}function HUe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function VUe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function jk(e){return jk=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},jk(e)}var x3=function(e){jUe(r,e);var t=zUe(r);function r(n,i,o,s){return BUe(this,r),t.call(this,n,i,o,s,rh)}return $Ue(r)}(sb);li(x3,Vae);li(x3,S3);const UUe=x3;var $p="top",ru="bottom",Lp="inline_start",Np="top_inline_start_corner",rh="bottom_inline_start_corner",WUe=[$p,ru,Lp,Np,rh],GUe=new Map([[$p,"ht_clone_".concat($p)],[ru,"ht_clone_".concat(ru)],[Lp,"ht_clone_".concat(Lp," ht_clone_left")],[Np,"ht_clone_".concat(Np," ht_clone_top_left_corner")],[rh,"ht_clone_".concat(rh," ht_clone_bottom_left_corner")]]),YUe=Zi,KUe=Math.floor,qUe=Number.isInteger||function(t){return!YUe(t)&&isFinite(t)&&KUe(t)===t},XUe=Br,ZUe=qUe;XUe({target:"Number",stat:!0},{isInteger:ZUe});function e1(e){"@babel/helpers - typeof";return e1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},e1(e)}function JUe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function cq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Wae(n.key),n)}}function QUe(e,t,r){return t&&cq(e.prototype,t),r&&cq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function x$(e,t,r){return t=Wae(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Wae(e){var t=e4e(e,"string");return e1(t)==="symbol"?t:String(t)}function e4e(e,t){if(e1(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(e1(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var t4e=function(){function e(t){JUe(this,e),x$(this,"dataAccessObject",void 0),x$(this,"lastScrolledColumnPos",-1),x$(this,"lastScrolledRowPos",-1),this.dataAccessObject=t}return QUe(e,[{key:"scrollViewport",value:function(r,n,i,o,s){var a=this.scrollViewportHorizontally(r.col,i,s),h=this.scrollViewportVertically(r.row,n,o);return a||h}},{key:"scrollViewportHorizontally",value:function(r,n,i){var o=this.dataAccessObject,s=o.drawn,a=o.totalColumns;if(!s||!Number.isInteger(r)||r<0||r>a)return!1;var h=this.getFirstVisibleColumn(),p=this.getLastVisibleColumn(),g=n===void 0&&i===void 0,S=this.dataAccessObject,T=S.fixedColumnsStart,R=S.inlineStartOverlay;if(g&&r<T)return!1;var A=!1;return h===-1?A=R.scrollTo(r,g?r>this.lastScrolledColumnPos:n):(g&&(r<h||r>p)||!g)&&(A=R.scrollTo(r,g?r>p:n)),A&&(this.lastScrolledColumnPos=r),A}},{key:"scrollViewportVertically",value:function(r,n,i){var o=this.dataAccessObject,s=o.drawn,a=o.totalRows;if(!s||!Number.isInteger(r)||r<0||r>a)return!1;var h=this.getFirstVisibleRow(),p=this.getLastVisibleRow(),g=n===void 0&&i===void 0,S=this.dataAccessObject,T=S.fixedRowsBottom,R=S.fixedRowsTop,A=S.topOverlay;if(g&&(r<R||r>a-T-1))return!1;var $=!1;return h===-1?$=A.scrollTo(r,g?r>this.lastScrolledRowPos:i):(g&&(r<h||r>p)||!g)&&($=A.scrollTo(r,g?r>p:i)),$&&(this.lastScrolledRowPos=r),$}},{key:"getFirstVisibleRow",value:function(){var r=this.dataAccessObject,n=r.topOverlay,i=r.wtTable,o=r.wtViewport,s=r.totalRows,a=r.fixedRowsTop,h=r.rootWindow,p=i.getFirstVisibleRow();if(n.mainTableScrollableElement===h){var g=io(i.wtRootElement),S=Vf(i.hider),T=Vf(h),R=Ck(h,h);if(g.top+S-T<=R){var A=o.getColumnHeaderHeight();A+=n.sumCellSizes(0,a);for(var $=s;$>0;$--)if(A+=n.sumCellSizes($-1,$),g.top+S-A<=R){p=$;break}}}return p}},{key:"getLastVisibleRow",value:function(){var r=this.dataAccessObject,n=r.topOverlay,i=r.wtTable,o=r.wtViewport,s=r.totalRows,a=r.rootWindow,h=i.getLastVisibleRow();if(n.mainTableScrollableElement===a){var p=io(i.wtRootElement),g=Ck(a,a);if(p.top>g){for(var S=Vf(a),T=o.getColumnHeaderHeight(),R=1;R<=s;R++)if(T+=n.sumCellSizes(R-1,R),p.top+T-g>=S){h=R-2;break}}}return h}},{key:"getFirstVisibleColumn",value:function(){var r=this.dataAccessObject,n=r.inlineStartOverlay,i=r.wtTable,o=r.wtViewport,s=r.totalColumns,a=r.rootWindow,h=i.getFirstVisibleColumn();if(n.mainTableScrollableElement===a){var p=io(i.wtRootElement),g=sR(i.hider),S=sR(a),T=Math.abs(kN(a,a));if(p.left+g-S<=T){for(var R=o.getRowHeaderWidth(),A=s;A>0;A--)if(R+=n.sumCellSizes(A-1,A),p.left+g-R<=T){h=A;break}}}return h}},{key:"getLastVisibleColumn",value:function(){var r=this.dataAccessObject,n=r.wtSettings,i=r.inlineStartOverlay,o=r.wtTable,s=r.wtViewport,a=r.totalColumns,h=r.rootWindow,p=o.getLastVisibleColumn();if(i.mainTableScrollableElement===h){var g=n.getSetting("rtlMode"),S=null;if(g){var T=o.TABLE.getBoundingClientRect(),R=this.dataAccessObject.rootWindow.document,A=R.documentElement.offsetWidth;S=Math.abs(T.right-A)}else{var $=io(o.wtRootElement);S=$.left}var j=Math.abs(kN(h,h));if(S>j){for(var z=sR(h),V=s.getRowHeaderWidth(),G=1;G<=a;G++)if(V+=i.sumCellSizes(G-1,G),S+V-j>=z){p=G-2;break}}}return p}}]),e}();const r4e=t4e;function t1(e){"@babel/helpers - typeof";return t1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t1(e)}function n4e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Gae(n.key),n)}}function i4e(e,t,r){return t&&fq(e.prototype,t),r&&fq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function tl(e,t,r){return t=Gae(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Gae(e){var t=o4e(e,"string");return t1(t)==="symbol"?t:String(t)}function o4e(e,t){if(t1(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(t1(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var C3=function(){function e(t,r){n4e(this,e),tl(this,"wtTable",void 0),tl(this,"wtScroll",void 0),tl(this,"wtViewport",void 0),tl(this,"wtOverlays",void 0),tl(this,"selections",void 0),tl(this,"wtEvent",void 0),tl(this,"guid","wt_".concat(Voe())),tl(this,"drawInterrupted",!1),tl(this,"drawn",!1),tl(this,"domBindings",void 0),tl(this,"wtSettings",void 0),this.domBindings={rootTable:t,rootDocument:t.ownerDocument,rootWindow:t.ownerDocument.defaultView},this.wtSettings=r,this.wtScroll=new r4e(this.createScrollDao())}return i4e(e,[{key:"eventManager",get:function(){return new Bi(this)}},{key:"findOriginalHeaders",value:function(){var r=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(var n=0,i=this.wtTable.THEAD.childNodes[0].childNodes.length;n<i;n++)r.push(this.wtTable.THEAD.childNodes[0].childNodes[n].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(o,s){Ap(s,r[o])}])}}},{key:"createCellCoords",value:function(r,n){return new Pk(r,n,this.wtSettings.getSetting("rtlMode"))}},{key:"createCellRange",value:function(r,n,i){return new w3(r,n,i,this.wtSettings.getSetting("rtlMode"))}},{key:"draw",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,!r&&!this.wtTable.isVisible()?this.drawInterrupted=!0:this.wtTable.draw(r),this}},{key:"getCell",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(!n)return this.wtTable.getCell(r);var i=this.wtSettings.getSetting("totalRows"),o=this.wtSettings.getSetting("fixedRowsTop"),s=this.wtSettings.getSetting("fixedRowsBottom"),a=this.wtSettings.getSetting("fixedColumnsStart");if(r.row<o&&r.col<a)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(r);if(r.row<o)return this.wtOverlays.topOverlay.clone.wtTable.getCell(r);if(r.col<a&&r.row>=i-s){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(r)}else{if(r.col<a)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(r);if(r.row<i&&r.row>=i-s&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(r)}return this.wtTable.getCell(r)}},{key:"scrollViewport",value:function(r,n,i,o,s){return r.col<0||r.row<0?!1:this.wtScroll.scrollViewport(r,n,i,o,s)}},{key:"scrollViewportHorizontally",value:function(r,n,i){return r<0?!1:this.wtScroll.scrollViewportHorizontally(r,n,i)}},{key:"scrollViewportVertically",value:function(r,n,i){return r<0?!1:this.wtScroll.scrollViewportVertically(r,n,i)}},{key:"getViewport",value:function(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}},{key:"destroy",value:function(){this.wtOverlays.destroy(),this.wtEvent.destroy()}},{key:"createScrollDao",value:function(){var r=this;return{get drawn(){return r.drawn},get topOverlay(){return r.wtOverlays.topOverlay},get inlineStartOverlay(){return r.wtOverlays.inlineStartOverlay},get wtTable(){return r.wtTable},get wtViewport(){return r.wtViewport},get wtSettings(){return r.wtSettings},get rootWindow(){return r.domBindings.rootWindow},get totalRows(){return r.wtSettings.getSetting("totalRows")},get totalColumns(){return r.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return r.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return r.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return r.wtSettings.getSetting("fixedColumnsStart")}}}},{key:"getTableDao",value:function(){var r=this;return{get wot(){return r},get parentTableOffset(){return r.cloneSource.wtTable.tableOffset},get cloneSource(){return r.cloneSource},get workspaceWidth(){return r.wtViewport.getWorkspaceWidth()},get wtViewport(){return r.wtViewport},get wtOverlays(){return r.wtOverlays},get selections(){return r.selections},get drawn(){return r.drawn},set drawn(n){r.drawn=n},get wtTable(){return r.wtTable},get startColumnRendered(){return r.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return r.wtViewport.columnsVisibleCalculator.startColumn},get endColumnRendered(){return r.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return r.wtViewport.columnsVisibleCalculator.endColumn},get countColumnsRendered(){return r.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return r.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return r.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return r.wtViewport.rowsVisibleCalculator.startRow},get endRowRendered(){return r.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return r.wtViewport.rowsVisibleCalculator.endRow},get countRowsRendered(){return r.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return r.wtViewport.rowsVisibleCalculator.count}}}}]),e}();function cv(e){"@babel/helpers - typeof";return cv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cv(e)}function hq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Yae(n.key),n)}}function a4e(e,t,r){return t&&hq(e.prototype,t),r&&hq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function s4e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l4e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&cB(e,t)}function cB(e,t){return cB=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},cB(e,t)}function u4e(e){var t=f4e();return function(){var n=zk(e),i;if(t){var o=zk(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return c4e(this,i)}}function c4e(e,t){if(t&&(cv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return hR(e)}function hR(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function f4e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function zk(e){return zk=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},zk(e)}function dq(e,t,r){return t=Yae(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Yae(e){var t=h4e(e,"string");return cv(t)==="symbol"?t:String(t)}function h4e(e,t){if(cv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(cv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var d4e=function(e){l4e(r,e);var t=u4e(r);function r(n,i,o){var s;s4e(this,r),s=t.call(this,n,i),dq(hR(s),"cloneSource",void 0),dq(hR(s),"cloneOverlay",void 0);var a=s.wtSettings.getSetting("facade",hR(s));return s.cloneSource=o.source,s.cloneOverlay=o.overlay,s.wtTable=s.cloneOverlay.createTable(s.getTableDao(),a,s.domBindings,s.wtSettings),s.wtViewport=o.viewport,s.selections=o.selections,s.wtEvent=new Nae(a,s.domBindings,s.wtSettings,s.eventManager,s.wtTable,s.selections,o.event),s.findOriginalHeaders(),s}return a4e(r)}(C3);function r1(e){"@babel/helpers - typeof";return r1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r1(e)}function p4e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Kae(n.key),n)}}function m4e(e,t,r){return t&&pq(e.prototype,t),r&&pq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function y4e(e,t,r){return t=Kae(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Kae(e){var t=g4e(e,"string");return r1(t)==="symbol"?t:String(t)}function g4e(e,t){if(r1(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(r1(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var gC=function(){function e(t,r,n,i,o){p4e(this,e),y4e(this,"wtSettings",null),Bc(this,"wot",t,{writable:!1}),this.domBindings=o,this.facadeGetter=r,this.wtSettings=i;var s=this.wot.wtTable,a=s.TABLE,h=s.hider,p=s.spreader,g=s.holder,S=s.wtRootElement;this.instance=this.wot,this.type=n,this.mainTableScrollableElement=null,this.TABLE=a,this.hider=h,this.spreader=p,this.holder=g,this.wtRootElement=S,this.trimmingContainer=kS(this.hider.parentNode.parentNode),this.updateStateOfRendering(),this.clone=this.makeClone()}return m4e(e,[{key:"updateStateOfRendering",value:function(){var r=this.needFullRender;this.needFullRender=this.shouldBeRendered();var n=r!==this.needFullRender;return n&&!this.needFullRender&&this.reset(),n}},{key:"shouldBeRendered",value:function(){return!0}},{key:"updateTrimmingContainer",value:function(){this.trimmingContainer=kS(this.hider.parentNode.parentNode)}},{key:"updateMainScrollableElement",value:function(){var r=this.wot.wtTable,n=this.domBindings.rootWindow;n.getComputedStyle(r.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=Ek(r.TABLE)}},{key:"getRelativeCellPosition",value:function(r,n,i){if(this.clone.wtTable.holder.contains(r)===!1){ti("The provided element is not a child of the ".concat(this.type," overlay"));return}var o=this.mainTableScrollableElement===this.domBindings.rootWindow,s=i<this.wtSettings.getSetting("fixedColumnsStart"),a=n<this.wtSettings.getSetting("fixedRowsTop"),h=n>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),p=this.clone.wtTable.spreader,g={start:this.getRelativeStartPosition(p),top:p.offsetTop},S={start:this.getRelativeStartPosition(r),top:r.offsetTop},T=null;return o?T=this.getRelativeCellPositionWithinWindow(a,s,S,g):T=this.getRelativeCellPositionWithinHolder(a,h,s,S,g),T}},{key:"getRelativeStartPosition",value:function(r){return this.isRtl()?r.offsetParent.offsetWidth-r.offsetLeft-r.offsetWidth:r.offsetLeft}},{key:"getRelativeCellPositionWithinWindow",value:function(r,n,i,o){var s=this.wot.wtTable.wtRootElement.getBoundingClientRect(),a=0,h=0;if(!n)a=o.start;else{var p=s.left;this.isRtl()&&(p=this.domBindings.rootWindow.innerWidth-(s.left+s.width+Ao())),a=p<=0?-1*p:0}if(r){var g=this.clone.wtTable.TABLE.getBoundingClientRect();h=g.top-s.top}else h=o.top;return{start:i.start+a,top:i.top+h}}},{key:"getRelativeCellPositionWithinHolder",value:function(r,n,i,o,s){var a={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()},h=0,p=0;if(i||(h=a.horizontal-s.start),n){var g=this.wot.wtTable.wtRootElement.getBoundingClientRect(),S=this.clone.wtTable.TABLE.getBoundingClientRect();p=S.top*-1+g.top}else r||(p=a.vertical-s.top);return{start:o.start-h,top:o.top-p}}},{key:"makeClone",value:function(){if(WUe.indexOf(this.type)===-1)throw new Error('Clone type "'.concat(this.type,'" is not supported.'));var r=this.wot.wtTable,n=this.domBindings,i=n.rootDocument,o=n.rootWindow,s=i.createElement("DIV"),a=i.createElement("TABLE"),h=r.wtRootElement.parentNode;s.className="".concat(GUe.get(this.type)," handsontable"),s.setAttribute("dir",this.isRtl()?"rtl":"ltr"),s.style.position="absolute",s.style.top=0,s.style.overflow="visible",this.isRtl()?s.style.right=0:s.style.left=0,a.className=r.TABLE.className,s.appendChild(a),h.appendChild(s);var p=this.wtSettings.getSetting("preventOverflow");return p===!0||p==="horizontal"&&this.type===$p||p==="vertical"&&this.type===Lp?this.mainTableScrollableElement=o:o.getComputedStyle(h).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=r.holder:this.mainTableScrollableElement=Ek(r.TABLE),new d4e(a,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selections:this.wot.selections})}},{key:"refresh",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.shouldBeRendered();this.clone&&(this.needFullRender||n)&&this.clone.draw(r),this.needFullRender=n}},{key:"reset",value:function(){if(this.clone){var r=this.clone.wtTable.holder,n=this.clone.wtTable.hider,i=r.style,o=n.style,s=r.parentNode.style;Le([i,o,s],function(a){a.width="",a.height=""})}}},{key:"isRtl",value:function(){return this.wtSettings.getSetting("rtlMode")}},{key:"destroy",value:function(){this.clone.eventManager.destroy()}}]),e}();function fv(e){"@babel/helpers - typeof";return fv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fv(e)}function dR(e,t,r){return qae()?dR=Reflect.construct.bind():dR=function(i,o,s){var a=[null];a.push.apply(a,o);var h=Function.bind.apply(i,a),p=new h;return s&&Fk(p,s.prototype),p},dR.apply(null,arguments)}function v4e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,b4e(n.key),n)}}function _4e(e,t,r){return t&&mq(e.prototype,t),r&&mq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function b4e(e){var t=w4e(e,"string");return fv(t)==="symbol"?t:String(t)}function w4e(e,t){if(fv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(fv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function S4e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Fk(e,t)}function Fk(e,t){return Fk=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Fk(e,t)}function x4e(e){var t=qae();return function(){var n=Hk(e),i;if(t){var o=Hk(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return C4e(this,i)}}function C4e(e,t){if(t&&(fv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return E4e(e)}function E4e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function qae(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Hk(e){return Hk=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Hk(e)}var T4e=function(e){S4e(r,e);var t=x4e(r);function r(n,i,o,s,a,h){var p;return v4e(this,r),p=t.call(this,n,i,rh,o,s),p.bottomOverlay=a,p.inlineStartOverlay=h,p}return _4e(r,[{key:"createTable",value:function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return dR(UUe,o)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){var i=this.wot;if(this.updateTrimmingContainer(),!i.wtTable.holder.parentNode)return!1;var o=this.clone.wtTable.holder.parentNode;if(o.style.top="",this.trimmingContainer===this.domBindings.rootWindow){var s=this.inlineStartOverlay.getOverlayOffset(),a=this.bottomOverlay.getOverlayOffset();o.style[this.isRtl()?"right":"left"]="".concat(s,"px"),o.style.bottom="".concat(a,"px")}else AA(o),this.repositionOverlay();var h=$i(this.clone.wtTable.TABLE),p=ri(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(h=0),o.style.height="".concat(h,"px"),o.style.width="".concat(p,"px"),!1}},{key:"repositionOverlay",value:function(){var i=this.wot,o=i.wtTable,s=i.wtViewport,a=this.domBindings.rootDocument,h=this.clone.wtTable.holder.parentNode,p=0;s.hasVerticalScroll()||(p+=s.getWorkspaceHeight()-o.getTotalHeight()),s.hasVerticalScroll()&&s.hasHorizontalScroll()&&(p+=Ao(a)),h.style.bottom="".concat(p,"px")}}]),r}(gC),O4e="calculatedColumns",Xae={getFirstRenderedColumn:function(){var t=this.dataAccessObject.startColumnRendered;return t===null?-1:t},getFirstVisibleColumn:function(){var t=this.dataAccessObject.startColumnVisible;return t===null?-1:t},getLastRenderedColumn:function(){var t=this.dataAccessObject.endColumnRendered;return t===null?-1:t},getLastVisibleColumn:function(){var t=this.dataAccessObject.endColumnVisible;return t===null?-1:t},getRenderedColumnsCount:function(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount:function(){return this.dataAccessObject.countColumnsVisible}};Bc(Xae,"MIXIN_NAME",O4e,{writable:!1,enumerable:!1});const E3=Xae;function hv(e){"@babel/helpers - typeof";return hv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hv(e)}function yq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,k4e(n.key),n)}}function R4e(e,t,r){return t&&yq(e.prototype,t),r&&yq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function k4e(e){var t=P4e(e,"string");return hv(t)==="symbol"?t:String(t)}function P4e(e,t){if(hv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(hv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function A4e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function I4e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&fB(e,t)}function fB(e,t){return fB=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},fB(e,t)}function M4e(e){var t=L4e();return function(){var n=Vk(e),i;if(t){var o=Vk(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return D4e(this,i)}}function D4e(e,t){if(t&&(hv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return $4e(e)}function $4e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function L4e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Vk(e){return Vk=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Vk(e)}var T3=function(e){I4e(r,e);var t=M4e(r);function r(n,i,o,s){return A4e(this,r),t.call(this,n,i,o,s,ru)}return R4e(r)}(sb);li(T3,Vae);li(T3,E3);const N4e=T3;function dv(e){"@babel/helpers - typeof";return dv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},dv(e)}function pR(e,t,r){return Jae()?pR=Reflect.construct.bind():pR=function(i,o,s){var a=[null];a.push.apply(a,o);var h=Function.bind.apply(i,a),p=new h;return s&&Uk(p,s.prototype),p},pR.apply(null,arguments)}function B4e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Qae(n.key),n)}}function j4e(e,t,r){return t&&gq(e.prototype,t),r&&gq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function z4e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Uk(e,t)}function Uk(e,t){return Uk=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Uk(e,t)}function F4e(e){var t=Jae();return function(){var n=Wk(e),i;if(t){var o=Wk(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return H4e(this,i)}}function H4e(e,t){if(t&&(dv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Zae(e)}function Zae(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Jae(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Wk(e){return Wk=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Wk(e)}function V4e(e,t,r){return t=Qae(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Qae(e){var t=U4e(e,"string");return dv(t)==="symbol"?t:String(t)}function U4e(e,t){if(dv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(dv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var W4e=function(e){z4e(r,e);var t=F4e(r);function r(n,i,o,s){var a;return B4e(this,r),a=t.call(this,n,i,ru,o,s),V4e(Zae(a),"cachedFixedRowsBottom",-1),a.cachedFixedRowsBottom=a.wtSettings.getSetting("fixedRowsBottom"),a}return j4e(r,[{key:"createTable",value:function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return pR(N4e,o)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}},{key:"resetFixedPosition",value:function(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;var i=this.domBindings.rootWindow,o=this.clone.wtTable.holder.parentNode;o.style.top="";var s=0,a=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===i&&(!a||a!=="vertical")?(s=this.getOverlayOffset(),o.style.bottom="".concat(s,"px")):(s=this.getScrollPosition(),this.repositionOverlay());var h=this.adjustHeaderBordersPosition(s);return this.adjustElementsSize(),h}},{key:"repositionOverlay",value:function(){var i=this.wot,o=i.wtTable,s=i.wtViewport,a=this.domBindings.rootDocument,h=this.clone.wtTable.holder.parentNode,p=0;s.hasVerticalScroll()||(p+=s.getWorkspaceHeight()-o.getTotalHeight()),s.hasVerticalScroll()&&s.hasHorizontalScroll()&&(p+=Ao(a)),h.style.bottom="".concat(p,"px")}},{key:"setScrollPosition",value:function(i){var o=this.domBindings.rootWindow,s=!1;return this.mainTableScrollableElement===o?(o.scrollTo(zg(o),i),s=!0):this.mainTableScrollableElement.scrollTop!==i&&(this.mainTableScrollableElement.scrollTop=i,s=!0),s}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollHorizontally")}},{key:"sumCellSizes",value:function(i,o){for(var s=this.wot,a=s.wtTable,h=s.wtSettings,p=h.getSetting("defaultRowHeight"),g=i,S=0;g<o;){var T=a.getRowHeight(g);S+=T===void 0?p:T,g+=1}return S}},{key:"adjustElementsSize",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||i)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var i=this.wot,o=i.wtTable,s=i.wtViewport,a=this.domBindings,h=a.rootDocument,p=a.rootWindow,g=Ao(h),S=this.clone.wtTable.holder.parentNode,T=S.style,R=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==p||R==="horizontal"){var A=s.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(A-=g),A=Math.min(A,o.wtRootElement.scrollWidth),T.width="".concat(A,"px")}else T.width="";this.clone.wtTable.holder.style.width=T.width;var $=$i(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||($=0),T.height="".concat($,"px")}},{key:"adjustRootChildrenSize",value:function(){var i=this.clone.wtTable.holder;this.clone.wtTable.hider.style.width=this.hider.style.width,i.style.width=i.parentNode.style.width,i.style.height=i.parentNode.style.height}},{key:"applyToDOM",value:function(){var i=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px");else if(i===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){var i=this.isRtl()?"right":"left",o=this.clone.wtTable.spreader;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?o.style[i]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px"):o.style[i]=""}},{key:"scrollTo",value:function(i,o){var s=this.getTableParentOffset(),a=this.wot.cloneSource?this.wot.cloneSource:this.wot,h=a.wtTable.holder,p=0;o&&h.offsetHeight!==h.clientHeight&&(p=Ao(this.domBindings.rootDocument)),o?(s+=this.sumCellSizes(0,i+1),s-=this.wot.wtViewport.getViewportHeight(),s+=1):s+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),i),s+=p,this.setScrollPosition(s)}},{key:"getTableParentOffset",value:function(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}},{key:"getScrollPosition",value:function(){return Ck(this.mainTableScrollableElement,this.domBindings.rootWindow)}},{key:"getOverlayOffset",value:function(){var i=this.domBindings.rootWindow,o=this.wtSettings.getSetting("preventOverflow"),s=0;if(this.trimmingContainer===i&&(!o||o!=="vertical")){var a=this.wot.wtTable.getTotalHeight(),h=this.clone.wtTable.getTotalHeight(),p=a-h,g=this.domBindings.rootDocument.documentElement.clientHeight;s=Math.max(this.getTableParentOffset()-this.getScrollPosition()-g+a,0),s>p&&(s=0)}return s}},{key:"adjustHeaderBordersPosition",value:function(i){var o=this.wtSettings.getSetting("fixedRowsBottom"),s=this.cachedFixedRowsBottom!==o,a=this.wtSettings.getSetting("columnHeaders"),h=!1;if((s||o===0)&&a.length>0){var p=this.wot.wtTable.holder.parentNode,g=Ur(p,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),i||this.wtSettings.getSetting("totalRows")===0?(Ht(p,"innerBorderBottom"),h=!g):(Kr(p,"innerBorderBottom"),h=g)}return h}}]),r}(gC),G4e="calculatedRows",ese={getFirstRenderedRow:function(){var t=this.dataAccessObject.startRowRendered;return t===null?-1:t},getFirstVisibleRow:function(){var t=this.dataAccessObject.startRowVisible;return t===null?-1:t},getLastRenderedRow:function(){var t=this.dataAccessObject.endRowRendered;return t===null?-1:t},getLastVisibleRow:function(){var t=this.dataAccessObject.endRowVisible;return t===null?-1:t},getRenderedRowsCount:function(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount:function(){return this.dataAccessObject.countRowsVisible}};Bc(ese,"MIXIN_NAME",G4e,{writable:!1,enumerable:!1});const tse=ese;function pv(e){"@babel/helpers - typeof";return pv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pv(e)}function vq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,K4e(n.key),n)}}function Y4e(e,t,r){return t&&vq(e.prototype,t),r&&vq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function K4e(e){var t=q4e(e,"string");return pv(t)==="symbol"?t:String(t)}function q4e(e,t){if(pv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(pv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function X4e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Z4e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&hB(e,t)}function hB(e,t){return hB=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},hB(e,t)}function J4e(e){var t=tWe();return function(){var n=Gk(e),i;if(t){var o=Gk(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Q4e(this,i)}}function Q4e(e,t){if(t&&(pv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return eWe(e)}function eWe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function tWe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Gk(e){return Gk=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Gk(e)}var O3=function(e){Z4e(r,e);var t=J4e(r);function r(n,i,o,s){return X4e(this,r),t.call(this,n,i,o,s,Lp)}return Y4e(r)}(sb);li(O3,tse);li(O3,S3);const rWe=O3;function mv(e){"@babel/helpers - typeof";return mv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mv(e)}function mR(e,t,r){return rse()?mR=Reflect.construct.bind():mR=function(i,o,s){var a=[null];a.push.apply(a,o);var h=Function.bind.apply(i,a),p=new h;return s&&Yk(p,s.prototype),p},mR.apply(null,arguments)}function nWe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _q(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,oWe(n.key),n)}}function iWe(e,t,r){return t&&_q(e.prototype,t),r&&_q(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function oWe(e){var t=aWe(e,"string");return mv(t)==="symbol"?t:String(t)}function aWe(e,t){if(mv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(mv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function sWe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Yk(e,t)}function Yk(e,t){return Yk=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Yk(e,t)}function lWe(e){var t=rse();return function(){var n=Kk(e),i;if(t){var o=Kk(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return uWe(this,i)}}function uWe(e,t){if(t&&(mv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return cWe(e)}function cWe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function rse(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Kk(e){return Kk=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Kk(e)}var fWe=function(e){sWe(r,e);var t=lWe(r);function r(n,i,o,s){return nWe(this,r),t.call(this,n,i,Lp,o,s)}return iWe(r,[{key:"createTable",value:function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return mR(rWe,o)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){var i=this.wot.wtTable;if(!this.needFullRender||!i.holder.parentNode)return!1;var o=this.domBindings.rootWindow,s=this.clone.wtTable.holder.parentNode,a=this.wtSettings.getSetting("preventOverflow"),h=0;this.trimmingContainer===o&&(!a||a!=="horizontal")?(h=this.getOverlayOffset()*(this.isRtl()?-1:1),r3(s,"".concat(h,"px"),"0px")):(h=this.getScrollPosition(),AA(s));var p=this.adjustHeaderBordersPosition(h);return this.adjustElementsSize(),p}},{key:"setScrollPosition",value:function(i){var o=this.domBindings.rootWindow,s=!1;return this.isRtl()&&(i=-i),this.mainTableScrollableElement===o&&o.scrollX!==i?(o.scrollTo(i,RS(o)),s=!0):this.mainTableScrollableElement.scrollLeft!==i&&(this.mainTableScrollableElement.scrollLeft=i,s=!0),s}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollVertically")}},{key:"sumCellSizes",value:function(i,o){for(var s=this.wtSettings.getSetting("defaultColumnWidth"),a=i,h=0;a<o;)h+=this.wot.wtTable.getStretchedColumnWidth(a)||s,a+=1;return h}},{key:"adjustElementsSize",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||i)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var i=this.wot.wtTable,o=this.domBindings,s=o.rootDocument,a=o.rootWindow,h=Ao(s),p=this.clone.wtTable.holder.parentNode,g=p.style,S=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==a||S==="vertical"){var T=this.wot.wtViewport.getWorkspaceHeight();this.wot.wtOverlays.hasScrollbarBottom&&(T-=h),T=Math.min(T,i.wtRootElement.scrollHeight),g.height="".concat(T,"px")}else g.height="";this.clone.wtTable.holder.style.height=g.height;var R=ri(this.clone.wtTable.TABLE);g.width="".concat(R,"px")}},{key:"adjustRootChildrenSize",value:function(){var i,o=this.clone.wtTable.holder,s=this.wot.selections,a=this.facadeGetter(),h=Math.abs((i=s==null?void 0:s.getCell().getBorder(a).cornerCenterPointOffset)!==null&&i!==void 0?i:0);this.clone.wtTable.hider.style.height=this.hider.style.height,o.style.height=o.parentNode.style.height,o.style.width="".concat(parseInt(o.parentNode.style.width,10)+h,"px")}},{key:"applyToDOM",value:function(){var i=this.wtSettings.getSetting("totalColumns"),o=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[o]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px");else if(i===0)this.spreader.style[o]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px"):this.clone.wtTable.spreader.style.top=""}},{key:"scrollTo",value:function(i,o){var s=this.getTableParentOffset(),a=this.wot.cloneSource?this.wot.cloneSource:this.wot,h=a.wtTable.holder,p=0;if(o){var g=this.wot.wtTable.getColumnWidth(i),S=this.wot.wtViewport.getViewportWidth();g>S&&(o=!1)}return o&&h.offsetWidth!==h.clientWidth&&(p=Ao(this.domBindings.rootDocument)),o?(s+=this.sumCellSizes(0,i+1),s-=this.wot.wtViewport.getViewportWidth()):s+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),i),s+=p,this.setScrollPosition(s)}},{key:"getTableParentOffset",value:function(){var i=this.wtSettings.getSetting("preventOverflow"),o=0;return!i&&this.trimmingContainer===this.domBindings.rootWindow&&(o=this.wot.wtTable.holderOffset.left),o}},{key:"getScrollPosition",value:function(){return Math.abs(kN(this.mainTableScrollableElement,this.domBindings.rootWindow))}},{key:"getOverlayOffset",value:function(){var i=this.domBindings.rootWindow,o=this.wtSettings.getSetting("preventOverflow"),s=0;if(this.trimmingContainer===i&&(!o||o!=="horizontal")){this.isRtl()?s=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):s=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);var a=this.wot.wtTable.getTotalWidth(),h=this.clone.wtTable.getTotalWidth(),p=a-h;s>p&&(s=0)}return s}},{key:"adjustHeaderBordersPosition",value:function(i){var o=this.wot.wtTable.holder.parentNode,s=this.wtSettings.getSetting("rowHeaders"),a=this.wtSettings.getSetting("fixedColumnsStart"),h=this.wtSettings.getSetting("totalRows");h?Kr(o,"emptyRows"):Ht(o,"emptyRows");var p=!1;if(a&&!s.length)Ht(o,"innerBorderLeft innerBorderInlineStart");else if(!a&&s.length){var g=Ur(o,"innerBorderInlineStart");i?(Ht(o,"innerBorderLeft innerBorderInlineStart"),p=!g):(Kr(o,"innerBorderLeft innerBorderInlineStart"),p=g)}return p}}]),r}(gC),hWe="stickyRowsTop",nse={getFirstRenderedRow:function(){var t=this.wtSettings.getSetting("totalRows");return t===0?-1:0},getFirstVisibleRow:function(){return this.getFirstRenderedRow()},getLastRenderedRow:function(){return this.getRenderedRowsCount()-1},getLastVisibleRow:function(){return this.getLastRenderedRow()},getRenderedRowsCount:function(){var t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),t)},getVisibleRowsCount:function(){return this.getRenderedRowsCount()}};Bc(nse,"MIXIN_NAME",hWe,{writable:!1,enumerable:!1});const ise=nse;function yv(e){"@babel/helpers - typeof";return yv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yv(e)}function bq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,pWe(n.key),n)}}function dWe(e,t,r){return t&&bq(e.prototype,t),r&&bq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function pWe(e){var t=mWe(e,"string");return yv(t)==="symbol"?t:String(t)}function mWe(e,t){if(yv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(yv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function yWe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gWe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&dB(e,t)}function dB(e,t){return dB=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},dB(e,t)}function vWe(e){var t=wWe();return function(){var n=qk(e),i;if(t){var o=qk(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return _We(this,i)}}function _We(e,t){if(t&&(yv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return bWe(e)}function bWe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function wWe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function qk(e){return qk=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},qk(e)}var R3=function(e){gWe(r,e);var t=vWe(r);function r(n,i,o,s){return yWe(this,r),t.call(this,n,i,o,s,Np)}return dWe(r)}(sb);li(R3,ise);li(R3,S3);const SWe=R3;function gv(e){"@babel/helpers - typeof";return gv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gv(e)}function yR(e,t,r){return ose()?yR=Reflect.construct.bind():yR=function(i,o,s){var a=[null];a.push.apply(a,o);var h=Function.bind.apply(i,a),p=new h;return s&&Xk(p,s.prototype),p},yR.apply(null,arguments)}function xWe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function wq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ase(n.key),n)}}function CWe(e,t,r){return t&&wq(e.prototype,t),r&&wq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function EWe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Xk(e,t)}function Xk(e,t){return Xk=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Xk(e,t)}function TWe(e){var t=ose();return function(){var n=Zk(e),i;if(t){var o=Zk(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return OWe(this,i)}}function OWe(e,t){if(t&&(gv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return pB(e)}function pB(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ose(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Zk(e){return Zk=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Zk(e)}function Sq(e,t,r){return t=ase(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ase(e){var t=RWe(e,"string");return gv(t)==="symbol"?t:String(t)}function RWe(e,t){if(gv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(gv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var kWe=function(e){EWe(r,e);var t=TWe(r);function r(n,i,o,s,a,h){var p;return xWe(this,r),p=t.call(this,n,i,Np,o,s),Sq(pB(p),"topOverlay",void 0),Sq(pB(p),"inlineStartOverlay",void 0),p.topOverlay=a,p.inlineStartOverlay=h,p}return CWe(r,[{key:"createTable",value:function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return yR(SWe,o)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;var i=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){var o=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),s=this.topOverlay.getOverlayOffset();r3(i,"".concat(o,"px"),"".concat(s,"px"))}else AA(i);var a=$i(this.clone.wtTable.TABLE),h=ri(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(a=0),i.style.height="".concat(a,"px"),i.style.width="".concat(h,"px"),!1}}]),r}(gC);function vv(e){"@babel/helpers - typeof";return vv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vv(e)}function xq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,AWe(n.key),n)}}function PWe(e,t,r){return t&&xq(e.prototype,t),r&&xq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function AWe(e){var t=IWe(e,"string");return vv(t)==="symbol"?t:String(t)}function IWe(e,t){if(vv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(vv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function MWe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function DWe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&mB(e,t)}function mB(e,t){return mB=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},mB(e,t)}function $We(e){var t=BWe();return function(){var n=Jk(e),i;if(t){var o=Jk(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return LWe(this,i)}}function LWe(e,t){if(t&&(vv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return NWe(e)}function NWe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function BWe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Jk(e){return Jk=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Jk(e)}var k3=function(e){DWe(r,e);var t=$We(r);function r(n,i,o,s){return MWe(this,r),t.call(this,n,i,o,s,$p)}return PWe(r)}(sb);li(k3,ise);li(k3,E3);const jWe=k3;function _v(e){"@babel/helpers - typeof";return _v=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_v(e)}function gR(e,t,r){return lse()?gR=Reflect.construct.bind():gR=function(i,o,s){var a=[null];a.push.apply(a,o);var h=Function.bind.apply(i,a),p=new h;return s&&Qk(p,s.prototype),p},gR.apply(null,arguments)}function zWe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Cq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,use(n.key),n)}}function FWe(e,t,r){return t&&Cq(e.prototype,t),r&&Cq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function HWe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Qk(e,t)}function Qk(e,t){return Qk=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Qk(e,t)}function VWe(e){var t=lse();return function(){var n=eP(e),i;if(t){var o=eP(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return UWe(this,i)}}function UWe(e,t){if(t&&(_v(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return sse(e)}function sse(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function lse(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function eP(e){return eP=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},eP(e)}function WWe(e,t,r){return t=use(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function use(e){var t=GWe(e,"string");return _v(t)==="symbol"?t:String(t)}function GWe(e,t){if(_v(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_v(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var YWe=function(e){HWe(r,e);var t=VWe(r);function r(n,i,o,s){var a;return zWe(this,r),a=t.call(this,n,i,$p,o,s),WWe(sse(a),"cachedFixedRowsTop",-1),a.cachedFixedRowsTop=a.wtSettings.getSetting("fixedRowsTop"),a}return FWe(r,[{key:"createTable",value:function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return gR(jWe,o)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}},{key:"resetFixedPosition",value:function(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;var i=this.clone.wtTable.holder.parentNode,o=this.domBindings.rootWindow,s=this.wtSettings.getSetting("preventOverflow"),a=0,h=!1;if(this.trimmingContainer===o&&(!s||s!=="vertical")){var p=this.wot.wtTable,g=p.hider.getBoundingClientRect(),S=Math.ceil(g.bottom),T=i.offsetHeight;h=S===T,a=this.getOverlayOffset(),r3(i,"0px","".concat(a,"px"))}else a=this.getScrollPosition(),AA(i);var R=this.adjustHeaderBordersPosition(a,h);return this.adjustElementsSize(),R}},{key:"setScrollPosition",value:function(i){var o=this.domBindings.rootWindow,s=!1;return this.mainTableScrollableElement===o&&o.scrollY!==i?(o.scrollTo(zg(o),i),s=!0):this.mainTableScrollableElement.scrollTop!==i&&(this.mainTableScrollableElement.scrollTop=i,s=!0),s}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollHorizontally")}},{key:"sumCellSizes",value:function(i,o){for(var s=this.wtSettings.getSetting("defaultRowHeight"),a=i,h=0;a<o;){var p=this.wot.wtTable.getRowHeight(a);h+=p===void 0?s:p,a+=1}return h}},{key:"adjustElementsSize",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||i)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var i=this.wot.wtTable,o=this.domBindings,s=o.rootDocument,a=o.rootWindow,h=Ao(s),p=this.clone.wtTable.holder.parentNode,g=p.style,S=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==a||S==="horizontal"){var T=this.wot.wtViewport.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(T-=h),T=Math.min(T,i.wtRootElement.scrollWidth),g.width="".concat(T,"px")}else g.width="";this.clone.wtTable.holder.style.width=g.width;var R=$i(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(R=0),g.height="".concat(R,"px")}},{key:"adjustRootChildrenSize",value:function(){var i,o=this.clone.wtTable.holder,s=this.wot.selections,a=this.facadeGetter(),h=Math.abs((i=s==null?void 0:s.getCell().getBorder(a).cornerCenterPointOffset)!==null&&i!==void 0?i:0);this.clone.wtTable.hider.style.width=this.hider.style.width,o.style.width=o.parentNode.style.width,o.style.height="".concat(parseInt(o.parentNode.style.height,10)+h,"px")}},{key:"applyToDOM",value:function(){var i=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px");else if(i===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){var i=this.isRtl()?"right":"left",o=this.clone.wtTable.spreader;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?o.style[i]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px"):o.style[i]=""}},{key:"scrollTo",value:function(i,o){var s=this.wot,a=this.wtSettings,h=s.cloneSource?s.cloneSource:s,p=h.wtTable.holder,g=this.getTableParentOffset(),S=0;if(o){var T=this.wot.wtTable.getRowHeight(i),R=this.wot.wtViewport.getViewportHeight();T>R&&(o=!1)}if(o&&p.offsetHeight!==p.clientHeight&&(S=Ao(this.domBindings.rootDocument)),o){var A=a.getSetting("fixedRowsBottom"),$=a.getSetting("totalRows");g+=this.sumCellSizes(0,i+1),g-=s.wtViewport.getViewportHeight()-this.sumCellSizes($-A,$),g+=1}else g+=this.sumCellSizes(a.getSetting("fixedRowsTop"),i);return g+=S,this.setScrollPosition(g)}},{key:"getTableParentOffset",value:function(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}},{key:"getScrollPosition",value:function(){return Ck(this.mainTableScrollableElement,this.domBindings.rootWindow)}},{key:"getOverlayOffset",value:function(){var i=this.domBindings.rootWindow,o=this.wtSettings.getSetting("preventOverflow"),s=0;if(this.trimmingContainer===i&&(!o||o!=="vertical")){var a=this.wot.wtTable.getTotalHeight(),h=this.clone.wtTable.getTotalHeight(),p=a-h;s=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),s>p&&(s=0)}return s}},{key:"adjustHeaderBordersPosition",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,s=this.wot.wtTable.holder.parentNode,a=this.wtSettings.getSetting("totalColumns");a?Kr(s,"emptyColumns"):Ht(s,"emptyColumns");var h=!1;if(!o){var p=this.wtSettings.getSetting("fixedRowsTop"),g=this.cachedFixedRowsTop!==p,S=this.wtSettings.getSetting("columnHeaders");if((g||p===0)&&S.length>0){var T=Ur(s,"innerBorderTop");this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop"),i||this.wtSettings.getSetting("totalRows")===0?(Ht(s,"innerBorderTop"),h=!T):(Kr(s,"innerBorderTop"),h=T)}}return h}}]),r}(gC);function n1(e){"@babel/helpers - typeof";return n1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n1(e)}function Lf(e,t,r){return KWe()?Lf=Reflect.construct.bind():Lf=function(i,o,s){var a=[null];a.push.apply(a,o);var h=Function.bind.apply(i,a),p=new h;return s&&yB(p,s.prototype),p},Lf.apply(null,arguments)}function KWe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function yB(e,t){return yB=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},yB(e,t)}function qWe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Eq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,cse(n.key),n)}}function XWe(e,t,r){return t&&Eq(e.prototype,t),r&&Eq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Du(e,t,r){return t=cse(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function cse(e){var t=ZWe(e,"string");return n1(t)==="symbol"?t:String(t)}function ZWe(e,t){if(n1(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(n1(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var JWe=function(){function e(t,r,n,i,o,s){var a=this;qWe(this,e),Du(this,"wot",null),Du(this,"topOverlay",null),Du(this,"bottomOverlay",null),Du(this,"inlineStartOverlay",null),Du(this,"topInlineStartCornerOverlay",null),Du(this,"bottomInlineStartCornerOverlay",null),Du(this,"browserLineHeight",void 0),Du(this,"wtSettings",null),Du(this,"resizeObserver",new ResizeObserver(function(T){e3(function(){!Array.isArray(T)||!T.length||a.wtSettings.getSetting("onContainerElementResize")})})),this.wot=t,this.wtSettings=i,this.domBindings=n,this.facadeGetter=r,this.wtTable=s;var h=this.domBindings,p=h.rootDocument,g=h.rootWindow;this.instance=this.wot,this.eventManager=o,this.scrollbarSize=Ao(p);var S=g.getComputedStyle(s.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=S?s.holder:Ek(s.TABLE),this.initOverlays(),this.hasScrollbarBottom=!1,this.hasScrollbarRight=!1,this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=g.scrollX,this.lastScrollY=g.scrollY}return XWe(e,[{key:"getOverlays",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=[this.topOverlay,this.topInlineStartCornerOverlay,this.inlineStartOverlay,this.bottomOverlay,this.bottomInlineStartCornerOverlay];return r&&n.push(this.wtTable),n}},{key:"initBrowserLineHeight",value:function(){var r=this.domBindings,n=r.rootWindow,i=r.rootDocument,o=n.getComputedStyle(i.body),s=parseInt(o.lineHeight,10),a=parseInt(o.fontSize,10)*1.2;this.browserLineHeight=s||a}},{key:"initOverlays",value:function(){var r=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=Lf(YWe,r),this.bottomOverlay=Lf(W4e,r),this.inlineStartOverlay=Lf(fWe,r),this.topInlineStartCornerOverlay=Lf(kWe,r.concat([this.topOverlay,this.inlineStartOverlay])),this.bottomInlineStartCornerOverlay=Lf(T4e,r.concat([this.bottomOverlay,this.inlineStartOverlay]))}},{key:"updateStateOfRendering",value:function(){var r=this.topOverlay.updateStateOfRendering();return r=this.bottomOverlay.updateStateOfRendering()||r,r=this.inlineStartOverlay.updateStateOfRendering()||r,this.inlineStartOverlay.needFullRender&&(this.topOverlay.needFullRender&&(r=this.topInlineStartCornerOverlay.updateStateOfRendering()||r),this.bottomOverlay.needFullRender&&(r=this.bottomInlineStartCornerOverlay.updateStateOfRendering()||r)),r}},{key:"refreshAll",value:function(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}},{key:"registerListeners",value:function(){var r=this,n=this.domBindings,i=n.rootDocument,o=n.rootWindow,s=this.topOverlay.mainTableScrollableElement,a=this.inlineStartOverlay.mainTableScrollableElement;this.eventManager.addEventListener(i.documentElement,"keydown",function(A){return r.onKeyDown(A)}),this.eventManager.addEventListener(i.documentElement,"keyup",function(){return r.onKeyUp()}),this.eventManager.addEventListener(i,"visibilitychange",function(){return r.onKeyUp()}),this.eventManager.addEventListener(s,"scroll",function(A){return r.onTableScroll(A)},{passive:!0}),s!==a&&this.eventManager.addEventListener(a,"scroll",function(A){return r.onTableScroll(A)},{passive:!0});var h=o.devicePixelRatio&&o.devicePixelRatio>1,p=this.scrollableElement===o,g=this.wtSettings.getSetting("preventWheel"),S={passive:p};(g||h||!Aoe())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",function(A){return r.onCloneWheel(A,g)},S);var T=[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];T.forEach(function(A){if(A&&A.needFullRender){var $=A.clone.wtTable.holder;r.eventManager.addEventListener($,"wheel",function(j){return r.onCloneWheel(j,g)},S)}});var R;this.eventManager.addEventListener(o,"resize",function(){clearTimeout(R),R=setTimeout(function(){r.wtSettings.getSetting("onWindowResize")},200)}),p||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}},{key:"deregisterListeners",value:function(){this.eventManager.clearEvents(!0)}},{key:"onTableScroll",value:function(r){var n=this.domBindings.rootWindow,i=this.inlineStartOverlay.mainTableScrollableElement,o=this.topOverlay.mainTableScrollableElement,s=r.target;this.keyPressed&&(o!==n&&s!==n&&!r.target.contains(o)||i!==n&&s!==n&&!r.target.contains(i))||this.syncScrollPositions(r)}},{key:"onCloneWheel",value:function(r,n){var i=this.domBindings.rootWindow,o=this.inlineStartOverlay.mainTableScrollableElement,s=this.topOverlay.mainTableScrollableElement,a=r.target,h=s!==i&&a!==i&&!a.contains(s),p=o!==i&&a!==i&&!a.contains(o);if(!(this.keyPressed&&(h||p))){var g=this.translateMouseWheelToScroll(r);(n||this.scrollableElement!==i&&g)&&r.preventDefault()}}},{key:"onKeyDown",value:function(r){this.keyPressed=TS(r.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}},{key:"onKeyUp",value:function(){this.keyPressed=!1}},{key:"translateMouseWheelToScroll",value:function(r){var n=isNaN(r.deltaY)?-1*r.wheelDeltaY:r.deltaY,i=isNaN(r.deltaX)?-1*r.wheelDeltaX:r.deltaX;r.deltaMode===1&&(i+=i*this.browserLineHeight,n+=n*this.browserLineHeight);var o=this.scrollVertically(n),s=this.scrollHorizontally(i);return o||s}},{key:"scrollVertically",value:function(r){var n=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=r,n!==this.scrollableElement.scrollTop}},{key:"scrollHorizontally",value:function(r){var n=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=r,n!==this.scrollableElement.scrollLeft}},{key:"syncScrollPositions",value:function(){if(!this.destroyed){var r=this.domBindings.rootWindow,n=this.topOverlay.clone.wtTable.holder,i=this.inlineStartOverlay.clone.wtTable.holder,o=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop],s=o[0],a=o[1];if(this.horizontalScrolling=n.scrollLeft!==s||this.lastScrollX!==r.scrollX,this.verticalScrolling=i.scrollTop!==a||this.lastScrollY!==r.scrollY,this.lastScrollX=r.scrollX,this.lastScrollY=r.scrollY,this.horizontalScrolling){n.scrollLeft=s;var h=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;h&&(h.scrollLeft=s)}this.verticalScrolling&&(i.scrollTop=a),this.refreshAll()}}},{key:"syncScrollWithMaster",value:function(){var r=this.topOverlay.mainTableScrollableElement,n=r.scrollLeft,i=r.scrollTop;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=n),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=n),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=i)}},{key:"updateMainScrollableElements",value:function(){this.deregisterListeners(),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();var r=this.wtTable,n=this.domBindings.rootWindow;n.getComputedStyle(r.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=r.holder:this.scrollableElement=Ek(r.TABLE),this.registerListeners()}},{key:"destroy",value:function(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}},{key:"refresh",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.updateLastSpreaderSize();n&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(r),this.inlineStartOverlay.refresh(r),this.topOverlay.refresh(r),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(r),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(r)}},{key:"updateLastSpreaderSize",value:function(){var r=this.wtTable.spreader,n=r.clientWidth,i=r.clientHeight,o=n!==this.spreaderLastSize.width||i!==this.spreaderLastSize.height;return o&&(this.spreaderLastSize.width=n,this.spreaderLastSize.height=i),o}},{key:"adjustElementsSize",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.wot.wtViewport,i=this.wtTable,o=this.wtSettings.getSetting("totalColumns"),s=this.wtSettings.getSetting("totalRows"),a=n.getRowHeaderWidth(),h=n.getColumnHeaderHeight(),p=i.hider.style;if(p.width="".concat(a+this.inlineStartOverlay.sumCellSizes(0,o),"px"),p.height="".concat(h+this.topOverlay.sumCellSizes(0,s)+1,"px"),this.scrollbarSize>0){var g=i.wtRootElement,S=g.scrollHeight,T=g.scrollWidth,R=i.holder,A=R.scrollHeight,$=R.scrollWidth;this.hasScrollbarRight=S<A,this.hasScrollbarBottom=T<$,this.hasScrollbarRight&&i.hider.scrollWidth+this.scrollbarSize>T?this.hasScrollbarBottom=!0:this.hasScrollbarBottom&&i.hider.scrollHeight+this.scrollbarSize>S&&(this.hasScrollbarRight=!0)}this.topOverlay.adjustElementsSize(r),this.inlineStartOverlay.adjustElementsSize(r),this.bottomOverlay.adjustElementsSize(r)}},{key:"applyToDOM",value:function(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}},{key:"getParentOverlay",value:function(r){if(!r)return null;var n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay],i=null;return Le(n,function(o){o&&o.clone&&o.clone.wtTable.TABLE.contains(r)&&(i=o.clone)}),i}},{key:"syncOverlayTableClassNames",value:function(){var r=this.wtTable.TABLE,n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];Le(n,function(i){i&&(i.clone.wtTable.TABLE.className=r.className)})}}]),e}();const QWe=JWe;function i1(e){"@babel/helpers - typeof";return i1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i1(e)}function e5e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Tq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,fse(n.key),n)}}function t5e(e,t,r){return t&&Tq(e.prototype,t),r&&Tq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Oq(e,t,r){return t=fse(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function fse(e){var t=r5e(e,"string");return i1(t)==="symbol"?t:String(t)}function r5e(e,t){if(i1(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(i1(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var n5e=function(){function e(t){var r=this;e5e(this,e),Oq(this,"settings",{}),Oq(this,"defaults",Object.freeze(this.getDefaults())),pn(this.defaults,function(n,i){if(t[i]!==void 0)r.settings[i]=t[i];else{if(n===void 0)throw new Error('A required setting "'.concat(i,'" was not provided'));r.settings[i]=n}})}return t5e(e,[{key:"getDefaults",value:function(){var r=this;return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow:function(){return!1},preventWheel:!1,data:void 0,freezeOverlays:!1,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:function(){return r.getSetting("fixedColumnsStart")>0||r.getSetting("rowHeaders").length>0},shouldRenderTopOverlay:function(){return r.getSetting("fixedRowsTop")>0||r.getSetting("columnHeaders").length>0},shouldRenderBottomOverlay:function(){return r.getSetting("fixedRowsBottom")>0},minSpareRows:0,rowHeaders:function(){return[]},columnHeaders:function(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:function(i,o,s){var a=r.getSetting("data",i,o);Ap(s,a??"")},columnWidth:function(){},rowHeight:function(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onScrollVertically:null,onScrollHorizontally:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:function(i){return i},onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onBeforeHighlightingRowHeader:function(i){return i},onBeforeHighlightingColumnHeader:function(i){return i},onWindowResize:null,onContainerElementResize:null,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1}}},{key:"update",value:function(r,n){var i=this;return n===void 0?pn(r,function(o,s){i.settings[s]=o}):this.settings[r]=n,this}},{key:"getSetting",value:function(r,n,i,o,s){return typeof this.settings[r]=="function"?this.settings[r](n,i,o,s):n!==void 0&&Array.isArray(this.settings[r])?this.settings[r][n]:this.settings[r]}},{key:"getSettingPure",value:function(r){return this.settings[r]}},{key:"has",value:function(r){return!!this.settings[r]}}]),e}();function bv(e){"@babel/helpers - typeof";return bv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bv(e)}function i5e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Rq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,a5e(n.key),n)}}function o5e(e,t,r){return t&&Rq(e.prototype,t),r&&Rq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function a5e(e){var t=s5e(e,"string");return bv(t)==="symbol"?t:String(t)}function s5e(e,t){if(bv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(bv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function l5e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&gB(e,t)}function gB(e,t){return gB=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},gB(e,t)}function u5e(e){var t=h5e();return function(){var n=tP(e),i;if(t){var o=tP(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return c5e(this,i)}}function c5e(e,t){if(t&&(bv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return f5e(e)}function f5e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function h5e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function tP(e){return tP=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},tP(e)}var P3=function(e){l5e(r,e);var t=u5e(r);function r(n,i,o,s){return i5e(this,r),t.call(this,n,i,o,s,"master")}return o5e(r,[{key:"alignOverlaysWithTrimmingContainer",value:function(){var i=kS(this.wtRootElement),o=this.domBindings.rootWindow;if(i===o){var s=this.wtSettings.getSetting("preventOverflow");s||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible")}else{var a=i.parentElement,h=PS(i,"height",o),p=PS(i,"overflow",o),g=this.holder.style,S=i.scrollWidth,T=i.scrollHeight,R=i.getBoundingClientRect(),A=R.width,$=R.height,j=["auto","hidden","scroll"];if(a&&j.includes(p)){var z=i.cloneNode(!1);z.style.overflow="auto",z.style.position="absolute",i.nextElementSibling?a.insertBefore(z,i.nextElementSibling):a.appendChild(z);var V=parseInt(Ip(z,o).height,10);a.removeChild(z),V===0&&($=0)}$=Math.min($,T),g.height=h==="auto"?"auto":"".concat($,"px"),A=Math.min(A,S),g.width="".concat(A,"px"),g.overflow="",this.hasTableHeight=g.height==="auto"?!0:$>0,this.hasTableWidth=A>0}this.isTableVisible=OS(this.TABLE)}},{key:"markOversizedColumnHeaders",value:function(){var i=this.wtSettings,o=this.dataAccessObject.wtViewport,s="master",a=i.getSetting("columnHeaders"),h=a.length;if(h&&!o.hasOversizedColumnHeadersMarked[s]){for(var p=i.getSetting("rowHeaders"),g=p.length,S=this.getRenderedColumnsCount(),T=0;T<h;T++)for(var R=-1*g;R<S;R++)this.markIfOversizedColumnHeader(R);o.hasOversizedColumnHeadersMarked[s]=!0}}}]),r}(sb);li(P3,tse);li(P3,E3);const d5e=P3;function o1(e){"@babel/helpers - typeof";return o1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o1(e)}function p5e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,y5e(n.key),n)}}function m5e(e,t,r){return t&&kq(e.prototype,t),r&&kq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function y5e(e){var t=g5e(e,"string");return o1(t)==="symbol"?t:String(t)}function g5e(e,t){if(o1(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(o1(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var v5e=function(){function e(t,r,n,i,o){var s=this;p5e(this,e),this.dataAccessObject=t,this.wot=t.wot,this.instance=this.wot,this.domBindings=r,this.wtSettings=n,this.wtTable=o,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.eventManager=i,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",function(){s.clientHeight=s.getWorkspaceHeight()})}return m5e(e,[{key:"getWorkspaceHeight",value:function(){var r=this.domBindings.rootDocument,n=this.dataAccessObject.topOverlayTrimmingContainer,i=0;if(n===this.domBindings.rootWindow)i=r.documentElement.clientHeight;else{var o=$i(n);i=o>0&&n.clientHeight>0?n.clientHeight:1/0}return i}},{key:"getWorkspaceWidth",value:function(){var r=this.wtSettings,n=this.domBindings,i=n.rootDocument,o=n.rootWindow,s=this.dataAccessObject.inlineStartOverlayTrimmingContainer,a=i.documentElement.offsetWidth,h=r.getSetting("totalColumns"),p=r.getSetting("preventOverflow"),g=r.getSetting("rtlMode"),S=this.wtTable.TABLE.getBoundingClientRect(),T=g?S.right-a:S.left,R=a-T,A,$;if(p)return ri(this.wtTable.wtRootElement);if(r.getSetting("freezeOverlays")?A=Math.min(R,a):A=Math.min(this.getContainerFillWidth(),R,a),s===o&&h>0&&this.sumColumnWidths(0,h-1)>A)return i.documentElement.clientWidth;if(s!==o&&($=PS(this.dataAccessObject.inlineStartOverlayTrimmingContainer,"overflow",o),$==="scroll"||$==="hidden"||$==="auto"))return Math.max(A,s.clientWidth);var j=r.getSetting("stretchH");return j==="none"||!j?Math.max(A,ri(this.wtTable.TABLE)):A}},{key:"hasVerticalScroll",value:function(){return this.wtTable.hider.offsetHeight>this.getWorkspaceHeight()}},{key:"hasHorizontalScroll",value:function(){return this.wtTable.hider.offsetWidth>this.getWorkspaceWidth()}},{key:"sumColumnWidths",value:function(r,n){for(var i=0,o=r;o<n;)i+=this.wtTable.getColumnWidth(o),o+=1;return i}},{key:"getContainerFillWidth",value:function(){if(this.containerWidth)return this.containerWidth;var r=this.wtTable.holder,n=this.domBindings.rootDocument.createElement("div");n.style.width="100%",n.style.height="1px",r.appendChild(n);var i=n.offsetWidth;return this.containerWidth=i,r.removeChild(n),i}},{key:"getWorkspaceOffset",value:function(){return io(this.wtTable.TABLE)}},{key:"getColumnHeaderHeight",value:function(){var r=this.wtSettings.getSetting("columnHeaders");return r.length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=$i(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}},{key:"getViewportHeight",value:function(){var r=this.getWorkspaceHeight();if(r===1/0)return r;var n=this.getColumnHeaderHeight();return n>0&&(r-=n),r}},{key:"getRowHeaderWidth",value:function(){var r=this.wtSettings.getSetting("rowHeaderWidth"),n=this.wtSettings.getSetting("rowHeaders");if(r){this.rowHeaderWidth=0;for(var i=0,o=n.length;i<o;i++)this.rowHeaderWidth+=r[i]||r}if(isNaN(this.rowHeaderWidth))if(n.length){var s=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(var a=0,h=n.length;a<h;a++)s?(this.rowHeaderWidth+=ri(s),s=s.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}},{key:"getViewportWidth",value:function(){var r=this.getWorkspaceWidth();if(r===1/0)return r;var n=this.getRowHeaderWidth();return n>0?r-n:r}},{key:"createRowsCalculator",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:zd,n=this.wtSettings,i=this.wtTable,o,s,a;this.rowHeaderWidth=NaN,n.getSetting("renderAllRows")&&r===zd?o=1/0:o=this.getViewportHeight();var h=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset,p=n.getSetting("fixedRowsTop"),g=n.getSetting("fixedRowsBottom"),S=n.getSetting("totalRows");return p&&h>=0&&(a=this.dataAccessObject.topOverlay.sumCellSizes(0,p),h+=a,o-=a),g&&this.dataAccessObject.bottomOverlay.clone&&(a=this.dataAccessObject.bottomOverlay.sumCellSizes(S-g,S),o-=a),i.holder.clientHeight===i.holder.offsetHeight?s=0:s=Ao(this.domBindings.rootDocument),new Iae({viewportSize:o,scrollOffset:h,totalItems:n.getSetting("totalRows"),itemSizeFn:function(R){return i.getRowHeight(R)},overrideFn:n.getSettingPure("viewportRowCalculatorOverride"),calculationType:r,scrollbarHeight:s})}},{key:"createColumnsCalculator",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:zd,n=this.wtSettings,i=this.wtTable,o=this.getViewportWidth(),s=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;var a=n.getSetting("fixedColumnsStart");if(a&&s>=0){var h=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,a);s+=h,o-=h}return i.holder.clientWidth!==i.holder.offsetWidth&&(o-=Ao(this.domBindings.rootDocument)),new b3({viewportSize:o,scrollOffset:s,totalItems:n.getSetting("totalColumns"),itemSizeFn:function(g){return i.getColumnWidth(g)},overrideFn:n.getSettingPure("viewportColumnCalculatorOverride"),calculationType:r,stretchMode:n.getSetting("stretchH"),stretchingItemWidthFn:function(g,S){return n.getSetting("onBeforeStretchingColumnWidth",g,S)},inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}},{key:"createRenderCalculators",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=r;if(n){var i=this.createRowsCalculator(Jo),o=this.createColumnsCalculator(Jo);this.areAllProposedVisibleRowsAlreadyRendered(i)&&this.areAllProposedVisibleColumnsAlreadyRendered(o)||(n=!1)}return n||(this.rowsRenderCalculator=this.createRowsCalculator(zd),this.columnsRenderCalculator=this.createColumnsCalculator(zd)),this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,n}},{key:"createVisibleCalculators",value:function(){this.rowsVisibleCalculator=this.createRowsCalculator(Jo),this.columnsVisibleCalculator=this.createColumnsCalculator(Jo)}},{key:"areAllProposedVisibleRowsAlreadyRendered",value:function(r){if(!this.rowsVisibleCalculator)return!1;var n=r.startRow,i=r.endRow,o=r.isVisibleInTrimmingContainer;if(n===null&&i===null)return!o;var s=this.rowsRenderCalculator,a=s.startRow,h=s.endRow;return n<a||n===a&&n>0?!1:!(i>h||i===h&&i<this.wtSettings.getSetting("totalRows")-1)}},{key:"areAllProposedVisibleColumnsAlreadyRendered",value:function(r){if(!this.columnsVisibleCalculator)return!1;var n=r.startColumn,i=r.endColumn,o=r.isVisibleInTrimmingContainer;if(n===null&&i===null)return!o;var s=this.columnsRenderCalculator,a=s.startColumn,h=s.endColumn;return n<a||n===a&&n>0?!1:!(i>h||i===h&&i<this.wtSettings.getSetting("totalColumns")-1)}},{key:"resetHasOversizedColumnHeadersMarked",value:function(){pn(this.hasOversizedColumnHeadersMarked,function(r,n,i){i[n]=void 0})}}]),e}();const _5e=v5e;function wv(e){"@babel/helpers - typeof";return wv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wv(e)}function b5e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Pq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,S5e(n.key),n)}}function w5e(e,t,r){return t&&Pq(e.prototype,t),r&&Pq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function S5e(e){var t=x5e(e,"string");return wv(t)==="symbol"?t:String(t)}function x5e(e,t){if(wv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(wv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function C5e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&vB(e,t)}function vB(e,t){return vB=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},vB(e,t)}function E5e(e){var t=O5e();return function(){var n=rP(e),i;if(t){var o=rP(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return T5e(this,i)}}function T5e(e,t){if(t&&(wv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _B(e)}function _B(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function O5e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function rP(e){return rP=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},rP(e)}var R5e=function(e){C5e(r,e);var t=E5e(r);function r(n,i){var o;b5e(this,r),o=t.call(this,n,new n5e(i));var s=o.wtSettings.getSetting("facade",_B(o));return o.wtTable=new d5e(o.getTableDao(),s,o.domBindings,o.wtSettings),o.wtViewport=new _5e(o.getViewportDao(),o.domBindings,o.wtSettings,o.eventManager,o.wtTable),o.selections=o.wtSettings.getSetting("selections"),o.wtEvent=new Nae(s,o.domBindings,o.wtSettings,o.eventManager,o.wtTable,o.selections),o.wtOverlays=new QWe(_B(o),s,o.domBindings,o.wtSettings,o.eventManager,o.wtTable),o.exportSettingsAsClassNames(),o.findOriginalHeaders(),o}return w5e(r,[{key:"exportSettingsAsClassNames",value:function(){var i=this,o={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},s=[],a=[];pn(o,function(h,p){i.wtSettings.getSetting(p).length&&a.push(h),s.push(h)}),Kr(this.wtTable.wtRootElement.parentNode,s),Ht(this.wtTable.wtRootElement.parentNode,a)}},{key:"getViewportDao",value:function(){var i=this;return{get wot(){return i},get topOverlayTrimmingContainer(){return i.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return i.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return i.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return i.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return i.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return i.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return i.wtOverlays.topOverlay},get inlineStartOverlay(){return i.wtOverlays.inlineStartOverlay},get bottomOverlay(){return i.wtOverlays.bottomOverlay}}}}]),r}(C3);function a1(e){"@babel/helpers - typeof";return a1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a1(e)}function k5e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Aq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,A5e(n.key),n)}}function P5e(e,t,r){return t&&Aq(e.prototype,t),r&&Aq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function A5e(e){var t=I5e(e,"string");return a1(t)==="symbol"?t:String(t)}function I5e(e,t){if(a1(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(a1(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var M5e=function(){function e(t){k5e(this,e),t instanceof C3?this._wot=t:this._initFromSettings(t)}return P5e(e,[{key:"_initFromSettings",value:function(r){r.facade=function(n){var i=new e(n);return function(){return i}},this._wot=new R5e(r.table,r)}},{key:"guid",get:function(){return this._wot.guid}},{key:"rootDocument",get:function(){return this._wot.domBindings.rootDocument}},{key:"rootWindow",get:function(){return this._wot.domBindings.rootWindow}},{key:"wtSettings",get:function(){return this._wot.wtSettings}},{key:"cloneSource",get:function(){return this._wot.cloneSource}},{key:"cloneOverlay",get:function(){return this._wot.cloneOverlay}},{key:"selections",get:function(){return this._wot.selections}},{key:"wtViewport",get:function(){return this._wot.wtViewport}},{key:"wtOverlays",get:function(){return this._wot.wtOverlays}},{key:"wtTable",get:function(){return this._wot.wtTable}},{key:"wtEvent",get:function(){return this._wot.wtEvent}},{key:"wtScroll",get:function(){return this._wot.wtScroll}},{key:"drawn",get:function(){return this._wot.drawn},set:function(r){this._wot.drawn=r}},{key:"drawInterrupted",get:function(){return this._wot.drawInterrupted},set:function(r){this._wot.drawInterrupted=r}},{key:"lastMouseOver",get:function(){return this._wot.lastMouseOver},set:function(r){this._wot.lastMouseOver=r}},{key:"momentumScrolling",get:function(){return this._wot.momentumScrolling},set:function(r){this._wot.momentumScrolling=r}},{key:"touchApplied",get:function(){return this._wot.touchApplied},set:function(r){this._wot.touchApplied=r}},{key:"domBindings",get:function(){return this._wot.domBindings}},{key:"eventListeners",get:function(){return this._wot.eventListeners},set:function(r){this._wot.eventListeners=r}},{key:"eventManager",get:function(){return this._wot.eventManager}},{key:"createCellCoords",value:function(r,n){return this._wot.createCellCoords(r,n)}},{key:"createCellRange",value:function(r,n,i){return this._wot.createCellRange(r,n,i)}},{key:"draw",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(r),this}},{key:"getCell",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(r,n)}},{key:"scrollViewport",value:function(r,n,i,o,s){return this._wot.scrollViewport(r,n,i,o,s)}},{key:"scrollViewportHorizontally",value:function(r,n,i){return this._wot.scrollViewportHorizontally(r,n,i)}},{key:"scrollViewportVertically",value:function(r,n,i){return this._wot.scrollViewportVertically(r,n,i)}},{key:"getViewport",value:function(){return this._wot.getViewport()}},{key:"getOverlayName",value:function(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}},{key:"exportSettingsAsClassNames",value:function(){return this._wot.exportSettingsAsClassNames()}},{key:"update",value:function(r,n){return this._wot.wtSettings.update(r,n),this}},{key:"getSetting",value:function(r,n,i,o,s){return this._wot.wtSettings.getSetting(r,n,i,o,s)}},{key:"hasSetting",value:function(r){return this._wot.wtSettings.hasSetting(r)}},{key:"destroy",value:function(){this._wot.destroy()}}]),e}(),D5e=Ji,hse=an,$5e=Hx,L5e=cs,N5e=Gx.f,B5e=hse(N5e),j5e=hse([].push),Iq=function(e){return function(t){for(var r=L5e(t),n=$5e(r),i=n.length,o=0,s=[],a;i>o;)a=n[o++],(!D5e||B5e(r,a))&&j5e(s,e?[a,r[a]]:r[a]);return s}},z5e={entries:Iq(!0),values:Iq(!1)},F5e=Br,H5e=z5e.values;F5e({target:"Object",stat:!0},{values:function(t){return H5e(t)}});function s1(e){"@babel/helpers - typeof";return s1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s1(e)}function C$(e,t){return G5e(e)||W5e(e,t)||U5e(e,t)||V5e()}function V5e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function U5e(e,t){if(e){if(typeof e=="string")return Mq(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Mq(e,t)}}function Mq(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function W5e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],h=!0,p=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;h=!1}else for(;!(h=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);h=!0);}catch(g){p=!0,i=g}finally{try{if(!h&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(p)throw i}}return a}}function G5e(e){if(Array.isArray(e))return e}function Y5e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Dq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,q5e(n.key),n)}}function K5e(e,t,r){return t&&Dq(e.prototype,t),r&&Dq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function q5e(e){var t=X5e(e,"string");return s1(t)==="symbol"?t:String(t)}function X5e(e,t){if(s1(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(s1(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Z5e=function(){function e(t,r){Y5e(this,e),r&&(this.eventManager=t.eventManager,this.instance=t,this.wot=t,this.settings=r,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle={width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"},this.cornerCenterPointOffset=-(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(r),this.registerListeners())}return K5e(e,[{key:"registerListeners",value:function(){var r=this,n=this.wot.rootDocument.body;this.eventManager.addEventListener(n,"mousedown",function(){return r.onMouseDown()}),this.eventManager.addEventListener(n,"mouseup",function(){return r.onMouseUp()});for(var i=function(h){var p=r.main.childNodes[h];r.eventManager.addEventListener(p,"mouseenter",function(g){return r.onMouseEnter(g,r.main.childNodes[h])})},o=0,s=this.main.childNodes.length;o<s;o++)i(o)}},{key:"onMouseDown",value:function(){this.mouseDown=!0}},{key:"onMouseUp",value:function(){this.mouseDown=!1}},{key:"onMouseEnter",value:function(r,n){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;r.preventDefault(),lu(r);var i=this,o=this.wot.rootDocument.body,s=n.getBoundingClientRect();n.style.display="none";function a(p){if(p.clientY<Math.floor(s.top)||p.clientY>Math.ceil(s.top+s.height)||p.clientX<Math.floor(s.left)||p.clientX>Math.ceil(s.left+s.width))return!0}function h(p){a(p)&&(i.eventManager.removeEventListener(o,"mousemove",h),n.style.display="block")}this.eventManager.addEventListener(o,"mousemove",h)}},{key:"createBorders",value:function(r){var n=this.wot.rootDocument;this.main=n.createElement("div");var i=["top","start","bottom","end","corner"],o=this.main.style;o.position="absolute",o.top=0,o.left=0;for(var s=0;s<5;s++){var a=i[s],h=n.createElement("div");h.className="wtBorder ".concat(this.settings.className||""),this.settings[a]&&this.settings[a].hide&&(h.className+=" hidden"),o=h.style,o.backgroundColor=this.settings[a]&&this.settings[a].color?this.settings[a].color:r.border.color,o.height=this.settings[a]&&this.settings[a].width?"".concat(this.settings[a].width,"px"):"".concat(r.border.width,"px"),o.width=this.settings[a]&&this.settings[a].width?"".concat(this.settings[a].width,"px"):"".concat(r.border.width,"px"),this.main.appendChild(h)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),nu()&&this.createMultipleSelectorHandles(),this.disappear();var p=this.wot.wtTable,g=p.bordersHolder;g||(g=n.createElement("div"),g.className="htBorders",p.bordersHolder=g,p.spreader.appendChild(g)),g.appendChild(this.main)}},{key:"createMultipleSelectorHandles",value:function(){var r=this,n=this.wot.rootDocument;this.selectionHandles={top:n.createElement("DIV"),topHitArea:n.createElement("DIV"),bottom:n.createElement("DIV"),bottomHitArea:n.createElement("DIV")};var i=10,o=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};var s={position:"absolute",height:"".concat(o,"px"),width:"".concat(o,"px"),"border-radius":"".concat(parseInt(o/1.5,10),"px")};pn(s,function(h,p){r.selectionHandles.styles.bottomHitArea[p]=h,r.selectionHandles.styles.topHitArea[p]=h});var a={position:"absolute",height:"".concat(i,"px"),width:"".concat(i,"px"),"border-radius":"".concat(parseInt(i/1.5,10),"px"),background:"#F5F5FF",border:"1px solid #4285c8"};pn(a,function(h,p){r.selectionHandles.styles.bottom[p]=h,r.selectionHandles.styles.top[p]=h}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}},{key:"isPartRange",value:function(r,n){var i=this.wot.selections.createOrGetArea();return!!(i.cellRange&&(r!==i.cellRange.to.row||n!==i.cellRange.to.col))}},{key:"updateMultipleSelectionHandlesPosition",value:function(r,n,i,o,s,a){var h=this.wot.wtSettings.getSetting("rtlMode"),p=h?"right":"left",g=this.selectionHandles.styles,S=g.top,T=g.topHitArea,R=g.bottom,A=g.bottomHitArea,$=parseInt(S.borderWidth,10),j=parseInt(S.width,10),z=parseInt(T.width,10),V=this.wot.wtTable.getWidth(),G=this.wot.wtTable.getHeight();S.top="".concat(parseInt(i-j-1,10),"px"),S[p]="".concat(parseInt(o-j-1,10),"px"),T.top="".concat(parseInt(i-z/4*3,10),"px"),T[p]="".concat(parseInt(o-z/4*3,10),"px");var ee=Math.min(parseInt(o+s,10),V-j-$*2),K=Math.min(parseInt(o+s-z/4,10),V-z-$*2);R[p]="".concat(ee,"px"),A[p]="".concat(K,"px");var xe=Math.min(parseInt(i+a,10),G-j-$*2),Me=Math.min(parseInt(i+a-z/4,10),G-z-$*2);R.top="".concat(xe,"px"),A.top="".concat(Me,"px"),this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(S.display="block",T.display="block",this.isPartRange(r,n)?(R.display="none",A.display="none"):(R.display="block",A.display="block")):(S.display="none",R.display="none",T.display="none",A.display="none"),r===this.wot.wtSettings.getSetting("fixedRowsTop")||n===this.wot.wtSettings.getSetting("fixedColumnsStart")?(S.zIndex="9999",T.zIndex="9999"):(S.zIndex="",T.zIndex="")}},{key:"appear",value:function(r){if(!this.disabled){for(var n=this.wot,i=n.wtTable,o=n.rootDocument,s=n.rootWindow,a,h,p,g,S,T,R=i.getRenderedRowsCount(),A=0;A<R;A+=1){var $=i.rowFilter.renderedToSource(A);if($>=r[0]&&$<=r[2]){a=$,S=r[0];break}}for(var j=R-1;j>=0;j-=1){var z=i.rowFilter.renderedToSource(j);if(z>=r[0]&&z<=r[2]){h=z;break}}for(var V=i.getRenderedColumnsCount(),G=0;G<V;G+=1){var ee=i.columnFilter.renderedToSource(G);if(ee>=r[1]&&ee<=r[3]){p=ee,T=r[1];break}}for(var K=V-1;K>=0;K-=1){var xe=i.columnFilter.renderedToSource(K);if(xe>=r[1]&&xe<=r[3]){g=xe;break}}if(a===void 0||p===void 0){this.disappear();return}var Me=i.getCell(this.wot.createCellCoords(a,p)),He=a!==h||p!==g,Ne=He?i.getCell(this.wot.createCellCoords(h,g)):Me,We=io(Me),gt=He?io(Ne):We,Lt=io(i.TABLE),_t=ri(i.TABLE),$e=We.top,Fe=We.left,At=this.wot.wtSettings.getSetting("rtlMode"),Gt=0,ae=0;if(At){var D=ri(Me),U=s.innerWidth-Lt.left-_t;ae=Fe+D-gt.left,Gt=s.innerWidth-Fe-D-U-1}else ae=gt.left+ri(Ne)-Fe,Gt=Fe-Lt.left-1;if(this.isEntireColumnSelected(a,h)){var q=this.getDimensionsFromHeader("columns",p,g,S,Lt),ne=null;if(q){var ye=C$(q,3);ne=ye[0],Gt=ye[1],ae=ye[2]}ne&&(Me=ne)}var ve=$e-Lt.top-1,ze=gt.top+$i(Ne)-$e;if(this.isEntireRowSelected(p,g)){var je=this.getDimensionsFromHeader("rows",a,h,T,Lt),Je=null;if(je){var xt=C$(je,3);Je=xt[0],ve=xt[1],ze=xt[2]}Je&&(Me=Je)}var kt=Ip(Me,s);parseInt(kt.borderTopWidth,10)>0&&(ve+=1,ze=ze>0?ze-1:0),parseInt(kt[At?"borderRightWidth":"borderLeftWidth"],10)>0&&(Gt+=1,ae=ae>0?ae-1:0);var jt=At?"right":"left";this.topStyle.top="".concat(ve,"px"),this.topStyle[jt]="".concat(Gt,"px"),this.topStyle.width="".concat(ae,"px"),this.topStyle.display="block",this.startStyle.top="".concat(ve,"px"),this.startStyle[jt]="".concat(Gt,"px"),this.startStyle.height="".concat(ze,"px"),this.startStyle.display="block";var yr=Math.floor(this.settings.border.width/2);this.bottomStyle.top="".concat(ve+ze-yr,"px"),this.bottomStyle[jt]="".concat(Gt,"px"),this.bottomStyle.width="".concat(ae,"px"),this.bottomStyle.display="block",this.endStyle.top="".concat(ve,"px"),this.endStyle[jt]="".concat(Gt+ae-yr,"px"),this.endStyle.height="".concat(ze+1,"px"),this.endStyle.display="block";var Ft=this.settings.border.cornerVisible;Ft=typeof Ft=="function"?Ft(this.settings.layerLevel):Ft;var Jt=this.wot.getSetting("onModifyGetCellCoords",h,g),et=h,wr=g;if(Jt&&Array.isArray(Jt)){var $r=C$(Jt,4);et=$r[2],wr=$r[3]}if(nu()||!Ft||this.isPartRange(et,wr))this.cornerStyle.display="none";else{this.cornerStyle.top="".concat(ve+ze+this.cornerCenterPointOffset-1,"px"),this.cornerStyle[jt]="".concat(Gt+ae+this.cornerCenterPointOffset-1,"px"),this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";var lr=kS(i.TABLE),Sr=lr===s;Sr&&(lr=o.documentElement);var Or=parseInt(this.cornerDefaultStyle.width,10)/2,se=parseInt(this.cornerDefaultStyle.height,10)/2;if(g===this.wot.getSetting("totalColumns")-1){var _e=Sr?Ne.getBoundingClientRect().left:Ne.offsetLeft,Re=!1,Ke=0;At?(Ke=_e-parseInt(this.cornerDefaultStyle.width,10)/2,Re=Ke<0):(Ke=_e+ri(Ne)+parseInt(this.cornerDefaultStyle.width,10)/2,Re=Ke>=sR(lr)),Re&&(this.cornerStyle[jt]="".concat(Math.floor(Gt+ae+this.cornerCenterPointOffset-Or),"px"),this.cornerStyle[At?"borderLeftWidth":"borderRightWidth"]=0)}if(h===this.wot.getSetting("totalRows")-1){var Be=Sr?Ne.getBoundingClientRect().top:Ne.offsetTop,rt=Be+$i(Ne)+parseInt(this.cornerDefaultStyle.height,10)/2,Ue=rt>=Vf(lr);Ue&&(this.cornerStyle.top="".concat(Math.floor(ve+ze+this.cornerCenterPointOffset-se),"px"),this.cornerStyle.borderBottomWidth=0)}this.cornerStyle.display="block"}nu()&&this.updateMultipleSelectionHandlesPosition(h,g,ve,Gt,ae,ze)}}},{key:"isEntireColumnSelected",value:function(r,n){return r===this.wot.wtTable.getFirstRenderedRow()&&n===this.wot.wtTable.getLastRenderedRow()}},{key:"isEntireRowSelected",value:function(r,n){return r===this.wot.wtTable.getFirstRenderedColumn()&&n===this.wot.wtTable.getLastRenderedColumn()}},{key:"getDimensionsFromHeader",value:function(r,n,i,o,s){var a=this.wot.wtTable,h=a.wtRootElement.parentNode,p=null,g=null,S=null,T=null,R=null,A=null,$=null,j=null;switch(r){case"rows":p=function(){return a.getRowHeader.apply(a,arguments)},g=function(){return $i.apply(void 0,arguments)},S="ht__selection--rows",A="top";break;case"columns":p=function(){return a.getColumnHeader.apply(a,arguments)},g=function(){return ri.apply(void 0,arguments)},S="ht__selection--columns",A="left";break}if(h.classList.contains(S)){var z=this.wot.getSetting("columnHeaders").length;if($=p(n,z-o),j=p(i,z-o),!$||!j)return!1;var V=io($),G=io(j);return $&&j&&(T=V[A]-s[A]-1,R=G[A]+g(j)-V[A]),[$,T,R]}return!1}},{key:"changeBorderStyle",value:function(r,n){var i=this[r].style,o=n[r];!o||o.hide?Ht(this[r],"hidden"):(Ur(this[r],"hidden")&&Kr(this[r],"hidden"),i.backgroundColor=o.color,(r==="top"||r==="bottom")&&(i.height="".concat(o.width,"px")),(r==="start"||r==="end")&&(i.width="".concat(o.width,"px")))}},{key:"changeBorderToDefaultStyle",value:function(r){var n={width:1,color:"#000"},i=this[r].style;i.backgroundColor=n.color,i.width="".concat(n.width,"px"),i.height="".concat(n.width,"px")}},{key:"toggleHiddenClass",value:function(r,n){this.changeBorderToDefaultStyle(r),n?Ht(this[r],"hidden"):Kr(this[r],"hidden")}},{key:"disappear",value:function(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",nu()&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}},{key:"destroy",value:function(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}]),e}();const J5e=Z5e;function Q5e(e,t){return nGe(e)||rGe(e,t)||tGe(e,t)||eGe()}function eGe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function tGe(e,t){if(e){if(typeof e=="string")return $q(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return $q(e,t)}}function $q(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function rGe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],h=!0,p=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;h=!1}else for(;!(h=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);h=!0);}catch(g){p=!0,i=g}finally{try{if(!h&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(p)throw i}}return a}}function nGe(e){if(Array.isArray(e))return e}function Sv(e){"@babel/helpers - typeof";return Sv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sv(e)}function iGe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Lq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,aGe(n.key),n)}}function oGe(e,t,r){return t&&Lq(e.prototype,t),r&&Lq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function aGe(e){var t=sGe(e,"string");return Sv(t)==="symbol"?t:String(t)}function sGe(e,t){if(Sv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Sv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var lGe=function(){function e(t,r){iGe(this,e),this.settings=t,this.cellRange=r||null,this.instanceBorders={},this.classNames=[this.settings.className],this.classNameGenerator=this.linearClassNameGenerator(this.settings.className,this.settings.layerLevel)}return oGe(e,[{key:"getBorder",value:function(r){return this.instanceBorders[r.guid]||(this.instanceBorders[r.guid]=new J5e(r,this.settings)),this.instanceBorders[r.guid]}},{key:"isEmpty",value:function(){return this.cellRange===null}},{key:"add",value:function(r){return this.isEmpty()?this.cellRange=this.settings.createCellRange(r):this.cellRange.expand(r),this}},{key:"replace",value:function(r,n){if(!this.isEmpty()){if(this.cellRange.from.isEqual(r))return this.cellRange.from=n,!0;if(this.cellRange.to.isEqual(r))return this.cellRange.to=n,!0}return!1}},{key:"clear",value:function(){return this.cellRange=null,this}},{key:"getCorners",value:function(){var r=this.cellRange.getOuterTopStartCorner(),n=this.cellRange.getOuterBottomEndCorner();return[r.row,r.col,n.row,n.col]}},{key:"addClassAtCoords",value:function(r,n,i,o){var s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,a=r.wtTable.getCell(this.settings.createCellCoords(n,i));if(Sv(a)==="object"){var h=o;s&&(h=this.classNameGenerator(a),this.classNames.includes(h)||this.classNames.push(h)),Ht(a,h)}return this}},{key:"linearClassNameGenerator",value:function(r,n){return function i(o){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;if(n===0||s===0)return r;var a=s>=0?s:n,h=r;a-=1;var p=a===0?r:"".concat(r,"-").concat(a);if(Ur(o,p)){var g=a+1;h="".concat(r,"-").concat(g)}else h=i(o,a);return h}}},{key:"draw",value:function(r){if(this.isEmpty()){this.settings.border&&this.getBorder(r).disappear();return}var n=r.wtTable.getRenderedRowsCount(),i=r.wtTable.getRenderedColumnsCount(),o=this.getCorners(),s=Q5e(o,4),a=s[0],h=s[1],p=s[2],g=s[3],S=this.settings,T=S.highlightHeaderClassName,R=S.highlightColumnClassName,A=S.highlightRowClassName,$=S.highlightOnlyClosestHeader,j=S.selectionType,z=j===void 0||["active-header","header"].includes(j);if(z&&h!==null&&g!==null)for(var V=0,G=0;G<i;G+=1){var ee=r.wtTable.columnFilter.renderedToSource(G);if(ee>=h&&ee<=g){var K=r.wtTable.getColumnHeaders(ee),xe=K.length-1;$&&K.length>1&&(K=[K[xe]]);for(var Me=0;Me<K.length;Me+=1){var He=[],Ne=K[Me];T&&He.push(T),R&&He.push(R),Me=$?xe:Me;var We=r.getSetting("onBeforeHighlightingColumnHeader",ee,Me,{selectionType:j,columnCursor:V,selectionWidth:g-h+1,classNames:He});We!==ee&&(Ne=r.wtTable.getColumnHeader(We,Me)),Ht(Ne,He)}V+=1}}if(a!==null&&p!==null)for(var gt=0,Lt=0;Lt<n;Lt+=1){var _t=r.wtTable.rowFilter.renderedToSource(Lt);if(z&&_t>=a&&_t<=p){var $e=r.wtTable.getRowHeaders(_t),Fe=$e.length-1;$&&$e.length>1&&($e=[$e[Fe]]);for(var At=0;At<$e.length;At+=1){var Gt=[],ae=$e[At];T&&Gt.push(T),A&&Gt.push(A),At=$?Fe:At;var D=r.getSetting("onBeforeHighlightingRowHeader",_t,At,{selectionType:j,rowCursor:gt,selectionHeight:p-a+1,classNames:Gt});D!==_t&&(ae=r.wtTable.getRowHeader(D,At)),Ht(ae,Gt)}gt+=1}if(h!==null&&g!==null)for(var U=0;U<i;U+=1){var q=r.wtTable.columnFilter.renderedToSource(U);_t>=a&&_t<=p&&q>=h&&q<=g?this.settings.className&&this.addClassAtCoords(r,_t,q,this.settings.className,this.settings.markIntersections):_t>=a&&_t<=p?A&&this.addClassAtCoords(r,_t,q,A):q>=h&&q<=g&&R&&this.addClassAtCoords(r,_t,q,R);var ne=r.getSetting("onAfterDrawSelection",_t,q,this.settings.layerLevel);typeof ne=="string"&&this.addClassAtCoords(r,_t,q,ne)}}r.getSetting("onBeforeDrawBorders",o,this.settings.className),this.settings.border&&this.getBorder(r).appear(o)}},{key:"destroy",value:function(){Object.values(this.instanceBorders).forEach(function(r){return r.destroy()})}}]),e}();const uGe=lGe;var cGe=Br,fGe=em.findIndex,hGe=Vx,bB="findIndex",dse=!0;bB in[]&&Array(1)[bB](function(){dse=!1});cGe({target:"Array",proto:!0,forced:dse},{findIndex:function(t){return fGe(this,t,arguments.length>1?arguments[1]:void 0)}});hGe(bB);var dGe="localHooks",pse={_localHooks:Object.create(null),addLocalHook:function(t,r){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(r),this},runLocalHooks:function(t,r,n,i,o,s,a){if(this._localHooks[t])for(var h=this._localHooks[t].length,p=0;p<h;p++)PN(this._localHooks[t][p],this,r,n,i,o,s,a)},clearLocalHooks:function(){return this._localHooks={},this}};Bc(pse,"MIXIN_NAME",dGe,{writable:!1,enumerable:!1});const Va=pse;function l1(e){"@babel/helpers - typeof";return l1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l1(e)}function pGe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Nq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,yGe(n.key),n)}}function mGe(e,t,r){return t&&Nq(e.prototype,t),r&&Nq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function yGe(e){var t=gGe(e,"string");return l1(t)==="symbol"?t:String(t)}function gGe(e,t){if(l1(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(l1(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var im=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;pGe(this,e),this.indexedValues=[],this.initValueOrFn=t}return mGe(e,[{key:"getValues",value:function(){return this.indexedValues}},{key:"getValueAtIndex",value:function(r){var n=this.indexedValues;if(r<n.length)return n[r]}},{key:"setValues",value:function(r){this.indexedValues=r.slice(),this.runLocalHooks("change")}},{key:"setValueAtIndex",value:function(r,n){return r<this.indexedValues.length?(this.indexedValues[r]=n,this.runLocalHooks("change"),!0):!1}},{key:"clear",value:function(){this.setDefaultValues()}},{key:"getLength",value:function(){return this.getValues().length}},{key:"setDefaultValues",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,ci(this.initValueOrFn)?Er(n-1,function(i){return r.indexedValues.push(r.initValueOrFn(i))}):Er(n-1,function(){return r.indexedValues.push(r.initValueOrFn)}),this.runLocalHooks("change")}},{key:"init",value:function(r){return this.setDefaultValues(r),this.runLocalHooks("init"),this}},{key:"insert",value:function(){this.runLocalHooks("change")}},{key:"remove",value:function(){this.runLocalHooks("change")}},{key:"destroy",value:function(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}]),e}();li(im,Va);function E$(e){return wGe(e)||bGe(e)||_Ge(e)||vGe()}function vGe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _Ge(e,t){if(e){if(typeof e=="string")return wB(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return wB(e,t)}}function bGe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function wGe(e){if(Array.isArray(e))return wB(e)}function wB(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function A3(e,t,r,n){var i=r.length?r[0]:void 0;return[].concat(E$(e.slice(0,i)),E$(r.map(function(o,s){return ci(n)?n(o,s):n})),E$(i===void 0?[]:e.slice(i)))}function I3(e,t){return $s(e,function(r,n){return t.includes(n)===!1})}function xv(e){"@babel/helpers - typeof";return xv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xv(e)}function SGe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Bq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,CGe(n.key),n)}}function xGe(e,t,r){return t&&Bq(e.prototype,t),r&&Bq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function CGe(e){var t=EGe(e,"string");return xv(t)==="symbol"?t:String(t)}function EGe(e,t){if(xv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(xv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function U0(){return typeof Reflect<"u"&&Reflect.get?U0=Reflect.get.bind():U0=function(t,r,n){var i=TGe(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},U0.apply(this,arguments)}function TGe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Bp(e),e!==null););return e}function OGe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&SB(e,t)}function SB(e,t){return SB=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},SB(e,t)}function RGe(e){var t=AGe();return function(){var n=Bp(e),i;if(t){var o=Bp(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return kGe(this,i)}}function kGe(e,t){if(t&&(xv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return PGe(e)}function PGe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function AGe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Bp(e){return Bp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Bp(e)}var Ch=function(e){OGe(r,e);var t=RGe(r);function r(){return SGe(this,r),t.apply(this,arguments)}return xGe(r,[{key:"insert",value:function(i,o){this.indexedValues=A3(this.indexedValues,i,o,this.initValueOrFn),U0(Bp(r.prototype),"insert",this).call(this,i,o)}},{key:"remove",value:function(i){this.indexedValues=I3(this.indexedValues,i),U0(Bp(r.prototype),"remove",this).call(this,i)}}]),r}(im);function Cv(e){"@babel/helpers - typeof";return Cv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cv(e)}function IGe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,DGe(n.key),n)}}function MGe(e,t,r){return t&&jq(e.prototype,t),r&&jq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function DGe(e){var t=$Ge(e,"string");return Cv(t)==="symbol"?t:String(t)}function $Ge(e,t){if(Cv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Cv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function LGe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&xB(e,t)}function xB(e,t){return xB=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},xB(e,t)}function NGe(e){var t=zGe();return function(){var n=nP(e),i;if(t){var o=nP(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return BGe(this,i)}}function BGe(e,t){if(t&&(Cv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return jGe(e)}function jGe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function zGe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function nP(e){return nP=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},nP(e)}var $A=function(e){LGe(r,e);var t=NGe(r);function r(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return IGe(this,r),t.call(this,n)}return MGe(r,[{key:"getHiddenIndexes",value:function(){return na(this.getValues(),function(i,o,s){return o&&i.push(s),i},[])}}]),r}(Ch);function T$(e){return UGe(e)||VGe(e)||HGe(e)||FGe()}function FGe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function HGe(e,t){if(e){if(typeof e=="string")return CB(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return CB(e,t)}}function VGe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function UGe(e){if(Array.isArray(e))return CB(e)}function CB(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function M3(e,t,r){return[].concat(T$(e.slice(0,t)),T$(r),T$(e.slice(t)))}function u1(e,t){return $s(e,function(r){return t.includes(r)===!1})}function D3(e,t){return hn(e,function(r){return r-t.filter(function(n){return n<r}).length})}function $3(e,t){var r=t[0],n=t.length;return hn(e,function(i){return i>=r?i+n:i})}function Ev(e){"@babel/helpers - typeof";return Ev=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ev(e)}function WGe(e){return qGe(e)||KGe(e)||YGe(e)||GGe()}function GGe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function YGe(e,t){if(e){if(typeof e=="string")return EB(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return EB(e,t)}}function KGe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function qGe(e){if(Array.isArray(e))return EB(e)}function EB(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function XGe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function zq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,yse(n.key),n)}}function ZGe(e,t,r){return t&&zq(e.prototype,t),r&&zq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Gu(){return typeof Reflect<"u"&&Reflect.get?Gu=Reflect.get.bind():Gu=function(t,r,n){var i=JGe(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Gu.apply(this,arguments)}function JGe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=fl(e),e!==null););return e}function QGe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&TB(e,t)}function TB(e,t){return TB=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},TB(e,t)}function e6e(e){var t=r6e();return function(){var n=fl(e),i;if(t){var o=fl(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return t6e(this,i)}}function t6e(e,t){if(t&&(Ev(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return mse(e)}function mse(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function r6e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function fl(e){return fl=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},fl(e)}function n6e(e,t,r){return t=yse(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function yse(e){var t=i6e(e,"string");return Ev(t)==="symbol"?t:String(t)}function i6e(e,t){if(Ev(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ev(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var LA=function(e){QGe(r,e);var t=e6e(r);function r(){var n;XGe(this,r);for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n=t.call.apply(t,[this].concat(o)),n6e(mse(n),"orderOfIndexes",[]),n}return ZGe(r,[{key:"getValues",value:function(){var i=this;return this.orderOfIndexes.map(function(o){return i.indexedValues[o]})}},{key:"setValues",value:function(i){this.orderOfIndexes=WGe(Array(i.length).keys()),Gu(fl(r.prototype),"setValues",this).call(this,i)}},{key:"setValueAtIndex",value:function(i,o){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return i<this.indexedValues.length?(this.indexedValues[i]=o,this.orderOfIndexes.includes(i)===!1&&this.orderOfIndexes.splice(s,0,i),this.runLocalHooks("change"),!0):!1}},{key:"clearValue",value:function(i){this.orderOfIndexes=u1(this.orderOfIndexes,[i]),ci(this.initValueOrFn)?Gu(fl(r.prototype),"setValueAtIndex",this).call(this,i,this.initValueOrFn(i)):Gu(fl(r.prototype),"setValueAtIndex",this).call(this,i,this.initValueOrFn)}},{key:"getLength",value:function(){return this.orderOfIndexes.length}},{key:"setDefaultValues",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,Gu(fl(r.prototype),"setDefaultValues",this).call(this,i)}},{key:"insert",value:function(i,o){this.indexedValues=A3(this.indexedValues,i,o,this.initValueOrFn),this.orderOfIndexes=$3(this.orderOfIndexes,o),Gu(fl(r.prototype),"insert",this).call(this,i,o)}},{key:"remove",value:function(i){this.indexedValues=I3(this.indexedValues,i),this.orderOfIndexes=u1(this.orderOfIndexes,i),this.orderOfIndexes=D3(this.orderOfIndexes,i),Gu(fl(r.prototype),"remove",this).call(this,i)}},{key:"getEntries",value:function(){var i=this;return this.orderOfIndexes.map(function(o){return[o,i.getValueAtIndex(o)]})}}]),r}(im);function Tv(e){"@babel/helpers - typeof";return Tv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Tv(e)}function o6e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Fq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,s6e(n.key),n)}}function a6e(e,t,r){return t&&Fq(e.prototype,t),r&&Fq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function s6e(e){var t=l6e(e,"string");return Tv(t)==="symbol"?t:String(t)}function l6e(e,t){if(Tv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Tv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function u6e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&OB(e,t)}function OB(e,t){return OB=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},OB(e,t)}function c6e(e){var t=d6e();return function(){var n=iP(e),i;if(t){var o=iP(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return f6e(this,i)}}function f6e(e,t){if(t&&(Tv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return h6e(e)}function h6e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function d6e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function iP(e){return iP=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},iP(e)}var vC=function(e){u6e(r,e);var t=c6e(r);function r(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return o6e(this,r),t.call(this,n)}return a6e(r,[{key:"getTrimmedIndexes",value:function(){return na(this.getValues(),function(i,o,s){return o&&i.push(s),i},[])}}]),r}(Ch),Hq=new Map([["indexesSequence",{getListWithInsertedItems:M3,getListWithRemovedItems:u1}],["physicallyIndexed",{getListWithInsertedItems:A3,getListWithRemovedItems:I3}]]),gse=function(t){if(Hq.has(t)===!1)throw new Error("Alter strategy with ID '".concat(t,"' does not exist."));return Hq.get(t)};function Ov(e){"@babel/helpers - typeof";return Ov=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ov(e)}function p6e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Vq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,y6e(n.key),n)}}function m6e(e,t,r){return t&&Vq(e.prototype,t),r&&Vq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function y6e(e){var t=g6e(e,"string");return Ov(t)==="symbol"?t:String(t)}function g6e(e,t){if(Ov(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ov(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function W0(){return typeof Reflect<"u"&&Reflect.get?W0=Reflect.get.bind():W0=function(t,r,n){var i=v6e(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},W0.apply(this,arguments)}function v6e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=jp(e),e!==null););return e}function _6e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&RB(e,t)}function RB(e,t){return RB=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},RB(e,t)}function b6e(e){var t=x6e();return function(){var n=jp(e),i;if(t){var o=jp(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return w6e(this,i)}}function w6e(e,t){if(t&&(Ov(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return S6e(e)}function S6e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function x6e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function jp(e){return jp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},jp(e)}var vse=function(e){_6e(r,e);var t=b6e(r);function r(){return p6e(this,r),t.call(this,function(n){return n})}return m6e(r,[{key:"insert",value:function(i,o){var s=$3(this.indexedValues,o);this.indexedValues=M3(s,i,o),W0(jp(r.prototype),"insert",this).call(this,i,o)}},{key:"remove",value:function(i){var o=u1(this.indexedValues,i);this.indexedValues=D3(o,i),W0(jp(r.prototype),"remove",this).call(this,i)}}]),r}(im),Uq=new Map([["hiding",$A],["index",im],["linkedPhysicalIndexToValue",LA],["physicalIndexToValue",Ch],["trimming",vC]]);function C6e(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!Uq.has(e))throw new Error('The provided map type ("'.concat(e,'") does not exist.'));return new(Uq.get(e))(t)}function c1(e){"@babel/helpers - typeof";return c1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},c1(e)}function E6e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Wq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,O6e(n.key),n)}}function T6e(e,t,r){return t&&Wq(e.prototype,t),r&&Wq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function O6e(e){var t=R6e(e,"string");return c1(t)==="symbol"?t:String(t)}function R6e(e,t){if(c1(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(c1(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var L3=function(){function e(){E6e(this,e),this.collection=new Map}return T6e(e,[{key:"register",value:function(r,n){var i=this;this.collection.has(r)===!1&&(this.collection.set(r,n),n.addLocalHook("change",function(){return i.runLocalHooks("change",n)}))}},{key:"unregister",value:function(r){var n=this.collection.get(r);dr(n)&&(n.destroy(),this.collection.delete(r),this.runLocalHooks("change",n))}},{key:"unregisterAll",value:function(){var r=this;this.collection.forEach(function(n,i){return r.unregister(i)}),this.collection.clear()}},{key:"get",value:function(r){return si(r)?Array.from(this.collection.values()):this.collection.get(r)}},{key:"getLength",value:function(){return this.collection.size}},{key:"removeFromEvery",value:function(r){this.collection.forEach(function(n){n.remove(r)})}},{key:"insertToEvery",value:function(r,n){this.collection.forEach(function(i){i.insert(r,n)})}},{key:"initEvery",value:function(r){this.collection.forEach(function(n){n.init(r)})}}]),e}();li(L3,Va);function Rv(e){"@babel/helpers - typeof";return Rv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rv(e)}function k6e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Gq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,A6e(n.key),n)}}function P6e(e,t,r){return t&&Gq(e.prototype,t),r&&Gq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function A6e(e){var t=I6e(e,"string");return Rv(t)==="symbol"?t:String(t)}function I6e(e,t){if(Rv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Rv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function M6e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&kB(e,t)}function kB(e,t){return kB=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},kB(e,t)}function D6e(e){var t=N6e();return function(){var n=oP(e),i;if(t){var o=oP(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return $6e(this,i)}}function $6e(e,t){if(t&&(Rv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return L6e(e)}function L6e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function N6e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function oP(e){return oP=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},oP(e)}var Yq=function(e){M6e(r,e);var t=D6e(r);function r(n,i){var o;return k6e(this,r),o=t.call(this),o.mergedValuesCache=[],o.aggregationFunction=n,o.fallbackValue=i,o}return P6e(r,[{key:"getMergedValues",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(i===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];for(var o=hn(this.get(),function(S){return S.getValues()}),s=[],a=dr(o[0])&&o[0].length||0,h=0;h<a;h+=1){for(var p=[],g=0;g<this.getLength();g+=1)p.push(o[g][h]);s.push(p)}return hn(s,this.aggregationFunction)}},{key:"getMergedValueAtIndex",value:function(i,o){var s=this.getMergedValues(o)[i];return dr(s)?s:this.fallbackValue}},{key:"updateCache",value:function(){this.mergedValuesCache=this.getMergedValues(!1)}}]),r}(L3);function f1(e){"@babel/helpers - typeof";return f1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},f1(e)}function B6e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Kq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,z6e(n.key),n)}}function j6e(e,t,r){return t&&Kq(e.prototype,t),r&&Kq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function z6e(e){var t=F6e(e,"string");return f1(t)==="symbol"?t:String(t)}function F6e(e,t){if(f1(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(f1(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function H6e(e,t,r){V6e(e,t),t.set(e,r)}function V6e(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function U6e(e,t,r){var n=_se(e,t,"set");return W6e(e,n,r),r}function W6e(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}function G6e(e,t){var r=_se(e,t,"get");return Y6e(e,r)}function _se(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function Y6e(e,t){return t.get?t.get.call(e):t.value}var O$=new WeakMap,bse=function(){function e(){B6e(this,e),H6e(this,O$,{writable:!0,value:[]})}return j6e(e,[{key:"subscribe",value:function(r){return this.addLocalHook("change",r),this._write(G6e(this,O$)),this}},{key:"unsubscribe",value:function(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}},{key:"_write",value:function(r){return r.length>0&&this.runLocalHooks("change",r),this}},{key:"_writeInitialChanges",value:function(r){U6e(this,O$,r)}}]),e}();li(bse,Va);function qq(e,t){for(var r=[],n=0,i=0;n<e.length&&i<t.length;n++,i++)e[n]!==t[i]&&r.push({op:"replace",index:i,oldValue:e[n],newValue:t[i]});for(;n<t.length;n++)r.push({op:"insert",index:n,oldValue:void 0,newValue:t[n]});for(;i<e.length;i++)r.push({op:"remove",index:i,oldValue:e[i],newValue:void 0});return r}function h1(e){"@babel/helpers - typeof";return h1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},h1(e)}function K6e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Xq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,X6e(n.key),n)}}function q6e(e,t,r){return t&&Xq(e.prototype,t),r&&Xq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function X6e(e){var t=Z6e(e,"string");return h1(t)==="symbol"?t:String(t)}function Z6e(e,t){if(h1(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(h1(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Jw(e,t,r){J6e(e,t),t.set(e,r)}function J6e(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xs(e,t){var r=wse(e,t,"get");return Q6e(e,r)}function Q6e(e,t){return t.get?t.get.call(e):t.value}function rO(e,t,r){var n=wse(e,t,"set");return e8e(e,n,r),r}function wse(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function e8e(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var nO=new WeakMap,Qw=new WeakMap,iO=new WeakMap,oO=new WeakMap,aO=new WeakMap,t8e=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.initialIndexValue;K6e(this,e),Jw(this,nO,{writable:!0,value:new Set}),Jw(this,Qw,{writable:!0,value:[]}),Jw(this,iO,{writable:!0,value:[]}),Jw(this,oO,{writable:!0,value:!1}),Jw(this,aO,{writable:!0,value:!1}),rO(this,aO,r??!1)}return q6e(e,[{key:"createObserver",value:function(){var r=this,n=new bse;return xs(this,nO).add(n),n.addLocalHook("unsubscribe",function(){xs(r,nO).delete(n)}),n._writeInitialChanges(qq(xs(this,Qw),xs(this,iO))),n}},{key:"emit",value:function(r){var n=xs(this,iO);(!xs(this,oO)||xs(this,Qw).length!==r.length)&&(r.length===0?r=new Array(n.length).fill(xs(this,aO)):rO(this,Qw,new Array(r.length).fill(xs(this,aO))),xs(this,oO)||(rO(this,oO,!0),n=xs(this,Qw)));var i=qq(n,r);xs(this,nO).forEach(function(o){return o._write(i)}),rO(this,iO,r)}}]),e}();function d1(e){"@babel/helpers - typeof";return d1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},d1(e)}var Zq;function R$(e){return o8e(e)||i8e(e)||n8e(e)||r8e()}function r8e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function n8e(e,t){if(e){if(typeof e=="string")return PB(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return PB(e,t)}}function i8e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function o8e(e){if(Array.isArray(e))return PB(e)}function PB(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function a8e(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function s8e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Jq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,u8e(n.key),n)}}function l8e(e,t,r){return t&&Jq(e.prototype,t),r&&Jq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function u8e(e){var t=c8e(e,"string");return d1(t)==="symbol"?t:String(t)}function c8e(e,t){if(d1(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(d1(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Qq=new Set(["getFirstNotHiddenIndex"]),AB=function(){function e(){var t=this;s8e(this,e),this.indexesSequence=new vse,this.trimmingMapsCollection=new Yq(function(r){return r.some(function(n){return n===!0})},!1),this.hidingMapsCollection=new Yq(function(r){return r.some(function(n){return n===!0})},!1),this.variousMapsCollection=new L3,this.hidingChangesObservable=new t8e({initialIndexValue:!1}),this.notTrimmedIndexesCache=[],this.notHiddenIndexesCache=[],this.isBatched=!1,this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1,this.renderablePhysicalIndexesCache=[],this.fromPhysicalToVisualIndexesCache=new Map,this.fromVisualToRenderableIndexesCache=new Map,this.indexesSequence.addLocalHook("change",function(){t.indexesSequenceChanged=!0,t.updateCache(),t.runLocalHooks("change",t.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",function(r){t.trimmedIndexesChanged=!0,t.updateCache(),t.runLocalHooks("change",r,t.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",function(r){t.hiddenIndexesChanged=!0,t.updateCache(),t.runLocalHooks("change",r,t.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",function(r){t.runLocalHooks("change",r,t.variousMapsCollection)})}return l8e(e,[{key:"suspendOperations",value:function(){this.isBatched=!0}},{key:"resumeOperations",value:function(){this.isBatched=!1,this.updateCache()}},{key:"createChangesObserver",value:function(r){if(r!=="hiding")throw new Error('Unsupported index map type "'.concat(r,'".'));return this.hidingChangesObservable.createObserver()}},{key:"createAndRegisterIndexMap",value:function(r,n,i){return this.registerMap(r,C6e(n,i))}},{key:"registerMap",value:function(r,n){if(this.trimmingMapsCollection.get(r)||this.hidingMapsCollection.get(r)||this.variousMapsCollection.get(r))throw Error('Map with name "'.concat(r,'" has been already registered.'));n instanceof vC?this.trimmingMapsCollection.register(r,n):n instanceof $A?this.hidingMapsCollection.register(r,n):this.variousMapsCollection.register(r,n);var i=this.getNumberOfIndexes();return i>0&&n.init(i),n}},{key:"unregisterMap",value:function(r){this.trimmingMapsCollection.unregister(r),this.hidingMapsCollection.unregister(r),this.variousMapsCollection.unregister(r)}},{key:"unregisterAll",value:function(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}},{key:"getPhysicalFromVisualIndex",value:function(r){var n=this.notTrimmedIndexesCache[r];return dr(n)?n:null}},{key:"getPhysicalFromRenderableIndex",value:function(r){var n=this.renderablePhysicalIndexesCache[r];return dr(n)?n:null}},{key:"getVisualFromPhysicalIndex",value:function(r){var n=this.fromPhysicalToVisualIndexesCache.get(r);return dr(n)?n:null}},{key:"getVisualFromRenderableIndex",value:function(r){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(r))}},{key:"getRenderableFromVisualIndex",value:function(r){var n=this.fromVisualToRenderableIndexesCache.get(r);return dr(n)?n:null}},{key:"getFirstNotHiddenIndex",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:r-n;Qq.has("getFirstNotHiddenIndex")&&(Qq.delete("getFirstNotHiddenIndex"),ti(Xn(Zq||(Zq=a8e([`The method "getFirstNotHiddenIndex" is deprecated and will be removed in the next 
                        major release. Please use "getNearestNotHiddenIndex" instead.`],[`The method "getFirstNotHiddenIndex" is deprecated and will be removed in the next\\x20
                        major release. Please use "getNearestNotHiddenIndex" instead.`])))));var s=this.getPhysicalFromVisualIndex(r);return s===null?i===!0&&o!==r-n?this.getFirstNotHiddenIndex(o,-n,!1,o):null:this.isHidden(s)===!1?r:this.getFirstNotHiddenIndex(r+n,n,i,o)}},{key:"getNearestNotHiddenIndex",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=this.getPhysicalFromVisualIndex(r);if(o===null)return null;if(this.fromVisualToRenderableIndexesCache.has(r))return r;var s=Array.from(this.fromVisualToRenderableIndexesCache.keys()),a=-1;return n>0?a=s.findIndex(function(h){return h>r}):a=s.reverse().findIndex(function(h){return h<r}),a===-1?i?this.getNearestNotHiddenIndex(r,-n,!1):null:s[a]}},{key:"initToLength",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=R$(new Array(r).keys()),this.notHiddenIndexesCache=R$(new Array(r).keys()),this.suspendOperations(),this.indexesSequence.init(r),this.trimmingMapsCollection.initEvery(r),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(r),this.variousMapsCollection.initEvery(r),this.resumeOperations(),this.runLocalHooks("init")}},{key:"fitToLength",value:function(r){var n=this.getNumberOfIndexes();if(r<n){var i=R$(Array(this.getNumberOfIndexes()-r).keys()).map(function(o){return o+r});this.removeIndexes(i)}else this.insertIndexes(n,r-n)}},{key:"getIndexesSequence",value:function(){return this.indexesSequence.getValues()}},{key:"setIndexesSequence",value:function(r){this.indexesSequence.setValues(r)}},{key:"getNotTrimmedIndexes",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(n===!0)return this.notTrimmedIndexesCache;var i=this.getIndexesSequence();return i.filter(function(o){return r.isTrimmed(o)===!1})}},{key:"getNotTrimmedIndexesLength",value:function(){return this.getNotTrimmedIndexes().length}},{key:"getNotHiddenIndexes",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(n===!0)return this.notHiddenIndexesCache;var i=this.getIndexesSequence();return i.filter(function(o){return r.isHidden(o)===!1})}},{key:"getNotHiddenIndexesLength",value:function(){return this.getNotHiddenIndexes().length}},{key:"getRenderableIndexes",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(n===!0)return this.renderablePhysicalIndexesCache;var i=this.getNotTrimmedIndexes();return i.filter(function(o){return r.isHidden(o)===!1})}},{key:"getRenderableIndexesLength",value:function(){return this.getRenderableIndexes().length}},{key:"getNumberOfIndexes",value:function(){return this.getIndexesSequence().length}},{key:"moveIndexes",value:function(r,n){var i=this;typeof r=="number"&&(r=[r]);var o=hn(r,function(S){return i.getPhysicalFromVisualIndex(S)}),s=this.getNotTrimmedIndexesLength(),a=r.length,h=u1(this.getIndexesSequence(),o),p=s-a;if(n+a<s){var g=h.filter(function(S){return i.isTrimmed(S)===!1})[n];p=h.indexOf(g)}this.setIndexesSequence(M3(h,p,o))}},{key:"isTrimmed",value:function(r){return this.trimmingMapsCollection.getMergedValueAtIndex(r)}},{key:"isHidden",value:function(r){return this.hidingMapsCollection.getMergedValueAtIndex(r)}},{key:"insertIndexes",value:function(r,n){var i=this.getNotTrimmedIndexes()[r],o=dr(i)?i:this.getNumberOfIndexes(),s=this.getIndexesSequence().includes(i)?this.getIndexesSequence().indexOf(i):this.getNumberOfIndexes(),a=hn(new Array(n).fill(o),function(h,p){return h+p});this.suspendOperations(),this.indexesSequence.insert(s,a),this.trimmingMapsCollection.insertToEvery(s,a),this.hidingMapsCollection.insertToEvery(s,a),this.variousMapsCollection.insertToEvery(s,a),this.resumeOperations()}},{key:"removeIndexes",value:function(r){this.suspendOperations(),this.indexesSequence.remove(r),this.trimmingMapsCollection.removeFromEvery(r),this.hidingMapsCollection.removeFromEvery(r),this.variousMapsCollection.removeFromEvery(r),this.resumeOperations()}},{key:"updateCache",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(r===!0||this.isBatched===!1&&n===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}},{key:"cacheFromPhysicalToVisualIndexes",value:function(){var r=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(var n=0;n<r;n+=1){var i=this.getPhysicalFromVisualIndex(n);this.fromPhysicalToVisualIndexesCache.set(i,n)}}},{key:"cacheFromVisualToRenderableIndexes",value:function(){var r=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(var n=0;n<r;n+=1){var i=this.getPhysicalFromRenderableIndex(n),o=this.getVisualFromPhysicalIndex(i);this.fromVisualToRenderableIndexesCache.set(o,n)}}}]),e}();li(AB,Va);function kv(e){"@babel/helpers - typeof";return kv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kv(e)}function e9(e,t){return p8e(e)||d8e(e,t)||h8e(e,t)||f8e()}function f8e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function h8e(e,t){if(e){if(typeof e=="string")return t9(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return t9(e,t)}}function t9(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function d8e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],h=!0,p=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;h=!1}else for(;!(h=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);h=!0);}catch(g){p=!0,i=g}finally{try{if(!h&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(p)throw i}}return a}}function p8e(e){if(Array.isArray(e))return e}function m8e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r9(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,g8e(n.key),n)}}function y8e(e,t,r){return t&&r9(e.prototype,t),r&&r9(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function g8e(e){var t=v8e(e,"string");return kv(t)==="symbol"?t:String(t)}function v8e(e,t){if(kv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(kv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Gd(){return typeof Reflect<"u"&&Reflect.get?Gd=Reflect.get.bind():Gd=function(t,r,n){var i=_8e(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Gd.apply(this,arguments)}function _8e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ju(e),e!==null););return e}function b8e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&IB(e,t)}function IB(e,t){return IB=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},IB(e,t)}function w8e(e){var t=x8e();return function(){var n=Ju(e),i;if(t){var o=Ju(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return S8e(this,i)}}function S8e(e,t){if(t&&(kv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Sse(e)}function Sse(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function x8e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ju(e){return Ju=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ju(e)}mr.getSingleton().register("modifyAutoColumnSizeSeed");var e0="autoColumnSize",C8e=10,k$=new WeakMap,E8e="autoColumnSize",T8e=function(e){b8e(r,e);var t=w8e(r);function r(n){var i;return m8e(this,r),i=t.call(this,n),k$.set(Sse(i),{cachedColumnHeaders:[]}),i.ghostTable=new Rae(i.hot),i.samplesGenerator=new Aae(function(o,s){var a=i.hot.getCellMeta(o,s),h="";a.spanned||(h=i.hot.getDataAtCell(o,s));var p="";return i.hot.hasHook("modifyAutoColumnSizeSeed")&&(p=i.hot.runHooks("modifyAutoColumnSizeSeed",p,a,h)),{value:h,bundleSeed:p}}),i.firstCalculation=!0,i.inProgress=!1,i.measuredColumns=0,i.columnWidthsMap=new Ch,i.hot.columnIndexMapper.registerMap(E8e,i.columnWidthsMap),i.addHook("beforeColumnResize",function(o,s,a){return i.onBeforeColumnResize(o,s,a)}),i}return y8e(r,[{key:"isEnabled",value:function(){return this.hot.getSettings()[e0]!==!1&&!this.hot.getSettings().colWidths}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){var o=this.hot.getSettings()[e0];o&&o.useHeaders!==null&&o.useHeaders!==void 0&&this.ghostTable.setSetting("useHeaders",o.useHeaders),this.setSamplingOptions(),this.addHook("afterLoadData",function(){return i.onAfterLoadData.apply(i,arguments)}),this.addHook("beforeChangeRender",function(s){return i.onBeforeChange(s)}),this.addHook("afterFormulasValuesUpdate",function(s){return i.onAfterFormulasValuesUpdate(s)}),this.addHook("beforeViewRender",function(s){return i.onBeforeViewRender(s)}),this.addHook("modifyColWidth",function(s,a){return i.getColumnWidth(a,s)}),this.addHook("afterInit",function(){return i.onAfterInit()}),Gd(Ju(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){var i=this.findColumnsWhereHeaderWasChanged();i.length&&(this.clearCache(i),this.calculateVisibleColumnsWidth()),Gd(Ju(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var i=this;Gd(Ju(r.prototype),"disablePlugin",this).call(this),this.addHook("beforeColumnResize",function(o,s,a){return i.onBeforeColumnResize(o,s,a)})}},{key:"calculateVisibleColumnsWidth",value:function(){var i=this.hot.countRows();if(i){var o=this.hot.renderCall,s=this.getFirstVisibleColumn(),a=this.getLastVisibleColumn();s===-1||a===-1||this.calculateColumnsWidth({from:s,to:a},void 0,o)}}},{key:"calculateColumnsWidth",value:function(){var i=this,o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,h=typeof o=="number"?{from:o,to:o}:o,p=typeof s=="number"?{from:s,to:s}:s;Er(h.from,h.to,function(g){var S=i.hot.toPhysicalColumn(g);if(S===null&&(S=g),a||i.columnWidthsMap.getValueAtIndex(S)===null&&!i.hot._getColWidthFromSettings(S)){var T=i.samplesGenerator.generateColumnSamples(g,p);Le(T,function(R){var A=e9(R,2),$=A[0],j=A[1];return i.ghostTable.addColumn($,j)})}}),this.ghostTable.columns.length&&(this.hot.batchExecution(function(){i.ghostTable.getWidths(function(g,S){var T=i.hot.toPhysicalColumn(g);i.columnWidthsMap.setValueAtIndex(T,S)})},!0),this.measuredColumns=h.to+1,this.ghostTable.clean())}},{key:"calculateAllColumnsWidth",value:function(){var i=this,o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},s=0,a=this.hot.countCols()-1,h=null;this.inProgress=!0;var p=function S(){if(!i.hot){wk(h),i.inProgress=!1;return}i.calculateColumnsWidth({from:s,to:Math.min(s+r.CALCULATION_STEP,a)},o),s=s+r.CALCULATION_STEP+1,s<a?h=e3(S):(wk(h),i.inProgress=!1,i.hot.view.adjustElementsSize())},g=this.getSyncCalculationLimit();this.firstCalculation&&g>=0&&(this.calculateColumnsWidth({from:0,to:g},o),this.firstCalculation=!1,s=g+1),s<a?p():this.inProgress=!1}},{key:"setSamplingOptions",value:function(){var i=this.hot.getSettings()[e0],o=i&&Ui(i,"samplingRatio")?i.samplingRatio:void 0,s=i&&Ui(i,"allowSampleDuplicates")?i.allowSampleDuplicates:void 0;o&&!isNaN(o)&&this.samplesGenerator.setSampleCount(parseInt(o,10)),s&&this.samplesGenerator.setAllowDuplicates(s)}},{key:"recalculateAllColumnsWidth",value:function(){this.hot.view&&this.hot.view._wt.wtTable.isVisible()&&(this.clearCache(),this.calculateAllColumnsWidth())}},{key:"getSyncCalculationLimit",value:function(){var i=this.hot.getSettings()[e0],o=r.SYNC_CALCULATION_LIMIT,s=this.hot.countCols()-1;return dn(i)&&(o=i.syncLimit,Uoe(o)?o=aae(s,o):o>>=0),Math.min(o,s)}},{key:"getColumnWidth",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,a=o;return a===void 0&&(a=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(i)),s&&typeof a=="number"&&(a=Math.max(a,b3.DEFAULT_WIDTH))),a}},{key:"getFirstVisibleColumn",value:function(){var i=this.hot.view._wt;if(i.wtViewport.columnsVisibleCalculator){var o=i.wtTable.getFirstVisibleColumn();if(o!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(o)}if(i.wtViewport.columnsRenderCalculator){var s=i.wtTable.getFirstRenderedColumn();if(s!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(s)}return-1}},{key:"getLastVisibleColumn",value:function(){var i=this.hot.view._wt;if(i.wtViewport.columnsVisibleCalculator){var o=i.wtTable.getLastVisibleColumn();if(o!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(o)}if(i.wtViewport.columnsRenderCalculator){var s=i.wtTable.getLastRenderedColumn();if(s!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(s)}return-1}},{key:"findColumnsWhereHeaderWasChanged",value:function(){var i=this.hot.getColHeader(),o=k$.get(this),s=o.cachedColumnHeaders,a=na(i,function(h,p,g){var S=s.length;return(S-1<g||s[g]!==p)&&h.push(g),S-1<g?s.push(p):s[g]=p,h},[]);return a}},{key:"clearCache",value:function(){var i=this,o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];o.length?this.hot.batchExecution(function(){Le(o,function(s){i.columnWidthsMap.setValueAtIndex(s,null)})},!0):this.columnWidthsMap.clear()}},{key:"isNeedRecalculate",value:function(){return!!$s(this.columnWidthsMap.getValues().slice(0,this.measuredColumns),function(i){return i===null}).length}},{key:"onBeforeViewRender",value:function(){this.calculateVisibleColumnsWidth(),this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllColumnsWidth()}},{key:"onAfterLoadData",value:function(){var i=this;this.hot.view?this.recalculateAllColumnsWidth():setTimeout(function(){i.hot&&i.recalculateAllColumnsWidth()},0)}},{key:"onBeforeChange",value:function(i){var o=this,s=hn(i,function(a){var h=e9(a,2),p=h[1];return o.hot.toPhysicalColumn(o.hot.propToCol(p))});this.clearCache(Array.from(new Set(s)))}},{key:"onBeforeColumnResize",value:function(i,o,s){var a=i;return s&&(this.calculateColumnsWidth(o,void 0,!0),a=this.getColumnWidth(o,void 0,!1)),a}},{key:"onAfterInit",value:function(){k$.get(this).cachedColumnHeaders=this.hot.getColHeader()}},{key:"onAfterFormulasValuesUpdate",value:function(i){var o=$s(i,function(a){var h;return dr((h=a.address)===null||h===void 0?void 0:h.col)}),s=hn(o,function(a){return a.address.col});this.clearCache(Array.from(new Set(s)))}},{key:"destroy",value:function(){this.ghostTable.clean(),Gd(Ju(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return e0}},{key:"PLUGIN_PRIORITY",get:function(){return C8e}},{key:"SETTING_KEYS",get:function(){return!0}},{key:"CALCULATION_STEP",get:function(){return 50}},{key:"SYNC_CALCULATION_LIMIT",get:function(){return 50}}]),r}(Wn),Yd={horizontal:"horizontal",vertical:"vertical"};function O8e(e,t,r,n){var i=r.length,o=r?r[0].length:0,s=[],a=t.row-e.row,h=t.col-e.col;if(["down","up"].indexOf(n)!==-1){for(var p=[],g=0;g<h;g++){var S=parseInt(r[0][g],10),T=parseInt(r[i-1][g],10),R=(n==="down"?T-S:S-T)/(i-1)||0;p.push(R)}s.push(p)}if(["right","left"].indexOf(n)!==-1)for(var A=0;A<a;A++){var $=parseInt(r[A][0],10),j=parseInt(r[A][o-1],10),z=(n==="right"?j-$:$-j)/(o-1)||0;s.push([z])}return s}function R8e(e,t,r){var n,i,o;return t[0]===e[0]&&t[1]<e[1]?(o="left",n=r(t[0],t[1]),i=r(t[2],e[1]-1)):t[2]===e[2]&&t[0]===e[0]&&t[3]>e[3]?(o="right",n=r(t[0],e[3]+1),i=r(t[2],t[3])):t[0]<e[0]&&t[1]===e[1]?(o="up",n=r(t[0],t[1]),i=r(e[0]-1,t[3])):t[2]>e[2]&&t[1]===e[1]&&(o="down",n=r(e[2]+1,t[1]),i=r(t[2],t[3])),n&&n.normalize(),i&&i.normalize(),{directionOfDrag:o,startOfDragCoords:n,endOfDragCoords:i}}function k8e(e){var t={};return e===!0?(t.directions=Object.keys(Yd),t.autoInsertRow=!0):dn(e)?(dr(e.autoInsertRow)?e.direction===Yd.horizontal?t.autoInsertRow=!1:t.autoInsertRow=e.autoInsertRow:t.autoInsertRow=!1,dr(e.direction)?t.directions=[e.direction]:t.directions=Object.keys(Yd)):typeof e=="string"?(t.directions=[e],t.autoInsertRow=!0):(t.directions=[],t.autoInsertRow=!1),t}function Pv(e){"@babel/helpers - typeof";return Pv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pv(e)}function P8e(e){return M8e(e)||I8e(e)||xse(e)||A8e()}function A8e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function I8e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function M8e(e){if(Array.isArray(e))return MB(e)}function D8e(e,t){return N8e(e)||L8e(e,t)||xse(e,t)||$8e()}function $8e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function xse(e,t){if(e){if(typeof e=="string")return MB(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return MB(e,t)}}function MB(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function L8e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],h=!0,p=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;h=!1}else for(;!(h=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);h=!0);}catch(g){p=!0,i=g}finally{try{if(!h&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(p)throw i}}return a}}function N8e(e){if(Array.isArray(e))return e}function B8e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n9(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,z8e(n.key),n)}}function j8e(e,t,r){return t&&n9(e.prototype,t),r&&n9(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function z8e(e){var t=F8e(e,"string");return Pv(t)==="symbol"?t:String(t)}function F8e(e,t){if(Pv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Pv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Kd(){return typeof Reflect<"u"&&Reflect.get?Kd=Reflect.get.bind():Kd=function(t,r,n){var i=H8e(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Kd.apply(this,arguments)}function H8e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Qu(e),e!==null););return e}function V8e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&DB(e,t)}function DB(e,t){return DB=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},DB(e,t)}function U8e(e){var t=G8e();return function(){var n=Qu(e),i;if(t){var o=Qu(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return W8e(this,i)}}function W8e(e,t){if(t&&(Pv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Cse(e)}function Cse(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function G8e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Qu(e){return Qu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Qu(e)}mr.getSingleton().register("modifyAutofillRange");mr.getSingleton().register("beforeAutofill");mr.getSingleton().register("afterAutofill");var i9="autofill",Y8e=20,K8e=["fillHandle"],q8e="insert_row_below",X8e=200,Z8e=function(e){V8e(r,e);var t=U8e(r);function r(n){var i;return B8e(this,r),i=t.call(this,n),i.eventManager=new Bi(Cse(i)),i.addingStarted=!1,i.mouseDownOnCellCorner=!1,i.mouseDragOutside=!1,i.handleDraggedCells=0,i.directions=[],i.autoInsertRow=!1,i}return j8e(r,[{key:"isEnabled",value:function(){return this.hot.getSettings().fillHandle}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",function(o){return i.onAfterCellCornerMouseDown(o)}),this.addHook("afterOnCellCornerDblClick",function(o){return i.onCellCornerDblClick(o)}),this.addHook("beforeOnCellMouseOver",function(o,s){return i.onBeforeCellMouseOver(s)}),Kd(Qu(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Kd(Qu(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.clearMappedSettings(),Kd(Qu(r.prototype),"disablePlugin",this).call(this)}},{key:"getSelectionData",value:function(){var i=this,o=this.hot.getSelectedRangeLast(),s=o.getTopStartCorner(),a=s.row,h=s.col,p=o.getBottomEndCorner(),g=p.row,S=p.col,T=this.hot.runHooks("modifyCopyableRange",[{startRow:a,startCol:h,endRow:g,endCol:S}]),R=[],A=[],$=[];return Le(T,function(j){for(var z=j.startRow;z<=j.endRow;z+=1)R.indexOf(z)===-1&&R.push(z);for(var V=j.startCol;V<=j.endCol;V+=1)A.indexOf(V)===-1&&A.push(V)}),Le(R,function(j){var z=[];Le(A,function(V){z.push(i.hot.getCopyableData(j,V))}),$.push(z)}),$}},{key:"fillIn",value:function(){var i=this;if(this.hot.selection.highlight.getFill().isEmpty())return!1;var o=this.hot.selection.highlight.getFill().getVisualCorners(),s=D8e(o,4),a=s[0],h=s[1],p=s[2],g=s[3],S=this.hot.getSelectedRangeLast(),T=S.getTopStartCorner(),R=S.getBottomEndCorner();this.resetSelectionOfDraggedArea();var A=[T.row,T.col,R.row,R.col],$=this.hot.runHooks("modifyAutofillRange",[Math.min(T.row,a),Math.min(T.col,h),Math.max(R.row,p),Math.max(R.col,g)],A),j=R8e(A,$,function(ae,D){return i.hot._createCellCoords(ae,D)}),z=j.directionOfDrag,V=j.startOfDragCoords,G=j.endOfDragCoords;if(V&&V.row>-1&&V.col>-1){var ee=this.getSelectionData(),K=S.clone(),xe=this.hot._createCellRange(V,V,G),Me=this.hot.runHooks("beforeAutofill",ee,K,xe,z);if(Me===!1)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;var He=O8e(V,G,ee,z),Ne=Me,We=Me;if(["up","left"].indexOf(z)>-1&&!(We.length===1&&We[0].length===0))if(Ne=[],z==="up")for(var gt=G.row-V.row+1,Lt=gt%We.length,_t=0;_t<gt;_t++)Ne.push(We[(_t+(We.length-Lt))%We.length]);else for(var $e=G.col-V.col+1,Fe=$e%We[0].length,At=0;At<We.length;At++){Ne.push([]);for(var Gt=0;Gt<$e;Gt++)Ne[At].push(We[At][(Gt+(We[At].length-Fe))%We[At].length])}this.hot.populateFromArray(V.row,V.col,Ne,G.row,G.col,"".concat(this.pluginName,".fill"),null,z,He),this.setSelection($),this.hot.runHooks("afterAutofill",Ne,K,xe,z),this.hot.render()}else this.hot._refreshBorders();return!0}},{key:"reduceSelectionAreaIfNeeded",value:function(i){return i.row<0&&(i.row=0),i.col<0&&(i.col=0),i}},{key:"getCoordsOfDragAndDropBorders",value:function(i){var o=this.hot.getSelectedRangeLast(),s=o.getBottomEndCorner(),a=i;if(this.directions.includes(Yd.vertical)&&this.directions.includes(Yd.horizontal)){var h=o.getTopStartCorner();(s.col<=i.col||h.col>=i.col)&&(a=this.hot._createCellCoords(s.row,i.col)),(s.row<i.row||h.row>i.row)&&(a=this.hot._createCellCoords(i.row,s.col))}else if(this.directions.includes(Yd.vertical))a=this.hot._createCellCoords(i.row,s.col);else if(this.directions.includes(Yd.horizontal))a=this.hot._createCellCoords(s.row,i.col);else return;return this.reduceSelectionAreaIfNeeded(a)}},{key:"showBorder",value:function(i){var o=this.getCoordsOfDragAndDropBorders(i);o&&this.redrawBorders(o)}},{key:"addRow",value:function(){var i=this;this.hot._registerTimeout(function(){i.hot.alter(q8e,void 0,1,"".concat(i.pluginName,".fill")),i.addingStarted=!1},X8e)}},{key:"addNewRowIfNeeded",value:function(){if(!this.hot.selection.highlight.getFill().isEmpty()&&this.addingStarted===!1&&this.autoInsertRow){var i=this.hot.getSelectedLast(),o=this.hot.selection.highlight.getFill().getVisualCorners(),s=this.hot.countRows();i[2]<s-1&&o[2]===s-1&&(this.addingStarted=!0,this.addRow())}}},{key:"getIndexOfLastAdjacentFilledInRow",value:function(i){for(var o=this.hot.getData(),s=this.hot.countRows(),a,h=i[2]+1;h<s;h++){for(var p=i[1];p<=i[3];p++){var g=o[h][p];if(g)return-1}var S=o[h][i[1]-1],T=o[h][i[3]+1];(S||T)&&(a=h)}return a}},{key:"addSelectionFromStartAreaToSpecificRowIndex",value:function(i,o){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(i[0],i[1])).add(this.hot._createCellCoords(o,i[3])).commit()}},{key:"setSelection",value:function(i){var o;(o=this.hot).selectCell.apply(o,P8e(hn(i,function(s){return Math.max(s,0)})).concat([!1,!1]))}},{key:"selectAdjacent",value:function(){var i=this.hot.getSelectedLast(),o=this.getIndexOfLastAdjacentFilledInRow(i);return o===-1||o===void 0?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(i,o),!0)}},{key:"resetSelectionOfDraggedArea",value:function(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}},{key:"redrawBorders",value:function(i){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(i).commit(),this.hot.view.render()}},{key:"getIfMouseWasDraggedOutside",value:function(i){var o=this.hot.rootDocument.documentElement,s=io(this.hot.table).top-(this.hot.rootWindow.pageYOffset||o.scrollTop)+$i(this.hot.table),a=io(this.hot.table).left-(this.hot.rootWindow.pageXOffset||o.scrollLeft)+ri(this.hot.table);return i.clientY>s&&i.clientX<=a}},{key:"registerEvents",value:function(){var i=this,o=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(o,"mouseup",function(){return i.onMouseUp()}),this.eventManager.addEventListener(o,"mousemove",function(s){return i.onMouseMove(s)})}},{key:"onCellCornerDblClick",value:function(){var i=this.selectAdjacent();i&&this.fillIn()}},{key:"onAfterCellCornerMouseDown",value:function(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}},{key:"onBeforeCellMouseOver",value:function(i){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(i),this.addNewRowIfNeeded())}},{key:"onMouseUp",value:function(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}},{key:"onMouseMove",value:function(i){var o=this.getIfMouseWasDraggedOutside(i);this.addingStarted===!1&&this.handleDraggedCells>0&&o?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}},{key:"clearMappedSettings",value:function(){this.directions.length=0,this.autoInsertRow=!1}},{key:"mapSettings",value:function(){var i=k8e(this.hot.getSettings().fillHandle);this.directions=i.directions,this.autoInsertRow=i.autoInsertRow}},{key:"destroy",value:function(){Kd(Qu(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return i9}},{key:"PLUGIN_PRIORITY",get:function(){return Y8e}},{key:"SETTING_KEYS",get:function(){return[i9].concat(K8e)}}]),r}(Wn);function Av(e){"@babel/helpers - typeof";return Av=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Av(e)}function J8e(e,t){return rYe(e)||tYe(e,t)||eYe(e,t)||Q8e()}function Q8e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function eYe(e,t){if(e){if(typeof e=="string")return o9(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return o9(e,t)}}function o9(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function tYe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],h=!0,p=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;h=!1}else for(;!(h=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);h=!0);}catch(g){p=!0,i=g}finally{try{if(!h&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(p)throw i}}return a}}function rYe(e){if(Array.isArray(e))return e}function nYe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a9(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,oYe(n.key),n)}}function iYe(e,t,r){return t&&a9(e.prototype,t),r&&a9(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function oYe(e){var t=aYe(e,"string");return Av(t)==="symbol"?t:String(t)}function aYe(e,t){if(Av(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Av(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function wg(){return typeof Reflect<"u"&&Reflect.get?wg=Reflect.get.bind():wg=function(t,r,n){var i=sYe(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},wg.apply(this,arguments)}function sYe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=nh(e),e!==null););return e}function lYe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&$B(e,t)}function $B(e,t){return $B=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},$B(e,t)}function uYe(e){var t=hYe();return function(){var n=nh(e),i;if(t){var o=nh(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return cYe(this,i)}}function cYe(e,t){if(t&&(Av(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return fYe(e)}function fYe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function hYe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function nh(e){return nh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},nh(e)}var sO="autoRowSize",dYe=40,pYe="autoRowSize",mYe=function(e){lYe(r,e);var t=uYe(r);function r(n){var i;return nYe(this,r),i=t.call(this,n),i.rowHeightsMap=void 0,i.headerHeight=null,i.ghostTable=new Rae(i.hot),i.samplesGenerator=new Aae(function(o,s){var a;return o>=0?a=i.hot.getDataAtCell(o,s):o===-1&&(a=i.hot.getColHeader(s)),{value:a}}),i.firstCalculation=!0,i.inProgress=!1,i.measuredRows=0,i.rowHeightsMap=new Ch,i.hot.rowIndexMapper.registerMap(pYe,i.rowHeightsMap),i.addHook("beforeRowResize",function(o,s,a){return i.onBeforeRowResize(o,s,a)}),i}return iYe(r,[{key:"isEnabled",value:function(){var i=this.hot.getSettings()[sO];return i===!0||dn(i)}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.setSamplingOptions(),this.addHook("afterLoadData",function(){return i.onAfterLoadData.apply(i,arguments)}),this.addHook("beforeChangeRender",function(o){return i.onBeforeChange(o)}),this.addHook("beforeColumnResize",function(){return i.recalculateAllRowsHeight()}),this.addHook("beforeViewRender",function(o){return i.onBeforeViewRender(o)}),this.addHook("modifyRowHeight",function(o,s){return i.getRowHeight(s,o)}),this.addHook("modifyColumnHeaderHeight",function(){return i.getColumnHeaderHeight()}),wg(nh(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var i=this;this.headerHeight=null,wg(nh(r.prototype),"disablePlugin",this).call(this),this.addHook("beforeRowResize",function(o,s,a){return i.onBeforeRowResize(o,s,a)})}},{key:"calculateRowsHeight",value:function(){var i=this,o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,h=typeof o=="number"?{from:o,to:o}:o,p=typeof s=="number"?{from:s,to:s}:s;if(this.hot.getColHeader(0)!==null){var g=this.samplesGenerator.generateRowSamples(-1,p);this.ghostTable.addColumnHeadersRow(g.get(-1))}Er(h.from,h.to,function(S){if(a||i.rowHeightsMap.getValueAtIndex(S)===null){var T=i.samplesGenerator.generateRowSamples(S,p);Le(T,function(R){var A=J8e(R,2),$=A[0],j=A[1];return i.ghostTable.addRow($,j)})}}),this.ghostTable.rows.length&&(this.hot.batchExecution(function(){i.ghostTable.getHeights(function(S,T){S<0?i.headerHeight=T:i.rowHeightsMap.setValueAtIndex(i.hot.toPhysicalRow(S),T)})},!0),this.measuredRows=h.to+1,this.ghostTable.clean())}},{key:"calculateAllRowsHeight",value:function(){var i=this,o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},s=0,a=this.hot.countRows()-1,h=null;this.inProgress=!0;var p=function S(){if(!i.hot){wk(h),i.inProgress=!1;return}i.calculateRowsHeight({from:s,to:Math.min(s+r.CALCULATION_STEP,a)},o),s=s+r.CALCULATION_STEP+1,s<a?h=e3(S):(wk(h),i.inProgress=!1,i.hot.view.adjustElementsSize(!0),i.hot.view._wt.wtOverlays.inlineStartOverlay.needFullRender&&i.hot.view._wt.wtOverlays.inlineStartOverlay.clone.draw())},g=this.getSyncCalculationLimit();this.firstCalculation&&g>=0&&(this.calculateRowsHeight({from:0,to:g},o),this.firstCalculation=!1,s=g+1),s<a?p():(this.inProgress=!1,this.hot.view.adjustElementsSize(!1))}},{key:"setSamplingOptions",value:function(){var i=this.hot.getSettings()[sO],o=i&&Ui(i,"samplingRatio")?i.samplingRatio:void 0,s=i&&Ui(i,"allowSampleDuplicates")?i.allowSampleDuplicates:void 0;o&&!isNaN(o)&&this.samplesGenerator.setSampleCount(parseInt(o,10)),s&&this.samplesGenerator.setAllowDuplicates(s)}},{key:"recalculateAllRowsHeight",value:function(){OS(this.hot.view._wt.wtTable.TABLE)&&(this.clearCache(),this.calculateAllRowsHeight())}},{key:"getSyncCalculationLimit",value:function(){var i=this.hot.getSettings()[sO],o=r.SYNC_CALCULATION_LIMIT,s=this.hot.countRows()-1;return dn(i)&&(o=i.syncLimit,Uoe(o)?o=aae(s,o):o>>=0),Math.min(o,s)}},{key:"getRowHeight",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,s=i<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(i)),a=o;return s!==null&&s>(o||0)&&(a=s),a}},{key:"getColumnHeaderHeight",value:function(){return this.headerHeight}},{key:"getFirstVisibleRow",value:function(){var i=this.hot.view._wt;return i.wtViewport.rowsVisibleCalculator?i.wtTable.getFirstVisibleRow():i.wtViewport.rowsRenderCalculator?i.wtTable.getFirstRenderedRow():-1}},{key:"getLastVisibleRow",value:function(){var i=this.hot.view._wt;return i.wtViewport.rowsVisibleCalculator?i.wtTable.getLastVisibleRow():i.wtViewport.rowsRenderCalculator?i.wtTable.getLastRenderedRow():-1}},{key:"clearCache",value:function(){this.headerHeight=null,this.rowHeightsMap.init()}},{key:"clearCacheByRange",value:function(i){var o=this,s=typeof i=="number"?{from:i,to:i}:i,a=s.from,h=s.to;this.hot.batchExecution(function(){Er(Math.min(a,h),Math.max(a,h),function(p){o.rowHeightsMap.setValueAtIndex(p,null)})},!0)}},{key:"isNeedRecalculate",value:function(){return!!$s(this.rowHeightsMap.getValues().slice(0,this.measuredRows),function(i){return i===null}).length}},{key:"onBeforeViewRender",value:function(){var i=this.hot.renderCall,o=this.hot.getSettings().fixedRowsBottom,s=this.getFirstVisibleRow(),a=this.getLastVisibleRow();if(!(s===-1||a===-1)){if(this.calculateRowsHeight({from:s,to:a},void 0,i),o){var h=this.hot.countRows()-1;this.calculateRowsHeight({from:h-o,to:h})}this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllRowsHeight()}}},{key:"onBeforeRowMove",value:function(i,o){this.clearCacheByRange({from:i,to:o}),this.calculateAllRowsHeight()}},{key:"onBeforeRowResize",value:function(i,o,s){var a=i;return s&&(this.calculateRowsHeight(o,void 0,!0),a=this.getRowHeight(o)),a}},{key:"onAfterLoadData",value:function(){var i=this;this.hot.view?this.recalculateAllRowsHeight():setTimeout(function(){i.hot&&i.recalculateAllRowsHeight()},0)}},{key:"onBeforeChange",value:function(i){var o=null;i.length===1?o=i[0][0]:i.length>1&&(o={from:i[0][0],to:i[i.length-1][0]}),o!==null&&this.clearCacheByRange(o)}},{key:"destroy",value:function(){this.ghostTable.clean(),wg(nh(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return sO}},{key:"PLUGIN_PRIORITY",get:function(){return dYe}},{key:"SETTING_KEYS",get:function(){return!0}},{key:"CALCULATION_STEP",get:function(){return 50}},{key:"SYNC_CALCULATION_LIMIT",get:function(){return 500}}]),r}(Wn);function Iv(e){"@babel/helpers - typeof";return Iv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Iv(e)}function yYe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s9(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,vYe(n.key),n)}}function gYe(e,t,r){return t&&s9(e.prototype,t),r&&s9(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function vYe(e){var t=_Ye(e,"string");return Iv(t)==="symbol"?t:String(t)}function _Ye(e,t){if(Iv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Iv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function G0(){return typeof Reflect<"u"&&Reflect.get?G0=Reflect.get.bind():G0=function(t,r,n){var i=bYe(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},G0.apply(this,arguments)}function bYe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=zp(e),e!==null););return e}function wYe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&LB(e,t)}function LB(e,t){return LB=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},LB(e,t)}function SYe(e){var t=EYe();return function(){var n=zp(e),i;if(t){var o=zp(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return xYe(this,i)}}function xYe(e,t){if(t&&(Iv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return CYe(e)}function CYe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function EYe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function zp(e){return zp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},zp(e)}var Ese=gse("physicallyIndexed"),TYe=Ese.getListWithInsertedItems,OYe=Ese.getListWithRemovedItems,RYe=function(e){wYe(r,e);var t=SYe(r);function r(){return yYe(this,r),t.call(this,function(n){return n})}return gYe(r,[{key:"insert",value:function(i,o){var s=$3(this.indexedValues,o);this.indexedValues=TYe(s,i,o,this.initValueOrFn),G0(zp(r.prototype),"insert",this).call(this,i,o)}},{key:"remove",value:function(i){var o=OYe(this.indexedValues,i);this.indexedValues=D3(o,i),G0(zp(r.prototype),"remove",this).call(this,i)}}]),r}(im);const kYe=RYe;function Mv(e){"@babel/helpers - typeof";return Mv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mv(e)}function PYe(e){return DYe(e)||MYe(e)||IYe(e)||AYe()}function AYe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function IYe(e,t){if(e){if(typeof e=="string")return NB(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return NB(e,t)}}function MYe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function DYe(e){if(Array.isArray(e))return NB(e)}function NB(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function $Ye(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l9(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,NYe(n.key),n)}}function LYe(e,t,r){return t&&l9(e.prototype,t),r&&l9(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function NYe(e){var t=BYe(e,"string");return Mv(t)==="symbol"?t:String(t)}function BYe(e,t){if(Mv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Mv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Y0(){return typeof Reflect<"u"&&Reflect.get?Y0=Reflect.get.bind():Y0=function(t,r,n){var i=jYe(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Y0.apply(this,arguments)}function jYe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Fp(e),e!==null););return e}function zYe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&BB(e,t)}function BB(e,t){return BB=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},BB(e,t)}function FYe(e){var t=UYe();return function(){var n=Fp(e),i;if(t){var o=Fp(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return HYe(this,i)}}function HYe(e,t){if(t&&(Mv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return VYe(e)}function VYe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function UYe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Fp(e){return Fp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Fp(e)}var Tse=gse("physicallyIndexed"),WYe=Tse.getListWithInsertedItems,GYe=Tse.getListWithRemovedItems,YYe=function(e){zYe(r,e);var t=FYe(r);function r(){return $Ye(this,r),t.call(this,function(n){return n})}return LYe(r,[{key:"insert",value:function(i,o){var s=this;this.indexedValues=WYe(this.indexedValues,i,o,function(a,h){return s.getNextValue(h)}),Y0(Fp(r.prototype),"insert",this).call(this,i,o)}},{key:"remove",value:function(i){this.indexedValues=GYe(this.indexedValues,i),Y0(Fp(r.prototype),"remove",this).call(this,i)}},{key:"getNextValue",value:function(i){return Math.max.apply(Math,PYe(this.getValues()))+1+i}}]),r}(im);const KYe=YYe;function Dv(e){"@babel/helpers - typeof";return Dv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dv(e)}function qYe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u9(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ZYe(n.key),n)}}function XYe(e,t,r){return t&&u9(e.prototype,t),r&&u9(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ZYe(e){var t=JYe(e,"string");return Dv(t)==="symbol"?t:String(t)}function JYe(e,t){if(Dv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Dv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Sg(){return typeof Reflect<"u"&&Reflect.get?Sg=Reflect.get.bind():Sg=function(t,r,n){var i=QYe(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Sg.apply(this,arguments)}function QYe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=ih(e),e!==null););return e}function eKe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&jB(e,t)}function jB(e,t){return jB=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},jB(e,t)}function tKe(e){var t=iKe();return function(){var n=ih(e),i;if(t){var o=ih(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return rKe(this,i)}}function rKe(e,t){if(t&&(Dv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return nKe(e)}function nKe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function iKe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ih(e){return ih=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ih(e)}var P$="bindRowsWithHeaders",oKe=210,aKe="loose",sKe=new Map([["loose",kYe],["strict",KYe]]),lKe=function(e){eKe(r,e);var t=tKe(r);function r(n){var i;return qYe(this,r),i=t.call(this,n),i.headerIndexes=null,i}return XYe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[P$]}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){var o=this.hot.getSettings()[P$];typeof o!="string"&&(o=aKe);var s=sKe.get(o);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new s),this.addHook("modifyRowHeader",function(a){return i.onModifyRowHeader(a)}),Sg(ih(r.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),Sg(ih(r.prototype),"disablePlugin",this).call(this)}},{key:"onModifyRowHeader",value:function(i){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(i))}},{key:"destroy",value:function(){Sg(ih(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return P$}},{key:"PLUGIN_PRIORITY",get:function(){return oKe}}]),r}(Wn);function $v(e){"@babel/helpers - typeof";return $v=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$v(e)}function c9(e){return hKe(e)||fKe(e)||cKe(e)||uKe()}function uKe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function cKe(e,t){if(e){if(typeof e=="string")return zB(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return zB(e,t)}}function fKe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function hKe(e){if(Array.isArray(e))return zB(e)}function zB(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function dKe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f9(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ose(n.key),n)}}function pKe(e,t,r){return t&&f9(e.prototype,t),r&&f9(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function qd(){return typeof Reflect<"u"&&Reflect.get?qd=Reflect.get.bind():qd=function(t,r,n){var i=mKe(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},qd.apply(this,arguments)}function mKe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=ec(e),e!==null););return e}function yKe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&FB(e,t)}function FB(e,t){return FB=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},FB(e,t)}function gKe(e){var t=_Ke();return function(){var n=ec(e),i;if(t){var o=ec(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return vKe(this,i)}}function vKe(e,t){if(t&&($v(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Gy(e)}function Gy(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _Ke(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ec(e){return ec=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ec(e)}function bKe(e,t,r){wKe(e,t),t.set(e,r)}function wKe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function A$(e,t,r){return t=Ose(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ose(e){var t=SKe(e,"string");return $v(t)==="symbol"?t:String(t)}function SKe(e,t){if($v(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if($v(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function h9(e,t){var r=Rse(e,t,"get");return xKe(e,r)}function xKe(e,t){return t.get?t.get.call(e):t.value}function I$(e,t,r){var n=Rse(e,t,"set");return CKe(e,n,r),r}function Rse(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function CKe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var M$="collapsibleColumns",EKe=290,TKe=["nestedHeaders"],_y="collapsibleIndicator",d9=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]),by=new WeakMap,OKe=function(e){yKe(r,e);var t=gKe(r);function r(){var n;dKe(this,r);for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n=t.call.apply(t,[this].concat(o)),A$(Gy(n),"nestedHeadersPlugin",null),A$(Gy(n),"eventManager",new Bi(Gy(n))),A$(Gy(n),"headerStateManager",null),bKe(Gy(n),by,{writable:!0,value:null}),n}return pKe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[M$]}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){var o=this.hot.getSettings(),s=o.nestedHeaders;s||ti("You need to configure the Nested Headers plugin in order to use collapsible headers."),I$(this,by,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",function(){return i.onInit()}),this.addHook("afterLoadData",function(){return i.onAfterLoadData.apply(i,arguments)}),this.addHook("afterGetColHeader",function(){return i.onAfterGetColHeader.apply(i,arguments)}),this.addHook("beforeOnCellMouseDown",function(a,h,p){return i.onBeforeOnCellMouseDown(a,h,p)}),qd(ec(r.prototype),"enablePlugin",this).call(this),this.updatePlugin()}}},{key:"updatePlugin",value:function(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){var i=this.hot.getSettings(),o=i.collapsibleColumns;typeof o=="boolean"?this.headerStateManager.mapState(function(s){return{collapsible:s.origColspan>1}}):Array.isArray(o)&&(this.headerStateManager.mapState(function(){return{collapsible:!1}}),this.headerStateManager.mergeStateWith(o))}qd(ec(r.prototype),"updatePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),I$(this,by,null),this.nestedHeadersPlugin=null,this.clearButtons(),qd(ec(r.prototype),"disablePlugin",this).call(this)}},{key:"clearButtons",value:function(){if(this.hot.view){var i=this.hot.view._wt.getSetting("columnHeaders").length,o=this.hot.view._wt.wtTable.THEAD,s=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,a=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,h=function(g){g&&g.parentNode.removeChild(g)};Er(0,i-1,function(p){var g=o.childNodes[p],S=s.childNodes[p],T=a?a.childNodes[p]:null;Er(0,g.childNodes.length-1,function(R){var A=g.childNodes[R].querySelector(".".concat(_y));h(A),S&&S.childNodes[R]&&(A=S.childNodes[R].querySelector(".".concat(_y)),h(A)),a&&T&&T.childNodes[R]&&(A=T.childNodes[R].querySelector(".".concat(_y)),h(A))})})}}},{key:"expandSection",value:function(i){this.toggleCollapsibleSection([i],"expand")}},{key:"collapseSection",value:function(i){this.toggleCollapsibleSection([i],"collapse")}},{key:"toggleAllCollapsibleSections",value:function(i){var o=this,s=this.headerStateManager.mapNodes(function(a){var h=a.collapsible,p=a.origColspan,g=a.headerLevel,S=a.columnIndex,T=a.isCollapsed;if(h===!0&&p>1&&(T&&i==="expand"||!T&&i==="collapse"))return{row:o.headerStateManager.levelToRowCoords(g),col:S}});this.toggleCollapsibleSection(s,i)}},{key:"collapseAll",value:function(){this.toggleAllCollapsibleSections("collapse")}},{key:"expandAll",value:function(){this.toggleAllCollapsibleSections("expand")}},{key:"toggleCollapsibleSection",value:function(i,o){var s=this;if(!d9.has(o))throw new Error("Unsupported action is passed (".concat(o,")."));if(Array.isArray(i)){var a=$s(i,function(j){var z=j.row;return z<0}),h=a.length>0;Le(a,function(j){var z,V=j.row,G=j.col,ee=(z=s.headerStateManager.getHeaderSettings(V,G))!==null&&z!==void 0?z:{},K=ee.collapsible,xe=ee.isCollapsed;if(!K||xe&&o==="collapse"||!xe&&o==="expand")return h=!1,!1});var p=[],g=[];h&&Le(a,function(j){var z=j.row,V=j.col,G=s.headerStateManager.triggerNodeModification(o,z,V),ee=G.colspanCompensation,K=G.affectedColumns,xe=G.rollbackModification;ee>0&&(g.push.apply(g,c9(K)),p.push(xe))});var S=this.getCollapsedColumns(),T=[];o==="collapse"?T=Roe([].concat(c9(S),g)):o==="expand"&&(T=$s(S,function(j){return!g.includes(j)}));var R=d9.get(o),A=this.hot.runHooks(R.beforeHook,S,T,h);if(A===!1){Le(p,function(j){j()});return}this.hot.batchExecution(function(){Le(g,function(j){h9(s,by).setValueAtIndex(s.hot.toPhysicalColumn(j),R.hideColumn)})},!0);var $=this.getCollapsedColumns().length!==S.length;this.hot.runHooks(R.afterHook,S,T,h,$),this.hot.render(),this.hot.view.adjustElementsSize(!0)}}},{key:"getCollapsedColumns",value:function(){return h9(this,by).getHiddenIndexes()}},{key:"onAfterGetColHeader",value:function(i,o,s){var a,h=(a=this.headerStateManager.getHeaderSettings(s,i))!==null&&a!==void 0?a:{},p=h.collapsible,g=h.origColspan,S=h.isCollapsed,T=p&&g>1&&i>=this.hot.getSettings().fixedColumnsStart,R=o.querySelector(".".concat(_y));if(T)R||(R=this.hot.rootDocument.createElement("div"),Ht(R,_y),o.querySelector("div:first-child").appendChild(R)),Kr(R,["collapsed","expanded"]),S?(Ht(R,"collapsed"),Ap(R,"+")):(Ht(R,"expanded"),Ap(R,"-"));else{var A;(A=R)===null||A===void 0||A.remove()}}},{key:"onBeforeOnCellMouseDown",value:function(i,o){Ur(i.target,_y)&&(Ur(i.target,"expanded")?(this.eventManager.fireEvent(i.target,"mouseup"),this.toggleCollapsibleSection([o],"collapse")):Ur(i.target,"collapsed")&&(this.eventManager.fireEvent(i.target,"mouseup"),this.toggleCollapsibleSection([o],"expand")),lu(i))}},{key:"onInit",value:function(){this.updatePlugin()}},{key:"onAfterLoadData",value:function(i,o){o||this.updatePlugin()}},{key:"destroy",value:function(){I$(this,by,null),qd(ec(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return M$}},{key:"PLUGIN_PRIORITY",get:function(){return EKe}},{key:"PLUGIN_DEPS",get:function(){return["plugin:NestedHeaders"]}},{key:"SETTING_KEYS",get:function(){return[M$].concat(TKe)}}]),r}(Wn),RKe=Br,kKe=Ji,PKe=Fre,AKe=cs,IKe=fu,MKe=Q_;RKe({target:"Object",stat:!0,sham:!kKe},{getOwnPropertyDescriptors:function(t){for(var r=AKe(t),n=IKe.f,i=PKe(r),o={},s=0,a,h;i.length>s;)h=n(r,a=i[s++]),h!==void 0&&MKe(o,a,h);return o}});var p9=Ji,DKe=an,$Ke=so,LKe=nn,D$=Hx,NKe=Kx,BKe=Gx,jKe=Ha,zKe=Nx,wy=Object.assign,m9=Object.defineProperty,FKe=DKe([].concat),HKe=!wy||LKe(function(){if(p9&&wy({b:1},wy(m9({},"a",{enumerable:!0,get:function(){m9(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var e={},t={},r=Symbol(),n="abcdefghijklmnopqrst";return e[r]=7,n.split("").forEach(function(i){t[i]=i}),wy({},e)[r]!=7||D$(wy({},t)).join("")!=n})?function(t,r){for(var n=jKe(t),i=arguments.length,o=1,s=NKe.f,a=BKe.f;i>o;)for(var h=zKe(arguments[o++]),p=s?FKe(D$(h),s(h)):D$(h),g=p.length,S=0,T;g>S;)T=p[S++],(!p9||$Ke(a,h,T))&&(n[T]=h[T]);return n}:wy,VKe=Br,y9=HKe;VKe({target:"Object",stat:!0,arity:2,forced:Object.assign!==y9},{assign:y9});function p1(e){"@babel/helpers - typeof";return p1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},p1(e)}function g9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function UKe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?g9(Object(r),!0).forEach(function(n){WKe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):g9(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function WKe(e,t,r){return t=kse(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function v9(e,t){return qKe(e)||KKe(e,t)||YKe(e,t)||GKe()}function GKe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function YKe(e,t){if(e){if(typeof e=="string")return _9(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _9(e,t)}}function _9(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function KKe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],h=!0,p=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;h=!1}else for(;!(h=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);h=!0);}catch(g){p=!0,i=g}finally{try{if(!h&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(p)throw i}}return a}}function qKe(e){if(Array.isArray(e))return e}function XKe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function b9(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,kse(n.key),n)}}function ZKe(e,t,r){return t&&b9(e.prototype,t),r&&b9(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function kse(e){var t=JKe(e,"string");return p1(t)==="symbol"?t:String(t)}function JKe(e,t){if(p1(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(p1(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var QKe=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],eqe=!1,tqe=!0,rqe=!0,nqe=function(){function e(t,r){XKe(this,e),this.hot=t,this.sortingStates=new LA,this.sortEmptyCells=eqe,this.indicator=tqe,this.headerAction=rqe,this.compareFunctionFactory=void 0,this.mapName=r,this.hot.columnIndexMapper.registerMap(r,this.sortingStates)}return ZKe(e,[{key:"updateAllColumnsProperties",value:function(r){var n=this;dn(r)&&pn(r,function(i,o){QKe.includes(o)&&(n[o]=i)})}},{key:"getAllColumnsProperties",value:function(){var r={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return typeof this.compareFunctionFactory=="function"&&(r.compareFunctionFactory=this.compareFunctionFactory),r}},{key:"getSortOrderOfColumn",value:function(r){var n;return(n=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(r)))===null||n===void 0?void 0:n.sortOrder}},{key:"getIndexOfColumnInSortQueue",value:function(r){return r=this.hot.toPhysicalColumn(r),this.sortingStates.getEntries().findIndex(function(n){var i=v9(n,1),o=i[0];return o===r})}},{key:"getNumberOfSortedColumns",value:function(){return this.sortingStates.getLength()}},{key:"isListOfSortedColumnsEmpty",value:function(){return this.getNumberOfSortedColumns()===0}},{key:"isColumnSorted",value:function(r){return dn(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(r)))}},{key:"getSortStates",value:function(){var r=this;if(this.sortingStates===null)return[];var n=this.sortingStates.getEntries();return n.map(function(i){var o=v9(i,2),s=o[0],a=o[1];return UKe({column:r.hot.toVisualColumn(s)},a)})}},{key:"getColumnSortState",value:function(r){var n=this.getSortOrderOfColumn(r);if(dr(n))return{column:r,sortOrder:n}}},{key:"setSortStates",value:function(r){this.sortingStates.clear();for(var n=0;n<r.length;n+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(r[n].column),{sortOrder:r[n].sortOrder})}},{key:"destroy",value:function(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}]),e}(),aP="asc",sP="desc",iqe="colHeader";function oqe(e){if(dn(e)===!1)return!1;var t=e.column,r=e.sortOrder;return Number.isInteger(t)&&[aP,sP].includes(r)}function aqe(e){if(e.some(function(r){return oqe(r)===!1}))return!1;var t=e.map(function(r){var n=r.column;return n});return new Set(t).size===t.length}function w9(e){if(e!==sP)return e===aP?sP:aP}function S9(e){var t=e.querySelector(".".concat(iqe));return t}function x9(e,t){if(e<0||!t.parentNode)return!1;var r=t.parentNode.parentNode.childNodes,n=Array.from(r).indexOf(t.parentNode)-r.length;return n===-1}function HB(e,t,r){return e===-1&&t>=0&&Pp(r)===!1}var sqe="ascending",lqe="descending",Pse="indicatorDisabled",Ase="columnSorting",Ise="sortAction",Mse=new Map([[aP,sqe],[sP,lqe]]);function uqe(e,t,r,n){var i=[Ase];if(n&&i.push(Ise),r===!1)return i.push(Pse),i;var o=e.getSortOrderOfColumn(t);return dr(o)&&i.push(Mse.get(o)),i}function cqe(){return Array.from(Mse.values()).concat(Ise,Pse,Ase)}function Dse(e,t,r){var n=t.locale;return function(i,o){var s=r.sortEmptyCells;return typeof i=="string"&&(i=i.toLocaleLowerCase(n)),typeof o=="string"&&(o=o.toLocaleLowerCase(n)),i===o?au:go(i)?go(o)?au:s&&e==="asc"?Ii:Mi:go(o)?s&&e==="asc"?Mi:Ii:isNaN(i)&&!isNaN(o)?e==="asc"?Mi:Ii:!isNaN(i)&&isNaN(o)||(isNaN(i)||isNaN(o)||(i=parseFloat(i),o=parseFloat(o)),i<o)?e==="asc"?Ii:Mi:i>o?e==="asc"?Mi:Ii:au}}var $se="default";function fqe(e,t,r){return function(n,i){var o=parseFloat(n),s=parseFloat(i),a=r.sortEmptyCells;if(o===s||isNaN(o)&&isNaN(s))return au;if(a){if(go(n))return e==="asc"?Ii:Mi;if(go(i))return e==="asc"?Mi:Ii}return isNaN(o)?Mi:isNaN(s)?Ii:o<s?e==="asc"?Ii:Mi:o>s?e==="asc"?Mi:Ii:au}}var hqe="numeric";function dqe(e,t,r){var n=t.checkedTemplate,i=t.uncheckedTemplate,o=r.sortEmptyCells;return function(s,a){var h=go(s),p=go(a),g=h?i:s,S=p?i:a,T=g===i||g===n,R=S===i||S===n;if(o===!1){if(h&&p===!1)return Mi;if(h===!1&&p)return Ii}return T===!1&&R?e==="asc"?Ii:Mi:T&&R===!1?e==="asc"?Mi:Ii:T===!1&&R===!1?Dse(e,t,r)(s,a):g===i&&S===n?e==="asc"?Ii:Mi:g===n&&S===i?e==="asc"?Mi:Ii:au}}var pqe="checkbox";function mqe(e,t,r){return function(n,i){var o=r.sortEmptyCells;if(n===i)return au;if(go(n))return go(i)?au:o&&e==="asc"?Ii:Mi;if(go(i))return o&&e==="asc"?Mi:Ii;var s=t.dateFormat,a=Vt(n,s),h=Vt(i,s);return a.isValid()?h.isValid()?h.isAfter(a)?e==="asc"?Ii:Mi:h.isBefore(a)?e==="asc"?Mi:Ii:au:Ii:Mi}}var yqe="date",N3=Fs("sorting.compareFunctionFactory"),NA=N3.register,C9=N3.getItem,gqe=N3.hasItem,Lse=Fs("sorting.mainSortComparator"),Nse=Lse.register,vqe=Lse.getItem;function Bse(e){return gqe(e)?C9(e):C9($se)}NA(hqe,fqe);NA(pqe,dqe);NA(yqe,mqe);NA($se,Dse);var au=0,Ii=-1,Mi=1;function _qe(e,t){for(var r=vqe(t),n=arguments.length,i=new Array(n>2?n-2:0),o=2;o<n;o++)i[o-2]=arguments[o];e.sort(r.apply(void 0,i))}function E9(e){return xqe(e)||Sqe(e)||wqe(e)||bqe()}function bqe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function wqe(e,t){if(e){if(typeof e=="string")return T9(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return T9(e,t)}}function T9(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Sqe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function xqe(e){if(Array.isArray(e))return e}function Cqe(e,t){return function(r,n){var i=E9(r),o=i.slice(1),s=E9(n),a=s.slice(1);return function(p){var g=e[p],S=t[p],T=o[p],R=a[p],A=S.columnSorting,$=A.compareFunctionFactory?A.compareFunctionFactory:Bse(S.type),j=$(g,S,A)(T,R);return j}(0)}}function Lv(e){"@babel/helpers - typeof";return Lv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lv(e)}var Eqe=["column"],Tqe=["column"];function Sy(e){return Pqe(e)||kqe(e)||Rqe(e)||Oqe()}function Oqe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Rqe(e,t){if(e){if(typeof e=="string")return VB(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return VB(e,t)}}function kqe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Pqe(e){if(Array.isArray(e))return VB(e)}function VB(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function O9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function R9(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?O9(Object(r),!0).forEach(function(n){Aqe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):O9(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Aqe(e,t,r){return t=jse(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function k9(e,t){if(e==null)return{};var r=Iqe(e,t),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Iqe(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,o;for(o=0;o<n.length;o++)i=n[o],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function Mqe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function P9(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,jse(n.key),n)}}function Dqe(e,t,r){return t&&P9(e.prototype,t),r&&P9(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function jse(e){var t=$qe(e,"string");return Lv(t)==="symbol"?t:String(t)}function $qe(e,t){if(Lv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Lv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Xd(){return typeof Reflect<"u"&&Reflect.get?Xd=Reflect.get.bind():Xd=function(t,r,n){var i=Lqe(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Xd.apply(this,arguments)}function Lqe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=tc(e),e!==null););return e}function Nqe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&UB(e,t)}function UB(e,t){return UB=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},UB(e,t)}function Bqe(e){var t=Fqe();return function(){var n=tc(e),i;if(t){var o=tc(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return jqe(this,i)}}function jqe(e,t){if(t&&(Lv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return zqe(e)}function zqe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Fqe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function tc(e){return tc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},tc(e)}var WB="columnSorting",Hqe=50,A9="append",Vqe="replace";Nse(WB,Cqe);mr.getSingleton().register("beforeColumnSort");mr.getSingleton().register("afterColumnSort");var zse=function(e){Nqe(r,e);var t=Bqe(r);function r(n){var i;return Mqe(this,r),i=t.call(this,n),i.columnStatesManager=null,i.columnMetaCache=null,i.pluginKey=WB,i.indexesSequenceCache=null,i}return Dqe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[this.pluginKey]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.columnStatesManager=new nqe(this.hot,"".concat(this.pluginKey,".sortingStates")),this.columnMetaCache=new Ch(function(o){var s=i.hot.toVisualColumn(o);return s===null&&(s=o),i.getMergedPluginSettings(s)}),this.hot.columnIndexMapper.registerMap("".concat(this.pluginKey,".columnMeta"),this.columnMetaCache),this.addHook("afterGetColHeader",function(o,s){return i.onAfterGetColHeader(o,s)}),this.addHook("beforeOnCellMouseDown",function(){return i.onBeforeOnCellMouseDown.apply(i,arguments)}),this.addHook("afterOnCellMouseDown",function(o,s){return i.onAfterOnCellMouseDown(o,s)}),this.addHook("afterInit",function(){return i.loadOrSortBySettings()}),this.addHook("afterLoadData",function(){return i.onAfterLoadData.apply(i,arguments)}),this.hot.view&&this.loadOrSortBySettings(),Xd(tc(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var i=this,o=function(a,h){var p=S9(h);x9(a,h)===!1||p===null||i.updateHeaderClasses(p)};this.hot.addHook("afterGetColHeader",o),this.hot.addHookOnce("afterViewRender",function(){i.hot.removeHook("afterGetColHeader",o)}),this.hot.batchExecution(function(){i.indexesSequenceCache!==null&&(i.hot.rowIndexMapper.setIndexesSequence(i.indexesSequenceCache.getValues()),i.hot.rowIndexMapper.unregisterMap(i.pluginKey))},!0),this.hot.columnIndexMapper.unregisterMap("".concat(this.pluginKey,".columnMeta")),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,Xd(tc(r.prototype),"disablePlugin",this).call(this)}},{key:"sort",value:function(i){var o=this.getSortConfig(),s=this.getNormalizedSortConfigs(i),a=this.areValidSortConfigs(s),h=this.hot.runHooks("beforeColumnSort",o,s,a);h!==!1&&(o.length===0&&this.indexesSequenceCache===null&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new vse),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),a&&(this.columnStatesManager.setSortStates(s),this.sortByPresetSortStates(s),this.saveAllSortSettings(s)),this.hot.runHooks("afterColumnSort",o,a?s:o,a),a&&(this.hot.render(),this.hot.forceFullRender=!1,this.hot.view.render()))}},{key:"clearSort",value:function(){this.sort([])}},{key:"isSorted",value:function(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}},{key:"getSortConfig",value:function(i){return dr(i)?this.columnStatesManager.getColumnSortState(i):this.columnStatesManager.getSortStates()}},{key:"setSortConfig",value:function(i){var o=this.getNormalizedSortConfigs(i);this.areValidSortConfigs(o)&&this.columnStatesManager.setSortStates(o)}},{key:"getNormalizedSortConfigs",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(i)?i.slice(0,1):[i]}},{key:"areValidSortConfigs",value:function(i){var o=this.hot.countCols();return aqe(i)&&i.every(function(s){var a=s.column;return a<=o&&a>=0})}},{key:"saveAllSortSettings",value:function(i){var o=this,s=this.columnStatesManager.getAllColumnsProperties(),a=function(p){var g=p.column,S=k9(p,Eqe);return R9({column:o.hot.toPhysicalColumn(g)},S)};s.initialConfig=hn(i,a),this.hot.runHooks("persistentStateSave","columnSorting",s)}},{key:"getAllSavedSortSettings",value:function(){var i=this,o={};this.hot.runHooks("persistentStateLoad","columnSorting",o);var s=o.value,a=function(p){var g=p.column,S=k9(p,Tqe);return R9({column:i.hot.toVisualColumn(g)},S)};return dr(s)&&Array.isArray(s.initialConfig)&&(s.initialConfig=hn(s.initialConfig,a)),s}},{key:"getColumnNextConfig",value:function(i){var o=this.columnStatesManager.getSortOrderOfColumn(i);if(dr(o)){var s=w9(o);return dr(s)?{column:i,sortOrder:s}:void 0}var a=this.hot.countCols();if(Number.isInteger(i)&&i>=0&&i<a)return{column:i,sortOrder:w9()}}},{key:"getNextSortConfig",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:A9,s=this.columnStatesManager.getIndexOfColumnInSortQueue(i),a=s!==-1,h=this.getSortConfig(),p=this.getColumnNextConfig(i);if(a){if(si(p))return[].concat(Sy(h.slice(0,s)),Sy(h.slice(s+1)));if(o===A9)return[].concat(Sy(h.slice(0,s)),Sy(h.slice(s+1)),[p]);if(o===Vqe)return[].concat(Sy(h.slice(0,s)),[p],Sy(h.slice(s+1)))}return dr(p)?h.concat(p):h}},{key:"getPluginColumnConfig",value:function(i){if(dn(i)){var o=i[this.pluginKey];if(dn(o))return o}return{}}},{key:"getMergedPluginSettings",value:function(i){var o=this.hot.getSettings()[this.pluginKey],s=this.columnStatesManager.getAllColumnsProperties(),a=this.hot.getCellMeta(0,i),h=Object.getPrototypeOf(a);return Array.isArray(h.columns)?Object.assign(s,o,this.getPluginColumnConfig(h.columns[i])):ci(h.columns)?Object.assign(s,o,this.getPluginColumnConfig(h.columns(i))):Object.assign(s,o)}},{key:"getFirstCellSettings",value:function(i){var o=this.hot.getCellMeta(0,i),s=Object.create(o);return s[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(i)),s}},{key:"getNumberOfRowsToSort",value:function(i){var o=this.hot.getSettings();return o.maxRows<=i?o.maxRows:i-o.minSpareRows}},{key:"sortByPresetSortStates",value:function(i){var o=this;if(i.length===0){this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues());return}for(var s=[],a=this.hot.countRows(),h=function(j){return hn(i,function(z){return o.hot.getDataAtCell(j,z.column)})},p=0;p<this.getNumberOfRowsToSort(a);p+=1)s.push([this.hot.toPhysicalRow(p)].concat(h(p)));var g=hn(s,function($){return $[0]});_qe(s,this.pluginKey,hn(i,function($){return $.sortOrder}),hn(i,function($){return o.getFirstCellSettings($.column)}));for(var S=s.length;S<a;S+=1)s.push([S].concat(h(S)));var T=hn(s,function($){return $[0]}),R=new Map(hn(g,function($,j){return[$,T[j]]})),A=hn(this.hot.rowIndexMapper.getIndexesSequence(),function($){return R.has($)?R.get($):$});this.hot.rowIndexMapper.setIndexesSequence(A)}},{key:"loadOrSortBySettings",value:function(){var i=this.getAllSavedSortSettings();if(dn(i))this.sortBySettings(i);else{var o=this.hot.getSettings()[this.pluginKey];this.sortBySettings(o)}}},{key:"sortBySettings",value:function(i){if(dn(i)){this.columnStatesManager.updateAllColumnsProperties(i);var o=i.initialConfig;(Array.isArray(o)||dn(o))&&this.sort(o)}else this.hot.render()}},{key:"onAfterGetColHeader",value:function(i,o){var s=S9(o);if(!(x9(i,o)===!1||s===null)){var a=this.getFirstCellSettings(i)[this.pluginKey],h=a.indicator,p=a.headerAction;this.updateHeaderClasses(s,this.columnStatesManager,i,h,p)}}},{key:"updateHeaderClasses",value:function(i){if(Kr(i,cqe()),this.enabled!==!1){for(var o=arguments.length,s=new Array(o>1?o-1:0),a=1;a<o;a++)s[a-1]=arguments[a];Ht(i,uqe.apply(void 0,s))}}},{key:"onUpdateSettings",value:function(i){Xd(tc(r.prototype),"onUpdateSettings",this).call(this),this.columnMetaCache!==null&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),dr(i[this.pluginKey])&&this.sortBySettings(i[this.pluginKey])}},{key:"onAfterLoadData",value:function(i){i===!0&&this.hot.view&&this.loadOrSortBySettings()}},{key:"wasClickableHeaderClicked",value:function(i,o){var s=this.getFirstCellSettings(o)[this.pluginKey],a=s.headerAction;return a&&i.target.nodeName==="SPAN"}},{key:"onBeforeOnCellMouseDown",value:function(i,o,s,a){HB(o.row,o.col,i)!==!1&&this.wasClickableHeaderClicked(i,o.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(a.column=!0)}},{key:"onAfterOnCellMouseDown",value:function(i,o){HB(o.row,o.col,i)!==!1&&this.wasClickableHeaderClicked(i,o.col)&&(this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(o.col)),this.sort(this.getColumnNextConfig(o.col)))}},{key:"destroy",value:function(){var i;(i=this.columnStatesManager)===null||i===void 0||i.destroy(),Xd(tc(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return WB}},{key:"PLUGIN_PRIORITY",get:function(){return Hqe}}]),r}(Wn),Uqe=Br,B3=an,Wqe=wh,Gqe=aie,Yqe=kie,I9=nn,Kqe=RangeError,Fse=String,Hse=Math.floor,GB=B3(Yqe),M9=B3("".slice),t0=B3(1 .toFixed),lg=function(e,t,r){return t===0?r:t%2===1?lg(e,t-1,r*e):lg(e*e,t/2,r)},qqe=function(e){for(var t=0,r=e;r>=4096;)t+=12,r/=4096;for(;r>=2;)t+=1,r/=2;return t},xy=function(e,t,r){for(var n=-1,i=r;++n<6;)i+=t*e[n],e[n]=i%1e7,i=Hse(i/1e7)},$$=function(e,t){for(var r=6,n=0;--r>=0;)n+=e[r],e[r]=Hse(n/t),n=n%t*1e7},D9=function(e){for(var t=6,r="";--t>=0;)if(r!==""||t===0||e[t]!==0){var n=Fse(e[t]);r=r===""?n:r+GB("0",7-n.length)+n}return r},Xqe=I9(function(){return t0(8e-5,3)!=="0.000"||t0(.9,0)!=="1"||t0(1.255,2)!=="1.25"||t0(0xde0b6b3a7640080,0)!=="1000000000000000128"})||!I9(function(){t0({})});Uqe({target:"Number",proto:!0,forced:Xqe},{toFixed:function(t){var r=Gqe(this),n=Wqe(t),i=[0,0,0,0,0,0],o="",s="0",a,h,p,g;if(n<0||n>20)throw Kqe("Incorrect fraction digits");if(r!=r)return"NaN";if(r<=-1e21||r>=1e21)return Fse(r);if(r<0&&(o="-",r=-r),r>1e-21)if(a=qqe(r*lg(2,69,1))-69,h=a<0?r*lg(2,-a,1):r/lg(2,a,1),h*=4503599627370496,a=52-a,a>0){for(xy(i,0,h),p=n;p>=7;)xy(i,1e7,0),p-=7;for(xy(i,lg(10,p,1),0),p=a-1;p>=23;)$$(i,1<<23),p-=23;$$(i,1<<p),xy(i,1,1),$$(i,2),s=D9(i)}else xy(i,0,h),xy(i,1<<-a,0),s=D9(i)+GB("0",n);return n>0?(g=s.length,s=o+(g<=n?"0."+GB("0",n-g)+s:M9(s,0,g-n)+"."+M9(s,g-n))):s=o+s,s}});function m1(e){"@babel/helpers - typeof";return m1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},m1(e)}function Zqe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $9(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Qqe(n.key),n)}}function Jqe(e,t,r){return t&&$9(e.prototype,t),r&&$9(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Qqe(e){var t=e9e(e,"string");return m1(t)==="symbol"?t:String(t)}function e9e(e,t){if(m1(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(m1(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var t9e=function(){function e(t,r){Zqe(this,e),this.plugin=t,this.hot=this.plugin.hot,this.endpoints=[],this.settings=r,this.settingsType="array",this.currentEndpoint=null,this.cellsToSetCache=[]}return Jqe(e,[{key:"getEndpoint",value:function(r){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[r]:this.endpoints[r]}},{key:"getAllEndpoints",value:function(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}},{key:"fillMissingEndpointData",value:function(r){return this.parseSettings(r.call(this))}},{key:"parseSettings",value:function(r){var n=this,i=[],o=r;if(!o&&typeof this.settings=="function"){this.settingsType="function";return}return o||(o=this.settings),Le(o,function(s){var a={};n.assignSetting(s,a,"ranges",[[0,n.hot.countRows()-1]]),n.assignSetting(s,a,"reversedRowCoords",!1),n.assignSetting(s,a,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),n.assignSetting(s,a,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),n.assignSetting(s,a,"sourceColumn",s.destinationColumn),n.assignSetting(s,a,"type","sum"),n.assignSetting(s,a,"forceNumeric",!1),n.assignSetting(s,a,"suppressDataTypeErrors",!0),n.assignSetting(s,a,"suppressDataTypeErrors",!0),n.assignSetting(s,a,"customFunction",null),n.assignSetting(s,a,"readOnly",!0),n.assignSetting(s,a,"roundFloat",!1),i.push(a)}),i}},{key:"assignSetting",value:function(r,n,i,o){if(i==="ranges"&&r[i]===void 0){n[i]=o;return}else if(i==="ranges"&&r[i].length===0)return;if(r[i]===void 0){if(o instanceof Error)throw o;n[i]=o}else i==="destinationRow"&&n.reversedRowCoords?n[i]=this.hot.countRows()-r[i]-1:n[i]=r[i]}},{key:"resetSetupBeforeStructureAlteration",value:function(r,n,i){if(this.settingsType==="function"){var o=r.indexOf("row")>-1?"row":"col",s=this.getAllEndpoints();Le(s,function(a){o==="row"&&a.destinationRow>=n&&(r==="insert_row"?a.alterRowOffset=i:r==="remove_row"&&(a.alterRowOffset=-1*i)),o==="col"&&a.destinationColumn>=n&&(r==="insert_col"?a.alterColumnOffset=i:r==="remove_col"&&(a.alterColumnOffset=-1*i))}),this.resetAllEndpoints(s,!1)}}},{key:"resetSetupAfterStructureAlteration",value:function(r,n,i,o,s){var a=this,h=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;if(this.settingsType==="function"){var p=function $(){return a.hot.removeHook("beforeViewRender",$),a.refreshAllEndpoints()};this.hot.addHookOnce("beforeViewRender",p);return}var g=r.indexOf("row")>-1?"row":"col",S=r.indexOf("remove")>-1?-1:1,T=this.getAllEndpoints(),R=r.indexOf("move_row")===0,A=n;Le(T,function($){g==="row"&&$.destinationRow>=A&&($.alterRowOffset=S*i),g==="col"&&$.destinationColumn>=A&&($.alterColumnOffset=S*i)}),this.resetAllEndpoints(T,!R),R?Le(T,function($){a.extendEndpointRanges($,A,o[0],o.length),a.recreatePhysicalRanges($),a.clearOffsetInformation($)}):Le(T,function($){a.shiftEndpointCoordinates($,A)}),h&&this.refreshAllEndpoints()}},{key:"clearOffsetInformation",value:function(r){r.alterRowOffset=void 0,r.alterColumnOffset=void 0}},{key:"extendEndpointRanges",value:function(r,n,i,o){Le(r.ranges,function(s){s[1]&&(n>=s[0]&&n<=s[1]?i>s[1]?s[1]+=o:i<s[0]&&(s[0]-=o):i>=s[0]&&i<=s[1]&&(s[1]-=o,n<=s[0]&&(s[0]+=1,s[1]+=1)))})}},{key:"recreatePhysicalRanges",value:function(r){var n=this,i=r.ranges,o=[],s=[];Le(i,function(a){var h=[];if(a[1])for(var p=a[0];p<=a[1];p++)h.push(n.hot.toPhysicalRow(p));else h.push(n.hot.toPhysicalRow(a[0]));s.push(h)}),Le(s,function(a){var h=[];Le(a,function(p,g){g===0?h.push(p):a[g]!==a[g-1]+1&&(h.push(a[g-1]),o.push(h),h=[],h.push(p)),g===a.length-1&&(h.push(p),o.push(h))})}),r.ranges=o}},{key:"shiftEndpointCoordinates",value:function(r,n){r.alterRowOffset&&r.alterRowOffset!==0?(r.destinationRow+=r.alterRowOffset||0,Le(r.ranges,function(i){Le(i,function(o,s){o>=n&&(i[s]+=r.alterRowOffset||0)})})):r.alterColumnOffset&&r.alterColumnOffset!==0&&(r.destinationColumn+=r.alterColumnOffset||0,r.sourceColumn+=r.alterColumnOffset||0)}},{key:"resetAllEndpoints",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getAllEndpoints(),i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,o=n.some(function(s){var a=s.alterRowOffset||0,h=s.alterColumnOffset||0;return s.destinationRow+a>=r.hot.countRows()||s.destinationColumn+h>=r.hot.countCols()});o||(this.cellsToSetCache=[],Le(n,function(s){r.resetEndpointValue(s,i)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}},{key:"refreshAllEndpoints",value:function(){var r=this;this.cellsToSetCache=[],Le(this.getAllEndpoints(),function(n){r.currentEndpoint=n,r.plugin.calculate(n),r.setEndpointValue(n,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}},{key:"refreshChangedEndpoints",value:function(r){var n=this,i=[];this.cellsToSetCache=[],Le(r,function(o,s,a){"".concat(o[2]||"")!=="".concat(o[3])&&Le(n.getAllEndpoints(),function(h,p){n.hot.propToCol(a[s][1])===h.sourceColumn&&i.indexOf(p)===-1&&i.push(p)})}),Le(i,function(o){n.refreshEndpoint(n.getEndpoint(o))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}},{key:"refreshEndpoint",value:function(r){this.currentEndpoint=r,this.plugin.calculate(r),this.setEndpointValue(r),this.currentEndpoint=null}},{key:"resetEndpointValue",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=r.alterRowOffset||0,o=r.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(r.destinationRow+(n?i:0)),this.hot.toVisualColumn(r.destinationColumn+(n?o:0)),""])}},{key:"setEndpointValue",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=this.hot.toVisualRow(r.destinationRow);if(r.destinationRow>=this.hot.countRows()||r.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}var s=this.hot.toVisualRow(r.destinationRow);if(s!==null){var a=this.hot.getCellMeta(s,r.destinationColumn);(n==="init"||a.readOnly!==r.readOnly)&&(a.readOnly=r.readOnly,a.className="columnSummaryResult")}r.roundFloat&&!isNaN(r.result)&&(r.result=r.result.toFixed(r.roundFloat)),i?this.hot.setDataAtCell(o,r.destinationColumn,r.result,"ColumnSummary.set"):this.cellsToSetCache.push([o,r.destinationColumn,r.result]),r.alterRowOffset=void 0,r.alterColumnOffset=void 0}},{key:"throwOutOfBoundsWarning",value:function(){ti("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}]),e}();const r9e=t9e;function L$(e){return e==null||isNaN(e)}function Nv(e){"@babel/helpers - typeof";return Nv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nv(e)}var L9;function n9e(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function i9e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function N9(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,a9e(n.key),n)}}function o9e(e,t,r){return t&&N9(e.prototype,t),r&&N9(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function a9e(e){var t=s9e(e,"string");return Nv(t)==="symbol"?t:String(t)}function s9e(e,t){if(Nv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Nv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function vR(){return typeof Reflect<"u"&&Reflect.get?vR=Reflect.get.bind():vR=function(t,r,n){var i=l9e(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},vR.apply(this,arguments)}function l9e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Bv(e),e!==null););return e}function u9e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&YB(e,t)}function YB(e,t){return YB=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},YB(e,t)}function c9e(e){var t=d9e();return function(){var n=Bv(e),i;if(t){var o=Bv(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return f9e(this,i)}}function f9e(e,t){if(t&&(Nv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return h9e(e)}function h9e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function d9e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Bv(e){return Bv=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Bv(e)}var N$="columnSummary",p9e=220,m9e=function(e){u9e(r,e);var t=c9e(r);function r(n){var i;return i9e(this,r),i=t.call(this,n),i.endpoints=null,i}return o9e(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[N$]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.settings=this.hot.getSettings()[N$],this.endpoints=new r9e(this,this.settings),this.addHook("afterInit",function(){return i.onAfterInit.apply(i,arguments)}),this.addHook("afterChange",function(){return i.onAfterChange.apply(i,arguments)}),this.addHook("beforeCreateRow",function(o,s,a){return i.endpoints.resetSetupBeforeStructureAlteration("insert_row",o,s,null,a)}),this.addHook("beforeCreateCol",function(o,s,a){return i.endpoints.resetSetupBeforeStructureAlteration("insert_col",o,s,null,a)}),this.addHook("beforeRemoveRow",function(){for(var o,s=arguments.length,a=new Array(s),h=0;h<s;h++)a[h]=arguments[h];return(o=i.endpoints).resetSetupBeforeStructureAlteration.apply(o,["remove_row"].concat(a))}),this.addHook("beforeRemoveCol",function(){for(var o,s=arguments.length,a=new Array(s),h=0;h<s;h++)a[h]=arguments[h];return(o=i.endpoints).resetSetupBeforeStructureAlteration.apply(o,["remove_col"].concat(a))}),this.addHook("afterCreateRow",function(o,s,a){return i.endpoints.resetSetupAfterStructureAlteration("insert_row",o,s,null,a)}),this.addHook("afterCreateCol",function(o,s,a){return i.endpoints.resetSetupAfterStructureAlteration("insert_col",o,s,null,a)}),this.addHook("afterRemoveRow",function(){for(var o,s=arguments.length,a=new Array(s),h=0;h<s;h++)a[h]=arguments[h];return(o=i.endpoints).resetSetupAfterStructureAlteration.apply(o,["remove_row"].concat(a))}),this.addHook("afterRemoveCol",function(){for(var o,s=arguments.length,a=new Array(s),h=0;h<s;h++)a[h]=arguments[h];return(o=i.endpoints).resetSetupAfterStructureAlteration.apply(o,["remove_col"].concat(a))}),this.addHook("afterRowMove",function(){return i.onAfterRowMove.apply(i,arguments)}),vR(Bv(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.endpoints=null,this.settings=null,this.currentEndpoint=null}},{key:"calculate",value:function(i){switch(i.type.toLowerCase()){case"sum":i.result=this.calculateSum(i);break;case"min":i.result=this.calculateMinMax(i,i.type);break;case"max":i.result=this.calculateMinMax(i,i.type);break;case"count":i.result=this.countEntries(i);break;case"average":i.result=this.calculateAverage(i);break;case"custom":i.result=i.customFunction.call(this,i);break}}},{key:"calculateSum",value:function(i){var o=this,s=0;return pn(i.ranges,function(a){s+=o.getPartialSum(a,i.sourceColumn)}),s}},{key:"getPartialSum",value:function(i,o){var s=0,a=i[1]||i[0],h=null,p=0;do{if(h=this.getCellValue(a,o),h=L$(h)?null:h,h!==null){var g=("".concat(h).split(".")[1]||[]).length||1;g>p&&(p=g)}s+=h||0,a-=1}while(a>=i[0]);return Math.round(s*Math.pow(10,p))/Math.pow(10,p)}},{key:"calculateMinMax",value:function(i,o){var s=this,a=null;return pn(i.ranges,function(h){var p=s.getPartialMinMax(h,i.sourceColumn,o);if(a===null&&p!==null&&(a=p),p!==null)switch(o){case"min":a=Math.min(a,p);break;case"max":a=Math.max(a,p);break}}),a===null?"Not enough data":a}},{key:"getPartialMinMax",value:function(i,o,s){var a=null,h=i[1]||i[0],p;do{if(p=this.getCellValue(h,o),p=L$(p)?null:p,a===null)a=p;else if(p!==null)switch(s){case"min":a=Math.min(a,p);break;case"max":a=Math.max(a,p);break}h-=1}while(h>=i[0]);return a}},{key:"countEmpty",value:function(i,o){var s,a=0,h=i[1]||i[0];do s=this.getCellValue(h,o),s=L$(s)?null:s,s===null&&(a+=1),h-=1;while(h>=i[0]);return a}},{key:"countEntries",value:function(i){var o=this,s=0,a=i.ranges;return pn(a,function(h){var p=h[1]===void 0?1:h[1]-h[0]+1,g=o.countEmpty(h,i.sourceColumn);s+=p,s-=g}),s}},{key:"calculateAverage",value:function(i){var o=this.calculateSum(i),s=this.countEntries(i);return o/s}},{key:"getCellValue",value:function(i,o){var s=this.hot.toVisualRow(i),a=this.hot.toVisualColumn(o),h=this.hot.getSourceDataAtCell(i,o),p="";if(s!==null&&a!==null&&(p=this.hot.getCellMeta(s,a).className||""),p.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof h=="string"&&(h=h.replace(/,/,".")),h=parseFloat(h)),isNaN(h)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(Xn(L9||(L9=n9e(["ColumnSummary plugin: cell at (",", ",`) is not in a 
          numeric format. Cannot do the calculation.`],["ColumnSummary plugin: cell at (",", ",`) is not in a\\x20
          numeric format. Cannot do the calculation.`])),i,o));return h}},{key:"onAfterInit",value:function(){this.endpoints.endpoints=this.endpoints.parseSettings(),this.endpoints.refreshAllEndpoints(!0)}},{key:"onAfterChange",value:function(i,o){i&&o!=="ColumnSummary.reset"&&o!=="ColumnSummary.set"&&o!=="loadData"&&this.endpoints.refreshChangedEndpoints(i)}},{key:"onAfterRowMove",value:function(i,o){this.endpoints.resetSetupBeforeStructureAlteration("move_row",i[0],i.length,i,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",o,i.length,i,this.pluginName)}}],[{key:"PLUGIN_KEY",get:function(){return N$}},{key:"PLUGIN_PRIORITY",get:function(){return p9e}}]),r}(Wn);function y1(e){"@babel/helpers - typeof";return y1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},y1(e)}function y9e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function B9(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,v9e(n.key),n)}}function g9e(e,t,r){return t&&B9(e.prototype,t),r&&B9(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function v9e(e){var t=_9e(e,"string");return y1(t)==="symbol"?t:String(t)}function _9e(e,t){if(y1(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(y1(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var b9e=function(){function e(t,r){y9e(this,e),this.rootDocument=t,this.isRtl=r,this.container=null,this.editor=this.createEditor(),this.editorStyle=this.editor.style,this.hidden=!0,this.hide()}return g9e(e,[{key:"setPosition",value:function(r,n){this.editorStyle.left="".concat(r,"px"),this.editorStyle.top="".concat(n,"px")}},{key:"setSize",value:function(r,n){if(r&&n){var i=this.getInputElement();i.style.width="".concat(r,"px"),i.style.height="".concat(n,"px")}}},{key:"getSize",value:function(){return{width:ri(this.getInputElement()),height:$i(this.getInputElement())}}},{key:"resetSize",value:function(){var r=this.getInputElement();r.style.width="",r.style.height=""}},{key:"setReadOnlyState",value:function(r){var n=this.getInputElement();n.readOnly=r}},{key:"show",value:function(){this.editorStyle.display="block",this.hidden=!1}},{key:"hide",value:function(){this.hidden||(this.editorStyle.display="none"),this.hidden=!0}},{key:"isVisible",value:function(){return this.editorStyle.display==="block"}},{key:"setValue",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=r||"";this.getInputElement().value=n}},{key:"getValue",value:function(){return this.getInputElement().value}},{key:"isFocused",value:function(){return this.rootDocument.activeElement===this.getInputElement()}},{key:"focus",value:function(){this.getInputElement().focus()}},{key:"createEditor",value:function(){var r=this.rootDocument.createElement("div"),n=this.rootDocument.createElement("textarea");return r.style.display="none",this.container=this.rootDocument.createElement("div"),this.container.setAttribute("dir",this.isRtl?"rtl":"ltr"),Ht(this.container,e.CLASS_EDITOR_CONTAINER),this.rootDocument.body.appendChild(this.container),Ht(r,e.CLASS_EDITOR),Ht(n,e.CLASS_INPUT),r.appendChild(n),this.container.appendChild(r),r}},{key:"getInputElement",value:function(){return this.editor.querySelector(".".concat(e.CLASS_INPUT))}},{key:"destroy",value:function(){var r=this.container?this.container.parentNode:null;this.editor.parentNode.removeChild(this.editor),this.editor=null,this.editorStyle=null,r&&r.removeChild(this.container)}}],[{key:"CLASS_EDITOR_CONTAINER",get:function(){return"htCommentsContainer"}},{key:"CLASS_EDITOR",get:function(){return"htComments"}},{key:"CLASS_INPUT",get:function(){return"htCommentTextArea"}},{key:"CLASS_CELL",get:function(){return"htCommentCell"}}]),e}();const w9e=b9e;var fn="---------";function S9e(){return{name:fn}}function x9e(e){return hn(e,function(t){return{start:t.getTopStartCorner(),end:t.getBottomEndCorner()}})}function lO(e){return Ur(e,"htSeparator")}function C9e(e){return Ur(e,"htSubmenu")}function uO(e){return Ur(e,"htDisabled")}function cO(e){return Ur(e,"htSelectionDisabled")}function om(e){var t=e.getSelected();return!t||t[0]<0?null:t}function E9e(e,t){if(e.indexOf(t)!==-1)return e;var r=e.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","");return"".concat(r," ").concat(t)}function T9e(e,t){if(e.indexOf(t)!==-1)return e;var r=e.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","");return"".concat(r," ").concat(t)}function Cd(e,t){var r={};return Le(e,function(n){n.forAll(function(i,o){i>=0&&o>=0&&(r[i]||(r[i]=[]),r[i][o]=t(i,o))})}),r}function kf(e,t,r,n,i){Le(e,function(o){o.forAll(function(s,a){s>=0&&a>=0&&O9e(s,a,t,r,n,i)})})}function O9e(e,t,r,n,i,o){var s=i(e,t),a=n;s.className&&(r==="vertical"?a=E9e(s.className,n):a=T9e(s.className,n)),o(e,t,"className",a)}function Ql(e,t){var r=!1;return Array.isArray(e)&&Le(e,function(n){return n.forAll(function(i,o){if(i>=0&&o>=0&&t(i,o))return r=!0,!1}),r}),r}function Vu(e){return'<span class="selected">'.concat(String.fromCharCode(10003),"</span>").concat(e)}function R9e(e,t){return!e.hidden||!(typeof e.hidden=="function"&&e.hidden.call(t))}function Vse(e,t){for(var r=e.slice(0),n=0;n<r.length&&r[n].name===t;)r.shift();return r}function k9e(e,t){var r=e.slice(0);return r.reverse(),r=Vse(r,t),r.reverse(),r}function P9e(e){var t=[];return Le(e,function(r,n){n>0?t[t.length-1].name!==r.name&&t.push(r):t.push(r)}),t}function A9e(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:fn,r=e.slice(0);return r=Vse(r,t),r=k9e(r,t),r=P9e(r),r}function g1(e){"@babel/helpers - typeof";return g1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},g1(e)}function I9e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function j9(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,D9e(n.key),n)}}function M9e(e,t,r){return t&&j9(e.prototype,t),r&&j9(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function D9e(e){var t=$9e(e,"string");return g1(t)==="symbol"?t:String(t)}function $9e(e,t){if(g1(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(g1(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var L9e=250,N9e=250,Use=function(){function e(t){I9e(this,e),this.wasLastActionShow=!0,this.showDebounced=null,this.hidingTimer=null,this.updateDelay(t)}return M9e(e,[{key:"hide",value:function(){var r=this;this.wasLastActionShow=!1,this.hidingTimer=setTimeout(function(){r.wasLastActionShow===!1&&r.runLocalHooks("hide")},N9e)}},{key:"show",value:function(r){this.wasLastActionShow=!0,this.showDebounced(r)}},{key:"cancelHiding",value:function(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}},{key:"updateDelay",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:L9e;this.showDebounced=Qoe(function(i){r.wasLastActionShow&&r.runLocalHooks("show",i.from.row,i.from.col)},n)}},{key:"destroy",value:function(){this.clearLocalHooks()}}]),e}();li(Use,Va);const B9e=Use;var Wse="ContextMenu:items",en=Wse,j3="".concat(en,".noItems"),z3="".concat(en,".insertRowAbove"),F3="".concat(en,".insertRowBelow"),H3="".concat(en,".insertColumnOnTheLeft"),V3="".concat(en,".insertColumnOnTheRight"),U3="".concat(en,".removeRow"),W3="".concat(en,".removeColumn"),G3="".concat(en,".undo"),Y3="".concat(en,".redo"),K3="".concat(en,".readOnly"),q3="".concat(en,".clearColumn"),X3="".concat(en,".copy"),Z3="".concat(en,".copyWithHeaders"),J3="".concat(en,".copyWithGroupHeaders"),Q3="".concat(en,".copyHeadersOnly"),eV="".concat(en,".cut"),tV="".concat(en,".freezeColumn"),rV="".concat(en,".unfreezeColumn"),nV="".concat(en,".mergeCells"),iV="".concat(en,".unmergeCells"),oV="".concat(en,".addComment"),aV="".concat(en,".editComment"),sV="".concat(en,".removeComment"),lV="".concat(en,".readOnlyComment"),uV="".concat(en,".align"),cV="".concat(en,".align.left"),fV="".concat(en,".align.center"),hV="".concat(en,".align.right"),dV="".concat(en,".align.justify"),pV="".concat(en,".align.top"),mV="".concat(en,".align.middle"),yV="".concat(en,".align.bottom"),gV="".concat(en,".borders"),vV="".concat(en,".borders.top"),_V="".concat(en,".borders.right"),bV="".concat(en,".borders.bottom"),wV="".concat(en,".borders.left"),SV="".concat(en,".borders.remove"),xV="".concat(en,".nestedHeaders.insertChildRow"),CV="".concat(en,".nestedHeaders.detachFromParent"),EV="".concat(en,".hideColumn"),TV="".concat(en,".showColumn"),OV="".concat(en,".hideRow"),RV="".concat(en,".showRow"),wa="Filters:",ji="".concat(wa,"conditions"),BA="".concat(ji,".none"),kV="".concat(ji,".isEmpty"),PV="".concat(ji,".isNotEmpty"),AV="".concat(ji,".isEqualTo"),IV="".concat(ji,".isNotEqualTo"),MV="".concat(ji,".beginsWith"),DV="".concat(ji,".endsWith"),$V="".concat(ji,".contains"),LV="".concat(ji,".doesNotContain"),j9e="".concat(ji,".byValue"),NV="".concat(ji,".greaterThan"),BV="".concat(ji,".greaterThanOrEqualTo"),jV="".concat(ji,".lessThan"),zV="".concat(ji,".lessThanOrEqualTo"),FV="".concat(ji,".isBetween"),HV="".concat(ji,".isNotBetween"),VV="".concat(ji,".after"),UV="".concat(ji,".before"),WV="".concat(ji,".today"),GV="".concat(ji,".tomorrow"),YV="".concat(ji,".yesterday"),KV="".concat(wa,"labels.filterByCondition"),qV="".concat(wa,"labels.filterByValue"),XV="".concat(wa,"labels.conjunction"),jA="".concat(wa,"labels.disjunction"),lP="".concat(wa,"values.blankCells"),ZV="".concat(wa,"buttons.selectAll"),JV="".concat(wa,"buttons.clear"),QV="".concat(wa,"buttons.ok"),eU="".concat(wa,"buttons.cancel"),tU="".concat(wa,"buttons.placeholder.search"),rU="".concat(wa,"buttons.placeholder.value"),nU="".concat(wa,"buttons.placeholder.secondValue");const z9e=Object.freeze(Object.defineProperty({__proto__:null,CONTEXTMENU_ITEMS_ADD_COMMENT:oV,CONTEXTMENU_ITEMS_ALIGNMENT:uV,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:yV,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:fV,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:dV,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:cV,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:mV,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:hV,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:pV,CONTEXTMENU_ITEMS_BORDERS:gV,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:bV,CONTEXTMENU_ITEMS_BORDERS_LEFT:wV,CONTEXTMENU_ITEMS_BORDERS_RIGHT:_V,CONTEXTMENU_ITEMS_BORDERS_TOP:vV,CONTEXTMENU_ITEMS_CLEAR_COLUMN:q3,CONTEXTMENU_ITEMS_COPY:X3,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:Q3,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:J3,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:Z3,CONTEXTMENU_ITEMS_CUT:eV,CONTEXTMENU_ITEMS_EDIT_COMMENT:aV,CONTEXTMENU_ITEMS_FREEZE_COLUMN:tV,CONTEXTMENU_ITEMS_HIDE_COLUMN:EV,CONTEXTMENU_ITEMS_HIDE_ROW:OV,CONTEXTMENU_ITEMS_INSERT_LEFT:H3,CONTEXTMENU_ITEMS_INSERT_RIGHT:V3,CONTEXTMENU_ITEMS_MERGE_CELLS:nV,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:CV,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:xV,CONTEXTMENU_ITEMS_NO_ITEMS:j3,CONTEXTMENU_ITEMS_READ_ONLY:K3,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:lV,CONTEXTMENU_ITEMS_REDO:Y3,CONTEXTMENU_ITEMS_REMOVE_BORDERS:SV,CONTEXTMENU_ITEMS_REMOVE_COLUMN:W3,CONTEXTMENU_ITEMS_REMOVE_COMMENT:sV,CONTEXTMENU_ITEMS_REMOVE_ROW:U3,CONTEXTMENU_ITEMS_ROW_ABOVE:z3,CONTEXTMENU_ITEMS_ROW_BELOW:F3,CONTEXTMENU_ITEMS_SHOW_COLUMN:TV,CONTEXTMENU_ITEMS_SHOW_ROW:RV,CONTEXTMENU_ITEMS_UNDO:G3,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:rV,CONTEXTMENU_ITEMS_UNMERGE_CELLS:iV,CONTEXT_MENU_ITEMS_NAMESPACE:Wse,FILTERS_BUTTONS_CANCEL:eU,FILTERS_BUTTONS_CLEAR:JV,FILTERS_BUTTONS_OK:QV,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:tU,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:nU,FILTERS_BUTTONS_PLACEHOLDER_VALUE:rU,FILTERS_BUTTONS_SELECT_ALL:ZV,FILTERS_CONDITIONS_AFTER:VV,FILTERS_CONDITIONS_BEFORE:UV,FILTERS_CONDITIONS_BEGINS_WITH:MV,FILTERS_CONDITIONS_BETWEEN:FV,FILTERS_CONDITIONS_BY_VALUE:j9e,FILTERS_CONDITIONS_CONTAINS:$V,FILTERS_CONDITIONS_EMPTY:kV,FILTERS_CONDITIONS_ENDS_WITH:DV,FILTERS_CONDITIONS_EQUAL:AV,FILTERS_CONDITIONS_GREATER_THAN:NV,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:BV,FILTERS_CONDITIONS_LESS_THAN:jV,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:zV,FILTERS_CONDITIONS_NAMESPACE:ji,FILTERS_CONDITIONS_NONE:BA,FILTERS_CONDITIONS_NOT_BETWEEN:HV,FILTERS_CONDITIONS_NOT_CONTAIN:LV,FILTERS_CONDITIONS_NOT_EMPTY:PV,FILTERS_CONDITIONS_NOT_EQUAL:IV,FILTERS_CONDITIONS_TODAY:WV,FILTERS_CONDITIONS_TOMORROW:GV,FILTERS_CONDITIONS_YESTERDAY:YV,FILTERS_DIVS_FILTER_BY_CONDITION:KV,FILTERS_DIVS_FILTER_BY_VALUE:qV,FILTERS_LABELS_CONJUNCTION:XV,FILTERS_LABELS_DISJUNCTION:jA,FILTERS_NAMESPACE:wa,FILTERS_VALUES_BLANK_CELLS:lP},Symbol.toStringTag,{value:"Module"}));function jv(e){"@babel/helpers - typeof";return jv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jv(e)}function B$(e,t,r){return t=Gse(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function F9e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function z9(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Gse(n.key),n)}}function H9e(e,t,r){return t&&z9(e.prototype,t),r&&z9(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Gse(e){var t=V9e(e,"string");return jv(t)==="symbol"?t:String(t)}function V9e(e,t){if(jv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(jv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Zd(){return typeof Reflect<"u"&&Reflect.get?Zd=Reflect.get.bind():Zd=function(t,r,n){var i=U9e(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Zd.apply(this,arguments)}function U9e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=rc(e),e!==null););return e}function W9e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&KB(e,t)}function KB(e,t){return KB=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},KB(e,t)}function G9e(e){var t=K9e();return function(){var n=rc(e),i;if(t){var o=rc(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Y9e(this,i)}}function Y9e(e,t){if(t&&(jv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Yse(e)}function Yse(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function K9e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function rc(e){return rc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},rc(e)}var j$="comments",q9e=60,fO=new WeakMap,Ul="comment",Cy="value",F9="style",hO="readOnly",X9e=function(e){W9e(r,e);var t=G9e(r);function r(n){var i;return F9e(this,r),i=t.call(this,n),i.editor=null,i.displaySwitch=null,i.eventManager=null,i.range={},i.preventEditorAutoSwitch=!1,fO.set(Yse(i),{tempEditorDimensions:{},cellBelowCursor:null}),i}return H9e(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[j$]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.editor||(this.editor=new w9e(this.hot.rootDocument,this.hot.isRtl())),this.eventManager||(this.eventManager=new Bi(this)),this.displaySwitch||(this.displaySwitch=new B9e(this.getDisplayDelaySetting())),this.addHook("afterContextMenuDefaultOptions",function(o){return i.addToContextMenu(o)}),this.addHook("afterRenderer",function(o,s,a,h,p,g){return i.onAfterRenderer(o,g)}),this.addHook("afterScrollHorizontally",function(){return i.hide()}),this.addHook("afterScrollVertically",function(){return i.hide()}),this.addHook("afterBeginEditing",function(){return i.hide()}),this.displaySwitch.addLocalHook("hide",function(){return i.hide()}),this.displaySwitch.addLocalHook("show",function(o,s){return i.showAtCell(o,s)}),this.registerListeners(),Zd(rc(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Zd(rc(r.prototype),"updatePlugin",this).call(this),this.displaySwitch.updateDelay(this.getDisplayDelaySetting())}},{key:"disablePlugin",value:function(){Zd(rc(r.prototype),"disablePlugin",this).call(this)}},{key:"registerListeners",value:function(){var i=this,o=this.hot.rootDocument;this.eventManager.addEventListener(o,"mouseover",function(s){return i.onMouseOver(s)}),this.eventManager.addEventListener(o,"mousedown",function(s){return i.onMouseDown(s)}),this.eventManager.addEventListener(o,"mouseup",function(){return i.onMouseUp()}),this.eventManager.addEventListener(this.editor.getInputElement(),"blur",function(){return i.onEditorBlur()}),this.eventManager.addEventListener(this.editor.getInputElement(),"mousedown",function(s){return i.onEditorMouseDown(s)}),this.eventManager.addEventListener(this.editor.getInputElement(),"mouseup",function(s){return i.onEditorMouseUp(s)})}},{key:"setRange",value:function(i){this.range=i}},{key:"clearRange",value:function(){this.range={}}},{key:"targetIsCellWithComment",value:function(i){var o=Sp(i.target,"TD","TBODY");return!!(o&&Ur(o,"htCommentCell")&&Sp(o,[this.hot.rootElement]))}},{key:"targetIsCommentTextArea",value:function(i){return this.editor.getInputElement()===i.target}},{key:"setComment",value:function(i){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');var o=this.editor.getValue(),s="";i!=null?s=i:o!=null&&(s=o);var a=this.range.from.row,h=this.range.from.col;this.updateCommentMeta(a,h,B$({},Cy,s)),this.hot.render()}},{key:"setCommentAtCell",value:function(i,o,s){this.setRange({from:this.hot._createCellCoords(i,o)}),this.setComment(s)}},{key:"removeComment",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,Ul),i&&this.hot.render(),this.hide()}},{key:"removeCommentAtCell",value:function(i,o){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setRange({from:this.hot._createCellCoords(i,o)}),this.removeComment(s)}},{key:"getComment",value:function(){var i=this.range.from.row,o=this.range.from.col;return this.getCommentMeta(i,o,Cy)}},{key:"getCommentAtCell",value:function(i,o){return this.getCommentMeta(i,o,Cy)}},{key:"show",value:function(){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');var i=this.range.from,o=i.row,s=i.col;if(o<0||o>this.hot.countSourceRows()-1||s<0||s>this.hot.countSourceCols()-1)return!1;var a=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return this.editor.setValue(a[Ul]?a[Ul][Cy]:""),this.editor.show(),this.refreshEditor(!0),!0}},{key:"showAtCell",value:function(i,o){return this.setRange({from:this.hot._createCellCoords(i,o)}),this.show()}},{key:"hide",value:function(){this.editor.hide()}},{key:"refreshEditor",value:function(){var i,o,s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!(!s&&(!this.range.from||!this.editor.isVisible()))){var a=this.hot,h=a.rowIndexMapper,p=a.columnIndexMapper,g=this.range.from,S=g.row,T=g.col,R=h.getRenderableFromVisualIndex(S),A=p.getRenderableFromVisualIndex(T),$=R===null;this.editor.setPosition(0,0),R===null&&(R=h.getRenderableFromVisualIndex(h.getNearestNotHiddenIndex(S,-1))),A===null&&(A=p.getRenderableFromVisualIndex(p.getNearestNotHiddenIndex(T,-1)));var j=R===null,z=A===null;R=(i=R)!==null&&i!==void 0?i:0,A=(o=A)!==null&&o!==void 0?o:0;var V=this.hot,G=V.rootWindow,ee=V.view._wt,K=ee.wtTable,xe=ee.getCell({row:R,col:A},!0),Me=this.getCommentMeta(S,T,F9);Me?this.editor.setSize(Me.width,Me.height):this.editor.resetSize();var He=z?0:K.getStretchedColumnWidth(A),Ne=$&&!j?$i(xe):0,We=xe.getBoundingClientRect(),gt=We.left,Lt=We.top,_t=We.width,$e=We.height,Fe=this.editor.getSize(),At=Fe.width,Gt=Fe.height,ae=this.hot.rootWindow,D=ae.innerWidth,U=ae.innerHeight,q=this.hot.rootDocument.documentElement,ne=gt+G.scrollX+He,ye=Lt+G.scrollY+Ne;this.hot.isRtl()&&(ne-=At+He),this.hot.isLtr()&&gt+_t+At>D?ne=gt+G.scrollX-At-1:this.hot.isRtl()&&ne<-(q.scrollWidth-q.clientWidth)&&(ne=gt+G.scrollX+He+1),Lt+Gt>U&&(ye-=Gt-$e+1),this.editor.setPosition(ne,ye),this.editor.setReadOnlyState(this.getCommentMeta(S,T,hO))}}},{key:"checkSelectionCommentsConsistency",value:function(){var i=this.hot.getSelectedRangeLast();if(!i)return!1;var o=!1,s=i.getTopStartCorner();return this.getCommentMeta(s.row,s.col,Cy)&&(o=!0),o}},{key:"updateCommentMeta",value:function(i,o,s){var a=this.hot.getCellMeta(i,o)[Ul],h;a?(h=ya(a),kA(h,s)):h=s,this.hot.setCellMeta(i,o,Ul,h)}},{key:"getCommentMeta",value:function(i,o,s){var a=this.hot.getCellMeta(i,o);if(a[Ul])return a[Ul][s]}},{key:"onMouseDown",value:function(i){if(!(!this.hot.view||!this.hot.view._wt)&&!this.preventEditorAutoSwitch&&!this.targetIsCommentTextArea(i)){var o=Sp(i.target,"TD","TBODY"),s=null;o&&(s=this.hot.getCoords(o)),(!o||this.range.from&&s&&(this.range.from.row!==s.row||this.range.from.col!==s.col))&&this.hide()}}},{key:"onMouseOver",value:function(i){var o=fO.get(this),s=this.hot.rootDocument;if(!(this.preventEditorAutoSwitch||this.editor.isFocused()||Ur(i.target,"wtBorder")||o.cellBelowCursor===i.target||!this.editor))if(o.cellBelowCursor=s.elementFromPoint(i.clientX,i.clientY),this.targetIsCellWithComment(i)){var a=this.hot._createCellRange(this.hot.getCoords(i.target));this.displaySwitch.show(a)}else xp(i.target,s)&&!this.targetIsCommentTextArea(i)&&this.displaySwitch.hide()}},{key:"onMouseUp",value:function(){this.preventEditorAutoSwitch=!1}},{key:"onAfterRenderer",value:function(i,o){o[Ul]&&o[Ul][Cy]&&Ht(i,o.commentedCellClassName)}},{key:"onEditorBlur",value:function(){this.setComment()}},{key:"onEditorMouseDown",value:function(i){var o=fO.get(this);o.tempEditorDimensions={width:ri(i.target),height:$i(i.target)}}},{key:"onEditorMouseUp",value:function(i){var o=fO.get(this),s=ri(i.target),a=$i(i.target);(s!==o.tempEditorDimensions.width+1||a!==o.tempEditorDimensions.height+2)&&this.updateCommentMeta(this.range.from.row,this.range.from.col,B$({},F9,{width:s,height:a}))}},{key:"onContextMenuAddComment",value:function(){var i=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,this.displaySwitch.cancelHiding(),this.setRange({from:i.highlight}),this.show(),this.hot.deselectCell(),this.editor.focus()}},{key:"onContextMenuRemoveComment",value:function(){var i=this,o=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,o.forAll(function(s,a){s>=0&&a>=0&&i.removeCommentAtCell(s,a,!1)}),this.hot.render()}},{key:"onContextMenuMakeReadOnly",value:function(){var i=this,o=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,o.forAll(function(s,a){if(s>=0&&a>=0){var h=!!i.getCommentMeta(s,a,hO);i.updateCommentMeta(s,a,B$({},hO,!h))}})}},{key:"addToContextMenu",value:function(i){var o=this,s=function(){return o.hot.rowIndexMapper.getRenderableIndexesLength()>0&&o.hot.columnIndexMapper.getRenderableIndexesLength()>0};i.items.push({name:"---------"},{key:"commentsAddEdit",name:function(){return o.checkSelectionCommentsConsistency()?o.hot.getTranslatedPhrase(aV):o.hot.getTranslatedPhrase(oV)},callback:function(){return o.onContextMenuAddComment()},disabled:function(){return s()?!(o.hot.getSelectedLast()&&!o.hot.selection.isSelectedByCorner()):!0}},{key:"commentsRemove",name:function(){return this.getTranslatedPhrase(sV)},callback:function(){return o.onContextMenuRemoveComment()},disabled:function(){return s()?!(o.hot.getSelectedLast()&&!o.hot.selection.isSelectedByCorner()):!0}},{key:"commentsReadOnly",name:function(){var h=this,p=this.getTranslatedPhrase(lV),g=Ql(this.getSelectedRangeLast(),function(S,T){var R=h.getCellMeta(S,T)[Ul];if(R&&(R=R[hO]),R)return!0});return g&&(p=Vu(p)),p},callback:function(){return o.onContextMenuMakeReadOnly()},disabled:function(){return s()?!(o.hot.getSelectedLast()&&!o.hot.selection.isSelectedByCorner())||!o.checkSelectionCommentsConsistency():!0}})}},{key:"getDisplayDelaySetting",value:function(){var i=this.hot.getSettings()[j$];if(dn(i))return i.displayDelay}},{key:"destroy",value:function(){this.editor&&this.editor.destroy(),this.displaySwitch&&this.displaySwitch.destroy(),Zd(rc(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return j$}},{key:"PLUGIN_PRIORITY",get:function(){return q9e}}]),r}(Wn);function v1(e){"@babel/helpers - typeof";return v1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},v1(e)}function Z9e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function H9(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Q9e(n.key),n)}}function J9e(e,t,r){return t&&H9(e.prototype,t),r&&H9(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Q9e(e){var t=e7e(e,"string");return v1(t)==="symbol"?t:String(t)}function e7e(e,t){if(v1(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(v1(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var t7e=function(){function e(t){Z9e(this,e),this.hot=t,this.commands={},this.commonCallback=null}return J9e(e,[{key:"registerCommand",value:function(r,n){this.commands[r]=n}},{key:"setCommonCallback",value:function(r){this.commonCallback=r}},{key:"execute",value:function(r){for(var n=this,i=arguments.length,o=new Array(i>1?i-1:0),s=1;s<i;s++)o[s-1]=arguments[s];var a=r.split(":"),h=a[0],p=a.length===2?a[1]:null,g=this.commands[h];if(!g)throw new Error("Menu command '".concat(h,"' not exists."));if(p&&g.submenu&&(g=r7e(p,g.submenu.items)),g.disabled!==!0&&!(typeof g.disabled=="function"&&g.disabled.call(this.hot)===!0)&&!Ui(g,"submenu")){var S=[];typeof g.callback=="function"&&S.push(g.callback),typeof this.commonCallback=="function"&&S.push(this.commonCallback),o.unshift(a.join(":")),Le(S,function(T){return T.apply(n.hot,o)})}}}]),e}();function r7e(e,t){var r;return Le(t,function(n){var i=n.key?n.key.split(":"):null;if(Array.isArray(i)&&i[1]===e)return r=n,!1}),r}const Kse=t7e;var Es="alignment";function n7e(){return{key:Es,name:function(){return this.getTranslatedPhrase(uV)},disabled:function(){return this.countRows()===0||this.countCols()===0?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:"".concat(Es,":left"),name:function(){var t=this,r=this.getTranslatedPhrase(cV),n=Ql(this.getSelectedRange(),function(i,o){var s=t.getCellMeta(i,o).className;if(s&&s.indexOf("htLeft")!==-1)return!0});return n&&(r=Vu(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Cd(r,function(s,a){return t.getCellMeta(s,a).className}),i="horizontal",o="htLeft";this.runHooks("beforeCellAlignment",n,r,i,o),kf(r,i,o,function(s,a){return t.getCellMeta(s,a)},function(s,a,h,p){return t.setCellMeta(s,a,h,p)}),this.render()},disabled:!1},{key:"".concat(Es,":center"),name:function(){var t=this,r=this.getTranslatedPhrase(fV),n=Ql(this.getSelectedRange(),function(i,o){var s=t.getCellMeta(i,o).className;if(s&&s.indexOf("htCenter")!==-1)return!0});return n&&(r=Vu(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Cd(r,function(s,a){return t.getCellMeta(s,a).className}),i="horizontal",o="htCenter";this.runHooks("beforeCellAlignment",n,r,i,o),kf(r,i,o,function(s,a){return t.getCellMeta(s,a)},function(s,a,h,p){return t.setCellMeta(s,a,h,p)}),this.render()},disabled:!1},{key:"".concat(Es,":right"),name:function(){var t=this,r=this.getTranslatedPhrase(hV),n=Ql(this.getSelectedRange(),function(i,o){var s=t.getCellMeta(i,o).className;if(s&&s.indexOf("htRight")!==-1)return!0});return n&&(r=Vu(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Cd(r,function(s,a){return t.getCellMeta(s,a).className}),i="horizontal",o="htRight";this.runHooks("beforeCellAlignment",n,r,i,o),kf(r,i,o,function(s,a){return t.getCellMeta(s,a)},function(s,a,h,p){return t.setCellMeta(s,a,h,p)}),this.render()},disabled:!1},{key:"".concat(Es,":justify"),name:function(){var t=this,r=this.getTranslatedPhrase(dV),n=Ql(this.getSelectedRange(),function(i,o){var s=t.getCellMeta(i,o).className;if(s&&s.indexOf("htJustify")!==-1)return!0});return n&&(r=Vu(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Cd(r,function(s,a){return t.getCellMeta(s,a).className}),i="horizontal",o="htJustify";this.runHooks("beforeCellAlignment",n,r,i,o),kf(r,i,o,function(s,a){return t.getCellMeta(s,a)},function(s,a,h,p){return t.setCellMeta(s,a,h,p)}),this.render()},disabled:!1},{name:fn},{key:"".concat(Es,":top"),name:function(){var t=this,r=this.getTranslatedPhrase(pV),n=Ql(this.getSelectedRange(),function(i,o){var s=t.getCellMeta(i,o).className;if(s&&s.indexOf("htTop")!==-1)return!0});return n&&(r=Vu(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Cd(r,function(s,a){return t.getCellMeta(s,a).className}),i="vertical",o="htTop";this.runHooks("beforeCellAlignment",n,r,i,o),kf(r,i,o,function(s,a){return t.getCellMeta(s,a)},function(s,a,h,p){return t.setCellMeta(s,a,h,p)}),this.render()},disabled:!1},{key:"".concat(Es,":middle"),name:function(){var t=this,r=this.getTranslatedPhrase(mV),n=Ql(this.getSelectedRange(),function(i,o){var s=t.getCellMeta(i,o).className;if(s&&s.indexOf("htMiddle")!==-1)return!0});return n&&(r=Vu(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Cd(r,function(s,a){return t.getCellMeta(s,a).className}),i="vertical",o="htMiddle";this.runHooks("beforeCellAlignment",n,r,i,o),kf(r,i,o,function(s,a){return t.getCellMeta(s,a)},function(s,a,h,p){return t.setCellMeta(s,a,h,p)}),this.render()},disabled:!1},{key:"".concat(Es,":bottom"),name:function(){var t=this,r=this.getTranslatedPhrase(yV),n=Ql(this.getSelectedRange(),function(i,o){var s=t.getCellMeta(i,o).className;if(s&&s.indexOf("htBottom")!==-1)return!0});return n&&(r=Vu(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Cd(r,function(s,a){return t.getCellMeta(s,a).className}),i="vertical",o="htBottom";this.runHooks("beforeCellAlignment",n,r,i,o),kf(r,i,o,function(s,a){return t.getCellMeta(s,a)},function(s,a,h,p){return t.setCellMeta(s,a,h,p)}),this.render()},disabled:!1}]}}}var zA="clear_column";function i7e(){return{key:zA,name:function(){return this.getTranslatedPhrase(q3)},callback:function(t,r){var n=r[0].start.col,i=r[0].end.col;this.countRows()&&this.populateFromArray(0,n,[[null]],Math.max(r[0].start.row,r[0].end.row),i,"ContextMenu.clearColumn")},disabled:function(){var t=om(this);return t?!this.selection.isSelectedByColumnHeader():!0}}}var _C="col_left";function o7e(){return{key:_C,name:function(){return this.getTranslatedPhrase(H3)},callback:function(){var t=this.getSelectedRangeLast().getTopLeftCorner(),r=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(r,t.col,1,"ContextMenu.columnLeft")},disabled:function(){if(!this.isColumnModificationAllowed())return!0;var t=om(this);if(!t)return!0;if(this.selection.isSelectedByCorner()){var r=this.countCols();return r===0}return this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden:function(){return!this.getSettings().allowInsertColumn}}}var bC="col_right";function a7e(){return{key:bC,name:function(){return this.getTranslatedPhrase(V3)},callback:function(){var t=this.getSelectedRangeLast().getTopRightCorner(),r=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(r,t.col,1,"ContextMenu.columnRight")},disabled:function(){if(!this.isColumnModificationAllowed())return!0;var t=om(this);return t?this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols:!0},hidden:function(){return!this.getSettings().allowInsertColumn}}}var wC="make_read_only";function s7e(){return{key:wC,name:function(){var t=this,r=this.getTranslatedPhrase(K3),n=Ql(this.getSelectedRange(),function(i,o){return t.getCellMeta(i,o).readOnly});return n&&(r=Vu(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Ql(r,function(i,o){return t.getCellMeta(i,o).readOnly});Le(r,function(i){i.forAll(function(o,s){o>=0&&s>=0&&t.setCellMeta(o,s,"readOnly",!n)})}),this.render()},disabled:function(){return!!(this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}var FA="redo";function l7e(){return{key:FA,name:function(){return this.getTranslatedPhrase(Y3)},callback:function(){this.redo()},hidden:function(){var t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled:function(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}function qse(e,t){return h7e(e)||f7e(e,t)||c7e(e,t)||u7e()}function u7e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function c7e(e,t){if(e){if(typeof e=="string")return V9(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return V9(e,t)}}function V9(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function f7e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],h=!0,p=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;h=!1}else for(;!(h=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);h=!0);}catch(g){p=!0,i=g}finally{try{if(!h&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(p)throw i}}return a}}function h7e(e){if(Array.isArray(e))return e}function qB(e){"@babel/helpers - typeof";return qB=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qB(e)}var HA=0,VA=1,Xse=2,iU=3,d7e=[iU,Xse],p7e=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],z$=Symbol("root"),U9=Symbol("child");function zv(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:z$;if(t!==z$&&t!==U9)throw new Error("The second argument is used internally only and cannot be overwritten.");var r=Array.isArray(e),n=t===z$,i=HA;if(r){var o=e[0];if(e.length===0)i=VA;else if(n&&o instanceof w3)i=iU;else if(n&&Array.isArray(o))i=zv(o,U9);else if(e.length>=2&&e.length<=4){var s=!e.some(function(a,h){return!p7e[h].includes(qB(a))});s&&(i=Xse)}}return i}function _1(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=t.keepDirection,n=r===void 0?!1:r,i=t.propToCol;if(!d7e.includes(e))throw new Error("Unsupported selection ranges schema type was provided.");return function(o){var s=e===iU,a=s?o.from.row:o[0],h=s?o.from.col:o[1],p=s?o.to.row:o[2],g=s?o.to.col:o[3];if(typeof i=="function"&&(typeof h=="string"&&(h=i(h)),typeof g=="string"&&(g=i(g))),si(p)&&(p=a),si(g)&&(g=h),!n){var S=a,T=h,R=p,A=g;a=Math.min(S,R),h=Math.min(T,A),p=Math.max(S,R),g=Math.max(T,A)}return[a,h,p,g]}}function m7e(e){var t=zv(e);if(t===HA||t===VA)return[];var r=_1(t),n=new Set;Le(e,function(s){var a=r(s),h=qse(a,4),p=h[1],g=h[3],S=Math.max(p,0),T=g-S+1;Le(Array.from(new Array(T),function(R,A){return S+A}),function(R){n.has(R)||n.add(R)})});var i=Array.from(n).sort(function(s,a){return s-a}),o=na(i,function(s,a,h,p){return h!==0&&a===p[h-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s},[]);return o}function y7e(e){var t=zv(e);if(t===HA||t===VA)return[];var r=_1(t),n=new Set;Le(e,function(s){var a=r(s),h=qse(a,3),p=h[0],g=h[2],S=Math.max(p,0),T=g-S+1;Le(Array.from(new Array(T),function(R,A){return S+A}),function(R){n.has(R)||n.add(R)})});var i=Array.from(n).sort(function(s,a){return s-a}),o=na(i,function(s,a,h,p){return h!==0&&a===p[h-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s},[]);return o}function wf(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;return typeof e=="number"&&e>=0&&e<t}function g7e(e,t){return w7e(e)||b7e(e,t)||_7e(e,t)||v7e()}function v7e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _7e(e,t){if(e){if(typeof e=="string")return W9(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return W9(e,t)}}function W9(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function b7e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],h=!0,p=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;h=!1}else for(;!(h=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);h=!0);}catch(g){p=!0,i=g}finally{try{if(!h&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(p)throw i}}return a}}function w7e(e){if(Array.isArray(e))return e}var SC="remove_col";function S7e(){return{key:SC,name:function(){var t=this.getSelected(),r=0;if(t)if(t.length>1)r=1;else{var n=g7e(t[0],4),i=n[1],o=n[3];i-o!==0&&(r=1)}return this.getTranslatedPhrase(W3,r)},callback:function(){this.alter("remove_col",m7e(this.getSelected()),null,"ContextMenu.removeColumn")},disabled:function(){if(!this.isColumnModificationAllowed())return!0;var t=om(this);if(!t)return!0;var r=this.countCols();return this.selection.isSelectedByCorner()?r===0:this.selection.isSelectedByRowHeader()||r===0},hidden:function(){return!this.getSettings().allowRemoveColumn}}}function x7e(e,t){return O7e(e)||T7e(e,t)||E7e(e,t)||C7e()}function C7e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function E7e(e,t){if(e){if(typeof e=="string")return G9(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return G9(e,t)}}function G9(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function T7e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],h=!0,p=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;h=!1}else for(;!(h=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);h=!0);}catch(g){p=!0,i=g}finally{try{if(!h&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(p)throw i}}return a}}function O7e(e){if(Array.isArray(e))return e}var UA="remove_row";function R7e(){return{key:UA,name:function(){var t=this.getSelected(),r=0;if(t)if(t.length>1)r=1;else{var n=x7e(t[0],3),i=n[0],o=n[2];i-o!==0&&(r=1)}return this.getTranslatedPhrase(U3,r)},callback:function(){this.alter("remove_row",y7e(this.getSelected()),1,"ContextMenu.removeRow")},disabled:function(){var t=om(this);if(!t)return!0;var r=this.countRows();return this.selection.isSelectedByCorner()?r===0:this.selection.isSelectedByColumnHeader()||r===0},hidden:function(){return!this.getSettings().allowRemoveRow}}}var WA="row_above";function k7e(){return{key:WA,name:function(){return this.getTranslatedPhrase(z3)},callback:function(){var t=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",t.row,1,"ContextMenu.rowAbove")},disabled:function(){var t=om(this);if(!t)return!0;if(this.selection.isSelectedByCorner()){var r=this.countRows();return r===0}return this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden:function(){return!this.getSettings().allowInsertRow}}}var GA="row_below";function P7e(){return{key:GA,name:function(){return this.getTranslatedPhrase(F3)},callback:function(){var t=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",t.row,1,"ContextMenu.rowBelow")},disabled:function(){var t=om(this);return t?this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows:!0},hidden:function(){return!this.getSettings().allowInsertRow}}}var b1="no_items";function A7e(){return{key:b1,name:function(){return this.getTranslatedPhrase(j3)},disabled:!0,isCommand:!1}}var YA="undo";function I7e(){return{key:YA,name:function(){return this.getTranslatedPhrase(G3)},callback:function(){this.undo()},hidden:function(){var t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled:function(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}function w1(e){"@babel/helpers - typeof";return w1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},w1(e)}var la;function Ka(e,t,r){return t=M7e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function M7e(e){var t=D7e(e,"string");return w1(t)==="symbol"?t:String(t)}function D7e(e,t){if(w1(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(w1(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var $7e=[WA,GA,_C,bC,zA,UA,SC,YA,FA,wC,Es,fn,b1],L7e=(la={},Ka(la,fn,S9e),Ka(la,b1,A7e),Ka(la,WA,k7e),Ka(la,GA,P7e),Ka(la,_C,o7e),Ka(la,bC,a7e),Ka(la,zA,i7e),Ka(la,UA,R7e),Ka(la,SC,S7e),Ka(la,YA,I7e),Ka(la,FA,l7e),Ka(la,wC,s7e),Ka(la,Es,n7e),la);function Zse(){var e={};return pn(L7e,function(t,r){e[r]=t()}),e}function S1(e){"@babel/helpers - typeof";return S1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},S1(e)}function N7e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Y9(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,j7e(n.key),n)}}function B7e(e,t,r){return t&&Y9(e.prototype,t),r&&Y9(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function j7e(e){var t=z7e(e,"string");return S1(t)==="symbol"?t:String(t)}function z7e(e,t){if(S1(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(S1(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var F7e=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;N7e(this,e),this.hot=t,this.predefinedItems=Zse(),this.defaultOrderPattern=r}return B7e(e,[{key:"setPredefinedItems",value:function(r){var n=this,i={};this.defaultOrderPattern.length=0,pn(r,function(o,s){var a="";o.name===fn?(i[fn]=o,a=fn):isNaN(parseInt(s,10))?(o.key=o.key===void 0?s:o.key,i[s]=o,a=o.key):(i[o.key]=o,a=o.key),n.defaultOrderPattern.push(a)}),this.predefinedItems=i}},{key:"getItems",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return H7e(r,this.defaultOrderPattern,this.predefinedItems)}}]),e}();function H7e(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=[],i=e;return i&&i.items?i=i.items:Array.isArray(i)||(i=t),dn(i)?pn(i,function(o,s){var a=r[typeof o=="string"?o:s];a||(a=o),dn(o)?ao(a,o):typeof a=="string"&&(a={name:a}),a.key===void 0&&(a.key=s),n.push(a)}):Le(i,function(o,s){var a=r[o];!a&&$7e.indexOf(o)>=0||(a||(a={name:o,key:"".concat(s)}),dn(o)&&ao(a,o),a.key===void 0&&(a.key=s),n.push(a))}),n}const Jse=F7e;function x1(e){"@babel/helpers - typeof";return x1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},x1(e)}function V7e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function K9(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,W7e(n.key),n)}}function U7e(e,t,r){return t&&K9(e.prototype,t),r&&K9(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function W7e(e){var t=G7e(e,"string");return x1(t)==="symbol"?t:String(t)}function G7e(e,t){if(x1(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(x1(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Y7e=function(){function e(t,r){V7e(this,e);var n=RS(r),i=zg(r),o,s,a,h,p,g;this.rootWindow=r,this.type=this.getSourceType(t),this.type==="literal"?(o=parseInt(t.top,10),a=parseInt(t.left,10),p=t.height||0,g=t.width||0,s=o,h=a,o+=n,a+=i):this.type==="event"&&(o=parseInt(t.pageY,10),a=parseInt(t.pageX,10),p=t.target.clientHeight,g=t.target.clientWidth,s=o-n,h=a-i),this.top=o,this.topRelative=s,this.left=a,this.leftRelative=h,this.scrollTop=n,this.scrollLeft=i,this.cellHeight=p,this.cellWidth=g}return U7e(e,[{key:"getSourceType",value:function(r){var n="literal";return r instanceof Event&&(n="event"),n}},{key:"fitsAbove",value:function(r){return this.topRelative>=r.offsetHeight}},{key:"fitsBelow",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+r.offsetHeight<=n}},{key:"fitsOnRight",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+r.offsetWidth<=n}},{key:"fitsOnLeft",value:function(r){return this.leftRelative>=r.offsetWidth}}]),e}();const K7e=Y7e;var q7e=Kp,X7e=/(?:ipad|iphone|ipod).*applewebkit/i.test(q7e),Z7e=cu,Qse=typeof process<"u"&&Z7e(process)=="process",os=ni,J7e=tm,Q7e=Jx,q9=vi,eXe=Ni,ele=nn,X9=kre,tXe=nC,Z9=XP,rXe=qoe,nXe=X7e,iXe=Qse,XB=os.setImmediate,ZB=os.clearImmediate,oXe=os.process,F$=os.Dispatch,aXe=os.Function,J9=os.MessageChannel,sXe=os.String,H$=0,K0={},Q9="onreadystatechange",C1,Ed,V$,U$;ele(function(){C1=os.location});var oU=function(e){if(eXe(K0,e)){var t=K0[e];delete K0[e],t()}},W$=function(e){return function(){oU(e)}},e7=function(e){oU(e.data)},t7=function(e){os.postMessage(sXe(e),C1.protocol+"//"+C1.host)};(!XB||!ZB)&&(XB=function(t){rXe(arguments.length,1);var r=q9(t)?t:aXe(t),n=tXe(arguments,1);return K0[++H$]=function(){J7e(r,void 0,n)},Ed(H$),H$},ZB=function(t){delete K0[t]},iXe?Ed=function(e){oXe.nextTick(W$(e))}:F$&&F$.now?Ed=function(e){F$.now(W$(e))}:J9&&!nXe?(V$=new J9,U$=V$.port2,V$.port1.onmessage=e7,Ed=Q7e(U$.postMessage,U$)):os.addEventListener&&q9(os.postMessage)&&!os.importScripts&&C1&&C1.protocol!=="file:"&&!ele(t7)?(Ed=t7,os.addEventListener("message",e7,!1)):Q9 in Z9("script")?Ed=function(e){X9.appendChild(Z9("script"))[Q9]=function(){X9.removeChild(this),oU(e)}}:Ed=function(e){setTimeout(W$(e),0)});var tle={set:XB,clear:ZB},lXe=Br,uXe=ni,r7=tle.clear;lXe({global:!0,bind:!0,enumerable:!0,forced:uXe.clearImmediate!==r7},{clearImmediate:r7});var cXe=Br,rle=ni,n7=tle.set,fXe=o3,i7=rle.setImmediate?fXe(n7,!1):n7;cXe({global:!0,bind:!0,enumerable:!0,forced:rle.setImmediate!==i7},{setImmediate:i7});var hXe=so,dXe=sA,pXe=Wi,mXe=_l,yXe=Zp,G$=Qi,gXe=Fa,vXe=Xp,_Xe=pH,o7=lA;dXe("match",function(e,t,r){return[function(i){var o=gXe(this),s=mXe(i)?void 0:vXe(i,e);return s?hXe(s,i,o):new RegExp(i)[e](G$(o))},function(n){var i=pXe(this),o=G$(n),s=r(t,i,o);if(s.done)return s.value;if(!i.global)return o7(i,o);var a=i.unicode;i.lastIndex=0;for(var h=[],p=0,g;(g=o7(i,o))!==null;){var S=G$(g[0]);h[p]=S,S===""&&(i.lastIndex=_Xe(o,yXe(i.lastIndex),a)),p++}return p===0?null:h}]});var bXe=tm,wXe=cs,SXe=wh,xXe=Ns,CXe=tb,EXe=Math.min,JB=[].lastIndexOf,nle=!!JB&&1/[1].lastIndexOf(1,-0)<0,TXe=CXe("lastIndexOf"),OXe=nle||!TXe,RXe=OXe?function(t){if(nle)return bXe(JB,this,arguments)||0;var r=wXe(this),n=xXe(r),i=n-1;for(arguments.length>1&&(i=EXe(i,SXe(arguments[1]))),i<0&&(i=n+i);i>=0;i--)if(i in r&&r[i]===t)return i||0;return-1}:JB,kXe=Br,a7=RXe;kXe({target:"Array",proto:!0,forced:a7!==[].lastIndexOf},{lastIndexOf:a7});var PXe=qp,AXe=Ha,IXe=Nx,MXe=Ns,DXe=TypeError,s7=function(e){return function(t,r,n,i){PXe(r);var o=AXe(t),s=IXe(o),a=MXe(o),h=e?a-1:0,p=e?-1:1;if(n<2)for(;;){if(h in s){i=s[h],h+=p;break}if(h+=p,e?h<0:a<=h)throw DXe("Reduce of empty array with no initial value")}for(;e?h>=0:a>h;h+=p)h in s&&(i=r(i,s[h],h,o));return i}},$Xe={left:s7(!1),right:s7(!0)},LXe=Br,NXe=$Xe.left,BXe=tb,l7=Bx,jXe=Qse,zXe=!jXe&&l7>79&&l7<83,FXe=zXe||!BXe("reduce");LXe({target:"Array",proto:!0,forced:FXe},{reduce:function(t){var r=arguments.length;return NXe(this,t,r,r>1?arguments[1]:void 0)}});function Y$(e){return WXe(e)||UXe(e)||VXe(e)||HXe()}function HXe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function VXe(e,t){if(e){if(typeof e=="string")return QB(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return QB(e,t)}}function UXe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function WXe(e){if(Array.isArray(e))return QB(e)}function QB(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var ile={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},GXe=new RegExp(Object.keys(ile).map(function(e){return"(".concat(e,")")}).join("|"),"gi");function YXe(e){return(e&&e.nodeName||"")==="TABLE"}function u7(e){for(var t=e.hasColHeaders(),r=e.hasRowHeaders(),n=[t?-1:0,r?-1:0,e.countRows()-1,e.countCols()-1],i=e.getData.apply(e,n),o=i.length,s=o>0?i[0].length:0,a=["<table>","</table>"],h=t?["<thead>","</thead>"]:[],p=["<tbody>","</tbody>"],g=r?1:0,S=t?1:0,T=0;T<o;T+=1){for(var R=t&&T===0,A=[],$=0;$<s;$+=1){var j=!R&&r&&$===0,z="";if(R)z="<th>".concat(e.getColHeader($-g),"</th>");else if(j)z="<th>".concat(e.getRowHeader(T-S),"</th>");else{var V=i[T][$],G=e.getCellMeta(T-S,$-g),ee=G.hidden,K=G.rowspan,xe=G.colspan;if(!ee){var Me=[];if(K&&Me.push('rowspan="'.concat(K,'"')),xe&&Me.push('colspan="'.concat(xe,'"')),go(V))z="<td ".concat(Me.join(" "),"></td>");else{var He=V.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");z="<td ".concat(Me.join(" "),">").concat(He,"</td>")}}}A.push(z)}var Ne=["<tr>"].concat(A,["</tr>"]).join("");R?h.splice(1,0,Ne):p.splice(-1,0,Ne)}return a.splice(1,0,h.join(""),p.join("")),a.join("")}function c7(e){for(var t=e.length,r=["<table>"],n=0;n<t;n+=1){var i=e[n],o=i.length,s=[];n===0&&r.push("<tbody>");for(var a=0;a<o;a+=1){var h=i[a],p=go(h)?"":h.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");s.push("<td>".concat(p,"</td>"))}r.push.apply(r,["<tr>"].concat(s,["</tr>"])),n+1===t&&r.push("</tbody>")}return r.push("</table>"),r.join("")}function KXe(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document,r={},n=t.createDocumentFragment(),i=t.createElement("div");n.appendChild(i);var o=e;if(typeof o=="string"){var s=o.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,function(ne){var ye=ne.match(/<td\b[^>]*?>/g)[0],ve=ne.substring(ye.length,ne.lastIndexOf("<")).replace(/(<(?!br)([^>]+)>)/gi,""),ze="</td>";return"".concat(ye).concat(ve).concat(ze)});i.insertAdjacentHTML("afterbegin","".concat(s)),o=i.querySelector("table")}if(!(!o||!YXe(o))){var a=i.querySelector('meta[name$="enerator"]'),h=o.querySelector("tbody th")!==null,p=o.querySelector("tr"),g=p?Array.from(p.cells).reduce(function(ne,ye){return ne+ye.colSpan},0)-(h?1:0):0,S=o.tFoot&&Array.from(o.tFoot.rows)||[],T=[],R=!1,A=0,$=0;if(o.tHead){var j=Array.from(o.tHead.rows).filter(function(ne){var ye=ne.querySelector("td")!==null;return ye&&T.push(ne),!ye});A=j.length,R=A>0,A>1?r.nestedHeaders=Array.from(j).reduce(function(ne,ye){var ve=Array.from(ye.cells).reduce(function(ze,je,Je){if(h&&Je===0)return ze;var xt=je.colSpan,kt=je.innerHTML,jt=xt>1?{label:kt,colspan:xt}:kt;return ze.push(jt),ze},[]);return ne.push(ve),ne},[]):R&&(r.colHeaders=Array.from(j[0].children).reduce(function(ne,ye,ve){return h&&ve===0||ne.push(ye.innerHTML),ne},[]))}T.length&&(r.fixedRowsTop=T.length),S.length&&(r.fixedRowsBottom=S.length);var z=[].concat(T,Y$(Array.from(o.tBodies).reduce(function(ne,ye){return ne.push.apply(ne,Y$(Array.from(ye.rows))),ne},[])),Y$(S));$=z.length;for(var V=new Array($),G=0;G<$;G++)V[G]=new Array(g);for(var ee=[],K=[],xe=0;xe<$;xe++)for(var Me=z[xe],He=Array.from(Me.cells),Ne=He.length,We=0;We<Ne;We++){var gt=He[We],Lt=gt.nodeName,_t=gt.innerHTML,$e=gt.rowSpan,Fe=gt.colSpan,At=V[xe].findIndex(function(ne){return ne===void 0});if(Lt==="TD"){if($e>1||Fe>1){for(var Gt=xe;Gt<xe+$e;Gt++)if(Gt<$)for(var ae=At;ae<At+Fe;ae++)V[Gt][ae]=null;var D=gt.getAttribute("style"),U=D&&D.includes("mso-ignore:colspan");U||ee.push({col:At,row:xe,rowspan:$e,colspan:Fe})}var q="";a&&/excel/gi.test(a.content)?q=_t.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):q=_t.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),V[xe][At]=q.replace(GXe,function(ne){return ile[ne]})}else K.push(_t)}return ee.length&&(r.mergeCells=ee),K.length&&(r.rowHeaders=K),V.length&&(r.data=V),r}}function f7(e){var t=e.isShiftKey,r=e.isLeftClick,n=e.isRightClick,i=e.coords,o=e.selection,s=e.controller,a=e.cellCoordsFactory,h=o.isSelected()?o.getSelectedRange().current():null,p=o.isSelectedByCorner(),g=o.isSelectedByRowHeader();if(t&&h)i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(i):(p||g)&&i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(a(i.row,i.col)):p&&i.row<0&&!s.column?o.setRangeEnd(a(h.to.row,i.col)):g&&i.col<0&&!s.row?o.setRangeEnd(a(i.row,h.to.col)):(!p&&!g&&i.col<0||p&&i.col<0)&&!s.row?o.selectRows(Math.max(h.from.row,0),i.row,i.col):(!p&&!g&&i.row<0||g&&i.row<0)&&!s.column&&o.selectColumns(Math.max(h.from.col,0),i.col,i.row);else{var S=!o.inInSelection(i),T=r||n&&S;i.row<0&&i.col>=0&&!s.column?T&&o.selectColumns(i.col,i.col,i.row):i.col<0&&i.row>=0&&!s.row?T&&o.selectRows(i.row,i.row,i.col):i.col>=0&&i.row>=0&&!s.cell?T&&o.setRangeStart(i):i.col<0&&i.row<0&&o.selectAll(!0,!0)}}function qXe(e){var t=e.isLeftClick,r=e.coords,n=e.selection,i=e.controller,o=e.cellCoordsFactory;if(t){var s=n.isSelectedByRowHeader(),a=n.isSelectedByColumnHeader(),h=n.tableProps.countCols(),p=n.tableProps.countRows();a&&!i.column?n.setRangeEnd(o(p-1,r.col)):s&&!i.row?n.setRangeEnd(o(r.row,h-1)):i.cell||n.setRangeEnd(r)}}var XXe=new Map([["mousedown",f7],["mouseover",qXe],["touchstart",f7]]);function h7(e,t){var r=t.coords,n=t.selection,i=t.controller,o=t.cellCoordsFactory;XXe.get(e.type)({coords:r,selection:n,controller:i,cellCoordsFactory:o,isShiftKey:e.shiftKey,isLeftClick:JH(e)||e.type==="touchstart",isRightClick:Pp(e)})}var ole=new WeakMap,aU=Symbol("rootInstance");function ZXe(e){ole.set(e,!0)}function JXe(e){return e===aU}function ej(e){return ole.has(e)}function E1(e){"@babel/helpers - typeof";return E1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},E1(e)}function r0(e,t){return tZe(e)||eZe(e,t)||ale(e,t)||QXe()}function QXe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function eZe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],h=!0,p=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;h=!1}else for(;!(h=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);h=!0);}catch(g){p=!0,i=g}finally{try{if(!h&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(p)throw i}}return a}}function tZe(e){if(Array.isArray(e))return e}function d7(e){return iZe(e)||nZe(e)||ale(e)||rZe()}function rZe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ale(e,t){if(e){if(typeof e=="string")return tj(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return tj(e,t)}}function nZe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function iZe(e){if(Array.isArray(e))return tj(e)}function tj(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function oZe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,sle(n.key),n)}}function aZe(e,t,r){return t&&p7(e.prototype,t),r&&p7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function m7(e,t,r){sZe(e,t),t.set(e,r)}function sZe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Sf(e,t,r){return t=sle(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function sle(e){var t=lZe(e,"string");return E1(t)==="symbol"?t:String(t)}function lZe(e,t){if(E1(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(E1(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function y7(e,t){var r=lle(e,t,"get");return uZe(e,r)}function uZe(e,t){return t.get?t.get.call(e):t.value}function g7(e,t,r){var n=lle(e,t,"set");return cZe(e,n,r),r}function lle(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function cZe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var Td=new WeakMap,K$=new WeakMap,q$=new WeakMap,fZe=function(){function e(t){oZe(this,e),Sf(this,"instance",void 0),Sf(this,"eventManager",void 0),Sf(this,"settings",void 0),Sf(this,"THEAD",void 0),Sf(this,"TBODY",void 0),Sf(this,"_wt",void 0),Sf(this,"activeWt",void 0),m7(this,K$,{writable:!0,value:0}),m7(this,q$,{writable:!0,value:0}),Sf(this,"postponedAdjustElementsSize",!1),this.instance=t,this.eventManager=new Bi(this.instance),this.settings=this.instance.getSettings(),Td.set(this,{selectionMouseDown:!1,mouseDown:void 0,table:void 0,lastWidth:0,lastHeight:0}),this.createElements(),this.registerEvents(),this.initializeWalkontable()}return aZe(e,[{key:"render",value:function(){this.instance.isRenderSuspended()||(this.instance.runHooks("beforeRender",this.instance.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this._wt.draw(!this.instance.forceFullRender),this.instance.runHooks("afterRender",this.instance.forceFullRender),this.instance.forceFullRender=!1,this.instance.renderCall=!1)}},{key:"adjustElementsSize",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.instance.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize(r)}},{key:"getCellAtCoords",value:function(r,n){var i=this._wt.getCell(r,n);return i<0?null:i}},{key:"scrollViewport",value:function(r,n,i,o,s){return this._wt.scrollViewport(r,n,i,o,s)}},{key:"scrollViewportHorizontally",value:function(r,n,i){return this._wt.scrollViewportHorizontally(r,n,i)}},{key:"scrollViewportVertically",value:function(r,n,i){return this._wt.scrollViewportVertically(r,n,i)}},{key:"createElements",value:function(){var r=Td.get(this),n=this.instance,i=n.rootElement,o=n.rootDocument,s=i.getAttribute("style");s&&i.setAttribute("data-originalstyle",s),Ht(i,"handsontable"),r.table=o.createElement("TABLE"),Ht(r.table,"htCore"),this.instance.getSettings().tableClassName&&Ht(r.table,this.instance.getSettings().tableClassName),this.THEAD=o.createElement("THEAD"),r.table.appendChild(this.THEAD),this.TBODY=o.createElement("TBODY"),r.table.appendChild(this.TBODY),this.instance.table=r.table,this.instance.container.insertBefore(r.table,this.instance.container.firstChild)}},{key:"registerEvents",value:function(){var r=this,n=Td.get(this),i=this.instance,o=i.rootElement,s=i.rootDocument,a=i.selection,h=s.documentElement;this.eventManager.addEventListener(o,"mousedown",function(p){if(n.selectionMouseDown=!0,!r.isTextSelectionAllowed(p.target)){var g=r.instance.rootWindow;jY(g),p.preventDefault(),g.focus()}}),this.eventManager.addEventListener(o,"mouseup",function(){n.selectionMouseDown=!1}),this.eventManager.addEventListener(o,"mousemove",function(p){n.selectionMouseDown&&!r.isTextSelectionAllowed(p.target)&&(r.settings.fragmentSelection&&jY(r.instance.rootWindow),p.preventDefault())}),this.eventManager.addEventListener(h,"keyup",function(p){a.isInProgress()&&!p.shiftKey&&a.finish()}),this.eventManager.addEventListener(h,"mouseup",function(p){a.isInProgress()&&JH(p)&&a.finish(),n.mouseDown=!1,(n3(s.activeElement)||!a.isSelected()&&!a.isSelectedByAnyHeader()&&!o.contains(p.target)&&!Pp(p))&&r.instance.unlisten()}),this.eventManager.addEventListener(h,"contextmenu",function(p){a.isInProgress()&&Pp(p)&&(a.finish(),n.mouseDown=!1)}),this.eventManager.addEventListener(h,"touchend",function(){a.isInProgress()&&a.finish(),n.mouseDown=!1}),this.eventManager.addEventListener(h,"mousedown",function(p){var g=p.target,S=p.x||p.clientX,T=p.y||p.clientY,R=p.target;if(!(n.mouseDown||!o||!r.instance.view)){var A=r.instance.view._wt.wtTable.holder;if(R===A){var $=Ao(s);if(s.elementFromPoint(S+$,T)!==A||s.elementFromPoint(S,T+$)!==A)return}else for(;R!==h;){if(R===null){if(p.isTargetWebComponent)break;return}if(R===o)return;R=R.parentNode}var j=typeof r.settings.outsideClickDeselects=="function"?r.settings.outsideClickDeselects(g):r.settings.outsideClickDeselects;j?r.instance.deselectCell():r.instance.destroyEditor(!1,!1)}}),this.eventManager.addEventListener(n.table,"selectstart",function(p){r.settings.fragmentSelection||Tk(p.target)||p.preventDefault()})}},{key:"translateFromRenderableToVisualCoords",value:function(r){var n,i=r.row,o=r.col;return(n=this.instance)._createCellCoords.apply(n,d7(this.translateFromRenderableToVisualIndex(i,o)))}},{key:"translateFromRenderableToVisualIndex",value:function(r,n){var i=r>=0?this.instance.rowIndexMapper.getVisualFromRenderableIndex(r):r,o=n>=0?this.instance.columnIndexMapper.getVisualFromRenderableIndex(n):n;return i===null&&(i=r),o===null&&(o=n),[i,o]}},{key:"countRenderableIndexes",value:function(r,n){var i=Math.min(r.getNotTrimmedIndexesLength(),n),o=r.getNearestNotHiddenIndex(i-1,-1);return o===null?0:r.getRenderableFromVisualIndex(o)+1}},{key:"countRenderableColumns",value:function(){return this.countRenderableIndexes(this.instance.columnIndexMapper,this.settings.maxCols)}},{key:"countRenderableRows",value:function(){return this.countRenderableIndexes(this.instance.rowIndexMapper,this.settings.maxRows)}},{key:"countNotHiddenRowIndexes",value:function(r,n){return this.countNotHiddenIndexes(r,n,this.instance.rowIndexMapper,this.countRenderableRows())}},{key:"countNotHiddenColumnIndexes",value:function(r,n){return this.countNotHiddenIndexes(r,n,this.instance.columnIndexMapper,this.countRenderableColumns())}},{key:"countNotHiddenIndexes",value:function(r,n,i,o){if(isNaN(r)||r<0)return 0;var s=i.getNearestNotHiddenIndex(r,n),a=i.getRenderableFromVisualIndex(s);if(!Number.isInteger(a))return 0;var h=0;return n<0?h=a+1:n>0&&(h=o-a),h}},{key:"countNotHiddenFixedColumnsStart",value:function(){var r=this.instance.countCols(),n=Math.min(parseInt(this.settings.fixedColumnsStart,10),r)-1;return this.countNotHiddenColumnIndexes(n,-1)}},{key:"countNotHiddenFixedRowsTop",value:function(){var r=this.instance.countRows(),n=Math.min(parseInt(this.settings.fixedRowsTop,10),r)-1;return this.countNotHiddenRowIndexes(n,-1)}},{key:"countNotHiddenFixedRowsBottom",value:function(){var r=this.instance.countRows(),n=Math.max(r-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(n,1)}},{key:"isMainTableNotFullyCoveredByOverlays",value:function(){var r=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),n=this.countNotHiddenFixedColumnsStart();return this.instance.countRenderedRows()>r&&this.instance.countRenderedCols()>n}},{key:"initializeWalkontable",value:function(){var r=this,n=Td.get(this),i={rtlMode:this.instance.isRtl(),externalRowCalculator:this.instance.getPlugin("autoRowSize")&&this.instance.getPlugin("autoRowSize").isEnabled(),table:n.table,isDataViewInstance:function(){return ej(r.instance)},preventOverflow:function(){return r.settings.preventOverflow},preventWheel:function(){return r.settings.preventWheel},stretchH:function(){return r.settings.stretchH},data:function(g,S){var T;return(T=r.instance).getDataAtCell.apply(T,d7(r.translateFromRenderableToVisualIndex(g,S)))},totalRows:function(){return r.countRenderableRows()},totalColumns:function(){return r.countRenderableColumns()},fixedColumnsStart:function(){return r.countNotHiddenFixedColumnsStart()},fixedRowsTop:function(){return r.countNotHiddenFixedRowsTop()},fixedRowsBottom:function(){return r.countNotHiddenFixedRowsBottom()},shouldRenderInlineStartOverlay:function(){return r.settings.fixedColumnsStart>0||i.rowHeaders().length>0},shouldRenderTopOverlay:function(){return r.settings.fixedRowsTop>0||i.columnHeaders().length>0},shouldRenderBottomOverlay:function(){return r.settings.fixedRowsBottom>0},minSpareRows:function(){return r.settings.minSpareRows},renderAllRows:this.settings.renderAllRows,rowHeaders:function(){var g=[];return r.instance.hasRowHeaders()&&g.push(function(S,T){var R=S>=0?r.instance.rowIndexMapper.getVisualFromRenderableIndex(S):S;r.appendRowHeader(R,T)}),r.instance.runHooks("afterGetRowHeaderRenderers",g),g7(r,q$,g.length),g},columnHeaders:function(){var g=[];return r.instance.hasColHeaders()&&g.push(function(S,T){var R=S>=0?r.instance.columnIndexMapper.getVisualFromRenderableIndex(S):S;r.appendColHeader(R,T)}),r.instance.runHooks("afterGetColumnHeaderRenderers",g),g7(r,K$,g.length),g},columnWidth:function(g){var S=r.instance.columnIndexMapper.getVisualFromRenderableIndex(g);return r.instance.getColWidth(S===null?g:S)},rowHeight:function(g){var S=r.instance.rowIndexMapper.getVisualFromRenderableIndex(g);return r.instance.getRowHeight(S===null?g:S)},cellRenderer:function(g,S,T){var R=r.translateFromRenderableToVisualIndex(g,S),A=r0(R,2),$=A[0],j=A[1],z=r.instance.runHooks("modifyGetCellCoords",$,j),V=$,G=j;if(Array.isArray(z)){var ee=r0(z,2);V=ee[0],G=ee[1]}var K=r.instance.getCellMeta(V,G),xe=r.instance.colToProp(G),Me=r.instance.getDataAtRowProp(V,xe);r.instance.hasHook("beforeValueRender")&&(Me=r.instance.runHooks("beforeValueRender",Me,K)),r.instance.runHooks("beforeRenderer",T,$,j,xe,Me,K),r.instance.getCellRenderer(K)(r.instance,T,$,j,xe,Me,K),r.instance.runHooks("afterRenderer",T,$,j,xe,Me,K)},selections:this.instance.selection.highlight,hideBorderOnMouseDownOver:function(){return r.settings.fragmentSelection},onWindowResize:function(){r.instance&&!r.instance.isDestroyed&&r.instance.refreshDimensions()},onContainerElementResize:function(){r.instance&&!r.instance.isDestroyed&&r.instance.refreshDimensions()},onCellMouseDown:function(g,S,T,R){var A=r.translateFromRenderableToVisualCoords(S),$={row:!1,column:!1,cell:!1};r.instance.listen(),r.activeWt=R,n.mouseDown=!0,r.instance.runHooks("beforeOnCellMouseDown",g,A,T,$),!Uy(g)&&(h7(g,{coords:A,selection:r.instance.selection,controller:$,cellCoordsFactory:function(z,V){return r.instance._createCellCoords(z,V)}}),r.instance.runHooks("afterOnCellMouseDown",g,A,T),r.activeWt=r._wt)},onCellContextMenu:function(g,S,T,R){var A=r.translateFromRenderableToVisualCoords(S);r.activeWt=R,n.mouseDown=!1,r.instance.selection.isInProgress()&&r.instance.selection.finish(),r.instance.runHooks("beforeOnCellContextMenu",g,A,T),!Uy(g)&&(r.instance.runHooks("afterOnCellContextMenu",g,A,T),r.activeWt=r._wt)},onCellMouseOut:function(g,S,T,R){var A=r.translateFromRenderableToVisualCoords(S);r.activeWt=R,r.instance.runHooks("beforeOnCellMouseOut",g,A,T),!Uy(g)&&(r.instance.runHooks("afterOnCellMouseOut",g,A,T),r.activeWt=r._wt)},onCellMouseOver:function(g,S,T,R){var A=r.translateFromRenderableToVisualCoords(S),$={row:!1,column:!1,cell:!1};r.activeWt=R,r.instance.runHooks("beforeOnCellMouseOver",g,A,T,$),!Uy(g)&&(n.mouseDown&&h7(g,{coords:A,selection:r.instance.selection,controller:$,cellCoordsFactory:function(z,V){return r.instance._createCellCoords(z,V)}}),r.instance.runHooks("afterOnCellMouseOver",g,A,T),r.activeWt=r._wt)},onCellMouseUp:function(g,S,T,R){var A=r.translateFromRenderableToVisualCoords(S);r.activeWt=R,r.instance.runHooks("beforeOnCellMouseUp",g,A,T),!(Uy(g)||r.instance.isDestroyed)&&(r.instance.runHooks("afterOnCellMouseUp",g,A,T),r.activeWt=r._wt)},onCellCornerMouseDown:function(g){g.preventDefault(),r.instance.runHooks("afterOnCellCornerMouseDown",g)},onCellCornerDblClick:function(g){g.preventDefault(),r.instance.runHooks("afterOnCellCornerDblClick",g)},beforeDraw:function(g,S){return r.beforeRender(g,S)},onDraw:function(g){return r.afterRender(g)},onScrollVertically:function(){return r.instance.runHooks("afterScrollVertically")},onScrollHorizontally:function(){return r.instance.runHooks("afterScrollHorizontally")},onBeforeRemoveCellClassNames:function(){return r.instance.runHooks("beforeRemoveCellClassNames")},onBeforeHighlightingRowHeader:function(g,S,T){var R=r.instance.rowIndexMapper,A=R.getVisualFromRenderableIndex(g),$=r.instance.runHooks("beforeHighlightingRowHeader",A,S,T);return R.getRenderableFromVisualIndex(R.getNearestNotHiddenIndex($,1))},onBeforeHighlightingColumnHeader:function(g,S,T){var R=r.instance.columnIndexMapper,A=R.getVisualFromRenderableIndex(g),$=r.instance.runHooks("beforeHighlightingColumnHeader",A,S,T);return R.getRenderableFromVisualIndex(R.getNearestNotHiddenIndex($,1))},onAfterDrawSelection:function(g,S,T){var R,A=r.translateFromRenderableToVisualIndex(g,S),$=r0(A,2),j=$[0],z=$[1],V=r.instance.selection.getSelectedRange(),G=V.size();if(G>0){var ee=(T??0)+1-G,K=V.peekByIndex(ee);R=[K.from.row,K.from.col,K.to.row,K.to.col]}return r.instance.runHooks("afterDrawSelection",j,z,R,T)},onBeforeDrawBorders:function(g,S){var T=r0(g,4),R=T[0],A=T[1],$=T[2],j=T[3],z=[r.instance.rowIndexMapper.getVisualFromRenderableIndex(R),r.instance.columnIndexMapper.getVisualFromRenderableIndex(A),r.instance.rowIndexMapper.getVisualFromRenderableIndex($),r.instance.columnIndexMapper.getVisualFromRenderableIndex(j)];return r.instance.runHooks("beforeDrawBorders",z,S)},onBeforeTouchScroll:function(){return r.instance.runHooks("beforeTouchScroll")},onAfterMomentumScroll:function(){return r.instance.runHooks("afterMomentumScroll")},onBeforeStretchingColumnWidth:function(g,S){var T=r.instance.columnIndexMapper.getVisualFromRenderableIndex(S);return r.instance.runHooks("beforeStretchingColumnWidth",g,T)},onModifyRowHeaderWidth:function(g){return r.instance.runHooks("modifyRowHeaderWidth",g)},onModifyGetCellCoords:function(g,S,T){var R=r.instance.rowIndexMapper,A=r.instance.columnIndexMapper,$=S>=0?A.getVisualFromRenderableIndex(S):S,j=g>=0?R.getVisualFromRenderableIndex(g):g,z=r.instance.runHooks("modifyGetCellCoords",j,$,T);if(Array.isArray(z)){var V=r0(z,4),G=V[0],ee=V[1],K=V[2],xe=V[3];return[G>=0?R.getRenderableFromVisualIndex(R.getNearestNotHiddenIndex(G,1)):G,ee>=0?A.getRenderableFromVisualIndex(A.getNearestNotHiddenIndex(ee,1)):ee,K>=0?R.getRenderableFromVisualIndex(R.getNearestNotHiddenIndex(K,-1)):K,xe>=0?A.getRenderableFromVisualIndex(A.getNearestNotHiddenIndex(xe,-1)):xe]}},viewportRowCalculatorOverride:function(g){var S=r.settings.viewportRowRenderingOffset;if(S==="auto"&&r.settings.fixedRowsTop&&(S=10),S>0||S==="auto"){var T=r.countRenderableRows(),R=g.startRow,A=g.endRow;if(typeof S=="number")g.startRow=Math.max(R-S,0),g.endRow=Math.min(A+S,T-1);else if(S==="auto"){var $=Math.ceil(A/T*12);g.startRow=Math.max(R-$,0),g.endRow=Math.min(A+$,T-1)}}r.instance.runHooks("afterViewportRowCalculatorOverride",g)},viewportColumnCalculatorOverride:function(g){var S=r.settings.viewportColumnRenderingOffset;if(S==="auto"&&r.settings.fixedColumnsStart&&(S=10),S>0||S==="auto"){var T=r.countRenderableColumns(),R=g.startColumn,A=g.endColumn;if(typeof S=="number"&&(g.startColumn=Math.max(R-S,0),g.endColumn=Math.min(A+S,T-1)),S==="auto"){var $=Math.ceil(A/T*6);g.startColumn=Math.max(R-$,0),g.endColumn=Math.min(A+$,T-1)}}r.instance.runHooks("afterViewportColumnCalculatorOverride",g)},rowHeaderWidth:function(){return r.settings.rowHeaderWidth},columnHeaderHeight:function(){var g=r.instance.runHooks("modifyColumnHeaderHeight");return r.settings.columnHeaderHeight||g}};this.instance.runHooks("beforeInitWalkontable",i),this._wt=new M5e(i),this.activeWt=this._wt;var o=this._wt.wtTable.spreader,s=this.instance.rootElement.getBoundingClientRect(),a=s.width,h=s.height;this.setLastSize(a,h),this.eventManager.addEventListener(o,"mousedown",function(p){p.target===o&&p.which===3&&p.stopPropagation()}),this.eventManager.addEventListener(o,"contextmenu",function(p){p.target===o&&p.which===3&&p.stopPropagation()}),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"click",function(){r.settings.observeDOMVisibility&&r._wt.drawInterrupted&&(r.instance.forceFullRender=!0,r.render())})}},{key:"isTextSelectionAllowed",value:function(r){if(Tk(r))return!0;var n=xp(r,this.instance.view._wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&n||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&n||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}},{key:"isMouseDown",value:function(){return Td.get(this).mouseDown}},{key:"isSelectedOnlyCell",value:function(){var r,n;return(r=(n=this.instance.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingle())!==null&&r!==void 0?r:!1}},{key:"isCellEdited",value:function(){var r=this.instance.getActiveEditor();return r&&r.isOpened()}},{key:"beforeRender",value:function(r,n){r&&this.instance.runHooks("beforeViewRender",this.instance.forceFullRender,n)}},{key:"afterRender",value:function(r){r&&this.instance.runHooks("afterViewRender",this.instance.forceFullRender)}},{key:"appendRowHeader",value:function(r,n){if(n.firstChild){var i=n.firstChild;if(!Ur(i,"relative")){uu(n),this.appendRowHeader(r,n);return}this.updateCellHeader(i.querySelector(".rowHeader"),r,this.instance.getRowHeader)}else{var o=this.instance,s=o.rootDocument,a=o.getRowHeader,h=s.createElement("div"),p=s.createElement("span");h.className="relative",p.className="rowHeader",this.updateCellHeader(p,r,a),h.appendChild(p),n.appendChild(h)}this.instance.runHooks("afterGetRowHeader",r,n)}},{key:"appendColHeader",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.instance.getColHeader,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;if(n.firstChild){var s=n.firstChild;Ur(s,"relative")?this.updateCellHeader(s.querySelector(".colHeader"),r,i,o):(uu(n),this.appendColHeader(r,n,i,o))}else{var a=this.instance.rootDocument,h=a.createElement("div"),p=a.createElement("span");h.className="relative",p.className="colHeader",this.updateCellHeader(p,r,i,o),h.appendChild(p),n.appendChild(h)}this.instance.runHooks("afterGetColHeader",r,n,o)}},{key:"updateCellHeader",value:function(r,n,i){var o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,s=n,a=this._wt.wtOverlays.getParentOverlay(r)||this._wt;r.parentNode&&(Ur(r,"colHeader")?s=a.wtTable.columnFilter.sourceToRendered(n):Ur(r,"rowHeader")&&(s=a.wtTable.rowFilter.sourceToRendered(n))),s>-1?ib(r,i(n,o)):(Ap(r,String.fromCharCode(160)),Ht(r,"cornerHeader"))}},{key:"maximumVisibleElementWidth",value:function(r){var n=this._wt.wtViewport.getWorkspaceWidth(),i=n-r;return i>0?i:0}},{key:"maximumVisibleElementHeight",value:function(r){var n=this._wt.wtViewport.getWorkspaceHeight(),i=n-r;return i>0?i:0}},{key:"setLastSize",value:function(r,n){var i=Td.get(this),o=[r,n];i.lastWidth=o[0],i.lastHeight=o[1]}},{key:"getLastSize",value:function(){var r=Td.get(this);return{width:r.lastWidth,height:r.lastHeight}}},{key:"getFirstFullyVisibleRow",value:function(){return this.instance.rowIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getFirstVisibleRow())}},{key:"getLastFullyVisibleRow",value:function(){return this.instance.rowIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getLastVisibleRow())}},{key:"getFirstFullyVisibleColumn",value:function(){return this.instance.columnIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getFirstVisibleColumn())}},{key:"getLastFullyVisibleColumn",value:function(){return this.instance.columnIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getLastVisibleColumn())}},{key:"getColumnHeadersCount",value:function(){return y7(this,K$)}},{key:"getRowHeadersCount",value:function(){return y7(this,q$)}},{key:"destroy",value:function(){this._wt.destroy(),this.eventManager.destroy()}}]),e}();const hZe=fZe;function rj(e){"@babel/helpers - typeof";return rj=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rj(e)}var dZe="ABCDEFGHIJKLMNOPQRSTUVWXYZ",v7=dZe.length;function pZe(e){for(var t=e+1,r="",n;t>0;)n=(t-1)%v7,r=String.fromCharCode(65+n)+r,t=parseInt((t-n)/v7,10);return r}function _7(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=e,n=[];return(!Array.isArray(e)||!Array.isArray(e[0]))&&(r=[e]),r.forEach(function(i,o){Array.isArray(i)?i.forEach(function(s,a){n.push([o+t,a,s])}):Object.keys(i).forEach(function(s){n.push([o+t,s,i[s]])})}),n}function ule(e){var t=0;return Array.isArray(e)&&(e[0]&&Array.isArray(e[0])?t=e[0].length:e[0]&&dn(e[0])&&(t=ZH(e[0]))),t}function mZe(e){return!!(Array.isArray(e)&&e.length&&e.every(function(t){return Array.isArray(t)}))}function yZe(e){return!!(Array.isArray(e)&&e.length&&e.every(function(t){return rj(t)==="object"&&!Array.isArray(t)&&t!==null}))}function T1(e){"@babel/helpers - typeof";return T1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},T1(e)}function gZe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function b7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_Ze(n.key),n)}}function vZe(e,t,r){return t&&b7(e.prototype,t),r&&b7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _Ze(e){var t=bZe(e,"string");return T1(t)==="symbol"?t:String(t)}function bZe(e,t){if(T1(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(T1(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var wZe=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];gZe(this,e),this.hot=t,this.data=r,this.dataType="array",this.colToProp=function(){},this.propToCol=function(){}}return vZe(e,[{key:"modifyRowData",value:function(r){var n;return this.hot.hasHook("modifyRowData")&&(n=this.hot.runHooks("modifyRowData",r)),n!==void 0&&!Number.isInteger(n)?n:this.data[r]}},{key:"getData",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,r)}},{key:"setData",value:function(r){this.data=r}},{key:"getAtColumn",value:function(r){var n=this,i=[];return Le(this.data,function(o,s){var a=n.getAtCell(s,r);i.push(a)}),i}},{key:"getAtRow",value:function(r,n,i){var o=this,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,a=n===void 0&&i===void 0,h=null,p=null;if(h=this.modifyRowData(r),Array.isArray(h))p=[],a?h.forEach(function(T,R){p[R]=o.getAtPhysicalCell(r,R,h)}):Er(n,i,function(T){p[T-n]=o.getAtPhysicalCell(r,T,h)});else if(dn(h)||ci(h))if(s?p=[]:p={},!a||s){var g=0,S=this.countFirstRowKeys()-1;Er(g,S,function(T){var R=o.colToProp(T);if(T>=(n||g)&&T<=(i||S)&&!Number.isInteger(R)){var A=o.getAtPhysicalCell(r,R,h);s?p.push(A):i$(p,R,A)}})}else pn(h,function(T,R){i$(p,R,o.getAtPhysicalCell(r,R,h))});return p}},{key:"setAtCell",value:function(r,n,i){if(!(r>=this.countRows()||n>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){var o=jg(i);this.hot.runHooks("modifySourceData",r,this.propToCol(n),o,"set"),o.isTouched()&&(i=o.value)}Number.isInteger(n)?this.data[r][n]=i:i$(this.data[r],n,i)}}},{key:"getAtPhysicalCell",value:function(r,n,i){var o=null;if(i&&(typeof n=="string"?o=R$e(i,n):typeof n=="function"?o=n(i):o=i[n]),this.hot.hasHook("modifySourceData")){var s=jg(o);this.hot.runHooks("modifySourceData",r,this.colToProp(n),s,"get"),s.isTouched()&&(o=s.value)}return o}},{key:"getAtCell",value:function(r,n){var i=this.modifyRowData(r);return this.getAtPhysicalCell(r,this.colToProp(n),i)}},{key:"getByRange",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=!1,a=null,h=null,p=null,g=null;n===null||i===null?(s=!0,a=0,p=this.countRows()-1):(a=Math.min(n.row,i.row),h=Math.min(n.col,i.col),p=Math.max(n.row,i.row),g=Math.max(n.col,i.col));var S=[];return Er(a,p,function(T){S.push(s?r.getAtRow(T,void 0,void 0,o):r.getAtRow(T,h,g,o))}),S}},{key:"countRows",value:function(){if(this.hot.hasHook("modifySourceLength")){var r=this.hot.runHooks("modifySourceLength");if(Number.isInteger(r))return r}return this.data.length}},{key:"countFirstRowKeys",value:function(){return ule(this.data)}},{key:"destroy",value:function(){this.data=null,this.hot=null}}]),e}();const SZe=wZe;var w7;function xZe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function CZe(e,t){return pn(t,function(r,n){si(e[n])&&(e[n]=r)}),e}function cle(e){var t=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/,r=t.exec(e);return r?"".concat(r[1].toLowerCase(),"-").concat(r[2].toUpperCase()):e}function fle(e){dr(e)&&i3(Xn(w7||(w7=xZe(['Language with code "',`" was not found. You should register particular language 
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`],['Language with code "',`" was not found. You should register particular language\\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`])),e))}function EZe(e,t){var r=Array.isArray(e)&&Number.isInteger(t);return r?e[t]:e}var hle=Fs("phraseFormatters"),TZe=hle.register,OZe=hle.getValues;function RZe(e,t){TZe(e,t)}function kZe(){return OZe()}RZe("pluralize",EZe);function O1(e){"@babel/helpers - typeof";return O1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},O1(e)}var ir;function sr(e,t,r){return t=PZe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function PZe(e){var t=AZe(e,"string");return O1(t)==="symbol"?t:String(t)}function AZe(e,t){if(O1(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(O1(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var IZe=(ir={languageCode:"en-US"},sr(ir,j3,"No available options"),sr(ir,z3,"Insert row above"),sr(ir,F3,"Insert row below"),sr(ir,H3,"Insert column left"),sr(ir,V3,"Insert column right"),sr(ir,U3,["Remove row","Remove rows"]),sr(ir,W3,["Remove column","Remove columns"]),sr(ir,G3,"Undo"),sr(ir,Y3,"Redo"),sr(ir,K3,"Read only"),sr(ir,q3,"Clear column"),sr(ir,uV,"Alignment"),sr(ir,cV,"Left"),sr(ir,fV,"Center"),sr(ir,hV,"Right"),sr(ir,dV,"Justify"),sr(ir,pV,"Top"),sr(ir,mV,"Middle"),sr(ir,yV,"Bottom"),sr(ir,tV,"Freeze column"),sr(ir,rV,"Unfreeze column"),sr(ir,gV,"Borders"),sr(ir,vV,"Top"),sr(ir,_V,"Right"),sr(ir,bV,"Bottom"),sr(ir,wV,"Left"),sr(ir,SV,"Remove border(s)"),sr(ir,oV,"Add comment"),sr(ir,aV,"Edit comment"),sr(ir,sV,"Delete comment"),sr(ir,lV,"Read-only comment"),sr(ir,nV,"Merge cells"),sr(ir,iV,"Unmerge cells"),sr(ir,X3,"Copy"),sr(ir,Z3,["Copy with header","Copy with headers"]),sr(ir,J3,["Copy with group header","Copy with group headers"]),sr(ir,Q3,["Copy header only","Copy headers only"]),sr(ir,eV,"Cut"),sr(ir,xV,"Insert child row"),sr(ir,CV,"Detach from parent"),sr(ir,EV,["Hide column","Hide columns"]),sr(ir,TV,["Show column","Show columns"]),sr(ir,OV,["Hide row","Hide rows"]),sr(ir,RV,["Show row","Show rows"]),sr(ir,BA,"None"),sr(ir,kV,"Is empty"),sr(ir,PV,"Is not empty"),sr(ir,AV,"Is equal to"),sr(ir,IV,"Is not equal to"),sr(ir,MV,"Begins with"),sr(ir,DV,"Ends with"),sr(ir,$V,"Contains"),sr(ir,LV,"Does not contain"),sr(ir,NV,"Greater than"),sr(ir,BV,"Greater than or equal to"),sr(ir,jV,"Less than"),sr(ir,zV,"Less than or equal to"),sr(ir,FV,"Is between"),sr(ir,HV,"Is not between"),sr(ir,VV,"After"),sr(ir,UV,"Before"),sr(ir,WV,"Today"),sr(ir,GV,"Tomorrow"),sr(ir,YV,"Yesterday"),sr(ir,lP,"Blank cells"),sr(ir,KV,"Filter by condition"),sr(ir,qV,"Filter by value"),sr(ir,XV,"And"),sr(ir,jA,"Or"),sr(ir,ZV,"Select all"),sr(ir,JV,"Clear"),sr(ir,QV,"OK"),sr(ir,eU,"Cancel"),sr(ir,tU,"Search"),sr(ir,rU,"Value"),sr(ir,nU,"Second value"),ir);const dle=IZe;var nj=dle.languageCode,KA=Fs("languagesDictionaries"),MZe=KA.register,ple=KA.getItem,DZe=KA.hasItem,$Ze=KA.getValues;mle(dle);function mle(e,t){var r=e,n=t;return dn(e)&&(n=e,r=n.languageCode),LZe(r,n),MZe(r,ya(n)),ya(n)}function LZe(e,t){e!==nj&&CZe(t,ple(nj))}function yle(e){return sU(e)?ya(ple(e)):null}function sU(e){return DZe(e)}function NZe(){return $Ze()}function gle(e,t,r){var n=yle(e);if(n===null)return null;var i=n[t];if(si(i))return null;var o=BZe(i,r);return Array.isArray(o)?o[0]:o}function BZe(e,t){var r=e;return Le(kZe(),function(n){r=n(e,t)}),r}function jZe(e){var t=cle(e);return sU(t)||(t=nj,fle(e)),t}var qA="active-header",XA="area",R1="cell",lU="fill",xC="header",uU="custom-selection";function Fv(e){"@babel/helpers - typeof";return Fv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fv(e)}function zZe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function S7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_le(n.key),n)}}function FZe(e,t,r){return t&&S7(e.prototype,t),r&&S7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _R(){return typeof Reflect<"u"&&Reflect.get?_R=Reflect.get.bind():_R=function(t,r,n){var i=HZe(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},_R.apply(this,arguments)}function HZe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Hv(e),e!==null););return e}function VZe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ij(e,t)}function ij(e,t){return ij=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},ij(e,t)}function UZe(e){var t=GZe();return function(){var n=Hv(e),i;if(t){var o=Hv(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return WZe(this,i)}}function WZe(e,t){if(t&&(Fv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return vle(e)}function vle(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function GZe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Hv(e){return Hv=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Hv(e)}function YZe(e,t,r){return t=_le(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _le(e){var t=KZe(e,"string");return Fv(t)==="symbol"?t:String(t)}function KZe(e,t){if(Fv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Fv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var qZe=function(e){VZe(r,e);var t=UZe(r);function r(n,i){var o;return zZe(this,r),o=t.call(this,n,null),YZe(vle(o),"visualCellRange",null),o.visualCellRange=i||null,o.commit(),o}return FZe(r,[{key:"add",value:function(i){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(i):this.visualCellRange.expand(i),this}},{key:"clear",value:function(){return this.visualCellRange=null,_R(Hv(r.prototype),"clear",this).call(this)}},{key:"trimToVisibleCellsRangeOnly",value:function(i){var o=i.from,s=i.to,a=this.getNearestNotHiddenCoords(o,1),h=this.getNearestNotHiddenCoords(s,-1);if(a===null||h===null)return null;if(a.row>h.row||a.col>h.col){var p=this.settings.type==="header"||this.settings.type==="active-header";if(!p)return null;a=o,h=s}return this.settings.createCellRange(a,a,h)}},{key:"getNearestNotHiddenCoords",value:function(i,o){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:o,a=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper(),i.row,o);if(a===null)return null;var h=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper(),i.col,s);return h===null?null:this.settings.createCellCoords(a,h)}},{key:"getNearestNotHiddenIndex",value:function(i,o,s){if(o<0)return o;var a=i.getNearestNotHiddenIndex(o,s),h=this.settings.type==="header"||this.settings.type==="active-header";return h&&a===null?-1:a}},{key:"commit",value:function(){if(this.visualCellRange===null)return this;var i=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return i===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(i.from,i.to),this}},{key:"syncWith",value:function(i){var o=i.getVerticalDirection()==="N-S"?1:-1,s=i.getHorizontalDirection()==="W-E"?1:-1,a=this.getNearestNotHiddenCoords(i.from.clone().normalize(),o,s);if(a!==null&&i.overlaps(a)){if(this.cellRange===null){var h=this.settings.visualToRenderableCoords(a);this.cellRange=this.settings.createCellRange(h)}return i.setHighlight(a),this}return i.setHighlight(i.from),this}},{key:"getCorners",value:function(){var i=this.cellRange,o=i.from,s=i.to,a=o.row===null||s.row===null,h=o.col===null||s.col===null,p=this.settings.createCellCoords(a?null:Math.min(o.row,s.row),h?null:Math.min(o.col,s.col)),g=this.settings.createCellCoords(a?null:Math.max(o.row,s.row),h?null:Math.max(o.col,s.col));return[p.row,p.col,g.row,g.col]}},{key:"getVisualCorners",value:function(){var i=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),o=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[i.row,i.col,o.row,o.col]}},{key:"createRenderableCellRange",value:function(i,o){var s=this.settings.visualToRenderableCoords(i),a=this.settings.visualToRenderableCoords(o);return this.settings.createCellRange(s,s,a)}}]),r}(uGe);const lb=qZe;function k1(e){"@babel/helpers - typeof";return k1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},k1(e)}var XZe=["activeHeaderClassName"];function x7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function C7(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?x7(Object(r),!0).forEach(function(n){ZZe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):x7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ZZe(e,t,r){return t=JZe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function JZe(e){var t=QZe(e,"string");return k1(t)==="symbol"?t:String(t)}function QZe(e,t){if(k1(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(k1(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function eJe(e,t){if(e==null)return{};var r=tJe(e,t),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function tJe(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,o;for(o=0;o<n.length;o++)i=n[o],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function rJe(e){var t=e.activeHeaderClassName,r=eJe(e,XZe),n=new lb(C7(C7({highlightHeaderClassName:t},r),{},{selectionType:qA}));return n}function P1(e){"@babel/helpers - typeof";return P1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},P1(e)}var nJe=["layerLevel","areaCornerVisible"];function E7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function T7(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?E7(Object(r),!0).forEach(function(n){iJe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):E7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function iJe(e,t,r){return t=oJe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function oJe(e){var t=aJe(e,"string");return P1(t)==="symbol"?t:String(t)}function aJe(e,t){if(P1(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(P1(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function sJe(e,t){if(e==null)return{};var r=lJe(e,t),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function lJe(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,o;for(o=0;o<n.length;o++)i=n[o],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function uJe(e){var t=e.layerLevel,r=e.areaCornerVisible,n=sJe(e,nJe),i=new lb(T7(T7({className:"area",markIntersections:!0,layerLevel:Math.min(t,7),border:{width:1,color:"#4b89ff",cornerVisible:r}},n),{},{selectionType:XA}));return i}function A1(e){"@babel/helpers - typeof";return A1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},A1(e)}var cJe=["cellCornerVisible"];function O7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function R7(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?O7(Object(r),!0).forEach(function(n){fJe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):O7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function fJe(e,t,r){return t=hJe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function hJe(e){var t=dJe(e,"string");return A1(t)==="symbol"?t:String(t)}function dJe(e,t){if(A1(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(A1(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function pJe(e,t){if(e==null)return{};var r=mJe(e,t),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function mJe(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,o;for(o=0;o<n.length;o++)i=n[o],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function yJe(e){var t=e.cellCornerVisible,r=pJe(e,cJe),n=new lb(R7(R7({className:"current",border:{width:2,color:"#4b89ff",cornerVisible:t}},r),{},{selectionType:R1}));return n}function I1(e){"@babel/helpers - typeof";return I1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},I1(e)}var gJe=["border","visualCellRange"];function k7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function X$(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?k7(Object(r),!0).forEach(function(n){vJe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):k7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function vJe(e,t,r){return t=_Je(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _Je(e){var t=bJe(e,"string");return I1(t)==="symbol"?t:String(t)}function bJe(e,t){if(I1(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(I1(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function wJe(e,t){if(e==null)return{};var r=SJe(e,t),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function SJe(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,o;for(o=0;o<n.length;o++)i=n[o],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function xJe(e){var t=e.border,r=e.visualCellRange,n=wJe(e,gJe),i=new lb(X$(X$(X$({},t),n),{},{selectionType:uU}),r);return i}function M1(e){"@babel/helpers - typeof";return M1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},M1(e)}function P7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function A7(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?P7(Object(r),!0).forEach(function(n){CJe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):P7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function CJe(e,t,r){return t=EJe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function EJe(e){var t=TJe(e,"string");return M1(t)==="symbol"?t:String(t)}function TJe(e,t){if(M1(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(M1(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function OJe(e){if(e==null)throw new TypeError("Cannot destructure "+e)}function RJe(e){var t=Object.assign({},(OJe(e),e)),r=new lb(A7(A7({className:"fill",border:{width:1,color:"#ff0000"}},t),{},{selectionType:lU}));return r}function D1(e){"@babel/helpers - typeof";return D1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},D1(e)}var kJe=["headerClassName","rowClassName","columnClassName"];function I7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function M7(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?I7(Object(r),!0).forEach(function(n){PJe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):I7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function PJe(e,t,r){return t=AJe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function AJe(e){var t=IJe(e,"string");return D1(t)==="symbol"?t:String(t)}function IJe(e,t){if(D1(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(D1(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function MJe(e,t){if(e==null)return{};var r=DJe(e,t),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function DJe(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,o;for(o=0;o<n.length;o++)i=n[o],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function $Je(e){var t=e.headerClassName,r=e.rowClassName,n=e.columnClassName,i=MJe(e,kJe),o=new lb(M7(M7({className:"highlight",highlightHeaderClassName:t,highlightRowClassName:r,highlightColumnClassName:n},i),{},{highlightOnlyClosestHeader:!0,selectionType:xC}));return o}function $1(e){"@babel/helpers - typeof";return $1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$1(e)}function D7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function LJe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?D7(Object(r),!0).forEach(function(n){NJe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):D7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function NJe(e,t,r){return t=BJe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function BJe(e){var t=jJe(e,"string");return $1(t)==="symbol"?t:String(t)}function jJe(e,t){if($1(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if($1(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ble=Fs("highlight/types"),ub=ble.register,zJe=ble.getItem;ub(qA,rJe);ub(XA,uJe);ub(R1,yJe);ub(uU,xJe);ub(lU,RJe);ub(xC,$Je);function Ey(e,t){return zJe(e)(LJe({type:e},t))}function L1(e){"@babel/helpers - typeof";return L1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},L1(e)}function xf(e){return UJe(e)||VJe(e)||HJe(e)||FJe()}function FJe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function HJe(e,t){if(e){if(typeof e=="string")return oj(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return oj(e,t)}}function VJe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function UJe(e){if(Array.isArray(e))return oj(e)}function oj(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function $7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function n0(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?$7(Object(r),!0).forEach(function(n){WJe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function WJe(e,t,r){return t=wle(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function GJe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function L7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,wle(n.key),n)}}function YJe(e,t,r){return t&&L7(e.prototype,t),r&&L7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function wle(e){var t=KJe(e,"string");return L1(t)==="symbol"?t:String(t)}function KJe(e,t){if(L1(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(L1(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var qJe=function(e){function t(r){GJe(this,t),this.options=r,this.layerLevel=0,this.cell=Ey(R1,r),this.fill=Ey(lU,r),this.areas=new Map,this.headers=new Map,this.activeHeaders=new Map,this.customSelections=[]}return YJe(t,[{key:"isEnabledFor",value:function(n,i){var o=n;n===R1&&(o="current");var s=this.options.disabledCellSelection(i.row,i.col);return typeof s=="string"&&(s=[s]),s===!1||Array.isArray(s)&&!s.includes(o)}},{key:"useLayerLevel",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=n,this}},{key:"getCell",value:function(){return this.cell}},{key:"getFill",value:function(){return this.fill}},{key:"createOrGetArea",value:function(){var n=this.layerLevel,i;return this.areas.has(n)?i=this.areas.get(n):(i=Ey(XA,n0({layerLevel:n},this.options)),this.areas.set(n,i)),i}},{key:"getAreas",value:function(){return xf(this.areas.values())}},{key:"createOrGetHeader",value:function(){var n=this.layerLevel,i;return this.headers.has(n)?i=this.headers.get(n):(i=Ey(xC,n0({},this.options)),this.headers.set(n,i)),i}},{key:"getHeaders",value:function(){return xf(this.headers.values())}},{key:"createOrGetActiveHeader",value:function(){var n=this.layerLevel,i;return this.activeHeaders.has(n)?i=this.activeHeaders.get(n):(i=Ey(qA,n0({},this.options)),this.activeHeaders.set(n,i)),i}},{key:"getActiveHeaders",value:function(){return xf(this.activeHeaders.values())}},{key:"getCustomSelections",value:function(){return xf(this.customSelections.values())}},{key:"addCustomSelection",value:function(n){this.customSelections.push(Ey(uU,n0(n0({},this.options),n)))}},{key:"clear",value:function(){this.cell.clear(),this.fill.clear(),Le(this.areas.values(),function(n){return void n.clear()}),Le(this.headers.values(),function(n){return void n.clear()}),Le(this.activeHeaders.values(),function(n){return void n.clear()})}},{key:e,value:function(){return[this.cell,this.fill].concat(xf(this.areas.values()),xf(this.headers.values()),xf(this.activeHeaders.values()),xf(this.customSelections))[Symbol.iterator]()}}]),t}(Symbol.iterator);const XJe=qJe;function N1(e){"@babel/helpers - typeof";return N1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},N1(e)}function ZJe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function N7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,QJe(n.key),n)}}function JJe(e,t,r){return t&&N7(e.prototype,t),r&&N7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function QJe(e){var t=eQe(e,"string");return N1(t)==="symbol"?t:String(t)}function eQe(e,t){if(N1(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(N1(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var tQe=function(e){function t(r){ZJe(this,t),this.ranges=[],this.createCellRange=r}return JJe(t,[{key:"isEmpty",value:function(){return this.size()===0}},{key:"set",value:function(n){return this.clear(),this.ranges.push(this.createCellRange(n)),this}},{key:"add",value:function(n){return this.ranges.push(this.createCellRange(n)),this}},{key:"pop",value:function(){return this.ranges.pop(),this}},{key:"current",value:function(){return this.peekByIndex(0)}},{key:"previous",value:function(){return this.peekByIndex(-1)}},{key:"includes",value:function(n){return this.ranges.some(function(i){return i.includes(n)})}},{key:"clear",value:function(){return this.ranges.length=0,this}},{key:"size",value:function(){return this.ranges.length}},{key:"peekByIndex",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,i=this.size()+n-1,o;return i>=0&&(o=this.ranges[i]),o}},{key:e,value:function(){return this.ranges[Symbol.iterator]()}}]),t}(Symbol.iterator);const rQe=tQe;function B1(e){"@babel/helpers - typeof";return B1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},B1(e)}function nQe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function B7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,oQe(n.key),n)}}function iQe(e,t,r){return t&&B7(e.prototype,t),r&&B7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function oQe(e){var t=aQe(e,"string");return B1(t)==="symbol"?t:String(t)}function aQe(e,t){if(B1(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(B1(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Sle=function(){function e(t,r){nQe(this,e),this.range=t,this.options=r}return iQe(e,[{key:"transformStart",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=this.options.createCellCoords(r,n),s=this.range.current().highlight,a=this.options.visualToRenderableCoords(s),h=a.row,p=a.col,g=s,S=0,T=0;if(this.runLocalHooks("beforeTransformStart",o),h!==null&&p!==null){var R=this.options.countRows(),A=this.options.countCols(),$=this.options.fixedRowsBottom(),j=this.options.minSpareRows(),z=this.options.minSpareCols(),V=this.options.autoWrapRow(),G=this.options.autoWrapCol();h+r>R-1?i&&j>0&&!($&&h>=R-$-1)?(this.runLocalHooks("insertRowRequire",R),R=this.options.countRows()):G&&(o.row=1-R,o.col=p+o.col===A-1?1-A:1):G&&h+o.row<0&&p+o.col>=0&&(o.row=R-1,o.col=p+o.col===0?A-1:-1),p+o.col>A-1?i&&z>0?(this.runLocalHooks("insertColRequire",A),A=this.options.countCols()):V&&(o.row=h+o.row===R-1?1-R:1,o.col=1-A):V&&p+o.col<0&&h+o.row>=0&&(o.row=h+o.row===0?R-1:-1,o.col=A-1);var ee=this.options.createCellCoords(h+o.row,p+o.col);S=0,T=0,ee.row<0?(S=-1,ee.row=0):ee.row>0&&ee.row>=R&&(S=1,ee.row=R-1),ee.col<0?(T=-1,ee.col=0):ee.col>0&&ee.col>=A&&(T=1,ee.col=A-1),g=this.options.renderableToVisualCoords(ee)}return this.runLocalHooks("afterTransformStart",g,S,T),g}},{key:"transformEnd",value:function(r,n){var i=this.options.createCellCoords(r,n),o=this.range.current(),s=o.to,a=0,h=0;this.runLocalHooks("beforeTransformEnd",i);var p=this.options.visualToRenderableCoords(o.highlight),g=p.row,S=p.col;if(g!==null&&S!==null){var T=this.options.countRows(),R=this.options.countCols(),A=this.options.visualToRenderableCoords(o.to),$=A.row,j=A.col,z=this.options.createCellCoords($+i.row,j+i.col);a=0,h=0,z.row<0?(a=-1,z.row=0):z.row>0&&z.row>=T&&(a=1,z.row=T-1),z.col<0?(h=-1,z.col=0):z.col>0&&z.col>=R&&(h=1,z.col=R-1),s=this.options.renderableToVisualCoords(z)}return this.runLocalHooks("afterTransformEnd",s,a,h),s}}]),e}();li(Sle,Va);const sQe=Sle;function j1(e){"@babel/helpers - typeof";return j1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},j1(e)}var j7;function z7(e,t){return fQe(e)||cQe(e,t)||uQe(e,t)||lQe()}function lQe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function uQe(e,t){if(e){if(typeof e=="string")return F7(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return F7(e,t)}}function F7(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function cQe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],h=!0,p=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;h=!1}else for(;!(h=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);h=!0);}catch(g){p=!0,i=g}finally{try{if(!h&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(p)throw i}}return a}}function fQe(e){if(Array.isArray(e))return e}function hQe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function dQe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function H7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,mQe(n.key),n)}}function pQe(e,t,r){return t&&H7(e.prototype,t),r&&H7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function mQe(e){var t=yQe(e,"string");return j1(t)==="symbol"?t:String(t)}function yQe(e,t){if(j1(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(j1(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var xle=function(){function e(t,r){var n=this;dQe(this,e),this.settings=t,this.tableProps=r,this.inProgress=!1,this.selectedByCorner=!1,this.selectedByRowHeader=new Set,this.selectedByColumnHeader=new Set,this.selectedRange=new rQe(function(i,o,s){return n.tableProps.createCellRange(i,o,s)}),this.highlight=new XJe({headerClassName:t.currentHeaderClassName,activeHeaderClassName:t.activeHeaderClassName,rowClassName:t.currentRowClassName,columnClassName:t.currentColClassName,disabledCellSelection:function(o,s){return n.tableProps.isDisabledCellSelection(o,s)},cellCornerVisible:function(){return n.isCellCornerVisible.apply(n,arguments)},areaCornerVisible:function(){return n.isAreaCornerVisible.apply(n,arguments)},visualToRenderableCoords:function(o){return n.tableProps.visualToRenderableCoords(o)},renderableToVisualCoords:function(o){return n.tableProps.renderableToVisualCoords(o)},createCellCoords:function(o,s){return n.tableProps.createCellCoords(o,s)},createCellRange:function(o,s,a){return n.tableProps.createCellRange(o,s,a)},rowIndexMapper:function(){return n.tableProps.rowIndexMapper()},columnIndexMapper:function(){return n.tableProps.columnIndexMapper()}}),this.transformation=new sQe(this.selectedRange,{countRows:function(){return n.tableProps.countRowsTranslated()},countCols:function(){return n.tableProps.countColsTranslated()},visualToRenderableCoords:function(o){return n.tableProps.visualToRenderableCoords(o)},renderableToVisualCoords:function(o){return n.tableProps.renderableToVisualCoords(o)},createCellCoords:function(o,s){return n.tableProps.createCellCoords(o,s)},fixedRowsBottom:function(){return t.fixedRowsBottom},minSpareRows:function(){return t.minSpareRows},minSpareCols:function(){return t.minSpareCols},autoWrapRow:function(){return t.autoWrapRow},autoWrapCol:function(){return t.autoWrapCol}}),this.transformation.addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks.apply(n,["beforeModifyTransformStart"].concat(o))}),this.transformation.addLocalHook("afterTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks.apply(n,["afterModifyTransformStart"].concat(o))}),this.transformation.addLocalHook("beforeTransformEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks.apply(n,["beforeModifyTransformEnd"].concat(o))}),this.transformation.addLocalHook("afterTransformEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks.apply(n,["afterModifyTransformEnd"].concat(o))}),this.transformation.addLocalHook("insertRowRequire",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks.apply(n,["insertRowRequire"].concat(o))}),this.transformation.addLocalHook("insertColRequire",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks.apply(n,["insertColRequire"].concat(o))})}return pQe(e,[{key:"getSelectedRange",value:function(){return this.selectedRange}},{key:"begin",value:function(){this.inProgress=!0}},{key:"finish",value:function(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1}},{key:"isInProgress",value:function(){return this.inProgress}},{key:"setRangeStart",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=this.settings.selectionMode==="multiple",s=si(n)?this.tableProps.getShortcutManager().isCtrlPressed():n,a=r.row<0,h=r.col<0,p=a&&h,g=r.clone();this.selectedByCorner=p,this.runLocalHooks("beforeSetRangeStart".concat(i?"Only":""),g),(!o||o&&!s&&si(n))&&this.selectedRange.clear(),this.selectedRange.add(g),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),!p&&h&&this.selectedByRowHeader.add(this.getLayerLevel()),!p&&a&&this.selectedByColumnHeader.add(this.getLayerLevel()),i||this.setRangeEnd(r)}},{key:"setRangeStartOnly",value:function(r,n){this.setRangeStart(r,n,!0)}},{key:"setRangeEnd",value:function(r){if(!this.selectedRange.isEmpty()){var n=r.clone();this.runLocalHooks("beforeSetRangeEnd",n),this.begin();var i=this.selectedRange.current();this.settings.selectionMode!=="single"&&i.setTo(this.tableProps.createCellCoords(n.row,n.col)),this.highlight.getCell().clear(),this.highlight.isEnabledFor(R1,i.highlight)&&this.highlight.getCell().add(this.selectedRange.current().highlight).commit().syncWith(i);var o=this.getLayerLevel();o<this.highlight.layerLevel&&(Le(this.highlight.getAreas(),function($){return void $.clear()}),Le(this.highlight.getHeaders(),function($){return void $.clear()}),Le(this.highlight.getActiveHeaders(),function($){return void $.clear()})),this.highlight.useLayerLevel(o);var s=this.highlight.createOrGetArea(),a=this.highlight.createOrGetHeader(),h=this.highlight.createOrGetActiveHeader();if(s.clear(),a.clear(),h.clear(),this.highlight.isEnabledFor(XA,i.highlight)&&(this.isMultiple()||o>=1)&&(s.add(i.from).add(i.to).commit(),o===1)){var p=this.selectedRange.previous();this.highlight.useLayerLevel(o-1).createOrGetArea().add(p.from).commit().syncWith(p),this.highlight.useLayerLevel(o)}if(this.highlight.isEnabledFor(xC,i.highlight)){var g=this.tableProps.countRowsTranslated()===0,S=this.tableProps.countColsTranslated()===0,T=i;if((g||S)&&(T=i.clone()),g&&(T.from.row=-1),S&&(T.from.col=-1),this.settings.selectionMode==="single"?(this.isSelectedByAnyHeader()&&T.from.normalize(),a.add(T.from).commit()):a.add(T.from).add(T.to).commit(),this.isEntireRowSelected()){var R=this.tableProps.countCols()===i.getWidth();R&&h.add(this.tableProps.createCellCoords(i.from.row,-1)).add(this.tableProps.createCellCoords(i.to.row,-1)).commit()}if(this.isEntireColumnSelected()){var A=this.tableProps.countRows()===i.getHeight();A&&h.add(this.tableProps.createCellCoords(-1,i.from.col)).add(this.tableProps.createCellCoords(-1,i.to.col)).commit()}}this.runLocalHooks("afterSetRangeEnd",r)}}},{key:"isMultiple",value:function(){var r=jg(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",r),r.value}},{key:"transformStart",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.setRangeStart(this.transformation.transformStart(r,n,i))}},{key:"transformEnd",value:function(r,n){this.setRangeEnd(this.transformation.transformEnd(r,n))}},{key:"getLayerLevel",value:function(){return this.selectedRange.size()-1}},{key:"isSelected",value:function(){return!this.selectedRange.isEmpty()}},{key:"isSelectedByRowHeader",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(r)&&this.isEntireRowSelected(r)}},{key:"isEntireRowSelected",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return r===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(r)}},{key:"isSelectedByColumnHeader",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&this.isEntireColumnSelected(r)}},{key:"isEntireColumnSelected",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return r===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(r)}},{key:"isSelectedByAnyHeader",value:function(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}},{key:"isSelectedByCorner",value:function(){return this.selectedByCorner}},{key:"inInSelection",value:function(r){return this.selectedRange.includes(r)}},{key:"isCellCornerVisible",value:function(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}},{key:"isAreaCornerVisible",value:function(r){return Number.isInteger(r)&&r!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}},{key:"clear",value:function(){this.selectedRange.clear(),this.highlight.clear()}},{key:"deselect",value:function(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}},{key:"selectAll",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=this.tableProps.countRows(),o=this.tableProps.countCols();if(!(!r&&!n&&(i===0||o===0))){var s=this.tableProps.createCellCoords(n?-1:0,r?-1:0),a=this.tableProps.createCellCoords(i-1,o-1);this.clear(),this.setRangeStartOnly(s),this.selectedByRowHeader.add(this.getLayerLevel()),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(a),this.finish()}}},{key:"selectCells",value:function(r){var n=this,i=zv(r);if(i===VA)return!1;if(i===HA)throw new Error(Xn(j7||(j7=hQe([`Unsupported format of the selection ranges was passed. To select cells pass 
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd, 
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`],[`Unsupported format of the selection ranges was passed. To select cells pass\\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`]))));var o=_1(i,{propToCol:function(g){return n.tableProps.propToCol(g)},keepDirection:!0}),s=this.tableProps.countRows(),a=this.tableProps.countCols(),h=!r.some(function(p){var g=o(p),S=z7(g,4),T=S[0],R=S[1],A=S[2],$=S[3],j=wf(T,s)&&wf(R,a)&&wf(A,s)&&wf($,a);return!j});return h&&(this.clear(),Le(r,function(p){var g=o(p),S=z7(g,4),T=S[0],R=S[1],A=S[2],$=S[3];n.setRangeStartOnly(n.tableProps.createCellCoords(T,R),!1),n.setRangeEnd(n.tableProps.createCellCoords(A,$)),n.finish()})),h}},{key:"selectColumns",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:r,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1,o=typeof r=="string"?this.tableProps.propToCol(r):r,s=typeof n=="string"?this.tableProps.propToCol(n):n,a=this.tableProps.countCols(),h=this.tableProps.countRows(),p=wf(o,a)&&wf(s,a);return p&&(this.setRangeStartOnly(this.tableProps.createCellCoords(i,o)),this.setRangeEnd(this.tableProps.createCellCoords(h-1,s)),this.finish()),p}},{key:"selectRows",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:r,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1,o=this.tableProps.countRows(),s=this.tableProps.countCols(),a=wf(r,o)&&wf(n,o);return a&&(this.setRangeStartOnly(this.tableProps.createCellCoords(r,i)),this.setRangeEnd(this.tableProps.createCellCoords(n,s-1)),this.finish()),a}},{key:"refresh",value:function(){var r=this.highlight.getCustomSelections();if(r.forEach(function(p){p.commit()}),!!this.isSelected()){var n=this.highlight.getCell(),i=this.getLayerLevel();n.commit().syncWith(this.selectedRange.current());for(var o=0;o<this.selectedRange.size();o+=1){this.highlight.useLayerLevel(o);var s=this.highlight.createOrGetArea(),a=this.highlight.createOrGetHeader(),h=this.highlight.createOrGetActiveHeader();s.commit(),a.commit(),h.commit()}this.highlight.useLayerLevel(i)}}}]),e}();li(xle,Va);const gQe=xle;var vQe=Br,Cle=Zx,_Qe=fu.f,bQe=Zp,V7=Qi,wQe=KH,SQe=Fa,xQe=qH,U7=Cle("".startsWith),CQe=Cle("".slice),EQe=Math.min,Ele=xQe("startsWith"),TQe=!Ele&&!!function(){var e=_Qe(String.prototype,"startsWith");return e&&!e.writable}();vQe({target:"String",proto:!0,forced:!TQe&&!Ele},{startsWith:function(t){var r=V7(SQe(this));wQe(t);var n=bQe(EQe(arguments.length>1?arguments[1]:void 0,r.length)),i=V7(t);return U7?U7(r,i,n):CQe(r,n,n+i.length)===i}});var W7=/^(\r\n|\n\r|\r|\n)/,OQe=/^[^\t\r\n]+/,G7=/^\t/;function RQe(e){var t=[[""]];if(e.length===0)return t;for(var r=0,n=0,i;e.length>0&&i!==e.length;)if(i=e.length,e.match(G7))e=e.replace(G7,""),r+=1,t[n][r]="";else if(e.match(W7))e=e.replace(W7,""),r=0,n+=1,t[n]=[""];else{var o="";if(e.startsWith('"')){for(var s=0,a=!0;a;){var h=e.slice(0,1);h==='"'&&(s+=1),o+=h,e=e.slice(1),(e.length===0||e.match(/^[\t\r\n]/)&&s%2===0)&&(a=!1)}o=o.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,function(g){return new Array(Math.floor(g.length/2)).fill('"').join("")})}else{var p=e.match(OQe);o=p?p[0]:"",e=e.slice(o.length)}t[n][r]=o}return t}function q0(e){var t,r,n,i,o="",s;for(t=0,r=e.length;t<r;t+=1){for(i=e[t].length,n=0;n<i;n+=1)n>0&&(o+="	"),s=e[t][n],typeof s=="string"?s.indexOf(`
`)>-1?o+='"'.concat(s.replace(/"/g,'""'),'"'):o+=s:s==null?o+="":o+=s;t!==r-1&&(o+=`
`)}return o}function Z$(e){return IQe(e)||AQe(e)||PQe(e)||kQe()}function kQe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function PQe(e,t){if(e){if(typeof e=="string")return aj(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return aj(e,t)}}function AQe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function IQe(e){if(Array.isArray(e))return aj(e)}function aj(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Vv(e){"@babel/helpers - typeof";return Vv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vv(e)}function MQe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Y7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,$Qe(n.key),n)}}function DQe(e,t,r){return t&&Y7(e.prototype,t),r&&Y7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function $Qe(e){var t=LQe(e,"string");return Vv(t)==="symbol"?t:String(t)}function LQe(e,t){if(Vv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Vv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var NQe=function(){function e(t,r,n){MQe(this,e),this.instance=t,this.metaManager=n,this.tableMeta=n.getTableMeta(),this.dataSource=r,this.duckSchema=this.createDuckSchema(),this.colToPropCache=void 0,this.propToColCache=void 0,this.createMap()}return DQe(e,[{key:"createMap",value:function(){var r=this.getSchema();if(typeof r>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");var n=this.tableMeta.columns,i;if(this.colToPropCache=[],this.propToColCache=new Map,n){var o=0,s=0,a=!1;if(typeof n=="function"){var h=ZH(r);o=h>0?h:this.countFirstRowKeys(),a=!0}else{var p=this.tableMeta.maxCols;o=Math.min(p,n.length)}for(i=0;i<o;i++){var g=a?n(i):n[i];if(dn(g)){if(typeof g.data<"u"){var S=a?s:i;this.colToPropCache[S]=g.data,this.propToColCache.set(g.data,S)}s+=1}}}else this.recursiveDuckColumns(r)}},{key:"countFirstRowKeys",value:function(){return ule(this.dataSource)}},{key:"recursiveDuckColumns",value:function(r,n,i){var o=this,s=n,a=i,h;return typeof s>"u"&&(s=0,a=""),Vv(r)==="object"&&!Array.isArray(r)&&pn(r,function(p,g){p===null?(h=a+g,o.colToPropCache.push(h),o.propToColCache.set(h,s),s+=1):s=o.recursiveDuckColumns(p,s,"".concat(g,"."))}),s}},{key:"colToProp",value:function(r){if(Number.isInteger(r)===!1)return r;var n=this.instance.toPhysicalColumn(r);return n===null?r:this.colToPropCache&&dr(this.colToPropCache[n])?this.colToPropCache[n]:n}},{key:"propToCol",value:function(r){var n=this.propToColCache.get(r);if(dr(n))return this.instance.toVisualColumn(n);var i=this.instance.toVisualColumn(r);return i===null?r:i}},{key:"getSchema",value:function(){var r=this.tableMeta.dataSchema;return r?typeof r=="function"?r():r:this.duckSchema}},{key:"createDuckSchema",value:function(){return this.dataSource&&this.dataSource[0]?ES(this.dataSource[0]):{}}},{key:"refreshDuckSchema",value:function(){this.duckSchema=this.createDuckSchema()}},{key:"createRow",value:function(r){var n=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},s=o.source,a=o.mode,h=a===void 0?"above":a,p=this.instance.countSourceRows(),g=p,S=0,T=r;(typeof T!="number"||T>=p)&&(T=p),T<this.instance.countRows()&&(g=this.instance.toPhysicalRow(T));var R=this.instance.runHooks("beforeCreateRow",T,i,s);if(R===!1||g===null)return{delta:0};for(var A=this.tableMeta.maxRows,$=this.getSchema().length,j=[],z=function(){var ee=null;n.instance.dataType==="array"?n.tableMeta.dataSchema?ee=ya(n.getSchema()):(ee=[],Er($-1,function(){return ee.push(null)})):n.instance.dataType==="function"?ee=n.tableMeta.dataSchema(T+S):(ee={},kA(ee,n.getSchema())),j.push(ee),S+=1};S<i&&p+S<A;)z();this.instance.rowIndexMapper.insertIndexes(T,S),h==="below"&&(g=Math.min(g+1,p)),this.spliceData(g,0,j);var V=this.instance.toVisualRow(g);return this.instance.countSourceRows()===j.length&&this.instance.columnIndexMapper.initToLength(this.instance.getInitialColumnCount()),S>0&&(r==null?this.metaManager.createRow(null,S):s!=="auto"&&this.metaManager.createRow(g,i)),this.instance.runHooks("afterCreateRow",V,S,s),this.instance.forceFullRender=!0,{delta:S,startPhysicalIndex:g}}},{key:"createCol",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},o=i.source,s=i.mode,a=s===void 0?"start":s;if(!this.instance.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");var h=this.dataSource,p=this.tableMeta.maxCols,g=this.instance.countSourceCols(),S=r;(typeof S!="number"||S>=g)&&(S=g);var T=this.instance.runHooks("beforeCreateCol",S,n,o);if(T===!1)return{delta:0};var R=g;S<this.instance.countCols()&&(R=this.instance.toPhysicalColumn(S));var A=this.instance.countSourceRows(),$=this.instance.countCols(),j=0,z=R;a==="end"&&(z=Math.min(z+1,g));for(var V=z;j<n&&$<p;){if(typeof S!="number"||S>=$)if(A>0)for(var G=0;G<A;G+=1)typeof h[G]>"u"&&(h[G]=[]),h[G].push(null);else h.push([null]);else for(var ee=0;ee<A;ee++)h[ee].splice(z,0,null);j+=1,z+=1,$+=1}this.instance.columnIndexMapper.insertIndexes(S,j),j>0&&(r==null?this.metaManager.createColumn(null,j):o!=="auto"&&this.metaManager.createColumn(V,n));var K=this.instance.toVisualColumn(V);return this.instance.runHooks("afterCreateCol",K,j,o),this.instance.forceFullRender=!0,this.refreshDuckSchema(),{delta:j,startPhysicalIndex:V}}},{key:"removeRow",value:function(r){var n=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,o=arguments.length>2?arguments[2]:void 0,s=Number.isInteger(r)?r:-i,a=this.visualRowsToPhysical(s,i),h=this.instance.countSourceRows();s=(h+s)%h;var p=this.instance.runHooks("beforeRemoveRow",s,a.length,a,o);if(p===!1)return!1;var g=a.length;if(this.filterData(s,g,a),s<this.instance.countRows()){this.instance.rowIndexMapper.removeIndexes(a);var S=dr(this.tableMeta.columns)||dr(this.tableMeta.dataSchema);this.instance.rowIndexMapper.getNotTrimmedIndexesLength()===0&&S===!1&&this.instance.columnIndexMapper.setIndexesSequence([])}var T=a.slice(0).sort(function(R,A){return A-R});return T.forEach(function(R){n.metaManager.removeRow(R,1)}),this.instance.runHooks("afterRemoveRow",s,g,a,o),this.instance.forceFullRender=!0,!0}},{key:"removeCol",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,i=arguments.length>2?arguments[2]:void 0;if(this.instance.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");var o=typeof r!="number"?-n:r;o=(this.instance.countCols()+o)%this.instance.countCols();var s=this.visualColumnsToPhysical(o,n),a=s.slice(0).sort(function(V,G){return G-V}),h=this.instance.runHooks("beforeRemoveCol",o,n,s,i);if(h===!1)return!1;for(var p=!0,g=a.length,S=this.dataSource,T=0;T<g;T++)p&&s[0]!==s[T]-T&&(p=!1);if(p)for(var R=0,A=this.instance.countSourceRows();R<A;R++)S[R].splice(s[0],n),R===0&&this.metaManager.removeColumn(s[0],n);else for(var $=0,j=this.instance.countSourceRows();$<j;$++)for(var z=0;z<g;z++)S[$].splice(a[z],1),$===0&&this.metaManager.removeColumn(a[z],1);return o<this.instance.countCols()&&(this.instance.columnIndexMapper.removeIndexes(s),this.instance.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.instance.rowIndexMapper.setIndexesSequence([])),this.instance.runHooks("afterRemoveCol",o,n,s,i),this.instance.forceFullRender=!0,this.refreshDuckSchema(),!0}},{key:"spliceCol",value:function(r,n,i){for(var o=this.instance.getDataAtCol(r),s=o.slice(n,n+i),a=o.slice(n+i),h=arguments.length,p=new Array(h>3?h-3:0),g=3;g<h;g++)p[g-3]=arguments[g];oY(p,a);for(var S=0;S<i;)p.push(null),S+=1;return l$e(p),this.instance.populateFromArray(n,r,p,null,null,"spliceCol"),s}},{key:"spliceRow",value:function(r,n,i){for(var o=this.instance.getSourceDataAtRow(r),s=o.slice(n,n+i),a=o.slice(n+i),h=arguments.length,p=new Array(h>3?h-3:0),g=3;g<h;g++)p[g-3]=arguments[g];oY(p,a);for(var S=0;S<i;)p.push(null),S+=1;return this.instance.populateFromArray(r,n,[p],null,null,"spliceRow"),s}},{key:"spliceData",value:function(r,n,i){var o=this,s=this.instance.runHooks("beforeDataSplice",r,n,i);if(s!==!1){var a=[].concat(Z$(this.dataSource.slice(0,r)),Z$(i),Z$(this.dataSource.slice(r)));this.dataSource.length=0,a.forEach(function(h){return o.dataSource.push(h)})}}},{key:"filterData",value:function(r,n,i){var o=this.instance.runHooks("filterData",r,n,i);Array.isArray(o)===!1&&(o=this.dataSource.filter(function(s,a){return i.indexOf(a)===-1})),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,o)}},{key:"get",value:function(r,n){var i=this.instance.toPhysicalRow(r),o=this.dataSource[i],s=this.instance.runHooks("modifyRowData",i);o=isNaN(s)?s:o;var a=null;if(o&&o.hasOwnProperty&&Ui(o,n))a=o[n];else if(typeof n=="string"&&n.indexOf(".")>-1){var h=n.split("."),p=o;if(!p)return null;for(var g=0,S=h.length;g<S;g++)if(p=p[h[g]],typeof p>"u")return null;a=p}else typeof n=="function"&&(a=n(this.dataSource.slice(i,i+1)[0]));if(this.instance.hasHook("modifyData")){var T=jg(a);this.instance.runHooks("modifyData",i,this.propToCol(n),T,"get"),T.isTouched()&&(a=T.value)}return a}},{key:"getCopyable",value:function(r,n){return this.instance.getCellMeta(r,this.propToCol(n)).copyable?this.get(r,n):""}},{key:"set",value:function(r,n,i){var o=this.instance.toPhysicalRow(r),s=i,a=this.dataSource[o],h=this.instance.runHooks("modifyRowData",o);if(a=isNaN(h)?h:a,this.instance.hasHook("modifyData")){var p=jg(s);this.instance.runHooks("modifyData",o,this.propToCol(n),p,"set"),p.isTouched()&&(s=p.value)}if(a&&a.hasOwnProperty&&Ui(a,n))a[n]=s;else if(typeof n=="string"&&n.indexOf(".")>-1){var g=n.split("."),S=a,T=0,R;for(T=0,R=g.length-1;T<R;T++)typeof S[g[T]]>"u"&&(S[g[T]]={}),S=S[g[T]];S[g[T]]=s}else typeof n=="function"?n(this.dataSource.slice(o,o+1)[0],s):a[n]=s}},{key:"visualRowsToPhysical",value:function(r,n){for(var i=this.instance.countSourceRows(),o=[],s=(i+r)%i,a=n,h;s<i&&a;)h=this.instance.toPhysicalRow(s),o.push(h),a-=1,s+=1;return o}},{key:"visualColumnsToPhysical",value:function(r,n){for(var i=this.instance.countCols(),o=[],s=(i+r)%i,a=n;s<i&&a;){var h=this.instance.toPhysicalColumn(s);o.push(h),a-=1,s+=1}return o}},{key:"clear",value:function(){for(var r=0;r<this.instance.countSourceRows();r++)for(var n=0;n<this.instance.countCols();n++)this.set(r,this.colToProp(n),"")}},{key:"getLength",value:function(){var r=this.tableMeta.maxRows,n;r<0||r===0?n=0:n=r||1/0;var i=this.instance.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(i,n)}},{key:"getAll",value:function(){var r={row:0,col:0},n={row:Math.max(this.instance.countRows()-1,0),col:Math.max(this.instance.countCols()-1,0)};return r.row-n.row===0&&!this.instance.countSourceRows()?[]:this.getRange(r,n,e.DESTINATION_RENDERER)}},{key:"countCachedColumns",value:function(){return this.colToPropCache.length}},{key:"getRange",value:function(r,n,i){var o=[],s,a,h,p=this.tableMeta.maxRows,g=this.tableMeta.maxCols;if(p===0||g===0)return[];var S=i===e.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,T=Math.min(Math.max(p-1,0),Math.max(r.row,n.row)),R=Math.min(Math.max(g-1,0),Math.max(r.col,n.col));for(s=Math.min(r.row,n.row);s<=T;s++){h=[];var A=s>=0?this.instance.toPhysicalRow(s):s;for(a=Math.min(r.col,n.col);a<=R&&A!==null;a++)h.push(S.call(this,s,this.colToProp(a)));A!==null&&o.push(h)}return o}},{key:"getText",value:function(r,n){return q0(this.getRange(r,n,e.DESTINATION_RENDERER))}},{key:"getCopyableText",value:function(r,n){return q0(this.getRange(r,n,e.DESTINATION_CLIPBOARD_GENERATOR))}},{key:"destroy",value:function(){this.instance=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}],[{key:"DESTINATION_RENDERER",get:function(){return 1}},{key:"DESTINATION_CLIPBOARD_GENERATOR",get:function(){return 2}}]),e}();const BQe=NQe;function jQe(e,t){var r;return e==="CELL_TYPE"?!1:((r=t._automaticallyAssignedMetaProps)===null||r===void 0?void 0:r.has(e))||!Ui(t,e)}function ZA(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,n=typeof t.type=="string"?dFe(t.type):t.type;if(e._automaticallyAssignedMetaProps&&pn(t,function(o,s){return void e._automaticallyAssignedMetaProps.delete(s)}),!!dn(n)){r===e&&!e._automaticallyAssignedMetaProps&&(e._automaticallyAssignedMetaProps=new Set);var i={};pn(n,function(o,s){if(jQe(s,r)){var a;i[s]=o,(a=e._automaticallyAssignedMetaProps)===null||a===void 0||a.add(s)}}),ao(e,i)}}function zQe(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function r(){}Sh(r,e);for(var n=0;n<t.length;n++)r.prototype[t[n]]=void 0;return r}function bR(e){return Number.isInteger(e)&&e>=0}function wR(e,t){if(!e())throw new Error("Assertion failed: ".concat(t))}function dO(e){return e==null}function sj(e){"@babel/helpers - typeof";return sj=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sj(e)}const Tle=function(){return{_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",isEmptyCol:function(t){var r,n,i;for(r=0,n=this.countRows();r<n;r++)if(i=this.getDataAtCell(r,t),go(i)===!1)return!1;return!0},isEmptyRow:function(t){var r,n,i,o;for(r=0,n=this.countCols();r<n;r++)if(i=this.getDataAtCell(t,r),go(i)===!1)return sj(i)==="object"?(o=this.getCellMeta(t,r),Poe(this.getSchema()[o.prop],i)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:void 0,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:void 0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",visibleRows:10,width:void 0,wordWrap:!0}};function z1(e){"@babel/helpers - typeof";return z1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},z1(e)}function K7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function q7(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?K7(Object(r),!0).forEach(function(n){FQe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):K7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function FQe(e,t,r){return t=Rle(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function X7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Rle(n.key),n)}}function Ole(e,t,r){return t&&X7(e.prototype,t),r&&X7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Rle(e){var t=HQe(e,"string");return z1(t)==="symbol"?t:String(t)}function HQe(e,t){if(z1(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(z1(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function kle(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function VQe(){return Ole(function e(){kle(this,e)})}var UQe=function(){function e(t){kle(this,e),this.metaCtor=VQe(),this.meta=this.metaCtor.prototype,ao(this.meta,Tle()),this.meta.instance=t}return Ole(e,[{key:"getMetaConstructor",value:function(){return this.metaCtor}},{key:"getMeta",value:function(){return this.meta}},{key:"updateMeta",value:function(r){var n;ao(this.meta,r),ZA(this.meta,q7(q7({},r),{},{type:(n=r.type)!==null&&n!==void 0?n:this.meta.type}),r)}}]),e}();function F1(e){"@babel/helpers - typeof";return F1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},F1(e)}function WQe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Z7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,YQe(n.key),n)}}function GQe(e,t,r){return t&&Z7(e.prototype,t),r&&Z7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function YQe(e){var t=KQe(e,"string");return F1(t)==="symbol"?t:String(t)}function KQe(e,t){if(F1(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(F1(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var qQe=function(){function e(t){WQe(this,e);var r=t.getMetaConstructor();this.meta=new r}return GQe(e,[{key:"getMeta",value:function(){return this.meta}},{key:"updateMeta",value:function(r){ao(this.meta,r),ZA(this.meta,r,r)}}]),e}();function H1(e){"@babel/helpers - typeof";return H1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},H1(e)}function J7(e){return QQe(e)||JQe(e)||ZQe(e)||XQe()}function XQe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ZQe(e,t){if(e){if(typeof e=="string")return lj(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return lj(e,t)}}function JQe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function QQe(e){if(Array.isArray(e))return lj(e)}function lj(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function eet(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Q7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ret(n.key),n)}}function tet(e,t,r){return t&&Q7(e.prototype,t),r&&Q7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ret(e){var t=net(e,"string");return H1(t)==="symbol"?t:String(t)}function net(e,t){if(H1(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(H1(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var uj=function(e){function t(r){eet(this,t),this.valueFactory=r,this.data=[],this.index=[],this.holes=new Set}return tet(t,[{key:"obtain",value:function(n){wR(function(){return bR(n)},"Expecting an unsigned number.");var i=this._getStorageIndexByKey(n),o;if(i>=0)o=this.data[i],o===void 0&&(o=this.valueFactory(n),this.data[i]=o);else if(o=this.valueFactory(n),this.holes.size>0){var s=this.holes.values().next().value;this.holes.delete(s),this.data[s]=o,this.index[n]=s}else this.data.push(o),this.index[n]=this.data.length-1;return o}},{key:"insert",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;wR(function(){return bR(n)||dO(n)},"Expecting an unsigned number or null/undefined argument.");for(var o=[],s=this.data.length,a=0;a<i;a++)o.push(s+a),this.data.push(void 0);var h=dO(n)?this.index.length:n;this.index=[].concat(J7(this.index.slice(0,h)),o,J7(this.index.slice(h)))}},{key:"remove",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;wR(function(){return bR(n)||dO(n)},"Expecting an unsigned number or null/undefined argument.");for(var o=this.index.splice(dO(n)?this.index.length-i:n,i),s=0;s<o.length;s++){var a=o[s];typeof a=="number"&&this.holes.add(a)}}},{key:"size",value:function(){return this.data.length-this.holes.size}},{key:"values",value:function(){var n=this;return $s(this.data,function(i,o){return!n.holes.has(o)})[Symbol.iterator]()}},{key:"entries",value:function(){for(var n=[],i=0;i<this.data.length;i++){var o=this._getKeyByStorageIndex(i);o!==-1&&n.push([o,this.data[i]])}var s=0;return{next:function(){if(s<n.length){var h=n[s];return s+=1,{value:h,done:!1}}return{done:!0}}}}},{key:"clear",value:function(){this.data=[],this.index=[],this.holes.clear()}},{key:"_getStorageIndexByKey",value:function(n){return this.index.length>n?this.index[n]:-1}},{key:"_getKeyByStorageIndex",value:function(n){return this.index.indexOf(n)}},{key:e,value:function(){return this.entries()}}]),t}(Symbol.iterator);function V1(e){"@babel/helpers - typeof";return V1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},V1(e)}function iet(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function eX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,aet(n.key),n)}}function oet(e,t,r){return t&&eX(e.prototype,t),r&&eX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function aet(e){var t=set(e,"string");return V1(t)==="symbol"?t:String(t)}function set(e,t){if(V1(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(V1(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var uet=["data","width"],cet=function(){function e(t){var r=this;iet(this,e),this.globalMeta=t,this.metas=new uj(function(){return r._createMeta()})}return oet(e,[{key:"updateMeta",value:function(r,n){var i=this.getMeta(r);ao(i,n),ZA(i,n)}},{key:"createColumn",value:function(r,n){this.metas.insert(r,n)}},{key:"removeColumn",value:function(r,n){this.metas.remove(r,n)}},{key:"getMeta",value:function(r){return this.metas.obtain(r)}},{key:"getMetaConstructor",value:function(r){return this.metas.obtain(r).constructor}},{key:"clearCache",value:function(){this.metas.clear()}},{key:"_createMeta",value:function(){return zQe(this.globalMeta.getMetaConstructor(),uet).prototype}}]),e}();function U1(e){"@babel/helpers - typeof";return U1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},U1(e)}function fet(e){return met(e)||pet(e)||det(e)||het()}function het(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function det(e,t){if(e){if(typeof e=="string")return cj(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return cj(e,t)}}function pet(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function met(e){if(Array.isArray(e))return cj(e)}function cj(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function yet(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function tX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,vet(n.key),n)}}function get(e,t,r){return t&&tX(e.prototype,t),r&&tX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function vet(e){var t=_et(e,"string");return U1(t)==="symbol"?t:String(t)}function _et(e,t){if(U1(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(U1(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var bet=function(){function e(t){var r=this;yet(this,e),this.columnMeta=t,this.metas=new uj(function(){return r._createRow()})}return get(e,[{key:"updateMeta",value:function(r,n,i){var o=this.getMeta(r,n);ao(o,i),ZA(o,i)}},{key:"createRow",value:function(r,n){this.metas.insert(r,n)}},{key:"createColumn",value:function(r,n){for(var i=0;i<this.metas.size();i++)this.metas.obtain(i).insert(r,n)}},{key:"removeRow",value:function(r,n){this.metas.remove(r,n)}},{key:"removeColumn",value:function(r,n){for(var i=0;i<this.metas.size();i++)this.metas.obtain(i).remove(r,n)}},{key:"getMeta",value:function(r,n,i){var o=this.metas.obtain(r).obtain(n);return i===void 0?o:o[i]}},{key:"setMeta",value:function(r,n,i,o){var s,a=this.metas.obtain(r).obtain(n);(s=a._automaticallyAssignedMetaProps)===null||s===void 0||s.delete(i),a[i]=o}},{key:"removeMeta",value:function(r,n,i){var o=this.metas.obtain(r).obtain(n);delete o[i]}},{key:"getMetas",value:function(){for(var r=[],n=Array.from(this.metas.values()),i=0;i<n.length;i++)r.push.apply(r,fet(n[i].values()));return r}},{key:"getMetasAtRow",value:function(r){wR(function(){return bR(r)},"Expecting an unsigned number.");var n=new Map(this.metas);return n.has(r)?Array.from(n.get(r).values()):[]}},{key:"clearCache",value:function(){this.metas.clear()}},{key:"_createRow",value:function(){var r=this;return new uj(function(n){return r._createMeta(n)})}},{key:"_createMeta",value:function(r){var n=this.columnMeta.getMetaConstructor(r);return new n}}]),e}();function W1(e){"@babel/helpers - typeof";return W1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},W1(e)}function wet(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function rX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Cet(n.key),n)}}function xet(e,t,r){return t&&rX(e.prototype,t),r&&rX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Cet(e){var t=Eet(e,"string");return W1(t)==="symbol"?t:String(t)}function Eet(e,t){if(W1(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(W1(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ple=function(){function e(t){var r=this,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];wet(this,e),this.hot=t,this.globalMeta=new UQe(t),this.tableMeta=new qQe(this.globalMeta),this.columnMeta=new cet(this.globalMeta),this.cellMeta=new bet(this.columnMeta),i.forEach(function(o){return new o(r)}),this.globalMeta.updateMeta(n)}return xet(e,[{key:"getGlobalMeta",value:function(){return this.globalMeta.getMeta()}},{key:"updateGlobalMeta",value:function(r){this.globalMeta.updateMeta(r)}},{key:"getTableMeta",value:function(){return this.tableMeta.getMeta()}},{key:"updateTableMeta",value:function(r){this.tableMeta.updateMeta(r)}},{key:"getColumnMeta",value:function(r){return this.columnMeta.getMeta(r)}},{key:"updateColumnMeta",value:function(r,n){this.columnMeta.updateMeta(r,n)}},{key:"getCellMeta",value:function(r,n,i){var o=i.visualRow,s=i.visualColumn,a=this.cellMeta.getMeta(r,n);return a.visualRow=o,a.visualCol=s,a.row=r,a.col=n,this.runLocalHooks("afterGetCellMeta",a),a}},{key:"getCellMetaKeyValue",value:function(r,n,i){if(typeof i!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(r,n,i)}},{key:"setCellMeta",value:function(r,n,i,o){this.cellMeta.setMeta(r,n,i,o)}},{key:"updateCellMeta",value:function(r,n,i){this.cellMeta.updateMeta(r,n,i)}},{key:"removeCellMeta",value:function(r,n,i){this.cellMeta.removeMeta(r,n,i)}},{key:"getCellsMeta",value:function(){return this.cellMeta.getMetas()}},{key:"getCellsMetaAtRow",value:function(r){return this.cellMeta.getMetasAtRow(r)}},{key:"createRow",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(r,n)}},{key:"removeRow",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(r,n)}},{key:"createColumn",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(r,n),this.columnMeta.createColumn(r,n)}},{key:"removeColumn",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(r,n),this.columnMeta.removeColumn(r,n)}},{key:"clearCellsCache",value:function(){this.cellMeta.clearCache()}},{key:"clearCache",value:function(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}]),e}();li(Ple,Va);function uP(e){"@babel/helpers - typeof";return uP=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},uP(e)}function nX(e,t,r,n){var i=n.hotInstance,o=n.dataMap,s=n.dataSource,a=n.internalSource,h=n.source,p=n.metaManager,g=n.firstRun,S=xc(a),T=i.getSettings();Array.isArray(T.dataSchema)?i.dataType="array":ci(T.dataSchema)?i.dataType="function":i.dataType="object",o&&o.destroy(),e=i.runHooks("before".concat(S),e,g,h);var R=new BQe(i,e,p);if(t(R),uP(e)==="object"&&e!==null)e.push&&e.splice||(e=[e]);else if(e===null){var A=R.getSchema();e=[];var $,j=0,z=0;for(j=0,z=T.startRows;j<z;j++)if((i.dataType==="object"||i.dataType==="function")&&T.dataSchema)$=ya(A),e.push($);else if(i.dataType==="array")$=ya(A[0]),e.push($);else{$=[];for(var V=0,G=T.startCols;V<G;V++)$.push(null);e.push($)}}else throw new Error("".concat(a," only accepts array of objects or array of arrays (").concat(uP(e)," given)"));Array.isArray(e[0])&&(i.dataType="array"),T.data=e,R.dataSource=e,s.data=e,s.dataType=i.dataType,s.colToProp=R.colToProp.bind(R),s.propToCol=R.propToCol.bind(R),s.countCachedColumns=R.countCachedColumns.bind(R),r(R),i.runHooks("after".concat(S),e,g,h),g||(i.runHooks("afterChange",null,a),i.render())}function G1(e){"@babel/helpers - typeof";return G1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},G1(e)}function Tet(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function iX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ret(n.key),n)}}function Oet(e,t,r){return t&&iX(e.prototype,t),r&&iX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ret(e){var t=ket(e,"string");return G1(t)==="symbol"?t:String(t)}function ket(e,t){if(G1(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(G1(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Pet=function(){function e(t){var r=this;Tet(this,e),this.metaManager=t,this.metaSyncMemo=new Map,t.addLocalHook("afterGetCellMeta",function(n){return r.extendCellMeta(n)}),mr.getSingleton().add("beforeRender",function(n){n&&r.metaSyncMemo.clear()},this.metaManager.hot)}return Oet(e,[{key:"extendCellMeta",value:function(r){var n,i=r.row,o=r.col;if(!((n=this.metaSyncMemo.get(i))!==null&&n!==void 0&&n.has(o))){var s=r.visualRow,a=r.visualCol,h=this.metaManager.hot,p=h.colToProp(a);r.prop=p,h.runHooks("beforeGetCellMeta",s,a,r);var g=Ui(r,"type")?r.type:null,S=ci(r.cells)?r.cells(i,o,p):null;if(g)if(S){var T;S.type=(T=S.type)!==null&&T!==void 0?T:g}else S={type:g};S&&this.metaManager.updateCellMeta(i,o,S),h.runHooks("afterGetCellMeta",s,a,r),this.metaSyncMemo.has(i)||this.metaSyncMemo.set(i,new Set),this.metaSyncMemo.get(i).add(o)}}}]),e}();function Y1(e){"@babel/helpers - typeof";return Y1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Y1(e)}function Aet(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function oX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Met(n.key),n)}}function Iet(e,t,r){return t&&oX(e.prototype,t),r&&oX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Met(e){var t=Det(e,"string");return Y1(t)==="symbol"?t:String(t)}function Det(e,t){if(Y1(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Y1(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var $et=function(){function e(t){Aet(this,e),this.metaManager=t,this.usageTracker=new Set,this.propDescriptors=new Map([["fixedColumnsLeft",{target:"fixedColumnsStart",onChange:function(n){var i=this.metaManager.hot.isRtl();if(i&&n==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{onChange:function(n,i,o){if(!o)throw new Error("The `".concat(n,"` option can not be updated after the Handsontable is initialized."))}}]]),this.extendMetaProps()}return Iet(e,[{key:"extendMetaProps",value:function(){var r=this;this.propDescriptors.forEach(function(n,i){var o=n.target,s=n.onChange,a=s===void 0?function(){}:s,h=typeof o=="string",p=h?o:i,g="_".concat(p);r.metaManager.globalMeta.meta[g]=r.metaManager.globalMeta.meta[p],r.installPropWatcher(i,g,a),h&&r.installPropWatcher(o,g,a)})}},{key:"installPropWatcher",value:function(r,n,i){var o=this;Object.defineProperty(this.metaManager.globalMeta.meta,r,{get:function(){return this[n]},set:function(a){var h=!o.usageTracker.has(r);o.usageTracker.add(r),i.call(o,r,a,h),this[n]=a},enumerable:!0,configurable:!0})}}]),e}(),aX=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),pO=function(t){return t.map(function(r){var n=r.toLowerCase();return aX.has(n)?aX.get(n):n}).sort().join("+")},Let=function(t){return t.split("+")},sX=function(t){return t.toLowerCase()},lX;function Net(e){return zet(e)||jet(e)||Ale(e)||Bet()}function Bet(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function jet(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function zet(e){if(Array.isArray(e))return fj(e)}function Fet(e,t){return Uet(e)||Vet(e,t)||Ale(e,t)||Het()}function Het(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ale(e,t){if(e){if(typeof e=="string")return fj(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return fj(e,t)}}function fj(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Vet(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],h=!0,p=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;h=!1}else for(;!(h=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);h=!0);}catch(g){p=!0,i=g}finally{try{if(!h&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(p)throw i}}return a}}function Uet(e){if(Array.isArray(e))return e}function Wet(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var Get=function(t){var r=DA({errorIdExists:function(g){return'The "'.concat(g,'" shortcut is already registered in the "').concat(t,'" context.')}}),n=function(){var g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},S=g.keys,T=g.callback,R=g.group,A=g.runOnlyIf,$=A===void 0?function(){return!0}:A,j=g.captureCtrl,z=j===void 0?!1:j,V=g.preventDefault,G=V===void 0?!0:V,ee=g.stopPropagation,K=ee===void 0?!1:ee,xe=g.relativeToGroup,Me=g.position;if(si(R))throw new Error("You need to define the shortcut's group.");if(ci(T)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(S)===!1)throw new Error(Xn(lX||(lX=Wet([`Pass the shortcut's keys as an array of arrays, 
      using the KeyboardEvent.key properties: 
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`],[`Pass the shortcut\\'s keys as an array of arrays,\\x20
      using the KeyboardEvent.key properties:\\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`]))));var He={callback:T,group:R,runOnlyIf:$,captureCtrl:z,preventDefault:G,stopPropagation:K};if(dr(xe)){var Ne=[xe,Me];He.relativeToGroup=Ne[0],He.position=Ne[1]}S.forEach(function(We){var gt=pO(We),Lt=r.hasItem(gt);if(Lt){var _t=r.getItem(gt),$e=_t.findIndex(function(Fe){return Fe.group===xe});$e!==-1?Me==="before"?$e-=1:$e+=1:$e=_t.length,_t.splice($e,0,He)}else r.addItem(gt,[He])})},i=function(g){var S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};g.forEach(function(T){pn(S,function(R,A){Object.prototype.hasOwnProperty.call(T,A)===!1&&(T[A]=S[A])}),n(T)})},o=function(g){var S=pO(g);r.removeItem(S)},s=function(g){var S=r.getItems();S.forEach(function(T){var R=Fet(T,2),A=R[0],$=R[1],j=$.filter(function(z){return z.group!==g});j.length===0?o(Let(A)):($.length=0,$.push.apply($,Net(j)))})},a=function(g){var S=pO(g),T=r.getItem(S);return dr(T)?T.slice():[]},h=function(g){var S=pO(g);return r.hasItem(S)};return{addShortcut:n,addShortcuts:i,getShortcuts:a,hasShortcut:h,removeShortcutsByKeys:o,removeShortcutsByGroup:s}};function Yet(){var e=new Set;return{press:function(r){e.add(r)},release:function(r){e.delete(r)},releaseAll:function(){e.clear()},isPressed:function(r){return e.has(r)}}}var Ket=["meta","alt","shift","control"],i0=Yet();function qet(e,t,r,n,i){var o=function(R){return Ket.includes(R)},s=function(R){var A=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,$=[];return R.altKey&&$.push("alt"),A&&(R.ctrlKey||R.metaKey)?$.push("control/meta"):(R.ctrlKey&&$.push("control"),R.metaKey&&$.push("meta")),R.shiftKey&&$.push("shift"),$},a=function(R){if(t(R)!==!1){var A=r(R);if(!(R.keyCode===229||A===!1||Uy(R))){var $=sX(R.key),j=[];o($)?i0.press($):j=s(R);var z=[$].concat(j),V=i(R,z);!V&&(xY()&&j.includes("meta")||!xY()&&j.includes("control"))&&i(R,[$].concat(s(R,!0))),n(R)}}},h=function(R){if(t(R)!==!1){var A=sX(R.key);o(A)!==!1&&i0.release(A)}},p=function(){i0.releaseAll()},g=function(){for(var R=e;R;)R.document.documentElement.addEventListener("keydown",a),R.document.documentElement.addEventListener("keyup",h),R.document.documentElement.addEventListener("blur",p),R=xk(R)},S=function(){for(var R=e;R;)R.document.documentElement.removeEventListener("keydown",a),R.document.documentElement.removeEventListener("keyup",h),R.document.documentElement.removeEventListener("blur",p),R=xk(R)};return{mount:g,unmount:S,isPressed:function(R){return i0.isPressed(R)},releasePressedKeys:function(){return i0.releaseAll()}}}var Xet=function(t){var r=t.ownerWindow,n=t.handleEvent,i=t.beforeKeyDown,o=t.afterKeyDown,s=DA({errorIdExists:function($){return'The "'.concat($,'" context name is already registered.')}}),a="grid",h=function($){var j=Get($);return s.addItem($,j),j},p=function(){return a},g=function($){return s.getItem($)},S=function($){a=$},T=!1,R=qet(r,n,i,o,function(A,$){var j=g(p()),z=!1;if(!j.hasShortcut($))return z;for(var V=j.getShortcuts($),G=0;G<V.length;G++){var ee=V[G],K=ee.callback,xe=ee.runOnlyIf,Me=ee.preventDefault,He=ee.stopPropagation,Ne=ee.captureCtrl;if(xe(A)!==!1&&(T=Ne,z=K(A,$)===!1,T=!1,Me&&A.preventDefault(),He&&A.stopPropagation(),z))break}return z});return R.mount(),{addContext:h,getActiveContextName:p,getContext:g,setActiveContextName:S,isCtrlPressed:function(){return!T&&(R.isPressed("control")||R.isPressed("meta"))},releasePressedKeys:function(){return R.releasePressedKeys()},destroy:function(){return R.unmount()}}},uX,cX;function Aa(e){"@babel/helpers - typeof";return Aa=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Aa(e)}function fX(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function Wl(e,t){return Qet(e)||Jet(e,t)||Ile(e,t)||Zet()}function Zet(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Jet(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],h=!0,p=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;h=!1}else for(;!(h=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);h=!0);}catch(g){p=!0,i=g}finally{try{if(!h&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(p)throw i}}return a}}function Qet(e){if(Array.isArray(e))return e}function Ty(e){return rtt(e)||ttt(e)||Ile(e)||ett()}function ett(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ile(e,t){if(e){if(typeof e=="string")return hj(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return hj(e,t)}}function ttt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function rtt(e){if(Array.isArray(e))return hj(e)}function hj(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var ntt="gridDefault",J$=null,mO=new Set;function cU(e,t){var r,n=this,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=!1,s=this,a=new Bi(s),h,p,g,S,T=!0;JXe(i)&&ZXe(this),this.rootElement=e,this.rootDocument=e.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;var R=(r=t==null?void 0:t.layoutDirection)!==null&&r!==void 0?r:"inherit",A=["rtl","ltr"].includes(R)?R:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",A),this.isRtl=function(){return A==="rtl"},this.isLtr=function(){return!s.isRtl()},this.getDirectionFactor=function(){return s.isLtr()?1:-1},t.language=jZe(t.language);var $=new Ple(s,t,[Pet,$et]),j=$.getTableMeta(),z=$.getGlobalMeta(),V=DA();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,e.insertBefore(this.container,e.firstChild),ej(this)&&h$e(t.licenseKey,e),this.guid="ht_".concat(Voe()),this.columnIndexMapper=new AB,this.rowIndexMapper=new AB,p=new SZe(s),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);var G=function(U){var q=U.row,ne=U.col;return s._createCellCoords(q>=0?s.rowIndexMapper.getRenderableFromVisualIndex(q):q,ne>=0?s.columnIndexMapper.getRenderableFromVisualIndex(ne):ne)},ee=function(U){var q=U.row,ne=U.col;return s._createCellCoords(q>=0?s.rowIndexMapper.getVisualFromRenderableIndex(q):q,ne>=0?s.columnIndexMapper.getVisualFromRenderableIndex(ne):ne)},K=new gQe(j,{rowIndexMapper:function(){return s.rowIndexMapper},columnIndexMapper:function(){return s.columnIndexMapper},countCols:function(){return s.countCols()},countRows:function(){return s.countRows()},propToCol:function(U){return h.propToCol(U)},isEditorOpened:function(){return s.getActiveEditor()?s.getActiveEditor().isOpened():!1},countColsTranslated:function(){return n.view.countRenderableColumns()},countRowsTranslated:function(){return n.view.countRenderableRows()},getShortcutManager:function(){return s.getShortcutManager()},createCellCoords:function(U,q){return s._createCellCoords(U,q)},createCellRange:function(U,q,ne){return s._createCellRange(U,q,ne)},visualToRenderableCoords:G,renderableToVisualCoords:ee,isDisabledCellSelection:function(U,q){return s.getCellMeta(U,q).disableVisualSelection}});this.selection=K;var xe=function(U){var q=U.hiddenIndexesChanged;q&&n.selection.refresh()};this.columnIndexMapper.addLocalHook("cacheUpdated",xe),this.rowIndexMapper.addLocalHook("cacheUpdated",xe),this.selection.addLocalHook("beforeSetRangeStart",function(D){n.runHooks("beforeSetRangeStart",D)}),this.selection.addLocalHook("beforeSetRangeStartOnly",function(D){n.runHooks("beforeSetRangeStartOnly",D)}),this.selection.addLocalHook("beforeSetRangeEnd",function(D){n.runHooks("beforeSetRangeEnd",D),D.row<0&&(D.row=n.view._wt.wtTable.getFirstVisibleRow()),D.col<0&&(D.col=n.view._wt.wtTable.getFirstVisibleColumn())}),this.selection.addLocalHook("afterSetRangeEnd",function(D){var U=jg(!1),q=n.selection.getSelectedRange(),ne=q.current(),ye=ne.from,ve=ne.to,ze=q.size()-1;n.runHooks("afterSelection",ye.row,ye.col,ve.row,ve.col,U,ze),n.runHooks("afterSelectionByProp",ye.row,s.colToProp(ye.col),ve.row,s.colToProp(ve.col),U,ze);var je=n.selection.isSelectedByAnyHeader(),Je=n.selection.selectedRange.current(),xt=!0;o&&(xt=!1),U.isTouched()&&(xt=!U.value);var kt=n.selection.isSelectedByRowHeader(),jt=n.selection.isSelectedByColumnHeader();xt!==!1&&(je?kt?n.view.scrollViewportVertically(s.rowIndexMapper.getRenderableFromVisualIndex(D.row)):jt&&n.view.scrollViewportHorizontally(s.columnIndexMapper.getRenderableFromVisualIndex(D.col)):Je&&!n.selection.isMultiple()?n.view.scrollViewport(G(Je.from)):n.view.scrollViewport(G(D))),kt&&jt?Ht(n.rootElement,["ht__selection--rows","ht__selection--columns"]):kt?(Kr(n.rootElement,"ht__selection--columns"),Ht(n.rootElement,"ht__selection--rows")):jt?(Kr(n.rootElement,"ht__selection--rows"),Ht(n.rootElement,"ht__selection--columns")):Kr(n.rootElement,["ht__selection--rows","ht__selection--columns"]),n._refreshBorders(null)}),this.selection.addLocalHook("afterSelectionFinished",function(D){var U=D.length-1,q=D[U],ne=q.from,ye=q.to;n.runHooks("afterSelectionEnd",ne.row,ne.col,ye.row,ye.col,U),n.runHooks("afterSelectionEndByProp",ne.row,s.colToProp(ne.col),ye.row,s.colToProp(ye.col),U)}),this.selection.addLocalHook("afterIsMultipleSelection",function(D){var U=n.runHooks("afterIsMultipleSelection",D.value);D.value&&(D.value=U)}),this.selection.addLocalHook("beforeModifyTransformStart",function(D){n.runHooks("modifyTransformStart",D)}),this.selection.addLocalHook("afterModifyTransformStart",function(D,U,q){n.runHooks("afterModifyTransformStart",D,U,q)}),this.selection.addLocalHook("beforeModifyTransformEnd",function(D){n.runHooks("modifyTransformEnd",D)}),this.selection.addLocalHook("afterModifyTransformEnd",function(D,U,q){n.runHooks("afterModifyTransformEnd",D,U,q)}),this.selection.addLocalHook("afterDeselect",function(){S.destroyEditor(),n._refreshBorders(),Kr(n.rootElement,["ht__selection--rows","ht__selection--columns"]),n.runHooks("afterDeselect")}),this.selection.addLocalHook("insertRowRequire",function(D){n.alter("insert_row_above",D,1,"auto")}),this.selection.addLocalHook("insertColRequire",function(D){n.alter("insert_col_start",D,1,"auto")}),g={alter:function(U,q){var ne,ye,ve=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,ze=arguments.length>3?arguments[3]:void 0,je=arguments.length>4?arguments[4]:void 0,Je=function(Ir){if(Ir.length===0)return[];var Ar=Ty(Ir);Ar.sort(function(on,Fr){var jr=Wl(on,1),tn=jr[0],ei=Wl(Fr,1),xn=ei[0];return tn===xn?0:tn>xn?1:-1});var sn=na(Ar,function(on,Fr){var jr=Wl(Fr,2),tn=jr[0],ei=jr[1],xn=on[on.length-1],ln=Wl(xn,2),zr=ln[0],vo=ln[1],ia=zr+vo;if(tn<=ia){var jo=Math.max(ei-(ia-tn),0);xn[1]+=jo}else on.push([tn,ei]);return on},[Ar[0]]);return sn};switch(U){case"insert_row":mO.has(U)||(mO.add(U),ti(Xn(uX||(uX=fX(["The `","` action of the `alter()` method is deprecated and will be removed \n                              in the next major release of Handsontable. Use the `insert_row_above` action instead."],["The \\`","\\` action of the \\`alter()\\` method is deprecated and will be removed\\x20\n                              in the next major release of Handsontable. Use the \\`insert_row_above\\` action instead."])),U)));case"insert_row_below":case"insert_row_above":var xt=s.countSourceRows();if(j.maxRows===xt)return;var kt=U==="insert_row_below"?"below":"above";q=(ne=q)!==null&&ne!==void 0?ne:U==="insert_row"||kt==="below"?xt:0;var jt=h.createRow(q,ve,{source:ze,mode:kt}),yr=jt.delta,Ft=jt.startPhysicalIndex;if(yr){var Jt=K.selectedRange.current(),et=Jt==null?void 0:Jt.from,wr=et==null?void 0:et.row,$r=s.toVisualRow(Ft);if(K.isSelectedByCorner())s.selectAll();else if(dr(wr)&&wr>=$r){var lr=Jt.to,Sr=lr.row,Or=lr.col,se=et.col;K.isSelectedByRowHeader()&&(se=-1),K.getSelectedRange().pop(),K.setRangeStartOnly(s._createCellCoords(wr+yr,se),!0),K.setRangeEnd(s._createCellCoords(Sr+yr,Or))}else s._refreshBorders()}break;case"insert_col":mO.has(U)||(mO.add(U),ti(Xn(cX||(cX=fX(["The `","` action of the `alter()` method is deprecated and will be removed \n                              in the next major release of Handsontable. Use the `insert_col_start` action instead."],["The \\`","\\` action of the \\`alter()\\` method is deprecated and will be removed\\x20\n                              in the next major release of Handsontable. Use the \\`insert_col_start\\` action instead."])),U)));case"insert_col_start":case"insert_col_end":var _e=U==="insert_col_end"?"end":"start";q=(ye=q)!==null&&ye!==void 0?ye:U==="insert_col"||_e==="end"?s.countSourceCols():0;var Re=h.createCol(q,ve,{source:ze,mode:_e}),Ke=Re.delta,Be=Re.startPhysicalIndex;if(Ke){if(Array.isArray(j.colHeaders)){var rt=[s.toVisualColumn(Be),0];rt.length+=Ke,Array.prototype.splice.apply(j.colHeaders,rt)}var Ue=K.selectedRange.current(),Ve=Ue==null?void 0:Ue.from,st=Ve==null?void 0:Ve.col,Ze=s.toVisualColumn(Be);if(K.isSelectedByCorner())s.selectAll();else if(dr(st)&&st>=Ze){var ft=Ue.to,zt=ft.row,nr=ft.col,cr=Ve.row;K.isSelectedByColumnHeader()&&(cr=-1),K.getSelectedRange().pop(),K.setRangeStartOnly(s._createCellCoords(cr,st+Ke),!0),K.setRangeEnd(s._createCellCoords(zt,nr+Ke))}else s._refreshBorders()}break;case"remove_row":var Pr=function(Ir){var Ar=0;Le(Ir,function(sn){var on=Wl(sn,2),Fr=on[0],jr=on[1],tn=go(Fr)?s.countRows()-1:Math.max(Fr-Ar,0);Number.isInteger(Fr)&&(Fr=Math.max(Fr-Ar,0));var ei=h.removeRow(Fr,jr,ze);if(ei){var xn=s.countRows(),ln=j.fixedRowsTop;ln>=tn+1&&(j.fixedRowsTop-=Math.min(jr,ln-tn));var zr=j.fixedRowsBottom;zr&&tn>=xn-zr&&(j.fixedRowsBottom-=Math.min(jr,zr)),Ar+=jr}})};Array.isArray(q)?Pr(Je(q)):Pr([[q,ve]]),g.adjustRowsAndCols(),s._refreshBorders();break;case"remove_col":var Vr=function(Ir){var Ar=0;Le(Ir,function(sn){var on=Wl(sn,2),Fr=on[0],jr=on[1],tn=go(Fr)?s.countCols()-1:Math.max(Fr-Ar,0),ei=s.toPhysicalColumn(tn);Number.isInteger(Fr)&&(Fr=Math.max(Fr-Ar,0));var xn=h.removeCol(Fr,jr,ze);if(xn){var ln=j.fixedColumnsStart;ln>=tn+1&&(j.fixedColumnsStart-=Math.min(jr,ln-tn)),Array.isArray(j.colHeaders)&&(typeof ei>"u"&&(ei=-1),j.colHeaders.splice(ei,jr)),Ar+=jr}})};Array.isArray(q)?Vr(Je(q)):Vr([[q,ve]]),g.adjustRowsAndCols(),s._refreshBorders();break;default:throw new Error('There is no such action "'.concat(U,'"'))}je||g.adjustRowsAndCols()},adjustRowsAndCols:function(){var U=j.minRows,q=j.minSpareRows,ne=j.minCols,ye=j.minSpareCols;if(s.countRows()===0&&s.countCols()===0&&K.deselect(),U){var ve=s.countRows();ve<U&&h.createRow(ve,U-ve,{source:"auto"})}if(q){var ze=s.countEmptyRows(!0);if(ze<q){var je=q-ze,Je=Math.min(je,j.maxRows-s.countSourceRows());h.createRow(s.countRows(),Je,{source:"auto"})}}{var xt;(ne||ye)&&(xt=s.countEmptyCols(!0));var kt=s.countCols();if(ne&&!j.columns&&kt<ne){var jt=ne-kt;xt+=jt,h.createCol(kt,jt,{source:"auto"})}if(ye&&!j.columns&&s.dataType==="array"&&xt<ye){kt=s.countCols();var yr=ye-xt,Ft=Math.min(yr,j.maxCols-kt);h.createCol(kt,Ft,{source:"auto"})}}if(K.isSelected()){var Jt=s.countRows(),et=s.countCols();Le(K.selectedRange,function(wr){var $r=!1,lr=wr.from.row,Sr=wr.from.col,Or=wr.to.row,se=wr.to.col;lr>Jt-1?(lr=Jt-1,$r=!0,Or>lr&&(Or=lr)):Or>Jt-1&&(Or=Jt-1,$r=!0,lr>Or&&(lr=Or)),Sr>et-1?(Sr=et-1,$r=!0,se>Sr&&(se=Sr)):se>et-1&&(se=et-1,$r=!0,Sr>se&&(Sr=se)),$r&&s.selectCell(lr,Sr,Or,se)})}s.view&&s.view.adjustElementsSize()},populateFromArray:function(U,q,ne,ye,ve,ze,je){var Je,xt,kt,jt,yr=[],Ft={},Jt=[],et=U.row,wr=U.col;if(xt=q.length,xt===0)return!1;var $r=0,lr=0;switch(dn(ne)&&($r=ne.col-wr+1,lr=ne.row-et+1),ve){case"shift_down":var Sr=iR(q),Or=Sr.length,se=Math.max(Or,$r),_e=s.getData().slice(et),Re=iR(_e).slice(wr,wr+se);for(kt=0;kt<se;kt+=1)if(kt<Or){for(Je=0,xt=Sr[kt].length;Je<lr-xt;Je+=1)Sr[kt].push(Sr[kt][Je%xt]);kt<Re.length?Jt.push(Sr[kt].concat(Re[kt])):Jt.push(Sr[kt].concat(new Array(_e.length).fill(null)))}else Jt.push(Sr[kt%Or].concat(Re[kt]));s.populateFromArray(et,wr,iR(Jt));break;case"shift_right":var Ke=q.length,Be=Math.max(Ke,lr),rt=s.getData().slice(et).map(function(ln){return ln.slice(wr)});for(Je=0;Je<Be;Je+=1)if(Je<Ke){for(kt=0,jt=q[Je].length;kt<$r-jt;kt+=1)q[Je].push(q[Je][kt%jt]);if(Je<rt.length)for(var Ue=0;Ue<rt[Je].length;Ue+=1)q[Je].push(rt[Je][Ue]);else{var Ve;(Ve=q[Je]).push.apply(Ve,Ty(new Array(rt[0].length).fill(null)))}}else q.push(q[Je%xt].slice(0,Be).concat(rt[Je]));s.populateFromArray(et,wr,q);break;case"overwrite":default:Ft.row=U.row,Ft.col=U.col;var st={row:ne&&U?ne.row-U.row+1:1,col:ne&&U?ne.col-U.col+1:1},Ze=0,ft=0,zt=!0,nr,cr=function(zr){var vo=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,ia=q[zr%q.length];return vo!==null?ia[vo%ia.length]:ia},Pr=q.length,Vr=ne?ne.row-U.row+1:0;for(ne?xt=Vr:xt=Math.max(Pr,Vr),Je=0;Je<xt&&!(ne&&Ft.row>ne.row&&Vr>Pr||!j.allowInsertRow&&Ft.row>s.countRows()-1||Ft.row>=j.maxRows);Je++){var gn=Je-Ze,Ir=cr(gn).length,Ar=ne?ne.col-U.col+1:0;if(ne?jt=Ar:jt=Math.max(Ir,Ar),Ft.col=U.col,nr=s.getCellMeta(Ft.row,Ft.col),(ye==="CopyPaste.paste"||ye==="Autofill.fill")&&nr.skipRowOnPaste){Ze+=1,Ft.row+=1,xt+=1;continue}for(ft=0,kt=0;kt<jt&&!(ne&&Ft.col>ne.col&&Ar>Ir||!j.allowInsertColumn&&Ft.col>s.countCols()-1||Ft.col>=j.maxCols);kt++){if(nr=s.getCellMeta(Ft.row,Ft.col),(ye==="CopyPaste.paste"||ye==="Autofill.fill")&&nr.skipColumnOnPaste){ft+=1,Ft.col+=1,jt+=1;continue}if(nr.readOnly&&ye!=="UndoRedo.undo"){Ft.col+=1;continue}var sn=kt-ft,on=cr(gn,sn),Fr=s.getDataAtCell(Ft.row,Ft.col),jr={row:gn,col:sn};if(ye==="Autofill.fill"){var tn=s.runHooks("beforeAutofillInsidePopulate",jr,ze,q,je,{},st);tn&&(on=si(tn.value)?on:tn.value)}if(on!==null&&Aa(on)==="object")if(Array.isArray(on)&&Fr===null&&(Fr=[]),Fr===null||Aa(Fr)!=="object")zt=!1;else{var ei=ES(Array.isArray(Fr)?Fr:Fr[0]||Fr),xn=ES(Array.isArray(on)?on:on[0]||on);Poe(ei,xn)||Array.isArray(ei)&&Array.isArray(xn)?on=ya(on):zt=!1}else Fr!==null&&Aa(Fr)==="object"&&(zt=!1);zt&&yr.push([Ft.row,Ft.col,on]),zt=!0,Ft.col+=1}Ft.row+=1}s.setDataAtCell(yr,null,null,ye||"populateFromArray");break}}};function Me(D){var U=cle(D);sU(U)?(s.runHooks("beforeLanguageChange",U),z.language=U,s.runHooks("afterLanguageChange",U)):fle(D)}function He(D,U){var q=D==="className"?s.rootElement:s.table;if(T)Ht(q,U);else{var ne=[],ye=[];z[D]&&(ne=Array.isArray(z[D])?z[D]:sY(z[D])),U&&(ye=Array.isArray(U)?U:sY(U));var ve=aY(ne,ye),ze=aY(ye,ne);ve.length&&Kr(q,ve),ze.length&&Ht(q,ze)}z[D]=U}this.init=function(){p.setData(j.data),s.runHooks("beforeInit"),(nu()||Moe())&&Ht(s.rootElement,"mobile"),this.updateSettings(j,!0),this.view=new hZe(this),S=ANe.getInstance(s,j,K),s.runHooks("init"),this.forceFullRender=!0,this.view.render(),T&&s.rootElement.offsetParent===null&&mLe(s.rootElement,function(){s.view._wt.wtOverlays.updateLastSpreaderSize(),s.render(),s.view.adjustElementsSize()}),Aa(T)==="object"&&(s.runHooks("afterChange",T[0],T[1]),T=!1),s.runHooks("afterInit")};function Ne(){var D=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue:function(){this.validatorsInQueue+=1,D=!1},removeValidatorFormQueue:function(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty:function(){},checkIfQueueIsEmpty:function(){this.validatorsInQueue===0&&D===!1&&(D=!0,this.onQueueEmpty(this.valid))}}}function We(D){var U=D.replace(",",".");return isNaN(parseFloat(U))===!1?parseFloat(U):D}function gt(D,U,q){if(D.length){var ne=s.getActiveEditor(),ye=s.runHooks("beforeChange",D,U||"edit"),ve=!0;if(ye===!1){ne&&ne.cancelChanges();return}var ze=new Ne;ze.onQueueEmpty=function(Jt){ne&&ve&&ne.cancelChanges(),q(Jt)};for(var je=D.length-1;je>=0;je--)if(D[je]===null)D.splice(je,1);else{var Je=Wl(D[je],4),xt=Je[0],kt=Je[1],jt=Je[3],yr=h.propToCol(kt),Ft=s.getCellMeta(xt,yr);Ft.type==="numeric"&&typeof jt=="string"&&rBe(jt)&&(D[je][3]=We(jt)),s.getCellValidator(Ft)&&(ze.addValidatorToQueue(),s.validateCell(D[je][3],Ft,function(Jt,et){return function(wr){if(typeof wr!="boolean")throw new Error("Validation error: result is not boolean");if(wr===!1&&et.allowInvalid===!1){ve=!1,D.splice(Jt,1),et.valid=!0;var $r=s.getCell(et.visualRow,et.visualCol);$r!==null&&Kr($r,j.invalidCellClassName)}ze.removeValidatorFormQueue()}}(je,Ft),U))}ze.checkIfQueueIsEmpty()}}function Lt(D,U){var q=D.length-1;if(!(q<0)){for(;q>=0;q--){var ne=!1;if(D[q]===null){D.splice(q,1);continue}if(!((D[q][2]===null||D[q][2]===void 0)&&(D[q][3]===null||D[q][3]===void 0))){if(j.allowInsertRow)for(;D[q][0]>s.countRows()-1;){var ye=h.createRow(void 0,void 0,{source:U}),ve=ye.delta;if(ve===0){ne=!0;break}}if(s.dataType==="array"&&(!j.columns||j.columns.length===0)&&j.allowInsertColumn)for(;h.propToCol(D[q][1])>s.countCols()-1;){var ze=h.createCol(void 0,void 0,{source:U}),je=ze.delta;if(je===0){ne=!0;break}}ne||h.set(D[q][0],D[q][1],D[q][3])}}s.forceFullRender=!0,g.adjustRowsAndCols(),s.runHooks("beforeChangeRender",D,U),S.lockEditor(),s._refreshBorders(null),S.unlockEditor(),s.view.adjustElementsSize(),s.runHooks("afterChange",D,U||"edit");var Je=s.getActiveEditor();Je&&dr(Je.refreshValue)&&Je.refreshValue()}}this._createCellCoords=function(D,U){return s.view._wt.createCellCoords(D,U)},this._createCellRange=function(D,U,q){return s.view._wt.createCellRange(D,U,q)},this.validateCell=function(D,U,q,ne){var ye=s.getCellValidator(U);function ve(ze){var je=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(!je||U.hidden===!0){q(ze);return}var Je=U.visualCol,xt=U.visualRow,kt=s.getCell(xt,Je,!0);if(kt&&kt.nodeName!=="TH"){var jt=s.rowIndexMapper.getRenderableFromVisualIndex(xt),yr=s.columnIndexMapper.getRenderableFromVisualIndex(Je);s.view._wt.getSetting("cellRenderer",jt,yr,kt)}q(ze)}u$e(ye)&&(ye=function(ze){return function(je,Je){Je(ze.test(je))}}(ye)),ci(ye)?(D=s.runHooks("beforeValidate",D,U.visualRow,U.prop,ne),s._registerImmediate(function(){ye.call(U,D,function(ze){s&&(ze=s.runHooks("afterValidate",ze,D,U.visualRow,U.prop,ne),U.valid=ze,ve(ze),s.runHooks("postAfterValidate",ze,D,U.visualRow,U.prop,ne))})})):s._registerImmediate(function(){U.valid=!0,ve(U.valid,!1)})};function _t(D,U,q){return Array.isArray(D)?D:[[D,U,q]]}this.setDataAtCell=function(D,U,q,ne){var ye=_t(D,U,q),ve=[],ze=ne,je,Je,xt;for(je=0,Je=ye.length;je<Je;je++){if(Aa(ye[je])!=="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof ye[je][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");ye[je][1]>=this.countCols()?xt=ye[je][1]:xt=h.colToProp(ye[je][1]),ve.push([ye[je][0],xt,p.getAtCell(this.toPhysicalRow(ye[je][0]),ye[je][1]),ye[je][2]])}!ze&&Aa(D)==="object"&&(ze=U),s.runHooks("afterSetDataAtCell",ve,ze),gt(ve,ze,function(){Lt(ve,ze)})},this.setDataAtRowProp=function(D,U,q,ne){var ye=_t(D,U,q),ve=[],ze=ne,je,Je;for(je=0,Je=ye.length;je<Je;je++)ve.push([ye[je][0],ye[je][1],p.getAtCell(this.toPhysicalRow(ye[je][0]),ye[je][1]),ye[je][2]]);!ze&&Aa(D)==="object"&&(ze=U),s.runHooks("afterSetDataAtRowProp",ve,ze),gt(ve,ze,function(){Lt(ve,ze)})},this.listen=function(){s&&!s.isListening()&&(J$=s.guid,s.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(J$=null,s.runHooks("afterUnlisten"))},this.isListening=function(){return J$===s.guid},this.destroyEditor=function(){var D=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,U=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;s._refreshBorders(D,U)},this.populateFromArray=function(D,U,q,ne,ye,ve,ze,je,Je){if(!(Aa(q)==="object"&&Aa(q[0])==="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");var xt=typeof ne=="number"?s._createCellCoords(ne,ye):null;return g.populateFromArray(s._createCellCoords(D,U),q,xt,ve,ze,je,Je)},this.spliceCol=function(D,U,q){for(var ne,ye=arguments.length,ve=new Array(ye>3?ye-3:0),ze=3;ze<ye;ze++)ve[ze-3]=arguments[ze];return(ne=h).spliceCol.apply(ne,[D,U,q].concat(ve))},this.spliceRow=function(D,U,q){for(var ne,ye=arguments.length,ve=new Array(ye>3?ye-3:0),ze=3;ze<ye;ze++)ve[ze-3]=arguments[ze];return(ne=h).spliceRow.apply(ne,[D,U,q].concat(ve))},this.getSelected=function(){if(K.isSelected())return hn(K.getSelectedRange(),function(D){var U=D.from,q=D.to;return[U.row,U.col,q.row,q.col]})},this.getSelectedLast=function(){var D=this.getSelected(),U;return D&&D.length>0&&(U=D[D.length-1]),U},this.getSelectedRange=function(){if(K.isSelected())return Array.from(K.getSelectedRange())},this.getSelectedRangeLast=function(){var D=this.getSelectedRange(),U;return D&&D.length>0&&(U=D[D.length-1]),U},this.emptySelectedCells=function(D){var U=this;if(!(!K.isSelected()||this.countRows()===0||this.countCols()===0)){var q=[];Le(K.getSelectedRange(),function(ne){var ye=ne.getTopStartCorner(),ve=ne.getBottomEndCorner();Er(ye.row,ve.row,function(ze){Er(ye.col,ve.col,function(je){U.getCellMeta(ze,je).readOnly||q.push([ze,je,null])})})}),q.length>0&&this.setDataAtCell(q,D)}},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){var D=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(D,0),!this.isRenderSuspended()&&D===this.renderSuspendedCounter&&(this.renderCall?this.render():this._refreshBorders(null))},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||(S.lockEditor(),this._refreshBorders(null),S.unlockEditor()))},this.batchRender=function(D){this.suspendRender();var U=D();return this.resumeRender(),U},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){var D=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,U=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(U,0),(!this.isExecutionSuspended()&&U===this.executionSuspendedCounter||D)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(D){var U=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();var q=D();return this.resumeExecution(U),q},this.batch=function(D){this.suspendRender(),this.suspendExecution();var U=D();return this.resumeExecution(),this.resumeRender(),U},this.refreshDimensions=function(){if(s.view){var D=s.view.getLastSize(),U=D.width,q=D.height,ne=s.rootElement.getBoundingClientRect(),ye=ne.width,ve=ne.height,ze=ye!==U||ve!==q,je=s.runHooks("beforeRefreshDimensions",{width:U,height:q},{width:ye,height:ve},ze)===!1;je||((ze||s.view._wt.wtOverlays.scrollableElement===s.rootWindow)&&(s.view.setLastSize(ye,ve),s.render()),s.runHooks("afterRefreshDimensions",{width:U,height:q},{width:ye,height:ve},ze))}},this.updateData=function(D,U){var q=this;nX(D,function(ne){h=ne},function(ne){h=ne,s.columnIndexMapper.fitToLength(q.getInitialColumnCount()),s.rowIndexMapper.fitToLength(q.countSourceRows()),g.adjustRowsAndCols()},{hotInstance:s,dataMap:h,dataSource:p,internalSource:"updateData",source:U,metaManager:$,firstRun:T})},this.loadData=function(D,U){nX(D,function(q){h=q},function(){$.clearCellsCache(),s.initIndexMappers(),g.adjustRowsAndCols(),T&&(T=[null,"loadData"])},{hotInstance:s,dataMap:h,dataSource:p,internalSource:"loadData",source:U,metaManager:$,firstRun:T})},this.getInitialColumnCount=function(){var D=j.columns,U=0;if(Array.isArray(D))U=D.length;else if(ci(D))if(s.dataType==="array")for(var q=this.countSourceCols(),ne=0;ne<q;ne+=1)D(ne)&&(U+=1);else(s.dataType==="object"||s.dataType==="function")&&(U=h.colToPropCache.length);else if(dr(j.dataSchema)){var ye=h.getSchema();U=Array.isArray(ye)?ye.length:ZH(ye)}else U=this.countSourceCols();return U},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(D,U,q,ne){return si(D)?h.getAll():h.getRange(s._createCellCoords(D,U),s._createCellCoords(q,ne),h.DESTINATION_RENDERER)},this.getCopyableText=function(D,U,q,ne){return h.getCopyableText(s._createCellCoords(D,U),s._createCellCoords(q,ne))},this.getCopyableData=function(D,U){return h.getCopyable(D,h.colToProp(U))},this.getSchema=function(){return h.getSchema()},this.updateSettings=function(D){var U=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,q=(T?s.loadData:s.updateData).bind(this),ne=!1,ye,ve;if(dr(D.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(dr(D.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(dr(D.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(ye in D)ye==="data"||(ye==="language"?Me(D.language):ye==="className"?He("className",D.className):ye==="tableClassName"&&s.table?(He("tableClassName",D.tableClassName),s.view._wt.wtOverlays.syncOverlayTableClassNames()):mr.getSingleton().isRegistered(ye)||mr.getSingleton().isDeprecated(ye)?(ci(D[ye])||Array.isArray(D[ye]))&&(D[ye].initialHook=!0,s.addHook(ye,D[ye])):!U&&Ui(D,ye)&&(z[ye]=D[ye]));D.data===void 0&&j.data===void 0?q(null,"updateSettings"):D.data!==void 0?q(D.data,"updateSettings"):D.columns!==void 0&&(h.createMap(),s.initIndexMappers());var ze=s.countCols(),je=j.columns;if(je&&ci(je)&&(ne=!0),(D.cell!==void 0||D.cells!==void 0||D.columns!==void 0)&&$.clearCache(),ze>0)for(ye=0,ve=0;ye<ze;ye++){if(je){var Je=ne?je(ye):je[ve];Je&&$.updateColumnMeta(ve,Je)}ve+=1}dr(D.cell)&&pn(D.cell,function(Jt){s.setCellMetaObject(Jt.row,Jt.col,Jt)}),s.runHooks("afterCellMetaReset");var xt=s.rootElement.style.height;xt!==""&&(xt=parseInt(s.rootElement.style.height,10));var kt=D.height;if(ci(kt)&&(kt=kt()),U){var jt=s.rootElement.getAttribute("style");jt&&s.rootElement.setAttribute("data-initialstyle",s.rootElement.getAttribute("style"))}if(kt===null){var yr=s.rootElement.getAttribute("data-initialstyle");yr&&(yr.indexOf("height")>-1||yr.indexOf("overflow")>-1)?s.rootElement.setAttribute("style",yr):(s.rootElement.style.height="",s.rootElement.style.overflow="")}else kt!==void 0&&(s.rootElement.style.height=isNaN(kt)?"".concat(kt):"".concat(kt,"px"),s.rootElement.style.overflow="hidden");if(typeof D.width<"u"){var Ft=D.width;ci(Ft)&&(Ft=Ft()),s.rootElement.style.width=isNaN(Ft)?"".concat(Ft):"".concat(Ft,"px")}U||(s.view&&(s.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),s.view._wt.exportSettingsAsClassNames()),s.runHooks("afterUpdateSettings",D)),g.adjustRowsAndCols(),s.view&&!T&&(s.forceFullRender=!0,S.lockEditor(),s._refreshBorders(null),s.view._wt.wtOverlays.adjustElementsSize(),S.unlockEditor()),!U&&s.view&&(xt===""||kt===""||kt===void 0)&&xt!==kt&&s.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){var D=s.getSelectedLast();if(j.getValue){if(ci(j.getValue))return j.getValue.call(s);if(D)return s.getData()[D[0][0]][j.getValue]}else if(D)return s.getDataAtCell(D[0],D[1])},this.getSettings=function(){return j},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(D,U,q,ne,ye){g.alter(D,U,q,ne,ye)},this.getCell=function(D,U){var q=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,ne=U,ye=D;if(U>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(U)))return null;ne=this.columnIndexMapper.getRenderableFromVisualIndex(U)}if(D>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(D)))return null;ye=this.rowIndexMapper.getRenderableFromVisualIndex(D)}return ye===null||ne===null?null:s.view.getCellAtCoords(s._createCellCoords(ye,ne),q)},this.getCoords=function(D){var U=this.view._wt.wtTable.getCoords(D);if(U===null)return null;var q=U.row,ne=U.col,ye=q,ve=ne;return q>=0&&(ye=this.rowIndexMapper.getVisualFromRenderableIndex(q)),ne>=0&&(ve=this.columnIndexMapper.getVisualFromRenderableIndex(ne)),s._createCellCoords(ye,ve)},this.colToProp=function(D){return h.colToProp(D)},this.propToCol=function(D){return h.propToCol(D)},this.toVisualRow=function(D){return n.rowIndexMapper.getVisualFromPhysicalIndex(D)},this.toVisualColumn=function(D){return n.columnIndexMapper.getVisualFromPhysicalIndex(D)},this.toPhysicalRow=function(D){return n.rowIndexMapper.getPhysicalFromVisualIndex(D)},this.toPhysicalColumn=function(D){return n.columnIndexMapper.getPhysicalFromVisualIndex(D)},this.getDataAtCell=function(D,U){return h.get(D,h.colToProp(U))},this.getDataAtRowProp=function(D,U){return h.get(D,U)},this.getDataAtCol=function(D){for(var U=[],q=h.getRange(s._createCellCoords(0,D),s._createCellCoords(j.data.length-1,D),h.DESTINATION_RENDERER),ne=0;ne<q.length;ne+=1)for(var ye=0;ye<q[ne].length;ye+=1)U.push(q[ne][ye]);return U},this.getDataAtProp=function(D){for(var U=[],q=h.getRange(s._createCellCoords(0,h.propToCol(D)),s._createCellCoords(j.data.length-1,h.propToCol(D)),h.DESTINATION_RENDERER),ne=0;ne<q.length;ne+=1)for(var ye=0;ye<q[ne].length;ye+=1)U.push(q[ne][ye]);return U},this.getSourceData=function(D,U,q,ne){var ye;return D===void 0?ye=p.getData():ye=p.getByRange(s._createCellCoords(D,U),s._createCellCoords(q,ne)),ye},this.getSourceDataArray=function(D,U,q,ne){var ye;return D===void 0?ye=p.getData(!0):ye=p.getByRange(s._createCellCoords(D,U),s._createCellCoords(q,ne),!0),ye},this.getSourceDataAtCol=function(D){return p.getAtColumn(D)},this.setSourceDataAtCell=function(D,U,q,ne){var ye=_t(D,U,q),ve=this.hasHook("afterSetSourceDataAtCell"),ze=[];ve&&Le(ye,function(Je){var xt=Wl(Je,3),kt=xt[0],jt=xt[1],yr=xt[2];ze.push([kt,jt,p.getAtCell(kt,jt),yr])}),Le(ye,function(Je){var xt=Wl(Je,3),kt=xt[0],jt=xt[1],yr=xt[2];p.setAtCell(kt,jt,yr)}),ve&&this.runHooks("afterSetSourceDataAtCell",ze,ne),this.render();var je=s.getActiveEditor();je&&dr(je.refreshValue)&&je.refreshValue()},this.getSourceDataAtRow=function(D){return p.getAtRow(D)},this.getSourceDataAtCell=function(D,U){return p.getAtCell(D,U)},this.getDataAtRow=function(D){var U=h.getRange(s._createCellCoords(D,0),s._createCellCoords(D,this.countCols()-1),h.DESTINATION_RENDERER);return U[0]||[]},this.getDataType=function(D,U,q,ne){var ye=this,ve=D===void 0?[0,0,this.countRows(),this.countCols()]:[D,U,q,ne],ze=ve[0],je=ve[1],Je=ve[2],xt=ve[3],kt=null,jt=null;Je===void 0&&(Je=ze),xt===void 0&&(xt=je);var yr="mixed";return Er(Math.max(Math.min(ze,Je),0),Math.max(ze,Je),function(Ft){var Jt=!0;return Er(Math.max(Math.min(je,xt),0),Math.max(je,xt),function(et){var wr=ye.getCellMeta(Ft,et);return jt=wr.type,kt?Jt=kt===jt:kt=jt,Jt}),yr=Jt?jt:"mixed",Jt}),yr},this.removeCellMeta=function(D,U,q){var ne=[this.toPhysicalRow(D),this.toPhysicalColumn(U)],ye=ne[0],ve=ne[1],ze=$.getCellMetaKeyValue(ye,ve,q),je=s.runHooks("beforeRemoveCellMeta",D,U,q,ze);je!==!1&&($.removeCellMeta(ye,ve,q),s.runHooks("afterRemoveCellMeta",D,U,q,ze)),ze=null},this.spliceCellsMeta=function(D){for(var U=this,q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,ne=arguments.length,ye=new Array(ne>2?ne-2:0),ve=2;ve<ne;ve++)ye[ve-2]=arguments[ve];if(ye.length>0&&!Array.isArray(ye[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");q>0&&$.removeRow(this.toPhysicalRow(D),q),ye.length>0&&Le(ye.reverse(),function(ze){$.createRow(U.toPhysicalRow(D)),Le(ze,function(je,Je){return U.setCellMetaObject(D,Je,je)})}),s.render()},this.setCellMetaObject=function(D,U,q){var ne=this;Aa(q)==="object"&&pn(q,function(ye,ve){ne.setCellMeta(D,U,ve,ye)})},this.setCellMeta=function(D,U,q,ne){var ye=s.runHooks("beforeSetCellMeta",D,U,q,ne);if(ye!==!1){var ve=D,ze=U;D<this.countRows()&&(ve=this.toPhysicalRow(D)),U<this.countCols()&&(ze=this.toPhysicalColumn(U)),$.setCellMeta(ve,ze,q,ne),s.runHooks("afterSetCellMeta",D,U,q,ne)}},this.getCellsMeta=function(){return $.getCellsMeta()},this.getCellMeta=function(D,U){var q=this.toPhysicalRow(D),ne=this.toPhysicalColumn(U);return q===null&&(q=D),ne===null&&(ne=U),$.getCellMeta(q,ne,{visualRow:D,visualColumn:U})},this.getCellMetaAtRow=function(D){return $.getCellsMetaAtRow(D)},this.isColumnModificationAllowed=function(){return!(s.dataType==="object"||j.columns)},this.getCellRenderer=function(D,U){var q=typeof D=="number"?s.getCellMeta(D,U).renderer:D.renderer;return typeof q=="string"?wK(q):si(q)?wK("text"):q},this.getCellEditor=function(D,U){var q=typeof D=="number"?s.getCellMeta(D,U).editor:D.editor;return typeof q=="string"?GY(q):si(q)?GY("text"):q},this.getCellValidator=function(D,U){var q=typeof D=="number"?s.getCellMeta(D,U).validator:D.validator;return typeof q=="string"?Gze(q):q},this.validateCells=function(D){this._validateCells(D)},this.validateRows=function(D,U){if(!Array.isArray(D))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(U,D)},this.validateColumns=function(D,U){if(!Array.isArray(D))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(U,void 0,D)},this._validateCells=function(D,U,q){var ne=new Ne;D&&(ne.onQueueEmpty=D);for(var ye=s.countRows()-1;ye>=0;){if(U!==void 0&&U.indexOf(ye)===-1){ye-=1;continue}for(var ve=s.countCols()-1;ve>=0;){if(q!==void 0&&q.indexOf(ve)===-1){ve-=1;continue}ne.addValidatorToQueue(),s.validateCell(s.getDataAtCell(ye,ve),s.getCellMeta(ye,ve),function(ze){if(typeof ze!="boolean")throw new Error("Validation error: result is not boolean");ze===!1&&(ne.valid=!1),ne.removeValidatorFormQueue()},"validateCells"),ve-=1}ye-=1}ne.checkIfQueueIsEmpty()},this.getRowHeader=function(D){var U=j.rowHeaders,q=D;return q!==void 0&&(q=s.runHooks("modifyRowHeader",q)),q===void 0?(U=[],Er(s.countRows()-1,function(ne){U.push(s.getRowHeader(ne))})):Array.isArray(U)&&U[q]!==void 0?U=U[q]:ci(U)?U=U(q):U&&typeof U!="string"&&typeof U!="number"&&(U=q+1),U},this.hasRowHeaders=function(){return!!j.rowHeaders},this.hasColHeaders=function(){if(j.colHeaders!==void 0&&j.colHeaders!==null)return!!j.colHeaders;for(var D=0,U=s.countCols();D<U;D++)if(s.getColHeader(D))return!0;return!1},this.getColHeader=function(D){var U=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1,q=s.runHooks("modifyColHeader",D);if(q===void 0){for(var ne=[],ye=s.countCols(),ve=0;ve<ye;ve++)ne.push(s.getColHeader(ve));return ne}var ze=j.colHeaders,je=function(jt){for(var yr=[],Ft=s.countCols(),Jt=0;Jt<Ft;Jt++)ci(j.columns)&&j.columns(Jt)&&yr.push(Jt);return yr[jt]},Je=s.toPhysicalColumn(q),xt=je(Je);return j.colHeaders===!1?ze=null:j.columns&&ci(j.columns)&&j.columns(xt)&&j.columns(xt).title?ze=j.columns(xt).title:j.columns&&j.columns[Je]&&j.columns[Je].title?ze=j.columns[Je].title:Array.isArray(j.colHeaders)&&j.colHeaders[Je]!==void 0?ze=j.colHeaders[Je]:ci(j.colHeaders)?ze=j.colHeaders(Je):j.colHeaders&&typeof j.colHeaders!="string"&&typeof j.colHeaders!="number"&&(ze=pZe(q)),ze=s.runHooks("modifyColumnHeaderValue",ze,D,U),ze},this._getColWidthFromSettings=function(D){var U;if(D>=0){var q=s.getCellMeta(0,D);U=q.width}if((U===void 0||U===j.width)&&(U=j.colWidths),U!=null){switch(Aa(U)){case"object":U=U[D];break;case"function":U=U(D);break}typeof U=="string"&&(U=parseInt(U,10))}return U},this.getColWidth=function(D){var U=s._getColWidthFromSettings(D);return U=s.runHooks("modifyColWidth",U,D),U===void 0&&(U=b3.DEFAULT_WIDTH),U},this._getRowHeightFromSettings=function(D){var U=j.rowHeights;if(U!=null){switch(Aa(U)){case"object":U=U[D];break;case"function":U=U(D);break}typeof U=="string"&&(U=parseInt(U,10))}return U},this.getRowHeight=function(D){var U=s._getRowHeightFromSettings(D);return U=s.runHooks("modifyRowHeight",U,D),U},this.countSourceRows=function(){return p.countRows()},this.countSourceCols=function(){return p.countFirstRowKeys()},this.countRows=function(){return h.getLength()},this.countCols=function(){var D=j.maxCols,U=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(D,U)},this.countRenderedRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleColumnsCount():-1},this.countEmptyRows=function(){var D=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,U=0;return BN(s.countRows()-1,function(q){if(s.isEmptyRow(q))U+=1;else if(D===!0)return!1}),U},this.countEmptyCols=function(){var D=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,U=0;return BN(s.countCols()-1,function(q){if(s.isEmptyCol(q))U+=1;else if(D===!0)return!1}),U},this.isEmptyRow=function(D){return j.isEmptyRow.call(s,D)},this.isEmptyCol=function(D){return j.isEmptyCol.call(s,D)},this.selectCell=function(D,U,q,ne){var ye=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,ve=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return si(D)||si(U)?!1:this.selectCells([[D,U,q,ne]],ye,ve)},this.selectCells=function(){var D=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],U=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,q=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;U===!1&&(o=!0);var ne=K.selectCells(D);return ne&&q&&s.listen(),o=!1,ne},this.selectColumns=function(D){var U=arguments.length>1&&arguments[1]!==void 0?arguments[1]:D;return K.selectColumns(D,U)},this.selectRows=function(D){var U=arguments.length>1&&arguments[1]!==void 0?arguments[1]:D;return K.selectRows(D,U)},this.deselectCell=function(){K.deselect()},this.selectAll=function(){var D=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,U=D&&this.hasRowHeaders(),q=D&&this.hasColHeaders();o=!0,K.selectAll(U,q),o=!1};var $e=function(U,q){return U.getNearestNotHiddenIndex(q,1,!0)};this.scrollViewportTo=function(D,U){var q=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,ne=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,ye=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,ve=!q,ze=!ne,je=D,Je=U;if(ye){var xt=Number.isInteger(D),kt=Number.isInteger(U),jt=xt?$e(this.rowIndexMapper,D):void 0,yr=kt?$e(this.columnIndexMapper,U):void 0;if(jt===null||yr===null)return!1;je=xt?s.rowIndexMapper.getRenderableFromVisualIndex(jt):void 0,Je=kt?s.columnIndexMapper.getRenderableFromVisualIndex(yr):void 0}var Ft=Number.isInteger(je),Jt=Number.isInteger(Je);return Ft&&Jt?s.view.scrollViewport(s._createCellCoords(je,Je),ve,ne,q,ze):Ft&&Jt===!1?s.view.scrollViewportVertically(je,ve,q):Jt&&Ft===!1?s.view.scrollViewportHorizontally(Je,ne,ze):!1},this.destroy=function(){if(s._clearTimeouts(),s._clearImmediates(),s.view&&s.view.destroy(),p&&p.destroy(),p=null,this.getShortcutManager().destroy(),$.clearCache(),ej(s)){var D=this.rootDocument.querySelector(".hot-display-license-info");D&&D.parentNode.removeChild(D)}uu(s.rootElement),a.destroy(),S&&S.destroy(),s.batchExecution(function(){s.rowIndexMapper.unregisterAll(),s.columnIndexMapper.unregisterAll(),V.getItems().forEach(function(U){var q=Wl(U,2),ne=q[1];ne.destroy()}),V.clear(),s.runHooks("afterDestroy")},!0),mr.getSingleton().destroy(s),pn(s,function(U,q,ne){ci(U)?ne[q]=Fe(q):q!=="guid"&&(ne[q]=null)}),s.isDestroyed=!0,h&&h.destroy(),s.rowIndexMapper=null,s.columnIndexMapper=null,h=null,g=null,K=null,S=null,s=null};function Fe(D){return function(){throw new Error('The "'.concat(D,'" method cannot be called because this Handsontable instance has been destroyed'))}}this.getActiveEditor=function(){return S.getActiveEditor()},this.getPlugin=function(D){var U=xc(D);return U==="UndoRedo"?this.undoRedo:V.getItem(U)},this.getPluginName=function(D){return D===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:V.getId(D)},this.getInstance=function(){return s},this.addHook=function(D,U){mr.getSingleton().add(D,U,s)},this.hasHook=function(D){return mr.getSingleton().has(D,s)||mr.getSingleton().has(D)},this.addHookOnce=function(D,U){mr.getSingleton().once(D,U,s)},this.removeHook=function(D,U){mr.getSingleton().remove(D,U,s)},this.runHooks=function(D,U,q,ne,ye,ve,ze){return mr.getSingleton().run(s,D,U,q,ne,ye,ve,ze)},this.getTranslatedPhrase=function(D,U){return gle(j.language,D,U)},this.toHTML=function(){return u7(n)},this.toTableElement=function(){var D=n.rootDocument.createElement("div");return D.insertAdjacentHTML("afterbegin",u7(n)),D.firstElementChild},this.timeouts=[],this._registerTimeout=function(D){var U=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,q=D;typeof q=="function"&&(q=setTimeout(q,U)),this.timeouts.push(q)},this._clearTimeouts=function(){Le(this.timeouts,function(D){clearTimeout(D)})},this.immediates=[],this._registerImmediate=function(D){this.immediates.push(setImmediate(D))},this._clearImmediates=function(){Le(this.immediates,function(D){clearImmediate(D)})},this._refreshBorders=function(){var D=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,U=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;S.destroyEditor(D),s.view.render(),U&&K.isSelected()&&S.prepareEditor()},this.isRtl=function(){return s.rootWindow.getComputedStyle(s.rootElement).direction==="rtl"},this.isLtr=function(){return!s.isRtl()},this.getDirectionFactor=function(){return s.isLtr()?1:-1};var At=Xet({handleEvent:function(U){var q=s.isListening(),ne=(U==null?void 0:U.key)!==void 0;return q&&ne},beforeKeyDown:function(U){return n.runHooks("beforeKeyDown",U)},afterKeyDown:function(U){n.isDestroyed||s.runHooks("afterDocumentKeyDown",U)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",function(D){D.ctrlKey===!1&&D.metaKey===!1&&At.releasePressedKeys()}),this.getShortcutManager=function(){return At};var Gt=At.addContext("grid"),ae={runOnlyIf:function(){return dr(s.getSelected())&&s.countRenderedRows()>0&&s.countRenderedCols()>0},group:ntt};At.setActiveContextName("grid"),Gt.addShortcuts([{keys:[["Control/Meta","A"]],callback:function(){s.selectAll()}},{keys:[["Control/Meta","Enter"]],callback:function(){for(var U=s.getSelectedRange(),q=U[U.length-1].highlight,ne=q.row,ye=q.col,ve=s.getDataAtCell(ne,ye),ze=new Map,je=0;je<U.length;je++)U[je].forAll(function(Je,xt){if(Je>=0&&xt>=0&&(Je!==ne||xt!==ye)){var kt=s.getCellMeta(Je,xt),jt=kt.readOnly;jt||ze.set("".concat(Je,"x").concat(xt),[Je,xt,ve])}});s.setDataAtCell(Array.from(ze.values()))},runOnlyIf:function(){return s.getSelectedRangeLast().getCellsCount()>1}},{keys:[["ArrowUp"]],callback:function(){K.transformStart(-1,0)}},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:function(){K.setRangeStart(s._createCellCoords(s.rowIndexMapper.getNearestNotHiddenIndex(0,1),s.getSelectedRangeLast().highlight.col))}},{keys:[["ArrowUp","Shift"]],callback:function(){K.transformEnd(-1,0)}},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var U=s.getSelectedRangeLast(),q=U.from,ne=U.to,ye=s.rowIndexMapper.getNearestNotHiddenIndex(0,1);K.setRangeStart(q.clone()),K.setRangeEnd(s._createCellCoords(ye,ne.col))},runOnlyIf:function(){return!(s.selection.isSelectedByCorner()||s.selection.isSelectedByColumnHeader())}},{keys:[["ArrowDown"]],callback:function(){K.transformStart(1,0)}},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:function(){K.setRangeStart(s._createCellCoords(s.rowIndexMapper.getNearestNotHiddenIndex(s.countRows()-1,-1),s.getSelectedRangeLast().highlight.col))}},{keys:[["ArrowDown","Shift"]],callback:function(){K.transformEnd(1,0)}},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var U=s.getSelectedRangeLast(),q=U.from,ne=U.to,ye=s.rowIndexMapper.getNearestNotHiddenIndex(s.countRows()-1,-1);K.setRangeStart(q.clone()),K.setRangeEnd(s._createCellCoords(ye,ne.col))},runOnlyIf:function(){return!(s.selection.isSelectedByCorner()||s.selection.isSelectedByColumnHeader())}},{keys:[["ArrowLeft"]],callback:function(){K.transformStart(0,-1*s.getDirectionFactor())}},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:function(){var U,q=s.getSelectedRangeLast().highlight.row,ne=(U=s.columnIndexMapper).getNearestNotHiddenIndex.apply(U,Ty(s.isRtl()?[s.countCols()-1,-1]:[0,1]));K.setRangeStart(s._createCellCoords(q,ne))}},{keys:[["ArrowLeft","Shift"]],callback:function(){K.transformEnd(0,-1*s.getDirectionFactor())}},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var U,q=s.getSelectedRangeLast(),ne=q.from,ye=q.to,ve=(U=s.columnIndexMapper).getNearestNotHiddenIndex.apply(U,Ty(s.isRtl()?[s.countCols()-1,-1]:[0,1]));K.setRangeStart(ne.clone()),K.setRangeEnd(s._createCellCoords(ye.row,ve))},runOnlyIf:function(){return!(s.selection.isSelectedByCorner()||s.selection.isSelectedByRowHeader())}},{keys:[["ArrowRight"]],callback:function(){K.transformStart(0,s.getDirectionFactor())}},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:function(){var U,q=s.getSelectedRangeLast().highlight.row,ne=(U=s.columnIndexMapper).getNearestNotHiddenIndex.apply(U,Ty(s.isRtl()?[0,1]:[s.countCols()-1,-1]));K.setRangeStart(s._createCellCoords(q,ne))}},{keys:[["ArrowRight","Shift"]],callback:function(){K.transformEnd(0,s.getDirectionFactor())}},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var U,q=s.getSelectedRangeLast(),ne=q.from,ye=q.to,ve=(U=s.columnIndexMapper).getNearestNotHiddenIndex.apply(U,Ty(s.isRtl()?[0,1]:[s.countCols()-1,-1]));K.setRangeStart(ne.clone()),K.setRangeEnd(s._createCellCoords(ye.row,ve))},runOnlyIf:function(){return!(s.selection.isSelectedByCorner()||s.selection.isSelectedByRowHeader())}},{keys:[["Home"]],captureCtrl:!0,callback:function(){var U=parseInt(s.getSettings().fixedColumnsStart,10),q=s.getSelectedRangeLast().highlight.row,ne=s.columnIndexMapper.getNearestNotHiddenIndex(U,1);K.setRangeStart(s._createCellCoords(q,ne))},runOnlyIf:function(){return s.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["Home","Shift"]],callback:function(){K.setRangeEnd(s._createCellCoords(K.selectedRange.current().from.row,s.columnIndexMapper.getNearestNotHiddenIndex(0,1)))}},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:function(){var U=parseInt(s.getSettings().fixedRowsTop,10),q=parseInt(s.getSettings().fixedColumnsStart,10),ne=s.rowIndexMapper.getNearestNotHiddenIndex(U,1),ye=s.columnIndexMapper.getNearestNotHiddenIndex(q,1);K.setRangeStart(s._createCellCoords(ne,ye))},runOnlyIf:function(){return s.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["End"]],captureCtrl:!0,callback:function(){K.setRangeStart(s._createCellCoords(s.getSelectedRangeLast().highlight.row,s.columnIndexMapper.getNearestNotHiddenIndex(s.countCols()-1,-1)))},runOnlyIf:function(){return s.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["End","Shift"]],callback:function(){K.setRangeEnd(s._createCellCoords(K.selectedRange.current().from.row,s.columnIndexMapper.getNearestNotHiddenIndex(s.countCols()-1,-1)))}},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:function(){var U=parseInt(s.getSettings().fixedRowsBottom,10),q=s.rowIndexMapper.getNearestNotHiddenIndex(s.countRows()-U-1,-1),ne=s.columnIndexMapper.getNearestNotHiddenIndex(s.countCols()-1,-1);K.setRangeStart(s._createCellCoords(q,ne))},runOnlyIf:function(){return s.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["PageUp"]],callback:function(){K.transformStart(-s.countVisibleRows(),0)}},{keys:[["PageUp","Shift"]],callback:function(){var U=s.getSelectedRangeLast(),q=U.to,ne=Math.max(q.row-s.countVisibleRows(),0),ye=s.rowIndexMapper.getNearestNotHiddenIndex(ne,1);if(ye!==null){var ve=s._createCellCoords(ye,q.col),ze=q.row-s.view.getFirstFullyVisibleRow(),je=Math.max(ve.row-ze,0);K.setRangeEnd(ve),s.scrollViewportTo(je)}}},{keys:[["PageDown"]],callback:function(){K.transformStart(s.countVisibleRows(),0)}},{keys:[["PageDown","Shift"]],callback:function(){var U=s.getSelectedRangeLast(),q=U.to,ne=Math.min(q.row+s.countVisibleRows(),s.countRows()-1),ye=s.rowIndexMapper.getNearestNotHiddenIndex(ne,-1);if(ye!==null){var ve=s._createCellCoords(ye,q.col),ze=q.row-s.view.getFirstFullyVisibleRow(),je=Math.min(ve.row-ze,s.countRows()-1);K.setRangeEnd(ve),s.scrollViewportTo(je)}}},{keys:[["Tab"]],callback:function(U){var q=typeof j.tabMoves=="function"?j.tabMoves(U):j.tabMoves;K.transformStart(q.row,q.col,!0)}},{keys:[["Shift","Tab"]],callback:function(U){var q=typeof j.tabMoves=="function"?j.tabMoves(U):j.tabMoves;K.transformStart(-q.row,-q.col)}}],ae),Oae().forEach(function(D){var U=_3(D);V.addItem(D,new U(n))}),mr.getSingleton().run(s,"construct")}function K1(e){"@babel/helpers - typeof";return K1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},K1(e)}function hX(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function dX(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?hX(Object(r),!0).forEach(function(n){itt(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):hX(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function itt(e,t,r){return t=Mle(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ott(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Mle(n.key),n)}}function att(e,t,r){return t&&pX(e.prototype,t),r&&pX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Mle(e){var t=stt(e,"string");return K1(t)==="symbol"?t:String(t)}function stt(e,t){if(K1(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(K1(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var mX=215,Dle="menu",ltt=Dle,$le=function(){function e(t,r){ott(this,e),this.hot=t,this.options=r||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:mX,container:this.hot.rootDocument.documentElement},this.eventManager=new Bi(this),this.container=this.createContainer(this.options.name),this.hotMenu=null,this.hotSubMenus={},this.parentMenu=this.options.parent||null,this.menuItems=null,this.origOutsideClickDeselects=null,this.keyEvent=!1,this.offset={above:0,below:0,left:0,right:0},this._afterScrollCallback=null,this.registerEvents()}return att(e,[{key:"registerEvents",value:function(){for(var r=this,n=this.hot.rootWindow;n;)this.eventManager.addEventListener(n.document,"mousedown",function(i){return r.onDocumentMouseDown(i)}),this.eventManager.addEventListener(n.document,"contextmenu",function(i){return r.onDocumentContextMenu(i)}),n=xk(n)}},{key:"setMenuItems",value:function(r){this.menuItems=r}},{key:"getSelectedItem",value:function(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}},{key:"hasSelectedItem",value:function(){return Array.isArray(this.hotMenu.getSelectedLast())}},{key:"setOffset",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.offset[r]=n}},{key:"isSubMenu",value:function(){return this.parentMenu!==null}},{key:"open",value:function(){var r=this;this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";var n=Qoe(function(R){return r.openSubMenu(R)},300),i=this.options.minWidth||mX,o=!1,s=$s(this.menuItems,function(R){return R.key===b1&&(o=!0),R9e(R,r.hot)});if(s.length<1&&!o)s.push(Zse()[b1]);else if(s.length===0)return;s=A9e(s,fn);var a=!1,h={data:s,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth:function(A){return dr(A)&&A<i?i:A},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,maxCols:1,columns:[{data:"name",renderer:function(A,$,j,z,V,G){return r.menuItemRenderer(A,$,j,z,V,G)}}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",afterOnCellMouseOver:function(A,$){r.isAllSubMenusClosed()?n($.row):r.openSubMenu($.row)},rowHeights:function(A){return s[A].name===fn?1:23},afterOnCellContextMenu:function(A){A.preventDefault(),SY()&&a&&r.hasSelectedItem()&&r.close(!0)},beforeOnCellMouseUp:function(A){r.hasSelectedItem()&&(a=!r.isCommandPassive(r.getSelectedItem()),r.executeCommand(A))},afterOnCellMouseUp:function(A){(!SY()||!Pp(A))&&a&&r.hasSelectedItem()&&(nu()||Moe()?setTimeout(function(){return r.close(!0)},325):r.close(!0))},afterUnlisten:function(){!r.hasSelectedItem()&&r.isOpened()&&r.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new cU(this.container,h),this.hotMenu.addHook("afterInit",function(){return r.onAfterInit()}),this.hotMenu.addHook("afterSelection",function(){return r.onAfterSelection.apply(r,arguments)}),this.hotMenu.init(),this.hotMenu.listen();var p=this.hotMenu.getShortcutManager(),g=p.addContext(ltt),S={group:Dle},T=dX(dX({},S),{},{runOnlyIf:function(A){return Tk(A.target)===!1||r.container.contains(A.target)===!1}});p.setActiveContextName("menu"),g.addShortcuts([{keys:[["Escape"]],callback:function(){r.keyEvent=!0,r.close(),r.keyEvent=!1}},{keys:[["ArrowDown"]],callback:function(){var A=r.hotMenu.getSelectedLast();r.keyEvent=!0,A?r.selectNextCell(A[0],A[1]):r.selectFirstCell(),r.keyEvent=!1}},{keys:[["ArrowUp"]],callback:function(){var A=r.hotMenu.getSelectedLast();r.keyEvent=!0,A?r.selectPrevCell(A[0],A[1]):r.selectLastCell(),r.keyEvent=!1}},{keys:[["ArrowRight"]],callback:function(){var A=r.hotMenu.getSelectedLast();if(r.keyEvent=!0,A){var $=r.openSubMenu(A[0]);$&&$.selectFirstCell()}r.keyEvent=!1}},{keys:[["ArrowLeft"]],callback:function(){var A=r.hotMenu.getSelectedLast();r.keyEvent=!0,A&&r.isSubMenu()&&(r.close(),r.parentMenu&&r.parentMenu.hotMenu.listen()),r.keyEvent=!1}},{keys:[["Enter"]],callback:function(A){var $=r.hotMenu.getSelectedLast();r.keyEvent=!0,r.hotMenu.getSourceDataAtRow($[0]).submenu||(r.executeCommand(A),r.close(!0)),r.keyEvent=!1}},{keys:[["PageUp"]],callback:function(){var A=r.hotMenu.getSelectedLast();r.keyEvent=!0,A?r.hotMenu.selection.transformStart(-r.hotMenu.countVisibleRows(),0):r.selectFirstCell(),r.keyEvent=!1}},{keys:[["PageDown"]],callback:function(){var A=r.hotMenu.getSelectedLast();r.keyEvent=!0,A?r.hotMenu.selection.transformStart(r.hotMenu.countVisibleRows(),0):r.selectLastCell(),r.keyEvent=!1}}],T),this.blockMainTableCallbacks(),this.runLocalHooks("afterOpen")}},{key:"close",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.isOpened()&&(r&&this.parentMenu?this.parentMenu.close():(this.closeAllSubMenus(),this.container.style.display="none",this.releaseMainTableCallbacks(),this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.parentMenu&&this.parentMenu.hotMenu.listen()))}},{key:"openSubMenu",value:function(r){if(!this.hotMenu)return!1;var n=this.hotMenu.getCell(r,0);if(this.closeAllSubMenus(),!n||!C9e(n))return!1;var i=this.hotMenu.getSourceDataAtRow(r),o=new e(this.hot,{parent:this,name:i.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return o.setMenuItems(i.submenu.items),o.open(),o.setPosition(n.getBoundingClientRect()),this.hotSubMenus[i.key]=o,o}},{key:"closeSubMenu",value:function(r){var n=this.hotMenu.getSourceDataAtRow(r),i=this.hotSubMenus[n.key];i&&(i.destroy(),delete this.hotSubMenus[n.key])}},{key:"closeAllSubMenus",value:function(){var r=this;Le(this.hotMenu.getData(),function(n,i){return r.closeSubMenu(i)})}},{key:"isAllSubMenusClosed",value:function(){return Object.keys(this.hotSubMenus).length===0}},{key:"destroy",value:function(){var r=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),r&&r.removeChild(this.container)}},{key:"isOpened",value:function(){return this.hotMenu!==null}},{key:"executeCommand",value:function(r){if(!(!this.isOpened()||!this.hasSelectedItem())){var n=this.getSelectedItem();if(this.runLocalHooks("select",n,r),!this.isCommandPassive(n)){var i=this.hot.getSelectedRange(),o=i?x9e(i):[];this.runLocalHooks("executeCommand",n.key,o,r),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",n.key,o,r)}}}},{key:"isCommandPassive",value:function(r){var n=r.isCommand,i=r.name,o=r.disabled,s=r.submenu,a=o===!0||typeof o=="function"&&o.call(this.hot)===!0;return n===!1||i===fn||a===!0||s}},{key:"setPosition",value:function(r){var n=new K7e(r,this.container.ownerDocument.defaultView);this.options.keepInViewport?(n.fitsBelow(this.container)?this.setPositionBelowCursor(n):n.fitsAbove(this.container)?this.setPositionAboveCursor(n):this.setPositionBelowCursor(n),this.hot.isLtr()?this.setHorizontalPositionForLtr(n):this.setHorizontalPositionForRtl(n)):(this.setPositionBelowCursor(n),this.setPositionOnRightOfCursor(n))}},{key:"setHorizontalPositionForRtl",value:function(r){r.fitsOnLeft(this.container)?this.setPositionOnLeftOfCursor(r):this.setPositionOnRightOfCursor(r)}},{key:"setHorizontalPositionForLtr",value:function(r){r.fitsOnRight(this.container)?this.setPositionOnRightOfCursor(r):this.setPositionOnLeftOfCursor(r)}},{key:"setPositionAboveCursor",value:function(r){var n=this.offset.above+r.top-this.container.offsetHeight;this.isSubMenu()&&(n=r.top+r.cellHeight-this.container.offsetHeight+3),this.container.style.top="".concat(n,"px")}},{key:"setPositionBelowCursor",value:function(r){var n=this.offset.below+r.top+1;this.isSubMenu()&&(n=r.top-1),this.container.style.top="".concat(n,"px")}},{key:"setPositionOnRightOfCursor",value:function(r){var n=r.left;if(this.isSubMenu()){var i=this.parentMenu.container.getBoundingClientRect(),o=i.right;n+=r.cellWidth+o-(r.left+r.cellWidth)}else n+=this.offset.right;this.container.style.left="".concat(n,"px")}},{key:"setPositionOnLeftOfCursor",value:function(r){var n=this.offset.left+r.left-this.container.offsetWidth;if(this.isSubMenu()){var i=this.parentMenu.container.getBoundingClientRect(),o=i.left;n-=r.left-o}this.container.style.left="".concat(n,"px")}},{key:"selectFirstCell",value:function(){var r=this.hotMenu.getCell(0,0);lO(r)||uO(r)||cO(r)?this.selectNextCell(0,0):this.hotMenu.selectCell(0,0)}},{key:"selectLastCell",value:function(){var r=this.hotMenu.countRows()-1,n=this.hotMenu.getCell(r,0);lO(n)||uO(n)||cO(n)?this.selectPrevCell(r,0):(this.hotMenu.selectCell(r,0,void 0,void 0,!1),this.hotMenu.scrollViewportTo(r,0,!0,!1))}},{key:"selectNextCell",value:function(r,n){var i=r+1,o=i<this.hotMenu.countRows()?this.hotMenu.getCell(i,n):null;o&&(lO(o)||uO(o)||cO(o)?this.selectNextCell(i,n):this.hotMenu.selectCell(i,n))}},{key:"selectPrevCell",value:function(r,n){var i=r-1,o=i>=0?this.hotMenu.getCell(i,n):null;o&&(lO(o)||uO(o)||cO(o)?this.selectPrevCell(i,n):this.hotMenu.selectCell(i,n))}},{key:"menuItemRenderer",value:function(r,n,i,o,s,a){var h=this,p=r.getSourceDataAtRow(i),g=this.hot.rootDocument.createElement("div"),S=function(z){return Ui(z,"submenu")},T=function(z){return new RegExp(fn,"i").test(z.name)},R=function(z){return z.disabled===!0||typeof z.disabled=="function"&&z.disabled.call(h.hot)===!0},A=function(z){return z.disableSelection},$=a;typeof $=="function"&&($=$.call(this.hot)),uu(n),Ht(g,"htItemWrapper"),n.appendChild(g),T(p)?Ht(n,"htSeparator"):typeof p.renderer=="function"?(Ht(n,"htCustomMenuRenderer"),n.appendChild(p.renderer(r,g,i,o,s,$))):ib(g,$),R(p)?(Ht(n,"htDisabled"),this.eventManager.addEventListener(n,"mouseenter",function(){return r.deselectCell()})):A(p)?(Ht(n,"htSelectionDisabled"),this.eventManager.addEventListener(n,"mouseenter",function(){return r.deselectCell()})):S(p)?(Ht(n,"htSubmenu"),A(p)?this.eventManager.addEventListener(n,"mouseenter",function(){return r.deselectCell()}):this.eventManager.addEventListener(n,"mouseenter",function(){return r.selectCell(i,o,void 0,void 0,!1,!1)})):(Kr(n,["htSubmenu","htDisabled"]),A(p)?this.eventManager.addEventListener(n,"mouseenter",function(){return r.deselectCell()}):this.eventManager.addEventListener(n,"mouseenter",function(){return r.selectCell(i,o,void 0,void 0,!1,!1)}))}},{key:"createContainer",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=this.options.container.ownerDocument,i=r,o;return i&&(ci(i)&&(i=i.call(this.hot),i===null||si(i)?i="":i=i.toString()),i=i.replace(/[^A-z0-9]/g,"_"),i="".concat(this.options.className,"Sub_").concat(i),o=n.querySelector(".".concat(this.options.className,".").concat(i))),o||(o=n.createElement("div"),Ht(o,"htMenu ".concat(this.options.className)),i&&Ht(o,i),this.options.container.appendChild(o)),o}},{key:"blockMainTableCallbacks",value:function(){this._afterScrollCallback=function(){},this.hot.addHook("afterScrollVertically",this._afterScrollCallback),this.hot.addHook("afterScrollHorizontally",this._afterScrollCallback)}},{key:"releaseMainTableCallbacks",value:function(){this._afterScrollCallback&&(this.hot.removeHook("afterScrollVertically",this._afterScrollCallback),this.hot.removeHook("afterScrollHorizontally",this._afterScrollCallback),this._afterScrollCallback=null)}},{key:"onAfterInit",value:function(){var r=this.hotMenu.view._wt.wtTable,n=this.hotMenu.getSettings().data,i=r.hider.style,o=r.holder.style,s=parseInt(i.width,10),a=na(n,function(h,p){return h+(p.name===fn?1:26)},0);o.width="".concat(s+3,"px"),o.height="".concat(a+3,"px"),i.height=o.height}},{key:"onAfterSelection",value:function(r,n,i,o,s){this.keyEvent===!1&&(s.value=!0)}},{key:"onDocumentMouseDown",value:function(r){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!xp(r.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!xp(r.target,".htMenu")&&this.close(!0))}},{key:"onDocumentContextMenu",value:function(r){this.isOpened()&&Ur(r.target,"htCore")&&xp(r.target,this.hotMenu.rootElement)&&r.preventDefault()}}]),e}();li($le,Va);const fU=$le;function Uv(e){"@babel/helpers - typeof";return Uv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Uv(e)}function utt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ftt(n.key),n)}}function ctt(e,t,r){return t&&yX(e.prototype,t),r&&yX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ftt(e){var t=htt(e,"string");return Uv(t)==="symbol"?t:String(t)}function htt(e,t){if(Uv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Uv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Jd(){return typeof Reflect<"u"&&Reflect.get?Jd=Reflect.get.bind():Jd=function(t,r,n){var i=dtt(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Jd.apply(this,arguments)}function dtt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=nc(e),e!==null););return e}function ptt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&dj(e,t)}function dj(e,t){return dj=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},dj(e,t)}function mtt(e){var t=gtt();return function(){var n=nc(e),i;if(t){var o=nc(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return ytt(this,i)}}function ytt(e,t){if(t&&(Uv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Lle(e)}function Lle(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function gtt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function nc(e){return nc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},nc(e)}var yO="contextMenu",vtt=70;mr.getSingleton().register("afterContextMenuDefaultOptions");mr.getSingleton().register("beforeContextMenuShow");mr.getSingleton().register("afterContextMenuShow");mr.getSingleton().register("afterContextMenuHide");mr.getSingleton().register("afterContextMenuExecute");var Nle=function(e){ptt(r,e);var t=mtt(r);function r(n){var i;return utt(this,r),i=t.call(this,n),i.eventManager=new Bi(Lle(i)),i.commandExecutor=new Kse(i.hot),i.itemsFactory=null,i.menu=null,i}return ctt(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[yO]}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){var o=this.hot.getSettings()[yO];typeof o.callback=="function"&&this.commandExecutor.setCommonCallback(o.callback),this.menu=new fU(this.hot,{className:"htContextMenu",keepInViewport:!0,container:o.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",function(){return i.onMenuBeforeOpen()}),this.menu.addLocalHook("afterOpen",function(){return i.onMenuAfterOpen()}),this.menu.addLocalHook("afterClose",function(){return i.onMenuAfterClose()}),this.menu.addLocalHook("executeCommand",function(){for(var s,a=arguments.length,h=new Array(a),p=0;p<a;p++)h[p]=arguments[p];return(s=i.executeCommand).call.apply(s,[i].concat(h))}),this.addHook("afterOnCellContextMenu",function(s){return i.onAfterOnCellContextMenu(s)}),Jd(nc(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Jd(nc(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),Jd(nc(r.prototype),"disablePlugin",this).call(this)}},{key:"open",value:function(i){if(this.menu&&(this.prepareMenuItems(),this.menu.open(),!!this.menu.isOpened())){var o=0,s=0;if(this.hot.rootDocument!==this.menu.container.ownerDocument){var a=this.hot.rootWindow.frameElement,h=a.getBoundingClientRect(),p=h.top,g=h.left;o=p-RS(i.view),s=g-zg(i.view)}else o=-1*RS(this.menu.hotMenu.rootWindow),s=-1*zg(this.menu.hotMenu.rootWindow);this.menu.setPosition({top:parseInt(i.pageY,10)+o,left:parseInt(i.pageX,10)+s})}}},{key:"close",value:function(){this.menu&&(this.menu.close(),this.itemsFactory=null)}},{key:"executeCommand",value:function(i){var o;this.itemsFactory===null&&this.prepareMenuItems();for(var s=arguments.length,a=new Array(s>1?s-1:0),h=1;h<s;h++)a[h-1]=arguments[h];(o=this.commandExecutor).execute.apply(o,[i].concat(a))}},{key:"prepareMenuItems",value:function(){var i=this;this.itemsFactory=new Jse(this.hot,r.DEFAULT_ITEMS);var o=this.hot.getSettings()[yO],s={items:this.itemsFactory.getItems(o)};this.hot.runHooks("afterContextMenuDefaultOptions",s),this.itemsFactory.setPredefinedItems(s.items);var a=this.itemsFactory.getItems(o);this.hot.runHooks("beforeContextMenuSetItems",a),this.menu.setMenuItems(a),Le(a,function(h){return i.commandExecutor.registerCommand(h.key,h)})}},{key:"onAfterOnCellContextMenu",value:function(i){var o=this.hot.getSettings(),s=o.rowHeaders,a=o.colHeaders;function h(g){return g.nodeName==="TD"||g.parentNode.nodeName==="TD"}var p=i.target;this.close(),!Ur(p,"handsontableInput")&&(i.preventDefault(),i.stopPropagation(),!(!(s||a)&&!h(p)&&!(Ur(p,"current")&&Ur(p,"wtBorder")))&&this.open(i))}},{key:"onMenuBeforeOpen",value:function(){this.hot.runHooks("beforeContextMenuShow",this)}},{key:"onMenuAfterOpen",value:function(){this.hot.runHooks("afterContextMenuShow",this)}},{key:"onMenuAfterClose",value:function(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}},{key:"destroy",value:function(){this.close(),this.menu&&this.menu.destroy(),Jd(nc(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return yO}},{key:"PLUGIN_PRIORITY",get:function(){return vtt}},{key:"PLUGIN_DEPS",get:function(){return["plugin:AutoColumnSize"]}},{key:"DEFAULT_ITEMS",get:function(){return[WA,GA,fn,_C,bC,fn,UA,SC,fn,YA,FA,fn,wC,fn,Es]}}]),r}(Wn);Nle.SEPARATOR={name:fn};function _tt(e){return{key:"copy",name:function(){return this.getTranslatedPhrase(X3)},callback:function(){e.copyCellsOnly()},disabled:function(){if(this.countRows()===0||this.countCols()===0)return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function btt(e){return{key:"copy_column_headers_only",name:function(){var r=this.getSelectedRangeLast(),n=r?Math.min(r.getWidth()-1,1):0;return this.getTranslatedPhrase(Q3,n)},callback:function(){e.copyColumnHeadersOnly()},disabled:function(){if(!this.hasColHeaders())return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function wtt(e){return{key:"copy_with_column_group_headers",name:function(){var r=this.getSelectedRangeLast(),n=r?Math.min(r.getWidth()-1,1):0;return this.getTranslatedPhrase(J3,n)},callback:function(){e.copyWithAllColumnHeaders()},disabled:function(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function Stt(e){return{key:"copy_with_column_headers",name:function(){var r=this.getSelectedRangeLast(),n=r?Math.min(r.getWidth()-1,1):0;return this.getTranslatedPhrase(Z3,n)},callback:function(){e.copyWithColumnHeaders()},disabled:function(){if(!this.hasColHeaders())return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function xtt(e){return{key:"cut",name:function(){return this.getTranslatedPhrase(eV)},callback:function(){e.cut()},disabled:function(){if(this.countRows()===0||this.countCols()===0)return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function q1(e){"@babel/helpers - typeof";return q1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},q1(e)}function Ctt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ttt(n.key),n)}}function Ett(e,t,r){return t&&gX(e.prototype,t),r&&gX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ttt(e){var t=Ott(e,"string");return q1(t)==="symbol"?t:String(t)}function Ott(e,t){if(q1(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(q1(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Rtt=function(){function e(){Ctt(this,e),this.data={}}return Ett(e,[{key:"setData",value:function(r,n){this.data[r]=n}},{key:"getData",value:function(r){return this.data[r]||void 0}}]),e}();function X1(e){"@babel/helpers - typeof";return X1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},X1(e)}function vX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ptt(n.key),n)}}function ktt(e,t,r){return t&&vX(e.prototype,t),r&&vX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ptt(e){var t=Att(e,"string");return X1(t)==="symbol"?t:String(t)}function Att(e,t){if(X1(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(X1(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Itt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var Mtt=ktt(function e(){Itt(this,e),this.clipboardData=new Rtt});function Z1(e){"@babel/helpers - typeof";return Z1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Z1(e)}function Dtt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _X(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ltt(n.key),n)}}function $tt(e,t,r){return t&&_X(e.prototype,t),r&&_X(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ltt(e){var t=Ntt(e,"string");return Z1(t)==="symbol"?t:String(t)}function Ntt(e,t){if(Z1(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Z1(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var hU=function(){function e(t){Dtt(this,e),this.rootDocument=t.defaultView?t:t.ownerDocument,this.mainElement=null,this.eventManager=new Bi(this),this.listenersCount=new WeakSet,this.container=t}return $tt(e,[{key:"useSecondaryElement",value:function(){var r=ztt(this.container);this.listenersCount.has(r)||(this.listenersCount.add(r),bX(this.eventManager,r,this)),this.mainElement=r}},{key:"setFocusableElement",value:function(r){this.listenersCount.has(r)||(this.listenersCount.add(r),bX(this.eventManager,r,this)),this.mainElement=r}},{key:"getFocusableElement",value:function(){return this.mainElement}},{key:"focus",value:function(){this.mainElement.value=" ",nu()||pLe(this.mainElement)}}]),e}();li(hU,Va);var cP=new WeakMap;function Btt(e){var t=new hU(e),r=cP.get(e);return r=isNaN(r)?0:r,cP.set(e,r+1),t}function jtt(e){e.eventManager.clear()}var Q$=function(t,r){return function(n){return r.runLocalHooks(t,n)}};function bX(e,t,r){e.addEventListener(t,"copy",Q$("copy",r)),e.addEventListener(t,"cut",Q$("cut",r)),e.addEventListener(t,"paste",Q$("paste",r))}var fP=new WeakMap;function ztt(e){var t=fP.get(e);if(t)return t.parentElement||e.appendChild(t),t;var r=e.defaultView?e:e.ownerDocument,n=r.createElement("textarea");return fP.set(e,n),n.setAttribute("data-hot-input",""),n.className="HandsontableCopyPaste",n.tabIndex=-1,n.autocomplete="off",n.wrap="hard",n.value=" ",e.appendChild(n),n}function wX(e){if(e instanceof hU){var t=cP.get(e.container);if(t=isNaN(t)?0:t,t>0&&(t-=1),jtt(e),t<=0){t=0;var r=fP.get(e.container);r&&r.parentNode&&(r.parentNode.removeChild(r),fP.delete(e.container)),e.mainElement=null}cP.set(e.container,t)}}function J1(e){"@babel/helpers - typeof";return J1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},J1(e)}function Ftt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function SX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Vtt(n.key),n)}}function Htt(e,t,r){return t&&SX(e.prototype,t),r&&SX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Vtt(e){var t=Utt(e,"string");return J1(t)==="symbol"?t:String(t)}function Utt(e,t){if(J1(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(J1(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function xX(e,t){Ble(e,t),t.add(e)}function Oy(e,t,r){Ble(e,t),t.set(e,r)}function Ble(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gO(e,t,r){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return r}function fa(e,t){var r=jle(e,t,"get");return Wtt(e,r)}function Wtt(e,t){return t.get?t.get.call(e):t.value}function Ry(e,t,r){var n=jle(e,t,"set");return Gtt(e,n,r),r}function jle(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function Gtt(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var Cf=new WeakMap,e2=new WeakMap,o0=new WeakMap,pj=new WeakMap,mj=new WeakMap,a0=new WeakMap,vO=new WeakSet,CX=new WeakSet,Ytt=function(){function e(t){var r=t.countRows,n=t.countColumns,i=t.rowsLimit,o=t.columnsLimit,s=t.countColumnHeaders;Ftt(this,e),xX(this,CX),xX(this,vO),Oy(this,Cf,{writable:!0,value:void 0}),Oy(this,e2,{writable:!0,value:void 0}),Oy(this,o0,{writable:!0,value:void 0}),Oy(this,pj,{writable:!0,value:void 0}),Oy(this,mj,{writable:!0,value:void 0}),Oy(this,a0,{writable:!0,value:void 0}),Ry(this,e2,r),Ry(this,o0,n),Ry(this,pj,i),Ry(this,mj,o),Ry(this,a0,s)}return Htt(e,[{key:"setSelectedRange",value:function(r){Ry(this,Cf,r)}},{key:"getCellsRange",value:function(){if(fa(this,e2).call(this)===0||fa(this,o0).call(this)===0)return null;var r=fa(this,Cf).getTopStartCorner(),n=r.row,i=r.col,o=fa(this,Cf).getBottomEndCorner(),s=o.row,a=o.col,h=gO(this,CX,Ktt).call(this,n,s),p=gO(this,vO,t2).call(this,i,a),g=s!==h||a!==p;return{isRangeTrimmed:g,startRow:n,startCol:i,endRow:h,endCol:p}}},{key:"getMostBottomColumnHeadersRange",value:function(){if(fa(this,o0).call(this)===0||fa(this,a0).call(this)===0)return null;var r=fa(this,Cf).getTopStartCorner(),n=r.col,i=fa(this,Cf).getBottomEndCorner(),o=i.col,s=gO(this,vO,t2).call(this,n,o),a=o!==s;return{isRangeTrimmed:a,startRow:-1,startCol:n,endRow:-1,endCol:s}}},{key:"getAllColumnHeadersRange",value:function(){if(fa(this,o0).call(this)===0||fa(this,a0).call(this)===0)return null;var r=fa(this,Cf).getTopStartCorner(),n=r.col,i=fa(this,Cf).getBottomEndCorner(),o=i.col,s=gO(this,vO,t2).call(this,n,o),a=o!==s;return{isRangeTrimmed:a,startRow:-fa(this,a0).call(this),startCol:n,endRow:-1,endCol:s}}}]),e}();function t2(e,t){return Math.min(t,Math.max(e+fa(this,mj).call(this)-1,e))}function Ktt(e,t){return Math.min(t,Math.max(e+fa(this,pj).call(this)-1,e))}function zle(e){var t=[],r=[];return Le(e,function(n){var i=Math.min(n.startRow,n.endRow),o=Math.max(n.startRow,n.endRow);Er(i,o,function(h){t.indexOf(h)===-1&&t.push(h)});var s=Math.min(n.startCol,n.endCol),a=Math.max(n.startCol,n.endCol);Er(s,a,function(h){r.indexOf(h)===-1&&r.push(h)})}),{rows:t,columns:r}}function qtt(e,t){return Qtt(e)||Jtt(e,t)||Ztt(e,t)||Xtt()}function Xtt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ztt(e,t){if(e){if(typeof e=="string")return EX(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return EX(e,t)}}function EX(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Jtt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],h=!0,p=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;h=!1}else for(;!(h=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);h=!0);}catch(g){p=!0,i=g}finally{try{if(!h&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(p)throw i}}return a}}function Qtt(e){if(Array.isArray(e))return e}function Hp(e){"@babel/helpers - typeof";return Hp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hp(e)}function ert(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function TX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Hle(n.key),n)}}function trt(e,t,r){return t&&TX(e.prototype,t),r&&TX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Qd(){return typeof Reflect<"u"&&Reflect.get?Qd=Reflect.get.bind():Qd=function(t,r,n){var i=rrt(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Qd.apply(this,arguments)}function rrt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=ic(e),e!==null););return e}function nrt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&yj(e,t)}function yj(e,t){return yj=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},yj(e,t)}function irt(e){var t=art();return function(){var n=ic(e),i;if(t){var o=ic(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return ort(this,i)}}function ort(e,t){if(t&&(Hp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ca(e)}function ca(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function art(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ic(e){return ic=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ic(e)}function srt(e,t){Fle(e,t),t.add(e)}function Od(e,t,r){Fle(e,t),t.set(e,r)}function Fle(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ky(e,t,r){return t=Hle(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Hle(e){var t=lrt(e,"string");return Hp(t)==="symbol"?t:String(t)}function lrt(e,t){if(Hp(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Hp(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function urt(e,t,r){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return r}function qa(e,t){var r=Vle(e,t,"get");return crt(e,r)}function crt(e,t){return t.get?t.get.call(e):t.value}function $u(e,t,r){var n=Vle(e,t,"set");return frt(e,n,r),r}function Vle(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function frt(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}mr.getSingleton().register("afterCopyLimit");mr.getSingleton().register("modifyCopyableRange");mr.getSingleton().register("beforeCut");mr.getSingleton().register("afterCut");mr.getSingleton().register("beforePaste");mr.getSingleton().register("afterPaste");mr.getSingleton().register("beforeCopy");mr.getSingleton().register("afterCopy");var _O="copyPaste",hrt=80,drt=["fragmentSelection"],OX=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join(""),r2=new WeakMap,n2=new WeakMap,i2=new WeakMap,Py=new WeakMap,bO=new WeakMap,wO=new WeakMap,Ay=new WeakMap,RX=new WeakSet,prt=function(e){nrt(r,e);var t=irt(r);function r(){var n;ert(this,r);for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n=t.call.apply(t,[this].concat(o)),srt(ca(n),RX),ky(ca(n),"columnsLimit",1/0),ky(ca(n),"rowsLimit",1/0),ky(ca(n),"pasteMode","overwrite"),ky(ca(n),"uiContainer",n.hot.rootDocument.body),Od(ca(n),r2,{writable:!0,value:!1}),Od(ca(n),n2,{writable:!0,value:!1}),Od(ca(n),i2,{writable:!0,value:!1}),Od(ca(n),Py,{writable:!0,value:"cells-only"}),Od(ca(n),bO,{writable:!0,value:!1}),Od(ca(n),wO,{writable:!0,value:!1}),Od(ca(n),Ay,{writable:!0,value:new Ytt({countRows:function(){return n.hot.countRows()},countColumns:function(){return n.hot.countCols()},rowsLimit:function(){return n.rowsLimit},columnsLimit:function(){return n.columnsLimit},countColumnHeaders:function(){return n.hot.view.getColumnHeadersCount()}})}),ky(ca(n),"copyableRanges",[]),ky(ca(n),"focusableElement",void 0),n}return trt(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[_O]}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){var o=this.hot.getSettings(),s=o[_O];if(Hp(s)==="object"){var a,h;this.pasteMode=(a=s.pasteMode)!==null&&a!==void 0?a:this.pasteMode,this.rowsLimit=isNaN(s.rowsLimit)?this.rowsLimit:s.rowsLimit,this.columnsLimit=isNaN(s.columnsLimit)?this.columnsLimit:s.columnsLimit,$u(this,r2,!!s.copyColumnHeaders),$u(this,n2,!!s.copyColumnGroupHeaders),$u(this,i2,!!s.copyColumnHeadersOnly),this.uiContainer=(h=s.uiContainer)!==null&&h!==void 0?h:this.uiContainer}this.addHook("afterContextMenuDefaultOptions",function(p){return i.onAfterContextMenuDefaultOptions(p)}),this.addHook("afterOnCellMouseUp",function(){return i.onAfterOnCellMouseUp()}),this.addHook("afterSelectionEnd",function(){return i.onAfterSelectionEnd()}),this.addHook("beforeKeyDown",function(){return i.onBeforeKeyDown()}),this.focusableElement=Btt(this.uiContainer),this.focusableElement.addLocalHook("copy",function(p){return i.onCopy(p)}).addLocalHook("cut",function(p){return i.onCut(p)}).addLocalHook("paste",function(p){return i.onPaste(p)}),Qd(ic(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.getOrCreateFocusableElement(),Qd(ic(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.focusableElement&&wX(this.focusableElement),Qd(ic(r.prototype),"disablePlugin",this).call(this)}},{key:"copy",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";$u(this,Py,i),$u(this,bO,!0),this.getOrCreateFocusableElement(),this.focusableElement.focus(),this.hot.rootDocument.execCommand("copy")}},{key:"copyCellsOnly",value:function(){this.copy("cells-only")}},{key:"copyColumnHeadersOnly",value:function(){this.copy("column-headers-only")}},{key:"copyWithAllColumnHeaders",value:function(){this.copy("with-column-group-headers")}},{key:"copyWithColumnHeaders",value:function(){this.copy("with-column-headers")}},{key:"cut",value:function(){$u(this,wO,!0),this.getOrCreateFocusableElement(),this.focusableElement.focus(),this.hot.rootDocument.execCommand("cut")}},{key:"getRangedCopyableData",value:function(i){return q0(this.getRangedData(i))}},{key:"getRangedData",value:function(i){var o=this,s=[],a=zle(i),h=a.rows,p=a.columns;return Le(h,function(g){var S=[];Le(p,function(T){g<0?S.push(o.hot.getColHeader(T,g)):S.push(o.hot.getCopyableData(g,T))}),s.push(S)}),s}},{key:"paste",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:i;if(!(!i&&!o)){var s=new Mtt;i&&s.clipboardData.setData("text/plain",i),o&&s.clipboardData.setData("text/html",o),this.getOrCreateFocusableElement(),this.onPaste(s)}}},{key:"setCopyableText",value:function(){var i=this.hot.getSelectedRangeLast();if(i){qa(this,Ay).setSelectedRange(i);var o=new Map([["headers",null],["cells",null]]);qa(this,Py)==="column-headers-only"?o.set("headers",qa(this,Ay).getMostBottomColumnHeadersRange()):(qa(this,Py)==="with-column-headers"?o.set("headers",qa(this,Ay).getMostBottomColumnHeadersRange()):qa(this,Py)==="with-column-group-headers"&&o.set("headers",qa(this,Ay).getAllColumnHeadersRange()),o.set("cells",qa(this,Ay).getCellsRange())),this.copyableRanges=Array.from(o.values()).filter(function(S){return S!==null}).map(function(S){var T=S.startRow,R=S.startCol,A=S.endRow,$=S.endCol;return{startRow:T,startCol:R,endRow:A,endCol:$}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);var s=o.get("cells");if(s!==null&&s.isRangeTrimmed){var a=s.startRow,h=s.startCol,p=s.endRow,g=s.endCol;this.hot.runHooks("afterCopyLimit",p-a+1,g-h+1,this.rowsLimit,this.columnsLimit)}}}},{key:"getOrCreateFocusableElement",value:function(){var i,o=(i=this.hot.getActiveEditor())===null||i===void 0?void 0:i.TEXTAREA;o?this.focusableElement.setFocusableElement(o):this.focusableElement.useSecondaryElement()}},{key:"isEditorOpened",value:function(){var i;return(i=this.hot.getActiveEditor())===null||i===void 0?void 0:i.isOpened()}},{key:"populateValues",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.getSelectedRangeLast();if(i.length){for(var s=i.length,a=i[0].length,h=[],p=o.getTopStartCorner(),g=p.row,S=p.col,T=o.getBottomEndCorner(),R=T.row,A=T.col,$=g,j=S,z=g,V=S;h.length<s||$<=R;){var G=this.hot.getCellMeta($,S),ee=G.skipRowOnPaste,K=G.visualRow;if($=K+1,ee!==!0){z=K,j=S;for(var xe=[],Me=h.length%s;xe.length<a||j<=A;){var He=this.hot.getCellMeta(g,j),Ne=He.skipColumnOnPaste,We=He.visualCol;if(j=We+1,Ne!==!0){V=We;var gt=xe.length%a;xe.push(i[Me][gt])}}h.push(xe)}}return this.hot.populateFromArray(g,S,h,void 0,void 0,"CopyPaste.paste",this.pasteMode),[g,S,z,V]}}},{key:"onCopy",value:function(i){if(!(!this.hot.isListening()&&!qa(this,bO)||this.isEditorOpened())){this.setCopyableText(),$u(this,bO,!1);var o=this.getRangedData(this.copyableRanges),s=urt(this,RX,mrt).call(this,this.copyableRanges),a=!!this.hot.runHooks("beforeCopy",o,this.copyableRanges,s);if(a){var h=q0(o);if(i&&i.clipboardData){var p=c7(o,this.hot.rootDocument);i.clipboardData.setData("text/plain",h),i.clipboardData.setData("text/html",[OX,p].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",h);this.hot.runHooks("afterCopy",o,this.copyableRanges,s)}$u(this,Py,"cells-only"),i.preventDefault()}}},{key:"onCut",value:function(i){if(!(!this.hot.isListening()&&!qa(this,wO)||this.isEditorOpened())){this.setCopyableText(),$u(this,wO,!1);var o=this.getRangedData(this.copyableRanges),s=!!this.hot.runHooks("beforeCut",o,this.copyableRanges);if(s){var a=q0(o);if(i&&i.clipboardData){var h=c7(o,this.hot.rootDocument);i.clipboardData.setData("text/plain",a),i.clipboardData.setData("text/html",[OX,h].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",a);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",o,this.copyableRanges)}i.preventDefault()}}},{key:"onPaste",value:function(i){if(!(!this.hot.isListening()||this.isEditorOpened())){i&&i.preventDefault&&i.preventDefault();var o;if(i&&typeof i.clipboardData<"u"){var s=t3(i.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});if(s&&/(<table)|(<TABLE)/g.test(s)){var a=KXe(s,this.hot.rootDocument);o=a.data}else o=i.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(o=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof o=="string"&&(o=RQe(o)),!(o&&o.length===0)&&this.hot.runHooks("beforePaste",o,this.copyableRanges)!==!1){var h=this.populateValues(o),p=qtt(h,4),g=p[0],S=p[1],T=p[2],R=p[3];this.hot.selectCell(g,S,Math.min(this.hot.countRows()-1,T),Math.min(this.hot.countCols()-1,R)),this.hot.runHooks("afterPaste",o,this.copyableRanges)}}}},{key:"onAfterContextMenuDefaultOptions",value:function(i){i.items.push({name:"---------"},_tt(this)),qa(this,r2)&&i.items.push(Stt(this)),qa(this,n2)&&i.items.push(wtt(this)),qa(this,i2)&&i.items.push(btt(this)),i.items.push(xtt(this))}},{key:"onAfterOnCellMouseUp",value:function(){!this.hot.isListening()||this.isEditorOpened()||this.hot.getSettings().fragmentSelection||(this.getOrCreateFocusableElement(),this.focusableElement.focus())}},{key:"onAfterSelectionEnd",value:function(){this.isEditorOpened()||(this.getOrCreateFocusableElement(),!(this.hot.getSettings().fragmentSelection&&this.focusableElement.getFocusableElement()!==this.hot.rootDocument.activeElement&&cLe())&&(this.setCopyableText(),this.focusableElement.focus()))}},{key:"onBeforeKeyDown",value:function(){if(!(!this.hot.isListening()||this.isEditorOpened())){var i=this.hot.rootDocument.activeElement,o=this.hot.getActiveEditor();!o||i!==this.focusableElement.getFocusableElement()&&i!==o.select||(this.getOrCreateFocusableElement(),this.focusableElement.focus())}}},{key:"destroy",value:function(){this.focusableElement&&(wX(this.focusableElement),this.focusableElement=null),Qd(ic(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return _O}},{key:"SETTING_KEYS",get:function(){return[_O].concat(drt)}},{key:"PLUGIN_PRIORITY",get:function(){return hrt}}]),r}(Wn);function mrt(e){for(var t=zle(e),r=t.rows,n=0,i=0;i<r.length&&!(r[i]>=0);i++)n+=1;return{columnHeadersCount:n}}function Ule(e,t){return"border_row".concat(e,"col").concat(t)}function C0(){return{width:1,color:"#000"}}function oc(){return{hide:!0}}function yrt(){return{width:1,color:"#000",cornerVisible:!1}}function o2(e){if(dr(e.start)||dr(e.left)){var t;e.start=(t=e.start)!==null&&t!==void 0?t:e.left}if(dr(e.end)||dr(e.right)){var r;e.end=(r=e.end)!==null&&r!==void 0?r:e.right}return delete e.left,delete e.right,e}function s0(e){return dr(e.start)&&(e.left=e.start),dr(e.end)&&(e.right=e.end),e}function a2(e,t){return{id:Ule(e,t),border:yrt(),row:e,col:t,top:oc(),bottom:oc(),start:oc(),end:oc()}}function grt(e,t){return Ui(t,"border")&&t.border&&(e.border=t.border),Ui(t,"top")&&dr(t.top)&&(t.top?(dn(t.top)||(t.top=C0()),e.top=t.top):(t.top=oc(),e.top=t.top)),Ui(t,"bottom")&&dr(t.bottom)&&(t.bottom?(dn(t.bottom)||(t.bottom=C0()),e.bottom=t.bottom):(t.bottom=oc(),e.bottom=t.bottom)),Ui(t,"start")&&dr(t.start)&&(t.start?(dn(t.start)||(t.start=C0()),e.start=t.start):(t.start=oc(),e.start=t.start)),Ui(t,"end")&&dr(t.end)&&(t.end?(dn(t.end)||(t.end=C0()),e.end=t.end):(t.end=oc(),e.end=t.end)),e}function Ic(e,t){var r=!1;return Le(e.getSelectedRange(),function(n){n.forAll(function(i,o){if(!(i<0||o<0)){var s=e.getCellMeta(i,o).borders;if(s)if(t){if(!Ui(s[t],"hide")||s[t].hide===!1)return r=!0,!1}else return r=!0,!1}})}),r}function JA(e){return'<span class="selected">'.concat(String.fromCharCode(10003),"</span>").concat(e)}function vrt(e){return e.some(function(t){return dr(t.left)||dr(t.right)})}function _rt(e){return e.some(function(t){return dr(t.start)||dr(t.end)})}var brt=new Map([["left","start"],["right","end"]]);function wrt(e){var t;return(t=brt.get(e))!==null&&t!==void 0?t:e}function Srt(e){return{key:"borders:bottom",name:function(){var r=this.getTranslatedPhrase(bV),n=Ic(this,"bottom");return n&&(r=JA(r)),r},callback:function(r,n){var i=Ic(this,"bottom");e.prepareBorder(n,"bottom",i)}}}function xrt(e){var t=e.hot.isRtl()?"end":"start";return{key:"borders:left",name:function(){var n=this.getTranslatedPhrase(wV),i=Ic(this,t);return i&&(n=JA(n)),n},callback:function(n,i){var o=Ic(this,t);e.prepareBorder(i,t,o)}}}function Crt(e){return{key:"borders:no_borders",name:function(){return this.getTranslatedPhrase(SV)},callback:function(r,n){e.prepareBorder(n,"noBorders")},disabled:function(){return!Ic(this)}}}function Ert(e){var t=e.hot.isRtl()?"start":"end";return{key:"borders:right",name:function(){var n=this.getTranslatedPhrase(_V),i=Ic(this,t);return i&&(n=JA(n)),n},callback:function(n,i){var o=Ic(this,t);e.prepareBorder(i,t,o)}}}function Trt(e){return{key:"borders:top",name:function(){var r=this.getTranslatedPhrase(vV),n=Ic(this,"top");return n&&(r=JA(r)),r},callback:function(r,n){var i=Ic(this,"top");e.prepareBorder(n,"top",i)}}}function Wv(e){"@babel/helpers - typeof";return Wv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wv(e)}function kX(e,t){return Prt(e)||krt(e,t)||Rrt(e,t)||Ort()}function Ort(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Rrt(e,t){if(e){if(typeof e=="string")return PX(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return PX(e,t)}}function PX(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function krt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],h=!0,p=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;h=!1}else for(;!(h=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);h=!0);}catch(g){p=!0,i=g}finally{try{if(!h&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(p)throw i}}return a}}function Prt(e){if(Array.isArray(e))return e}function Art(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function AX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Gle(n.key),n)}}function Irt(e,t,r){return t&&AX(e.prototype,t),r&&AX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ep(){return typeof Reflect<"u"&&Reflect.get?ep=Reflect.get.bind():ep=function(t,r,n){var i=Mrt(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},ep.apply(this,arguments)}function Mrt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=ac(e),e!==null););return e}function Drt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&gj(e,t)}function gj(e,t){return gj=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},gj(e,t)}function $rt(e){var t=Nrt();return function(){var n=ac(e),i;if(t){var o=ac(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Lrt(this,i)}}function Lrt(e,t){if(t&&(Wv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Wle(e)}function Wle(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Nrt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ac(e){return ac=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ac(e)}function Brt(e,t,r){return t=Gle(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Gle(e){var t=jrt(e,"string");return Wv(t)==="symbol"?t:String(t)}function jrt(e,t){if(Wv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Wv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var SO="customBorders",zrt=90,Frt=function(e){Drt(r,e);var t=$rt(r);function r(){var n;Art(this,r);for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n=t.call.apply(t,[this].concat(o)),Brt(Wle(n),"savedBorders",[]),n}return Irt(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[SO]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.addHook("afterContextMenuDefaultOptions",function(o){return i.onAfterContextMenuDefaultOptions(o)}),this.addHook("init",function(){return i.onAfterInit()}),ep(ac(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.hideBorders(),ep(ac(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),ep(ac(r.prototype),"updatePlugin",this).call(this)}},{key:"setBorders",value:function(i,o){var s=this,a=["top","bottom","start","end"],h=null;o&&(this.checkSettingsCohesion([o]),a=Object.keys(o),h=o2(o));var p=zv(i),g=_1(p);Le(i,function(S){for(var T=g(S),R=kX(T,4),A=R[0],$=R[1],j=R[2],z=R[3],V=function(K){for(var xe=function(Ne){Le(a,function(We){s.prepareBorderFromCustomAdded(K,Ne,h,wrt(We))})},Me=$;Me<=z;Me+=1)xe(Me)},G=A;G<=j;G+=1)V(G)}),this.hot.view.render()}},{key:"getBorders",value:function(i){var o=this;if(!Array.isArray(i))return this.savedBorders;var s=zv(i),a=_1(s),h=[];return Le(i,function(p){for(var g=a(p),S=kX(g,4),T=S[0],R=S[1],A=S[2],$=S[3],j=function(G){for(var ee=function(Me){Le(o.savedBorders,function(He){He.row===G&&He.col===Me&&h.push(s0(He))})},K=R;K<=$;K+=1)ee(K)},z=T;z<=A;z+=1)j(z)}),h}},{key:"clearBorders",value:function(i){var o=this;i?this.setBorders(i):(Le(this.savedBorders,function(s){o.clearBordersFromSelectionSettings(s.id),o.clearNullCellRange(),o.hot.removeCellMeta(s.row,s.col,"borders")}),this.savedBorders.length=0)}},{key:"insertBorderIntoSettings",value:function(i,o){var s=this.checkSavedBorders(i);s||this.savedBorders.push(i);var a=this.hot._createCellRange(this.hot._createCellCoords(i.row,i.col)),h=this.checkCustomSelections(i,a,o);h||this.hot.selection.highlight.addCustomSelection({border:i,visualCellRange:a})}},{key:"prepareBorderFromCustomAdded",value:function(i,o,s,a){var h=this.hot.countRows(),p=this.hot.countCols();if(!(i>=h||o>=p)){var g=a2(i,o);s&&(g=grt(g,s),Le(this.hot.selection.highlight.customSelections,function(S){if(g.id===S.settings.id)return Object.assign(S.settings,s),g.id=S.settings.id,g.top=S.settings.top,g.bottom=S.settings.bottom,g.start=S.settings.start,g.end=S.settings.end,!1})),this.hot.setCellMeta(i,o,"borders",s0(g)),this.insertBorderIntoSettings(g,a)}}},{key:"prepareBorderFromCustomAddedRange",value:function(i,o){var s=this,a=Math.min(i.to.row,this.hot.countRows()-1),h=Math.min(i.to.col,this.hot.countCols()-1);Er(i.from.row,a,function(p){Er(i.from.col,h,function(g){var S=a2(p,g),T=0;p===i.from.row&&Ui(o,"top")&&(T+=1,S.top=o.top),p===i.to.row&&Ui(o,"bottom")&&(T+=1,S.bottom=o.bottom),g===i.from.col&&Ui(o,"start")&&(T+=1,S.start=o.start),g===i.to.col&&Ui(o,"end")&&(T+=1,S.end=o.end),T>0&&(s.hot.setCellMeta(p,g,"borders",s0(S)),s.insertBorderIntoSettings(S))})})}},{key:"removeAllBorders",value:function(i,o){var s=Ule(i,o);this.spliceBorder(s),this.clearBordersFromSelectionSettings(s),this.clearNullCellRange(),this.hot.removeCellMeta(i,o,"borders")}},{key:"setBorder",value:function(i,o,s,a){var h=this.hot.getCellMeta(i,o).borders;if(!h||h.border===void 0?h=a2(i,o):h=o2(h),a){h[s]=oc();var p=this.countHide(h);if(p===4)this.removeAllBorders(i,o);else{var g=this.checkCustomSelectionsFromContextMenu(h,s,a);g||this.insertBorderIntoSettings(h),this.hot.setCellMeta(i,o,"borders",s0(h))}}else{h[s]=C0();var S=this.checkCustomSelectionsFromContextMenu(h,s,a);S||this.insertBorderIntoSettings(h),this.hot.setCellMeta(i,o,"borders",s0(h))}}},{key:"prepareBorder",value:function(i,o,s){var a=this;Le(i,function(h){var p=h.start,g=h.end;if(p.row===g.row&&p.col===g.col)o==="noBorders"?a.removeAllBorders(p.row,p.col):a.setBorder(p.row,p.col,o,s);else switch(o){case"noBorders":Er(p.col,g.col,function(S){Er(p.row,g.row,function(T){a.removeAllBorders(T,S)})});break;case"top":Er(p.col,g.col,function(S){a.setBorder(p.row,S,o,s)});break;case"bottom":Er(p.col,g.col,function(S){a.setBorder(g.row,S,o,s)});break;case"start":Er(p.row,g.row,function(S){a.setBorder(S,p.col,o,s)});break;case"end":Er(p.row,g.row,function(S){a.setBorder(S,g.col,o,s)});break}})}},{key:"createCustomBorders",value:function(i){var o=this;Le(i,function(s){var a=o2(s);s.range?o.prepareBorderFromCustomAddedRange(s.range,a):o.prepareBorderFromCustomAdded(s.row,s.col,a)})}},{key:"countHide",value:function(i){var o=i.top,s=i.bottom,a=i.start,h=i.end,p=[o,s,a,h];return na(p,function(g,S){var T=g;return S&&S.hide&&(T+=1),T},0)}},{key:"clearBordersFromSelectionSettings",value:function(i){var o=hn(this.hot.selection.highlight.customSelections,function(s){return s.settings.id}).indexOf(i);o>-1&&this.hot.selection.highlight.customSelections[o].clear()}},{key:"clearNullCellRange",value:function(){var i=this;Le(this.hot.selection.highlight.customSelections,function(o,s){if(o.cellRange===null)return i.hot.selection.highlight.customSelections[s].destroy(),i.hot.selection.highlight.customSelections.splice(s,1),!1})}},{key:"hideBorders",value:function(){var i=this;Le(this.savedBorders,function(o){i.clearBordersFromSelectionSettings(o.id),i.clearNullCellRange()})}},{key:"spliceBorder",value:function(i){var o=hn(this.savedBorders,function(s){return s.id}).indexOf(i);o>-1&&this.savedBorders.splice(o,1)}},{key:"checkSavedBorders",value:function(i){var o=this,s=!1,a=this.countHide(i);return a===4?(this.spliceBorder(i.id),s=!0):Le(this.savedBorders,function(h,p){if(i.id===h.id)return o.savedBorders[p]=i,s=!0,!1}),s}},{key:"checkCustomSelectionsFromContextMenu",value:function(i,o,s){var a=!1;return Le(this.hot.selection.highlight.customSelections,function(h){if(i.id===h.settings.id)return pn(h.instanceBorders,function(p){p.toggleHiddenClass(o,s)}),a=!0,!1}),a}},{key:"checkCustomSelections",value:function(i,o,s){var a=this.countHide(i),h=!1;return a===4?(this.removeAllBorders(i.row,i.col),h=!0):Le(this.hot.selection.highlight.customSelections,function(p){if(i.id===p.settings.id)return p.visualCellRange=o,p.commit(),s&&pn(p.instanceBorders,function(g){g.changeBorderStyle(s,i)}),h=!0,!1}),h}},{key:"changeBorderSettings",value:function(){var i=this.hot.getSettings()[SO];if(Array.isArray(i)){var o=ya(i);this.checkSettingsCohesion(o),o.length||(this.savedBorders=o),this.createCustomBorders(o)}else i!==void 0&&this.createCustomBorders(this.savedBorders)}},{key:"checkSettingsCohesion",value:function(i){var o=vrt(i),s=_rt(i);if(o&&s)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&o)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}},{key:"onAfterContextMenuDefaultOptions",value:function(i){this.hot.getSettings()[SO]&&i.items.push({name:"---------"},{key:"borders",name:function(){return this.getTranslatedPhrase(gV)},disabled:function(){return this.selection.isSelectedByCorner()},submenu:{items:[Trt(this),Ert(this),Srt(this),xrt(this),Crt(this)]}})}},{key:"onAfterInit",value:function(){this.changeBorderSettings()}},{key:"destroy",value:function(){ep(ac(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return SO}},{key:"PLUGIN_PRIORITY",get:function(){return zrt}}]),r}(Wn);function Gv(e){"@babel/helpers - typeof";return Gv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gv(e)}function Hrt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function IX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Urt(n.key),n)}}function Vrt(e,t,r){return t&&IX(e.prototype,t),r&&IX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Urt(e){var t=Wrt(e,"string");return Gv(t)==="symbol"?t:String(t)}function Wrt(e,t){if(Gv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Gv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function tp(){return typeof Reflect<"u"&&Reflect.get?tp=Reflect.get.bind():tp=function(t,r,n){var i=Grt(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},tp.apply(this,arguments)}function Grt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=sc(e),e!==null););return e}function Yrt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&vj(e,t)}function vj(e,t){return vj=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},vj(e,t)}function Krt(e){var t=Xrt();return function(){var n=sc(e),i;if(t){var o=sc(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return qrt(this,i)}}function qrt(e,t){if(t&&(Gv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Yle(e)}function Yle(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Xrt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function sc(e){return sc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},sc(e)}var MX="dragToScroll",Zrt=100,Jrt=function(e){Yrt(r,e);var t=Krt(r);function r(n){var i;return Hrt(this,r),i=t.call(this,n),i.eventManager=new Bi(Yle(i)),i.boundaries=null,i.callback=null,i.listening=!1,i}return Vrt(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[MX]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.addHook("afterOnCellMouseDown",function(o){return i.setupListening(o)}),this.addHook("afterOnCellCornerMouseDown",function(o){return i.setupListening(o)}),this.registerEvents(),tp(sc(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),tp(sc(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.unregisterEvents(),tp(sc(r.prototype),"disablePlugin",this).call(this)}},{key:"setBoundaries",value:function(i){this.boundaries=i}},{key:"setCallback",value:function(i){this.callback=i}},{key:"check",value:function(i,o){var s=0,a=0;o<this.boundaries.top?a=o-this.boundaries.top:o>this.boundaries.bottom&&(a=o-this.boundaries.bottom),i<this.boundaries.left?s=i-this.boundaries.left:i>this.boundaries.right&&(s=i-this.boundaries.right),this.callback(s,a)}},{key:"listen",value:function(){this.listening=!0}},{key:"unlisten",value:function(){this.listening=!1}},{key:"isListening",value:function(){return this.listening}},{key:"registerEvents",value:function(){for(var i=this,o=this.hot.rootWindow,s=o;s;)this.eventManager.addEventListener(s.document,"contextmenu",function(){return i.unlisten()}),this.eventManager.addEventListener(s.document,"mouseup",function(){return i.unlisten()}),this.eventManager.addEventListener(s.document,"mousemove",function(a){return i.onMouseMove(a)}),s=xk(s)}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"setupListening",value:function(i){if(!Pp(i)){var o=this.hot.view._wt.wtTable.holder;o!==this.hot.rootWindow&&(this.setBoundaries(o.getBoundingClientRect()),this.setCallback(function(s,a){s<0?o.scrollLeft-=50:s>0&&(o.scrollLeft+=50),a<0?o.scrollTop-=20:a>0&&(o.scrollTop+=20)}),this.listen())}}},{key:"onMouseMove",value:function(i){this.isListening()&&this.check(i.clientX,i.clientY)}},{key:"destroy",value:function(){tp(sc(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return MX}},{key:"PLUGIN_PRIORITY",get:function(){return Zrt}}]),r}(Wn);function Yv(e){"@babel/helpers - typeof";return Yv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yv(e)}function Qrt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function DX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,tnt(n.key),n)}}function ent(e,t,r){return t&&DX(e.prototype,t),r&&DX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function tnt(e){var t=rnt(e,"string");return Yv(t)==="symbol"?t:String(t)}function rnt(e,t){if(Yv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Yv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function rp(){return typeof Reflect<"u"&&Reflect.get?rp=Reflect.get.bind():rp=function(t,r,n){var i=nnt(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},rp.apply(this,arguments)}function nnt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=lc(e),e!==null););return e}function int(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_j(e,t)}function _j(e,t){return _j=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},_j(e,t)}function ont(e){var t=snt();return function(){var n=lc(e),i;if(t){var o=lc(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return ant(this,i)}}function ant(e,t){if(t&&(Yv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Kle(e)}function Kle(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function snt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function lc(e){return lc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},lc(e)}mr.getSingleton().register("afterDropdownMenuDefaultOptions");mr.getSingleton().register("beforeDropdownMenuShow");mr.getSingleton().register("afterDropdownMenuShow");mr.getSingleton().register("afterDropdownMenuHide");mr.getSingleton().register("afterDropdownMenuExecute");var s2="dropdownMenu",lnt=230,l2="changeType",qle=function(e){int(r,e);var t=ont(r);function r(n){var i;return Qrt(this,r),i=t.call(this,n),i.eventManager=new Bi(Kle(i)),i.commandExecutor=new Kse(i.hot),i.itemsFactory=null,i.menu=null,i.hot.addHook("afterGetColHeader",function(o,s){return i.onAfterGetColHeader(o,s)}),i}return ent(r,[{key:"isEnabled",value:function(){return this.hot.getSettings()[s2]}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){this.itemsFactory=new Jse(this.hot,r.DEFAULT_ITEMS);var o=this.hot.getSettings()[s2],s={items:this.itemsFactory.getItems(o)};this.registerEvents(),typeof o.callback=="function"&&this.commandExecutor.setCommonCallback(o.callback),rp(lc(r.prototype),"enablePlugin",this).call(this),this.callOnPluginsReady(function(){i.hot.runHooks("afterDropdownMenuDefaultOptions",s),i.itemsFactory.setPredefinedItems(s.items);var a=i.itemsFactory.getItems(o);i.menu&&i.menu.destroy(),i.menu=new fU(i.hot,{className:"htDropdownMenu",keepInViewport:!0,container:o.uiContainer||i.hot.rootDocument.body}),i.hot.runHooks("beforeDropdownMenuSetItems",a),i.menu.setMenuItems(a),i.menu.addLocalHook("beforeOpen",function(){return i.onMenuBeforeOpen()}),i.menu.addLocalHook("afterOpen",function(){return i.onMenuAfterOpen()}),i.menu.addLocalHook("afterClose",function(){return i.onMenuAfterClose()}),i.menu.addLocalHook("executeCommand",function(){for(var h,p=arguments.length,g=new Array(p),S=0;S<p;S++)g[S]=arguments[S];return(h=i.executeCommand).call.apply(h,[i].concat(g))}),Le(a,function(h){return i.commandExecutor.registerCommand(h.key,h)})})}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),rp(lc(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.close(),this.menu&&this.menu.destroy(),rp(lc(r.prototype),"disablePlugin",this).call(this)}},{key:"registerEvents",value:function(){var i=this;this.eventManager.addEventListener(this.hot.rootElement,"click",function(o){return i.onTableClick(o)})}},{key:"open",value:function(i){this.menu&&(this.menu.open(),i.width&&this.menu.setOffset("left",i.width),this.menu.setPosition(i))}},{key:"close",value:function(){this.menu&&this.menu.close()}},{key:"executeCommand",value:function(i){for(var o,s=arguments.length,a=new Array(s>1?s-1:0),h=1;h<s;h++)a[h-1]=arguments[h];(o=this.commandExecutor).execute.apply(o,[i].concat(a))}},{key:"setListening",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.menu.isOpened()&&(i?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}},{key:"onTableClick",value:function(i){if(i.stopPropagation(),Ur(i.target,l2)&&!this.menu.isOpened()){var o=0,s=0;if(this.hot.rootDocument!==this.menu.container.ownerDocument){var a=this.hot.rootWindow.frameElement,h=a.getBoundingClientRect(),p=h.top,g=h.left;o=p,s=g}var S=i.target.getBoundingClientRect();this.open({left:S.left+s,top:S.top+i.target.offsetHeight+3+o,width:S.width,height:S.height})}}},{key:"onAfterGetColHeader",value:function(i,o){var s=o.parentNode;if(s){var a=s.parentNode.childNodes,h=Array.prototype.indexOf.call(a,s);if(!(i<0||h!==a.length-1)){var p=o.querySelector(".".concat(l2));if(!(this.enabled&&p)){if(!this.enabled){p&&p.parentNode.removeChild(p);return}var g=this.hot.rootDocument.createElement("button");g.className=l2,g.type="button",g.onclick=function(){return!1},o.firstChild.insertBefore(g,o.firstChild.firstChild)}}}}},{key:"onMenuBeforeOpen",value:function(){this.hot.runHooks("beforeDropdownMenuShow",this)}},{key:"onMenuAfterOpen",value:function(){this.hot.runHooks("afterDropdownMenuShow",this)}},{key:"onMenuAfterClose",value:function(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}},{key:"destroy",value:function(){this.close(),this.menu&&this.menu.destroy(),rp(lc(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return s2}},{key:"PLUGIN_PRIORITY",get:function(){return lnt}},{key:"PLUGIN_DEPS",get:function(){return["plugin:AutoColumnSize"]}},{key:"DEFAULT_ITEMS",get:function(){return[_C,bC,fn,SC,fn,zA,fn,wC,fn,Es]}}]),r}(Wn);qle.SEPARATOR={name:fn};function Q1(e){"@babel/helpers - typeof";return Q1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Q1(e)}function unt(e,t){return dnt(e)||hnt(e,t)||fnt(e,t)||cnt()}function cnt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function fnt(e,t){if(e){if(typeof e=="string")return $X(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return $X(e,t)}}function $X(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function hnt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],h=!0,p=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;h=!1}else for(;!(h=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);h=!0);}catch(g){p=!0,i=g}finally{try{if(!h&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(p)throw i}}return a}}function dnt(e){if(Array.isArray(e))return e}function pnt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function LX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ynt(n.key),n)}}function mnt(e,t,r){return t&&LX(e.prototype,t),r&&LX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ynt(e){var t=gnt(e,"string");return Q1(t)==="symbol"?t:String(t)}function gnt(e,t){if(Q1(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Q1(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var vnt=function(){function e(t){pnt(this,e),this.hot=t,this.options={}}return mnt(e,[{key:"setOptions",value:function(r){this.options=r}},{key:"getData",value:function(){var r=this,n=this._getDataRange(),i=n.startRow,o=n.startCol,s=n.endRow,a=n.endCol,h=this.options,p=[];return Er(i,s,function(g){var S=[];!h.exportHiddenRows&&r._isHiddenRow(g)||(Er(o,a,function(T){!h.exportHiddenColumns&&r._isHiddenColumn(T)||S.push(r.hot.getDataAtCell(g,T))}),p.push(S))}),p}},{key:"getRowHeaders",value:function(){var r=this,n=[];if(this.options.rowHeaders){var i=this._getDataRange(),o=i.startRow,s=i.endRow,a=this.hot.getRowHeader();Er(o,s,function(h){!r.options.exportHiddenRows&&r._isHiddenRow(h)||n.push(a[h])})}return n}},{key:"getColumnHeaders",value:function(){var r=this,n=[];if(this.options.columnHeaders){var i=this._getDataRange(),o=i.startCol,s=i.endCol,a=this.hot.getColHeader();Er(o,s,function(h){!r.options.exportHiddenColumns&&r._isHiddenColumn(h)||n.push(a[h])})}return n}},{key:"_getDataRange",value:function(){var r=this.hot.countCols()-1,n=this.hot.countRows()-1,i=unt(this.options.range,4),o=i[0],s=o===void 0?0:o,a=i[1],h=a===void 0?0:a,p=i[2],g=p===void 0?n:p,S=i[3],T=S===void 0?r:S;return s=Math.max(s,0),h=Math.max(h,0),g=Math.min(g,n),T=Math.min(T,r),{startRow:s,startCol:h,endRow:g,endCol:T}}},{key:"_isHiddenRow",value:function(r){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(r))}},{key:"_isHiddenColumn",value:function(r){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(r))}}]),e}();const _nt=vnt;function ex(e){"@babel/helpers - typeof";return ex=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ex(e)}function bnt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function NX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Snt(n.key),n)}}function wnt(e,t,r){return t&&NX(e.prototype,t),r&&NX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Snt(e){var t=xnt(e,"string");return ex(t)==="symbol"?t:String(t)}function xnt(e,t){if(ex(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ex(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Cnt=function(){function e(t,r){bnt(this,e),this.dataProvider=t,this.options=this._mergeOptions(r),this.dataProvider.setOptions(this.options)}return wnt(e,[{key:"_mergeOptions",value:function(r){var n=Na(this.constructor.DEFAULT_OPTIONS),i=new Date;return n=ao(Na(e.DEFAULT_OPTIONS),n),n=ao(n,r),n.filename=Woe(n.filename,{YYYY:i.getFullYear(),MM:"".concat(i.getMonth()+1).padStart(2,"0"),DD:"".concat(i.getDate()).padStart(2,"0")}),n}}],[{key:"DEFAULT_OPTIONS",get:function(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}}]),e}();const Ent=Cnt;function Kv(e){"@babel/helpers - typeof";return Kv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Kv(e)}function Tnt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function BX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Rnt(n.key),n)}}function Ont(e,t,r){return t&&BX(e.prototype,t),r&&BX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Rnt(e){var t=knt(e,"string");return Kv(t)==="symbol"?t:String(t)}function knt(e,t){if(Kv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Kv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Pnt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&bj(e,t)}function bj(e,t){return bj=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},bj(e,t)}function Ant(e){var t=Dnt();return function(){var n=hP(e),i;if(t){var o=hP(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Int(this,i)}}function Int(e,t){if(t&&(Kv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Mnt(e)}function Mnt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Dnt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function hP(e){return hP=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},hP(e)}var $nt=String.fromCharCode(13),Lnt=String.fromCharCode(34),Nnt=String.fromCharCode(10),Bnt=function(e){Pnt(r,e);var t=Ant(r);function r(){return Tnt(this,r),t.apply(this,arguments)}return Ont(r,[{key:"export",value:function(){var i=this,o=this.options,s=this.dataProvider.getData(),a=this.dataProvider.getColumnHeaders(),h=a.length>0,p=this.dataProvider.getRowHeaders(),g=p.length>0,S=o.bom?String.fromCharCode(65279):"";return h&&(a=hn(a,function(T){return i._escapeCell(T,!0)}),g&&(S+=o.columnDelimiter),S+=a.join(o.columnDelimiter),S+=o.rowDelimiter),Le(s,function(T,R){R>0&&(S+=o.rowDelimiter),g&&(S+=i._escapeCell(p[R])+o.columnDelimiter),S+=T.map(function(A){return i._escapeCell(A)}).join(o.columnDelimiter)}),S}},{key:"_escapeCell",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,s=Xi(i);return s!==""&&(o||s.indexOf($nt)>=0||s.indexOf(Lnt)>=0||s.indexOf(Nnt)>=0||s.indexOf(this.options.columnDelimiter)>=0)&&(s=s.replace(new RegExp('"',"g"),'""'),s='"'.concat(s,'"')),s}}],[{key:"DEFAULT_OPTIONS",get:function(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:`\r
`}}}]),r}(Ent);const jnt=Bnt;function tx(e){"@babel/helpers - typeof";return tx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tx(e)}function znt(e,t,r){return t=Fnt(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Fnt(e){var t=Hnt(e,"string");return tx(t)==="symbol"?t:String(t)}function Hnt(e,t){if(tx(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(tx(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Vnt="csv",wj=znt({},Vnt,jnt);function Unt(e,t,r){return typeof wj[e]=="function"?new wj[e](t,r):null}function qv(e){"@babel/helpers - typeof";return qv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qv(e)}function Wnt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ynt(n.key),n)}}function Gnt(e,t,r){return t&&jX(e.prototype,t),r&&jX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ynt(e){var t=Knt(e,"string");return qv(t)==="symbol"?t:String(t)}function Knt(e,t){if(qv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(qv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function qnt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Sj(e,t)}function Sj(e,t){return Sj=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Sj(e,t)}function Xnt(e){var t=Qnt();return function(){var n=dP(e),i;if(t){var o=dP(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Znt(this,i)}}function Znt(e,t){if(t&&(qv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Jnt(e)}function Jnt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Qnt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function dP(e){return dP=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},dP(e)}var eit="exportFile",tit=240,rit=function(e){qnt(r,e);var t=Xnt(r);function r(){return Wnt(this,r),t.apply(this,arguments)}return Gnt(r,[{key:"isEnabled",value:function(){return!0}},{key:"exportAsString",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createTypeFormatter(i,o).export()}},{key:"exportAsBlob",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createBlob(this._createTypeFormatter(i,o))}},{key:"downloadFile",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=this.hot,a=s.rootDocument,h=s.rootWindow,p=this._createTypeFormatter(i,o),g=this._createBlob(p),S=h.URL||h.webkitURL,T=a.createElement("a"),R="".concat(p.options.filename,".").concat(p.options.fileExtension);if(T.download!==void 0){var A=S.createObjectURL(g);T.style.display="none",T.setAttribute("href",A),T.setAttribute("download",R),a.body.appendChild(T),T.dispatchEvent(new MouseEvent("click")),a.body.removeChild(T),setTimeout(function(){S.revokeObjectURL(A)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(g,R)}},{key:"_createTypeFormatter",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!wj[i])throw new Error('Export format type "'.concat(i,'" is not supported.'));return Unt(i,new _nt(this.hot),o)}},{key:"_createBlob",value:function(i){var o=null;return typeof Blob<"u"&&(o=new Blob([i.export()],{type:"".concat(i.options.mimeType,";charset=").concat(i.options.encoding)})),o}}],[{key:"PLUGIN_KEY",get:function(){return eit}},{key:"PLUGIN_PRIORITY",get:function(){return tit}}]),r}(Wn);function rx(e){"@babel/helpers - typeof";return rx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rx(e)}function nit(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function zX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,oit(n.key),n)}}function iit(e,t,r){return t&&zX(e.prototype,t),r&&zX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function oit(e){var t=ait(e,"string");return rx(t)==="symbol"?t:String(t)}function ait(e,t){if(rx(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(rx(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Xle=function(){function e(t,r){var n=r.id,i=r.stateless,o=i===void 0?!0:i;nit(this,e),this.hot=t,this.id=n,this.elements=[],this.hidden=!1,this.stateId="Filters.component.".concat(this.id),this.state=o?null:this.hot.columnIndexMapper.registerMap(this.stateId,new LA)}return iit(e,[{key:"reset",value:function(){Le(this.elements,function(r){return r.reset()})}},{key:"hide",value:function(){this.hidden=!0}},{key:"show",value:function(){this.hidden=!1}},{key:"isHidden",value:function(){return this.hot===null||this.hidden}},{key:"restoreState",value:function(r){this.state&&this.setState(this.state.getValueAtIndex(r))}},{key:"setState",value:function(){throw new Error("The state setting logic is not implemented")}},{key:"saveState",value:function(r){this.state&&this.state.setValueAtIndex(r,this.getState())}},{key:"getState",value:function(){throw new Error("The state gathering logic is not implemented")}},{key:"destroy",value:function(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),Le(this.elements,function(r){return r.destroy()}),this.state=null,this.elements=null,this.hot=null}}]),e}();li(Xle,Va);const QA=Xle;var nx={};function mh(e,t){if(!nx[e])throw Error('Filter condition "'.concat(e,'" does not exist.'));var r=nx[e],n=r.condition,i=r.descriptor,o=t;return i.inputValuesDecorator&&(o=i.inputValuesDecorator(o)),function(s){return n.apply(s.meta.instance,[].concat([s],[o]))}}function np(e){if(!nx[e])throw Error('Filter condition "'.concat(e,'" does not exist.'));return nx[e].descriptor}function eo(e,t,r){r.key=e,nx[e]={condition:t,descriptor:r}}var Oo="none";function sit(){return!0}eo(Oo,sit,{name:BA,inputsCount:0,showOperators:!1});var X0="empty";function lit(e){return go(e.value)}eo(X0,lit,{name:kV,inputsCount:0,showOperators:!0});var SR="not_empty";function uit(e,t){return!mh(X0,t)(e)}eo(SR,uit,{name:PV,inputsCount:0,showOperators:!0});function cit(e,t){return pit(e)||dit(e,t)||hit(e,t)||fit()}function fit(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function hit(e,t){if(e){if(typeof e=="string")return FX(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return FX(e,t)}}function FX(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function dit(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],h=!0,p=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;h=!1}else for(;!(h=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);h=!0);}catch(g){p=!0,i=g}finally{try{if(!h&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(p)throw i}}return a}}function pit(e){if(Array.isArray(e))return e}var Z0="eq";function mit(e,t){var r=cit(t,1),n=r[0];return Xi(e.value).toLocaleLowerCase(e.meta.locale)===Xi(n)}eo(Z0,mit,{name:AV,inputsCount:1,showOperators:!0});var xR="neq";function yit(e,t){return!mh(Z0,t)(e)}eo(xR,yit,{name:IV,inputsCount:1,showOperators:!0});function git(e,t){return wit(e)||bit(e,t)||_it(e,t)||vit()}function vit(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _it(e,t){if(e){if(typeof e=="string")return HX(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return HX(e,t)}}function HX(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function bit(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],h=!0,p=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;h=!1}else for(;!(h=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);h=!0);}catch(g){p=!0,i=g}finally{try{if(!h&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(p)throw i}}return a}}function wit(e){if(Array.isArray(e))return e}var Zle="gt";function Sit(e,t){var r=git(t,1),n=r[0],i=n;return e.meta.type==="numeric"&&(i=parseFloat(i,10)),e.value>i}eo(Zle,Sit,{name:NV,inputsCount:1,showOperators:!0});function xit(e,t){return Oit(e)||Tit(e,t)||Eit(e,t)||Cit()}function Cit(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Eit(e,t){if(e){if(typeof e=="string")return VX(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return VX(e,t)}}function VX(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Tit(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],h=!0,p=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;h=!1}else for(;!(h=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);h=!0);}catch(g){p=!0,i=g}finally{try{if(!h&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(p)throw i}}return a}}function Oit(e){if(Array.isArray(e))return e}var Jle="gte";function Rit(e,t){var r=xit(t,1),n=r[0],i=n;return e.meta.type==="numeric"&&(i=parseFloat(i,10)),e.value>=i}eo(Jle,Rit,{name:BV,inputsCount:1,showOperators:!0});function kit(e,t){return Mit(e)||Iit(e,t)||Ait(e,t)||Pit()}function Pit(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ait(e,t){if(e){if(typeof e=="string")return UX(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return UX(e,t)}}function UX(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Iit(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],h=!0,p=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;h=!1}else for(;!(h=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);h=!0);}catch(g){p=!0,i=g}finally{try{if(!h&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(p)throw i}}return a}}function Mit(e){if(Array.isArray(e))return e}var Qle="lt";function Dit(e,t){var r=kit(t,1),n=r[0],i=n;return e.meta.type==="numeric"&&(i=parseFloat(i,10)),e.value<i}eo(Qle,Dit,{name:jV,inputsCount:1,showOperators:!0});function $it(e,t){return jit(e)||Bit(e,t)||Nit(e,t)||Lit()}function Lit(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Nit(e,t){if(e){if(typeof e=="string")return WX(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return WX(e,t)}}function WX(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Bit(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],h=!0,p=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;h=!1}else for(;!(h=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);h=!0);}catch(g){p=!0,i=g}finally{try{if(!h&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(p)throw i}}return a}}function jit(e){if(Array.isArray(e))return e}var eue="lte";function zit(e,t){var r=$it(t,1),n=r[0],i=n;return e.meta.type==="numeric"&&(i=parseFloat(i,10)),e.value<=i}eo(eue,zit,{name:zV,inputsCount:1,showOperators:!0});function Fit(e,t){return Wit(e)||Uit(e,t)||Vit(e,t)||Hit()}function Hit(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Vit(e,t){if(e){if(typeof e=="string")return GX(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return GX(e,t)}}function GX(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Uit(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],h=!0,p=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;h=!1}else for(;!(h=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);h=!0);}catch(g){p=!0,i=g}finally{try{if(!h&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(p)throw i}}return a}}function Wit(e){if(Array.isArray(e))return e}var dU="date_after";function Git(e,t){var r=Fit(t,1),n=r[0],i=Vt(e.value,e.meta.dateFormat),o=Vt(n,e.meta.dateFormat);return!i.isValid()||!o.isValid()?!1:i.diff(o)>=0}eo(dU,Git,{name:VV,inputsCount:1,showOperators:!0});function Yit(e,t){return Zit(e)||Xit(e,t)||qit(e,t)||Kit()}function Kit(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function qit(e,t){if(e){if(typeof e=="string")return YX(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return YX(e,t)}}function YX(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Xit(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],h=!0,p=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;h=!1}else for(;!(h=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);h=!0);}catch(g){p=!0,i=g}finally{try{if(!h&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(p)throw i}}return a}}function Zit(e){if(Array.isArray(e))return e}var pU="date_before";function Jit(e,t){var r=Yit(t,1),n=r[0],i=Vt(e.value,e.meta.dateFormat),o=Vt(n,e.meta.dateFormat);return!i.isValid()||!o.isValid()?!1:i.diff(o)<=0}eo(pU,Jit,{name:UV,inputsCount:1,showOperators:!0});function Qit(e,t){return not(e)||rot(e,t)||tot(e,t)||eot()}function eot(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function tot(e,t){if(e){if(typeof e=="string")return KX(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return KX(e,t)}}function KX(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function rot(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],h=!0,p=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;h=!1}else for(;!(h=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);h=!0);}catch(g){p=!0,i=g}finally{try{if(!h&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(p)throw i}}return a}}function not(e){if(Array.isArray(e))return e}var pP="between";function iot(e,t){var r=Qit(t,2),n=r[0],i=r[1],o=n,s=i;if(e.meta.type==="numeric"){var a=parseFloat(o,10),h=parseFloat(s,10);o=Math.min(a,h),s=Math.max(a,h)}else if(e.meta.type==="date"){var p=mh(pU,[s]),g=mh(dU,[o]);return p(e)&&g(e)}return e.value>=o&&e.value<=s}eo(pP,iot,{name:FV,inputsCount:2,showOperators:!0});var tue="not_between";function oot(e,t){return!mh(pP,t)(e)}eo(tue,oot,{name:HV,inputsCount:2,showOperators:!0});function aot(e,t){return cot(e)||uot(e,t)||lot(e,t)||sot()}function sot(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function lot(e,t){if(e){if(typeof e=="string")return qX(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return qX(e,t)}}function qX(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function uot(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],h=!0,p=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;h=!1}else for(;!(h=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);h=!0);}catch(g){p=!0,i=g}finally{try{if(!h&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(p)throw i}}return a}}function cot(e){if(Array.isArray(e))return e}var rue="begins_with";function fot(e,t){var r=aot(t,1),n=r[0];return Xi(e.value).toLocaleLowerCase(e.meta.locale).startsWith(Xi(n))}eo(rue,fot,{name:MV,inputsCount:1,showOperators:!0});var hot=Br,nue=Zx,dot=fu.f,pot=Zp,XX=Qi,mot=KH,yot=Fa,got=qH,ZX=nue("".endsWith),vot=nue("".slice),_ot=Math.min,iue=got("endsWith"),bot=!iue&&!!function(){var e=dot(String.prototype,"endsWith");return e&&!e.writable}();hot({target:"String",proto:!0,forced:!bot&&!iue},{endsWith:function(t){var r=XX(yot(this));mot(t);var n=arguments.length>1?arguments[1]:void 0,i=r.length,o=n===void 0?i:_ot(pot(n),i),s=XX(t);return ZX?ZX(r,s,o):vot(r,o-s.length,o)===s}});function wot(e,t){return Eot(e)||Cot(e,t)||xot(e,t)||Sot()}function Sot(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function xot(e,t){if(e){if(typeof e=="string")return JX(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return JX(e,t)}}function JX(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Cot(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],h=!0,p=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;h=!1}else for(;!(h=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);h=!0);}catch(g){p=!0,i=g}finally{try{if(!h&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(p)throw i}}return a}}function Eot(e){if(Array.isArray(e))return e}var oue="ends_with";function Tot(e,t){var r=wot(t,1),n=r[0];return Xi(e.value).toLocaleLowerCase(e.meta.locale).endsWith(Xi(n))}eo(oue,Tot,{name:DV,inputsCount:1,showOperators:!0});function Oot(e,t){return Aot(e)||Pot(e,t)||kot(e,t)||Rot()}function Rot(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function kot(e,t){if(e){if(typeof e=="string")return QX(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return QX(e,t)}}function QX(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Pot(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],h=!0,p=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;h=!1}else for(;!(h=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);h=!0);}catch(g){p=!0,i=g}finally{try{if(!h&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(p)throw i}}return a}}function Aot(e){if(Array.isArray(e))return e}var mU="contains";function Iot(e,t){var r=Oot(t,1),n=r[0];return Xi(e.value).toLocaleLowerCase(e.meta.locale).indexOf(Xi(n))>=0}eo(mU,Iot,{name:$V,inputsCount:1,showOperators:!0});var aue="not_contains";function Mot(e,t){return!mh(mU,t)(e)}eo(aue,Mot,{name:LV,inputsCount:1,showOperators:!0});var sue="date_tomorrow";function Dot(e){var t=Vt(e.value,e.meta.dateFormat);return t.isValid()?t.isSame(Vt().subtract(-1,"days").startOf("day"),"d"):!1}eo(sue,Dot,{name:GV,inputsCount:0});var lue="date_today";function $ot(e){var t=Vt(e.value,e.meta.dateFormat);return t.isValid()?t.isSame(Vt().startOf("day"),"d"):!1}eo(lue,$ot,{name:WV,inputsCount:0});var uue="date_yesterday";function Lot(e){var t=Vt(e.value,e.meta.dateFormat);return t.isValid()?t.isSame(Vt().subtract(1,"days").startOf("day"),"d"):!1}eo(uue,Lot,{name:YV,inputsCount:0});C2e();function Not(e,t){var r=e;return r===""&&(r="(".concat(t,")")),r}var xj=new Set([1]).has(1),Bot=xj&&typeof Array.from=="function";function CC(e){var t=e;return xj&&(t=new Set(t)),function(r){var n;return xj?n=t.has(r):n=!!~t.indexOf(r),n}}function cue(e){return e??""}function Cj(e){var t=e;return Bot?t=Array.from(new Set(t)):t=Roe(t),t=t.sort(function(r,n){return typeof r=="number"&&typeof n=="number"?r-n:r===n?0:r>n?1:-1}),t}function eZ(e,t,r,n){var i=[],o=e===t,s;return o||(s=CC(t)),Le(e,function(a){var h=!1;(o||s(a))&&(h=!0);var p={checked:h,value:a,visualValue:Not(a,r)};n&&n(p),i.push(p)}),i}function fue(e,t){return Hot(e)||Fot(e,t)||zot(e,t)||jot()}function jot(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zot(e,t){if(e){if(typeof e=="string")return tZ(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return tZ(e,t)}}function tZ(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Fot(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],h=!0,p=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;h=!1}else for(;!(h=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);h=!0);}catch(g){p=!0,i=g}finally{try{if(!h&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(p)throw i}}return a}}function Hot(e){if(Array.isArray(e))return e}var ip="by_value";function Vot(e,t){var r=fue(t,1),n=r[0];return n(e.value)}eo(ip,Vot,{name:"By value",inputsCount:0,inputValuesDecorator:function(t){var r=fue(t,1),n=r[0];return[CC(n)]},showOperators:!1});var ix={};function Uot(e){if(!ix[e])throw Error('Operation with id "'.concat(e,'" does not exist.'));var t=ix[e].func;return function(r,n){return t(r,n)}}function Wot(e){return ix[e].name}function yU(e,t,r){ix[e]={name:t,func:r}}var oh="conjunction",Got=XV;function Yot(e,t){return e.every(function(r){return r.func(t)})}yU(oh,Got,Yot);var mP="disjunction",Kot=jA;function qot(e,t){return e.some(function(r){return r.func(t)})}yU(mP,Kot,qot);var gU="disjunctionWithExtraCondition",Xot=jA;function Zot(e,t){if(e.length<3)throw Error("Operation doesn't work on less then three conditions.");return e.slice(0,e.length-1).some(function(r){return r.func(t)})&&e[e.length-1].func(t)}yU(gU,Xot,Zot);function ox(e){"@babel/helpers - typeof";return ox=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ox(e)}var l0;function u2(e,t,r){return t=Jot(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Jot(e){var t=Qot(e,"string");return ox(t)==="symbol"?t:String(t)}function Qot(e,t){if(ox(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ox(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var eat="numeric",hue="text",tat="date",rZ=(l0={},u2(l0,eat,[Oo,fn,X0,SR,fn,Z0,xR,fn,Zle,Jle,Qle,eue,pP,tue]),u2(l0,hue,[Oo,fn,X0,SR,fn,Z0,xR,fn,rue,oue,fn,mU,aue]),u2(l0,tat,[Oo,fn,X0,SR,fn,Z0,xR,fn,pU,dU,pP,fn,sue,lue,uue]),l0);function rat(e){var t=[],r=e;return rZ[r]||(r=hue),Le(rZ[r],function(n){var i;n===fn?i={name:fn}:i=Na(np(n)),t.push(i)}),t}function ax(e){"@babel/helpers - typeof";return ax=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ax(e)}function nat(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function nZ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,oat(n.key),n)}}function iat(e,t,r){return t&&nZ(e.prototype,t),r&&nZ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function oat(e){var t=aat(e,"string");return ax(t)==="symbol"?t:String(t)}function aat(e,t){if(ax(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ax(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var c2="built",f2="building",iZ=["click","input","keydown","keypress","keyup","focus","blur","change"],due=function(){function e(t,r){nat(this,e),this.hot=t,this.eventManager=new Bi(this),this.options=ao(e.DEFAULTS,r),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName),this.buildState=null}return iat(e,[{key:"setValue",value:function(r){this.options.value=r,this.update()}},{key:"getValue",value:function(){return this.options.value}},{key:"element",get:function(){return this.buildState===f2?this._element:this.buildState===c2?(this.update(),this._element):(this.buildState=f2,this.build(),this.buildState=c2,this._element)}},{key:"isBuilt",value:function(){return this.buildState===c2}},{key:"translateIfPossible",value:function(r){return typeof r=="string"&&r.startsWith(wa)?this.hot.getTranslatedPhrase(r):r}},{key:"build",value:function(){var r=this,n=function(s,a){r.eventManager.addEventListener(s,a,function(h){return r.runLocalHooks(a,h,r)})};if(this.buildState||(this.buildState=f2),this.options.className&&Ht(this._element,this.options.className),this.options.children.length)Le(this.options.children,function(o){return r._element.appendChild(o.element)});else if(this.options.wrapIt){var i=this.hot.rootDocument.createElement(this.options.tagName);pn(this.options,function(o,s){i[s]!==void 0&&s!=="className"&&s!=="tagName"&&s!=="children"&&(i[s]=r.translateIfPossible(o))}),this._element.appendChild(i),Le(iZ,function(o){return n(i,o)})}else Le(iZ,function(o){return n(r._element,o)})}},{key:"update",value:function(){}},{key:"reset",value:function(){this.options.value="",this.update()}},{key:"show",value:function(){this.element.style.display=""}},{key:"hide",value:function(){this.element.style.display="none"}},{key:"focus",value:function(){}},{key:"destroy",value:function(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}}],[{key:"DEFAULTS",get:function(){return Na({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}}]),e}();li(due,Va);const ah=due;function Xv(e){"@babel/helpers - typeof";return Xv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xv(e)}function sat(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function oZ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,uat(n.key),n)}}function lat(e,t,r){return t&&oZ(e.prototype,t),r&&oZ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function uat(e){var t=cat(e,"string");return Xv(t)==="symbol"?t:String(t)}function cat(e,t){if(Xv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Xv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function CR(){return typeof Reflect<"u"&&Reflect.get?CR=Reflect.get.bind():CR=function(t,r,n){var i=fat(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},CR.apply(this,arguments)}function fat(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Zv(e),e!==null););return e}function hat(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ej(e,t)}function Ej(e,t){return Ej=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Ej(e,t)}function dat(e){var t=mat();return function(){var n=Zv(e),i;if(t){var o=Zv(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return pat(this,i)}}function pat(e,t){if(t&&(Xv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return pue(e)}function pue(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function mat(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Zv(e){return Zv=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Zv(e)}var xO=new WeakMap,yat=function(e){hat(r,e);var t=dat(r);function r(n,i){var o;return sat(this,r),o=t.call(this,n,ao(r.DEFAULTS,i)),xO.set(pue(o),{}),o.registerHooks(),o}return lat(r,[{key:"registerHooks",value:function(){var i=this;this.addLocalHook("click",function(){return i.onClick()}),this.addLocalHook("keyup",function(o){return i.onKeyup(o)})}},{key:"build",value:function(){CR(Zv(r.prototype),"build",this).call(this);var i=xO.get(this),o=this.hot.rootDocument.createElement("div");i.input=this._element.firstChild,Ht(this._element,"htUIInput"),Ht(o,"htUIInputIcon"),this._element.appendChild(o),this.update()}},{key:"update",value:function(){if(this.isBuilt()){var i=xO.get(this).input;i.type=this.options.type,i.placeholder=this.translateIfPossible(this.options.placeholder),i.value=this.translateIfPossible(this.options.value)}}},{key:"focus",value:function(){this.isBuilt()&&xO.get(this).input.focus()}},{key:"onClick",value:function(){}},{key:"onKeyup",value:function(i){this.options.value=i.target.value}}],[{key:"DEFAULTS",get:function(){return Na({placeholder:"",type:"text",tagName:"input"})}}]),r}(ah);const xg=yat;function Jv(e){"@babel/helpers - typeof";return Jv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jv(e)}function gat(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function aZ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_at(n.key),n)}}function vat(e,t,r){return t&&aZ(e.prototype,t),r&&aZ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _at(e){var t=bat(e,"string");return Jv(t)==="symbol"?t:String(t)}function bat(e,t){if(Jv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Jv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Cg(){return typeof Reflect<"u"&&Reflect.get?Cg=Reflect.get.bind():Cg=function(t,r,n){var i=wat(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Cg.apply(this,arguments)}function wat(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=sh(e),e!==null););return e}function Sat(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Tj(e,t)}function Tj(e,t){return Tj=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Tj(e,t)}function xat(e){var t=Eat();return function(){var n=sh(e),i;if(t){var o=sh(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Cat(this,i)}}function Cat(e,t){if(t&&(Jv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return mue(e)}function mue(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Eat(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function sh(e){return sh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},sh(e)}var CO=new WeakMap,Tat=function(e){Sat(r,e);var t=xat(r);function r(n,i){var o;return gat(this,r),o=t.call(this,n,ao(r.DEFAULTS,i)),CO.set(mue(o),{}),o.menu=null,o.items=[],o.registerHooks(),o}return vat(r,[{key:"registerHooks",value:function(){var i=this;this.addLocalHook("click",function(){return i.onClick()})}},{key:"setItems",value:function(i){this.items=this.translateNames(i),this.menu&&this.menu.setMenuItems(this.items)}},{key:"translateNames",value:function(i){var o=this;return Le(i,function(s){s.name=o.translateIfPossible(s.name)}),i}},{key:"build",value:function(){var i=this;Cg(sh(r.prototype),"build",this).call(this),this.menu=new fU(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer}),this.menu.setMenuItems(this.items);var o=new ah(this.hot,{className:"htUISelectCaption"}),s=new ah(this.hot,{className:"htUISelectDropdown"}),a=CO.get(this);a.caption=o,a.captionElement=o.element,a.dropdown=s,Le([o,s],function(h){return i._element.appendChild(h.element)}),this.menu.addLocalHook("select",function(h){return i.onMenuSelect(h)}),this.menu.addLocalHook("afterClose",function(){return i.onMenuClosed()}),this.update()}},{key:"update",value:function(){if(this.isBuilt()){var i;this.options.value?i=this.options.value.name:i=this.menu.hot.getTranslatedPhrase(BA),CO.get(this).captionElement.textContent=i,Cg(sh(r.prototype),"update",this).call(this)}}},{key:"openOptions",value:function(){var i=this.element.getBoundingClientRect();this.menu&&(this.menu.open(),this.menu.setPosition({left:this.hot.isLtr()?i.left-5:i.left-31,top:i.top-1,width:i.width,height:i.height}))}},{key:"closeOptions",value:function(){this.menu&&this.menu.close()}},{key:"onMenuSelect",value:function(i){i.name!==fn&&(this.options.value=i,this.update(),this.runLocalHooks("select",this.options.value))}},{key:"onMenuClosed",value:function(){this.runLocalHooks("afterClose")}},{key:"onClick",value:function(){this.openOptions()}},{key:"destroy",value:function(){this.menu&&(this.menu.destroy(),this.menu=null);var i=CO.get(this),o=i.caption,s=i.dropdown;o&&o.destroy(),s&&s.destroy(),Cg(sh(r.prototype),"destroy",this).call(this)}}],[{key:"DEFAULTS",get:function(){return Na({className:"htUISelect",wrapIt:!1})}}]),r}(ah);const sZ=Tat;function Qv(e){"@babel/helpers - typeof";return Qv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qv(e)}function Oat(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function lZ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,kat(n.key),n)}}function Rat(e,t,r){return t&&lZ(e.prototype,t),r&&lZ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function kat(e){var t=Pat(e,"string");return Qv(t)==="symbol"?t:String(t)}function Pat(e,t){if(Qv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Qv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ER(){return typeof Reflect<"u"&&Reflect.get?ER=Reflect.get.bind():ER=function(t,r,n){var i=Aat(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},ER.apply(this,arguments)}function Aat(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=e_(e),e!==null););return e}function Iat(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Oj(e,t)}function Oj(e,t){return Oj=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Oj(e,t)}function Mat(e){var t=Lat();return function(){var n=e_(e),i;if(t){var o=e_(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Dat(this,i)}}function Dat(e,t){if(t&&(Qv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return $at(e)}function $at(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Lat(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function e_(e){return e_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},e_(e)}var Nat=function(e){Iat(r,e);var t=Mat(r);function r(n,i){var o;return Oat(this,r),o=t.call(this,n,{id:i.id,stateless:!1}),o.name=i.name,o.addSeparator=i.addSeparator,o.elements.push(new sZ(o.hot,{menuContainer:i.menuContainer})),o.elements.push(new xg(o.hot,{placeholder:rU})),o.elements.push(new xg(o.hot,{placeholder:nU})),o.registerHooks(),o}return Rat(r,[{key:"registerHooks",value:function(){var i=this;this.getSelectElement().addLocalHook("select",function(o){return i.onConditionSelect(o)}),this.getSelectElement().addLocalHook("afterClose",function(){return i.onSelectUIClosed()}),Le(this.getInputElements(),function(o){o.addLocalHook("keydown",function(s){return i.onInputKeyDown(s)})})}},{key:"setState",value:function(i){var o=this;if(this.reset(),!!i){var s=Na(i.command);s.name.startsWith(ji)&&(s.name=this.hot.getTranslatedPhrase(s.name)),this.getSelectElement().setValue(s),Le(i.args,function(a,h){if(h>s.inputsCount-1)return!1;var p=o.getInputElement(h);p.setValue(a),p[s.inputsCount>h?"show":"hide"](),h||setTimeout(function(){return p.focus()},10)})}}},{key:"getState",value:function(){var i=this.getSelectElement().getValue()||np(Oo),o=[];return Le(this.getInputElements(),function(s,a){i.inputsCount>a&&o.push(s.getValue())}),{command:i,args:o}}},{key:"updateState",value:function(i,o){var s=np(i?i.name:Oo);this.state.setValueAtIndex(o,{command:s,args:i?i.args:[]}),i||Le(this.getInputElements(),function(a){return a.setValue(null)})}},{key:"getSelectElement",value:function(){return this.elements.filter(function(i){return i instanceof sZ})[0]}},{key:"getInputElement",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.getInputElements()[i]}},{key:"getInputElements",value:function(){return this.elements.filter(function(i){return i instanceof xg})}},{key:"getMenuItemDescriptor",value:function(){var i=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return i.isHidden()},renderer:function(s,a,h,p,g,S){Ht(a.parentNode,"htFiltersMenuCondition"),i.addSeparator&&Ht(a.parentNode,"border");var T=i.hot.rootDocument.createElement("div");return Ht(T,"htFiltersMenuLabel"),T.textContent=S,a.appendChild(T),a.parentNode.hasAttribute("ghost-table")||Le(i.elements,function(R){return a.appendChild(R.element)}),a}}}},{key:"reset",value:function(){var i=this.hot.getPlugin("filters").getSelectedColumn(),o=[np(Oo)];if(i!==null){var s=i.visualIndex;o=rat(this.hot.getDataType(0,s,this.hot.countRows(),s))}Le(this.getInputElements(),function(a){return a.hide()}),this.getSelectElement().setItems(o),ER(e_(r.prototype),"reset",this).call(this),this.getSelectElement().setValue(o[0])}},{key:"onConditionSelect",value:function(i){Le(this.getInputElements(),function(o,s){o[i.inputsCount>s?"show":"hide"](),s===0&&setTimeout(function(){return o.focus()},10)}),this.runLocalHooks("change",i)}},{key:"onSelectUIClosed",value:function(){this.runLocalHooks("afterClose")}},{key:"onInputKeyDown",value:function(i){TS(i.keyCode,"ENTER")?(this.runLocalHooks("accept"),lu(i)):TS(i.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),lu(i))}}]),r}(QA);const h2=Nat;function t_(e){"@babel/helpers - typeof";return t_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t_(e)}function Bat(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function uZ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,zat(n.key),n)}}function jat(e,t,r){return t&&uZ(e.prototype,t),r&&uZ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function zat(e){var t=Fat(e,"string");return t_(t)==="symbol"?t:String(t)}function Fat(e,t){if(t_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(t_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function TR(){return typeof Reflect<"u"&&Reflect.get?TR=Reflect.get.bind():TR=function(t,r,n){var i=Hat(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},TR.apply(this,arguments)}function Hat(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=r_(e),e!==null););return e}function Vat(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Rj(e,t)}function Rj(e,t){return Rj=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Rj(e,t)}function Uat(e){var t=Gat();return function(){var n=r_(e),i;if(t){var o=r_(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Wat(this,i)}}function Wat(e,t){if(t&&(t_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return yue(e)}function yue(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Gat(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function r_(e){return r_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},r_(e)}var EO=new WeakMap,Yat=function(e){Vat(r,e);var t=Uat(r);function r(n,i){var o;return Bat(this,r),o=t.call(this,n,ao(r.DEFAULTS,i)),EO.set(yue(o),{}),o}return jat(r,[{key:"build",value:function(){TR(r_(r.prototype),"build",this).call(this);var i=EO.get(this);i.input=this._element.firstChild;var o=this.hot.rootDocument.createElement("label");o.textContent=this.translateIfPossible(this.options.label.textContent),o.htmlFor=this.translateIfPossible(this.options.label.htmlFor),i.label=o,this._element.appendChild(o),this.update()}},{key:"update",value:function(){if(this.isBuilt()){var i=EO.get(this);i.input.checked=this.options.checked,i.label.textContent=this.translateIfPossible(this.options.label.textContent)}}},{key:"isChecked",value:function(){return this.options.checked}},{key:"setChecked",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.options.checked=i,this.update()}},{key:"focus",value:function(){this.isBuilt()&&EO.get(this).input.focus()}}],[{key:"DEFAULTS",get:function(){return Na({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}}]),r}(ah);const cZ=Yat;function n_(e){"@babel/helpers - typeof";return n_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n_(e)}var fZ;function Kat(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function qat(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function hZ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Zat(n.key),n)}}function Xat(e,t,r){return t&&hZ(e.prototype,t),r&&hZ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Zat(e){var t=Jat(e,"string");return n_(t)==="symbol"?t:String(t)}function Jat(e,t){if(n_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(n_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Qat(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&kj(e,t)}function kj(e,t){return kj=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},kj(e,t)}function est(e){var t=nst();return function(){var n=yP(e),i;if(t){var o=yP(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return tst(this,i)}}function tst(e,t){if(t&&(n_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return rst(e)}function rst(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function nst(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function yP(e){return yP=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},yP(e)}var dZ=0,ist=function(e){Qat(r,e);var t=est(r);function r(n,i){var o;return qat(this,r),o=t.call(this,n,{id:i.id,stateless:!1}),o.name=i.name,o.buildOperatorsElement(),o}return Xat(r,[{key:"getMenuItemDescriptor",value:function(){var i=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return i.isHidden()},renderer:function(s,a){return Ht(a.parentNode,"htFiltersMenuOperators"),a.parentNode.hasAttribute("ghost-table")||Le(i.elements,function(h){return a.appendChild(h.element)}),a}}}},{key:"buildOperatorsElement",value:function(){var i=this,o=[oh,mP];Le(o,function(s){var a=new cZ(i.hot,{name:"operator",label:{htmlFor:s,textContent:Wot(s)},value:s,checked:s===o[dZ],id:s});a.addLocalHook("change",function(h){return i.onRadioInputChange(h)}),i.elements.push(a)})}},{key:"setChecked",value:function(i){if(this.elements.length<i)throw Error(Xn(fZ||(fZ=Kat(["Radio button with index "," doesn't exist."])),i));Le(this.elements,function(o,s){o.setChecked(s===i)})}},{key:"getActiveOperationId",value:function(){var i=this.elements.find(function(o){return o instanceof cZ&&o.isChecked()});return i?i.getValue():oh}},{key:"getState",value:function(){return this.getActiveOperationId()}},{key:"setState",value:function(i){this.reset(),i&&this.getActiveOperationId()!==i&&Le(this.elements,function(o){o.setChecked(o.getValue()===i)})}},{key:"updateState",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:oh,o=arguments.length>1?arguments[1]:void 0,s=i;s===gU&&(s=mP),this.state.setValueAtIndex(o,s)}},{key:"reset",value:function(){this.setChecked(dZ)}},{key:"onRadioInputChange",value:function(i){this.setState(i.target.value)}}]),r}(QA);const ost=ist;var ast=an,sst=Fa,pZ=Qi,lst=/"/g,ust=ast("".replace),cst=function(e,t,r,n){var i=pZ(sst(e)),o="<"+t;return r!==""&&(o+=" "+r+'="'+ust(pZ(n),lst,"&quot;")+'"'),o+">"+i+"</"+t+">"},fst=nn,hst=function(e){return fst(function(){var t=""[e]('"');return t!==t.toLowerCase()||t.split('"').length>3})},dst=Br,pst=cst,mst=hst;dst({target:"String",proto:!0,forced:mst("link")},{link:function(t){return pst(this,"a","href",t)}});function i_(e){"@babel/helpers - typeof";return i_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i_(e)}function yst(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mZ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,vst(n.key),n)}}function gst(e,t,r){return t&&mZ(e.prototype,t),r&&mZ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function vst(e){var t=_st(e,"string");return i_(t)==="symbol"?t:String(t)}function _st(e,t){if(i_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(i_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function OR(){return typeof Reflect<"u"&&Reflect.get?OR=Reflect.get.bind():OR=function(t,r,n){var i=bst(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},OR.apply(this,arguments)}function bst(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=o_(e),e!==null););return e}function wst(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Pj(e,t)}function Pj(e,t){return Pj=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Pj(e,t)}function Sst(e){var t=Cst();return function(){var n=o_(e),i;if(t){var o=o_(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return xst(this,i)}}function xst(e,t){if(t&&(i_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return gue(e)}function gue(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Cst(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function o_(e){return o_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},o_(e)}var d2=new WeakMap,Est=function(e){wst(r,e);var t=Sst(r);function r(n,i){var o;return yst(this,r),o=t.call(this,n,ao(r.DEFAULTS,i)),d2.set(gue(o),{}),o}return gst(r,[{key:"build",value:function(){OR(o_(r.prototype),"build",this).call(this);var i=d2.get(this);i.link=this._element.firstChild}},{key:"update",value:function(){this.isBuilt()&&(d2.get(this).link.textContent=this.translateIfPossible(this.options.textContent))}}],[{key:"DEFAULTS",get:function(){return Na({href:"#",tagName:"a"})}}]),r}(ah);const yZ=Est;function a_(e){"@babel/helpers - typeof";return a_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a_(e)}function gZ(e){return kst(e)||Rst(e)||Ost(e)||Tst()}function Tst(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ost(e,t){if(e){if(typeof e=="string")return Aj(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Aj(e,t)}}function Rst(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function kst(e){if(Array.isArray(e))return Aj(e)}function Aj(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Pst(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function vZ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ist(n.key),n)}}function Ast(e,t,r){return t&&vZ(e.prototype,t),r&&vZ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ist(e){var t=Mst(e,"string");return a_(t)==="symbol"?t:String(t)}function Mst(e,t){if(a_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(a_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Eg(){return typeof Reflect<"u"&&Reflect.get?Eg=Reflect.get.bind():Eg=function(t,r,n){var i=Dst(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Eg.apply(this,arguments)}function Dst(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=lh(e),e!==null););return e}function $st(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ij(e,t)}function Ij(e,t){return Ij=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Ij(e,t)}function Lst(e){var t=Bst();return function(){var n=lh(e),i;if(t){var o=lh(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Nst(this,i)}}function Nst(e,t){if(t&&(a_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return vue(e)}function vue(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Bst(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function lh(e){return lh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},lh(e)}var jst=new WeakMap,zst="multipleSelect.itemBox",Fst=function(e){$st(r,e);var t=Lst(r);function r(n,i){var o;return Pst(this,r),o=t.call(this,n,ao(r.DEFAULTS,i)),jst.set(vue(o),{}),o.searchInput=new xg(o.hot,{placeholder:tU,className:"htUIMultipleSelectSearch"}),o.selectAllUI=new yZ(o.hot,{textContent:ZV,className:"htUISelectAll"}),o.clearAllUI=new yZ(o.hot,{textContent:JV,className:"htUIClearAll"}),o.items=[],o.itemsBox=null,o.registerHooks(),o}return Ast(r,[{key:"registerHooks",value:function(){var i=this;this.searchInput.addLocalHook("keydown",function(o){return i.onInputKeyDown(o)}),this.searchInput.addLocalHook("input",function(o){return i.onInput(o)}),this.selectAllUI.addLocalHook("click",function(o){return i.onSelectAllClick(o)}),this.clearAllUI.addLocalHook("click",function(o){return i.onClearAllClick(o)})}},{key:"setItems",value:function(i){this.items=i,this.itemsBox&&this.itemsBox.loadData(this.items)}},{key:"setLocale",value:function(i){this.locale=i}},{key:"getLocale",value:function(){return this.locale}},{key:"getItems",value:function(){return gZ(this.items)}},{key:"getValue",value:function(){return Vst(this.items)}},{key:"isSelectedAllValues",value:function(){return this.items.length===this.getValue().length}},{key:"build",value:function(){var i=this;Eg(lh(r.prototype),"build",this).call(this);var o=this.hot.rootDocument,s=o.createElement("div"),a=new ah(this.hot,{className:"htUISelectionControls",children:[this.selectAllUI,this.clearAllUI]});this._element.appendChild(this.searchInput.element),this._element.appendChild(a.element),this._element.appendChild(s);var h=function(g){if(i._element){i.itemsBox&&i.itemsBox.destroy(),Ht(g,"htUIMultipleSelectHot"),i.itemsBox=new i.hot.constructor(g,{data:i.items,columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:function(A,$,j,z,V,G){A.title=G.instance.getDataAtRowProp($,G.label.property)},maxCols:1,autoWrapCol:!0,height:110,colWidths:function(){return i.itemsBox.container.scrollWidth-Ao(o)},copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},layoutDirection:i.hot.isRtl()?"rtl":"ltr"}),i.itemsBox.init();var S=i.itemsBox.getShortcutManager(),T=S.getContext("grid");T.addShortcut({keys:[["Escape"]],callback:function(A){i.runLocalHooks("keydown",A,i)},group:zst})}};h(s),setTimeout(function(){return h(s)},100)}},{key:"reset",value:function(){this.searchInput.reset(),this.selectAllUI.reset(),this.clearAllUI.reset()}},{key:"update",value:function(){this.isBuilt()&&(this.itemsBox.loadData(Hst(this.items,this.options.value)),Eg(lh(r.prototype),"update",this).call(this))}},{key:"destroy",value:function(){this.itemsBox&&this.itemsBox.destroy(),this.searchInput.destroy(),this.clearAllUI.destroy(),this.selectAllUI.destroy(),this.searchInput=null,this.clearAllUI=null,this.selectAllUI=null,this.itemsBox=null,this.items=null,Eg(lh(r.prototype),"destroy",this).call(this)}},{key:"onInput",value:function(i){var o=this,s=i.target.value.toLocaleLowerCase(this.getLocale()),a;s===""?a=gZ(this.items):a=$s(this.items,function(h){return"".concat(h.value).toLocaleLowerCase(o.getLocale()).indexOf(s)>=0}),this.itemsBox.loadData(a)}},{key:"onInputKeyDown",value:function(i){this.runLocalHooks("keydown",i,this);var o=eae(TS,i.keyCode);o("ARROW_DOWN|TAB")&&!this.itemsBox.isListening()&&(lu(i),this.itemsBox.listen(),this.itemsBox.selectCell(0,0))}},{key:"onSelectAllClick",value:function(i){var o=[];i.preventDefault(),Le(this.itemsBox.getSourceData(),function(s,a){s.checked=!0,o.push(_7(s,a)[0])}),this.itemsBox.setSourceDataAtCell(o)}},{key:"onClearAllClick",value:function(i){var o=[];i.preventDefault(),Le(this.itemsBox.getSourceData(),function(s,a){s.checked=!1,o.push(_7(s,a)[0])}),this.itemsBox.setSourceDataAtCell(o)}}],[{key:"DEFAULTS",get:function(){return Na({className:"htUIMultipleSelect",value:[]})}}]),r}(ah);const _Z=Fst;function Hst(e,t){var r=CC(t);return hn(e,function(n){return n.checked=r(n.value),n})}function Vst(e){var t=[];return Le(e,function(r){r.checked&&t.push(r.value)}),t}function s_(e){"@babel/helpers - typeof";return s_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s_(e)}function Ust(e,t){return Kst(e)||Yst(e,t)||Gst(e,t)||Wst()}function Wst(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Gst(e,t){if(e){if(typeof e=="string")return bZ(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return bZ(e,t)}}function bZ(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Yst(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],h=!0,p=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;h=!1}else for(;!(h=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);h=!0);}catch(g){p=!0,i=g}finally{try{if(!h&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(p)throw i}}return a}}function Kst(e){if(Array.isArray(e))return e}function qst(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function wZ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Zst(n.key),n)}}function Xst(e,t,r){return t&&wZ(e.prototype,t),r&&wZ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Zst(e){var t=Jst(e,"string");return s_(t)==="symbol"?t:String(t)}function Jst(e,t){if(s_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(s_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function RR(){return typeof Reflect<"u"&&Reflect.get?RR=Reflect.get.bind():RR=function(t,r,n){var i=Qst(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},RR.apply(this,arguments)}function Qst(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=l_(e),e!==null););return e}function elt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Mj(e,t)}function Mj(e,t){return Mj=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Mj(e,t)}function tlt(e){var t=ilt();return function(){var n=l_(e),i;if(t){var o=l_(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return rlt(this,i)}}function rlt(e,t){if(t&&(s_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return nlt(e)}function nlt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ilt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function l_(e){return l_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},l_(e)}var olt=function(e){elt(r,e);var t=tlt(r);function r(n,i){var o;return qst(this,r),o=t.call(this,n,{id:i.id,stateless:!1}),o.name=i.name,o.elements.push(new _Z(o.hot)),o.registerHooks(),o}return Xst(r,[{key:"registerHooks",value:function(){var i=this;this.getMultipleSelectElement().addLocalHook("keydown",function(o){return i.onInputKeyDown(o)})}},{key:"setState",value:function(i){if(this.reset(),i&&i.command.key===ip){var o=this.getMultipleSelectElement();o.setItems(i.itemsSnapshot),o.setValue(i.args[0]),o.setLocale(i.locale)}}},{key:"getState",value:function(){var i=this.getMultipleSelectElement(),o=i.getItems();return{command:{key:i.isSelectedAllValues()||!o.length?Oo:ip},args:[i.getValue()],itemsSnapshot:o}}},{key:"updateState",value:function(i){var o=this,s=function(h,p,g,S,T){var R=$s(p,function(xe){return xe.name===ip}),A=Ust(R,1),$=A[0],j={},z=o.hot.getTranslatedPhrase(lP);if($){var V=Cj(hn(S(h,T),function(xe){return xe.value}));g&&($.args[0]=g);var G=[],ee=eZ(V,$.args[0],z,function(xe){xe.checked&&G.push(xe.value)}),K=i.editedConditionStack.column;j.locale=o.hot.getCellMeta(0,K).locale,j.args=[G],j.command=np(ip),j.itemsSnapshot=ee}else j.args=[],j.command=np(Oo);o.state.setValueAtIndex(h,j)};s(i.editedConditionStack.column,i.editedConditionStack.conditions,i.conditionArgsChange,i.filteredRowsFactory),i.dependentConditionStacks.length&&s(i.dependentConditionStacks[0].column,i.dependentConditionStacks[0].conditions,i.conditionArgsChange,i.filteredRowsFactory,i.editedConditionStack)}},{key:"getMultipleSelectElement",value:function(){return this.elements.filter(function(i){return i instanceof _Z})[0]}},{key:"getMenuItemDescriptor",value:function(){var i=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return i.isHidden()},renderer:function(s,a,h,p,g,S){Ht(a.parentNode,"htFiltersMenuValue");var T=i.hot.rootDocument.createElement("div");return Ht(T,"htFiltersMenuLabel"),T.textContent=S,a.appendChild(T),a.parentNode.hasAttribute("ghost-table")||Le(i.elements,function(R){return a.appendChild(R.element)}),a}}}},{key:"reset",value:function(){var i=this.hot.getTranslatedPhrase(lP),o=Cj(this._getColumnVisibleValues()),s=eZ(o,o,i);this.getMultipleSelectElement().setItems(s),RR(l_(r.prototype),"reset",this).call(this),this.getMultipleSelectElement().setValue(o);var a=this.hot.getPlugin("filters").getSelectedColumn();a!==null&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,a.visualIndex).locale)}},{key:"onInputKeyDown",value:function(i){TS(i.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),lu(i))}},{key:"_getColumnVisibleValues",value:function(){var i=this.hot.getPlugin("filters").getSelectedColumn();return i===null?[]:hn(this.hot.getDataAtCol(i.visualIndex),function(o){return cue(o)})}}]),r}(QA);const alt=olt;function u_(e){"@babel/helpers - typeof";return u_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u_(e)}function slt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function SZ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ult(n.key),n)}}function llt(e,t,r){return t&&SZ(e.prototype,t),r&&SZ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ult(e){var t=clt(e,"string");return u_(t)==="symbol"?t:String(t)}function clt(e,t){if(u_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(u_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function flt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Dj(e,t)}function Dj(e,t){return Dj=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Dj(e,t)}function hlt(e){var t=mlt();return function(){var n=gP(e),i;if(t){var o=gP(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return dlt(this,i)}}function dlt(e,t){if(t&&(u_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return plt(e)}function plt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function mlt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function gP(e){return gP=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},gP(e)}var ylt=function(e){flt(r,e);var t=hlt(r);function r(n,i){var o;return slt(this,r),o=t.call(this,n,{id:i.id,stateless:!0}),o.name=i.name,o.elements.push(new xg(o.hot,{type:"button",value:QV,className:"htUIButton htUIButtonOK",identifier:r.BUTTON_OK})),o.elements.push(new xg(o.hot,{type:"button",value:eU,className:"htUIButton htUIButtonCancel",identifier:r.BUTTON_CANCEL})),o.registerHooks(),o}return llt(r,[{key:"registerHooks",value:function(){var i=this;Le(this.elements,function(o){o.addLocalHook("click",function(s,a){return i.onButtonClick(s,a)})})}},{key:"getMenuItemDescriptor",value:function(){var i=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return i.isHidden()},renderer:function(s,a){return Ht(a.parentNode,"htFiltersMenuActionBar"),a.parentNode.hasAttribute("ghost-table")||Le(i.elements,function(h){return a.appendChild(h.element)}),a}}}},{key:"accept",value:function(){this.runLocalHooks("accept")}},{key:"cancel",value:function(){this.runLocalHooks("cancel")}},{key:"onButtonClick",value:function(i,o){o.options.identifier===r.BUTTON_OK?this.accept():this.cancel()}}],[{key:"BUTTON_OK",get:function(){return"ok"}},{key:"BUTTON_CANCEL",get:function(){return"cancel"}}]),r}(QA);const glt=ylt;function sx(e){"@babel/helpers - typeof";return sx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sx(e)}var xZ,CZ;function EZ(e,t){return wlt(e)||blt(e,t)||_lt(e,t)||vlt()}function vlt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _lt(e,t){if(e){if(typeof e=="string")return TZ(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return TZ(e,t)}}function TZ(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function blt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],h=!0,p=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;h=!1}else for(;!(h=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);h=!0);}catch(g){p=!0,i=g}finally{try{if(!h&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(p)throw i}}return a}}function wlt(e){if(Array.isArray(e))return e}function OZ(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function Slt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function RZ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Clt(n.key),n)}}function xlt(e,t,r){return t&&RZ(e.prototype,t),r&&RZ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Clt(e){var t=Elt(e,"string");return sx(t)==="symbol"?t:String(t)}function Elt(e,t){if(sx(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(sx(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var kZ="ConditionCollection.filteringStates",_ue=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;Slt(this,e),this.hot=t,this.isMapRegistrable=r,this.filteringStates=new LA,this.isMapRegistrable===!0?this.hot.columnIndexMapper.registerMap(kZ,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}return xlt(e,[{key:"isEmpty",value:function(){return this.getFilteredColumns().length===0}},{key:"isMatch",value:function(r,n){var i,o=this.filteringStates.getValueAtIndex(n),s=(i=o==null?void 0:o.conditions)!==null&&i!==void 0?i:[],a=o==null?void 0:o.operation;return this.isMatchInConditions(s,r,a)}},{key:"isMatchInConditions",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:oh;return r.length?Uot(i)(r,n):!0}},{key:"addCondition",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:oh,o=arguments.length>3?arguments[3]:void 0,s=this.hot.getCellMeta(0,r).locale,a=hn(n.args,function(S){return typeof S=="string"?S.toLocaleLowerCase(s):S}),h=n.name||n.command.key;this.runLocalHooks("beforeAdd",r);var p=this.getOperation(r);if(p){if(p!==i)throw Error(Xn(xZ||(xZ=OZ(["The column of index "," has been already applied with a `","` \n        filter operation. Use `removeConditions` to clear the current conditions and then add new ones. \n        Mind that you cannot mix different types of operations (for instance, if you use `conjunction`, \n        use it consequently for a particular column)."],["The column of index "," has been already applied with a \\`","\\`\\x20\n        filter operation. Use \\`removeConditions\\` to clear the current conditions and then add new ones.\\x20\n        Mind that you cannot mix different types of operations (for instance, if you use \\`conjunction\\`,\\x20\n        use it consequently for a particular column)."])),r,p))}else if(si(ix[i]))throw new Error(Xn(CZ||(CZ=OZ(["Unexpected operation named `","`. Possible ones are \n        `disjunction` and `conjunction`."],["Unexpected operation named \\`","\\`. Possible ones are\\x20\n        \\`disjunction\\` and \\`conjunction\\`."])),i));var g=this.getConditions(r);g.length===0?this.filteringStates.setValueAtIndex(r,{operation:i,conditions:[{name:h,args:a,func:mh(h,a)}]},o):g.push({name:h,args:a,func:mh(h,a)}),this.runLocalHooks("afterAdd",r)}},{key:"getConditions",value:function(r){var n,i;return(n=(i=this.filteringStates.getValueAtIndex(r))===null||i===void 0?void 0:i.conditions)!==null&&n!==void 0?n:[]}},{key:"getOperation",value:function(r){var n;return(n=this.filteringStates.getValueAtIndex(r))===null||n===void 0?void 0:n.operation}},{key:"getFilteredColumns",value:function(){return this.filteringStates.getEntries().map(function(r){var n=EZ(r,1),i=n[0];return i})}},{key:"getColumnStackPosition",value:function(r){return this.getFilteredColumns().indexOf(r)}},{key:"exportAllConditions",value:function(){return na(this.filteringStates.getEntries(),function(r,n){var i=EZ(n,2),o=i[0],s=i[1],a=s.operation,h=s.conditions;return r.push({column:o,operation:a,conditions:hn(h,function(p){var g=p.name,S=p.args;return{name:g,args:S}})}),r},[])}},{key:"importAllConditions",value:function(r){var n=this;this.clean(),Le(r,function(i){Le(i.conditions,function(o){return n.addCondition(i.column,o)})})}},{key:"removeConditions",value:function(r){this.runLocalHooks("beforeRemove",r),this.filteringStates.clearValue(r),this.runLocalHooks("afterRemove",r)}},{key:"clean",value:function(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}},{key:"hasConditions",value:function(r,n){var i=this.getConditions(r);return n?i.some(function(o){return o.name===n}):i.length>0}},{key:"destroy",value:function(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(kZ),this.filteringStates=null,this.clearLocalHooks()}}]),e}();li(_ue,Va);const bue=_ue;function lx(e){"@babel/helpers - typeof";return lx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lx(e)}function Tlt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function PZ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Rlt(n.key),n)}}function Olt(e,t,r){return t&&PZ(e.prototype,t),r&&PZ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Rlt(e){var t=klt(e,"string");return lx(t)==="symbol"?t:String(t)}function klt(e,t){if(lx(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(lx(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Plt=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(){return[]};Tlt(this,e),this.conditionCollection=t,this.columnDataFactory=r}return Olt(e,[{key:"filter",value:function(){var r=this,n=[];return Le(this.conditionCollection.getFilteredColumns(),function(i,o){var s=r.columnDataFactory(i);o&&(s=r._getIntersectData(s,n)),n=r.filterByColumn(i,s)}),n}},{key:"filterByColumn",value:function(r){var n=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],o=[];return Le(i,function(s){s!==void 0&&n.conditionCollection.isMatch(s,r)&&o.push(s)}),o}},{key:"_getIntersectData",value:function(r,n){var i=[];return Le(n,function(o){var s=o.meta.visualRow;r[s]!==void 0&&(i[s]=r[s])}),i}}]),e}();const wue=Plt;function ux(e){"@babel/helpers - typeof";return ux=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ux(e)}function Alt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function AZ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Mlt(n.key),n)}}function Ilt(e,t,r){return t&&AZ(e.prototype,t),r&&AZ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Mlt(e){var t=Dlt(e,"string");return ux(t)==="symbol"?t:String(t)}function Dlt(e,t){if(ux(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ux(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Sue=function(){function e(t,r){var n=this,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:function(){return[]};Alt(this,e),this.hot=t,this.conditionCollection=r,this.columnDataFactory=i,this.changes=[],this.grouping=!1,this.latestEditedColumnPosition=-1,this.latestOrderStack=[],this.conditionCollection.addLocalHook("beforeRemove",function(o){return n._onConditionBeforeModify(o)}),this.conditionCollection.addLocalHook("afterRemove",function(o){return n.updateStatesAtColumn(o)}),this.conditionCollection.addLocalHook("afterAdd",function(o){return n.updateStatesAtColumn(o)}),this.conditionCollection.addLocalHook("beforeClean",function(){return n._onConditionBeforeClean()}),this.conditionCollection.addLocalHook("afterClean",function(){return n._onConditionAfterClean()})}return Ilt(e,[{key:"groupChanges",value:function(){this.grouping=!0}},{key:"flush",value:function(){var r=this;this.grouping=!1,Le(this.changes,function(n){r.updateStatesAtColumn(n)}),this.changes.length=0}},{key:"_onConditionBeforeModify",value:function(r){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(r)}},{key:"updateStatesAtColumn",value:function(r,n){var i=this;if(this.grouping){this.changes.indexOf(r)===-1&&this.changes.push(r);return}var o=this.conditionCollection.exportAllConditions(),s=this.conditionCollection.getColumnStackPosition(r);s===-1&&(s=this.latestEditedColumnPosition);var a=o.slice(0,s),h=o.slice(s);h.length&&h[0].column===r&&h.shift();var p=tNe(function(S,T){var R=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],A=new bue(i.hot,!1),$=[].concat(S,R);A.importAllConditions($);var j=i.columnDataFactory(T),z;A.isEmpty()?z=j:z=new wue(A,function(G){return i.columnDataFactory(G)}).filter(),z=hn(z,function(G){return G.meta.visualRow});var V=CC(z);return A.destroy(),$s(j,function(G){return V(G.meta.visualRow)})})(a),g=[].concat(this.conditionCollection.getConditions(r));this.runLocalHooks("update",{editedConditionStack:{column:r,conditions:g},dependentConditionStacks:h,filteredRowsFactory:p,conditionArgsChange:n})}},{key:"_onConditionBeforeClean",value:function(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}},{key:"_onConditionAfterClean",value:function(){var r=this;Le(this.latestOrderStack,function(n){r.updateStatesAtColumn(n)})}},{key:"destroy",value:function(){var r=this;this.clearLocalHooks(),pn(this,function(n,i){r[i]=null})}}]),e}();li(Sue,Va);const $lt=Sue;function c_(e){"@babel/helpers - typeof";return c_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},c_(e)}var IZ;function Llt(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function Nlt(e,t){return Flt(e)||zlt(e,t)||jlt(e,t)||Blt()}function Blt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function jlt(e,t){if(e){if(typeof e=="string")return MZ(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return MZ(e,t)}}function MZ(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function zlt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],h=!0,p=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;h=!1}else for(;!(h=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);h=!0);}catch(g){p=!0,i=g}finally{try{if(!h&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(p)throw i}}return a}}function Flt(e){if(Array.isArray(e))return e}function Hlt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function DZ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ult(n.key),n)}}function Vlt(e,t,r){return t&&DZ(e.prototype,t),r&&DZ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ult(e){var t=Wlt(e,"string");return c_(t)==="symbol"?t:String(t)}function Wlt(e,t){if(c_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(c_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Tg(){return typeof Reflect<"u"&&Reflect.get?Tg=Reflect.get.bind():Tg=function(t,r,n){var i=Glt(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Tg.apply(this,arguments)}function Glt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=uh(e),e!==null););return e}function Ylt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&$j(e,t)}function $j(e,t){return $j=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},$j(e,t)}function Klt(e){var t=Xlt();return function(){var n=uh(e),i;if(t){var o=uh(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return qlt(this,i)}}function qlt(e,t){if(t&&(c_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return xue(e)}function xue(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Xlt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function uh(e){return uh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},uh(e)}var $Z="filters",Zlt=250,Jlt=function(e){Ylt(r,e);var t=Klt(r);function r(n){var i;return Hlt(this,r),i=t.call(this,n),i.eventManager=new Bi(xue(i)),i.dropdownMenuPlugin=null,i.conditionCollection=null,i.conditionUpdateObserver=null,i.components=new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]]),i.filtersRowsMap=null,i.hot.addHook("afterGetColHeader",function(o,s){return i.onAfterGetColHeader(o,s)}),i}return Vlt(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[$Z]}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new vC),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");var o=this.hot.getSettings().dropdownMenu,s=o&&o.uiContainer||this.hot.rootDocument.body,a=function(R){return R.addLocalHook("accept",function(){return i.onActionBarSubmit("accept")}),R.addLocalHook("cancel",function(){return i.onActionBarSubmit("cancel")}),R.addLocalHook("change",function(A){return i.onComponentChange(R,A)}),R},h=function(){return"".concat(i.hot.getTranslatedPhrase(KV),":")},p=function(){return"".concat(i.hot.getTranslatedPhrase(qV),":")};if(!this.components.get("filter_by_condition")){var g=new h2(this.hot,{id:"filter_by_condition",name:h,addSeparator:!1,menuContainer:s});g.addLocalHook("afterClose",function(){return i.onSelectUIClosed()}),this.components.set("filter_by_condition",a(g))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new ost(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){var S=new h2(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:s});S.addLocalHook("afterClose",function(){return i.onSelectUIClosed()}),this.components.set("filter_by_condition2",a(S))}this.components.get("filter_by_value")||this.components.set("filter_by_value",a(new alt(this.hot,{id:"filter_by_value",name:p}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",a(new glt(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new bue(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new $lt(this.hot,this.conditionCollection,function(T){return i.getDataMapAtColumn(T)}),this.conditionUpdateObserver.addLocalHook("update",function(T){return i.updateComponents(T)})),this.components.forEach(function(T){return T.show()}),this.addHook("beforeDropdownMenuSetItems",function(T){return i.onBeforeDropdownMenuSetItems(T)}),this.addHook("afterDropdownMenuDefaultOptions",function(T){return i.onAfterDropdownMenuDefaultOptions(T)}),this.addHook("afterDropdownMenuShow",function(){return i.onAfterDropdownMenuShow()}),this.addHook("afterDropdownMenuHide",function(){return i.onAfterDropdownMenuHide()}),this.addHook("afterChange",function(T){return i.onAfterChange(T)}),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),Tg(uh(r.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){var i=this;if(this.enabled){var o;(o=this.dropdownMenuPlugin)!==null&&o!==void 0&&o.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach(function(s,a){s.destroy(),i.components.set(a,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}Tg(uh(r.prototype),"disablePlugin",this).call(this)}},{key:"addCondition",value:function(i,o,s){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:oh,h=this.hot.toPhysicalColumn(i);this.conditionCollection.addCondition(h,{command:{key:o},args:s},a)}},{key:"removeConditions",value:function(i){var o=this.hot.toPhysicalColumn(i);this.conditionCollection.removeConditions(o)}},{key:"clearConditions",value:function(i){if(i===void 0)this.conditionCollection.clean();else{var o=this.hot.toPhysicalColumn(i);this.conditionCollection.removeConditions(o)}}},{key:"filter",value:function(){var i=this,o=this._createDataFilter(),s=!this.conditionCollection.isEmpty(),a=[],h=this.conditionCollection.exportAllConditions(),p=this.hot.runHooks("beforeFilter",h);if(p!==!1)if(s){var g=[];this.hot.batchExecution(function(){i.filtersRowsMap.clear(),a=hn(o.filter(),function(T){return T.meta.visualRow});var S=CC(a);Er(i.hot.countSourceRows()-1,function(T){S(T)||g.push(T)}),Le(g,function(T){i.filtersRowsMap.setValueAtIndex(T,!0)})},!0),a.length||this.hot.deselectCell()}else this.filtersRowsMap.clear();this.hot.runHooks("afterFilter",h),this.hot.view.adjustElementsSize(!0),this.hot.render(),this.clearColumnSelection()}},{key:"getSelectedColumn",value:function(){var i,o=(i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight;return o?{visualIndex:o.col,physicalIndex:this.hot.toPhysicalColumn(o.col)}:null}},{key:"clearColumnSelection",value:function(){var i=this.getSelectedColumn();i!==null&&this.hot.selectCell(0,i.visualIndex)}},{key:"getDataMapAtColumn",value:function(i){var o=this,s=this.hot.toVisualColumn(i),a=[];return Le(this.hot.getSourceDataAtCol(s),function(h,p){var g,S=o.hot.getCellMeta(p,s),T=S.row,R=S.col,A=S.visualCol,$=S.visualRow,j=S.type,z=S.instance,V=S.dateFormat,G=S.locale,ee=(g=o.hot.getDataAtCell(o.hot.toVisualRow(p),s))!==null&&g!==void 0?g:h;a.push({meta:{row:T,col:R,visualCol:A,visualRow:$,type:j,instance:z,dateFormat:V,locale:G},value:cue(ee)})}),a}},{key:"onAfterChange",value:function(i){var o=this;i&&Le(i,function(s){var a=Nlt(s,2),h=a[1],p=o.hot.propToCol(h);o.conditionCollection.hasConditions(p)&&o.updateValueComponentCondition(p)})}},{key:"updateValueComponentCondition",value:function(i){var o=this.hot.getDataAtCol(i),s=Cj(o);this.conditionUpdateObserver.updateStatesAtColumn(i,s)}},{key:"restoreComponents",value:function(i){var o,s=(o=this.getSelectedColumn())===null||o===void 0?void 0:o.physicalIndex;i.forEach(function(a){a.isHidden()||a.restoreState(s)}),this.updateDependentComponentsVisibility()}},{key:"onAfterDropdownMenuShow",value:function(){this.restoreComponents(Array.from(this.components.values()))}},{key:"onAfterDropdownMenuHide",value:function(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}},{key:"onBeforeDropdownMenuSetItems",value:function(){var i=this;this.dropdownMenuPlugin&&this.dropdownMenuPlugin.menu.addLocalHook("afterOpen",function(){i.dropdownMenuPlugin.menu.hotMenu.updateSettings({hiddenRows:!0})})}},{key:"onAfterDropdownMenuDefaultOptions",value:function(i){i.items.push({name:fn}),this.components.forEach(function(o){i.items.push(o.getMenuItemDescriptor())})}},{key:"getOperationBasedOnArguments",value:function(i,o,s,a){var h=i;return h===mP&&o.command.key!==Oo&&s.command.key!==Oo&&a.command.key!==Oo?h=gU:a.command.key!==Oo&&(o.command.key===Oo||s.command.key===Oo)&&(h=oh),h}},{key:"onActionBarSubmit",value:function(i){var o;if(i==="accept"){var s=this.getSelectedColumn();if(s===null){var a;(a=this.dropdownMenuPlugin)===null||a===void 0||a.close();return}var h=s.physicalIndex,p=this.components.get("filter_by_condition").getState(),g=this.components.get("filter_by_condition2").getState(),S=this.components.get("filter_by_value").getState(),T=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),p,g,S);this.conditionUpdateObserver.groupChanges();var R=this.conditionCollection.getColumnStackPosition(h);R===-1&&(R=void 0),this.conditionCollection.removeConditions(h),p.command.key!==Oo&&(this.conditionCollection.addCondition(h,p,T,R),g.command.key!==Oo&&this.conditionCollection.addCondition(h,g,T,R)),S.command.key!==Oo&&this.conditionCollection.addCondition(h,S,T,R),this.conditionUpdateObserver.flush(),this.components.forEach(function(A){return A.saveState(h)}),this.filtersRowsMap.clear(),this.filter()}(o=this.dropdownMenuPlugin)===null||o===void 0||o.close()}},{key:"onComponentChange",value:function(i,o){this.updateDependentComponentsVisibility(),i.constructor===h2&&!o.inputsCount&&this.setListeningDropdownMenu()}},{key:"onSelectUIClosed",value:function(){this.setListeningDropdownMenu()}},{key:"setListeningDropdownMenu",value:function(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}},{key:"updateDependentComponentsVisibility",value:function(){var i=this.components.get("filter_by_condition"),o=i.getState(),s=o.command,a=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];s.showOperators?this.showComponents.apply(this,a):this.hideComponents.apply(this,a)}},{key:"onAfterGetColHeader",value:function(i,o){var s=this.hot.toPhysicalColumn(i);this.enabled&&this.conditionCollection.hasConditions(s)?Ht(o,"htFiltersActive"):Kr(o,"htFiltersActive")}},{key:"_createDataFilter",value:function(){var i=this,o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.conditionCollection;return new wue(o,function(s){return i.getDataMapAtColumn(s)})}},{key:"updateComponents",value:function(i){var o;if((o=this.dropdownMenuPlugin)!==null&&o!==void 0&&o.enabled){var s=i.editedConditionStack,a=s.conditions,h=s.column,p=a.filter(function(T){return T.name===ip}),g=a.filter(function(T){return T.name!==ip});if(p.length>=2||g.length>=3)ti(Xn(IZ||(IZ=Llt([`The filter conditions have been applied properly, but couldnt be displayed visually. 
        The overall amount of conditions exceed the capability of the dropdown menu. 
        For more details see the documentation.`],[`The filter conditions have been applied properly, but couldnt be displayed visually.\\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\\x20
        For more details see the documentation.`]))));else{var S=this.conditionCollection.getOperation(h);this.components.get("filter_by_condition").updateState(g[0],h),this.components.get("filter_by_condition2").updateState(g[1],h),this.components.get("filter_operators").updateState(S,h),this.components.get("filter_by_value").updateState(i)}}}},{key:"getIndexesOfComponents",value:function(){var i=[];if(!this.dropdownMenuPlugin)return i;for(var o=this.dropdownMenuPlugin.menu,s=arguments.length,a=new Array(s),h=0;h<s;h++)a[h]=arguments[h];return Le(a,function(p){Le(o.menuItems,function(g,S){g.key===p.getMenuItemDescriptor().key&&i.push(S)})}),i}},{key:"changeComponentsVisibility",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(this.dropdownMenuPlugin){for(var o=this.dropdownMenuPlugin.menu,s=o.hotMenu,a=s.getPlugin("hiddenRows"),h=arguments.length,p=new Array(h>1?h-1:0),g=1;g<h;g++)p[g-1]=arguments[g];var S=this.getIndexesOfComponents.apply(this,p);i?a.showRows(S):a.hideRows(S),s.render()}}},{key:"hideComponents",value:function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];this.changeComponentsVisibility.apply(this,[!1].concat(o))}},{key:"showComponents",value:function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];this.changeComponentsVisibility.apply(this,[!0].concat(o))}},{key:"destroy",value:function(){var i=this;this.enabled&&(this.components.forEach(function(o,s){o!==null&&(o.destroy(),i.components.set(s,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),Tg(uh(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return $Z}},{key:"PLUGIN_PRIORITY",get:function(){return Zlt}},{key:"PLUGIN_DEPS",get:function(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}}]),r}(Wn);function cx(e){"@babel/helpers - typeof";return cx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cx(e)}function LZ(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function J0(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?LZ(Object(r),!0).forEach(function(n){Qlt(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):LZ(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Qlt(e,t,r){return t=eut(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function eut(e){var t=tut(e,"string");return cx(t)==="symbol"?t:String(t)}function tut(e,t){if(cx(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(cx(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Cue="internal-use-in-handsontable",rut={licenseKey:Cue,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!0,nullDate:{year:1899,month:12,day:31},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function Eue(e){var t,r;return{maxColumns:e.maxColumns,maxRows:e.maxRows,language:(t=e[pa])===null||t===void 0||(r=t.language)===null||r===void 0?void 0:r.langCode}}function Tue(e){return Object.keys(e).reduce(function(t,r){return r!=="hyperformula"&&(t[r]=e[r]),t},{})}function nut(e){var t,r=e[pa],n=Tue(r!=null&&(t=r.engine)!==null&&t!==void 0&&t.hyperformula?r.engine:{}),i=Eue(e);return J0(J0(J0({},rut),n),i)}function iut(e){var t,r=e[pa],n=Tue(r!=null&&(t=r.engine)!==null&&t!==void 0&&t.hyperformula?r.engine:{}),i=Eue(e);return J0(J0({},n),i)}function Lj(e){"@babel/helpers - typeof";return Lj=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lj(e)}function eI(){var e="engine_relationship",t=Fs(pa);return t.hasItem(e)||t.register(e,new Map),t.getItem(e)}function vU(){var e="shared_engine_usage",t=Fs(pa);return t.hasItem(e)||t.register(e,new Map),t.getItem(e)}function out(e){var t=e.getSettings(),r=t[pa],n=r==null?void 0:r.engine;if(r===!0||si(n))return null;if(typeof n.hyperformula=="function"||typeof n=="function"){var i;return aut((i=n.hyperformula)!==null&&i!==void 0?i:n,t,e)}else if(Lj(n)==="object"&&si(n.hyperformula)){var o=eI(),s=vU().get(n);return o.has(n)||o.set(n,[]),o.get(n).push(e),s&&s.push(e.guid),n.getConfig().licenseKey||n.updateConfig({licenseKey:Cue}),n}return null}function aut(e,t,r){var n=t[pa],i=nut(t),o=eI(),s=vU();sut(e,n.functions),lut(e,n.language);var a=e.buildEmpty(i);return o.set(a,[r]),s.set(a,[r.guid]),uut(a,n.namedExpressions),a.on("sheetAdded",function(){a.rebuildAndRecalculate()}),a.on("sheetRemoved",function(){a.rebuildAndRecalculate()}),a}function NZ(e){var t,r=eI(),n=r.size===0?[]:Array.from((t=r.get(e))!==null&&t!==void 0?t:[]);return new Map(n.map(function(i){return[i.getPlugin("formulas").sheetId,i]}))}function BZ(e,t){if(e){var r=eI(),n=r.get(e),i=vU(),o=i.get(e);n&&n.includes(t)&&(n.splice(n.indexOf(t),1),n.length===0&&r.delete(e)),o&&o.includes(t.guid)&&(o.splice(o.indexOf(t.guid),1),o.length===0&&(i.delete(e),e.destroy()))}}function sut(e,t){t&&t.forEach(function(r){var n=r.name,i=r.plugin,o=r.translations;try{e.registerFunction(n,i,o)}catch(s){ti(s.message)}})}function lut(e,t){if(t){var r=t.langCode;try{e.registerLanguage(r,t)}catch(n){ti(n.message)}}}function uut(e,t){t&&(e.suspendEvaluation(),t.forEach(function(r){var n=r.name,i=r.expression,o=r.scope,s=r.options;try{e.addNamedExpression(n,i,o,s)}catch(a){ti(a.message)}}),e.resumeEvaluation())}function cut(e,t){return(si(t)||!e.doesSheetExist(t))&&(t=e.addSheet(t)),t}function Oue(e){return typeof e=="string"&&e.charAt(0)==="'"&&e.charAt(1)==="="}function fut(e){return Oue(e)?e.substr(1):e}function hut(e){return mut(e)||put(e)||Rue(e)||dut()}function dut(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function put(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function mut(e){if(Array.isArray(e))return Nj(e)}function jZ(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function zZ(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?jZ(Object(r),!0).forEach(function(n){kR(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):jZ(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function yh(e){"@babel/helpers - typeof";return yh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yh(e)}function Iy(e,t){return vut(e)||gut(e,t)||Rue(e,t)||yut()}function yut(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Rue(e,t){if(e){if(typeof e=="string")return Nj(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Nj(e,t)}}function Nj(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function gut(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],h=!0,p=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;h=!1}else for(;!(h=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);h=!0);}catch(g){p=!0,i=g}finally{try{if(!h&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(p)throw i}}return a}}function vut(e){if(Array.isArray(e))return e}function _ut(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function FZ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,kue(n.key),n)}}function but(e,t,r){return t&&FZ(e.prototype,t),r&&FZ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function op(){return typeof Reflect<"u"&&Reflect.get?op=Reflect.get.bind():op=function(t,r,n){var i=wut(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},op.apply(this,arguments)}function wut(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=uc(e),e!==null););return e}function Sut(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Bj(e,t)}function Bj(e,t){return Bj=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Bj(e,t)}function xut(e){var t=Eut();return function(){var n=uc(e),i;if(t){var o=uc(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Cut(this,i)}}function Cut(e,t){if(t&&(yh(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return $d(e)}function $d(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Eut(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function uc(e){return uc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},uc(e)}function kR(e,t,r){return t=kue(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function kue(e){var t=Tut(e,"string");return yh(t)==="symbol"?t:String(t)}function Tut(e,t){if(yh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(yh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function p2(e,t,r){Out(e,t),t.set(e,r)}function Out(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function My(e,t,r){var n=Pue(e,t,"set");return Rut(e,n,r),r}function Rut(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}function Dy(e,t){var r=Pue(e,t,"get");return kut(e,r)}function Pue(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function kut(e,t){return t.get?t.get.call(e):t.value}var pa="formulas",Put=260,HZ="row_move";mr.getSingleton().register("afterNamedExpressionAdded");mr.getSingleton().register("afterNamedExpressionRemoved");mr.getSingleton().register("afterSheetAdded");mr.getSingleton().register("afterSheetRemoved");mr.getSingleton().register("afterSheetRenamed");mr.getSingleton().register("afterFormulasValuesUpdate");var $y=function(t){return t==="UndoRedo.undo"||t==="UndoRedo.redo"||t==="auto"},Rd=new WeakMap,m2=new WeakMap,u0=new WeakMap,Aut=function(e){Sut(r,e);var t=xut(r);function r(){var n;_ut(this,r);for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n=t.call.apply(t,[this].concat(o)),p2($d(n),Rd,{writable:!0,value:!1}),p2($d(n),m2,{writable:!0,value:!1}),p2($d(n),u0,{writable:!0,value:[["valuesUpdated",function(){var a;return(a=n).onEngineValuesUpdated.apply(a,arguments)}],["namedExpressionAdded",function(){var a;return(a=n).onEngineNamedExpressionsAdded.apply(a,arguments)}],["namedExpressionRemoved",function(){var a;return(a=n).onEngineNamedExpressionsRemoved.apply(a,arguments)}],["sheetAdded",function(){var a;return(a=n).onEngineSheetAdded.apply(a,arguments)}],["sheetRenamed",function(){var a;return(a=n).onEngineSheetRenamed.apply(a,arguments)}],["sheetRemoved",function(){var a;return(a=n).onEngineSheetRemoved.apply(a,arguments)}]]}),kR($d(n),"staticRegister",Fs("formulas")),kR($d(n),"engine",null),kR($d(n),"sheetName",null),n}return but(r,[{key:"sheetId",get:function(){return this.sheetName===null?null:this.engine.getSheetId(this.sheetName)}},{key:"isEnabled",value:function(){return!!this.hot.getSettings()[pa]}},{key:"enablePlugin",value:function(){var i,o=this;if(!this.enabled){if(this.engine=(i=out(this.hot))!==null&&i!==void 0?i:this.engine,!this.engine){ti("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(this.sheetName!==null&&!this.engine.doesSheetExist(this.sheetName)){var s=this.addSheet(this.sheetName,this.hot.getSourceDataArray());s!==!1&&(this.sheetName=s)}this.addHook("beforeLoadData",function(){return o.onBeforeLoadData.apply(o,arguments)}),this.addHook("afterLoadData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.addHook("beforeUpdateData",function(){return o.onBeforeLoadData.apply(o,arguments)}),this.addHook("afterUpdateData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.addHook("modifyData",function(){return o.onModifyData.apply(o,arguments)}),this.addHook("modifySourceData",function(){return o.onModifySourceData.apply(o,arguments)}),this.addHook("beforeValidate",function(){return o.onBeforeValidate.apply(o,arguments)}),this.addHook("afterSetSourceDataAtCell",function(){return o.onAfterSetSourceDataAtCell.apply(o,arguments)}),this.addHook("afterSetDataAtCell",function(){return o.onAfterSetDataAtCell.apply(o,arguments)}),this.addHook("afterSetDataAtRowProp",function(){return o.onAfterSetDataAtCell.apply(o,arguments)}),this.addHook("beforeCreateRow",function(){return o.onBeforeCreateRow.apply(o,arguments)}),this.addHook("beforeCreateCol",function(){return o.onBeforeCreateCol.apply(o,arguments)}),this.addHook("afterCreateRow",function(){return o.onAfterCreateRow.apply(o,arguments)}),this.addHook("afterCreateCol",function(){return o.onAfterCreateCol.apply(o,arguments)}),this.addHook("beforeRemoveRow",function(){return o.onBeforeRemoveRow.apply(o,arguments)}),this.addHook("beforeRemoveCol",function(){return o.onBeforeRemoveCol.apply(o,arguments)}),this.addHook("afterRemoveRow",function(){return o.onAfterRemoveRow.apply(o,arguments)}),this.addHook("afterRemoveCol",function(){return o.onAfterRemoveCol.apply(o,arguments)}),this.addHook("beforeUndo",function(a){(a==null?void 0:a.actionType)!==HZ&&o.engine.undo()}),this.addHook("beforeRedo",function(a){(a==null?void 0:a.actionType)!==HZ&&o.engine.redo()}),this.addHook("afterDetachChild",function(){return o.onAfterDetachChild.apply(o,arguments)}),this.addHook("beforeAutofill",function(){return o.onBeforeAutofill.apply(o,arguments)}),Dy(this,u0).forEach(function(a){var h=Iy(a,2),p=h[0],g=h[1];return o.engine.on(p,g)}),op(uc(r.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){var i=this;Dy(this,u0).forEach(function(o){var s=Iy(o,2),a=s[0],h=s[1];return i.engine.off(a,h)}),BZ(this.engine,this.hot),this.engine=null,op(uc(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(i){this.engine.updateConfig(iut(this.hot.getSettings()));var o=this.hot.getSettings()[pa];if(dr(o)&&dr(o.sheetName)&&o.sheetName!==this.sheetName&&this.switchSheet(o.sheetName),!i.data&&this.sheetName===null){var s=this.hot.getSettings()[pa].sheetName;s&&this.engine.doesSheetExist(s)?this.switchSheet(this.sheetName):this.sheetName=this.addSheet(s??void 0,this.hot.getSourceDataArray())}op(uc(r.prototype),"updatePlugin",this).call(this,i)}},{key:"destroy",value:function(){var i=this;Dy(this,u0).forEach(function(o){var s,a=Iy(o,2),h=a[0],p=a[1];return(s=i.engine)===null||s===void 0?void 0:s.off(h,p)}),My(this,u0,null),BZ(this.engine,this.hot),this.engine=null,op(uc(r.prototype),"destroy",this).call(this)}},{key:"getPhysicalIndexPosition",value:function(i,o,s,a,h){return!h&&i>=s?a+(i-s):o}},{key:"toPhysicalRowPosition",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this.getPhysicalIndexPosition(i,this.hot.toPhysicalRow(i),this.hot.countRows(),this.hot.countSourceRows(),o)}},{key:"toPhysicalColumnPosition",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this.getPhysicalIndexPosition(i,this.hot.toPhysicalColumn(i),this.hot.countCols(),this.hot.countSourceCols(),o)}},{key:"addSheet",value:function(i,o){if(dr(o)&&!mZe(o))return ti("The provided data should be an array of arrays."),!1;if(i!=null&&this.engine.doesSheetExist(i))return ti("Sheet with the provided name already exists."),!1;try{var s=this.engine.addSheet(i??void 0);return o&&this.engine.setSheetContent(this.engine.getSheetId(s),o),s}catch(a){return ti(a.message),!1}}},{key:"switchSheet",value:function(i){if(!this.engine.doesSheetExist(i)){i3("The sheet named `".concat(i,"` does not exist, switch aborted."));return}this.sheetName=i;var o=this.engine.getSheetSerialized(this.sheetId);o.length>0&&this.hot.loadData(o,"".concat(xc(pa),".switchSheet"))}},{key:"getCellType",value:function(i,o){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId,a=this.hot.toPhysicalRow(i),h=this.hot.toPhysicalColumn(o);return a!==null&&h!==null?this.engine.getCellType({sheet:s,row:a,col:h}):"EMPTY"}},{key:"isFormulaCellType",value:function(i,o){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId,a=this.hot.toPhysicalRow(i),h=this.hot.toPhysicalColumn(o);return a===null||h===null?!1:this.engine.doesCellHaveFormula({sheet:s,row:a,col:h})}},{key:"renderDependentSheets",value:function(i){var o=this,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,a=new Set;i.forEach(function(h){var p,g=h==null||(p=h.address)===null||p===void 0?void 0:p.sheet;g!==void 0&&(a.has(g)||a.add(g))}),NZ(this.engine).forEach(function(h,p){if((s||p!==o.sheetId)&&a.has(p)){var g;h.render(),(g=h.view)===null||g===void 0||g.adjustElementsSize()}})}},{key:"validateDependentCells",value:function(i){var o=this,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],a=function(g){var S,T=(S=g==null?void 0:g.address)!==null&&S!==void 0?S:{},R=T.row,A=T.col,$=T.sheet;return dr($)?"".concat($,":").concat(R,"x").concat(A):""},h=new Set(s.map(function(p){return a(p)}));i.forEach(function(p){var g,S,T=(g=p.address)!==null&&g!==void 0?g:{},R=T.row,A=T.col,$=dr(R)?o.hot.toVisualRow(R):null,j=dr(A)?o.hot.toVisualColumn(A):null;if(!($===null||j===null)){var z=p==null||(S=p.address)===null||S===void 0?void 0:S.sheet,V=a(p);if(z!==void 0&&!h.has(V)){var G=NZ(o.engine).get(z);if(!G)return;G.validateCell(G.getDataAtCell($,j),G.getCellMeta($,j),function(){})}}})}},{key:"syncChangeWithEngine",value:function(i,o,s){var a={row:this.toPhysicalRowPosition(i),col:this.toPhysicalColumnPosition(o),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(a)){ti("Not possible to set cell data at ".concat(JSON.stringify(a)));return}return this.engine.setCellContents(a,s)}},{key:"onBeforeValidate",value:function(i,o,s){var a=this.hot.propToCol(s);if(this.isFormulaCellType(o,a)){var h={row:this.hot.toPhysicalRow(o),col:this.hot.toPhysicalColumn(a),sheet:this.sheetId},p=this.engine.getCellValue(h);return yh(p)==="object"&&p!==null?p.value:p}return i}},{key:"onBeforeAutofill",value:function(i,o,s){var a=this,h=function(T){return zZ(zZ({},T),{},{sheet:a.sheetId})},p={start:h(o.getTopStartCorner()),end:h(o.getBottomEndCorner())},g={start:h(s.getTopStartCorner()),end:h(s.getBottomEndCorner())};return this.engine.isItPossibleToSetCellContents(g)===!1?!1:this.engine.getFillRangeData(p,g)}},{key:"onBeforeLoadData",value:function(i,o){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";s.includes(xc(pa))||My(this,m2,si(this.hot.getSettings().data))}},{key:"onAfterLoadData",value:function(i,o){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";if(!s.includes(xc(pa)))if(this.sheetName=cut(this.engine,this.hot.getSettings()[pa].sheetName),Dy(this,m2))this.switchSheet(this.sheetName);else{var a=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,a)){My(this,Rd,!0);var h=this.engine.setSheetContent(this.sheetId,this.hot.getSourceDataArray());this.renderDependentSheets(h),My(this,Rd,!1)}}}},{key:"onModifyData",value:function(i,o,s,a){if(!(a!=="get"||Dy(this,Rd)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))){var h=this.hot.toVisualRow(i),p=this.isFormulaCellType(h,o);if(!p){var g=this.getCellType(h,o);if(g!=="ARRAY"){Oue(s.value)&&(s.value=fut(s.value));return}}var S={row:i,col:this.toPhysicalColumnPosition(o),sheet:this.sheetId},T=this.engine.getCellValue(S),R=yh(T)==="object"&&T!==null?T.value:T;s.value=R}}},{key:"onModifySourceData",value:function(i,o,s,a){if(!(a!=="get"||Dy(this,Rd)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))){var h=this.hot.toVisualRow(i),p=this.hot.propToCol(o),g=this.isFormulaCellType(h,p);if(!g){var S=this.getCellType(h,p);if(S!=="ARRAY")return}var T=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(!(T.width===0&&T.height===0)){var R={row:i,col:this.toPhysicalColumnPosition(p),sheet:this.sheetId};s.value=this.engine.getCellSerialized(R)}}}},{key:"onAfterSetDataAtCell",value:function(i,o){var s=this;if(!$y(o)){var a=[],h=[],p=this.engine.batch(function(){i.forEach(function(g){var S=Iy(g,4),T=S[0],R=S[1],A=S[3],$=s.hot.propToCol(R),j=s.hot.toPhysicalRow(T),z=s.hot.toPhysicalColumn($),V={row:j,col:z,sheet:s.sheetId};j!==null&&z!==null?s.syncChangeWithEngine(T,$,A):a.push([T,$,A]),h.push({address:V})})});a.length&&this.hot.addHookOnce("afterChange",function(){var g=s.engine.batch(function(){a.forEach(function(S){var T=Iy(S,3),R=T[0],A=T[1],$=T[2];s.syncChangeWithEngine(R,A,$)})});s.renderDependentSheets(g,!0)}),this.renderDependentSheets(p),this.validateDependentCells(p,h)}}},{key:"onAfterSetSourceDataAtCell",value:function(i,o){var s=this;if(!$y(o)){var a=[],h=[];i.forEach(function(p){var g=Iy(p,4),S=g[0],T=g[1],R=g[3],A=s.hot.propToCol(T);if(ks(A)){var $={row:S,col:s.toPhysicalColumnPosition(A),sheet:s.sheetId};if(!s.engine.isItPossibleToSetCellContents($)){ti("Not possible to set source cell data at ".concat(JSON.stringify($)));return}h.push({address:$}),a.push.apply(a,hut(s.engine.setCellContents($,R)))}}),this.renderDependentSheets(a),this.validateDependentCells(a,h)}}},{key:"onBeforeCreateRow",value:function(i,o){if(this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[this.toPhysicalRowPosition(i),o]))return!1}},{key:"onBeforeCreateCol",value:function(i,o){if(this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[this.toPhysicalColumnPosition(i),o]))return!1}},{key:"onBeforeRemoveRow",value:function(i,o,s){var a=this,h=s.every(function(p){return a.engine.isItPossibleToRemoveRows(a.sheetId,[p,1])});return h===!1?!1:void 0}},{key:"onBeforeRemoveCol",value:function(i,o,s){var a=this,h=s.every(function(p){return a.engine.isItPossibleToRemoveColumns(a.sheetId,[p,1])});return h===!1?!1:void 0}},{key:"onAfterCreateRow",value:function(i,o,s){if(!$y(s)){var a=this.engine.addRows(this.sheetId,[this.toPhysicalRowPosition(i),o]);this.renderDependentSheets(a)}}},{key:"onAfterCreateCol",value:function(i,o,s){if(!$y(s)){var a=this.engine.addColumns(this.sheetId,[this.toPhysicalColumnPosition(i),o]);this.renderDependentSheets(a)}}},{key:"onAfterRemoveRow",value:function(i,o,s,a){var h=this;if(!$y(a)){var p=s.sort().reverse(),g=this.engine.batch(function(){p.forEach(function(S){h.engine.removeRows(h.sheetId,[S,1])})});this.renderDependentSheets(g)}}},{key:"onAfterRemoveCol",value:function(i,o,s,a){var h=this;if(!$y(a)){var p=s.sort().reverse(),g=this.engine.batch(function(){p.forEach(function(S){h.engine.removeColumns(h.sheetId,[S,1])})});this.renderDependentSheets(g)}}},{key:"onAfterDetachChild",value:function(i,o,s){var a,h=this;My(this,Rd,!0);var p=this.hot.getSourceDataArray(s,0,s+(((a=o.__children)===null||a===void 0?void 0:a.length)||0),this.hot.countSourceCols());My(this,Rd,!1),p.forEach(function(g,S){g.forEach(function(T,R){h.engine.setCellContents({col:R,row:s+S,sheet:h.sheetId},[[T]])})})}},{key:"onEngineValuesUpdated",value:function(i){this.hot.runHooks("afterFormulasValuesUpdate",i)}},{key:"onEngineNamedExpressionsAdded",value:function(i,o){this.hot.runHooks("afterNamedExpressionAdded",i,o)}},{key:"onEngineNamedExpressionsRemoved",value:function(i,o){this.hot.runHooks("afterNamedExpressionRemoved",i,o)}},{key:"onEngineSheetAdded",value:function(i){this.hot.runHooks("afterSheetAdded",i)}},{key:"onEngineSheetRenamed",value:function(i,o){this.hot.runHooks("afterSheetRenamed",i,o)}},{key:"onEngineSheetRemoved",value:function(i,o){this.hot.runHooks("afterSheetRemoved",i,o)}}],[{key:"PLUGIN_KEY",get:function(){return pa}},{key:"PLUGIN_PRIORITY",get:function(){return Put}}]),r}(Wn);function Iut(e,t){return Lut(e)||$ut(e,t)||Dut(e,t)||Mut()}function Mut(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Dut(e,t){if(e){if(typeof e=="string")return VZ(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return VZ(e,t)}}function VZ(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function $ut(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],h=!0,p=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;h=!1}else for(;!(h=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);h=!0);}catch(g){p=!0,i=g}finally{try{if(!h&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(p)throw i}}return a}}function Lut(e){if(Array.isArray(e))return e}function Nut(e){return{key:"hidden_columns_hide",name:function(){var r=this.getSelectedLast(),n=0;if(Array.isArray(r)){var i=Iut(r,4),o=i[1],s=i[3];o-s!==0&&(n=1)}return this.getTranslatedPhrase(EV,n)},callback:function(){for(var r=this.getSelectedRangeLast(),n=r.from,i=r.to,o=Math.max(Math.min(n.col,i.col),0),s=Math.max(n.col,i.col),a=[],h=o;h<=s;h+=1)a.push(h);e.hideColumns(a);var p=a[a.length-1],g=this.columnIndexMapper.getNearestNotHiddenIndex(p,1,!0);Number.isInteger(g)&&g>=0?this.selectColumns(g):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden:function(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function TO(e){return Fut(e)||zut(e)||jut(e)||But()}function But(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function jut(e,t){if(e){if(typeof e=="string")return jj(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return jj(e,t)}}function zut(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Fut(e){if(Array.isArray(e))return jj(e)}function jj(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Hut(e){var t=[];return{key:"hidden_columns_show",name:function(){var n=t.length>1?1:0;return this.getTranslatedPhrase(TV,n)},callback:function(){var n,i;if(t.length!==0){var o=t[0],s=t[t.length-1];o=(n=this.columnIndexMapper.getNearestNotHiddenIndex(o-1,-1))!==null&&n!==void 0?n:0,s=(i=this.columnIndexMapper.getNearestNotHiddenIndex(s+1,1))!==null&&i!==void 0?i:this.countCols()-1,e.showColumns(t),this.render(),this.view.adjustElementsSize(!0);var a=s-o+1===this.countCols();a||this.selectColumns(o,s)}},disabled:!1,hidden:function(){var n=this,i=hn(e.getHiddenColumns(),function(V){return n.toPhysicalColumn(V)});if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||i.length<1)return!0;t.length=0;var o=this.getSelectedRangeLast(),s=o.getTopStartCorner().col,a=o.getBottomEndCorner().col,h=this.columnIndexMapper,p=h.getRenderableFromVisualIndex(s),g=h.getRenderableFromVisualIndex(a),S=h.getNotTrimmedIndexes(),T=[];if(s!==a){var R=a-s+1,A=g-p+1;if(R>A){var $=S.slice(s,a+1);T.push.apply(T,TO($.filter(function(V){return i.includes(V)})))}}else if(p===0&&p<s)T.push.apply(T,TO(S.slice(0,s)));else if(p===null)T.push.apply(T,TO(S.slice(0,this.countCols())));else{var j=this.countCols()-1,z=h.getRenderableFromVisualIndex(h.getNearestNotHiddenIndex(j,-1));g===z&&j>a&&T.push.apply(T,TO(S.slice(a+1)))}return Le(T,function(V){t.push(n.toVisualColumn(V))}),t.length===0}}}function f_(e){"@babel/helpers - typeof";return f_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},f_(e)}function Vut(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function UZ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Wut(n.key),n)}}function Uut(e,t,r){return t&&UZ(e.prototype,t),r&&UZ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Wut(e){var t=Gut(e,"string");return f_(t)==="symbol"?t:String(t)}function Gut(e,t){if(f_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(f_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ap(){return typeof Reflect<"u"&&Reflect.get?ap=Reflect.get.bind():ap=function(t,r,n){var i=Yut(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},ap.apply(this,arguments)}function Yut(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=cc(e),e!==null););return e}function Kut(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&zj(e,t)}function zj(e,t){return zj=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},zj(e,t)}function qut(e){var t=Zut();return function(){var n=cc(e),i;if(t){var o=cc(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Xut(this,i)}}function Xut(e,t){if(t&&(f_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Fj(e)}function Fj(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Zut(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function cc(e){return cc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},cc(e)}function WZ(e,t,r){Jut(e,t),t.set(e,r)}function Jut(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Xa(e,t){var r=Aue(e,t,"get");return Qut(e,r)}function Qut(e,t){return t.get?t.get.call(e):t.value}function c0(e,t,r){var n=Aue(e,t,"set");return ect(e,n,r),r}function Aue(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function ect(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}mr.getSingleton().register("beforeHideColumns");mr.getSingleton().register("afterHideColumns");mr.getSingleton().register("beforeUnhideColumns");mr.getSingleton().register("afterUnhideColumns");var y2="hiddenColumns",tct=310,Gl=new WeakMap,Yl=new WeakMap,rct=function(e){Kut(r,e);var t=qut(r);function r(){var n;Vut(this,r);for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n=t.call.apply(t,[this].concat(o)),WZ(Fj(n),Gl,{writable:!0,value:{}}),WZ(Fj(n),Yl,{writable:!0,value:null}),n}return Uut(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[y2]}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){var o=this.hot.getSettings()[y2];dn(o)&&(c0(this,Gl,o),si(o.copyPasteEnabled)&&(o.copyPasteEnabled=!0)),c0(this,Yl,new $A),Xa(this,Yl).addLocalHook("init",function(){return i.onMapInit()}),this.hot.columnIndexMapper.registerMap(this.pluginName,Xa(this,Yl)),this.addHook("afterContextMenuDefaultOptions",function(){return i.onAfterContextMenuDefaultOptions.apply(i,arguments)}),this.addHook("afterGetCellMeta",function(s,a,h){return i.onAfterGetCellMeta(s,a,h)}),this.addHook("modifyColWidth",function(s,a){return i.onModifyColWidth(s,a)}),this.addHook("afterGetColHeader",function(){return i.onAfterGetColHeader.apply(i,arguments)}),this.addHook("modifyCopyableRange",function(s){return i.onModifyCopyableRange(s)}),ap(cc(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),ap(cc(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),c0(this,Gl,{}),ap(cc(r.prototype),"disablePlugin",this).call(this),this.resetCellsMeta()}},{key:"showColumns",value:function(i){var o=this,s=this.getHiddenColumns(),a=this.isValidConfig(i),h=s,p=Xa(this,Yl).getValues().slice(),g=i.length>0;if(a&&g){var S=i.map(function(R){return o.hot.toPhysicalColumn(R)});Le(S,function(R){p[R]=!1}),h=na(p,function(R,A,$){return A&&R.push(o.hot.toVisualColumn($)),R},[])}var T=this.hot.runHooks("beforeUnhideColumns",s,h,a&&g);T!==!1&&(a&&g&&Xa(this,Yl).setValues(p),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",s,h,a&&g,a&&h.length<s.length))}},{key:"showColumn",value:function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];this.showColumns(o)}},{key:"hideColumns",value:function(i){var o=this,s=this.getHiddenColumns(),a=this.isValidConfig(i),h=s;a&&(h=Array.from(new Set(s.concat(i))));var p=this.hot.runHooks("beforeHideColumns",s,h,a);p!==!1&&(a&&this.hot.batchExecution(function(){Le(i,function(g){Xa(o,Yl).setValueAtIndex(o.hot.toPhysicalColumn(g),!0)})},!0),this.hot.runHooks("afterHideColumns",s,h,a,a&&h.length>s.length))}},{key:"hideColumn",value:function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];this.hideColumns(o)}},{key:"getHiddenColumns",value:function(){var i=this;return hn(Xa(this,Yl).getHiddenIndexes(),function(o){return i.hot.toVisualColumn(o)})}},{key:"isHidden",value:function(i){return Xa(this,Yl).getValueAtIndex(this.hot.toPhysicalColumn(i))||!1}},{key:"isValidConfig",value:function(i){var o=this.hot.countCols();return Array.isArray(i)&&i.length>0?i.every(function(s){return Number.isInteger(s)&&s>=0&&s<o}):!1}},{key:"resetCellsMeta",value:function(){Le(this.hot.getCellsMeta(),function(i){i&&(i.skipColumnOnPaste=!1)})}},{key:"onModifyColWidth",value:function(i,o){if(this.isHidden(o))return 0;if(Xa(this,Gl).indicators&&(this.isHidden(o+1)||this.isHidden(o-1))&&typeof i=="number"&&this.hot.hasColHeaders())return i+15}},{key:"onAfterGetCellMeta",value:function(i,o,s){if(Xa(this,Gl).copyPasteEnabled===!1&&this.isHidden(o)&&(s.skipColumnOnPaste=!0),this.isHidden(o-1))s.className=s.className||"",s.className.indexOf("afterHiddenColumn")===-1&&(s.className+=" afterHiddenColumn");else if(s.className){var a=s.className.split(" ");if(a.length>0){var h=a.indexOf("afterHiddenColumn");h>-1&&a.splice(h,1),s.className=a.join(" ")}}}},{key:"onModifyCopyableRange",value:function(i){var o=this;if(Xa(this,Gl).copyPasteEnabled)return i;var s=[],a=function(p,g,S,T){s.push({startRow:p,endRow:g,startCol:S,endCol:T})};return Le(i,function(h){var p=!0,g=0;Er(h.startCol,h.endCol,function(S){o.isHidden(S)?(p||a(h.startRow,h.endRow,g,S-1),p=!0):(p&&(g=S),S===h.endCol&&a(h.startRow,h.endRow,g,S),p=!1)})}),s}},{key:"onAfterGetColHeader",value:function(i,o){if(!(!Xa(this,Gl).indicators||i<0)){var s=[];i>=1&&this.isHidden(i-1)&&s.push("afterHiddenColumn"),i<this.hot.countCols()-1&&this.isHidden(i+1)&&s.push("beforeHiddenColumn"),Ht(o,s)}}},{key:"onAfterContextMenuDefaultOptions",value:function(i){i.items.push({name:fn},Nut(this),Hut(this))}},{key:"onMapInit",value:function(){Array.isArray(Xa(this,Gl).columns)&&this.hideColumns(Xa(this,Gl).columns)}},{key:"destroy",value:function(){c0(this,Gl,null),c0(this,Yl,null),ap(cc(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return y2}},{key:"PLUGIN_PRIORITY",get:function(){return tct}}]),r}(Wn);function nct(e,t){return sct(e)||act(e,t)||oct(e,t)||ict()}function ict(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function oct(e,t){if(e){if(typeof e=="string")return GZ(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return GZ(e,t)}}function GZ(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function act(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],h=!0,p=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;h=!1}else for(;!(h=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);h=!0);}catch(g){p=!0,i=g}finally{try{if(!h&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(p)throw i}}return a}}function sct(e){if(Array.isArray(e))return e}function lct(e){return{key:"hidden_rows_hide",name:function(){var r=this.getSelectedLast(),n=0;if(Array.isArray(r)){var i=nct(r,3),o=i[0],s=i[2];o-s!==0&&(n=1)}return this.getTranslatedPhrase(OV,n)},callback:function(){for(var r=this.getSelectedRangeLast(),n=r.from,i=r.to,o=Math.max(Math.min(n.row,i.row),0),s=Math.max(n.row,i.row),a=[],h=o;h<=s;h+=1)a.push(h);e.hideRows(a);var p=a[a.length-1],g=this.rowIndexMapper.getNearestNotHiddenIndex(p,1,!0);Number.isInteger(g)&&g>=0?this.selectRows(g):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden:function(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function OO(e){return hct(e)||fct(e)||cct(e)||uct()}function uct(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function cct(e,t){if(e){if(typeof e=="string")return Hj(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Hj(e,t)}}function fct(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function hct(e){if(Array.isArray(e))return Hj(e)}function Hj(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function dct(e){var t=[];return{key:"hidden_rows_show",name:function(){var n=t.length>1?1:0;return this.getTranslatedPhrase(RV,n)},callback:function(){var n,i;if(t.length!==0){var o=t[0],s=t[t.length-1];o=(n=this.rowIndexMapper.getNearestNotHiddenIndex(o-1,-1))!==null&&n!==void 0?n:0,s=(i=this.rowIndexMapper.getNearestNotHiddenIndex(s+1,1))!==null&&i!==void 0?i:this.countRows()-1,e.showRows(t),this.render(),this.view.adjustElementsSize(!0);var a=s-o+1===this.countRows();a||this.selectRows(o,s)}},disabled:!1,hidden:function(){var n=this,i=hn(e.getHiddenRows(),function(V){return n.toPhysicalRow(V)});if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||i.length<1)return!0;t.length=0;var o=this.getSelectedRangeLast(),s=o.getTopStartCorner().row,a=o.getBottomEndCorner().row,h=this.rowIndexMapper,p=h.getRenderableFromVisualIndex(s),g=h.getRenderableFromVisualIndex(a),S=h.getNotTrimmedIndexes(),T=[];if(s!==a){var R=a-s+1,A=g-p+1;if(R>A){var $=S.slice(s,a+1);T.push.apply(T,OO($.filter(function(V){return i.includes(V)})))}}else if(p===0&&p<s)T.push.apply(T,OO(S.slice(0,s)));else if(p===null)T.push.apply(T,OO(S.slice(0,this.countRows())));else{var j=this.countRows()-1,z=h.getRenderableFromVisualIndex(h.getNearestNotHiddenIndex(j,-1));g===z&&j>a&&T.push.apply(T,OO(S.slice(a+1)))}return Le(T,function(V){t.push(n.toVisualRow(V))}),t.length===0}}}function h_(e){"@babel/helpers - typeof";return h_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},h_(e)}function pct(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function YZ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,yct(n.key),n)}}function mct(e,t,r){return t&&YZ(e.prototype,t),r&&YZ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function yct(e){var t=gct(e,"string");return h_(t)==="symbol"?t:String(t)}function gct(e,t){if(h_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(h_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function sp(){return typeof Reflect<"u"&&Reflect.get?sp=Reflect.get.bind():sp=function(t,r,n){var i=vct(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},sp.apply(this,arguments)}function vct(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=fc(e),e!==null););return e}function _ct(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Vj(e,t)}function Vj(e,t){return Vj=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Vj(e,t)}function bct(e){var t=Sct();return function(){var n=fc(e),i;if(t){var o=fc(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return wct(this,i)}}function wct(e,t){if(t&&(h_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Uj(e)}function Uj(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Sct(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function fc(e){return fc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},fc(e)}function KZ(e,t,r){xct(e,t),t.set(e,r)}function xct(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Cs(e,t){var r=Iue(e,t,"get");return Cct(e,r)}function Cct(e,t){return t.get?t.get.call(e):t.value}function f0(e,t,r){var n=Iue(e,t,"set");return Ect(e,n,r),r}function Iue(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function Ect(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}mr.getSingleton().register("beforeHideRows");mr.getSingleton().register("afterHideRows");mr.getSingleton().register("beforeUnhideRows");mr.getSingleton().register("afterUnhideRows");var g2="hiddenRows",Tct=320,Lu=new WeakMap,Kl=new WeakMap,Oct=function(e){_ct(r,e);var t=bct(r);function r(){var n;pct(this,r);for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n=t.call.apply(t,[this].concat(o)),KZ(Uj(n),Lu,{writable:!0,value:{}}),KZ(Uj(n),Kl,{writable:!0,value:null}),n}return mct(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[g2]}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){var o=this.hot.getSettings()[g2];dn(o)&&(f0(this,Lu,o),si(o.copyPasteEnabled)&&(o.copyPasteEnabled=!0)),f0(this,Kl,new $A),Cs(this,Kl).addLocalHook("init",function(){return i.onMapInit()}),this.hot.rowIndexMapper.registerMap(this.pluginName,Cs(this,Kl)),this.addHook("afterContextMenuDefaultOptions",function(){return i.onAfterContextMenuDefaultOptions.apply(i,arguments)}),this.addHook("afterGetCellMeta",function(s,a,h){return i.onAfterGetCellMeta(s,a,h)}),this.addHook("modifyRowHeight",function(s,a){return i.onModifyRowHeight(s,a)}),this.addHook("afterGetRowHeader",function(){return i.onAfterGetRowHeader.apply(i,arguments)}),this.addHook("modifyCopyableRange",function(s){return i.onModifyCopyableRange(s)}),sp(fc(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),sp(fc(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap(this.pluginName),f0(this,Lu,{}),sp(fc(r.prototype),"disablePlugin",this).call(this),this.resetCellsMeta()}},{key:"showRows",value:function(i){var o=this,s=this.getHiddenRows(),a=this.isValidConfig(i),h=s,p=Cs(this,Kl).getValues().slice(),g=i.length>0;if(a&&g){var S=i.map(function(R){return o.hot.toPhysicalRow(R)});Le(S,function(R){p[R]=!1}),h=na(p,function(R,A,$){return A&&R.push(o.hot.toVisualRow($)),R},[])}var T=this.hot.runHooks("beforeUnhideRows",s,h,a&&g);T!==!1&&(a&&g&&Cs(this,Kl).setValues(p),this.hot.runHooks("afterUnhideRows",s,h,a&&g,a&&h.length<s.length))}},{key:"showRow",value:function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];this.showRows(o)}},{key:"hideRows",value:function(i){var o=this,s=this.getHiddenRows(),a=this.isValidConfig(i),h=s;a&&(h=Array.from(new Set(s.concat(i))));var p=this.hot.runHooks("beforeHideRows",s,h,a);p!==!1&&(a&&this.hot.batchExecution(function(){Le(i,function(g){Cs(o,Kl).setValueAtIndex(o.hot.toPhysicalRow(g),!0)})},!0),this.hot.runHooks("afterHideRows",s,h,a,a&&h.length>s.length))}},{key:"hideRow",value:function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];this.hideRows(o)}},{key:"getHiddenRows",value:function(){var i=this;return hn(Cs(this,Kl).getHiddenIndexes(),function(o){return i.hot.toVisualRow(o)})}},{key:"isHidden",value:function(i){return Cs(this,Kl).getValueAtIndex(this.hot.toPhysicalRow(i))||!1}},{key:"isValidConfig",value:function(i){var o=this.hot.countRows();return Array.isArray(i)&&i.length>0?i.every(function(s){return Number.isInteger(s)&&s>=0&&s<o}):!1}},{key:"resetCellsMeta",value:function(){Le(this.hot.getCellsMeta(),function(i){i&&(i.skipRowOnPaste=!1)})}},{key:"onModifyRowHeight",value:function(i,o){return this.isHidden(o)?0:i}},{key:"onAfterGetCellMeta",value:function(i,o,s){if(Cs(this,Lu).copyPasteEnabled===!1&&this.isHidden(i)&&(s.skipRowOnPaste=!0),this.isHidden(i-1))s.className=s.className||"",s.className.indexOf("afterHiddenRow")===-1&&(s.className+=" afterHiddenRow");else if(s.className){var a=s.className.split(" ");if(a.length>0){var h=a.indexOf("afterHiddenRow");h>-1&&a.splice(h,1),s.className=a.join(" ")}}}},{key:"onModifyCopyableRange",value:function(i){var o=this;if(Cs(this,Lu).copyPasteEnabled)return i;var s=[],a=function(p,g,S,T){s.push({startRow:p,endRow:g,startCol:S,endCol:T})};return Le(i,function(h){var p=!0,g=0;Er(h.startRow,h.endRow,function(S){o.isHidden(S)?(p||a(g,S-1,h.startCol,h.endCol),p=!0):(p&&(g=S),S===h.endRow&&a(g,S,h.startCol,h.endCol),p=!1)})}),s}},{key:"onAfterGetRowHeader",value:function(i,o){if(!(!Cs(this,Lu).indicators||i<0)){var s=[];i>=1&&this.isHidden(i-1)&&s.push("afterHiddenRow"),i<this.hot.countRows()-1&&this.isHidden(i+1)&&s.push("beforeHiddenRow"),Ht(o,s)}}},{key:"onAfterContextMenuDefaultOptions",value:function(i){i.items.push({name:fn},lct(this),dct(this))}},{key:"onMapInit",value:function(){Array.isArray(Cs(this,Lu).rows)&&this.hideRows(Cs(this,Lu).rows)}},{key:"destroy",value:function(){f0(this,Lu,null),f0(this,Kl,null),sp(fc(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return g2}},{key:"PLUGIN_PRIORITY",get:function(){return Tct}}]),r}(Wn);function Rct(e,t){return Ict(e)||Act(e,t)||Pct(e,t)||kct()}function kct(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Pct(e,t){if(e){if(typeof e=="string")return qZ(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return qZ(e,t)}}function qZ(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Act(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],h=!0,p=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;h=!1}else for(;!(h=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);h=!0);}catch(g){p=!0,i=g}finally{try{if(!h&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(p)throw i}}return a}}function Ict(e){if(Array.isArray(e))return e}function Mct(e){return{key:"freeze_column",name:function(){return this.getTranslatedPhrase(tV)},callback:function(r,n){var i=Rct(n,1),o=i[0].start.col;e.freezeColumn(o),this.render(),this.view.adjustElementsSize(!0)},hidden:function(){var r=this.getSelectedRange(),n=!1;return(r===void 0||r.length>1||r[0].from.col!==r[0].to.col||r[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(n=!0),n}}}function Dct(e,t){return Bct(e)||Nct(e,t)||Lct(e,t)||$ct()}function $ct(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Lct(e,t){if(e){if(typeof e=="string")return XZ(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return XZ(e,t)}}function XZ(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Nct(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],h=!0,p=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;h=!1}else for(;!(h=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);h=!0);}catch(g){p=!0,i=g}finally{try{if(!h&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(p)throw i}}return a}}function Bct(e){if(Array.isArray(e))return e}function jct(e){return{key:"unfreeze_column",name:function(){return this.getTranslatedPhrase(rV)},callback:function(r,n){var i=Dct(n,1),o=i[0].start.col;e.unfreezeColumn(o),this.render(),this.view.adjustElementsSize(!0)},hidden:function(){var r=this.getSelectedRange(),n=!1;return(r===void 0||r.length>1||r[0].from.col!==r[0].to.col||r[0].from.col>=this.getSettings().fixedColumnsStart)&&(n=!0),n}}}function d_(e){"@babel/helpers - typeof";return d_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},d_(e)}function zct(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ZZ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Hct(n.key),n)}}function Fct(e,t,r){return t&&ZZ(e.prototype,t),r&&ZZ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Hct(e){var t=Vct(e,"string");return d_(t)==="symbol"?t:String(t)}function Vct(e,t){if(d_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(d_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Og(){return typeof Reflect<"u"&&Reflect.get?Og=Reflect.get.bind():Og=function(t,r,n){var i=Uct(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Og.apply(this,arguments)}function Uct(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=ch(e),e!==null););return e}function Wct(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Wj(e,t)}function Wj(e,t){return Wj=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Wj(e,t)}function Gct(e){var t=Kct();return function(){var n=ch(e),i;if(t){var o=ch(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Yct(this,i)}}function Yct(e,t){if(t&&(d_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Mue(e)}function Mue(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Kct(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ch(e){return ch=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ch(e)}mr.getSingleton().register("beforeColumnFreeze");mr.getSingleton().register("afterColumnFreeze");mr.getSingleton().register("beforeColumnUnfreeze");mr.getSingleton().register("afterColumnUnfreeze");var JZ="manualColumnFreeze",qct=110,h0=new WeakMap,Xct=function(e){Wct(r,e);var t=Gct(r);function r(n){var i;return zct(this,r),i=t.call(this,n),h0.set(Mue(i),{afterFirstUse:!1}),i}return Fct(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[JZ]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.addHook("afterContextMenuDefaultOptions",function(o){return i.addContextMenuEntry(o)}),this.addHook("beforeColumnMove",function(o,s){return i.onBeforeColumnMove(o,s)}),Og(ch(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var i=h0.get(this);i.afterFirstUse=!1,Og(ch(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Og(ch(r.prototype),"updatePlugin",this).call(this)}},{key:"freezeColumn",value:function(i){var o=h0.get(this),s=this.hot.getSettings(),a=s.fixedColumnsStart<this.hot.countCols()&&i>s.fixedColumnsStart-1;o.afterFirstUse||(o.afterFirstUse=!0);var h=this.hot.runHooks("beforeColumnFreeze",i,a);h!==!1&&(a&&(this.hot.columnIndexMapper.moveIndexes(i,s.fixedColumnsStart),s._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",i,a))}},{key:"unfreezeColumn",value:function(i){var o=h0.get(this),s=this.hot.getSettings(),a=s.fixedColumnsStart>0&&i<=s.fixedColumnsStart-1;o.afterFirstUse||(o.afterFirstUse=!0);var h=this.hot.runHooks("beforeColumnUnfreeze",i,a);h!==!1&&(a&&(s._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(i,s.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",i,a))}},{key:"addContextMenuEntry",value:function(i){i.items.push({name:"---------"},Mct(this),jct(this))}},{key:"onBeforeColumnMove",value:function(i,o){var s=h0.get(this);if(s.afterFirstUse){var a=this.hot.getSettings().fixedColumnsStart;if(o<a||i.some(function(h){return h<a}))return!1}}}],[{key:"PLUGIN_KEY",get:function(){return JZ}},{key:"PLUGIN_PRIORITY",get:function(){return qct}}]),r}(Wn);function fx(e){"@babel/helpers - typeof";return fx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fx(e)}function Zct(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function QZ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Qct(n.key),n)}}function Jct(e,t,r){return t&&QZ(e.prototype,t),r&&QZ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Qct(e){var t=eft(e,"string");return fx(t)==="symbol"?t:String(t)}function eft(e,t){if(fx(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(fx(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var v2=0,eJ=1,tJ=2,Ly="px",tft=function(){function e(t){Zct(this,e),this.hot=t,this._element=null,this.state=v2,this.inlineProperty=t.isRtl()?"right":"left"}return Jct(e,[{key:"appendTo",value:function(r){r.appendChild(this._element),this.state=tJ}},{key:"build",value:function(){this.state===v2&&(this._element=this.hot.rootDocument.createElement("div"),this.state=eJ)}},{key:"destroy",value:function(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=v2}},{key:"isAppended",value:function(){return this.state===tJ}},{key:"isBuilt",value:function(){return this.state>=eJ}},{key:"setPosition",value:function(r,n){ks(r)&&(this._element.style.top=r+Ly),ks(n)&&(this._element.style[this.inlineProperty]=n+Ly)}},{key:"getPosition",value:function(){var r=this._element.style;return{top:r.top?parseInt(r.top,10):0,start:r[this.inlineProperty]?parseInt(r[this.inlineProperty],10):0}}},{key:"setSize",value:function(r,n){ks(r)&&(this._element.style.width=r+Ly),ks(n)&&(this._element.style.height=n+Ly)}},{key:"getSize",value:function(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}},{key:"setOffset",value:function(r,n){ks(r)&&(this._element.style.marginTop=r+Ly),ks(n)&&(this._element.style["margin".concat(xc(this.inlineProperty))]=n+Ly)}},{key:"getOffset",value:function(){var r=this._element.style,n="margin".concat(xc(this.inlineProperty));return{top:r.marginTop?parseInt(r.marginTop,10):0,start:r[n]?parseInt(r[n],10):0}}}]),e}();const Due=tft;function p_(e){"@babel/helpers - typeof";return p_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},p_(e)}function rft(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function rJ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ift(n.key),n)}}function nft(e,t,r){return t&&rJ(e.prototype,t),r&&rJ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ift(e){var t=oft(e,"string");return p_(t)==="symbol"?t:String(t)}function oft(e,t){if(p_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(p_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function PR(){return typeof Reflect<"u"&&Reflect.get?PR=Reflect.get.bind():PR=function(t,r,n){var i=aft(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},PR.apply(this,arguments)}function aft(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=m_(e),e!==null););return e}function sft(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Gj(e,t)}function Gj(e,t){return Gj=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Gj(e,t)}function lft(e){var t=fft();return function(){var n=m_(e),i;if(t){var o=m_(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return uft(this,i)}}function uft(e,t){if(t&&(p_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return cft(e)}function cft(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function fft(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function m_(e){return m_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},m_(e)}var hft="ht__manualColumnMove--backlight",dft=function(e){sft(r,e);var t=lft(r);function r(){return rft(this,r),t.apply(this,arguments)}return nft(r,[{key:"build",value:function(){PR(m_(r.prototype),"build",this).call(this),Ht(this._element,hft)}}]),r}(Due);const pft=dft;function y_(e){"@babel/helpers - typeof";return y_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},y_(e)}function mft(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function nJ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,gft(n.key),n)}}function yft(e,t,r){return t&&nJ(e.prototype,t),r&&nJ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function gft(e){var t=vft(e,"string");return y_(t)==="symbol"?t:String(t)}function vft(e,t){if(y_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(y_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function AR(){return typeof Reflect<"u"&&Reflect.get?AR=Reflect.get.bind():AR=function(t,r,n){var i=_ft(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},AR.apply(this,arguments)}function _ft(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=g_(e),e!==null););return e}function bft(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Yj(e,t)}function Yj(e,t){return Yj=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Yj(e,t)}function wft(e){var t=Cft();return function(){var n=g_(e),i;if(t){var o=g_(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Sft(this,i)}}function Sft(e,t){if(t&&(y_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return xft(e)}function xft(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Cft(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function g_(e){return g_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},g_(e)}var Eft="ht__manualColumnMove--guideline",Tft=function(e){bft(r,e);var t=wft(r);function r(){return mft(this,r),t.apply(this,arguments)}return yft(r,[{key:"build",value:function(){AR(g_(r.prototype),"build",this).call(this),Ht(this._element,Eft)}}]),r}(Due);const Oft=Tft;function v_(e){"@babel/helpers - typeof";return v_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},v_(e)}function Rft(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function iJ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Pft(n.key),n)}}function kft(e,t,r){return t&&iJ(e.prototype,t),r&&iJ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Pft(e){var t=Aft(e,"string");return v_(t)==="symbol"?t:String(t)}function Aft(e,t){if(v_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(v_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function lp(){return typeof Reflect<"u"&&Reflect.get?lp=Reflect.get.bind():lp=function(t,r,n){var i=Ift(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},lp.apply(this,arguments)}function Ift(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=hc(e),e!==null););return e}function Mft(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Kj(e,t)}function Kj(e,t){return Kj=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Kj(e,t)}function Dft(e){var t=Lft();return function(){var n=hc(e),i;if(t){var o=hc(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return $ft(this,i)}}function $ft(e,t){if(t&&(v_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return qj(e)}function qj(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Lft(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function hc(e){return hc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},hc(e)}mr.getSingleton().register("beforeColumnMove");mr.getSingleton().register("afterColumnMove");var _2="manualColumnMove",Nft=120,Ef=new WeakMap,oJ="ht__manualColumnMove",RO="show-ui",b2="on-moving--columns",w2="after-selection--columns",Bft=function(e){Mft(r,e);var t=Dft(r);function r(n){var i;return Rft(this,r),i=t.call(this,n),Ef.set(qj(i),{columnsToMove:[],countCols:0,fixedColumns:0,pressed:void 0,target:{eventPageX:void 0,coords:void 0,TD:void 0,col:void 0},cachedDropIndex:void 0}),i.eventManager=new Bi(qj(i)),i.backlight=new pft(n),i.guideline=new Oft(n),i}return kft(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[_2]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){return i.onBeforeOnCellMouseDown.apply(i,arguments)}),this.addHook("beforeOnCellMouseOver",function(){return i.onBeforeOnCellMouseOver.apply(i,arguments)}),this.addHook("afterScrollVertically",function(){return i.onAfterScrollVertically()}),this.addHook("afterLoadData",function(){return i.onAfterLoadData.apply(i,arguments)}),this.buildPluginUI(),this.registerEvents(),Ht(this.hot.rootElement,oJ),lp(hc(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),lp(hc(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){Kr(this.hot.rootElement,oJ),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),lp(hc(r.prototype),"disablePlugin",this).call(this)}},{key:"moveColumn",value:function(i,o){return this.moveColumns([i],o)}},{key:"moveColumns",value:function(i,o){var s=Ef.get(this),a=s.cachedDropIndex,h=this.isMovePossible(i,o),p=this.hot.runHooks("beforeColumnMove",i,o,a,h);if(s.cachedDropIndex=void 0,p!==!1){h&&this.hot.columnIndexMapper.moveIndexes(i,o);var g=h&&this.isColumnOrderChanged(i,o);return this.hot.runHooks("afterColumnMove",i,o,a,h,g),g}}},{key:"dragColumn",value:function(i,o){return this.dragColumns([i],o)}},{key:"dragColumns",value:function(i,o){var s=this.countFinalIndex(i,o),a=Ef.get(this);return a.cachedDropIndex=o,this.moveColumns(i,s)}},{key:"isMovePossible",value:function(i,o){var s=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),a=i.length+o>s,h=o<0,p=i.some(function(S){return S<0}),g=i.some(function(S){return S>=s});return!(a||h||p||g)}},{key:"isColumnOrderChanged",value:function(i,o){return i.some(function(s,a){return s-a!==o})}},{key:"countFinalIndex",value:function(i,o){var s=na(i,function(a,h){return h<o&&(a+=1),a},0);return o-s}},{key:"getColumnsWidth",value:function(i,o){for(var s=this.hot.columnIndexMapper,a=0,h=i;h<=o;h+=1){var p=s.getRenderableFromVisualIndex(h);h<0?a+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:p!==null&&(a+=this.hot.view._wt.wtTable.getStretchedColumnWidth(p)||0)}return a}},{key:"moveBySettingsOrLoad",value:function(){var i=this.hot.getSettings()[_2];if(Array.isArray(i))this.moveColumns(i,0);else if(i!==void 0){var o=this.persistentStateLoad();o.length&&this.moveColumns(o,0)}}},{key:"isFixedColumnsStart",value:function(i){return i<this.hot.getSettings().fixedColumnsStart}},{key:"persistentStateSave",value:function(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}},{key:"persistentStateLoad",value:function(){var i={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",i),i.value?i.value:[]}},{key:"prepareColumnsToMoving",value:function(i,o){var s=[];return Er(i,o,function(a){s.push(a)}),s}},{key:"refreshPositions",value:function(){var i=Ef.get(this),o=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(i.hoveredColumn)&&o>0&&this.hot.scrollViewportTo(void 0,this.hot.columnIndexMapper.getNearestNotHiddenIndex(o-1,-1));var s=this.hot.view._wt.wtTable,a=this.hot.view._wt.wtOverlays.scrollableElement,h=typeof a.scrollX=="number"?a.scrollX:a.scrollLeft,p=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,i.hoveredColumn-1),g=s.hider.offsetWidth,S=s.TBODY.offsetLeft,T=this.backlight.getOffset().start,R=this.backlight.getSize().width,A=0,$=0;if(this.hot.isRtl()){var j=this.hot.rootWindow,z=ri(this.hot.rootElement),V=j.innerWidth-i.rootElementOffset-z;$=j.innerWidth-i.target.eventPageX-V-(a.scrollX===void 0?h:0)}else $=i.target.eventPageX-(i.rootElementOffset-(a.scrollX===void 0?h:0));if(i.hasRowHeaders&&(A=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(i.hoveredColumn)&&(p+=h),p+=A,i.hoveredColumn<0)i.fixedColumnsStart>0?i.target.col=0:i.target.col=o>0?o-1:o;else if(i.target.TD.offsetWidth/2+p<=$){var G=i.hoveredColumn>=i.countCols?i.countCols-1:i.hoveredColumn;i.target.col=G+1,p+=i.target.TD.offsetWidth}else i.target.col=i.hoveredColumn;var ee=$,K=p;$+R+T>=g?ee=g-R-T:$+T<S+A&&(ee=S+A+Math.abs(T)),p>=g-1?K=g-1:K===0?K=1:a.scrollX!==void 0&&i.hoveredColumn<i.fixedColumnsStart&&(K-=i.rootElementOffset<=a.scrollX?i.rootElementOffset:0),this.backlight.setPosition(null,ee),this.guideline.setPosition(null,K)}},{key:"registerEvents",value:function(){var i=this,o=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(o,"mousemove",function(s){return i.onMouseMove(s)}),this.eventManager.addEventListener(o,"mouseup",function(){return i.onMouseUp()})}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"onBeforeOnCellMouseDown",value:function(i,o,s,a){var h=this.hot.view._wt.wtTable,p=this.hot.selection.isSelectedByColumnHeader(),g=this.hot.getSelectedRangeLast(),S=Ef.get(this),T=Ur(i.target,"sortAction");if(!g||!p||S.pressed||i.button!==0||T){S.pressed=!1,S.columnsToMove.length=0,Kr(this.hot.rootElement,[b2,RO]);return}var R=this.guideline.isBuilt()&&!this.guideline.isAppended(),A=this.backlight.isBuilt()&&!this.backlight.isAppended();R&&A&&(this.guideline.appendTo(h.hider),this.backlight.appendTo(h.hider));var $=g.from,j=g.to,z=Math.min($.col,j.col),V=Math.max($.col,j.col);if(o.row<0&&o.col>=z&&o.col<=V){a.column=!0,S.pressed=!0,S.target.eventPageX=i.pageX,S.target.eventOffsetX=i.offsetX,S.hoveredColumn=o.col,S.target.TD=s,S.target.col=o.col,S.columnsToMove=this.prepareColumnsToMoving(z,V),S.hasRowHeaders=!!this.hot.getSettings().rowHeaders,S.countCols=this.hot.countCols(),S.fixedColumnsStart=this.hot.getSettings().fixedColumnsStart,S.rootElementOffset=io(this.hot.rootElement).left;var G=S.hasRowHeaders?-1:0,ee=h.holder.scrollTop+h.getColumnHeaderHeight(0)+1,K=o.col<S.fixedColumnsStart,xe=Math.abs(this.hot.view._wt.wtOverlays.inlineStartOverlay.getScrollPosition()),Me=Math.abs(i.offsetX-(this.hot.isRtl()?i.target.offsetWidth:0)),He=this.getColumnsWidth(z,o.col-1)+Me,Ne=this.getColumnsWidth(G,z-1)+(K?xe:0)+He;this.backlight.setPosition(ee,Ne),this.backlight.setSize(this.getColumnsWidth(z,V),h.hider.offsetHeight-ee),this.backlight.setOffset(null,-He),Ht(this.hot.rootElement,b2)}else Kr(this.hot.rootElement,w2),S.pressed=!1,S.columnsToMove.length=0}},{key:"onMouseMove",value:function(i){var o=Ef.get(this);if(o.pressed){if(i.target===this.backlight.element){var s=this.backlight.getSize().width;this.backlight.setSize(0),setTimeout(function(){this.backlight.setPosition(s)})}o.target.eventPageX=i.pageX,this.refreshPositions()}}},{key:"onBeforeOnCellMouseOver",value:function(i,o,s,a){var h=this.hot.getSelectedRangeLast(),p=Ef.get(this);!h||!p.pressed||(p.columnsToMove.indexOf(o.col)>-1?Kr(this.hot.rootElement,RO):Ht(this.hot.rootElement,RO),a.row=!0,a.column=!0,a.cell=!0,p.hoveredColumn=o.col,p.target.TD=s)}},{key:"onMouseUp",value:function(){var i=Ef.get(this),o=i.target.col,s=i.columnsToMove.length;if(i.hoveredColumn=void 0,i.pressed=!1,i.backlightWidth=0,Kr(this.hot.rootElement,[b2,RO,w2]),this.hot.selection.isSelectedByColumnHeader()&&Ht(this.hot.rootElement,w2),!(s<1||o===void 0)){var a=i.columnsToMove[0],h=this.hot.toPhysicalColumn(a),p=this.dragColumns(i.columnsToMove,o);if(i.columnsToMove.length=0,p===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);var g=this.hot.toVisualColumn(h),S=g+s-1;this.hot.selectColumns(g,S)}}}},{key:"onAfterScrollVertically",value:function(){var i=this.hot.view._wt.wtTable,o=i.getColumnHeaderHeight(0)+1,s=i.holder.scrollTop,a=o+s;this.backlight.setPosition(a),this.backlight.setSize(null,i.hider.offsetHeight-a)}},{key:"buildPluginUI",value:function(){this.backlight.build(),this.guideline.build()}},{key:"onAfterLoadData",value:function(){this.moveBySettingsOrLoad()}},{key:"destroy",value:function(){this.backlight.destroy(),this.guideline.destroy(),lp(hc(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return _2}},{key:"PLUGIN_PRIORITY",get:function(){return Nft}}]),r}(Wn);function __(e){"@babel/helpers - typeof";return __=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},__(e)}function jft(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function aJ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Fft(n.key),n)}}function zft(e,t,r){return t&&aJ(e.prototype,t),r&&aJ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Fft(e){var t=Hft(e,"string");return __(t)==="symbol"?t:String(t)}function Hft(e,t){if(__(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(__(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function up(){return typeof Reflect<"u"&&Reflect.get?up=Reflect.get.bind():up=function(t,r,n){var i=Vft(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},up.apply(this,arguments)}function Vft(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=dc(e),e!==null););return e}function Uft(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Xj(e,t)}function Xj(e,t){return Xj=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Xj(e,t)}function Wft(e){var t=Yft();return function(){var n=dc(e),i;if(t){var o=dc(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Gft(this,i)}}function Gft(e,t){if(t&&(__(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Zj(e)}function Zj(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Yft(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function dc(e){return dc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},dc(e)}var kO="manualColumnResize",Kft=130,sJ="manualColumnWidths",S2=new WeakMap,qft=function(e){Uft(r,e);var t=Wft(r);function r(n){var i;jft(this,r),i=t.call(this,n);var o=i.hot.rootDocument;return i.currentTH=null,i.currentCol=null,i.selectedCols=[],i.currentWidth=null,i.newSize=null,i.startY=null,i.startWidth=null,i.startOffset=null,i.handle=o.createElement("DIV"),i.guide=o.createElement("DIV"),i.eventManager=new Bi(Zj(i)),i.pressed=null,i.dblclick=0,i.autoresizeTimeout=null,i.columnWidthsMap=void 0,S2.set(Zj(i),{config:void 0}),Ht(i.handle,"manualColumnResizer"),Ht(i.guide,"manualColumnResizerGuide"),i}return zft(r,[{key:"inlineDir",get:function(){return this.hot.isRtl()?"right":"left"}},{key:"isEnabled",value:function(){return this.hot.getSettings()[kO]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.columnWidthsMap=new Ch,this.columnWidthsMap.addLocalHook("init",function(){return i.onMapInit()}),this.hot.columnIndexMapper.registerMap(this.pluginName,this.columnWidthsMap),this.addHook("modifyColWidth",function(o,s){return i.onModifyColWidth(o,s)}),this.addHook("beforeStretchingColumnWidth",function(o,s){return i.onBeforeStretchingColumnWidth(o,s)}),this.addHook("beforeColumnResize",function(o,s,a){return i.onBeforeColumnResize(o,s,a)}),this.bindEvents(),up(dc(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),up(dc(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var i=S2.get(this);i.config=this.columnWidthsMap.getValues(),this.hot.columnIndexMapper.unregisterMap(this.pluginName),up(dc(r.prototype),"disablePlugin",this).call(this)}},{key:"saveManualColumnWidths",value:function(){this.hot.runHooks("persistentStateSave",sJ,this.columnWidthsMap.getValues())}},{key:"loadManualColumnWidths",value:function(){var i={};return this.hot.runHooks("persistentStateLoad",sJ,i),i.value}},{key:"setManualSize",value:function(i,o){var s=Math.max(o,20),a=this.hot.toPhysicalColumn(i);return this.columnWidthsMap.setValueAtIndex(a,s),s}},{key:"clearManualSize",value:function(i){var o=this.hot.toPhysicalColumn(i);this.columnWidthsMap.setValueAtIndex(o,null)}},{key:"onMapInit",value:function(){var i=this,o=S2.get(this),s=this.hot.getSettings()[kO],a=this.loadManualColumnWidths();typeof a<"u"?this.hot.batchExecution(function(){a.forEach(function(h,p){i.columnWidthsMap.setValueAtIndex(p,h)})},!0):Array.isArray(s)?(this.hot.batchExecution(function(){s.forEach(function(h,p){i.columnWidthsMap.setValueAtIndex(p,h)})},!0),o.config=s):s===!0&&Array.isArray(o.config)&&this.hot.batchExecution(function(){o.config.forEach(function(h,p){i.columnWidthsMap.setValueAtIndex(p,h)})},!0)}},{key:"setupHandlePosition",value:function(i){var o=this;if(i.parentNode){this.currentTH=i;var s=this.hot.view._wt,a=s.wtTable.getCoords(this.currentTH),h=a.col;if(!(h<0)){var p=$i(this.currentTH),g=this.currentTH.getBoundingClientRect(),S=h<s.getSetting("fixedColumnsStart"),T;S&&(T=s.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,a.row,a.col)),T||(T=s.wtOverlays.topOverlay.getRelativeCellPosition(this.currentTH,a.row,a.col)),this.currentCol=this.hot.columnIndexMapper.getVisualFromRenderableIndex(h),this.selectedCols=[];var R=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&R){var A=this.hot.getSelectedRange();Le(A,function($){var j=$.getTopStartCorner().col,z=$.getBottomEndCorner().col;Er(j,z,function(V){o.selectedCols.includes(V)||o.selectedCols.push(V)})})}this.selectedCols.includes(this.currentCol)||(this.selectedCols=[this.currentCol]),this.startOffset=T.start-6,this.startWidth=parseInt(g.width,10),this.handle.style.top="".concat(T.top,"px"),this.handle.style[this.inlineDir]="".concat(this.startOffset+this.startWidth,"px"),this.handle.style.height="".concat(p,"px"),this.hot.rootElement.appendChild(this.handle)}}}},{key:"refreshHandlePosition",value:function(){this.handle.style[this.inlineDir]="".concat(this.startOffset+this.currentWidth,"px")}},{key:"setupGuidePosition",value:function(){var i=parseInt($i(this.handle),10),o=parseInt(this.handle.style.top,10)+i,s=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);Ht(this.handle,"active"),Ht(this.guide,"active"),this.guide.style.top="".concat(o,"px"),this.refreshGuidePosition(),this.guide.style.height="".concat(s-i,"px"),this.hot.rootElement.appendChild(this.guide)}},{key:"refreshGuidePosition",value:function(){this.guide.style[this.inlineDir]=this.handle.style[this.inlineDir]}},{key:"hideHandleAndGuide",value:function(){Kr(this.handle,"active"),Kr(this.guide,"active")}},{key:"checkIfColumnHeader",value:function(i){return!!Sp(i,["THEAD"],this.hot.rootElement)}},{key:"getClosestTHParent",value:function(i){return i.tagName!=="TABLE"?i.tagName==="TH"?i:this.getClosestTHParent(i.parentNode):null}},{key:"onMouseOver",value:function(i){if(!Koe(i.target)&&this.checkIfColumnHeader(i.target)){var o=this.getClosestTHParent(i.target);if(!o)return;var s=o.getAttribute("colspan");o&&(s===null||s==="1")&&(this.pressed||this.setupHandlePosition(o))}}},{key:"afterMouseDownTimeout",value:function(){var i=this,o=function(){i.hot.forceFullRender=!0,i.hot.view.render(),i.hot.view.adjustElementsSize(!0)},s=function(p,g){var S=i.hot.runHooks("beforeColumnResize",i.newSize,p,!0);S!==void 0&&(i.newSize=S),i.hot.getSettings().stretchH==="all"?i.clearManualSize(p):i.setManualSize(p,i.newSize),i.saveManualColumnWidths(),i.hot.runHooks("afterColumnResize",i.newSize,p,!0),g&&o()};if(this.dblclick>=2){var a=this.selectedCols.length;a>1?(Le(this.selectedCols,function(h){s(h)}),o()):Le(this.selectedCols,function(h){s(h,!0)})}this.dblclick=0,this.autoresizeTimeout=null}},{key:"onMouseDown",value:function(i){var o=this;Ur(i.target,"manualColumnResizer")&&(this.setupHandlePosition(this.currentTH),this.setupGuidePosition(),this.pressed=!0,this.autoresizeTimeout===null&&(this.autoresizeTimeout=setTimeout(function(){return o.afterMouseDownTimeout()},500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startX=i.pageX,this.newSize=this.startWidth)}},{key:"onMouseMove",value:function(i){var o=this;if(this.pressed){var s=(i.pageX-this.startX)*this.hot.getDirectionFactor();this.currentWidth=this.startWidth+s,Le(this.selectedCols,function(a){o.newSize=o.setManualSize(a,o.currentWidth)}),this.refreshHandlePosition(),this.refreshGuidePosition()}}},{key:"onMouseUp",value:function(){var i=this,o=function(){i.hot.forceFullRender=!0,i.hot.view.render(),i.hot.view.adjustElementsSize(!0)},s=function(p,g){i.hot.runHooks("beforeColumnResize",i.newSize,p,!1),g&&o(),i.saveManualColumnWidths(),i.hot.runHooks("afterColumnResize",i.newSize,p,!1)};if(this.pressed){if(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startWidth){var a=this.selectedCols.length;a>1?(Le(this.selectedCols,function(h){s(h)}),o()):Le(this.selectedCols,function(h){s(h,!0)})}this.setupHandlePosition(this.currentTH)}}},{key:"bindEvents",value:function(){var i=this,o=this.hot,s=o.rootWindow,a=o.rootElement;this.eventManager.addEventListener(a,"mouseover",function(h){return i.onMouseOver(h)}),this.eventManager.addEventListener(a,"mousedown",function(h){return i.onMouseDown(h)}),this.eventManager.addEventListener(s,"mousemove",function(h){return i.onMouseMove(h)}),this.eventManager.addEventListener(s,"mouseup",function(){return i.onMouseUp()})}},{key:"onModifyColWidth",value:function(i,o){var s=i;if(this.enabled){var a=this.hot.toPhysicalColumn(o),h=this.columnWidthsMap.getValueAtIndex(a);this.hot.getSettings()[kO]&&h&&(s=h)}return s}},{key:"onBeforeStretchingColumnWidth",value:function(i,o){var s=this.columnWidthsMap.getValueAtIndex(o);return s===null&&(s=i),s}},{key:"onBeforeColumnResize",value:function(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}},{key:"destroy",value:function(){up(dc(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return kO}},{key:"PLUGIN_PRIORITY",get:function(){return Kft}}]),r}(Wn);function hx(e){"@babel/helpers - typeof";return hx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hx(e)}function Xft(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function lJ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Jft(n.key),n)}}function Zft(e,t,r){return t&&lJ(e.prototype,t),r&&lJ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Jft(e){var t=Qft(e,"string");return hx(t)==="symbol"?t:String(t)}function Qft(e,t){if(hx(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(hx(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var x2=0,uJ=1,cJ=2,Ny="px",eht=function(){function e(t){Xft(this,e),this.hot=t,this._element=null,this.state=x2}return Zft(e,[{key:"appendTo",value:function(r){r.appendChild(this._element),this.state=cJ}},{key:"build",value:function(){this.state===x2&&(this._element=this.hot.rootDocument.createElement("div"),this.state=uJ)}},{key:"destroy",value:function(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=x2}},{key:"isAppended",value:function(){return this.state===cJ}},{key:"isBuilt",value:function(){return this.state>=uJ}},{key:"setPosition",value:function(r,n){r!==void 0&&(this._element.style.top=r+Ny),n!==void 0&&(this._element.style.left=n+Ny)}},{key:"getPosition",value:function(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}},{key:"setSize",value:function(r,n){r&&(this._element.style.width=r+Ny),n&&(this._element.style.height=n+Ny)}},{key:"getSize",value:function(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}},{key:"setOffset",value:function(r,n){r&&(this._element.style.marginTop=r+Ny),n&&(this._element.style.marginLeft=n+Ny)}},{key:"getOffset",value:function(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}}]),e}();const $ue=eht;function b_(e){"@babel/helpers - typeof";return b_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},b_(e)}function tht(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fJ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,nht(n.key),n)}}function rht(e,t,r){return t&&fJ(e.prototype,t),r&&fJ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function nht(e){var t=iht(e,"string");return b_(t)==="symbol"?t:String(t)}function iht(e,t){if(b_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(b_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function IR(){return typeof Reflect<"u"&&Reflect.get?IR=Reflect.get.bind():IR=function(t,r,n){var i=oht(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},IR.apply(this,arguments)}function oht(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=w_(e),e!==null););return e}function aht(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Jj(e,t)}function Jj(e,t){return Jj=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Jj(e,t)}function sht(e){var t=cht();return function(){var n=w_(e),i;if(t){var o=w_(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return lht(this,i)}}function lht(e,t){if(t&&(b_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return uht(e)}function uht(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function cht(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function w_(e){return w_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},w_(e)}var fht="ht__manualRowMove--backlight",hht=function(e){aht(r,e);var t=sht(r);function r(){return tht(this,r),t.apply(this,arguments)}return rht(r,[{key:"build",value:function(){IR(w_(r.prototype),"build",this).call(this),Ht(this._element,fht)}}]),r}($ue);const dht=hht;function S_(e){"@babel/helpers - typeof";return S_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},S_(e)}function pht(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function hJ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,yht(n.key),n)}}function mht(e,t,r){return t&&hJ(e.prototype,t),r&&hJ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function yht(e){var t=ght(e,"string");return S_(t)==="symbol"?t:String(t)}function ght(e,t){if(S_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(S_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function MR(){return typeof Reflect<"u"&&Reflect.get?MR=Reflect.get.bind():MR=function(t,r,n){var i=vht(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},MR.apply(this,arguments)}function vht(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=x_(e),e!==null););return e}function _ht(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Qj(e,t)}function Qj(e,t){return Qj=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Qj(e,t)}function bht(e){var t=xht();return function(){var n=x_(e),i;if(t){var o=x_(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return wht(this,i)}}function wht(e,t){if(t&&(S_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Sht(e)}function Sht(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function xht(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function x_(e){return x_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},x_(e)}var Cht="ht__manualRowMove--guideline",Eht=function(e){_ht(r,e);var t=bht(r);function r(){return pht(this,r),t.apply(this,arguments)}return mht(r,[{key:"build",value:function(){MR(x_(r.prototype),"build",this).call(this),Ht(this._element,Cht)}}]),r}($ue);const Tht=Eht;function C_(e){"@babel/helpers - typeof";return C_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},C_(e)}function Oht(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dJ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,kht(n.key),n)}}function Rht(e,t,r){return t&&dJ(e.prototype,t),r&&dJ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function kht(e){var t=Pht(e,"string");return C_(t)==="symbol"?t:String(t)}function Pht(e,t){if(C_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(C_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function cp(){return typeof Reflect<"u"&&Reflect.get?cp=Reflect.get.bind():cp=function(t,r,n){var i=Aht(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},cp.apply(this,arguments)}function Aht(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=pc(e),e!==null););return e}function Iht(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ez(e,t)}function ez(e,t){return ez=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},ez(e,t)}function Mht(e){var t=$ht();return function(){var n=pc(e),i;if(t){var o=pc(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Dht(this,i)}}function Dht(e,t){if(t&&(C_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return tz(e)}function tz(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function $ht(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function pc(e){return pc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},pc(e)}mr.getSingleton().register("beforeRowMove");mr.getSingleton().register("afterRowMove");var C2="manualRowMove",Lht=140,Tf=new WeakMap,pJ="ht__manualRowMove",PO="show-ui",E2="on-moving--rows",T2="after-selection--rows",Nht=function(e){Iht(r,e);var t=Mht(r);function r(n){var i;return Oht(this,r),i=t.call(this,n),Tf.set(tz(i),{rowsToMove:[],pressed:void 0,target:{eventPageY:void 0,coords:void 0,TD:void 0,row:void 0},cachedDropIndex:void 0}),i.eventManager=new Bi(tz(i)),i.backlight=new dht(n),i.guideline=new Tht(n),i}return Rht(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[C2]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){return i.onBeforeOnCellMouseDown.apply(i,arguments)}),this.addHook("beforeOnCellMouseOver",function(){return i.onBeforeOnCellMouseOver.apply(i,arguments)}),this.addHook("afterScrollHorizontally",function(){return i.onAfterScrollHorizontally()}),this.addHook("afterLoadData",function(){return i.onAfterLoadData.apply(i,arguments)}),this.buildPluginUI(),this.registerEvents(),Ht(this.hot.rootElement,pJ),cp(pc(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),cp(pc(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){Kr(this.hot.rootElement,pJ),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),cp(pc(r.prototype),"disablePlugin",this).call(this)}},{key:"moveRow",value:function(i,o){return this.moveRows([i],o)}},{key:"moveRows",value:function(i,o){var s=Tf.get(this),a=s.cachedDropIndex,h=this.isMovePossible(i,o),p=this.hot.runHooks("beforeRowMove",i,o,a,h);if(s.cachedDropIndex=void 0,p!==!1){h&&this.hot.rowIndexMapper.moveIndexes(i,o);var g=h&&this.isRowOrderChanged(i,o);return this.hot.runHooks("afterRowMove",i,o,a,h,g),g}}},{key:"dragRow",value:function(i,o){return this.dragRows([i],o)}},{key:"dragRows",value:function(i,o){var s=this.countFinalIndex(i,o),a=Tf.get(this);return a.cachedDropIndex=o,this.moveRows(i,s)}},{key:"isMovePossible",value:function(i,o){var s=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),a=i.length+o>s,h=o<0,p=i.some(function(S){return S<0}),g=i.some(function(S){return S>=s});return!(a||h||p||g)}},{key:"isRowOrderChanged",value:function(i,o){return i.some(function(s,a){return s-a!==o})}},{key:"countFinalIndex",value:function(i,o){var s=na(i,function(a,h){return h<o&&(a+=1),a},0);return o-s}},{key:"getRowsHeight",value:function(i,o){for(var s=this.hot.rowIndexMapper,a=0,h=i;h<=o;h++){var p=s.getRenderableFromVisualIndex(h);p!==null&&(a+=this.hot.view._wt.wtTable.getRowHeight(p)||23)}return a}},{key:"moveBySettingsOrLoad",value:function(){var i=this.hot.getSettings()[C2];if(Array.isArray(i))this.moveRows(i,0);else if(i!==void 0){var o=this.persistentStateLoad();o.length&&this.moveRows(o,0)}}},{key:"isFixedRowTop",value:function(i){return i<this.hot.getSettings().fixedRowsTop}},{key:"isFixedRowBottom",value:function(i){return i>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}},{key:"persistentStateSave",value:function(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}},{key:"persistentStateLoad",value:function(){var i={};return this.hot.runHooks("persistentStateLoad","manualRowMove",i),i.value?i.value:[]}},{key:"prepareRowsToMoving",value:function(){var i=this.hot.getSelectedRangeLast(),o=[];if(!i)return o;var s=i.from,a=i.to,h=Math.min(s.row,a.row),p=Math.max(s.row,a.row);return Er(h,p,function(g){o.push(g)}),o}},{key:"refreshPositions",value:function(){var i=Tf.get(this),o=i.target.coords,s=this.hot.view.getFirstFullyVisibleRow(),a=this.hot.view.getLastFullyVisibleRow(),h=this.hot.countRows();this.isFixedRowTop(o.row)&&s>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(s-1,-1)),this.isFixedRowBottom(o.row)&&a<h&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(a+1,1),void 0,!0);var p=this.hot.view._wt.wtTable,g=i.target.TD,S=io(this.hot.rootElement),T=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,o.row-1),R=i.target.eventPageY-S.top+p.holder.scrollTop,A=p.hider.offsetHeight,$=p.TBODY.offsetTop,j=this.backlight.getOffset().top,z=this.backlight.getSize().height;this.isFixedRowTop(o.row)&&(T+=p.holder.scrollTop),o.row<0?i.target.row=s>0?s-1:s:g.offsetHeight/2+T<=R?(i.target.row=o.row+1,T+=o.row===0?g.offsetHeight-1:g.offsetHeight):i.target.row=o.row;var V=R,G=T;R+z+j>=A?V=A-z-j:R+j<$&&(V=$+Math.abs(j)),T>=A-1&&(G=A-1),this.backlight.setPosition(V),this.guideline.setPosition(G)}},{key:"registerEvents",value:function(){var i=this,o=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(o,"mousemove",function(s){return i.onMouseMove(s)}),this.eventManager.addEventListener(o,"mouseup",function(){return i.onMouseUp()})}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"onBeforeOnCellMouseDown",value:function(i,o,s,a){var h=this.hot.view._wt,p=h.wtTable,g=h.wtViewport,S=this.hot.selection.isSelectedByRowHeader(),T=this.hot.getSelectedRangeLast(),R=Tf.get(this);if(!T||!S||R.pressed||i.button!==0){R.pressed=!1,R.rowsToMove.length=0,Kr(this.hot.rootElement,[E2,PO]);return}var A=this.guideline.isBuilt()&&!this.guideline.isAppended(),$=this.backlight.isBuilt()&&!this.backlight.isAppended();A&&$&&(this.guideline.appendTo(p.hider),this.backlight.appendTo(p.hider));var j=T.from,z=T.to,V=Math.min(j.row,z.row),G=Math.max(j.row,z.row);if(o.col<0&&o.row>=V&&o.row<=G){a.row=!0,R.pressed=!0,R.target.eventPageY=i.pageY,R.target.coords=o,R.target.TD=s,R.rowsToMove=this.prepareRowsToMoving();var ee=p.holder.scrollLeft+g.getRowHeaderWidth();this.backlight.setPosition(null,ee),this.backlight.setSize(p.hider.offsetWidth-ee,this.getRowsHeight(V,G)),this.backlight.setOffset((this.getRowsHeight(V,o.row-1)+i.offsetY)*-1,null),Ht(this.hot.rootElement,E2),this.refreshPositions()}else Kr(this.hot.rootElement,T2),R.pressed=!1,R.rowsToMove.length=0}},{key:"onMouseMove",value:function(i){var o=Tf.get(this);if(o.pressed){if(i.target===this.backlight.element){var s=this.backlight.getSize().height;this.backlight.setSize(null,0),setTimeout(function(){this.backlight.setPosition(null,s)})}o.target.eventPageY=i.pageY,this.refreshPositions()}}},{key:"onBeforeOnCellMouseOver",value:function(i,o,s,a){var h=this.hot.getSelectedRangeLast(),p=Tf.get(this);!h||!p.pressed||(p.rowsToMove.indexOf(o.row)>-1?Kr(this.hot.rootElement,PO):Ht(this.hot.rootElement,PO),a.row=!0,a.column=!0,a.cell=!0,p.target.coords=o,p.target.TD=s)}},{key:"onMouseUp",value:function(){var i=Tf.get(this),o=i.target.row,s=i.rowsToMove.length;if(i.pressed=!1,i.backlightHeight=0,Kr(this.hot.rootElement,[E2,PO,T2]),this.hot.selection.isSelectedByRowHeader()&&Ht(this.hot.rootElement,T2),!(s<1||o===void 0)){var a=i.rowsToMove[0],h=this.hot.toPhysicalRow(a),p=this.dragRows(i.rowsToMove,o);if(i.rowsToMove.length=0,p===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);var g=this.hot.toVisualRow(h),S=g+s-1;this.hot.selectRows(g,S)}}}},{key:"onAfterScrollHorizontally",value:function(){var i=this.hot.view._wt.wtTable,o=this.hot.view._wt.wtViewport.getRowHeaderWidth(),s=i.holder.scrollLeft,a=o+s;this.backlight.setPosition(null,a),this.backlight.setSize(i.hider.offsetWidth-a)}},{key:"buildPluginUI",value:function(){this.backlight.build(),this.guideline.build()}},{key:"onAfterLoadData",value:function(){this.moveBySettingsOrLoad()}},{key:"destroy",value:function(){this.backlight.destroy(),this.guideline.destroy(),cp(pc(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return C2}},{key:"PLUGIN_PRIORITY",get:function(){return Lht}}]),r}(Wn);function E_(e){"@babel/helpers - typeof";return E_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},E_(e)}function Bht(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mJ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,zht(n.key),n)}}function jht(e,t,r){return t&&mJ(e.prototype,t),r&&mJ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function zht(e){var t=Fht(e,"string");return E_(t)==="symbol"?t:String(t)}function Fht(e,t){if(E_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(E_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function fp(){return typeof Reflect<"u"&&Reflect.get?fp=Reflect.get.bind():fp=function(t,r,n){var i=Hht(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},fp.apply(this,arguments)}function Hht(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=mc(e),e!==null););return e}function Vht(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&rz(e,t)}function rz(e,t){return rz=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},rz(e,t)}function Uht(e){var t=Ght();return function(){var n=mc(e),i;if(t){var o=mc(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Wht(this,i)}}function Wht(e,t){if(t&&(E_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return nz(e)}function nz(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ght(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function mc(e){return mc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},mc(e)}var AO="manualRowResize",Yht=30,yJ="manualRowHeights",O2=new WeakMap,Kht=function(e){Vht(r,e);var t=Uht(r);function r(n){var i;Bht(this,r),i=t.call(this,n);var o=i.hot.rootDocument;return i.currentTH=null,i.currentRow=null,i.selectedRows=[],i.currentHeight=null,i.newSize=null,i.startY=null,i.startHeight=null,i.startOffset=null,i.handle=o.createElement("DIV"),i.guide=o.createElement("DIV"),i.eventManager=new Bi(nz(i)),i.pressed=null,i.dblclick=0,i.autoresizeTimeout=null,i.rowHeightsMap=void 0,O2.set(nz(i),{config:void 0}),Ht(i.handle,"manualRowResizer"),Ht(i.guide,"manualRowResizerGuide"),i}return jht(r,[{key:"inlineDir",get:function(){return this.hot.isRtl()?"right":"left"}},{key:"isEnabled",value:function(){return this.hot.getSettings()[AO]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.rowHeightsMap=new Ch,this.rowHeightsMap.addLocalHook("init",function(){return i.onMapInit()}),this.hot.rowIndexMapper.registerMap(this.pluginName,this.rowHeightsMap),this.addHook("modifyRowHeight",function(o,s){return i.onModifyRowHeight(o,s)}),this.bindEvents(),fp(mc(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),fp(mc(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var i=O2.get(this);i.config=this.rowHeightsMap.getValues(),this.hot.rowIndexMapper.unregisterMap(this.pluginName),fp(mc(r.prototype),"disablePlugin",this).call(this)}},{key:"saveManualRowHeights",value:function(){this.hot.runHooks("persistentStateSave",yJ,this.rowHeightsMap.getValues())}},{key:"loadManualRowHeights",value:function(){var i={};return this.hot.runHooks("persistentStateLoad",yJ,i),i.value}},{key:"setManualSize",value:function(i,o){var s=this.hot.toPhysicalRow(i),a=Math.max(o,Iae.DEFAULT_HEIGHT);return this.rowHeightsMap.setValueAtIndex(s,a),a}},{key:"setupHandlePosition",value:function(i){var o=this;this.currentTH=i;var s=this.hot.view,a=s._wt,h=a.wtTable.getCoords(this.currentTH),p=h.row;if(!(p<0)){var g=ri(this.currentTH),S=this.currentTH.getBoundingClientRect(),T=p<a.getSetting("fixedRowsTop"),R=p>=s.countNotHiddenRowIndexes(0,1)-a.getSetting("fixedRowsBottom"),A;T?A=a.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,h.row,h.col):R&&(A=a.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,h.row,h.col)),A||(A=a.wtOverlays.inlineStartOverlay.getRelativeCellPosition(this.currentTH,h.row,h.col)),this.currentRow=this.hot.rowIndexMapper.getVisualFromRenderableIndex(p),this.selectedRows=[];var $=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&$){var j=this.hot.getSelectedRange();Le(j,function(z){var V=z.getTopStartCorner().row,G=z.getBottomStartCorner().row;Er(V,G,function(ee){o.selectedRows.includes(ee)||o.selectedRows.push(ee)})})}this.selectedRows.includes(this.currentRow)||(this.selectedRows=[this.currentRow]),this.startOffset=A.top-6,this.startHeight=parseInt(S.height,10),this.handle.style.top="".concat(this.startOffset+this.startHeight,"px"),this.handle.style[this.inlineDir]="".concat(A.start,"px"),this.handle.style.width="".concat(g,"px"),this.hot.rootElement.appendChild(this.handle)}}},{key:"refreshHandlePosition",value:function(){this.handle.style.top="".concat(this.startOffset+this.currentHeight,"px")}},{key:"setupGuidePosition",value:function(){var i=parseInt(ri(this.handle),10),o=parseInt(this.handle.style[this.inlineDir],10)+i,s=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);Ht(this.handle,"active"),Ht(this.guide,"active"),this.guide.style.top=this.handle.style.top,this.guide.style[this.inlineDir]="".concat(o,"px"),this.guide.style.width="".concat(s-i,"px"),this.hot.rootElement.appendChild(this.guide)}},{key:"refreshGuidePosition",value:function(){this.guide.style.top=this.handle.style.top}},{key:"hideHandleAndGuide",value:function(){Kr(this.handle,"active"),Kr(this.guide,"active")}},{key:"checkIfRowHeader",value:function(i){var o,s,a=Sp(i,["TH"],this.hot.rootElement);return a&&((o=i.parentNode)===null||o===void 0||(s=o.parentNode)===null||s===void 0?void 0:s.tagName)==="TBODY"}},{key:"getClosestTHParent",value:function(i){return i.tagName!=="TABLE"?i.tagName==="TH"?i:this.getClosestTHParent(i.parentNode):null}},{key:"getActualRowHeight",value:function(i){var o=this.hot.view._wt.wtTable.getRowHeight(i);return o!==void 0&&this.newSize<o?o:this.newSize}},{key:"onMouseOver",value:function(i){if(!Koe(i.target)&&this.checkIfRowHeader(i.target)){var o=this.getClosestTHParent(i.target);o&&(this.pressed||this.setupHandlePosition(o))}}},{key:"afterMouseDownTimeout",value:function(){var i=this,o=function(){i.hot.forceFullRender=!0,i.hot.view.render(),i.hot.view.adjustElementsSize(!0)},s=function(p,g){var S=i.hot.runHooks("beforeRowResize",i.getActualRowHeight(p),p,!0);S!==void 0&&(i.newSize=S),i.setManualSize(p,i.newSize),i.hot.runHooks("afterRowResize",i.getActualRowHeight(p),p,!0),g&&o()};if(this.dblclick>=2){var a=this.selectedRows.length;a>1?(Le(this.selectedRows,function(h){s(h)}),o()):Le(this.selectedRows,function(h){s(h,!0)})}this.dblclick=0,this.autoresizeTimeout=null}},{key:"onMouseDown",value:function(i){var o=this;Ur(i.target,"manualRowResizer")&&(this.setupHandlePosition(this.currentTH),this.setupGuidePosition(),this.pressed=!0,this.autoresizeTimeout===null&&(this.autoresizeTimeout=setTimeout(function(){return o.afterMouseDownTimeout()},500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startY=i.pageY,this.newSize=this.startHeight)}},{key:"onMouseMove",value:function(i){var o=this;this.pressed&&(this.currentHeight=this.startHeight+(i.pageY-this.startY),Le(this.selectedRows,function(s){o.newSize=o.setManualSize(s,o.currentHeight)}),this.refreshHandlePosition(),this.refreshGuidePosition())}},{key:"onMouseUp",value:function(){var i=this,o=function(){i.hot.forceFullRender=!0,i.hot.view.render(),i.hot.view.adjustElementsSize(!0)},s=function(p,g){i.hot.runHooks("beforeRowResize",i.getActualRowHeight(p),p,!1),g&&o(),i.saveManualRowHeights(),i.hot.runHooks("afterRowResize",i.getActualRowHeight(p),p,!1)};if(this.pressed){if(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startHeight){var a=this.selectedRows.length;a>1?(Le(this.selectedRows,function(h){s(h)}),o()):Le(this.selectedRows,function(h){s(h,!0)})}this.setupHandlePosition(this.currentTH)}}},{key:"bindEvents",value:function(){var i=this,o=this.hot,s=o.rootElement,a=o.rootWindow;this.eventManager.addEventListener(s,"mouseover",function(h){return i.onMouseOver(h)}),this.eventManager.addEventListener(s,"mousedown",function(h){return i.onMouseDown(h)}),this.eventManager.addEventListener(a,"mousemove",function(h){return i.onMouseMove(h)}),this.eventManager.addEventListener(a,"mouseup",function(){return i.onMouseUp()})}},{key:"onModifyRowHeight",value:function(i,o){var s=i;if(this.enabled){var a=this.hot.toPhysicalRow(o),h=this.rowHeightsMap.getValueAtIndex(a);this.hot.getSettings()[AO]&&h&&(s=h)}return s}},{key:"onMapInit",value:function(){var i=this,o=O2.get(this),s=this.hot.getSettings()[AO],a=this.loadManualRowHeights();this.hot.batchExecution(function(){typeof a<"u"?a.forEach(function(h,p){i.rowHeightsMap.setValueAtIndex(p,h)}):Array.isArray(s)?(s.forEach(function(h,p){i.rowHeightsMap.setValueAtIndex(p,h)}),o.config=s):s===!0&&Array.isArray(o.config)&&o.config.forEach(function(h,p){i.rowHeightsMap.setValueAtIndex(p,h)})},!0)}},{key:"destroy",value:function(){fp(mc(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return AO}},{key:"PLUGIN_PRIORITY",get:function(){return Yht}}]),r}(Wn);function dx(e){"@babel/helpers - typeof";return dx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},dx(e)}var gJ,vJ,_J,bJ;function IO(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function qht(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function wJ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Zht(n.key),n)}}function Xht(e,t,r){return t&&wJ(e.prototype,t),r&&wJ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Zht(e){var t=Jht(e,"string");return dx(t)==="symbol"?t:String(t)}function Jht(e,t){if(dx(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(dx(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Qht=function(){function e(t,r,n,i,o,s){qht(this,e),this.row=t,this.col=r,this.rowspan=n,this.colspan=i,this.removed=!1,this.cellCoordsFactory=o,this.cellRangeFactory=s}return Xht(e,[{key:"normalize",value:function(r){var n=r.countRows(),i=r.countCols();this.row<0?this.row=0:this.row>n-1&&(this.row=n-1),this.col<0?this.col=0:this.col>i-1&&(this.col=i-1),this.row+this.rowspan>n-1&&(this.rowspan=n-this.row),this.col+this.colspan>i-1&&(this.colspan=i-this.col)}},{key:"includes",value:function(r,n){return this.row<=r&&this.col<=n&&this.row+this.rowspan-1>=r&&this.col+this.colspan-1>=n}},{key:"includesHorizontally",value:function(r){return this.col<=r&&this.col+this.colspan-1>=r}},{key:"includesVertically",value:function(r){return this.row<=r&&this.row+this.rowspan-1>=r}},{key:"shift",value:function(r,n){var i=r[0]||r[1],o=n+Math.abs(r[0]||r[1])-1,s=r[0]?"colspan":"rowspan",a=r[0]?"col":"row",h=Math.min(n,o),p=Math.max(n,o),g=this[a],S=this[a]+this[s]-1;if(g>=n&&(this[a]+=i),i>0)n<=S&&n>g&&(this[s]+=i);else if(i<0){if(h<=g&&p>=S)return this.removed=!0,!1;if(g>=h&&g<=p){var T=p-g+1,R=Math.abs(i)-T;this[a]-=R+i,this[s]-=T}else if(g<=h&&S>=p)this[s]+=i;else if(g<=h&&S>=h&&S<p){var A=S-h+1;this[s]-=A}}return!0}},{key:"isFarther",value:function(r,n){return r?n==="down"?r.row+r.rowspan-1<this.row+this.rowspan-1:n==="up"?r.row>this.row:n==="right"?r.col+r.colspan-1<this.col+this.colspan-1:n==="left"?r.col>this.col:null:!0}},{key:"getLastRow",value:function(){return this.row+this.rowspan-1}},{key:"getLastColumn",value:function(){return this.col+this.colspan-1}},{key:"getRange",value:function(){return this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))}}],[{key:"NEGATIVE_VALUES_WARNING",value:function(r){return Xn(gJ||(gJ=IO(["The merged cell declared with {row: ",", col: ",`, 
      rowspan: `,", colspan: ",`} contains negative values, which is 
      not supported. It will not be added to the collection.`],["The merged cell declared with {row: ",", col: ",`,\\x20
      rowspan: `,", colspan: ",`} contains negative values, which is\\x20
      not supported. It will not be added to the collection.`])),r.row,r.col,r.rowspan,r.colspan)}},{key:"IS_OUT_OF_BOUNDS_WARNING",value:function(r){return Xn(vJ||(vJ=IO(["The merged cell declared at [",", ",`] is positioned 
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`],["The merged cell declared at [",", ",`] is positioned\\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`])),r.row,r.col)}},{key:"IS_SINGLE_CELL",value:function(r){return Xn(_J||(_J=IO(["The merged cell declared at [",", ",`] has both "rowspan" 
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`],["The merged cell declared at [",", ",`] has both "rowspan"\\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`])),r.row,r.col)}},{key:"ZERO_SPAN_WARNING",value:function(r){return Xn(bJ||(bJ=IO(["The merged cell declared at [",", ",`] has "rowspan" 
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`],["The merged cell declared at [",", ",`] has "rowspan"\\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`])),r.row,r.col)}},{key:"containsNegativeValues",value:function(r){return r.row<0||r.col<0||r.rowspan<0||r.colspan<0}},{key:"isSingleCell",value:function(r){return r.colspan===1&&r.rowspan===1}},{key:"containsZeroSpan",value:function(r){return r.colspan===0||r.rowspan===0}},{key:"isOutOfBounds",value:function(r,n,i){return r.row<0||r.col<0||r.row>=n||r.row+r.rowspan-1>=n||r.col>=i||r.col+r.colspan-1>=i}}]),e}();const Jl=Qht;function iz(e,t,r,n){t?t.row===r&&t.col===n?(e.setAttribute("rowspan",t.rowspan.toString()),e.setAttribute("colspan",t.colspan.toString())):(e.removeAttribute("rowspan"),e.removeAttribute("colspan"),e.style.display="none"):(e.removeAttribute("rowspan"),e.removeAttribute("colspan"),e.style.display="")}function px(e){"@babel/helpers - typeof";return px=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},px(e)}var SJ;function edt(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function xJ(e){return idt(e)||ndt(e)||rdt(e)||tdt()}function tdt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function rdt(e,t){if(e){if(typeof e=="string")return oz(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return oz(e,t)}}function ndt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function idt(e){if(Array.isArray(e))return oz(e)}function oz(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function odt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function CJ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,sdt(n.key),n)}}function adt(e,t,r){return t&&CJ(e.prototype,t),r&&CJ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function sdt(e){var t=ldt(e,"string");return px(t)==="symbol"?t:String(t)}function ldt(e,t){if(px(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(px(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var udt=function(){function e(t){odt(this,e),this.plugin=t,this.mergedCells=[],this.hot=t.hot}return adt(e,[{key:"get",value:function(r,n){var i=this.mergedCells,o=!1;return Le(i,function(s){return s.row<=r&&s.row+s.rowspan-1>=r&&s.col<=n&&s.col+s.colspan-1>=n?(o=s,!1):!0}),o}},{key:"getByRange",value:function(r){var n=this.mergedCells,i=!1;return Le(n,function(o){return o.row<=r.from.row&&o.row+o.rowspan-1>=r.to.row&&o.col<=r.from.col&&o.col+o.colspan-1>=r.to.col?(i=o,i):!0}),i}},{key:"getWithinRange",value:function(r){var n=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,o=this.mergedCells,s=[],a=r;if(!a.includesRange){var h=this.hot._createCellCoords(a.from.row,a.from.col),p=this.hot._createCellCoords(a.to.row,a.to.col);a=this.hot._createCellRange(h,h,p)}return Le(o,function(g){var S=n.hot._createCellCoords(g.row,g.col),T=n.hot._createCellCoords(g.row+g.rowspan-1,g.col+g.colspan-1),R=n.hot._createCellRange(S,S,T);i?a.overlaps(R)&&s.push(g):a.includesRange(R)&&s.push(g)}),s.length?s:!1}},{key:"add",value:function(r){var n=this.mergedCells,i=r.row,o=r.col,s=r.rowspan,a=r.colspan,h=new Jl(i,o,s,a,this.hot._createCellCoords,this.hot._createCellRange),p=this.get(i,o),g=this.isOverlapping(h);return!p&&!g?(this.hot&&h.normalize(this.hot),n.push(h),h):(ti(e.IS_OVERLAPPING_WARNING(h)),!1)}},{key:"remove",value:function(r,n){var i=this.mergedCells,o=this.get(r,n),s=o?this.mergedCells.indexOf(o):-1;return o&&s!==-1?(i.splice(s,1),o):!1}},{key:"clear",value:function(){var r=this,n=this.mergedCells,i=[],o=[];Le(n,function(s){var a=r.hot.getCell(s.row,s.col);a&&i.push([a,r.get(s.row,s.col),s.row,s.col])}),this.mergedCells.length=0,Le(i,function(s,a){Er(0,s.rowspan-1,function(h){Er(0,s.colspan-1,function(p){if(p!==0||h!==0){var g=r.hot.getCell(s.row+h,s.col+p);g&&o.push([g,null,null,null])}})}),i[a][1]=null}),Le(i,function(s){iz.apply(void 0,xJ(s))}),Le(o,function(s){iz.apply(void 0,xJ(s))})}},{key:"isOverlapping",value:function(r){var n=this,i=this.hot._createCellRange(this.hot._createCellCoords(0,0),this.hot._createCellCoords(r.row,r.col),this.hot._createCellCoords(r.row+r.rowspan-1,r.col+r.colspan-1)),o=!1;return Le(this.mergedCells,function(s){var a=n.hot._createCellRange(n.hot._createCellCoords(0,0),n.hot._createCellCoords(s.row,s.col),n.hot._createCellCoords(s.row+s.rowspan-1,s.col+s.colspan-1));return a.overlaps(i)?(o=!0,!1):!0}),o}},{key:"isFirstRenderableMergedCell",value:function(r,n){var i=this.get(r,n);return i&&this.hot.rowIndexMapper.getNearestNotHiddenIndex(i.row,1)===r&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(i.col,1)===n}},{key:"getFirstRenderableCoords",value:function(r,n){var i=this.get(r,n);if(!i||this.isFirstRenderableMergedCell(r,n))return this.hot._createCellCoords(r,n);var o=this.hot.rowIndexMapper.getNearestNotHiddenIndex(i.row,1),s=this.hot.columnIndexMapper.getNearestNotHiddenIndex(i.col,1);return this.hot._createCellCoords(o,s)}},{key:"shiftCollections",value:function(r,n,i){var o=this,s=[0,0];switch(r){case"right":s[0]+=i;break;case"left":s[0]-=i;break;case"down":s[1]+=i;break;case"up":s[1]-=i;break}Le(this.mergedCells,function(a){a.shift(s,n)}),BN(this.mergedCells.length-1,0,function(a){var h=o.mergedCells[a];h&&h.removed&&o.mergedCells.splice(o.mergedCells.indexOf(h),1)})}}],[{key:"IS_OVERLAPPING_WARNING",value:function(r){return Xn(SJ||(SJ=edt(["The merged cell declared at [",", ",`], overlaps 
      with the other declared merged cell. The overlapping merged cell was not added to the table, please 
      fix your setup.`],["The merged cell declared at [",", ",`], overlaps\\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\\x20
      fix your setup.`])),r.row,r.col)}}]),e}();const cdt=udt;function mx(e){"@babel/helpers - typeof";return mx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mx(e)}function kd(e,t){return pdt(e)||ddt(e,t)||hdt(e,t)||fdt()}function fdt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function hdt(e,t){if(e){if(typeof e=="string")return EJ(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return EJ(e,t)}}function EJ(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ddt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],h=!0,p=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;h=!1}else for(;!(h=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);h=!0);}catch(g){p=!0,i=g}finally{try{if(!h&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(p)throw i}}return a}}function pdt(e){if(Array.isArray(e))return e}function mdt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function TJ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,gdt(n.key),n)}}function ydt(e,t,r){return t&&TJ(e.prototype,t),r&&TJ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function gdt(e){var t=vdt(e,"string");return mx(t)==="symbol"?t:String(t)}function vdt(e,t){if(mx(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(mx(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var _dt=function(){function e(t){mdt(this,e),this.plugin=t,this.mergedCellsCollection=this.plugin.mergedCellsCollection,this.currentFillData=null}return ydt(e,[{key:"correctSelectionAreaSize",value:function(r){if(r[0]===r[2]&&r[1]===r[3]){var n=this.mergedCellsCollection.get(r[0],r[1]);n&&(r[2]=r[0]+n.rowspan-1,r[3]=r[1]+n.colspan-1)}}},{key:"getDirection",value:function(r,n){var i=null;return n[0]===r[0]&&n[1]===r[1]&&n[3]===r[3]?i="down":n[2]===r[2]&&n[1]===r[1]&&n[3]===r[3]?i="up":n[1]===r[1]&&n[2]===r[2]?i="right":i="left",i}},{key:"snapDragArea",value:function(r,n,i,o){var s=n.slice(0),a=this.getAutofillSize(r,n,i),h=kd(r,4),p=h[0],g=h[1],S=h[2],T=h[3],R=["up","down"].indexOf(i)>-1,A=R?S-p+1:T-g+1,$=Math.floor(a/A)*A,j=a-$,z=this.getFarthestCollection(r,n,i,o);if(z){if(i==="down"){var V=z.row+z.rowspan-p-j,G=s[2]+V;G>=this.plugin.hot.countRows()?s[2]-=j:s[2]+=j?V:0}else if(i==="right"){var ee=z.col+z.colspan-g-j,K=s[3]+ee;K>=this.plugin.hot.countCols()?s[3]-=j:s[3]+=j?ee:0}else if(i==="up"){var xe=S-j-z.row+1,Me=s[0]+xe;Me<0?s[0]+=j:s[0]-=j?xe:0}else if(i==="left"){var He=T-j-z.col+1,Ne=s[1]+He;Ne<0?s[1]+=j:s[1]-=j?He:0}}return this.updateCurrentFillCache({baseArea:r,dragDirection:i,foundMergedCells:o,fillSize:a,dragArea:s,cycleLength:A}),s}},{key:"updateCurrentFillCache",value:function(r){this.currentFillData||(this.currentFillData={}),ao(this.currentFillData,r)}},{key:"getAutofillSize",value:function(r,n,i){var o=kd(r,4),s=o[0],a=o[1],h=o[2],p=o[3],g=kd(n,4),S=g[0],T=g[1],R=g[2],A=g[3];switch(i){case"up":return s-S;case"down":return R-h;case"left":return a-T;case"right":return A-p;default:return null}}},{key:"getDragArea",value:function(r,n,i){var o=kd(r,4),s=o[0],a=o[1],h=o[2],p=o[3],g=kd(n,4),S=g[0],T=g[1],R=g[2],A=g[3];switch(i){case"up":return[S,T,s-1,p];case"down":return[h+1,a,R,p];case"left":return[S,T,h,a-1];case"right":return[s,p+1,R,A];default:return null}}},{key:"getFarthestCollection",value:function(r,n,i,o){var s=kd(r,4),a=s[0],h=s[1],p=s[2],g=s[3],S=["up","down"].indexOf(i)>-1,T=S?p:g,R=S?a:h,A=this.getAutofillSize(r,n,i),$=S?p-a+1:g-h+1,j=Math.floor(A/$)*$,z=A-j,V=null,G=null,ee=null;switch(i){case"up":V="includesVertically",ee=T-z+1;break;case"left":V="includesHorizontally",ee=T-z+1;break;case"down":V="includesVertically",ee=R+z-1;break;case"right":V="includesHorizontally",ee=R+z-1;break}return Le(o,function(K){K[V](ee)&&K.isFarther(G,i)&&(G=K)}),G}},{key:"recreateAfterDataPopulation",value:function(r){if(this.currentFillData){var n=this.getRangeFromChanges(r),i=this.currentFillData.foundMergedCells,o=this.currentFillData.dragDirection,s=function(T,R){switch(o){case"up":return T.row-R>=n.from.row;case"down":return T.row+T.rowspan-1+R<=n.to.row;case"left":return T.col-R>=n.from.column;case"right":return T.col+T.colspan-1+R<=n.to.column;default:return null}},a=0,h=null,p=1;do for(var g=0;g<i.length;g+=1){if(h=i[g],a=p*this.currentFillData.cycleLength,s(h,a))switch(o){case"up":this.plugin.mergedCellsCollection.add({row:h.row-a,rowspan:h.rowspan,col:h.col,colspan:h.colspan});break;case"down":this.plugin.mergedCellsCollection.add({row:h.row+a,rowspan:h.rowspan,col:h.col,colspan:h.colspan});break;case"left":this.plugin.mergedCellsCollection.add({row:h.row,rowspan:h.rowspan,col:h.col-a,colspan:h.colspan});break;case"right":this.plugin.mergedCellsCollection.add({row:h.row,rowspan:h.rowspan,col:h.col+a,colspan:h.colspan});break}g===i.length-1&&(p+=1)}while(s(h,a));this.currentFillData=null,this.plugin.hot.render(),i.length>0&&this.plugin.ifChromeForceRepaint()}}},{key:"getRangeFromChanges",value:function(r){var n=this,i={min:null,max:null},o={min:null,max:null};return Le(r,function(s){var a=s[0],h=n.plugin.hot.propToCol(s[1]);(i.min===null||a<i.min)&&(i.min=a),(i.max===null||a>i.max)&&(i.max=a),(o.min===null||h<o.min)&&(o.min=h),(o.max===null||h>o.max)&&(o.max=h)}),{from:{row:i.min,column:o.min},to:{row:i.max,column:o.max}}}},{key:"dragAreaOverlapsCollections",value:function(r,n,i){var o=this.getDragArea(r,n,i),s=kd(o,4),a=s[0],h=s[1],p=s[2],g=s[3],S=this.plugin.hot._createCellCoords(a,h),T=this.plugin.hot._createCellCoords(p,g),R=this.plugin.hot._createCellRange(S,S,T);return!!this.mergedCellsCollection.getWithinRange(R,!0)}}]),e}();const bdt=_dt;function yx(e){"@babel/helpers - typeof";return yx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yx(e)}function wdt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function OJ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,xdt(n.key),n)}}function Sdt(e,t,r){return t&&OJ(e.prototype,t),r&&OJ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function xdt(e){var t=Cdt(e,"string");return yx(t)==="symbol"?t:String(t)}function Cdt(e,t){if(yx(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(yx(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Edt=function(){function e(t){wdt(this,e),this.plugin=t,this.hot=t.hot,this.fullySelectedMergedCellClassName="fullySelectedMergedCell"}return Sdt(e,[{key:"snapDelta",value:function(r,n,i){var o=n.to,s=o.row+r.row,a=o.col+r.col;r.row?this.jumpOverMergedCell(r,i,s):r.col&&this.jumpOverMergedCell(r,i,a)}},{key:"jumpOverMergedCell",value:function(r,n,i){var o=r.row||r.col,s=null,a=null,h=null;r.row?(s=n.includesVertically(i),a=n.row,h=n.getLastRow()):r.col&&(s=n.includesHorizontally(i),a=n.col,h=n.getLastColumn()),o!==0&&(o>0?s&&i!==a&&(o+=h-i+1):s&&i!==h&&(o-=i-a+1),r.row?r.row=o:r.col&&(r.col=o))}},{key:"getUpdatedSelectionRange",value:function(r,n){return this.hot._createCellRange(r.highlight,r.from,this.hot._createCellCoords(r.to.row+n.row,r.to.col+n.col))}},{key:"getSelectedMergedCellClassName",value:function(r,n,i,o){var s=Math.min(i[0],i[2]),a=Math.min(i[1],i[3]),h=Math.max(i[0],i[2]),p=Math.max(i[1],i[3]);if(o!==void 0){var g=this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(r,n);if(g){var S=this.plugin.mergedCellsCollection.get(r,n);if(S){var T=S.getLastRow(),R=S.getLastColumn(),A=s<=S.row&&a<=S.col&&h>=T&&p>=R;if(A)return"".concat(this.fullySelectedMergedCellClassName,"-").concat(o);if(this.plugin.selectionCalculations.isMergeCellFullySelected(S,this.plugin.hot.getSelectedRange()))return"".concat(this.fullySelectedMergedCellClassName,"-multiple")}}}}},{key:"isMergeCellFullySelected",value:function(r,n){var i=[];if(!n||!r)return!1;for(var o=0;o<r.rowspan;o+=1)for(var s=0;s<r.colspan;s+=1)i.push(this.hot._createCellCoords(r.row+o,r.col+s));for(var a=0;a<i.length;a+=1){for(var h=[],p=0;p<n.length;p+=1)h[p]=n[p].includes(i[a]);if(!h.includes(!0))return!1}return!0}},{key:"getSelectedMergedCellClassNameToRemove",value:function(){for(var r=[],n=0;n<=7;n+=1)r.push("".concat(this.fullySelectedMergedCellClassName,"-").concat(n));return r.push("".concat(this.fullySelectedMergedCellClassName,"-multiple")),r}}]),e}();const Tdt=Edt;function Odt(e){return{key:"mergeCells",name:function(){var r=this.getSelectedLast();if(r){var n=e.mergedCellsCollection.get(r[0],r[1]);if(n.row===r[0]&&n.col===r[1]&&n.row+n.rowspan-1===r[2]&&n.col+n.colspan-1===r[3])return this.getTranslatedPhrase(iV)}return this.getTranslatedPhrase(nV)},callback:function(){e.toggleMergeOnSelection()},disabled:function(){var r=this.getSelectedLast();if(!r)return!0;var n=Jl.isSingleCell({row:r[0],col:r[1],rowspan:r[2]-r[0]+1,colspan:r[3]-r[1]+1});return n||this.selection.isSelectedByCorner()},hidden:!1}}function T_(e){"@babel/helpers - typeof";return T_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},T_(e)}function Rdt(e,t){return Adt(e)||Pdt(e,t)||Lue(e,t)||kdt()}function kdt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Pdt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],h=!0,p=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;h=!1}else for(;!(h=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);h=!0);}catch(g){p=!0,i=g}finally{try{if(!h&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(p)throw i}}return a}}function Adt(e){if(Array.isArray(e))return e}function Idt(e){return $dt(e)||Ddt(e)||Lue(e)||Mdt()}function Mdt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Lue(e,t){if(e){if(typeof e=="string")return az(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return az(e,t)}}function Ddt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function $dt(e){if(Array.isArray(e))return az(e)}function az(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Ldt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function RJ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Bdt(n.key),n)}}function Ndt(e,t,r){return t&&RJ(e.prototype,t),r&&RJ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Bdt(e){var t=jdt(e,"string");return T_(t)==="symbol"?t:String(t)}function jdt(e,t){if(T_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(T_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Rg(){return typeof Reflect<"u"&&Reflect.get?Rg=Reflect.get.bind():Rg=function(t,r,n){var i=zdt(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Rg.apply(this,arguments)}function zdt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=fh(e),e!==null););return e}function Fdt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&sz(e,t)}function sz(e,t){return sz=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},sz(e,t)}function Hdt(e){var t=Udt();return function(){var n=fh(e),i;if(t){var o=fh(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Vdt(this,i)}}function Vdt(e,t){if(t&&(T_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Nue(e)}function Nue(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Udt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function fh(e){return fh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},fh(e)}mr.getSingleton().register("beforeMergeCells");mr.getSingleton().register("afterMergeCells");mr.getSingleton().register("beforeUnmergeCells");mr.getSingleton().register("afterUnmergeCells");var E0="mergeCells",Wdt=150,kJ=new WeakMap,PJ=E0,Gdt=function(e){Fdt(r,e);var t=Hdt(r);function r(n){var i;return Ldt(this,r),i=t.call(this,n),kJ.set(Nue(i),{lastDesiredCoords:null}),i.mergedCellsCollection=null,i.autofillCalculations=null,i.selectionCalculations=null,i}return Ndt(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[E0]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.mergedCellsCollection=new cdt(this),this.autofillCalculations=new bdt(this),this.selectionCalculations=new Tdt(this),this.addHook("afterInit",function(){return i.onAfterInit.apply(i,arguments)}),this.addHook("modifyTransformStart",function(){return i.onModifyTransformStart.apply(i,arguments)}),this.addHook("afterModifyTransformStart",function(){return i.onAfterModifyTransformStart.apply(i,arguments)}),this.addHook("modifyTransformEnd",function(){return i.onModifyTransformEnd.apply(i,arguments)}),this.addHook("modifyGetCellCoords",function(){return i.onModifyGetCellCoords.apply(i,arguments)}),this.addHook("beforeSetRangeStart",function(){return i.onBeforeSetRangeStart.apply(i,arguments)}),this.addHook("beforeSetRangeStartOnly",function(){return i.onBeforeSetRangeStart.apply(i,arguments)}),this.addHook("beforeSetRangeEnd",function(){return i.onBeforeSetRangeEnd.apply(i,arguments)}),this.addHook("afterIsMultipleSelection",function(){return i.onAfterIsMultipleSelection.apply(i,arguments)}),this.addHook("afterRenderer",function(){return i.onAfterRenderer.apply(i,arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){return i.addMergeActionsToContextMenu.apply(i,arguments)}),this.addHook("afterGetCellMeta",function(){return i.onAfterGetCellMeta.apply(i,arguments)}),this.addHook("afterViewportRowCalculatorOverride",function(){return i.onAfterViewportRowCalculatorOverride.apply(i,arguments)}),this.addHook("afterViewportColumnCalculatorOverride",function(){return i.onAfterViewportColumnCalculatorOverride.apply(i,arguments)}),this.addHook("modifyAutofillRange",function(){return i.onModifyAutofillRange.apply(i,arguments)}),this.addHook("afterCreateCol",function(){return i.onAfterCreateCol.apply(i,arguments)}),this.addHook("afterRemoveCol",function(){return i.onAfterRemoveCol.apply(i,arguments)}),this.addHook("afterCreateRow",function(){return i.onAfterCreateRow.apply(i,arguments)}),this.addHook("afterRemoveRow",function(){return i.onAfterRemoveRow.apply(i,arguments)}),this.addHook("afterChange",function(){return i.onAfterChange.apply(i,arguments)}),this.addHook("beforeDrawBorders",function(){return i.onBeforeDrawAreaBorders.apply(i,arguments)}),this.addHook("afterDrawSelection",function(){return i.onAfterDrawSelection.apply(i,arguments)}),this.addHook("beforeRemoveCellClassNames",function(){return i.onBeforeRemoveCellClassNames.apply(i,arguments)}),this.addHook("beforeUndoStackChange",function(o,s){if(s==="MergeCells")return!1}),this.registerShortcuts(),Rg(fh(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),Rg(fh(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){var i=this.hot.getSettings()[E0];this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(i),Rg(fh(r.prototype),"updatePlugin",this).call(this)}},{key:"ifChromeForceRepaint",value:function(){var i=this;if(Aoe()){var o=[],s=[];this.mergedCellsCollection.mergedCells.forEach(function(a){for(var h=a.row,p=a.rowspan,g=h+1;g<h+p;g++)s.push(g)}),s=Idt(new Set(s)),s.forEach(function(a){var h=i.hot.rowIndexMapper.getRenderableFromVisualIndex(a);i.hot.view._wt.wtOverlays.getOverlays(!0).map(function(p){return(p==null?void 0:p.name)==="master"?p:p.clone.wtTable}).forEach(function(p){var g=p.getRow(h);g&&(g.style.background=PS(g,"backgroundColor").replace(")",", 0.99)"),o.push(g))})}),this.hot._registerTimeout(function(){o.forEach(function(a){a.style.background=PS(a,"backgroundColor").replace(", 0.99)",")")})},1)}}},{key:"validateSetting",value:function(i){var o=!0;return i?(Jl.containsNegativeValues(i)?(ti(Jl.NEGATIVE_VALUES_WARNING(i)),o=!1):Jl.isOutOfBounds(i,this.hot.countRows(),this.hot.countCols())?(ti(Jl.IS_OUT_OF_BOUNDS_WARNING(i)),o=!1):Jl.isSingleCell(i)?(ti(Jl.IS_SINGLE_CELL(i)),o=!1):Jl.containsZeroSpan(i)&&(ti(Jl.ZERO_SPAN_WARNING(i)),o=!1),o):!1}},{key:"generateFromSettings",value:function(i){var o=this;if(Array.isArray(i)){var s=[];if(Le(i,function(a){if(o.validateSetting(a)){var h=o.hot._createCellCoords(a.row,a.col),p=o.hot._createCellCoords(a.row+a.rowspan-1,a.col+a.colspan-1),g=o.hot._createCellRange(h,h,p);o.mergeRange(g,!0,!0),Er(a.row,a.row+a.rowspan-1,function(S){Er(a.col,a.col+a.colspan-1,function(T){S===a.row&&T===a.col||s.push([S,T,null])})})}}),s.length===0)return;this.hot.setDataAtCell(s)}}},{key:"clearCollections",value:function(){this.mergedCellsCollection.clear()}},{key:"canMergeRange",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return o?!0:this.validateSetting(i)}},{key:"toggleMergeOnSelection",value:function(){var i=this.hot.getSelectedRangeLast();if(i){i.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");var o=i.from,s=i.to;this.toggleMerge(i),this.hot.selectCell(o.row,o.col,s.row,s.col,!1)}}},{key:"mergeSelection",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(i){i.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");var o=i.from,s=i.to;this.unmergeRange(i,!0),this.mergeRange(i),this.hot.selectCell(o.row,o.col,s.row,s.col,!1)}}},{key:"unmergeSelection",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(i){var o=i.from,s=i.to;this.unmergeRange(i,!0),this.hot.selectCell(o.row,o.col,s.row,s.col,!1)}}},{key:"mergeRange",value:function(i){var o=this,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,h=i.getTopStartCorner(),p=i.getBottomEndCorner(),g={row:h.row,col:h.col,rowspan:p.row-h.row+1,colspan:p.col-h.col+1},S=[],T=null;if(!this.canMergeRange(g,s))return!1;this.hot.runHooks("beforeMergeCells",i,s),Er(0,g.rowspan-1,function(A){Er(0,g.colspan-1,function($){var j=null;S[A]||(S[A]=[]),A===0&&$===0?j=o.hot.getSourceDataAtCell(o.hot.toPhysicalRow(g.row),o.hot.toPhysicalColumn(g.col)):o.hot.setCellMeta(g.row+A,g.col+$,"hidden",!0),S[A][$]=j})}),this.hot.setCellMeta(g.row,g.col,"spanned",!0);var R=this.mergedCellsCollection.add(g);return R?(a?T=[g.row,g.col,S]:this.hot.populateFromArray(g.row,g.col,S,void 0,void 0,this.pluginName),s||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",i,g,s),T):!0}},{key:"unmergeRange",value:function(i){var o=this,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,a=this.mergedCellsCollection.getWithinRange(i);a&&(this.hot.runHooks("beforeUnmergeCells",i,s),Le(a,function(h){o.mergedCellsCollection.remove(h.row,h.col),Er(0,h.rowspan-1,function(p){Er(0,h.colspan-1,function(g){o.hot.removeCellMeta(h.row+p,h.col+g,"hidden")})}),o.hot.removeCellMeta(h.row,h.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",i,s),this.hot.render())}},{key:"toggleMerge",value:function(i){var o=this.mergedCellsCollection.get(i.from.row,i.from.col),s=o.row===i.from.row&&o.col===i.from.col&&o.row+o.rowspan-1===i.to.row&&o.col+o.colspan-1===i.to.col;s?this.unmergeRange(i):this.mergeSelection(i)}},{key:"merge",value:function(i,o,s,a){var h=this.hot._createCellCoords(i,o),p=this.hot._createCellCoords(s,a);this.mergeRange(this.hot._createCellRange(h,h,p))}},{key:"unmerge",value:function(i,o,s,a){var h=this.hot._createCellCoords(i,o),p=this.hot._createCellCoords(s,a);this.unmergeRange(this.hot._createCellRange(h,h,p))}},{key:"onAfterInit",value:function(){this.generateFromSettings(this.hot.getSettings()[E0]),this.hot.render()}},{key:"registerShortcuts",value:function(){var i=this,o=this.hot.getShortcutManager(),s=o.getContext("grid");s.addShortcut({keys:[["Control","m"]],callback:function(){i.toggleMerge(i.hot.getSelectedRangeLast()),i.hot.render()},runOnlyIf:function(h){return!h.altKey},group:PJ})}},{key:"unregisterShortcuts",value:function(){var i=this.hot.getShortcutManager(),o=i.getContext("grid");o.removeShortcutsByGroup(PJ)}},{key:"onAfterIsMultipleSelection",value:function(i){if(i){for(var o=this.mergedCellsCollection.mergedCells,s=this.hot.getSelectedRangeLast(),a=0;a<o.length;a+=1)if(s.from.row===o[a].row&&s.from.col===o[a].col&&s.to.row===o[a].row+o[a].rowspan-1&&s.to.col===o[a].col+o[a].colspan-1)return!1}return i}},{key:"onModifyTransformStart",value:function(i){var o=kJ.get(this),s=this.hot.getSelectedRangeLast(),a={row:i.row,col:i.col},h=null,p=this.hot._createCellCoords(s.highlight.row,s.highlight.col),g=this.mergedCellsCollection.get(p.row,p.col);if(o.lastDesiredCoords||(o.lastDesiredCoords=this.hot._createCellCoords(null,null)),g){var S=this.hot._createCellCoords(g.row,g.col),T=this.hot._createCellCoords(g.row+g.rowspan-1,g.col+g.colspan-1),R=this.hot._createCellRange(S,S,T);R.includes(o.lastDesiredCoords)||(o.lastDesiredCoords=this.hot._createCellCoords(null,null)),a.row=o.lastDesiredCoords.row?o.lastDesiredCoords.row-p.row:a.row,a.col=o.lastDesiredCoords.col?o.lastDesiredCoords.col-p.col:a.col,i.row>0?a.row=g.row+g.rowspan-1-p.row+i.row:i.row<0&&(a.row=p.row-g.row+i.row),i.col>0?a.col=g.col+g.colspan-1-p.col+i.col:i.col<0&&(a.col=p.col-g.col+i.col)}h=this.hot._createCellCoords(s.highlight.row+a.row,s.highlight.col+a.col);var A=this.mergedCellsCollection.get(h.row,h.col);if(A){var $=this.mergedCellsCollection.getFirstRenderableCoords(A.row,A.col);o.lastDesiredCoords=h,a={row:$.row-p.row,col:$.col-p.col}}a.row!==0&&(i.row=a.row),a.col!==0&&(i.col=a.col)}},{key:"onModifyTransformEnd",value:function(i){var o=this,s=this.hot.getSelectedRangeLast(),a=Na(i),h=this.selectionCalculations.getUpdatedSelectionRange(s,i),p=Na(a),g=this.mergedCellsCollection.getWithinRange(h,!0);do p=Na(a),this.selectionCalculations.getUpdatedSelectionRange(s,a),Le(g,function(S){o.selectionCalculations.snapDelta(a,s,S)});while(a.row!==p.row||a.col!==p.col);i.row=a.row,i.col=a.col}},{key:"onModifyGetCellCoords",value:function(i,o){if(!(i<0||o<0)){var s=this.mergedCellsCollection.get(i,o);if(s){var a=s.row,h=s.col,p=s.colspan,g=s.rowspan;return[a,h,a+g-1,h+p-1]}}}},{key:"addMergeActionsToContextMenu",value:function(i){i.items.push({name:"---------"},Odt(this))}},{key:"onAfterRenderer",value:function(i,o,s){var a=this.mergedCellsCollection.get(o,s),h=dn(a)?Na(a):void 0;if(dn(h)){var p=this.hot,g=p.rowIndexMapper,S=p.columnIndexMapper,T=h.row,R=h.col,A=h.colspan,$=h.rowspan,j=this.translateMergedCellToRenderable(T,$,R,A),z=Rdt(j,2),V=z[0],G=z[1],ee=g.getRenderableFromVisualIndex(o),K=S.getRenderableFromVisualIndex(s),xe=V-ee+1,Me=G-K+1;h.row=g.getNearestNotHiddenIndex(h.row,1),h.col=S.getNearestNotHiddenIndex(h.col,1),h.rowspan=Math.min(h.rowspan,xe),h.colspan=Math.min(h.colspan,Me)}iz(i,h,o,s)}},{key:"onBeforeSetRangeStart",value:function(i){if(this.mergedCellsCollection.isFirstRenderableMergedCell(i.row,i.col)){var o=this.mergedCellsCollection.get(i.row,i.col),s=[o.row,o.col];i.row=s[0],i.col=s[1]}}},{key:"onBeforeSetRangeEnd",value:function(i){var o=this.hot.getSelectedRangeLast();o.highlight=this.hot._createCellCoords(o.highlight.row,o.highlight.col),o.to=i;var s=!1;if(!(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()))do{s=!1;for(var a=0;a<this.mergedCellsCollection.mergedCells.length;a+=1){var h=this.mergedCellsCollection.mergedCells[a],p=h.getRange();o.expandByRange(p)&&(i.row=o.to.row,i.col=o.to.col,s=!0)}}while(s)}},{key:"onAfterGetCellMeta",value:function(i,o,s){var a=this.mergedCellsCollection.get(i,o);a&&(a.row!==i||a.col!==o?s.copyable=!1:(s.rowspan=a.rowspan,s.colspan=a.colspan))}},{key:"onAfterViewportRowCalculatorOverride",value:function(i){var o=this.hot.countCols();this.modifyViewportRowStart(i,o),this.modifyViewportRowEnd(i,o)}},{key:"modifyViewportRowStart",value:function(i,o){for(var s=this.hot.rowIndexMapper,a=s.getVisualFromRenderableIndex(i.startRow),h=0;h<o;h+=1){var p=this.mergedCellsCollection.get(a,h);if(dn(p)){var g=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(p.row,1));if(g<i.startRow){i.startRow=g,this.modifyViewportRowStart(i,o);return}}}}},{key:"modifyViewportRowEnd",value:function(i,o){for(var s=this.hot.rowIndexMapper,a=s.getVisualFromRenderableIndex(i.endRow),h=0;h<o;h+=1){var p=this.mergedCellsCollection.get(a,h);if(dn(p)){var g=p.row+p.rowspan-1,S=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(g,-1));if(S>i.endRow){i.endRow=S,this.modifyViewportRowEnd(i,o);return}}}}},{key:"onAfterViewportColumnCalculatorOverride",value:function(i){var o=this.hot.countRows();this.modifyViewportColumnStart(i,o),this.modifyViewportColumnEnd(i,o)}},{key:"modifyViewportColumnStart",value:function(i,o){for(var s=this.hot.columnIndexMapper,a=s.getVisualFromRenderableIndex(i.startColumn),h=0;h<o;h+=1){var p=this.mergedCellsCollection.get(h,a);if(dn(p)){var g=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(p.col,1));if(g<i.startColumn){i.startColumn=g,this.modifyViewportColumnStart(i,o);return}}}}},{key:"modifyViewportColumnEnd",value:function(i,o){for(var s=this.hot.columnIndexMapper,a=s.getVisualFromRenderableIndex(i.endColumn),h=0;h<o;h+=1){var p=this.mergedCellsCollection.get(h,a);if(dn(p)){var g=p.col+p.colspan-1,S=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(g,-1));if(S>i.endColumn){i.endColumn=S,this.modifyViewportColumnEnd(i,o);return}}}}},{key:"translateMergedCellToRenderable",value:function(i,o,s,a){var h=this.hot,p=h.rowIndexMapper,g=h.columnIndexMapper,S,T;o===0?S=p.getNearestNotHiddenIndex(i,1):S=p.getNearestNotHiddenIndex(i+o-1,-1),a===0?T=g.getNearestNotHiddenIndex(s,1):T=g.getNearestNotHiddenIndex(s+a-1,-1);var R=i>=0?p.getRenderableFromVisualIndex(S):i,A=s>=0?g.getRenderableFromVisualIndex(T):s;return[R,A]}},{key:"onModifyAutofillRange",value:function(i,o){this.autofillCalculations.correctSelectionAreaSize(o);var s=this.autofillCalculations.getDirection(o,i),a=i;if(this.autofillCalculations.dragAreaOverlapsCollections(o,a,s))return a=o,a;var h=this.mergedCellsCollection.getWithinRange({from:{row:o[0],col:o[1]},to:{row:o[2],col:o[3]}});return h&&(a=this.autofillCalculations.snapDragArea(o,a,s,h)),a}},{key:"onAfterCreateCol",value:function(i,o){this.mergedCellsCollection.shiftCollections("right",i,o)}},{key:"onAfterRemoveCol",value:function(i,o){this.mergedCellsCollection.shiftCollections("left",i,o)}},{key:"onAfterCreateRow",value:function(i,o,s){s!=="auto"&&this.mergedCellsCollection.shiftCollections("down",i,o)}},{key:"onAfterRemoveRow",value:function(i,o){this.mergedCellsCollection.shiftCollections("up",i,o)}},{key:"onAfterChange",value:function(i,o){o==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(i)}},{key:"onBeforeDrawAreaBorders",value:function(i,o){if(o&&o==="area"){var s=this.hot.getSelectedRangeLast(),a=this.mergedCellsCollection.getWithinRange(s);Le(a,function(h){s.getBottomEndCorner().row===h.getLastRow()&&s.getBottomEndCorner().col===h.getLastColumn()&&(i[2]=h.row,i[3]=h.col)})}}},{key:"onAfterModifyTransformStart",value:function(i,o,s){if(this.enabled){var a=this.mergedCellsCollection.get(i.row,i.col);if(a){var h=o>0,p=o<0,g=s<0,S=s>0,T=a.row+a.rowspan-1===this.hot.countRows()-1,R=a.row===0,A=a.col+a.colspan-1===this.hot.countCols()-1,$=a.col===0;(h&&T||p&&R||S&&A||g&&$)&&(i.row=a.row,i.col=a.col)}}}},{key:"onAfterDrawSelection",value:function(i,o,s,a){if(s)return this.selectionCalculations.getSelectedMergedCellClassName(i,o,s,a)}},{key:"onBeforeRemoveCellClassNames",value:function(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}}],[{key:"PLUGIN_KEY",get:function(){return E0}},{key:"PLUGIN_PRIORITY",get:function(){return Wdt}}]),r}(Wn);function AJ(e){return Xdt(e)||qdt(e)||Kdt(e)||Ydt()}function Ydt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Kdt(e,t){if(e){if(typeof e=="string")return IJ(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return IJ(e,t)}}function IJ(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function qdt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Xdt(e){if(Array.isArray(e))return e}function Zdt(e,t){return function(r,n){var i=AJ(r),o=i.slice(1),s=AJ(n),a=s.slice(1);return function h(p){var g=e[p],S=t[p],T=o[p],R=a[p],A=S.multiColumnSorting,$=A.compareFunctionFactory?A.compareFunctionFactory:Bse(S.type),j=$(g,S,A)(T,R);if(j===au){var z=p+1;if(typeof t[z]<"u")return h(z)}return j}(0)}}var MJ;function Jdt(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function DJ(){ti(Xn(MJ||(MJ=Jdt(["Plugins `columnSorting` and `multiColumnSorting` should not be enabled simultaneously. \n    Only `multiColumnSorting` will work."],["Plugins \\`columnSorting\\` and \\`multiColumnSorting\\` should not be enabled simultaneously. \n    Only \\`multiColumnSorting\\` will work."]))))}var Bue="sort";function Qdt(e,t,r){var n=[];return r===!1||e.isColumnSorted(t)&&e.getNumberOfSortedColumns()>1&&n.push("".concat(Bue,"-").concat(e.getIndexOfColumnInSortQueue(t)+1)),n}function ept(e){var t=e.className.split(" "),r=new RegExp("^".concat(Bue,"-[0-9]{1,2}$"));return t.filter(function(n){return r.test(n)})}function O_(e){"@babel/helpers - typeof";return O_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},O_(e)}function tpt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $J(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,npt(n.key),n)}}function rpt(e,t,r){return t&&$J(e.prototype,t),r&&$J(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function npt(e){var t=ipt(e,"string");return O_(t)==="symbol"?t:String(t)}function ipt(e,t){if(O_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(O_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function es(){return typeof Reflect<"u"&&Reflect.get?es=Reflect.get.bind():es=function(t,r,n){var i=opt(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},es.apply(this,arguments)}function opt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=ha(e),e!==null););return e}function apt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&lz(e,t)}function lz(e,t){return lz=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},lz(e,t)}function spt(e){var t=cpt();return function(){var n=ha(e),i;if(t){var o=ha(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return lpt(this,i)}}function lpt(e,t){if(t&&(O_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return upt(e)}function upt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function cpt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ha(e){return ha=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ha(e)}var uz="multiColumnSorting",fpt=170,hpt="append",LJ="columnSorting";Nse(uz,Zdt);var dpt=function(e){apt(r,e);var t=spt(r);function r(n){var i;return tpt(this,r),i=t.call(this,n),i.pluginKey=uz,i}return rpt(r,[{key:"isEnabled",value:function(){return es(ha(r.prototype),"isEnabled",this).call(this)}},{key:"enablePlugin",value:function(){!this.enabled&&this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[LJ]&&DJ(),es(ha(r.prototype),"enablePlugin",this).call(this)}},{key:"disablePlugin",value:function(){es(ha(r.prototype),"disablePlugin",this).call(this)}},{key:"sort",value:function(i){es(ha(r.prototype),"sort",this).call(this,i)}},{key:"clearSort",value:function(){es(ha(r.prototype),"clearSort",this).call(this)}},{key:"isSorted",value:function(){return es(ha(r.prototype),"isSorted",this).call(this)}},{key:"getSortConfig",value:function(i){return es(ha(r.prototype),"getSortConfig",this).call(this,i)}},{key:"setSortConfig",value:function(i){es(ha(r.prototype),"setSortConfig",this).call(this,i)}},{key:"getNormalizedSortConfigs",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(i)?i:[i]}},{key:"updateHeaderClasses",value:function(i){for(var o,s=arguments.length,a=new Array(s>1?s-1:0),h=1;h<s;h++)a[h-1]=arguments[h];(o=es(ha(r.prototype),"updateHeaderClasses",this)).call.apply(o,[this,i].concat(a)),Kr(i,ept(i)),this.enabled!==!1&&Ht(i,Qdt.apply(void 0,a))}},{key:"onUpdateSettings",value:function(i){this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[LJ]&&DJ(),es(ha(r.prototype),"onUpdateSettings",this).call(this,i)}},{key:"onAfterOnCellMouseDown",value:function(i,o){HB(o.row,o.col,i)!==!1&&this.wasClickableHeaderClicked(i,o.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(o.col),this.sort(this.getNextSortConfig(o.col,hpt))):this.sort(this.getColumnNextConfig(o.col)))}}],[{key:"PLUGIN_KEY",get:function(){return uz}},{key:"PLUGIN_PRIORITY",get:function(){return fpt}}]),r}(zse);function R_(e){"@babel/helpers - typeof";return R_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},R_(e)}function ppt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function NJ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ypt(n.key),n)}}function mpt(e,t,r){return t&&NJ(e.prototype,t),r&&NJ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ypt(e){var t=gpt(e,"string");return R_(t)==="symbol"?t:String(t)}function gpt(e,t){if(R_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(R_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function DR(){return typeof Reflect<"u"&&Reflect.get?DR=Reflect.get.bind():DR=function(t,r,n){var i=vpt(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},DR.apply(this,arguments)}function vpt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=k_(e),e!==null););return e}function _pt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&cz(e,t)}function cz(e,t){return cz=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},cz(e,t)}function bpt(e){var t=xpt();return function(){var n=k_(e),i;if(t){var o=k_(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return wpt(this,i)}}function wpt(e,t){if(t&&(R_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Spt(e)}function Spt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function xpt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function k_(e){return k_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},k_(e)}var Cpt="multipleSelectionHandles",Ept=160,Tpt=function(e){_pt(r,e);var t=bpt(r);function r(n){var i;return ppt(this,r),i=t.call(this,n),i.dragged=[],i.eventManager=null,i.lastSetCell=null,i}return mpt(r,[{key:"isEnabled",value:function(){return nu()}},{key:"enablePlugin",value:function(){this.enabled||(this.eventManager||(this.eventManager=new Bi(this)),this.registerListeners(),DR(k_(r.prototype),"enablePlugin",this).call(this))}},{key:"registerListeners",value:function(){var i=this,o=this,s=this.hot.rootElement;function a(h){if(o.dragged.length===1)return o.dragged.splice(0,o.dragged.length),!0;var p=o.dragged.indexOf(h);if(p===-1)return!1;p===0?o.dragged=o.dragged.slice(0,1):p===1&&(o.dragged=o.dragged.slice(-1))}this.eventManager.addEventListener(s,"touchstart",function(h){var p;if(Ur(h.target,"topSelectionHandle-HitArea"))return p=o.hot.getSelectedRangeLast(),o.dragged.push("top"),o.touchStartRange={width:p.getWidth(),height:p.getHeight(),direction:p.getDirection()},h.preventDefault(),!1;if(Ur(h.target,"bottomSelectionHandle-HitArea"))return p=o.hot.getSelectedRangeLast(),o.dragged.push("bottom"),o.touchStartRange={width:p.getWidth(),height:p.getHeight(),direction:p.getDirection()},h.preventDefault(),!1}),this.eventManager.addEventListener(s,"touchend",function(h){if(Ur(h.target,"topSelectionHandle-HitArea"))return a.call(o,"top"),o.touchStartRange=void 0,h.preventDefault(),!1;if(Ur(h.target,"bottomSelectionHandle-HitArea"))return a.call(o,"bottom"),o.touchStartRange=void 0,h.preventDefault(),!1}),this.eventManager.addEventListener(s,"touchmove",function(h){var p=i.hot.rootDocument,g,S,T,R,A,$;if(o.dragged.length!==0){var j=p.elementFromPoint(h.touches[0].clientX,h.touches[0].clientY);!j||j===o.lastSetCell||((j.nodeName==="TD"||j.nodeName==="TH")&&(g=o.hot.getCoords(j),g.col===-1&&(g.col=0),S=o.hot.getSelectedRangeLast(),T=S.getWidth(),R=S.getHeight(),A=S.getDirection(),T===1&&R===1&&o.hot.selection.setRangeEnd(g),$=o.getCurrentRangeCoords(S,g,o.touchStartRange.direction,A,o.dragged[0]),$.start!==null&&o.hot.selection.setRangeStart($.start),o.hot.selection.setRangeEnd($.end),o.lastSetCell=j),h.preventDefault())}})}},{key:"getCurrentRangeCoords",value:function(i,o,s,a,h){var p=i.getTopStartCorner(),g=i.getBottomEndCorner(),S=i.getBottomStartCorner(),T=i.getTopEndCorner(),R={start:null,end:null};switch(s){case"NE-SW":switch(a){case"NE-SW":case"NW-SE":h==="top"?R={start:this.hot._createCellCoords(o.row,i.highlight.col),end:this.hot._createCellCoords(S.row,o.col)}:R={start:this.hot._createCellCoords(i.highlight.row,o.col),end:this.hot._createCellCoords(o.row,p.col)};break;case"SE-NW":h==="bottom"&&(R={start:this.hot._createCellCoords(g.row,o.col),end:this.hot._createCellCoords(o.row,p.col)});break}break;case"NW-SE":switch(a){case"NE-SW":h==="top"?R={start:o,end:S}:R.end=o;break;case"NW-SE":h==="top"?R={start:o,end:g}:R.end=o;break;case"SE-NW":h==="top"?R={start:o,end:p}:R.end=o;break;case"SW-NE":h==="top"?R={start:o,end:T}:R.end=o;break}break;case"SW-NE":switch(a){case"NW-SE":h==="bottom"?R={start:this.hot._createCellCoords(o.row,p.col),end:this.hot._createCellCoords(S.row,o.col)}:R={start:this.hot._createCellCoords(p.row,o.col),end:this.hot._createCellCoords(o.row,g.col)};break;case"SW-NE":h==="top"?R={start:this.hot._createCellCoords(i.highlight.row,o.col),end:this.hot._createCellCoords(o.row,g.col)}:R={start:this.hot._createCellCoords(o.row,p.col),end:this.hot._createCellCoords(p.row,o.col)};break;case"SE-NW":h==="bottom"?R={start:this.hot._createCellCoords(o.row,T.col),end:this.hot._createCellCoords(p.row,o.col)}:h==="top"&&(R={start:S,end:o});break}break;case"SE-NW":switch(a){case"NW-SE":case"NE-SW":case"SW-NE":h==="top"&&(R.end=o);break;case"SE-NW":h==="top"?R.end=o:R={start:o,end:p};break}break}return R}},{key:"isDragged",value:function(){return this.dragged.length>0}}],[{key:"PLUGIN_KEY",get:function(){return Cpt}},{key:"PLUGIN_PRIORITY",get:function(){return Ept}}]),r}(Wn);function fz(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.label,r=t===void 0?"":t,n=e.colspan,i=n===void 0?1:n,o=e.origColspan,s=o===void 0?1:o,a=e.collapsible,h=a===void 0?!1:a,p=e.crossHiddenColumns,g=p===void 0?[]:p,S=e.isCollapsed,T=S===void 0?!1:S,R=e.isHidden,A=R===void 0?!1:R,$=e.isRoot,j=$===void 0?!1:$,z=e.isPlaceholder,V=z===void 0?!1:z;return{label:r,colspan:i,origColspan:s,collapsible:h,isCollapsed:T,crossHiddenColumns:g,isHidden:A,isRoot:j,isPlaceholder:V}}function jue(){return{label:"",isPlaceholder:!0}}function BJ(e){return Ppt(e)||kpt(e)||Rpt(e)||Opt()}function Opt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Rpt(e,t){if(e){if(typeof e=="string")return hz(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return hz(e,t)}}function kpt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Ppt(e){if(Array.isArray(e))return hz(e)}function hz(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Apt(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0,r=[];if(t===0)return r;Le(e,function(i){var o=[],s=0;r.push(o),Le(i,function(a){var h=fz();if(dn(a)){var p=a.label,g=a.colspan;h.label=Xi(p),typeof g=="number"&&g>1&&(h.colspan=g,h.origColspan=g)}else h.label=Xi(a);s+=h.origColspan;var S=!1;if(s>=t&&(h.colspan=h.origColspan-(s-t),h.origColspan=h.colspan,S=!0),o.push(h),h.colspan>1)for(var T=0;T<h.colspan-1;T++)o.push(jue());return!S})});var n=Math.max.apply(Math,BJ(hn(r,function(i){return i.length})));return Le(r,function(i){if(i.length<n){var o=hn(new Array(n-i.length),function(){return fz()});i.splice.apply(i,[i.length,0].concat(BJ(o)))}}),r}function gx(e){"@babel/helpers - typeof";return gx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gx(e)}var Ipt=["row","col"];function jJ(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Mpt(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?jJ(Object(r),!0).forEach(function(n){Dpt(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):jJ(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Dpt(e,t,r){return t=zue(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $pt(e,t){if(e==null)return{};var r=Lpt(e,t),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Lpt(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,o;for(o=0;o<n.length;o++)i=n[o],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function Npt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function zJ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,zue(n.key),n)}}function Bpt(e,t,r){return t&&zJ(e.prototype,t),r&&zJ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function zue(e){var t=jpt(e,"string");return gx(t)==="symbol"?t:String(t)}function jpt(e,t){if(gx(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(gx(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function R2(e,t,r){zpt(e,t),t.set(e,r)}function zpt(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function rl(e,t){var r=Fue(e,t,"get");return Fpt(e,r)}function Fpt(e,t){return t.get?t.get.call(e):t.value}function d0(e,t,r){var n=Fue(e,t,"set");return Hpt(e,n,r),r}function Fue(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function Hpt(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var FJ=["label","collapsible"],Nu=new WeakMap,Pd=new WeakMap,k2=new WeakMap,Vpt=function(){function e(){Npt(this,e),R2(this,Nu,{writable:!0,value:[]}),R2(this,Pd,{writable:!0,value:0}),R2(this,k2,{writable:!0,value:1/0})}return Bpt(e,[{key:"setColumnsLimit",value:function(r){d0(this,k2,r)}},{key:"setData",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];d0(this,Nu,Apt(r,rl(this,k2))),d0(this,Pd,rl(this,Nu).length)}},{key:"getData",value:function(){return rl(this,Nu)}},{key:"mergeWith",value:function(r){var n=this;Le(r,function(i){var o=i.row,s=i.col,a=$pt(i,Ipt),h=n.getHeaderSettings(o,s);h!==null&&ao(h,a,FJ)})}},{key:"map",value:function(r){Le(rl(this,Nu),function(n){Le(n,function(i){var o=r(Mpt({},i));dn(o)&&ao(i,o,FJ)})})}},{key:"getHeaderSettings",value:function(r,n){var i;if(r>=rl(this,Pd)||r<0)return null;var o=rl(this,Nu)[r];return n>=o.length?null:(i=o[n])!==null&&i!==void 0?i:null}},{key:"getHeadersSettings",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,o=[];if(r>=rl(this,Pd)||r<0)return o;for(var s=rl(this,Nu)[r],a=0,h=n;h<s.length;h++){var p=s[h];if(p.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(a+=p.colspan,o.push(p),p.colspan>1&&(h+=p.colspan-1),a===i)break;if(a>i)throw new Error("The last column settings cannot overlap the other header layers")}return o}},{key:"getLayersCount",value:function(){return rl(this,Pd)}},{key:"getColumnsCount",value:function(){return rl(this,Pd)>0?rl(this,Nu)[0].length:0}},{key:"clear",value:function(){d0(this,Nu,[]),d0(this,Pd,0)}}]),e}();function vx(e){"@babel/helpers - typeof";return vx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vx(e)}function HJ(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function VJ(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?HJ(Object(r),!0).forEach(function(n){$R(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):HJ(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Upt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function UJ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Hue(n.key),n)}}function Wpt(e,t,r){return t&&UJ(e.prototype,t),r&&UJ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function $R(e,t,r){return t=Hue(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Hue(e){var t=Gpt(e,"string");return vx(t)==="symbol"?t:String(t)}function Gpt(e,t){if(vx(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(vx(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ypt(e){return Zpt(e)||Xpt(e)||qpt(e)||Kpt()}function Kpt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function qpt(e,t){if(e){if(typeof e=="string")return dz(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return dz(e,t)}}function Xpt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Zpt(e){if(Array.isArray(e))return dz(e)}function dz(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Jpt="DF-pre-order";function Vue(e,t){for(var r=e.call(t,this),n=0;n<this.childs.length;n++){if(r===!1)return!1;r=Vue.call(this.childs[n],e,t)}return r}var Qpt="DF-post-order";function Uue(e,t){for(var r=0;r<this.childs.length;r++){var n=Uue.call(this.childs[r],e,t);if(n===!1)return!1}return e.call(t,this)}var Wue="BF";function emt(e,t){var r=[this];function n(){if(r.length!==0){var i=r.shift();r.push.apply(r,Ypt(i.childs)),e.call(t,i)!==!1&&n()}}n()}var tmt=Wue,WJ=new Map([[Jpt,Vue],[Qpt,Uue],[Wue,emt]]),GJ=function(){function e(t){Upt(this,e),$R(this,"data",{}),$R(this,"parent",null),$R(this,"childs",[]),this.data=t}return Wpt(e,[{key:"addChild",value:function(r){r.parent=this,this.childs.push(r)}},{key:"cloneTree",value:function(){for(var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this,n=new e(VJ({},r.data)),i=0;i<r.childs.length;i++)n.addChild(this.cloneTree(r.childs[i]));return n}},{key:"replaceTreeWith",value:function(r){this.data=VJ({},r.data),this.childs=[];for(var n=0;n<r.childs.length;n++)this.addChild(r.childs[n])}},{key:"walkDown",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:tmt;if(!WJ.has(n))throw new Error('Traversal strategy "'.concat(n,'" does not exist'));WJ.get(n).call(this,r,this)}},{key:"walkUp",value:function(r){var n=this,i=function o(s){var a=r.call(n,s);a!==!1&&s.parent!==null&&o(s.parent)};i(this)}}]),e}();function _x(e){"@babel/helpers - typeof";return _x=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_x(e)}function YJ(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function KJ(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?YJ(Object(r),!0).forEach(function(n){rmt(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):YJ(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function rmt(e,t,r){return t=Gue(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function nmt(e,t){return smt(e)||amt(e,t)||omt(e,t)||imt()}function imt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function omt(e,t){if(e){if(typeof e=="string")return qJ(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return qJ(e,t)}}function qJ(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function amt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],h=!0,p=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;h=!1}else for(;!(h=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);h=!0);}catch(g){p=!0,i=g}finally{try{if(!h&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(p)throw i}}return a}}function smt(e){if(Array.isArray(e))return e}function lmt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function XJ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Gue(n.key),n)}}function umt(e,t,r){return t&&XJ(e.prototype,t),r&&XJ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Gue(e){var t=cmt(e,"string");return _x(t)==="symbol"?t:String(t)}function cmt(e,t){if(_x(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_x(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function P2(e,t,r){fmt(e,t),t.set(e,r)}function fmt(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ua(e,t){var r=Yue(e,t,"get");return hmt(e,r)}function hmt(e,t){return t.get?t.get.call(e):t.value}function dmt(e,t,r){var n=Yue(e,t,"set");return pmt(e,n,r),r}function Yue(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function pmt(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var By=new WeakMap,Ad=new WeakMap,jy=new WeakMap,mmt=function(){function e(t){lmt(this,e),P2(this,By,{writable:!0,value:new Map}),P2(this,Ad,{writable:!0,value:new Map}),P2(this,jy,{writable:!0,value:null}),dmt(this,jy,t)}return umt(e,[{key:"getRoots",value:function(){return Array.from(ua(this,By).values())}},{key:"getRootByColumn",value:function(r){var n;return ua(this,Ad).has(r)&&(n=ua(this,By).get(ua(this,Ad).get(r))),n}},{key:"getNode",value:function(r,n){var i=this.getRootByColumn(n);if(i){var o=n-ua(this,Ad).get(n),s=0,a;return i.walkDown(function(h){var p=h.data,g=p.origColspan,S=p.headerLevel;if(r===S){if(o>=s&&o<=s+g-1)return a=h,a.data.isRoot=n===a.data.columnIndex,!1;s+=g}}),a}}},{key:"rebuildTreeIndex",value:function(){var r=this,n=0;ua(this,Ad).clear(),Le(ua(this,By),function(i){for(var o=nmt(i,2),s=o[1].data.colspan,a=n;a<n+s;a++)ua(r,Ad).set(a,n);n+=s})}},{key:"buildTree",value:function(){this.clear();for(var r=ua(this,jy).getColumnsCount(),n=0;n<r;){var i=ua(this,jy).getHeaderSettings(0,n),o=new GJ;ua(this,By).set(n,o),this.buildLeaves(o,n,0,i.origColspan),n+=i.origColspan}this.rebuildTreeIndex()}},{key:"buildLeaves",value:function(r,n,i){var o=this,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1,a=ua(this,jy).getHeadersSettings(i,n,s);i+=1,Le(a,function(h){var p=KJ(KJ({},h),{},{headerLevel:i-1,columnIndex:n}),g;i===1?(r.data=p,g=r):(g=new GJ(p),r.addChild(g)),i<ua(o,jy).getLayersCount()&&o.buildLeaves(g,n,i,h.origColspan),n+=h.origColspan})}},{key:"clear",value:function(){ua(this,By).clear(),ua(this,Ad).clear()}}]),e}();function Kue(e,t){e.walkDown(function(r){var n=r.data,i=r.childs;if(!n.isHidden&&(t(n.columnIndex),i.length===0))for(var o=1;o<n.colspan;o++)t(n.columnIndex+o)})}function vP(e,t){var r=e.childs;if(r.length!==0)return r[0].data[t]}function _P(e){return vP(e,"origColspan")===e.data.origColspan}function _U(e){var t=e.data,r=e.childs;if(!t.isCollapsed||t.isHidden||t.origColspan<=1)return{rollbackModification:function(){},affectedColumns:[],colspanCompensation:0};var n=_P(e);if(n)return _U(r[0]);t.isCollapsed=!1;var i=r.slice(1),o=new Set,s=0;if(i.length>0)Le(i,function(S){S.replaceTreeWith(S.data.clonedTree),S.data.clonedTree=null;var T=S.data;s+=T.colspan,Kue(S,function(R){o.add(R)})});else{var a=t.colspan,h=t.origColspan,p=t.columnIndex;s=h-a;for(var g=1;g<h;g++)o.add(p+g)}return e.walkUp(function(S){var T=S.data;T.colspan+=s,T.colspan>=T.origColspan?(T.colspan=T.origColspan,T.isCollapsed=!1):_P(S)&&(T.isCollapsed=vP(S,"isCollapsed"))}),{rollbackModification:function(){return bU(e)},affectedColumns:Array.from(o),colspanCompensation:s}}function bU(e){var t,r=e.data,n=e.childs;if(r.isCollapsed||r.isHidden||r.origColspan<=1)return{rollbackModification:function(){},affectedColumns:[],colspanCompensation:0};var i=_P(e);if(i)return bU(n[0]);r.isCollapsed=!0;var o=n.slice(1),s=new Set;if(o.length>0)Le(o,function(T){Kue(T,function(R){s.add(R)}),T.data.clonedTree=T.cloneTree(),T.walkDown(function(R){var A=R.data;A.isHidden=!0})});else for(var a=r.origColspan,h=r.columnIndex,p=1;p<a;p++){var g=h+p;s.add(g)}var S=r.colspan-((t=vP(e,"colspan"))!==null&&t!==void 0?t:1);return e.walkUp(function(T){var R=T.data;R.colspan-=S,R.colspan<=1?(R.colspan=1,R.isCollapsed=!0):_P(T)&&(R.isCollapsed=vP(T,"isCollapsed"))}),{rollbackModification:function(){return _U(e)},affectedColumns:Array.from(s),colspanCompensation:S}}var ZJ;function ymt(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function gmt(e,t){if(!Number.isInteger(t))throw new Error("The passed gridColumnIndex argument has invalid type.");if(e.childs.length>0)throw new Error(Xn(ZJ||(ZJ=ymt([`The passed node is not the last node on the tree. Only for 
the last node, the hide column modification can be applied.`],[`The passed node is not the last node on the tree. Only for\\x20
the last node, the hide column modification can be applied.`]))));var r=e.data.crossHiddenColumns;if(!r.includes(t)){var n=!1;e.walkUp(function(i){var o=i.data.collapsible;if(o)return n=!0,!1}),!n&&e.walkUp(function(i){var o=i.data;o.crossHiddenColumns.push(t),o.colspan>1?o.colspan-=1:o.isHidden=!0})}}var JJ;function vmt(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function _mt(e,t){if(!Number.isInteger(t))throw new Error("The passed gridColumnIndex argument has invalid type.");if(e.childs.length>0)throw new Error(Xn(JJ||(JJ=vmt([`The passed node is not the last node on the tree. Only for 
the last node, the show column modification can be applied.`],[`The passed node is not the last node on the tree. Only for\\x20
the last node, the show column modification can be applied.`]))));var r=e.data.crossHiddenColumns;if(r.includes(t)){var n=!1;e.walkUp(function(i){var o=i.data.collapsible;if(o)return n=!0,!1}),!n&&e.walkUp(function(i){var o=i.data;o.crossHiddenColumns.splice(o.crossHiddenColumns.indexOf(t),1),!o.isHidden&&o.colspan<o.origColspan&&(o.colspan+=1),o.isHidden=!1})}}var QJ=new Map([["collapse",bU],["expand",_U],["hide-column",gmt],["show-column",_mt]]);function bmt(e,t,r){if(!QJ.has(e))throw new Error('The node modifier action ("'.concat(e,'") does not exist.'));return QJ.get(e)(t,r)}var wmt=["crossHiddenColumns"];function Smt(e,t){if(e==null)return{};var r=xmt(e,t),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function xmt(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,o;for(o=0;o<n.length;o++)i=n[o],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function MO(e){var t=[];return Le(e,function(r){r.walkDown(function(n){for(var i=n.data,o=i.origColspan,s=i.columnIndex,a=i.headerLevel,h=i.crossHiddenColumns,p=Emt(t,a),g=!1,S=s;S<s+o;S++){var T=h.includes(S);if(T||g)p.push(jue());else{var R=Cmt(i);R.isRoot=!0,p.push(R),g=!0}}})}),t}function Cmt(e){var t=fz(e);t.crossHiddenColumns;var r=Smt(t,wmt);return r}function Emt(e,t){var r;return Array.isArray(e[t])?r=e[t]:(r=[],e[t]=r),r}function bx(e){"@babel/helpers - typeof";return bx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bx(e)}var Tmt=["row"];function eQ(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function tQ(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?eQ(Object(r),!0).forEach(function(n){Omt(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):eQ(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Omt(e,t,r){return t=que(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Rmt(e,t){if(e==null)return{};var r=kmt(e,t),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function kmt(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,o;for(o=0;o<n.length;o++)i=n[o],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function Pmt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function rQ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,que(n.key),n)}}function Amt(e,t,r){return t&&rQ(e.prototype,t),r&&rQ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function que(e){var t=Imt(e,"string");return bx(t)==="symbol"?t:String(t)}function Imt(e,t){if(bx(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(bx(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function A2(e,t,r){Mmt(e,t),t.set(e,r)}function Mmt(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function p0(e,t,r){var n=Xue(e,t,"set");return Dmt(e,n,r),r}function Dmt(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}function Hi(e,t){var r=Xue(e,t,"get");return $mt(e,r)}function Xue(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function $mt(e,t){return t.get?t.get.call(e):t.value}var ql=new WeakMap,Za=new WeakMap,Id=new WeakMap,Lmt=function(){function e(){Pmt(this,e),A2(this,ql,{writable:!0,value:new Vpt}),A2(this,Za,{writable:!0,value:new mmt(Hi(this,ql))}),A2(this,Id,{writable:!0,value:[[]]})}return Amt(e,[{key:"setState",value:function(r){Hi(this,ql).setData(r);var n=!1;try{Hi(this,Za).buildTree()}catch{Hi(this,Za).clear(),Hi(this,ql).clear(),n=!0}return p0(this,Id,MO(Hi(this,Za).getRoots())),n}},{key:"setColumnsLimit",value:function(r){Hi(this,ql).setColumnsLimit(r)}},{key:"mergeStateWith",value:function(r){var n=this,i=hn(r,function(o){var s=o.row,a=Rmt(o,Tmt);return tQ({row:s<0?n.rowCoordsToLevel(s):s},a)});Hi(this,ql).mergeWith(i),Hi(this,Za).buildTree(),p0(this,Id,MO(Hi(this,Za).getRoots()))}},{key:"mapState",value:function(r){Hi(this,ql).map(r),Hi(this,Za).buildTree(),p0(this,Id,MO(Hi(this,Za).getRoots()))}},{key:"mapNodes",value:function(r){return na(Hi(this,Za).getRoots(),function(n,i){return i.walkDown(function(o){var s=r(o.data);s!==void 0&&n.push(s)}),n},[])}},{key:"triggerNodeModification",value:function(r,n,i){n<0&&(n=this.rowCoordsToLevel(n));var o=Hi(this,Za).getNode(n,i),s;return o&&(s=bmt(r,o,i),p0(this,Id,MO(Hi(this,Za).getRoots()))),s}},{key:"triggerColumnModification",value:function(r,n){return this.triggerNodeModification(r,-1,n)}},{key:"rowCoordsToLevel",value:function(r){if(r>=0)return null;var n=r+Math.max(this.getLayersCount(),1);return n<0?null:n}},{key:"levelToRowCoords",value:function(r){if(r<0)return null;var n=r-Math.max(this.getLayersCount(),1);return n>=0?null:n}},{key:"getHeaderSettings",value:function(r,n){var i,o;return r<0&&(r=this.rowCoordsToLevel(r)),r===null||r>=this.getLayersCount()?null:(i=(o=Hi(this,Id)[r])===null||o===void 0?void 0:o[n])!==null&&i!==void 0?i:null}},{key:"getHeaderTreeNodeData",value:function(r,n){if(r<0&&(r=this.rowCoordsToLevel(r)),r===null||r>=this.getLayersCount())return null;var i=Hi(this,Za).getNode(r,n);return i?tQ({},i.data):null}},{key:"findLeftMostColumnIndex",value:function(r,n){var i,o=(i=this.getHeaderSettings(r,n))!==null&&i!==void 0?i:{isRoot:!0},s=o.isRoot;if(s)return n;for(var a=n-1;a>=0;){var h,p=(h=this.getHeaderSettings(r,a))!==null&&h!==void 0?h:{isRoot:!0},g=p.isRoot;if(g)break;a-=1}return a}},{key:"getLayersCount",value:function(){return Hi(this,ql).getLayersCount()}},{key:"getColumnsCount",value:function(){return Hi(this,ql).getColumnsCount()}},{key:"clear",value:function(){p0(this,Id,[]),Hi(this,ql).clear(),Hi(this,Za).clear()}}]),e}();function wx(e){"@babel/helpers - typeof";return wx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wx(e)}function Nmt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function nQ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Zue(n.key),n)}}function Bmt(e,t,r){return t&&nQ(e.prototype,t),r&&nQ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function m0(e,t,r){return t=Zue(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Zue(e){var t=jmt(e,"string");return wx(t)==="symbol"?t:String(t)}function jmt(e,t){if(wx(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(wx(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var zmt=function(){function e(t,r){Nmt(this,e),m0(this,"hot",void 0),m0(this,"nestedHeaderSettingsGetter",void 0),m0(this,"layersCount",0),m0(this,"container",void 0),m0(this,"widthsMap",void 0),this.hot=t,this.nestedHeaderSettingsGetter=r,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}return Bmt(e,[{key:"setLayersCount",value:function(r){return this.layersCount=r,this}},{key:"getWidth",value:function(r){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(r))}},{key:"buildWidthsMap",value:function(){this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);var r=this.container.querySelectorAll("tr:last-of-type th"),n=r.length;this.widthsMap.clear();for(var i=0;i<n;i++){var o=this.hot.columnIndexMapper.getVisualFromRenderableIndex(i),s=this.hot.toPhysicalColumn(o);this.widthsMap.setValueAtIndex(s,r[i].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}},{key:"_buildGhostTable",value:function(r){for(var n=this.hot,i=n.rootDocument,o=n.columnIndexMapper,s=i.createDocumentFragment(),a=i.createElement("table"),h=!!this.hot.getSettings().dropdownMenu,p=o.getRenderableIndexesLength(),g=0;g<this.layersCount;g++){for(var S=i.createElement("tr"),T=0;T<p;T++){var R=o.getVisualFromRenderableIndex(T);R===null&&(R=T);var A=i.createElement("th"),$=this.nestedHeaderSettingsGetter(g,R);if($&&(!$.isPlaceholder||$.isHidden)){var j=$.label;h&&(j+='<button class="changeType"></button>'),ib(A,j),A.colSpan=$.colspan,S.appendChild(A)}}a.appendChild(S)}s.appendChild(a),r.appendChild(s)}},{key:"clear",value:function(){this.widthsMap.clear(),this.container=null}}]),e}();const Fmt=zmt;function P_(e){"@babel/helpers - typeof";return P_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},P_(e)}var iQ,oQ;function aQ(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function Hmt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function sQ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Jue(n.key),n)}}function Vmt(e,t,r){return t&&sQ(e.prototype,t),r&&sQ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function hp(){return typeof Reflect<"u"&&Reflect.get?hp=Reflect.get.bind():hp=function(t,r,n){var i=Umt(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},hp.apply(this,arguments)}function Umt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=yc(e),e!==null););return e}function Wmt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&pz(e,t)}function pz(e,t){return pz=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},pz(e,t)}function Gmt(e){var t=Kmt();return function(){var n=yc(e),i;if(t){var o=yc(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Ymt(this,i)}}function Ymt(e,t){if(t&&(P_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return T0(e)}function T0(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Kmt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function yc(e){return yc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},yc(e)}function lQ(e,t,r){return t=Jue(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Jue(e){var t=qmt(e,"string");return P_(t)==="symbol"?t:String(t)}function qmt(e,t){if(P_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(P_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function uQ(e,t,r){Xmt(e,t),t.set(e,r)}function Xmt(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function DO(e,t,r){var n=Que(e,t,"set");return Zmt(e,n,r),r}function Zmt(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}function Pi(e,t){var r=Que(e,t,"get");return Jmt(e,r)}function Que(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function Jmt(e,t){return t.get?t.get.call(e):t.value}var cQ="nestedHeaders",Qmt=280,Yi=new WeakMap,Of=new WeakMap,eyt=function(e){Wmt(r,e);var t=Gmt(r);function r(){var n;Hmt(this,r);for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n=t.call.apply(t,[this].concat(o)),uQ(T0(n),Yi,{writable:!0,value:new Lmt}),uQ(T0(n),Of,{writable:!0,value:null}),lQ(T0(n),"ghostTable",new Fmt(n.hot,function(a,h){return n.getHeaderSettings(a,h)})),lQ(T0(n),"detectedOverlappedHeaders",!1),n}return Vmt(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[cQ]}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){var o=this.hot.getSettings(),s=o.nestedHeaders;(!Array.isArray(s)||!Array.isArray(s[0]))&&ti(Xn(iQ||(iQ=aQ([`Your Nested Headers plugin configuration is invalid. The settings has to be 
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`],[`Your Nested Headers plugin configuration is invalid. The settings has to be\\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`])))),this.addHook("init",function(){return i.onInit()}),this.addHook("afterLoadData",function(){return i.onAfterLoadData.apply(i,arguments)}),this.addHook("beforeOnCellMouseDown",function(){return i.onBeforeOnCellMouseDown.apply(i,arguments)}),this.addHook("afterOnCellMouseDown",function(){return i.onAfterOnCellMouseDown.apply(i,arguments)}),this.addHook("beforeOnCellMouseOver",function(){return i.onBeforeOnCellMouseOver.apply(i,arguments)}),this.addHook("afterGetColumnHeaderRenderers",function(a){return i.onAfterGetColumnHeaderRenderers(a)}),this.addHook("modifyColWidth",function(){return i.onModifyColWidth.apply(i,arguments)}),this.addHook("modifyColumnHeaderValue",function(){return i.onModifyColumnHeaderValue.apply(i,arguments)}),this.addHook("beforeHighlightingColumnHeader",function(){return i.onBeforeHighlightingColumnHeader.apply(i,arguments)}),this.addHook("beforeCopy",function(){return i.onBeforeCopy.apply(i,arguments)}),this.addHook("afterViewportColumnCalculatorOverride",function(){return i.onAfterViewportColumnCalculatorOverride.apply(i,arguments)}),hp(yc(r.prototype),"enablePlugin",this).call(this),this.updatePlugin()}}},{key:"updatePlugin",value:function(){var i=this;if(this.hot.view){var o=this.hot.getSettings(),s=o.nestedHeaders;Pi(this,Yi).setColumnsLimit(this.hot.countCols()),Array.isArray(s)&&(this.detectedOverlappedHeaders=Pi(this,Yi).setState(s)),this.detectedOverlappedHeaders&&ti(Xn(oQ||(oQ=aQ([`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration 
                        is currently not supported.`],[`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\\x20
                        is currently not supported.`])))),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach(function(a,h){var p=a===!0?"hide-column":"show-column";Pi(i,Yi).triggerColumnModification(p,h)}),!Pi(this,Of)&&this.enabled&&DO(this,Of,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(function(a){a.forEach(function(h){var p=h.op,g=h.index,S=h.newValue;if(p==="replace"){var T=S===!0?"hide-column":"show-column";Pi(i,Yi).triggerColumnModification(T,g)}}),i.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),hp(yc(r.prototype),"updatePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){this.clearColspans(),Pi(this,Yi).clear(),Pi(this,Of).unsubscribe(),DO(this,Of,null),this.ghostTable.clear(),hp(yc(r.prototype),"disablePlugin",this).call(this)}},{key:"getStateManager",value:function(){return Pi(this,Yi)}},{key:"getLayersCount",value:function(){return Pi(this,Yi).getLayersCount()}},{key:"getHeaderSettings",value:function(i,o){return Pi(this,Yi).getHeaderSettings(i,o)}},{key:"clearColspans",value:function(){if(this.hot.view)for(var i=this.hot.view._wt,o=i.getSetting("columnHeaders").length,s=i.wtTable.THEAD,a=i.wtOverlays.topOverlay.clone.wtTable.THEAD,h=i.wtOverlays.topInlineStartCornerOverlay?i.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,p=0;p<o;p++){var g=s.childNodes[p];if(!g)break;for(var S=a.childNodes[p],T=h?h.childNodes[p]:null,R=0,A=g.childNodes.length;R<A;R++)g.childNodes[R].removeAttribute("colspan"),Kr(g.childNodes[R],"hiddenHeader"),S&&S.childNodes[R]&&(S.childNodes[R].removeAttribute("colspan"),Kr(S.childNodes[R],"hiddenHeader")),h&&T&&T.childNodes[R]&&(T.childNodes[R].removeAttribute("colspan"),Kr(T.childNodes[R],"hiddenHeader"))}}},{key:"headerRendererFactory",value:function(i){var o=this,s=this.hot.view._wt.getSetting("fixedColumnsStart");return function(a,h){var p,g=o.hot,S=g.columnIndexMapper,T=g.view,R=S.getVisualFromRenderableIndex(a);R===null&&(R=a),h.removeAttribute("colspan"),Kr(h,"hiddenHeader");var A=(p=Pi(o,Yi).getHeaderSettings(i,R))!==null&&p!==void 0?p:{label:""},$=A.colspan,j=A.isHidden,z=A.isPlaceholder;if(z||j)Ht(h,"hiddenHeader");else if($>1){var V,G,ee=T._wt.wtOverlays,K=(V=ee.topInlineStartCornerOverlay)===null||V===void 0?void 0:V.clone.wtTable.THEAD.contains(h),xe=(G=ee.inlineStartOverlay)===null||G===void 0?void 0:G.clone.wtTable.THEAD.contains(h),Me=K||xe?Math.min($,s-a):$;Me>1&&h.setAttribute("colspan",Me)}o.hot.view.appendColHeader(R,h,function(){return o.getColumnHeaderValue.apply(o,arguments)},i)}}},{key:"getColumnHeaderValue",value:function(i,o){var s,a=(s=Pi(this,Yi).getHeaderSettings(o,i))!==null&&s!==void 0?s:{},h=a.isHidden,p=a.isPlaceholder;return p||h?"":this.hot.getColHeader(i,o)}},{key:"onBeforeHighlightingColumnHeader",value:function(i,o,s){var a=Pi(this,Yi).getHeaderTreeNodeData(o,i);if(!a)return i;var h=s.classNames,p=s.columnCursor,g=s.selectionType,S=s.selectionWidth,T=Pi(this,Yi).getHeaderSettings(o,i),R=T.isRoot,A=T.colspan;if(g===xC){if(!R)return a.columnIndex}else g===qA&&(A>S-p||!R)&&(h.length=0);return i}},{key:"onBeforeCopy",value:function(i,o,s){var a=s.columnHeadersCount;if(a!==0)for(var h=0;h<o.length;h++){var p=o[h],g=p.startRow,S=p.startCol,T=p.endRow,R=p.endCol,A=T-g+1,$=S-R+1;if(g>=0||$===1)break;for(var j=S;j<=R;j++)for(var z=g;z<=T;z++){var V,G=A+z,ee=j-S;if(ee!==0){var K=(V=Pi(this,Yi).getHeaderTreeNodeData(z,j))===null||V===void 0?void 0:V.isRoot;K===!1&&(i[G][ee]="")}}}}},{key:"onBeforeOnCellMouseDown",value:function(i,o,s,a){var h=this._getHeaderTreeNodeDataByCoords(o);h&&(a.column=!0)}},{key:"onAfterOnCellMouseDown",value:function(i,o){var s=this._getHeaderTreeNodeDataByCoords(o);if(s){var a=this.hot.selection,h=a.isSelected()?a.getSelectedRange().current():null,p=[],g=s.columnIndex,S=s.origColspan,T=!a.inInSelection(o);i.shiftKey&&h?o.col<h.from.col?p.push(h.getTopEndCorner().col,g,o.row):o.col>h.from.col?p.push(h.getTopStartCorner().col,g+S-1,o.row):p.push(g,g+S-1,o.row):(JH(i)||Pp(i)&&T)&&p.push(g,g+S-1,o.row),a.selectColumns.apply(a,p)}}},{key:"onBeforeOnCellMouseOver",value:function(i,o,s,a){var h;if(this.hot.view.isMouseDown()){var p=this._getHeaderTreeNodeDataByCoords(o);if(p){var g=p.columnIndex,S=p.origColspan,T=this.hot.getSelectedRangeLast(),R=T.getTopStartCorner(),A=T.getBottomEndCorner(),$=T.from;a.column=!0,a.cell=!0;var j=[];o.col<$.col?j.push(A.col,g):o.col>$.col?j.push(R.col,g+S-1):j.push(g,g+S-1),(h=this.hot).selectColumns.apply(h,j)}}}},{key:"onAfterGetColumnHeaderRenderers",value:function(i){i.length=0;for(var o=0;o<Pi(this,Yi).getLayersCount();o++)i.push(this.headerRendererFactory(o))}},{key:"onAfterViewportColumnCalculatorOverride",value:function(i){for(var o=Pi(this,Yi).getLayersCount(),s=i.startColumn,a=!!o,h=0;h<o;h++){var p=Pi(this,Yi).findLeftMostColumnIndex(h,i.startColumn),g=this.hot.columnIndexMapper.getRenderableFromVisualIndex(p);if(p>=0&&(a=!1),ks(g)&&g<i.startColumn){s=g;break}}i.startColumn=a?Pi(this,Yi).getHeaderTreeNodeData(0,s).columnIndex:s}},{key:"onModifyColWidth",value:function(i,o){var s=this.ghostTable.getWidth(o);return i>s?i:s}},{key:"onModifyColumnHeaderValue",value:function(i,o,s){var a,h=(a=Pi(this,Yi).getHeaderTreeNodeData(s,o))!==null&&a!==void 0?a:{label:""},p=h.label;return p}},{key:"onInit",value:function(){this.updatePlugin()}},{key:"onAfterLoadData",value:function(i,o){o||this.updatePlugin()}},{key:"destroy",value:function(){DO(this,Yi,null),Pi(this,Of)!==null&&(Pi(this,Of).unsubscribe(),DO(this,Of,null)),hp(yc(r.prototype),"destroy",this).call(this)}},{key:"_getHeaderTreeNodeDataByCoords",value:function(i){if(!(i.row>=0||i.col<0))return Pi(this,Yi).getHeaderTreeNodeData(i.row,i.col)}}],[{key:"PLUGIN_KEY",get:function(){return cQ}},{key:"PLUGIN_PRIORITY",get:function(){return Qmt}}]),r}(Wn);function fQ(e){return iyt(e)||nyt(e)||ryt(e)||tyt()}function tyt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ryt(e,t){if(e){if(typeof e=="string")return mz(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return mz(e,t)}}function nyt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function iyt(e){if(Array.isArray(e))return mz(e)}function mz(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function A_(e){"@babel/helpers - typeof";return A_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},A_(e)}function oyt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function hQ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,syt(n.key),n)}}function ayt(e,t,r){return t&&hQ(e.prototype,t),r&&hQ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function syt(e){var t=lyt(e,"string");return A_(t)==="symbol"?t:String(t)}function lyt(e,t){if(A_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(A_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var uyt=function(){function e(t,r){oyt(this,e),this.hot=r,this.data=null,this.plugin=t,this.parentReference=new WeakMap,this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}}return ayt(e,[{key:"setData",value:function(r){this.data=r}},{key:"getData",value:function(){return this.data}},{key:"getRawSourceData",value:function(){var r=null;return this.plugin.disableCoreAPIModifiers(),r=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),r}},{key:"updateWithData",value:function(r){this.setData(r),this.rewriteCache()}},{key:"rewriteCache",value:function(){var r=this;this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},Er(0,this.data.length-1,function(n){r.cacheNode(r.data[n],0,null)})}},{key:"cacheNode",value:function(r,n,i){var o=this;this.cache.levels[n]||(this.cache.levels[n]=[],this.cache.levelCount+=1),this.cache.levels[n].push(r),this.cache.rows.push(r),this.cache.nodeInfo.set(r,{parent:i,row:this.cache.rows.length-1,level:n}),this.hasChildren(r)&&Le(r.__children,function(s){o.cacheNode(s,n+1,r)})}},{key:"getDataObject",value:function(r){return r==null?null:this.cache.rows[r]}},{key:"readTreeNodes",value:function(r,n,i,o){var s=this,a=!1,h=n;if(isNaN(h)&&h.end)return h;var p=r;return p||(p={__children:this.data},a=!0,h-=1),i!=null&&h===i?{result:p,end:!0}:o!=null&&p===o?{result:h,end:!0}:(h+=1,p.__children&&Le(p.__children,function(g){if(s.parentReference.set(g,a?null:p),h=s.readTreeNodes(g,h,i,o),isNaN(h)&&h.end)return!1}),h)}},{key:"mockParent",value:function(){var r=this.mockNode();return r.__children=this.data,r}},{key:"mockNode",value:function(){var r={};return pn(this.data[0],function(n,i){r[i]=null}),r}},{key:"getRowIndex",value:function(r){return r==null?null:this.cache.nodeInfo.get(r).row}},{key:"getRowIndexWithinParent",value:function(r){var n=null;isNaN(r)?n=r:n=this.getDataObject(r);var i=this.getRowParent(r);return i==null?this.data.indexOf(n):i.__children.indexOf(n)}},{key:"countAllRows",value:function(){var r={__children:this.data};return this.countChildren(r)}},{key:"countChildren",value:function(r){var n=this,i=0,o=r;return isNaN(o)||(o=this.getDataObject(o)),!o||!o.__children?0:(Le(o.__children,function(s){i+=1,s.__children&&(i+=n.countChildren(s))}),i)}},{key:"getRowParent",value:function(r){var n;return isNaN(r)?n=r:n=this.getDataObject(r),this.getRowObjectParent(n)}},{key:"getRowObjectParent",value:function(r){return!r||A_(r)!=="object"?null:this.cache.nodeInfo.get(r).parent}},{key:"getRowLevel",value:function(r){var n=null;return isNaN(r)?n=r:n=this.getDataObject(r),n?this.getRowObjectLevel(n):null}},{key:"getRowObjectLevel",value:function(r){return r==null?null:this.cache.nodeInfo.get(r).level}},{key:"hasChildren",value:function(r){var n=r;return isNaN(n)||(n=this.getDataObject(n)),!!(n.__children&&n.__children.length)}},{key:"isChild",value:function(r){return this.getRowParent(r)!==null}},{key:"getChild",value:function(r,n){var i;return((i=r.__children)===null||i===void 0?void 0:i[n])||null}},{key:"isRowHighestLevel",value:function(r){return!this.isChild(r)}},{key:"isParent",value:function(r){var n,i=r;return isNaN(i)||(i=this.getDataObject(i)),i&&!!i.__children&&((n=i.__children)===null||n===void 0?void 0:n.length)!==0}},{key:"addChild",value:function(r,n){var i=n;this.hot.runHooks("beforeAddChild",r,i);var o=null;r&&(o=this.getRowIndex(r)),this.hot.runHooks("beforeCreateRow",o+this.countChildren(r)+1,1);var s=r;r||(s=this.mockParent()),s.__children||(s.__children=[]),i||(i=this.mockNode()),s.__children.push(i),this.rewriteCache();var a=this.getRowIndex(i);this.hot.rowIndexMapper.insertIndexes(a,1),this.hot.runHooks("afterCreateRow",a,1),this.hot.runHooks("afterAddChild",r,i)}},{key:"addChildAtIndex",value:function(r,n,i){var o=i,s;if(o||(o=this.mockNode()),this.hot.runHooks("beforeAddChild",r,o,n),r){var a=this.getRowIndex(r),h=a+n+1;this.hot.runHooks("beforeCreateRow",h,1),r.__children.splice(n,null,o),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(r),"__children",r.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(h,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",h,1),s=h}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",n,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),s=this.getRowIndex(this.data[n]);o=this.getDataObject(s),this.hot.runHooks("afterAddChild",r,o,n)}},{key:"addSibling",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"below",i=this.translateTrimmedRow(r),o=this.getRowParent(i),s=this.getRowIndexWithinParent(i);switch(n){case"below":this.addChildAtIndex(o,s+1,null);break;case"above":this.addChildAtIndex(o,s,null);break}}},{key:"detachFromParent",value:function(r){var n=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,o=null,s=[];Array.isArray(r)?(Er(r[0],r[2],function(z){var V=n.translateTrimmedRow(z);s.push(n.getDataObject(V))}),Er(0,s.length-2,function(z){n.detachFromParent(s[z],!1)}),o=s[s.length-1]):o=r;var a=this.getRowIndex(o),h=this.countChildren(o),p=this.getRowIndexWithinParent(o),g=this.getRowParent(o),S=this.getRowParent(g),T=this.getRowIndex(S),R=null;if(this.hot.runHooks("beforeDetachChild",g,o),p!=null){var A=Array.from(new Array(a+h+1).keys()).splice(-1*(h+1));if(this.hot.runHooks("beforeRemoveRow",a,h+1,A,this.plugin.pluginName),g.__children.splice(p,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",a,h+1,A,this.plugin.pluginName),S){R=T+this.countChildren(S);var $=this.getChild(S,this.countChildren(S)-1),j=this.getRowIndex($);this.hot.runHooks("beforeCreateRow",j+1,h+1,this.plugin.pluginName),S.__children.push(o)}else R=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",R-2,h+1,this.plugin.pluginName),this.data.push(o)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",R-2,h+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",g,o,this.getRowIndex(o)),i&&this.hot.render()}},{key:"filterData",value:function(r,n,i){var o=this,s=[];Le(i,function(a){s.push(o.getDataObject(a))}),Le(s,function(a){var h=o.getRowIndexWithinParent(a),p=o.getRowParent(a);p===null?o.data.splice(h,1):p.__children.splice(h,1)}),this.rewriteCache()}},{key:"spliceData",value:function(r,n,i){var o=this.getDataObject(r-1),s=null,a=r;if(o&&o.__children&&o.__children.length===0?(s=o,a=0):r<this.countAllRows()&&(s=this.getRowParent(r),a=this.getRowIndexWithinParent(r)),s)if(i){var h;(h=s.__children).splice.apply(h,[a,n].concat(fQ(i)))}else s.__children.splice(a,n);else if(i){var p;(p=this.data).splice.apply(p,[a,n].concat(fQ(i)))}else this.data.splice(a,n);this.rewriteCache()}},{key:"syncRowWithRawSource",value:function(r){var n=r,i=null;do i=this.getRowParent(i),i!==null&&(n=i);while(i!==null);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndex(n),"__children",n.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}},{key:"moveRow",value:function(r,n,i,o){var s=n===this.hot.countRows(),a=this.getRowParent(r),h=this.getRowIndexWithinParent(r),p=a.__children.slice(h,h+1),g=r>n,S=s?this.getRowParent(n-1):this.getRowParent(n);S==null&&(S=this.getRowParent(n-1)),S==null&&(S=this.getDataObject(n-1)),S?S.__children||(S.__children=[]):(S=this.getDataObject(n),S.__children=[]);var T=s||i||o?S.__children.length:this.getRowIndexWithinParent(n),R=a===S;S.__children.splice(T,0,p[0]),a.__children.splice(h+(g&&R?1:0),1),this.syncRowWithRawSource(a),R||this.syncRowWithRawSource(S)}},{key:"translateTrimmedRow",value:function(r){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(r):r}},{key:"untranslateTrimmedRow",value:function(r){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(r):r}}]),e}();const cyt=uyt;function Sx(e){"@babel/helpers - typeof";return Sx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sx(e)}function dQ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,hyt(n.key),n)}}function fyt(e,t,r){return t&&dQ(e.prototype,t),r&&dQ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function hyt(e){var t=dyt(e,"string");return Sx(t)==="symbol"?t:String(t)}function dyt(e,t){if(Sx(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Sx(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function pyt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var myt=fyt(function e(t,r){pyt(this,e),this.hot=r,this.plugin=t});const wU=myt;function I_(e){"@babel/helpers - typeof";return I_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},I_(e)}function yyt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pQ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,vyt(n.key),n)}}function gyt(e,t,r){return t&&pQ(e.prototype,t),r&&pQ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function vyt(e){var t=_yt(e,"string");return I_(t)==="symbol"?t:String(t)}function _yt(e,t){if(I_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(I_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function byt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&yz(e,t)}function yz(e,t){return yz=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},yz(e,t)}function wyt(e){var t=Cyt();return function(){var n=bP(e),i;if(t){var o=bP(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Syt(this,i)}}function Syt(e,t){if(t&&(I_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return xyt(e)}function xyt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Cyt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function bP(e){return bP=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},bP(e)}var Eyt=function(e){byt(r,e);var t=wyt(r);function r(n,i){var o;return yyt(this,r),o=t.call(this,n,i),o.dataManager=o.plugin.dataManager,o.collapsingUI=o.plugin.collapsingUI,o.rowHeaderWidthCache=null,o}return gyt(r,[{key:"appendLevelIndicators",value:function(i,o){var s=this.hot.toPhysicalRow(i),a=this.dataManager.getRowLevel(s),h=this.dataManager.getDataObject(s),p=o.getElementsByTagName("DIV")[0],g=p.querySelector("span.rowHeader"),S=p.querySelectorAll('[class^="ht_nesting"]');if(Le(S,function($){$&&p.removeChild($)}),Ht(o,r.CSS_CLASSES.indicatorContainer),a){var T=this.hot.rootDocument,R=g.cloneNode(!0);p.innerHTML="",Er(0,a-1,function(){var $=T.createElement("SPAN");Ht($,r.CSS_CLASSES.emptyIndicator),p.appendChild($)}),p.appendChild(R)}if(this.dataManager.hasChildren(h)){var A=this.hot.rootDocument.createElement("DIV");Ht(o,r.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(s)?Ht(A,"".concat(r.CSS_CLASSES.button," ").concat(r.CSS_CLASSES.expandButton)):Ht(A,"".concat(r.CSS_CLASSES.button," ").concat(r.CSS_CLASSES.collapseButton)),p.appendChild(A)}}},{key:"updateRowHeaderWidth",value:function(i){var o=i;o||(o=this.dataManager.cache.levelCount),this.rowHeaderWidthCache=Math.max(50,11+10*o+25),this.hot.render()}}],[{key:"CSS_CLASSES",get:function(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}}]),r}(wU);const ece=Eyt;function M_(e){"@babel/helpers - typeof";return M_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},M_(e)}function mQ(e){return kyt(e)||Ryt(e)||Oyt(e)||Tyt()}function Tyt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Oyt(e,t){if(e){if(typeof e=="string")return gz(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return gz(e,t)}}function Ryt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function kyt(e){if(Array.isArray(e))return gz(e)}function gz(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Pyt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yQ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Iyt(n.key),n)}}function Ayt(e,t,r){return t&&yQ(e.prototype,t),r&&yQ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Iyt(e){var t=Myt(e,"string");return M_(t)==="symbol"?t:String(t)}function Myt(e,t){if(M_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(M_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Dyt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&vz(e,t)}function vz(e,t){return vz=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},vz(e,t)}function $yt(e){var t=Byt();return function(){var n=wP(e),i;if(t){var o=wP(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Lyt(this,i)}}function Lyt(e,t){if(t&&(M_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Nyt(e)}function Nyt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Byt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function wP(e){return wP=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},wP(e)}var jyt=function(e){Dyt(r,e);var t=$yt(r);function r(n,i){var o;return Pyt(this,r),o=t.call(this,n,i),o.dataManager=o.plugin.dataManager,o.collapsedRows=[],o.collapsedRowsStash={stash:function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;o.lastCollapsedRows=o.collapsedRows.slice(0),o.expandMultipleChildren(o.lastCollapsedRows,a)},shiftStash:function(a,h){var p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;h==null&&(h=1/0),Le(o.lastCollapsedRows,function(g,S){g>=a&&g<h&&(o.lastCollapsedRows[S]=g+p)})},applyStash:function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;o.collapseMultipleChildren(o.lastCollapsedRows,a),o.lastCollapsedRows=void 0},trimStash:function(a,h){Er(a,a+h-1,function(p){var g=o.lastCollapsedRows.indexOf(p);g>-1&&o.lastCollapsedRows.splice(g,1)})}},o}return Ayt(r,[{key:"collapseChildren",value:function(i){var o=this,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,h=[],p=null,g=null,S=null;return isNaN(i)?(p=i,g=this.dataManager.getRowIndex(p)):(p=this.dataManager.getDataObject(i),g=i),this.dataManager.hasChildren(p)&&Le(p.__children,function(T){h.push(o.dataManager.getRowIndex(T))}),S=this.collapseRows(h,!0,!1),a&&this.trimRows(S),s&&this.renderAndAdjust(),this.collapsedRows.indexOf(g)===-1&&this.collapsedRows.push(g),S}},{key:"collapseMultipleChildren",value:function(i){var o=this,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,h=[];Le(i,function(p){h.push.apply(h,mQ(o.collapseChildren(p,!1,!1)))}),a&&this.trimRows(h),s&&this.renderAndAdjust()}},{key:"collapseRow",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.collapseRows([i],o)}},{key:"collapseRows",value:function(i){var o=this,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,h=[];return Le(i,function(p){h.push(p),s&&o.collapseChildRows(p,h)}),a&&this.trimRows(h),h}},{key:"collapseChildRows",value:function(i){var o=this,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(i)){var h=this.dataManager.getDataObject(i);Le(h.__children,function(p){var g=o.dataManager.getRowIndex(p);s.push(g),o.collapseChildRows(g,s)})}a&&this.trimRows(s)}},{key:"expandRow",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.expandRows([i],o)}},{key:"expandRows",value:function(i){var o=this,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,h=[];return Le(i,function(p){h.push(p),s&&o.expandChildRows(p,h)}),a&&this.untrimRows(h),h}},{key:"expandChildRows",value:function(i){var o=this,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(i)){var h=this.dataManager.getDataObject(i);Le(h.__children,function(p){if(!o.isAnyParentCollapsed(p)){var g=o.dataManager.getRowIndex(p);s.push(g),o.expandChildRows(g,s)}})}a&&this.untrimRows(s)}},{key:"expandChildren",value:function(i){var o=this,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,h=[],p=null,g=null,S=null;return isNaN(i)?(p=i,g=this.dataManager.getRowIndex(i)):(p=this.dataManager.getDataObject(i),g=i),this.collapsedRows.splice(this.collapsedRows.indexOf(g),1),this.dataManager.hasChildren(p)&&Le(p.__children,function(T){var R=o.dataManager.getRowIndex(T);h.push(R)}),S=this.expandRows(h,!0,!1),a&&this.untrimRows(S),s&&this.renderAndAdjust(),S}},{key:"expandMultipleChildren",value:function(i){var o=this,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,h=[];Le(i,function(p){h.push.apply(h,mQ(o.expandChildren(p,!1,!1)))}),a&&this.untrimRows(h),s&&this.renderAndAdjust()}},{key:"collapseAll",value:function(){var i=this,o=this.dataManager.getData(),s=[];Le(o,function(a){i.dataManager.hasChildren(a)&&s.push(a)}),this.collapseMultipleChildren(s),this.renderAndAdjust()}},{key:"expandAll",value:function(){var i=this,o=this.dataManager.getData(),s=[];Le(o,function(a){i.dataManager.hasChildren(a)&&s.push(a)}),this.expandMultipleChildren(s),this.renderAndAdjust()}},{key:"trimRows",value:function(i){var o=this;this.hot.batchExecution(function(){Le(i,function(s){o.plugin.collapsedRowsMap.setValueAtIndex(s,!0)})},!0)}},{key:"untrimRows",value:function(i){var o=this;this.hot.batchExecution(function(){Le(i,function(s){o.plugin.collapsedRowsMap.setValueAtIndex(s,!1)})},!0)}},{key:"areChildrenCollapsed",value:function(i){var o=this,s=isNaN(i)?i:this.dataManager.getDataObject(i),a=!0;return s===null&&(s={__children:this.dataManager.data}),this.dataManager.hasChildren(s)&&Le(s.__children,function(h){var p=o.dataManager.getRowIndex(h);if(!o.plugin.collapsedRowsMap.getValueAtIndex(p))return a=!1,!1}),a}},{key:"isAnyParentCollapsed",value:function(i){for(var o=i;o!==null;){o=this.dataManager.getRowParent(o);var s=this.dataManager.getRowIndex(o);if(this.collapsedRows.indexOf(s)>-1)return!0}return!1}},{key:"toggleState",value:function(i,o){if(!(o.col>=0)){var s=this.translateTrimmedRow(o.row);Ur(i.target,ece.CSS_CLASSES.button)&&(this.areChildrenCollapsed(s)?this.expandChildren(s):this.collapseChildren(s),lu(i))}}},{key:"translateTrimmedRow",value:function(i){return this.hot.toPhysicalRow(i)}},{key:"untranslateTrimmedRow",value:function(i){return this.hot.toVisualRow(i)}},{key:"renderAndAdjust",value:function(){this.hot.render(),this.hot.view.adjustElementsSize()}}]),r}(wU);const zyt=jyt;function D_(e){"@babel/helpers - typeof";return D_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},D_(e)}function Fyt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gQ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Vyt(n.key),n)}}function Hyt(e,t,r){return t&&gQ(e.prototype,t),r&&gQ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Vyt(e){var t=Uyt(e,"string");return D_(t)==="symbol"?t:String(t)}function Uyt(e,t){if(D_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(D_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Wyt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_z(e,t)}function _z(e,t){return _z=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},_z(e,t)}function Gyt(e){var t=Kyt();return function(){var n=SP(e),i;if(t){var o=SP(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Yyt(this,i)}}function Yyt(e,t){if(t&&(D_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return tce(e)}function tce(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Kyt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function SP(e){return SP=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},SP(e)}var vQ=new WeakMap,qyt=function(e){Wyt(r,e);var t=Gyt(r);function r(n,i){var o;return Fyt(this,r),o=t.call(this,n,i),vQ.set(tce(o),{row_above:function(a,h){var p=h[h.length-1];o.dataManager.addSibling(p.start.row,"above")},row_below:function(a,h){var p=h[h.length-1];o.dataManager.addSibling(p.start.row,"below")}}),o.dataManager=o.plugin.dataManager,o}return Hyt(r,[{key:"appendOptions",value:function(i){var o=this,s=[{key:"add_child",name:function(){return this.getTranslatedPhrase(xV)},callback:function(){var h=o.dataManager.translateTrimmedRow(o.hot.getSelectedLast()[0]),p=o.dataManager.getDataObject(h);o.dataManager.addChild(p)},disabled:function(){var h=o.hot.getSelectedLast();return!h||h[0]<0||o.hot.selection.isSelectedByColumnHeader()||o.hot.countRows()>=o.hot.getSettings().maxRows}},{key:"detach_from_parent",name:function(){return this.getTranslatedPhrase(CV)},callback:function(){o.dataManager.detachFromParent(o.hot.getSelectedLast())},disabled:function(){var h=o.hot.getSelectedLast(),p=o.dataManager.translateTrimmedRow(h[0]),g=o.dataManager.getRowParent(p);return!g||!h||h[0]<0||o.hot.selection.isSelectedByColumnHeader()||o.hot.countRows()>=o.hot.getSettings().maxRows}},{name:"---------"}];return Er(0,i.items.length-1,function(a){if(a===0)return Le(s,function(h,p){i.items.splice(a+p,0,h)}),!1}),this.modifyRowInsertingOptions(i)}},{key:"modifyRowInsertingOptions",value:function(i){var o=vQ.get(this);return Er(0,i.items.length-1,function(s){var a=o[i.items[s].key];a!=null&&(i.items[s].callback=a)}),i}}]),r}(wU);const Xyt=qyt;function xx(e){"@babel/helpers - typeof";return xx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xx(e)}var _Q;function bQ(e){return egt(e)||Qyt(e)||Jyt(e)||Zyt()}function Zyt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Jyt(e,t){if(e){if(typeof e=="string")return bz(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return bz(e,t)}}function Qyt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function egt(e){if(Array.isArray(e))return bz(e)}function bz(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function tgt(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function rgt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function wQ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,igt(n.key),n)}}function ngt(e,t,r){return t&&wQ(e.prototype,t),r&&wQ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function igt(e){var t=ogt(e,"string");return xx(t)==="symbol"?t:String(t)}function ogt(e,t){if(xx(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(xx(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var agt=function(){function e(t){rgt(this,e),this.plugin=t,this.hot=t.hot,this.dataManager=t.dataManager,this.collapsingUI=t.collapsingUI}return ngt(e,[{key:"onBeforeRowMove",value:function(r,n,i,o){var s=this,a=this.displayAPICompatibilityWarning({rows:r,finalIndex:n,dropIndex:i,movePossible:o});if(a)return!1;this.movedToCollapsed=!1;var h=i===this.hot.countRows(),p=h?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(i),g=!0,S=r.map(function(j){if(!g)return!1;var z=s.dataManager.translateTrimmedRow(j);return g=s.shouldAllowMoving(z,p),z}),T=S.indexOf(p)===-1;if(!g||!T)return!1;var R=this.getBaseParent(S),A=this.getTargetParent(h,p),$=R===A;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(A),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(S,p,$),this.moveRows(S,p,A),this.dataManager.rewriteCache(),this.moveCellsMeta(S,p),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",r,n,i,o,o&&this.isRowOrderChanged(r,n)),this.hot.render(),this.selectCells(r,i),!1}},{key:"displayAPICompatibilityWarning",value:function(r){var n=r.rows,i=r.finalIndex,o=r.dropIndex,s=r.movePossible,a=!1;return si(o)&&(ti(Xn(_Q||(_Q=tgt([`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows 
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`],[`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`])))),this.hot.runHooks("afterRowMove",n,i,o,s,!1),a=!0),a}},{key:"shouldAllowMoving",value:function(r,n){return!(this.dataManager.isParent(r)||this.dataManager.isRowHighestLevel(r)||r===n||n===0)}},{key:"getBaseParent",value:function(r){return this.dataManager.getRowParent(r[0])}},{key:"getTargetParent",value:function(r,n){var i=this.dataManager.getRowParent(r?n-1:n);return i==null&&(i=this.dataManager.getRowParent(n-1)),i}},{key:"shiftCollapsibleParentsLocations",value:function(r,n,i){i||(Math.max.apply(Math,bQ(r))<=n?this.collapsingUI.collapsedRowsStash.shiftStash(r[0],n,-1*r.length):this.collapsingUI.collapsedRowsStash.shiftStash(n,r[0],r.length))}},{key:"moveRows",value:function(r,n,i){var o=this,s=n===this.dataManager.getRowIndex(i)+this.dataManager.countChildren(i)+1;this.hot.batchRender(function(){r.forEach(function(a){o.dataManager.moveRow(a,n,o.movedToCollapsed,s)})})}},{key:"moveCellsMeta",value:function(r,n){var i=this,o,s=[],a=Math.max.apply(Math,bQ(r))<n;r.forEach(function(h){s.push(i.hot.getCellMetaAtRow(h))}),this.hot.spliceCellsMeta(r[0],r.length),(o=this.hot).spliceCellsMeta.apply(o,[n-(a?s.length:0),0].concat(s))}},{key:"selectCells",value:function(r,n){var i=r.length,o=0,s=0,a=null,h=null;if(this.movedToCollapsed){var p=null;r[i-1]<n?p=this.dataManager.translateTrimmedRow(n-i):p=this.dataManager.translateTrimmedRow(n);var g=this.dataManager.getRowParent(p===null?this.hot.countSourceRows()-1:p-1),S=this.dataManager.getRowIndex(g);o=this.dataManager.untranslateTrimmedRow(S),s=o}else r[i-1]<n?(s=n-1,o=s-i+1):(o=n,s=o+i-1);a=this.hot.selection,h=this.hot.countCols()-1,a.setRangeStart(this.hot._createCellCoords(o,0)),a.setRangeEnd(this.hot._createCellCoords(s,h),!0)}},{key:"isRowOrderChanged",value:function(r,n){return r.some(function(i,o){return i-o!==n})}}]),e}();function $_(e){"@babel/helpers - typeof";return $_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$_(e)}function sgt(e){return fgt(e)||cgt(e)||ugt(e)||lgt()}function lgt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ugt(e,t){if(e){if(typeof e=="string")return wz(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return wz(e,t)}}function cgt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function fgt(e){if(Array.isArray(e))return wz(e)}function wz(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function hgt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function SQ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,pgt(n.key),n)}}function dgt(e,t,r){return t&&SQ(e.prototype,t),r&&SQ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function pgt(e){var t=mgt(e,"string");return $_(t)==="symbol"?t:String(t)}function mgt(e,t){if($_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if($_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function dp(){return typeof Reflect<"u"&&Reflect.get?dp=Reflect.get.bind():dp=function(t,r,n){var i=ygt(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},dp.apply(this,arguments)}function ygt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=gc(e),e!==null););return e}function ggt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Sz(e,t)}function Sz(e,t){return Sz=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Sz(e,t)}function vgt(e){var t=bgt();return function(){var n=gc(e),i;if(t){var o=gc(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return _gt(this,i)}}function _gt(e,t){if(t&&($_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return rce(e)}function rce(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function bgt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function gc(e){return gc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},gc(e)}var I2="nestedRows",wgt=300,Bu=new WeakMap,Sgt="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.",xgt=function(e){ggt(r,e);var t=vgt(r);function r(n){var i;return hgt(this,r),i=t.call(this,n),i.dataManager=null,i.headersUI=null,i.collapsedRowsMap=null,Bu.set(rce(i),{movedToCollapsed:!1,skipRender:null,skipCoreAPIModifiers:!1}),i}return dgt(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[I2]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new vC),this.dataManager=new cyt(this,this.hot),this.collapsingUI=new zyt(this,this.hot),this.headersUI=new ece(this,this.hot),this.contextMenuUI=new Xyt(this,this.hot),this.rowMoveController=new agt(this),this.addHook("afterInit",function(){return i.onAfterInit.apply(i,arguments)}),this.addHook("beforeViewRender",function(){return i.onBeforeViewRender.apply(i,arguments)}),this.addHook("modifyRowData",function(){return i.onModifyRowData.apply(i,arguments)}),this.addHook("modifySourceLength",function(){return i.onModifySourceLength.apply(i,arguments)}),this.addHook("beforeDataSplice",function(){return i.onBeforeDataSplice.apply(i,arguments)}),this.addHook("filterData",function(){return i.onFilterData.apply(i,arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){return i.onAfterContextMenuDefaultOptions.apply(i,arguments)}),this.addHook("afterGetRowHeader",function(){return i.onAfterGetRowHeader.apply(i,arguments)}),this.addHook("beforeOnCellMouseDown",function(){return i.onBeforeOnCellMouseDown.apply(i,arguments)}),this.addHook("beforeRemoveRow",function(){return i.onBeforeRemoveRow.apply(i,arguments)}),this.addHook("afterRemoveRow",function(){return i.onAfterRemoveRow.apply(i,arguments)}),this.addHook("beforeAddChild",function(){return i.onBeforeAddChild.apply(i,arguments)}),this.addHook("afterAddChild",function(){return i.onAfterAddChild.apply(i,arguments)}),this.addHook("beforeDetachChild",function(){return i.onBeforeDetachChild.apply(i,arguments)}),this.addHook("afterDetachChild",function(){return i.onAfterDetachChild.apply(i,arguments)}),this.addHook("modifyRowHeaderWidth",function(){return i.onModifyRowHeaderWidth.apply(i,arguments)}),this.addHook("afterCreateRow",function(){return i.onAfterCreateRow.apply(i,arguments)}),this.addHook("beforeRowMove",function(){return i.onBeforeRowMove.apply(i,arguments)}),this.addHook("beforeLoadData",function(o){return i.onBeforeLoadData(o)}),this.addHook("beforeUpdateData",function(o){return i.onBeforeLoadData(o)}),dp(gc(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),dp(gc(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin();var i=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(i),dp(gc(r.prototype),"updatePlugin",this).call(this)}},{key:"onBeforeRowMove",value:function(i,o,s,a){return this.rowMoveController.onBeforeRowMove(i,o,s,a)}},{key:"disableCoreAPIModifiers",value:function(){var i=Bu.get(this);i.skipCoreAPIModifiers=!0}},{key:"enableCoreAPIModifiers",value:function(){var i=Bu.get(this);i.skipCoreAPIModifiers=!1}},{key:"onBeforeOnCellMouseDown",value:function(i,o,s){this.collapsingUI.toggleState(i,o,s)}},{key:"onModifyRowData",value:function(i){var o=Bu.get(this);if(!o.skipCoreAPIModifiers)return this.dataManager.getDataObject(i)}},{key:"onModifySourceLength",value:function(){var i=Bu.get(this);if(!i.skipCoreAPIModifiers)return this.dataManager.countAllRows()}},{key:"onBeforeDataSplice",value:function(i,o,s){var a=Bu.get(this);return a.skipCoreAPIModifiers||this.dataManager.isRowHighestLevel(i)?!0:(this.dataManager.spliceData(i,o,s),!1)}},{key:"onFilterData",value:function(i,o,s){var a=Bu.get(this);return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(s[0],o),this.collapsingUI.collapsedRowsStash.shiftStash(s[0],null,-1*o),this.dataManager.filterData(i,o,s),a.skipRender=!0,this.dataManager.getData().slice()}},{key:"onAfterContextMenuDefaultOptions",value:function(i){return this.contextMenuUI.appendOptions(i)}},{key:"onAfterGetRowHeader",value:function(i,o){this.headersUI.appendLevelIndicators(i,o)}},{key:"onModifyRowHeaderWidth",value:function(i){return this.headersUI.rowHeaderWidthCache||i}},{key:"onAfterRemoveRow",value:function(i,o,s,a){var h=this;if(a!==this.pluginName){var p=Bu.get(this);setTimeout(function(){p.skipRender=null,h.headersUI.updateRowHeaderWidth(),h.collapsingUI.collapsedRowsStash.applyStash()},0)}}},{key:"onBeforeRemoveRow",value:function(i,o,s){var a=this,h=Array.from(s.reduce(function(p,g){if(a.dataManager.isParent(g)){var S=a.dataManager.getDataObject(g).__children;return p.add(g),Array.isArray(S)&&S.forEach(function(T){return p.add(a.dataManager.getRowIndex(T))}),p}return p.add(g)},new Set));s.length=0,s.push.apply(s,h)}},{key:"onBeforeAddChild",value:function(){this.collapsingUI.collapsedRowsStash.stash()}},{key:"onAfterAddChild",value:function(i,o){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(o)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}},{key:"onBeforeDetachChild",value:function(){this.collapsingUI.collapsedRowsStash.stash()}},{key:"onAfterDetachChild",value:function(i,o,s){this.collapsingUI.collapsedRowsStash.shiftStash(s,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}},{key:"onAfterCreateRow",value:function(){this.dataManager.rewriteCache()}},{key:"onAfterInit",value:function(){var i=Math.max.apply(Math,sgt(this.dataManager.cache.levels));i>0&&this.headersUI.updateRowHeaderWidth(i)}},{key:"onBeforeViewRender",value:function(i,o){var s=Bu.get(this);s.skipRender&&(o.skipRender=!0)}},{key:"destroy",value:function(){dp(gc(r.prototype),"destroy",this).call(this)}},{key:"onBeforeLoadData",value:function(i){if(!yZe(i)){i3(Sgt),this.hot.getSettings()[I2]=!1,this.disablePlugin();return}this.dataManager.setData(i),this.dataManager.rewriteCache()}}],[{key:"PLUGIN_KEY",get:function(){return I2}},{key:"PLUGIN_PRIORITY",get:function(){return wgt}}]),r}(Wn);function Cx(e){"@babel/helpers - typeof";return Cx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cx(e)}function Cgt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function xQ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Tgt(n.key),n)}}function Egt(e,t,r){return t&&xQ(e.prototype,t),r&&xQ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Tgt(e){var t=Ogt(e,"string");return Cx(t)==="symbol"?t:String(t)}function Ogt(e,t){if(Cx(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Cx(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Rgt=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;Cgt(this,e),this.rootWindow=r,this.prefix=t,this.savedKeys=[],this.loadSavedKeys()}return Egt(e,[{key:"saveValue",value:function(r,n){this.rootWindow.localStorage.setItem("".concat(this.prefix,"_").concat(r),JSON.stringify(n)),this.savedKeys.indexOf(r)===-1&&(this.savedKeys.push(r),this.saveSavedKeys())}},{key:"loadValue",value:function(r,n){var i=typeof r>"u"?n:r,o=this.rootWindow.localStorage.getItem("".concat(this.prefix,"_").concat(i));return o===null?void 0:JSON.parse(o)}},{key:"reset",value:function(r){this.rootWindow.localStorage.removeItem("".concat(this.prefix,"_").concat(r))}},{key:"resetAll",value:function(){var r=this;Le(this.savedKeys,function(n,i){r.rootWindow.localStorage.removeItem("".concat(r.prefix,"_").concat(r.savedKeys[i]))}),this.clearSavedKeys()}},{key:"loadSavedKeys",value:function(){var r=this.rootWindow.localStorage.getItem("".concat(this.prefix,"__persistentStateKeys")),n=typeof r=="string"?JSON.parse(r):void 0;this.savedKeys=n||[]}},{key:"saveSavedKeys",value:function(){this.rootWindow.localStorage.setItem("".concat(this.prefix,"__persistentStateKeys"),JSON.stringify(this.savedKeys))}},{key:"clearSavedKeys",value:function(){this.savedKeys.length=0,this.saveSavedKeys()}}]),e}();const kgt=Rgt;function L_(e){"@babel/helpers - typeof";return L_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},L_(e)}function Pgt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function CQ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Igt(n.key),n)}}function Agt(e,t,r){return t&&CQ(e.prototype,t),r&&CQ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Igt(e){var t=Mgt(e,"string");return L_(t)==="symbol"?t:String(t)}function Mgt(e,t){if(L_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(L_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function pp(){return typeof Reflect<"u"&&Reflect.get?pp=Reflect.get.bind():pp=function(t,r,n){var i=Dgt(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},pp.apply(this,arguments)}function Dgt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=vc(e),e!==null););return e}function $gt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&xz(e,t)}function xz(e,t){return xz=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},xz(e,t)}function Lgt(e){var t=jgt();return function(){var n=vc(e),i;if(t){var o=vc(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Ngt(this,i)}}function Ngt(e,t){if(t&&(L_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Bgt(e)}function Bgt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function jgt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function vc(e){return vc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},vc(e)}mr.getSingleton().register("persistentStateSave");mr.getSingleton().register("persistentStateLoad");mr.getSingleton().register("persistentStateReset");var EQ="persistentState",zgt=0,Fgt=function(e){$gt(r,e);var t=Lgt(r);function r(n){var i;return Pgt(this,r),i=t.call(this,n),i.storage=void 0,i}return Agt(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[EQ]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.storage||(this.storage=new kgt(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",function(o,s){return i.saveValue(o,s)}),this.addHook("persistentStateLoad",function(o,s){return i.loadValue(o,s)}),this.addHook("persistentStateReset",function(){return i.resetValue()}),pp(vc(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.storage=void 0,pp(vc(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),pp(vc(r.prototype),"updatePlugin",this).call(this)}},{key:"loadValue",value:function(i,o){o.value=this.storage.loadValue(i)}},{key:"saveValue",value:function(i,o){this.storage.saveValue(i,o)}},{key:"resetValue",value:function(i){typeof i>"u"?this.storage.resetAll():this.storage.reset(i)}},{key:"destroy",value:function(){pp(vc(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return EQ}},{key:"PLUGIN_PRIORITY",get:function(){return zgt}}]),r}(Wn);function N_(e){"@babel/helpers - typeof";return N_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},N_(e)}function Hgt(e){return Ggt(e)||Wgt(e)||Ugt(e)||Vgt()}function Vgt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ugt(e,t){if(e){if(typeof e=="string")return Cz(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Cz(e,t)}}function Wgt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Ggt(e){if(Array.isArray(e))return Cz(e)}function Cz(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Ygt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function TQ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,qgt(n.key),n)}}function Kgt(e,t,r){return t&&TQ(e.prototype,t),r&&TQ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function qgt(e){var t=Xgt(e,"string");return N_(t)==="symbol"?t:String(t)}function Xgt(e,t){if(N_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(N_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function mp(){return typeof Reflect<"u"&&Reflect.get?mp=Reflect.get.bind():mp=function(t,r,n){var i=Zgt(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},mp.apply(this,arguments)}function Zgt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=_c(e),e!==null););return e}function Jgt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ez(e,t)}function Ez(e,t){return Ez=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Ez(e,t)}function Qgt(e){var t=rvt();return function(){var n=_c(e),i;if(t){var o=_c(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return evt(this,i)}}function evt(e,t){if(t&&(N_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return tvt(e)}function tvt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function rvt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _c(e){return _c=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_c(e)}var M2="search",nvt=190,ivt="htSearchResult",ovt=function(t,r,n,i,o){t.getCellMeta(r,n).isSearchResult=o},avt=function(t,r,n){return si(t)||t===null||!t.toLocaleLowerCase||t.length===0||si(r)||r===null?!1:r.toString().toLocaleLowerCase(n.locale).indexOf(t.toLocaleLowerCase(n.locale))!==-1},svt=function(e){Jgt(r,e);var t=Qgt(r);function r(n){var i;return Ygt(this,r),i=t.call(this,n),i.callback=ovt,i.queryMethod=avt,i.searchResultClass=ivt,i}return Kgt(r,[{key:"isEnabled",value:function(){return this.hot.getSettings()[M2]}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){var o=this.hot.getSettings()[M2];this.updatePluginSettings(o),this.addHook("beforeRenderer",function(){return i.onBeforeRenderer.apply(i,arguments)}),mp(_c(r.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){var i=this,o=function(){return i.onBeforeRenderer.apply(i,arguments)};this.hot.addHook("beforeRenderer",o),this.hot.addHookOnce("afterViewRender",function(){i.hot.removeHook("beforeRenderer",o)}),mp(_c(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),mp(_c(r.prototype),"updatePlugin",this).call(this)}},{key:"query",value:function(i){var o=this,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getCallback(),a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getQueryMethod(),h=this.hot.countRows(),p=this.hot.countCols(),g=[],S=this.hot;return Er(0,h-1,function(T){Er(0,p-1,function(R){var A=o.hot.getDataAtCell(T,R),$=o.hot.getCellMeta(T,R),j=$.search.callback||s,z=$.search.queryMethod||a,V=z(i,A,$);if(V){var G={row:T,col:R,data:A};g.push(G)}j&&j(S,T,R,A,V)})}),g}},{key:"getCallback",value:function(){return this.callback}},{key:"setCallback",value:function(i){this.callback=i}},{key:"getQueryMethod",value:function(){return this.queryMethod}},{key:"setQueryMethod",value:function(i){this.queryMethod=i}},{key:"getSearchResultClass",value:function(){return this.searchResultClass}},{key:"setSearchResultClass",value:function(i){this.searchResultClass=i}},{key:"updatePluginSettings",value:function(i){dn(i)&&(i.searchResultClass&&this.setSearchResultClass(i.searchResultClass),i.queryMethod&&this.setQueryMethod(i.queryMethod),i.callback&&this.setCallback(i.callback))}},{key:"onBeforeRenderer",value:function(i,o,s,a,h,p){var g=p.className||[],S=[];if(typeof g=="string")S=g.split(" ");else{var T;(T=S).push.apply(T,Hgt(g))}this.isEnabled()&&p.isSearchResult?S.includes(this.searchResultClass)||S.push("".concat(this.searchResultClass)):S.includes(this.searchResultClass)&&S.splice(S.indexOf(this.searchResultClass),1),p.className=S.join(" ")}},{key:"destroy",value:function(){mp(_c(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return M2}},{key:"PLUGIN_PRIORITY",get:function(){return nvt}}]),r}(Wn);function B_(e){"@babel/helpers - typeof";return B_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},B_(e)}function lvt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function OQ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,cvt(n.key),n)}}function uvt(e,t,r){return t&&OQ(e.prototype,t),r&&OQ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function cvt(e){var t=fvt(e,"string");return B_(t)==="symbol"?t:String(t)}function fvt(e,t){if(B_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(B_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function kg(){return typeof Reflect<"u"&&Reflect.get?kg=Reflect.get.bind():kg=function(t,r,n){var i=hvt(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},kg.apply(this,arguments)}function hvt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=hh(e),e!==null););return e}function dvt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Tz(e,t)}function Tz(e,t){return Tz=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Tz(e,t)}function pvt(e){var t=gvt();return function(){var n=hh(e),i;if(t){var o=hh(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return mvt(this,i)}}function mvt(e,t){if(t&&(B_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return yvt(e)}function yvt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function gvt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function hh(e){return hh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},hh(e)}var vvt="touchScroll",_vt=200,bvt=function(e){dvt(r,e);var t=pvt(r);function r(n){var i;return lvt(this,r),i=t.call(this,n),i.scrollbars=[],i.clones=[],i.lockedCollection=!1,i.freezeOverlays=!1,i}return uvt(r,[{key:"isEnabled",value:function(){return joe()}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.addHook("afterViewRender",function(){return i.onAfterViewRender()}),this.registerEvents(),kg(hh(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.lockedCollection=!1,kg(hh(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){kg(hh(r.prototype),"disablePlugin",this).call(this)}},{key:"registerEvents",value:function(){var i=this;this.addHook("beforeTouchScroll",function(){return i.onBeforeTouchScroll()}),this.addHook("afterMomentumScroll",function(){return i.onAfterMomentumScroll()})}},{key:"onAfterViewRender",value:function(){if(!this.lockedCollection){var i=this.hot.view._wt.wtOverlays,o=i.topOverlay,s=i.bottomOverlay,a=i.inlineStartOverlay,h=i.topInlineStartCornerOverlay,p=i.bottomInlineStartCornerOverlay;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(o),s.clone&&this.scrollbars.push(s),this.scrollbars.push(a),h&&this.scrollbars.push(h),p&&p.clone&&this.scrollbars.push(p),this.clones=[],o.needFullRender&&this.clones.push(o.clone.wtTable.holder.parentNode),s.needFullRender&&this.clones.push(s.clone.wtTable.holder.parentNode),a.needFullRender&&this.clones.push(a.clone.wtTable.holder.parentNode),h&&this.clones.push(h.clone.wtTable.holder.parentNode),p&&p.clone&&this.clones.push(p.clone.wtTable.holder.parentNode)}}},{key:"onBeforeTouchScroll",value:function(){this.freezeOverlays=!0,Le(this.clones,function(i){Ht(i,"hide-tween")})}},{key:"onAfterMomentumScroll",value:function(){var i=this;this.freezeOverlays=!1,Le(this.clones,function(o){Kr(o,"hide-tween"),Ht(o,"show-tween")}),this.hot._registerTimeout(function(){Le(i.clones,function(o){Kr(o,"show-tween")})},400),Le(this.scrollbars,function(o){o.refresh(),o.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}}],[{key:"PLUGIN_KEY",get:function(){return vvt}},{key:"PLUGIN_PRIORITY",get:function(){return _vt}},{key:"SETTING_KEYS",get:function(){return!0}}]),r}(Wn);function j_(e){"@babel/helpers - typeof";return j_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},j_(e)}function wvt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function RQ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,xvt(n.key),n)}}function Svt(e,t,r){return t&&RQ(e.prototype,t),r&&RQ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function xvt(e){var t=Cvt(e,"string");return j_(t)==="symbol"?t:String(t)}function Cvt(e,t){if(j_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(j_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function yp(){return typeof Reflect<"u"&&Reflect.get?yp=Reflect.get.bind():yp=function(t,r,n){var i=Evt(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},yp.apply(this,arguments)}function Evt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=bc(e),e!==null););return e}function Tvt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Oz(e,t)}function Oz(e,t){return Oz=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Oz(e,t)}function Ovt(e){var t=Pvt();return function(){var n=bc(e),i;if(t){var o=bc(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Rvt(this,i)}}function Rvt(e,t){if(t&&(j_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return kvt(e)}function kvt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Pvt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function bc(e){return bc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},bc(e)}var $O="trimRows",Avt=330,Ivt=function(e){Tvt(r,e);var t=Ovt(r);function r(n){var i;return wvt(this,r),i=t.call(this,n),i.trimmedRowsMap=null,i}return Svt(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[$O]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new vC),this.trimmedRowsMap.addLocalHook("init",function(){return i.onMapInit()}),yp(bc(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){var i=this,o=this.hot.getSettings()[$O];Array.isArray(o)&&this.hot.batchExecution(function(){i.trimmedRowsMap.clear(),Le(o,function(s){i.trimmedRowsMap.setValueAtIndex(s,!0)})},!0),yp(bc(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap("trimRows"),yp(bc(r.prototype),"disablePlugin",this).call(this)}},{key:"getTrimmedRows",value:function(){return this.trimmedRowsMap.getTrimmedIndexes()}},{key:"trimRows",value:function(i){var o=this,s=this.getTrimmedRows(),a=this.isValidConfig(i),h=s;a&&(h=Array.from(new Set(s.concat(i))));var p=this.hot.runHooks("beforeTrimRow",s,h,a);p!==!1&&(a&&this.hot.batchExecution(function(){Le(i,function(g){o.trimmedRowsMap.setValueAtIndex(g,!0)})},!0),this.hot.runHooks("afterTrimRow",s,h,a,a&&h.length>s.length))}},{key:"trimRow",value:function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];this.trimRows(o)}},{key:"untrimRows",value:function(i){var o=this.getTrimmedRows(),s=this.isValidConfig(i),a=o,h=this.trimmedRowsMap.getValues().slice(),p=i.length>0;s&&p&&(Le(i,function(S){h[S]=!1}),a=na(h,function(S,T,R){return T&&S.push(R),S},[]));var g=this.hot.runHooks("beforeUntrimRow",o,a,s&&p);g!==!1&&(s&&p&&this.trimmedRowsMap.setValues(h),this.hot.runHooks("afterUntrimRow",o,a,s&&p,s&&a.length<o.length))}},{key:"untrimRow",value:function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];this.untrimRows(o)}},{key:"isTrimmed",value:function(i){return this.trimmedRowsMap.getValueAtIndex(i)||!1}},{key:"untrimAll",value:function(){this.untrimRows(this.getTrimmedRows())}},{key:"isValidConfig",value:function(i){var o=this.hot.countSourceRows();return i.every(function(s){return Number.isInteger(s)&&s>=0&&s<o})}},{key:"onMapInit",value:function(){var i=this,o=this.hot.getSettings()[$O];Array.isArray(o)&&this.hot.batchExecution(function(){Le(o,function(s){i.trimmedRowsMap.setValueAtIndex(s,!0)})},!0)}},{key:"destroy",value:function(){yp(bc(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return $O}},{key:"PLUGIN_PRIORITY",get:function(){return Avt}}]),r}(Wn);function z_(e){"@babel/helpers - typeof";return z_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},z_(e)}function nce(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kQ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Mvt(n.key),n)}}function ice(e,t,r){return t&&kQ(e.prototype,t),r&&kQ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Mvt(e){var t=Dvt(e,"string");return z_(t)==="symbol"?t:String(t)}function Dvt(e,t){if(z_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(z_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function oce(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Rz(e,t)}function Rz(e,t){return Rz=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Rz(e,t)}function ace(e){var t=Nvt();return function(){var n=xP(e),i;if(t){var o=xP(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return $vt(this,i)}}function $vt(e,t){if(t&&(z_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Lvt(e)}function Lvt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Nvt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function xP(e){return xP=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},xP(e)}function Bvt(e){return Fvt(e)||zvt(e)||lce(e)||jvt()}function jvt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zvt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Fvt(e){if(Array.isArray(e))return kz(e)}function sce(e,t){return Uvt(e)||Vvt(e,t)||lce(e,t)||Hvt()}function Hvt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function lce(e,t){if(e){if(typeof e=="string")return kz(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return kz(e,t)}}function kz(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Vvt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],h=!0,p=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;h=!1}else for(;!(h=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);h=!0);}catch(g){p=!0,i=g}finally{try{if(!h&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(p)throw i}}return a}}function Uvt(e){if(Array.isArray(e))return e}var uce="undoRedo",Wvt="undoRedo";function hr(e){var t=this;this.instance=e,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,this.enabled=!1,e.addHook("afterChange",function(r,n){var i=this,o=r&&r.length;if(o){var s=r.find(function(h){var p=sce(h,4),g=p[2],S=p[3];return g!==S});if(s){var a=function(){var p=r.reduce(function(S,T){return S.push(Bvt(T)),S},[]);Le(p,function(S){S[1]=e.propToCol(S[1])});var g=o>1?i.getSelected():[[p[0][0],p[0][1]]];return new hr.ChangeAction(p,g)};t.done(a,n)}}}),e.addHook("afterCreateRow",function(r,n,i){t.done(function(){return new hr.CreateRowAction(r,n)},i)}),e.addHook("beforeRemoveRow",function(r,n,i,o){var s=function(){var h=e.toPhysicalRow(r),p=ya(t.instance.getSourceData(h,0,h+n-1,t.instance.countSourceCols()-1));return new hr.RemoveRowAction(h,p,e.getSettings().fixedRowsBottom,e.getSettings().fixedRowsTop,e.rowIndexMapper.getIndexesSequence())};t.done(s,o)}),e.addHook("afterCreateCol",function(r,n,i){t.done(function(){return new hr.CreateColumnAction(r,n)},i)}),e.addHook("beforeRemoveCol",function(r,n,i,o){var s=function(){var h=t.instance.getSourceDataArray(),p=(t.instance.countCols()+r)%t.instance.countCols(),g=[],S=[],T=[];Er(h.length-1,function($){var j=[],z=h[$];Er(p,p+(n-1),function(V){j.push(z[e.toPhysicalColumn(V)])}),g.push(j)}),Er(n-1,function($){T.push(e.toPhysicalColumn(p+$))}),Array.isArray(e.getSettings().colHeaders)&&Er(n-1,function($){S.push(e.getSettings().colHeaders[e.toPhysicalColumn(p+$)]||null)});var R=e.columnIndexMapper.getIndexesSequence(),A=e.rowIndexMapper.getIndexesSequence();return new hr.RemoveColumnAction(p,T,g,S,R,A,e.getSettings().fixedColumnsStart)};t.done(s,o)}),e.addHook("beforeCellAlignment",function(r,n,i,o){t.done(function(){return new hr.CellAlignmentAction(r,n,i,o)})}),e.addHook("beforeFilter",function(r){t.done(function(){return new hr.FiltersAction(r)})}),e.addHook("beforeRowMove",function(r,n){r!==!1&&t.done(function(){return new hr.RowMoveAction(r,n)})}),e.addHook("beforeMergeCells",function(r,n){n||t.done(function(){return new hr.MergeCellsAction(e,r)})}),e.addHook("afterUnmergeCells",function(r,n){n||t.done(function(){return new hr.UnmergeCellsAction(e,r)})}),e.addHook("afterInit",function(){t.init()})}hr.prototype.done=function(e,t){if(!this.ignoreNewActions){var r=t==="UndoRedo.undo"||t==="UndoRedo.redo"||t==="auto";if(!r){var n=this.doneActions.slice(),i=this.instance.runHooks("beforeUndoStackChange",n,t);if(i!==!1){var o=e(),s=this.undoneActions.slice();this.doneActions.push(o),this.instance.runHooks("afterUndoStackChange",n,this.doneActions.slice()),this.instance.runHooks("beforeRedoStackChange",s),this.undoneActions.length=0,this.instance.runHooks("afterRedoStackChange",s,this.undoneActions.slice())}}}};hr.prototype.undo=function(){if(this.isUndoAvailable()){var e=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",e);var t=this.doneActions.pop();this.instance.runHooks("afterUndoStackChange",e,this.doneActions.slice());var r=ya(t),n=this.instance.runHooks("beforeUndo",r);if(n===!1)return;this.ignoreNewActions=!0;var i=this,o=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",o),t.undo(this.instance,function(){i.ignoreNewActions=!1,i.undoneActions.push(t)}),this.instance.runHooks("afterRedoStackChange",o,this.undoneActions.slice()),this.instance.runHooks("afterUndo",r)}};hr.prototype.redo=function(){if(this.isRedoAvailable()){var e=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",e);var t=this.undoneActions.pop();this.instance.runHooks("afterRedoStackChange",e,this.undoneActions.slice());var r=ya(t),n=this.instance.runHooks("beforeRedo",r);if(n===!1)return;this.ignoreNewActions=!0;var i=this,o=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",o),t.redo(this.instance,function(){i.ignoreNewActions=!1,i.doneActions.push(t)}),this.instance.runHooks("afterUndoStackChange",o,this.doneActions.slice()),this.instance.runHooks("afterRedo",r)}};hr.prototype.isUndoAvailable=function(){return this.doneActions.length>0};hr.prototype.isRedoAvailable=function(){return this.undoneActions.length>0};hr.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0};hr.prototype.isEnabled=function(){return this.enabled};hr.prototype.enable=function(){if(!this.isEnabled()){var e=this.instance;this.enabled=!0,Kvt(e),this.registerShortcuts(),e.addHook("afterChange",cce)}};hr.prototype.disable=function(){if(this.isEnabled()){var e=this.instance;this.enabled=!1,qvt(e),this.unregisterShortcuts(),e.removeHook("afterChange",cce)}};hr.prototype.destroy=function(){this.clear(),this.instance=null,this.doneActions=null,this.undoneActions=null};hr.Action=function(){};hr.Action.prototype.undo=function(){};hr.Action.prototype.redo=function(){};hr.ChangeAction=function(e,t){this.changes=e,this.selected=t,this.actionType="change"};Sh(hr.ChangeAction,hr.Action);hr.ChangeAction.prototype.undo=function(e,t){for(var r=ya(this.changes),n=e.countEmptyRows(!0),i=e.countEmptyCols(!0),o=0,s=r.length;o<s;o++)r[o].splice(3,1);e.addHookOnce("afterChange",t),e.setDataAtCell(r,null,null,"UndoRedo.undo");for(var a=0,h=r.length;a<h;a++){var p=sce(r[a],2),g=p[0],S=p[1];e.getSettings().minSpareRows&&g+1+e.getSettings().minSpareRows===e.countRows()&&n===e.getSettings().minSpareRows&&(e.alter("remove_row",parseInt(g+1,10),e.getSettings().minSpareRows),e.undoRedo.doneActions.pop()),e.getSettings().minSpareCols&&S+1+e.getSettings().minSpareCols===e.countCols()&&i===e.getSettings().minSpareCols&&(e.alter("remove_col",parseInt(S+1,10),e.getSettings().minSpareCols),e.undoRedo.doneActions.pop())}e.selectCells(this.selected,!1,!1)};hr.ChangeAction.prototype.redo=function(e,t){for(var r=ya(this.changes),n=0,i=r.length;n<i;n++)r[n].splice(2,1);e.addHookOnce("afterChange",t),e.setDataAtCell(r,null,null,"UndoRedo.redo"),this.selected&&e.selectCells(this.selected,!1,!1)};hr.CreateRowAction=function(e,t){this.index=e,this.amount=t,this.actionType="insert_row"};Sh(hr.CreateRowAction,hr.Action);hr.CreateRowAction.prototype.undo=function(e,t){var r=e.countRows(),n=e.getSettings().minSpareRows;this.index>=r&&this.index-n<r&&(this.index-=n),e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",this.index,this.amount,"UndoRedo.undo")};hr.CreateRowAction.prototype.redo=function(e,t){e.addHookOnce("afterCreateRow",t),e.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")};hr.RemoveRowAction=function(e,t,r,n,i){this.index=e,this.data=t,this.actionType="remove_row",this.fixedRowsBottom=r,this.fixedRowsTop=n,this.rowIndexesSequence=i};Sh(hr.RemoveRowAction,hr.Action);hr.RemoveRowAction.prototype.undo=function(e,t){var r=this,n=e.getSettings(),i=[];n.fixedRowsBottom=this.fixedRowsBottom,n.fixedRowsTop=this.fixedRowsTop,this.data.forEach(function(o,s){Object.keys(o).forEach(function(a){var h=parseInt(a,10);i.push([r.index+s,isNaN(h)?a:h,o[a]])})}),e.alter("insert_row_above",this.index,this.data.length,"UndoRedo.undo"),e.addHookOnce("afterViewRender",t),e.setSourceDataAtCell(i,null,null,"UndoRedo.undo"),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence)};hr.RemoveRowAction.prototype.redo=function(e,t){e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")};hr.CreateColumnAction=function(e,t){this.index=e,this.amount=t,this.actionType="insert_col"};Sh(hr.CreateColumnAction,hr.Action);hr.CreateColumnAction.prototype.undo=function(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount,"UndoRedo.undo")};hr.CreateColumnAction.prototype.redo=function(e,t){e.addHookOnce("afterCreateCol",t),e.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")};hr.RemoveColumnAction=function(e,t,r,n,i,o,s){this.index=e,this.indexes=t,this.data=r,this.amount=this.data[0].length,this.headers=n,this.columnPositions=i.slice(0),this.rowPositions=o.slice(0),this.actionType="remove_col",this.fixedColumnsStart=s};Sh(hr.RemoveColumnAction,hr.Action);hr.RemoveColumnAction.prototype.undo=function(e,t){var r=this,n=e.getSettings();n.fixedColumnsStart=this.fixedColumnsStart;for(var i=this.indexes.slice(0).sort(),o=function(T,R,A){return A[r.indexes.indexOf(i[R])]},s=this.data.length,a=[],h=0;h<s;h++)a.push(hn(this.data[h],o));var p=hn(this.headers,o),g=[];e.alter("insert_col_start",this.indexes[0],this.indexes.length,"UndoRedo.undo"),Le(e.getSourceDataArray(),function(S,T){Le(i,function(R,A){S[R]=a[T][A],g.push([T,R,S[R]])})}),e.setSourceDataAtCell(g,void 0,void 0,"UndoRedo.undo"),e.columnIndexMapper.insertIndexes(i[0],i.length),typeof this.headers<"u"&&Le(p,function(S,T){e.getSettings().colHeaders[i[T]]=S}),e.batchExecution(function(){e.rowIndexMapper.setIndexesSequence(r.rowPositions),e.columnIndexMapper.setIndexesSequence(r.columnPositions)},!0),e.addHookOnce("afterViewRender",t),e.render()};hr.RemoveColumnAction.prototype.redo=function(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount,"UndoRedo.redo")};hr.CellAlignmentAction=function(e,t,r,n){this.stateBefore=e,this.range=t,this.type=r,this.alignment=n};hr.CellAlignmentAction.prototype.undo=function(e,t){var r=this;Le(this.range,function(n){n.forAll(function(i,o){i>=0&&o>=0&&e.setCellMeta(i,o,"className",r.stateBefore[i][o]||" htLeft")})}),e.addHookOnce("afterViewRender",t),e.render()};hr.CellAlignmentAction.prototype.redo=function(e,t){kf(this.range,this.type,this.alignment,function(r,n){return e.getCellMeta(r,n)},function(r,n,i,o){return e.setCellMeta(r,n,i,o)}),e.addHookOnce("afterViewRender",t),e.render()};hr.FiltersAction=function(e){this.conditionsStack=e,this.actionType="filter"};Sh(hr.FiltersAction,hr.Action);hr.FiltersAction.prototype.undo=function(e,t){var r=e.getPlugin("filters");e.addHookOnce("afterViewRender",t),r.conditionCollection.importAllConditions(this.conditionsStack.slice(0,this.conditionsStack.length-1)),r.filter()};hr.FiltersAction.prototype.redo=function(e,t){var r=e.getPlugin("filters");e.addHookOnce("afterViewRender",t),r.conditionCollection.importAllConditions(this.conditionsStack),r.filter()};var Gvt=function(e){oce(r,e);var t=ace(r);function r(n,i){var o;nce(this,r),o=t.call(this),o.cellRange=i;var s=o.cellRange.getTopStartCorner(),a=o.cellRange.getBottomEndCorner();return o.rangeData=n.getData(s.row,s.col,a.row,a.col),o}return ice(r,[{key:"undo",value:function(i,o){var s=i.getPlugin("mergeCells");i.addHookOnce("afterViewRender",o),s.unmergeRange(this.cellRange,!0);var a=this.cellRange.getTopStartCorner();i.populateFromArray(a.row,a.col,this.rangeData,void 0,void 0,"MergeCells")}},{key:"redo",value:function(i,o){var s=i.getPlugin("mergeCells");i.addHookOnce("afterViewRender",o),s.mergeRange(this.cellRange)}}]),r}(hr.Action);hr.MergeCellsAction=Gvt;var Yvt=function(e){oce(r,e);var t=ace(r);function r(n,i){var o;return nce(this,r),o=t.call(this),o.cellRange=i,o}return ice(r,[{key:"undo",value:function(i,o){var s=i.getPlugin("mergeCells");i.addHookOnce("afterViewRender",o),s.mergeRange(this.cellRange,!0)}},{key:"redo",value:function(i,o){var s=i.getPlugin("mergeCells");i.addHookOnce("afterViewRender",o),s.unmergeRange(this.cellRange,!0),i.render()}}]),r}(hr.Action);hr.UnmergeCellsAction=Yvt;hr.RowMoveAction=function(e,t){this.rows=e.slice(),this.finalIndex=t,this.actionType="row_move"};Sh(hr.RowMoveAction,hr.Action);hr.RowMoveAction.prototype.undo=function(e,t){var r=this,n=e.getPlugin("manualRowMove"),i=[].concat(this.rows),o=i.filter(function(g){return g>r.finalIndex}),s=i.filter(function(g){return g<=r.finalIndex}),a=o.sort(function(g,S){return S-g}).concat(s.sort(function(g,S){return g-S}));e.addHookOnce("afterViewRender",t);for(var h=0;h<a.length;h+=1){var p=e.toVisualRow(a[h]);n.moveRow(p,a[h])}e.render(),e.deselectCell(),e.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)};hr.RowMoveAction.prototype.redo=function(e,t){var r=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",t),r.moveRows(this.rows.slice(),this.finalIndex),e.render(),e.deselectCell(),e.selectRows(this.finalIndex,this.finalIndex+this.rows.length-1)};hr.prototype.init=function(){var e=this.instance.getSettings().undo,t=typeof e>"u"||e;this.instance.undoRedo||(this.instance.undoRedo=this),t?this.instance.undoRedo.enable():this.instance.undoRedo.disable()};hr.prototype.registerShortcuts=function(){var e=this,t=this.instance.getShortcutManager(),r=t.getContext("grid"),n=function(s){return!s.altKey},i={runOnlyIf:n,group:uce};r.addShortcuts([{keys:[["Control/Meta","z"]],callback:function(){e.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:function(){e.redo()}}],i)};hr.prototype.unregisterShortcuts=function(){var e=this.instance.getShortcutManager(),t=e.getContext("grid");t.removeShortcutsByGroup(uce)};function cce(e,t){var r=this;if(t==="loadData")return r.undoRedo.clear()}function Kvt(e){e.undo=function(){return e.undoRedo.undo()},e.redo=function(){return e.undoRedo.redo()},e.isUndoAvailable=function(){return e.undoRedo.isUndoAvailable()},e.isRedoAvailable=function(){return e.undoRedo.isRedoAvailable()},e.clearUndo=function(){return e.undoRedo.clear()}}function qvt(e){delete e.undo,delete e.redo,delete e.isUndoAvailable,delete e.isRedoAvailable,delete e.clearUndo}var EC=mr.getSingleton();EC.add("afterUpdateSettings",function(){var e;(e=this.getPlugin("undoRedo"))===null||e===void 0||e.init()});EC.register("beforeUndo");EC.register("afterUndo");EC.register("beforeRedo");EC.register("afterRedo");hr.PLUGIN_KEY=Wvt;hr.SETTING_KEYS=!0;function Xvt(){Mn(T8e),Mn(Z8e),Mn(mYe),Mn(lKe),Mn(OKe),Mn(zse),Mn(m9e),Mn(X9e),Mn(Nle),Mn(prt),Mn(Frt),Mn(Jrt),Mn(qle),Mn(rit),Mn(Jlt),Mn(Aut),Mn(rct),Mn(Oct),Mn(Xct),Mn(Bft),Mn(qft),Mn(Nht),Mn(Kht),Mn(Gdt),Mn(dpt),Mn(Tpt),Mn(eyt),Mn(xgt),Mn(Fgt),Mn(svt),Mn(bvt),Mn(Ivt),Mn(hr)}function Zvt(){fze(),Rze(),Yze(),pFe(),Xvt()}Xl(bae);wn.editors={BaseEditor:ob};function wn(e,t){var r=new cU(e,t||{},aU);return r.init(),r}wn.Core=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new cU(e,t,aU)};wn.DefaultSettings=Tle();wn.hooks=mr.getSingleton();wn.CellCoords=Pk;wn.CellRange=w3;wn.packageName="handsontable";wn.buildDate="28/03/2023 12:24:11";wn.version="12.3.3";wn.languages={dictionaryKeys:z9e,getLanguageDictionary:yle,getLanguagesDictionaries:NZe,registerLanguageDictionary:mle,getTranslatedPhrase:gle};function PQ(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Jvt(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?PQ(Object(r),!0).forEach(function(n){Qvt(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):PQ(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Ex(e){"@babel/helpers - typeof";return Ex=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ex(e)}function F_(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function AQ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,hce(n.key),n)}}function H_(e,t,r){return t&&AQ(e.prototype,t),r&&AQ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Qvt(e,t,r){return t=hce(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Tx(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Pz(e,t)}function CP(e){return CP=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},CP(e)}function Pz(e,t){return Pz=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Pz(e,t)}function e_t(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function fce(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function t_t(e,t){if(t&&(typeof t=="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return fce(e)}function Ox(e){var t=e_t();return function(){var n=CP(e),i;if(t){var o=CP(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return t_t(this,i)}}function r_t(e){return n_t(e)||i_t(e)||o_t(e)||a_t()}function n_t(e){if(Array.isArray(e))return Az(e)}function i_t(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function o_t(e,t){if(e){if(typeof e=="string")return Az(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Az(e,t)}}function Az(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function a_t(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function s_t(e,t){if(typeof e!="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function hce(e){var t=s_t(e,"string");return typeof t=="symbol"?t:String(t)}var D2=null,l_t="Your `HotTable` configuration includes `autoRowSize`/`autoColumnSize` options, which are not compatible with  the component-based renderers`. Disable `autoRowSize` and `autoColumnSize` to prevent row and column misalignment.",u_t="The Handsontable instance bound to this component was destroyed and cannot be used properly.",EP="global",c_t="hot-wrapper-editor-container";function f_t(){if(typeof console<"u"){var e;(e=console).warn.apply(e,arguments)}}function Iz(e,t){var r=ro.Children.toArray(e),n=ro.Children.count(e),i=null;return n!==0&&(n===1&&r[0].props[t]?i=r[0]:i=r.find(function(o){return o.props[t]!==void 0})),i||null}function dce(e){return e?e.type.WrappedComponent?e.type.WrappedComponent:e.type:null}function pce(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document,t=arguments.length>1?arguments[1]:void 0;if(t===null)return null;var r=yce(t.props,!1);return r.className="".concat(c_t," ").concat(r.className),Kte.createPortal(ro.createElement("div",Object.assign({},r),t),e.body)}function mce(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:EP,n=Iz(e,"hot-editor"),i=dce(n);return n?ro.cloneElement(n,{emitEditorInstance:function(s,a){t.get(i)||t.set(i,new Map);var h=t.get(i);h.set(a??EP,s)},editorColumnScope:r,isEditor:!0}):null}function h_t(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:document;r||(r=document),D2||(D2=r.createDocumentFragment());var n=r.createElement("DIV");D2.appendChild(n);var i=ro.cloneElement(e,Jvt({key:"".concat(t.row,"-").concat(t.col)},t));return{portal:Kte.createPortal(i,n,"".concat(t.row,"-").concat(t.col,"-").concat(Math.random())),portalContainer:n}}function yce(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return{id:e.id||(t?"hot-"+Math.random().toString(36).substring(5):void 0),className:e.className||"",style:e.style||{}}}var gce=function(){function e(){F_(this,e)}return H_(e,null,[{key:"getSettings",value:function(r){var n={};if(r.settings){var i=r.settings;for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])}for(var s in r)s!=="settings"&&s!=="children"&&r.hasOwnProperty(s)&&(n[s]=r[s]);return n}}]),e}(),d_t=function(e){Tx(r,e);var t=Ox(r);function r(){return F_(this,r),t.apply(this,arguments)}return H_(r,[{key:"getSettingsProps",value:function(){var i=this;return this.internalProps=["_componentRendererColumns","_emitColumnSettings","_columnIndex","_getChildElementByType","_getRendererWrapper","_getEditorClass","_getEditorCache","_getOwnerDocument","hot-renderer","hot-editor","children"],Object.keys(this.props).filter(function(o){return!i.internalProps.includes(o)}).reduce(function(o,s){return o[s]=i.props[s],o},{})}},{key:"getLocalEditorElement",value:function(){return mce(this.props.children,this.props._getEditorCache(),this.props._columnIndex)}},{key:"createColumnSettings",value:function(){var i=this.props._getChildElementByType(this.props.children,"hot-renderer"),o=this.getLocalEditorElement();this.columnSettings=gce.getSettings(this.getSettingsProps()),i!==null&&(this.columnSettings.renderer=this.props._getRendererWrapper(i),this.props._componentRendererColumns.set(this.props._columnIndex,!0)),o!==null&&(this.columnSettings.editor=this.props._getEditorClass(o,this.props._columnIndex))}},{key:"emitColumnSettings",value:function(){this.props._emitColumnSettings(this.columnSettings,this.props._columnIndex)}},{key:"componentDidMount",value:function(){this.createColumnSettings(),this.emitColumnSettings()}},{key:"componentDidUpdate",value:function(){this.createColumnSettings(),this.emitColumnSettings()}},{key:"render",value:function(){var i=this.props._getOwnerDocument(),o=pce(i,this.getLocalEditorElement());return ro.createElement(ro.Fragment,null,o)}}]),r}(ro.Component),p_t=function(e){Tx(r,e);var t=Ox(r);function r(){var n;return F_(this,r),n=t.apply(this,arguments),n.state={portals:[]},n}return H_(r,[{key:"render",value:function(){return ro.createElement(ro.Fragment,null,this.state.portals)}}]),r}(ro.Component),m_t="12.3.3";function SU(e,t){return t={exports:{}},e(t,t.exports),t.exports}/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Io=typeof Symbol=="function"&&Symbol.for,xU=Io?Symbol.for("react.element"):60103,CU=Io?Symbol.for("react.portal"):60106,tI=Io?Symbol.for("react.fragment"):60107,rI=Io?Symbol.for("react.strict_mode"):60108,nI=Io?Symbol.for("react.profiler"):60114,iI=Io?Symbol.for("react.provider"):60109,oI=Io?Symbol.for("react.context"):60110,EU=Io?Symbol.for("react.async_mode"):60111,aI=Io?Symbol.for("react.concurrent_mode"):60111,sI=Io?Symbol.for("react.forward_ref"):60112,lI=Io?Symbol.for("react.suspense"):60113,y_t=Io?Symbol.for("react.suspense_list"):60120,uI=Io?Symbol.for("react.memo"):60115,cI=Io?Symbol.for("react.lazy"):60116,g_t=Io?Symbol.for("react.block"):60121,v_t=Io?Symbol.for("react.fundamental"):60117,__t=Io?Symbol.for("react.responder"):60118,b_t=Io?Symbol.for("react.scope"):60119;function hs(e){if(Ex(e)==="object"&&e!==null){var t=e.$$typeof;switch(t){case xU:switch(e=e.type,e){case EU:case aI:case tI:case nI:case rI:case lI:return e;default:switch(e=e&&e.$$typeof,e){case oI:case sI:case cI:case uI:case iI:return e;default:return t}}case CU:return t}}}function vce(e){return hs(e)===aI}var w_t=EU,S_t=aI,x_t=oI,C_t=iI,E_t=xU,T_t=sI,O_t=tI,R_t=cI,k_t=uI,P_t=CU,A_t=nI,I_t=rI,M_t=lI,D_t=function(t){return vce(t)||hs(t)===EU},$_t=vce,L_t=function(t){return hs(t)===oI},N_t=function(t){return hs(t)===iI},B_t=function(t){return Ex(t)==="object"&&t!==null&&t.$$typeof===xU},j_t=function(t){return hs(t)===sI},z_t=function(t){return hs(t)===tI},F_t=function(t){return hs(t)===cI},H_t=function(t){return hs(t)===uI},V_t=function(t){return hs(t)===CU},U_t=function(t){return hs(t)===nI},W_t=function(t){return hs(t)===rI},G_t=function(t){return hs(t)===lI},Y_t=function(t){return typeof t=="string"||typeof t=="function"||t===tI||t===aI||t===nI||t===rI||t===lI||t===y_t||Ex(t)==="object"&&t!==null&&(t.$$typeof===cI||t.$$typeof===uI||t.$$typeof===iI||t.$$typeof===oI||t.$$typeof===sI||t.$$typeof===v_t||t.$$typeof===__t||t.$$typeof===b_t||t.$$typeof===g_t)},K_t=hs,q_t={AsyncMode:w_t,ConcurrentMode:S_t,ContextConsumer:x_t,ContextProvider:C_t,Element:E_t,ForwardRef:T_t,Fragment:O_t,Lazy:R_t,Memo:k_t,Portal:P_t,Profiler:A_t,StrictMode:I_t,Suspense:M_t,isAsyncMode:D_t,isConcurrentMode:$_t,isContextConsumer:L_t,isContextProvider:N_t,isElement:B_t,isForwardRef:j_t,isFragment:z_t,isLazy:F_t,isMemo:H_t,isPortal:V_t,isProfiler:U_t,isStrictMode:W_t,isSuspense:G_t,isValidElementType:Y_t,typeOf:K_t},oi=SU(function(e,t){});oi.AsyncMode;oi.ConcurrentMode;oi.ContextConsumer;oi.ContextProvider;oi.Element;oi.ForwardRef;oi.Fragment;oi.Lazy;oi.Memo;oi.Portal;oi.Profiler;oi.StrictMode;oi.Suspense;oi.isAsyncMode;oi.isConcurrentMode;oi.isContextConsumer;oi.isContextProvider;oi.isElement;oi.isForwardRef;oi.isFragment;oi.isLazy;oi.isMemo;oi.isPortal;oi.isProfiler;oi.isStrictMode;oi.isSuspense;oi.isValidElementType;oi.typeOf;SU(function(e){e.exports=q_t});/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var IQ=Object.getOwnPropertySymbols,X_t=Object.prototype.hasOwnProperty,Z_t=Object.prototype.propertyIsEnumerable;function J_t(e){if(e==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}function Q_t(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de",Object.getOwnPropertyNames(e)[0]==="5")return!1;for(var t={},r=0;r<10;r++)t["_"+String.fromCharCode(r)]=r;var n=Object.getOwnPropertyNames(t).map(function(o){return t[o]});if(n.join("")!=="0123456789")return!1;var i={};return"abcdefghijklmnopqrst".split("").forEach(function(o){i[o]=o}),Object.keys(Object.assign({},i)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}Q_t();var ebt="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",tbt=ebt;Function.call.bind(Object.prototype.hasOwnProperty);function _ce(){}function bce(){}bce.resetWarningCache=_ce;var rbt=function(){function t(i,o,s,a,h,p){if(p!==tbt){var g=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw g.name="Invariant Violation",g}}t.isRequired=t;function r(){return t}var n={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:r,element:t,elementType:t,instanceOf:r,node:t,objectOf:r,oneOf:r,oneOfType:r,shape:r,exact:r,checkPropTypes:bce,resetWarningCache:_ce};return n.PropTypes=n,n},nbt=SU(function(e){e.exports=rbt()}),$2=nbt,wce=function(e){Tx(r,e);var t=Ox(r);function r(){var n;return F_(this,r),n=t.apply(this,arguments),n.id=null,n.__hotInstance=null,n.hotElementRef=null,n.columnSettings=[],n.renderersPortalManager=null,n.portalCacheArray=[],n.renderedCellCache=new Map,n.editorCache=new Map,n.componentRendererColumns=new Map,n}return H_(r,[{key:"hotInstance",get:function(){return!this.__hotInstance||this.__hotInstance&&!this.__hotInstance.isDestroyed?this.__hotInstance:(console.warn(u_t),null)},set:function(i){this.__hotInstance=i}},{key:"getRenderedCellCache",value:function(){return this.renderedCellCache}},{key:"getEditorCache",value:function(){return this.editorCache}},{key:"clearCache",value:function(){this.getRenderedCellCache().clear(),this.componentRendererColumns.clear()}},{key:"getOwnerDocument",value:function(){return this.hotElementRef?this.hotElementRef.ownerDocument:document}},{key:"setHotElementRef",value:function(i){this.hotElementRef=i}},{key:"getRendererWrapper",value:function(i){var o=this;return function(s,a,h,p,g,S,T){var R=o.getRenderedCellCache();if(R.has("".concat(h,"-").concat(p))&&(a.innerHTML=R.get("".concat(h,"-").concat(p)).innerHTML),a&&!a.getAttribute("ghost-table")){for(var A=h_t(i,{TD:a,row:h,col:p,prop:g,value:S,cellProperties:T,isRenderer:!0},a.ownerDocument),$=A.portal,j=A.portalContainer;a.firstChild;)a.removeChild(a.firstChild);a.appendChild(j),o.portalCacheArray.push($)}return R.set("".concat(h,"-").concat(p),a),a}}},{key:"getEditorClass",value:function(i){var o,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:EP,a=dce(i),h=(o=this.getEditorCache().get(a))===null||o===void 0?void 0:o.get(s);return this.makeEditorClass(h)}},{key:"makeEditorClass",value:function(i){var o=function(s){Tx(h,s);var a=Ox(h);function h(p){var g;return F_(this,h),g=a.call(this,p),i.hotCustomEditorInstance=fce(g),g.editorComponent=i,g}return H_(h,[{key:"focus",value:function(){}},{key:"getValue",value:function(){}},{key:"setValue",value:function(){}},{key:"open",value:function(){}},{key:"close",value:function(){}}]),h}(wn.editors.BaseEditor);return Object.getOwnPropertyNames(wn.editors.BaseEditor.prototype).forEach(function(s){s!=="constructor"&&(o.prototype[s]=function(){for(var a,h=arguments.length,p=new Array(h),g=0;g<h;g++)p[g]=arguments[g];return(a=i[s]).call.apply(a,[i].concat(p))})}),o}},{key:"getGlobalRendererElement",value:function(){return Iz(this.props.children,"hot-renderer")}},{key:"getGlobalEditorElement",value:function(){return mce(this.props.children,this.getEditorCache())}},{key:"createNewGlobalSettings",value:function(){var i=gce.getSettings(this.props),o=this.getGlobalRendererElement(),s=this.getGlobalEditorElement();return i.columns=this.columnSettings.length?this.columnSettings:i.columns,s?i.editor=this.getEditorClass(s,EP):i.editor=this.props.editor||(this.props.settings?this.props.settings.editor:void 0),o?(i.renderer=this.getRendererWrapper(o),this.componentRendererColumns.set("global",!0)):i.renderer=this.props.renderer||(this.props.settings?this.props.settings.renderer:void 0),i}},{key:"displayAutoSizeWarning",value:function(i){var o,s;this.hotInstance&&((o=this.hotInstance.getPlugin("autoRowSize"))!==null&&o!==void 0&&o.enabled||(s=this.hotInstance.getPlugin("autoColumnSize"))!==null&&s!==void 0&&s.enabled)&&this.componentRendererColumns.size>0&&f_t(l_t)}},{key:"setHotColumnSettings",value:function(i,o){this.columnSettings[o]=i}},{key:"handsontableBeforeViewRender",value:function(){this.getRenderedCellCache().clear()}},{key:"handsontableAfterViewRender",value:function(){var i=this;this.renderersPortalManager.setState({portals:r_t(this.portalCacheArray)},function(){i.portalCacheArray=[]})}},{key:"updateHot",value:function(i){this.hotInstance&&this.hotInstance.updateSettings(i,!1)}},{key:"setRenderersPortalManagerRef",value:function(i){this.renderersPortalManager=i}},{key:"componentDidMount",value:function(){var i=this,o=this.createNewGlobalSettings();this.hotInstance=new wn.Core(this.hotElementRef,o),this.hotInstance.addHook("beforeViewRender",function(){return i.handsontableBeforeViewRender()}),this.hotInstance.addHook("afterViewRender",function(){return i.handsontableAfterViewRender()}),this.hotInstance.init(),this.displayAutoSizeWarning(o)}},{key:"componentDidUpdate",value:function(){this.clearCache();var i=this.createNewGlobalSettings();this.updateHot(i),this.displayAutoSizeWarning(i)}},{key:"componentWillUnmount",value:function(){this.clearCache(),this.hotInstance&&this.hotInstance.destroy()}},{key:"render",value:function(){var i=this,o=yce(this.props),s=function(S){return S.type===d_t},a=ro.Children.toArray(this.props.children),h=a.filter(function(g){return s(g)}).map(function(g,S){return ro.cloneElement(g,{_componentRendererColumns:i.componentRendererColumns,_emitColumnSettings:i.setHotColumnSettings.bind(i),_columnIndex:S,_getChildElementByType:Iz.bind(i),_getRendererWrapper:i.getRendererWrapper.bind(i),_getEditorClass:i.getEditorClass.bind(i),_getOwnerDocument:i.getOwnerDocument.bind(i),_getEditorCache:i.getEditorCache.bind(i),children:g.props.children})}),p=pce(this.getOwnerDocument(),this.getGlobalEditorElement());return ro.createElement(ro.Fragment,null,ro.createElement("div",Object.assign({ref:this.setHotElementRef.bind(this)},o),h),ro.createElement(p_t,{ref:this.setRenderersPortalManagerRef.bind(this)}),p)}}],[{key:"version",get:function(){return m_t}}]),r}(ro.Component);wce.propTypes={style:$2.object,id:$2.string,className:$2.string};ro.Component;Zvt();function ibt({fileName:e,deleteFile:t,dataState:r,setdataState:n,size:i,setSize:o,saveCheck:s,setsaveCheck:a,checkifDeleted:h,userName:p,supabase:g}){const S=Rt.useRef(e===""?null:e),[T,R]=Rt.useState(0),A=()=>{const z=localStorage.getItem(p+"/"+e),V=localStorage.getItem(p+"/"+e+"/lastrow"),G=localStorage.getItem(p+"/"+e+"/savestate");z!=null&&V!=null&&G!=null&&(n(JSON.parse(z).grid),o(V),a(G))},$=()=>{console.log("removed const "+e+" data"),t(),j(),n([]),localStorage.removeItem(p+"/"+e),localStorage.removeItem(p+"/"+e+"/lastrow"),localStorage.removeItem(p+"/"+e+"/savestate")},j=async()=>{const z=p+"/"+e,{error:V}=await g.storage.from("User-Files").remove(z);V&&console.log(V)};return Rt.useEffect(()=>{i!=0&&localStorage.setItem(p+"/"+e+"/lastrow",i)},[i]),Rt.useEffect(()=>{localStorage.setItem(p+"/"+e+"/savestate",s)},[s]),Rt.useEffect(()=>{e!=""&&(o(0),n([]),A())},[e]),Rt.useEffect(()=>{h!=!1&&$()},[h]),Qe.jsxs(Qe.Fragment,{children:[Qe.jsxs("div",{className:"hottable-divq",children:[e&&Qe.jsx(wce,{id:p+"/"+e,ref:S,data:r,persistentState:!0,dataSchema:{Name:null,PickupAddress:null,DropoffAddress:null,Type:null,Time:null},rowHeaders:!0,colHeaders:["Full Name","Pickup Address","Dropoff Address","Trip Type: WC/ST/BCWCH","HH:MM AM/PM"],columns:[{data:"Name"},{data:"PickupAddress"},{data:"DropoffAddress"},{data:"Type"},{data:"Time"}],afterOnCellMouseDown:function(z,V){R(V.row)},height:"100vh",width:"78%",stretchH:"all",minSpareRows:50,beforeRefreshDimensions:()=>!1,licenseKey:"non-commercial-and-evaluation",afterChange:function(z,V){V!="edit"&&V!="CopyPaste.paste"||(+z[z.length-1][0]+1>i&&o(+z[z.length-1][0]+1),localStorage.setItem(p+"/"+e,JSON.stringify({grid:r})),a("Unsaved"))}}),";"]}),";"]})}function MQ({userFiles:e,changePage:t,selectFile:r,fileName:n,setdataState:i}){const[o,s]=Rt.useState(0),a=p=>{t(p)},h=p=>{r(p)};return Qe.jsx(Qe.Fragment,{children:Qe.jsxs("div",{className:"input-div",children:[Qe.jsx("button",{className:"input-button-import one-two",onMouseDown:()=>{a("schedule"),r(""),i([])},children:"New Schedule"}),Qe.jsxs("div",{className:"schedule-select-div",children:[Qe.jsxs("div",{className:"sched-index",children:["Schedules (",e.length,")"]}),e.length===0&&Qe.jsx("div",{}),Qe.jsx("ul",{children:e.map((p,g)=>Qe.jsxs("li",{id:p,className:n!=""&&(n==p||o==g)?"list-css list-css-active":"list-css",onMouseEnter:()=>s(g),onMouseLeave:()=>s(-1),onMouseDown:()=>{h(p),a("grid")},children:[Qe.jsx("div",{style:{display:"inline-block"},children:Qe.jsx("span",{className:"glyphicon glyphicon-th sched-glyph"})}),Qe.jsx("div",{className:"files-div",children:p})]},g))})]})]})})}function obt({changePage:e,setFileName2:t}){const[r,n]=Rt.useState(""),i=(o,s)=>{let a=s.replace(/\s/g,"");t(a),e(o)};return Qe.jsx(Qe.Fragment,{children:Qe.jsx("div",{className:"init-sched-div",children:Qe.jsxs("form",{onSubmit:()=>{i("grid",r===""?"":r)},children:[Qe.jsx("input",{type:"text",className:"schedule-input-series",placeholder:"Schedule Name",onChange:o=>n(o.target.value),value:r}),Qe.jsx("button",{className:"input-button-import submit-button",type:"submit",children:"Create Schedule"})]})})})}function abt({fileName:e,dataState:t,size:r,setsaveCheck:n,setcheckifDeleted:i,saveCheck:o,userName:s,supabase:a}){const h=async()=>{const g=JSON.parse(JSON.stringify(t));let S=JSON.stringify(g.splice(0,r)),T=new Blob([[S]],{type:"application/json"});const{error:R}=await a.storage.from("User-Files").update(s+"/"+e,T);R?console.log(R):n("Saved")},p=()=>{e!=""&&i(!0)};return Qe.jsxs(Qe.Fragment,{children:[Qe.jsx("div",{className:"page-title-div",children:Qe.jsx("p",{className:"page-title",children:"Schedule"})}),Qe.jsxs("div",{className:"change-map-div",children:[Qe.jsx("button",{className:e==""?"hidden":"select-map-button",onClick:()=>h(),children:" Save File"}),Qe.jsx("button",{className:e==""?"hidden":"select-map-button",onClick:()=>{p()},children:"Delete File"}),Qe.jsx("p",{style:{display:"inline-block",paddingLeft:"20px"},className:e==""?"hidden":o=="Saved"?"saved":"unsaved",children:o})]})]})}function sbt({dkey:e,name:t,address:r,type:n,status1:i,deleteDriver:o,supabase:s,driverload:a,id:h}){const[p,g]=Rt.useState(i),S=async T=>{const{data:R,error:A}=await s.from("user_drivers").update({Status:T}).eq("Name",t);A?console.log(A):(g(T),a[e].Status=T)};return Qe.jsx(Qe.Fragment,{children:Qe.jsxs("div",{id:e,className:"driver-div",children:[Qe.jsxs("div",{className:"name",children:[Qe.jsx("p",{className:"make-grey",children:"Name:"})," ",t]}),Qe.jsxs("div",{className:"address",children:[Qe.jsx("p",{className:"make-grey",children:"Starting Address: "})," ",r]}),Qe.jsxs("div",{className:"vType",children:[Qe.jsx("p",{className:"make-grey",children:"Vehicle Type: "})," ",n," "]}),Qe.jsx("button",{className:"button1",children:"Edit"}),Qe.jsx("button",{onClick:()=>o(t),className:"button2",children:"Delete"}),Qe.jsxs("div",{className:"status-title",children:[Qe.jsx("p",{className:"make-grey",children:"Status: "})," ",p==!0?"Active":"Inactive",Qe.jsx("i",{style:{fontSize:"9px"},className:p==!0?"fi fi-ss-circle status":"fi fi-ss-circle status-red"}),Qe.jsxs("button",{onClick:()=>S(!p),className:"button3",children:["Set ",p==!0?"Inactive":"Active"]})]})]})})}function lbt({supabase:e,userName:t,driverload:r,handleDriver:n,setDriverHave:i}){const[o,s]=Rt.useState(""),[a,h]=Rt.useState(""),[p,g]=Rt.useState(""),S=async()=>{const{data:T,error:R}=await e.from("user_drivers").insert([{user_id:t,Name:o,Address:a,vType:p,Status:!0}]);R?console.log(R):(r.push({Name:o,Address:a,Type:p,Status:!0}),i(A=>[A]),s(""),h(""),g(""))};return Qe.jsx(Qe.Fragment,{children:Qe.jsxs("div",{className:"driver-input-div",children:[Qe.jsx("input",{className:"schedule-input-series2 iname",placeholder:"Name",onChange:T=>s(T.target.value),value:o}),Qe.jsx("input",{className:"schedule-input-series2 iaddress",placeholder:"Address",onChange:T=>h(T.target.value),value:a}),Qe.jsxs("select",{className:"schedule-input-series2 itype",onChange:T=>g(T.target.value),value:p,children:[Qe.jsx("option",{value:"",children:"Select Vehicle Type"}),Qe.jsx("option",{value:"WC",children:"Wheelchair"}),Qe.jsx("option",{value:"ST",children:"Stretcher"}),Qe.jsx("option",{value:"BCWCH",children:"Bariatric Wheelchair"})]}),Qe.jsx("button",{onClick:()=>S(),className:"input-button-import ibutton",children:"Add Driver"})]})})}function ubt(){return Qe.jsx(Qe.Fragment,{children:Qe.jsx("div",{className:"page-title-div",children:Qe.jsx("p",{className:"page-title",children:"Drivers"})})})}function cbt({currentPage:e,changePage:t,fileName:r,userFiles:n,selectFile:i,handleFileName:o,deleteFile:s,dataState:a,setdataState:h,size:p,setSize:g,saveCheck:S,setsaveCheck:T,checkifDeleted:R,setcheckifDeleted:A,userName:$,queryRouteAPI:j,supabase:z,reformatDataForRouteQuery:V,driverload:G,deleteDriver:ee,handleDriver:K,setDriverHave:xe,driverhave:Me,grabAndListUserDrivers:He,routeData:Ne}){const We=()=>{if(e==="route")return Qe.jsx(Ove,{routeData:Ne});if(e==="schedule")return Qe.jsx(obt,{changePage:t,setFileName2:o});if(e==="grid")return Qe.jsx(ibt,{fileName:r,deleteFile:s,dataState:a,setdataState:h,size:p,setSize:g,saveCheck:S,setsaveCheck:T,checkifDeleted:R,setcheckifDeleted:A,userName:$,supabase:z});if(e==="driver")return G.map((_t,$e)=>{const Fe=$e;return Qe.jsx(sbt,{dkey:$e,name:_t.Name,address:_t.Address,type:_t.Type,status1:_t.Status,deleteDriver:ee,supabase:z,driverload:G,id:_t.Id},Fe)})},gt=()=>{if(e==="route")return Qe.jsx(Rve,{fileName:r,selectFile:i,userFiles:n,queryRouteAPI:j,reformatDataForRouteQuery:V});if(e==="schedule")return Qe.jsx(MQ,{userFiles:n,changePage:t,selectFile:i,fileName:r});if(e==="grid")return Qe.jsx(MQ,{userFiles:n,changePage:t,selectFile:i,fileName:r,setdataState:h});if(e==="driver")return Qe.jsx(lbt,{supabase:z,userName:$,driverload:G,handleDriver:K,setDriverHave:xe,grabAndListUserDrivers:He})},Lt=()=>{if(e==="route")return Qe.jsx(Eve,{});if(e=="grid"||e=="schedule")return Qe.jsx(abt,{fileName:r,dataState:a,size:p,setsaveCheck:T,deleteFile:s,setcheckifDeleted:A,checkifDeleted:R,saveCheck:S,userName:$,supabase:z});if(e==="driver")return Qe.jsx(ubt,{})};return Qe.jsx(Qe.Fragment,{children:Qe.jsxs("div",{id:"root",className:"page-grid",children:[Qe.jsx("div",{className:"header",children:Lt()}),Qe.jsx("div",{className:"main",children:We()}),Qe.jsx("div",{className:"input",children:gt()})]})})}function fbt({supabase:e,setLogOut:t}){const r=Dx(),[n,i]=Rt.useState("route"),[o,s]=Rt.useState(""),[a,h]=Rt.useState([]),[p,g]=Rt.useState(r.state.userid),[S,T]=Rt.useState([]),[R,A]=Rt.useState(0),[$,j]=Rt.useState("Saved"),[z,V]=Rt.useState(!0),[G,ee]=Rt.useState(!1);Rt.useState(!1);const[K,xe]=Rt.useState([]),[Me,He]=Rt.useState([]),[Ne,We]=Rt.useState(null),gt=ve=>{s(ve),Lt(ve),a.push(ve)},Lt=async ve=>{const ze=p+"/"+ve;let je=new Blob([[""]],{type:"application/json"});const{error:Je}=await e.storage.from("User-Files").upload(ze,je);Je&&console.log(Je)},_t=()=>{const ve=a.indexOf(o);ve>-1&&a.splice(ve,1),localStorage.setItem(p,JSON.stringify({files:a})),s(""),i("schedule"),ee(!1)},$e=ve=>{let ze=-1;for(let je=0;je<K.length;je++)K[je].Name==ve&&(console.log("found"),ze=je);Fe(ze),ze>-1&&K.splice(ze,1),He(je=>[je])},Fe=async ve=>{const{error:ze}=await e.from("user_drivers").delete().eq("Name",K[ve].Name);ze&&console.log(ze)},At=ve=>{s(ve)},Gt=ve=>{i(ve)};Rt.useEffect(()=>{a.length==0&&n=="route"&&ae()},[]),Rt.useEffect(()=>{K.length==0&&n=="route"&&D()},[]);const ae=async()=>{const{data:ve,error:ze}=await e.storage.from("User-Files").list(p);if(ze)console.log("error: "+ze);else{if(ve==null)return;let je=[];for(let Je=0;Je<ve.length;Je++){const{data:xt,error:kt}=await e.storage.from("User-Files").download(p+"/"+ve[Je].name);kt?console.log(kt):ne(xt).then(async jt=>{localStorage.setItem(p+"/"+ve[Je].name,JSON.stringify({grid:jt})),localStorage.setItem(p+"/"+ve[Je].name+"/lastrow",jt.length),localStorage.setItem(p+"/"+ve[Je].name+"/savestate","Saved")}),je[Je]=ve[Je].name}h(je)}},D=async()=>{const{data:ve,error:ze}=await e.from("user_drivers").select().eq("user_id",p);if(ze)console.log(ze);else{if(ve==null){console.log("NO DRIVERS_NULL");return}for(let je=0;je<ve.length;je++)K.push({Name:ve[je].Name,Address:ve[je].Address,Type:ve[je].vType,Status:ve[je].Status,Id:ve[je].driver_id});He(je=>[je])}},U=async()=>{const{data:ve,error:ze}=await e.storage.from("User-Files").download(p+"/"+o);ze?console.log(ze):ne(ve).then(async je=>{const Je=[];let xt='"';for(let lr=0;lr<je.length;lr++)if(lr==0){Je[lr]=`{
`+xt+[lr]+xt+": "+JSON.stringify(je[lr],null,3)+`
`;continue}else if(lr==je.length-1){Je[lr]=xt+[lr]+xt+": "+JSON.stringify(je[lr],null,3)+`
}`;continue}else{Je[lr]=xt+[lr]+xt+": "+JSON.stringify(je[lr],null,3)+`
`;continue}const kt=q();let jt=new FormData,yr=new Blob([[Je]],{type:"application/json"}),Ft=new Blob([[kt]],{type:"application/json"}),Jt=new File([yr],"Patients.json"),et=new File([Ft],"Drivers.json");jt.append("file",Jt),jt.append("file2",et);const $r=await(await fetch("http://localhost:5001/uploadjson",{method:"POST",body:jt})).json();We($r)})},q=()=>{let ve={};const ze=K.length;for(let je=0,Je=0;je<ze;je++)K[je].Status==!0&&(ve[Je]=K[je],Je++);return JSON.stringify(ve,null,3)};function ne(ve){return new Promise((ze,je)=>{const Je=new FileReader;Je.addEventListener("loadend",xt=>{const kt=xt.target.result;try{const jt=JSON.parse(kt);ze(jt)}catch(jt){je(jt)}}),Je.readAsText(ve)})}const ye=ve=>{xe(ve)};return Qe.jsx(Qe.Fragment,{children:Qe.jsxs("div",{className:"div-grid",children:[Qe.jsx("div",{className:"menu1",children:Qe.jsx(Cve,{onMenuClick:Gt,currentPage:n,selectFile:At,setLogOut:t})}),Qe.jsx("div",{className:"app",children:Qe.jsx(cbt,{currentPage:n,fileName:o,userName:p,changePage:Gt,handleFileName:gt,selectFile:At,userFiles:a,deleteFile:_t,dataState:S,setdataState:T,size:R,setSize:A,saveCheck:$,setsaveCheck:j,mapOn:z,setmapOn:V,checkifDeleted:G,setcheckifDeleted:ee,supabase:e,reformatDataForRouteQuery:U,driverload:K,deleteDriver:$e,handleDriver:ye,setDriverHave:He,driverhave:Me,grabAndListUserDrivers:D,routeData:Ne})})]})})}const hbt=({logOut:e,setLogOut:t,supabase:r,userData:n,setUserData:i,setsessionData:o})=>{const[s,a]=Rt.useState(""),[h,p]=Rt.useState(""),[g,S]=Rt.useState(!1),[T,R]=Rt.useState(!1),[A,$]=Rt.useState(!1),j=UP(),z=async()=>{let{data:G,error:ee}=await r.auth.signInWithPassword({email:h,password:s});ee==null?(localStorage.setItem("email",h),i(G.user),o(G.session)):(R(!0),S(!0))},V=()=>{if(s==""){S(!0);return}if(h==""){R(!0);return}else z()};return Rt.useEffect(()=>{async function G(){const ee=await r.auth.getSession();ee&&(i(ee.data.session.user),o(ee.data))}e==null&&G()},[]),Rt.useEffect(()=>{async function G(){const{error:ee}=await r.auth.signOut();ee?console.log("error signing out: "+ee):(i(null),o(null),t(null))}e==!0&&G()},[e]),Rt.useEffect(()=>{if(n!=null&&e!=!0){const G={userid:n.id};j("/whichway",{state:G})}},[n]),Qe.jsx(Qe.Fragment,{children:Qe.jsxs("div",{className:"parent-login-div",children:[Qe.jsx("p",{style:{fontWeight:"400",fontFamily:"roboto"},children:"Login"}),Qe.jsx("input",{className:T==!1?"t-2":"t-2 t-2-warning",placeholder:"Username",onChange:G=>{p(G.target.value),R(!1)},value:h}),Qe.jsx("input",{className:g==!1?"t-2 t-2-3":"t-2 t-2-3 t-2-warning",type:A?"":"password",placeholder:"Password",onChange:G=>{a(G.target.value),S(!1)},value:s}),Qe.jsx("button",{className:"input-button-import v3",type:"button",onClick:()=>V(),children:"Authenticate"}),Qe.jsxs("label",{style:{display:"block",fontSize:"14px",fontFamily:"roboto",fontWeight:"300"},children:[Qe.jsx("input",{type:"checkbox",onChange:()=>$(!A),style:{marginRight:"7px"}}),"Show Password"]})]})})};function dbt({supabase:e,userData:t,setUserData:r,setsessionData:n}){const[i,o]=Rt.useState(""),[s,a]=Rt.useState(""),[h,p]=Rt.useState(""),[g,S]=Rt.useState(""),[T,R]=Rt.useState(""),[A,$]=Rt.useState(""),[j,z]=Rt.useState(!1),[V,G]=Rt.useState(!1),[ee,K]=Rt.useState(!1),[xe,Me]=Rt.useState(!1),[He,Ne]=Rt.useState(!1),[We,gt]=Rt.useState(!1),Lt=UP(),_t=()=>{if(i==""){z(!0);return}if(s==""){G(!0);return}if(h==""){K(!0);return}if(g==""){Me(!0);return}if(T==""){Ne(!0);return}if(A==""){gt(!0);return}else $e()},$e=async()=>{const{data:Fe,error:At}=await e.auth.signUp({email:h,password:g,options:{data:{FirstName:i,LastName:s,PhoneNumber:T,Organization:A}}});At?console.log(At):(r(Fe.user),n(Fe.session),Lt("/verification"))};return Qe.jsx(Qe.Fragment,{children:Qe.jsx("div",{className:"signup-container",children:Qe.jsxs("div",{className:"sign-up-grid",children:[Qe.jsx("p",{style:{fontWeight:"400",fontFamily:"roboto",fontSize:"40px",textAlign:"center",color:"#337ab7"},className:"sign-header",children:"Sign Up"}),Qe.jsx("input",{placeholder:"First Name",className:j==!1?"schedule-input-series-sign-up fname":"schedule-input-series-sign-up fname-active",type:"text",onChange:Fe=>{o(Fe.target.value),z(!1)},value:i}),Qe.jsx("input",{placeholder:"Last Name",className:V==!1?"schedule-input-series-sign-up lname":"schedule-input-series-sign-up lname-active",type:"text",onChange:Fe=>{a(Fe.target.value),G(!1)},value:s}),Qe.jsx("input",{placeholder:"Email",className:ee==!1?"schedule-input-series-sign-up email":"schedule-input-series-sign-up email-active",type:"email",onChange:Fe=>{p(Fe.target.value),K(!1)},value:h}),Qe.jsx("input",{placeholder:"Password",className:xe==!1?"schedule-input-series-sign-up password":"schedule-input-series-sign-up password-active",type:"text",onChange:Fe=>{S(Fe.target.value),Me(!1)},value:g}),Qe.jsx("input",{placeholder:"Phone Number",className:He==!1?"schedule-input-series-sign-up number":"schedule-input-series-sign-up number-active",type:"tel",pattern:"[0-9]{3}-[0-9]{2}-[0-9]{3}",onChange:Fe=>{R(Fe.target.value),Ne(!1)},value:T}),Qe.jsx("input",{placeholder:"Organization Name",className:We==!1?"schedule-input-series-sign-up org":"schedule-input-series-sign-up org-active",type:"text",onChange:Fe=>{$(Fe.target.value),gt(!1)},value:A}),Qe.jsx("button",{onClick:()=>_t(),className:"input-button-import v5 sign-up",children:"Sign Up"})]})})})}function pbt({supabase:e,userData:t,setUserData:r,setsessionData:n}){return Qe.jsx(Qe.Fragment,{children:Qe.jsxs("p",{style:{textAlign:"center",fontSize:"16px",marginTop:"300px",fontFamily:"roboto"},children:["go to your email at (",t.email,") and confirm your email to start routing"]})})}function mbt(){const[e,t]=Rt.useState(null),[r,n]=Rt.useState(null),[i,o]=Rt.useState(null),s=bve("https://jskylaemugysziiuhbnp.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Impza3lsYWVtdWd5c3ppaXVoYm5wIiwicm9sZSI6ImFub24iLCJpYXQiOjE2ODQzNjcyNzIsImV4cCI6MTk5OTk0MzI3Mn0.z2ChCLTkbBB3PnW8YMCJk3ESdfLE3R3Cc7V8tF8FI4E");return Qe.jsxs(hye,{children:[Qe.jsx(zy,{path:"/",element:Qe.jsx(Sve,{})}),Qe.jsx(zy,{path:"/log-in/",element:Qe.jsx(hbt,{supabase:s,logOut:e,setLogOut:t,userData:r,setsessionData:o,setUserData:n})}),Qe.jsx(zy,{path:"/register/",element:Qe.jsx(dbt,{supabase:s,userData:r,setUserData:n,setsessionData:o})}),Qe.jsx(zy,{path:"/whichway",element:Qe.jsx(fbt,{supabase:s,setLogOut:t})}),Qe.jsx(zy,{path:"/verification",element:Qe.jsx(pbt,{supabase:s,userData:r,setUserData:n,setsessionData:o})})]})}L2.createRoot(document.getElementById("root")).render(Qe.jsx(gye,{children:Qe.jsx(mbt,{})}))});export default ybt();
