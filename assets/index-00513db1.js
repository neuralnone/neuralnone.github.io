var tye=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var IOt=tye((DOt,rP)=>{function rye(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const i in n)if(i!=="default"&&!(i in e)){const o=Object.getOwnPropertyDescriptor(n,i);o&&Object.defineProperty(e,i,o.get?o:{enumerable:!0,get:()=>n[i]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function r(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(i){if(i.ep)return;i.ep=!0;const o=r(i);fetch(i.href,o)}})();var Zy=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function jb(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function nye(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function n(){if(this instanceof n){var i=[null];i.push.apply(i,arguments);var o=Function.bind.apply(t,i);return new o}return t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var i=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,i.get?i:{enumerable:!0,get:function(){return e[n]}})}),r}var $re={exports:{}},XA={},Dre={exports:{}},Rn={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var MC=Symbol.for("react.element"),iye=Symbol.for("react.portal"),oye=Symbol.for("react.fragment"),aye=Symbol.for("react.strict_mode"),sye=Symbol.for("react.profiler"),lye=Symbol.for("react.provider"),uye=Symbol.for("react.context"),cye=Symbol.for("react.forward_ref"),fye=Symbol.for("react.suspense"),hye=Symbol.for("react.memo"),dye=Symbol.for("react.lazy"),v6=Symbol.iterator;function pye(e){return e===null||typeof e!="object"?null:(e=v6&&e[v6]||e["@@iterator"],typeof e=="function"?e:null)}var Lre={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Nre=Object.assign,Bre={};function Fb(e,t,r){this.props=e,this.context=t,this.refs=Bre,this.updater=r||Lre}Fb.prototype.isReactComponent={};Fb.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Fb.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function jre(){}jre.prototype=Fb.prototype;function IH(e,t,r){this.props=e,this.context=t,this.refs=Bre,this.updater=r||Lre}var MH=IH.prototype=new jre;MH.constructor=IH;Nre(MH,Fb.prototype);MH.isPureReactComponent=!0;var _6=Array.isArray,Fre=Object.prototype.hasOwnProperty,$H={current:null},zre={key:!0,ref:!0,__self:!0,__source:!0};function Hre(e,t,r){var n,i={},o=null,s=null;if(t!=null)for(n in t.ref!==void 0&&(s=t.ref),t.key!==void 0&&(o=""+t.key),t)Fre.call(t,n)&&!zre.hasOwnProperty(n)&&(i[n]=t[n]);var a=arguments.length-2;if(a===1)i.children=r;else if(1<a){for(var h=Array(a),p=0;p<a;p++)h[p]=arguments[p+2];i.children=h}if(e&&e.defaultProps)for(n in a=e.defaultProps,a)i[n]===void 0&&(i[n]=a[n]);return{$$typeof:MC,type:e,key:o,ref:s,props:i,_owner:$H.current}}function mye(e,t){return{$$typeof:MC,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function DH(e){return typeof e=="object"&&e!==null&&e.$$typeof===MC}function gye(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var b6=/\/+/g;function aD(e,t){return typeof e=="object"&&e!==null&&e.key!=null?gye(""+e.key):t.toString(36)}function QR(e,t,r,n,i){var o=typeof e;(o==="undefined"||o==="boolean")&&(e=null);var s=!1;if(e===null)s=!0;else switch(o){case"string":case"number":s=!0;break;case"object":switch(e.$$typeof){case MC:case iye:s=!0}}if(s)return s=e,i=i(s),e=n===""?"."+aD(s,0):n,_6(i)?(r="",e!=null&&(r=e.replace(b6,"$&/")+"/"),QR(i,t,r,"",function(p){return p})):i!=null&&(DH(i)&&(i=mye(i,r+(!i.key||s&&s.key===i.key?"":(""+i.key).replace(b6,"$&/")+"/")+e)),t.push(i)),1;if(s=0,n=n===""?".":n+":",_6(e))for(var a=0;a<e.length;a++){o=e[a];var h=n+aD(o,a);s+=QR(o,t,r,h,i)}else if(h=pye(e),typeof h=="function")for(e=h.call(e),a=0;!(o=e.next()).done;)o=o.value,h=n+aD(o,a++),s+=QR(o,t,r,h,i);else if(o==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return s}function vO(e,t,r){if(e==null)return e;var n=[],i=0;return QR(e,n,"","",function(o){return t.call(r,o,i++)}),n}function yye(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Sa={current:null},ek={transition:null},vye={ReactCurrentDispatcher:Sa,ReactCurrentBatchConfig:ek,ReactCurrentOwner:$H};Rn.Children={map:vO,forEach:function(e,t,r){vO(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return vO(e,function(){t++}),t},toArray:function(e){return vO(e,function(t){return t})||[]},only:function(e){if(!DH(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Rn.Component=Fb;Rn.Fragment=oye;Rn.Profiler=sye;Rn.PureComponent=IH;Rn.StrictMode=aye;Rn.Suspense=fye;Rn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=vye;Rn.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=Nre({},e.props),i=e.key,o=e.ref,s=e._owner;if(t!=null){if(t.ref!==void 0&&(o=t.ref,s=$H.current),t.key!==void 0&&(i=""+t.key),e.type&&e.type.defaultProps)var a=e.type.defaultProps;for(h in t)Fre.call(t,h)&&!zre.hasOwnProperty(h)&&(n[h]=t[h]===void 0&&a!==void 0?a[h]:t[h])}var h=arguments.length-2;if(h===1)n.children=r;else if(1<h){a=Array(h);for(var p=0;p<h;p++)a[p]=arguments[p+2];n.children=a}return{$$typeof:MC,type:e.type,key:i,ref:o,props:n,_owner:s}};Rn.createContext=function(e){return e={$$typeof:uye,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:lye,_context:e},e.Consumer=e};Rn.createElement=Hre;Rn.createFactory=function(e){var t=Hre.bind(null,e);return t.type=e,t};Rn.createRef=function(){return{current:null}};Rn.forwardRef=function(e){return{$$typeof:cye,render:e}};Rn.isValidElement=DH;Rn.lazy=function(e){return{$$typeof:dye,_payload:{_status:-1,_result:e},_init:yye}};Rn.memo=function(e,t){return{$$typeof:hye,type:e,compare:t===void 0?null:t}};Rn.startTransition=function(e){var t=ek.transition;ek.transition={};try{e()}finally{ek.transition=t}};Rn.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};Rn.useCallback=function(e,t){return Sa.current.useCallback(e,t)};Rn.useContext=function(e){return Sa.current.useContext(e)};Rn.useDebugValue=function(){};Rn.useDeferredValue=function(e){return Sa.current.useDeferredValue(e)};Rn.useEffect=function(e,t){return Sa.current.useEffect(e,t)};Rn.useId=function(){return Sa.current.useId()};Rn.useImperativeHandle=function(e,t,r){return Sa.current.useImperativeHandle(e,t,r)};Rn.useInsertionEffect=function(e,t){return Sa.current.useInsertionEffect(e,t)};Rn.useLayoutEffect=function(e,t){return Sa.current.useLayoutEffect(e,t)};Rn.useMemo=function(e,t){return Sa.current.useMemo(e,t)};Rn.useReducer=function(e,t,r){return Sa.current.useReducer(e,t,r)};Rn.useRef=function(e){return Sa.current.useRef(e)};Rn.useState=function(e){return Sa.current.useState(e)};Rn.useSyncExternalStore=function(e,t,r){return Sa.current.useSyncExternalStore(e,t,r)};Rn.useTransition=function(){return Sa.current.useTransition()};Rn.version="18.2.0";Dre.exports=Rn;var _t=Dre.exports;const io=jb(_t);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _ye=_t,bye=Symbol.for("react.element"),wye=Symbol.for("react.fragment"),Sye=Object.prototype.hasOwnProperty,xye=_ye.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Cye={key:!0,ref:!0,__self:!0,__source:!0};function Vre(e,t,r){var n,i={},o=null,s=null;r!==void 0&&(o=""+r),t.key!==void 0&&(o=""+t.key),t.ref!==void 0&&(s=t.ref);for(n in t)Sye.call(t,n)&&!Cye.hasOwnProperty(n)&&(i[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)i[n]===void 0&&(i[n]=t[n]);return{$$typeof:bye,type:e,key:o,ref:s,props:i,_owner:xye.current}}XA.Fragment=wye;XA.jsx=Vre;XA.jsxs=Vre;$re.exports=XA;var Pe=$re.exports,ON={},Ure={exports:{}},ms={},Wre={exports:{}},Gre={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(ie,M){var U=ie.length;ie.push(M);e:for(;0<U;){var K=U-1>>>1,re=ie[K];if(0<i(re,M))ie[K]=M,ie[U]=re,U=K;else break e}}function r(ie){return ie.length===0?null:ie[0]}function n(ie){if(ie.length===0)return null;var M=ie[0],U=ie.pop();if(U!==M){ie[0]=U;e:for(var K=0,re=ie.length,me=re>>>1;K<me;){var Oe=2*(K+1)-1,We=ie[Oe],Je=Oe+1,ht=ie[Je];if(0>i(We,U))Je<re&&0>i(ht,We)?(ie[K]=ht,ie[Je]=U,K=Je):(ie[K]=We,ie[Oe]=U,K=Oe);else if(Je<re&&0>i(ht,U))ie[K]=ht,ie[Je]=U,K=Je;else break e}}return M}function i(ie,M){var U=ie.sortIndex-M.sortIndex;return U!==0?U:ie.id-M.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;e.unstable_now=function(){return o.now()}}else{var s=Date,a=s.now();e.unstable_now=function(){return s.now()-a}}var h=[],p=[],y=1,S=null,E=3,O=!1,A=!1,$=!1,B=typeof setTimeout=="function"?setTimeout:null,j=typeof clearTimeout=="function"?clearTimeout:null,z=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function W(ie){for(var M=r(p);M!==null;){if(M.callback===null)n(p);else if(M.startTime<=ie)n(p),M.sortIndex=M.expirationTime,t(h,M);else break;M=r(p)}}function Q(ie){if($=!1,W(ie),!A)if(r(h)!==null)A=!0,pt(q);else{var M=r(p);M!==null&&Ct(Q,M.startTime-ie)}}function q(ie,M){A=!1,$&&($=!1,j(He),He=-1),O=!0;var U=E;try{for(W(M),S=r(h);S!==null&&(!(S.expirationTime>M)||ie&&!ct());){var K=S.callback;if(typeof K=="function"){S.callback=null,E=S.priorityLevel;var re=K(S.expirationTime<=M);M=e.unstable_now(),typeof re=="function"?S.callback=re:S===r(h)&&n(h),W(M)}else n(h);S=r(h)}if(S!==null)var me=!0;else{var Oe=r(p);Oe!==null&&Ct(Q,Oe.startTime-M),me=!1}return me}finally{S=null,E=U,O=!1}}var Se=!1,Ie=null,He=-1,Le=5,ze=-1;function ct(){return!(e.unstable_now()-ze<Le)}function At(){if(Ie!==null){var ie=e.unstable_now();ze=ie;var M=!0;try{M=Ie(!0,ie)}finally{M?Qe():(Se=!1,Ie=null)}}else Se=!1}var Qe;if(typeof z=="function")Qe=function(){z(At)};else if(typeof MessageChannel<"u"){var de=new MessageChannel,Ce=de.port2;de.port1.onmessage=At,Qe=function(){Ce.postMessage(null)}}else Qe=function(){B(At,0)};function pt(ie){Ie=ie,Se||(Se=!0,Qe())}function Ct(ie,M){He=B(function(){ie(e.unstable_now())},M)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(ie){ie.callback=null},e.unstable_continueExecution=function(){A||O||(A=!0,pt(q))},e.unstable_forceFrameRate=function(ie){0>ie||125<ie?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Le=0<ie?Math.floor(1e3/ie):5},e.unstable_getCurrentPriorityLevel=function(){return E},e.unstable_getFirstCallbackNode=function(){return r(h)},e.unstable_next=function(ie){switch(E){case 1:case 2:case 3:var M=3;break;default:M=E}var U=E;E=M;try{return ie()}finally{E=U}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(ie,M){switch(ie){case 1:case 2:case 3:case 4:case 5:break;default:ie=3}var U=E;E=ie;try{return M()}finally{E=U}},e.unstable_scheduleCallback=function(ie,M,U){var K=e.unstable_now();switch(typeof U=="object"&&U!==null?(U=U.delay,U=typeof U=="number"&&0<U?K+U:K):U=K,ie){case 1:var re=-1;break;case 2:re=250;break;case 5:re=1073741823;break;case 4:re=1e4;break;default:re=5e3}return re=U+re,ie={id:y++,callback:M,priorityLevel:ie,startTime:U,expirationTime:re,sortIndex:-1},U>K?(ie.sortIndex=U,t(p,ie),r(h)===null&&ie===r(p)&&($?(j(He),He=-1):$=!0,Ct(Q,U-K))):(ie.sortIndex=re,t(h,ie),A||O||(A=!0,pt(q))),ie},e.unstable_shouldYield=ct,e.unstable_wrapCallback=function(ie){var M=E;return function(){var U=E;E=M;try{return ie.apply(this,arguments)}finally{E=U}}}})(Gre);Wre.exports=Gre;var Eye=Wre.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Yre=_t,fs=Eye;function Zt(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Kre=new Set,n1={};function xm(e,t){vv(e,t),vv(e+"Capture",t)}function vv(e,t){for(n1[e]=t,e=0;e<t.length;e++)Kre.add(t[e])}var Vc=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),RN=Object.prototype.hasOwnProperty,Tye=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,w6={},S6={};function Oye(e){return RN.call(S6,e)?!0:RN.call(w6,e)?!1:Tye.test(e)?S6[e]=!0:(w6[e]=!0,!1)}function Rye(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function kye(e,t,r,n){if(t===null||typeof t>"u"||Rye(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function xa(e,t,r,n,i,o,s){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=o,this.removeEmptyString=s}var Fo={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Fo[e]=new xa(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Fo[t]=new xa(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Fo[e]=new xa(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Fo[e]=new xa(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Fo[e]=new xa(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Fo[e]=new xa(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Fo[e]=new xa(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Fo[e]=new xa(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Fo[e]=new xa(e,5,!1,e.toLowerCase(),null,!1,!1)});var LH=/[\-:]([a-z])/g;function NH(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(LH,NH);Fo[t]=new xa(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(LH,NH);Fo[t]=new xa(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(LH,NH);Fo[t]=new xa(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Fo[e]=new xa(e,1,!1,e.toLowerCase(),null,!1,!1)});Fo.xlinkHref=new xa("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Fo[e]=new xa(e,1,!1,e.toLowerCase(),null,!0,!0)});function BH(e,t,r,n){var i=Fo.hasOwnProperty(t)?Fo[t]:null;(i!==null?i.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(kye(t,r,i,n)&&(r=null),n||i===null?Oye(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):i.mustUseProperty?e[i.propertyName]=r===null?i.type===3?!1:"":r:(t=i.attributeName,n=i.attributeNamespace,r===null?e.removeAttribute(t):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var Qc=Yre.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,_O=Symbol.for("react.element"),$y=Symbol.for("react.portal"),Dy=Symbol.for("react.fragment"),jH=Symbol.for("react.strict_mode"),kN=Symbol.for("react.profiler"),qre=Symbol.for("react.provider"),Xre=Symbol.for("react.context"),FH=Symbol.for("react.forward_ref"),PN=Symbol.for("react.suspense"),AN=Symbol.for("react.suspense_list"),zH=Symbol.for("react.memo"),Jf=Symbol.for("react.lazy"),Zre=Symbol.for("react.offscreen"),x6=Symbol.iterator;function A0(e){return e===null||typeof e!="object"?null:(e=x6&&e[x6]||e["@@iterator"],typeof e=="function"?e:null)}var Bi=Object.assign,sD;function vS(e){if(sD===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);sD=t&&t[1]||""}return`
`+sD+e}var lD=!1;function uD(e,t){if(!e||lD)return"";lD=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(p){var n=p}Reflect.construct(e,[],t)}else{try{t.call()}catch(p){n=p}e.call(t.prototype)}else{try{throw Error()}catch(p){n=p}e()}}catch(p){if(p&&n&&typeof p.stack=="string"){for(var i=p.stack.split(`
`),o=n.stack.split(`
`),s=i.length-1,a=o.length-1;1<=s&&0<=a&&i[s]!==o[a];)a--;for(;1<=s&&0<=a;s--,a--)if(i[s]!==o[a]){if(s!==1||a!==1)do if(s--,a--,0>a||i[s]!==o[a]){var h=`
`+i[s].replace(" at new "," at ");return e.displayName&&h.includes("<anonymous>")&&(h=h.replace("<anonymous>",e.displayName)),h}while(1<=s&&0<=a);break}}}finally{lD=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?vS(e):""}function Pye(e){switch(e.tag){case 5:return vS(e.type);case 16:return vS("Lazy");case 13:return vS("Suspense");case 19:return vS("SuspenseList");case 0:case 2:case 15:return e=uD(e.type,!1),e;case 11:return e=uD(e.type.render,!1),e;case 1:return e=uD(e.type,!0),e;default:return""}}function IN(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Dy:return"Fragment";case $y:return"Portal";case kN:return"Profiler";case jH:return"StrictMode";case PN:return"Suspense";case AN:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Xre:return(e.displayName||"Context")+".Consumer";case qre:return(e._context.displayName||"Context")+".Provider";case FH:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case zH:return t=e.displayName||null,t!==null?t:IN(e.type)||"Memo";case Jf:t=e._payload,e=e._init;try{return IN(e(t))}catch{}}return null}function Aye(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return IN(t);case 8:return t===jH?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Dh(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Jre(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Iye(e){var t=Jre(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,o=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(s){n=""+s,o.call(this,s)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(s){n=""+s},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function bO(e){e._valueTracker||(e._valueTracker=Iye(e))}function Qre(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=Jre(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function nP(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function MN(e,t){var r=t.checked;return Bi({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function C6(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=Dh(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function ene(e,t){t=t.checked,t!=null&&BH(e,"checked",t,!1)}function $N(e,t){ene(e,t);var r=Dh(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?DN(e,t.type,r):t.hasOwnProperty("defaultValue")&&DN(e,t.type,Dh(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function E6(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function DN(e,t,r){(t!=="number"||nP(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var _S=Array.isArray;function Jy(e,t,r,n){if(e=e.options,t){t={};for(var i=0;i<r.length;i++)t["$"+r[i]]=!0;for(r=0;r<e.length;r++)i=t.hasOwnProperty("$"+e[r].value),e[r].selected!==i&&(e[r].selected=i),i&&n&&(e[r].defaultSelected=!0)}else{for(r=""+Dh(r),t=null,i=0;i<e.length;i++){if(e[i].value===r){e[i].selected=!0,n&&(e[i].defaultSelected=!0);return}t!==null||e[i].disabled||(t=e[i])}t!==null&&(t.selected=!0)}}function LN(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(Zt(91));return Bi({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function T6(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(Zt(92));if(_S(r)){if(1<r.length)throw Error(Zt(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:Dh(r)}}function tne(e,t){var r=Dh(t.value),n=Dh(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function O6(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function rne(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function NN(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?rne(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var wO,nne=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,i){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,i)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(wO=wO||document.createElement("div"),wO.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=wO.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function i1(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var kS={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Mye=["Webkit","ms","Moz","O"];Object.keys(kS).forEach(function(e){Mye.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),kS[t]=kS[e]})});function ine(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||kS.hasOwnProperty(e)&&kS[e]?(""+t).trim():t+"px"}function one(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=ine(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,i):e[r]=i}}var $ye=Bi({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function BN(e,t){if(t){if($ye[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(Zt(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(Zt(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(Zt(61))}if(t.style!=null&&typeof t.style!="object")throw Error(Zt(62))}}function jN(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var FN=null;function HH(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var zN=null,Qy=null,ev=null;function R6(e){if(e=LC(e)){if(typeof zN!="function")throw Error(Zt(280));var t=e.stateNode;t&&(t=tI(t),zN(e.stateNode,e.type,t))}}function ane(e){Qy?ev?ev.push(e):ev=[e]:Qy=e}function sne(){if(Qy){var e=Qy,t=ev;if(ev=Qy=null,R6(e),t)for(e=0;e<t.length;e++)R6(t[e])}}function lne(e,t){return e(t)}function une(){}var cD=!1;function cne(e,t,r){if(cD)return e(t,r);cD=!0;try{return lne(e,t,r)}finally{cD=!1,(Qy!==null||ev!==null)&&(une(),sne())}}function o1(e,t){var r=e.stateNode;if(r===null)return null;var n=tI(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(Zt(231,t,typeof r));return r}var HN=!1;if(Vc)try{var I0={};Object.defineProperty(I0,"passive",{get:function(){HN=!0}}),window.addEventListener("test",I0,I0),window.removeEventListener("test",I0,I0)}catch{HN=!1}function Dye(e,t,r,n,i,o,s,a,h){var p=Array.prototype.slice.call(arguments,3);try{t.apply(r,p)}catch(y){this.onError(y)}}var PS=!1,iP=null,oP=!1,VN=null,Lye={onError:function(e){PS=!0,iP=e}};function Nye(e,t,r,n,i,o,s,a,h){PS=!1,iP=null,Dye.apply(Lye,arguments)}function Bye(e,t,r,n,i,o,s,a,h){if(Nye.apply(this,arguments),PS){if(PS){var p=iP;PS=!1,iP=null}else throw Error(Zt(198));oP||(oP=!0,VN=p)}}function Cm(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function fne(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function k6(e){if(Cm(e)!==e)throw Error(Zt(188))}function jye(e){var t=e.alternate;if(!t){if(t=Cm(e),t===null)throw Error(Zt(188));return t!==e?null:e}for(var r=e,n=t;;){var i=r.return;if(i===null)break;var o=i.alternate;if(o===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===r)return k6(i),e;if(o===n)return k6(i),t;o=o.sibling}throw Error(Zt(188))}if(r.return!==n.return)r=i,n=o;else{for(var s=!1,a=i.child;a;){if(a===r){s=!0,r=i,n=o;break}if(a===n){s=!0,n=i,r=o;break}a=a.sibling}if(!s){for(a=o.child;a;){if(a===r){s=!0,r=o,n=i;break}if(a===n){s=!0,n=o,r=i;break}a=a.sibling}if(!s)throw Error(Zt(189))}}if(r.alternate!==n)throw Error(Zt(190))}if(r.tag!==3)throw Error(Zt(188));return r.stateNode.current===r?e:t}function hne(e){return e=jye(e),e!==null?dne(e):null}function dne(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=dne(e);if(t!==null)return t;e=e.sibling}return null}var pne=fs.unstable_scheduleCallback,P6=fs.unstable_cancelCallback,Fye=fs.unstable_shouldYield,zye=fs.unstable_requestPaint,Zi=fs.unstable_now,Hye=fs.unstable_getCurrentPriorityLevel,VH=fs.unstable_ImmediatePriority,mne=fs.unstable_UserBlockingPriority,aP=fs.unstable_NormalPriority,Vye=fs.unstable_LowPriority,gne=fs.unstable_IdlePriority,ZA=null,yu=null;function Uye(e){if(yu&&typeof yu.onCommitFiberRoot=="function")try{yu.onCommitFiberRoot(ZA,e,void 0,(e.current.flags&128)===128)}catch{}}var Cl=Math.clz32?Math.clz32:Yye,Wye=Math.log,Gye=Math.LN2;function Yye(e){return e>>>=0,e===0?32:31-(Wye(e)/Gye|0)|0}var SO=64,xO=4194304;function bS(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function sP(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,i=e.suspendedLanes,o=e.pingedLanes,s=r&268435455;if(s!==0){var a=s&~i;a!==0?n=bS(a):(o&=s,o!==0&&(n=bS(o)))}else s=r&~i,s!==0?n=bS(s):o!==0&&(n=bS(o));if(n===0)return 0;if(t!==0&&t!==n&&!(t&i)&&(i=n&-n,o=t&-t,i>=o||i===16&&(o&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-Cl(t),i=1<<r,n|=e[r],t&=~i;return n}function Kye(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function qye(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,i=e.expirationTimes,o=e.pendingLanes;0<o;){var s=31-Cl(o),a=1<<s,h=i[s];h===-1?(!(a&r)||a&n)&&(i[s]=Kye(a,t)):h<=t&&(e.expiredLanes|=a),o&=~a}}function UN(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function yne(){var e=SO;return SO<<=1,!(SO&4194240)&&(SO=64),e}function fD(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function $C(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Cl(t),e[t]=r}function Xye(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var i=31-Cl(r),o=1<<i;t[i]=0,n[i]=-1,e[i]=-1,r&=~o}}function UH(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-Cl(r),i=1<<n;i&t|e[n]&t&&(e[n]|=t),r&=~i}}var ti=0;function vne(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var _ne,WH,bne,wne,Sne,WN=!1,CO=[],hh=null,dh=null,ph=null,a1=new Map,s1=new Map,th=[],Zye="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function A6(e,t){switch(e){case"focusin":case"focusout":hh=null;break;case"dragenter":case"dragleave":dh=null;break;case"mouseover":case"mouseout":ph=null;break;case"pointerover":case"pointerout":a1.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":s1.delete(t.pointerId)}}function M0(e,t,r,n,i,o){return e===null||e.nativeEvent!==o?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:o,targetContainers:[i]},t!==null&&(t=LC(t),t!==null&&WH(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,i!==null&&t.indexOf(i)===-1&&t.push(i),e)}function Jye(e,t,r,n,i){switch(t){case"focusin":return hh=M0(hh,e,t,r,n,i),!0;case"dragenter":return dh=M0(dh,e,t,r,n,i),!0;case"mouseover":return ph=M0(ph,e,t,r,n,i),!0;case"pointerover":var o=i.pointerId;return a1.set(o,M0(a1.get(o)||null,e,t,r,n,i)),!0;case"gotpointercapture":return o=i.pointerId,s1.set(o,M0(s1.get(o)||null,e,t,r,n,i)),!0}return!1}function xne(e){var t=gp(e.target);if(t!==null){var r=Cm(t);if(r!==null){if(t=r.tag,t===13){if(t=fne(r),t!==null){e.blockedOn=t,Sne(e.priority,function(){bne(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function tk(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=GN(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);FN=n,r.target.dispatchEvent(n),FN=null}else return t=LC(r),t!==null&&WH(t),e.blockedOn=r,!1;t.shift()}return!0}function I6(e,t,r){tk(e)&&r.delete(t)}function Qye(){WN=!1,hh!==null&&tk(hh)&&(hh=null),dh!==null&&tk(dh)&&(dh=null),ph!==null&&tk(ph)&&(ph=null),a1.forEach(I6),s1.forEach(I6)}function $0(e,t){e.blockedOn===t&&(e.blockedOn=null,WN||(WN=!0,fs.unstable_scheduleCallback(fs.unstable_NormalPriority,Qye)))}function l1(e){function t(i){return $0(i,e)}if(0<CO.length){$0(CO[0],e);for(var r=1;r<CO.length;r++){var n=CO[r];n.blockedOn===e&&(n.blockedOn=null)}}for(hh!==null&&$0(hh,e),dh!==null&&$0(dh,e),ph!==null&&$0(ph,e),a1.forEach(t),s1.forEach(t),r=0;r<th.length;r++)n=th[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<th.length&&(r=th[0],r.blockedOn===null);)xne(r),r.blockedOn===null&&th.shift()}var tv=Qc.ReactCurrentBatchConfig,lP=!0;function eve(e,t,r,n){var i=ti,o=tv.transition;tv.transition=null;try{ti=1,GH(e,t,r,n)}finally{ti=i,tv.transition=o}}function tve(e,t,r,n){var i=ti,o=tv.transition;tv.transition=null;try{ti=4,GH(e,t,r,n)}finally{ti=i,tv.transition=o}}function GH(e,t,r,n){if(lP){var i=GN(e,t,r,n);if(i===null)wD(e,t,n,uP,r),A6(e,n);else if(Jye(i,e,t,r,n))n.stopPropagation();else if(A6(e,n),t&4&&-1<Zye.indexOf(e)){for(;i!==null;){var o=LC(i);if(o!==null&&_ne(o),o=GN(e,t,r,n),o===null&&wD(e,t,n,uP,r),o===i)break;i=o}i!==null&&n.stopPropagation()}else wD(e,t,n,null,r)}}var uP=null;function GN(e,t,r,n){if(uP=null,e=HH(n),e=gp(e),e!==null)if(t=Cm(e),t===null)e=null;else if(r=t.tag,r===13){if(e=fne(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return uP=e,null}function Cne(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Hye()){case VH:return 1;case mne:return 4;case aP:case Vye:return 16;case gne:return 536870912;default:return 16}default:return 16}}var oh=null,YH=null,rk=null;function Ene(){if(rk)return rk;var e,t=YH,r=t.length,n,i="value"in oh?oh.value:oh.textContent,o=i.length;for(e=0;e<r&&t[e]===i[e];e++);var s=r-e;for(n=1;n<=s&&t[r-n]===i[o-n];n++);return rk=i.slice(e,1<n?1-n:void 0)}function nk(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function EO(){return!0}function M6(){return!1}function gs(e){function t(r,n,i,o,s){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=o,this.target=s,this.currentTarget=null;for(var a in e)e.hasOwnProperty(a)&&(r=e[a],this[a]=r?r(o):o[a]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?EO:M6,this.isPropagationStopped=M6,this}return Bi(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=EO)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=EO)},persist:function(){},isPersistent:EO}),t}var zb={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},KH=gs(zb),DC=Bi({},zb,{view:0,detail:0}),rve=gs(DC),hD,dD,D0,JA=Bi({},DC,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:qH,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==D0&&(D0&&e.type==="mousemove"?(hD=e.screenX-D0.screenX,dD=e.screenY-D0.screenY):dD=hD=0,D0=e),hD)},movementY:function(e){return"movementY"in e?e.movementY:dD}}),$6=gs(JA),nve=Bi({},JA,{dataTransfer:0}),ive=gs(nve),ove=Bi({},DC,{relatedTarget:0}),pD=gs(ove),ave=Bi({},zb,{animationName:0,elapsedTime:0,pseudoElement:0}),sve=gs(ave),lve=Bi({},zb,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),uve=gs(lve),cve=Bi({},zb,{data:0}),D6=gs(cve),fve={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},hve={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},dve={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function pve(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=dve[e])?!!t[e]:!1}function qH(){return pve}var mve=Bi({},DC,{key:function(e){if(e.key){var t=fve[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=nk(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?hve[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:qH,charCode:function(e){return e.type==="keypress"?nk(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?nk(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),gve=gs(mve),yve=Bi({},JA,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),L6=gs(yve),vve=Bi({},DC,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:qH}),_ve=gs(vve),bve=Bi({},zb,{propertyName:0,elapsedTime:0,pseudoElement:0}),wve=gs(bve),Sve=Bi({},JA,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),xve=gs(Sve),Cve=[9,13,27,32],XH=Vc&&"CompositionEvent"in window,AS=null;Vc&&"documentMode"in document&&(AS=document.documentMode);var Eve=Vc&&"TextEvent"in window&&!AS,Tne=Vc&&(!XH||AS&&8<AS&&11>=AS),N6=String.fromCharCode(32),B6=!1;function One(e,t){switch(e){case"keyup":return Cve.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Rne(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Ly=!1;function Tve(e,t){switch(e){case"compositionend":return Rne(t);case"keypress":return t.which!==32?null:(B6=!0,N6);case"textInput":return e=t.data,e===N6&&B6?null:e;default:return null}}function Ove(e,t){if(Ly)return e==="compositionend"||!XH&&One(e,t)?(e=Ene(),rk=YH=oh=null,Ly=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Tne&&t.locale!=="ko"?null:t.data;default:return null}}var Rve={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function j6(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Rve[e.type]:t==="textarea"}function kne(e,t,r,n){ane(n),t=cP(t,"onChange"),0<t.length&&(r=new KH("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var IS=null,u1=null;function kve(e){Fne(e,0)}function QA(e){var t=jy(e);if(Qre(t))return e}function Pve(e,t){if(e==="change")return t}var Pne=!1;if(Vc){var mD;if(Vc){var gD="oninput"in document;if(!gD){var F6=document.createElement("div");F6.setAttribute("oninput","return;"),gD=typeof F6.oninput=="function"}mD=gD}else mD=!1;Pne=mD&&(!document.documentMode||9<document.documentMode)}function z6(){IS&&(IS.detachEvent("onpropertychange",Ane),u1=IS=null)}function Ane(e){if(e.propertyName==="value"&&QA(u1)){var t=[];kne(t,u1,e,HH(e)),cne(kve,t)}}function Ave(e,t,r){e==="focusin"?(z6(),IS=t,u1=r,IS.attachEvent("onpropertychange",Ane)):e==="focusout"&&z6()}function Ive(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return QA(u1)}function Mve(e,t){if(e==="click")return QA(t)}function $ve(e,t){if(e==="input"||e==="change")return QA(t)}function Dve(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Tl=typeof Object.is=="function"?Object.is:Dve;function c1(e,t){if(Tl(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!RN.call(t,i)||!Tl(e[i],t[i]))return!1}return!0}function H6(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function V6(e,t){var r=H6(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=H6(r)}}function Ine(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Ine(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Mne(){for(var e=window,t=nP();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=nP(e.document)}return t}function ZH(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function Lve(e){var t=Mne(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&Ine(r.ownerDocument.documentElement,r)){if(n!==null&&ZH(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var i=r.textContent.length,o=Math.min(n.start,i);n=n.end===void 0?o:Math.min(n.end,i),!e.extend&&o>n&&(i=n,n=o,o=i),i=V6(r,o);var s=V6(r,n);i&&s&&(e.rangeCount!==1||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==s.node||e.focusOffset!==s.offset)&&(t=t.createRange(),t.setStart(i.node,i.offset),e.removeAllRanges(),o>n?(e.addRange(t),e.extend(s.node,s.offset)):(t.setEnd(s.node,s.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Nve=Vc&&"documentMode"in document&&11>=document.documentMode,Ny=null,YN=null,MS=null,KN=!1;function U6(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;KN||Ny==null||Ny!==nP(n)||(n=Ny,"selectionStart"in n&&ZH(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),MS&&c1(MS,n)||(MS=n,n=cP(YN,"onSelect"),0<n.length&&(t=new KH("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=Ny)))}function TO(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var By={animationend:TO("Animation","AnimationEnd"),animationiteration:TO("Animation","AnimationIteration"),animationstart:TO("Animation","AnimationStart"),transitionend:TO("Transition","TransitionEnd")},yD={},$ne={};Vc&&($ne=document.createElement("div").style,"AnimationEvent"in window||(delete By.animationend.animation,delete By.animationiteration.animation,delete By.animationstart.animation),"TransitionEvent"in window||delete By.transitionend.transition);function eI(e){if(yD[e])return yD[e];if(!By[e])return e;var t=By[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in $ne)return yD[e]=t[r];return e}var Dne=eI("animationend"),Lne=eI("animationiteration"),Nne=eI("animationstart"),Bne=eI("transitionend"),jne=new Map,W6="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Hh(e,t){jne.set(e,t),xm(t,[e])}for(var vD=0;vD<W6.length;vD++){var _D=W6[vD],Bve=_D.toLowerCase(),jve=_D[0].toUpperCase()+_D.slice(1);Hh(Bve,"on"+jve)}Hh(Dne,"onAnimationEnd");Hh(Lne,"onAnimationIteration");Hh(Nne,"onAnimationStart");Hh("dblclick","onDoubleClick");Hh("focusin","onFocus");Hh("focusout","onBlur");Hh(Bne,"onTransitionEnd");vv("onMouseEnter",["mouseout","mouseover"]);vv("onMouseLeave",["mouseout","mouseover"]);vv("onPointerEnter",["pointerout","pointerover"]);vv("onPointerLeave",["pointerout","pointerover"]);xm("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));xm("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));xm("onBeforeInput",["compositionend","keypress","textInput","paste"]);xm("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));xm("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));xm("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var wS="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Fve=new Set("cancel close invalid load scroll toggle".split(" ").concat(wS));function G6(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,Bye(n,t,void 0,e),e.currentTarget=null}function Fne(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],i=n.event;n=n.listeners;e:{var o=void 0;if(t)for(var s=n.length-1;0<=s;s--){var a=n[s],h=a.instance,p=a.currentTarget;if(a=a.listener,h!==o&&i.isPropagationStopped())break e;G6(i,a,p),o=h}else for(s=0;s<n.length;s++){if(a=n[s],h=a.instance,p=a.currentTarget,a=a.listener,h!==o&&i.isPropagationStopped())break e;G6(i,a,p),o=h}}}if(oP)throw e=VN,oP=!1,VN=null,e}function yi(e,t){var r=t[QN];r===void 0&&(r=t[QN]=new Set);var n=e+"__bubble";r.has(n)||(zne(t,e,2,!1),r.add(n))}function bD(e,t,r){var n=0;t&&(n|=4),zne(r,e,n,t)}var OO="_reactListening"+Math.random().toString(36).slice(2);function f1(e){if(!e[OO]){e[OO]=!0,Kre.forEach(function(r){r!=="selectionchange"&&(Fve.has(r)||bD(r,!1,e),bD(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[OO]||(t[OO]=!0,bD("selectionchange",!1,t))}}function zne(e,t,r,n){switch(Cne(t)){case 1:var i=eve;break;case 4:i=tve;break;default:i=GH}r=i.bind(null,t,r,e),i=void 0,!HN||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(i=!0),n?i!==void 0?e.addEventListener(t,r,{capture:!0,passive:i}):e.addEventListener(t,r,!0):i!==void 0?e.addEventListener(t,r,{passive:i}):e.addEventListener(t,r,!1)}function wD(e,t,r,n,i){var o=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var s=n.tag;if(s===3||s===4){var a=n.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(s===4)for(s=n.return;s!==null;){var h=s.tag;if((h===3||h===4)&&(h=s.stateNode.containerInfo,h===i||h.nodeType===8&&h.parentNode===i))return;s=s.return}for(;a!==null;){if(s=gp(a),s===null)return;if(h=s.tag,h===5||h===6){n=o=s;continue e}a=a.parentNode}}n=n.return}cne(function(){var p=o,y=HH(r),S=[];e:{var E=jne.get(e);if(E!==void 0){var O=KH,A=e;switch(e){case"keypress":if(nk(r)===0)break e;case"keydown":case"keyup":O=gve;break;case"focusin":A="focus",O=pD;break;case"focusout":A="blur",O=pD;break;case"beforeblur":case"afterblur":O=pD;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":O=$6;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":O=ive;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":O=_ve;break;case Dne:case Lne:case Nne:O=sve;break;case Bne:O=wve;break;case"scroll":O=rve;break;case"wheel":O=xve;break;case"copy":case"cut":case"paste":O=uve;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":O=L6}var $=(t&4)!==0,B=!$&&e==="scroll",j=$?E!==null?E+"Capture":null:E;$=[];for(var z=p,W;z!==null;){W=z;var Q=W.stateNode;if(W.tag===5&&Q!==null&&(W=Q,j!==null&&(Q=o1(z,j),Q!=null&&$.push(h1(z,Q,W)))),B)break;z=z.return}0<$.length&&(E=new O(E,A,null,r,y),S.push({event:E,listeners:$}))}}if(!(t&7)){e:{if(E=e==="mouseover"||e==="pointerover",O=e==="mouseout"||e==="pointerout",E&&r!==FN&&(A=r.relatedTarget||r.fromElement)&&(gp(A)||A[Uc]))break e;if((O||E)&&(E=y.window===y?y:(E=y.ownerDocument)?E.defaultView||E.parentWindow:window,O?(A=r.relatedTarget||r.toElement,O=p,A=A?gp(A):null,A!==null&&(B=Cm(A),A!==B||A.tag!==5&&A.tag!==6)&&(A=null)):(O=null,A=p),O!==A)){if($=$6,Q="onMouseLeave",j="onMouseEnter",z="mouse",(e==="pointerout"||e==="pointerover")&&($=L6,Q="onPointerLeave",j="onPointerEnter",z="pointer"),B=O==null?E:jy(O),W=A==null?E:jy(A),E=new $(Q,z+"leave",O,r,y),E.target=B,E.relatedTarget=W,Q=null,gp(y)===p&&($=new $(j,z+"enter",A,r,y),$.target=W,$.relatedTarget=B,Q=$),B=Q,O&&A)t:{for($=O,j=A,z=0,W=$;W;W=Vg(W))z++;for(W=0,Q=j;Q;Q=Vg(Q))W++;for(;0<z-W;)$=Vg($),z--;for(;0<W-z;)j=Vg(j),W--;for(;z--;){if($===j||j!==null&&$===j.alternate)break t;$=Vg($),j=Vg(j)}$=null}else $=null;O!==null&&Y6(S,E,O,$,!1),A!==null&&B!==null&&Y6(S,B,A,$,!0)}}e:{if(E=p?jy(p):window,O=E.nodeName&&E.nodeName.toLowerCase(),O==="select"||O==="input"&&E.type==="file")var q=Pve;else if(j6(E))if(Pne)q=$ve;else{q=Ive;var Se=Ave}else(O=E.nodeName)&&O.toLowerCase()==="input"&&(E.type==="checkbox"||E.type==="radio")&&(q=Mve);if(q&&(q=q(e,p))){kne(S,q,r,y);break e}Se&&Se(e,E,p),e==="focusout"&&(Se=E._wrapperState)&&Se.controlled&&E.type==="number"&&DN(E,"number",E.value)}switch(Se=p?jy(p):window,e){case"focusin":(j6(Se)||Se.contentEditable==="true")&&(Ny=Se,YN=p,MS=null);break;case"focusout":MS=YN=Ny=null;break;case"mousedown":KN=!0;break;case"contextmenu":case"mouseup":case"dragend":KN=!1,U6(S,r,y);break;case"selectionchange":if(Nve)break;case"keydown":case"keyup":U6(S,r,y)}var Ie;if(XH)e:{switch(e){case"compositionstart":var He="onCompositionStart";break e;case"compositionend":He="onCompositionEnd";break e;case"compositionupdate":He="onCompositionUpdate";break e}He=void 0}else Ly?One(e,r)&&(He="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(He="onCompositionStart");He&&(Tne&&r.locale!=="ko"&&(Ly||He!=="onCompositionStart"?He==="onCompositionEnd"&&Ly&&(Ie=Ene()):(oh=y,YH="value"in oh?oh.value:oh.textContent,Ly=!0)),Se=cP(p,He),0<Se.length&&(He=new D6(He,e,null,r,y),S.push({event:He,listeners:Se}),Ie?He.data=Ie:(Ie=Rne(r),Ie!==null&&(He.data=Ie)))),(Ie=Eve?Tve(e,r):Ove(e,r))&&(p=cP(p,"onBeforeInput"),0<p.length&&(y=new D6("onBeforeInput","beforeinput",null,r,y),S.push({event:y,listeners:p}),y.data=Ie))}Fne(S,t)})}function h1(e,t,r){return{instance:e,listener:t,currentTarget:r}}function cP(e,t){for(var r=t+"Capture",n=[];e!==null;){var i=e,o=i.stateNode;i.tag===5&&o!==null&&(i=o,o=o1(e,r),o!=null&&n.unshift(h1(e,o,i)),o=o1(e,t),o!=null&&n.push(h1(e,o,i))),e=e.return}return n}function Vg(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Y6(e,t,r,n,i){for(var o=t._reactName,s=[];r!==null&&r!==n;){var a=r,h=a.alternate,p=a.stateNode;if(h!==null&&h===n)break;a.tag===5&&p!==null&&(a=p,i?(h=o1(r,o),h!=null&&s.unshift(h1(r,h,a))):i||(h=o1(r,o),h!=null&&s.push(h1(r,h,a)))),r=r.return}s.length!==0&&e.push({event:t,listeners:s})}var zve=/\r\n?/g,Hve=/\u0000|\uFFFD/g;function K6(e){return(typeof e=="string"?e:""+e).replace(zve,`
`).replace(Hve,"")}function RO(e,t,r){if(t=K6(t),K6(e)!==t&&r)throw Error(Zt(425))}function fP(){}var qN=null,XN=null;function ZN(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var JN=typeof setTimeout=="function"?setTimeout:void 0,Vve=typeof clearTimeout=="function"?clearTimeout:void 0,q6=typeof Promise=="function"?Promise:void 0,Uve=typeof queueMicrotask=="function"?queueMicrotask:typeof q6<"u"?function(e){return q6.resolve(null).then(e).catch(Wve)}:JN;function Wve(e){setTimeout(function(){throw e})}function SD(e,t){var r=t,n=0;do{var i=r.nextSibling;if(e.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){e.removeChild(i),l1(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);l1(t)}function mh(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function X6(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var Hb=Math.random().toString(36).slice(2),du="__reactFiber$"+Hb,d1="__reactProps$"+Hb,Uc="__reactContainer$"+Hb,QN="__reactEvents$"+Hb,Gve="__reactListeners$"+Hb,Yve="__reactHandles$"+Hb;function gp(e){var t=e[du];if(t)return t;for(var r=e.parentNode;r;){if(t=r[Uc]||r[du]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=X6(e);e!==null;){if(r=e[du])return r;e=X6(e)}return t}e=r,r=e.parentNode}return null}function LC(e){return e=e[du]||e[Uc],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function jy(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Zt(33))}function tI(e){return e[d1]||null}var eB=[],Fy=-1;function Vh(e){return{current:e}}function vi(e){0>Fy||(e.current=eB[Fy],eB[Fy]=null,Fy--)}function di(e,t){Fy++,eB[Fy]=e.current,e.current=t}var Lh={},ra=Vh(Lh),Ha=Vh(!1),rm=Lh;function _v(e,t){var r=e.type.contextTypes;if(!r)return Lh;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var i={},o;for(o in r)i[o]=t[o];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function Va(e){return e=e.childContextTypes,e!=null}function hP(){vi(Ha),vi(ra)}function Z6(e,t,r){if(ra.current!==Lh)throw Error(Zt(168));di(ra,t),di(Ha,r)}function Hne(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in t))throw Error(Zt(108,Aye(e)||"Unknown",i));return Bi({},r,n)}function dP(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Lh,rm=ra.current,di(ra,e),di(Ha,Ha.current),!0}function J6(e,t,r){var n=e.stateNode;if(!n)throw Error(Zt(169));r?(e=Hne(e,t,rm),n.__reactInternalMemoizedMergedChildContext=e,vi(Ha),vi(ra),di(ra,e)):vi(Ha),di(Ha,r)}var oc=null,rI=!1,xD=!1;function Vne(e){oc===null?oc=[e]:oc.push(e)}function Kve(e){rI=!0,Vne(e)}function Uh(){if(!xD&&oc!==null){xD=!0;var e=0,t=ti;try{var r=oc;for(ti=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}oc=null,rI=!1}catch(i){throw oc!==null&&(oc=oc.slice(e+1)),pne(VH,Uh),i}finally{ti=t,xD=!1}}return null}var zy=[],Hy=0,pP=null,mP=0,Ms=[],$s=0,nm=null,uc=1,cc="";function lp(e,t){zy[Hy++]=mP,zy[Hy++]=pP,pP=e,mP=t}function Une(e,t,r){Ms[$s++]=uc,Ms[$s++]=cc,Ms[$s++]=nm,nm=e;var n=uc;e=cc;var i=32-Cl(n)-1;n&=~(1<<i),r+=1;var o=32-Cl(t)+i;if(30<o){var s=i-i%5;o=(n&(1<<s)-1).toString(32),n>>=s,i-=s,uc=1<<32-Cl(t)+i|r<<i|n,cc=o+e}else uc=1<<o|r<<i|n,cc=e}function JH(e){e.return!==null&&(lp(e,1),Une(e,1,0))}function QH(e){for(;e===pP;)pP=zy[--Hy],zy[Hy]=null,mP=zy[--Hy],zy[Hy]=null;for(;e===nm;)nm=Ms[--$s],Ms[$s]=null,cc=Ms[--$s],Ms[$s]=null,uc=Ms[--$s],Ms[$s]=null}var cs=null,ls=null,Oi=!1,_l=null;function Wne(e,t){var r=Ns(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function Q6(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,cs=e,ls=mh(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,cs=e,ls=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=nm!==null?{id:uc,overflow:cc}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=Ns(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,cs=e,ls=null,!0):!1;default:return!1}}function tB(e){return(e.mode&1)!==0&&(e.flags&128)===0}function rB(e){if(Oi){var t=ls;if(t){var r=t;if(!Q6(e,t)){if(tB(e))throw Error(Zt(418));t=mh(r.nextSibling);var n=cs;t&&Q6(e,t)?Wne(n,r):(e.flags=e.flags&-4097|2,Oi=!1,cs=e)}}else{if(tB(e))throw Error(Zt(418));e.flags=e.flags&-4097|2,Oi=!1,cs=e}}}function e8(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;cs=e}function kO(e){if(e!==cs)return!1;if(!Oi)return e8(e),Oi=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!ZN(e.type,e.memoizedProps)),t&&(t=ls)){if(tB(e))throw Gne(),Error(Zt(418));for(;t;)Wne(e,t),t=mh(t.nextSibling)}if(e8(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Zt(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){ls=mh(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}ls=null}}else ls=cs?mh(e.stateNode.nextSibling):null;return!0}function Gne(){for(var e=ls;e;)e=mh(e.nextSibling)}function bv(){ls=cs=null,Oi=!1}function e3(e){_l===null?_l=[e]:_l.push(e)}var qve=Qc.ReactCurrentBatchConfig;function ml(e,t){if(e&&e.defaultProps){t=Bi({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}var gP=Vh(null),yP=null,Vy=null,t3=null;function r3(){t3=Vy=yP=null}function n3(e){var t=gP.current;vi(gP),e._currentValue=t}function nB(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function rv(e,t){yP=e,t3=Vy=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Fa=!0),e.firstContext=null)}function zs(e){var t=e._currentValue;if(t3!==e)if(e={context:e,memoizedValue:t,next:null},Vy===null){if(yP===null)throw Error(Zt(308));Vy=e,yP.dependencies={lanes:0,firstContext:e}}else Vy=Vy.next=e;return t}var yp=null;function i3(e){yp===null?yp=[e]:yp.push(e)}function Yne(e,t,r,n){var i=t.interleaved;return i===null?(r.next=r,i3(t)):(r.next=i.next,i.next=r),t.interleaved=r,Wc(e,n)}function Wc(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var Qf=!1;function o3(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Kne(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Nc(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function gh(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,Ln&2){var i=n.pending;return i===null?t.next=t:(t.next=i.next,i.next=t),n.pending=t,Wc(e,r)}return i=n.interleaved,i===null?(t.next=t,i3(n)):(t.next=i.next,i.next=t),n.interleaved=t,Wc(e,r)}function ik(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,UH(e,r)}}function t8(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,o=null;if(r=r.firstBaseUpdate,r!==null){do{var s={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};o===null?i=o=s:o=o.next=s,r=r.next}while(r!==null);o===null?i=o=t:o=o.next=t}else i=o=t;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:o,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function vP(e,t,r,n){var i=e.updateQueue;Qf=!1;var o=i.firstBaseUpdate,s=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var h=a,p=h.next;h.next=null,s===null?o=p:s.next=p,s=h;var y=e.alternate;y!==null&&(y=y.updateQueue,a=y.lastBaseUpdate,a!==s&&(a===null?y.firstBaseUpdate=p:a.next=p,y.lastBaseUpdate=h))}if(o!==null){var S=i.baseState;s=0,y=p=h=null,a=o;do{var E=a.lane,O=a.eventTime;if((n&E)===E){y!==null&&(y=y.next={eventTime:O,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var A=e,$=a;switch(E=t,O=r,$.tag){case 1:if(A=$.payload,typeof A=="function"){S=A.call(O,S,E);break e}S=A;break e;case 3:A.flags=A.flags&-65537|128;case 0:if(A=$.payload,E=typeof A=="function"?A.call(O,S,E):A,E==null)break e;S=Bi({},S,E);break e;case 2:Qf=!0}}a.callback!==null&&a.lane!==0&&(e.flags|=64,E=i.effects,E===null?i.effects=[a]:E.push(a))}else O={eventTime:O,lane:E,tag:a.tag,payload:a.payload,callback:a.callback,next:null},y===null?(p=y=O,h=S):y=y.next=O,s|=E;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;E=a,a=E.next,E.next=null,i.lastBaseUpdate=E,i.shared.pending=null}}while(1);if(y===null&&(h=S),i.baseState=h,i.firstBaseUpdate=p,i.lastBaseUpdate=y,t=i.shared.interleaved,t!==null){i=t;do s|=i.lane,i=i.next;while(i!==t)}else o===null&&(i.shared.lanes=0);om|=s,e.lanes=s,e.memoizedState=S}}function r8(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(Zt(191,i));i.call(n)}}}var qne=new Yre.Component().refs;function iB(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:Bi({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var nI={isMounted:function(e){return(e=e._reactInternals)?Cm(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=ya(),i=vh(e),o=Nc(n,i);o.payload=t,r!=null&&(o.callback=r),t=gh(e,o,i),t!==null&&(El(t,e,i,n),ik(t,e,i))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=ya(),i=vh(e),o=Nc(n,i);o.tag=1,o.payload=t,r!=null&&(o.callback=r),t=gh(e,o,i),t!==null&&(El(t,e,i,n),ik(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=ya(),n=vh(e),i=Nc(r,n);i.tag=2,t!=null&&(i.callback=t),t=gh(e,i,n),t!==null&&(El(t,e,n,r),ik(t,e,n))}};function n8(e,t,r,n,i,o,s){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,o,s):t.prototype&&t.prototype.isPureReactComponent?!c1(r,n)||!c1(i,o):!0}function Xne(e,t,r){var n=!1,i=Lh,o=t.contextType;return typeof o=="object"&&o!==null?o=zs(o):(i=Va(t)?rm:ra.current,n=t.contextTypes,o=(n=n!=null)?_v(e,i):Lh),t=new t(r,o),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=nI,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=o),t}function i8(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&nI.enqueueReplaceState(t,t.state,null)}function oB(e,t,r,n){var i=e.stateNode;i.props=r,i.state=e.memoizedState,i.refs=qne,o3(e);var o=t.contextType;typeof o=="object"&&o!==null?i.context=zs(o):(o=Va(t)?rm:ra.current,i.context=_v(e,o)),i.state=e.memoizedState,o=t.getDerivedStateFromProps,typeof o=="function"&&(iB(e,t,o,r),i.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(t=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),t!==i.state&&nI.enqueueReplaceState(i,i.state,null),vP(e,r,i,n),i.state=e.memoizedState),typeof i.componentDidMount=="function"&&(e.flags|=4194308)}function L0(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Zt(309));var n=r.stateNode}if(!n)throw Error(Zt(147,e));var i=n,o=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===o?t.ref:(t=function(s){var a=i.refs;a===qne&&(a=i.refs={}),s===null?delete a[o]:a[o]=s},t._stringRef=o,t)}if(typeof e!="string")throw Error(Zt(284));if(!r._owner)throw Error(Zt(290,e))}return e}function PO(e,t){throw e=Object.prototype.toString.call(t),Error(Zt(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function o8(e){var t=e._init;return t(e._payload)}function Zne(e){function t(j,z){if(e){var W=j.deletions;W===null?(j.deletions=[z],j.flags|=16):W.push(z)}}function r(j,z){if(!e)return null;for(;z!==null;)t(j,z),z=z.sibling;return null}function n(j,z){for(j=new Map;z!==null;)z.key!==null?j.set(z.key,z):j.set(z.index,z),z=z.sibling;return j}function i(j,z){return j=_h(j,z),j.index=0,j.sibling=null,j}function o(j,z,W){return j.index=W,e?(W=j.alternate,W!==null?(W=W.index,W<z?(j.flags|=2,z):W):(j.flags|=2,z)):(j.flags|=1048576,z)}function s(j){return e&&j.alternate===null&&(j.flags|=2),j}function a(j,z,W,Q){return z===null||z.tag!==6?(z=PD(W,j.mode,Q),z.return=j,z):(z=i(z,W),z.return=j,z)}function h(j,z,W,Q){var q=W.type;return q===Dy?y(j,z,W.props.children,Q,W.key):z!==null&&(z.elementType===q||typeof q=="object"&&q!==null&&q.$$typeof===Jf&&o8(q)===z.type)?(Q=i(z,W.props),Q.ref=L0(j,z,W),Q.return=j,Q):(Q=ck(W.type,W.key,W.props,null,j.mode,Q),Q.ref=L0(j,z,W),Q.return=j,Q)}function p(j,z,W,Q){return z===null||z.tag!==4||z.stateNode.containerInfo!==W.containerInfo||z.stateNode.implementation!==W.implementation?(z=AD(W,j.mode,Q),z.return=j,z):(z=i(z,W.children||[]),z.return=j,z)}function y(j,z,W,Q,q){return z===null||z.tag!==7?(z=qp(W,j.mode,Q,q),z.return=j,z):(z=i(z,W),z.return=j,z)}function S(j,z,W){if(typeof z=="string"&&z!==""||typeof z=="number")return z=PD(""+z,j.mode,W),z.return=j,z;if(typeof z=="object"&&z!==null){switch(z.$$typeof){case _O:return W=ck(z.type,z.key,z.props,null,j.mode,W),W.ref=L0(j,null,z),W.return=j,W;case $y:return z=AD(z,j.mode,W),z.return=j,z;case Jf:var Q=z._init;return S(j,Q(z._payload),W)}if(_S(z)||A0(z))return z=qp(z,j.mode,W,null),z.return=j,z;PO(j,z)}return null}function E(j,z,W,Q){var q=z!==null?z.key:null;if(typeof W=="string"&&W!==""||typeof W=="number")return q!==null?null:a(j,z,""+W,Q);if(typeof W=="object"&&W!==null){switch(W.$$typeof){case _O:return W.key===q?h(j,z,W,Q):null;case $y:return W.key===q?p(j,z,W,Q):null;case Jf:return q=W._init,E(j,z,q(W._payload),Q)}if(_S(W)||A0(W))return q!==null?null:y(j,z,W,Q,null);PO(j,W)}return null}function O(j,z,W,Q,q){if(typeof Q=="string"&&Q!==""||typeof Q=="number")return j=j.get(W)||null,a(z,j,""+Q,q);if(typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case _O:return j=j.get(Q.key===null?W:Q.key)||null,h(z,j,Q,q);case $y:return j=j.get(Q.key===null?W:Q.key)||null,p(z,j,Q,q);case Jf:var Se=Q._init;return O(j,z,W,Se(Q._payload),q)}if(_S(Q)||A0(Q))return j=j.get(W)||null,y(z,j,Q,q,null);PO(z,Q)}return null}function A(j,z,W,Q){for(var q=null,Se=null,Ie=z,He=z=0,Le=null;Ie!==null&&He<W.length;He++){Ie.index>He?(Le=Ie,Ie=null):Le=Ie.sibling;var ze=E(j,Ie,W[He],Q);if(ze===null){Ie===null&&(Ie=Le);break}e&&Ie&&ze.alternate===null&&t(j,Ie),z=o(ze,z,He),Se===null?q=ze:Se.sibling=ze,Se=ze,Ie=Le}if(He===W.length)return r(j,Ie),Oi&&lp(j,He),q;if(Ie===null){for(;He<W.length;He++)Ie=S(j,W[He],Q),Ie!==null&&(z=o(Ie,z,He),Se===null?q=Ie:Se.sibling=Ie,Se=Ie);return Oi&&lp(j,He),q}for(Ie=n(j,Ie);He<W.length;He++)Le=O(Ie,j,He,W[He],Q),Le!==null&&(e&&Le.alternate!==null&&Ie.delete(Le.key===null?He:Le.key),z=o(Le,z,He),Se===null?q=Le:Se.sibling=Le,Se=Le);return e&&Ie.forEach(function(ct){return t(j,ct)}),Oi&&lp(j,He),q}function $(j,z,W,Q){var q=A0(W);if(typeof q!="function")throw Error(Zt(150));if(W=q.call(W),W==null)throw Error(Zt(151));for(var Se=q=null,Ie=z,He=z=0,Le=null,ze=W.next();Ie!==null&&!ze.done;He++,ze=W.next()){Ie.index>He?(Le=Ie,Ie=null):Le=Ie.sibling;var ct=E(j,Ie,ze.value,Q);if(ct===null){Ie===null&&(Ie=Le);break}e&&Ie&&ct.alternate===null&&t(j,Ie),z=o(ct,z,He),Se===null?q=ct:Se.sibling=ct,Se=ct,Ie=Le}if(ze.done)return r(j,Ie),Oi&&lp(j,He),q;if(Ie===null){for(;!ze.done;He++,ze=W.next())ze=S(j,ze.value,Q),ze!==null&&(z=o(ze,z,He),Se===null?q=ze:Se.sibling=ze,Se=ze);return Oi&&lp(j,He),q}for(Ie=n(j,Ie);!ze.done;He++,ze=W.next())ze=O(Ie,j,He,ze.value,Q),ze!==null&&(e&&ze.alternate!==null&&Ie.delete(ze.key===null?He:ze.key),z=o(ze,z,He),Se===null?q=ze:Se.sibling=ze,Se=ze);return e&&Ie.forEach(function(At){return t(j,At)}),Oi&&lp(j,He),q}function B(j,z,W,Q){if(typeof W=="object"&&W!==null&&W.type===Dy&&W.key===null&&(W=W.props.children),typeof W=="object"&&W!==null){switch(W.$$typeof){case _O:e:{for(var q=W.key,Se=z;Se!==null;){if(Se.key===q){if(q=W.type,q===Dy){if(Se.tag===7){r(j,Se.sibling),z=i(Se,W.props.children),z.return=j,j=z;break e}}else if(Se.elementType===q||typeof q=="object"&&q!==null&&q.$$typeof===Jf&&o8(q)===Se.type){r(j,Se.sibling),z=i(Se,W.props),z.ref=L0(j,Se,W),z.return=j,j=z;break e}r(j,Se);break}else t(j,Se);Se=Se.sibling}W.type===Dy?(z=qp(W.props.children,j.mode,Q,W.key),z.return=j,j=z):(Q=ck(W.type,W.key,W.props,null,j.mode,Q),Q.ref=L0(j,z,W),Q.return=j,j=Q)}return s(j);case $y:e:{for(Se=W.key;z!==null;){if(z.key===Se)if(z.tag===4&&z.stateNode.containerInfo===W.containerInfo&&z.stateNode.implementation===W.implementation){r(j,z.sibling),z=i(z,W.children||[]),z.return=j,j=z;break e}else{r(j,z);break}else t(j,z);z=z.sibling}z=AD(W,j.mode,Q),z.return=j,j=z}return s(j);case Jf:return Se=W._init,B(j,z,Se(W._payload),Q)}if(_S(W))return A(j,z,W,Q);if(A0(W))return $(j,z,W,Q);PO(j,W)}return typeof W=="string"&&W!==""||typeof W=="number"?(W=""+W,z!==null&&z.tag===6?(r(j,z.sibling),z=i(z,W),z.return=j,j=z):(r(j,z),z=PD(W,j.mode,Q),z.return=j,j=z),s(j)):r(j,z)}return B}var wv=Zne(!0),Jne=Zne(!1),NC={},vu=Vh(NC),p1=Vh(NC),m1=Vh(NC);function vp(e){if(e===NC)throw Error(Zt(174));return e}function a3(e,t){switch(di(m1,t),di(p1,e),di(vu,NC),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:NN(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=NN(t,e)}vi(vu),di(vu,t)}function Sv(){vi(vu),vi(p1),vi(m1)}function Qne(e){vp(m1.current);var t=vp(vu.current),r=NN(t,e.type);t!==r&&(di(p1,e),di(vu,r))}function s3(e){p1.current===e&&(vi(vu),vi(p1))}var Mi=Vh(0);function _P(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var CD=[];function l3(){for(var e=0;e<CD.length;e++)CD[e]._workInProgressVersionPrimary=null;CD.length=0}var ok=Qc.ReactCurrentDispatcher,ED=Qc.ReactCurrentBatchConfig,im=0,Li=null,go=null,Po=null,bP=!1,$S=!1,g1=0,Xve=0;function Xo(){throw Error(Zt(321))}function u3(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Tl(e[r],t[r]))return!1;return!0}function c3(e,t,r,n,i,o){if(im=o,Li=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ok.current=e===null||e.memoizedState===null?e_e:t_e,e=r(n,i),$S){o=0;do{if($S=!1,g1=0,25<=o)throw Error(Zt(301));o+=1,Po=go=null,t.updateQueue=null,ok.current=r_e,e=r(n,i)}while($S)}if(ok.current=wP,t=go!==null&&go.next!==null,im=0,Po=go=Li=null,bP=!1,t)throw Error(Zt(300));return e}function f3(){var e=g1!==0;return g1=0,e}function cu(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Po===null?Li.memoizedState=Po=e:Po=Po.next=e,Po}function Hs(){if(go===null){var e=Li.alternate;e=e!==null?e.memoizedState:null}else e=go.next;var t=Po===null?Li.memoizedState:Po.next;if(t!==null)Po=t,go=e;else{if(e===null)throw Error(Zt(310));go=e,e={memoizedState:go.memoizedState,baseState:go.baseState,baseQueue:go.baseQueue,queue:go.queue,next:null},Po===null?Li.memoizedState=Po=e:Po=Po.next=e}return Po}function y1(e,t){return typeof t=="function"?t(e):t}function TD(e){var t=Hs(),r=t.queue;if(r===null)throw Error(Zt(311));r.lastRenderedReducer=e;var n=go,i=n.baseQueue,o=r.pending;if(o!==null){if(i!==null){var s=i.next;i.next=o.next,o.next=s}n.baseQueue=i=o,r.pending=null}if(i!==null){o=i.next,n=n.baseState;var a=s=null,h=null,p=o;do{var y=p.lane;if((im&y)===y)h!==null&&(h=h.next={lane:0,action:p.action,hasEagerState:p.hasEagerState,eagerState:p.eagerState,next:null}),n=p.hasEagerState?p.eagerState:e(n,p.action);else{var S={lane:y,action:p.action,hasEagerState:p.hasEagerState,eagerState:p.eagerState,next:null};h===null?(a=h=S,s=n):h=h.next=S,Li.lanes|=y,om|=y}p=p.next}while(p!==null&&p!==o);h===null?s=n:h.next=a,Tl(n,t.memoizedState)||(Fa=!0),t.memoizedState=n,t.baseState=s,t.baseQueue=h,r.lastRenderedState=n}if(e=r.interleaved,e!==null){i=e;do o=i.lane,Li.lanes|=o,om|=o,i=i.next;while(i!==e)}else i===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function OD(e){var t=Hs(),r=t.queue;if(r===null)throw Error(Zt(311));r.lastRenderedReducer=e;var n=r.dispatch,i=r.pending,o=t.memoizedState;if(i!==null){r.pending=null;var s=i=i.next;do o=e(o,s.action),s=s.next;while(s!==i);Tl(o,t.memoizedState)||(Fa=!0),t.memoizedState=o,t.baseQueue===null&&(t.baseState=o),r.lastRenderedState=o}return[o,n]}function eie(){}function tie(e,t){var r=Li,n=Hs(),i=t(),o=!Tl(n.memoizedState,i);if(o&&(n.memoizedState=i,Fa=!0),n=n.queue,h3(iie.bind(null,r,n,e),[e]),n.getSnapshot!==t||o||Po!==null&&Po.memoizedState.tag&1){if(r.flags|=2048,v1(9,nie.bind(null,r,n,i,t),void 0,null),Io===null)throw Error(Zt(349));im&30||rie(r,t,i)}return i}function rie(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=Li.updateQueue,t===null?(t={lastEffect:null,stores:null},Li.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function nie(e,t,r,n){t.value=r,t.getSnapshot=n,oie(t)&&aie(e)}function iie(e,t,r){return r(function(){oie(t)&&aie(e)})}function oie(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Tl(e,r)}catch{return!0}}function aie(e){var t=Wc(e,1);t!==null&&El(t,e,1,-1)}function a8(e){var t=cu();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:y1,lastRenderedState:e},t.queue=e,e=e.dispatch=Qve.bind(null,Li,e),[t.memoizedState,e]}function v1(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=Li.updateQueue,t===null?(t={lastEffect:null,stores:null},Li.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function sie(){return Hs().memoizedState}function ak(e,t,r,n){var i=cu();Li.flags|=e,i.memoizedState=v1(1|t,r,void 0,n===void 0?null:n)}function iI(e,t,r,n){var i=Hs();n=n===void 0?null:n;var o=void 0;if(go!==null){var s=go.memoizedState;if(o=s.destroy,n!==null&&u3(n,s.deps)){i.memoizedState=v1(t,r,o,n);return}}Li.flags|=e,i.memoizedState=v1(1|t,r,o,n)}function s8(e,t){return ak(8390656,8,e,t)}function h3(e,t){return iI(2048,8,e,t)}function lie(e,t){return iI(4,2,e,t)}function uie(e,t){return iI(4,4,e,t)}function cie(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function fie(e,t,r){return r=r!=null?r.concat([e]):null,iI(4,4,cie.bind(null,t,e),r)}function d3(){}function hie(e,t){var r=Hs();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&u3(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function die(e,t){var r=Hs();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&u3(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function pie(e,t,r){return im&21?(Tl(r,t)||(r=yne(),Li.lanes|=r,om|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Fa=!0),e.memoizedState=r)}function Zve(e,t){var r=ti;ti=r!==0&&4>r?r:4,e(!0);var n=ED.transition;ED.transition={};try{e(!1),t()}finally{ti=r,ED.transition=n}}function mie(){return Hs().memoizedState}function Jve(e,t,r){var n=vh(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},gie(e))yie(t,r);else if(r=Yne(e,t,r,n),r!==null){var i=ya();El(r,e,n,i),vie(r,t,n)}}function Qve(e,t,r){var n=vh(e),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(gie(e))yie(t,i);else{var o=e.alternate;if(e.lanes===0&&(o===null||o.lanes===0)&&(o=t.lastRenderedReducer,o!==null))try{var s=t.lastRenderedState,a=o(s,r);if(i.hasEagerState=!0,i.eagerState=a,Tl(a,s)){var h=t.interleaved;h===null?(i.next=i,i3(t)):(i.next=h.next,h.next=i),t.interleaved=i;return}}catch{}finally{}r=Yne(e,t,i,n),r!==null&&(i=ya(),El(r,e,n,i),vie(r,t,n))}}function gie(e){var t=e.alternate;return e===Li||t!==null&&t===Li}function yie(e,t){$S=bP=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function vie(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,UH(e,r)}}var wP={readContext:zs,useCallback:Xo,useContext:Xo,useEffect:Xo,useImperativeHandle:Xo,useInsertionEffect:Xo,useLayoutEffect:Xo,useMemo:Xo,useReducer:Xo,useRef:Xo,useState:Xo,useDebugValue:Xo,useDeferredValue:Xo,useTransition:Xo,useMutableSource:Xo,useSyncExternalStore:Xo,useId:Xo,unstable_isNewReconciler:!1},e_e={readContext:zs,useCallback:function(e,t){return cu().memoizedState=[e,t===void 0?null:t],e},useContext:zs,useEffect:s8,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,ak(4194308,4,cie.bind(null,t,e),r)},useLayoutEffect:function(e,t){return ak(4194308,4,e,t)},useInsertionEffect:function(e,t){return ak(4,2,e,t)},useMemo:function(e,t){var r=cu();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=cu();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=Jve.bind(null,Li,e),[n.memoizedState,e]},useRef:function(e){var t=cu();return e={current:e},t.memoizedState=e},useState:a8,useDebugValue:d3,useDeferredValue:function(e){return cu().memoizedState=e},useTransition:function(){var e=a8(!1),t=e[0];return e=Zve.bind(null,e[1]),cu().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=Li,i=cu();if(Oi){if(r===void 0)throw Error(Zt(407));r=r()}else{if(r=t(),Io===null)throw Error(Zt(349));im&30||rie(n,t,r)}i.memoizedState=r;var o={value:r,getSnapshot:t};return i.queue=o,s8(iie.bind(null,n,o,e),[e]),n.flags|=2048,v1(9,nie.bind(null,n,o,r,t),void 0,null),r},useId:function(){var e=cu(),t=Io.identifierPrefix;if(Oi){var r=cc,n=uc;r=(n&~(1<<32-Cl(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=g1++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=Xve++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},t_e={readContext:zs,useCallback:hie,useContext:zs,useEffect:h3,useImperativeHandle:fie,useInsertionEffect:lie,useLayoutEffect:uie,useMemo:die,useReducer:TD,useRef:sie,useState:function(){return TD(y1)},useDebugValue:d3,useDeferredValue:function(e){var t=Hs();return pie(t,go.memoizedState,e)},useTransition:function(){var e=TD(y1)[0],t=Hs().memoizedState;return[e,t]},useMutableSource:eie,useSyncExternalStore:tie,useId:mie,unstable_isNewReconciler:!1},r_e={readContext:zs,useCallback:hie,useContext:zs,useEffect:h3,useImperativeHandle:fie,useInsertionEffect:lie,useLayoutEffect:uie,useMemo:die,useReducer:OD,useRef:sie,useState:function(){return OD(y1)},useDebugValue:d3,useDeferredValue:function(e){var t=Hs();return go===null?t.memoizedState=e:pie(t,go.memoizedState,e)},useTransition:function(){var e=OD(y1)[0],t=Hs().memoizedState;return[e,t]},useMutableSource:eie,useSyncExternalStore:tie,useId:mie,unstable_isNewReconciler:!1};function xv(e,t){try{var r="",n=t;do r+=Pye(n),n=n.return;while(n);var i=r}catch(o){i=`
Error generating stack: `+o.message+`
`+o.stack}return{value:e,source:t,stack:i,digest:null}}function RD(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function aB(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var n_e=typeof WeakMap=="function"?WeakMap:Map;function _ie(e,t,r){r=Nc(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){xP||(xP=!0,gB=n),aB(e,t)},r}function bie(e,t,r){r=Nc(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var i=t.value;r.payload=function(){return n(i)},r.callback=function(){aB(e,t)}}var o=e.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(r.callback=function(){aB(e,t),typeof n!="function"&&(yh===null?yh=new Set([this]):yh.add(this));var s=t.stack;this.componentDidCatch(t.value,{componentStack:s!==null?s:""})}),r}function l8(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new n_e;var i=new Set;n.set(t,i)}else i=n.get(t),i===void 0&&(i=new Set,n.set(t,i));i.has(r)||(i.add(r),e=y_e.bind(null,e,t,r),t.then(e,e))}function u8(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function c8(e,t,r,n,i){return e.mode&1?(e.flags|=65536,e.lanes=i,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=Nc(-1,1),t.tag=2,gh(r,t,1))),r.lanes|=1),e)}var i_e=Qc.ReactCurrentOwner,Fa=!1;function ma(e,t,r,n){t.child=e===null?Jne(t,null,r,n):wv(t,e.child,r,n)}function f8(e,t,r,n,i){r=r.render;var o=t.ref;return rv(t,i),n=c3(e,t,r,n,o,i),r=f3(),e!==null&&!Fa?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Gc(e,t,i)):(Oi&&r&&JH(t),t.flags|=1,ma(e,t,n,i),t.child)}function h8(e,t,r,n,i){if(e===null){var o=r.type;return typeof o=="function"&&!w3(o)&&o.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=o,wie(e,t,o,n,i)):(e=ck(r.type,null,n,t,t.mode,i),e.ref=t.ref,e.return=t,t.child=e)}if(o=e.child,!(e.lanes&i)){var s=o.memoizedProps;if(r=r.compare,r=r!==null?r:c1,r(s,n)&&e.ref===t.ref)return Gc(e,t,i)}return t.flags|=1,e=_h(o,n),e.ref=t.ref,e.return=t,t.child=e}function wie(e,t,r,n,i){if(e!==null){var o=e.memoizedProps;if(c1(o,n)&&e.ref===t.ref)if(Fa=!1,t.pendingProps=n=o,(e.lanes&i)!==0)e.flags&131072&&(Fa=!0);else return t.lanes=e.lanes,Gc(e,t,i)}return sB(e,t,r,n,i)}function Sie(e,t,r){var n=t.pendingProps,i=n.children,o=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},di(Wy,os),os|=r;else{if(!(r&1073741824))return e=o!==null?o.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,di(Wy,os),os|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=o!==null?o.baseLanes:r,di(Wy,os),os|=n}else o!==null?(n=o.baseLanes|r,t.memoizedState=null):n=r,di(Wy,os),os|=n;return ma(e,t,i,r),t.child}function xie(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function sB(e,t,r,n,i){var o=Va(r)?rm:ra.current;return o=_v(t,o),rv(t,i),r=c3(e,t,r,n,o,i),n=f3(),e!==null&&!Fa?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Gc(e,t,i)):(Oi&&n&&JH(t),t.flags|=1,ma(e,t,r,i),t.child)}function d8(e,t,r,n,i){if(Va(r)){var o=!0;dP(t)}else o=!1;if(rv(t,i),t.stateNode===null)sk(e,t),Xne(t,r,n),oB(t,r,n,i),n=!0;else if(e===null){var s=t.stateNode,a=t.memoizedProps;s.props=a;var h=s.context,p=r.contextType;typeof p=="object"&&p!==null?p=zs(p):(p=Va(r)?rm:ra.current,p=_v(t,p));var y=r.getDerivedStateFromProps,S=typeof y=="function"||typeof s.getSnapshotBeforeUpdate=="function";S||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(a!==n||h!==p)&&i8(t,s,n,p),Qf=!1;var E=t.memoizedState;s.state=E,vP(t,n,s,i),h=t.memoizedState,a!==n||E!==h||Ha.current||Qf?(typeof y=="function"&&(iB(t,r,y,n),h=t.memoizedState),(a=Qf||n8(t,r,a,n,E,h,p))?(S||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount()),typeof s.componentDidMount=="function"&&(t.flags|=4194308)):(typeof s.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=h),s.props=n,s.state=h,s.context=p,n=a):(typeof s.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{s=t.stateNode,Kne(e,t),a=t.memoizedProps,p=t.type===t.elementType?a:ml(t.type,a),s.props=p,S=t.pendingProps,E=s.context,h=r.contextType,typeof h=="object"&&h!==null?h=zs(h):(h=Va(r)?rm:ra.current,h=_v(t,h));var O=r.getDerivedStateFromProps;(y=typeof O=="function"||typeof s.getSnapshotBeforeUpdate=="function")||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(a!==S||E!==h)&&i8(t,s,n,h),Qf=!1,E=t.memoizedState,s.state=E,vP(t,n,s,i);var A=t.memoizedState;a!==S||E!==A||Ha.current||Qf?(typeof O=="function"&&(iB(t,r,O,n),A=t.memoizedState),(p=Qf||n8(t,r,p,n,E,A,h)||!1)?(y||typeof s.UNSAFE_componentWillUpdate!="function"&&typeof s.componentWillUpdate!="function"||(typeof s.componentWillUpdate=="function"&&s.componentWillUpdate(n,A,h),typeof s.UNSAFE_componentWillUpdate=="function"&&s.UNSAFE_componentWillUpdate(n,A,h)),typeof s.componentDidUpdate=="function"&&(t.flags|=4),typeof s.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof s.componentDidUpdate!="function"||a===e.memoizedProps&&E===e.memoizedState||(t.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||a===e.memoizedProps&&E===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=A),s.props=n,s.state=A,s.context=h,n=p):(typeof s.componentDidUpdate!="function"||a===e.memoizedProps&&E===e.memoizedState||(t.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||a===e.memoizedProps&&E===e.memoizedState||(t.flags|=1024),n=!1)}return lB(e,t,r,n,o,i)}function lB(e,t,r,n,i,o){xie(e,t);var s=(t.flags&128)!==0;if(!n&&!s)return i&&J6(t,r,!1),Gc(e,t,o);n=t.stateNode,i_e.current=t;var a=s&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&s?(t.child=wv(t,e.child,null,o),t.child=wv(t,null,a,o)):ma(e,t,a,o),t.memoizedState=n.state,i&&J6(t,r,!0),t.child}function Cie(e){var t=e.stateNode;t.pendingContext?Z6(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Z6(e,t.context,!1),a3(e,t.containerInfo)}function p8(e,t,r,n,i){return bv(),e3(i),t.flags|=256,ma(e,t,r,n),t.child}var uB={dehydrated:null,treeContext:null,retryLane:0};function cB(e){return{baseLanes:e,cachePool:null,transitions:null}}function Eie(e,t,r){var n=t.pendingProps,i=Mi.current,o=!1,s=(t.flags&128)!==0,a;if((a=s)||(a=e!==null&&e.memoizedState===null?!1:(i&2)!==0),a?(o=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(i|=1),di(Mi,i&1),e===null)return rB(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(s=n.children,e=n.fallback,o?(n=t.mode,o=t.child,s={mode:"hidden",children:s},!(n&1)&&o!==null?(o.childLanes=0,o.pendingProps=s):o=sI(s,n,0,null),e=qp(e,n,r,null),o.return=t,e.return=t,o.sibling=e,t.child=o,t.child.memoizedState=cB(r),t.memoizedState=uB,e):p3(t,s));if(i=e.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return o_e(e,t,s,n,a,i,r);if(o){o=n.fallback,s=t.mode,i=e.child,a=i.sibling;var h={mode:"hidden",children:n.children};return!(s&1)&&t.child!==i?(n=t.child,n.childLanes=0,n.pendingProps=h,t.deletions=null):(n=_h(i,h),n.subtreeFlags=i.subtreeFlags&14680064),a!==null?o=_h(a,o):(o=qp(o,s,r,null),o.flags|=2),o.return=t,n.return=t,n.sibling=o,t.child=n,n=o,o=t.child,s=e.child.memoizedState,s=s===null?cB(r):{baseLanes:s.baseLanes|r,cachePool:null,transitions:s.transitions},o.memoizedState=s,o.childLanes=e.childLanes&~r,t.memoizedState=uB,n}return o=e.child,e=o.sibling,n=_h(o,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function p3(e,t){return t=sI({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function AO(e,t,r,n){return n!==null&&e3(n),wv(t,e.child,null,r),e=p3(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function o_e(e,t,r,n,i,o,s){if(r)return t.flags&256?(t.flags&=-257,n=RD(Error(Zt(422))),AO(e,t,s,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(o=n.fallback,i=t.mode,n=sI({mode:"visible",children:n.children},i,0,null),o=qp(o,i,s,null),o.flags|=2,n.return=t,o.return=t,n.sibling=o,t.child=n,t.mode&1&&wv(t,e.child,null,s),t.child.memoizedState=cB(s),t.memoizedState=uB,o);if(!(t.mode&1))return AO(e,t,s,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var a=n.dgst;return n=a,o=Error(Zt(419)),n=RD(o,n,void 0),AO(e,t,s,n)}if(a=(s&e.childLanes)!==0,Fa||a){if(n=Io,n!==null){switch(s&-s){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|s)?0:i,i!==0&&i!==o.retryLane&&(o.retryLane=i,Wc(e,i),El(n,e,i,-1))}return b3(),n=RD(Error(Zt(421))),AO(e,t,s,n)}return i.data==="$?"?(t.flags|=128,t.child=e.child,t=v_e.bind(null,e),i._reactRetry=t,null):(e=o.treeContext,ls=mh(i.nextSibling),cs=t,Oi=!0,_l=null,e!==null&&(Ms[$s++]=uc,Ms[$s++]=cc,Ms[$s++]=nm,uc=e.id,cc=e.overflow,nm=t),t=p3(t,n.children),t.flags|=4096,t)}function m8(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),nB(e.return,t,r)}function kD(e,t,r,n,i){var o=e.memoizedState;o===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(o.isBackwards=t,o.rendering=null,o.renderingStartTime=0,o.last=n,o.tail=r,o.tailMode=i)}function Tie(e,t,r){var n=t.pendingProps,i=n.revealOrder,o=n.tail;if(ma(e,t,n.children,r),n=Mi.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&m8(e,r,t);else if(e.tag===19)m8(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(di(Mi,n),!(t.mode&1))t.memoizedState=null;else switch(i){case"forwards":for(r=t.child,i=null;r!==null;)e=r.alternate,e!==null&&_P(e)===null&&(i=r),r=r.sibling;r=i,r===null?(i=t.child,t.child=null):(i=r.sibling,r.sibling=null),kD(t,!1,i,r,o);break;case"backwards":for(r=null,i=t.child,t.child=null;i!==null;){if(e=i.alternate,e!==null&&_P(e)===null){t.child=i;break}e=i.sibling,i.sibling=r,r=i,i=e}kD(t,!0,r,null,o);break;case"together":kD(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function sk(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Gc(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),om|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(Zt(153));if(t.child!==null){for(e=t.child,r=_h(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=_h(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function a_e(e,t,r){switch(t.tag){case 3:Cie(t),bv();break;case 5:Qne(t);break;case 1:Va(t.type)&&dP(t);break;case 4:a3(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,i=t.memoizedProps.value;di(gP,n._currentValue),n._currentValue=i;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(di(Mi,Mi.current&1),t.flags|=128,null):r&t.child.childLanes?Eie(e,t,r):(di(Mi,Mi.current&1),e=Gc(e,t,r),e!==null?e.sibling:null);di(Mi,Mi.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return Tie(e,t,r);t.flags|=128}if(i=t.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),di(Mi,Mi.current),n)break;return null;case 22:case 23:return t.lanes=0,Sie(e,t,r)}return Gc(e,t,r)}var Oie,fB,Rie,kie;Oie=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};fB=function(){};Rie=function(e,t,r,n){var i=e.memoizedProps;if(i!==n){e=t.stateNode,vp(vu.current);var o=null;switch(r){case"input":i=MN(e,i),n=MN(e,n),o=[];break;case"select":i=Bi({},i,{value:void 0}),n=Bi({},n,{value:void 0}),o=[];break;case"textarea":i=LN(e,i),n=LN(e,n),o=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=fP)}BN(r,n);var s;r=null;for(p in i)if(!n.hasOwnProperty(p)&&i.hasOwnProperty(p)&&i[p]!=null)if(p==="style"){var a=i[p];for(s in a)a.hasOwnProperty(s)&&(r||(r={}),r[s]="")}else p!=="dangerouslySetInnerHTML"&&p!=="children"&&p!=="suppressContentEditableWarning"&&p!=="suppressHydrationWarning"&&p!=="autoFocus"&&(n1.hasOwnProperty(p)?o||(o=[]):(o=o||[]).push(p,null));for(p in n){var h=n[p];if(a=i!=null?i[p]:void 0,n.hasOwnProperty(p)&&h!==a&&(h!=null||a!=null))if(p==="style")if(a){for(s in a)!a.hasOwnProperty(s)||h&&h.hasOwnProperty(s)||(r||(r={}),r[s]="");for(s in h)h.hasOwnProperty(s)&&a[s]!==h[s]&&(r||(r={}),r[s]=h[s])}else r||(o||(o=[]),o.push(p,r)),r=h;else p==="dangerouslySetInnerHTML"?(h=h?h.__html:void 0,a=a?a.__html:void 0,h!=null&&a!==h&&(o=o||[]).push(p,h)):p==="children"?typeof h!="string"&&typeof h!="number"||(o=o||[]).push(p,""+h):p!=="suppressContentEditableWarning"&&p!=="suppressHydrationWarning"&&(n1.hasOwnProperty(p)?(h!=null&&p==="onScroll"&&yi("scroll",e),o||a===h||(o=[])):(o=o||[]).push(p,h))}r&&(o=o||[]).push("style",r);var p=o;(t.updateQueue=p)&&(t.flags|=4)}};kie=function(e,t,r,n){r!==n&&(t.flags|=4)};function N0(e,t){if(!Oi)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Zo(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=e,i=i.sibling;else for(i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function s_e(e,t,r){var n=t.pendingProps;switch(QH(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Zo(t),null;case 1:return Va(t.type)&&hP(),Zo(t),null;case 3:return n=t.stateNode,Sv(),vi(Ha),vi(ra),l3(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(kO(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,_l!==null&&(_B(_l),_l=null))),fB(e,t),Zo(t),null;case 5:s3(t);var i=vp(m1.current);if(r=t.type,e!==null&&t.stateNode!=null)Rie(e,t,r,n,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(Zt(166));return Zo(t),null}if(e=vp(vu.current),kO(t)){n=t.stateNode,r=t.type;var o=t.memoizedProps;switch(n[du]=t,n[d1]=o,e=(t.mode&1)!==0,r){case"dialog":yi("cancel",n),yi("close",n);break;case"iframe":case"object":case"embed":yi("load",n);break;case"video":case"audio":for(i=0;i<wS.length;i++)yi(wS[i],n);break;case"source":yi("error",n);break;case"img":case"image":case"link":yi("error",n),yi("load",n);break;case"details":yi("toggle",n);break;case"input":C6(n,o),yi("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!o.multiple},yi("invalid",n);break;case"textarea":T6(n,o),yi("invalid",n)}BN(r,o),i=null;for(var s in o)if(o.hasOwnProperty(s)){var a=o[s];s==="children"?typeof a=="string"?n.textContent!==a&&(o.suppressHydrationWarning!==!0&&RO(n.textContent,a,e),i=["children",a]):typeof a=="number"&&n.textContent!==""+a&&(o.suppressHydrationWarning!==!0&&RO(n.textContent,a,e),i=["children",""+a]):n1.hasOwnProperty(s)&&a!=null&&s==="onScroll"&&yi("scroll",n)}switch(r){case"input":bO(n),E6(n,o,!0);break;case"textarea":bO(n),O6(n);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(n.onclick=fP)}n=i,t.updateQueue=n,n!==null&&(t.flags|=4)}else{s=i.nodeType===9?i:i.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=rne(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=s.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=s.createElement(r,{is:n.is}):(e=s.createElement(r),r==="select"&&(s=e,n.multiple?s.multiple=!0:n.size&&(s.size=n.size))):e=s.createElementNS(e,r),e[du]=t,e[d1]=n,Oie(e,t,!1,!1),t.stateNode=e;e:{switch(s=jN(r,n),r){case"dialog":yi("cancel",e),yi("close",e),i=n;break;case"iframe":case"object":case"embed":yi("load",e),i=n;break;case"video":case"audio":for(i=0;i<wS.length;i++)yi(wS[i],e);i=n;break;case"source":yi("error",e),i=n;break;case"img":case"image":case"link":yi("error",e),yi("load",e),i=n;break;case"details":yi("toggle",e),i=n;break;case"input":C6(e,n),i=MN(e,n),yi("invalid",e);break;case"option":i=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},i=Bi({},n,{value:void 0}),yi("invalid",e);break;case"textarea":T6(e,n),i=LN(e,n),yi("invalid",e);break;default:i=n}BN(r,i),a=i;for(o in a)if(a.hasOwnProperty(o)){var h=a[o];o==="style"?one(e,h):o==="dangerouslySetInnerHTML"?(h=h?h.__html:void 0,h!=null&&nne(e,h)):o==="children"?typeof h=="string"?(r!=="textarea"||h!=="")&&i1(e,h):typeof h=="number"&&i1(e,""+h):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(n1.hasOwnProperty(o)?h!=null&&o==="onScroll"&&yi("scroll",e):h!=null&&BH(e,o,h,s))}switch(r){case"input":bO(e),E6(e,n,!1);break;case"textarea":bO(e),O6(e);break;case"option":n.value!=null&&e.setAttribute("value",""+Dh(n.value));break;case"select":e.multiple=!!n.multiple,o=n.value,o!=null?Jy(e,!!n.multiple,o,!1):n.defaultValue!=null&&Jy(e,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(e.onclick=fP)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Zo(t),null;case 6:if(e&&t.stateNode!=null)kie(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(Zt(166));if(r=vp(m1.current),vp(vu.current),kO(t)){if(n=t.stateNode,r=t.memoizedProps,n[du]=t,(o=n.nodeValue!==r)&&(e=cs,e!==null))switch(e.tag){case 3:RO(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&RO(n.nodeValue,r,(e.mode&1)!==0)}o&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[du]=t,t.stateNode=n}return Zo(t),null;case 13:if(vi(Mi),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Oi&&ls!==null&&t.mode&1&&!(t.flags&128))Gne(),bv(),t.flags|=98560,o=!1;else if(o=kO(t),n!==null&&n.dehydrated!==null){if(e===null){if(!o)throw Error(Zt(318));if(o=t.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(Zt(317));o[du]=t}else bv(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Zo(t),o=!1}else _l!==null&&(_B(_l),_l=null),o=!0;if(!o)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||Mi.current&1?yo===0&&(yo=3):b3())),t.updateQueue!==null&&(t.flags|=4),Zo(t),null);case 4:return Sv(),fB(e,t),e===null&&f1(t.stateNode.containerInfo),Zo(t),null;case 10:return n3(t.type._context),Zo(t),null;case 17:return Va(t.type)&&hP(),Zo(t),null;case 19:if(vi(Mi),o=t.memoizedState,o===null)return Zo(t),null;if(n=(t.flags&128)!==0,s=o.rendering,s===null)if(n)N0(o,!1);else{if(yo!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(s=_P(e),s!==null){for(t.flags|=128,N0(o,!1),n=s.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)o=r,e=n,o.flags&=14680066,s=o.alternate,s===null?(o.childLanes=0,o.lanes=e,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=s.childLanes,o.lanes=s.lanes,o.child=s.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=s.memoizedProps,o.memoizedState=s.memoizedState,o.updateQueue=s.updateQueue,o.type=s.type,e=s.dependencies,o.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return di(Mi,Mi.current&1|2),t.child}e=e.sibling}o.tail!==null&&Zi()>Cv&&(t.flags|=128,n=!0,N0(o,!1),t.lanes=4194304)}else{if(!n)if(e=_P(s),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),N0(o,!0),o.tail===null&&o.tailMode==="hidden"&&!s.alternate&&!Oi)return Zo(t),null}else 2*Zi()-o.renderingStartTime>Cv&&r!==1073741824&&(t.flags|=128,n=!0,N0(o,!1),t.lanes=4194304);o.isBackwards?(s.sibling=t.child,t.child=s):(r=o.last,r!==null?r.sibling=s:t.child=s,o.last=s)}return o.tail!==null?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=Zi(),t.sibling=null,r=Mi.current,di(Mi,n?r&1|2:r&1),t):(Zo(t),null);case 22:case 23:return _3(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?os&1073741824&&(Zo(t),t.subtreeFlags&6&&(t.flags|=8192)):Zo(t),null;case 24:return null;case 25:return null}throw Error(Zt(156,t.tag))}function l_e(e,t){switch(QH(t),t.tag){case 1:return Va(t.type)&&hP(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Sv(),vi(Ha),vi(ra),l3(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return s3(t),null;case 13:if(vi(Mi),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(Zt(340));bv()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return vi(Mi),null;case 4:return Sv(),null;case 10:return n3(t.type._context),null;case 22:case 23:return _3(),null;case 24:return null;default:return null}}var IO=!1,Qo=!1,u_e=typeof WeakSet=="function"?WeakSet:Set,xr=null;function Uy(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Wi(e,t,n)}else r.current=null}function hB(e,t,r){try{r()}catch(n){Wi(e,t,n)}}var g8=!1;function c_e(e,t){if(qN=lP,e=Mne(),ZH(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,o=n.focusNode;n=n.focusOffset;try{r.nodeType,o.nodeType}catch{r=null;break e}var s=0,a=-1,h=-1,p=0,y=0,S=e,E=null;t:for(;;){for(var O;S!==r||i!==0&&S.nodeType!==3||(a=s+i),S!==o||n!==0&&S.nodeType!==3||(h=s+n),S.nodeType===3&&(s+=S.nodeValue.length),(O=S.firstChild)!==null;)E=S,S=O;for(;;){if(S===e)break t;if(E===r&&++p===i&&(a=s),E===o&&++y===n&&(h=s),(O=S.nextSibling)!==null)break;S=E,E=S.parentNode}S=O}r=a===-1||h===-1?null:{start:a,end:h}}else r=null}r=r||{start:0,end:0}}else r=null;for(XN={focusedElem:e,selectionRange:r},lP=!1,xr=t;xr!==null;)if(t=xr,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,xr=e;else for(;xr!==null;){t=xr;try{var A=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(A!==null){var $=A.memoizedProps,B=A.memoizedState,j=t.stateNode,z=j.getSnapshotBeforeUpdate(t.elementType===t.type?$:ml(t.type,$),B);j.__reactInternalSnapshotBeforeUpdate=z}break;case 3:var W=t.stateNode.containerInfo;W.nodeType===1?W.textContent="":W.nodeType===9&&W.documentElement&&W.removeChild(W.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Zt(163))}}catch(Q){Wi(t,t.return,Q)}if(e=t.sibling,e!==null){e.return=t.return,xr=e;break}xr=t.return}return A=g8,g8=!1,A}function DS(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&e)===e){var o=i.destroy;i.destroy=void 0,o!==void 0&&hB(t,r,o)}i=i.next}while(i!==n)}}function oI(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function dB(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function Pie(e){var t=e.alternate;t!==null&&(e.alternate=null,Pie(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[du],delete t[d1],delete t[QN],delete t[Gve],delete t[Yve])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Aie(e){return e.tag===5||e.tag===3||e.tag===4}function y8(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Aie(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function pB(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=fP));else if(n!==4&&(e=e.child,e!==null))for(pB(e,t,r),e=e.sibling;e!==null;)pB(e,t,r),e=e.sibling}function mB(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(mB(e,t,r),e=e.sibling;e!==null;)mB(e,t,r),e=e.sibling}var Bo=null,yl=!1;function jf(e,t,r){for(r=r.child;r!==null;)Iie(e,t,r),r=r.sibling}function Iie(e,t,r){if(yu&&typeof yu.onCommitFiberUnmount=="function")try{yu.onCommitFiberUnmount(ZA,r)}catch{}switch(r.tag){case 5:Qo||Uy(r,t);case 6:var n=Bo,i=yl;Bo=null,jf(e,t,r),Bo=n,yl=i,Bo!==null&&(yl?(e=Bo,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):Bo.removeChild(r.stateNode));break;case 18:Bo!==null&&(yl?(e=Bo,r=r.stateNode,e.nodeType===8?SD(e.parentNode,r):e.nodeType===1&&SD(e,r),l1(e)):SD(Bo,r.stateNode));break;case 4:n=Bo,i=yl,Bo=r.stateNode.containerInfo,yl=!0,jf(e,t,r),Bo=n,yl=i;break;case 0:case 11:case 14:case 15:if(!Qo&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var o=i,s=o.destroy;o=o.tag,s!==void 0&&(o&2||o&4)&&hB(r,t,s),i=i.next}while(i!==n)}jf(e,t,r);break;case 1:if(!Qo&&(Uy(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(a){Wi(r,t,a)}jf(e,t,r);break;case 21:jf(e,t,r);break;case 22:r.mode&1?(Qo=(n=Qo)||r.memoizedState!==null,jf(e,t,r),Qo=n):jf(e,t,r);break;default:jf(e,t,r)}}function v8(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new u_e),t.forEach(function(n){var i=__e.bind(null,e,n);r.has(n)||(r.add(n),n.then(i,i))})}}function ul(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var o=e,s=t,a=s;e:for(;a!==null;){switch(a.tag){case 5:Bo=a.stateNode,yl=!1;break e;case 3:Bo=a.stateNode.containerInfo,yl=!0;break e;case 4:Bo=a.stateNode.containerInfo,yl=!0;break e}a=a.return}if(Bo===null)throw Error(Zt(160));Iie(o,s,i),Bo=null,yl=!1;var h=i.alternate;h!==null&&(h.return=null),i.return=null}catch(p){Wi(i,t,p)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)Mie(t,e),t=t.sibling}function Mie(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ul(t,e),Zl(e),n&4){try{DS(3,e,e.return),oI(3,e)}catch($){Wi(e,e.return,$)}try{DS(5,e,e.return)}catch($){Wi(e,e.return,$)}}break;case 1:ul(t,e),Zl(e),n&512&&r!==null&&Uy(r,r.return);break;case 5:if(ul(t,e),Zl(e),n&512&&r!==null&&Uy(r,r.return),e.flags&32){var i=e.stateNode;try{i1(i,"")}catch($){Wi(e,e.return,$)}}if(n&4&&(i=e.stateNode,i!=null)){var o=e.memoizedProps,s=r!==null?r.memoizedProps:o,a=e.type,h=e.updateQueue;if(e.updateQueue=null,h!==null)try{a==="input"&&o.type==="radio"&&o.name!=null&&ene(i,o),jN(a,s);var p=jN(a,o);for(s=0;s<h.length;s+=2){var y=h[s],S=h[s+1];y==="style"?one(i,S):y==="dangerouslySetInnerHTML"?nne(i,S):y==="children"?i1(i,S):BH(i,y,S,p)}switch(a){case"input":$N(i,o);break;case"textarea":tne(i,o);break;case"select":var E=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!o.multiple;var O=o.value;O!=null?Jy(i,!!o.multiple,O,!1):E!==!!o.multiple&&(o.defaultValue!=null?Jy(i,!!o.multiple,o.defaultValue,!0):Jy(i,!!o.multiple,o.multiple?[]:"",!1))}i[d1]=o}catch($){Wi(e,e.return,$)}}break;case 6:if(ul(t,e),Zl(e),n&4){if(e.stateNode===null)throw Error(Zt(162));i=e.stateNode,o=e.memoizedProps;try{i.nodeValue=o}catch($){Wi(e,e.return,$)}}break;case 3:if(ul(t,e),Zl(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{l1(t.containerInfo)}catch($){Wi(e,e.return,$)}break;case 4:ul(t,e),Zl(e);break;case 13:ul(t,e),Zl(e),i=e.child,i.flags&8192&&(o=i.memoizedState!==null,i.stateNode.isHidden=o,!o||i.alternate!==null&&i.alternate.memoizedState!==null||(y3=Zi())),n&4&&v8(e);break;case 22:if(y=r!==null&&r.memoizedState!==null,e.mode&1?(Qo=(p=Qo)||y,ul(t,e),Qo=p):ul(t,e),Zl(e),n&8192){if(p=e.memoizedState!==null,(e.stateNode.isHidden=p)&&!y&&e.mode&1)for(xr=e,y=e.child;y!==null;){for(S=xr=y;xr!==null;){switch(E=xr,O=E.child,E.tag){case 0:case 11:case 14:case 15:DS(4,E,E.return);break;case 1:Uy(E,E.return);var A=E.stateNode;if(typeof A.componentWillUnmount=="function"){n=E,r=E.return;try{t=n,A.props=t.memoizedProps,A.state=t.memoizedState,A.componentWillUnmount()}catch($){Wi(n,r,$)}}break;case 5:Uy(E,E.return);break;case 22:if(E.memoizedState!==null){b8(S);continue}}O!==null?(O.return=E,xr=O):b8(S)}y=y.sibling}e:for(y=null,S=e;;){if(S.tag===5){if(y===null){y=S;try{i=S.stateNode,p?(o=i.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(a=S.stateNode,h=S.memoizedProps.style,s=h!=null&&h.hasOwnProperty("display")?h.display:null,a.style.display=ine("display",s))}catch($){Wi(e,e.return,$)}}}else if(S.tag===6){if(y===null)try{S.stateNode.nodeValue=p?"":S.memoizedProps}catch($){Wi(e,e.return,$)}}else if((S.tag!==22&&S.tag!==23||S.memoizedState===null||S===e)&&S.child!==null){S.child.return=S,S=S.child;continue}if(S===e)break e;for(;S.sibling===null;){if(S.return===null||S.return===e)break e;y===S&&(y=null),S=S.return}y===S&&(y=null),S.sibling.return=S.return,S=S.sibling}}break;case 19:ul(t,e),Zl(e),n&4&&v8(e);break;case 21:break;default:ul(t,e),Zl(e)}}function Zl(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(Aie(r)){var n=r;break e}r=r.return}throw Error(Zt(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(i1(i,""),n.flags&=-33);var o=y8(e);mB(e,o,i);break;case 3:case 4:var s=n.stateNode.containerInfo,a=y8(e);pB(e,a,s);break;default:throw Error(Zt(161))}}catch(h){Wi(e,e.return,h)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function f_e(e,t,r){xr=e,$ie(e)}function $ie(e,t,r){for(var n=(e.mode&1)!==0;xr!==null;){var i=xr,o=i.child;if(i.tag===22&&n){var s=i.memoizedState!==null||IO;if(!s){var a=i.alternate,h=a!==null&&a.memoizedState!==null||Qo;a=IO;var p=Qo;if(IO=s,(Qo=h)&&!p)for(xr=i;xr!==null;)s=xr,h=s.child,s.tag===22&&s.memoizedState!==null?w8(i):h!==null?(h.return=s,xr=h):w8(i);for(;o!==null;)xr=o,$ie(o),o=o.sibling;xr=i,IO=a,Qo=p}_8(e)}else i.subtreeFlags&8772&&o!==null?(o.return=i,xr=o):_8(e)}}function _8(e){for(;xr!==null;){var t=xr;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Qo||oI(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!Qo)if(r===null)n.componentDidMount();else{var i=t.elementType===t.type?r.memoizedProps:ml(t.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;o!==null&&r8(t,o,n);break;case 3:var s=t.updateQueue;if(s!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}r8(t,s,r)}break;case 5:var a=t.stateNode;if(r===null&&t.flags&4){r=a;var h=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":h.autoFocus&&r.focus();break;case"img":h.src&&(r.src=h.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var p=t.alternate;if(p!==null){var y=p.memoizedState;if(y!==null){var S=y.dehydrated;S!==null&&l1(S)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Zt(163))}Qo||t.flags&512&&dB(t)}catch(E){Wi(t,t.return,E)}}if(t===e){xr=null;break}if(r=t.sibling,r!==null){r.return=t.return,xr=r;break}xr=t.return}}function b8(e){for(;xr!==null;){var t=xr;if(t===e){xr=null;break}var r=t.sibling;if(r!==null){r.return=t.return,xr=r;break}xr=t.return}}function w8(e){for(;xr!==null;){var t=xr;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{oI(4,t)}catch(h){Wi(t,r,h)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var i=t.return;try{n.componentDidMount()}catch(h){Wi(t,i,h)}}var o=t.return;try{dB(t)}catch(h){Wi(t,o,h)}break;case 5:var s=t.return;try{dB(t)}catch(h){Wi(t,s,h)}}}catch(h){Wi(t,t.return,h)}if(t===e){xr=null;break}var a=t.sibling;if(a!==null){a.return=t.return,xr=a;break}xr=t.return}}var h_e=Math.ceil,SP=Qc.ReactCurrentDispatcher,m3=Qc.ReactCurrentOwner,js=Qc.ReactCurrentBatchConfig,Ln=0,Io=null,oo=null,jo=0,os=0,Wy=Vh(0),yo=0,_1=null,om=0,aI=0,g3=0,LS=null,Ba=null,y3=0,Cv=1/0,tc=null,xP=!1,gB=null,yh=null,MO=!1,ah=null,CP=0,NS=0,yB=null,lk=-1,uk=0;function ya(){return Ln&6?Zi():lk!==-1?lk:lk=Zi()}function vh(e){return e.mode&1?Ln&2&&jo!==0?jo&-jo:qve.transition!==null?(uk===0&&(uk=yne()),uk):(e=ti,e!==0||(e=window.event,e=e===void 0?16:Cne(e.type)),e):1}function El(e,t,r,n){if(50<NS)throw NS=0,yB=null,Error(Zt(185));$C(e,r,n),(!(Ln&2)||e!==Io)&&(e===Io&&(!(Ln&2)&&(aI|=r),yo===4&&rh(e,jo)),Ua(e,n),r===1&&Ln===0&&!(t.mode&1)&&(Cv=Zi()+500,rI&&Uh()))}function Ua(e,t){var r=e.callbackNode;qye(e,t);var n=sP(e,e===Io?jo:0);if(n===0)r!==null&&P6(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&P6(r),t===1)e.tag===0?Kve(S8.bind(null,e)):Vne(S8.bind(null,e)),Uve(function(){!(Ln&6)&&Uh()}),r=null;else{switch(vne(n)){case 1:r=VH;break;case 4:r=mne;break;case 16:r=aP;break;case 536870912:r=gne;break;default:r=aP}r=Hie(r,Die.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function Die(e,t){if(lk=-1,uk=0,Ln&6)throw Error(Zt(327));var r=e.callbackNode;if(nv()&&e.callbackNode!==r)return null;var n=sP(e,e===Io?jo:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=EP(e,n);else{t=n;var i=Ln;Ln|=2;var o=Nie();(Io!==e||jo!==t)&&(tc=null,Cv=Zi()+500,Kp(e,t));do try{m_e();break}catch(a){Lie(e,a)}while(1);r3(),SP.current=o,Ln=i,oo!==null?t=0:(Io=null,jo=0,t=yo)}if(t!==0){if(t===2&&(i=UN(e),i!==0&&(n=i,t=vB(e,i))),t===1)throw r=_1,Kp(e,0),rh(e,n),Ua(e,Zi()),r;if(t===6)rh(e,n);else{if(i=e.current.alternate,!(n&30)&&!d_e(i)&&(t=EP(e,n),t===2&&(o=UN(e),o!==0&&(n=o,t=vB(e,o))),t===1))throw r=_1,Kp(e,0),rh(e,n),Ua(e,Zi()),r;switch(e.finishedWork=i,e.finishedLanes=n,t){case 0:case 1:throw Error(Zt(345));case 2:up(e,Ba,tc);break;case 3:if(rh(e,n),(n&130023424)===n&&(t=y3+500-Zi(),10<t)){if(sP(e,0)!==0)break;if(i=e.suspendedLanes,(i&n)!==n){ya(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=JN(up.bind(null,e,Ba,tc),t);break}up(e,Ba,tc);break;case 4:if(rh(e,n),(n&4194240)===n)break;for(t=e.eventTimes,i=-1;0<n;){var s=31-Cl(n);o=1<<s,s=t[s],s>i&&(i=s),n&=~o}if(n=i,n=Zi()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*h_e(n/1960))-n,10<n){e.timeoutHandle=JN(up.bind(null,e,Ba,tc),n);break}up(e,Ba,tc);break;case 5:up(e,Ba,tc);break;default:throw Error(Zt(329))}}}return Ua(e,Zi()),e.callbackNode===r?Die.bind(null,e):null}function vB(e,t){var r=LS;return e.current.memoizedState.isDehydrated&&(Kp(e,t).flags|=256),e=EP(e,t),e!==2&&(t=Ba,Ba=r,t!==null&&_B(t)),e}function _B(e){Ba===null?Ba=e:Ba.push.apply(Ba,e)}function d_e(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],o=i.getSnapshot;i=i.value;try{if(!Tl(o(),i))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function rh(e,t){for(t&=~g3,t&=~aI,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Cl(t),n=1<<r;e[r]=-1,t&=~n}}function S8(e){if(Ln&6)throw Error(Zt(327));nv();var t=sP(e,0);if(!(t&1))return Ua(e,Zi()),null;var r=EP(e,t);if(e.tag!==0&&r===2){var n=UN(e);n!==0&&(t=n,r=vB(e,n))}if(r===1)throw r=_1,Kp(e,0),rh(e,t),Ua(e,Zi()),r;if(r===6)throw Error(Zt(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,up(e,Ba,tc),Ua(e,Zi()),null}function v3(e,t){var r=Ln;Ln|=1;try{return e(t)}finally{Ln=r,Ln===0&&(Cv=Zi()+500,rI&&Uh())}}function am(e){ah!==null&&ah.tag===0&&!(Ln&6)&&nv();var t=Ln;Ln|=1;var r=js.transition,n=ti;try{if(js.transition=null,ti=1,e)return e()}finally{ti=n,js.transition=r,Ln=t,!(Ln&6)&&Uh()}}function _3(){os=Wy.current,vi(Wy)}function Kp(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,Vve(r)),oo!==null)for(r=oo.return;r!==null;){var n=r;switch(QH(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&hP();break;case 3:Sv(),vi(Ha),vi(ra),l3();break;case 5:s3(n);break;case 4:Sv();break;case 13:vi(Mi);break;case 19:vi(Mi);break;case 10:n3(n.type._context);break;case 22:case 23:_3()}r=r.return}if(Io=e,oo=e=_h(e.current,null),jo=os=t,yo=0,_1=null,g3=aI=om=0,Ba=LS=null,yp!==null){for(t=0;t<yp.length;t++)if(r=yp[t],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,o=r.pending;if(o!==null){var s=o.next;o.next=i,n.next=s}r.pending=n}yp=null}return e}function Lie(e,t){do{var r=oo;try{if(r3(),ok.current=wP,bP){for(var n=Li.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}bP=!1}if(im=0,Po=go=Li=null,$S=!1,g1=0,m3.current=null,r===null||r.return===null){yo=1,_1=t,oo=null;break}e:{var o=e,s=r.return,a=r,h=t;if(t=jo,a.flags|=32768,h!==null&&typeof h=="object"&&typeof h.then=="function"){var p=h,y=a,S=y.tag;if(!(y.mode&1)&&(S===0||S===11||S===15)){var E=y.alternate;E?(y.updateQueue=E.updateQueue,y.memoizedState=E.memoizedState,y.lanes=E.lanes):(y.updateQueue=null,y.memoizedState=null)}var O=u8(s);if(O!==null){O.flags&=-257,c8(O,s,a,o,t),O.mode&1&&l8(o,p,t),t=O,h=p;var A=t.updateQueue;if(A===null){var $=new Set;$.add(h),t.updateQueue=$}else A.add(h);break e}else{if(!(t&1)){l8(o,p,t),b3();break e}h=Error(Zt(426))}}else if(Oi&&a.mode&1){var B=u8(s);if(B!==null){!(B.flags&65536)&&(B.flags|=256),c8(B,s,a,o,t),e3(xv(h,a));break e}}o=h=xv(h,a),yo!==4&&(yo=2),LS===null?LS=[o]:LS.push(o),o=s;do{switch(o.tag){case 3:o.flags|=65536,t&=-t,o.lanes|=t;var j=_ie(o,h,t);t8(o,j);break e;case 1:a=h;var z=o.type,W=o.stateNode;if(!(o.flags&128)&&(typeof z.getDerivedStateFromError=="function"||W!==null&&typeof W.componentDidCatch=="function"&&(yh===null||!yh.has(W)))){o.flags|=65536,t&=-t,o.lanes|=t;var Q=bie(o,a,t);t8(o,Q);break e}}o=o.return}while(o!==null)}jie(r)}catch(q){t=q,oo===r&&r!==null&&(oo=r=r.return);continue}break}while(1)}function Nie(){var e=SP.current;return SP.current=wP,e===null?wP:e}function b3(){(yo===0||yo===3||yo===2)&&(yo=4),Io===null||!(om&268435455)&&!(aI&268435455)||rh(Io,jo)}function EP(e,t){var r=Ln;Ln|=2;var n=Nie();(Io!==e||jo!==t)&&(tc=null,Kp(e,t));do try{p_e();break}catch(i){Lie(e,i)}while(1);if(r3(),Ln=r,SP.current=n,oo!==null)throw Error(Zt(261));return Io=null,jo=0,yo}function p_e(){for(;oo!==null;)Bie(oo)}function m_e(){for(;oo!==null&&!Fye();)Bie(oo)}function Bie(e){var t=zie(e.alternate,e,os);e.memoizedProps=e.pendingProps,t===null?jie(e):oo=t,m3.current=null}function jie(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=l_e(r,t),r!==null){r.flags&=32767,oo=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{yo=6,oo=null;return}}else if(r=s_e(r,t,os),r!==null){oo=r;return}if(t=t.sibling,t!==null){oo=t;return}oo=t=e}while(t!==null);yo===0&&(yo=5)}function up(e,t,r){var n=ti,i=js.transition;try{js.transition=null,ti=1,g_e(e,t,r,n)}finally{js.transition=i,ti=n}return null}function g_e(e,t,r,n){do nv();while(ah!==null);if(Ln&6)throw Error(Zt(327));r=e.finishedWork;var i=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(Zt(177));e.callbackNode=null,e.callbackPriority=0;var o=r.lanes|r.childLanes;if(Xye(e,o),e===Io&&(oo=Io=null,jo=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||MO||(MO=!0,Hie(aP,function(){return nv(),null})),o=(r.flags&15990)!==0,r.subtreeFlags&15990||o){o=js.transition,js.transition=null;var s=ti;ti=1;var a=Ln;Ln|=4,m3.current=null,c_e(e,r),Mie(r,e),Lve(XN),lP=!!qN,XN=qN=null,e.current=r,f_e(r),zye(),Ln=a,ti=s,js.transition=o}else e.current=r;if(MO&&(MO=!1,ah=e,CP=i),o=e.pendingLanes,o===0&&(yh=null),Uye(r.stateNode),Ua(e,Zi()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)i=t[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(xP)throw xP=!1,e=gB,gB=null,e;return CP&1&&e.tag!==0&&nv(),o=e.pendingLanes,o&1?e===yB?NS++:(NS=0,yB=e):NS=0,Uh(),null}function nv(){if(ah!==null){var e=vne(CP),t=js.transition,r=ti;try{if(js.transition=null,ti=16>e?16:e,ah===null)var n=!1;else{if(e=ah,ah=null,CP=0,Ln&6)throw Error(Zt(331));var i=Ln;for(Ln|=4,xr=e.current;xr!==null;){var o=xr,s=o.child;if(xr.flags&16){var a=o.deletions;if(a!==null){for(var h=0;h<a.length;h++){var p=a[h];for(xr=p;xr!==null;){var y=xr;switch(y.tag){case 0:case 11:case 15:DS(8,y,o)}var S=y.child;if(S!==null)S.return=y,xr=S;else for(;xr!==null;){y=xr;var E=y.sibling,O=y.return;if(Pie(y),y===p){xr=null;break}if(E!==null){E.return=O,xr=E;break}xr=O}}}var A=o.alternate;if(A!==null){var $=A.child;if($!==null){A.child=null;do{var B=$.sibling;$.sibling=null,$=B}while($!==null)}}xr=o}}if(o.subtreeFlags&2064&&s!==null)s.return=o,xr=s;else e:for(;xr!==null;){if(o=xr,o.flags&2048)switch(o.tag){case 0:case 11:case 15:DS(9,o,o.return)}var j=o.sibling;if(j!==null){j.return=o.return,xr=j;break e}xr=o.return}}var z=e.current;for(xr=z;xr!==null;){s=xr;var W=s.child;if(s.subtreeFlags&2064&&W!==null)W.return=s,xr=W;else e:for(s=z;xr!==null;){if(a=xr,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:oI(9,a)}}catch(q){Wi(a,a.return,q)}if(a===s){xr=null;break e}var Q=a.sibling;if(Q!==null){Q.return=a.return,xr=Q;break e}xr=a.return}}if(Ln=i,Uh(),yu&&typeof yu.onPostCommitFiberRoot=="function")try{yu.onPostCommitFiberRoot(ZA,e)}catch{}n=!0}return n}finally{ti=r,js.transition=t}}return!1}function x8(e,t,r){t=xv(r,t),t=_ie(e,t,1),e=gh(e,t,1),t=ya(),e!==null&&($C(e,1,t),Ua(e,t))}function Wi(e,t,r){if(e.tag===3)x8(e,e,r);else for(;t!==null;){if(t.tag===3){x8(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(yh===null||!yh.has(n))){e=xv(r,e),e=bie(t,e,1),t=gh(t,e,1),e=ya(),t!==null&&($C(t,1,e),Ua(t,e));break}}t=t.return}}function y_e(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=ya(),e.pingedLanes|=e.suspendedLanes&r,Io===e&&(jo&r)===r&&(yo===4||yo===3&&(jo&130023424)===jo&&500>Zi()-y3?Kp(e,0):g3|=r),Ua(e,t)}function Fie(e,t){t===0&&(e.mode&1?(t=xO,xO<<=1,!(xO&130023424)&&(xO=4194304)):t=1);var r=ya();e=Wc(e,t),e!==null&&($C(e,t,r),Ua(e,r))}function v_e(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),Fie(e,r)}function __e(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,i=e.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(Zt(314))}n!==null&&n.delete(t),Fie(e,r)}var zie;zie=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||Ha.current)Fa=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return Fa=!1,a_e(e,t,r);Fa=!!(e.flags&131072)}else Fa=!1,Oi&&t.flags&1048576&&Une(t,mP,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;sk(e,t),e=t.pendingProps;var i=_v(t,ra.current);rv(t,r),i=c3(null,t,n,e,i,r);var o=f3();return t.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Va(n)?(o=!0,dP(t)):o=!1,t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,o3(t),i.updater=nI,t.stateNode=i,i._reactInternals=t,oB(t,n,e,r),t=lB(null,t,n,!0,o,r)):(t.tag=0,Oi&&o&&JH(t),ma(null,t,i,r),t=t.child),t;case 16:n=t.elementType;e:{switch(sk(e,t),e=t.pendingProps,i=n._init,n=i(n._payload),t.type=n,i=t.tag=w_e(n),e=ml(n,e),i){case 0:t=sB(null,t,n,e,r);break e;case 1:t=d8(null,t,n,e,r);break e;case 11:t=f8(null,t,n,e,r);break e;case 14:t=h8(null,t,n,ml(n.type,e),r);break e}throw Error(Zt(306,n,""))}return t;case 0:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:ml(n,i),sB(e,t,n,i,r);case 1:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:ml(n,i),d8(e,t,n,i,r);case 3:e:{if(Cie(t),e===null)throw Error(Zt(387));n=t.pendingProps,o=t.memoizedState,i=o.element,Kne(e,t),vP(t,n,null,r);var s=t.memoizedState;if(n=s.element,o.isDehydrated)if(o={element:n,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},t.updateQueue.baseState=o,t.memoizedState=o,t.flags&256){i=xv(Error(Zt(423)),t),t=p8(e,t,n,r,i);break e}else if(n!==i){i=xv(Error(Zt(424)),t),t=p8(e,t,n,r,i);break e}else for(ls=mh(t.stateNode.containerInfo.firstChild),cs=t,Oi=!0,_l=null,r=Jne(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(bv(),n===i){t=Gc(e,t,r);break e}ma(e,t,n,r)}t=t.child}return t;case 5:return Qne(t),e===null&&rB(t),n=t.type,i=t.pendingProps,o=e!==null?e.memoizedProps:null,s=i.children,ZN(n,i)?s=null:o!==null&&ZN(n,o)&&(t.flags|=32),xie(e,t),ma(e,t,s,r),t.child;case 6:return e===null&&rB(t),null;case 13:return Eie(e,t,r);case 4:return a3(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=wv(t,null,n,r):ma(e,t,n,r),t.child;case 11:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:ml(n,i),f8(e,t,n,i,r);case 7:return ma(e,t,t.pendingProps,r),t.child;case 8:return ma(e,t,t.pendingProps.children,r),t.child;case 12:return ma(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,i=t.pendingProps,o=t.memoizedProps,s=i.value,di(gP,n._currentValue),n._currentValue=s,o!==null)if(Tl(o.value,s)){if(o.children===i.children&&!Ha.current){t=Gc(e,t,r);break e}}else for(o=t.child,o!==null&&(o.return=t);o!==null;){var a=o.dependencies;if(a!==null){s=o.child;for(var h=a.firstContext;h!==null;){if(h.context===n){if(o.tag===1){h=Nc(-1,r&-r),h.tag=2;var p=o.updateQueue;if(p!==null){p=p.shared;var y=p.pending;y===null?h.next=h:(h.next=y.next,y.next=h),p.pending=h}}o.lanes|=r,h=o.alternate,h!==null&&(h.lanes|=r),nB(o.return,r,t),a.lanes|=r;break}h=h.next}}else if(o.tag===10)s=o.type===t.type?null:o.child;else if(o.tag===18){if(s=o.return,s===null)throw Error(Zt(341));s.lanes|=r,a=s.alternate,a!==null&&(a.lanes|=r),nB(s,r,t),s=o.sibling}else s=o.child;if(s!==null)s.return=o;else for(s=o;s!==null;){if(s===t){s=null;break}if(o=s.sibling,o!==null){o.return=s.return,s=o;break}s=s.return}o=s}ma(e,t,i.children,r),t=t.child}return t;case 9:return i=t.type,n=t.pendingProps.children,rv(t,r),i=zs(i),n=n(i),t.flags|=1,ma(e,t,n,r),t.child;case 14:return n=t.type,i=ml(n,t.pendingProps),i=ml(n.type,i),h8(e,t,n,i,r);case 15:return wie(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:ml(n,i),sk(e,t),t.tag=1,Va(n)?(e=!0,dP(t)):e=!1,rv(t,r),Xne(t,n,i),oB(t,n,i,r),lB(null,t,n,!0,e,r);case 19:return Tie(e,t,r);case 22:return Sie(e,t,r)}throw Error(Zt(156,t.tag))};function Hie(e,t){return pne(e,t)}function b_e(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ns(e,t,r,n){return new b_e(e,t,r,n)}function w3(e){return e=e.prototype,!(!e||!e.isReactComponent)}function w_e(e){if(typeof e=="function")return w3(e)?1:0;if(e!=null){if(e=e.$$typeof,e===FH)return 11;if(e===zH)return 14}return 2}function _h(e,t){var r=e.alternate;return r===null?(r=Ns(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function ck(e,t,r,n,i,o){var s=2;if(n=e,typeof e=="function")w3(e)&&(s=1);else if(typeof e=="string")s=5;else e:switch(e){case Dy:return qp(r.children,i,o,t);case jH:s=8,i|=8;break;case kN:return e=Ns(12,r,t,i|2),e.elementType=kN,e.lanes=o,e;case PN:return e=Ns(13,r,t,i),e.elementType=PN,e.lanes=o,e;case AN:return e=Ns(19,r,t,i),e.elementType=AN,e.lanes=o,e;case Zre:return sI(r,i,o,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case qre:s=10;break e;case Xre:s=9;break e;case FH:s=11;break e;case zH:s=14;break e;case Jf:s=16,n=null;break e}throw Error(Zt(130,e==null?e:typeof e,""))}return t=Ns(s,r,t,i),t.elementType=e,t.type=n,t.lanes=o,t}function qp(e,t,r,n){return e=Ns(7,e,n,t),e.lanes=r,e}function sI(e,t,r,n){return e=Ns(22,e,n,t),e.elementType=Zre,e.lanes=r,e.stateNode={isHidden:!1},e}function PD(e,t,r){return e=Ns(6,e,null,t),e.lanes=r,e}function AD(e,t,r){return t=Ns(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function S_e(e,t,r,n,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=fD(0),this.expirationTimes=fD(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=fD(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function S3(e,t,r,n,i,o,s,a,h){return e=new S_e(e,t,r,a,h),t===1?(t=1,o===!0&&(t|=8)):t=0,o=Ns(3,null,null,t),e.current=o,o.stateNode=e,o.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},o3(o),e}function x_e(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:$y,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function Vie(e){if(!e)return Lh;e=e._reactInternals;e:{if(Cm(e)!==e||e.tag!==1)throw Error(Zt(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Va(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(Zt(171))}if(e.tag===1){var r=e.type;if(Va(r))return Hne(e,r,t)}return t}function Uie(e,t,r,n,i,o,s,a,h){return e=S3(r,n,!0,e,i,o,s,a,h),e.context=Vie(null),r=e.current,n=ya(),i=vh(r),o=Nc(n,i),o.callback=t??null,gh(r,o,i),e.current.lanes=i,$C(e,i,n),Ua(e,n),e}function lI(e,t,r,n){var i=t.current,o=ya(),s=vh(i);return r=Vie(r),t.context===null?t.context=r:t.pendingContext=r,t=Nc(o,s),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=gh(i,t,s),e!==null&&(El(e,i,s,o),ik(e,i,s)),s}function TP(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function C8(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function x3(e,t){C8(e,t),(e=e.alternate)&&C8(e,t)}function C_e(){return null}var Wie=typeof reportError=="function"?reportError:function(e){console.error(e)};function C3(e){this._internalRoot=e}uI.prototype.render=C3.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(Zt(409));lI(e,t,null,null)};uI.prototype.unmount=C3.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;am(function(){lI(null,e,null,null)}),t[Uc]=null}};function uI(e){this._internalRoot=e}uI.prototype.unstable_scheduleHydration=function(e){if(e){var t=wne();e={blockedOn:null,target:e,priority:t};for(var r=0;r<th.length&&t!==0&&t<th[r].priority;r++);th.splice(r,0,e),r===0&&xne(e)}};function E3(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function cI(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function E8(){}function E_e(e,t,r,n,i){if(i){if(typeof n=="function"){var o=n;n=function(){var p=TP(s);o.call(p)}}var s=Uie(t,n,e,0,null,!1,!1,"",E8);return e._reactRootContainer=s,e[Uc]=s.current,f1(e.nodeType===8?e.parentNode:e),am(),s}for(;i=e.lastChild;)e.removeChild(i);if(typeof n=="function"){var a=n;n=function(){var p=TP(h);a.call(p)}}var h=S3(e,0,!1,null,null,!1,!1,"",E8);return e._reactRootContainer=h,e[Uc]=h.current,f1(e.nodeType===8?e.parentNode:e),am(function(){lI(t,h,r,n)}),h}function fI(e,t,r,n,i){var o=r._reactRootContainer;if(o){var s=o;if(typeof i=="function"){var a=i;i=function(){var h=TP(s);a.call(h)}}lI(t,s,e,i)}else s=E_e(r,t,e,i,n);return TP(s)}_ne=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=bS(t.pendingLanes);r!==0&&(UH(t,r|1),Ua(t,Zi()),!(Ln&6)&&(Cv=Zi()+500,Uh()))}break;case 13:am(function(){var n=Wc(e,1);if(n!==null){var i=ya();El(n,e,1,i)}}),x3(e,1)}};WH=function(e){if(e.tag===13){var t=Wc(e,134217728);if(t!==null){var r=ya();El(t,e,134217728,r)}x3(e,134217728)}};bne=function(e){if(e.tag===13){var t=vh(e),r=Wc(e,t);if(r!==null){var n=ya();El(r,e,t,n)}x3(e,t)}};wne=function(){return ti};Sne=function(e,t){var r=ti;try{return ti=e,t()}finally{ti=r}};zN=function(e,t,r){switch(t){case"input":if($N(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var i=tI(n);if(!i)throw Error(Zt(90));Qre(n),$N(n,i)}}}break;case"textarea":tne(e,r);break;case"select":t=r.value,t!=null&&Jy(e,!!r.multiple,t,!1)}};lne=v3;une=am;var T_e={usingClientEntryPoint:!1,Events:[LC,jy,tI,ane,sne,v3]},B0={findFiberByHostInstance:gp,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},O_e={bundleType:B0.bundleType,version:B0.version,rendererPackageName:B0.rendererPackageName,rendererConfig:B0.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Qc.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=hne(e),e===null?null:e.stateNode},findFiberByHostInstance:B0.findFiberByHostInstance||C_e,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var $O=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!$O.isDisabled&&$O.supportsFiber)try{ZA=$O.inject(O_e),yu=$O}catch{}}ms.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=T_e;ms.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!E3(t))throw Error(Zt(200));return x_e(e,t,null,r)};ms.createRoot=function(e,t){if(!E3(e))throw Error(Zt(299));var r=!1,n="",i=Wie;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(i=t.onRecoverableError)),t=S3(e,1,!1,null,null,r,!1,n,i),e[Uc]=t.current,f1(e.nodeType===8?e.parentNode:e),new C3(t)};ms.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(Zt(188)):(e=Object.keys(e).join(","),Error(Zt(268,e)));return e=hne(t),e=e===null?null:e.stateNode,e};ms.flushSync=function(e){return am(e)};ms.hydrate=function(e,t,r){if(!cI(t))throw Error(Zt(200));return fI(null,e,t,!0,r)};ms.hydrateRoot=function(e,t,r){if(!E3(e))throw Error(Zt(405));var n=r!=null&&r.hydratedSources||null,i=!1,o="",s=Wie;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(o=r.identifierPrefix),r.onRecoverableError!==void 0&&(s=r.onRecoverableError)),t=Uie(t,null,e,1,r??null,i,!1,o,s),e[Uc]=t.current,f1(e),n)for(e=0;e<n.length;e++)r=n[e],i=r._getVersion,i=i(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,i]:t.mutableSourceEagerHydrationData.push(r,i);return new uI(t)};ms.render=function(e,t,r){if(!cI(t))throw Error(Zt(200));return fI(null,e,t,!1,r)};ms.unmountComponentAtNode=function(e){if(!cI(e))throw Error(Zt(40));return e._reactRootContainer?(am(function(){fI(null,null,e,!1,function(){e._reactRootContainer=null,e[Uc]=null})}),!0):!1};ms.unstable_batchedUpdates=v3;ms.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!cI(r))throw Error(Zt(200));if(e==null||e._reactInternals===void 0)throw Error(Zt(38));return fI(e,t,r,!1,n)};ms.version="18.2.0-next-9e3b772b8-20220608";function Gie(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Gie)}catch(e){console.error(e)}}Gie(),Ure.exports=ms;var Yie=Ure.exports;const Kie=jb(Yie);var T8=Yie;ON.createRoot=T8.createRoot,ON.hydrateRoot=T8.hydrateRoot;/**
 * @remix-run/router v1.6.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function b1(){return b1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},b1.apply(this,arguments)}var sh;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(sh||(sh={}));const O8="popstate";function R_e(e){e===void 0&&(e={});function t(i,o){let{pathname:s="/",search:a="",hash:h=""}=Em(i.location.hash.substr(1));return bB("",{pathname:s,search:a,hash:h},o.state&&o.state.usr||null,o.state&&o.state.key||"default")}function r(i,o){let s=i.document.querySelector("base"),a="";if(s&&s.getAttribute("href")){let h=i.location.href,p=h.indexOf("#");a=p===-1?h:h.slice(0,p)}return a+"#"+(typeof o=="string"?o:OP(o))}function n(i,o){hI(i.pathname.charAt(0)==="/","relative pathnames are not supported in hash history.push("+JSON.stringify(o)+")")}return P_e(t,r,n,e)}function so(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function hI(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function k_e(){return Math.random().toString(36).substr(2,8)}function R8(e,t){return{usr:e.state,key:e.key,idx:t}}function bB(e,t,r,n){return r===void 0&&(r=null),b1({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?Em(t):t,{state:r,key:t&&t.key||n||k_e()})}function OP(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function Em(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function P_e(e,t,r,n){n===void 0&&(n={});let{window:i=document.defaultView,v5Compat:o=!1}=n,s=i.history,a=sh.Pop,h=null,p=y();p==null&&(p=0,s.replaceState(b1({},s.state,{idx:p}),""));function y(){return(s.state||{idx:null}).idx}function S(){a=sh.Pop;let B=y(),j=B==null?null:B-p;p=B,h&&h({action:a,location:$.location,delta:j})}function E(B,j){a=sh.Push;let z=bB($.location,B,j);r&&r(z,B),p=y()+1;let W=R8(z,p),Q=$.createHref(z);try{s.pushState(W,"",Q)}catch{i.location.assign(Q)}o&&h&&h({action:a,location:$.location,delta:1})}function O(B,j){a=sh.Replace;let z=bB($.location,B,j);r&&r(z,B),p=y();let W=R8(z,p),Q=$.createHref(z);s.replaceState(W,"",Q),o&&h&&h({action:a,location:$.location,delta:0})}function A(B){let j=i.location.origin!=="null"?i.location.origin:i.location.href,z=typeof B=="string"?B:OP(B);return so(j,"No window.location.(origin|href) available to create URL for href: "+z),new URL(z,j)}let $={get action(){return a},get location(){return e(i,s)},listen(B){if(h)throw new Error("A history only accepts one active listener");return i.addEventListener(O8,S),h=B,()=>{i.removeEventListener(O8,S),h=null}},createHref(B){return t(i,B)},createURL:A,encodeLocation(B){let j=A(B);return{pathname:j.pathname,search:j.search,hash:j.hash}},push:E,replace:O,go(B){return s.go(B)}};return $}var k8;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(k8||(k8={}));function A_e(e,t,r){r===void 0&&(r="/");let n=typeof t=="string"?Em(t):t,i=T3(n.pathname||"/",r);if(i==null)return null;let o=qie(e);I_e(o);let s=null;for(let a=0;s==null&&a<o.length;++a)s=z_e(o[a],U_e(i));return s}function qie(e,t,r,n){t===void 0&&(t=[]),r===void 0&&(r=[]),n===void 0&&(n="");let i=(o,s,a)=>{let h={relativePath:a===void 0?o.path||"":a,caseSensitive:o.caseSensitive===!0,childrenIndex:s,route:o};h.relativePath.startsWith("/")&&(so(h.relativePath.startsWith(n),'Absolute route path "'+h.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),h.relativePath=h.relativePath.slice(n.length));let p=bh([n,h.relativePath]),y=r.concat(h);o.children&&o.children.length>0&&(so(o.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+p+'".')),qie(o.children,t,y,p)),!(o.path==null&&!o.index)&&t.push({path:p,score:j_e(p,o.index),routesMeta:y})};return e.forEach((o,s)=>{var a;if(o.path===""||!((a=o.path)!=null&&a.includes("?")))i(o,s);else for(let h of Xie(o.path))i(o,s,h)}),t}function Xie(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,i=r.endsWith("?"),o=r.replace(/\?$/,"");if(n.length===0)return i?[o,""]:[o];let s=Xie(n.join("/")),a=[];return a.push(...s.map(h=>h===""?o:[o,h].join("/"))),i&&a.push(...s),a.map(h=>e.startsWith("/")&&h===""?"/":h)}function I_e(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:F_e(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const M_e=/^:\w+$/,$_e=3,D_e=2,L_e=1,N_e=10,B_e=-2,P8=e=>e==="*";function j_e(e,t){let r=e.split("/"),n=r.length;return r.some(P8)&&(n+=B_e),t&&(n+=D_e),r.filter(i=>!P8(i)).reduce((i,o)=>i+(M_e.test(o)?$_e:o===""?L_e:N_e),n)}function F_e(e,t){return e.length===t.length&&e.slice(0,-1).every((n,i)=>n===t[i])?e[e.length-1]-t[t.length-1]:0}function z_e(e,t){let{routesMeta:r}=e,n={},i="/",o=[];for(let s=0;s<r.length;++s){let a=r[s],h=s===r.length-1,p=i==="/"?t:t.slice(i.length)||"/",y=H_e({path:a.relativePath,caseSensitive:a.caseSensitive,end:h},p);if(!y)return null;Object.assign(n,y.params);let S=a.route;o.push({params:n,pathname:bh([i,y.pathname]),pathnameBase:K_e(bh([i,y.pathnameBase])),route:S}),y.pathnameBase!=="/"&&(i=bh([i,y.pathnameBase]))}return o}function H_e(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=V_e(e.path,e.caseSensitive,e.end),i=t.match(r);if(!i)return null;let o=i[0],s=o.replace(/(.)\/+$/,"$1"),a=i.slice(1);return{params:n.reduce((p,y,S)=>{if(y==="*"){let E=a[S]||"";s=o.slice(0,o.length-E.length).replace(/(.)\/+$/,"$1")}return p[y]=W_e(a[S]||"",y),p},{}),pathname:o,pathnameBase:s,pattern:e}}function V_e(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),hI(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let n=[],i="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^$?{}|()[\]]/g,"\\$&").replace(/\/:(\w+)/g,(s,a)=>(n.push(a),"/([^\\/]+)"));return e.endsWith("*")?(n.push("*"),i+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?i+="\\/*$":e!==""&&e!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,t?void 0:"i"),n]}function U_e(e){try{return decodeURI(e)}catch(t){return hI(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function W_e(e,t){try{return decodeURIComponent(e)}catch(r){return hI(!1,'The value for the URL param "'+t+'" will not be decoded because'+(' the string "'+e+'" is a malformed URL segment. This is probably')+(" due to a bad percent encoding ("+r+").")),e}}function T3(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}function G_e(e,t){t===void 0&&(t="/");let{pathname:r,search:n="",hash:i=""}=typeof e=="string"?Em(e):e;return{pathname:r?r.startsWith("/")?r:Y_e(r,t):t,search:q_e(n),hash:X_e(i)}}function Y_e(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(i=>{i===".."?r.length>1&&r.pop():i!=="."&&r.push(i)}),r.length>1?r.join("/"):"/"}function ID(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function Zie(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function Jie(e,t,r,n){n===void 0&&(n=!1);let i;typeof e=="string"?i=Em(e):(i=b1({},e),so(!i.pathname||!i.pathname.includes("?"),ID("?","pathname","search",i)),so(!i.pathname||!i.pathname.includes("#"),ID("#","pathname","hash",i)),so(!i.search||!i.search.includes("#"),ID("#","search","hash",i)));let o=e===""||i.pathname==="",s=o?"/":i.pathname,a;if(n||s==null)a=r;else{let S=t.length-1;if(s.startsWith("..")){let E=s.split("/");for(;E[0]==="..";)E.shift(),S-=1;i.pathname=E.join("/")}a=S>=0?t[S]:"/"}let h=G_e(i,a),p=s&&s!=="/"&&s.endsWith("/"),y=(o||s===".")&&r.endsWith("/");return!h.pathname.endsWith("/")&&(p||y)&&(h.pathname+="/"),h}const bh=e=>e.join("/").replace(/\/\/+/g,"/"),K_e=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),q_e=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,X_e=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function Z_e(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const Qie=["post","put","patch","delete"];new Set(Qie);const J_e=["get",...Qie];new Set(J_e);/**
 * React Router v6.11.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function RP(){return RP=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},RP.apply(this,arguments)}const O3=_t.createContext(null),Q_e=_t.createContext(null),Vb=_t.createContext(null),dI=_t.createContext(null),Tm=_t.createContext({outlet:null,matches:[],isDataRoute:!1}),eoe=_t.createContext(null);function ebe(e,t){let{relative:r}=t===void 0?{}:t;BC()||so(!1);let{basename:n,navigator:i}=_t.useContext(Vb),{hash:o,pathname:s,search:a}=roe(e,{relative:r}),h=s;return n!=="/"&&(h=s==="/"?n:bh([n,s])),i.createHref({pathname:h,search:a,hash:o})}function BC(){return _t.useContext(dI)!=null}function jC(){return BC()||so(!1),_t.useContext(dI).location}function toe(e){_t.useContext(Vb).static||_t.useLayoutEffect(e)}function pI(){let{isDataRoute:e}=_t.useContext(Tm);return e?dbe():tbe()}function tbe(){BC()||so(!1);let e=_t.useContext(O3),{basename:t,navigator:r}=_t.useContext(Vb),{matches:n}=_t.useContext(Tm),{pathname:i}=jC(),o=JSON.stringify(Zie(n).map(h=>h.pathnameBase)),s=_t.useRef(!1);return toe(()=>{s.current=!0}),_t.useCallback(function(h,p){if(p===void 0&&(p={}),!s.current)return;if(typeof h=="number"){r.go(h);return}let y=Jie(h,JSON.parse(o),i,p.relative==="path");e==null&&t!=="/"&&(y.pathname=y.pathname==="/"?t:bh([t,y.pathname])),(p.replace?r.replace:r.push)(y,p.state,p)},[t,r,o,i,e])}function roe(e,t){let{relative:r}=t===void 0?{}:t,{matches:n}=_t.useContext(Tm),{pathname:i}=jC(),o=JSON.stringify(Zie(n).map(s=>s.pathnameBase));return _t.useMemo(()=>Jie(e,JSON.parse(o),i,r==="path"),[e,o,i,r])}function rbe(e,t){return nbe(e,t)}function nbe(e,t,r){BC()||so(!1);let{navigator:n}=_t.useContext(Vb),{matches:i}=_t.useContext(Tm),o=i[i.length-1],s=o?o.params:{};o&&o.pathname;let a=o?o.pathnameBase:"/";o&&o.route;let h=jC(),p;if(t){var y;let $=typeof t=="string"?Em(t):t;a==="/"||(y=$.pathname)!=null&&y.startsWith(a)||so(!1),p=$}else p=h;let S=p.pathname||"/",E=a==="/"?S:S.slice(a.length)||"/",O=A_e(e,{pathname:E}),A=lbe(O&&O.map($=>Object.assign({},$,{params:Object.assign({},s,$.params),pathname:bh([a,n.encodeLocation?n.encodeLocation($.pathname).pathname:$.pathname]),pathnameBase:$.pathnameBase==="/"?a:bh([a,n.encodeLocation?n.encodeLocation($.pathnameBase).pathname:$.pathnameBase])})),i,r);return t&&A?_t.createElement(dI.Provider,{value:{location:RP({pathname:"/",search:"",hash:"",state:null,key:"default"},p),navigationType:sh.Pop}},A):A}function ibe(){let e=hbe(),t=Z_e(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},o=null;return _t.createElement(_t.Fragment,null,_t.createElement("h2",null,"Unexpected Application Error!"),_t.createElement("h3",{style:{fontStyle:"italic"}},t),r?_t.createElement("pre",{style:i},r):null,o)}const obe=_t.createElement(ibe,null);class abe extends _t.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error||r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error?_t.createElement(Tm.Provider,{value:this.props.routeContext},_t.createElement(eoe.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function sbe(e){let{routeContext:t,match:r,children:n}=e,i=_t.useContext(O3);return i&&i.static&&i.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=r.route.id),_t.createElement(Tm.Provider,{value:t},n)}function lbe(e,t,r){var n;if(t===void 0&&(t=[]),r===void 0&&(r=null),e==null){var i;if((i=r)!=null&&i.errors)e=r.matches;else return null}let o=e,s=(n=r)==null?void 0:n.errors;if(s!=null){let a=o.findIndex(h=>h.route.id&&(s==null?void 0:s[h.route.id]));a>=0||so(!1),o=o.slice(0,Math.min(o.length,a+1))}return o.reduceRight((a,h,p)=>{let y=h.route.id?s==null?void 0:s[h.route.id]:null,S=null;r&&(S=h.route.errorElement||obe);let E=t.concat(o.slice(0,p+1)),O=()=>{let A;return y?A=S:h.route.Component?A=_t.createElement(h.route.Component,null):h.route.element?A=h.route.element:A=a,_t.createElement(sbe,{match:h,routeContext:{outlet:a,matches:E,isDataRoute:r!=null},children:A})};return r&&(h.route.ErrorBoundary||h.route.errorElement||p===0)?_t.createElement(abe,{location:r.location,revalidation:r.revalidation,component:S,error:y,children:O(),routeContext:{outlet:null,matches:E,isDataRoute:!0}}):O()},null)}var wB;(function(e){e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate"})(wB||(wB={}));var w1;(function(e){e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId"})(w1||(w1={}));function ube(e){let t=_t.useContext(O3);return t||so(!1),t}function cbe(e){let t=_t.useContext(Q_e);return t||so(!1),t}function fbe(e){let t=_t.useContext(Tm);return t||so(!1),t}function noe(e){let t=fbe(),r=t.matches[t.matches.length-1];return r.route.id||so(!1),r.route.id}function hbe(){var e;let t=_t.useContext(eoe),r=cbe(w1.UseRouteError),n=noe(w1.UseRouteError);return t||((e=r.errors)==null?void 0:e[n])}function dbe(){let{router:e}=ube(wB.UseNavigateStable),t=noe(w1.UseNavigateStable),r=_t.useRef(!1);return toe(()=>{r.current=!0}),_t.useCallback(function(i,o){o===void 0&&(o={}),r.current&&(typeof i=="number"?e.navigate(i):e.navigate(i,RP({fromRouteId:t},o)))},[e,t])}function Cy(e){so(!1)}function pbe(e){let{basename:t="/",children:r=null,location:n,navigationType:i=sh.Pop,navigator:o,static:s=!1}=e;BC()&&so(!1);let a=t.replace(/^\/*/,"/"),h=_t.useMemo(()=>({basename:a,navigator:o,static:s}),[a,o,s]);typeof n=="string"&&(n=Em(n));let{pathname:p="/",search:y="",hash:S="",state:E=null,key:O="default"}=n,A=_t.useMemo(()=>{let $=T3(p,a);return $==null?null:{location:{pathname:$,search:y,hash:S,state:E,key:O},navigationType:i}},[a,p,y,S,E,O,i]);return A==null?null:_t.createElement(Vb.Provider,{value:h},_t.createElement(dI.Provider,{children:r,value:A}))}function mbe(e){let{children:t,location:r}=e;return rbe(SB(t),r)}var A8;(function(e){e[e.pending=0]="pending",e[e.success=1]="success",e[e.error=2]="error"})(A8||(A8={}));new Promise(()=>{});function SB(e,t){t===void 0&&(t=[]);let r=[];return _t.Children.forEach(e,(n,i)=>{if(!_t.isValidElement(n))return;let o=[...t,i];if(n.type===_t.Fragment){r.push.apply(r,SB(n.props.children,o));return}n.type!==Cy&&so(!1),!n.props.index||!n.props.children||so(!1);let s={id:n.props.id||o.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(s.children=SB(n.props.children,o)),r.push(s)}),r}/**
 * React Router DOM v6.11.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function xB(){return xB=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},xB.apply(this,arguments)}function gbe(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,o;for(o=0;o<n.length;o++)i=n[o],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function ybe(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function vbe(e,t){return e.button===0&&(!t||t==="_self")&&!ybe(e)}const _be=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset"];function bbe(e){let{basename:t,children:r,window:n}=e,i=_t.useRef();i.current==null&&(i.current=R_e({window:n,v5Compat:!0}));let o=i.current,[s,a]=_t.useState({action:o.action,location:o.location});return _t.useLayoutEffect(()=>o.listen(a),[o]),_t.createElement(pbe,{basename:t,children:r,location:s.location,navigationType:s.action,navigator:o})}const wbe=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Sbe=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,I8=_t.forwardRef(function(t,r){let{onClick:n,relative:i,reloadDocument:o,replace:s,state:a,target:h,to:p,preventScrollReset:y}=t,S=gbe(t,_be),{basename:E}=_t.useContext(Vb),O,A=!1;if(typeof p=="string"&&Sbe.test(p)&&(O=p,wbe))try{let z=new URL(window.location.href),W=p.startsWith("//")?new URL(z.protocol+p):new URL(p),Q=T3(W.pathname,E);W.origin===z.origin&&Q!=null?p=Q+W.search+W.hash:A=!0}catch{}let $=ebe(p,{relative:i}),B=xbe(p,{replace:s,state:a,target:h,preventScrollReset:y,relative:i});function j(z){n&&n(z),z.defaultPrevented||B(z)}return _t.createElement("a",xB({},S,{href:O||$,onClick:A||o?n:j,ref:r,target:h}))});var M8;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmitImpl="useSubmitImpl",e.UseFetcher="useFetcher"})(M8||(M8={}));var $8;(function(e){e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})($8||($8={}));function xbe(e,t){let{target:r,replace:n,state:i,preventScrollReset:o,relative:s}=t===void 0?{}:t,a=pI(),h=jC(),p=roe(e,{relative:s});return _t.useCallback(y=>{if(vbe(y,r)){y.preventDefault();let S=n!==void 0?n:OP(h)===OP(p);a(e,{replace:S,state:i,preventScrollReset:o,relative:s})}},[h,a,p,n,i,r,e,o,s])}const Cbe="modulepreload",Ebe=function(e){return"/"+e},D8={},mI=function(t,r,n){if(!r||r.length===0)return t();const i=document.getElementsByTagName("link");return Promise.all(r.map(o=>{if(o=Ebe(o),o in D8)return;D8[o]=!0;const s=o.endsWith(".css"),a=s?'[rel="stylesheet"]':"";if(!!n)for(let y=i.length-1;y>=0;y--){const S=i[y];if(S.href===o&&(!s||S.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${o}"]${a}`))return;const p=document.createElement("link");if(p.rel=s?"stylesheet":Cbe,s||(p.as="script",p.crossOrigin=""),p.href=o,document.head.appendChild(p),s)return new Promise((y,S)=>{p.addEventListener("load",y),p.addEventListener("error",()=>S(new Error(`Unable to preload CSS for ${o}`)))})})).then(()=>t())};var Tbe=globalThis&&globalThis.__awaiter||function(e,t,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(y){try{p(n.next(y))}catch(S){s(S)}}function h(y){try{p(n.throw(y))}catch(S){s(S)}}function p(y){y.done?o(y.value):i(y.value).then(a,h)}p((n=n.apply(e,t||[])).next())})};const Obe=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>Tbe(void 0,void 0,void 0,function*(){return yield(yield mI(()=>Promise.resolve().then(()=>gI),void 0)).fetch(...r)}):t=fetch,(...r)=>t(...r)};class R3 extends Error{constructor(t,r="FunctionsError",n){super(t),super.name=r,this.context=n}}class Rbe extends R3{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class kbe extends R3{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class Pbe extends R3{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var Abe=globalThis&&globalThis.__awaiter||function(e,t,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(y){try{p(n.next(y))}catch(S){s(S)}}function h(y){try{p(n.throw(y))}catch(S){s(S)}}function p(y){y.done?o(y.value):i(y.value).then(a,h)}p((n=n.apply(e,t||[])).next())})};class Ibe{constructor(t,{headers:r={},customFetch:n}={}){this.url=t,this.headers=r,this.fetch=Obe(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t,r={}){var n;return Abe(this,void 0,void 0,function*(){try{const{headers:i,method:o,body:s}=r;let a={},h;s&&(i&&!Object.prototype.hasOwnProperty.call(i,"Content-Type")||!i)&&(typeof Blob<"u"&&s instanceof Blob||s instanceof ArrayBuffer?(a["Content-Type"]="application/octet-stream",h=s):typeof s=="string"?(a["Content-Type"]="text/plain",h=s):typeof FormData<"u"&&s instanceof FormData?h=s:(a["Content-Type"]="application/json",h=JSON.stringify(s)));const p=yield this.fetch(`${this.url}/${t}`,{method:o||"POST",headers:Object.assign(Object.assign(Object.assign({},a),this.headers),i),body:h}).catch(O=>{throw new Rbe(O)}),y=p.headers.get("x-relay-error");if(y&&y==="true")throw new kbe(p);if(!p.ok)throw new Pbe(p);let S=((n=p.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),E;return S==="application/json"?E=yield p.json():S==="application/octet-stream"?E=yield p.blob():S==="multipart/form-data"?E=yield p.formData():E=yield p.text(),{data:E,error:null}}catch(i){return{data:null,error:i}}})}}var CB={exports:{}};(function(e,t){var r=typeof self<"u"?self:Zy,n=function(){function o(){this.fetch=!1,this.DOMException=r.DOMException}return o.prototype=r,new o}();(function(o){(function(s){var a={searchParams:"URLSearchParams"in o,iterable:"Symbol"in o&&"iterator"in Symbol,blob:"FileReader"in o&&"Blob"in o&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in o,arrayBuffer:"ArrayBuffer"in o};function h(de){return de&&DataView.prototype.isPrototypeOf(de)}if(a.arrayBuffer)var p=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],y=ArrayBuffer.isView||function(de){return de&&p.indexOf(Object.prototype.toString.call(de))>-1};function S(de){if(typeof de!="string"&&(de=String(de)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(de))throw new TypeError("Invalid character in header field name");return de.toLowerCase()}function E(de){return typeof de!="string"&&(de=String(de)),de}function O(de){var Ce={next:function(){var pt=de.shift();return{done:pt===void 0,value:pt}}};return a.iterable&&(Ce[Symbol.iterator]=function(){return Ce}),Ce}function A(de){this.map={},de instanceof A?de.forEach(function(Ce,pt){this.append(pt,Ce)},this):Array.isArray(de)?de.forEach(function(Ce){this.append(Ce[0],Ce[1])},this):de&&Object.getOwnPropertyNames(de).forEach(function(Ce){this.append(Ce,de[Ce])},this)}A.prototype.append=function(de,Ce){de=S(de),Ce=E(Ce);var pt=this.map[de];this.map[de]=pt?pt+", "+Ce:Ce},A.prototype.delete=function(de){delete this.map[S(de)]},A.prototype.get=function(de){return de=S(de),this.has(de)?this.map[de]:null},A.prototype.has=function(de){return this.map.hasOwnProperty(S(de))},A.prototype.set=function(de,Ce){this.map[S(de)]=E(Ce)},A.prototype.forEach=function(de,Ce){for(var pt in this.map)this.map.hasOwnProperty(pt)&&de.call(Ce,this.map[pt],pt,this)},A.prototype.keys=function(){var de=[];return this.forEach(function(Ce,pt){de.push(pt)}),O(de)},A.prototype.values=function(){var de=[];return this.forEach(function(Ce){de.push(Ce)}),O(de)},A.prototype.entries=function(){var de=[];return this.forEach(function(Ce,pt){de.push([pt,Ce])}),O(de)},a.iterable&&(A.prototype[Symbol.iterator]=A.prototype.entries);function $(de){if(de.bodyUsed)return Promise.reject(new TypeError("Already read"));de.bodyUsed=!0}function B(de){return new Promise(function(Ce,pt){de.onload=function(){Ce(de.result)},de.onerror=function(){pt(de.error)}})}function j(de){var Ce=new FileReader,pt=B(Ce);return Ce.readAsArrayBuffer(de),pt}function z(de){var Ce=new FileReader,pt=B(Ce);return Ce.readAsText(de),pt}function W(de){for(var Ce=new Uint8Array(de),pt=new Array(Ce.length),Ct=0;Ct<Ce.length;Ct++)pt[Ct]=String.fromCharCode(Ce[Ct]);return pt.join("")}function Q(de){if(de.slice)return de.slice(0);var Ce=new Uint8Array(de.byteLength);return Ce.set(new Uint8Array(de)),Ce.buffer}function q(){return this.bodyUsed=!1,this._initBody=function(de){this._bodyInit=de,de?typeof de=="string"?this._bodyText=de:a.blob&&Blob.prototype.isPrototypeOf(de)?this._bodyBlob=de:a.formData&&FormData.prototype.isPrototypeOf(de)?this._bodyFormData=de:a.searchParams&&URLSearchParams.prototype.isPrototypeOf(de)?this._bodyText=de.toString():a.arrayBuffer&&a.blob&&h(de)?(this._bodyArrayBuffer=Q(de.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):a.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(de)||y(de))?this._bodyArrayBuffer=Q(de):this._bodyText=de=Object.prototype.toString.call(de):this._bodyText="",this.headers.get("content-type")||(typeof de=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):a.searchParams&&URLSearchParams.prototype.isPrototypeOf(de)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},a.blob&&(this.blob=function(){var de=$(this);if(de)return de;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?$(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(j)}),this.text=function(){var de=$(this);if(de)return de;if(this._bodyBlob)return z(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(W(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},a.formData&&(this.formData=function(){return this.text().then(Le)}),this.json=function(){return this.text().then(JSON.parse)},this}var Se=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function Ie(de){var Ce=de.toUpperCase();return Se.indexOf(Ce)>-1?Ce:de}function He(de,Ce){Ce=Ce||{};var pt=Ce.body;if(de instanceof He){if(de.bodyUsed)throw new TypeError("Already read");this.url=de.url,this.credentials=de.credentials,Ce.headers||(this.headers=new A(de.headers)),this.method=de.method,this.mode=de.mode,this.signal=de.signal,!pt&&de._bodyInit!=null&&(pt=de._bodyInit,de.bodyUsed=!0)}else this.url=String(de);if(this.credentials=Ce.credentials||this.credentials||"same-origin",(Ce.headers||!this.headers)&&(this.headers=new A(Ce.headers)),this.method=Ie(Ce.method||this.method||"GET"),this.mode=Ce.mode||this.mode||null,this.signal=Ce.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&pt)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(pt)}He.prototype.clone=function(){return new He(this,{body:this._bodyInit})};function Le(de){var Ce=new FormData;return de.trim().split("&").forEach(function(pt){if(pt){var Ct=pt.split("="),ie=Ct.shift().replace(/\+/g," "),M=Ct.join("=").replace(/\+/g," ");Ce.append(decodeURIComponent(ie),decodeURIComponent(M))}}),Ce}function ze(de){var Ce=new A,pt=de.replace(/\r?\n[\t ]+/g," ");return pt.split(/\r?\n/).forEach(function(Ct){var ie=Ct.split(":"),M=ie.shift().trim();if(M){var U=ie.join(":").trim();Ce.append(M,U)}}),Ce}q.call(He.prototype);function ct(de,Ce){Ce||(Ce={}),this.type="default",this.status=Ce.status===void 0?200:Ce.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in Ce?Ce.statusText:"OK",this.headers=new A(Ce.headers),this.url=Ce.url||"",this._initBody(de)}q.call(ct.prototype),ct.prototype.clone=function(){return new ct(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new A(this.headers),url:this.url})},ct.error=function(){var de=new ct(null,{status:0,statusText:""});return de.type="error",de};var At=[301,302,303,307,308];ct.redirect=function(de,Ce){if(At.indexOf(Ce)===-1)throw new RangeError("Invalid status code");return new ct(null,{status:Ce,headers:{location:de}})},s.DOMException=o.DOMException;try{new s.DOMException}catch{s.DOMException=function(Ce,pt){this.message=Ce,this.name=pt;var Ct=Error(Ce);this.stack=Ct.stack},s.DOMException.prototype=Object.create(Error.prototype),s.DOMException.prototype.constructor=s.DOMException}function Qe(de,Ce){return new Promise(function(pt,Ct){var ie=new He(de,Ce);if(ie.signal&&ie.signal.aborted)return Ct(new s.DOMException("Aborted","AbortError"));var M=new XMLHttpRequest;function U(){M.abort()}M.onload=function(){var K={status:M.status,statusText:M.statusText,headers:ze(M.getAllResponseHeaders()||"")};K.url="responseURL"in M?M.responseURL:K.headers.get("X-Request-URL");var re="response"in M?M.response:M.responseText;pt(new ct(re,K))},M.onerror=function(){Ct(new TypeError("Network request failed"))},M.ontimeout=function(){Ct(new TypeError("Network request failed"))},M.onabort=function(){Ct(new s.DOMException("Aborted","AbortError"))},M.open(ie.method,ie.url,!0),ie.credentials==="include"?M.withCredentials=!0:ie.credentials==="omit"&&(M.withCredentials=!1),"responseType"in M&&a.blob&&(M.responseType="blob"),ie.headers.forEach(function(K,re){M.setRequestHeader(re,K)}),ie.signal&&(ie.signal.addEventListener("abort",U),M.onreadystatechange=function(){M.readyState===4&&ie.signal.removeEventListener("abort",U)}),M.send(typeof ie._bodyInit>"u"?null:ie._bodyInit)})}return Qe.polyfill=!0,o.fetch||(o.fetch=Qe,o.Headers=A,o.Request=He,o.Response=ct),s.Headers=A,s.Request=He,s.Response=ct,s.fetch=Qe,Object.defineProperty(s,"__esModule",{value:!0}),s})({})})(n),n.fetch.ponyfill=!0,delete n.fetch.polyfill;var i=n;t=i.fetch,t.default=i.fetch,t.fetch=i.fetch,t.Headers=i.Headers,t.Request=i.Request,t.Response=i.Response,e.exports=t})(CB,CB.exports);var k3=CB.exports;const P3=jb(k3),gI=rye({__proto__:null,default:P3},[k3]);class Mbe{constructor(t){this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=t.headers,this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=t.shouldThrowOnError,this.signal=t.signal,this.isMaybeSingle=t.isMaybeSingle,t.fetch?this.fetch=t.fetch:typeof fetch>"u"?this.fetch=P3:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}then(t,r){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const n=this.fetch;let i=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async o=>{var s,a,h;let p=null,y=null,S=null,E=o.status,O=o.statusText;if(o.ok){if(this.method!=="HEAD"){const j=await o.text();j===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?y=j:y=JSON.parse(j))}const $=(s=this.headers.Prefer)===null||s===void 0?void 0:s.match(/count=(exact|planned|estimated)/),B=(a=o.headers.get("content-range"))===null||a===void 0?void 0:a.split("/");$&&B&&B.length>1&&(S=parseInt(B[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(y)&&(y.length>1?(p={code:"PGRST116",details:`Results contain ${y.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},y=null,S=null,E=406,O="Not Acceptable"):y.length===1?y=y[0]:y=null)}else{const $=await o.text();try{p=JSON.parse($),Array.isArray(p)&&o.status===404&&(y=[],p=null,E=200,O="OK")}catch{o.status===404&&$===""?(E=204,O="No Content"):p={message:$}}if(p&&this.isMaybeSingle&&(!((h=p==null?void 0:p.details)===null||h===void 0)&&h.includes("Results contain 0 rows"))&&(p=null,E=200,O="OK"),p&&this.shouldThrowOnError)throw p}return{error:p,data:y,count:S,status:E,statusText:O}});return this.shouldThrowOnError||(i=i.catch(o=>{var s,a,h;return{error:{message:`${(s=o==null?void 0:o.name)!==null&&s!==void 0?s:"FetchError"}: ${o==null?void 0:o.message}`,details:`${(a=o==null?void 0:o.stack)!==null&&a!==void 0?a:""}`,hint:"",code:`${(h=o==null?void 0:o.code)!==null&&h!==void 0?h:""}`},data:null,count:null,status:0,statusText:""}})),i.then(t,r)}}class $be extends Mbe{select(t){let r=!1;const n=(t??"*").split("").map(i=>/\s/.test(i)&&!r?"":(i==='"'&&(r=!r),i)).join("");return this.url.searchParams.set("select",n),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(t,{ascending:r=!0,nullsFirst:n,foreignTable:i}={}){const o=i?`${i}.order`:"order",s=this.url.searchParams.get(o);return this.url.searchParams.set(o,`${s?`${s},`:""}${t}.${r?"asc":"desc"}${n===void 0?"":n?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:r}={}){const n=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(n,`${t}`),this}range(t,r,{foreignTable:n}={}){const i=typeof n>"u"?"offset":`${n}.offset`,o=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(i,`${t}`),this.url.searchParams.set(o,`${r-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:t=!1,verbose:r=!1,settings:n=!1,buffers:i=!1,wal:o=!1,format:s="text"}={}){const a=[t?"analyze":null,r?"verbose":null,n?"settings":null,i?"buffers":null,o?"wal":null].filter(Boolean).join("|"),h=this.headers.Accept;return this.headers.Accept=`application/vnd.pgrst.plan+${s}; for="${h}"; options=${a};`,s==="json"?this:this}rollback(){var t;return((t=this.headers.Prefer)!==null&&t!==void 0?t:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}class Ey extends $be{eq(t,r){return this.url.searchParams.append(t,`eq.${r}`),this}neq(t,r){return this.url.searchParams.append(t,`neq.${r}`),this}gt(t,r){return this.url.searchParams.append(t,`gt.${r}`),this}gte(t,r){return this.url.searchParams.append(t,`gte.${r}`),this}lt(t,r){return this.url.searchParams.append(t,`lt.${r}`),this}lte(t,r){return this.url.searchParams.append(t,`lte.${r}`),this}like(t,r){return this.url.searchParams.append(t,`like.${r}`),this}likeAllOf(t,r){return this.url.searchParams.append(t,`like(all).{${r.join(",")}}`),this}likeAnyOf(t,r){return this.url.searchParams.append(t,`like(any).{${r.join(",")}}`),this}ilike(t,r){return this.url.searchParams.append(t,`ilike.${r}`),this}ilikeAllOf(t,r){return this.url.searchParams.append(t,`ilike(all).{${r.join(",")}}`),this}ilikeAnyOf(t,r){return this.url.searchParams.append(t,`ilike(any).{${r.join(",")}}`),this}is(t,r){return this.url.searchParams.append(t,`is.${r}`),this}in(t,r){const n=r.map(i=>typeof i=="string"&&new RegExp("[,()]").test(i)?`"${i}"`:`${i}`).join(",");return this.url.searchParams.append(t,`in.(${n})`),this}contains(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cs.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cs.{${r.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(r)}`),this}containedBy(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cd.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cd.{${r.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(r)}`),this}rangeGt(t,r){return this.url.searchParams.append(t,`sr.${r}`),this}rangeGte(t,r){return this.url.searchParams.append(t,`nxl.${r}`),this}rangeLt(t,r){return this.url.searchParams.append(t,`sl.${r}`),this}rangeLte(t,r){return this.url.searchParams.append(t,`nxr.${r}`),this}rangeAdjacent(t,r){return this.url.searchParams.append(t,`adj.${r}`),this}overlaps(t,r){return typeof r=="string"?this.url.searchParams.append(t,`ov.${r}`):this.url.searchParams.append(t,`ov.{${r.join(",")}}`),this}textSearch(t,r,{config:n,type:i}={}){let o="";i==="plain"?o="pl":i==="phrase"?o="ph":i==="websearch"&&(o="w");const s=n===void 0?"":`(${n})`;return this.url.searchParams.append(t,`${o}fts${s}.${r}`),this}match(t){return Object.entries(t).forEach(([r,n])=>{this.url.searchParams.append(r,`eq.${n}`)}),this}not(t,r,n){return this.url.searchParams.append(t,`not.${r}.${n}`),this}or(t,{foreignTable:r}={}){const n=r?`${r}.or`:"or";return this.url.searchParams.append(n,`(${t})`),this}filter(t,r,n){return this.url.searchParams.append(t,`${r}.${n}`),this}}class Dbe{constructor(t,{headers:r={},schema:n,fetch:i}){this.url=t,this.headers=r,this.schema=n,this.fetch=i}select(t,{head:r=!1,count:n}={}){const i=r?"HEAD":"GET";let o=!1;const s=(t??"*").split("").map(a=>/\s/.test(a)&&!o?"":(a==='"'&&(o=!o),a)).join("");return this.url.searchParams.set("select",s),n&&(this.headers.Prefer=`count=${n}`),new Ey({method:i,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(t,{count:r,defaultToNull:n=!0}={}){const i="POST",o=[];if(this.headers.Prefer&&o.push(this.headers.Prefer),r&&o.push(`count=${r}`),n||o.push("missing=default"),this.headers.Prefer=o.join(","),Array.isArray(t)){const s=t.reduce((a,h)=>a.concat(Object.keys(h)),[]);if(s.length>0){const a=[...new Set(s)].map(h=>`"${h}"`);this.url.searchParams.set("columns",a.join(","))}}return new Ey({method:i,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}upsert(t,{onConflict:r,ignoreDuplicates:n=!1,count:i,defaultToNull:o=!0}={}){const s="POST",a=[`resolution=${n?"ignore":"merge"}-duplicates`];if(r!==void 0&&this.url.searchParams.set("on_conflict",r),this.headers.Prefer&&a.push(this.headers.Prefer),i&&a.push(`count=${i}`),o||a.push("missing=default"),this.headers.Prefer=a.join(","),Array.isArray(t)){const h=t.reduce((p,y)=>p.concat(Object.keys(y)),[]);if(h.length>0){const p=[...new Set(h)].map(y=>`"${y}"`);this.url.searchParams.set("columns",p.join(","))}}return new Ey({method:s,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}update(t,{count:r}={}){const n="PATCH",i=[];return this.headers.Prefer&&i.push(this.headers.Prefer),r&&i.push(`count=${r}`),this.headers.Prefer=i.join(","),new Ey({method:n,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}delete({count:t}={}){const r="DELETE",n=[];return t&&n.push(`count=${t}`),this.headers.Prefer&&n.unshift(this.headers.Prefer),this.headers.Prefer=n.join(","),new Ey({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}const Lbe="1.6.1",Nbe={"X-Client-Info":`postgrest-js/${Lbe}`};class Bbe{constructor(t,{headers:r={},schema:n,fetch:i}={}){this.url=t,this.headers=Object.assign(Object.assign({},Nbe),r),this.schema=n,this.fetch=i}from(t){const r=new URL(`${this.url}/${t}`);return new Dbe(r,{headers:Object.assign({},this.headers),schema:this.schema,fetch:this.fetch})}rpc(t,r={},{head:n=!1,count:i}={}){let o;const s=new URL(`${this.url}/rpc/${t}`);let a;n?(o="HEAD",Object.entries(r).forEach(([p,y])=>{s.searchParams.append(p,`${y}`)})):(o="POST",a=r);const h=Object.assign({},this.headers);return i&&(h.Prefer=`count=${i}`),new Ey({method:o,url:s,headers:h,schema:this.schema,body:a,fetch:this.fetch,allowEmpty:!1})}}var MD,L8;function jbe(){if(L8)return MD;L8=1;var e=function(){if(typeof self=="object"&&self)return self;if(typeof window=="object"&&window)return window;throw new Error("Unable to resolve global `this`")};return MD=function(){if(this)return this;if(typeof globalThis=="object"&&globalThis)return globalThis;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch{return e()}try{return __global__||e()}finally{delete Object.prototype.__global__}}(),MD}const Fbe="websocket",zbe="Websocket Client & Server Library implementing the WebSocket protocol as specified in RFC 6455.",Hbe=["websocket","websockets","socket","networking","comet","push","RFC-6455","realtime","server","client"],Vbe="Brian McKelvey <theturtle32@gmail.com> (https://github.com/theturtle32)",Ube=["Iaki Baz Castillo <ibc@aliax.net> (http://dev.sipdoc.net)"],Wbe="1.0.34",Gbe={type:"git",url:"https://github.com/theturtle32/WebSocket-Node.git"},Ybe="https://github.com/theturtle32/WebSocket-Node",Kbe={node:">=4.0.0"},qbe={bufferutil:"^4.0.1",debug:"^2.2.0","es5-ext":"^0.10.50","typedarray-to-buffer":"^3.1.5","utf-8-validate":"^5.0.2",yaeti:"^0.0.6"},Xbe={"buffer-equal":"^1.0.0",gulp:"^4.0.2","gulp-jshint":"^2.0.4","jshint-stylish":"^2.2.1",jshint:"^2.0.0",tape:"^4.9.1"},Zbe={verbose:!1},Jbe={test:"tape test/unit/*.js",gulp:"gulp"},Qbe="index",ewe={lib:"./lib"},twe="lib/browser.js",rwe="Apache-2.0",nwe={name:Fbe,description:zbe,keywords:Hbe,author:Vbe,contributors:Ube,version:Wbe,repository:Gbe,homepage:Ybe,engines:Kbe,dependencies:qbe,devDependencies:Xbe,config:Zbe,scripts:Jbe,main:Qbe,directories:ewe,browser:twe,license:rwe};var iwe=nwe.version,fp;if(typeof globalThis=="object")fp=globalThis;else try{fp=jbe()}catch{}finally{if(!fp&&typeof window<"u"&&(fp=window),!fp)throw new Error("Could not determine global this")}var S1=fp.WebSocket||fp.MozWebSocket,owe=iwe;function ioe(e,t){var r;return t?r=new S1(e,t):r=new S1(e),r}S1&&["CONNECTING","OPEN","CLOSING","CLOSED"].forEach(function(e){Object.defineProperty(ioe,e,{get:function(){return S1[e]}})});var awe={w3cwebsocket:S1?ioe:null,version:owe};const swe="2.7.2",lwe={"X-Client-Info":`realtime-js/${swe}`},uwe="1.0.0",ooe=1e4,cwe=1e3;var BS;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(BS||(BS={}));var rs;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(rs||(rs={}));var vl;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(vl||(vl={}));var EB;(function(e){e.websocket="websocket"})(EB||(EB={}));var hp;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(hp||(hp={}));class aoe{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}class fwe{constructor(){this.HEADER_LENGTH=1}decode(t,r){return t.constructor===ArrayBuffer?r(this._binaryDecode(t)):r(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const r=new DataView(t),n=new TextDecoder;return this._decodeBroadcast(t,r,n)}_decodeBroadcast(t,r,n){const i=r.getUint8(1),o=r.getUint8(2);let s=this.HEADER_LENGTH+2;const a=n.decode(t.slice(s,s+i));s=s+i;const h=n.decode(t.slice(s,s+o));s=s+o;const p=JSON.parse(n.decode(t.slice(s,t.byteLength)));return{ref:null,topic:a,event:h,payload:p}}}class $D{constructor(t,r,n={},i=ooe){this.channel=t,this.event=r,this.payload=n,this.timeout=i,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null,this.rateLimited=!1}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){if(this._hasReceived("timeout"))return;this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()})==="rate limited"&&(this.rateLimited=!0)}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var n;return this._hasReceived(t)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var N8;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(N8||(N8={}));class jS{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},i=>{const{onJoin:o,onLeave:s,onSync:a}=this.caller;this.joinRef=this.channel._joinRef(),this.state=jS.syncState(this.state,i,o,s),this.pendingDiffs.forEach(h=>{this.state=jS.syncDiff(this.state,h,o,s)}),this.pendingDiffs=[],a()}),this.channel._on(n.diff,{},i=>{const{onJoin:o,onLeave:s,onSync:a}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(i):(this.state=jS.syncDiff(this.state,i,o,s),a())}),this.onJoin((i,o,s)=>{this.channel._trigger("presence",{event:"join",key:i,currentPresences:o,newPresences:s})}),this.onLeave((i,o,s)=>{this.channel._trigger("presence",{event:"leave",key:i,currentPresences:o,leftPresences:s})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,n,i){const o=this.cloneDeep(t),s=this.transformState(r),a={},h={};return this.map(o,(p,y)=>{s[p]||(h[p]=y)}),this.map(s,(p,y)=>{const S=o[p];if(S){const E=y.map(B=>B.presence_ref),O=S.map(B=>B.presence_ref),A=y.filter(B=>O.indexOf(B.presence_ref)<0),$=S.filter(B=>E.indexOf(B.presence_ref)<0);A.length>0&&(a[p]=A),$.length>0&&(h[p]=$)}else a[p]=y}),this.syncDiff(o,{joins:a,leaves:h},n,i)}static syncDiff(t,r,n,i){const{joins:o,leaves:s}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),i||(i=()=>{}),this.map(o,(a,h)=>{var p;const y=(p=t[a])!==null&&p!==void 0?p:[];if(t[a]=this.cloneDeep(h),y.length>0){const S=t[a].map(O=>O.presence_ref),E=y.filter(O=>S.indexOf(O.presence_ref)<0);t[a].unshift(...E)}n(a,y,h)}),this.map(s,(a,h)=>{let p=t[a];if(!p)return;const y=h.map(S=>S.presence_ref);p=p.filter(S=>y.indexOf(S.presence_ref)<0),t[a]=p,i(a,p,h),p.length===0&&delete t[a]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(n=>r(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,n)=>{const i=t[n];return"metas"in i?r[n]=i.metas.map(o=>(o.presence_ref=o.phx_ref,delete o.phx_ref,delete o.phx_ref_prev,o)):r[n]=i,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var fi;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(fi||(fi={}));const B8=(e,t,r={})=>{var n;const i=(n=r.skipTypes)!==null&&n!==void 0?n:[];return Object.keys(t).reduce((o,s)=>(o[s]=hwe(s,e,t,i),o),{})},hwe=(e,t,r,n)=>{const i=t.find(a=>a.name===e),o=i==null?void 0:i.type,s=r[e];return o&&!n.includes(o)?soe(o,s):TB(s)},soe=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return gwe(t,r)}switch(e){case fi.bool:return dwe(t);case fi.float4:case fi.float8:case fi.int2:case fi.int4:case fi.int8:case fi.numeric:case fi.oid:return pwe(t);case fi.json:case fi.jsonb:return mwe(t);case fi.timestamp:return ywe(t);case fi.abstime:case fi.date:case fi.daterange:case fi.int4range:case fi.int8range:case fi.money:case fi.reltime:case fi.text:case fi.time:case fi.timestamptz:case fi.timetz:case fi.tsrange:case fi.tstzrange:return TB(t);default:return TB(t)}},TB=e=>e,dwe=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},pwe=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},mwe=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},gwe=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,n=e[r];if(e[0]==="{"&&n==="}"){let o;const s=e.slice(1,r);try{o=JSON.parse("["+s+"]")}catch{o=s?s.split(","):[]}return o.map(a=>soe(t,a))}return e},ywe=e=>typeof e=="string"?e.replace(" ","T"):e;var j8=globalThis&&globalThis.__awaiter||function(e,t,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(y){try{p(n.next(y))}catch(S){s(S)}}function h(y){try{p(n.throw(y))}catch(S){s(S)}}function p(y){y.done?o(y.value):i(y.value).then(a,h)}p((n=n.apply(e,t||[])).next())})},F8;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(F8||(F8={}));var z8;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes"})(z8||(z8={}));var H8;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(H8||(H8={}));class A3{constructor(t,r={config:{}},n){this.topic=t,this.params=r,this.socket=n,this.bindings={},this.state=rs.closed,this.joinedOnce=!1,this.pushBuffer=[],this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""}},r.config),this.timeout=this.socket.timeout,this.joinPush=new $D(this,vl.join,this.params,this.timeout),this.rejoinTimer=new aoe(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=rs.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(i=>i.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=rs.closed,this.socket._remove(this)}),this._onError(i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=rs.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=rs.errored,this.rejoinTimer.scheduleTimeout())}),this._on(vl.reply,{},(i,o)=>{this._trigger(this._replyEventName(o),i)}),this.presence=new jS(this)}subscribe(t,r=this.timeout){var n,i;if(this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:o,presence:s}}=this.params;this._onError(p=>t&&t("CHANNEL_ERROR",p)),this._onClose(()=>t&&t("CLOSED"));const a={},h={broadcast:o,presence:s,postgres_changes:(i=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(p=>p.filter))!==null&&i!==void 0?i:[]};this.socket.accessToken&&(a.access_token=this.socket.accessToken),this.updateJoinPayload(Object.assign({config:h},a)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",({postgres_changes:p})=>{var y;if(this.socket.accessToken&&this.socket.setAuth(this.socket.accessToken),p===void 0){t&&t("SUBSCRIBED");return}else{const S=this.bindings.postgres_changes,E=(y=S==null?void 0:S.length)!==null&&y!==void 0?y:0,O=[];for(let A=0;A<E;A++){const $=S[A],{filter:{event:B,schema:j,table:z,filter:W}}=$,Q=p&&p[A];if(Q&&Q.event===B&&Q.schema===j&&Q.table===z&&Q.filter===W)O.push(Object.assign(Object.assign({},$),{id:Q.id}));else{this.unsubscribe(),t&&t("CHANNEL_ERROR",new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=O,t&&t("SUBSCRIBED");return}}).receive("error",p=>{t&&t("CHANNEL_ERROR",new Error(JSON.stringify(Object.values(p).join(", ")||"error")))}).receive("timeout",()=>{t&&t("TIMED_OUT")})}return this}presenceState(){return this.presence.state}track(t,r={}){return j8(this,void 0,void 0,function*(){return yield this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)})}untrack(t={}){return j8(this,void 0,void 0,function*(){return yield this.send({type:"presence",event:"untrack"},t)})}on(t,r,n){return this._on(t,r,n)}send(t,r={}){return new Promise(n=>{var i,o,s;const a=this._push(t.type,t,r.timeout||this.timeout);a.rateLimited&&n("rate limited"),t.type==="broadcast"&&!(!((s=(o=(i=this.params)===null||i===void 0?void 0:i.config)===null||o===void 0?void 0:o.broadcast)===null||s===void 0)&&s.ack)&&n("ok"),a.receive("ok",()=>n("ok")),a.receive("timeout",()=>n("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=rs.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(vl.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise(n=>{const i=new $D(this,vl.leave,{},t);i.receive("ok",()=>{r(),n("ok")}).receive("timeout",()=>{r(),n("timed out")}).receive("error",()=>{n("error")}),i.send(),this._canPush()||i.trigger("ok",{})})}_push(t,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let i=new $D(this,t,r,n);return this._canPush()?i.send():(i.startTimeout(),this.pushBuffer.push(i)),i}_onMessage(t,r,n){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,n){var i,o;const s=t.toLocaleLowerCase(),{close:a,error:h,leave:p,join:y}=vl;if(n&&[a,h,p,y].indexOf(s)>=0&&n!==this._joinRef())return;let E=this._onMessage(s,r,n);if(r&&!E)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(s)?(i=this.bindings.postgres_changes)===null||i===void 0||i.filter(O=>{var A,$,B;return((A=O.filter)===null||A===void 0?void 0:A.event)==="*"||((B=($=O.filter)===null||$===void 0?void 0:$.event)===null||B===void 0?void 0:B.toLocaleLowerCase())===s}).map(O=>O.callback(E,n)):(o=this.bindings[s])===null||o===void 0||o.filter(O=>{var A,$,B,j,z,W;if(["broadcast","presence","postgres_changes"].includes(s))if("id"in O){const Q=O.id,q=(A=O.filter)===null||A===void 0?void 0:A.event;return Q&&(($=r.ids)===null||$===void 0?void 0:$.includes(Q))&&(q==="*"||(q==null?void 0:q.toLocaleLowerCase())===((B=r.data)===null||B===void 0?void 0:B.type.toLocaleLowerCase()))}else{const Q=(z=(j=O==null?void 0:O.filter)===null||j===void 0?void 0:j.event)===null||z===void 0?void 0:z.toLocaleLowerCase();return Q==="*"||Q===((W=r==null?void 0:r.event)===null||W===void 0?void 0:W.toLocaleLowerCase())}else return O.type.toLocaleLowerCase()===s}).map(O=>{if(typeof E=="object"&&"ids"in E){const A=E.data,{schema:$,table:B,commit_timestamp:j,type:z,errors:W}=A;E=Object.assign(Object.assign({},{schema:$,table:B,commit_timestamp:j,eventType:z,new:{},old:{},errors:W}),this._getPayloadRecords(A))}O.callback(E,n)})}_isClosed(){return this.state===rs.closed}_isJoined(){return this.state===rs.joined}_isJoining(){return this.state===rs.joining}_isLeaving(){return this.state===rs.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,n){const i=t.toLocaleLowerCase(),o={type:i,filter:r,callback:n};return this.bindings[i]?this.bindings[i].push(o):this.bindings[i]=[o],this}_off(t,r){const n=t.toLocaleLowerCase();return this.bindings[n]=this.bindings[n].filter(i=>{var o;return!(((o=i.type)===null||o===void 0?void 0:o.toLocaleLowerCase())===n&&A3.isEqual(i.filter,r))}),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(t[n]!==r[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(vl.close,{},t)}_onError(t){this._on(vl.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=rs.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=B8(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=B8(t.columns,t.old_record)),r}}var DD=globalThis&&globalThis.__awaiter||function(e,t,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(y){try{p(n.next(y))}catch(S){s(S)}}function h(y){try{p(n.throw(y))}catch(S){s(S)}}function p(y){y.done?o(y.value):i(y.value).then(a,h)}p((n=n.apply(e,t||[])).next())})};const vwe=()=>{};class _we{constructor(t,r){var n;this.accessToken=null,this.channels=[],this.endPoint="",this.headers=lwe,this.params={},this.timeout=ooe,this.transport=awe.w3cwebsocket,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=vwe,this.conn=null,this.sendBuffer=[],this.serializer=new fwe,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.eventsPerSecondLimitMs=100,this.inThrottle=!1,this.endPoint=`${t}/${EB.websocket}`,r!=null&&r.params&&(this.params=r.params),r!=null&&r.headers&&(this.headers=Object.assign(Object.assign({},this.headers),r.headers)),r!=null&&r.timeout&&(this.timeout=r.timeout),r!=null&&r.logger&&(this.logger=r.logger),r!=null&&r.transport&&(this.transport=r.transport),r!=null&&r.heartbeatIntervalMs&&(this.heartbeatIntervalMs=r.heartbeatIntervalMs);const i=(n=r==null?void 0:r.params)===null||n===void 0?void 0:n.eventsPerSecond;i&&(this.eventsPerSecondLimitMs=Math.floor(1e3/i)),this.reconnectAfterMs=r!=null&&r.reconnectAfterMs?r.reconnectAfterMs:o=>[1e3,2e3,5e3,1e4][o-1]||1e4,this.encode=r!=null&&r.encode?r.encode:(o,s)=>s(JSON.stringify(o)),this.decode=r!=null&&r.decode?r.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new aoe(()=>DD(this,void 0,void 0,function*(){this.disconnect(),this.connect()}),this.reconnectAfterMs)}connect(){this.conn||(this.conn=new this.transport(this._endPointURL(),[],null,this.headers),this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t)))}disconnect(t,r){this.conn&&(this.conn.onclose=function(){},t?this.conn.close(t,r??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}removeChannel(t){return DD(this,void 0,void 0,function*(){const r=yield t.unsubscribe();return this.channels.length===0&&this.disconnect(),r})}removeAllChannels(){return DD(this,void 0,void 0,function*(){const t=yield Promise.all(this.channels.map(r=>r.unsubscribe()));return this.disconnect(),t})}log(t,r,n){this.logger(t,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case BS.connecting:return hp.Connecting;case BS.open:return hp.Open;case BS.closing:return hp.Closing;default:return hp.Closed}}isConnected(){return this.connectionState()===hp.Open}channel(t,r={config:{}}){this.isConnected()||this.connect();const n=new A3(`realtime:${t}`,r,this);return this.channels.push(n),n}push(t){const{topic:r,event:n,payload:i,ref:o}=t;let s=()=>{this.encode(t,a=>{var h;(h=this.conn)===null||h===void 0||h.send(a)})};if(this.log("push",`${r} ${n} (${o})`,i),this.isConnected())if(["broadcast","presence","postgres_changes"].includes(n)){if(this._throttle(s)())return"rate limited"}else s();else this.sendBuffer.push(s)}setAuth(t){this.accessToken=t,this.channels.forEach(r=>{t&&r.updateJoinPayload({access_token:t}),r.joinedOnce&&r._isJoined()&&r._push(vl.access_token,{access_token:t})})}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r._joinRef()!==t._joinRef())}_endPointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:uwe}))}_onConnMessage(t){this.decode(t.data,r=>{let{topic:n,event:i,payload:o,ref:s}=r;(s&&s===this.pendingHeartbeatRef||i===(o==null?void 0:o.type))&&(this.pendingHeartbeatRef=null),this.log("receive",`${o.status||""} ${n} ${i} ${s&&"("+s+")"||""}`,o),this.channels.filter(a=>a._isMember(n)).forEach(a=>a._trigger(i,o,s)),this.stateChangeCallbacks.message.forEach(a=>a(r))})}_onConnOpen(){this.log("transport",`connected to ${this._endPointURL()}`),this._flushSendBuffer(),this.reconnectTimer.reset(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this._sendHeartbeat(),this.heartbeatIntervalMs),this.stateChangeCallbacks.open.forEach(t=>t())}_onConnClose(t){this.log("transport","close",t),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(r=>r(t))}_onConnError(t){this.log("transport",t.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(r=>r(t))}_triggerChanError(){this.channels.forEach(t=>t._trigger(vl.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const n=t.match(/\?/)?"&":"?",i=new URLSearchParams(r);return`${t}${n}${i}`}_flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_sendHeartbeat(){var t;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),(t=this.conn)===null||t===void 0||t.close(cwe,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth(this.accessToken)}}_throttle(t,r=this.eventsPerSecondLimitMs){return()=>this.inThrottle?!0:(t(),r>0&&(this.inThrottle=!0,setTimeout(()=>{this.inThrottle=!1},r)),!1)}}class I3 extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function Jo(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class bwe extends I3{constructor(t,r){super(t),this.name="StorageApiError",this.status=r}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class V8 extends I3{constructor(t,r){super(t),this.name="StorageUnknownError",this.originalError=r}}var loe=globalThis&&globalThis.__awaiter||function(e,t,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(y){try{p(n.next(y))}catch(S){s(S)}}function h(y){try{p(n.throw(y))}catch(S){s(S)}}function p(y){y.done?o(y.value):i(y.value).then(a,h)}p((n=n.apply(e,t||[])).next())})};const uoe=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>loe(void 0,void 0,void 0,function*(){return yield(yield mI(()=>Promise.resolve().then(()=>gI),void 0)).fetch(...r)}):t=fetch,(...r)=>t(...r)},wwe=()=>loe(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield mI(()=>Promise.resolve().then(()=>gI),void 0)).Response:Response});var Ub=globalThis&&globalThis.__awaiter||function(e,t,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(y){try{p(n.next(y))}catch(S){s(S)}}function h(y){try{p(n.throw(y))}catch(S){s(S)}}function p(y){y.done?o(y.value):i(y.value).then(a,h)}p((n=n.apply(e,t||[])).next())})};const LD=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),Swe=(e,t)=>Ub(void 0,void 0,void 0,function*(){const r=yield wwe();e instanceof r?e.json().then(n=>{t(new bwe(LD(n),e.status||500))}).catch(n=>{t(new V8(LD(n),n))}):t(new V8(LD(e),e))}),xwe=(e,t,r,n)=>{const i={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),i.body=JSON.stringify(n),Object.assign(Object.assign({},i),r))};function yI(e,t,r,n,i,o){return Ub(this,void 0,void 0,function*(){return new Promise((s,a)=>{e(r,xwe(t,n,i,o)).then(h=>{if(!h.ok)throw h;return n!=null&&n.noResolveJson?h:h.json()}).then(h=>s(h)).catch(h=>Swe(h,a))})})}function OB(e,t,r,n){return Ub(this,void 0,void 0,function*(){return yI(e,"GET",t,r,n)})}function eh(e,t,r,n,i){return Ub(this,void 0,void 0,function*(){return yI(e,"POST",t,n,i,r)})}function Cwe(e,t,r,n,i){return Ub(this,void 0,void 0,function*(){return yI(e,"PUT",t,n,i,r)})}function coe(e,t,r,n,i){return Ub(this,void 0,void 0,function*(){return yI(e,"DELETE",t,n,i,r)})}var Rs=globalThis&&globalThis.__awaiter||function(e,t,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(y){try{p(n.next(y))}catch(S){s(S)}}function h(y){try{p(n.throw(y))}catch(S){s(S)}}function p(y){y.done?o(y.value):i(y.value).then(a,h)}p((n=n.apply(e,t||[])).next())})};const Ewe={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},U8={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Twe{constructor(t,r={},n,i){this.url=t,this.headers=r,this.bucketId=n,this.fetch=uoe(i)}uploadOrUpdate(t,r,n,i){return Rs(this,void 0,void 0,function*(){try{let o;const s=Object.assign(Object.assign({},U8),i),a=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(s.upsert)});typeof Blob<"u"&&n instanceof Blob?(o=new FormData,o.append("cacheControl",s.cacheControl),o.append("",n)):typeof FormData<"u"&&n instanceof FormData?(o=n,o.append("cacheControl",s.cacheControl)):(o=n,a["cache-control"]=`max-age=${s.cacheControl}`,a["content-type"]=s.contentType);const h=this._removeEmptyFolders(r),p=this._getFinalPath(h),y=yield this.fetch(`${this.url}/object/${p}`,Object.assign({method:t,body:o,headers:a},s!=null&&s.duplex?{duplex:s.duplex}:{}));return y.ok?{data:{path:h},error:null}:{data:null,error:yield y.json()}}catch(o){if(Jo(o))return{data:null,error:o};throw o}})}upload(t,r,n){return Rs(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,r,n)})}uploadToSignedUrl(t,r,n,i){return Rs(this,void 0,void 0,function*(){const o=this._removeEmptyFolders(t),s=this._getFinalPath(o),a=new URL(this.url+`/object/upload/sign/${s}`);a.searchParams.set("token",r);try{let h;const p=Object.assign({upsert:U8.upsert},i),y=Object.assign(Object.assign({},this.headers),{"x-upsert":String(p.upsert)});typeof Blob<"u"&&n instanceof Blob?(h=new FormData,h.append("cacheControl",p.cacheControl),h.append("",n)):typeof FormData<"u"&&n instanceof FormData?(h=n,h.append("cacheControl",p.cacheControl)):(h=n,y["cache-control"]=`max-age=${p.cacheControl}`,y["content-type"]=p.contentType);const S=yield this.fetch(a.toString(),{method:"PUT",body:h,headers:y});return S.ok?{data:{path:o},error:null}:{data:null,error:yield S.json()}}catch(h){if(Jo(h))return{data:null,error:h};throw h}})}createSignedUploadUrl(t){return Rs(this,void 0,void 0,function*(){try{let r=this._getFinalPath(t);const n=yield eh(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:this.headers}),i=new URL(this.url+n.url),o=i.searchParams.get("token");if(!o)throw new I3("No token returned by API");return{data:{signedUrl:i.toString(),path:t,token:o},error:null}}catch(r){if(Jo(r))return{data:null,error:r};throw r}})}update(t,r,n){return Rs(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,r,n)})}move(t,r){return Rs(this,void 0,void 0,function*(){try{return{data:yield eh(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r},{headers:this.headers}),error:null}}catch(n){if(Jo(n))return{data:null,error:n};throw n}})}copy(t,r){return Rs(this,void 0,void 0,function*(){try{return{data:{path:(yield eh(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r},{headers:this.headers})).Key},error:null}}catch(n){if(Jo(n))return{data:null,error:n};throw n}})}createSignedUrl(t,r,n){return Rs(this,void 0,void 0,function*(){try{let i=this._getFinalPath(t),o=yield eh(this.fetch,`${this.url}/object/sign/${i}`,Object.assign({expiresIn:r},n!=null&&n.transform?{transform:n.transform}:{}),{headers:this.headers});const s=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return o={signedUrl:encodeURI(`${this.url}${o.signedURL}${s}`)},{data:o,error:null}}catch(i){if(Jo(i))return{data:null,error:i};throw i}})}createSignedUrls(t,r,n){return Rs(this,void 0,void 0,function*(){try{const i=yield eh(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:t},{headers:this.headers}),o=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:i.map(s=>Object.assign(Object.assign({},s),{signedUrl:s.signedURL?encodeURI(`${this.url}${s.signedURL}${o}`):null})),error:null}}catch(i){if(Jo(i))return{data:null,error:i};throw i}})}download(t,r){return Rs(this,void 0,void 0,function*(){const i=typeof(r==null?void 0:r.transform)<"u"?"render/image/authenticated":"object",o=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),s=o?`?${o}`:"";try{const a=this._getFinalPath(t);return{data:yield(yield OB(this.fetch,`${this.url}/${i}/${a}${s}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(a){if(Jo(a))return{data:null,error:a};throw a}})}getPublicUrl(t,r){const n=this._getFinalPath(t),i=[],o=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";o!==""&&i.push(o);const a=typeof(r==null?void 0:r.transform)<"u"?"render/image":"object",h=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});h!==""&&i.push(h);let p=i.join("&");return p!==""&&(p=`?${p}`),{data:{publicUrl:encodeURI(`${this.url}/${a}/public/${n}${p}`)}}}remove(t){return Rs(this,void 0,void 0,function*(){try{return{data:yield coe(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(r){if(Jo(r))return{data:null,error:r};throw r}})}list(t,r,n){return Rs(this,void 0,void 0,function*(){try{const i=Object.assign(Object.assign(Object.assign({},Ewe),r),{prefix:t||""});return{data:yield eh(this.fetch,`${this.url}/object/list/${this.bucketId}`,i,{headers:this.headers},n),error:null}}catch(i){if(Jo(i))return{data:null,error:i};throw i}})}_getFinalPath(t){return`${this.bucketId}/${t}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const r=[];return t.width&&r.push(`width=${t.width}`),t.height&&r.push(`height=${t.height}`),t.resize&&r.push(`resize=${t.resize}`),t.format&&r.push(`format=${t.format}`),t.quality&&r.push(`quality=${t.quality}`),r.join("&")}}const Owe="2.5.1",Rwe={"X-Client-Info":`storage-js/${Owe}`};var Ug=globalThis&&globalThis.__awaiter||function(e,t,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(y){try{p(n.next(y))}catch(S){s(S)}}function h(y){try{p(n.throw(y))}catch(S){s(S)}}function p(y){y.done?o(y.value):i(y.value).then(a,h)}p((n=n.apply(e,t||[])).next())})};class kwe{constructor(t,r={},n){this.url=t,this.headers=Object.assign(Object.assign({},Rwe),r),this.fetch=uoe(n)}listBuckets(){return Ug(this,void 0,void 0,function*(){try{return{data:yield OB(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(Jo(t))return{data:null,error:t};throw t}})}getBucket(t){return Ug(this,void 0,void 0,function*(){try{return{data:yield OB(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(r){if(Jo(r))return{data:null,error:r};throw r}})}createBucket(t,r={public:!1}){return Ug(this,void 0,void 0,function*(){try{return{data:yield eh(this.fetch,`${this.url}/bucket`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(Jo(n))return{data:null,error:n};throw n}})}updateBucket(t,r){return Ug(this,void 0,void 0,function*(){try{return{data:yield Cwe(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(Jo(n))return{data:null,error:n};throw n}})}emptyBucket(t){return Ug(this,void 0,void 0,function*(){try{return{data:yield eh(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(Jo(r))return{data:null,error:r};throw r}})}deleteBucket(t){return Ug(this,void 0,void 0,function*(){try{return{data:yield coe(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(Jo(r))return{data:null,error:r};throw r}})}}class Pwe extends kwe{constructor(t,r={},n){super(t,r,n)}from(t){return new Twe(this.url,this.headers,t,this.fetch)}}const Awe="2.22.0",Iwe={"X-Client-Info":`supabase-js/${Awe}`};var Mwe=globalThis&&globalThis.__awaiter||function(e,t,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(y){try{p(n.next(y))}catch(S){s(S)}}function h(y){try{p(n.throw(y))}catch(S){s(S)}}function p(y){y.done?o(y.value):i(y.value).then(a,h)}p((n=n.apply(e,t||[])).next())})};const $we=e=>{let t;return e?t=e:typeof fetch>"u"?t=P3:t=fetch,(...r)=>t(...r)},Dwe=()=>typeof Headers>"u"?k3.Headers:Headers,Lwe=(e,t,r)=>{const n=$we(r),i=Dwe();return(o,s)=>Mwe(void 0,void 0,void 0,function*(){var a;const h=(a=yield t())!==null&&a!==void 0?a:e;let p=new i(s==null?void 0:s.headers);return p.has("apikey")||p.set("apikey",e),p.has("Authorization")||p.set("Authorization",`Bearer ${h}`),n(o,Object.assign(Object.assign({},s),{headers:p}))})};function Nwe(e){return e.replace(/\/$/,"")}function Bwe(e,t){const{db:r,auth:n,realtime:i,global:o}=e,{db:s,auth:a,realtime:h,global:p}=t;return{db:Object.assign(Object.assign({},s),r),auth:Object.assign(Object.assign({},a),n),realtime:Object.assign(Object.assign({},h),i),global:Object.assign(Object.assign({},p),o)}}var Om=globalThis&&globalThis.__awaiter||function(e,t,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(y){try{p(n.next(y))}catch(S){s(S)}}function h(y){try{p(n.throw(y))}catch(S){s(S)}}function p(y){y.done?o(y.value):i(y.value).then(a,h)}p((n=n.apply(e,t||[])).next())})};function jwe(e){return Math.round(Date.now()/1e3)+e}function Fwe(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0;return(e=="x"?t:t&3|8).toString(16)})}const Xf=()=>typeof document<"u",Vd={tested:!1,writable:!1},ND=()=>{if(!Xf())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Vd.tested)return Vd.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),Vd.tested=!0,Vd.writable=!0}catch{Vd.tested=!0,Vd.writable=!1}return Vd.writable};function $a(e,t){var r;t||(t=((r=window==null?void 0:window.location)===null||r===void 0?void 0:r.href)||""),e=e.replace(/[\[\]]/g,"\\$&");const n=new RegExp("[?&#]"+e+"(=([^&#]*)|&|#|$)"),i=n.exec(t);return i?i[2]?decodeURIComponent(i[2].replace(/\+/g," ")):"":null}const foe=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>Om(void 0,void 0,void 0,function*(){return yield(yield mI(()=>Promise.resolve().then(()=>gI),void 0)).fetch(...r)}):t=fetch,(...r)=>t(...r)},zwe=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",j0=(e,t,r)=>Om(void 0,void 0,void 0,function*(){yield e.setItem(t,JSON.stringify(r))}),DO=(e,t)=>Om(void 0,void 0,void 0,function*(){const r=yield e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}}),BD=(e,t)=>Om(void 0,void 0,void 0,function*(){yield e.removeItem(t)});function Hwe(e){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let r="",n,i,o,s,a,h,p,y=0;for(e=e.replace("-","+").replace("_","/");y<e.length;)s=t.indexOf(e.charAt(y++)),a=t.indexOf(e.charAt(y++)),h=t.indexOf(e.charAt(y++)),p=t.indexOf(e.charAt(y++)),n=s<<2|a>>4,i=(a&15)<<4|h>>2,o=(h&3)<<6|p,r=r+String.fromCharCode(n),h!=64&&i!=0&&(r=r+String.fromCharCode(i)),p!=64&&o!=0&&(r=r+String.fromCharCode(o));return r}class vI{constructor(){this.promise=new vI.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}vI.promiseConstructor=Promise;function W8(e){const t=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}=?$|[a-z0-9_-]{2}(==)?$)$/i,r=e.split(".");if(r.length!==3)throw new Error("JWT is not valid: not a JWT structure");if(!t.test(r[1]))throw new Error("JWT is not valid: payload is not in base64url format");const n=r[1];return JSON.parse(Hwe(n))}function Vwe(e){return new Promise(t=>{setTimeout(()=>t(null),e)})}function Uwe(e,t){return new Promise((n,i)=>{Om(this,void 0,void 0,function*(){for(let o=0;o<1/0;o++)try{const s=yield e(o);if(!t(o,null,s)){n(s);return}}catch(s){if(!t(o,s)){i(s);return}}})})}function Wwe(e){return("0"+e.toString(16)).substr(-2)}function LO(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let i="";for(let o=0;o<56;o++)i+=r.charAt(Math.floor(Math.random()*n));return i}return crypto.getRandomValues(t),Array.from(t,Wwe).join("")}function Gwe(e){return Om(this,void 0,void 0,function*(){const r=new TextEncoder().encode(e),n=yield crypto.subtle.digest("SHA-256",r),i=new Uint8Array(n);return Array.from(i).map(o=>String.fromCharCode(o)).join("")})}function Ywe(e){return btoa(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}function NO(e){return Om(this,void 0,void 0,function*(){if(typeof crypto>"u")return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const t=yield Gwe(e);return Ywe(t)})}class M3 extends Error{constructor(t,r){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r}}function jn(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class Kwe extends M3{constructor(t,r){super(t,r),this.name="AuthApiError",this.status=r}toJSON(){return{name:this.name,message:this.message,status:this.status}}}function qwe(e){return jn(e)&&e.name==="AuthApiError"}class hoe extends M3{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class FC extends M3{constructor(t,r,n){super(t),this.name=r,this.status=n}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class Wg extends FC{constructor(){super("Auth session missing!","AuthSessionMissingError",400)}}class BO extends FC{constructor(t){super(t,"AuthInvalidCredentialsError",400)}}class Yu extends FC{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class jD extends FC{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class RB extends FC{constructor(t,r){super(t,"AuthRetryableFetchError",r)}}var $3=globalThis&&globalThis.__awaiter||function(e,t,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(y){try{p(n.next(y))}catch(S){s(S)}}function h(y){try{p(n.throw(y))}catch(S){s(S)}}function p(y){y.done?o(y.value):i(y.value).then(a,h)}p((n=n.apply(e,t||[])).next())})},Xwe=globalThis&&globalThis.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r};const jO=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),Zwe=(e,t)=>$3(void 0,void 0,void 0,function*(){const r=[502,503,504];zwe(e)?r.includes(e.status)?t(new RB(jO(e),e.status)):e.json().then(n=>{t(new Kwe(jO(n),e.status||500))}).catch(n=>{t(new hoe(jO(n),n))}):t(new RB(jO(e),0))}),Jwe=(e,t,r,n)=>{const i={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),i.body=JSON.stringify(n),Object.assign(Object.assign({},i),r))};function Gn(e,t,r,n){var i;return $3(this,void 0,void 0,function*(){const o=Object.assign({},n==null?void 0:n.headers);n!=null&&n.jwt&&(o.Authorization=`Bearer ${n.jwt}`);const s=(i=n==null?void 0:n.query)!==null&&i!==void 0?i:{};n!=null&&n.redirectTo&&(s.redirect_to=n.redirectTo);const a=Object.keys(s).length?"?"+new URLSearchParams(s).toString():"",h=yield Qwe(e,t,r+a,{headers:o,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(h):{data:Object.assign({},h),error:null}})}function Qwe(e,t,r,n,i,o){return $3(this,void 0,void 0,function*(){return new Promise((s,a)=>{e(r,Jwe(t,n,i,o)).then(h=>{if(!h.ok)throw h;return n!=null&&n.noResolveJson?h:h.json()}).then(h=>s(h)).catch(h=>Zwe(h,a))})})}function Ff(e){var t;let r=null;n0e(e)&&(r=Object.assign({},e),r.expires_at=jwe(e.expires_in));const n=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:n},error:null}}function dp(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function e0e(e){return{data:e,error:null}}function t0e(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:i,verification_type:o}=e,s=Xwe(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),a={action_link:t,email_otp:r,hashed_token:n,redirect_to:i,verification_type:o},h=Object.assign({},s);return{data:{properties:a,user:h},error:null}}function r0e(e){return e}function n0e(e){return e.access_token&&e.refresh_token&&e.expires_in}var Jl=globalThis&&globalThis.__awaiter||function(e,t,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(y){try{p(n.next(y))}catch(S){s(S)}}function h(y){try{p(n.throw(y))}catch(S){s(S)}}function p(y){y.done?o(y.value):i(y.value).then(a,h)}p((n=n.apply(e,t||[])).next())})},i0e=globalThis&&globalThis.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r};class o0e{constructor({url:t="",headers:r={},fetch:n}){this.url=t,this.headers=r,this.fetch=foe(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}signOut(t){return Jl(this,void 0,void 0,function*(){try{return yield Gn(this.fetch,"POST",`${this.url}/logout`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(r){if(jn(r))return{data:null,error:r};throw r}})}inviteUserByEmail(t,r={}){return Jl(this,void 0,void 0,function*(){try{return yield Gn(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:dp})}catch(n){if(jn(n))return{data:{user:null},error:n};throw n}})}generateLink(t){return Jl(this,void 0,void 0,function*(){try{const{options:r}=t,n=i0e(t,["options"]),i=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(i.new_email=n==null?void 0:n.newEmail,delete i.newEmail),yield Gn(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:i,headers:this.headers,xform:t0e,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(jn(r))return{data:{properties:null,user:null},error:r};throw r}})}createUser(t){return Jl(this,void 0,void 0,function*(){try{return yield Gn(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:dp})}catch(r){if(jn(r))return{data:{user:null},error:r};throw r}})}listUsers(t){var r,n,i,o,s,a,h;return Jl(this,void 0,void 0,function*(){try{const p={nextPage:null,lastPage:0,total:0},y=yield Gn(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(o=(i=t==null?void 0:t.perPage)===null||i===void 0?void 0:i.toString())!==null&&o!==void 0?o:""},xform:r0e});if(y.error)throw y.error;const S=yield y.json(),E=(s=y.headers.get("x-total-count"))!==null&&s!==void 0?s:0,O=(h=(a=y.headers.get("link"))===null||a===void 0?void 0:a.split(","))!==null&&h!==void 0?h:[];return O.length>0&&(O.forEach(A=>{const $=parseInt(A.split(";")[0].split("=")[1].substring(0,1)),B=JSON.parse(A.split(";")[1].split("=")[1]);p[`${B}Page`]=$}),p.total=parseInt(E)),{data:Object.assign(Object.assign({},S),p),error:null}}catch(p){if(jn(p))return{data:{users:[]},error:p};throw p}})}getUserById(t){return Jl(this,void 0,void 0,function*(){try{return yield Gn(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:dp})}catch(r){if(jn(r))return{data:{user:null},error:r};throw r}})}updateUserById(t,r){return Jl(this,void 0,void 0,function*(){try{return yield Gn(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:dp})}catch(n){if(jn(n))return{data:{user:null},error:n};throw n}})}deleteUser(t,r=!1){return Jl(this,void 0,void 0,function*(){try{return yield Gn(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:dp})}catch(n){if(jn(n))return{data:{user:null},error:n};throw n}})}_listFactors(t){return Jl(this,void 0,void 0,function*(){try{const{data:r,error:n}=yield Gn(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:i=>({data:{factors:i},error:null})});return{data:r,error:n}}catch(r){if(jn(r))return{data:null,error:r};throw r}})}_deleteFactor(t){return Jl(this,void 0,void 0,function*(){try{return{data:yield Gn(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(jn(r))return{data:null,error:r};throw r}})}}const a0e="2.27.2",s0e="http://localhost:9999",l0e="supabase.auth.token",u0e={"X-Client-Info":`gotrue-js/${a0e}`},c0e=10,f0e={getItem:e=>ND()?globalThis.localStorage.getItem(e):null,setItem:(e,t)=>{ND()&&globalThis.localStorage.setItem(e,t)},removeItem:e=>{ND()&&globalThis.localStorage.removeItem(e)}};function h0e(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}var en=globalThis&&globalThis.__awaiter||function(e,t,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(y){try{p(n.next(y))}catch(S){s(S)}}function h(y){try{p(n.throw(y))}catch(S){s(S)}}function p(y){y.done?o(y.value):i(y.value).then(a,h)}p((n=n.apply(e,t||[])).next())})};h0e();const d0e={url:s0e,storageKey:l0e,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:u0e,flowType:"implicit"},FD=30*1e3,p0e=3;class m0e{constructor(t){var r;this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.broadcastChannel=null;const n=Object.assign(Object.assign({},d0e),t);if(this.inMemorySession=null,this.storageKey=n.storageKey,this.autoRefreshToken=n.autoRefreshToken,this.persistSession=n.persistSession,this.storage=n.storage||f0e,this.admin=new o0e({url:n.url,headers:n.headers,fetch:n.fetch}),this.url=n.url,this.headers=n.headers,this.fetch=foe(n.fetch),this.detectSessionInUrl=n.detectSessionInUrl,this.flowType=n.flowType,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},Xf()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(r=this.broadcastChannel)===null||r===void 0||r.addEventListener("message",i=>{this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}initialize(){return this.initializePromise||(this.initializePromise=this._initialize()),this.initializePromise}_initialize(){return en(this,void 0,void 0,function*(){if(this.initializePromise)return this.initializePromise;try{const t=yield this._isPKCEFlow();if(this.detectSessionInUrl&&this._isImplicitGrantFlow()||t){const{data:r,error:n}=yield this._getSessionFromUrl(t);if(n)return yield this._removeSession(),{error:n};const{session:i,redirectType:o}=r;return yield this._saveSession(i),setTimeout(()=>{o==="recovery"?this._notifyAllSubscribers("PASSWORD_RECOVERY",i):this._notifyAllSubscribers("SIGNED_IN",i)},0),{error:null}}return yield this._recoverAndRefresh(),{error:null}}catch(t){return jn(t)?{error:t}:{error:new hoe("Unexpected error during initialization",t)}}finally{yield this._handleVisibilityChange()}})}signUp(t){var r,n,i;return en(this,void 0,void 0,function*(){try{yield this._removeSession();let o;if("email"in t){const{email:y,password:S,options:E}=t;let O=null,A=null;if(this.flowType==="pkce"){const $=LO();yield j0(this.storage,`${this.storageKey}-code-verifier`,$),O=yield NO($),A=$===O?"plain":"s256"}o=yield Gn(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:E==null?void 0:E.emailRedirectTo,body:{email:y,password:S,data:(r=E==null?void 0:E.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:E==null?void 0:E.captchaToken},code_challenge:O,code_challenge_method:A},xform:Ff})}else if("phone"in t){const{phone:y,password:S,options:E}=t;o=yield Gn(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:y,password:S,data:(n=E==null?void 0:E.data)!==null&&n!==void 0?n:{},channel:(i=E==null?void 0:E.channel)!==null&&i!==void 0?i:"sms",gotrue_meta_security:{captcha_token:E==null?void 0:E.captchaToken}},xform:Ff})}else throw new BO("You must provide either an email or phone number and a password");const{data:s,error:a}=o;if(a||!s)return{data:{user:null,session:null},error:a};const h=s.session,p=s.user;return s.session&&(yield this._saveSession(s.session),this._notifyAllSubscribers("SIGNED_IN",h)),{data:{user:p,session:h},error:null}}catch(o){if(jn(o))return{data:{user:null,session:null},error:o};throw o}})}signInWithPassword(t){return en(this,void 0,void 0,function*(){try{yield this._removeSession();let r;if("email"in t){const{email:o,password:s,options:a}=t;r=yield Gn(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:o,password:s,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:Ff})}else if("phone"in t){const{phone:o,password:s,options:a}=t;r=yield Gn(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:o,password:s,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:Ff})}else throw new BO("You must provide either an email or phone number and a password");const{data:n,error:i}=r;return i||!n?{data:{user:null,session:null},error:i}:(n.session&&(yield this._saveSession(n.session),this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:n,error:i})}catch(r){if(jn(r))return{data:{user:null,session:null},error:r};throw r}})}signInWithOAuth(t){var r,n,i,o;return en(this,void 0,void 0,function*(){return yield this._removeSession(),yield this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(i=t.options)===null||i===void 0?void 0:i.queryParams,skipBrowserRedirect:(o=t.options)===null||o===void 0?void 0:o.skipBrowserRedirect})})}exchangeCodeForSession(t){return en(this,void 0,void 0,function*(){const r=yield DO(this.storage,`${this.storageKey}-code-verifier`),{data:n,error:i}=yield Gn(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:r},xform:Ff});return yield BD(this.storage,`${this.storageKey}-code-verifier`),i||!n?{data:{user:null,session:null},error:i}:(n.session&&(yield this._saveSession(n.session),this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:n,error:i})})}signInWithIdToken(t){return en(this,void 0,void 0,function*(){yield this._removeSession();try{const{options:r,provider:n,token:i,nonce:o}=t,s=yield Gn(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:i,nonce:o,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:Ff}),{data:a,error:h}=s;return h||!a?{data:{user:null,session:null},error:h}:(a.session&&(yield this._saveSession(a.session),this._notifyAllSubscribers("SIGNED_IN",a.session)),{data:a,error:h})}catch(r){if(jn(r))return{data:{user:null,session:null},error:r};throw r}})}signInWithOtp(t){var r,n,i,o,s;return en(this,void 0,void 0,function*(){try{if(yield this._removeSession(),"email"in t){const{email:a,options:h}=t;let p=null,y=null;if(this.flowType==="pkce"){const E=LO();yield j0(this.storage,`${this.storageKey}-code-verifier`,E),p=yield NO(E),y=E===p?"plain":"s256"}const{error:S}=yield Gn(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:a,data:(r=h==null?void 0:h.data)!==null&&r!==void 0?r:{},create_user:(n=h==null?void 0:h.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken},code_challenge:p,code_challenge_method:y},redirectTo:h==null?void 0:h.emailRedirectTo});return{data:{user:null,session:null},error:S}}if("phone"in t){const{phone:a,options:h}=t,{error:p}=yield Gn(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:a,data:(i=h==null?void 0:h.data)!==null&&i!==void 0?i:{},create_user:(o=h==null?void 0:h.shouldCreateUser)!==null&&o!==void 0?o:!0,gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken},channel:(s=h==null?void 0:h.channel)!==null&&s!==void 0?s:"sms"}});return{data:{user:null,session:null},error:p}}throw new BO("You must provide either an email or phone number.")}catch(a){if(jn(a))return{data:{user:null,session:null},error:a};throw a}})}verifyOtp(t){var r,n;return en(this,void 0,void 0,function*(){try{yield this._removeSession();const{data:i,error:o}=yield Gn(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:(r=t.options)===null||r===void 0?void 0:r.captchaToken}}),redirectTo:(n=t.options)===null||n===void 0?void 0:n.redirectTo,xform:Ff});if(o)throw o;if(!i)throw new Error("An error occurred on token verification.");const s=i.session,a=i.user;return s!=null&&s.access_token&&(yield this._saveSession(s),this._notifyAllSubscribers("SIGNED_IN",s)),{data:{user:a,session:s},error:null}}catch(i){if(jn(i))return{data:{user:null,session:null},error:i};throw i}})}signInWithSSO(t){var r,n,i;return en(this,void 0,void 0,function*(){try{return yield this._removeSession(),yield Gn(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((i=t==null?void 0:t.options)===null||i===void 0)&&i.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0}),headers:this.headers,xform:e0e})}catch(o){if(jn(o))return{data:null,error:o};throw o}})}reauthenticate(){return en(this,void 0,void 0,function*(){try{const{data:{session:t},error:r}=yield this.getSession();if(r)throw r;if(!t)throw new Wg;const{error:n}=yield Gn(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:n}}catch(t){if(jn(t))return{data:{user:null,session:null},error:t};throw t}})}resend(t){return en(this,void 0,void 0,function*(){try{yield this._removeSession();const r=`${this.url}/resend`;if("email"in t){const{email:n,type:i,options:o}=t,{error:s}=yield Gn(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:i,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}}});return{data:{user:null,session:null},error:s}}else if("phone"in t){const{phone:n,type:i,options:o}=t,{error:s}=yield Gn(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:i,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}}});return{data:{user:null,session:null},error:s}}throw new BO("You must provide either an email or phone number and a type")}catch(r){if(jn(r))return{data:{user:null,session:null},error:r};throw r}})}getSession(){return en(this,void 0,void 0,function*(){yield this.initializePromise;let t=null;if(this.persistSession){const o=yield DO(this.storage,this.storageKey);o!==null&&(this._isValidSession(o)?t=o:yield this._removeSession())}else t=this.inMemorySession;if(!t)return{data:{session:null},error:null};if(!(t.expires_at?t.expires_at<=Date.now()/1e3:!1))return{data:{session:t},error:null};const{session:n,error:i}=yield this._callRefreshToken(t.refresh_token);return i?{data:{session:null},error:i}:{data:{session:n},error:null}})}getUser(t){var r,n;return en(this,void 0,void 0,function*(){try{if(!t){const{data:i,error:o}=yield this.getSession();if(o)throw o;t=(n=(r=i.session)===null||r===void 0?void 0:r.access_token)!==null&&n!==void 0?n:void 0}return yield Gn(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:dp})}catch(i){if(jn(i))return{data:{user:null},error:i};throw i}})}updateUser(t,r={}){return en(this,void 0,void 0,function*(){try{const{data:n,error:i}=yield this.getSession();if(i)throw i;if(!n.session)throw new Wg;const o=n.session,{data:s,error:a}=yield Gn(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:t,jwt:o.access_token,xform:dp});if(a)throw a;return o.user=s.user,yield this._saveSession(o),this._notifyAllSubscribers("USER_UPDATED",o),{data:{user:o.user},error:null}}catch(n){if(jn(n))return{data:{user:null},error:n};throw n}})}_decodeJWT(t){return W8(t)}setSession(t){return en(this,void 0,void 0,function*(){try{if(!t.access_token||!t.refresh_token)throw new Wg;const r=Date.now()/1e3;let n=r,i=!0,o=null;const s=W8(t.access_token);if(s.exp&&(n=s.exp,i=n<=r),i){const{session:a,error:h}=yield this._callRefreshToken(t.refresh_token);if(h)return{data:{user:null,session:null},error:h};if(!a)return{data:{user:null,session:null},error:null};o=a}else{const{data:a,error:h}=yield this.getUser(t.access_token);if(h)throw h;o={access_token:t.access_token,refresh_token:t.refresh_token,user:a.user,token_type:"bearer",expires_in:n-r,expires_at:n},yield this._saveSession(o),this._notifyAllSubscribers("SIGNED_IN",o)}return{data:{user:o.user,session:o},error:null}}catch(r){if(jn(r))return{data:{session:null,user:null},error:r};throw r}})}refreshSession(t){var r;return en(this,void 0,void 0,function*(){try{if(!t){const{data:o,error:s}=yield this.getSession();if(s)throw s;t=(r=o.session)!==null&&r!==void 0?r:void 0}if(!(t!=null&&t.refresh_token))throw new Wg;const{session:n,error:i}=yield this._callRefreshToken(t.refresh_token);return i?{data:{user:null,session:null},error:i}:n?{data:{user:n.user,session:n},error:null}:{data:{user:null,session:null},error:null}}catch(n){if(jn(n))return{data:{user:null,session:null},error:n};throw n}})}_getSessionFromUrl(t){return en(this,void 0,void 0,function*(){try{if(!Xf())throw new Yu("No browser detected.");if(this.flowType==="implicit"&&!this._isImplicitGrantFlow())throw new Yu("Not a valid implicit grant flow url.");if(this.flowType=="pkce"&&!t)throw new jD("Not a valid PKCE flow url.");if(t){const B=$a("code");if(!B)throw new jD("No code detected.");const{data:j,error:z}=yield this.exchangeCodeForSession(B);if(z)throw z;if(!j.session)throw new jD("No session detected.");let W=new URL(window.location.href);return W.searchParams.delete("code"),window.history.replaceState(window.history.state,"",W.toString()),{data:{session:j.session,redirectType:null},error:null}}const r=$a("error_description");if(r){const B=$a("error_code");if(!B)throw new Yu("No error_code detected.");const j=$a("error");throw j?new Yu(r,{error:j,code:B}):new Yu("No error detected.")}const n=$a("provider_token"),i=$a("provider_refresh_token"),o=$a("access_token");if(!o)throw new Yu("No access_token detected.");const s=$a("expires_in");if(!s)throw new Yu("No expires_in detected.");const a=$a("refresh_token");if(!a)throw new Yu("No refresh_token detected.");const h=$a("token_type");if(!h)throw new Yu("No token_type detected.");const y=Math.round(Date.now()/1e3)+parseInt(s),{data:S,error:E}=yield this.getUser(o);if(E)throw E;const O=S.user,A={provider_token:n,provider_refresh_token:i,access_token:o,expires_in:parseInt(s),expires_at:y,refresh_token:a,token_type:h,user:O},$=$a("type");return window.location.hash="",{data:{session:A,redirectType:$},error:null}}catch(r){if(jn(r))return{data:{session:null,redirectType:null},error:r};throw r}})}_isImplicitGrantFlow(){return Xf()&&(!!$a("access_token")||!!$a("error_description"))}_isPKCEFlow(){return en(this,void 0,void 0,function*(){const t=yield DO(this.storage,`${this.storageKey}-code-verifier`);return Xf()&&!!$a("code")&&!!t})}signOut(){var t;return en(this,void 0,void 0,function*(){const{data:r,error:n}=yield this.getSession();if(n)return{error:n};const i=(t=r.session)===null||t===void 0?void 0:t.access_token;if(i){const{error:o}=yield this.admin.signOut(i);if(o&&!(qwe(o)&&(o.status===404||o.status===401)))return{error:o}}return yield this._removeSession(),yield BD(this.storage,`${this.storageKey}-code-verifier`),this._notifyAllSubscribers("SIGNED_OUT",null),{error:null}})}onAuthStateChange(t){const r=Fwe(),n={id:r,callback:t,unsubscribe:()=>{this.stateChangeEmitters.delete(r)}};return this.stateChangeEmitters.set(r,n),this.emitInitialSession(r),{data:{subscription:n}}}emitInitialSession(t){var r,n;return en(this,void 0,void 0,function*(){try{const{data:{session:i},error:o}=yield this.getSession();if(o)throw o;(r=this.stateChangeEmitters.get(t))===null||r===void 0||r.callback("INITIAL_SESSION",i)}catch(i){(n=this.stateChangeEmitters.get(t))===null||n===void 0||n.callback("INITIAL_SESSION",null),console.error(i)}})}resetPasswordForEmail(t,r={}){return en(this,void 0,void 0,function*(){let n=null,i=null;if(this.flowType==="pkce"){const o=LO();yield j0(this.storage,`${this.storageKey}-code-verifier`,o),n=yield NO(o),i=o===n?"plain":"s256"}try{return yield Gn(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:i,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(o){if(jn(o))return{data:null,error:o};throw o}})}_refreshAccessToken(t){return en(this,void 0,void 0,function*(){try{const r=Date.now();return yield Uwe(n=>en(this,void 0,void 0,function*(){return yield Vwe(n*200),yield Gn(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:Ff})}),(n,i,o)=>o&&o.error&&o.error instanceof RB&&Date.now()+(n+1)*200-r<FD)}catch(r){if(jn(r))return{data:{session:null,user:null},error:r};throw r}})}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}_handleProviderSignIn(t,r){return en(this,void 0,void 0,function*(){const n=yield this._getUrlForProvider(t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return Xf()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}})}_recoverAndRefresh(){var t;return en(this,void 0,void 0,function*(){try{const r=yield DO(this.storage,this.storageKey);if(!this._isValidSession(r)){r!==null&&(yield this._removeSession());return}const n=Math.round(Date.now()/1e3);if(((t=r.expires_at)!==null&&t!==void 0?t:1/0)<n+c0e){if(this.autoRefreshToken&&r.refresh_token){const{error:i}=yield this._callRefreshToken(r.refresh_token);i&&(console.log(i.message),yield this._removeSession())}}else this.persistSession&&(yield this._saveSession(r)),this._notifyAllSubscribers("SIGNED_IN",r)}catch(r){console.error(r);return}})}_callRefreshToken(t){var r,n;return en(this,void 0,void 0,function*(){if(this.refreshingDeferred)return this.refreshingDeferred.promise;try{if(this.refreshingDeferred=new vI,!t)throw new Wg;const{data:i,error:o}=yield this._refreshAccessToken(t);if(o)throw o;if(!i.session)throw new Wg;yield this._saveSession(i.session),this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const s={session:i.session,error:null};return this.refreshingDeferred.resolve(s),s}catch(i){if(jn(i)){const o={session:null,error:i};return(r=this.refreshingDeferred)===null||r===void 0||r.resolve(o),o}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(i),i}finally{this.refreshingDeferred=null}})}_notifyAllSubscribers(t,r,n=!0){this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:r}),this.stateChangeEmitters.forEach(i=>i.callback(t,r))}_saveSession(t){return en(this,void 0,void 0,function*(){this.persistSession||(this.inMemorySession=t),this.persistSession&&t.expires_at&&(yield this._persistSession(t))})}_persistSession(t){return j0(this.storage,this.storageKey,t)}_removeSession(){return en(this,void 0,void 0,function*(){this.persistSession?yield BD(this.storage,this.storageKey):this.inMemorySession=null})}_removeVisibilityChangedCallback(){const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&Xf()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}_startAutoRefresh(){return en(this,void 0,void 0,function*(){yield this._stopAutoRefresh();const t=setInterval(()=>this._autoRefreshTokenTick(),FD);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),yield this._autoRefreshTokenTick()})}_stopAutoRefresh(){return en(this,void 0,void 0,function*(){const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)})}startAutoRefresh(){return en(this,void 0,void 0,function*(){this._removeVisibilityChangedCallback(),yield this._startAutoRefresh()})}stopAutoRefresh(){return en(this,void 0,void 0,function*(){this._removeVisibilityChangedCallback(),yield this._stopAutoRefresh()})}_autoRefreshTokenTick(){return en(this,void 0,void 0,function*(){const t=Date.now();try{const{data:{session:r}}=yield this.getSession();if(!r||!r.refresh_token||!r.expires_at)return;Math.floor((r.expires_at*1e3-t)/FD)<p0e&&(yield this._callRefreshToken(r.refresh_token))}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}})}_handleVisibilityChange(){return en(this,void 0,void 0,function*(){if(!Xf()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=()=>en(this,void 0,void 0,function*(){return yield this._onVisibilityChanged(!1)}),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),yield this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}})}_onVisibilityChanged(t){return en(this,void 0,void 0,function*(){document.visibilityState==="visible"?(t||(yield this.initializePromise,yield this._recoverAndRefresh()),this.autoRefreshToken&&this._startAutoRefresh()):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()})}_getUrlForProvider(t,r){return en(this,void 0,void 0,function*(){const n=[`provider=${encodeURIComponent(t)}`];if(r!=null&&r.redirectTo&&n.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r!=null&&r.scopes&&n.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){const i=LO();yield j0(this.storage,`${this.storageKey}-code-verifier`,i);const o=yield NO(i),s=i===o?"plain":"s256",a=new URLSearchParams({code_challenge:`${encodeURIComponent(o)}`,code_challenge_method:`${encodeURIComponent(s)}`});n.push(a.toString())}if(r!=null&&r.queryParams){const i=new URLSearchParams(r.queryParams);n.push(i.toString())}return`${this.url}/authorize?${n.join("&")}`})}_unenroll(t){var r;return en(this,void 0,void 0,function*(){try{const{data:n,error:i}=yield this.getSession();return i?{data:null,error:i}:yield Gn(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(r=n==null?void 0:n.session)===null||r===void 0?void 0:r.access_token})}catch(n){if(jn(n))return{data:null,error:n};throw n}})}_enroll(t){var r,n;return en(this,void 0,void 0,function*(){try{const{data:i,error:o}=yield this.getSession();if(o)return{data:null,error:o};const{data:s,error:a}=yield Gn(this.fetch,"POST",`${this.url}/factors`,{body:{friendly_name:t.friendlyName,factor_type:t.factorType,issuer:t.issuer},headers:this.headers,jwt:(r=i==null?void 0:i.session)===null||r===void 0?void 0:r.access_token});return a?{data:null,error:a}:(!((n=s==null?void 0:s.totp)===null||n===void 0)&&n.qr_code&&(s.totp.qr_code=`data:image/svg+xml;utf-8,${s.totp.qr_code}`),{data:s,error:null})}catch(i){if(jn(i))return{data:null,error:i};throw i}})}_verify(t){var r;return en(this,void 0,void 0,function*(){try{const{data:n,error:i}=yield this.getSession();if(i)return{data:null,error:i};const{data:o,error:s}=yield Gn(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:{code:t.code,challenge_id:t.challengeId},headers:this.headers,jwt:(r=n==null?void 0:n.session)===null||r===void 0?void 0:r.access_token});return s?{data:null,error:s}:(yield this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),{data:o,error:s})}catch(n){if(jn(n))return{data:null,error:n};throw n}})}_challenge(t){var r;return en(this,void 0,void 0,function*(){try{const{data:n,error:i}=yield this.getSession();return i?{data:null,error:i}:yield Gn(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{headers:this.headers,jwt:(r=n==null?void 0:n.session)===null||r===void 0?void 0:r.access_token})}catch(n){if(jn(n))return{data:null,error:n};throw n}})}_challengeAndVerify(t){return en(this,void 0,void 0,function*(){const{data:r,error:n}=yield this._challenge({factorId:t.factorId});return n?{data:null,error:n}:yield this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})})}_listFactors(){return en(this,void 0,void 0,function*(){const{data:{user:t},error:r}=yield this.getUser();if(r)return{data:null,error:r};const n=(t==null?void 0:t.factors)||[],i=n.filter(o=>o.factor_type==="totp"&&o.status==="verified");return{data:{all:n,totp:i},error:null}})}_getAuthenticatorAssuranceLevel(){var t,r;return en(this,void 0,void 0,function*(){const{data:{session:n},error:i}=yield this.getSession();if(i)return{data:null,error:i};if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const o=this._decodeJWT(n.access_token);let s=null;o.aal&&(s=o.aal);let a=s;((r=(t=n.user.factors)===null||t===void 0?void 0:t.filter(y=>y.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(a="aal2");const p=o.amr||[];return{data:{currentLevel:s,nextLevel:a,currentAuthenticationMethods:p},error:null}})}}class g0e extends m0e{constructor(t){super(t)}}var y0e=globalThis&&globalThis.__awaiter||function(e,t,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(y){try{p(n.next(y))}catch(S){s(S)}}function h(y){try{p(n.throw(y))}catch(S){s(S)}}function p(y){y.done?o(y.value):i(y.value).then(a,h)}p((n=n.apply(e,t||[])).next())})};const v0e={headers:Iwe},_0e={schema:"public"},b0e={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},w0e={};class S0e{constructor(t,r,n){var i,o,s,a,h,p,y,S;if(this.supabaseUrl=t,this.supabaseKey=r,!t)throw new Error("supabaseUrl is required.");if(!r)throw new Error("supabaseKey is required.");const E=Nwe(t);if(this.realtimeUrl=`${E}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${E}/auth/v1`,this.storageUrl=`${E}/storage/v1`,E.match(/(supabase\.co)|(supabase\.in)/)){const j=E.split(".");this.functionsUrl=`${j[0]}.functions.${j[1]}.${j[2]}`}else this.functionsUrl=`${E}/functions/v1`;const A=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,$={db:_0e,realtime:w0e,auth:Object.assign(Object.assign({},b0e),{storageKey:A}),global:v0e},B=Bwe(n??{},$);this.storageKey=(o=(i=B.auth)===null||i===void 0?void 0:i.storageKey)!==null&&o!==void 0?o:"",this.headers=(a=(s=B.global)===null||s===void 0?void 0:s.headers)!==null&&a!==void 0?a:{},this.auth=this._initSupabaseAuthClient((h=B.auth)!==null&&h!==void 0?h:{},this.headers,(p=B.global)===null||p===void 0?void 0:p.fetch),this.fetch=Lwe(r,this._getAccessToken.bind(this),(y=B.global)===null||y===void 0?void 0:y.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers},B.realtime)),this.rest=new Bbe(`${E}/rest/v1`,{headers:this.headers,schema:(S=B.db)===null||S===void 0?void 0:S.schema,fetch:this.fetch}),this._listenForAuthEvents()}get functions(){return new Ibe(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new Pwe(this.storageUrl,this.headers,this.fetch)}from(t){return this.rest.from(t)}rpc(t,r={},n){return this.rest.rpc(t,r,n)}channel(t,r={config:{}}){return this.realtime.channel(t,r)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var t,r;return y0e(this,void 0,void 0,function*(){const{data:n}=yield this.auth.getSession();return(r=(t=n.session)===null||t===void 0?void 0:t.access_token)!==null&&r!==void 0?r:null})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:i,storageKey:o,flowType:s},a,h){const p={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new g0e({url:this.authUrl,headers:Object.assign(Object.assign({},p),a),storageKey:o,autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:i,flowType:s,fetch:h})}_initRealtimeClient(t){return new _we(this.realtimeUrl,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,n)=>{this._handleTokenChanged(r,n==null?void 0:n.access_token,"CLIENT")})}_handleTokenChanged(t,r,n){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==r?(this.realtime.setAuth(r??null),this.changedAccessToken=r):t==="SIGNED_OUT"&&(this.realtime.setAuth(this.supabaseKey),n=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const x0e=(e,t,r)=>new S0e(e,t,r);function Ev(){return Ev=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ev.apply(this,arguments)}function C0e(e,t){typeof e=="function"?e(t):e!=null&&(e.current=t)}function E0e(...e){return t=>e.forEach(r=>C0e(r,t))}const doe=_t.forwardRef((e,t)=>{const{children:r,...n}=e,i=_t.Children.toArray(r),o=i.find(O0e);if(o){const s=o.props.children,a=i.map(h=>h===o?_t.Children.count(s)>1?_t.Children.only(null):_t.isValidElement(s)?s.props.children:null:h);return _t.createElement(kB,Ev({},n,{ref:t}),_t.isValidElement(s)?_t.cloneElement(s,void 0,a):null)}return _t.createElement(kB,Ev({},n,{ref:t}),r)});doe.displayName="Slot";const kB=_t.forwardRef((e,t)=>{const{children:r,...n}=e;return _t.isValidElement(r)?_t.cloneElement(r,{...R0e(n,r.props),ref:t?E0e(t,r.ref):r.ref}):_t.Children.count(r)>1?_t.Children.only(null):null});kB.displayName="SlotClone";const T0e=({children:e})=>_t.createElement(_t.Fragment,null,e);function O0e(e){return _t.isValidElement(e)&&e.type===T0e}function R0e(e,t){const r={...t};for(const n in t){const i=e[n],o=t[n];/^on[A-Z]/.test(n)?i&&o?r[n]=(...a)=>{o(...a),i(...a)}:i&&(r[n]=i):n==="style"?r[n]={...i,...o}:n==="className"&&(r[n]=[i,o].filter(Boolean).join(" "))}return{...e,...r}}const k0e=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],P0e=k0e.reduce((e,t)=>{const r=_t.forwardRef((n,i)=>{const{asChild:o,...s}=n,a=o?doe:t;return _t.useEffect(()=>{window[Symbol.for("radix-ui")]=!0},[]),_t.createElement(a,Ev({},s,{ref:i}))});return r.displayName=`Primitive.${t}`,{...e,[t]:r}},{}),A0e=_t.forwardRef((e,t)=>{const{ratio:r=1,style:n,...i}=e;return _t.createElement("div",{style:{position:"relative",width:"100%",paddingBottom:`${100/r}%`},"data-radix-aspect-ratio-wrapper":""},_t.createElement(P0e.div,Ev({},i,{ref:t,style:{...n,position:"absolute",top:0,right:0,bottom:0,left:0}})))}),G8=A0e,poe="/assets/newlogo-fc2e0f7a.svg";function I0e(){return Pe.jsxs(Pe.Fragment,{children:[Pe.jsx("div",{className:"logo-hold",children:Pe.jsx("a",{children:Pe.jsx("img",{src:poe,height:"30",width:"42"})})}),Pe.jsx("div",{className:"mainmenu"}),Pe.jsx("div",{className:"action",children:Pe.jsxs("div",{style:{paddingTop:"20px"},children:[Pe.jsx(I8,{to:"log-in",style:{textDecoration:"none",color:"black"},children:Pe.jsx("a",{style:{marginRight:"20px",fontSize:"14px",fontWeight:"700"},children:"Log in"})}),Pe.jsx(I8,{to:"register",children:Pe.jsx("button",{style:{border:"none",fontSize:"14px",fontWeight:"700",paddingTop:"7px",paddingBottom:"7px",paddingLeft:"12px",paddingRight:"12px",borderRadius:"6px",color:"white"},className:"bg-blue-600",children:"Sign Up"})})]})})]})}const Y8="/assets/arrow-3eca6eb4.svg";function M0e(){return Pe.jsx(Pe.Fragment,{children:Pe.jsxs("div",{className:"home-layout bg-gradient-to-l from-cyan-50 via-white to-indigo-100",children:[Pe.jsx("div",{className:"home-header",children:Pe.jsx(I0e,{})}),Pe.jsxs("div",{className:"introduction",children:[Pe.jsx("div",{className:"tut-intro",children:Pe.jsxs("h1",{style:{fontSize:"80px",fontWeight:"700"},children:["Scheduling ",Pe.jsx("p",{className:"text-blue-600",style:{fontWeight:"900",display:"inline-block"},children:"made"})," easy"]})}),Pe.jsxs("div",{className:"tut-add-driver",children:[Pe.jsx("p",{style:{fontSize:"35px",fontWeight:"300"},children:"Add Your Drivers"}),Pe.jsx("p",{style:{fontSize:"15px",fontWeight:"100"},children:"Create your fleet"}),Pe.jsx("p",{style:{fontSize:"15px",fontWeight:"100"},children:"Manage Your drivers"})]}),Pe.jsx("div",{className:"Radix-Container left-one",children:Pe.jsx(G8,{ratio:16/9,children:Pe.jsx("img",{className:"Radix-Image",src:Y8})})}),Pe.jsx("div",{className:"tut-add-schedule",children:Pe.jsx("p",{style:{fontSize:"35px",fontWeight:"300"},children:"Create a Schedule"})}),Pe.jsx("div",{className:"Radix-Container right-one",children:Pe.jsx(G8,{ratio:16/9,children:Pe.jsx("img",{className:"Radix-Image",src:Y8})})}),Pe.jsx("div",{className:"tut-find-route",children:Pe.jsx("p",{style:{fontSize:"35px",fontWeight:"300"},children:"Find the most effecient routes."})})]}),Pe.jsx("div",{className:"home-main"})]})})}function $0e({onMenuClick:e,currentPage:t,selectFile:r,setLogOut:n}){const i=pI(),o=a=>{e(a)},s=()=>{n(!0),i("/log-in/")};return Pe.jsxs(Pe.Fragment,{children:[Pe.jsxs("div",{className:"menu-grid",children:[Pe.jsx("div",{className:"img-div logo",children:Pe.jsx("a",{children:Pe.jsx("img",{src:poe,height:"28",width:"38",style:{filter:"drop-shadow(0px 0px 7px #735eff)"}})})}),Pe.jsx("div",{onClick:()=>{o("route"),r("")},className:t==="route"?"glyph route menu-select-active":"glyph route",title:"Route",children:Pe.jsx("a",{placeholder:"Route",children:Pe.jsx("i",{className:"fi fi-rs-rocket-lunch glyphicon glyph-prop"})})}),Pe.jsx("div",{onClick:()=>{o("schedule"),r("")},className:t==="schedule"||t==="grid"?"glyph schedule menu-select-active":"glyph schedule",title:"Schedule",children:Pe.jsx("a",{children:Pe.jsx("i",{className:"fi fi-rr-calendar glyphicon glyph-prop"})})}),Pe.jsx("div",{className:t=="driver"?"glyph driver menu-select-active":"glyph driver",onClick:()=>{o("driver"),r("")},title:"Drivers",children:Pe.jsx("a",{children:Pe.jsx("i",{className:"fi fi-rs-users glyphicon glyph-prop"})})})]}),Pe.jsxs("div",{className:"menu-grid-two",children:[Pe.jsx("div",{onClick:()=>{o("settings")},title:"Settings",className:t==="settings"?"glyph setting menu-select-active":"glyph setting",children:Pe.jsx("a",{children:Pe.jsx("i",{className:"fi fi-rr-settings glyphicon glyph-prop"})})}),Pe.jsx("div",{className:"glyph log-out",onClick:()=>s(),title:"Log out",children:Pe.jsx("a",{children:Pe.jsx("i",{className:"fi fi-rs-address-card glyphicon glyph-prop"})})})]})]})}function D0e({currentTab:e,index:t,setActiveTab:r,activeTab:n}){return Pe.jsx(Pe.Fragment,{children:Pe.jsx("li",{className:n==e?"tabs-select tabs-select-active":"tabs-select",style:{listStyleType:"none"},onClick:()=>r(e),children:Pe.jsx("div",{children:Pe.jsx("p",{style:{fontWeight:"400"},children:e})})},t)})}var va="top",hs="bottom",ds="right",_a="left",_I="auto",Wb=[va,hs,ds,_a],sm="start",Tv="end",moe="clippingParents",D3="viewport",Ty="popper",goe="reference",PB=Wb.reduce(function(e,t){return e.concat([t+"-"+sm,t+"-"+Tv])},[]),L3=[].concat(Wb,[_I]).reduce(function(e,t){return e.concat([t,t+"-"+sm,t+"-"+Tv])},[]),yoe="beforeRead",voe="read",_oe="afterRead",boe="beforeMain",woe="main",Soe="afterMain",xoe="beforeWrite",Coe="write",Eoe="afterWrite",Toe=[yoe,voe,_oe,boe,woe,Soe,xoe,Coe,Eoe];function Su(e){return e?(e.nodeName||"").toLowerCase():null}function ps(e){if(e==null)return window;if(e.toString()!=="[object Window]"){var t=e.ownerDocument;return t&&t.defaultView||window}return e}function lm(e){var t=ps(e).Element;return e instanceof t||e instanceof Element}function Fs(e){var t=ps(e).HTMLElement;return e instanceof t||e instanceof HTMLElement}function N3(e){if(typeof ShadowRoot>"u")return!1;var t=ps(e).ShadowRoot;return e instanceof t||e instanceof ShadowRoot}function L0e(e){var t=e.state;Object.keys(t.elements).forEach(function(r){var n=t.styles[r]||{},i=t.attributes[r]||{},o=t.elements[r];!Fs(o)||!Su(o)||(Object.assign(o.style,n),Object.keys(i).forEach(function(s){var a=i[s];a===!1?o.removeAttribute(s):o.setAttribute(s,a===!0?"":a)}))})}function N0e(e){var t=e.state,r={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(t.elements.popper.style,r.popper),t.styles=r,t.elements.arrow&&Object.assign(t.elements.arrow.style,r.arrow),function(){Object.keys(t.elements).forEach(function(n){var i=t.elements[n],o=t.attributes[n]||{},s=Object.keys(t.styles.hasOwnProperty(n)?t.styles[n]:r[n]),a=s.reduce(function(h,p){return h[p]="",h},{});!Fs(i)||!Su(i)||(Object.assign(i.style,a),Object.keys(o).forEach(function(h){i.removeAttribute(h)}))})}}const B3={name:"applyStyles",enabled:!0,phase:"write",fn:L0e,effect:N0e,requires:["computeStyles"]};function _u(e){return e.split("-")[0]}var Xp=Math.max,kP=Math.min,Ov=Math.round;function AB(){var e=navigator.userAgentData;return e!=null&&e.brands&&Array.isArray(e.brands)?e.brands.map(function(t){return t.brand+"/"+t.version}).join(" "):navigator.userAgent}function Ooe(){return!/^((?!chrome|android).)*safari/i.test(AB())}function Rv(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!1);var n=e.getBoundingClientRect(),i=1,o=1;t&&Fs(e)&&(i=e.offsetWidth>0&&Ov(n.width)/e.offsetWidth||1,o=e.offsetHeight>0&&Ov(n.height)/e.offsetHeight||1);var s=lm(e)?ps(e):window,a=s.visualViewport,h=!Ooe()&&r,p=(n.left+(h&&a?a.offsetLeft:0))/i,y=(n.top+(h&&a?a.offsetTop:0))/o,S=n.width/i,E=n.height/o;return{width:S,height:E,top:y,right:p+S,bottom:y+E,left:p,x:p,y}}function j3(e){var t=Rv(e),r=e.offsetWidth,n=e.offsetHeight;return Math.abs(t.width-r)<=1&&(r=t.width),Math.abs(t.height-n)<=1&&(n=t.height),{x:e.offsetLeft,y:e.offsetTop,width:r,height:n}}function Roe(e,t){var r=t.getRootNode&&t.getRootNode();if(e.contains(t))return!0;if(r&&N3(r)){var n=t;do{if(n&&e.isSameNode(n))return!0;n=n.parentNode||n.host}while(n)}return!1}function Yc(e){return ps(e).getComputedStyle(e)}function B0e(e){return["table","td","th"].indexOf(Su(e))>=0}function Wh(e){return((lm(e)?e.ownerDocument:e.document)||window.document).documentElement}function bI(e){return Su(e)==="html"?e:e.assignedSlot||e.parentNode||(N3(e)?e.host:null)||Wh(e)}function K8(e){return!Fs(e)||Yc(e).position==="fixed"?null:e.offsetParent}function j0e(e){var t=/firefox/i.test(AB()),r=/Trident/i.test(AB());if(r&&Fs(e)){var n=Yc(e);if(n.position==="fixed")return null}var i=bI(e);for(N3(i)&&(i=i.host);Fs(i)&&["html","body"].indexOf(Su(i))<0;){var o=Yc(i);if(o.transform!=="none"||o.perspective!=="none"||o.contain==="paint"||["transform","perspective"].indexOf(o.willChange)!==-1||t&&o.willChange==="filter"||t&&o.filter&&o.filter!=="none")return i;i=i.parentNode}return null}function zC(e){for(var t=ps(e),r=K8(e);r&&B0e(r)&&Yc(r).position==="static";)r=K8(r);return r&&(Su(r)==="html"||Su(r)==="body"&&Yc(r).position==="static")?t:r||j0e(e)||t}function F3(e){return["top","bottom"].indexOf(e)>=0?"x":"y"}function FS(e,t,r){return Xp(e,kP(t,r))}function F0e(e,t,r){var n=FS(e,t,r);return n>r?r:n}function koe(){return{top:0,right:0,bottom:0,left:0}}function Poe(e){return Object.assign({},koe(),e)}function Aoe(e,t){return t.reduce(function(r,n){return r[n]=e,r},{})}var z0e=function(t,r){return t=typeof t=="function"?t(Object.assign({},r.rects,{placement:r.placement})):t,Poe(typeof t!="number"?t:Aoe(t,Wb))};function H0e(e){var t,r=e.state,n=e.name,i=e.options,o=r.elements.arrow,s=r.modifiersData.popperOffsets,a=_u(r.placement),h=F3(a),p=[_a,ds].indexOf(a)>=0,y=p?"height":"width";if(!(!o||!s)){var S=z0e(i.padding,r),E=j3(o),O=h==="y"?va:_a,A=h==="y"?hs:ds,$=r.rects.reference[y]+r.rects.reference[h]-s[h]-r.rects.popper[y],B=s[h]-r.rects.reference[h],j=zC(o),z=j?h==="y"?j.clientHeight||0:j.clientWidth||0:0,W=$/2-B/2,Q=S[O],q=z-E[y]-S[A],Se=z/2-E[y]/2+W,Ie=FS(Q,Se,q),He=h;r.modifiersData[n]=(t={},t[He]=Ie,t.centerOffset=Ie-Se,t)}}function V0e(e){var t=e.state,r=e.options,n=r.element,i=n===void 0?"[data-popper-arrow]":n;i!=null&&(typeof i=="string"&&(i=t.elements.popper.querySelector(i),!i)||Roe(t.elements.popper,i)&&(t.elements.arrow=i))}const Ioe={name:"arrow",enabled:!0,phase:"main",fn:H0e,effect:V0e,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function kv(e){return e.split("-")[1]}var U0e={top:"auto",right:"auto",bottom:"auto",left:"auto"};function W0e(e,t){var r=e.x,n=e.y,i=t.devicePixelRatio||1;return{x:Ov(r*i)/i||0,y:Ov(n*i)/i||0}}function q8(e){var t,r=e.popper,n=e.popperRect,i=e.placement,o=e.variation,s=e.offsets,a=e.position,h=e.gpuAcceleration,p=e.adaptive,y=e.roundOffsets,S=e.isFixed,E=s.x,O=E===void 0?0:E,A=s.y,$=A===void 0?0:A,B=typeof y=="function"?y({x:O,y:$}):{x:O,y:$};O=B.x,$=B.y;var j=s.hasOwnProperty("x"),z=s.hasOwnProperty("y"),W=_a,Q=va,q=window;if(p){var Se=zC(r),Ie="clientHeight",He="clientWidth";if(Se===ps(r)&&(Se=Wh(r),Yc(Se).position!=="static"&&a==="absolute"&&(Ie="scrollHeight",He="scrollWidth")),Se=Se,i===va||(i===_a||i===ds)&&o===Tv){Q=hs;var Le=S&&Se===q&&q.visualViewport?q.visualViewport.height:Se[Ie];$-=Le-n.height,$*=h?1:-1}if(i===_a||(i===va||i===hs)&&o===Tv){W=ds;var ze=S&&Se===q&&q.visualViewport?q.visualViewport.width:Se[He];O-=ze-n.width,O*=h?1:-1}}var ct=Object.assign({position:a},p&&U0e),At=y===!0?W0e({x:O,y:$},ps(r)):{x:O,y:$};if(O=At.x,$=At.y,h){var Qe;return Object.assign({},ct,(Qe={},Qe[Q]=z?"0":"",Qe[W]=j?"0":"",Qe.transform=(q.devicePixelRatio||1)<=1?"translate("+O+"px, "+$+"px)":"translate3d("+O+"px, "+$+"px, 0)",Qe))}return Object.assign({},ct,(t={},t[Q]=z?$+"px":"",t[W]=j?O+"px":"",t.transform="",t))}function G0e(e){var t=e.state,r=e.options,n=r.gpuAcceleration,i=n===void 0?!0:n,o=r.adaptive,s=o===void 0?!0:o,a=r.roundOffsets,h=a===void 0?!0:a,p={placement:_u(t.placement),variation:kv(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:i,isFixed:t.options.strategy==="fixed"};t.modifiersData.popperOffsets!=null&&(t.styles.popper=Object.assign({},t.styles.popper,q8(Object.assign({},p,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:s,roundOffsets:h})))),t.modifiersData.arrow!=null&&(t.styles.arrow=Object.assign({},t.styles.arrow,q8(Object.assign({},p,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:h})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})}const z3={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:G0e,data:{}};var FO={passive:!0};function Y0e(e){var t=e.state,r=e.instance,n=e.options,i=n.scroll,o=i===void 0?!0:i,s=n.resize,a=s===void 0?!0:s,h=ps(t.elements.popper),p=[].concat(t.scrollParents.reference,t.scrollParents.popper);return o&&p.forEach(function(y){y.addEventListener("scroll",r.update,FO)}),a&&h.addEventListener("resize",r.update,FO),function(){o&&p.forEach(function(y){y.removeEventListener("scroll",r.update,FO)}),a&&h.removeEventListener("resize",r.update,FO)}}const H3={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:Y0e,data:{}};var K0e={left:"right",right:"left",bottom:"top",top:"bottom"};function fk(e){return e.replace(/left|right|bottom|top/g,function(t){return K0e[t]})}var q0e={start:"end",end:"start"};function X8(e){return e.replace(/start|end/g,function(t){return q0e[t]})}function V3(e){var t=ps(e),r=t.pageXOffset,n=t.pageYOffset;return{scrollLeft:r,scrollTop:n}}function U3(e){return Rv(Wh(e)).left+V3(e).scrollLeft}function X0e(e,t){var r=ps(e),n=Wh(e),i=r.visualViewport,o=n.clientWidth,s=n.clientHeight,a=0,h=0;if(i){o=i.width,s=i.height;var p=Ooe();(p||!p&&t==="fixed")&&(a=i.offsetLeft,h=i.offsetTop)}return{width:o,height:s,x:a+U3(e),y:h}}function Z0e(e){var t,r=Wh(e),n=V3(e),i=(t=e.ownerDocument)==null?void 0:t.body,o=Xp(r.scrollWidth,r.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),s=Xp(r.scrollHeight,r.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0),a=-n.scrollLeft+U3(e),h=-n.scrollTop;return Yc(i||r).direction==="rtl"&&(a+=Xp(r.clientWidth,i?i.clientWidth:0)-o),{width:o,height:s,x:a,y:h}}function W3(e){var t=Yc(e),r=t.overflow,n=t.overflowX,i=t.overflowY;return/auto|scroll|overlay|hidden/.test(r+i+n)}function Moe(e){return["html","body","#document"].indexOf(Su(e))>=0?e.ownerDocument.body:Fs(e)&&W3(e)?e:Moe(bI(e))}function zS(e,t){var r;t===void 0&&(t=[]);var n=Moe(e),i=n===((r=e.ownerDocument)==null?void 0:r.body),o=ps(n),s=i?[o].concat(o.visualViewport||[],W3(n)?n:[]):n,a=t.concat(s);return i?a:a.concat(zS(bI(s)))}function IB(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function J0e(e,t){var r=Rv(e,!1,t==="fixed");return r.top=r.top+e.clientTop,r.left=r.left+e.clientLeft,r.bottom=r.top+e.clientHeight,r.right=r.left+e.clientWidth,r.width=e.clientWidth,r.height=e.clientHeight,r.x=r.left,r.y=r.top,r}function Z8(e,t,r){return t===D3?IB(X0e(e,r)):lm(t)?J0e(t,r):IB(Z0e(Wh(e)))}function Q0e(e){var t=zS(bI(e)),r=["absolute","fixed"].indexOf(Yc(e).position)>=0,n=r&&Fs(e)?zC(e):e;return lm(n)?t.filter(function(i){return lm(i)&&Roe(i,n)&&Su(i)!=="body"}):[]}function eSe(e,t,r,n){var i=t==="clippingParents"?Q0e(e):[].concat(t),o=[].concat(i,[r]),s=o[0],a=o.reduce(function(h,p){var y=Z8(e,p,n);return h.top=Xp(y.top,h.top),h.right=kP(y.right,h.right),h.bottom=kP(y.bottom,h.bottom),h.left=Xp(y.left,h.left),h},Z8(e,s,n));return a.width=a.right-a.left,a.height=a.bottom-a.top,a.x=a.left,a.y=a.top,a}function $oe(e){var t=e.reference,r=e.element,n=e.placement,i=n?_u(n):null,o=n?kv(n):null,s=t.x+t.width/2-r.width/2,a=t.y+t.height/2-r.height/2,h;switch(i){case va:h={x:s,y:t.y-r.height};break;case hs:h={x:s,y:t.y+t.height};break;case ds:h={x:t.x+t.width,y:a};break;case _a:h={x:t.x-r.width,y:a};break;default:h={x:t.x,y:t.y}}var p=i?F3(i):null;if(p!=null){var y=p==="y"?"height":"width";switch(o){case sm:h[p]=h[p]-(t[y]/2-r[y]/2);break;case Tv:h[p]=h[p]+(t[y]/2-r[y]/2);break}}return h}function Pv(e,t){t===void 0&&(t={});var r=t,n=r.placement,i=n===void 0?e.placement:n,o=r.strategy,s=o===void 0?e.strategy:o,a=r.boundary,h=a===void 0?moe:a,p=r.rootBoundary,y=p===void 0?D3:p,S=r.elementContext,E=S===void 0?Ty:S,O=r.altBoundary,A=O===void 0?!1:O,$=r.padding,B=$===void 0?0:$,j=Poe(typeof B!="number"?B:Aoe(B,Wb)),z=E===Ty?goe:Ty,W=e.rects.popper,Q=e.elements[A?z:E],q=eSe(lm(Q)?Q:Q.contextElement||Wh(e.elements.popper),h,y,s),Se=Rv(e.elements.reference),Ie=$oe({reference:Se,element:W,strategy:"absolute",placement:i}),He=IB(Object.assign({},W,Ie)),Le=E===Ty?He:Se,ze={top:q.top-Le.top+j.top,bottom:Le.bottom-q.bottom+j.bottom,left:q.left-Le.left+j.left,right:Le.right-q.right+j.right},ct=e.modifiersData.offset;if(E===Ty&&ct){var At=ct[i];Object.keys(ze).forEach(function(Qe){var de=[ds,hs].indexOf(Qe)>=0?1:-1,Ce=[va,hs].indexOf(Qe)>=0?"y":"x";ze[Qe]+=At[Ce]*de})}return ze}function tSe(e,t){t===void 0&&(t={});var r=t,n=r.placement,i=r.boundary,o=r.rootBoundary,s=r.padding,a=r.flipVariations,h=r.allowedAutoPlacements,p=h===void 0?L3:h,y=kv(n),S=y?a?PB:PB.filter(function(A){return kv(A)===y}):Wb,E=S.filter(function(A){return p.indexOf(A)>=0});E.length===0&&(E=S);var O=E.reduce(function(A,$){return A[$]=Pv(e,{placement:$,boundary:i,rootBoundary:o,padding:s})[_u($)],A},{});return Object.keys(O).sort(function(A,$){return O[A]-O[$]})}function rSe(e){if(_u(e)===_I)return[];var t=fk(e);return[X8(e),t,X8(t)]}function nSe(e){var t=e.state,r=e.options,n=e.name;if(!t.modifiersData[n]._skip){for(var i=r.mainAxis,o=i===void 0?!0:i,s=r.altAxis,a=s===void 0?!0:s,h=r.fallbackPlacements,p=r.padding,y=r.boundary,S=r.rootBoundary,E=r.altBoundary,O=r.flipVariations,A=O===void 0?!0:O,$=r.allowedAutoPlacements,B=t.options.placement,j=_u(B),z=j===B,W=h||(z||!A?[fk(B)]:rSe(B)),Q=[B].concat(W).reduce(function(Oe,We){return Oe.concat(_u(We)===_I?tSe(t,{placement:We,boundary:y,rootBoundary:S,padding:p,flipVariations:A,allowedAutoPlacements:$}):We)},[]),q=t.rects.reference,Se=t.rects.popper,Ie=new Map,He=!0,Le=Q[0],ze=0;ze<Q.length;ze++){var ct=Q[ze],At=_u(ct),Qe=kv(ct)===sm,de=[va,hs].indexOf(At)>=0,Ce=de?"width":"height",pt=Pv(t,{placement:ct,boundary:y,rootBoundary:S,altBoundary:E,padding:p}),Ct=de?Qe?ds:_a:Qe?hs:va;q[Ce]>Se[Ce]&&(Ct=fk(Ct));var ie=fk(Ct),M=[];if(o&&M.push(pt[At]<=0),a&&M.push(pt[Ct]<=0,pt[ie]<=0),M.every(function(Oe){return Oe})){Le=ct,He=!1;break}Ie.set(ct,M)}if(He)for(var U=A?3:1,K=function(We){var Je=Q.find(function(ht){var ft=Ie.get(ht);if(ft)return ft.slice(0,We).every(function(St){return St})});if(Je)return Le=Je,"break"},re=U;re>0;re--){var me=K(re);if(me==="break")break}t.placement!==Le&&(t.modifiersData[n]._skip=!0,t.placement=Le,t.reset=!0)}}const Doe={name:"flip",enabled:!0,phase:"main",fn:nSe,requiresIfExists:["offset"],data:{_skip:!1}};function J8(e,t,r){return r===void 0&&(r={x:0,y:0}),{top:e.top-t.height-r.y,right:e.right-t.width+r.x,bottom:e.bottom-t.height+r.y,left:e.left-t.width-r.x}}function Q8(e){return[va,ds,hs,_a].some(function(t){return e[t]>=0})}function iSe(e){var t=e.state,r=e.name,n=t.rects.reference,i=t.rects.popper,o=t.modifiersData.preventOverflow,s=Pv(t,{elementContext:"reference"}),a=Pv(t,{altBoundary:!0}),h=J8(s,n),p=J8(a,i,o),y=Q8(h),S=Q8(p);t.modifiersData[r]={referenceClippingOffsets:h,popperEscapeOffsets:p,isReferenceHidden:y,hasPopperEscaped:S},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":y,"data-popper-escaped":S})}const Loe={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:iSe};function oSe(e,t,r){var n=_u(e),i=[_a,va].indexOf(n)>=0?-1:1,o=typeof r=="function"?r(Object.assign({},t,{placement:e})):r,s=o[0],a=o[1];return s=s||0,a=(a||0)*i,[_a,ds].indexOf(n)>=0?{x:a,y:s}:{x:s,y:a}}function aSe(e){var t=e.state,r=e.options,n=e.name,i=r.offset,o=i===void 0?[0,0]:i,s=L3.reduce(function(y,S){return y[S]=oSe(S,t.rects,o),y},{}),a=s[t.placement],h=a.x,p=a.y;t.modifiersData.popperOffsets!=null&&(t.modifiersData.popperOffsets.x+=h,t.modifiersData.popperOffsets.y+=p),t.modifiersData[n]=s}const Noe={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:aSe};function sSe(e){var t=e.state,r=e.name;t.modifiersData[r]=$oe({reference:t.rects.reference,element:t.rects.popper,strategy:"absolute",placement:t.placement})}const G3={name:"popperOffsets",enabled:!0,phase:"read",fn:sSe,data:{}};function lSe(e){return e==="x"?"y":"x"}function uSe(e){var t=e.state,r=e.options,n=e.name,i=r.mainAxis,o=i===void 0?!0:i,s=r.altAxis,a=s===void 0?!1:s,h=r.boundary,p=r.rootBoundary,y=r.altBoundary,S=r.padding,E=r.tether,O=E===void 0?!0:E,A=r.tetherOffset,$=A===void 0?0:A,B=Pv(t,{boundary:h,rootBoundary:p,padding:S,altBoundary:y}),j=_u(t.placement),z=kv(t.placement),W=!z,Q=F3(j),q=lSe(Q),Se=t.modifiersData.popperOffsets,Ie=t.rects.reference,He=t.rects.popper,Le=typeof $=="function"?$(Object.assign({},t.rects,{placement:t.placement})):$,ze=typeof Le=="number"?{mainAxis:Le,altAxis:Le}:Object.assign({mainAxis:0,altAxis:0},Le),ct=t.modifiersData.offset?t.modifiersData.offset[t.placement]:null,At={x:0,y:0};if(Se){if(o){var Qe,de=Q==="y"?va:_a,Ce=Q==="y"?hs:ds,pt=Q==="y"?"height":"width",Ct=Se[Q],ie=Ct+B[de],M=Ct-B[Ce],U=O?-He[pt]/2:0,K=z===sm?Ie[pt]:He[pt],re=z===sm?-He[pt]:-Ie[pt],me=t.elements.arrow,Oe=O&&me?j3(me):{width:0,height:0},We=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:koe(),Je=We[de],ht=We[Ce],ft=FS(0,Ie[pt],Oe[pt]),St=W?Ie[pt]/2-U-ft-Je-ze.mainAxis:K-ft-Je-ze.mainAxis,Tt=W?-Ie[pt]/2+U+ft+ht+ze.mainAxis:re+ft+ht+ze.mainAxis,Xt=t.elements.arrow&&zC(t.elements.arrow),jt=Xt?Q==="y"?Xt.clientTop||0:Xt.clientLeft||0:0,Kt=(Qe=ct==null?void 0:ct[Q])!=null?Qe:0,qe=Ct+St-Kt-jt,yr=Ct+Tt-Kt,Ar=FS(O?kP(ie,qe):ie,Ct,O?Xp(M,yr):M);Se[Q]=Ar,At[Q]=Ar-Ct}if(a){var wr,vr=Q==="x"?va:_a,Cr=Q==="x"?hs:ds,se=Se[q],ye=q==="y"?"height":"width",Ee=se+B[vr],Ye=se-B[Cr],je=[va,_a].indexOf(j)!==-1,tt=(wr=ct==null?void 0:ct[q])!=null?wr:0,Ue=je?Ee:se-Ie[ye]-He[ye]-tt+ze.altAxis,Ve=je?se+Ie[ye]+He[ye]-tt-ze.altAxis:Ye,at=O&&je?F0e(Ue,se,Ve):FS(O?Ue:Ee,se,O?Ve:Ye);Se[q]=at,At[q]=at-se}t.modifiersData[n]=At}}const Boe={name:"preventOverflow",enabled:!0,phase:"main",fn:uSe,requiresIfExists:["offset"]};function cSe(e){return{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}}function fSe(e){return e===ps(e)||!Fs(e)?V3(e):cSe(e)}function hSe(e){var t=e.getBoundingClientRect(),r=Ov(t.width)/e.offsetWidth||1,n=Ov(t.height)/e.offsetHeight||1;return r!==1||n!==1}function dSe(e,t,r){r===void 0&&(r=!1);var n=Fs(t),i=Fs(t)&&hSe(t),o=Wh(t),s=Rv(e,i,r),a={scrollLeft:0,scrollTop:0},h={x:0,y:0};return(n||!n&&!r)&&((Su(t)!=="body"||W3(o))&&(a=fSe(t)),Fs(t)?(h=Rv(t,!0),h.x+=t.clientLeft,h.y+=t.clientTop):o&&(h.x=U3(o))),{x:s.left+a.scrollLeft-h.x,y:s.top+a.scrollTop-h.y,width:s.width,height:s.height}}function pSe(e){var t=new Map,r=new Set,n=[];e.forEach(function(o){t.set(o.name,o)});function i(o){r.add(o.name);var s=[].concat(o.requires||[],o.requiresIfExists||[]);s.forEach(function(a){if(!r.has(a)){var h=t.get(a);h&&i(h)}}),n.push(o)}return e.forEach(function(o){r.has(o.name)||i(o)}),n}function mSe(e){var t=pSe(e);return Toe.reduce(function(r,n){return r.concat(t.filter(function(i){return i.phase===n}))},[])}function gSe(e){var t;return function(){return t||(t=new Promise(function(r){Promise.resolve().then(function(){t=void 0,r(e())})})),t}}function ySe(e){var t=e.reduce(function(r,n){var i=r[n.name];return r[n.name]=i?Object.assign({},i,n,{options:Object.assign({},i.options,n.options),data:Object.assign({},i.data,n.data)}):n,r},{});return Object.keys(t).map(function(r){return t[r]})}var eY={placement:"bottom",modifiers:[],strategy:"absolute"};function tY(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return!t.some(function(n){return!(n&&typeof n.getBoundingClientRect=="function")})}function wI(e){e===void 0&&(e={});var t=e,r=t.defaultModifiers,n=r===void 0?[]:r,i=t.defaultOptions,o=i===void 0?eY:i;return function(a,h,p){p===void 0&&(p=o);var y={placement:"bottom",orderedModifiers:[],options:Object.assign({},eY,o),modifiersData:{},elements:{reference:a,popper:h},attributes:{},styles:{}},S=[],E=!1,O={state:y,setOptions:function(j){var z=typeof j=="function"?j(y.options):j;$(),y.options=Object.assign({},o,y.options,z),y.scrollParents={reference:lm(a)?zS(a):a.contextElement?zS(a.contextElement):[],popper:zS(h)};var W=mSe(ySe([].concat(n,y.options.modifiers)));return y.orderedModifiers=W.filter(function(Q){return Q.enabled}),A(),O.update()},forceUpdate:function(){if(!E){var j=y.elements,z=j.reference,W=j.popper;if(tY(z,W)){y.rects={reference:dSe(z,zC(W),y.options.strategy==="fixed"),popper:j3(W)},y.reset=!1,y.placement=y.options.placement,y.orderedModifiers.forEach(function(ze){return y.modifiersData[ze.name]=Object.assign({},ze.data)});for(var Q=0;Q<y.orderedModifiers.length;Q++){if(y.reset===!0){y.reset=!1,Q=-1;continue}var q=y.orderedModifiers[Q],Se=q.fn,Ie=q.options,He=Ie===void 0?{}:Ie,Le=q.name;typeof Se=="function"&&(y=Se({state:y,options:He,name:Le,instance:O})||y)}}}},update:gSe(function(){return new Promise(function(B){O.forceUpdate(),B(y)})}),destroy:function(){$(),E=!0}};if(!tY(a,h))return O;O.setOptions(p).then(function(B){!E&&p.onFirstUpdate&&p.onFirstUpdate(B)});function A(){y.orderedModifiers.forEach(function(B){var j=B.name,z=B.options,W=z===void 0?{}:z,Q=B.effect;if(typeof Q=="function"){var q=Q({state:y,name:j,instance:O,options:W}),Se=function(){};S.push(q||Se)}})}function $(){S.forEach(function(B){return B()}),S=[]}return O}}var vSe=wI(),_Se=[H3,G3,z3,B3],bSe=wI({defaultModifiers:_Se}),wSe=[H3,G3,z3,B3,Noe,Doe,Boe,Ioe,Loe],Y3=wI({defaultModifiers:wSe});const joe=Object.freeze(Object.defineProperty({__proto__:null,afterMain:Soe,afterRead:_oe,afterWrite:Eoe,applyStyles:B3,arrow:Ioe,auto:_I,basePlacements:Wb,beforeMain:boe,beforeRead:yoe,beforeWrite:xoe,bottom:hs,clippingParents:moe,computeStyles:z3,createPopper:Y3,createPopperBase:vSe,createPopperLite:bSe,detectOverflow:Pv,end:Tv,eventListeners:H3,flip:Doe,hide:Loe,left:_a,main:woe,modifierPhases:Toe,offset:Noe,placements:L3,popper:Ty,popperGenerator:wI,popperOffsets:G3,preventOverflow:Boe,read:voe,reference:goe,right:ds,start:sm,top:va,variationPlacements:PB,viewport:D3,write:Coe},Symbol.toStringTag,{value:"Module"}));/*!
  * Bootstrap v5.2.3 (https://getbootstrap.com/)
  * Copyright 2011-2022 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */const SSe=1e6,xSe=1e3,MB="transitionend",CSe=e=>e==null?`${e}`:Object.prototype.toString.call(e).match(/\s([a-z]+)/i)[1].toLowerCase(),ESe=e=>{do e+=Math.floor(Math.random()*SSe);while(document.getElementById(e));return e},Foe=e=>{let t=e.getAttribute("data-bs-target");if(!t||t==="#"){let r=e.getAttribute("href");if(!r||!r.includes("#")&&!r.startsWith("."))return null;r.includes("#")&&!r.startsWith("#")&&(r=`#${r.split("#")[1]}`),t=r&&r!=="#"?r.trim():null}return t},zoe=e=>{const t=Foe(e);return t&&document.querySelector(t)?t:null},Bc=e=>{const t=Foe(e);return t?document.querySelector(t):null},TSe=e=>{if(!e)return 0;let{transitionDuration:t,transitionDelay:r}=window.getComputedStyle(e);const n=Number.parseFloat(t),i=Number.parseFloat(r);return!n&&!i?0:(t=t.split(",")[0],r=r.split(",")[0],(Number.parseFloat(t)+Number.parseFloat(r))*xSe)},Hoe=e=>{e.dispatchEvent(new Event(MB))},jc=e=>!e||typeof e!="object"?!1:(typeof e.jquery<"u"&&(e=e[0]),typeof e.nodeType<"u"),Nh=e=>jc(e)?e.jquery?e[0]:e:typeof e=="string"&&e.length>0?document.querySelector(e):null,Gb=e=>{if(!jc(e)||e.getClientRects().length===0)return!1;const t=getComputedStyle(e).getPropertyValue("visibility")==="visible",r=e.closest("details:not([open])");if(!r)return t;if(r!==e){const n=e.closest("summary");if(n&&n.parentNode!==r||n===null)return!1}return t},Bh=e=>!e||e.nodeType!==Node.ELEMENT_NODE||e.classList.contains("disabled")?!0:typeof e.disabled<"u"?e.disabled:e.hasAttribute("disabled")&&e.getAttribute("disabled")!=="false",Voe=e=>{if(!document.documentElement.attachShadow)return null;if(typeof e.getRootNode=="function"){const t=e.getRootNode();return t instanceof ShadowRoot?t:null}return e instanceof ShadowRoot?e:e.parentNode?Voe(e.parentNode):null},PP=()=>{},HC=e=>{e.offsetHeight},Uoe=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,zD=[],OSe=e=>{document.readyState==="loading"?(zD.length||document.addEventListener("DOMContentLoaded",()=>{for(const t of zD)t()}),zD.push(e)):e()},Vs=()=>document.documentElement.dir==="rtl",Gs=e=>{OSe(()=>{const t=Uoe();if(t){const r=e.NAME,n=t.fn[r];t.fn[r]=e.jQueryInterface,t.fn[r].Constructor=e,t.fn[r].noConflict=()=>(t.fn[r]=n,e.jQueryInterface)}})},lc=e=>{typeof e=="function"&&e()},Woe=(e,t,r=!0)=>{if(!r){lc(e);return}const n=5,i=TSe(t)+n;let o=!1;const s=({target:a})=>{a===t&&(o=!0,t.removeEventListener(MB,s),lc(e))};t.addEventListener(MB,s),setTimeout(()=>{o||Hoe(t)},i)},K3=(e,t,r,n)=>{const i=e.length;let o=e.indexOf(t);return o===-1?!r&&n?e[i-1]:e[0]:(o+=r?1:-1,n&&(o=(o+i)%i),e[Math.max(0,Math.min(o,i-1))])},RSe=/[^.]*(?=\..*)\.|.*/,kSe=/\..*/,PSe=/::\d+$/,HD={};let rY=1;const Goe={mouseenter:"mouseover",mouseleave:"mouseout"},ASe=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function Yoe(e,t){return t&&`${t}::${rY++}`||e.uidEvent||rY++}function Koe(e){const t=Yoe(e);return e.uidEvent=t,HD[t]=HD[t]||{},HD[t]}function ISe(e,t){return function r(n){return q3(n,{delegateTarget:e}),r.oneOff&&Wt.off(e,n.type,t),t.apply(e,[n])}}function MSe(e,t,r){return function n(i){const o=e.querySelectorAll(t);for(let{target:s}=i;s&&s!==this;s=s.parentNode)for(const a of o)if(a===s)return q3(i,{delegateTarget:s}),n.oneOff&&Wt.off(e,i.type,t,r),r.apply(s,[i])}}function qoe(e,t,r=null){return Object.values(e).find(n=>n.callable===t&&n.delegationSelector===r)}function Xoe(e,t,r){const n=typeof t=="string",i=n?r:t||r;let o=Zoe(e);return ASe.has(o)||(o=e),[n,i,o]}function nY(e,t,r,n,i){if(typeof t!="string"||!e)return;let[o,s,a]=Xoe(t,r,n);t in Goe&&(s=(A=>function($){if(!$.relatedTarget||$.relatedTarget!==$.delegateTarget&&!$.delegateTarget.contains($.relatedTarget))return A.call(this,$)})(s));const h=Koe(e),p=h[a]||(h[a]={}),y=qoe(p,s,o?r:null);if(y){y.oneOff=y.oneOff&&i;return}const S=Yoe(s,t.replace(RSe,"")),E=o?MSe(e,r,s):ISe(e,s);E.delegationSelector=o?r:null,E.callable=s,E.oneOff=i,E.uidEvent=S,p[S]=E,e.addEventListener(a,E,o)}function $B(e,t,r,n,i){const o=qoe(t[r],n,i);o&&(e.removeEventListener(r,o,!!i),delete t[r][o.uidEvent])}function $Se(e,t,r,n){const i=t[r]||{};for(const o of Object.keys(i))if(o.includes(n)){const s=i[o];$B(e,t,r,s.callable,s.delegationSelector)}}function Zoe(e){return e=e.replace(kSe,""),Goe[e]||e}const Wt={on(e,t,r,n){nY(e,t,r,n,!1)},one(e,t,r,n){nY(e,t,r,n,!0)},off(e,t,r,n){if(typeof t!="string"||!e)return;const[i,o,s]=Xoe(t,r,n),a=s!==t,h=Koe(e),p=h[s]||{},y=t.startsWith(".");if(typeof o<"u"){if(!Object.keys(p).length)return;$B(e,h,s,o,i?r:null);return}if(y)for(const S of Object.keys(h))$Se(e,h,S,t.slice(1));for(const S of Object.keys(p)){const E=S.replace(PSe,"");if(!a||t.includes(E)){const O=p[S];$B(e,h,s,O.callable,O.delegationSelector)}}},trigger(e,t,r){if(typeof t!="string"||!e)return null;const n=Uoe(),i=Zoe(t),o=t!==i;let s=null,a=!0,h=!0,p=!1;o&&n&&(s=n.Event(t,r),n(e).trigger(s),a=!s.isPropagationStopped(),h=!s.isImmediatePropagationStopped(),p=s.isDefaultPrevented());let y=new Event(t,{bubbles:a,cancelable:!0});return y=q3(y,r),p&&y.preventDefault(),h&&e.dispatchEvent(y),y.defaultPrevented&&s&&s.preventDefault(),y}};function q3(e,t){for(const[r,n]of Object.entries(t||{}))try{e[r]=n}catch{Object.defineProperty(e,r,{configurable:!0,get(){return n}})}return e}const zf=new Map,VD={set(e,t,r){zf.has(e)||zf.set(e,new Map);const n=zf.get(e);if(!n.has(t)&&n.size!==0){console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(n.keys())[0]}.`);return}n.set(t,r)},get(e,t){return zf.has(e)&&zf.get(e).get(t)||null},remove(e,t){if(!zf.has(e))return;const r=zf.get(e);r.delete(t),r.size===0&&zf.delete(e)}};function iY(e){if(e==="true")return!0;if(e==="false")return!1;if(e===Number(e).toString())return Number(e);if(e===""||e==="null")return null;if(typeof e!="string")return e;try{return JSON.parse(decodeURIComponent(e))}catch{return e}}function UD(e){return e.replace(/[A-Z]/g,t=>`-${t.toLowerCase()}`)}const Fc={setDataAttribute(e,t,r){e.setAttribute(`data-bs-${UD(t)}`,r)},removeDataAttribute(e,t){e.removeAttribute(`data-bs-${UD(t)}`)},getDataAttributes(e){if(!e)return{};const t={},r=Object.keys(e.dataset).filter(n=>n.startsWith("bs")&&!n.startsWith("bsConfig"));for(const n of r){let i=n.replace(/^bs/,"");i=i.charAt(0).toLowerCase()+i.slice(1,i.length),t[i]=iY(e.dataset[n])}return t},getDataAttribute(e,t){return iY(e.getAttribute(`data-bs-${UD(t)}`))}};class VC{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(t){return t=this._mergeConfigObj(t),t=this._configAfterMerge(t),this._typeCheckConfig(t),t}_configAfterMerge(t){return t}_mergeConfigObj(t,r){const n=jc(r)?Fc.getDataAttribute(r,"config"):{};return{...this.constructor.Default,...typeof n=="object"?n:{},...jc(r)?Fc.getDataAttributes(r):{},...typeof t=="object"?t:{}}}_typeCheckConfig(t,r=this.constructor.DefaultType){for(const n of Object.keys(r)){const i=r[n],o=t[n],s=jc(o)?"element":CSe(o);if(!new RegExp(i).test(s))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${n}" provided type "${s}" but expected type "${i}".`)}}}const DSe="5.2.3";let Pl=class extends VC{constructor(t,r){super(),t=Nh(t),t&&(this._element=t,this._config=this._getConfig(r),VD.set(this._element,this.constructor.DATA_KEY,this))}dispose(){VD.remove(this._element,this.constructor.DATA_KEY),Wt.off(this._element,this.constructor.EVENT_KEY);for(const t of Object.getOwnPropertyNames(this))this[t]=null}_queueCallback(t,r,n=!0){Woe(t,r,n)}_getConfig(t){return t=this._mergeConfigObj(t,this._element),t=this._configAfterMerge(t),this._typeCheckConfig(t),t}static getInstance(t){return VD.get(Nh(t),this.DATA_KEY)}static getOrCreateInstance(t,r={}){return this.getInstance(t)||new this(t,typeof r=="object"?r:null)}static get VERSION(){return DSe}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(t){return`${t}${this.EVENT_KEY}`}};const SI=(e,t="hide")=>{const r=`click.dismiss${e.EVENT_KEY}`,n=e.NAME;Wt.on(document,r,`[data-bs-dismiss="${n}"]`,function(i){if(["A","AREA"].includes(this.tagName)&&i.preventDefault(),Bh(this))return;const o=Bc(this)||this.closest(`.${n}`);e.getOrCreateInstance(o)[t]()})},LSe="alert",NSe="bs.alert",Joe=`.${NSe}`,BSe=`close${Joe}`,jSe=`closed${Joe}`,FSe="fade",zSe="show";class xI extends Pl{static get NAME(){return LSe}close(){if(Wt.trigger(this._element,BSe).defaultPrevented)return;this._element.classList.remove(zSe);const r=this._element.classList.contains(FSe);this._queueCallback(()=>this._destroyElement(),this._element,r)}_destroyElement(){this._element.remove(),Wt.trigger(this._element,jSe),this.dispose()}static jQueryInterface(t){return this.each(function(){const r=xI.getOrCreateInstance(this);if(typeof t=="string"){if(r[t]===void 0||t.startsWith("_")||t==="constructor")throw new TypeError(`No method named "${t}"`);r[t](this)}})}}SI(xI,"close");Gs(xI);const HSe="button",VSe="bs.button",USe=`.${VSe}`,WSe=".data-api",GSe="active",oY='[data-bs-toggle="button"]',YSe=`click${USe}${WSe}`;class CI extends Pl{static get NAME(){return HSe}toggle(){this._element.setAttribute("aria-pressed",this._element.classList.toggle(GSe))}static jQueryInterface(t){return this.each(function(){const r=CI.getOrCreateInstance(this);t==="toggle"&&r[t]()})}}Wt.on(document,YSe,oY,e=>{e.preventDefault();const t=e.target.closest(oY);CI.getOrCreateInstance(t).toggle()});Gs(CI);const vn={find(e,t=document.documentElement){return[].concat(...Element.prototype.querySelectorAll.call(t,e))},findOne(e,t=document.documentElement){return Element.prototype.querySelector.call(t,e)},children(e,t){return[].concat(...e.children).filter(r=>r.matches(t))},parents(e,t){const r=[];let n=e.parentNode.closest(t);for(;n;)r.push(n),n=n.parentNode.closest(t);return r},prev(e,t){let r=e.previousElementSibling;for(;r;){if(r.matches(t))return[r];r=r.previousElementSibling}return[]},next(e,t){let r=e.nextElementSibling;for(;r;){if(r.matches(t))return[r];r=r.nextElementSibling}return[]},focusableChildren(e){const t=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map(r=>`${r}:not([tabindex^="-"])`).join(",");return this.find(t,e).filter(r=>!Bh(r)&&Gb(r))}},KSe="swipe",Yb=".bs.swipe",qSe=`touchstart${Yb}`,XSe=`touchmove${Yb}`,ZSe=`touchend${Yb}`,JSe=`pointerdown${Yb}`,QSe=`pointerup${Yb}`,e1e="touch",t1e="pen",r1e="pointer-event",n1e=40,i1e={endCallback:null,leftCallback:null,rightCallback:null},o1e={endCallback:"(function|null)",leftCallback:"(function|null)",rightCallback:"(function|null)"};class AP extends VC{constructor(t,r){super(),this._element=t,!(!t||!AP.isSupported())&&(this._config=this._getConfig(r),this._deltaX=0,this._supportPointerEvents=!!window.PointerEvent,this._initEvents())}static get Default(){return i1e}static get DefaultType(){return o1e}static get NAME(){return KSe}dispose(){Wt.off(this._element,Yb)}_start(t){if(!this._supportPointerEvents){this._deltaX=t.touches[0].clientX;return}this._eventIsPointerPenTouch(t)&&(this._deltaX=t.clientX)}_end(t){this._eventIsPointerPenTouch(t)&&(this._deltaX=t.clientX-this._deltaX),this._handleSwipe(),lc(this._config.endCallback)}_move(t){this._deltaX=t.touches&&t.touches.length>1?0:t.touches[0].clientX-this._deltaX}_handleSwipe(){const t=Math.abs(this._deltaX);if(t<=n1e)return;const r=t/this._deltaX;this._deltaX=0,r&&lc(r>0?this._config.rightCallback:this._config.leftCallback)}_initEvents(){this._supportPointerEvents?(Wt.on(this._element,JSe,t=>this._start(t)),Wt.on(this._element,QSe,t=>this._end(t)),this._element.classList.add(r1e)):(Wt.on(this._element,qSe,t=>this._start(t)),Wt.on(this._element,XSe,t=>this._move(t)),Wt.on(this._element,ZSe,t=>this._end(t)))}_eventIsPointerPenTouch(t){return this._supportPointerEvents&&(t.pointerType===t1e||t.pointerType===e1e)}static isSupported(){return"ontouchstart"in document.documentElement||navigator.maxTouchPoints>0}}const a1e="carousel",s1e="bs.carousel",Gh=`.${s1e}`,Qoe=".data-api",l1e="ArrowLeft",u1e="ArrowRight",c1e=500,F0="next",Gg="prev",Oy="left",hk="right",f1e=`slide${Gh}`,WD=`slid${Gh}`,h1e=`keydown${Gh}`,d1e=`mouseenter${Gh}`,p1e=`mouseleave${Gh}`,m1e=`dragstart${Gh}`,g1e=`load${Gh}${Qoe}`,y1e=`click${Gh}${Qoe}`,eae="carousel",zO="active",v1e="slide",_1e="carousel-item-end",b1e="carousel-item-start",w1e="carousel-item-next",S1e="carousel-item-prev",tae=".active",rae=".carousel-item",x1e=tae+rae,C1e=".carousel-item img",E1e=".carousel-indicators",T1e="[data-bs-slide], [data-bs-slide-to]",O1e='[data-bs-ride="carousel"]',R1e={[l1e]:hk,[u1e]:Oy},k1e={interval:5e3,keyboard:!0,pause:"hover",ride:!1,touch:!0,wrap:!0},P1e={interval:"(number|boolean)",keyboard:"boolean",pause:"(string|boolean)",ride:"(boolean|string)",touch:"boolean",wrap:"boolean"};class UC extends Pl{constructor(t,r){super(t,r),this._interval=null,this._activeElement=null,this._isSliding=!1,this.touchTimeout=null,this._swipeHelper=null,this._indicatorsElement=vn.findOne(E1e,this._element),this._addEventListeners(),this._config.ride===eae&&this.cycle()}static get Default(){return k1e}static get DefaultType(){return P1e}static get NAME(){return a1e}next(){this._slide(F0)}nextWhenVisible(){!document.hidden&&Gb(this._element)&&this.next()}prev(){this._slide(Gg)}pause(){this._isSliding&&Hoe(this._element),this._clearInterval()}cycle(){this._clearInterval(),this._updateInterval(),this._interval=setInterval(()=>this.nextWhenVisible(),this._config.interval)}_maybeEnableCycle(){if(this._config.ride){if(this._isSliding){Wt.one(this._element,WD,()=>this.cycle());return}this.cycle()}}to(t){const r=this._getItems();if(t>r.length-1||t<0)return;if(this._isSliding){Wt.one(this._element,WD,()=>this.to(t));return}const n=this._getItemIndex(this._getActive());if(n===t)return;const i=t>n?F0:Gg;this._slide(i,r[t])}dispose(){this._swipeHelper&&this._swipeHelper.dispose(),super.dispose()}_configAfterMerge(t){return t.defaultInterval=t.interval,t}_addEventListeners(){this._config.keyboard&&Wt.on(this._element,h1e,t=>this._keydown(t)),this._config.pause==="hover"&&(Wt.on(this._element,d1e,()=>this.pause()),Wt.on(this._element,p1e,()=>this._maybeEnableCycle())),this._config.touch&&AP.isSupported()&&this._addTouchEventListeners()}_addTouchEventListeners(){for(const n of vn.find(C1e,this._element))Wt.on(n,m1e,i=>i.preventDefault());const r={leftCallback:()=>this._slide(this._directionToOrder(Oy)),rightCallback:()=>this._slide(this._directionToOrder(hk)),endCallback:()=>{this._config.pause==="hover"&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout(()=>this._maybeEnableCycle(),c1e+this._config.interval))}};this._swipeHelper=new AP(this._element,r)}_keydown(t){if(/input|textarea/i.test(t.target.tagName))return;const r=R1e[t.key];r&&(t.preventDefault(),this._slide(this._directionToOrder(r)))}_getItemIndex(t){return this._getItems().indexOf(t)}_setActiveIndicatorElement(t){if(!this._indicatorsElement)return;const r=vn.findOne(tae,this._indicatorsElement);r.classList.remove(zO),r.removeAttribute("aria-current");const n=vn.findOne(`[data-bs-slide-to="${t}"]`,this._indicatorsElement);n&&(n.classList.add(zO),n.setAttribute("aria-current","true"))}_updateInterval(){const t=this._activeElement||this._getActive();if(!t)return;const r=Number.parseInt(t.getAttribute("data-bs-interval"),10);this._config.interval=r||this._config.defaultInterval}_slide(t,r=null){if(this._isSliding)return;const n=this._getActive(),i=t===F0,o=r||K3(this._getItems(),n,i,this._config.wrap);if(o===n)return;const s=this._getItemIndex(o),a=O=>Wt.trigger(this._element,O,{relatedTarget:o,direction:this._orderToDirection(t),from:this._getItemIndex(n),to:s});if(a(f1e).defaultPrevented||!n||!o)return;const p=!!this._interval;this.pause(),this._isSliding=!0,this._setActiveIndicatorElement(s),this._activeElement=o;const y=i?b1e:_1e,S=i?w1e:S1e;o.classList.add(S),HC(o),n.classList.add(y),o.classList.add(y);const E=()=>{o.classList.remove(y,S),o.classList.add(zO),n.classList.remove(zO,S,y),this._isSliding=!1,a(WD)};this._queueCallback(E,n,this._isAnimated()),p&&this.cycle()}_isAnimated(){return this._element.classList.contains(v1e)}_getActive(){return vn.findOne(x1e,this._element)}_getItems(){return vn.find(rae,this._element)}_clearInterval(){this._interval&&(clearInterval(this._interval),this._interval=null)}_directionToOrder(t){return Vs()?t===Oy?Gg:F0:t===Oy?F0:Gg}_orderToDirection(t){return Vs()?t===Gg?Oy:hk:t===Gg?hk:Oy}static jQueryInterface(t){return this.each(function(){const r=UC.getOrCreateInstance(this,t);if(typeof t=="number"){r.to(t);return}if(typeof t=="string"){if(r[t]===void 0||t.startsWith("_")||t==="constructor")throw new TypeError(`No method named "${t}"`);r[t]()}})}}Wt.on(document,y1e,T1e,function(e){const t=Bc(this);if(!t||!t.classList.contains(eae))return;e.preventDefault();const r=UC.getOrCreateInstance(t),n=this.getAttribute("data-bs-slide-to");if(n){r.to(n),r._maybeEnableCycle();return}if(Fc.getDataAttribute(this,"slide")==="next"){r.next(),r._maybeEnableCycle();return}r.prev(),r._maybeEnableCycle()});Wt.on(window,g1e,()=>{const e=vn.find(O1e);for(const t of e)UC.getOrCreateInstance(t)});Gs(UC);const A1e="collapse",I1e="bs.collapse",WC=`.${I1e}`,M1e=".data-api",$1e=`show${WC}`,D1e=`shown${WC}`,L1e=`hide${WC}`,N1e=`hidden${WC}`,B1e=`click${WC}${M1e}`,GD="show",Gy="collapse",HO="collapsing",j1e="collapsed",F1e=`:scope .${Gy} .${Gy}`,z1e="collapse-horizontal",H1e="width",V1e="height",U1e=".collapse.show, .collapse.collapsing",DB='[data-bs-toggle="collapse"]',W1e={parent:null,toggle:!0},G1e={parent:"(null|element)",toggle:"boolean"};class x1 extends Pl{constructor(t,r){super(t,r),this._isTransitioning=!1,this._triggerArray=[];const n=vn.find(DB);for(const i of n){const o=zoe(i),s=vn.find(o).filter(a=>a===this._element);o!==null&&s.length&&this._triggerArray.push(i)}this._initializeChildren(),this._config.parent||this._addAriaAndCollapsedClass(this._triggerArray,this._isShown()),this._config.toggle&&this.toggle()}static get Default(){return W1e}static get DefaultType(){return G1e}static get NAME(){return A1e}toggle(){this._isShown()?this.hide():this.show()}show(){if(this._isTransitioning||this._isShown())return;let t=[];if(this._config.parent&&(t=this._getFirstLevelChildren(U1e).filter(a=>a!==this._element).map(a=>x1.getOrCreateInstance(a,{toggle:!1}))),t.length&&t[0]._isTransitioning||Wt.trigger(this._element,$1e).defaultPrevented)return;for(const a of t)a.hide();const n=this._getDimension();this._element.classList.remove(Gy),this._element.classList.add(HO),this._element.style[n]=0,this._addAriaAndCollapsedClass(this._triggerArray,!0),this._isTransitioning=!0;const i=()=>{this._isTransitioning=!1,this._element.classList.remove(HO),this._element.classList.add(Gy,GD),this._element.style[n]="",Wt.trigger(this._element,D1e)},s=`scroll${n[0].toUpperCase()+n.slice(1)}`;this._queueCallback(i,this._element,!0),this._element.style[n]=`${this._element[s]}px`}hide(){if(this._isTransitioning||!this._isShown()||Wt.trigger(this._element,L1e).defaultPrevented)return;const r=this._getDimension();this._element.style[r]=`${this._element.getBoundingClientRect()[r]}px`,HC(this._element),this._element.classList.add(HO),this._element.classList.remove(Gy,GD);for(const i of this._triggerArray){const o=Bc(i);o&&!this._isShown(o)&&this._addAriaAndCollapsedClass([i],!1)}this._isTransitioning=!0;const n=()=>{this._isTransitioning=!1,this._element.classList.remove(HO),this._element.classList.add(Gy),Wt.trigger(this._element,N1e)};this._element.style[r]="",this._queueCallback(n,this._element,!0)}_isShown(t=this._element){return t.classList.contains(GD)}_configAfterMerge(t){return t.toggle=!!t.toggle,t.parent=Nh(t.parent),t}_getDimension(){return this._element.classList.contains(z1e)?H1e:V1e}_initializeChildren(){if(!this._config.parent)return;const t=this._getFirstLevelChildren(DB);for(const r of t){const n=Bc(r);n&&this._addAriaAndCollapsedClass([r],this._isShown(n))}}_getFirstLevelChildren(t){const r=vn.find(F1e,this._config.parent);return vn.find(t,this._config.parent).filter(n=>!r.includes(n))}_addAriaAndCollapsedClass(t,r){if(t.length)for(const n of t)n.classList.toggle(j1e,!r),n.setAttribute("aria-expanded",r)}static jQueryInterface(t){const r={};return typeof t=="string"&&/show|hide/.test(t)&&(r.toggle=!1),this.each(function(){const n=x1.getOrCreateInstance(this,r);if(typeof t=="string"){if(typeof n[t]>"u")throw new TypeError(`No method named "${t}"`);n[t]()}})}}Wt.on(document,B1e,DB,function(e){(e.target.tagName==="A"||e.delegateTarget&&e.delegateTarget.tagName==="A")&&e.preventDefault();const t=zoe(this),r=vn.find(t);for(const n of r)x1.getOrCreateInstance(n,{toggle:!1}).toggle()});Gs(x1);const aY="dropdown",Y1e="bs.dropdown",Rm=`.${Y1e}`,X3=".data-api",K1e="Escape",sY="Tab",q1e="ArrowUp",lY="ArrowDown",X1e=2,Z1e=`hide${Rm}`,J1e=`hidden${Rm}`,Q1e=`show${Rm}`,exe=`shown${Rm}`,nae=`click${Rm}${X3}`,iae=`keydown${Rm}${X3}`,txe=`keyup${Rm}${X3}`,Ry="show",rxe="dropup",nxe="dropend",ixe="dropstart",oxe="dropup-center",axe="dropdown-center",_p='[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',sxe=`${_p}.${Ry}`,dk=".dropdown-menu",lxe=".navbar",uxe=".navbar-nav",cxe=".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",fxe=Vs()?"top-end":"top-start",hxe=Vs()?"top-start":"top-end",dxe=Vs()?"bottom-end":"bottom-start",pxe=Vs()?"bottom-start":"bottom-end",mxe=Vs()?"left-start":"right-start",gxe=Vs()?"right-start":"left-start",yxe="top",vxe="bottom",_xe={autoClose:!0,boundary:"clippingParents",display:"dynamic",offset:[0,2],popperConfig:null,reference:"toggle"},bxe={autoClose:"(boolean|string)",boundary:"(string|element)",display:"string",offset:"(array|string|function)",popperConfig:"(null|object|function)",reference:"(string|element|object)"};class bu extends Pl{constructor(t,r){super(t,r),this._popper=null,this._parent=this._element.parentNode,this._menu=vn.next(this._element,dk)[0]||vn.prev(this._element,dk)[0]||vn.findOne(dk,this._parent),this._inNavbar=this._detectNavbar()}static get Default(){return _xe}static get DefaultType(){return bxe}static get NAME(){return aY}toggle(){return this._isShown()?this.hide():this.show()}show(){if(Bh(this._element)||this._isShown())return;const t={relatedTarget:this._element};if(!Wt.trigger(this._element,Q1e,t).defaultPrevented){if(this._createPopper(),"ontouchstart"in document.documentElement&&!this._parent.closest(uxe))for(const n of[].concat(...document.body.children))Wt.on(n,"mouseover",PP);this._element.focus(),this._element.setAttribute("aria-expanded",!0),this._menu.classList.add(Ry),this._element.classList.add(Ry),Wt.trigger(this._element,exe,t)}}hide(){if(Bh(this._element)||!this._isShown())return;const t={relatedTarget:this._element};this._completeHide(t)}dispose(){this._popper&&this._popper.destroy(),super.dispose()}update(){this._inNavbar=this._detectNavbar(),this._popper&&this._popper.update()}_completeHide(t){if(!Wt.trigger(this._element,Z1e,t).defaultPrevented){if("ontouchstart"in document.documentElement)for(const n of[].concat(...document.body.children))Wt.off(n,"mouseover",PP);this._popper&&this._popper.destroy(),this._menu.classList.remove(Ry),this._element.classList.remove(Ry),this._element.setAttribute("aria-expanded","false"),Fc.removeDataAttribute(this._menu,"popper"),Wt.trigger(this._element,J1e,t)}}_getConfig(t){if(t=super._getConfig(t),typeof t.reference=="object"&&!jc(t.reference)&&typeof t.reference.getBoundingClientRect!="function")throw new TypeError(`${aY.toUpperCase()}: Option "reference" provided type "object" without a required "getBoundingClientRect" method.`);return t}_createPopper(){if(typeof joe>"u")throw new TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org)");let t=this._element;this._config.reference==="parent"?t=this._parent:jc(this._config.reference)?t=Nh(this._config.reference):typeof this._config.reference=="object"&&(t=this._config.reference);const r=this._getPopperConfig();this._popper=Y3(t,this._menu,r)}_isShown(){return this._menu.classList.contains(Ry)}_getPlacement(){const t=this._parent;if(t.classList.contains(nxe))return mxe;if(t.classList.contains(ixe))return gxe;if(t.classList.contains(oxe))return yxe;if(t.classList.contains(axe))return vxe;const r=getComputedStyle(this._menu).getPropertyValue("--bs-position").trim()==="end";return t.classList.contains(rxe)?r?hxe:fxe:r?pxe:dxe}_detectNavbar(){return this._element.closest(lxe)!==null}_getOffset(){const{offset:t}=this._config;return typeof t=="string"?t.split(",").map(r=>Number.parseInt(r,10)):typeof t=="function"?r=>t(r,this._element):t}_getPopperConfig(){const t={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return(this._inNavbar||this._config.display==="static")&&(Fc.setDataAttribute(this._menu,"popper","static"),t.modifiers=[{name:"applyStyles",enabled:!1}]),{...t,...typeof this._config.popperConfig=="function"?this._config.popperConfig(t):this._config.popperConfig}}_selectMenuItem({key:t,target:r}){const n=vn.find(cxe,this._menu).filter(i=>Gb(i));n.length&&K3(n,r,t===lY,!n.includes(r)).focus()}static jQueryInterface(t){return this.each(function(){const r=bu.getOrCreateInstance(this,t);if(typeof t=="string"){if(typeof r[t]>"u")throw new TypeError(`No method named "${t}"`);r[t]()}})}static clearMenus(t){if(t.button===X1e||t.type==="keyup"&&t.key!==sY)return;const r=vn.find(sxe);for(const n of r){const i=bu.getInstance(n);if(!i||i._config.autoClose===!1)continue;const o=t.composedPath(),s=o.includes(i._menu);if(o.includes(i._element)||i._config.autoClose==="inside"&&!s||i._config.autoClose==="outside"&&s||i._menu.contains(t.target)&&(t.type==="keyup"&&t.key===sY||/input|select|option|textarea|form/i.test(t.target.tagName)))continue;const a={relatedTarget:i._element};t.type==="click"&&(a.clickEvent=t),i._completeHide(a)}}static dataApiKeydownHandler(t){const r=/input|textarea/i.test(t.target.tagName),n=t.key===K1e,i=[q1e,lY].includes(t.key);if(!i&&!n||r&&!n)return;t.preventDefault();const o=this.matches(_p)?this:vn.prev(this,_p)[0]||vn.next(this,_p)[0]||vn.findOne(_p,t.delegateTarget.parentNode),s=bu.getOrCreateInstance(o);if(i){t.stopPropagation(),s.show(),s._selectMenuItem(t);return}s._isShown()&&(t.stopPropagation(),s.hide(),o.focus())}}Wt.on(document,iae,_p,bu.dataApiKeydownHandler);Wt.on(document,iae,dk,bu.dataApiKeydownHandler);Wt.on(document,nae,bu.clearMenus);Wt.on(document,txe,bu.clearMenus);Wt.on(document,nae,_p,function(e){e.preventDefault(),bu.getOrCreateInstance(this).toggle()});Gs(bu);const uY=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",cY=".sticky-top",VO="padding-right",fY="margin-right";class LB{constructor(){this._element=document.body}getWidth(){const t=document.documentElement.clientWidth;return Math.abs(window.innerWidth-t)}hide(){const t=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,VO,r=>r+t),this._setElementAttributes(uY,VO,r=>r+t),this._setElementAttributes(cY,fY,r=>r-t)}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,VO),this._resetElementAttributes(uY,VO),this._resetElementAttributes(cY,fY)}isOverflowing(){return this.getWidth()>0}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(t,r,n){const i=this.getWidth(),o=s=>{if(s!==this._element&&window.innerWidth>s.clientWidth+i)return;this._saveInitialAttribute(s,r);const a=window.getComputedStyle(s).getPropertyValue(r);s.style.setProperty(r,`${n(Number.parseFloat(a))}px`)};this._applyManipulationCallback(t,o)}_saveInitialAttribute(t,r){const n=t.style.getPropertyValue(r);n&&Fc.setDataAttribute(t,r,n)}_resetElementAttributes(t,r){const n=i=>{const o=Fc.getDataAttribute(i,r);if(o===null){i.style.removeProperty(r);return}Fc.removeDataAttribute(i,r),i.style.setProperty(r,o)};this._applyManipulationCallback(t,n)}_applyManipulationCallback(t,r){if(jc(t)){r(t);return}for(const n of vn.find(t,this._element))r(n)}}const oae="backdrop",wxe="fade",hY="show",dY=`mousedown.bs.${oae}`,Sxe={className:"modal-backdrop",clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:"body"},xxe={className:"string",clickCallback:"(function|null)",isAnimated:"boolean",isVisible:"boolean",rootElement:"(element|string)"};class aae extends VC{constructor(t){super(),this._config=this._getConfig(t),this._isAppended=!1,this._element=null}static get Default(){return Sxe}static get DefaultType(){return xxe}static get NAME(){return oae}show(t){if(!this._config.isVisible){lc(t);return}this._append();const r=this._getElement();this._config.isAnimated&&HC(r),r.classList.add(hY),this._emulateAnimation(()=>{lc(t)})}hide(t){if(!this._config.isVisible){lc(t);return}this._getElement().classList.remove(hY),this._emulateAnimation(()=>{this.dispose(),lc(t)})}dispose(){this._isAppended&&(Wt.off(this._element,dY),this._element.remove(),this._isAppended=!1)}_getElement(){if(!this._element){const t=document.createElement("div");t.className=this._config.className,this._config.isAnimated&&t.classList.add(wxe),this._element=t}return this._element}_configAfterMerge(t){return t.rootElement=Nh(t.rootElement),t}_append(){if(this._isAppended)return;const t=this._getElement();this._config.rootElement.append(t),Wt.on(t,dY,()=>{lc(this._config.clickCallback)}),this._isAppended=!0}_emulateAnimation(t){Woe(t,this._getElement(),this._config.isAnimated)}}const Cxe="focustrap",Exe="bs.focustrap",IP=`.${Exe}`,Txe=`focusin${IP}`,Oxe=`keydown.tab${IP}`,Rxe="Tab",kxe="forward",pY="backward",Pxe={autofocus:!0,trapElement:null},Axe={autofocus:"boolean",trapElement:"element"};class sae extends VC{constructor(t){super(),this._config=this._getConfig(t),this._isActive=!1,this._lastTabNavDirection=null}static get Default(){return Pxe}static get DefaultType(){return Axe}static get NAME(){return Cxe}activate(){this._isActive||(this._config.autofocus&&this._config.trapElement.focus(),Wt.off(document,IP),Wt.on(document,Txe,t=>this._handleFocusin(t)),Wt.on(document,Oxe,t=>this._handleKeydown(t)),this._isActive=!0)}deactivate(){this._isActive&&(this._isActive=!1,Wt.off(document,IP))}_handleFocusin(t){const{trapElement:r}=this._config;if(t.target===document||t.target===r||r.contains(t.target))return;const n=vn.focusableChildren(r);n.length===0?r.focus():this._lastTabNavDirection===pY?n[n.length-1].focus():n[0].focus()}_handleKeydown(t){t.key===Rxe&&(this._lastTabNavDirection=t.shiftKey?pY:kxe)}}const Ixe="modal",Mxe="bs.modal",Al=`.${Mxe}`,$xe=".data-api",Dxe="Escape",Lxe=`hide${Al}`,Nxe=`hidePrevented${Al}`,lae=`hidden${Al}`,uae=`show${Al}`,Bxe=`shown${Al}`,jxe=`resize${Al}`,Fxe=`click.dismiss${Al}`,zxe=`mousedown.dismiss${Al}`,Hxe=`keydown.dismiss${Al}`,Vxe=`click${Al}${$xe}`,mY="modal-open",Uxe="fade",gY="show",YD="modal-static",Wxe=".modal.show",Gxe=".modal-dialog",Yxe=".modal-body",Kxe='[data-bs-toggle="modal"]',qxe={backdrop:!0,focus:!0,keyboard:!0},Xxe={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class Av extends Pl{constructor(t,r){super(t,r),this._dialog=vn.findOne(Gxe,this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new LB,this._addEventListeners()}static get Default(){return qxe}static get DefaultType(){return Xxe}static get NAME(){return Ixe}toggle(t){return this._isShown?this.hide():this.show(t)}show(t){this._isShown||this._isTransitioning||Wt.trigger(this._element,uae,{relatedTarget:t}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add(mY),this._adjustDialog(),this._backdrop.show(()=>this._showElement(t)))}hide(){!this._isShown||this._isTransitioning||Wt.trigger(this._element,Lxe).defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove(gY),this._queueCallback(()=>this._hideModal(),this._element,this._isAnimated()))}dispose(){for(const t of[window,this._dialog])Wt.off(t,Al);this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new aae({isVisible:!!this._config.backdrop,isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new sae({trapElement:this._element})}_showElement(t){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0;const r=vn.findOne(Yxe,this._dialog);r&&(r.scrollTop=0),HC(this._element),this._element.classList.add(gY);const n=()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,Wt.trigger(this._element,Bxe,{relatedTarget:t})};this._queueCallback(n,this._dialog,this._isAnimated())}_addEventListeners(){Wt.on(this._element,Hxe,t=>{if(t.key===Dxe){if(this._config.keyboard){t.preventDefault(),this.hide();return}this._triggerBackdropTransition()}}),Wt.on(window,jxe,()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()}),Wt.on(this._element,zxe,t=>{Wt.one(this._element,Fxe,r=>{if(!(this._element!==t.target||this._element!==r.target)){if(this._config.backdrop==="static"){this._triggerBackdropTransition();return}this._config.backdrop&&this.hide()}})})}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide(()=>{document.body.classList.remove(mY),this._resetAdjustments(),this._scrollBar.reset(),Wt.trigger(this._element,lae)})}_isAnimated(){return this._element.classList.contains(Uxe)}_triggerBackdropTransition(){if(Wt.trigger(this._element,Nxe).defaultPrevented)return;const r=this._element.scrollHeight>document.documentElement.clientHeight,n=this._element.style.overflowY;n==="hidden"||this._element.classList.contains(YD)||(r||(this._element.style.overflowY="hidden"),this._element.classList.add(YD),this._queueCallback(()=>{this._element.classList.remove(YD),this._queueCallback(()=>{this._element.style.overflowY=n},this._dialog)},this._dialog),this._element.focus())}_adjustDialog(){const t=this._element.scrollHeight>document.documentElement.clientHeight,r=this._scrollBar.getWidth(),n=r>0;if(n&&!t){const i=Vs()?"paddingLeft":"paddingRight";this._element.style[i]=`${r}px`}if(!n&&t){const i=Vs()?"paddingRight":"paddingLeft";this._element.style[i]=`${r}px`}}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(t,r){return this.each(function(){const n=Av.getOrCreateInstance(this,t);if(typeof t=="string"){if(typeof n[t]>"u")throw new TypeError(`No method named "${t}"`);n[t](r)}})}}Wt.on(document,Vxe,Kxe,function(e){const t=Bc(this);["A","AREA"].includes(this.tagName)&&e.preventDefault(),Wt.one(t,uae,i=>{i.defaultPrevented||Wt.one(t,lae,()=>{Gb(this)&&this.focus()})});const r=vn.findOne(Wxe);r&&Av.getInstance(r).hide(),Av.getOrCreateInstance(t).toggle(this)});SI(Av);Gs(Av);const Zxe="offcanvas",Jxe="bs.offcanvas",ef=`.${Jxe}`,cae=".data-api",Qxe=`load${ef}${cae}`,eCe="Escape",yY="show",vY="showing",_Y="hiding",tCe="offcanvas-backdrop",fae=".offcanvas.show",rCe=`show${ef}`,nCe=`shown${ef}`,iCe=`hide${ef}`,bY=`hidePrevented${ef}`,hae=`hidden${ef}`,oCe=`resize${ef}`,aCe=`click${ef}${cae}`,sCe=`keydown.dismiss${ef}`,lCe='[data-bs-toggle="offcanvas"]',uCe={backdrop:!0,keyboard:!0,scroll:!1},cCe={backdrop:"(boolean|string)",keyboard:"boolean",scroll:"boolean"};class jh extends Pl{constructor(t,r){super(t,r),this._isShown=!1,this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._addEventListeners()}static get Default(){return uCe}static get DefaultType(){return cCe}static get NAME(){return Zxe}toggle(t){return this._isShown?this.hide():this.show(t)}show(t){if(this._isShown||Wt.trigger(this._element,rCe,{relatedTarget:t}).defaultPrevented)return;this._isShown=!0,this._backdrop.show(),this._config.scroll||new LB().hide(),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.classList.add(vY);const n=()=>{(!this._config.scroll||this._config.backdrop)&&this._focustrap.activate(),this._element.classList.add(yY),this._element.classList.remove(vY),Wt.trigger(this._element,nCe,{relatedTarget:t})};this._queueCallback(n,this._element,!0)}hide(){if(!this._isShown||Wt.trigger(this._element,iCe).defaultPrevented)return;this._focustrap.deactivate(),this._element.blur(),this._isShown=!1,this._element.classList.add(_Y),this._backdrop.hide();const r=()=>{this._element.classList.remove(yY,_Y),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._config.scroll||new LB().reset(),Wt.trigger(this._element,hae)};this._queueCallback(r,this._element,!0)}dispose(){this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}_initializeBackDrop(){const t=()=>{if(this._config.backdrop==="static"){Wt.trigger(this._element,bY);return}this.hide()},r=!!this._config.backdrop;return new aae({className:tCe,isVisible:r,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:r?t:null})}_initializeFocusTrap(){return new sae({trapElement:this._element})}_addEventListeners(){Wt.on(this._element,sCe,t=>{if(t.key===eCe){if(!this._config.keyboard){Wt.trigger(this._element,bY);return}this.hide()}})}static jQueryInterface(t){return this.each(function(){const r=jh.getOrCreateInstance(this,t);if(typeof t=="string"){if(r[t]===void 0||t.startsWith("_")||t==="constructor")throw new TypeError(`No method named "${t}"`);r[t](this)}})}}Wt.on(document,aCe,lCe,function(e){const t=Bc(this);if(["A","AREA"].includes(this.tagName)&&e.preventDefault(),Bh(this))return;Wt.one(t,hae,()=>{Gb(this)&&this.focus()});const r=vn.findOne(fae);r&&r!==t&&jh.getInstance(r).hide(),jh.getOrCreateInstance(t).toggle(this)});Wt.on(window,Qxe,()=>{for(const e of vn.find(fae))jh.getOrCreateInstance(e).show()});Wt.on(window,oCe,()=>{for(const e of vn.find("[aria-modal][class*=show][class*=offcanvas-]"))getComputedStyle(e).position!=="fixed"&&jh.getOrCreateInstance(e).hide()});SI(jh);Gs(jh);const fCe=new Set(["background","cite","href","itemtype","longdesc","poster","src","xlink:href"]),hCe=/^aria-[\w-]*$/i,dCe=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^#&/:?]*(?:[#/?]|$))/i,pCe=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[\d+/a-z]+=*$/i,mCe=(e,t)=>{const r=e.nodeName.toLowerCase();return t.includes(r)?fCe.has(r)?!!(dCe.test(e.nodeValue)||pCe.test(e.nodeValue)):!0:t.filter(n=>n instanceof RegExp).some(n=>n.test(r))},dae={"*":["class","dir","id","lang","role",hCe],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],div:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]};function gCe(e,t,r){if(!e.length)return e;if(r&&typeof r=="function")return r(e);const i=new window.DOMParser().parseFromString(e,"text/html"),o=[].concat(...i.body.querySelectorAll("*"));for(const s of o){const a=s.nodeName.toLowerCase();if(!Object.keys(t).includes(a)){s.remove();continue}const h=[].concat(...s.attributes),p=[].concat(t["*"]||[],t[a]||[]);for(const y of h)mCe(y,p)||s.removeAttribute(y.nodeName)}return i.body.innerHTML}const yCe="TemplateFactory",vCe={allowList:dae,content:{},extraClass:"",html:!1,sanitize:!0,sanitizeFn:null,template:"<div></div>"},_Ce={allowList:"object",content:"object",extraClass:"(string|function)",html:"boolean",sanitize:"boolean",sanitizeFn:"(null|function)",template:"string"},bCe={entry:"(string|element|function|null)",selector:"(string|element)"};class wCe extends VC{constructor(t){super(),this._config=this._getConfig(t)}static get Default(){return vCe}static get DefaultType(){return _Ce}static get NAME(){return yCe}getContent(){return Object.values(this._config.content).map(t=>this._resolvePossibleFunction(t)).filter(Boolean)}hasContent(){return this.getContent().length>0}changeContent(t){return this._checkContent(t),this._config.content={...this._config.content,...t},this}toHtml(){const t=document.createElement("div");t.innerHTML=this._maybeSanitize(this._config.template);for(const[i,o]of Object.entries(this._config.content))this._setContent(t,o,i);const r=t.children[0],n=this._resolvePossibleFunction(this._config.extraClass);return n&&r.classList.add(...n.split(" ")),r}_typeCheckConfig(t){super._typeCheckConfig(t),this._checkContent(t.content)}_checkContent(t){for(const[r,n]of Object.entries(t))super._typeCheckConfig({selector:r,entry:n},bCe)}_setContent(t,r,n){const i=vn.findOne(n,t);if(i){if(r=this._resolvePossibleFunction(r),!r){i.remove();return}if(jc(r)){this._putElementInTemplate(Nh(r),i);return}if(this._config.html){i.innerHTML=this._maybeSanitize(r);return}i.textContent=r}}_maybeSanitize(t){return this._config.sanitize?gCe(t,this._config.allowList,this._config.sanitizeFn):t}_resolvePossibleFunction(t){return typeof t=="function"?t(this):t}_putElementInTemplate(t,r){if(this._config.html){r.innerHTML="",r.append(t);return}r.textContent=t.textContent}}const SCe="tooltip",xCe=new Set(["sanitize","allowList","sanitizeFn"]),KD="fade",CCe="modal",UO="show",ECe=".tooltip-inner",wY=`.${CCe}`,SY="hide.bs.modal",z0="hover",qD="focus",TCe="click",OCe="manual",RCe="hide",kCe="hidden",PCe="show",ACe="shown",ICe="inserted",MCe="click",$Ce="focusin",DCe="focusout",LCe="mouseenter",NCe="mouseleave",BCe={AUTO:"auto",TOP:"top",RIGHT:Vs()?"left":"right",BOTTOM:"bottom",LEFT:Vs()?"right":"left"},jCe={allowList:dae,animation:!0,boundary:"clippingParents",container:!1,customClass:"",delay:0,fallbackPlacements:["top","right","bottom","left"],html:!1,offset:[0,0],placement:"top",popperConfig:null,sanitize:!0,sanitizeFn:null,selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',title:"",trigger:"hover focus"},FCe={allowList:"object",animation:"boolean",boundary:"(string|element)",container:"(string|element|boolean)",customClass:"(string|function)",delay:"(number|object)",fallbackPlacements:"array",html:"boolean",offset:"(array|string|function)",placement:"(string|function)",popperConfig:"(null|object|function)",sanitize:"boolean",sanitizeFn:"(null|function)",selector:"(string|boolean)",template:"string",title:"(string|element|function)",trigger:"string"};class Kb extends Pl{constructor(t,r){if(typeof joe>"u")throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org)");super(t,r),this._isEnabled=!0,this._timeout=0,this._isHovered=null,this._activeTrigger={},this._popper=null,this._templateFactory=null,this._newContent=null,this.tip=null,this._setListeners(),this._config.selector||this._fixTitle()}static get Default(){return jCe}static get DefaultType(){return FCe}static get NAME(){return SCe}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(){if(this._isEnabled){if(this._activeTrigger.click=!this._activeTrigger.click,this._isShown()){this._leave();return}this._enter()}}dispose(){clearTimeout(this._timeout),Wt.off(this._element.closest(wY),SY,this._hideModalHandler),this._element.getAttribute("data-bs-original-title")&&this._element.setAttribute("title",this._element.getAttribute("data-bs-original-title")),this._disposePopper(),super.dispose()}show(){if(this._element.style.display==="none")throw new Error("Please use show on visible elements");if(!(this._isWithContent()&&this._isEnabled))return;const t=Wt.trigger(this._element,this.constructor.eventName(PCe)),n=(Voe(this._element)||this._element.ownerDocument.documentElement).contains(this._element);if(t.defaultPrevented||!n)return;this._disposePopper();const i=this._getTipElement();this._element.setAttribute("aria-describedby",i.getAttribute("id"));const{container:o}=this._config;if(this._element.ownerDocument.documentElement.contains(this.tip)||(o.append(i),Wt.trigger(this._element,this.constructor.eventName(ICe))),this._popper=this._createPopper(i),i.classList.add(UO),"ontouchstart"in document.documentElement)for(const a of[].concat(...document.body.children))Wt.on(a,"mouseover",PP);const s=()=>{Wt.trigger(this._element,this.constructor.eventName(ACe)),this._isHovered===!1&&this._leave(),this._isHovered=!1};this._queueCallback(s,this.tip,this._isAnimated())}hide(){if(!this._isShown()||Wt.trigger(this._element,this.constructor.eventName(RCe)).defaultPrevented)return;if(this._getTipElement().classList.remove(UO),"ontouchstart"in document.documentElement)for(const i of[].concat(...document.body.children))Wt.off(i,"mouseover",PP);this._activeTrigger[TCe]=!1,this._activeTrigger[qD]=!1,this._activeTrigger[z0]=!1,this._isHovered=null;const n=()=>{this._isWithActiveTrigger()||(this._isHovered||this._disposePopper(),this._element.removeAttribute("aria-describedby"),Wt.trigger(this._element,this.constructor.eventName(kCe)))};this._queueCallback(n,this.tip,this._isAnimated())}update(){this._popper&&this._popper.update()}_isWithContent(){return!!this._getTitle()}_getTipElement(){return this.tip||(this.tip=this._createTipElement(this._newContent||this._getContentForTemplate())),this.tip}_createTipElement(t){const r=this._getTemplateFactory(t).toHtml();if(!r)return null;r.classList.remove(KD,UO),r.classList.add(`bs-${this.constructor.NAME}-auto`);const n=ESe(this.constructor.NAME).toString();return r.setAttribute("id",n),this._isAnimated()&&r.classList.add(KD),r}setContent(t){this._newContent=t,this._isShown()&&(this._disposePopper(),this.show())}_getTemplateFactory(t){return this._templateFactory?this._templateFactory.changeContent(t):this._templateFactory=new wCe({...this._config,content:t,extraClass:this._resolvePossibleFunction(this._config.customClass)}),this._templateFactory}_getContentForTemplate(){return{[ECe]:this._getTitle()}}_getTitle(){return this._resolvePossibleFunction(this._config.title)||this._element.getAttribute("data-bs-original-title")}_initializeOnDelegatedTarget(t){return this.constructor.getOrCreateInstance(t.delegateTarget,this._getDelegateConfig())}_isAnimated(){return this._config.animation||this.tip&&this.tip.classList.contains(KD)}_isShown(){return this.tip&&this.tip.classList.contains(UO)}_createPopper(t){const r=typeof this._config.placement=="function"?this._config.placement.call(this,t,this._element):this._config.placement,n=BCe[r.toUpperCase()];return Y3(this._element,t,this._getPopperConfig(n))}_getOffset(){const{offset:t}=this._config;return typeof t=="string"?t.split(",").map(r=>Number.parseInt(r,10)):typeof t=="function"?r=>t(r,this._element):t}_resolvePossibleFunction(t){return typeof t=="function"?t.call(this._element):t}_getPopperConfig(t){const r={placement:t,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"preSetPlacement",enabled:!0,phase:"beforeMain",fn:n=>{this._getTipElement().setAttribute("data-popper-placement",n.state.placement)}}]};return{...r,...typeof this._config.popperConfig=="function"?this._config.popperConfig(r):this._config.popperConfig}}_setListeners(){const t=this._config.trigger.split(" ");for(const r of t)if(r==="click")Wt.on(this._element,this.constructor.eventName(MCe),this._config.selector,n=>{this._initializeOnDelegatedTarget(n).toggle()});else if(r!==OCe){const n=r===z0?this.constructor.eventName(LCe):this.constructor.eventName($Ce),i=r===z0?this.constructor.eventName(NCe):this.constructor.eventName(DCe);Wt.on(this._element,n,this._config.selector,o=>{const s=this._initializeOnDelegatedTarget(o);s._activeTrigger[o.type==="focusin"?qD:z0]=!0,s._enter()}),Wt.on(this._element,i,this._config.selector,o=>{const s=this._initializeOnDelegatedTarget(o);s._activeTrigger[o.type==="focusout"?qD:z0]=s._element.contains(o.relatedTarget),s._leave()})}this._hideModalHandler=()=>{this._element&&this.hide()},Wt.on(this._element.closest(wY),SY,this._hideModalHandler)}_fixTitle(){const t=this._element.getAttribute("title");t&&(!this._element.getAttribute("aria-label")&&!this._element.textContent.trim()&&this._element.setAttribute("aria-label",t),this._element.setAttribute("data-bs-original-title",t),this._element.removeAttribute("title"))}_enter(){if(this._isShown()||this._isHovered){this._isHovered=!0;return}this._isHovered=!0,this._setTimeout(()=>{this._isHovered&&this.show()},this._config.delay.show)}_leave(){this._isWithActiveTrigger()||(this._isHovered=!1,this._setTimeout(()=>{this._isHovered||this.hide()},this._config.delay.hide))}_setTimeout(t,r){clearTimeout(this._timeout),this._timeout=setTimeout(t,r)}_isWithActiveTrigger(){return Object.values(this._activeTrigger).includes(!0)}_getConfig(t){const r=Fc.getDataAttributes(this._element);for(const n of Object.keys(r))xCe.has(n)&&delete r[n];return t={...r,...typeof t=="object"&&t?t:{}},t=this._mergeConfigObj(t),t=this._configAfterMerge(t),this._typeCheckConfig(t),t}_configAfterMerge(t){return t.container=t.container===!1?document.body:Nh(t.container),typeof t.delay=="number"&&(t.delay={show:t.delay,hide:t.delay}),typeof t.title=="number"&&(t.title=t.title.toString()),typeof t.content=="number"&&(t.content=t.content.toString()),t}_getDelegateConfig(){const t={};for(const r in this._config)this.constructor.Default[r]!==this._config[r]&&(t[r]=this._config[r]);return t.selector=!1,t.trigger="manual",t}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null),this.tip&&(this.tip.remove(),this.tip=null)}static jQueryInterface(t){return this.each(function(){const r=Kb.getOrCreateInstance(this,t);if(typeof t=="string"){if(typeof r[t]>"u")throw new TypeError(`No method named "${t}"`);r[t]()}})}}Gs(Kb);const zCe="popover",HCe=".popover-header",VCe=".popover-body",UCe={...Kb.Default,content:"",offset:[0,8],placement:"right",template:'<div class="popover" role="tooltip"><div class="popover-arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>',trigger:"click"},WCe={...Kb.DefaultType,content:"(null|string|element|function)"};class Z3 extends Kb{static get Default(){return UCe}static get DefaultType(){return WCe}static get NAME(){return zCe}_isWithContent(){return this._getTitle()||this._getContent()}_getContentForTemplate(){return{[HCe]:this._getTitle(),[VCe]:this._getContent()}}_getContent(){return this._resolvePossibleFunction(this._config.content)}static jQueryInterface(t){return this.each(function(){const r=Z3.getOrCreateInstance(this,t);if(typeof t=="string"){if(typeof r[t]>"u")throw new TypeError(`No method named "${t}"`);r[t]()}})}}Gs(Z3);const GCe="scrollspy",YCe="bs.scrollspy",J3=`.${YCe}`,KCe=".data-api",qCe=`activate${J3}`,xY=`click${J3}`,XCe=`load${J3}${KCe}`,ZCe="dropdown-item",Yg="active",JCe='[data-bs-spy="scroll"]',XD="[href]",QCe=".nav, .list-group",CY=".nav-link",eEe=".nav-item",tEe=".list-group-item",rEe=`${CY}, ${eEe} > ${CY}, ${tEe}`,nEe=".dropdown",iEe=".dropdown-toggle",oEe={offset:null,rootMargin:"0px 0px -25%",smoothScroll:!1,target:null,threshold:[.1,.5,1]},aEe={offset:"(number|null)",rootMargin:"string",smoothScroll:"boolean",target:"element",threshold:"array"};class EI extends Pl{constructor(t,r){super(t,r),this._targetLinks=new Map,this._observableSections=new Map,this._rootElement=getComputedStyle(this._element).overflowY==="visible"?null:this._element,this._activeTarget=null,this._observer=null,this._previousScrollData={visibleEntryTop:0,parentScrollTop:0},this.refresh()}static get Default(){return oEe}static get DefaultType(){return aEe}static get NAME(){return GCe}refresh(){this._initializeTargetsAndObservables(),this._maybeEnableSmoothScroll(),this._observer?this._observer.disconnect():this._observer=this._getNewObserver();for(const t of this._observableSections.values())this._observer.observe(t)}dispose(){this._observer.disconnect(),super.dispose()}_configAfterMerge(t){return t.target=Nh(t.target)||document.body,t.rootMargin=t.offset?`${t.offset}px 0px -30%`:t.rootMargin,typeof t.threshold=="string"&&(t.threshold=t.threshold.split(",").map(r=>Number.parseFloat(r))),t}_maybeEnableSmoothScroll(){this._config.smoothScroll&&(Wt.off(this._config.target,xY),Wt.on(this._config.target,xY,XD,t=>{const r=this._observableSections.get(t.target.hash);if(r){t.preventDefault();const n=this._rootElement||window,i=r.offsetTop-this._element.offsetTop;if(n.scrollTo){n.scrollTo({top:i,behavior:"smooth"});return}n.scrollTop=i}}))}_getNewObserver(){const t={root:this._rootElement,threshold:this._config.threshold,rootMargin:this._config.rootMargin};return new IntersectionObserver(r=>this._observerCallback(r),t)}_observerCallback(t){const r=s=>this._targetLinks.get(`#${s.target.id}`),n=s=>{this._previousScrollData.visibleEntryTop=s.target.offsetTop,this._process(r(s))},i=(this._rootElement||document.documentElement).scrollTop,o=i>=this._previousScrollData.parentScrollTop;this._previousScrollData.parentScrollTop=i;for(const s of t){if(!s.isIntersecting){this._activeTarget=null,this._clearActiveClass(r(s));continue}const a=s.target.offsetTop>=this._previousScrollData.visibleEntryTop;if(o&&a){if(n(s),!i)return;continue}!o&&!a&&n(s)}}_initializeTargetsAndObservables(){this._targetLinks=new Map,this._observableSections=new Map;const t=vn.find(XD,this._config.target);for(const r of t){if(!r.hash||Bh(r))continue;const n=vn.findOne(r.hash,this._element);Gb(n)&&(this._targetLinks.set(r.hash,r),this._observableSections.set(r.hash,n))}}_process(t){this._activeTarget!==t&&(this._clearActiveClass(this._config.target),this._activeTarget=t,t.classList.add(Yg),this._activateParents(t),Wt.trigger(this._element,qCe,{relatedTarget:t}))}_activateParents(t){if(t.classList.contains(ZCe)){vn.findOne(iEe,t.closest(nEe)).classList.add(Yg);return}for(const r of vn.parents(t,QCe))for(const n of vn.prev(r,rEe))n.classList.add(Yg)}_clearActiveClass(t){t.classList.remove(Yg);const r=vn.find(`${XD}.${Yg}`,t);for(const n of r)n.classList.remove(Yg)}static jQueryInterface(t){return this.each(function(){const r=EI.getOrCreateInstance(this,t);if(typeof t=="string"){if(r[t]===void 0||t.startsWith("_")||t==="constructor")throw new TypeError(`No method named "${t}"`);r[t]()}})}}Wt.on(window,XCe,()=>{for(const e of vn.find(JCe))EI.getOrCreateInstance(e)});Gs(EI);const sEe="tab",lEe="bs.tab",km=`.${lEe}`,uEe=`hide${km}`,cEe=`hidden${km}`,fEe=`show${km}`,hEe=`shown${km}`,dEe=`click${km}`,pEe=`keydown${km}`,mEe=`load${km}`,gEe="ArrowLeft",EY="ArrowRight",yEe="ArrowUp",TY="ArrowDown",bp="active",OY="fade",ZD="show",vEe="dropdown",_Ee=".dropdown-toggle",bEe=".dropdown-menu",JD=":not(.dropdown-toggle)",wEe='.list-group, .nav, [role="tablist"]',SEe=".nav-item, .list-group-item",xEe=`.nav-link${JD}, .list-group-item${JD}, [role="tab"]${JD}`,pae='[data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',QD=`${xEe}, ${pae}`,CEe=`.${bp}[data-bs-toggle="tab"], .${bp}[data-bs-toggle="pill"], .${bp}[data-bs-toggle="list"]`;class Iv extends Pl{constructor(t){super(t),this._parent=this._element.closest(wEe),this._parent&&(this._setInitialAttributes(this._parent,this._getChildren()),Wt.on(this._element,pEe,r=>this._keydown(r)))}static get NAME(){return sEe}show(){const t=this._element;if(this._elemIsActive(t))return;const r=this._getActiveElem(),n=r?Wt.trigger(r,uEe,{relatedTarget:t}):null;Wt.trigger(t,fEe,{relatedTarget:r}).defaultPrevented||n&&n.defaultPrevented||(this._deactivate(r,t),this._activate(t,r))}_activate(t,r){if(!t)return;t.classList.add(bp),this._activate(Bc(t));const n=()=>{if(t.getAttribute("role")!=="tab"){t.classList.add(ZD);return}t.removeAttribute("tabindex"),t.setAttribute("aria-selected",!0),this._toggleDropDown(t,!0),Wt.trigger(t,hEe,{relatedTarget:r})};this._queueCallback(n,t,t.classList.contains(OY))}_deactivate(t,r){if(!t)return;t.classList.remove(bp),t.blur(),this._deactivate(Bc(t));const n=()=>{if(t.getAttribute("role")!=="tab"){t.classList.remove(ZD);return}t.setAttribute("aria-selected",!1),t.setAttribute("tabindex","-1"),this._toggleDropDown(t,!1),Wt.trigger(t,cEe,{relatedTarget:r})};this._queueCallback(n,t,t.classList.contains(OY))}_keydown(t){if(![gEe,EY,yEe,TY].includes(t.key))return;t.stopPropagation(),t.preventDefault();const r=[EY,TY].includes(t.key),n=K3(this._getChildren().filter(i=>!Bh(i)),t.target,r,!0);n&&(n.focus({preventScroll:!0}),Iv.getOrCreateInstance(n).show())}_getChildren(){return vn.find(QD,this._parent)}_getActiveElem(){return this._getChildren().find(t=>this._elemIsActive(t))||null}_setInitialAttributes(t,r){this._setAttributeIfNotExists(t,"role","tablist");for(const n of r)this._setInitialAttributesOnChild(n)}_setInitialAttributesOnChild(t){t=this._getInnerElement(t);const r=this._elemIsActive(t),n=this._getOuterElement(t);t.setAttribute("aria-selected",r),n!==t&&this._setAttributeIfNotExists(n,"role","presentation"),r||t.setAttribute("tabindex","-1"),this._setAttributeIfNotExists(t,"role","tab"),this._setInitialAttributesOnTargetPanel(t)}_setInitialAttributesOnTargetPanel(t){const r=Bc(t);r&&(this._setAttributeIfNotExists(r,"role","tabpanel"),t.id&&this._setAttributeIfNotExists(r,"aria-labelledby",`#${t.id}`))}_toggleDropDown(t,r){const n=this._getOuterElement(t);if(!n.classList.contains(vEe))return;const i=(o,s)=>{const a=vn.findOne(o,n);a&&a.classList.toggle(s,r)};i(_Ee,bp),i(bEe,ZD),n.setAttribute("aria-expanded",r)}_setAttributeIfNotExists(t,r,n){t.hasAttribute(r)||t.setAttribute(r,n)}_elemIsActive(t){return t.classList.contains(bp)}_getInnerElement(t){return t.matches(QD)?t:vn.findOne(QD,t)}_getOuterElement(t){return t.closest(SEe)||t}static jQueryInterface(t){return this.each(function(){const r=Iv.getOrCreateInstance(this);if(typeof t=="string"){if(r[t]===void 0||t.startsWith("_")||t==="constructor")throw new TypeError(`No method named "${t}"`);r[t]()}})}}Wt.on(document,dEe,pae,function(e){["A","AREA"].includes(this.tagName)&&e.preventDefault(),!Bh(this)&&Iv.getOrCreateInstance(this).show()});Wt.on(window,mEe,()=>{for(const e of vn.find(CEe))Iv.getOrCreateInstance(e)});Gs(Iv);const EEe="toast",TEe="bs.toast",Yh=`.${TEe}`,OEe=`mouseover${Yh}`,REe=`mouseout${Yh}`,kEe=`focusin${Yh}`,PEe=`focusout${Yh}`,AEe=`hide${Yh}`,IEe=`hidden${Yh}`,MEe=`show${Yh}`,$Ee=`shown${Yh}`,DEe="fade",RY="hide",WO="show",GO="showing",LEe={animation:"boolean",autohide:"boolean",delay:"number"},NEe={animation:!0,autohide:!0,delay:5e3};class TI extends Pl{constructor(t,r){super(t,r),this._timeout=null,this._hasMouseInteraction=!1,this._hasKeyboardInteraction=!1,this._setListeners()}static get Default(){return NEe}static get DefaultType(){return LEe}static get NAME(){return EEe}show(){if(Wt.trigger(this._element,MEe).defaultPrevented)return;this._clearTimeout(),this._config.animation&&this._element.classList.add(DEe);const r=()=>{this._element.classList.remove(GO),Wt.trigger(this._element,$Ee),this._maybeScheduleHide()};this._element.classList.remove(RY),HC(this._element),this._element.classList.add(WO,GO),this._queueCallback(r,this._element,this._config.animation)}hide(){if(!this.isShown()||Wt.trigger(this._element,AEe).defaultPrevented)return;const r=()=>{this._element.classList.add(RY),this._element.classList.remove(GO,WO),Wt.trigger(this._element,IEe)};this._element.classList.add(GO),this._queueCallback(r,this._element,this._config.animation)}dispose(){this._clearTimeout(),this.isShown()&&this._element.classList.remove(WO),super.dispose()}isShown(){return this._element.classList.contains(WO)}_maybeScheduleHide(){this._config.autohide&&(this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout(()=>{this.hide()},this._config.delay)))}_onInteraction(t,r){switch(t.type){case"mouseover":case"mouseout":{this._hasMouseInteraction=r;break}case"focusin":case"focusout":{this._hasKeyboardInteraction=r;break}}if(r){this._clearTimeout();return}const n=t.relatedTarget;this._element===n||this._element.contains(n)||this._maybeScheduleHide()}_setListeners(){Wt.on(this._element,OEe,t=>this._onInteraction(t,!0)),Wt.on(this._element,REe,t=>this._onInteraction(t,!1)),Wt.on(this._element,kEe,t=>this._onInteraction(t,!0)),Wt.on(this._element,PEe,t=>this._onInteraction(t,!1))}_clearTimeout(){clearTimeout(this._timeout),this._timeout=null}static jQueryInterface(t){return this.each(function(){const r=TI.getOrCreateInstance(this,t);if(typeof t=="string"){if(typeof r[t]>"u")throw new TypeError(`No method named "${t}"`);r[t](this)}})}}SI(TI);Gs(TI);function BEe({tab:e,activeTab:t,setActiveTab:r}){return _t.useState(0),Pe.jsxs(Pe.Fragment,{children:[Pe.jsx("div",{className:"page-title-div",children:Pe.jsx("p",{className:"page-title",children:"Route"})}),Pe.jsx("div",{className:"change-map-div",children:Pe.jsx("ul",{children:e.map((n,i)=>{const o=i;return Pe.jsxs(Pe.Fragment,{children:[" ",Pe.jsx(D0e,{currentTab:n,index:o,setActiveTab:r,activeTab:t})]})})})})]})}var mae={exports:{}};(function(e,t){(function(r,n){e.exports=n()})(Zy,function(){var r,n,i;function o(a,h){if(!r)r=h;else if(!n)n=h;else{var p="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+r+")(sharedChunk); ("+n+")(sharedChunk); self.onerror = null;",y={};r(y),i=h(y),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(i.workerUrl=window.URL.createObjectURL(new Blob([p],{type:"text/javascript"})))}}o(["exports"],function(a){var h=typeof self<"u"?self:{},p="2.14.1";let y;const S={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(y==null){const u=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{y={}.API_URL_REGEX!=null?new RegExp({}.API_URL_REGEX):u}catch{y=u}}return y},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!S.API_URL)return null;try{const u=new URL(S.API_URL);return u.hostname==="api.mapbox.cn"?"https://events.mapbox.cn/events/v2":u.hostname==="api.mapbox.com"?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},E={supported:!1,testSupport:function(u){!$&&A&&(B?j(u):O=u)}};let O,A,$=!1,B=!1;function j(u){const l=u.createTexture();u.bindTexture(u.TEXTURE_2D,l);try{if(u.texImage2D(u.TEXTURE_2D,0,u.RGBA,u.RGBA,u.UNSIGNED_BYTE,A),u.isContextLost())return;E.supported=!0}catch{}u.deleteTexture(l),$=!0}h.document&&(A=h.document.createElement("img"),A.onload=function(){O&&j(O),O=null,B=!0},A.onerror=function(){$=!0,O=null},A.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const z="01";var W=Q;function Q(u,l,c,d){this.cx=3*u,this.bx=3*(c-u)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*l,this.by=3*(d-l)-this.cy,this.ay=1-this.cy-this.by,this.p1x=u,this.p1y=l,this.p2x=c,this.p2y=d}Q.prototype={sampleCurveX:function(u){return((this.ax*u+this.bx)*u+this.cx)*u},sampleCurveY:function(u){return((this.ay*u+this.by)*u+this.cy)*u},sampleCurveDerivativeX:function(u){return(3*this.ax*u+2*this.bx)*u+this.cx},solveCurveX:function(u,l){if(l===void 0&&(l=1e-6),u<0)return 0;if(u>1)return 1;for(var c=u,d=0;d<8;d++){var g=this.sampleCurveX(c)-u;if(Math.abs(g)<l)return c;var _=this.sampleCurveDerivativeX(c);if(Math.abs(_)<1e-6)break;c-=g/_}var w=0,C=1;for(c=u,d=0;d<20&&(g=this.sampleCurveX(c),!(Math.abs(g-u)<l));d++)u>g?w=c:C=c,c=.5*(C-w)+w;return c},solve:function(u,l){return this.sampleCurveY(this.solveCurveX(u,l))}};var q=Se;function Se(u,l){this.x=u,this.y=l}Se.prototype={clone:function(){return new Se(this.x,this.y)},add:function(u){return this.clone()._add(u)},sub:function(u){return this.clone()._sub(u)},multByPoint:function(u){return this.clone()._multByPoint(u)},divByPoint:function(u){return this.clone()._divByPoint(u)},mult:function(u){return this.clone()._mult(u)},div:function(u){return this.clone()._div(u)},rotate:function(u){return this.clone()._rotate(u)},rotateAround:function(u,l){return this.clone()._rotateAround(u,l)},matMult:function(u){return this.clone()._matMult(u)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(u){return this.x===u.x&&this.y===u.y},dist:function(u){return Math.sqrt(this.distSqr(u))},distSqr:function(u){var l=u.x-this.x,c=u.y-this.y;return l*l+c*c},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(u){return Math.atan2(this.y-u.y,this.x-u.x)},angleWith:function(u){return this.angleWithSep(u.x,u.y)},angleWithSep:function(u,l){return Math.atan2(this.x*l-this.y*u,this.x*u+this.y*l)},_matMult:function(u){var l=u[2]*this.x+u[3]*this.y;return this.x=u[0]*this.x+u[1]*this.y,this.y=l,this},_add:function(u){return this.x+=u.x,this.y+=u.y,this},_sub:function(u){return this.x-=u.x,this.y-=u.y,this},_mult:function(u){return this.x*=u,this.y*=u,this},_div:function(u){return this.x/=u,this.y/=u,this},_multByPoint:function(u){return this.x*=u.x,this.y*=u.y,this},_divByPoint:function(u){return this.x/=u.x,this.y/=u.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var u=this.y;return this.y=this.x,this.x=-u,this},_rotate:function(u){var l=Math.cos(u),c=Math.sin(u),d=c*this.x+l*this.y;return this.x=l*this.x-c*this.y,this.y=d,this},_rotateAround:function(u,l){var c=Math.cos(u),d=Math.sin(u),g=l.y+d*(this.x-l.x)+c*(this.y-l.y);return this.x=l.x+c*(this.x-l.x)-d*(this.y-l.y),this.y=g,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},Se.convert=function(u){return u instanceof Se?u:Array.isArray(u)?new Se(u[0],u[1]):u};const Ie=Math.PI/180,He=180/Math.PI;function Le(u){return u*Ie}function ze(u){return u*He}const ct=[[0,0],[1,0],[1,1],[0,1]];function At(u){if(u<=0)return 0;if(u>=1)return 1;const l=u*u,c=l*u;return 4*(u<.5?c:3*(u-l)+c-.75)}function Qe(u,l,c,d){const g=new W(u,l,c,d);return function(_){return g.solve(_)}}const de=Qe(.25,.1,.25,1);function Ce(u,l,c){return Math.min(c,Math.max(l,u))}function pt(u,l,c){return(c=Ce((c-u)/(l-u),0,1))*c*(3-2*c)}function Ct(u,l,c){const d=c-l,g=((u-l)%d+d)%d+l;return g===l?c:g}function ie(u,l,c){if(!u.length)return c(null,[]);let d=u.length;const g=new Array(u.length);let _=null;u.forEach((w,C)=>{l(w,(R,k)=>{R&&(_=R),g[C]=k,--d==0&&c(_,g)})})}function M(u){const l=[];for(const c in u)l.push(u[c]);return l}function U(u,...l){for(const c of l)for(const d in c)u[d]=c[d];return u}let K=1;function re(){return K++}function me(){return function u(l){return l?(l^Math.random()*(16>>l/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,u)}()}function Oe(u){return u<=1?1:Math.pow(2,Math.ceil(Math.log(u)/Math.LN2))}function We(u){return!!u&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(u)}function Je(u,l){u.forEach(c=>{l[c]&&(l[c]=l[c].bind(l))})}function ht(u,l){return u.indexOf(l,u.length-l.length)!==-1}function ft(u,l,c){const d={};for(const g in u)d[g]=l.call(c||this,u[g],g,u);return d}function St(u,l,c){const d={};for(const g in u)l.call(c||this,u[g],g,u)&&(d[g]=u[g]);return d}function Tt(u){return Array.isArray(u)?u.map(Tt):typeof u=="object"&&u?ft(u,Tt):u}const Xt={};function jt(u){Xt[u]||(typeof console<"u"&&console.warn(u),Xt[u]=!0)}function Kt(u,l,c){return(c.y-u.y)*(l.x-u.x)>(l.y-u.y)*(c.x-u.x)}function qe(u){let l=0;for(let c,d,g=0,_=u.length,w=_-1;g<_;w=g++)c=u[g],d=u[w],l+=(d.x-c.x)*(c.y+d.y);return l}function yr(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function Ar(u){const l={};if(u.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(c,d,g,_)=>{const w=g||_;return l[d]=!w||w.toLowerCase(),""}),l["max-age"]){const c=parseInt(l["max-age"],10);isNaN(c)?delete l["max-age"]:l["max-age"]=c}return l}let wr=null;function vr(u){if(wr==null){const l=u.navigator?u.navigator.userAgent:null;wr=!!u.safari||!(!l||!(/\b(iPad|iPhone|iPod)\b/.test(l)||l.match("Safari")&&!l.match("Chrome")))}return wr}function Cr(u){try{const l=h[u];return l.setItem("_mapbox_test_",1),l.removeItem("_mapbox_test_"),!0}catch{return!1}}function se(u,l){return[u[4*l],u[4*l+1],u[4*l+2],u[4*l+3]]}const ye="mapbox-tiles";let Ee,Ye,je=500,tt=50;function Ue(){try{return h.caches}catch{}}function Ve(){Ue()&&!Ee&&(Ee=h.caches.open(ye))}function at(u){const l=u.indexOf("?");if(l<0)return u;const c=function(g){const _=g.indexOf("?");return _>0?g.slice(_+1).split("&"):[]}(u),d=c.filter(g=>{const _=g.split("=");return _[0]==="language"||_[0]==="worldview"});return d.length?`${u.slice(0,l)}?${d.join("&")}`:u.slice(0,l)}let et=1/0;const mt={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(mt);class Ht extends Error{constructor(l,c,d){c===401&&Fr(d)&&(l+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(l),this.status=c,this.url=d}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const or=yr()?()=>self.worker&&self.worker.referrer:()=>(h.location.protocol==="blob:"?h.parent:h).location.href,fr=function(u,l){if(!(/^file:/.test(c=u.url)||/^file:/.test(or())&&!/^\w+:/.test(c))){if(h.fetch&&h.Request&&h.AbortController&&h.Request.prototype.hasOwnProperty("signal"))return function(d,g){const _=new h.AbortController,w=new h.Request(d.url,{method:d.method||"GET",body:d.body,credentials:d.credentials,headers:d.headers,referrer:or(),referrerPolicy:d.referrerPolicy,signal:_.signal});let C=!1,R=!1;const k=(D=w.url).indexOf("sku=")>0&&Fr(D);var D;d.type==="json"&&w.headers.set("Accept","application/json");const N=(G,Y,J)=>{if(R)return;if(G&&G.message!=="SecurityError"&&jt(G),Y&&J)return F(Y);const oe=Date.now();h.fetch(w).then(ge=>{if(ge.ok){const Te=k?ge.clone():null;return F(ge,Te,oe)}return g(new Ht(ge.statusText,ge.status,d.url))}).catch(ge=>{ge.name!=="AbortError"&&g(new Error(`${ge.message} ${d.url}`))})},F=(G,Y,J)=>{(d.type==="arrayBuffer"?G.arrayBuffer():d.type==="json"?G.json():G.text()).then(oe=>{R||(Y&&J&&function(ge,Te,he){if(Ve(),!Ee)return;const xe={status:Te.status,statusText:Te.statusText,headers:new h.Headers};Te.headers.forEach((lt,it)=>xe.headers.set(it,lt));const Me=Ar(Te.headers.get("Cache-Control")||"");if(Me["no-store"])return;Me["max-age"]&&xe.headers.set("Expires",new Date(he+1e3*Me["max-age"]).toUTCString());const ke=xe.headers.get("Expires");ke&&(new Date(ke).getTime()-he<42e4||function(lt,it){if(Ye===void 0)try{new Response(new ReadableStream),Ye=!0}catch{Ye=!1}Ye?it(lt.body):lt.blob().then(it)}(Te,lt=>{const it=new h.Response(lt,xe);Ve(),Ee&&Ee.then(xt=>xt.put(at(ge.url),it)).catch(xt=>jt(xt.message))}))}(w,Y,J),C=!0,g(null,oe,G.headers.get("Cache-Control"),G.headers.get("Expires")))}).catch(oe=>{R||g(new Error(oe.message))})};return k?function(G,Y){if(Ve(),!Ee)return Y(null);const J=at(G.url);Ee.then(oe=>{oe.match(J).then(ge=>{const Te=function(he){if(!he)return!1;const xe=new Date(he.headers.get("Expires")||0),Me=Ar(he.headers.get("Cache-Control")||"");return xe>Date.now()&&!Me["no-cache"]}(ge);oe.delete(J),Te&&oe.put(J,ge.clone()),Y(null,ge,Te)}).catch(Y)}).catch(Y)}(w,N):N(null,null),{cancel:()=>{R=!0,C||_.abort()}}}(u,l);if(yr()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",u,l,void 0,!0)}var c;return function(d,g){const _=new h.XMLHttpRequest;_.open(d.method||"GET",d.url,!0),d.type==="arrayBuffer"&&(_.responseType="arraybuffer");for(const w in d.headers)_.setRequestHeader(w,d.headers[w]);return d.type==="json"&&(_.responseType="text",_.setRequestHeader("Accept","application/json")),_.withCredentials=d.credentials==="include",_.onerror=()=>{g(new Error(_.statusText))},_.onload=()=>{if((_.status>=200&&_.status<300||_.status===0)&&_.response!==null){let w=_.response;if(d.type==="json")try{w=JSON.parse(_.response)}catch(C){return g(C)}g(null,w,_.getResponseHeader("Cache-Control"),_.getResponseHeader("Expires"))}else g(new Ht(_.statusText,_.status,d.url))},_.send(d.body),{cancel:()=>_.abort()}}(u,l)},Ir=function(u,l){return fr(U(u,{type:"arrayBuffer"}),l)};function Ur(u){const l=h.document.createElement("a");return l.href=u,l.protocol===h.document.location.protocol&&l.host===h.document.location.host}const _n="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let $r,Mr;$r=[],Mr=0;const ln=function(u,l){if(E.supported&&(u.headers||(u.headers={}),u.headers.accept="image/webp,*/*"),Mr>=S.MAX_PARALLEL_IMAGE_REQUESTS){const _={requestParameters:u,callback:l,cancelled:!1,cancel(){this.cancelled=!0}};return $r.push(_),_}Mr++;let c=!1;const d=()=>{if(!c)for(c=!0,Mr--;$r.length&&Mr<S.MAX_PARALLEL_IMAGE_REQUESTS;){const _=$r.shift(),{requestParameters:w,callback:C,cancelled:R}=_;R||(_.cancel=ln(w,C).cancel)}},g=Ir(u,(_,w,C,R)=>{d(),_?l(_):w&&(h.createImageBitmap?function(k,D){const N=new h.Blob([new Uint8Array(k)],{type:"image/png"});h.createImageBitmap(N).then(F=>{D(null,F)}).catch(F=>{D(new Error(`Could not load image because of ${F.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(w,(k,D)=>l(k,D,C,R)):function(k,D){const N=new h.Image,F=h.URL;N.onload=()=>{D(null,N),F.revokeObjectURL(N.src),N.onload=null,h.requestAnimationFrame(()=>{N.src=_n})},N.onerror=()=>D(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const G=new h.Blob([new Uint8Array(k)],{type:"image/png"});N.src=k.byteLength?F.createObjectURL(G):_n}(w,(k,D)=>l(k,D,C,R)))});return{cancel:()=>{g.cancel(),d()}}},an="NO_ACCESS_TOKEN";function Hr(u){return u.indexOf("mapbox:")===0}function Fr(u){return S.API_URL_REGEX.test(u)}function rn(u){return S.API_CDN_URL_REGEX.test(u)}function ri(u){return S.API_STYLE_REGEX.test(u)&&!En(u)}function En(u){return S.API_SPRITE_REGEX.test(u)}const un=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function zr(u){const l=u.match(un);if(!l)throw new Error("Unable to parse URL object");return{protocol:l[1],authority:l[2],path:l[3]||"/",params:l[4]?l[4].split("&"):[]}}function bo(u){const l=u.params.length?`?${u.params.join("&")}`:"";return`${u.protocol}://${u.authority}${u.path}${l}`}function aa(u){if(!u)return null;const l=u.split(".");if(!l||l.length!==3)return null;try{return JSON.parse(decodeURIComponent(h.atob(l[1]).split("").map(c=>"%"+("00"+c.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch{return null}}class zo{constructor(l){this.type=l,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(l){const c=aa(S.ACCESS_TOKEN);let d="";return d=c&&c.u?h.btoa(encodeURIComponent(c.u).replace(/%([0-9A-F]{2})/g,(g,_)=>String.fromCharCode(+("0x"+_)))):S.ACCESS_TOKEN||"",l?`mapbox.eventData.${l}:${d}`:`mapbox.eventData:${d}`}fetchEventData(){const l=Cr("localStorage"),c=this.getStorageKey(),d=this.getStorageKey("uuid");if(l)try{const g=h.localStorage.getItem(c);g&&(this.eventData=JSON.parse(g));const _=h.localStorage.getItem(d);_&&(this.anonId=_)}catch{jt("Unable to read from LocalStorage")}}saveEventData(){const l=Cr("localStorage"),c=this.getStorageKey(),d=this.getStorageKey("uuid");if(l)try{h.localStorage.setItem(d,this.anonId),Object.keys(this.eventData).length>=1&&h.localStorage.setItem(c,JSON.stringify(this.eventData))}catch{jt("Unable to write to LocalStorage")}}processRequests(l){}postEvent(l,c,d,g){if(!S.EVENTS_URL)return;const _=zr(S.EVENTS_URL);_.params.push(`access_token=${g||S.ACCESS_TOKEN||""}`);const w={event:this.type,created:new Date(l).toISOString()},C=c?U(w,c):w,R={url:bo(_),headers:{"Content-Type":"text/plain"},body:JSON.stringify([C])};this.pendingRequest=function(k,D){return fr(U(k,{method:"POST"}),D)}(R,k=>{this.pendingRequest=null,d(k),this.saveEventData(),this.processRequests(g)})}queueRequest(l,c){this.queue.push(l),this.processRequests(c)}}const pe=new class extends zo{constructor(u){super("appUserTurnstile"),this._customAccessToken=u}postTurnstileEvent(u,l){S.EVENTS_URL&&S.ACCESS_TOKEN&&Array.isArray(u)&&u.some(c=>Hr(c)||Fr(c))&&this.queueRequest(Date.now(),l)}processRequests(u){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const l=aa(S.ACCESS_TOKEN),c=l?l.u:S.ACCESS_TOKEN;let d=c!==this.eventData.tokenU;We(this.anonId)||(this.anonId=me(),d=!0);const g=this.queue.shift();if(this.eventData.lastSuccess){const _=new Date(this.eventData.lastSuccess),w=new Date(g),C=(g-this.eventData.lastSuccess)/864e5;d=d||C>=1||C<-1||_.getDate()!==w.getDate()}else d=!0;d?this.postEvent(g,{sdkIdentifier:"mapbox-gl-js",sdkVersion:p,skuId:z,"enabled.telemetry":!1,userId:this.anonId},_=>{_||(this.eventData.lastSuccess=g,this.eventData.tokenU=c)},u):this.processRequests()}},Z=pe.postTurnstileEvent.bind(pe),ee=new class extends zo{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(u,l,c,d){this.skuToken=l,this.errorCb=d,S.EVENTS_URL&&(c||S.ACCESS_TOKEN?this.queueRequest({id:u,timestamp:Date.now()},c):this.errorCb(new Error(an)))}processRequests(u){if(this.pendingRequest||this.queue.length===0)return;const{id:l,timestamp:c}=this.queue.shift();l&&this.success[l]||(this.anonId||this.fetchEventData(),We(this.anonId)||(this.anonId=me()),this.postEvent(c,{sdkIdentifier:"mapbox-gl-js",sdkVersion:p,skuId:z,skuToken:this.skuToken,userId:this.anonId},d=>{d?this.errorCb(d):l&&(this.success[l]=!0)},u))}},fe=ee.postMapLoadEvent.bind(ee),we=new class extends zo{constructor(){super("gljs.performance")}postPerformanceEvent(u,l){S.EVENTS_URL&&(u||S.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:l},u)}processRequests(u){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:l,performanceData:c}=this.queue.shift(),d=function(g){const _=h.performance.getEntriesByType("resource"),w=h.performance.getEntriesByType("mark"),C=function(F){const G={};if(F){for(const Y in F)if(Y!=="other")for(const J of F[Y]){const oe=`${Y}ResolveRangeMin`,ge=`${Y}ResolveRangeMax`,Te=`${Y}RequestCount`,he=`${Y}RequestCachedCount`;G[oe]=Math.min(G[oe]||1/0,J.startTime),G[ge]=Math.max(G[ge]||-1/0,J.responseEnd);const xe=Me=>{G[Me]===void 0&&(G[Me]=0),++G[Me]};J.transferSize!==void 0&&J.transferSize===0&&xe(he),xe(Te)}}return G}(function(F,G){const Y={};if(F)for(const J of F){const oe=G(J);Y[oe]===void 0&&(Y[oe]=[]),Y[oe].push(J)}return Y}(_,Qt)),R=h.devicePixelRatio,k=h.navigator.connection||h.navigator.mozConnection||h.navigator.webkitConnection,D={counters:[],metadata:[],attributes:[]},N=(F,G,Y)=>{Y!=null&&F.push({name:G,value:Y.toString()})};for(const F in C)N(D.counters,F,C[F]);if(g.interactionRange[0]!==1/0&&g.interactionRange[1]!==-1/0&&(N(D.counters,"interactionRangeMin",g.interactionRange[0]),N(D.counters,"interactionRangeMax",g.interactionRange[1])),w)for(const F of Object.keys(nt)){const G=nt[F],Y=w.find(J=>J.name===G);Y&&N(D.counters,G,Y.startTime)}return N(D.counters,"visibilityHidden",g.visibilityHidden),N(D.attributes,"style",function(F){if(F)for(const G of F){const Y=G.name.split("?")[0];if(ri(Y)){const J=Y.split("/").slice(-2);if(J.length===2)return`mapbox://styles/${J[0]}/${J[1]}`}}}(_)),N(D.attributes,"terrainEnabled",g.terrainEnabled?"true":"false"),N(D.attributes,"fogEnabled",g.fogEnabled?"true":"false"),N(D.attributes,"projection",g.projection),N(D.attributes,"zoom",g.zoom),N(D.metadata,"devicePixelRatio",R),N(D.metadata,"connectionEffectiveType",k?k.effectiveType:void 0),N(D.metadata,"navigatorUserAgent",h.navigator.userAgent),N(D.metadata,"screenWidth",h.screen.width),N(D.metadata,"screenHeight",h.screen.height),N(D.metadata,"windowWidth",h.innerWidth),N(D.metadata,"windowHeight",h.innerHeight),N(D.metadata,"mapWidth",g.width/R),N(D.metadata,"mapHeight",g.height/R),N(D.metadata,"webglRenderer",g.renderer),N(D.metadata,"webglVendor",g.vendor),N(D.metadata,"sdkVersion",p),N(D.metadata,"sdkIdentifier","mapbox-gl-js"),D}(c);for(const g of d.metadata);for(const g of d.counters);for(const g of d.attributes);this.postEvent(l,d,()=>{},u)}},De=we.postPerformanceEvent.bind(we),Xe=new class extends zo{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(u,l,c,d){if(!S.API_URL||!S.SESSION_PATH)return;const g=zr(S.API_URL+S.SESSION_PATH);g.params.push(`sku=${l||""}`),g.params.push(`access_token=${d||S.ACCESS_TOKEN||""}`);const _={url:bo(g),headers:{"Content-Type":"text/plain"}};this.pendingRequest=function(w,C){return fr(U(w,{method:"GET"}),C)}(_,w=>{this.pendingRequest=null,c(w),this.saveEventData(),this.processRequests(d)})}getSessionAPI(u,l,c,d){this.skuToken=l,this.errorCb=d,S.SESSION_PATH&&S.API_URL&&(c||S.ACCESS_TOKEN?this.queueRequest({id:u,timestamp:Date.now()},c):this.errorCb(new Error(an)))}processRequests(u){if(this.pendingRequest||this.queue.length===0)return;const{id:l,timestamp:c}=this.queue.shift();l&&this.success[l]||this.getSession(c,this.skuToken,d=>{d?this.errorCb(d):l&&(this.success[l]=!0)},u)}},Ge=Xe.getSessionAPI.bind(Xe),Ne=new Set,nt={create:"create",load:"load",fullLoad:"fullLoad"},kt={mark(u){h.performance.mark(u)},measure(u,l,c){h.performance.measure(u,l,c)}};function Qt(u){const l=u.name.split("?")[0];return rn(l)&&l.includes("mapbox-gl.js")?"javascript":rn(l)&&l.includes("mapbox-gl.css")?"css":function(c){return S.API_FONTS_REGEX.test(c)}(l)?"fontRange":En(l)?"sprite":ri(l)?"style":function(c){return S.API_TILEJSON_REGEX.test(c)}(l)?"tilejson":"other"}const Nt=h.performance;function Sr(u){const l=u?u.url.toString():void 0;return Nt.getEntriesByName(l)}let It,Re,bt,Dt;const mr={now:()=>bt!==void 0?bt:h.performance.now(),setNow(u){bt=u},restoreNow(){bt=void 0},frame(u){const l=h.requestAnimationFrame(u);return{cancel:()=>h.cancelAnimationFrame(l)}},getImageData(u,l=0){const{width:c,height:d}=u;Dt||(Dt=h.document.createElement("canvas"));const g=Dt.getContext("2d",{willReadFrequently:!0});if(!g)throw new Error("failed to create canvas 2d context");return(c>Dt.width||d>Dt.height)&&(Dt.width=c,Dt.height=d),g.clearRect(-l,-l,c+2*l,d+2*l),g.drawImage(u,0,0,c,d),g.getImageData(-l,-l,c+2*l,d+2*l)},resolveURL:u=>(It||(It=h.document.createElement("a")),It.href=u,It.href),get devicePixelRatio(){return h.devicePixelRatio},get prefersReducedMotion(){return!!h.matchMedia&&(Re==null&&(Re=h.matchMedia("(prefers-reduced-motion: reduce)")),Re.matches)}};function sr(u,l,c){c[u]&&c[u].indexOf(l)!==-1||(c[u]=c[u]||[],c[u].push(l))}function Br(u,l,c){if(c&&c[u]){const d=c[u].indexOf(l);d!==-1&&c[u].splice(d,1)}}class Nr{constructor(l,c={}){U(this,c),this.type=l}}class sa extends Nr{constructor(l,c={}){super("error",U({error:l},c))}}class Kn{on(l,c){return this._listeners=this._listeners||{},sr(l,c,this._listeners),this}off(l,c){return Br(l,c,this._listeners),Br(l,c,this._oneTimeListeners),this}once(l,c){return c?(this._oneTimeListeners=this._oneTimeListeners||{},sr(l,c,this._oneTimeListeners),this):new Promise(d=>this.once(l,d))}fire(l,c){typeof l=="string"&&(l=new Nr(l,c||{}));const d=l.type;if(this.listens(d)){l.target=this;const g=this._listeners&&this._listeners[d]?this._listeners[d].slice():[];for(const C of g)C.call(this,l);const _=this._oneTimeListeners&&this._oneTimeListeners[d]?this._oneTimeListeners[d].slice():[];for(const C of _)Br(d,C,this._oneTimeListeners),C.call(this,l);const w=this._eventedParent;w&&(U(l,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),w.fire(l))}else l instanceof sa&&console.error(l.error);return this}listens(l){return!!(this._listeners&&this._listeners[l]&&this._listeners[l].length>0||this._oneTimeListeners&&this._oneTimeListeners[l]&&this._oneTimeListeners[l].length>0||this._eventedParent&&this._eventedParent.listens(l))}setEventedParent(l,c){return this._eventedParent=l,this._eventedParentData=c,this}}var wt=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360,"units":"degrees"},"pitch":{"type":"number","default":0,"units":"degrees"},"light":{"type":"light"},"terrain":{"type":"terrain"},"fog":{"type":"fog"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":{},"mapbox":{}},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":{}}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":{}}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":{}}},"url":{"required":true,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"background":{},"sky":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],"layout_background":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","private":true,"default":0,"minimum":0,"maximum":1,"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":{},"round":{},"square":{}},"default":"butt","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":{},"round":{},"miter":{}},"default":"miter","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"requires":[{"line-join":"miter"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"requires":[{"line-join":"round"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":{},"line":{},"line-center":{}},"default":"point","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"units":"pixels","requires":[{"symbol-placement":"line"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":{},"viewport-y":{},"source":{}},"default":"auto","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"units":"factor of the original icon size","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":{},"width":{},"height":{},"both":{}},"default":"none","requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"units":"pixels","requires":["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"requires":["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"units":"ems","requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":{},"left":{},"center":{},"right":{}},"default":"center","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","units":"ems","default":0,"requires":["text-field"],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["text-field",{"!":"text-variable-anchor"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"units":"degrees","requires":["text-field",{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":{},"vertical":{}},"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"requires":["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":{},"uppercase":{},"lowercase":{}},"default":"none","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","units":"ems","length":2,"default":[0,0],"requires":["text-field",{"!":"text-radial-offset"}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"requires":["text-field","icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},"in":{},"!in":{},"all":{},"any":{},"none":{},"has":{},"!has":{},"within":{}}},"geometry_type":{"type":"enum","values":{"Point":{},"LineString":{},"Polygon":{}}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":{},"exponential":{},"interval":{},"categorical":{}},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":{},"lab":{},"hcl":{}},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":{},"viewport":{}},"property-type":"data-constant","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":{},"equalEarth":{},"equirectangular":{},"lambertConformalConic":{},"mercator":{},"naturalEarth":{},"winkelTripel":{},"globe":{}},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["source"]}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"requires":[{"!":"fill-pattern"},{"fill-antialias":true}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-extrusion-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-extrusion-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"requires":["fill-extrusion-height"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","private":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["fill-extrusion-edge-radius"]}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"line-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["line-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"transition":false,"units":"line widths","requires":[{"!":"line-pattern"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","transition":false,"requires":[{"!":"line-pattern"},{"source":"geojson","has":{"lineMetrics":true}}],"expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"transition":false,"requires":[{"source":"geojson","has":{"lineMetrics":true}}],"property-type":"constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["circle-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"transition":false,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"transition":false,"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["icon-image","icon-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["text-field","text-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"units":"degrees","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":{},"nearest":{}},"default":"linear","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"transition":false,"units":"milliseconds","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"transition":false,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"background-pattern"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":{},"atmosphere":{}},"default":"atmosphere","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"requires":[{"sky-type":"atmosphere"}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","requires":[{"sky-type":"atmosphere"}],"default":10,"minimum":0,"maximum":100,"transition":false,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","requires":[{"sky-type":"gradient"}],"value":"number","default":[0,0],"length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","requires":[{"sky-type":"gradient"}],"default":90,"minimum":0,"maximum":180,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"transition":false,"requires":[{"sky-type":"gradient"}],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0,"units":"milliseconds"},"delay":{"type":"number","default":0,"minimum":0,"units":"milliseconds"}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function Ta(u,...l){for(const c of l)for(const d in c)u[d]=c[d];return u}function Si(u){return u instanceof Number||u instanceof String||u instanceof Boolean?u.valueOf():u}function $l(u){if(Array.isArray(u))return u.map($l);if(u instanceof Object&&!(u instanceof Number||u instanceof String||u instanceof Boolean)){const l={};for(const c in u)l[c]=$l(u[c]);return l}return Si(u)}class LE extends Error{constructor(l,c){super(c),this.message=c,this.key=l}}var bs=LE;class sf{constructor(l,c=[]){this.parent=l,this.bindings={};for(const[d,g]of c)this.bindings[d]=g}concat(l){return new sf(this,l)}get(l){if(this.bindings[l])return this.bindings[l];if(this.parent)return this.parent.get(l);throw new Error(`${l} not found in scope.`)}has(l){return!!this.bindings[l]||!!this.parent&&this.parent.has(l)}}var NE=sf;const lf={kind:"null"},Gt={kind:"number"},nn={kind:"string"},Xr={kind:"boolean"},ws={kind:"color"},Au={kind:"object"},Yr={kind:"value"},Qh={kind:"collator"},uf={kind:"formatted"},cf={kind:"resolvedImage"};function Do(u,l){return{kind:"array",itemType:u,N:l}}function Hn(u){if(u.kind==="array"){const l=Hn(u.itemType);return typeof u.N=="number"?`array<${l}, ${u.N}>`:u.itemType.kind==="value"?"array":`array<${l}>`}return u.kind}const BE=[lf,Gt,nn,Xr,ws,uf,Au,Do(Yr),cf];function Ho(u,l){if(l.kind==="error")return null;if(u.kind==="array"){if(l.kind==="array"&&(l.N===0&&l.itemType.kind==="value"||!Ho(u.itemType,l.itemType))&&(typeof u.N!="number"||u.N===l.N))return null}else{if(u.kind===l.kind)return null;if(u.kind==="value"){for(const c of BE)if(!Ho(c,l))return null}}return`Expected ${Hn(u)} but found ${Hn(l)} instead.`}function cw(u,l){return l.some(c=>c.kind===u.kind)}function Iu(u,l){return l.some(c=>c==="null"?u===null:c==="array"?Array.isArray(u):c==="object"?u&&!Array.isArray(u)&&typeof u=="object":c===typeof u)}var fw,Hm={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function ed(u){return(u=Math.round(u))<0?0:u>255?255:u}function Mu(u){return ed(u[u.length-1]==="%"?parseFloat(u)/100*255:parseInt(u))}function ff(u){return(l=u[u.length-1]==="%"?parseFloat(u)/100:parseFloat(u))<0?0:l>1?1:l;var l}function hw(u,l,c){return c<0?c+=1:c>1&&(c-=1),6*c<1?u+(l-u)*c*6:2*c<1?l:3*c<2?u+(l-u)*(2/3-c)*6:u}try{fw={}.parseCSSColor=function(u){var l,c=u.replace(/ /g,"").toLowerCase();if(c in Hm)return Hm[c].slice();if(c[0]==="#")return c.length===4?(l=parseInt(c.substr(1),16))>=0&&l<=4095?[(3840&l)>>4|(3840&l)>>8,240&l|(240&l)>>4,15&l|(15&l)<<4,1]:null:c.length===7&&(l=parseInt(c.substr(1),16))>=0&&l<=16777215?[(16711680&l)>>16,(65280&l)>>8,255&l,1]:null;var d=c.indexOf("("),g=c.indexOf(")");if(d!==-1&&g+1===c.length){var _=c.substr(0,d),w=c.substr(d+1,g-(d+1)).split(","),C=1;switch(_){case"rgba":if(w.length!==4)return null;C=ff(w.pop());case"rgb":return w.length!==3?null:[Mu(w[0]),Mu(w[1]),Mu(w[2]),C];case"hsla":if(w.length!==4)return null;C=ff(w.pop());case"hsl":if(w.length!==3)return null;var R=(parseFloat(w[0])%360+360)%360/360,k=ff(w[1]),D=ff(w[2]),N=D<=.5?D*(k+1):D+k-D*k,F=2*D-N;return[ed(255*hw(F,N,R+1/3)),ed(255*hw(F,N,R)),ed(255*hw(F,N,R-1/3)),C];default:return null}}return null}}catch{}class Vo{constructor(l,c,d,g=1){this.r=l,this.g=c,this.b=d,this.a=g}static parse(l){if(!l)return;if(l instanceof Vo)return l;if(typeof l!="string")return;const c=fw(l);return c?new Vo(c[0]/255*c[3],c[1]/255*c[3],c[2]/255*c[3],c[3]):void 0}toString(){const[l,c,d,g]=this.toArray();return`rgba(${Math.round(l)},${Math.round(c)},${Math.round(d)},${g})`}toArray(){const{r:l,g:c,b:d,a:g}=this;return g===0?[0,0,0,0]:[255*l/g,255*c/g,255*d/g,g]}toArray01(){const{r:l,g:c,b:d,a:g}=this;return g===0?[0,0,0,0]:[l/g,c/g,d/g,g]}toArray01PremultipliedAlpha(){const{r:l,g:c,b:d,a:g}=this;return[l,c,d,g]}}Vo.black=new Vo(0,0,0,1),Vo.white=new Vo(1,1,1,1),Vo.transparent=new Vo(0,0,0,0),Vo.red=new Vo(1,0,0,1),Vo.blue=new Vo(0,0,1,1);var xi=Vo;class Vm{constructor(l,c,d){this.sensitivity=l?c?"variant":"case":c?"accent":"base",this.locale=d,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(l,c){return this.collator.compare(l,c)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class td{constructor(l,c,d,g,_){this.text=l.normalize?l.normalize():l,this.image=c,this.scale=d,this.fontStack=g,this.textColor=_}}class Uo{constructor(l){this.sections=l}static fromString(l){return new Uo([new td(l,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(l=>l.text.length!==0||l.image&&l.image.name.length!==0)}static factory(l){return l instanceof Uo?l:Uo.fromString(l)}toString(){return this.sections.length===0?"":this.sections.map(l=>l.text).join("")}serialize(){const l=["format"];for(const c of this.sections){if(c.image){l.push(["image",c.image.name]);continue}l.push(c.text);const d={};c.fontStack&&(d["text-font"]=["literal",c.fontStack.split(",")]),c.scale&&(d["font-scale"]=c.scale),c.textColor&&(d["text-color"]=["rgba"].concat(c.textColor.toArray())),l.push(d)}return l}}class Lo{constructor(l){this.name=l.name,this.available=l.available}toString(){return this.name}static fromString(l){return l?new Lo({name:l,available:!1}):null}serialize(){return["image",this.name]}}function jE(u,l,c,d){return typeof u=="number"&&u>=0&&u<=255&&typeof l=="number"&&l>=0&&l<=255&&typeof c=="number"&&c>=0&&c<=255?d===void 0||typeof d=="number"&&d>=0&&d<=1?null:`Invalid rgba value [${[u,l,c,d].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof d=="number"?[u,l,c,d]:[u,l,c]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Um(u){if(u===null||typeof u=="string"||typeof u=="boolean"||typeof u=="number"||u instanceof xi||u instanceof Vm||u instanceof Uo||u instanceof Lo)return!0;if(Array.isArray(u)){for(const l of u)if(!Um(l))return!1;return!0}if(typeof u=="object"){for(const l in u)if(!Um(u[l]))return!1;return!0}return!1}function Hi(u){if(u===null)return lf;if(typeof u=="string")return nn;if(typeof u=="boolean")return Xr;if(typeof u=="number")return Gt;if(u instanceof xi)return ws;if(u instanceof Vm)return Qh;if(u instanceof Uo)return uf;if(u instanceof Lo)return cf;if(Array.isArray(u)){const l=u.length;let c;for(const d of u){const g=Hi(d);if(c){if(c===g)continue;c=Yr;break}c=g}return Do(c||Yr,l)}return Au}function rd(u){const l=typeof u;return u===null?"":l==="string"||l==="number"||l==="boolean"?String(u):u instanceof xi||u instanceof Uo||u instanceof Lo?u.toString():JSON.stringify(u)}class dw{constructor(l,c){this.type=l,this.value=c}static parse(l,c){if(l.length!==2)return c.error(`'literal' expression requires exactly one argument, but found ${l.length-1} instead.`);if(!Um(l[1]))return c.error("invalid value");const d=l[1];let g=Hi(d);const _=c.expectedType;return g.kind!=="array"||g.N!==0||!_||_.kind!=="array"||typeof _.N=="number"&&_.N!==0||(g=_),new dw(g,d)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof xi?["rgba"].concat(this.value.toArray()):this.value instanceof Uo?this.value.serialize():this.value}}var nd=dw,co=class{constructor(u){this.name="ExpressionEvaluationError",this.message=u}toJSON(){return this.message}};const Wm={string:nn,number:Gt,boolean:Xr,object:Au};class hf{constructor(l,c){this.type=l,this.args=c}static parse(l,c){if(l.length<2)return c.error("Expected at least one argument.");let d,g=1;const _=l[0];if(_==="array"){let C,R;if(l.length>2){const k=l[1];if(typeof k!="string"||!(k in Wm)||k==="object")return c.error('The item type argument of "array" must be one of string, number, boolean',1);C=Wm[k],g++}else C=Yr;if(l.length>3){if(l[2]!==null&&(typeof l[2]!="number"||l[2]<0||l[2]!==Math.floor(l[2])))return c.error('The length argument to "array" must be a positive integer literal',2);R=l[2],g++}d=Do(C,R)}else d=Wm[_];const w=[];for(;g<l.length;g++){const C=c.parse(l[g],g,Yr);if(!C)return null;w.push(C)}return new hf(d,w)}evaluate(l){for(let c=0;c<this.args.length;c++){const d=this.args[c].evaluate(l);if(!Ho(this.type,Hi(d)))return d;if(c===this.args.length-1)throw new co(`Expected value to be of type ${Hn(this.type)}, but found ${Hn(Hi(d))} instead.`)}return null}eachChild(l){this.args.forEach(l)}outputDefined(){return this.args.every(l=>l.outputDefined())}serialize(){const l=this.type,c=[l.kind];if(l.kind==="array"){const d=l.itemType;if(d.kind==="string"||d.kind==="number"||d.kind==="boolean"){c.push(d.kind);const g=l.N;(typeof g=="number"||this.args.length>1)&&c.push(g)}}return c.concat(this.args.map(d=>d.serialize()))}}var Js=hf;class id{constructor(l){this.type=uf,this.sections=l}static parse(l,c){if(l.length<2)return c.error("Expected at least one argument.");const d=l[1];if(!Array.isArray(d)&&typeof d=="object")return c.error("First argument must be an image or text section.");const g=[];let _=!1;for(let w=1;w<=l.length-1;++w){const C=l[w];if(_&&typeof C=="object"&&!Array.isArray(C)){_=!1;let R=null;if(C["font-scale"]&&(R=c.parse(C["font-scale"],1,Gt),!R))return null;let k=null;if(C["text-font"]&&(k=c.parse(C["text-font"],1,Do(nn)),!k))return null;let D=null;if(C["text-color"]&&(D=c.parse(C["text-color"],1,ws),!D))return null;const N=g[g.length-1];N.scale=R,N.font=k,N.textColor=D}else{const R=c.parse(l[w],1,Yr);if(!R)return null;const k=R.type.kind;if(k!=="string"&&k!=="value"&&k!=="null"&&k!=="resolvedImage")return c.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");_=!0,g.push({content:R,scale:null,font:null,textColor:null})}}return new id(g)}evaluate(l){return new Uo(this.sections.map(c=>{const d=c.content.evaluate(l);return Hi(d)===cf?new td("",d,null,null,null):new td(rd(d),null,c.scale?c.scale.evaluate(l):null,c.font?c.font.evaluate(l).join(","):null,c.textColor?c.textColor.evaluate(l):null)}))}eachChild(l){for(const c of this.sections)l(c.content),c.scale&&l(c.scale),c.font&&l(c.font),c.textColor&&l(c.textColor)}outputDefined(){return!1}serialize(){const l=["format"];for(const c of this.sections){l.push(c.content.serialize());const d={};c.scale&&(d["font-scale"]=c.scale.serialize()),c.font&&(d["text-font"]=c.font.serialize()),c.textColor&&(d["text-color"]=c.textColor.serialize()),l.push(d)}return l}}class Gm{constructor(l){this.type=cf,this.input=l}static parse(l,c){if(l.length!==2)return c.error("Expected two arguments.");const d=c.parse(l[1],1,nn);return d?new Gm(d):c.error("No image name provided.")}evaluate(l){const c=this.input.evaluate(l),d=Lo.fromString(c);return d&&l.availableImages&&(d.available=l.availableImages.indexOf(c)>-1),d}eachChild(l){l(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const VM={"to-boolean":Xr,"to-color":ws,"to-number":Gt,"to-string":nn};class pw{constructor(l,c){this.type=l,this.args=c}static parse(l,c){if(l.length<2)return c.error("Expected at least one argument.");const d=l[0];if((d==="to-boolean"||d==="to-string")&&l.length!==2)return c.error("Expected one argument.");const g=VM[d],_=[];for(let w=1;w<l.length;w++){const C=c.parse(l[w],w,Yr);if(!C)return null;_.push(C)}return new pw(g,_)}evaluate(l){if(this.type.kind==="boolean")return!!this.args[0].evaluate(l);if(this.type.kind==="color"){let c,d;for(const g of this.args){if(c=g.evaluate(l),d=null,c instanceof xi)return c;if(typeof c=="string"){const _=l.parseColor(c);if(_)return _}else if(Array.isArray(c)&&(d=c.length<3||c.length>4?`Invalid rbga value ${JSON.stringify(c)}: expected an array containing either three or four numeric values.`:jE(c[0],c[1],c[2],c[3]),!d))return new xi(c[0]/255,c[1]/255,c[2]/255,c[3])}throw new co(d||`Could not parse color from value '${typeof c=="string"?c:String(JSON.stringify(c))}'`)}if(this.type.kind==="number"){let c=null;for(const d of this.args){if(c=d.evaluate(l),c===null)return 0;const g=Number(c);if(!isNaN(g))return g}throw new co(`Could not convert ${JSON.stringify(c)} to number.`)}return this.type.kind==="formatted"?Uo.fromString(rd(this.args[0].evaluate(l))):this.type.kind==="resolvedImage"?Lo.fromString(rd(this.args[0].evaluate(l))):rd(this.args[0].evaluate(l))}eachChild(l){this.args.forEach(l)}outputDefined(){return this.args.every(l=>l.outputDefined())}serialize(){if(this.type.kind==="formatted")return new id([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new Gm(this.args[0]).serialize();const l=[`to-${this.type.kind}`];return this.eachChild(c=>{l.push(c.serialize())}),l}}var df=pw;const FE=["Unknown","Point","LineString","Polygon"];var od=class{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?FE[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const u=this.featureDistanceData.center,l=this.featureDistanceData.scale,{x:c,y:d}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(c*l-u[0])+this.featureDistanceData.bearing[1]*(d*l-u[1])}return 0}parseColor(u){let l=this._parseColorCache[u];return l||(l=this._parseColorCache[u]=xi.parse(u)),l}};class pf{constructor(l,c,d,g){this.name=l,this.type=c,this._evaluate=d,this.args=g}evaluate(l){return this._evaluate(l,this.args)}eachChild(l){this.args.forEach(l)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(l=>l.serialize()))}static parse(l,c){const d=l[0],g=pf.definitions[d];if(!g)return c.error(`Unknown expression "${d}". If you wanted a literal array, use ["literal", [...]].`,0);const _=Array.isArray(g)?g[0]:g.type,w=Array.isArray(g)?[[g[1],g[2]]]:g.overloads,C=w.filter(([k])=>!Array.isArray(k)||k.length===l.length-1);let R=null;for(const[k,D]of C){R=new bw(c.registry,c.path,null,c.scope);const N=[];let F=!1;for(let G=1;G<l.length;G++){const Y=l[G],J=Array.isArray(k)?k[G-1]:k.type,oe=R.parse(Y,1+N.length,J);if(!oe){F=!0;break}N.push(oe)}if(!F)if(Array.isArray(k)&&k.length!==N.length)R.error(`Expected ${k.length} arguments, but found ${N.length} instead.`);else{for(let G=0;G<N.length;G++){const Y=Array.isArray(k)?k[G]:k.type,J=N[G];R.concat(G+1).checkSubtype(Y,J.type)}if(R.errors.length===0)return new pf(d,_,D,N)}}if(C.length===1)c.errors.push(...R.errors);else{const k=(C.length?C:w).map(([N])=>{return F=N,Array.isArray(F)?`(${F.map(Hn).join(", ")})`:`(${Hn(F.type)}...)`;var F}).join(" | "),D=[];for(let N=1;N<l.length;N++){const F=c.parse(l[N],1+D.length);if(!F)return null;D.push(Hn(F.type))}c.error(`Expected arguments of type ${k}, but found (${D.join(", ")}) instead.`)}return null}static register(l,c){pf.definitions=c;for(const d in c)l[d]=pf}}var Dl=pf;class Ym{constructor(l,c,d){this.type=Qh,this.locale=d,this.caseSensitive=l,this.diacriticSensitive=c}static parse(l,c){if(l.length!==2)return c.error("Expected one argument.");const d=l[1];if(typeof d!="object"||Array.isArray(d))return c.error("Collator options argument must be an object.");const g=c.parse(d["case-sensitive"]!==void 0&&d["case-sensitive"],1,Xr);if(!g)return null;const _=c.parse(d["diacritic-sensitive"]!==void 0&&d["diacritic-sensitive"],1,Xr);if(!_)return null;let w=null;return d.locale&&(w=c.parse(d.locale,1,nn),!w)?null:new Ym(g,_,w)}evaluate(l){return new Vm(this.caseSensitive.evaluate(l),this.diacriticSensitive.evaluate(l),this.locale?this.locale.evaluate(l):null)}eachChild(l){l(this.caseSensitive),l(this.diacriticSensitive),this.locale&&l(this.locale)}outputDefined(){return!1}serialize(){const l={};return l["case-sensitive"]=this.caseSensitive.serialize(),l["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(l.locale=this.locale.serialize()),["collator",l]}}const Ll=8192;function Oa(u,l){u[0]=Math.min(u[0],l[0]),u[1]=Math.min(u[1],l[1]),u[2]=Math.max(u[2],l[0]),u[3]=Math.max(u[3],l[1])}function ad(u,l){return!(u[0]<=l[0]||u[2]>=l[2]||u[1]<=l[1]||u[3]>=l[3])}function zE(u,l){const c=(180+u[0])/360,d=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+u[1]*Math.PI/360)))/360,g=Math.pow(2,l.z);return[Math.round(c*g*Ll),Math.round(d*g*Ll)]}function HE(u,l,c){const d=u[0]-l[0],g=u[1]-l[1],_=u[0]-c[0],w=u[1]-c[1];return d*w-_*g==0&&d*_<=0&&g*w<=0}function Km(u,l){let c=!1;for(let w=0,C=l.length;w<C;w++){const R=l[w];for(let k=0,D=R.length;k<D-1;k++){if(HE(u,R[k],R[k+1]))return!1;(g=R[k])[1]>(d=u)[1]!=(_=R[k+1])[1]>d[1]&&d[0]<(_[0]-g[0])*(d[1]-g[1])/(_[1]-g[1])+g[0]&&(c=!c)}}var d,g,_;return c}function VE(u,l){for(let c=0;c<l.length;c++)if(Km(u,l[c]))return!0;return!1}function mw(u,l,c,d){const g=d[0]-c[0],_=d[1]-c[1],w=(u[0]-c[0])*_-g*(u[1]-c[1]),C=(l[0]-c[0])*_-g*(l[1]-c[1]);return w>0&&C<0||w<0&&C>0}function gw(u,l,c){for(const k of c)for(let D=0;D<k.length-1;++D)if((C=[(w=k[D+1])[0]-(_=k[D])[0],w[1]-_[1]])[0]*(R=[(g=l)[0]-(d=u)[0],g[1]-d[1]])[1]-C[1]*R[0]!=0&&mw(d,g,_,w)&&mw(_,w,d,g))return!0;var d,g,_,w,C,R;return!1}function mf(u,l){for(let c=0;c<u.length;++c)if(!Km(u[c],l))return!1;for(let c=0;c<u.length-1;++c)if(gw(u[c],u[c+1],l))return!1;return!0}function UE(u,l){for(let c=0;c<l.length;c++)if(mf(u,l[c]))return!0;return!1}function qm(u,l,c){const d=[];for(let g=0;g<u.length;g++){const _=[];for(let w=0;w<u[g].length;w++){const C=zE(u[g][w],c);Oa(l,C),_.push(C)}d.push(_)}return d}function Xm(u,l,c){const d=[];for(let g=0;g<u.length;g++){const _=qm(u[g],l,c);d.push(_)}return d}function yw(u,l,c,d){if(u[0]<c[0]||u[0]>c[2]){const g=.5*d;let _=u[0]-c[0]>g?-d:c[0]-u[0]>g?d:0;_===0&&(_=u[0]-c[2]>g?-d:c[2]-u[0]>g?d:0),u[0]+=_}Oa(l,u)}function $u(u,l,c,d){const g=Math.pow(2,d.z)*Ll,_=[d.x*Ll,d.y*Ll],w=[];if(!u)return w;for(const C of u)for(const R of C){const k=[R.x+_[0],R.y+_[1]];yw(k,l,c,g),w.push(k)}return w}function Tn(u,l,c,d){const g=Math.pow(2,d.z)*Ll,_=[d.x*Ll,d.y*Ll],w=[];if(!u)return w;for(const R of u){const k=[];for(const D of R){const N=[D.x+_[0],D.y+_[1]];Oa(l,N),k.push(N)}w.push(k)}if(l[2]-l[0]<=g/2){(C=l)[0]=C[1]=1/0,C[2]=C[3]=-1/0;for(const R of w)for(const k of R)yw(k,l,c,g)}var C;return w}class sd{constructor(l,c){this.type=Xr,this.geojson=l,this.geometries=c}static parse(l,c){if(l.length!==2)return c.error(`'within' expression requires exactly one argument, but found ${l.length-1} instead.`);if(Um(l[1])){const d=l[1];if(d.type==="FeatureCollection")for(let g=0;g<d.features.length;++g){const _=d.features[g].geometry.type;if(_==="Polygon"||_==="MultiPolygon")return new sd(d,d.features[g].geometry)}else if(d.type==="Feature"){const g=d.geometry.type;if(g==="Polygon"||g==="MultiPolygon")return new sd(d,d.geometry)}else if(d.type==="Polygon"||d.type==="MultiPolygon")return new sd(d,d)}return c.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(l){if(l.geometry()!=null&&l.canonicalID()!=null){if(l.geometryType()==="Point")return function(c,d){const g=[1/0,1/0,-1/0,-1/0],_=[1/0,1/0,-1/0,-1/0],w=c.canonicalID();if(!w)return!1;if(d.type==="Polygon"){const C=qm(d.coordinates,_,w),R=$u(c.geometry(),g,_,w);if(!ad(g,_))return!1;for(const k of R)if(!Km(k,C))return!1}if(d.type==="MultiPolygon"){const C=Xm(d.coordinates,_,w),R=$u(c.geometry(),g,_,w);if(!ad(g,_))return!1;for(const k of R)if(!VE(k,C))return!1}return!0}(l,this.geometries);if(l.geometryType()==="LineString")return function(c,d){const g=[1/0,1/0,-1/0,-1/0],_=[1/0,1/0,-1/0,-1/0],w=c.canonicalID();if(!w)return!1;if(d.type==="Polygon"){const C=qm(d.coordinates,_,w),R=Tn(c.geometry(),g,_,w);if(!ad(g,_))return!1;for(const k of R)if(!mf(k,C))return!1}if(d.type==="MultiPolygon"){const C=Xm(d.coordinates,_,w),R=Tn(c.geometry(),g,_,w);if(!ad(g,_))return!1;for(const k of R)if(!UE(k,C))return!1}return!0}(l,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var vw=sd;function ld(u){if(u instanceof Dl&&(u.name==="get"&&u.args.length===1||u.name==="feature-state"||u.name==="has"&&u.args.length===1||u.name==="properties"||u.name==="geometry-type"||u.name==="id"||/^filter-/.test(u.name))||u instanceof vw)return!1;let l=!0;return u.eachChild(c=>{l&&!ld(c)&&(l=!1)}),l}function ud(u){if(u instanceof Dl&&u.name==="feature-state")return!1;let l=!0;return u.eachChild(c=>{l&&!ud(c)&&(l=!1)}),l}function Zm(u,l){if(u instanceof Dl&&l.indexOf(u.name)>=0)return!1;let c=!0;return u.eachChild(d=>{c&&!Zm(d,l)&&(c=!1)}),c}class Jm{constructor(l,c){this.type=c.type,this.name=l,this.boundExpression=c}static parse(l,c){if(l.length!==2||typeof l[1]!="string")return c.error("'var' expression requires exactly one string literal argument.");const d=l[1];return c.scope.has(d)?new Jm(d,c.scope.get(d)):c.error(`Unknown variable "${d}". Make sure "${d}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(l){return this.boundExpression.evaluate(l)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var _w=Jm;class Qm{constructor(l,c=[],d,g=new NE,_=[]){this.registry=l,this.path=c,this.key=c.map(w=>`[${w}]`).join(""),this.scope=g,this.errors=_,this.expectedType=d}parse(l,c,d,g,_={}){return c?this.concat(c,d,g)._parse(l,_):this._parse(l,_)}_parse(l,c){function d(g,_,w){return w==="assert"?new Js(_,[g]):w==="coerce"?new df(_,[g]):g}if(l!==null&&typeof l!="string"&&typeof l!="boolean"&&typeof l!="number"||(l=["literal",l]),Array.isArray(l)){if(l.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const g=l[0];if(typeof g!="string")return this.error(`Expression name must be a string, but found ${typeof g} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const _=this.registry[g];if(_){let w=_.parse(l,this);if(!w)return null;if(this.expectedType){const C=this.expectedType,R=w.type;if(C.kind!=="string"&&C.kind!=="number"&&C.kind!=="boolean"&&C.kind!=="object"&&C.kind!=="array"||R.kind!=="value")if(C.kind!=="color"&&C.kind!=="formatted"&&C.kind!=="resolvedImage"||R.kind!=="value"&&R.kind!=="string"){if(this.checkSubtype(C,R))return null}else w=d(w,C,c.typeAnnotation||"coerce");else w=d(w,C,c.typeAnnotation||"assert")}if(!(w instanceof nd)&&w.type.kind!=="resolvedImage"&&Nl(w)){const C=new od;try{w=new nd(w.type,w.evaluate(C))}catch(R){return this.error(R.message),null}}return w}return this.error(`Unknown expression "${g}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(l===void 0?"'undefined' value invalid. Use null instead.":typeof l=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof l} instead.`)}concat(l,c,d){const g=typeof l=="number"?this.path.concat(l):this.path,_=d?this.scope.concat(d):this.scope;return new Qm(this.registry,g,c||null,_,this.errors)}error(l,...c){const d=`${this.key}${c.map(g=>`[${g}]`).join("")}`;this.errors.push(new bs(d,l))}checkSubtype(l,c){const d=Ho(l,c);return d&&this.error(d),d}}var bw=Qm;function Nl(u){if(u instanceof _w)return Nl(u.boundExpression);if(u instanceof Dl&&u.name==="error"||u instanceof Ym||u instanceof vw)return!1;const l=u instanceof df||u instanceof Js;let c=!0;return u.eachChild(d=>{c=l?c&&Nl(d):c&&d instanceof nd}),!!c&&ld(u)&&Zm(u,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"])}function Du(u,l){const c=u.length-1;let d,g,_=0,w=c,C=0;for(;_<=w;)if(C=Math.floor((_+w)/2),d=u[C],g=u[C+1],d<=l){if(C===c||l<g)return C;_=C+1}else{if(!(d>l))throw new co("Input is not a number.");w=C-1}return 0}class eg{constructor(l,c,d){this.type=l,this.input=c,this.labels=[],this.outputs=[];for(const[g,_]of d)this.labels.push(g),this.outputs.push(_)}static parse(l,c){if(l.length-1<4)return c.error(`Expected at least 4 arguments, but found only ${l.length-1}.`);if((l.length-1)%2!=0)return c.error("Expected an even number of arguments.");const d=c.parse(l[1],1,Gt);if(!d)return null;const g=[];let _=null;c.expectedType&&c.expectedType.kind!=="value"&&(_=c.expectedType);for(let w=1;w<l.length;w+=2){const C=w===1?-1/0:l[w],R=l[w+1],k=w,D=w+1;if(typeof C!="number")return c.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',k);if(g.length&&g[g.length-1][0]>=C)return c.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',k);const N=c.parse(R,D,_);if(!N)return null;_=_||N.type,g.push([C,N])}return new eg(_,d,g)}evaluate(l){const c=this.labels,d=this.outputs;if(c.length===1)return d[0].evaluate(l);const g=this.input.evaluate(l);if(g<=c[0])return d[0].evaluate(l);const _=c.length;return g>=c[_-1]?d[_-1].evaluate(l):d[Du(c,g)].evaluate(l)}eachChild(l){l(this.input);for(const c of this.outputs)l(c)}outputDefined(){return this.outputs.every(l=>l.outputDefined())}serialize(){const l=["step",this.input.serialize()];for(let c=0;c<this.labels.length;c++)c>0&&l.push(this.labels[c]),l.push(this.outputs[c].serialize());return l}}var ww=eg;function gn(u,l,c){return u*(1-c)+l*c}var cd=Object.freeze({__proto__:null,number:gn,color:function(u,l,c){return new xi(gn(u.r,l.r,c),gn(u.g,l.g,c),gn(u.b,l.b,c),gn(u.a,l.a,c))},array:function(u,l,c){return u.map((d,g)=>gn(d,l[g],c))}});const WE=.95047,GE=1.08883,Sw=4/29,xw=6/29,Cw=3*xw*xw,YE=Math.PI/180,UM=180/Math.PI;function tg(u){return u>.008856451679035631?Math.pow(u,1/3):u/Cw+Sw}function Ew(u){return u>xw?u*u*u:Cw*(u-Sw)}function rg(u){return 255*(u<=.0031308?12.92*u:1.055*Math.pow(u,1/2.4)-.055)}function ng(u){return(u/=255)<=.04045?u/12.92:Math.pow((u+.055)/1.055,2.4)}function KE(u){const l=ng(u.r),c=ng(u.g),d=ng(u.b),g=tg((.4124564*l+.3575761*c+.1804375*d)/WE),_=tg((.2126729*l+.7151522*c+.072175*d)/1);return{l:116*_-16,a:500*(g-_),b:200*(_-tg((.0193339*l+.119192*c+.9503041*d)/GE)),alpha:u.a}}function qE(u){let l=(u.l+16)/116,c=isNaN(u.a)?l:l+u.a/500,d=isNaN(u.b)?l:l-u.b/200;return l=1*Ew(l),c=WE*Ew(c),d=GE*Ew(d),new xi(rg(3.2404542*c-1.5371385*l-.4985314*d),rg(-.969266*c+1.8760108*l+.041556*d),rg(.0556434*c-.2040259*l+1.0572252*d),u.alpha)}function WM(u,l,c){const d=l-u;return u+c*(d>180||d<-180?d-360*Math.round(d/360):d)}const fd={forward:KE,reverse:qE,interpolate:function(u,l,c){return{l:gn(u.l,l.l,c),a:gn(u.a,l.a,c),b:gn(u.b,l.b,c),alpha:gn(u.alpha,l.alpha,c)}}},hd={forward:function(u){const{l,a:c,b:d}=KE(u),g=Math.atan2(d,c)*UM;return{h:g<0?g+360:g,c:Math.sqrt(c*c+d*d),l,alpha:u.a}},reverse:function(u){const l=u.h*YE,c=u.c;return qE({l:u.l,a:Math.cos(l)*c,b:Math.sin(l)*c,alpha:u.alpha})},interpolate:function(u,l,c){return{h:WM(u.h,l.h,c),c:gn(u.c,l.c,c),l:gn(u.l,l.l,c),alpha:gn(u.alpha,l.alpha,c)}}};var XE=Object.freeze({__proto__:null,lab:fd,hcl:hd});class dd{constructor(l,c,d,g,_){this.type=l,this.operator=c,this.interpolation=d,this.input=g,this.labels=[],this.outputs=[];for(const[w,C]of _)this.labels.push(w),this.outputs.push(C)}static interpolationFactor(l,c,d,g){let _=0;if(l.name==="exponential")_=Tw(c,l.base,d,g);else if(l.name==="linear")_=Tw(c,1,d,g);else if(l.name==="cubic-bezier"){const w=l.controlPoints;_=new W(w[0],w[1],w[2],w[3]).solve(Tw(c,1,d,g))}return _}static parse(l,c){let[d,g,_,...w]=l;if(!Array.isArray(g)||g.length===0)return c.error("Expected an interpolation type expression.",1);if(g[0]==="linear")g={name:"linear"};else if(g[0]==="exponential"){const k=g[1];if(typeof k!="number")return c.error("Exponential interpolation requires a numeric base.",1,1);g={name:"exponential",base:k}}else{if(g[0]!=="cubic-bezier")return c.error(`Unknown interpolation type ${String(g[0])}`,1,0);{const k=g.slice(1);if(k.length!==4||k.some(D=>typeof D!="number"||D<0||D>1))return c.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);g={name:"cubic-bezier",controlPoints:k}}}if(l.length-1<4)return c.error(`Expected at least 4 arguments, but found only ${l.length-1}.`);if((l.length-1)%2!=0)return c.error("Expected an even number of arguments.");if(_=c.parse(_,2,Gt),!_)return null;const C=[];let R=null;d==="interpolate-hcl"||d==="interpolate-lab"?R=ws:c.expectedType&&c.expectedType.kind!=="value"&&(R=c.expectedType);for(let k=0;k<w.length;k+=2){const D=w[k],N=w[k+1],F=k+3,G=k+4;if(typeof D!="number")return c.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',F);if(C.length&&C[C.length-1][0]>=D)return c.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',F);const Y=c.parse(N,G,R);if(!Y)return null;R=R||Y.type,C.push([D,Y])}return R.kind==="number"||R.kind==="color"||R.kind==="array"&&R.itemType.kind==="number"&&typeof R.N=="number"?new dd(R,d,g,_,C):c.error(`Type ${Hn(R)} is not interpolatable.`)}evaluate(l){const c=this.labels,d=this.outputs;if(c.length===1)return d[0].evaluate(l);const g=this.input.evaluate(l);if(g<=c[0])return d[0].evaluate(l);const _=c.length;if(g>=c[_-1])return d[_-1].evaluate(l);const w=Du(c,g),C=dd.interpolationFactor(this.interpolation,g,c[w],c[w+1]),R=d[w].evaluate(l),k=d[w+1].evaluate(l);return this.operator==="interpolate"?cd[this.type.kind.toLowerCase()](R,k,C):this.operator==="interpolate-hcl"?hd.reverse(hd.interpolate(hd.forward(R),hd.forward(k),C)):fd.reverse(fd.interpolate(fd.forward(R),fd.forward(k),C))}eachChild(l){l(this.input);for(const c of this.outputs)l(c)}outputDefined(){return this.outputs.every(l=>l.outputDefined())}serialize(){let l;l=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const c=[this.operator,l,this.input.serialize()];for(let d=0;d<this.labels.length;d++)c.push(this.labels[d],this.outputs[d].serialize());return c}}function Tw(u,l,c,d){const g=d-c,_=u-c;return g===0?0:l===1?_/g:(Math.pow(l,_)-1)/(Math.pow(l,g)-1)}var Ss=dd;class Ow{constructor(l,c){this.type=l,this.args=c}static parse(l,c){if(l.length<2)return c.error("Expectected at least one argument.");let d=null;const g=c.expectedType;g&&g.kind!=="value"&&(d=g);const _=[];for(const C of l.slice(1)){const R=c.parse(C,1+_.length,d,void 0,{typeAnnotation:"omit"});if(!R)return null;d=d||R.type,_.push(R)}const w=g&&_.some(C=>Ho(g,C.type));return new Ow(w?Yr:d,_)}evaluate(l){let c,d=null,g=0;for(const _ of this.args){if(g++,d=_.evaluate(l),d&&d instanceof Lo&&!d.available&&(c||(c=d),d=null,g===this.args.length))return c;if(d!==null)break}return d}eachChild(l){this.args.forEach(l)}outputDefined(){return this.args.every(l=>l.outputDefined())}serialize(){const l=["coalesce"];return this.eachChild(c=>{l.push(c.serialize())}),l}}var ZE=Ow;class ig{constructor(l,c){this.type=c.type,this.bindings=[].concat(l),this.result=c}evaluate(l){return this.result.evaluate(l)}eachChild(l){for(const c of this.bindings)l(c[1]);l(this.result)}static parse(l,c){if(l.length<4)return c.error(`Expected at least 3 arguments, but found ${l.length-1} instead.`);const d=[];for(let _=1;_<l.length-1;_+=2){const w=l[_];if(typeof w!="string")return c.error(`Expected string, but found ${typeof w} instead.`,_);if(/[^a-zA-Z0-9_]/.test(w))return c.error("Variable names must contain only alphanumeric characters or '_'.",_);const C=c.parse(l[_+1],_+1);if(!C)return null;d.push([w,C])}const g=c.parse(l[l.length-1],l.length-1,c.expectedType,d);return g?new ig(d,g):null}outputDefined(){return this.result.outputDefined()}serialize(){const l=["let"];for(const[c,d]of this.bindings)l.push(c,d.serialize());return l.push(this.result.serialize()),l}}var Rw=ig;class og{constructor(l,c,d){this.type=l,this.index=c,this.input=d}static parse(l,c){if(l.length!==3)return c.error(`Expected 2 arguments, but found ${l.length-1} instead.`);const d=c.parse(l[1],1,Gt),g=c.parse(l[2],2,Do(c.expectedType||Yr));return d&&g?new og(g.type.itemType,d,g):null}evaluate(l){const c=this.index.evaluate(l),d=this.input.evaluate(l);if(c<0)throw new co(`Array index out of bounds: ${c} < 0.`);if(c>=d.length)throw new co(`Array index out of bounds: ${c} > ${d.length-1}.`);if(c!==Math.floor(c))throw new co(`Array index must be an integer, but found ${c} instead.`);return d[c]}eachChild(l){l(this.index),l(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}var GM=og;class kw{constructor(l,c){this.type=Xr,this.needle=l,this.haystack=c}static parse(l,c){if(l.length!==3)return c.error(`Expected 2 arguments, but found ${l.length-1} instead.`);const d=c.parse(l[1],1,Yr),g=c.parse(l[2],2,Yr);return d&&g?cw(d.type,[Xr,nn,Gt,lf,Yr])?new kw(d,g):c.error(`Expected first argument to be of type boolean, string, number or null, but found ${Hn(d.type)} instead`):null}evaluate(l){const c=this.needle.evaluate(l),d=this.haystack.evaluate(l);if(d==null)return!1;if(!Iu(c,["boolean","string","number","null"]))throw new co(`Expected first argument to be of type boolean, string, number or null, but found ${Hn(Hi(c))} instead.`);if(!Iu(d,["string","array"]))throw new co(`Expected second argument to be of type array or string, but found ${Hn(Hi(d))} instead.`);return d.indexOf(c)>=0}eachChild(l){l(this.needle),l(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var JE=kw;class pd{constructor(l,c,d){this.type=Gt,this.needle=l,this.haystack=c,this.fromIndex=d}static parse(l,c){if(l.length<=2||l.length>=5)return c.error(`Expected 3 or 4 arguments, but found ${l.length-1} instead.`);const d=c.parse(l[1],1,Yr),g=c.parse(l[2],2,Yr);if(!d||!g)return null;if(!cw(d.type,[Xr,nn,Gt,lf,Yr]))return c.error(`Expected first argument to be of type boolean, string, number or null, but found ${Hn(d.type)} instead`);if(l.length===4){const _=c.parse(l[3],3,Gt);return _?new pd(d,g,_):null}return new pd(d,g)}evaluate(l){const c=this.needle.evaluate(l),d=this.haystack.evaluate(l);if(!Iu(c,["boolean","string","number","null"]))throw new co(`Expected first argument to be of type boolean, string, number or null, but found ${Hn(Hi(c))} instead.`);if(!Iu(d,["string","array"]))throw new co(`Expected second argument to be of type array or string, but found ${Hn(Hi(d))} instead.`);if(this.fromIndex){const g=this.fromIndex.evaluate(l);return d.indexOf(c,g)}return d.indexOf(c)}eachChild(l){l(this.needle),l(this.haystack),this.fromIndex&&l(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const l=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),l]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var QE=pd;class Pw{constructor(l,c,d,g,_,w){this.inputType=l,this.type=c,this.input=d,this.cases=g,this.outputs=_,this.otherwise=w}static parse(l,c){if(l.length<5)return c.error(`Expected at least 4 arguments, but found only ${l.length-1}.`);if(l.length%2!=1)return c.error("Expected an even number of arguments.");let d,g;c.expectedType&&c.expectedType.kind!=="value"&&(g=c.expectedType);const _={},w=[];for(let k=2;k<l.length-1;k+=2){let D=l[k];const N=l[k+1];Array.isArray(D)||(D=[D]);const F=c.concat(k);if(D.length===0)return F.error("Expected at least one branch label.");for(const Y of D){if(typeof Y!="number"&&typeof Y!="string")return F.error("Branch labels must be numbers or strings.");if(typeof Y=="number"&&Math.abs(Y)>Number.MAX_SAFE_INTEGER)return F.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof Y=="number"&&Math.floor(Y)!==Y)return F.error("Numeric branch labels must be integer values.");if(d){if(F.checkSubtype(d,Hi(Y)))return null}else d=Hi(Y);if(_[String(Y)]!==void 0)return F.error("Branch labels must be unique.");_[String(Y)]=w.length}const G=c.parse(N,k,g);if(!G)return null;g=g||G.type,w.push(G)}const C=c.parse(l[1],1,Yr);if(!C)return null;const R=c.parse(l[l.length-1],l.length-1,g);return R?C.type.kind!=="value"&&c.concat(1).checkSubtype(d,C.type)?null:new Pw(d,g,C,_,w,R):null}evaluate(l){const c=this.input.evaluate(l);return(Hi(c)===this.inputType&&this.outputs[this.cases[c]]||this.otherwise).evaluate(l)}eachChild(l){l(this.input),this.outputs.forEach(l),l(this.otherwise)}outputDefined(){return this.outputs.every(l=>l.outputDefined())&&this.otherwise.outputDefined()}serialize(){const l=["match",this.input.serialize()],c=Object.keys(this.cases).sort(),d=[],g={};for(const w of c){const C=g[this.cases[w]];C===void 0?(g[this.cases[w]]=d.length,d.push([this.cases[w],[w]])):d[C][1].push(w)}const _=w=>this.inputType.kind==="number"?Number(w):w;for(const[w,C]of d)l.push(C.length===1?_(C[0]):C.map(_)),l.push(this.outputs[w].serialize());return l.push(this.otherwise.serialize()),l}}var YM=Pw;class Aw{constructor(l,c,d){this.type=l,this.branches=c,this.otherwise=d}static parse(l,c){if(l.length<4)return c.error(`Expected at least 3 arguments, but found only ${l.length-1}.`);if(l.length%2!=0)return c.error("Expected an odd number of arguments.");let d;c.expectedType&&c.expectedType.kind!=="value"&&(d=c.expectedType);const g=[];for(let w=1;w<l.length-1;w+=2){const C=c.parse(l[w],w,Xr);if(!C)return null;const R=c.parse(l[w+1],w+1,d);if(!R)return null;g.push([C,R]),d=d||R.type}const _=c.parse(l[l.length-1],l.length-1,d);return _?new Aw(d,g,_):null}evaluate(l){for(const[c,d]of this.branches)if(c.evaluate(l))return d.evaluate(l);return this.otherwise.evaluate(l)}eachChild(l){for(const[c,d]of this.branches)l(c),l(d);l(this.otherwise)}outputDefined(){return this.branches.every(([l,c])=>c.outputDefined())&&this.otherwise.outputDefined()}serialize(){const l=["case"];return this.eachChild(c=>{l.push(c.serialize())}),l}}var KM=Aw;class Lu{constructor(l,c,d,g){this.type=l,this.input=c,this.beginIndex=d,this.endIndex=g}static parse(l,c){if(l.length<=2||l.length>=5)return c.error(`Expected 3 or 4 arguments, but found ${l.length-1} instead.`);const d=c.parse(l[1],1,Yr),g=c.parse(l[2],2,Gt);if(!d||!g)return null;if(!cw(d.type,[Do(Yr),nn,Yr]))return c.error(`Expected first argument to be of type array or string, but found ${Hn(d.type)} instead`);if(l.length===4){const _=c.parse(l[3],3,Gt);return _?new Lu(d.type,d,g,_):null}return new Lu(d.type,d,g)}evaluate(l){const c=this.input.evaluate(l),d=this.beginIndex.evaluate(l);if(!Iu(c,["string","array"]))throw new co(`Expected first argument to be of type array or string, but found ${Hn(Hi(c))} instead.`);if(this.endIndex){const g=this.endIndex.evaluate(l);return c.slice(d,g)}return c.slice(d)}eachChild(l){l(this.input),l(this.beginIndex),this.endIndex&&l(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const l=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),l]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var eT=Lu;function Iw(u,l){return u==="=="||u==="!="?l.kind==="boolean"||l.kind==="string"||l.kind==="number"||l.kind==="null"||l.kind==="value":l.kind==="string"||l.kind==="number"||l.kind==="value"}function tT(u,l,c,d){return d.compare(l,c)===0}function gf(u,l,c){const d=u!=="=="&&u!=="!=";return class gae{constructor(_,w,C){this.type=Xr,this.lhs=_,this.rhs=w,this.collator=C,this.hasUntypedArgument=_.type.kind==="value"||w.type.kind==="value"}static parse(_,w){if(_.length!==3&&_.length!==4)return w.error("Expected two or three arguments.");const C=_[0];let R=w.parse(_[1],1,Yr);if(!R)return null;if(!Iw(C,R.type))return w.concat(1).error(`"${C}" comparisons are not supported for type '${Hn(R.type)}'.`);let k=w.parse(_[2],2,Yr);if(!k)return null;if(!Iw(C,k.type))return w.concat(2).error(`"${C}" comparisons are not supported for type '${Hn(k.type)}'.`);if(R.type.kind!==k.type.kind&&R.type.kind!=="value"&&k.type.kind!=="value")return w.error(`Cannot compare types '${Hn(R.type)}' and '${Hn(k.type)}'.`);d&&(R.type.kind==="value"&&k.type.kind!=="value"?R=new Js(k.type,[R]):R.type.kind!=="value"&&k.type.kind==="value"&&(k=new Js(R.type,[k])));let D=null;if(_.length===4){if(R.type.kind!=="string"&&k.type.kind!=="string"&&R.type.kind!=="value"&&k.type.kind!=="value")return w.error("Cannot use collator to compare non-string types.");if(D=w.parse(_[3],3,Qh),!D)return null}return new gae(R,k,D)}evaluate(_){const w=this.lhs.evaluate(_),C=this.rhs.evaluate(_);if(d&&this.hasUntypedArgument){const R=Hi(w),k=Hi(C);if(R.kind!==k.kind||R.kind!=="string"&&R.kind!=="number")throw new co(`Expected arguments for "${u}" to be (string, string) or (number, number), but found (${R.kind}, ${k.kind}) instead.`)}if(this.collator&&!d&&this.hasUntypedArgument){const R=Hi(w),k=Hi(C);if(R.kind!=="string"||k.kind!=="string")return l(_,w,C)}return this.collator?c(_,w,C,this.collator.evaluate(_)):l(_,w,C)}eachChild(_){_(this.lhs),_(this.rhs),this.collator&&_(this.collator)}outputDefined(){return!0}serialize(){const _=[u];return this.eachChild(w=>{_.push(w.serialize())}),_}}}const qM=gf("==",function(u,l,c){return l===c},tT),rT=gf("!=",function(u,l,c){return l!==c},function(u,l,c,d){return!tT(0,l,c,d)}),nT=gf("<",function(u,l,c){return l<c},function(u,l,c,d){return d.compare(l,c)<0}),iT=gf(">",function(u,l,c){return l>c},function(u,l,c,d){return d.compare(l,c)>0}),Mw=gf("<=",function(u,l,c){return l<=c},function(u,l,c,d){return d.compare(l,c)<=0}),XM=gf(">=",function(u,l,c){return l>=c},function(u,l,c,d){return d.compare(l,c)>=0});class $w{constructor(l,c,d,g,_,w){this.type=nn,this.number=l,this.locale=c,this.currency=d,this.unit=g,this.minFractionDigits=_,this.maxFractionDigits=w}static parse(l,c){if(l.length!==3)return c.error("Expected two arguments.");const d=c.parse(l[1],1,Gt);if(!d)return null;const g=l[2];if(typeof g!="object"||Array.isArray(g))return c.error("NumberFormat options argument must be an object.");let _=null;if(g.locale&&(_=c.parse(g.locale,1,nn),!_))return null;let w=null;if(g.currency&&(w=c.parse(g.currency,1,nn),!w))return null;let C=null;if(g.unit&&(C=c.parse(g.unit,1,nn),!C))return null;let R=null;if(g["min-fraction-digits"]&&(R=c.parse(g["min-fraction-digits"],1,Gt),!R))return null;let k=null;return g["max-fraction-digits"]&&(k=c.parse(g["max-fraction-digits"],1,Gt),!k)?null:new $w(d,_,w,C,R,k)}evaluate(l){return new Intl.NumberFormat(this.locale?this.locale.evaluate(l):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(l):void 0,unit:this.unit?this.unit.evaluate(l):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(l):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(l):void 0}).format(this.number.evaluate(l))}eachChild(l){l(this.number),this.locale&&l(this.locale),this.currency&&l(this.currency),this.unit&&l(this.unit),this.minFractionDigits&&l(this.minFractionDigits),this.maxFractionDigits&&l(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const l={};return this.locale&&(l.locale=this.locale.serialize()),this.currency&&(l.currency=this.currency.serialize()),this.unit&&(l.unit=this.unit.serialize()),this.minFractionDigits&&(l["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(l["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),l]}}class Dw{constructor(l){this.type=Gt,this.input=l}static parse(l,c){if(l.length!==2)return c.error(`Expected 1 argument, but found ${l.length-1} instead.`);const d=c.parse(l[1],1);return d?d.type.kind!=="array"&&d.type.kind!=="string"&&d.type.kind!=="value"?c.error(`Expected argument of type string or array, but found ${Hn(d.type)} instead.`):new Dw(d):null}evaluate(l){const c=this.input.evaluate(l);if(typeof c=="string"||Array.isArray(c))return c.length;throw new co(`Expected value to be of type string or array, but found ${Hn(Hi(c))} instead.`)}eachChild(l){l(this.input)}outputDefined(){return!1}serialize(){const l=["length"];return this.eachChild(c=>{l.push(c.serialize())}),l}}const oT={"==":qM,"!=":rT,">":iT,"<":nT,">=":XM,"<=":Mw,array:Js,at:GM,boolean:Js,case:KM,coalesce:ZE,collator:Ym,format:id,image:Gm,in:JE,"index-of":QE,interpolate:Ss,"interpolate-hcl":Ss,"interpolate-lab":Ss,length:Dw,let:Rw,literal:nd,match:YM,number:Js,"number-format":$w,object:Js,slice:eT,step:ww,string:Js,"to-boolean":df,"to-color":df,"to-number":df,"to-string":df,var:_w,within:vw};function aT(u,[l,c,d,g]){l=l.evaluate(u),c=c.evaluate(u),d=d.evaluate(u);const _=g?g.evaluate(u):1,w=jE(l,c,d,_);if(w)throw new co(w);return new xi(l/255*_,c/255*_,d/255*_,_)}function sT(u,l){return u in l}function Lw(u,l){const c=l[u];return c===void 0?null:c}function Bl(u){return{type:u}}Dl.register(oT,{error:[{kind:"error"},[nn],(u,[l])=>{throw new co(l.evaluate(u))}],typeof:[nn,[Yr],(u,[l])=>Hn(Hi(l.evaluate(u)))],"to-rgba":[Do(Gt,4),[ws],(u,[l])=>l.evaluate(u).toArray()],rgb:[ws,[Gt,Gt,Gt],aT],rgba:[ws,[Gt,Gt,Gt,Gt],aT],has:{type:Xr,overloads:[[[nn],(u,[l])=>sT(l.evaluate(u),u.properties())],[[nn,Au],(u,[l,c])=>sT(l.evaluate(u),c.evaluate(u))]]},get:{type:Yr,overloads:[[[nn],(u,[l])=>Lw(l.evaluate(u),u.properties())],[[nn,Au],(u,[l,c])=>Lw(l.evaluate(u),c.evaluate(u))]]},"feature-state":[Yr,[nn],(u,[l])=>Lw(l.evaluate(u),u.featureState||{})],properties:[Au,[],u=>u.properties()],"geometry-type":[nn,[],u=>u.geometryType()],id:[Yr,[],u=>u.id()],zoom:[Gt,[],u=>u.globals.zoom],pitch:[Gt,[],u=>u.globals.pitch||0],"distance-from-center":[Gt,[],u=>u.distanceFromCenter()],"heatmap-density":[Gt,[],u=>u.globals.heatmapDensity||0],"line-progress":[Gt,[],u=>u.globals.lineProgress||0],"sky-radial-progress":[Gt,[],u=>u.globals.skyRadialProgress||0],accumulated:[Yr,[],u=>u.globals.accumulated===void 0?null:u.globals.accumulated],"+":[Gt,Bl(Gt),(u,l)=>{let c=0;for(const d of l)c+=d.evaluate(u);return c}],"*":[Gt,Bl(Gt),(u,l)=>{let c=1;for(const d of l)c*=d.evaluate(u);return c}],"-":{type:Gt,overloads:[[[Gt,Gt],(u,[l,c])=>l.evaluate(u)-c.evaluate(u)],[[Gt],(u,[l])=>-l.evaluate(u)]]},"/":[Gt,[Gt,Gt],(u,[l,c])=>l.evaluate(u)/c.evaluate(u)],"%":[Gt,[Gt,Gt],(u,[l,c])=>l.evaluate(u)%c.evaluate(u)],ln2:[Gt,[],()=>Math.LN2],pi:[Gt,[],()=>Math.PI],e:[Gt,[],()=>Math.E],"^":[Gt,[Gt,Gt],(u,[l,c])=>Math.pow(l.evaluate(u),c.evaluate(u))],sqrt:[Gt,[Gt],(u,[l])=>Math.sqrt(l.evaluate(u))],log10:[Gt,[Gt],(u,[l])=>Math.log(l.evaluate(u))/Math.LN10],ln:[Gt,[Gt],(u,[l])=>Math.log(l.evaluate(u))],log2:[Gt,[Gt],(u,[l])=>Math.log(l.evaluate(u))/Math.LN2],sin:[Gt,[Gt],(u,[l])=>Math.sin(l.evaluate(u))],cos:[Gt,[Gt],(u,[l])=>Math.cos(l.evaluate(u))],tan:[Gt,[Gt],(u,[l])=>Math.tan(l.evaluate(u))],asin:[Gt,[Gt],(u,[l])=>Math.asin(l.evaluate(u))],acos:[Gt,[Gt],(u,[l])=>Math.acos(l.evaluate(u))],atan:[Gt,[Gt],(u,[l])=>Math.atan(l.evaluate(u))],min:[Gt,Bl(Gt),(u,l)=>Math.min(...l.map(c=>c.evaluate(u)))],max:[Gt,Bl(Gt),(u,l)=>Math.max(...l.map(c=>c.evaluate(u)))],abs:[Gt,[Gt],(u,[l])=>Math.abs(l.evaluate(u))],round:[Gt,[Gt],(u,[l])=>{const c=l.evaluate(u);return c<0?-Math.round(-c):Math.round(c)}],floor:[Gt,[Gt],(u,[l])=>Math.floor(l.evaluate(u))],ceil:[Gt,[Gt],(u,[l])=>Math.ceil(l.evaluate(u))],"filter-==":[Xr,[nn,Yr],(u,[l,c])=>u.properties()[l.value]===c.value],"filter-id-==":[Xr,[Yr],(u,[l])=>u.id()===l.value],"filter-type-==":[Xr,[nn],(u,[l])=>u.geometryType()===l.value],"filter-<":[Xr,[nn,Yr],(u,[l,c])=>{const d=u.properties()[l.value],g=c.value;return typeof d==typeof g&&d<g}],"filter-id-<":[Xr,[Yr],(u,[l])=>{const c=u.id(),d=l.value;return typeof c==typeof d&&c<d}],"filter->":[Xr,[nn,Yr],(u,[l,c])=>{const d=u.properties()[l.value],g=c.value;return typeof d==typeof g&&d>g}],"filter-id->":[Xr,[Yr],(u,[l])=>{const c=u.id(),d=l.value;return typeof c==typeof d&&c>d}],"filter-<=":[Xr,[nn,Yr],(u,[l,c])=>{const d=u.properties()[l.value],g=c.value;return typeof d==typeof g&&d<=g}],"filter-id-<=":[Xr,[Yr],(u,[l])=>{const c=u.id(),d=l.value;return typeof c==typeof d&&c<=d}],"filter->=":[Xr,[nn,Yr],(u,[l,c])=>{const d=u.properties()[l.value],g=c.value;return typeof d==typeof g&&d>=g}],"filter-id->=":[Xr,[Yr],(u,[l])=>{const c=u.id(),d=l.value;return typeof c==typeof d&&c>=d}],"filter-has":[Xr,[Yr],(u,[l])=>l.value in u.properties()],"filter-has-id":[Xr,[],u=>u.id()!==null&&u.id()!==void 0],"filter-type-in":[Xr,[Do(nn)],(u,[l])=>l.value.indexOf(u.geometryType())>=0],"filter-id-in":[Xr,[Do(Yr)],(u,[l])=>l.value.indexOf(u.id())>=0],"filter-in-small":[Xr,[nn,Do(Yr)],(u,[l,c])=>c.value.indexOf(u.properties()[l.value])>=0],"filter-in-large":[Xr,[nn,Do(Yr)],(u,[l,c])=>function(d,g,_,w){for(;_<=w;){const C=_+w>>1;if(g[C]===d)return!0;g[C]>d?w=C-1:_=C+1}return!1}(u.properties()[l.value],c.value,0,c.value.length-1)],all:{type:Xr,overloads:[[[Xr,Xr],(u,[l,c])=>l.evaluate(u)&&c.evaluate(u)],[Bl(Xr),(u,l)=>{for(const c of l)if(!c.evaluate(u))return!1;return!0}]]},any:{type:Xr,overloads:[[[Xr,Xr],(u,[l,c])=>l.evaluate(u)||c.evaluate(u)],[Bl(Xr),(u,l)=>{for(const c of l)if(c.evaluate(u))return!0;return!1}]]},"!":[Xr,[Xr],(u,[l])=>!l.evaluate(u)],"is-supported-script":[Xr,[nn],(u,[l])=>{const c=u.globals&&u.globals.isSupportedScript;return!c||c(l.evaluate(u))}],upcase:[nn,[nn],(u,[l])=>l.evaluate(u).toUpperCase()],downcase:[nn,[nn],(u,[l])=>l.evaluate(u).toLowerCase()],concat:[nn,Bl(Yr),(u,l)=>l.map(c=>rd(c.evaluate(u))).join("")],"resolved-locale":[nn,[Qh],(u,[l])=>l.evaluate(u).resolvedLocale()]});var yf=oT;function md(u){return{result:"success",value:u}}function vf(u){return{result:"error",value:u}}function _f(u){return u["property-type"]==="data-driven"}function Qs(u){return!!u.expression&&u.expression.parameters.indexOf("zoom")>-1}function ag(u){return!!u.expression&&u.expression.interpolated}function cn(u){return u instanceof Number?"number":u instanceof String?"string":u instanceof Boolean?"boolean":Array.isArray(u)?"array":u===null?"null":typeof u}function sg(u){return typeof u=="object"&&u!==null&&!Array.isArray(u)}function ZM(u){return u}function Nw(u,l){const c=l.type==="color",d=u.stops&&typeof u.stops[0][0]=="object",g=d||!(d||u.property!==void 0),_=u.type||(ag(l)?"exponential":"interval");if(c&&((u=Ta({},u)).stops&&(u.stops=u.stops.map(k=>[k[0],xi.parse(k[1])])),u.default=xi.parse(u.default?u.default:l.default)),u.colorSpace&&u.colorSpace!=="rgb"&&!XE[u.colorSpace])throw new Error(`Unknown color space: ${u.colorSpace}`);let w,C,R;if(_==="exponential")w=lg;else if(_==="interval")w=lT;else if(_==="categorical"){w=Bw,C=Object.create(null);for(const k of u.stops)C[k[0]]=k[1];R=typeof u.stops[0][0]}else{if(_!=="identity")throw new Error(`Unknown function type "${_}"`);w=uT}if(d){const k={},D=[];for(let G=0;G<u.stops.length;G++){const Y=u.stops[G],J=Y[0].zoom;k[J]===void 0&&(k[J]={zoom:J,type:u.type,property:u.property,default:u.default,stops:[]},D.push(J)),k[J].stops.push([Y[0].value,Y[1]])}const N=[];for(const G of D)N.push([k[G].zoom,Nw(k[G],l)]);const F={name:"linear"};return{kind:"composite",interpolationType:F,interpolationFactor:Ss.interpolationFactor.bind(void 0,F),zoomStops:N.map(G=>G[0]),evaluate:({zoom:G},Y)=>lg({stops:N,base:u.base},l,G).evaluate(G,Y)}}if(g){const k=_==="exponential"?{name:"exponential",base:u.base!==void 0?u.base:1}:null;return{kind:"camera",interpolationType:k,interpolationFactor:Ss.interpolationFactor.bind(void 0,k),zoomStops:u.stops.map(D=>D[0]),evaluate:({zoom:D})=>w(u,l,D,C,R)}}return{kind:"source",evaluate(k,D){const N=D&&D.properties?D.properties[u.property]:void 0;return N===void 0?gd(u.default,l.default):w(u,l,N,C,R)}}}function gd(u,l,c){return u!==void 0?u:l!==void 0?l:c!==void 0?c:void 0}function Bw(u,l,c,d,g){return gd(typeof c===g?d[c]:void 0,u.default,l.default)}function lT(u,l,c){if(cn(c)!=="number")return gd(u.default,l.default);const d=u.stops.length;if(d===1||c<=u.stops[0][0])return u.stops[0][1];if(c>=u.stops[d-1][0])return u.stops[d-1][1];const g=Du(u.stops.map(_=>_[0]),c);return u.stops[g][1]}function lg(u,l,c){const d=u.base!==void 0?u.base:1;if(cn(c)!=="number")return gd(u.default,l.default);const g=u.stops.length;if(g===1||c<=u.stops[0][0])return u.stops[0][1];if(c>=u.stops[g-1][0])return u.stops[g-1][1];const _=Du(u.stops.map(D=>D[0]),c),w=function(D,N,F,G){const Y=G-F,J=D-F;return Y===0?0:N===1?J/Y:(Math.pow(N,J)-1)/(Math.pow(N,Y)-1)}(c,d,u.stops[_][0],u.stops[_+1][0]),C=u.stops[_][1],R=u.stops[_+1][1];let k=cd[l.type]||ZM;if(u.colorSpace&&u.colorSpace!=="rgb"){const D=XE[u.colorSpace];k=(N,F)=>D.reverse(D.interpolate(D.forward(N),D.forward(F),w))}return typeof C.evaluate=="function"?{evaluate(...D){const N=C.evaluate.apply(void 0,D),F=R.evaluate.apply(void 0,D);if(N!==void 0&&F!==void 0)return k(N,F,w)}}:k(C,R,w)}function uT(u,l,c){return l.type==="color"?c=xi.parse(c):l.type==="formatted"?c=Uo.fromString(c.toString()):l.type==="resolvedImage"?c=Lo.fromString(c.toString()):cn(c)===l.type||l.type==="enum"&&l.values[c]||(c=void 0),gd(c,u.default,l.default)}class ug{constructor(l,c){this.expression=l,this._warningHistory={},this._evaluator=new od,this._defaultValue=c?function(d){return d.type==="color"&&(sg(d.default)||Array.isArray(d.default))?new xi(0,0,0,0):d.type==="color"?xi.parse(d.default)||null:d.default===void 0?null:d.default}(c):null,this._enumValues=c&&c.type==="enum"?c.values:null}evaluateWithoutErrorHandling(l,c,d,g,_,w,C,R){return this._evaluator.globals=l,this._evaluator.feature=c,this._evaluator.featureState=d,this._evaluator.canonical=g||null,this._evaluator.availableImages=_||null,this._evaluator.formattedSection=w,this._evaluator.featureTileCoord=C||null,this._evaluator.featureDistanceData=R||null,this.expression.evaluate(this._evaluator)}evaluate(l,c,d,g,_,w,C,R){this._evaluator.globals=l,this._evaluator.feature=c||null,this._evaluator.featureState=d||null,this._evaluator.canonical=g||null,this._evaluator.availableImages=_||null,this._evaluator.formattedSection=w||null,this._evaluator.featureTileCoord=C||null,this._evaluator.featureDistanceData=R||null;try{const k=this.expression.evaluate(this._evaluator);if(k==null||typeof k=="number"&&k!=k)return this._defaultValue;if(this._enumValues&&!(k in this._enumValues))throw new co(`Expected value to be one of ${Object.keys(this._enumValues).map(D=>JSON.stringify(D)).join(", ")}, but found ${JSON.stringify(k)} instead.`);return k}catch(k){return this._warningHistory[k.message]||(this._warningHistory[k.message]=!0,typeof console<"u"&&console.warn(k.message)),this._defaultValue}}}function bf(u){return Array.isArray(u)&&u.length>0&&typeof u[0]=="string"&&u[0]in yf}function wf(u,l){const c=new bw(yf,[],l?function(g){const _={color:ws,string:nn,number:Gt,enum:nn,boolean:Xr,formatted:uf,resolvedImage:cf};return g.type==="array"?Do(_[g.value]||Yr,g.length):_[g.type]}(l):void 0),d=c.parse(u,void 0,void 0,void 0,l&&l.type==="string"?{typeAnnotation:"coerce"}:void 0);return d?md(new ug(d,l)):vf(c.errors)}class cg{constructor(l,c){this.kind=l,this._styleExpression=c,this.isStateDependent=l!=="constant"&&!ud(c.expression)}evaluateWithoutErrorHandling(l,c,d,g,_,w){return this._styleExpression.evaluateWithoutErrorHandling(l,c,d,g,_,w)}evaluate(l,c,d,g,_,w){return this._styleExpression.evaluate(l,c,d,g,_,w)}}class Nu{constructor(l,c,d,g){this.kind=l,this.zoomStops=d,this._styleExpression=c,this.isStateDependent=l!=="camera"&&!ud(c.expression),this.interpolationType=g}evaluateWithoutErrorHandling(l,c,d,g,_,w){return this._styleExpression.evaluateWithoutErrorHandling(l,c,d,g,_,w)}evaluate(l,c,d,g,_,w){return this._styleExpression.evaluate(l,c,d,g,_,w)}interpolationFactor(l,c,d){return this.interpolationType?Ss.interpolationFactor(this.interpolationType,l,c,d):0}}function Bu(u,l){if((u=wf(u,l)).result==="error")return u;const c=u.value.expression,d=ld(c);if(!d&&!_f(l))return vf([new bs("","data expressions not supported")]);const g=Zm(c,["zoom","pitch","distance-from-center"]);if(!g&&!Qs(l))return vf([new bs("","zoom expressions not supported")]);const _=vd(c);return _||g?_ instanceof bs?vf([_]):_ instanceof Ss&&!ag(l)?vf([new bs("",'"interpolate" expressions cannot be used with this property')]):md(_?new Nu(d?"camera":"composite",u.value,_.labels,_ instanceof Ss?_.interpolation:void 0):new cg(d?"constant":"source",u.value)):vf([new bs("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class yd{constructor(l,c){this._parameters=l,this._specification=c,Ta(this,Nw(this._parameters,this._specification))}static deserialize(l){return new yd(l._parameters,l._specification)}static serialize(l){return{_parameters:l._parameters,_specification:l._specification}}}function vd(u){let l=null;if(u instanceof Rw)l=vd(u.result);else if(u instanceof ZE){for(const c of u.args)if(l=vd(c),l)break}else(u instanceof ww||u instanceof Ss)&&u.input instanceof Dl&&u.input.name==="zoom"&&(l=u);return l instanceof bs||u.eachChild(c=>{const d=vd(c);d instanceof bs?l=d:!l&&d?l=new bs("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):l&&d&&l!==d&&(l=new bs("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),l}class tr{constructor(l,c,d,g){this.message=(l?`${l}: `:"")+d,g&&(this.identifier=g),c!=null&&c.__line__&&(this.line=c.__line__)}}function Ra(u){const l=u.key,c=u.value,d=u.valueSpec||{},g=u.objectElementValidators||{},_=u.style,w=u.styleSpec;let C=[];const R=cn(c);if(R!=="object")return[new tr(l,c,`object expected, ${R} found`)];for(const k in c){const D=k.split(".")[0],N=d[D]||d["*"];let F;g[D]?F=g[D]:d[D]?F=wo:g["*"]?F=g["*"]:d["*"]&&(F=wo),F?C=C.concat(F({key:(l&&`${l}.`)+k,value:c[k],valueSpec:N,style:_,styleSpec:w,object:c,objectKey:k},c)):C.push(new tr(l,c[k],`unknown property "${k}"`))}for(const k in d)g[k]||d[k].required&&d[k].default===void 0&&c[k]===void 0&&C.push(new tr(l,c,`missing required property "${k}"`));return C}function cT(u){const l=u.value,c=u.valueSpec,d=u.style,g=u.styleSpec,_=u.key,w=u.arrayElementValidator||wo;if(cn(l)!=="array")return[new tr(_,l,`array expected, ${cn(l)} found`)];if(c.length&&l.length!==c.length)return[new tr(_,l,`array length ${c.length} expected, length ${l.length} found`)];if(c["min-length"]&&l.length<c["min-length"])return[new tr(_,l,`array length at least ${c["min-length"]} expected, length ${l.length} found`)];let C={type:c.value,values:c.values,minimum:c.minimum,maximum:c.maximum,function:void 0};g.$version<7&&(C.function=c.function),cn(c.value)==="object"&&(C=c.value);let R=[];for(let k=0;k<l.length;k++)R=R.concat(w({array:l,arrayIndex:k,value:l[k],valueSpec:C,style:d,styleSpec:g,key:`${_}[${k}]`}));return R}function jw(u){const l=u.key,c=u.value,d=u.valueSpec;let g=cn(c);if(g==="number"&&c!=c&&(g="NaN"),g!=="number")return[new tr(l,c,`number expected, ${g} found`)];if("minimum"in d){let _=d.minimum;if(cn(d.minimum)==="array"&&(_=d.minimum[u.arrayIndex]),c<_)return[new tr(l,c,`${c} is less than the minimum value ${_}`)]}if("maximum"in d){let _=d.maximum;if(cn(d.maximum)==="array"&&(_=d.maximum[u.arrayIndex]),c>_)return[new tr(l,c,`${c} is greater than the maximum value ${_}`)]}return[]}function _d(u){const l=u.valueSpec,c=Si(u.value.type);let d,g,_,w={};const C=c!=="categorical"&&u.value.property===void 0,R=!C,k=cn(u.value.stops)==="array"&&cn(u.value.stops[0])==="array"&&cn(u.value.stops[0][0])==="object",D=Ra({key:u.key,value:u.value,valueSpec:u.styleSpec.function,style:u.style,styleSpec:u.styleSpec,objectElementValidators:{stops:function(G){if(c==="identity")return[new tr(G.key,G.value,'identity function may not have a "stops" property')];let Y=[];const J=G.value;return Y=Y.concat(cT({key:G.key,value:J,valueSpec:G.valueSpec,style:G.style,styleSpec:G.styleSpec,arrayElementValidator:N})),cn(J)==="array"&&J.length===0&&Y.push(new tr(G.key,J,"array must have at least one stop")),Y},default:function(G){return wo({key:G.key,value:G.value,valueSpec:l,style:G.style,styleSpec:G.styleSpec})}}});return c==="identity"&&C&&D.push(new tr(u.key,u.value,'missing required property "property"')),c==="identity"||u.value.stops||D.push(new tr(u.key,u.value,'missing required property "stops"')),c==="exponential"&&u.valueSpec.expression&&!ag(u.valueSpec)&&D.push(new tr(u.key,u.value,"exponential functions not supported")),u.styleSpec.$version>=8&&(R&&!_f(u.valueSpec)?D.push(new tr(u.key,u.value,"property functions not supported")):C&&!Qs(u.valueSpec)&&D.push(new tr(u.key,u.value,"zoom functions not supported"))),c!=="categorical"&&!k||u.value.property!==void 0||D.push(new tr(u.key,u.value,'"property" property is required')),D;function N(G){let Y=[];const J=G.value,oe=G.key;if(cn(J)!=="array")return[new tr(oe,J,`array expected, ${cn(J)} found`)];if(J.length!==2)return[new tr(oe,J,`array length 2 expected, length ${J.length} found`)];if(k){if(cn(J[0])!=="object")return[new tr(oe,J,`object expected, ${cn(J[0])} found`)];if(J[0].zoom===void 0)return[new tr(oe,J,"object stop key must have zoom")];if(J[0].value===void 0)return[new tr(oe,J,"object stop key must have value")];const ge=Si(J[0].zoom);if(typeof ge!="number")return[new tr(oe,J[0].zoom,"stop zoom values must be numbers")];if(_&&_>ge)return[new tr(oe,J[0].zoom,"stop zoom values must appear in ascending order")];ge!==_&&(_=ge,g=void 0,w={}),Y=Y.concat(Ra({key:`${oe}[0]`,value:J[0],valueSpec:{zoom:{}},style:G.style,styleSpec:G.styleSpec,objectElementValidators:{zoom:jw,value:F}}))}else Y=Y.concat(F({key:`${oe}[0]`,value:J[0],valueSpec:{},style:G.style,styleSpec:G.styleSpec},J));return bf($l(J[1]))?Y.concat([new tr(`${oe}[1]`,J[1],"expressions are not allowed in function stops.")]):Y.concat(wo({key:`${oe}[1]`,value:J[1],valueSpec:l,style:G.style,styleSpec:G.styleSpec}))}function F(G,Y){const J=cn(G.value),oe=Si(G.value),ge=G.value!==null?G.value:Y;if(d){if(J!==d)return[new tr(G.key,ge,`${J} stop domain type must match previous stop domain type ${d}`)]}else d=J;if(J!=="number"&&J!=="string"&&J!=="boolean"&&typeof oe!="number"&&typeof oe!="string"&&typeof oe!="boolean")return[new tr(G.key,ge,"stop domain value must be a number, string, or boolean")];if(J!=="number"&&c!=="categorical"){let Te=`number expected, ${J} found`;return _f(l)&&c===void 0&&(Te+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new tr(G.key,ge,Te)]}return c!=="categorical"||J!=="number"||typeof oe=="number"&&isFinite(oe)&&Math.floor(oe)===oe?c!=="categorical"&&J==="number"&&typeof oe=="number"&&typeof g=="number"&&g!==void 0&&oe<g?[new tr(G.key,ge,"stop domain values must appear in ascending order")]:(g=oe,c==="categorical"&&oe in w?[new tr(G.key,ge,"stop domain values must be unique")]:(w[oe]=!0,[])):[new tr(G.key,ge,`integer expected, found ${String(oe)}`)]}}function Sf(u){const l=(u.expressionContext==="property"?Bu:wf)($l(u.value),u.valueSpec);if(l.result==="error")return l.value.map(d=>new tr(`${u.key}${d.key}`,u.value,d.message));const c=l.value.expression||l.value._styleExpression.expression;if(u.expressionContext==="property"&&u.propertyKey==="text-font"&&!c.outputDefined())return[new tr(u.key,u.value,`Invalid data expression for "${u.propertyKey}". Output values must be contained as literals within the expression.`)];if(u.expressionContext==="property"&&u.propertyType==="layout"&&!ud(c))return[new tr(u.key,u.value,'"feature-state" data expressions are not supported with layout properties.')];if(u.expressionContext==="filter")return fT(c,u);if(u.expressionContext&&u.expressionContext.indexOf("cluster")===0){if(!Zm(c,["zoom","feature-state"]))return[new tr(u.key,u.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(u.expressionContext==="cluster-initial"&&!ld(c))return[new tr(u.key,u.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function fT(u,l){const c=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(l.valueSpec&&l.valueSpec.expression)for(const g of l.valueSpec.expression.parameters)c.delete(g);if(c.size===0)return[];const d=[];return u instanceof Dl&&c.has(u.name)?[new tr(l.key,l.value,`["${u.name}"] expression is not supported in a filter for a ${l.object.type} layer with id: ${l.object.id}`)]:(u.eachChild(g=>{d.push(...fT(g,l))}),d)}function fg(u){const l=u.key,c=u.value,d=u.valueSpec,g=[];return Array.isArray(d.values)?d.values.indexOf(Si(c))===-1&&g.push(new tr(l,c,`expected one of [${d.values.join(", ")}], ${JSON.stringify(c)} found`)):Object.keys(d.values).indexOf(Si(c))===-1&&g.push(new tr(l,c,`expected one of [${Object.keys(d.values).join(", ")}], ${JSON.stringify(c)} found`)),g}function Fw(u){if(u===!0||u===!1)return!0;if(!Array.isArray(u)||u.length===0)return!1;switch(u[0]){case"has":return u.length>=2&&u[1]!=="$id"&&u[1]!=="$type";case"in":return u.length>=3&&(typeof u[1]!="string"||Array.isArray(u[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return u.length!==3||Array.isArray(u[1])||Array.isArray(u[2]);case"any":case"all":for(const l of u.slice(1))if(!Fw(l)&&typeof l!="boolean")return!1;return!0;default:return!0}}function hg(u,l="fill"){if(u==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};Fw(u)||(u=pg(u));const c=u;let d=!0;try{d=function(k){if(!no(k))return k;let D=$l(k);return wd(D),D=bd(D),D}(c)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(c,null,2)}
        `)}const g=wt[`filter_${l}`],_=wf(d,g);let w=null;if(_.result==="error")throw new Error(_.value.map(k=>`${k.key}: ${k.message}`).join(", "));w=(k,D,N)=>_.value.evaluate(k,D,{},N);let C=null,R=null;if(d!==c){const k=wf(c,g);if(k.result==="error")throw new Error(k.value.map(D=>`${D.key}: ${D.message}`).join(", "));C=(D,N,F,G,Y)=>k.value.evaluate(D,N,{},F,void 0,void 0,G,Y),R=!ld(k.value.expression)}return{filter:w,dynamicFilter:C||void 0,needGeometry:hT(d),needFeature:!!R}}function bd(u){if(!Array.isArray(u))return u;const l=function(c){if(dg.has(c[0])){for(let d=1;d<c.length;d++)if(no(c[d]))return!0}return c}(u);return l===!0?l:l.map(c=>bd(c))}function wd(u){let l=!1;const c=[];if(u[0]==="case"){for(let d=1;d<u.length-1;d+=2)l=l||no(u[d]),c.push(u[d+1]);c.push(u[u.length-1])}else if(u[0]==="match"){l=l||no(u[1]);for(let d=2;d<u.length-1;d+=2)c.push(u[d+1]);c.push(u[u.length-1])}else if(u[0]==="step"){l=l||no(u[1]);for(let d=1;d<u.length-1;d+=2)c.push(u[d+1])}l&&(u.length=0,u.push("any",...c));for(let d=1;d<u.length;d++)wd(u[d])}function no(u){if(!Array.isArray(u))return!1;if((l=u[0])==="pitch"||l==="distance-from-center")return!0;var l;for(let c=1;c<u.length;c++)if(no(u[c]))return!0;return!1}const dg=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function JM(u,l){return u<l?-1:u>l?1:0}function hT(u){if(!Array.isArray(u))return!1;if(u[0]==="within")return!0;for(let l=1;l<u.length;l++)if(hT(u[l]))return!0;return!1}function pg(u){if(!u)return!0;const l=u[0];return u.length<=1?l!=="any":l==="=="?zw(u[1],u[2],"=="):l==="!="?xf(zw(u[1],u[2],"==")):l==="<"||l===">"||l==="<="||l===">="?zw(u[1],u[2],l):l==="any"?(c=u.slice(1),["any"].concat(c.map(pg))):l==="all"?["all"].concat(u.slice(1).map(pg)):l==="none"?["all"].concat(u.slice(1).map(pg).map(xf)):l==="in"?mg(u[1],u.slice(2)):l==="!in"?xf(mg(u[1],u.slice(2))):l==="has"?dT(u[1]):l==="!has"?xf(dT(u[1])):l!=="within"||u;var c}function zw(u,l,c){switch(u){case"$type":return[`filter-type-${c}`,l];case"$id":return[`filter-id-${c}`,l];default:return[`filter-${c}`,u,l]}}function mg(u,l){if(l.length===0)return!1;switch(u){case"$type":return["filter-type-in",["literal",l]];case"$id":return["filter-id-in",["literal",l]];default:return l.length>200&&!l.some(c=>typeof c!=typeof l[0])?["filter-in-large",u,["literal",l.sort(JM)]]:["filter-in-small",u,["literal",l]]}}function dT(u){switch(u){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",u]}}function xf(u){return["!",u]}function Hw(u){return Fw($l(u.value))?Sf(Ta({},u,{expressionContext:"filter",valueSpec:u.styleSpec[`filter_${u.layerType||"fill"}`]})):pT(u)}function pT(u){const l=u.value,c=u.key;if(cn(l)!=="array")return[new tr(c,l,`array expected, ${cn(l)} found`)];const d=u.styleSpec;let g,_=[];if(l.length<1)return[new tr(c,l,"filter array must have at least 1 element")];switch(_=_.concat(fg({key:`${c}[0]`,value:l[0],valueSpec:d.filter_operator,style:u.style,styleSpec:u.styleSpec})),Si(l[0])){case"<":case"<=":case">":case">=":l.length>=2&&Si(l[1])==="$type"&&_.push(new tr(c,l,`"$type" cannot be use with operator "${l[0]}"`));case"==":case"!=":l.length!==3&&_.push(new tr(c,l,`filter array for operator "${l[0]}" must have 3 elements`));case"in":case"!in":l.length>=2&&(g=cn(l[1]),g!=="string"&&_.push(new tr(`${c}[1]`,l[1],`string expected, ${g} found`)));for(let w=2;w<l.length;w++)g=cn(l[w]),Si(l[1])==="$type"?_=_.concat(fg({key:`${c}[${w}]`,value:l[w],valueSpec:d.geometry_type,style:u.style,styleSpec:u.styleSpec})):g!=="string"&&g!=="number"&&g!=="boolean"&&_.push(new tr(`${c}[${w}]`,l[w],`string, number, or boolean expected, ${g} found`));break;case"any":case"all":case"none":for(let w=1;w<l.length;w++)_=_.concat(pT({key:`${c}[${w}]`,value:l[w],style:u.style,styleSpec:u.styleSpec}));break;case"has":case"!has":g=cn(l[1]),l.length!==2?_.push(new tr(c,l,`filter array for "${l[0]}" operator must have 2 elements`)):g!=="string"&&_.push(new tr(`${c}[1]`,l[1],`string expected, ${g} found`));break;case"within":g=cn(l[1]),l.length!==2?_.push(new tr(c,l,`filter array for "${l[0]}" operator must have 2 elements`)):g!=="object"&&_.push(new tr(`${c}[1]`,l[1],`object expected, ${g} found`))}return _}function gg(u,l){const c=u.key,d=u.style,g=u.styleSpec,_=u.value,w=u.objectKey,C=g[`${l}_${u.layerType}`];if(!C)return[];const R=w.match(/^(.*)-transition$/);if(l==="paint"&&R&&C[R[1]]&&C[R[1]].transition)return wo({key:c,value:_,valueSpec:g.transition,style:d,styleSpec:g});const k=u.valueSpec||C[w];if(!k)return[new tr(c,_,`unknown property "${w}"`)];let D;if(cn(_)==="string"&&_f(k)&&!k.tokens&&(D=/^{([^}]+)}$/.exec(_))){const F=`\`{ "type": "identity", "property": ${D?JSON.stringify(D[1]):'"_"'} }\``;return[new tr(c,_,`"${w}" does not support interpolation syntax
Use an identity property function instead: ${F}.`)]}const N=[];return u.layerType==="symbol"&&(w==="text-field"&&d&&!d.glyphs&&N.push(new tr(c,_,'use of "text-field" requires a style "glyphs" property')),w==="text-font"&&sg($l(_))&&Si(_.type)==="identity"&&N.push(new tr(c,_,'"text-font" does not support identity functions'))),N.concat(wo({key:u.key,value:_,valueSpec:k,style:d,styleSpec:g,expressionContext:"property",propertyType:l,propertyKey:w}))}function mT(u){return gg(u,"paint")}function Vw(u){return gg(u,"layout")}function Uw(u){let l=[];const c=u.value,d=u.key,g=u.style,_=u.styleSpec;c.type||c.ref||l.push(new tr(d,c,'either "type" or "ref" is required'));let w=Si(c.type);const C=Si(c.ref);if(c.id){const R=Si(c.id);for(let k=0;k<u.arrayIndex;k++){const D=g.layers[k];Si(D.id)===R&&l.push(new tr(d,c.id,`duplicate layer id "${c.id}", previously used at line ${D.id.__line__}`))}}if("ref"in c){let R;["type","source","source-layer","filter","layout"].forEach(k=>{k in c&&l.push(new tr(d,c[k],`"${k}" is prohibited for ref layers`))}),g.layers.forEach(k=>{Si(k.id)===C&&(R=k)}),R?R.ref?l.push(new tr(d,c.ref,"ref cannot reference another ref layer")):w=Si(R.type):typeof C=="string"&&l.push(new tr(d,c.ref,`ref layer "${C}" not found`))}else if(w!=="background"&&w!=="sky")if(c.source){const R=g.sources&&g.sources[c.source],k=R&&Si(R.type);R?k==="vector"&&w==="raster"?l.push(new tr(d,c.source,`layer "${c.id}" requires a raster source`)):k==="raster"&&w!=="raster"?l.push(new tr(d,c.source,`layer "${c.id}" requires a vector source`)):k!=="vector"||c["source-layer"]?k==="raster-dem"&&w!=="hillshade"?l.push(new tr(d,c.source,"raster-dem source can only be used with layer type 'hillshade'.")):w!=="line"||!c.paint||!c.paint["line-gradient"]&&!c.paint["line-trim-offset"]||k==="geojson"&&R.lineMetrics||l.push(new tr(d,c,`layer "${c.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):l.push(new tr(d,c,`layer "${c.id}" must specify a "source-layer"`)):l.push(new tr(d,c.source,`source "${c.source}" not found`))}else l.push(new tr(d,c,'missing required property "source"'));return l=l.concat(Ra({key:d,value:c,valueSpec:_.layer,style:u.style,styleSpec:u.styleSpec,objectElementValidators:{"*":()=>[],type:()=>wo({key:`${d}.type`,value:c.type,valueSpec:_.layer.type,style:u.style,styleSpec:u.styleSpec,object:c,objectKey:"type"}),filter:R=>Hw(Ta({layerType:w},R)),layout:R=>Ra({layer:c,key:R.key,value:R.value,valueSpec:{},style:R.style,styleSpec:R.styleSpec,objectElementValidators:{"*":k=>Vw(Ta({layerType:w},k))}}),paint:R=>Ra({layer:c,key:R.key,value:R.value,valueSpec:{},style:R.style,styleSpec:R.styleSpec,objectElementValidators:{"*":k=>mT(Ta({layerType:w},k))}})}})),l}function Cf(u){const l=u.value,c=u.key,d=cn(l);return d!=="string"?[new tr(c,l,`string expected, ${d} found`)]:[]}const yg={promoteId:function({key:u,value:l}){if(cn(l)==="string")return Cf({key:u,value:l});{const c=[];for(const d in l)c.push(...Cf({key:`${u}.${d}`,value:l[d]}));return c}}};function Sd(u){const l=u.value,c=u.key,d=u.styleSpec,g=u.style;if(!l.type)return[new tr(c,l,'"type" is required')];const _=Si(l.type);let w;switch(_){case"vector":case"raster":case"raster-dem":return w=Ra({key:c,value:l,valueSpec:d[`source_${_.replace("-","_")}`],style:u.style,styleSpec:d,objectElementValidators:yg}),w;case"geojson":if(w=Ra({key:c,value:l,valueSpec:d.source_geojson,style:g,styleSpec:d,objectElementValidators:yg}),l.cluster)for(const C in l.clusterProperties){const[R,k]=l.clusterProperties[C],D=typeof R=="string"?[R,["accumulated"],["get",C]]:R;w.push(...Sf({key:`${c}.${C}.map`,value:k,expressionContext:"cluster-map"})),w.push(...Sf({key:`${c}.${C}.reduce`,value:D,expressionContext:"cluster-reduce"}))}return w;case"video":return Ra({key:c,value:l,valueSpec:d.source_video,style:g,styleSpec:d});case"image":return Ra({key:c,value:l,valueSpec:d.source_image,style:g,styleSpec:d});case"canvas":return[new tr(c,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return fg({key:`${c}.type`,value:l.type,valueSpec:{values:gT(d)},style:g,styleSpec:d})}}function gT(u){return u.source.reduce((l,c)=>{const d=u[c];return d.type.type==="enum"&&(l=l.concat(Object.keys(d.type.values))),l},[])}function yT(u){const l=u.value,c=u.styleSpec,d=c.light,g=u.style;let _=[];const w=cn(l);if(l===void 0)return _;if(w!=="object")return _=_.concat([new tr("light",l,`object expected, ${w} found`)]),_;for(const C in l){const R=C.match(/^(.*)-transition$/);_=_.concat(R&&d[R[1]]&&d[R[1]].transition?wo({key:C,value:l[C],valueSpec:c.transition,style:g,styleSpec:c}):d[C]?wo({key:C,value:l[C],valueSpec:d[C],style:g,styleSpec:c}):[new tr(C,l[C],`unknown property "${C}"`)])}return _}function Ww(u){const l=u.value,c=u.key,d=u.style,g=u.styleSpec,_=g.terrain;let w=[];const C=cn(l);if(l===void 0)return w;if(C!=="object")return w=w.concat([new tr("terrain",l,`object expected, ${C} found`)]),w;for(const R in l){const k=R.match(/^(.*)-transition$/);w=w.concat(k&&_[k[1]]&&_[k[1]].transition?wo({key:R,value:l[R],valueSpec:g.transition,style:d,styleSpec:g}):_[R]?wo({key:R,value:l[R],valueSpec:_[R],style:d,styleSpec:g}):[new tr(R,l[R],`unknown property "${R}"`)])}if(l.source){const R=d.sources&&d.sources[l.source],k=R&&Si(R.type);R?k!=="raster-dem"&&w.push(new tr(c,l.source,`terrain cannot be used with a source of type ${String(k)}, it only be used with a "raster-dem" source type`)):w.push(new tr(c,l.source,`source "${l.source}" not found`))}else w.push(new tr(c,l,'terrain is missing required property "source"'));return w}function vT(u){const l=u.value,c=u.style,d=u.styleSpec,g=d.fog;let _=[];const w=cn(l);if(l===void 0)return _;if(w!=="object")return _=_.concat([new tr("fog",l,`object expected, ${w} found`)]),_;for(const C in l){const R=C.match(/^(.*)-transition$/);_=_.concat(R&&g[R[1]]&&g[R[1]].transition?wo({key:C,value:l[C],valueSpec:d.transition,style:c,styleSpec:d}):g[C]?wo({key:C,value:l[C],valueSpec:g[C],style:c,styleSpec:d}):[new tr(C,l[C],`unknown property "${C}"`)])}return _}const vg={"*":()=>[],array:cT,boolean:function(u){const l=u.value,c=u.key,d=cn(l);return d!=="boolean"?[new tr(c,l,`boolean expected, ${d} found`)]:[]},number:jw,color:function(u){const l=u.key,c=u.value,d=cn(c);return d!=="string"?[new tr(l,c,`color expected, ${d} found`)]:fw(c)===null?[new tr(l,c,`color expected, "${c}" found`)]:[]},enum:fg,filter:Hw,function:_d,layer:Uw,object:Ra,source:Sd,light:yT,terrain:Ww,fog:vT,string:Cf,formatted:function(u){return Cf(u).length===0?[]:Sf(u)},resolvedImage:function(u){return Cf(u).length===0?[]:Sf(u)},projection:function(u){const l=u.value,c=u.styleSpec,d=c.projection,g=u.style;let _=[];const w=cn(l);if(w==="object")for(const C in l)_=_.concat(wo({key:C,value:l[C],valueSpec:d[C],style:g,styleSpec:c}));else w!=="string"&&(_=_.concat([new tr("projection",l,`object or string expected, ${w} found`)]));return _}};function wo(u){const l=u.value,c=u.valueSpec,d=u.styleSpec;return c.expression&&sg(Si(l))?_d(u):c.expression&&bf($l(l))?Sf(u):c.type&&vg[c.type]?vg[c.type](u):Ra(Ta({},u,{valueSpec:c.type?d[c.type]:c}))}function QM(u){const l=u.value,c=u.key,d=Cf(u);return d.length||(l.indexOf("{fontstack}")===-1&&d.push(new tr(c,l,'"glyphs" url must include a "{fontstack}" token')),l.indexOf("{range}")===-1&&d.push(new tr(c,l,'"glyphs" url must include a "{range}" token'))),d}function _T(u,l=wt){return el(wo({key:"",value:u,valueSpec:l.$root,styleSpec:l,style:u,objectElementValidators:{glyphs:QM,"*":()=>[]}}))}const e$=u=>el(mT(u)),bT=u=>el(Vw(u));function el(u){return u.slice().sort((l,c)=>l.line&&c.line?l.line-c.line:0)}function wT(u,l){let c=!1;if(l&&l.length)for(const d of l)u.fire(new sa(new Error(d.message))),c=!0;return c}var Ef=xs;function xs(u,l,c){var d=this.cells=[];if(u instanceof ArrayBuffer){this.arrayBuffer=u;var g=new Int32Array(this.arrayBuffer);u=g[0],this.d=(l=g[1])+2*(c=g[2]);for(var _=0;_<this.d*this.d;_++){var w=g[3+_],C=g[3+_+1];d.push(w===C?null:g.subarray(w,C))}var R=g[3+d.length+1];this.keys=g.subarray(g[3+d.length],R),this.bboxes=g.subarray(R),this.insert=this._insertReadonly}else{this.d=l+2*c;for(var k=0;k<this.d*this.d;k++)d.push([]);this.keys=[],this.bboxes=[]}this.n=l,this.extent=u,this.padding=c,this.scale=l/u,this.uid=0;var D=c/l*u;this.min=-D,this.max=u+D}xs.prototype.insert=function(u,l,c,d,g){this._forEachCell(l,c,d,g,this._insertCell,this.uid++),this.keys.push(u),this.bboxes.push(l),this.bboxes.push(c),this.bboxes.push(d),this.bboxes.push(g)},xs.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},xs.prototype._insertCell=function(u,l,c,d,g,_){this.cells[g].push(_)},xs.prototype.query=function(u,l,c,d,g){var _=this.min,w=this.max;if(u<=_&&l<=_&&w<=c&&w<=d&&!g)return Array.prototype.slice.call(this.keys);var C=[];return this._forEachCell(u,l,c,d,this._queryCell,C,{},g),C},xs.prototype._queryCell=function(u,l,c,d,g,_,w,C){var R=this.cells[g];if(R!==null)for(var k=this.keys,D=this.bboxes,N=0;N<R.length;N++){var F=R[N];if(w[F]===void 0){var G=4*F;(C?C(D[G+0],D[G+1],D[G+2],D[G+3]):u<=D[G+2]&&l<=D[G+3]&&c>=D[G+0]&&d>=D[G+1])?(w[F]=!0,_.push(k[F])):w[F]=!1}}},xs.prototype._forEachCell=function(u,l,c,d,g,_,w,C){for(var R=this._convertToCellCoord(u),k=this._convertToCellCoord(l),D=this._convertToCellCoord(c),N=this._convertToCellCoord(d),F=R;F<=D;F++)for(var G=k;G<=N;G++){var Y=this.d*G+F;if((!C||C(this._convertFromCellCoord(F),this._convertFromCellCoord(G),this._convertFromCellCoord(F+1),this._convertFromCellCoord(G+1)))&&g.call(this,u,l,c,d,Y,_,w,C))return}},xs.prototype._convertFromCellCoord=function(u){return(u-this.padding)/this.scale},xs.prototype._convertToCellCoord=function(u){return Math.max(0,Math.min(this.d-1,Math.floor(u*this.scale)+this.padding))},xs.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var u=this.cells,l=3+this.cells.length+1+1,c=0,d=0;d<this.cells.length;d++)c+=this.cells[d].length;var g=new Int32Array(l+c+this.keys.length+this.bboxes.length);g[0]=this.extent,g[1]=this.n,g[2]=this.padding;for(var _=l,w=0;w<u.length;w++){var C=u[w];g[3+w]=_,g.set(C,_),_+=C.length}return g[3+u.length]=_,g.set(this.keys,_),g[3+u.length+1]=_+=this.keys.length,g.set(this.bboxes,_),_+=this.bboxes.length,g.buffer};const _g={};function nr(u,l,c={}){Object.defineProperty(u,"_classRegistryKey",{value:l,writeable:!1}),_g[l]={klass:u,omit:c.omit||[]}}nr(Object,"Object"),Ef.serialize=function(u,l){const c=u.toArrayBuffer();return l&&l.push(c),{buffer:c}},Ef.deserialize=function(u){return new Ef(u.buffer)},Object.defineProperty(Ef,"name",{value:"Grid"}),nr(Ef,"Grid"),nr(xi,"Color"),nr(Error,"Error"),nr(Ht,"AJAXError"),nr(Lo,"ResolvedImage"),nr(yd,"StylePropertyFunction"),nr(ug,"StyleExpression",{omit:["_evaluator"]}),nr(Nu,"ZoomDependentExpression"),nr(cg,"ZoomConstantExpression"),nr(Dl,"CompoundExpression",{omit:["_evaluate"]});for(const u in yf)_g[yf[u]._classRegistryKey]||nr(yf[u],`Expression${u}`);function ST(u){return u&&typeof ArrayBuffer<"u"&&(u instanceof ArrayBuffer||u.constructor&&u.constructor.name==="ArrayBuffer")}function xd(u){return h.ImageBitmap&&u instanceof h.ImageBitmap}function Cd(u,l){if(u==null||typeof u=="boolean"||typeof u=="number"||typeof u=="string"||u instanceof Boolean||u instanceof Number||u instanceof String||u instanceof Date||u instanceof RegExp)return u;if(ST(u)||xd(u))return l&&l.push(u),u;if(ArrayBuffer.isView(u)){const c=u;return l&&l.push(c.buffer),c}if(u instanceof h.ImageData)return l&&l.push(u.data.buffer),u;if(Array.isArray(u)){const c=[];for(const d of u)c.push(Cd(d,l));return c}if(typeof u=="object"){const c=u.constructor,d=c._classRegistryKey;if(!d)throw new Error(`can't serialize object of unregistered class ${d}`);const g=c.serialize?c.serialize(u,l):{};if(!c.serialize){for(const _ in u)u.hasOwnProperty(_)&&(_g[d].omit.indexOf(_)>=0||(g[_]=Cd(u[_],l)));u instanceof Error&&(g.message=u.message)}if(g.$name)throw new Error("$name property is reserved for worker serialization logic.");return d!=="Object"&&(g.$name=d),g}throw new Error("can't serialize object of type "+typeof u)}function Ed(u){if(u==null||typeof u=="boolean"||typeof u=="number"||typeof u=="string"||u instanceof Boolean||u instanceof Number||u instanceof String||u instanceof Date||u instanceof RegExp||ST(u)||xd(u)||ArrayBuffer.isView(u)||u instanceof h.ImageData)return u;if(Array.isArray(u))return u.map(Ed);if(typeof u=="object"){const l=u.$name||"Object",{klass:c}=_g[l];if(!c)throw new Error(`can't deserialize unregistered class ${l}`);if(c.deserialize)return c.deserialize(u);const d=Object.create(c.prototype);for(const g of Object.keys(u))g!=="$name"&&(d[g]=Ed(u[g]));return d}throw new Error("can't deserialize object of type "+typeof u)}const Td=u=>u>=1536&&u<=1791,xT=u=>u>=1872&&u<=1919,Gw=u=>u>=2208&&u<=2303,CT=u=>u>=11904&&u<=12031,Yw=u=>u>=12032&&u<=12255,Kw=u=>u>=12272&&u<=12287,Od=u=>u>=12288&&u<=12351,bg=u=>u>=12352&&u<=12447,Tf=u=>u>=12448&&u<=12543,wg=u=>u>=12544&&u<=12591,ET=u=>u>=12704&&u<=12735,TT=u=>u>=12736&&u<=12783,qw=u=>u>=12784&&u<=12799,OT=u=>u>=12800&&u<=13055,RT=u=>u>=13056&&u<=13311,kT=u=>u>=13312&&u<=19903,Xw=u=>u>=19968&&u<=40959,PT=u=>u>=40960&&u<=42127,AT=u=>u>=42128&&u<=42191,IT=u=>u>=44032&&u<=55215,MT=u=>u>=63744&&u<=64255,Sg=u=>u>=64336&&u<=65023,Rd=u=>u>=65040&&u<=65055,v=u=>u>=65072&&u<=65103,f=u=>u>=65104&&u<=65135,m=u=>u>=65136&&u<=65279,b=u=>u>=65280&&u<=65519;function x(u){for(const l of u)if(I(l.charCodeAt(0)))return!0;return!1}function T(u){for(const l of u)if(!P(l.charCodeAt(0)))return!1;return!0}function P(u){return!(Td(u)||xT(u)||Gw(u)||Sg(u)||m(u))}function I(u){return!(u!==746&&u!==747&&(u<4352||!(ET(u)||wg(u)||v(u)&&!(u>=65097&&u<=65103)||MT(u)||RT(u)||CT(u)||TT(u)||!(!Od(u)||u>=12296&&u<=12305||u>=12308&&u<=12319||u===12336)||kT(u)||Xw(u)||OT(u)||(l=>l>=12592&&l<=12687)(u)||(l=>l>=43360&&l<=43391)(u)||(l=>l>=55216&&l<=55295)(u)||(l=>l>=4352&&l<=4607)(u)||IT(u)||bg(u)||Kw(u)||(l=>l>=12688&&l<=12703)(u)||Yw(u)||qw(u)||Tf(u)&&u!==12540||!(!b(u)||u===65288||u===65289||u===65293||u>=65306&&u<=65310||u===65339||u===65341||u===65343||u>=65371&&u<=65503||u===65507||u>=65512&&u<=65519)||!(!f(u)||u>=65112&&u<=65118||u>=65123&&u<=65126)||(l=>l>=5120&&l<=5759)(u)||(l=>l>=6320&&l<=6399)(u)||Rd(u)||(l=>l>=19904&&l<=19967)(u)||PT(u)||AT(u))))}function L(u){return!(I(u)||function(l){return!!((c=>c>=128&&c<=255)(l)&&(l===167||l===169||l===174||l===177||l===188||l===189||l===190||l===215||l===247)||(c=>c>=8192&&c<=8303)(l)&&(l===8214||l===8224||l===8225||l===8240||l===8241||l===8251||l===8252||l===8258||l===8263||l===8264||l===8265||l===8273)||(c=>c>=8448&&c<=8527)(l)||(c=>c>=8528&&c<=8591)(l)||(c=>c>=8960&&c<=9215)(l)&&(l>=8960&&l<=8967||l>=8972&&l<=8991||l>=8996&&l<=9e3||l===9003||l>=9085&&l<=9114||l>=9150&&l<=9165||l===9167||l>=9169&&l<=9179||l>=9186&&l<=9215)||(c=>c>=9216&&c<=9279)(l)&&l!==9251||(c=>c>=9280&&c<=9311)(l)||(c=>c>=9312&&c<=9471)(l)||(c=>c>=9632&&c<=9727)(l)||(c=>c>=9728&&c<=9983)(l)&&!(l>=9754&&l<=9759)||(c=>c>=11008&&c<=11263)(l)&&(l>=11026&&l<=11055||l>=11088&&l<=11097||l>=11192&&l<=11243)||Od(l)||Tf(l)||(c=>c>=57344&&c<=63743)(l)||v(l)||f(l)||b(l)||l===8734||l===8756||l===8757||l>=9984&&l<=10087||l>=10102&&l<=10131||l===65532||l===65533)}(u))}function V(u){return u>=1424&&u<=2303||Sg(u)||m(u)}function H(u,l){return!(!l&&V(u)||u>=2304&&u<=3583||u>=3840&&u<=4255||(c=>c>=6016&&c<=6143)(u))}function X(u){for(const l of u)if(V(l.charCodeAt(0)))return!0;return!1}const ne="deferred",ae="loading",le="loaded";let ue=null,ce="unavailable",te=null;const _e=function(u){u&&typeof u=="string"&&u.indexOf("NetworkError")>-1&&(ce="error"),ue&&ue(u)};function ve(){be.fire(new Nr("pluginStateChange",{pluginStatus:ce,pluginURL:te}))}const be=new Kn,$e=function(){return ce},Ae=function(){if(ce!==ne||!te)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");ce=ae,ve(),te&&Ir({url:te},u=>{u?_e(u):(ce=le,ve())})},Be={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>ce===le||Be.applyArabicShaping!=null,isLoading:()=>ce===ae,setState(u){ce=u.pluginStatus,te=u.pluginURL},isParsed:()=>Be.applyArabicShaping!=null&&Be.processBidirectionalText!=null&&Be.processStyledBidirectionalText!=null,getPluginURL:()=>te};class Ze{constructor(l,c){this.zoom=l,c?(this.now=c.now,this.fadeDuration=c.fadeDuration,this.transition=c.transition,this.pitch=c.pitch):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0)}isSupportedScript(l){return function(c,d){for(const g of c)if(!H(g.charCodeAt(0),d))return!1;return!0}(l,Be.isLoaded())}}class ot{constructor(l,c){this.property=l,this.value=c,this.expression=function(d,g){if(sg(d))return new yd(d,g);if(bf(d)){const _=Bu(d,g);if(_.result==="error")throw new Error(_.value.map(w=>`${w.key}: ${w.message}`).join(", "));return _.value}{let _=d;return typeof d=="string"&&g.type==="color"&&(_=xi.parse(d)),{kind:"constant",evaluate:()=>_}}}(c===void 0?l.specification.default:c,l.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(l,c,d){return this.property.possiblyEvaluate(this,l,c,d)}}class ut{constructor(l){this.property=l,this.value=new ot(l,void 0)}transitioned(l,c){return new rt(this.property,this.value,c,U({},l.transition,this.transition),l.now)}untransitioned(){return new rt(this.property,this.value,null,{},0)}}class zt{constructor(l){this._properties=l,this._values=Object.create(l.defaultTransitionablePropertyValues)}getValue(l){return Tt(this._values[l].value.value)}setValue(l,c){this._values.hasOwnProperty(l)||(this._values[l]=new ut(this._values[l].property)),this._values[l].value=new ot(this._values[l].property,c===null?void 0:Tt(c))}getTransition(l){return Tt(this._values[l].transition)}setTransition(l,c){this._values.hasOwnProperty(l)||(this._values[l]=new ut(this._values[l].property)),this._values[l].transition=Tt(c)||void 0}serialize(){const l={};for(const c of Object.keys(this._values)){const d=this.getValue(c);d!==void 0&&(l[c]=d);const g=this.getTransition(c);g!==void 0&&(l[`${c}-transition`]=g)}return l}transitioned(l,c){const d=new Ot(this._properties);for(const g of Object.keys(this._values))d._values[g]=this._values[g].transitioned(l,c._values[g]);return d}untransitioned(){const l=new Ot(this._properties);for(const c of Object.keys(this._values))l._values[c]=this._values[c].untransitioned();return l}}class rt{constructor(l,c,d,g,_){const w=g.delay||0,C=g.duration||0;_=_||0,this.property=l,this.value=c,this.begin=_+w,this.end=this.begin+C,l.specification.transition&&(g.delay||g.duration)&&(this.prior=d)}possiblyEvaluate(l,c,d){const g=l.now||0,_=this.value.possiblyEvaluate(l,c,d),w=this.prior;if(w){if(g>this.end)return this.prior=null,_;if(this.value.isDataDriven())return this.prior=null,_;if(g<this.begin)return w.possiblyEvaluate(l,c,d);{const C=(g-this.begin)/(this.end-this.begin);return this.property.interpolate(w.possiblyEvaluate(l,c,d),_,At(C))}}return _}}class Ot{constructor(l){this._properties=l,this._values=Object.create(l.defaultTransitioningPropertyValues)}possiblyEvaluate(l,c,d){const g=new st(this._properties);for(const _ of Object.keys(this._values))g._values[_]=this._values[_].possiblyEvaluate(l,c,d);return g}hasTransition(){for(const l of Object.keys(this._values))if(this._values[l].prior)return!0;return!1}}class vt{constructor(l){this._properties=l,this._values=Object.create(l.defaultPropertyValues)}getValue(l){return Tt(this._values[l].value)}setValue(l,c){this._values[l]=new ot(this._values[l].property,c===null?void 0:Tt(c))}serialize(){const l={};for(const c of Object.keys(this._values)){const d=this.getValue(c);d!==void 0&&(l[c]=d)}return l}possiblyEvaluate(l,c,d){const g=new st(this._properties);for(const _ of Object.keys(this._values))g._values[_]=this._values[_].possiblyEvaluate(l,c,d);return g}}class Mt{constructor(l,c,d){this.property=l,this.value=c,this.parameters=d}isConstant(){return this.value.kind==="constant"}constantOr(l){return this.value.kind==="constant"?this.value.value:l}evaluate(l,c,d,g){return this.property.evaluate(this.value,this.parameters,l,c,d,g)}}class st{constructor(l){this._properties=l,this._values=Object.create(l.defaultPossiblyEvaluatedValues)}get(l){return this._values[l]}}class Ke{constructor(l){this.specification=l}possiblyEvaluate(l,c){return l.expression.evaluate(c)}interpolate(l,c,d){const g=cd[this.specification.type];return g?g(l,c,d):l}}class dt{constructor(l,c){this.specification=l,this.overrides=c}possiblyEvaluate(l,c,d,g){return new Mt(this,l.expression.kind==="constant"||l.expression.kind==="camera"?{kind:"constant",value:l.expression.evaluate(c,null,{},d,g)}:l.expression,c)}interpolate(l,c,d){if(l.value.kind!=="constant"||c.value.kind!=="constant")return l;if(l.value.value===void 0||c.value.value===void 0)return new Mt(this,{kind:"constant",value:void 0},l.parameters);const g=cd[this.specification.type];return g?new Mt(this,{kind:"constant",value:g(l.value.value,c.value.value,d)},l.parameters):l}evaluate(l,c,d,g,_,w){return l.kind==="constant"?l.value:l.evaluate(c,d,g,_,w)}}class Pt{constructor(l){this.specification=l}possiblyEvaluate(l,c,d,g){return!!l.expression.evaluate(c,null,{},d,g)}interpolate(){return!1}}class Lt{constructor(l){this.properties=l,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const c=new Ze(0,{});for(const d in l){const g=l[d];g.specification.overridable&&this.overridableProperties.push(d);const _=this.defaultPropertyValues[d]=new ot(g,void 0),w=this.defaultTransitionablePropertyValues[d]=new ut(g);this.defaultTransitioningPropertyValues[d]=w.untransitioned(),this.defaultPossiblyEvaluatedValues[d]=_.possiblyEvaluate(c)}}}function cr(u,l){return 256*(u=Ce(Math.floor(u),0,255))+Ce(Math.floor(l),0,255)}nr(dt,"DataDrivenProperty"),nr(Ke,"DataConstantProperty"),nr(Pt,"ColorRampProperty");const Vr={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class ir{constructor(l,c){this._structArray=l,this._pos1=c*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class rr{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(l,c){return l._trim(),c&&(l.isTransferred=!0,c.push(l.arrayBuffer)),{length:l.length,arrayBuffer:l.arrayBuffer}}static deserialize(l){const c=Object.create(this.prototype);return c.arrayBuffer=l.arrayBuffer,c.length=l.length,c.capacity=l.arrayBuffer.byteLength/c.bytesPerElement,c._refreshViews(),c}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(l){this.reserve(l),this.length=l}reserve(l){if(l>this.capacity){this.capacity=Math.max(l,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const c=this.uint8;this._refreshViews(),c&&this.uint8.set(c)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function hr(u,l=1){let c=0,d=0;return{members:u.map(g=>{const _=Vr[g.type].BYTES_PER_ELEMENT,w=c=Zr(c,Math.max(l,_)),C=g.components||1;return d=Math.max(d,_),c+=_*C,{name:g.name,type:g.type,components:C,offset:w}}),size:Zr(c,Math.max(d,l)),alignment:l}}function Zr(u,l){return Math.ceil(u/l)*l}class _r extends rr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(l,c){const d=this.length;return this.resize(d+1),this.emplace(d,l,c)}emplace(l,c,d){const g=2*l;return this.int16[g+0]=c,this.int16[g+1]=d,l}}_r.prototype.bytesPerElement=4,nr(_r,"StructArrayLayout2i4");class On extends rr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(l,c,d){const g=this.length;return this.resize(g+1),this.emplace(g,l,c,d)}emplace(l,c,d,g){const _=3*l;return this.int16[_+0]=c,this.int16[_+1]=d,this.int16[_+2]=g,l}}On.prototype.bytesPerElement=6,nr(On,"StructArrayLayout3i6");class kn extends rr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(l,c,d,g){const _=this.length;return this.resize(_+1),this.emplace(_,l,c,d,g)}emplace(l,c,d,g,_){const w=4*l;return this.int16[w+0]=c,this.int16[w+1]=d,this.int16[w+2]=g,this.int16[w+3]=_,l}}kn.prototype.bytesPerElement=8,nr(kn,"StructArrayLayout4i8");class Vn extends rr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(l,c,d,g,_,w,C){const R=this.length;return this.resize(R+1),this.emplace(R,l,c,d,g,_,w,C)}emplace(l,c,d,g,_,w,C,R){const k=6*l,D=12*l,N=3*l;return this.int16[k+0]=c,this.int16[k+1]=d,this.uint8[D+4]=g,this.uint8[D+5]=_,this.uint8[D+6]=w,this.uint8[D+7]=C,this.float32[N+2]=R,l}}Vn.prototype.bytesPerElement=12,nr(Vn,"StructArrayLayout2i4ub1f12");class Nn extends rr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(l,c,d,g){const _=this.length;return this.resize(_+1),this.emplace(_,l,c,d,g)}emplace(l,c,d,g,_){const w=4*l;return this.float32[w+0]=c,this.float32[w+1]=d,this.float32[w+2]=g,this.float32[w+3]=_,l}}Nn.prototype.bytesPerElement=16,nr(Nn,"StructArrayLayout4f16");class Ri extends rr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(l,c,d,g,_){const w=this.length;return this.resize(w+1),this.emplace(w,l,c,d,g,_)}emplace(l,c,d,g,_,w){const C=6*l,R=3*l;return this.uint16[C+0]=c,this.uint16[C+1]=d,this.uint16[C+2]=g,this.uint16[C+3]=_,this.float32[R+2]=w,l}}Ri.prototype.bytesPerElement=12,nr(Ri,"StructArrayLayout4ui1f12");class Wo extends rr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(l,c,d,g){const _=this.length;return this.resize(_+1),this.emplace(_,l,c,d,g)}emplace(l,c,d,g,_){const w=4*l;return this.uint16[w+0]=c,this.uint16[w+1]=d,this.uint16[w+2]=g,this.uint16[w+3]=_,l}}Wo.prototype.bytesPerElement=8,nr(Wo,"StructArrayLayout4ui8");class Ka extends rr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(l,c,d,g,_,w){const C=this.length;return this.resize(C+1),this.emplace(C,l,c,d,g,_,w)}emplace(l,c,d,g,_,w,C){const R=6*l;return this.int16[R+0]=c,this.int16[R+1]=d,this.int16[R+2]=g,this.int16[R+3]=_,this.int16[R+4]=w,this.int16[R+5]=C,l}}Ka.prototype.bytesPerElement=12,nr(Ka,"StructArrayLayout6i12");class tl extends rr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(l,c,d,g,_,w,C,R,k,D,N,F){const G=this.length;return this.resize(G+1),this.emplace(G,l,c,d,g,_,w,C,R,k,D,N,F)}emplace(l,c,d,g,_,w,C,R,k,D,N,F,G){const Y=12*l;return this.int16[Y+0]=c,this.int16[Y+1]=d,this.int16[Y+2]=g,this.int16[Y+3]=_,this.uint16[Y+4]=w,this.uint16[Y+5]=C,this.uint16[Y+6]=R,this.uint16[Y+7]=k,this.int16[Y+8]=D,this.int16[Y+9]=N,this.int16[Y+10]=F,this.int16[Y+11]=G,l}}tl.prototype.bytesPerElement=24,nr(tl,"StructArrayLayout4i4ui4i24");class Qn extends rr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(l,c,d,g,_,w){const C=this.length;return this.resize(C+1),this.emplace(C,l,c,d,g,_,w)}emplace(l,c,d,g,_,w,C){const R=10*l,k=5*l;return this.int16[R+0]=c,this.int16[R+1]=d,this.int16[R+2]=g,this.float32[k+2]=_,this.float32[k+3]=w,this.float32[k+4]=C,l}}Qn.prototype.bytesPerElement=20,nr(Qn,"StructArrayLayout3i3f20");class Bn extends rr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(l){const c=this.length;return this.resize(c+1),this.emplace(c,l)}emplace(l,c){return this.uint32[1*l+0]=c,l}}Bn.prototype.bytesPerElement=4,nr(Bn,"StructArrayLayout1ul4");class wn extends rr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(l,c,d,g,_,w,C,R,k,D,N,F,G){const Y=this.length;return this.resize(Y+1),this.emplace(Y,l,c,d,g,_,w,C,R,k,D,N,F,G)}emplace(l,c,d,g,_,w,C,R,k,D,N,F,G,Y){const J=20*l,oe=10*l;return this.int16[J+0]=c,this.int16[J+1]=d,this.int16[J+2]=g,this.int16[J+3]=_,this.int16[J+4]=w,this.float32[oe+3]=C,this.float32[oe+4]=R,this.float32[oe+5]=k,this.float32[oe+6]=D,this.int16[J+14]=N,this.uint32[oe+8]=F,this.uint16[J+18]=G,this.uint16[J+19]=Y,l}}wn.prototype.bytesPerElement=40,nr(wn,"StructArrayLayout5i4f1i1ul2ui40");class mi extends rr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(l,c,d,g,_,w,C){const R=this.length;return this.resize(R+1),this.emplace(R,l,c,d,g,_,w,C)}emplace(l,c,d,g,_,w,C,R){const k=8*l;return this.int16[k+0]=c,this.int16[k+1]=d,this.int16[k+2]=g,this.int16[k+4]=_,this.int16[k+5]=w,this.int16[k+6]=C,this.int16[k+7]=R,l}}mi.prototype.bytesPerElement=16,nr(mi,"StructArrayLayout3i2i2i16");class So extends rr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(l,c,d,g,_){const w=this.length;return this.resize(w+1),this.emplace(w,l,c,d,g,_)}emplace(l,c,d,g,_,w){const C=4*l,R=8*l;return this.float32[C+0]=c,this.float32[C+1]=d,this.float32[C+2]=g,this.int16[R+6]=_,this.int16[R+7]=w,l}}So.prototype.bytesPerElement=16,nr(So,"StructArrayLayout2f1f2i16");class qn extends rr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(l,c,d,g){const _=this.length;return this.resize(_+1),this.emplace(_,l,c,d,g)}emplace(l,c,d,g,_){const w=12*l,C=3*l;return this.uint8[w+0]=c,this.uint8[w+1]=d,this.float32[C+1]=g,this.float32[C+2]=_,l}}qn.prototype.bytesPerElement=12,nr(qn,"StructArrayLayout2ub2f12");class xo extends rr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(l,c,d){const g=this.length;return this.resize(g+1),this.emplace(g,l,c,d)}emplace(l,c,d,g){const _=3*l;return this.float32[_+0]=c,this.float32[_+1]=d,this.float32[_+2]=g,l}}xo.prototype.bytesPerElement=12,nr(xo,"StructArrayLayout3f12");class Co extends rr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(l,c,d){const g=this.length;return this.resize(g+1),this.emplace(g,l,c,d)}emplace(l,c,d,g){const _=3*l;return this.uint16[_+0]=c,this.uint16[_+1]=d,this.uint16[_+2]=g,l}}Co.prototype.bytesPerElement=6,nr(Co,"StructArrayLayout3ui6");class jl extends rr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(l,c,d,g,_,w,C,R,k,D,N,F,G,Y,J,oe,ge,Te,he,xe,Me){const ke=this.length;return this.resize(ke+1),this.emplace(ke,l,c,d,g,_,w,C,R,k,D,N,F,G,Y,J,oe,ge,Te,he,xe,Me)}emplace(l,c,d,g,_,w,C,R,k,D,N,F,G,Y,J,oe,ge,Te,he,xe,Me,ke){const lt=30*l,it=15*l,xt=60*l;return this.int16[lt+0]=c,this.int16[lt+1]=d,this.int16[lt+2]=g,this.float32[it+2]=_,this.float32[it+3]=w,this.uint16[lt+8]=C,this.uint16[lt+9]=R,this.uint32[it+5]=k,this.uint32[it+6]=D,this.uint32[it+7]=N,this.uint16[lt+16]=F,this.uint16[lt+17]=G,this.uint16[lt+18]=Y,this.float32[it+10]=J,this.float32[it+11]=oe,this.uint8[xt+48]=ge,this.uint8[xt+49]=Te,this.uint8[xt+50]=he,this.uint32[it+13]=xe,this.int16[lt+28]=Me,this.uint8[xt+58]=ke,l}}jl.prototype.bytesPerElement=60,nr(jl,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class Of extends rr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(l,c,d,g,_,w,C,R,k,D,N,F,G,Y,J,oe,ge,Te,he,xe,Me,ke,lt,it,xt,Bt,gt,Et,Rt,$t){const Ft=this.length;return this.resize(Ft+1),this.emplace(Ft,l,c,d,g,_,w,C,R,k,D,N,F,G,Y,J,oe,ge,Te,he,xe,Me,ke,lt,it,xt,Bt,gt,Et,Rt,$t)}emplace(l,c,d,g,_,w,C,R,k,D,N,F,G,Y,J,oe,ge,Te,he,xe,Me,ke,lt,it,xt,Bt,gt,Et,Rt,$t,Ft){const yt=38*l,Yt=19*l;return this.int16[yt+0]=c,this.int16[yt+1]=d,this.int16[yt+2]=g,this.float32[Yt+2]=_,this.float32[Yt+3]=w,this.int16[yt+8]=C,this.int16[yt+9]=R,this.int16[yt+10]=k,this.int16[yt+11]=D,this.int16[yt+12]=N,this.int16[yt+13]=F,this.uint16[yt+14]=G,this.uint16[yt+15]=Y,this.uint16[yt+16]=J,this.uint16[yt+17]=oe,this.uint16[yt+18]=ge,this.uint16[yt+19]=Te,this.uint16[yt+20]=he,this.uint16[yt+21]=xe,this.uint16[yt+22]=Me,this.uint16[yt+23]=ke,this.uint16[yt+24]=lt,this.uint16[yt+25]=it,this.uint16[yt+26]=xt,this.uint16[yt+27]=Bt,this.uint16[yt+28]=gt,this.uint32[Yt+15]=Et,this.float32[Yt+16]=Rt,this.float32[Yt+17]=$t,this.float32[Yt+18]=Ft,l}}Of.prototype.bytesPerElement=76,nr(Of,"StructArrayLayout3i2f6i15ui1ul3f76");class la extends rr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(l){const c=this.length;return this.resize(c+1),this.emplace(c,l)}emplace(l,c){return this.float32[1*l+0]=c,l}}la.prototype.bytesPerElement=4,nr(la,"StructArrayLayout1f4");class ka extends rr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(l,c,d,g,_){const w=this.length;return this.resize(w+1),this.emplace(w,l,c,d,g,_)}emplace(l,c,d,g,_,w){const C=5*l;return this.float32[C+0]=c,this.float32[C+1]=d,this.float32[C+2]=g,this.float32[C+3]=_,this.float32[C+4]=w,l}}ka.prototype.bytesPerElement=20,nr(ka,"StructArrayLayout5f20");class rl extends rr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(l,c,d,g){const _=this.length;return this.resize(_+1),this.emplace(_,l,c,d,g)}emplace(l,c,d,g,_){const w=6*l;return this.uint32[3*l+0]=c,this.uint16[w+2]=d,this.uint16[w+3]=g,this.uint16[w+4]=_,l}}rl.prototype.bytesPerElement=12,nr(rl,"StructArrayLayout1ul3ui12");class Fl extends rr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(l,c){const d=this.length;return this.resize(d+1),this.emplace(d,l,c)}emplace(l,c,d){const g=2*l;return this.uint16[g+0]=c,this.uint16[g+1]=d,l}}Fl.prototype.bytesPerElement=4,nr(Fl,"StructArrayLayout2ui4");class zl extends rr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(l){const c=this.length;return this.resize(c+1),this.emplace(c,l)}emplace(l,c){return this.uint16[1*l+0]=c,l}}zl.prototype.bytesPerElement=2,nr(zl,"StructArrayLayout1ui2");class Rf extends rr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(l,c){const d=this.length;return this.resize(d+1),this.emplace(d,l,c)}emplace(l,c,d){const g=2*l;return this.float32[g+0]=c,this.float32[g+1]=d,l}}Rf.prototype.bytesPerElement=8,nr(Rf,"StructArrayLayout2f8");class VW extends ir{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}VW.prototype.size=40;class t$ extends wn{get(l){return new VW(this,l)}}nr(t$,"CollisionBoxArray");class UW extends ir{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(l){this._structArray.uint8[this._pos1+49]=l}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(l){this._structArray.uint8[this._pos1+50]=l}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(l){this._structArray.uint32[this._pos4+13]=l}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(l){this._structArray.uint8[this._pos1+58]=l}}UW.prototype.size=60;class WW extends jl{get(l){return new UW(this,l)}}nr(WW,"PlacedSymbolArray");class GW extends ir{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+11]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+13]}get key(){return this._structArray.uint16[this._pos2+14]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+17]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+19]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+21]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+22]}get featureIndex(){return this._structArray.uint16[this._pos2+23]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+25]}get numIconVertices(){return this._structArray.uint16[this._pos2+26]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+27]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+28]}get crossTileID(){return this._structArray.uint32[this._pos4+15]}set crossTileID(l){this._structArray.uint32[this._pos4+15]=l}get textOffset0(){return this._structArray.float32[this._pos4+16]}get textOffset1(){return this._structArray.float32[this._pos4+17]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+18]}}GW.prototype.size=76;class YW extends Of{get(l){return new GW(this,l)}}nr(YW,"SymbolInstanceArray");class KW extends la{getoffsetX(l){return this.float32[1*l+0]}}nr(KW,"GlyphOffsetArray");class qW extends _r{getx(l){return this.int16[2*l+0]}gety(l){return this.int16[2*l+1]}}nr(qW,"SymbolLineVertexArray");class XW extends ir{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}XW.prototype.size=12;class ZW extends rl{get(l){return new XW(this,l)}}nr(ZW,"FeatureIndexArray");class JW extends Fl{geta_centroid_pos0(l){return this.uint16[2*l+0]}geta_centroid_pos1(l){return this.uint16[2*l+1]}}nr(JW,"FillExtrusionCentroidArray");const Epe=hr([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),Tpe=hr([{name:"a_dash",components:4,type:"Uint16"}]);var kd={},Ope={get exports(){return kd},set exports(u){kd=u}},r$={};({get exports(){return r$},set exports(u){r$=u}}).exports=function(u,l){var c,d,g,_,w,C,R,k;for(d=u.length-(c=3&u.length),g=l,w=3432918353,C=461845907,k=0;k<d;)R=255&u.charCodeAt(k)|(255&u.charCodeAt(++k))<<8|(255&u.charCodeAt(++k))<<16|(255&u.charCodeAt(++k))<<24,++k,g=27492+(65535&(_=5*(65535&(g=(g^=R=(65535&(R=(R=(65535&R)*w+(((R>>>16)*w&65535)<<16)&4294967295)<<15|R>>>17))*C+(((R>>>16)*C&65535)<<16)&4294967295)<<13|g>>>19))+((5*(g>>>16)&65535)<<16)&4294967295))+((58964+(_>>>16)&65535)<<16);switch(R=0,c){case 3:R^=(255&u.charCodeAt(k+2))<<16;case 2:R^=(255&u.charCodeAt(k+1))<<8;case 1:g^=R=(65535&(R=(R=(65535&(R^=255&u.charCodeAt(k)))*w+(((R>>>16)*w&65535)<<16)&4294967295)<<15|R>>>17))*C+(((R>>>16)*C&65535)<<16)&4294967295}return g^=u.length,g=2246822507*(65535&(g^=g>>>16))+((2246822507*(g>>>16)&65535)<<16)&4294967295,g=3266489909*(65535&(g^=g>>>13))+((3266489909*(g>>>16)&65535)<<16)&4294967295,(g^=g>>>16)>>>0};var n$={};({get exports(){return n$},set exports(u){n$=u}}).exports=function(u,l){for(var c,d=u.length,g=l^d,_=0;d>=4;)c=1540483477*(65535&(c=255&u.charCodeAt(_)|(255&u.charCodeAt(++_))<<8|(255&u.charCodeAt(++_))<<16|(255&u.charCodeAt(++_))<<24))+((1540483477*(c>>>16)&65535)<<16),g=1540483477*(65535&g)+((1540483477*(g>>>16)&65535)<<16)^(c=1540483477*(65535&(c^=c>>>24))+((1540483477*(c>>>16)&65535)<<16)),d-=4,++_;switch(d){case 3:g^=(255&u.charCodeAt(_+2))<<16;case 2:g^=(255&u.charCodeAt(_+1))<<8;case 1:g=1540483477*(65535&(g^=255&u.charCodeAt(_)))+((1540483477*(g>>>16)&65535)<<16)}return g=1540483477*(65535&(g^=g>>>13))+((1540483477*(g>>>16)&65535)<<16),(g^=g>>>15)>>>0};var QW=r$,Rpe=n$;Ope.exports=QW,kd.murmur3=QW,kd.murmur2=Rpe;class $T{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(l,c,d,g){this.ids.push(e5(l)),this.positions.push(c,d,g)}getPositions(l){const c=e5(l);let d=0,g=this.ids.length-1;for(;d<g;){const w=d+g>>1;this.ids[w]>=c?g=w:d=w+1}const _=[];for(;this.ids[d]===c;)_.push({index:this.positions[3*d],start:this.positions[3*d+1],end:this.positions[3*d+2]}),d++;return _}static serialize(l,c){const d=new Float64Array(l.ids),g=new Uint32Array(l.positions);return i$(d,g,0,d.length-1),c&&c.push(d.buffer,g.buffer),{ids:d,positions:g}}static deserialize(l){const c=new $T;return c.ids=l.ids,c.positions=l.positions,c.indexed=!0,c}}function e5(u){const l=+u;return!isNaN(l)&&Number.MIN_SAFE_INTEGER<=l&&l<=Number.MAX_SAFE_INTEGER?l:kd(String(u))}function i$(u,l,c,d){for(;c<d;){const g=u[c+d>>1];let _=c-1,w=d+1;for(;;){do _++;while(u[_]<g);do w--;while(u[w]>g);if(_>=w)break;DT(u,_,w),DT(l,3*_,3*w),DT(l,3*_+1,3*w+1),DT(l,3*_+2,3*w+2)}w-c<d-w?(i$(u,l,c,w),c=w+1):(i$(u,l,w+1,d),d=w)}}function DT(u,l,c){const d=u[l];u[l]=u[c],u[c]=d}nr($T,"FeaturePositionMap");class ju{constructor(l){this.gl=l.gl,this.initialized=!1}fetchUniformLocation(l,c){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(l,c),this.initialized=!0),!!this.location}}class LT extends ju{constructor(l){super(l),this.current=0}set(l,c,d){this.fetchUniformLocation(l,c)&&this.current!==d&&(this.current=d,this.gl.uniform1f(this.location,d))}}class t5 extends ju{constructor(l){super(l),this.current=[0,0,0,0]}set(l,c,d){this.fetchUniformLocation(l,c)&&(d[0]===this.current[0]&&d[1]===this.current[1]&&d[2]===this.current[2]&&d[3]===this.current[3]||(this.current=d,this.gl.uniform4f(this.location,d[0],d[1],d[2],d[3])))}}class r5 extends ju{constructor(l){super(l),this.current=xi.transparent}set(l,c,d){this.fetchUniformLocation(l,c)&&(d.r===this.current.r&&d.g===this.current.g&&d.b===this.current.b&&d.a===this.current.a||(this.current=d,this.gl.uniform4f(this.location,d.r,d.g,d.b,d.a)))}}const kpe=new Float32Array(16),Ppe=new Float32Array(9),Ape=new Float32Array(4);function o$(u){return[cr(255*u.r,255*u.g),cr(255*u.b,255*u.a)]}class Zw{constructor(l,c,d){this.value=l,this.uniformNames=c.map(g=>`u_${g}`),this.type=d}setUniform(l,c,d,g,_){c.set(l,_,g.constantOr(this.value))}getBinding(l,c){return this.type==="color"?new r5(l):new LT(l)}}class xg{constructor(l,c){this.uniformNames=c.map(d=>`u_${d}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(l){this.pixelRatio=l.pixelRatio||1,this.pattern=l.tl.concat(l.br)}setUniform(l,c,d,g,_){const w=_==="u_pattern"||_==="u_dash"?this.pattern:_==="u_pixel_ratio"?this.pixelRatio:null;w&&c.set(l,_,w)}getBinding(l,c){return c==="u_pattern"||c==="u_dash"?new t5(l):new LT(l)}}class Fu{constructor(l,c,d,g){this.expression=l,this.type=d,this.maxValue=0,this.paintVertexAttributes=c.map(_=>({name:`a_${_}`,type:"Float32",components:d==="color"?2:1,offset:0})),this.paintVertexArray=new g}populatePaintArray(l,c,d,g,_,w){const C=this.paintVertexArray.length,R=this.expression.evaluate(new Ze(0),c,{},_,g,w);this.paintVertexArray.resize(l),this._setPaintValue(C,l,R)}updatePaintArray(l,c,d,g,_){const w=this.expression.evaluate({zoom:0},d,g,void 0,_);this._setPaintValue(l,c,w)}_setPaintValue(l,c,d){if(this.type==="color"){const g=o$(d);for(let _=l;_<c;_++)this.paintVertexArray.emplace(_,g[0],g[1])}else{for(let g=l;g<c;g++)this.paintVertexArray.emplace(g,d);this.maxValue=Math.max(this.maxValue,Math.abs(d))}}upload(l){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=l.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class nl{constructor(l,c,d,g,_,w){this.expression=l,this.uniformNames=c.map(C=>`u_${C}_t`),this.type=d,this.useIntegerZoom=g,this.zoom=_,this.maxValue=0,this.paintVertexAttributes=c.map(C=>({name:`a_${C}`,type:"Float32",components:d==="color"?4:2,offset:0})),this.paintVertexArray=new w}populatePaintArray(l,c,d,g,_,w){const C=this.expression.evaluate(new Ze(this.zoom),c,{},_,g,w),R=this.expression.evaluate(new Ze(this.zoom+1),c,{},_,g,w),k=this.paintVertexArray.length;this.paintVertexArray.resize(l),this._setPaintValue(k,l,C,R)}updatePaintArray(l,c,d,g,_){const w=this.expression.evaluate({zoom:this.zoom},d,g,void 0,_),C=this.expression.evaluate({zoom:this.zoom+1},d,g,void 0,_);this._setPaintValue(l,c,w,C)}_setPaintValue(l,c,d,g){if(this.type==="color"){const _=o$(d),w=o$(g);for(let C=l;C<c;C++)this.paintVertexArray.emplace(C,_[0],_[1],w[0],w[1])}else{for(let _=l;_<c;_++)this.paintVertexArray.emplace(_,d,g);this.maxValue=Math.max(this.maxValue,Math.abs(d),Math.abs(g))}}upload(l){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=l.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(l,c,d,g,_){const w=this.useIntegerZoom?Math.floor(d.zoom):d.zoom,C=Ce(this.expression.interpolationFactor(w,this.zoom,this.zoom+1),0,1);c.set(l,_,C)}getBinding(l,c){return new LT(l)}}class kf{constructor(l,c,d,g,_){this.expression=l,this.layerId=_,this.paintVertexAttributes=(d==="array"?Tpe:Epe).members;for(let w=0;w<c.length;++w);this.paintVertexArray=new g}populatePaintArray(l,c,d){const g=this.paintVertexArray.length;this.paintVertexArray.resize(l),this._setPaintValues(g,l,c.patterns&&c.patterns[this.layerId],d)}updatePaintArray(l,c,d,g,_,w){this._setPaintValues(l,c,d.patterns&&d.patterns[this.layerId],w)}_setPaintValues(l,c,d,g){if(!g||!d)return;const _=g[d];if(!_)return;const{tl:w,br:C,pixelRatio:R}=_;for(let k=l;k<c;k++)this.paintVertexArray.emplace(k,w[0],w[1],C[0],C[1],R)}upload(l){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=l.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Pf{constructor(l,c,d=()=>!0){this.binders={},this._buffers=[];const g=[];for(const _ in l.paint._values){if(!d(_))continue;const w=l.paint.get(_);if(!(w instanceof Mt&&_f(w.property.specification)))continue;const C=Mpe(_,l.type),R=w.value,k=w.property.specification.type,D=!!w.property.useIntegerZoom,N=_==="line-dasharray"||_.endsWith("pattern"),F=_==="line-dasharray"&&l.layout.get("line-cap").value.kind!=="constant";if(R.kind!=="constant"||F)if(R.kind==="source"||F||N){const G=n5(_,k,"source");this.binders[_]=N?new kf(R,C,k,G,l.id):new Fu(R,C,k,G),g.push(`/a_${_}`)}else{const G=n5(_,k,"composite");this.binders[_]=new nl(R,C,k,D,c,G),g.push(`/z_${_}`)}else this.binders[_]=N?new xg(R.value,C):new Zw(R.value,C,k),g.push(`/u_${_}`)}this.cacheKey=g.sort().join("")}getMaxValue(l){const c=this.binders[l];return c instanceof Fu||c instanceof nl?c.maxValue:0}populatePaintArrays(l,c,d,g,_,w){for(const C in this.binders){const R=this.binders[C];(R instanceof Fu||R instanceof nl||R instanceof kf)&&R.populatePaintArray(l,c,d,g,_,w)}}setConstantPatternPositions(l){for(const c in this.binders){const d=this.binders[c];d instanceof xg&&d.setConstantPatternPositions(l)}}updatePaintArrays(l,c,d,g,_,w){let C=!1;for(const R in l){const k=c.getPositions(R);for(const D of k){const N=d.feature(D.index);for(const F in this.binders){const G=this.binders[F];if((G instanceof Fu||G instanceof nl||G instanceof kf)&&G.expression.isStateDependent===!0){const Y=g.paint.get(F);G.expression=Y.value,G.updatePaintArray(D.start,D.end,N,l[R],_,w),C=!0}}}}return C}defines(){const l=[];for(const c in this.binders){const d=this.binders[c];(d instanceof Zw||d instanceof xg)&&l.push(...d.uniformNames.map(g=>`#define HAS_UNIFORM_${g}`))}return l}getBinderAttributes(){const l=[];for(const c in this.binders){const d=this.binders[c];if(d instanceof Fu||d instanceof nl||d instanceof kf)for(let g=0;g<d.paintVertexAttributes.length;g++)l.push(d.paintVertexAttributes[g].name)}return l}getBinderUniforms(){const l=[];for(const c in this.binders){const d=this.binders[c];if(d instanceof Zw||d instanceof xg||d instanceof nl)for(const g of d.uniformNames)l.push(g)}return l}getPaintVertexBuffers(){return this._buffers}getUniforms(l){const c=[];for(const d in this.binders){const g=this.binders[d];if(g instanceof Zw||g instanceof xg||g instanceof nl)for(const _ of g.uniformNames)c.push({name:_,property:d,binding:g.getBinding(l,_)})}return c}setUniforms(l,c,d,g,_){for(const{name:w,property:C,binding:R}of d)this.binders[C].setUniform(l,R,_,g.get(C),w)}updatePaintBuffers(){this._buffers=[];for(const l in this.binders){const c=this.binders[l];(c instanceof Fu||c instanceof nl||c instanceof kf)&&c.paintVertexBuffer&&this._buffers.push(c.paintVertexBuffer)}}upload(l){for(const c in this.binders){const d=this.binders[c];(d instanceof Fu||d instanceof nl||d instanceof kf)&&d.upload(l)}this.updatePaintBuffers()}destroy(){for(const l in this.binders){const c=this.binders[l];(c instanceof Fu||c instanceof nl||c instanceof kf)&&c.destroy()}}}class Pd{constructor(l,c,d=()=>!0){this.programConfigurations={};for(const g of l)this.programConfigurations[g.id]=new Pf(g,c,d);this.needsUpload=!1,this._featureMap=new $T,this._bufferOffset=0}populatePaintArrays(l,c,d,g,_,w,C){for(const R in this.programConfigurations)this.programConfigurations[R].populatePaintArrays(l,c,g,_,w,C);c.id!==void 0&&this._featureMap.add(c.id,d,this._bufferOffset,l),this._bufferOffset=l,this.needsUpload=!0}updatePaintArrays(l,c,d,g,_){for(const w of d)this.needsUpload=this.programConfigurations[w.id].updatePaintArrays(l,this._featureMap,c,w,g,_)||this.needsUpload}get(l){return this.programConfigurations[l]}upload(l){if(this.needsUpload){for(const c in this.programConfigurations)this.programConfigurations[c].upload(l);this.needsUpload=!1}}destroy(){for(const l in this.programConfigurations)this.programConfigurations[l].destroy()}}const Ipe={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function Mpe(u,l){return Ipe[u]||[u.replace(`${l}-`,"").replace(/-/g,"_")]}const $pe={"line-pattern":{source:Ri,composite:Ri},"fill-pattern":{source:Ri,composite:Ri},"fill-extrusion-pattern":{source:Ri,composite:Ri},"line-dasharray":{source:Wo,composite:Wo}},Dpe={color:{source:Rf,composite:Nn},number:{source:la,composite:Rf}};function n5(u,l,c){const d=$pe[u];return d&&d[c]||Dpe[l][c]}nr(Zw,"ConstantBinder"),nr(xg,"PatternConstantBinder"),nr(Fu,"SourceExpressionBinder"),nr(kf,"PatternCompositeBinder"),nr(nl,"CompositeExpressionBinder"),nr(Pf,"ProgramConfiguration",{omit:["_buffers"]}),nr(Pd,"ProgramConfigurationSet");const NT="-transition";class il extends Kn{constructor(l,c){if(super(),this.id=l.id,this.type=l.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,l.type!=="custom"&&(this.metadata=l.metadata,this.minzoom=l.minzoom,this.maxzoom=l.maxzoom,l.type!=="background"&&l.type!=="sky"&&(this.source=l.source,this.sourceLayer=l["source-layer"],this.filter=l.filter),c.layout&&(this._unevaluatedLayout=new vt(c.layout)),c.paint)){this._transitionablePaint=new zt(c.paint);for(const d in l.paint)this.setPaintProperty(d,l.paint[d],{validate:!1});for(const d in l.layout)this.setLayoutProperty(d,l.layout[d],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new st(c.paint)}}getLayoutProperty(l){return l==="visibility"?this.visibility:this._unevaluatedLayout.getValue(l)}setLayoutProperty(l,c,d={}){c!=null&&this._validate(bT,`layers.${this.id}.layout.${l}`,l,c,d)||(l!=="visibility"?this._unevaluatedLayout.setValue(l,c):this.visibility=c)}getPaintProperty(l){return ht(l,NT)?this._transitionablePaint.getTransition(l.slice(0,-NT.length)):this._transitionablePaint.getValue(l)}setPaintProperty(l,c,d={}){if(c!=null&&this._validate(e$,`layers.${this.id}.paint.${l}`,l,c,d))return!1;if(ht(l,NT))return this._transitionablePaint.setTransition(l.slice(0,-NT.length),c||void 0),!1;{const g=this._transitionablePaint._values[l],_=g.value.isDataDriven(),w=g.value;this._transitionablePaint.setValue(l,c),this._handleSpecialPaintPropertyUpdate(l);const C=this._transitionablePaint._values[l].value,R=C.isDataDriven(),k=ht(l,"pattern")||l==="line-dasharray";return R||_||k||this._handleOverridablePaintPropertyUpdate(l,w,C)}}_handleSpecialPaintPropertyUpdate(l){}getProgramIds(){return null}getProgramConfiguration(l){return null}_handleOverridablePaintPropertyUpdate(l,c,d){return!1}isHidden(l){return!!(this.minzoom&&l<this.minzoom)||!!(this.maxzoom&&l>=this.maxzoom)||this.visibility==="none"}updateTransitions(l){this._transitioningPaint=this._transitionablePaint.transitioned(l,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(l,c){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(l,void 0,c)),this.paint=this._transitioningPaint.possiblyEvaluate(l,void 0,c)}serialize(){const l={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(l.layout=l.layout||{},l.layout.visibility=this.visibility),St(l,(c,d)=>!(c===void 0||d==="layout"&&!Object.keys(c).length||d==="paint"&&!Object.keys(c).length))}_validate(l,c,d,g,_={}){return(!_||_.validate!==!1)&&wT(this,l.call(_T,{key:c,layerType:this.type,objectKey:d,value:g,styleSpec:wt,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const l in this.paint._values){const c=this.paint.get(l);if(c instanceof Mt&&_f(c.property.specification)&&(c.value.kind==="source"||c.value.kind==="composite")&&c.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=hg(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}}const Lpe=hr([{name:"a_pos",components:2,type:"Int16"}],4),Npe=hr([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class ki{constructor(l=[]){this.segments=l}prepareSegment(l,c,d,g){let _=this.segments[this.segments.length-1];return l>ki.MAX_VERTEX_ARRAY_LENGTH&&jt(`Max vertices per segment is ${ki.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${l}`),(!_||_.vertexLength+l>ki.MAX_VERTEX_ARRAY_LENGTH||_.sortKey!==g)&&(_={vertexOffset:c.length,primitiveOffset:d.length,vertexLength:0,primitiveLength:0},g!==void 0&&(_.sortKey=g),this.segments.push(_)),_}get(){return this.segments}destroy(){for(const l of this.segments)for(const c in l.vaos)l.vaos[c].destroy()}static simpleSegment(l,c,d,g){return new ki([{vertexOffset:l,primitiveOffset:c,vertexLength:d,primitiveLength:g,vaos:{},sortKey:0}])}}ki.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,nr(ki,"SegmentVector");var Pr=8192;class Af{constructor(l,c){l&&(c?this.setSouthWest(l).setNorthEast(c):l.length===4?this.setSouthWest([l[0],l[1]]).setNorthEast([l[2],l[3]]):this.setSouthWest(l[0]).setNorthEast(l[1]))}setNorthEast(l){return this._ne=l instanceof bn?new bn(l.lng,l.lat):bn.convert(l),this}setSouthWest(l){return this._sw=l instanceof bn?new bn(l.lng,l.lat):bn.convert(l),this}extend(l){const c=this._sw,d=this._ne;let g,_;if(l instanceof bn)g=l,_=l;else{if(!(l instanceof Af))return Array.isArray(l)?l.length===4||l.every(Array.isArray)?this.extend(Af.convert(l)):this.extend(bn.convert(l)):typeof l=="object"&&l!==null&&l.hasOwnProperty("lat")&&(l.hasOwnProperty("lon")||l.hasOwnProperty("lng"))?this.extend(bn.convert(l)):this;if(g=l._sw,_=l._ne,!g||!_)return this}return c||d?(c.lng=Math.min(g.lng,c.lng),c.lat=Math.min(g.lat,c.lat),d.lng=Math.max(_.lng,d.lng),d.lat=Math.max(_.lat,d.lat)):(this._sw=new bn(g.lng,g.lat),this._ne=new bn(_.lng,_.lat)),this}getCenter(){return new bn((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new bn(this.getWest(),this.getNorth())}getSouthEast(){return new bn(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(l){const{lng:c,lat:d}=bn.convert(l);let g=this._sw.lng<=c&&c<=this._ne.lng;return this._sw.lng>this._ne.lng&&(g=this._sw.lng>=c&&c>=this._ne.lng),this._sw.lat<=d&&d<=this._ne.lat&&g}static convert(l){return!l||l instanceof Af?l:new Af(l)}}var BT=1e-6,Pa=typeof Float32Array<"u"?Float32Array:Array;function i5(){var u=new Pa(9);return Pa!=Float32Array&&(u[1]=0,u[2]=0,u[3]=0,u[5]=0,u[6]=0,u[7]=0),u[0]=1,u[4]=1,u[8]=1,u}function o5(u,l,c){var d=l[0],g=l[1],_=l[2],w=l[3],C=l[4],R=l[5],k=l[6],D=l[7],N=l[8],F=c[0],G=c[1],Y=c[2],J=c[3],oe=c[4],ge=c[5],Te=c[6],he=c[7],xe=c[8];return u[0]=F*d+G*w+Y*k,u[1]=F*g+G*C+Y*D,u[2]=F*_+G*R+Y*N,u[3]=J*d+oe*w+ge*k,u[4]=J*g+oe*C+ge*D,u[5]=J*_+oe*R+ge*N,u[6]=Te*d+he*w+xe*k,u[7]=Te*g+he*C+xe*D,u[8]=Te*_+he*R+xe*N,u}function ol(u){return u[0]=1,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=1,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=1,u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1,u}function a$(u,l){var c=l[0],d=l[1],g=l[2],_=l[3],w=l[4],C=l[5],R=l[6],k=l[7],D=l[8],N=l[9],F=l[10],G=l[11],Y=l[12],J=l[13],oe=l[14],ge=l[15],Te=c*C-d*w,he=c*R-g*w,xe=c*k-_*w,Me=d*R-g*C,ke=d*k-_*C,lt=g*k-_*R,it=D*J-N*Y,xt=D*oe-F*Y,Bt=D*ge-G*Y,gt=N*oe-F*J,Et=N*ge-G*J,Rt=F*ge-G*oe,$t=Te*Rt-he*Et+xe*gt+Me*Bt-ke*xt+lt*it;return $t?(u[0]=(C*Rt-R*Et+k*gt)*($t=1/$t),u[1]=(g*Et-d*Rt-_*gt)*$t,u[2]=(J*lt-oe*ke+ge*Me)*$t,u[3]=(F*ke-N*lt-G*Me)*$t,u[4]=(R*Bt-w*Rt-k*xt)*$t,u[5]=(c*Rt-g*Bt+_*xt)*$t,u[6]=(oe*xe-Y*lt-ge*he)*$t,u[7]=(D*lt-F*xe+G*he)*$t,u[8]=(w*Et-C*Bt+k*it)*$t,u[9]=(d*Bt-c*Et-_*it)*$t,u[10]=(Y*ke-J*xe+ge*Te)*$t,u[11]=(N*xe-D*ke-G*Te)*$t,u[12]=(C*xt-w*gt-R*it)*$t,u[13]=(c*gt-d*xt+g*it)*$t,u[14]=(J*he-Y*Me-oe*Te)*$t,u[15]=(D*Me-N*he+F*Te)*$t,u):null}function Ad(u,l,c){var d=l[0],g=l[1],_=l[2],w=l[3],C=l[4],R=l[5],k=l[6],D=l[7],N=l[8],F=l[9],G=l[10],Y=l[11],J=l[12],oe=l[13],ge=l[14],Te=l[15],he=c[0],xe=c[1],Me=c[2],ke=c[3];return u[0]=he*d+xe*C+Me*N+ke*J,u[1]=he*g+xe*R+Me*F+ke*oe,u[2]=he*_+xe*k+Me*G+ke*ge,u[3]=he*w+xe*D+Me*Y+ke*Te,u[4]=(he=c[4])*d+(xe=c[5])*C+(Me=c[6])*N+(ke=c[7])*J,u[5]=he*g+xe*R+Me*F+ke*oe,u[6]=he*_+xe*k+Me*G+ke*ge,u[7]=he*w+xe*D+Me*Y+ke*Te,u[8]=(he=c[8])*d+(xe=c[9])*C+(Me=c[10])*N+(ke=c[11])*J,u[9]=he*g+xe*R+Me*F+ke*oe,u[10]=he*_+xe*k+Me*G+ke*ge,u[11]=he*w+xe*D+Me*Y+ke*Te,u[12]=(he=c[12])*d+(xe=c[13])*C+(Me=c[14])*N+(ke=c[15])*J,u[13]=he*g+xe*R+Me*F+ke*oe,u[14]=he*_+xe*k+Me*G+ke*ge,u[15]=he*w+xe*D+Me*Y+ke*Te,u}function Jw(u,l,c){var d,g,_,w,C,R,k,D,N,F,G,Y,J=c[0],oe=c[1],ge=c[2];return l===u?(u[12]=l[0]*J+l[4]*oe+l[8]*ge+l[12],u[13]=l[1]*J+l[5]*oe+l[9]*ge+l[13],u[14]=l[2]*J+l[6]*oe+l[10]*ge+l[14],u[15]=l[3]*J+l[7]*oe+l[11]*ge+l[15]):(g=l[1],_=l[2],w=l[3],C=l[4],R=l[5],k=l[6],D=l[7],N=l[8],F=l[9],G=l[10],Y=l[11],u[0]=d=l[0],u[1]=g,u[2]=_,u[3]=w,u[4]=C,u[5]=R,u[6]=k,u[7]=D,u[8]=N,u[9]=F,u[10]=G,u[11]=Y,u[12]=d*J+C*oe+N*ge+l[12],u[13]=g*J+R*oe+F*ge+l[13],u[14]=_*J+k*oe+G*ge+l[14],u[15]=w*J+D*oe+Y*ge+l[15]),u}function Id(u,l,c){var d=c[0],g=c[1],_=c[2];return u[0]=l[0]*d,u[1]=l[1]*d,u[2]=l[2]*d,u[3]=l[3]*d,u[4]=l[4]*g,u[5]=l[5]*g,u[6]=l[6]*g,u[7]=l[7]*g,u[8]=l[8]*_,u[9]=l[9]*_,u[10]=l[10]*_,u[11]=l[11]*_,u[12]=l[12],u[13]=l[13],u[14]=l[14],u[15]=l[15],u}function s$(u,l,c){var d=Math.sin(c),g=Math.cos(c),_=l[4],w=l[5],C=l[6],R=l[7],k=l[8],D=l[9],N=l[10],F=l[11];return l!==u&&(u[0]=l[0],u[1]=l[1],u[2]=l[2],u[3]=l[3],u[12]=l[12],u[13]=l[13],u[14]=l[14],u[15]=l[15]),u[4]=_*g+k*d,u[5]=w*g+D*d,u[6]=C*g+N*d,u[7]=R*g+F*d,u[8]=k*g-_*d,u[9]=D*g-w*d,u[10]=N*g-C*d,u[11]=F*g-R*d,u}function jT(u,l,c){var d=Math.sin(c),g=Math.cos(c),_=l[0],w=l[1],C=l[2],R=l[3],k=l[8],D=l[9],N=l[10],F=l[11];return l!==u&&(u[4]=l[4],u[5]=l[5],u[6]=l[6],u[7]=l[7],u[12]=l[12],u[13]=l[13],u[14]=l[14],u[15]=l[15]),u[0]=_*g-k*d,u[1]=w*g-D*d,u[2]=C*g-N*d,u[3]=R*g-F*d,u[8]=_*d+k*g,u[9]=w*d+D*g,u[10]=C*d+N*g,u[11]=R*d+F*g,u}function a5(u,l){return u[0]=l[0],u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=l[1],u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=l[2],u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1,u}function s5(u,l,c){var d,g,_,w=c[0],C=c[1],R=c[2],k=Math.hypot(w,C,R);return k<BT?null:(w*=k=1/k,C*=k,R*=k,d=Math.sin(l),g=Math.cos(l),u[0]=w*w*(_=1-g)+g,u[1]=C*w*_+R*d,u[2]=R*w*_-C*d,u[3]=0,u[4]=w*C*_-R*d,u[5]=C*C*_+g,u[6]=R*C*_+w*d,u[7]=0,u[8]=w*R*_+C*d,u[9]=C*R*_-w*d,u[10]=R*R*_+g,u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1,u)}Math.hypot||(Math.hypot=function(){for(var u=0,l=arguments.length;l--;)u+=arguments[l]*arguments[l];return Math.sqrt(u)});var Bpe=Ad;function l$(){var u=new Pa(3);return Pa!=Float32Array&&(u[0]=0,u[1]=0,u[2]=0),u}function l5(u){var l=new Pa(3);return l[0]=u[0],l[1]=u[1],l[2]=u[2],l}function Qw(u){return Math.hypot(u[0],u[1],u[2])}function Cg(u,l,c){var d=new Pa(3);return d[0]=u,d[1]=l,d[2]=c,d}function zu(u,l,c){return u[0]=l[0]+c[0],u[1]=l[1]+c[1],u[2]=l[2]+c[2],u}function u$(u,l,c){return u[0]=l[0]-c[0],u[1]=l[1]-c[1],u[2]=l[2]-c[2],u}function u5(u,l,c){return u[0]=l[0]*c[0],u[1]=l[1]*c[1],u[2]=l[2]*c[2],u}function e0(u,l,c){return u[0]=Math.min(l[0],c[0]),u[1]=Math.min(l[1],c[1]),u[2]=Math.min(l[2],c[2]),u}function t0(u,l,c){return u[0]=Math.max(l[0],c[0]),u[1]=Math.max(l[1],c[1]),u[2]=Math.max(l[2],c[2]),u}function qa(u,l,c){return u[0]=l[0]*c,u[1]=l[1]*c,u[2]=l[2]*c,u}function r0(u,l,c,d){return u[0]=l[0]+c[0]*d,u[1]=l[1]+c[1]*d,u[2]=l[2]+c[2]*d,u}function Go(u,l){var c=l[0],d=l[1],g=l[2],_=c*c+d*d+g*g;return _>0&&(_=1/Math.sqrt(_)),u[0]=l[0]*_,u[1]=l[1]*_,u[2]=l[2]*_,u}function Cs(u,l){return u[0]*l[0]+u[1]*l[1]+u[2]*l[2]}function c$(u,l,c){var d=l[0],g=l[1],_=l[2],w=c[0],C=c[1],R=c[2];return u[0]=g*R-_*C,u[1]=_*w-d*R,u[2]=d*C-g*w,u}function Ci(u,l,c){var d=l[0],g=l[1],_=l[2],w=c[3]*d+c[7]*g+c[11]*_+c[15];return u[0]=(c[0]*d+c[4]*g+c[8]*_+c[12])/(w=w||1),u[1]=(c[1]*d+c[5]*g+c[9]*_+c[13])/w,u[2]=(c[2]*d+c[6]*g+c[10]*_+c[14])/w,u}function c5(u,l,c){var d=c[0],g=c[1],_=c[2],w=l[0],C=l[1],R=l[2],k=g*R-_*C,D=_*w-d*R,N=d*C-g*w,F=g*N-_*D,G=_*k-d*N,Y=d*D-g*k,J=2*c[3];return D*=J,N*=J,G*=2,Y*=2,u[0]=w+(k*=J)+(F*=2),u[1]=C+D+G,u[2]=R+N+Y,u}var n0,al=u$,jpe=u5,Fpe=Qw;function f5(u,l,c){return u[0]=l[0]*c,u[1]=l[1]*c,u[2]=l[2]*c,u[3]=l[3]*c,u}function h5(u,l){var c=l[0],d=l[1],g=l[2],_=l[3],w=c*c+d*d+g*g+_*_;return w>0&&(w=1/Math.sqrt(w)),u[0]=c*w,u[1]=d*w,u[2]=g*w,u[3]=_*w,u}function Md(u,l,c){var d=l[0],g=l[1],_=l[2],w=l[3];return u[0]=c[0]*d+c[4]*g+c[8]*_+c[12]*w,u[1]=c[1]*d+c[5]*g+c[9]*_+c[13]*w,u[2]=c[2]*d+c[6]*g+c[10]*_+c[14]*w,u[3]=c[3]*d+c[7]*g+c[11]*_+c[15]*w,u}function d5(){var u=new Pa(4);return Pa!=Float32Array&&(u[0]=0,u[1]=0,u[2]=0),u[3]=1,u}function p5(u){return u[0]=0,u[1]=0,u[2]=0,u[3]=1,u}function m5(u,l,c){c*=.5;var d=l[0],g=l[1],_=l[2],w=l[3],C=Math.sin(c),R=Math.cos(c);return u[0]=d*R+w*C,u[1]=g*R+_*C,u[2]=_*R-g*C,u[3]=w*R-d*C,u}function g5(u,l,c){c*=.5;var d=l[0],g=l[1],_=l[2],w=l[3],C=Math.sin(c),R=Math.cos(c);return u[0]=d*R-_*C,u[1]=g*R+w*C,u[2]=_*R+d*C,u[3]=w*R-g*C,u}l$(),n0=new Pa(4),Pa!=Float32Array&&(n0[0]=0,n0[1]=0,n0[2]=0,n0[3]=0);var zpe=h5;l$(),Cg(1,0,0),Cg(0,1,0),d5(),d5(),i5();const Hpe=hr([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:y5}=Hpe,v5=hr([{name:"a_pos_3",components:3,type:"Int16"}]);var i0=hr([{name:"a_pos",type:"Int16",components:2}]);class f${constructor(l,c){this.pos=l,this.dir=c}intersectsPlane(l,c,d){const g=Cs(c,this.dir);if(Math.abs(g)<1e-6)return!1;const _=((l[0]-this.pos[0])*c[0]+(l[1]-this.pos[1])*c[1]+(l[2]-this.pos[2])*c[2])/g;return d[0]=this.pos[0]+this.dir[0]*_,d[1]=this.pos[1]+this.dir[1]*_,d[2]=this.pos[2]+this.dir[2]*_,!0}closestPointOnSphere(l,c,d){if(function(G,Y){var J=G[0],oe=G[1],ge=G[2],Te=Y[0],he=Y[1],xe=Y[2];return Math.abs(J-Te)<=BT*Math.max(1,Math.abs(J),Math.abs(Te))&&Math.abs(oe-he)<=BT*Math.max(1,Math.abs(oe),Math.abs(he))&&Math.abs(ge-xe)<=BT*Math.max(1,Math.abs(ge),Math.abs(xe))}(this.pos,l)||c===0)return d[0]=d[1]=d[2]=0,!1;const[g,_,w]=this.dir,C=this.pos[0]-l[0],R=this.pos[1]-l[1],k=this.pos[2]-l[2],D=g*g+_*_+w*w,N=2*(C*g+R*_+k*w),F=N*N-4*D*(C*C+R*R+k*k-c*c);if(F<0){const G=Math.max(-N/2,0),Y=C+g*G,J=R+_*G,oe=k+w*G,ge=Math.hypot(Y,J,oe);return d[0]=Y*c/ge,d[1]=J*c/ge,d[2]=oe*c/ge,!1}{const G=(-N-Math.sqrt(F))/(2*D);if(G<0){const Y=Math.hypot(C,R,k);return d[0]=C*c/Y,d[1]=R*c/Y,d[2]=k*c/Y,!1}return d[0]=C+g*G,d[1]=R+_*G,d[2]=k+w*G,!0}}}class h${constructor(l,c,d,g,_){this.TL=l,this.TR=c,this.BR=d,this.BL=g,this.horizon=_}static fromInvProjectionMatrix(l,c,d){const g=[-1,1,1],_=[1,1,1],w=[1,-1,1],C=[-1,-1,1],R=Ci(g,g,l),k=Ci(_,_,l),D=Ci(w,w,l),N=Ci(C,C,l);return new h$(R,k,D,N,c/d)}}class d${constructor(l,c){this.points=l,this.planes=c}static fromInvProjectionMatrix(l,c,d,g){const _=Math.pow(2,d),w=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(R=>{const k=Md([],R,l),D=1/k[3]/c*_;return function(N,F,G){return N[0]=F[0]*G[0],N[1]=F[1]*G[1],N[2]=F[2]*G[2],N[3]=F[3]*G[3],N}(k,k,[D,D,g?1/k[3]:D,D])}),C=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(R=>{const k=Go([],c$([],al([],w[R[0]],w[R[1]]),al([],w[R[2]],w[R[1]]))),D=-Cs(k,w[R[1]]);return k.concat(D)});return new d$(w,C)}}class Yo{static fromPoints(l){const c=[1/0,1/0,1/0],d=[-1/0,-1/0,-1/0];for(const g of l)e0(c,c,g),t0(d,d,g);return new Yo(c,d)}static applyTransform(l,c){const d=l.getCorners();for(let g=0;g<d.length;++g)Ci(d[g],d[g],c);return Yo.fromPoints(d)}constructor(l,c){this.min=l,this.max=c,this.center=qa([],zu([],this.min,this.max),.5)}quadrant(l){const c=[l%2==0,l<2],d=l5(this.min),g=l5(this.max);for(let _=0;_<c.length;_++)d[_]=c[_]?this.min[_]:this.center[_],g[_]=c[_]?this.center[_]:this.max[_];return g[2]=this.max[2],new Yo(d,g)}distanceX(l){return Math.max(Math.min(this.max[0],l[0]),this.min[0])-l[0]}distanceY(l){return Math.max(Math.min(this.max[1],l[1]),this.min[1])-l[1]}distanceZ(l){return Math.max(Math.min(this.max[2],l[2]),this.min[2])-l[2]}getCorners(){const l=this.min,c=this.max;return[[l[0],l[1],l[2]],[c[0],l[1],l[2]],[c[0],c[1],l[2]],[l[0],c[1],l[2]],[l[0],l[1],c[2]],[c[0],l[1],c[2]],[c[0],c[1],c[2]],[l[0],c[1],c[2]]]}intersects(l){const c=this.getCorners();let d=!0;for(let g=0;g<l.planes.length;g++){const _=l.planes[g];let w=0;for(let C=0;C<c.length;C++)w+=Cs(_,c[C])+_[3]>=0;if(w===0)return 0;w!==c.length&&(d=!1)}if(d)return 2;for(let g=0;g<3;g++){let _=Number.MAX_VALUE,w=-Number.MAX_VALUE;for(let C=0;C<l.points.length;C++){const R=l.points[C][g]-this.min[g];_=Math.min(_,R),w=Math.max(w,R)}if(w<0||_>this.max[g]-this.min[g])return 0}return 1}}const Hl=Pr/Math.PI/2,$d=64,o0=[$d,32,16],Es=-Hl,Ts=Hl,Vpe=[new Yo([Es,Es,Es],[Ts,Ts,Ts]),new Yo([Es,Es,Es],[0,0,Ts]),new Yo([0,Es,Es],[Ts,0,Ts]),new Yo([Es,0,Es],[0,Ts,Ts]),new Yo([0,0,Es],[Ts,Ts,Ts])];function FT(u){return u*Hl/l0}function _5(u,l,c,d=!0){const g=qa([],u._camera.position,u.worldSize),_=[l,c,1,1];Md(_,_,u.pixelMatrixInverse),f5(_,_,1/_[3]);const w=Go([],al([],_,g)),C=u.globeMatrix,R=[C[12],C[13],C[14]],k=al([],R,g),D=Qw(k),N=Go([],k),F=u.worldSize/(2*Math.PI),G=Cs(N,w),Y=Math.asin(F/D);if(Y<Math.acos(G)){if(!d)return null;const Bt=[],gt=[];qa(Bt,w,D/G),Go(gt,al(gt,Bt,k)),Go(w,zu(w,k,qa(w,gt,Math.tan(Y)*D)))}const J=[];new f$(g,w).closestPointOnSphere(R,F,J);const oe=Go([],se(C,0)),ge=Go([],se(C,1)),Te=Go([],se(C,2)),he=Cs(oe,J),xe=Cs(ge,J),Me=Cs(Te,J),ke=ze(Math.asin(-xe/F));let lt=ze(Math.atan2(he,Me));lt=u.center.lng+function(Bt,gt){const Et=(gt-Bt+180)%360-180;return Et<-180?Et+360:Et}(u.center.lng,lt);const it=Ul(lt),xt=Ce(Wl(ke),0,1);return new Rg(it,xt)}class Upe{constructor(l,c,d){this.a=al([],l,d),this.b=al([],c,d),this.center=d;const g=Go([],this.a),_=Go([],this.b);this.angle=Math.acos(Cs(g,_))}}function p$(u,l){if(u.angle===0)return null;let c;return c=u.a[l]===0?1/u.angle*.5*Math.PI:1/u.angle*Math.atan(u.b[l]/u.a[l]/Math.sin(u.angle)-1/Math.tan(u.angle)),c<0||c>1?null:function(d,g,_,w){const C=Math.sin(_);return d*(Math.sin((1-w)*_)/C)+g*(Math.sin(w*_)/C)}(u.a[l],u.b[l],u.angle,Ce(c,0,1))+u.center[l]}function Vl(u){if(u.z<=1)return Vpe[u.z+2*u.y+u.x];const l=m$(zT(u));return Yo.fromPoints(l)}function Dd(u,l,c){return qa(u,u,1-c),r0(u,u,l,c)}function b5(u,l){const c=Og(l.zoom);if(c===0)return Vl(u);const d=zT(u),g=m$(d),_=Ul(d.getWest())*l.worldSize,w=Ul(d.getEast())*l.worldSize,C=Wl(d.getNorth())*l.worldSize,R=Wl(d.getSouth())*l.worldSize,k=[_,C,0],D=[w,C,0],N=[_,R,0],F=[w,R,0],G=a$([],l.globeMatrix);return Ci(k,k,G),Ci(D,D,G),Ci(N,N,G),Ci(F,F,G),g[0]=Dd(g[0],N,c),g[1]=Dd(g[1],F,c),g[2]=Dd(g[2],D,c),g[3]=Dd(g[3],k,c),Yo.fromPoints(g)}function w5(u,l,c){for(const d of u)Ci(d,d,l),qa(d,d,c)}function Wpe(u,l,c){const d=l/u.worldSize,g=u.globeMatrix;if(c.z<=1){const it=Vl(c).getCorners();return w5(it,g,d),Yo.fromPoints(it)}const _=zT(c),w=m$(_);w5(w,g,d);const C=Number.MAX_VALUE,R=[-C,-C,-C],k=[C,C,C];if(_.contains(u.center)){for(const Bt of w)e0(k,k,Bt),t0(R,R,Bt);R[2]=0;const it=u.point,xt=[it.x*d,it.y*d,0];return e0(k,k,xt),t0(R,R,xt),new Yo(k,R)}const D=[g[12]*d,g[13]*d,g[14]*d],N=_.getCenter(),F=Ce(u.center.lat,-To,To),G=Ce(N.lat,-To,To),Y=Ul(u.center.lng),J=Wl(F);let oe=Y-Ul(N.lng);const ge=J-Wl(G);oe>.5?oe-=1:oe<-.5&&(oe+=1);let Te=0;Math.abs(oe)>Math.abs(ge)?Te=oe>=0?1:3:(Te=ge>=0?0:2,r0(D,D,[g[4]*d,g[5]*d,g[6]*d],-Math.sin(Le(ge>=0?_.getSouth():_.getNorth()))*Hl));const he=w[Te],xe=w[(Te+1)%4],Me=new Upe(he,xe,D),ke=[p$(Me,0)||he[0],p$(Me,1)||he[1],p$(Me,2)||he[2]],lt=Og(u.zoom);if(lt>0){const it=function({x:Bt,y:gt,z:Et},Rt,$t,Ft,yt){const Yt=1/(1<<Et);let Er=Bt*Yt,er=Er+Yt,lr=gt*Yt,qt=lr+Yt,Rr=0;const Jr=(Er+er)/2-Ft;return Jr>.5?Rr=-1:Jr<-.5&&(Rr=1),Er=((Er+Rr)*Rt-(Ft*=Rt))*$t+Ft,er=((er+Rr)*Rt-Ft)*$t+Ft,lr=(lr*Rt-(yt*=Rt))*$t+yt,qt=(qt*Rt-yt)*$t+yt,[[Er,qt,0],[er,qt,0],[er,lr,0],[Er,lr,0]]}(c,l,u._pixelsPerMercatorPixel,Y,J);for(let Bt=0;Bt<w.length;Bt++)Dd(w[Bt],it[Bt],lt);const xt=zu([],it[Te],it[(Te+1)%4]);qa(xt,xt,.5),Dd(ke,xt,lt)}for(const it of w)e0(k,k,it),t0(R,R,it);return k[2]=Math.min(he[2],xe[2]),e0(k,k,ke),t0(R,R,ke),new Yo(k,R)}function zT({x:u,y:l,z:c}){const d=1/(1<<c),g=new bn(Xa(u*d),Eo((l+1)*d)),_=new bn(Xa((u+1)*d),Eo(l*d));return new Af(g,_)}function m$(u){const l=Le(u.getNorth()),c=Le(u.getSouth()),d=Math.cos(l),g=Math.cos(c),_=Math.sin(l),w=Math.sin(c),C=u.getWest(),R=u.getEast();return[Eg(g,w,C),Eg(g,w,R),Eg(d,_,R),Eg(d,_,C)]}function Eg(u,l,c,d=Hl){return c=Le(c),[u*Math.sin(c)*d,-l*d,u*Math.cos(c)*d]}function Tg(u,l,c){return Eg(Math.cos(Le(u)),Math.sin(Le(u)),l,c)}function a0(u,l,c,d){const g=1<<c.z,_=(u/Pr+c.x)/g;return Tg(Eo((l/Pr+c.y)/g),Xa(_),d)}function HT({min:u,max:l}){return 16383/Math.max(l[0]-u[0],l[1]-u[1],l[2]-u[2])}const S5=new Float64Array(16);function s0(u){const l=HT(u),c=a5(S5,[l,l,l]);return Jw(c,c,((d=[])[0]=-(g=u.min)[0],d[1]=-g[1],d[2]=-g[2],d));var d,g}function g$(u){const l=(d=u.min,(c=S5)[0]=1,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=1,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=1,c[11]=0,c[12]=d[0],c[13]=d[1],c[14]=d[2],c[15]=1,c);var c,d;const g=1/HT(u);return Id(l,l,[g,g,g])}function x5(u,l,c,d,g){const _=function(R){const k=Pr/(2*Math.PI);return R/(2*Math.PI)/k}(c),w=[u,l,-c/(2*Math.PI)],C=ol(new Float64Array(16));return Jw(C,C,w),Id(C,C,[_,_,_]),s$(C,C,Le(-g)),jT(C,C,Le(-d)),C}function Og(u){return pt(5,6,u)}function C5(u,l){const c=Tg(l.lat,l.lng),d=function(Y){const J=Tg(Y._center.lat,Y._center.lng);let oe=c$([],Cg(0,1,0),J);const ge=s5([],-Y.angle,J);oe=Ci(oe,oe,ge),s5(ge,-Y._pitch,oe);const Te=Go([],J);return qa(Te,Te,FT(Y.cameraToCenterDistance/Y.pixelsPerMeter)),Ci(Te,Te,ge),zu([],J,Te)}(u);return w=(g=u$([],d,c))[0],C=g[1],R=g[2],k=(_=c)[0],D=_[1],N=_[2],G=(F=Math.sqrt(w*w+C*C+R*R)*Math.sqrt(k*k+D*D+N*N))&&Cs(g,_)/F,Math.acos(Math.min(Math.max(G,-1),1));var g,_,w,C,R,k,D,N,F,G}function y$(u,l){return C5(u,l)>Math.PI/2*1.01}const E5=Le(85),Gpe=Math.cos(E5),Ype=Math.sin(E5),l0=63710088e-1,T5=2*Math.PI*l0;class bn{constructor(l,c){if(isNaN(l)||isNaN(c))throw new Error(`Invalid LngLat object: (${l}, ${c})`);if(this.lng=+l,this.lat=+c,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new bn(Ct(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(l){const c=Math.PI/180,d=this.lat*c,g=l.lat*c,_=Math.sin(d)*Math.sin(g)+Math.cos(d)*Math.cos(g)*Math.cos((l.lng-this.lng)*c);return l0*Math.acos(Math.min(_,1))}toBounds(l=0){const c=360*l/40075017,d=c/Math.cos(Math.PI/180*this.lat);return new Af(new bn(this.lng-d,this.lat-c),new bn(this.lng+d,this.lat+c))}toEcef(l){const c=FT(l);return Tg(this.lat,this.lng,Hl+c)}static convert(l){if(l instanceof bn)return l;if(Array.isArray(l)&&(l.length===2||l.length===3))return new bn(Number(l[0]),Number(l[1]));if(!Array.isArray(l)&&typeof l=="object"&&l!==null)return new bn(Number("lng"in l?l.lng:l.lon),Number(l.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}function v$(u){return T5*Math.cos(u*Math.PI/180)}function Ul(u){return(180+u)/360}function Wl(u){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+u*Math.PI/360)))/360}function sl(u,l){return u/v$(l)}function Xa(u){return 360*u-180}function Eo(u){return 360/Math.PI*Math.atan(Math.exp((180-360*u)*Math.PI/180))-90}function O5(u,l){return u*v$(Eo(l))}const To=85.051129;function R5(u){return 1/Math.cos(u*Math.PI/180)}class Rg{constructor(l,c,d=0){this.x=+l,this.y=+c,this.z=+d}static fromLngLat(l,c=0){const d=bn.convert(l);return new Rg(Ul(d.lng),Wl(d.lat),sl(c,d.lat))}toLngLat(){return new bn(Xa(this.x),Eo(this.y))}toAltitude(){return O5(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/T5*R5(Eo(this.y))}}function _$(u,l,c,d,g,_,w,C,R){const k=(l+d)/2,D=(c+g)/2,N=new q(k,D);C(N),function(F,G,Y,J,oe,ge){const Te=Y-oe,he=J-ge;return Math.abs((J-G)*Te-(Y-F)*he)/Math.hypot(Te,he)}(N.x,N.y,_.x,_.y,w.x,w.y)>=R?(_$(u,l,c,k,D,_,N,C,R),_$(u,k,D,d,g,N,w,C,R)):u.push(w)}function k5(u,l,c){let d=u[0],g=d.x,_=d.y;l(d);const w=[d];for(let C=1;C<u.length;C++){const R=u[C],{x:k,y:D}=R;l(R),_$(w,g,_,k,D,d,R,l,c),g=k,_=D,d=R}return w}function b$(u,l,c,d){if(d(l,c)){const g=l.add(c)._mult(.5);b$(u,l,g,d),b$(u,g,c,d)}else u.push(c)}function Kpe(u,l){let c=u[0];const d=[c];for(let g=1;g<u.length;g++){const _=u[g];b$(d,c,_,l),c=_}return d}const w$=Math.pow(2,14)-1,P5=-w$-1;function qpe(u,l){const c=Math.round(u.x*l),d=Math.round(u.y*l);return u.x=Ce(c,P5,w$),u.y=Ce(d,P5,w$),(c<u.x||c>u.x+1||d<u.y||d>u.y+1)&&jt("Geometry exceeds allowed extent, reduce your vector tile buffer size"),u}function Hu(u,l,c){const d=u.loadGeometry(),g=u.extent,_=Pr/g;if(l&&c&&c.projection.isReprojectedInTileSpace){const w=1<<l.z,{scale:C,x:R,y:k,projection:D}=c,N=F=>{const G=Xa((l.x+F.x/g)/w),Y=Eo((l.y+F.y/g)/w),J=D.project(G,Y);F.x=(J.x*C-R)*g,F.y=(J.y*C-k)*g};for(let F=0;F<d.length;F++)if(u.type!==1)d[F]=k5(d[F],N,1);else{const G=[];for(const Y of d[F])Y.x<0||Y.x>=g||Y.y<0||Y.y>=g||(N(Y),G.push(Y));d[F]=G}}for(const w of d)for(const C of w)qpe(C,_);return d}function Ld(u,l){return{type:u.type,id:u.id,properties:u.properties,geometry:l?Hu(u):[]}}function VT(u,l,c,d,g){u.emplaceBack(2*l+(d+1)/2,2*c+(g+1)/2)}function UT(u,l,c){u.emplaceBack(l.x,l.y,l.z,c[0]*16384,c[1]*16384,c[2]*16384)}class S${constructor(l){this.zoom=l.zoom,this.overscaling=l.overscaling,this.layers=l.layers,this.layerIds=this.layers.map(c=>c.id),this.index=l.index,this.hasPattern=!1,this.projection=l.projection,this.layoutVertexArray=new _r,this.indexArray=new Co,this.segments=new ki,this.programConfigurations=new Pd(l.layers,l.zoom),this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id)}populate(l,c,d,g){const _=this.layers[0],w=[];let C=null;_.type==="circle"&&(C=_.layout.get("circle-sort-key"));for(const{feature:k,id:D,index:N,sourceLayerIndex:F}of l){const G=this.layers[0]._featureFilter.needGeometry,Y=Ld(k,G);if(!this.layers[0]._featureFilter.filter(new Ze(this.zoom),Y,d))continue;const J=C?C.evaluate(Y,{},d):void 0,oe={id:D,properties:k.properties,type:k.type,sourceLayerIndex:F,index:N,geometry:G?Y.geometry:Hu(k,d,g),patterns:{},sortKey:J};w.push(oe)}C&&w.sort((k,D)=>k.sortKey-D.sortKey);let R=null;g.projection.name==="globe"&&(this.globeExtVertexArray=new Ka,R=g.projection);for(const k of w){const{geometry:D,index:N,sourceLayerIndex:F}=k,G=l[N].feature;this.addFeature(k,D,N,c.availableImages,d,R),c.featureIndex.insert(G,D,N,F,this.index)}}update(l,c,d,g){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(l,c,this.stateDependentLayers,d,g)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(l){this.uploaded||(this.layoutVertexBuffer=l.createVertexBuffer(this.layoutVertexArray,Lpe.members),this.indexBuffer=l.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=l.createVertexBuffer(this.globeExtVertexArray,Npe.members))),this.programConfigurations.upload(l),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(l,c,d,g,_,w){for(const C of c)for(const R of C){const k=R.x,D=R.y;if(k<0||k>=Pr||D<0||D>=Pr)continue;if(w){const G=w.projectTilePoint(k,D,_),Y=w.upVector(_,k,D),J=this.globeExtVertexArray;UT(J,G,Y),UT(J,G,Y),UT(J,G,Y),UT(J,G,Y)}const N=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,l.sortKey),F=N.vertexLength;VT(this.layoutVertexArray,k,D,-1,-1),VT(this.layoutVertexArray,k,D,1,-1),VT(this.layoutVertexArray,k,D,1,1),VT(this.layoutVertexArray,k,D,-1,1),this.indexArray.emplaceBack(F,F+1,F+2),this.indexArray.emplaceBack(F,F+2,F+3),N.vertexLength+=4,N.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,l,d,{},g,_)}}function A5(u,l){for(let c=0;c<u.length;c++)if(Nd(l,u[c]))return!0;for(let c=0;c<l.length;c++)if(Nd(u,l[c]))return!0;return!!x$(u,l)}function Xpe(u,l,c){return!!Nd(u,l)||!!C$(l,u,c)}function I5(u,l){if(u.length===1)return $5(l,u[0]);for(let c=0;c<l.length;c++){const d=l[c];for(let g=0;g<d.length;g++)if(Nd(u,d[g]))return!0}for(let c=0;c<u.length;c++)if($5(l,u[c]))return!0;for(let c=0;c<l.length;c++)if(x$(u,l[c]))return!0;return!1}function Zpe(u,l,c){if(u.length>1){if(x$(u,l))return!0;for(let d=0;d<l.length;d++)if(C$(l[d],u,c))return!0}for(let d=0;d<u.length;d++)if(C$(u[d],l,c))return!0;return!1}function x$(u,l){if(u.length===0||l.length===0)return!1;for(let c=0;c<u.length-1;c++){const d=u[c],g=u[c+1];for(let _=0;_<l.length-1;_++)if(Jpe(d,g,l[_],l[_+1]))return!0}return!1}function Jpe(u,l,c,d){return Kt(u,c,d)!==Kt(l,c,d)&&Kt(u,l,c)!==Kt(u,l,d)}function C$(u,l,c){const d=c*c;if(l.length===1)return u.distSqr(l[0])<d;for(let g=1;g<l.length;g++)if(M5(u,l[g-1],l[g])<d)return!0;return!1}function M5(u,l,c){const d=l.distSqr(c);if(d===0)return u.distSqr(l);const g=((u.x-l.x)*(c.x-l.x)+(u.y-l.y)*(c.y-l.y))/d;return u.distSqr(g<0?l:g>1?c:c.sub(l)._mult(g)._add(l))}function $5(u,l){let c,d,g,_=!1;for(let w=0;w<u.length;w++){c=u[w];for(let C=0,R=c.length-1;C<c.length;R=C++)d=c[C],g=c[R],d.y>l.y!=g.y>l.y&&l.x<(g.x-d.x)*(l.y-d.y)/(g.y-d.y)+d.x&&(_=!_)}return _}function Nd(u,l){let c=!1;for(let d=0,g=u.length-1;d<u.length;g=d++){const _=u[d],w=u[g];_.y>l.y!=w.y>l.y&&l.x<(w.x-_.x)*(l.y-_.y)/(w.y-_.y)+_.x&&(c=!c)}return c}function D5(u,l,c,d,g){for(const w of u)if(l<=w.x&&c<=w.y&&d>=w.x&&g>=w.y)return!0;const _=[new q(l,c),new q(l,g),new q(d,g),new q(d,c)];if(u.length>2){for(const w of _)if(Nd(u,w))return!0}for(let w=0;w<u.length-1;w++)if(Qpe(u[w],u[w+1],_))return!0;return!1}function Qpe(u,l,c){const d=c[0],g=c[2];if(u.x<d.x&&l.x<d.x||u.x>g.x&&l.x>g.x||u.y<d.y&&l.y<d.y||u.y>g.y&&l.y>g.y)return!1;const _=Kt(u,l,c[0]);return _!==Kt(u,l,c[1])||_!==Kt(u,l,c[2])||_!==Kt(u,l,c[3])}function kg(u,l,c){const d=l.paint.get(u).value;return d.kind==="constant"?d.value:c.programConfigurations.get(l.id).getMaxValue(u)}function WT(u){return Math.sqrt(u[0]*u[0]+u[1]*u[1])}function L5(u,l,c,d,g){if(!l[0]&&!l[1])return u;const _=q.convert(l)._mult(g);c==="viewport"&&_._rotate(-d);const w=[];for(let C=0;C<u.length;C++)w.push(u[C].sub(_));return w}function N5(u,l,c,d){const g=q.convert(u)._mult(d);return l==="viewport"&&g._rotate(-c),g}nr(S$,"CircleBucket",{omit:["layers"]});const eme=new Lt({"circle-sort-key":new dt(wt.layout_circle["circle-sort-key"])});var tme={paint:new Lt({"circle-radius":new dt(wt.paint_circle["circle-radius"]),"circle-color":new dt(wt.paint_circle["circle-color"]),"circle-blur":new dt(wt.paint_circle["circle-blur"]),"circle-opacity":new dt(wt.paint_circle["circle-opacity"]),"circle-translate":new Ke(wt.paint_circle["circle-translate"]),"circle-translate-anchor":new Ke(wt.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Ke(wt.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Ke(wt.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new dt(wt.paint_circle["circle-stroke-width"]),"circle-stroke-color":new dt(wt.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new dt(wt.paint_circle["circle-stroke-opacity"])}),layout:eme};function B5(u,l,c,d,g,_,w,C,R){if(_&&u.queryGeometry.isAboveHorizon)return!1;_&&(R*=u.pixelToTileUnitsFactor);const k=u.tileID.canonical,D=c.projection.upVectorScale(k,c.center.lat,c.worldSize).metersToTile;for(const N of l)for(const F of N){const G=F.add(C),Y=g&&c.elevation?c.elevation.exaggeration()*g.getElevationAt(G.x,G.y,!0):0,J=c.projection.projectTilePoint(G.x,G.y,k);if(Y>0){const he=c.projection.upVector(k,G.x,G.y);J.x+=he[0]*D*Y,J.y+=he[1]*D*Y,J.z+=he[2]*D*Y}const oe=_?G:rme(J.x,J.y,J.z,d),ge=_?u.tilespaceRays.map(he=>ime(he,Y)):u.queryGeometry.screenGeometry,Te=Md([],[J.x,J.y,J.z,1],d);if(!w&&_?R*=Te[3]/c.cameraToCenterDistance:w&&!_&&(R*=c.cameraToCenterDistance/Te[3]),_){const he=Eo((F.y/Pr+k.y)/(1<<k.z));R/=c.projection.pixelsPerMeter(he,1)/sl(1,he)}if(Xpe(ge,oe,R))return!0}return!1}function rme(u,l,c,d){const g=Md([],[u,l,c,1],d);return new q(g[0]/g[3],g[1]/g[3])}const j5=Cg(0,0,0),nme=Cg(0,0,1);function ime(u,l){const c=l$();return j5[2]=l,u.intersectsPlane(j5,nme,c),new q(c[0],c[1])}class F5 extends S${}function z5(u,{width:l,height:c},d,g){if(g){if(g instanceof Uint8ClampedArray)g=new Uint8Array(g.buffer);else if(g.length!==l*c*d)throw new RangeError("mismatched image size")}else g=new Uint8Array(l*c*d);return u.width=l,u.height=c,u.data=g,u}function H5(u,l,c){const{width:d,height:g}=l;d===u.width&&g===u.height||(E$(u,l,{x:0,y:0},{x:0,y:0},{width:Math.min(u.width,d),height:Math.min(u.height,g)},c),u.width=d,u.height=g,u.data=l.data)}function E$(u,l,c,d,g,_){if(g.width===0||g.height===0)return l;if(g.width>u.width||g.height>u.height||c.x>u.width-g.width||c.y>u.height-g.height)throw new RangeError("out of range source coordinates for image copy");if(g.width>l.width||g.height>l.height||d.x>l.width-g.width||d.y>l.height-g.height)throw new RangeError("out of range destination coordinates for image copy");const w=u.data,C=l.data;for(let R=0;R<g.height;R++){const k=((c.y+R)*u.width+c.x)*_,D=((d.y+R)*l.width+d.x)*_;for(let N=0;N<g.width*_;N++)C[D+N]=w[k+N]}return l}nr(F5,"HeatmapBucket",{omit:["layers"]});class Vu{constructor(l,c){z5(this,l,1,c)}resize(l){H5(this,new Vu(l),1)}clone(){return new Vu({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(l,c,d,g,_){E$(l,c,d,g,_,1)}}class Aa{constructor(l,c){z5(this,l,4,c)}resize(l){H5(this,new Aa(l),4)}replace(l,c){c?this.data.set(l):this.data=l instanceof Uint8ClampedArray?new Uint8Array(l.buffer):l}clone(){return new Aa({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(l,c,d,g,_){E$(l,c,d,g,_,4)}}nr(Vu,"AlphaImage"),nr(Aa,"RGBAImage");var ome={paint:new Lt({"heatmap-radius":new dt(wt.paint_heatmap["heatmap-radius"]),"heatmap-weight":new dt(wt.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Ke(wt.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Pt(wt.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Ke(wt.paint_heatmap["heatmap-opacity"])})};function T$(u){const l={},c=u.resolution||256,d=u.clips?u.clips.length:1,g=u.image||new Aa({width:c,height:d}),_=(w,C,R)=>{l[u.evaluationKey]=R;const k=u.expression.evaluate(l);g.data[w+C+0]=Math.floor(255*k.r/k.a),g.data[w+C+1]=Math.floor(255*k.g/k.a),g.data[w+C+2]=Math.floor(255*k.b/k.a),g.data[w+C+3]=Math.floor(255*k.a)};if(u.clips)for(let w=0,C=0;w<d;++w,C+=4*c)for(let R=0,k=0;R<c;R++,k+=4){const D=R/(c-1),{start:N,end:F}=u.clips[w];_(C,k,N*(1-D)+F*D)}else for(let w=0,C=0;w<c;w++,C+=4)_(0,C,w/(c-1));return g}var ame={paint:new Lt({"hillshade-illumination-direction":new Ke(wt.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Ke(wt.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Ke(wt.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Ke(wt.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Ke(wt.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Ke(wt.paint_hillshade["hillshade-accent-color"])})};const sme=hr([{name:"a_pos",components:2,type:"Int16"}],4),{members:lme}=sme;var Pg={};function GT(u,l,c){c=c||2;var d,g,_,w,C,R,k,D=l&&l.length,N=D?l[0]*c:u.length,F=V5(u,0,N,c,!0),G=[];if(!F||F.next===F.prev)return G;if(D&&(F=function(J,oe,ge,Te){var he,xe,Me,ke=[];for(he=0,xe=oe.length;he<xe;he++)(Me=V5(J,oe[he]*Te,he<xe-1?oe[he+1]*Te:J.length,Te,!1))===Me.next&&(Me.steiner=!0),ke.push(gme(Me));for(ke.sort(dme),he=0;he<ke.length;he++)ge=pme(ke[he],ge);return ge}(u,l,F,c)),u.length>80*c){d=_=u[0],g=w=u[1];for(var Y=c;Y<N;Y+=c)(C=u[Y])<d&&(d=C),(R=u[Y+1])<g&&(g=R),C>_&&(_=C),R>w&&(w=R);k=(k=Math.max(_-d,w-g))!==0?32767/k:0}return u0(F,G,c,d,g,k,0),G}function V5(u,l,c,d,g){var _,w;if(g===k$(u,l,c,d)>0)for(_=l;_<c;_+=d)w=G5(_,u[_],u[_+1],w);else for(_=c-d;_>=l;_-=d)w=G5(_,u[_],u[_+1],w);return w&&YT(w,w.next)&&(f0(w),w=w.next),w}function Bd(u,l){if(!u)return u;l||(l=u);var c,d=u;do if(c=!1,d.steiner||!YT(d,d.next)&&Pi(d.prev,d,d.next)!==0)d=d.next;else{if(f0(d),(d=l=d.prev)===d.next)break;c=!0}while(c||d!==l);return l}function u0(u,l,c,d,g,_,w){if(u){!w&&_&&function(D,N,F,G){var Y=D;do Y.z===0&&(Y.z=O$(Y.x,Y.y,N,F,G)),Y.prevZ=Y.prev,Y.nextZ=Y.next,Y=Y.next;while(Y!==D);Y.prevZ.nextZ=null,Y.prevZ=null,function(J){var oe,ge,Te,he,xe,Me,ke,lt,it=1;do{for(ge=J,J=null,xe=null,Me=0;ge;){for(Me++,Te=ge,ke=0,oe=0;oe<it&&(ke++,Te=Te.nextZ);oe++);for(lt=it;ke>0||lt>0&&Te;)ke!==0&&(lt===0||!Te||ge.z<=Te.z)?(he=ge,ge=ge.nextZ,ke--):(he=Te,Te=Te.nextZ,lt--),xe?xe.nextZ=he:J=he,he.prevZ=xe,xe=he;ge=Te}xe.nextZ=null,it*=2}while(Me>1)}(Y)}(u,d,g,_);for(var C,R,k=u;u.prev!==u.next;)if(C=u.prev,R=u.next,_?cme(u,d,g,_):ume(u))l.push(C.i/c|0),l.push(u.i/c|0),l.push(R.i/c|0),f0(u),u=R.next,k=R.next;else if((u=R)===k){w?w===1?u0(u=fme(Bd(u),l,c),l,c,d,g,_,2):w===2&&hme(u,l,c,d,g,_):u0(Bd(u),l,c,d,g,_,1);break}}}function ume(u){var l=u.prev,c=u,d=u.next;if(Pi(l,c,d)>=0)return!1;for(var g=l.x,_=c.x,w=d.x,C=l.y,R=c.y,k=d.y,D=g<_?g<w?g:w:_<w?_:w,N=C<R?C<k?C:k:R<k?R:k,F=g>_?g>w?g:w:_>w?_:w,G=C>R?C>k?C:k:R>k?R:k,Y=d.next;Y!==l;){if(Y.x>=D&&Y.x<=F&&Y.y>=N&&Y.y<=G&&Ag(g,C,_,R,w,k,Y.x,Y.y)&&Pi(Y.prev,Y,Y.next)>=0)return!1;Y=Y.next}return!0}function cme(u,l,c,d){var g=u.prev,_=u,w=u.next;if(Pi(g,_,w)>=0)return!1;for(var C=g.x,R=_.x,k=w.x,D=g.y,N=_.y,F=w.y,G=C<R?C<k?C:k:R<k?R:k,Y=D<N?D<F?D:F:N<F?N:F,J=C>R?C>k?C:k:R>k?R:k,oe=D>N?D>F?D:F:N>F?N:F,ge=O$(G,Y,l,c,d),Te=O$(J,oe,l,c,d),he=u.prevZ,xe=u.nextZ;he&&he.z>=ge&&xe&&xe.z<=Te;){if(he.x>=G&&he.x<=J&&he.y>=Y&&he.y<=oe&&he!==g&&he!==w&&Ag(C,D,R,N,k,F,he.x,he.y)&&Pi(he.prev,he,he.next)>=0||(he=he.prevZ,xe.x>=G&&xe.x<=J&&xe.y>=Y&&xe.y<=oe&&xe!==g&&xe!==w&&Ag(C,D,R,N,k,F,xe.x,xe.y)&&Pi(xe.prev,xe,xe.next)>=0))return!1;xe=xe.nextZ}for(;he&&he.z>=ge;){if(he.x>=G&&he.x<=J&&he.y>=Y&&he.y<=oe&&he!==g&&he!==w&&Ag(C,D,R,N,k,F,he.x,he.y)&&Pi(he.prev,he,he.next)>=0)return!1;he=he.prevZ}for(;xe&&xe.z<=Te;){if(xe.x>=G&&xe.x<=J&&xe.y>=Y&&xe.y<=oe&&xe!==g&&xe!==w&&Ag(C,D,R,N,k,F,xe.x,xe.y)&&Pi(xe.prev,xe,xe.next)>=0)return!1;xe=xe.nextZ}return!0}function fme(u,l,c){var d=u;do{var g=d.prev,_=d.next.next;!YT(g,_)&&U5(g,d,d.next,_)&&c0(g,_)&&c0(_,g)&&(l.push(g.i/c|0),l.push(d.i/c|0),l.push(_.i/c|0),f0(d),f0(d.next),d=u=_),d=d.next}while(d!==u);return Bd(d)}function hme(u,l,c,d,g,_){var w=u;do{for(var C=w.next.next;C!==w.prev;){if(w.i!==C.i&&yme(w,C)){var R=W5(w,C);return w=Bd(w,w.next),R=Bd(R,R.next),u0(w,l,c,d,g,_,0),void u0(R,l,c,d,g,_,0)}C=C.next}w=w.next}while(w!==u)}function dme(u,l){return u.x-l.x}function pme(u,l){var c=function(g,_){var w,C=_,R=g.x,k=g.y,D=-1/0;do{if(k<=C.y&&k>=C.next.y&&C.next.y!==C.y){var N=C.x+(k-C.y)*(C.next.x-C.x)/(C.next.y-C.y);if(N<=R&&N>D&&(D=N,w=C.x<C.next.x?C:C.next,N===R))return w}C=C.next}while(C!==_);if(!w)return null;var F,G=w,Y=w.x,J=w.y,oe=1/0;C=w;do R>=C.x&&C.x>=Y&&R!==C.x&&Ag(k<J?R:D,k,Y,J,k<J?D:R,k,C.x,C.y)&&(F=Math.abs(k-C.y)/(R-C.x),c0(C,g)&&(F<oe||F===oe&&(C.x>w.x||C.x===w.x&&mme(w,C)))&&(w=C,oe=F)),C=C.next;while(C!==G);return w}(u,l);if(!c)return l;var d=W5(c,u);return Bd(d,d.next),Bd(c,c.next)}function mme(u,l){return Pi(u.prev,u,l.prev)<0&&Pi(l.next,u,u.next)<0}function O$(u,l,c,d,g){return(u=1431655765&((u=858993459&((u=252645135&((u=16711935&((u=(u-c)*g|0)|u<<8))|u<<4))|u<<2))|u<<1))|(l=1431655765&((l=858993459&((l=252645135&((l=16711935&((l=(l-d)*g|0)|l<<8))|l<<4))|l<<2))|l<<1))<<1}function gme(u){var l=u,c=u;do(l.x<c.x||l.x===c.x&&l.y<c.y)&&(c=l),l=l.next;while(l!==u);return c}function Ag(u,l,c,d,g,_,w,C){return(g-w)*(l-C)>=(u-w)*(_-C)&&(u-w)*(d-C)>=(c-w)*(l-C)&&(c-w)*(_-C)>=(g-w)*(d-C)}function yme(u,l){return u.next.i!==l.i&&u.prev.i!==l.i&&!function(c,d){var g=c;do{if(g.i!==c.i&&g.next.i!==c.i&&g.i!==d.i&&g.next.i!==d.i&&U5(g,g.next,c,d))return!0;g=g.next}while(g!==c);return!1}(u,l)&&(c0(u,l)&&c0(l,u)&&function(c,d){var g=c,_=!1,w=(c.x+d.x)/2,C=(c.y+d.y)/2;do g.y>C!=g.next.y>C&&g.next.y!==g.y&&w<(g.next.x-g.x)*(C-g.y)/(g.next.y-g.y)+g.x&&(_=!_),g=g.next;while(g!==c);return _}(u,l)&&(Pi(u.prev,u,l.prev)||Pi(u,l.prev,l))||YT(u,l)&&Pi(u.prev,u,u.next)>0&&Pi(l.prev,l,l.next)>0)}function Pi(u,l,c){return(l.y-u.y)*(c.x-l.x)-(l.x-u.x)*(c.y-l.y)}function YT(u,l){return u.x===l.x&&u.y===l.y}function U5(u,l,c,d){var g=qT(Pi(u,l,c)),_=qT(Pi(u,l,d)),w=qT(Pi(c,d,u)),C=qT(Pi(c,d,l));return g!==_&&w!==C||!(g!==0||!KT(u,c,l))||!(_!==0||!KT(u,d,l))||!(w!==0||!KT(c,u,d))||!(C!==0||!KT(c,l,d))}function KT(u,l,c){return l.x<=Math.max(u.x,c.x)&&l.x>=Math.min(u.x,c.x)&&l.y<=Math.max(u.y,c.y)&&l.y>=Math.min(u.y,c.y)}function qT(u){return u>0?1:u<0?-1:0}function c0(u,l){return Pi(u.prev,u,u.next)<0?Pi(u,l,u.next)>=0&&Pi(u,u.prev,l)>=0:Pi(u,l,u.prev)<0||Pi(u,u.next,l)<0}function W5(u,l){var c=new R$(u.i,u.x,u.y),d=new R$(l.i,l.x,l.y),g=u.next,_=l.prev;return u.next=l,l.prev=u,c.next=g,g.prev=c,d.next=c,c.prev=d,_.next=d,d.prev=_,d}function G5(u,l,c,d){var g=new R$(u,l,c);return d?(g.next=d.next,g.prev=d,d.next.prev=g,d.next=g):(g.prev=g,g.next=g),g}function f0(u){u.next.prev=u.prev,u.prev.next=u.next,u.prevZ&&(u.prevZ.nextZ=u.nextZ),u.nextZ&&(u.nextZ.prevZ=u.prevZ)}function R$(u,l,c){this.i=u,this.x=l,this.y=c,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function k$(u,l,c,d){for(var g=0,_=l,w=c-d;_<c;_+=d)g+=(u[w]-u[_])*(u[_+1]+u[w+1]),w=_;return g}function vme(u,l,c,d,g){Y5(u,l,c||0,d||u.length-1,g||_me)}function Y5(u,l,c,d,g){for(;d>c;){if(d-c>600){var _=d-c+1,w=l-c+1,C=Math.log(_),R=.5*Math.exp(2*C/3),k=.5*Math.sqrt(C*R*(_-R)/_)*(w-_/2<0?-1:1);Y5(u,l,Math.max(c,Math.floor(l-w*R/_+k)),Math.min(d,Math.floor(l+(_-w)*R/_+k)),g)}var D=u[l],N=c,F=d;for(h0(u,c,l),g(u[d],D)>0&&h0(u,c,d);N<F;){for(h0(u,N,F),N++,F--;g(u[N],D)<0;)N++;for(;g(u[F],D)>0;)F--}g(u[c],D)===0?h0(u,c,F):h0(u,++F,d),F<=l&&(c=F+1),l<=F&&(d=F-1)}}function h0(u,l,c){var d=u[l];u[l]=u[c],u[c]=d}function _me(u,l){return u<l?-1:u>l?1:0}function P$(u,l){const c=u.length;if(c<=1)return[u];const d=[];let g,_;for(let w=0;w<c;w++){const C=qe(u[w]);C!==0&&(u[w].area=Math.abs(C),_===void 0&&(_=C<0),_===C<0?(g&&d.push(g),g=[u[w]]):g.push(u[w]))}if(g&&d.push(g),l>1)for(let w=0;w<d.length;w++)d[w].length<=l||(vme(d[w],l,1,d[w].length-1,bme),d[w]=d[w].slice(0,l));return d}function bme(u,l){return l.area-u.area}function A$(u,l,c){const d=c.patternDependencies;let g=!1;for(const _ of l){const w=_.paint.get(`${u}-pattern`);w.isConstant()||(g=!0);const C=w.constantOr(null);C&&(g=!0,d[C]=!0)}return g}function I$(u,l,c,d,g){const _=g.patternDependencies;for(const w of l){const C=w.paint.get(`${u}-pattern`).value;if(C.kind!=="constant"){let R=C.evaluate({zoom:d},c,{},g.availableImages);R=R&&R.name?R.name:R,_[R]=!0,c.patterns[w.id]=R}}return c}({get exports(){return Pg},set exports(u){Pg=u}}).exports=GT,Pg.default=GT,GT.deviation=function(u,l,c,d){var g=l&&l.length,_=Math.abs(k$(u,0,g?l[0]*c:u.length,c));if(g)for(var w=0,C=l.length;w<C;w++)_-=Math.abs(k$(u,l[w]*c,w<C-1?l[w+1]*c:u.length,c));var R=0;for(w=0;w<d.length;w+=3){var k=d[w]*c,D=d[w+1]*c,N=d[w+2]*c;R+=Math.abs((u[k]-u[N])*(u[D+1]-u[k+1])-(u[k]-u[D])*(u[N+1]-u[k+1]))}return _===0&&R===0?0:Math.abs((R-_)/_)},GT.flatten=function(u){for(var l=u[0][0].length,c={vertices:[],holes:[],dimensions:l},d=0,g=0;g<u.length;g++){for(var _=0;_<u[g].length;_++)for(var w=0;w<l;w++)c.vertices.push(u[g][_][w]);g>0&&c.holes.push(d+=u[g-1].length)}return c};class XT{constructor(l){this.zoom=l.zoom,this.overscaling=l.overscaling,this.layers=l.layers,this.layerIds=this.layers.map(c=>c.id),this.index=l.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new _r,this.indexArray=new Co,this.indexArray2=new Fl,this.programConfigurations=new Pd(l.layers,l.zoom),this.segments=new ki,this.segments2=new ki,this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id),this.projection=l.projection}populate(l,c,d,g){this.hasPattern=A$("fill",this.layers,c);const _=this.layers[0].layout.get("fill-sort-key"),w=[];for(const{feature:C,id:R,index:k,sourceLayerIndex:D}of l){const N=this.layers[0]._featureFilter.needGeometry,F=Ld(C,N);if(!this.layers[0]._featureFilter.filter(new Ze(this.zoom),F,d))continue;const G=_?_.evaluate(F,{},d,c.availableImages):void 0,Y={id:R,properties:C.properties,type:C.type,sourceLayerIndex:D,index:k,geometry:N?F.geometry:Hu(C,d,g),patterns:{},sortKey:G};w.push(Y)}_&&w.sort((C,R)=>C.sortKey-R.sortKey);for(const C of w){const{geometry:R,index:k,sourceLayerIndex:D}=C;if(this.hasPattern){const N=I$("fill",this.layers,C,this.zoom,c);this.patternFeatures.push(N)}else this.addFeature(C,R,k,d,{},c.availableImages);c.featureIndex.insert(l[k].feature,R,k,D,this.index)}}update(l,c,d,g){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(l,c,this.stateDependentLayers,d,g)}addFeatures(l,c,d,g,_){for(const w of this.patternFeatures)this.addFeature(w,w.geometry,w.index,c,d,g)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(l){this.uploaded||(this.layoutVertexBuffer=l.createVertexBuffer(this.layoutVertexArray,lme),this.indexBuffer=l.createIndexBuffer(this.indexArray),this.indexBuffer2=l.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(l),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(l,c,d,g,_,w=[]){for(const C of P$(c,500)){let R=0;for(const Y of C)R+=Y.length;const k=this.segments.prepareSegment(R,this.layoutVertexArray,this.indexArray),D=k.vertexLength,N=[],F=[];for(const Y of C){if(Y.length===0)continue;Y!==C[0]&&F.push(N.length/2);const J=this.segments2.prepareSegment(Y.length,this.layoutVertexArray,this.indexArray2),oe=J.vertexLength;this.layoutVertexArray.emplaceBack(Y[0].x,Y[0].y),this.indexArray2.emplaceBack(oe+Y.length-1,oe),N.push(Y[0].x),N.push(Y[0].y);for(let ge=1;ge<Y.length;ge++)this.layoutVertexArray.emplaceBack(Y[ge].x,Y[ge].y),this.indexArray2.emplaceBack(oe+ge-1,oe+ge),N.push(Y[ge].x),N.push(Y[ge].y);J.vertexLength+=Y.length,J.primitiveLength+=Y.length}const G=Pg(N,F);for(let Y=0;Y<G.length;Y+=3)this.indexArray.emplaceBack(D+G[Y],D+G[Y+1],D+G[Y+2]);k.vertexLength+=R,k.primitiveLength+=G.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,l,d,_,w,g)}}nr(XT,"FillBucket",{omit:["layers","patternFeatures"]});const wme=new Lt({"fill-sort-key":new dt(wt.layout_fill["fill-sort-key"])});var Sme={paint:new Lt({"fill-antialias":new Ke(wt.paint_fill["fill-antialias"]),"fill-opacity":new dt(wt.paint_fill["fill-opacity"]),"fill-color":new dt(wt.paint_fill["fill-color"]),"fill-outline-color":new dt(wt.paint_fill["fill-outline-color"]),"fill-translate":new Ke(wt.paint_fill["fill-translate"]),"fill-translate-anchor":new Ke(wt.paint_fill["fill-translate-anchor"]),"fill-pattern":new dt(wt.paint_fill["fill-pattern"])}),layout:wme};const xme=hr([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),Cme=hr([{name:"a_centroid_pos",components:2,type:"Uint16"}]),Eme=hr([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:Tme}=xme;var ZT={},Ome=q,K5=Ig;function Ig(u,l,c,d,g){this.properties={},this.extent=c,this.type=0,this._pbf=u,this._geometry=-1,this._keys=d,this._values=g,u.readFields(Rme,this,l)}function Rme(u,l,c){u==1?l.id=c.readVarint():u==2?function(d,g){for(var _=d.readVarint()+d.pos;d.pos<_;){var w=g._keys[d.readVarint()],C=g._values[d.readVarint()];g.properties[w]=C}}(c,l):u==3?l.type=c.readVarint():u==4&&(l._geometry=c.pos)}function kme(u){for(var l,c,d=0,g=0,_=u.length,w=_-1;g<_;w=g++)d+=((c=u[w]).x-(l=u[g]).x)*(l.y+c.y);return d}Ig.types=["Unknown","Point","LineString","Polygon"],Ig.prototype.loadGeometry=function(){var u=this._pbf;u.pos=this._geometry;for(var l,c=u.readVarint()+u.pos,d=1,g=0,_=0,w=0,C=[];u.pos<c;){if(g<=0){var R=u.readVarint();d=7&R,g=R>>3}if(g--,d===1||d===2)_+=u.readSVarint(),w+=u.readSVarint(),d===1&&(l&&C.push(l),l=[]),l.push(new Ome(_,w));else{if(d!==7)throw new Error("unknown command "+d);l&&l.push(l[0].clone())}}return l&&C.push(l),C},Ig.prototype.bbox=function(){var u=this._pbf;u.pos=this._geometry;for(var l=u.readVarint()+u.pos,c=1,d=0,g=0,_=0,w=1/0,C=-1/0,R=1/0,k=-1/0;u.pos<l;){if(d<=0){var D=u.readVarint();c=7&D,d=D>>3}if(d--,c===1||c===2)(g+=u.readSVarint())<w&&(w=g),g>C&&(C=g),(_+=u.readSVarint())<R&&(R=_),_>k&&(k=_);else if(c!==7)throw new Error("unknown command "+c)}return[w,R,C,k]},Ig.prototype.toGeoJSON=function(u,l,c){var d,g,_=this.extent*Math.pow(2,c),w=this.extent*u,C=this.extent*l,R=this.loadGeometry(),k=Ig.types[this.type];function D(G){for(var Y=0;Y<G.length;Y++){var J=G[Y];G[Y]=[360*(J.x+w)/_-180,360/Math.PI*Math.atan(Math.exp((180-360*(J.y+C)/_)*Math.PI/180))-90]}}switch(this.type){case 1:var N=[];for(d=0;d<R.length;d++)N[d]=R[d][0];D(R=N);break;case 2:for(d=0;d<R.length;d++)D(R[d]);break;case 3:for(R=function(G){var Y=G.length;if(Y<=1)return[G];for(var J,oe,ge=[],Te=0;Te<Y;Te++){var he=kme(G[Te]);he!==0&&(oe===void 0&&(oe=he<0),oe===he<0?(J&&ge.push(J),J=[G[Te]]):J.push(G[Te]))}return J&&ge.push(J),ge}(R),d=0;d<R.length;d++)for(g=0;g<R[d].length;g++)D(R[d][g])}R.length===1?R=R[0]:k="Multi"+k;var F={type:"Feature",geometry:{type:k,coordinates:R},properties:this.properties};return"id"in this&&(F.id=this.id),F};var Pme=K5,q5=X5;function X5(u,l){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=u,this._keys=[],this._values=[],this._features=[],u.readFields(Ame,this,l),this.length=this._features.length}function Ame(u,l,c){u===15?l.version=c.readVarint():u===1?l.name=c.readString():u===5?l.extent=c.readVarint():u===2?l._features.push(c.pos):u===3?l._keys.push(c.readString()):u===4&&l._values.push(function(d){for(var g=null,_=d.readVarint()+d.pos;d.pos<_;){var w=d.readVarint()>>3;g=w===1?d.readString():w===2?d.readFloat():w===3?d.readDouble():w===4?d.readVarint64():w===5?d.readVarint():w===6?d.readSVarint():w===7?d.readBoolean():null}return g}(c))}X5.prototype.feature=function(u){if(u<0||u>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[u];var l=this._pbf.readVarint()+this._pbf.pos;return new Pme(this._pbf,l,this.extent,this._keys,this._values)};var Ime=q5;function Mme(u,l,c){if(u===3){var d=new Ime(c,c.readVarint()+c.pos);d.length&&(l[d.name]=d)}}var M$=ZT.VectorTile=function(u,l){this.layers=u.readFields(Mme,{},l)},JT=ZT.VectorTileFeature=K5;function QT(u,l,c,d){const g=[],_=d===0?(w,C,R,k,D,N)=>{w.push(new q(N,R+(N-C)/(k-C)*(D-R)))}:(w,C,R,k,D,N)=>{w.push(new q(C+(N-R)/(D-R)*(k-C),N))};for(const w of u){const C=[];for(const R of w){if(R.length<=2)continue;const k=[];for(let F=0;F<R.length-1;F++){const G=R[F].x,Y=R[F].y,J=R[F+1].x,oe=R[F+1].y,ge=d===0?G:Y,Te=d===0?J:oe;ge<l?Te>l&&_(k,G,Y,J,oe,l):ge>c?Te<c&&_(k,G,Y,J,oe,c):k.push(R[F]),Te<l&&ge>=l&&_(k,G,Y,J,oe,l),Te>c&&ge<=c&&_(k,G,Y,J,oe,c)}let D=R[R.length-1];const N=d===0?D.x:D.y;N>=l&&N<=c&&k.push(D),k.length&&(D=k[k.length-1],k[0].x===D.x&&k[0].y===D.y||k.push(k[0]),C.push(k))}C.length&&g.push(C)}return g}ZT.VectorTileLayer=q5;const $me=JT.types,Dme=Math.pow(2,13);function d0(u,l,c,d,g,_,w,C){u.emplaceBack((l<<1)+w,(c<<1)+_,(Math.floor(d*Dme)<<1)+g,Math.round(C))}function p0(u,l,c){u.emplaceBack(l.x,l.y,l.z,c[0]*16384,c[1]*16384,c[2]*16384)}class Z5{constructor(){this.acc=new q(0,0),this.polyCount=[]}startRing(l){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new q(l.x,l.y),this.max=new q(l.x,l.y))}append(l,c){this.currentPolyCount.edges++,this.acc._add(l);const d=this.min,g=this.max;l.x<d.x?d.x=l.x:l.x>g.x&&(g.x=l.x),l.y<d.y?d.y=l.y:l.y>g.y&&(g.y=l.y),((l.x===0||l.x===Pr)&&l.x===c.x)!=((l.y===0||l.y===Pr)&&l.y===c.y)&&this.processBorderOverlap(l,c),c.x<0!=l.x<0&&this.addBorderIntersection(0,gn(c.y,l.y,(0-c.x)/(l.x-c.x))),c.x>Pr!=l.x>Pr&&this.addBorderIntersection(1,gn(c.y,l.y,(Pr-c.x)/(l.x-c.x))),c.y<0!=l.y<0&&this.addBorderIntersection(2,gn(c.x,l.x,(0-c.y)/(l.y-c.y))),c.y>Pr!=l.y>Pr&&this.addBorderIntersection(3,gn(c.x,l.x,(Pr-c.y)/(l.y-c.y)))}addBorderIntersection(l,c){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const d=this.borders[l];c<d[0]&&(d[0]=c),c>d[1]&&(d[1]=c)}processBorderOverlap(l,c){if(l.x===c.x){if(l.y===c.y)return;const d=l.x===0?0:1;this.addBorderIntersection(d,c.y),this.addBorderIntersection(d,l.y)}else{const d=l.y===0?2:3;this.addBorderIntersection(d,c.x),this.addBorderIntersection(d,l.x)}}centroid(){const l=this.polyCount.reduce((c,d)=>c+d.edges,0);return l!==0?this.acc.div(l)._round():new q(0,0)}span(){return new q(this.max.x-this.min.x,this.max.y-this.min.y)}intersectsCount(){return this.borders.reduce((l,c)=>l+ +(c[0]!==Number.MAX_VALUE),0)}}class m0{constructor(l){this.zoom=l.zoom,this.canonical=l.canonical,this.overscaling=l.overscaling,this.layers=l.layers,this.layerIds=this.layers.map(c=>c.id),this.index=l.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=l.projection,this.layoutVertexArray=new kn,this.centroidVertexArray=new JW,this.indexArray=new Co,this.programConfigurations=new Pd(l.layers,l.zoom),this.segments=new ki,this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id),this.enableTerrain=l.enableTerrain}populate(l,c,d,g){this.features=[],this.hasPattern=A$("fill-extrusion",this.layers,c),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=function(_){const w=Math.exp(Math.PI*(1-_.y/(1<<_.z)*2));return 80150034*w/(w*w+1)/Pr/(1<<_.z)}(d),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter;for(const{feature:_,id:w,index:C,sourceLayerIndex:R}of l){const k=this.layers[0]._featureFilter.needGeometry,D=Ld(_,k);if(!this.layers[0]._featureFilter.filter(new Ze(this.zoom),D,d))continue;const N={id:w,sourceLayerIndex:R,index:C,geometry:k?D.geometry:Hu(_,d,g),properties:_.properties,type:_.type,patterns:{}},F=this.layoutVertexArray.length;this.hasPattern?this.features.push(I$("fill-extrusion",this.layers,N,this.zoom,c)):this.addFeature(N,N.geometry,C,d,{},c.availableImages,g),c.featureIndex.insert(_,N.geometry,C,R,this.index,F)}this.sortBorders()}addFeatures(l,c,d,g,_){for(const w of this.features){const{geometry:C}=w;this.addFeature(w,C,w.index,c,d,g,_)}this.sortBorders()}update(l,c,d,g){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(l,c,this.stateDependentLayers,d,g)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(l){this.uploaded||(this.layoutVertexBuffer=l.createVertexBuffer(this.layoutVertexArray,Tme),this.indexBuffer=l.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=l.createVertexBuffer(this.layoutVertexExtArray,Eme.members,!0))),this.programConfigurations.upload(l),this.uploaded=!0}uploadCentroid(l){this.centroidVertexArray.length!==0&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=l.createVertexBuffer(this.centroidVertexArray,Cme.members,!0),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(l,c,d,g,_,w,C){const R=[new q(0,0),new q(Pr,Pr)],k=C.projection,D=k.name==="globe",N=this.enableTerrain&&!D?new Z5:null,F=$me[l.type]==="Polygon";D&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new Ka);const G=P$(c,500);for(let ge=G.length-1;ge>=0;ge--){const Te=G[ge];(Te.length===0||(Y=Te[0]).every(he=>he.x<=0)||Y.every(he=>he.x>=Pr)||Y.every(he=>he.y<=0)||Y.every(he=>he.y>=Pr))&&G.splice(ge,1)}var Y;let J;if(D)J=iG(G,R,g);else{J=[];for(const ge of G)J.push({polygon:ge,bounds:R})}const oe=F?this.edgeRadius:0;for(const{polygon:ge,bounds:Te}of J){let he=0,xe=0;for(const ke of ge)F&&!ke[0].equals(ke[ke.length-1])&&ke.push(ke[0]),xe+=F?ke.length-1:ke.length;const Me=this.segments.prepareSegment((F?5:4)*xe,this.layoutVertexArray,this.indexArray);if(F){const ke=[],lt=[];he=Me.vertexLength;for(const xt of ge){let Bt,gt;xt.length&&xt!==ge[0]&&lt.push(ke.length/2),Bt=xt[1].sub(xt[0])._perp()._unit();for(let Et=1;Et<xt.length;Et++){const Rt=xt[Et],$t=xt[Et===xt.length-1?1:Et+1];let{x:Ft,y:yt}=Rt;if(oe){gt=$t.sub(Rt)._perp()._unit();const Yt=Bt.add(gt)._unit(),Er=oe*Math.min(4,1/(Bt.x*Yt.x+Bt.y*Yt.y));Ft+=Er*Yt.x,yt+=Er*Yt.y,Bt=gt}d0(this.layoutVertexArray,Ft,yt,0,0,1,1,0),Me.vertexLength++,ke.push(Rt.x,Rt.y),D&&p0(this.layoutVertexExtArray,k.projectTilePoint(Ft,yt,g),k.upVector(g,Ft,yt))}}const it=Pg(ke,lt);for(let xt=0;xt<it.length;xt+=3)this.indexArray.emplaceBack(he+it[xt],he+it[xt+2],he+it[xt+1]),Me.primitiveLength++}for(const ke of ge){N&&ke.length&&N.startRing(ke[0]);let lt,it,xt,Bt=ke.length>4&&tG(ke[ke.length-2],ke[0],ke[1]),gt=oe?Lme(ke[ke.length-2],ke[0],ke[1],oe):0;it=ke[1].sub(ke[0])._perp()._unit();let Et=!0;for(let Rt=1,$t=0;Rt<ke.length;Rt++){let Ft=ke[Rt-1],yt=ke[Rt];const Yt=ke[Rt===ke.length-1?1:Rt+1];if(N&&F&&N.currentPolyCount.top++,eG(yt,Ft,Te)){oe&&(it=Yt.sub(yt)._perp()._unit(),Et=!Et);continue}N&&N.append(yt,Ft);const Er=yt.sub(Ft)._perp(),er=Er.x/(Math.abs(Er.x)+Math.abs(Er.y)),lr=Er.y>0?1:0,qt=Ft.dist(yt);if($t+qt>32768&&($t=0),oe){xt=Yt.sub(yt)._perp()._unit();let Gr=Q5(Ft,yt,Yt,J5(it,xt),oe);isNaN(Gr)&&(Gr=0);const kr=yt.sub(Ft)._unit();Ft=Ft.add(kr.mult(gt))._round(),yt=yt.add(kr.mult(-Gr))._round(),gt=Gr,it=xt}const Rr=Me.vertexLength,Jr=ke.length>4&&tG(Ft,yt,Yt);let Kr=rG($t,Bt,Et);if(d0(this.layoutVertexArray,Ft.x,Ft.y,er,lr,0,0,Kr),d0(this.layoutVertexArray,Ft.x,Ft.y,er,lr,0,1,Kr),$t+=qt,Kr=rG($t,Jr,!Et),Bt=Jr,d0(this.layoutVertexArray,yt.x,yt.y,er,lr,0,0,Kr),d0(this.layoutVertexArray,yt.x,yt.y,er,lr,0,1,Kr),Me.vertexLength+=4,this.indexArray.emplaceBack(Rr+0,Rr+1,Rr+2),this.indexArray.emplaceBack(Rr+1,Rr+3,Rr+2),Me.primitiveLength+=2,oe){const Gr=he+(Rt===1?ke.length-2:Rt-2),kr=Rt===1?he:Gr+1;if(this.indexArray.emplaceBack(Rr+1,Gr,Rr+3),this.indexArray.emplaceBack(Gr,kr,Rr+3),Me.primitiveLength+=2,lt===void 0&&(lt=Rr),!eG(Yt,ke[Rt],Te)){const Pn=Rt===ke.length-1?lt:Me.vertexLength;this.indexArray.emplaceBack(Rr+2,Rr+3,Pn),this.indexArray.emplaceBack(Rr+3,Pn+1,Pn),this.indexArray.emplaceBack(Rr+3,kr,Pn+1),Me.primitiveLength+=3}Et=!Et}if(D){const Gr=this.layoutVertexExtArray,kr=k.projectTilePoint(Ft.x,Ft.y,g),Pn=k.projectTilePoint(yt.x,yt.y,g),Lr=k.upVector(g,Ft.x,Ft.y),Qr=k.upVector(g,yt.x,yt.y);p0(Gr,kr,Lr),p0(Gr,kr,Lr),p0(Gr,Pn,Qr),p0(Gr,Pn,Qr)}}F&&(he+=ke.length-1)}}if(N&&N.polyCount.length>0){if(N.borders){N.vertexArrayOffset=this.centroidVertexArray.length;const ge=N.borders,Te=this.featuresOnBorder.push(N)-1;for(let he=0;he<4;he++)ge[he][0]!==Number.MAX_VALUE&&this.borders[he].push(Te)}this.encodeCentroid(N.borders?void 0:N.centroid(),N)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,l,d,_,w,g)}sortBorders(){for(let l=0;l<4;l++)this.borders[l].sort((c,d)=>this.featuresOnBorder[c].borders[l][0]-this.featuresOnBorder[d].borders[l][0])}encodeCentroid(l,c,d=!0){let g,_;if(l)if(l.y!==0){const C=c.span()._mult(this.tileToMeter);g=(Math.max(l.x,1)<<3)+Math.min(7,Math.round(C.x/10)),_=(Math.max(l.y,1)<<3)+Math.min(7,Math.round(C.y/10))}else g=Math.ceil(7*(l.x+450)),_=0;else g=0,_=+d;let w=d?this.centroidVertexArray.length:c.vertexArrayOffset;for(const C of c.polyCount){d&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*C.edges+C.top);for(let R=0;R<C.top;R++)this.centroidVertexArray.emplace(w++,g,_);for(let R=0;R<2*C.edges;R++)this.centroidVertexArray.emplace(w++,0,_),this.centroidVertexArray.emplace(w++,g,_)}}}function J5(u,l){const c=u.add(l)._unit();return u.x*c.x+u.y*c.y}function Lme(u,l,c,d){const g=l.sub(u)._perp()._unit(),_=c.sub(l)._perp()._unit();return Q5(u,l,c,J5(g,_),d)}function Q5(u,l,c,d,g){const _=Math.sqrt(1-d*d);return Math.min(u.dist(l)/3,l.dist(c)/3,g*_/d)}function eG(u,l,c){return u.x<c[0].x&&l.x<c[0].x||u.x>c[1].x&&l.x>c[1].x||u.y<c[0].y&&l.y<c[0].y||u.y>c[1].y&&l.y>c[1].y}function tG(u,l,c){if(u.x<0||u.x>=Pr||l.x<0||l.x>=Pr||c.x<0||c.x>=Pr)return!1;const d=c.sub(l),g=d.perp(),_=u.sub(l);return(d.x*_.x+d.y*_.y)/Math.sqrt((d.x*d.x+d.y*d.y)*(_.x*_.x+_.y*_.y))>-.866&&g.x*_.x+g.y*_.y<0}function rG(u,l,c){const d=l?2|u:-3&u;return c?1|d:-2&d}function nG(){const u=Math.PI/32,l=Math.tan(u),c=l0;return c*Math.sqrt(1+2*l*l)-c}function iG(u,l,c){const d=1<<c.z,g=Xa(c.x/d),_=Xa((c.x+1)/d),w=Eo(c.y/d),C=Eo((c.y+1)/d);return function(R,k,D,N,F=0,G){const Y=[];if(!R.length||!D||!N)return Y;const J=(ke,lt)=>{for(const it of ke)Y.push({polygon:it,bounds:lt})},oe=Math.ceil(Math.log2(D)),ge=Math.ceil(Math.log2(N)),Te=oe-ge,he=[];for(let ke=0;ke<Math.abs(Te);ke++)he.push(Te>0?0:1);for(let ke=0;ke<Math.min(oe,ge);ke++)he.push(0),he.push(1);let xe=R;if(xe=QT(xe,k[0].y-F,k[1].y+F,1),xe=QT(xe,k[0].x-F,k[1].x+F,0),!xe.length)return Y;const Me=[];for(he.length?Me.push({polygons:xe,bounds:k,depth:0}):J(xe,k);Me.length;){const ke=Me.pop(),lt=ke.depth,it=he[lt],xt=ke.bounds[0],Bt=ke.bounds[1],gt=it===0?xt.x:xt.y,Et=it===0?Bt.x:Bt.y,Rt=G?G(it,gt,Et):.5*(gt+Et),$t=QT(ke.polygons,gt-F,Rt+F,it),Ft=QT(ke.polygons,Rt-F,Et+F,it);if($t.length){const yt=[xt,new q(it===0?Rt:Bt.x,it===1?Rt:Bt.y)];he.length>lt+1?Me.push({polygons:$t,bounds:yt,depth:lt+1}):J($t,yt)}if(Ft.length){const yt=[new q(it===0?Rt:xt.x,it===1?Rt:xt.y),Bt];he.length>lt+1?Me.push({polygons:Ft,bounds:yt,depth:lt+1}):J(Ft,yt)}}return Y}(u,l,Math.ceil((_-g)/11.25),Math.ceil((w-C)/11.25),1,(R,k,D)=>{if(R===0)return .5*(k+D);{const N=Eo((c.y+k/Pr)/d);return(Wl(.5*(Eo((c.y+D/Pr)/d)+N))*d-c.y)*Pr}})}nr(m0,"FillExtrusionBucket",{omit:["layers","features"]}),nr(Z5,"PartMetadata");const Nme=new Lt({"fill-extrusion-edge-radius":new Ke(wt["layout_fill-extrusion"]["fill-extrusion-edge-radius"])});var Bme={paint:new Lt({"fill-extrusion-opacity":new Ke(wt["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new dt(wt["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Ke(wt["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Ke(wt["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new dt(wt["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new dt(wt["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new dt(wt["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Ke(wt["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new Ke(wt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new Ke(wt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"])}),layout:Nme};function oG(u,l,c){var d=2*Math.PI*6378137/256/Math.pow(2,c);return[u*d-2*Math.PI*6378137/2,l*d-2*Math.PI*6378137/2]}class eO{constructor(l,c,d){this.z=l,this.x=c,this.y=d,this.key=g0(0,l,l,c,d)}equals(l){return this.z===l.z&&this.x===l.x&&this.y===l.y}url(l,c){const d=function(_,w,C){var R=oG(256*_,256*(w=Math.pow(2,C)-w-1),C),k=oG(256*(_+1),256*(w+1),C);return R[0]+","+R[1]+","+k[0]+","+k[1]}(this.x,this.y,this.z),g=function(_,w,C){let R,k="";for(let D=_;D>0;D--)R=1<<D-1,k+=(w&R?1:0)+(C&R?2:0);return k}(this.z,this.x,this.y);return l[(this.x+this.y)%l.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(c==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",g).replace("{bbox-epsg-3857}",d)}toString(){return`${this.z}/${this.x}/${this.y}`}}class aG{constructor(l,c){this.wrap=l,this.canonical=c,this.key=g0(l,c.z,c.z,c.x,c.y)}}class Ko{constructor(l,c,d,g,_){this.overscaledZ=l,this.wrap=c,this.canonical=new eO(d,+g,+_),this.key=c===0&&l===d?this.canonical.key:g0(c,l,d,g,_)}equals(l){return this.overscaledZ===l.overscaledZ&&this.wrap===l.wrap&&this.canonical.equals(l.canonical)}scaledTo(l){const c=this.canonical.z-l;return l>this.canonical.z?new Ko(l,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Ko(l,this.wrap,l,this.canonical.x>>c,this.canonical.y>>c)}calculateScaledKey(l,c=!0){if(this.overscaledZ===l&&c)return this.key;if(l>this.canonical.z)return g0(this.wrap*+c,l,this.canonical.z,this.canonical.x,this.canonical.y);{const d=this.canonical.z-l;return g0(this.wrap*+c,l,l,this.canonical.x>>d,this.canonical.y>>d)}}isChildOf(l){if(l.wrap!==this.wrap)return!1;const c=this.canonical.z-l.canonical.z;return l.overscaledZ===0||l.overscaledZ<this.overscaledZ&&l.canonical.x===this.canonical.x>>c&&l.canonical.y===this.canonical.y>>c}children(l){if(this.overscaledZ>=l)return[new Ko(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const c=this.canonical.z+1,d=2*this.canonical.x,g=2*this.canonical.y;return[new Ko(c,this.wrap,c,d,g),new Ko(c,this.wrap,c,d+1,g),new Ko(c,this.wrap,c,d,g+1),new Ko(c,this.wrap,c,d+1,g+1)]}isLessThan(l){return this.wrap<l.wrap||!(this.wrap>l.wrap)&&(this.overscaledZ<l.overscaledZ||!(this.overscaledZ>l.overscaledZ)&&(this.canonical.x<l.canonical.x||!(this.canonical.x>l.canonical.x)&&this.canonical.y<l.canonical.y))}wrapped(){return new Ko(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(l){return new Ko(this.overscaledZ,l,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new aG(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function g0(u,l,c,d,g){const _=1<<Math.min(c,22);let w=_*(g%_)+d%_;return u&&c<22&&(w+=_*_*((u<0?-2*u-1:2*u)%(1<<2*(22-c)))),16*(32*w+c)+(l-c)}nr(eO,"CanonicalTileID"),nr(Ko,"OverscaledTileID",{omit:["projMatrix"]});class Mg extends q{constructor(l,c,d){super(l,c),this.z=d}}function y0(u,l){return u.x*l.x+u.y*l.y}function sG(u,l){if(u.length===1){let c=0;const d=l[c++];let g;for(;!g||d.equals(g);)if(g=l[c++],!g)return 1/0;for(;c<l.length;c++){const _=l[c],w=u[0],C=g.sub(d),R=_.sub(d),k=w.sub(d),D=y0(C,C),N=y0(C,R),F=y0(R,R),G=y0(k,C),Y=y0(k,R),J=D*F-N*N,oe=(F*G-N*Y)/J,ge=(D*Y-N*G)/J,Te=d.z*(1-oe-ge)+g.z*oe+_.z*ge;if(isFinite(Te))return Te}return 1/0}{let c=1/0;for(const d of l)c=Math.min(c,d.z);return c}}function lG(u,l,c,d,g,_,w,C){const R=w*g.getElevationAt(u,l,!0,!0),k=_[0]!==0,D=k?_[1]===0?w*(_[0]/7-450):w*function(N,F,G){const Y=Math.floor(F[0]/8),J=Math.floor(F[1]/8),oe=10*(F[0]-8*Y),ge=10*(F[1]-8*J),Te=N.getElevationAt(Y,J,!0,!0),he=N.getMeterToDEM(G),xe=Math.floor(.5*(oe*he-1)),Me=Math.floor(.5*(ge*he-1)),ke=N.tileCoordToPixel(Y,J),lt=2*xe+1,it=2*Me+1,xt=function(Ft,yt,Yt,Er,er){return[Ft.getElevationAtPixel(yt,Yt,!0),Ft.getElevationAtPixel(yt+er,Yt,!0),Ft.getElevationAtPixel(yt,Yt+er,!0),Ft.getElevationAtPixel(yt+Er,Yt+er,!0)]}(N,ke.x-xe,ke.y-Me,lt,it),Bt=Math.abs(xt[0]-xt[1]),gt=Math.abs(xt[2]-xt[3]),Et=Math.abs(xt[0]-xt[2])+Math.abs(xt[1]-xt[3]),Rt=Math.min(.25,.5*he*(Bt+gt)/lt),$t=Math.min(.25,.5*he*Et/it);return Te+Math.max(Rt*oe,$t*ge)}(g,_,C):R;return{base:R+(c===0)?-1:c,top:k?Math.max(D+d,R+c+2):R+d}}const jme=hr([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:Fme}=jme,zme=hr([{name:"a_packed",components:4,type:"Float32"}]),{members:Hme}=zme,Vme=JT.types,Ume=Math.cos(Math.PI/180*37.5);class tO{constructor(l){this.zoom=l.zoom,this.overscaling=l.overscaling,this.layers=l.layers,this.layerIds=this.layers.map(c=>c.id),this.index=l.index,this.projection=l.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(c=>{this.gradients[c.id]={}}),this.layoutVertexArray=new Vn,this.layoutVertexArray2=new Nn,this.indexArray=new Co,this.programConfigurations=new Pd(l.layers,l.zoom),this.segments=new ki,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id)}populate(l,c,d,g){this.hasPattern=A$("line",this.layers,c);const _=this.layers[0].layout.get("line-sort-key"),w=[];for(const{feature:D,id:N,index:F,sourceLayerIndex:G}of l){const Y=this.layers[0]._featureFilter.needGeometry,J=Ld(D,Y);if(!this.layers[0]._featureFilter.filter(new Ze(this.zoom),J,d))continue;const oe=_?_.evaluate(J,{},d):void 0,ge={id:N,properties:D.properties,type:D.type,sourceLayerIndex:G,index:F,geometry:Y?J.geometry:Hu(D,d,g),patterns:{},sortKey:oe};w.push(ge)}_&&w.sort((D,N)=>D.sortKey-N.sortKey);const{lineAtlas:C,featureIndex:R}=c,k=this.addConstantDashes(C);for(const D of w){const{geometry:N,index:F,sourceLayerIndex:G}=D;if(k&&this.addFeatureDashes(D,C),this.hasPattern){const Y=I$("line",this.layers,D,this.zoom,c);this.patternFeatures.push(Y)}else this.addFeature(D,N,F,d,C.positions,c.availableImages);R.insert(l[F].feature,N,F,G,this.index)}}addConstantDashes(l){let c=!1;for(const d of this.layers){const g=d.paint.get("line-dasharray").value,_=d.layout.get("line-cap").value;if(g.kind!=="constant"||_.kind!=="constant")c=!0;else{const w=_.value,C=g.value;if(!C)continue;l.addDash(C,w)}}return c}addFeatureDashes(l,c){const d=this.zoom;for(const g of this.layers){const _=g.paint.get("line-dasharray").value,w=g.layout.get("line-cap").value;if(_.kind==="constant"&&w.kind==="constant")continue;let C,R;if(_.kind==="constant"){if(C=_.value,!C)continue}else C=_.evaluate({zoom:d},l);R=w.kind==="constant"?w.value:w.evaluate({zoom:d},l),c.addDash(C,R),l.patterns[g.id]=c.getKey(C,R)}}update(l,c,d,g){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(l,c,this.stateDependentLayers,d,g)}addFeatures(l,c,d,g,_){for(const w of this.patternFeatures)this.addFeature(w,w.geometry,w.index,c,d,g)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(l){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=l.createVertexBuffer(this.layoutVertexArray2,Hme)),this.layoutVertexBuffer=l.createVertexBuffer(this.layoutVertexArray,Fme),this.indexBuffer=l.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(l),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(l){if(l.properties&&l.properties.hasOwnProperty("mapbox_clip_start")&&l.properties.hasOwnProperty("mapbox_clip_end"))return{start:+l.properties.mapbox_clip_start,end:+l.properties.mapbox_clip_end}}addFeature(l,c,d,g,_,w){const C=this.layers[0].layout,R=C.get("line-join").evaluate(l,{}),k=C.get("line-cap").evaluate(l,{}),D=C.get("line-miter-limit"),N=C.get("line-round-limit");this.lineClips=this.lineFeatureClips(l);for(const F of c)this.addLine(F,l,R,k,D,N);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,l,d,_,w,g)}addLine(l,c,d,g,_,w){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let ge=0;ge<l.length-1;ge++)this.totalDistance+=l[ge].dist(l[ge+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const C=Vme[c.type]==="Polygon";let R=l.length;for(;R>=2&&l[R-1].equals(l[R-2]);)R--;let k=0;for(;k<R-1&&l[k].equals(l[k+1]);)k++;if(R<(C?3:2))return;d==="bevel"&&(_=1.05);const D=this.overscaling<=16?122880/(512*this.overscaling):0,N=this.segments.prepareSegment(10*R,this.layoutVertexArray,this.indexArray);let F,G,Y,J,oe;this.e1=this.e2=-1,C&&(F=l[R-2],oe=l[k].sub(F)._unit()._perp());for(let ge=k;ge<R;ge++){if(Y=ge===R-1?C?l[k+1]:void 0:l[ge+1],Y&&l[ge].equals(Y))continue;oe&&(J=oe),F&&(G=F),F=l[ge],oe=Y?Y.sub(F)._unit()._perp():J,J=J||oe;let Te=J.add(oe);Te.x===0&&Te.y===0||Te._unit();const he=J.x*oe.x+J.y*oe.y,xe=Te.x*oe.x+Te.y*oe.y,Me=xe!==0?1/xe:1/0,ke=2*Math.sqrt(2-2*xe),lt=xe<Ume&&G&&Y,it=J.x*oe.y-J.y*oe.x>0;if(lt&&ge>k){const gt=F.dist(G);if(gt>2*D){const Et=F.sub(F.sub(G)._mult(D/gt)._round());this.updateDistance(G,Et),this.addCurrentVertex(Et,J,0,0,N),G=Et}}const xt=G&&Y;let Bt=xt?d:C?"butt":g;if(xt&&Bt==="round"&&(Me<w?Bt="miter":Me<=2&&(Bt="fakeround")),Bt==="miter"&&Me>_&&(Bt="bevel"),Bt==="bevel"&&(Me>2&&(Bt="flipbevel"),Me<_&&(Bt="miter")),G&&this.updateDistance(G,F),Bt==="miter")Te._mult(Me),this.addCurrentVertex(F,Te,0,0,N);else if(Bt==="flipbevel"){if(Me>100)Te=oe.mult(-1);else{const gt=Me*J.add(oe).mag()/J.sub(oe).mag();Te._perp()._mult(gt*(it?-1:1))}this.addCurrentVertex(F,Te,0,0,N),this.addCurrentVertex(F,Te.mult(-1),0,0,N)}else if(Bt==="bevel"||Bt==="fakeround"){const gt=-Math.sqrt(Me*Me-1),Et=it?gt:0,Rt=it?0:gt;if(G&&this.addCurrentVertex(F,J,Et,Rt,N),Bt==="fakeround"){const $t=Math.round(180*ke/Math.PI/20);for(let Ft=1;Ft<$t;Ft++){let yt=Ft/$t;if(yt!==.5){const Er=yt-.5;yt+=yt*Er*(yt-1)*((1.0904+he*(he*(3.55645-1.43519*he)-3.2452))*Er*Er+(.848013+he*(.215638*he-1.06021)))}const Yt=oe.sub(J)._mult(yt)._add(J)._unit()._mult(it?-1:1);this.addHalfVertex(F,Yt.x,Yt.y,!1,it,0,N)}}Y&&this.addCurrentVertex(F,oe,-Et,-Rt,N)}else if(Bt==="butt")this.addCurrentVertex(F,Te,0,0,N);else if(Bt==="square"){const gt=G?1:-1;G||this.addCurrentVertex(F,Te,gt,gt,N),this.addCurrentVertex(F,Te,0,0,N),G&&this.addCurrentVertex(F,Te,gt,gt,N)}else Bt==="round"&&(G&&(this.addCurrentVertex(F,J,0,0,N),this.addCurrentVertex(F,J,1,1,N,!0)),Y&&(this.addCurrentVertex(F,oe,-1,-1,N,!0),this.addCurrentVertex(F,oe,0,0,N)));if(lt&&ge<R-1){const gt=F.dist(Y);if(gt>2*D){const Et=F.add(Y.sub(F)._mult(D/gt)._round());this.updateDistance(F,Et),this.addCurrentVertex(Et,oe,0,0,N),F=Et}}}}addCurrentVertex(l,c,d,g,_,w=!1){const C=c.y*g-c.x,R=-c.y-c.x*g;this.addHalfVertex(l,c.x+c.y*d,c.y-c.x*d,w,!1,d,_),this.addHalfVertex(l,C,R,w,!0,-g,_)}addHalfVertex({x:l,y:c},d,g,_,w,C,R){this.layoutVertexArray.emplaceBack((l<<1)+(_?1:0),(c<<1)+(w?1:0),Math.round(63*d)+128,Math.round(63*g)+128,1+(C===0?0:C<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const k=R.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,k),R.primitiveLength++),w?this.e2=k:this.e1=k}updateScaledDistance(){if(this.lineClips){const l=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=l*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(l,c){this.distance+=l.dist(c),this.updateScaledDistance()}}nr(tO,"LineBucket",{omit:["layers","patternFeatures"]});const Wme=new Lt({"line-cap":new dt(wt.layout_line["line-cap"]),"line-join":new dt(wt.layout_line["line-join"]),"line-miter-limit":new Ke(wt.layout_line["line-miter-limit"]),"line-round-limit":new Ke(wt.layout_line["line-round-limit"]),"line-sort-key":new dt(wt.layout_line["line-sort-key"])});var uG={paint:new Lt({"line-opacity":new dt(wt.paint_line["line-opacity"]),"line-color":new dt(wt.paint_line["line-color"]),"line-translate":new Ke(wt.paint_line["line-translate"]),"line-translate-anchor":new Ke(wt.paint_line["line-translate-anchor"]),"line-width":new dt(wt.paint_line["line-width"]),"line-gap-width":new dt(wt.paint_line["line-gap-width"]),"line-offset":new dt(wt.paint_line["line-offset"]),"line-blur":new dt(wt.paint_line["line-blur"]),"line-dasharray":new dt(wt.paint_line["line-dasharray"]),"line-pattern":new dt(wt.paint_line["line-pattern"]),"line-gradient":new Pt(wt.paint_line["line-gradient"]),"line-trim-offset":new Ke(wt.paint_line["line-trim-offset"])}),layout:Wme};const cG=new class extends dt{possiblyEvaluate(u,l){return l=new Ze(Math.floor(l.zoom),{now:l.now,fadeDuration:l.fadeDuration,transition:l.transition}),super.possiblyEvaluate(u,l)}evaluate(u,l,c,d){return l=U({},l,{zoom:Math.floor(l.zoom)}),super.evaluate(u,l,c,d)}}(uG.paint.properties["line-width"].specification);function fG(u,l){return l>0?l+2*u:u}cG.useIntegerZoom=!0;const Gme=hr([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Yme=hr([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),Kme=hr([{name:"a_projected_pos",components:4,type:"Float32"}],4);hr([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const qme=hr([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),Xme=hr([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);hr([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const hG=hr([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Zme=hr([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);hr([{name:"triangle",components:3,type:"Uint16"}]),hr([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),hr([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),hr([{type:"Float32",name:"offsetX"}]),hr([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var Oo=24;const Gl=128;function $$(u,l){const{expression:c}=l;if(c.kind==="constant")return{kind:"constant",layoutSize:c.evaluate(new Ze(u+1))};if(c.kind==="source")return{kind:"source"};{const{zoomStops:d,interpolationType:g}=c;let _=0;for(;_<d.length&&d[_]<=u;)_++;_=Math.max(0,_-1);let w=_;for(;w<d.length&&d[w]<u+1;)w++;w=Math.min(d.length-1,w);const C=d[_],R=d[w];return c.kind==="composite"?{kind:"composite",minZoom:C,maxZoom:R,interpolationType:g}:{kind:"camera",minZoom:C,maxZoom:R,minSize:c.evaluate(new Ze(C)),maxSize:c.evaluate(new Ze(R)),interpolationType:g}}}function rO(u,{uSize:l,uSizeT:c},{lowerSize:d,upperSize:g}){return u.kind==="source"?d/Gl:u.kind==="composite"?gn(d/Gl,g/Gl,c):l}function $g(u,l){let c=0,d=0;if(u.kind==="constant")d=u.layoutSize;else if(u.kind!=="source"){const{interpolationType:g,minZoom:_,maxZoom:w}=u,C=g?Ce(Ss.interpolationFactor(g,l,_,w),0,1):0;u.kind==="camera"?d=gn(u.minSize,u.maxSize,C):c=C}return{uSizeT:c,uSize:d}}var Jme=Object.freeze({__proto__:null,getSizeData:$$,evaluateSizeForFeature:rO,evaluateSizeForZoom:$g,SIZE_PACK_FACTOR:Gl});function Qme(u,l,c){return u.sections.forEach(d=>{d.text=function(g,_,w){const C=_.layout.get("text-transform").evaluate(w,{});return C==="uppercase"?g=g.toLocaleUpperCase():C==="lowercase"&&(g=g.toLocaleLowerCase()),Be.applyArabicShaping&&(g=Be.applyArabicShaping(g)),g}(d.text,l,c)}),u}const v0={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};function ege(u){return u===""||u===""||u===""||u===""||u===""||u===""||u===""||u===""||u===""||u===""||u===""||u===""||u===""||u===""||u===""||u===""||u===""}function tge(u){return u===""||u===""||u===""||u===""||u===""||u===""||u===""||u===""||u===""||u===""}var _0=Un,dG=function(u,l,c,d,g){var _,w,C=8*g-d-1,R=(1<<C)-1,k=R>>1,D=-7,N=c?g-1:0,F=c?-1:1,G=u[l+N];for(N+=F,_=G&(1<<-D)-1,G>>=-D,D+=C;D>0;_=256*_+u[l+N],N+=F,D-=8);for(w=_&(1<<-D)-1,_>>=-D,D+=d;D>0;w=256*w+u[l+N],N+=F,D-=8);if(_===0)_=1-k;else{if(_===R)return w?NaN:1/0*(G?-1:1);w+=Math.pow(2,d),_-=k}return(G?-1:1)*w*Math.pow(2,_-d)},pG=function(u,l,c,d,g,_){var w,C,R,k=8*_-g-1,D=(1<<k)-1,N=D>>1,F=g===23?Math.pow(2,-24)-Math.pow(2,-77):0,G=d?0:_-1,Y=d?1:-1,J=l<0||l===0&&1/l<0?1:0;for(l=Math.abs(l),isNaN(l)||l===1/0?(C=isNaN(l)?1:0,w=D):(w=Math.floor(Math.log(l)/Math.LN2),l*(R=Math.pow(2,-w))<1&&(w--,R*=2),(l+=w+N>=1?F/R:F*Math.pow(2,1-N))*R>=2&&(w++,R/=2),w+N>=D?(C=0,w=D):w+N>=1?(C=(l*R-1)*Math.pow(2,g),w+=N):(C=l*Math.pow(2,N-1)*Math.pow(2,g),w=0));g>=8;u[c+G]=255&C,G+=Y,C/=256,g-=8);for(w=w<<g|C,k+=g;k>0;u[c+G]=255&w,G+=Y,w/=256,k-=8);u[c+G-Y]|=128*J};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */function Un(u){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(u)?u:new Uint8Array(u||0),this.pos=0,this.type=0,this.length=this.buf.length}Un.Varint=0,Un.Fixed64=1,Un.Bytes=2,Un.Fixed32=5;var D$=4294967296,mG=1/D$,gG=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function Uu(u){return u.type===Un.Bytes?u.readVarint()+u.pos:u.pos+1}function Dg(u,l,c){return c?4294967296*l+(u>>>0):4294967296*(l>>>0)+(u>>>0)}function yG(u,l,c){var d=l<=16383?1:l<=2097151?2:l<=268435455?3:Math.floor(Math.log(l)/(7*Math.LN2));c.realloc(d);for(var g=c.pos-1;g>=u;g--)c.buf[g+d]=c.buf[g]}function rge(u,l){for(var c=0;c<u.length;c++)l.writeVarint(u[c])}function nge(u,l){for(var c=0;c<u.length;c++)l.writeSVarint(u[c])}function ige(u,l){for(var c=0;c<u.length;c++)l.writeFloat(u[c])}function oge(u,l){for(var c=0;c<u.length;c++)l.writeDouble(u[c])}function age(u,l){for(var c=0;c<u.length;c++)l.writeBoolean(u[c])}function sge(u,l){for(var c=0;c<u.length;c++)l.writeFixed32(u[c])}function lge(u,l){for(var c=0;c<u.length;c++)l.writeSFixed32(u[c])}function uge(u,l){for(var c=0;c<u.length;c++)l.writeFixed64(u[c])}function cge(u,l){for(var c=0;c<u.length;c++)l.writeSFixed64(u[c])}function nO(u,l){return(u[l]|u[l+1]<<8|u[l+2]<<16)+16777216*u[l+3]}function Lg(u,l,c){u[c]=l,u[c+1]=l>>>8,u[c+2]=l>>>16,u[c+3]=l>>>24}function vG(u,l){return(u[l]|u[l+1]<<8|u[l+2]<<16)+(u[l+3]<<24)}function fge(u,l,c){l.glyphs=[],u===1&&c.readMessage(hge,l)}function hge(u,l,c){if(u===3){const{id:d,bitmap:g,width:_,height:w,left:C,top:R,advance:k}=c.readMessage(dge,{});l.glyphs.push({id:d,bitmap:new Vu({width:_+6,height:w+6},g),metrics:{width:_,height:w,left:C,top:R,advance:k}})}else u===4?l.ascender=c.readSVarint():u===5&&(l.descender=c.readSVarint())}function dge(u,l,c){u===1?l.id=c.readVarint():u===2?l.bitmap=c.readBytes():u===3?l.width=c.readVarint():u===4?l.height=c.readVarint():u===5?l.left=c.readSVarint():u===6?l.top=c.readSVarint():u===7&&(l.advance=c.readVarint())}function L$(u){let l=0,c=0;for(const w of u)l+=w.w*w.h,c=Math.max(c,w.w);u.sort((w,C)=>C.h-w.h);const d=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(l/.95)),c),h:1/0}];let g=0,_=0;for(const w of u)for(let C=d.length-1;C>=0;C--){const R=d[C];if(!(w.w>R.w||w.h>R.h)){if(w.x=R.x,w.y=R.y,_=Math.max(_,w.y+w.h),g=Math.max(g,w.x+w.w),w.w===R.w&&w.h===R.h){const k=d.pop();C<d.length&&(d[C]=k)}else w.h===R.h?(R.x+=w.w,R.w-=w.w):w.w===R.w?(R.y+=w.h,R.h-=w.h):(d.push({x:R.x+w.w,y:R.y,w:R.w-w.w,h:w.h}),R.y+=w.h,R.h-=w.h);break}}return{w:g,h:_,fill:l/(g*_)||0}}Un.prototype={destroy:function(){this.buf=null},readFields:function(u,l,c){for(c=c||this.length;this.pos<c;){var d=this.readVarint(),g=d>>3,_=this.pos;this.type=7&d,u(g,l,this),this.pos===_&&this.skip(d)}return l},readMessage:function(u,l){return this.readFields(u,l,this.readVarint()+this.pos)},readFixed32:function(){var u=nO(this.buf,this.pos);return this.pos+=4,u},readSFixed32:function(){var u=vG(this.buf,this.pos);return this.pos+=4,u},readFixed64:function(){var u=nO(this.buf,this.pos)+nO(this.buf,this.pos+4)*D$;return this.pos+=8,u},readSFixed64:function(){var u=nO(this.buf,this.pos)+vG(this.buf,this.pos+4)*D$;return this.pos+=8,u},readFloat:function(){var u=dG(this.buf,this.pos,!0,23,4);return this.pos+=4,u},readDouble:function(){var u=dG(this.buf,this.pos,!0,52,8);return this.pos+=8,u},readVarint:function(u){var l,c,d=this.buf;return l=127&(c=d[this.pos++]),c<128?l:(l|=(127&(c=d[this.pos++]))<<7,c<128?l:(l|=(127&(c=d[this.pos++]))<<14,c<128?l:(l|=(127&(c=d[this.pos++]))<<21,c<128?l:function(g,_,w){var C,R,k=w.buf;if(C=(112&(R=k[w.pos++]))>>4,R<128||(C|=(127&(R=k[w.pos++]))<<3,R<128)||(C|=(127&(R=k[w.pos++]))<<10,R<128)||(C|=(127&(R=k[w.pos++]))<<17,R<128)||(C|=(127&(R=k[w.pos++]))<<24,R<128)||(C|=(1&(R=k[w.pos++]))<<31,R<128))return Dg(g,C,_);throw new Error("Expected varint not more than 10 bytes")}(l|=(15&(c=d[this.pos]))<<28,u,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var u=this.readVarint();return u%2==1?(u+1)/-2:u/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var u=this.readVarint()+this.pos,l=this.pos;return this.pos=u,u-l>=12&&gG?function(c,d,g){return gG.decode(c.subarray(d,g))}(this.buf,l,u):function(c,d,g){for(var _="",w=d;w<g;){var C,R,k,D=c[w],N=null,F=D>239?4:D>223?3:D>191?2:1;if(w+F>g)break;F===1?D<128&&(N=D):F===2?(192&(C=c[w+1]))==128&&(N=(31&D)<<6|63&C)<=127&&(N=null):F===3?(R=c[w+2],(192&(C=c[w+1]))==128&&(192&R)==128&&((N=(15&D)<<12|(63&C)<<6|63&R)<=2047||N>=55296&&N<=57343)&&(N=null)):F===4&&(R=c[w+2],k=c[w+3],(192&(C=c[w+1]))==128&&(192&R)==128&&(192&k)==128&&((N=(15&D)<<18|(63&C)<<12|(63&R)<<6|63&k)<=65535||N>=1114112)&&(N=null)),N===null?(N=65533,F=1):N>65535&&(N-=65536,_+=String.fromCharCode(N>>>10&1023|55296),N=56320|1023&N),_+=String.fromCharCode(N),w+=F}return _}(this.buf,l,u)},readBytes:function(){var u=this.readVarint()+this.pos,l=this.buf.subarray(this.pos,u);return this.pos=u,l},readPackedVarint:function(u,l){if(this.type!==Un.Bytes)return u.push(this.readVarint(l));var c=Uu(this);for(u=u||[];this.pos<c;)u.push(this.readVarint(l));return u},readPackedSVarint:function(u){if(this.type!==Un.Bytes)return u.push(this.readSVarint());var l=Uu(this);for(u=u||[];this.pos<l;)u.push(this.readSVarint());return u},readPackedBoolean:function(u){if(this.type!==Un.Bytes)return u.push(this.readBoolean());var l=Uu(this);for(u=u||[];this.pos<l;)u.push(this.readBoolean());return u},readPackedFloat:function(u){if(this.type!==Un.Bytes)return u.push(this.readFloat());var l=Uu(this);for(u=u||[];this.pos<l;)u.push(this.readFloat());return u},readPackedDouble:function(u){if(this.type!==Un.Bytes)return u.push(this.readDouble());var l=Uu(this);for(u=u||[];this.pos<l;)u.push(this.readDouble());return u},readPackedFixed32:function(u){if(this.type!==Un.Bytes)return u.push(this.readFixed32());var l=Uu(this);for(u=u||[];this.pos<l;)u.push(this.readFixed32());return u},readPackedSFixed32:function(u){if(this.type!==Un.Bytes)return u.push(this.readSFixed32());var l=Uu(this);for(u=u||[];this.pos<l;)u.push(this.readSFixed32());return u},readPackedFixed64:function(u){if(this.type!==Un.Bytes)return u.push(this.readFixed64());var l=Uu(this);for(u=u||[];this.pos<l;)u.push(this.readFixed64());return u},readPackedSFixed64:function(u){if(this.type!==Un.Bytes)return u.push(this.readSFixed64());var l=Uu(this);for(u=u||[];this.pos<l;)u.push(this.readSFixed64());return u},skip:function(u){var l=7&u;if(l===Un.Varint)for(;this.buf[this.pos++]>127;);else if(l===Un.Bytes)this.pos=this.readVarint()+this.pos;else if(l===Un.Fixed32)this.pos+=4;else{if(l!==Un.Fixed64)throw new Error("Unimplemented type: "+l);this.pos+=8}},writeTag:function(u,l){this.writeVarint(u<<3|l)},realloc:function(u){for(var l=this.length||16;l<this.pos+u;)l*=2;if(l!==this.length){var c=new Uint8Array(l);c.set(this.buf),this.buf=c,this.length=l}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(u){this.realloc(4),Lg(this.buf,u,this.pos),this.pos+=4},writeSFixed32:function(u){this.realloc(4),Lg(this.buf,u,this.pos),this.pos+=4},writeFixed64:function(u){this.realloc(8),Lg(this.buf,-1&u,this.pos),Lg(this.buf,Math.floor(u*mG),this.pos+4),this.pos+=8},writeSFixed64:function(u){this.realloc(8),Lg(this.buf,-1&u,this.pos),Lg(this.buf,Math.floor(u*mG),this.pos+4),this.pos+=8},writeVarint:function(u){(u=+u||0)>268435455||u<0?function(l,c){var d,g;if(l>=0?(d=l%4294967296|0,g=l/4294967296|0):(g=~(-l/4294967296),4294967295^(d=~(-l%4294967296))?d=d+1|0:(d=0,g=g+1|0)),l>=18446744073709552e3||l<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");c.realloc(10),function(_,w,C){C.buf[C.pos++]=127&_|128,_>>>=7,C.buf[C.pos++]=127&_|128,_>>>=7,C.buf[C.pos++]=127&_|128,_>>>=7,C.buf[C.pos++]=127&_|128,C.buf[C.pos]=127&(_>>>=7)}(d,0,c),function(_,w){var C=(7&_)<<4;w.buf[w.pos++]|=C|((_>>>=3)?128:0),_&&(w.buf[w.pos++]=127&_|((_>>>=7)?128:0),_&&(w.buf[w.pos++]=127&_|((_>>>=7)?128:0),_&&(w.buf[w.pos++]=127&_|((_>>>=7)?128:0),_&&(w.buf[w.pos++]=127&_|((_>>>=7)?128:0),_&&(w.buf[w.pos++]=127&_)))))}(g,c)}(u,this):(this.realloc(4),this.buf[this.pos++]=127&u|(u>127?128:0),u<=127||(this.buf[this.pos++]=127&(u>>>=7)|(u>127?128:0),u<=127||(this.buf[this.pos++]=127&(u>>>=7)|(u>127?128:0),u<=127||(this.buf[this.pos++]=u>>>7&127))))},writeSVarint:function(u){this.writeVarint(u<0?2*-u-1:2*u)},writeBoolean:function(u){this.writeVarint(!!u)},writeString:function(u){u=String(u),this.realloc(4*u.length),this.pos++;var l=this.pos;this.pos=function(d,g,_){for(var w,C,R=0;R<g.length;R++){if((w=g.charCodeAt(R))>55295&&w<57344){if(!C){w>56319||R+1===g.length?(d[_++]=239,d[_++]=191,d[_++]=189):C=w;continue}if(w<56320){d[_++]=239,d[_++]=191,d[_++]=189,C=w;continue}w=C-55296<<10|w-56320|65536,C=null}else C&&(d[_++]=239,d[_++]=191,d[_++]=189,C=null);w<128?d[_++]=w:(w<2048?d[_++]=w>>6|192:(w<65536?d[_++]=w>>12|224:(d[_++]=w>>18|240,d[_++]=w>>12&63|128),d[_++]=w>>6&63|128),d[_++]=63&w|128)}return _}(this.buf,u,this.pos);var c=this.pos-l;c>=128&&yG(l,c,this),this.pos=l-1,this.writeVarint(c),this.pos+=c},writeFloat:function(u){this.realloc(4),pG(this.buf,u,this.pos,!0,23,4),this.pos+=4},writeDouble:function(u){this.realloc(8),pG(this.buf,u,this.pos,!0,52,8),this.pos+=8},writeBytes:function(u){var l=u.length;this.writeVarint(l),this.realloc(l);for(var c=0;c<l;c++)this.buf[this.pos++]=u[c]},writeRawMessage:function(u,l){this.pos++;var c=this.pos;u(l,this);var d=this.pos-c;d>=128&&yG(c,d,this),this.pos=c-1,this.writeVarint(d),this.pos+=d},writeMessage:function(u,l,c){this.writeTag(u,Un.Bytes),this.writeRawMessage(l,c)},writePackedVarint:function(u,l){l.length&&this.writeMessage(u,rge,l)},writePackedSVarint:function(u,l){l.length&&this.writeMessage(u,nge,l)},writePackedBoolean:function(u,l){l.length&&this.writeMessage(u,age,l)},writePackedFloat:function(u,l){l.length&&this.writeMessage(u,ige,l)},writePackedDouble:function(u,l){l.length&&this.writeMessage(u,oge,l)},writePackedFixed32:function(u,l){l.length&&this.writeMessage(u,sge,l)},writePackedSFixed32:function(u,l){l.length&&this.writeMessage(u,lge,l)},writePackedFixed64:function(u,l){l.length&&this.writeMessage(u,uge,l)},writePackedSFixed64:function(u,l){l.length&&this.writeMessage(u,cge,l)},writeBytesField:function(u,l){this.writeTag(u,Un.Bytes),this.writeBytes(l)},writeFixed32Field:function(u,l){this.writeTag(u,Un.Fixed32),this.writeFixed32(l)},writeSFixed32Field:function(u,l){this.writeTag(u,Un.Fixed32),this.writeSFixed32(l)},writeFixed64Field:function(u,l){this.writeTag(u,Un.Fixed64),this.writeFixed64(l)},writeSFixed64Field:function(u,l){this.writeTag(u,Un.Fixed64),this.writeSFixed64(l)},writeVarintField:function(u,l){this.writeTag(u,Un.Varint),this.writeVarint(l)},writeSVarintField:function(u,l){this.writeTag(u,Un.Varint),this.writeSVarint(l)},writeStringField:function(u,l){this.writeTag(u,Un.Bytes),this.writeString(l)},writeFloatField:function(u,l){this.writeTag(u,Un.Fixed32),this.writeFloat(l)},writeDoubleField:function(u,l){this.writeTag(u,Un.Fixed64),this.writeDouble(l)},writeBooleanField:function(u,l){this.writeVarintField(u,!!l)}};class N${constructor(l,{pixelRatio:c,version:d,stretchX:g,stretchY:_,content:w}){this.paddedRect=l,this.pixelRatio=c,this.stretchX=g,this.stretchY=_,this.content=w,this.version=d}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class _G{constructor(l,c){const d={},g={};this.haveRenderCallbacks=[];const _=[];this.addImages(l,d,_),this.addImages(c,g,_);const{w,h:C}=L$(_),R=new Aa({width:w||1,height:C||1});for(const k in l){const D=l[k],N=d[k].paddedRect;Aa.copy(D.data,R,{x:0,y:0},{x:N.x+1,y:N.y+1},D.data)}for(const k in c){const D=c[k],N=g[k].paddedRect,F=N.x+1,G=N.y+1,Y=D.data.width,J=D.data.height;Aa.copy(D.data,R,{x:0,y:0},{x:F,y:G},D.data),Aa.copy(D.data,R,{x:0,y:J-1},{x:F,y:G-1},{width:Y,height:1}),Aa.copy(D.data,R,{x:0,y:0},{x:F,y:G+J},{width:Y,height:1}),Aa.copy(D.data,R,{x:Y-1,y:0},{x:F-1,y:G},{width:1,height:J}),Aa.copy(D.data,R,{x:0,y:0},{x:F+Y,y:G},{width:1,height:J})}this.image=R,this.iconPositions=d,this.patternPositions=g}addImages(l,c,d){for(const g in l){const _=l[g],w={x:0,y:0,w:_.data.width+2,h:_.data.height+2};d.push(w),c[g]=new N$(w,_),_.hasRenderCallback&&this.haveRenderCallbacks.push(g)}}patchUpdatedImages(l,c){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(d=>l.hasImage(d)),l.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const d in l.updatedImages)this.patchUpdatedImage(this.iconPositions[d],l.getImage(d),c),this.patchUpdatedImage(this.patternPositions[d],l.getImage(d),c)}patchUpdatedImage(l,c,d){if(!l||!c||l.version===c.version)return;l.version=c.version;const[g,_]=l.tl;d.update(c.data,void 0,{x:g,y:_})}}nr(N$,"ImagePosition"),nr(_G,"ImageAtlas");const Za={horizontal:1,vertical:2,horizontalOnly:3};class b0{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(l,c){const d=new b0;return d.scale=l||1,d.fontStack=c,d}static forImage(l){const c=new b0;return c.imageName=l,c}}class Ng{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(l,c){const d=new Ng;for(let g=0;g<l.sections.length;g++){const _=l.sections[g];_.image?d.addImageSection(_):d.addTextSection(_,c)}return d}length(){return this.text.length}getSection(l){return this.sections[this.sectionIndex[l]]}getSections(){return this.sections}getSectionIndex(l){return this.sectionIndex[l]}getCharCode(l){return this.text.charCodeAt(l)}verticalizePunctuation(l){this.text=function(c,d){let g="";for(let _=0;_<c.length;_++){const w=c.charCodeAt(_+1)||null,C=c.charCodeAt(_-1)||null;g+=!d&&(w&&L(w)&&!v0[c[_+1]]||C&&L(C)&&!v0[c[_-1]])||!v0[c[_]]?c[_]:v0[c[_]]}return g}(this.text,l)}trim(){let l=0;for(let d=0;d<this.text.length&&iO[this.text.charCodeAt(d)];d++)l++;let c=this.text.length;for(let d=this.text.length-1;d>=0&&d>=l&&iO[this.text.charCodeAt(d)];d--)c--;this.text=this.text.substring(l,c),this.sectionIndex=this.sectionIndex.slice(l,c)}substring(l,c){const d=new Ng;return d.text=this.text.substring(l,c),d.sectionIndex=this.sectionIndex.slice(l,c),d.sections=this.sections,d}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((l,c)=>Math.max(l,this.sections[c].scale),0)}addTextSection(l,c){this.text+=l.text,this.sections.push(b0.forText(l.scale,l.fontStack||c));const d=this.sections.length-1;for(let g=0;g<l.text.length;++g)this.sectionIndex.push(d)}addImageSection(l){const c=l.image?l.image.name:"";if(c.length===0)return void jt("Can't add FormattedSection with an empty image.");const d=this.getNextImageSectionCharCode();d?(this.text+=String.fromCharCode(d),this.sections.push(b0.forImage(c)),this.sectionIndex.push(this.sections.length-1)):jt("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function B$(u,l,c,d,g,_,w,C,R,k,D,N,F,G,Y){const J=Ng.fromFeature(u,g);N===Za.vertical&&J.verticalizePunctuation(F);let oe=[];const ge=function(ke,lt,it,xt,Bt,gt){if(!ke)return[];const Et=[],Rt=function(Yt,Er,er,lr,qt,Rr){let Jr=0;for(let Kr=0;Kr<Yt.length();Kr++){const Gr=Yt.getSection(Kr);Jr+=bG(Yt.getCharCode(Kr),Gr,lr,qt,Er,Rr)}return Jr/Math.max(1,Math.ceil(Jr/er))}(ke,lt,it,xt,Bt,gt),$t=ke.text.indexOf("")>=0;let Ft=0;for(let Yt=0;Yt<ke.length();Yt++){const Er=ke.getSection(Yt),er=ke.getCharCode(Yt);if(iO[er]||(Ft+=bG(er,Er,xt,Bt,lt,gt)),Yt<ke.length()-1){const lr=!((yt=er)<11904||!(ET(yt)||wg(yt)||v(yt)||MT(yt)||RT(yt)||CT(yt)||TT(yt)||Od(yt)||kT(yt)||Xw(yt)||OT(yt)||b(yt)||bg(yt)||Kw(yt)||Yw(yt)||qw(yt)||Tf(yt)||Rd(yt)||AT(yt)||PT(yt)));(pge[er]||lr||Er.imageName)&&Et.push(SG(Yt+1,Ft,Rt,Et,mge(er,ke.getCharCode(Yt+1),lr&&$t),!1))}}var yt;return xG(SG(ke.length(),Ft,Rt,Et,0,!0))}(J,k,_,l,d,G),{processBidirectionalText:Te,processStyledBidirectionalText:he}=Be;if(Te&&J.sections.length===1){const ke=Te(J.toString(),ge);for(const lt of ke){const it=new Ng;it.text=lt,it.sections=J.sections;for(let xt=0;xt<lt.length;xt++)it.sectionIndex.push(0);oe.push(it)}}else if(he){const ke=he(J.text,J.sectionIndex,ge);for(const lt of ke){const it=new Ng;it.text=lt[0],it.sectionIndex=lt[1],it.sections=J.sections,oe.push(it)}}else oe=function(ke,lt){const it=[],xt=ke.text;let Bt=0;for(const gt of lt)it.push(ke.substring(Bt,gt)),Bt=gt;return Bt<xt.length&&it.push(ke.substring(Bt,xt.length)),it}(J,ge);const xe=[],Me={positionedLines:xe,text:J.toString(),top:D[1],bottom:D[1],left:D[0],right:D[0],writingMode:N,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(ke,lt,it,xt,Bt,gt,Et,Rt,$t,Ft,yt,Yt){let Er=0,er=0,lr=0;const qt=Rt==="right"?1:Rt==="left"?0:.5;let Rr=!1;for(const Lr of Bt){const Qr=Lr.getSections();for(const Mn of Qr){if(Mn.imageName)continue;const Xn=lt[Mn.fontStack];if(Xn&&(Rr=Xn.ascender!==void 0&&Xn.descender!==void 0,!Rr))break}if(!Rr)break}let Jr=0;for(const Lr of Bt){Lr.trim();const Qr=Lr.getMaxScale(),Mn=(Qr-1)*Oo,Xn={positionedGlyphs:[],lineOffset:0};ke.positionedLines[Jr]=Xn;const Wn=Xn.positionedGlyphs;let Zn=0;if(!Lr.length()){er+=gt,++Jr;continue}let ei=0,gi=0;for(let An=0;An<Lr.length();An++){const Vi=Lr.getSection(An),Ai=Lr.getSectionIndex(An),Sn=Lr.getCharCode(An);let li=Vi.scale,Ki=null,$n=null,Ei=null,No=Oo,ho=0;const po=!($t===Za.horizontal||!yt&&!I(Sn)||yt&&(iO[Sn]||(Kr=Sn,Td(Kr)||xT(Kr)||Gw(Kr)||Sg(Kr)||m(Kr))));if(Vi.imageName){const qo=xt[Vi.imageName];if(!qo)continue;Ei=Vi.imageName,ke.iconsInText=ke.iconsInText||!0,$n=qo.paddedRect;const mo=qo.displaySize;li=li*Oo/Yt,Ki={width:mo[0],height:mo[1],left:1,top:-3,advance:po?mo[1]:mo[0],localGlyph:!1},ho=Rr?-Ki.height*li:Qr*Oo-17-mo[1]*li,No=Ki.advance;const Gu=(po?mo[0]:mo[1])*li-Oo*Qr;Gu>0&&Gu>Zn&&(Zn=Gu)}else{const qo=it[Vi.fontStack];if(!qo)continue;qo[Sn]&&($n=qo[Sn]);const mo=lt[Vi.fontStack];if(!mo)continue;const Gu=mo.glyphs[Sn];if(!Gu)continue;if(Ki=Gu.metrics,No=Sn!==8203?Oo:0,Rr){const Hg=mo.ascender!==void 0?Math.abs(mo.ascender):0,R0=mo.descender!==void 0?Math.abs(mo.descender):0,k0=(Hg+R0)*li;ei<k0&&(ei=k0,gi=(Hg-R0)/2*li),ho=-Hg*li}else ho=(Qr-li)*Oo-17}po?(ke.verticalizable=!0,Wn.push({glyph:Sn,imageName:Ei,x:Er,y:er+ho,vertical:po,scale:li,localGlyph:Ki.localGlyph,fontStack:Vi.fontStack,sectionIndex:Ai,metrics:Ki,rect:$n}),Er+=No*li+Ft):(Wn.push({glyph:Sn,imageName:Ei,x:Er,y:er+ho,vertical:po,scale:li,localGlyph:Ki.localGlyph,fontStack:Vi.fontStack,sectionIndex:Ai,metrics:Ki,rect:$n}),Er+=Ki.advance*li+Ft)}Wn.length!==0&&(lr=Math.max(Er-Ft,lr),Rr?CG(Wn,qt,Zn,gi,gt*Qr/2):CG(Wn,qt,Zn,0,gt/2)),Er=0;const fo=gt*Qr+Zn;Xn.lineOffset=Math.max(Zn,Mn),er+=fo,++Jr}var Kr;const Gr=er,{horizontalAlign:kr,verticalAlign:Pn}=j$(Et);(function(Lr,Qr,Mn,Xn,Wn,Zn){const ei=(Qr-Mn)*Wn,gi=-Zn*Xn;for(const fo of Lr)for(const An of fo.positionedGlyphs)An.x+=ei,An.y+=gi})(ke.positionedLines,qt,kr,Pn,lr,Gr),ke.top+=-Pn*Gr,ke.bottom=ke.top+Gr,ke.left+=-kr*lr,ke.right=ke.left+lr,ke.hasBaseline=Rr}(Me,l,c,d,oe,w,C,R,N,k,F,Y),!function(ke){for(const lt of ke)if(lt.positionedGlyphs.length!==0)return!1;return!0}(xe)&&Me}const iO={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},pge={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function bG(u,l,c,d,g,_){if(l.imageName){const w=d[l.imageName];return w?w.displaySize[0]*l.scale*Oo/_+g:0}{const w=c[l.fontStack],C=w&&w.glyphs[u];return C?C.metrics.advance*l.scale+g:0}}function wG(u,l,c,d){const g=Math.pow(u-l,2);return d?u<l?g/2:2*g:g+Math.abs(c)*c}function mge(u,l,c){let d=0;return u===10&&(d-=1e4),c&&(d+=150),u!==40&&u!==65288||(d+=50),l!==41&&l!==65289||(d+=50),d}function SG(u,l,c,d,g,_){let w=null,C=wG(l,c,g,_);for(const R of d){const k=wG(l-R.x,c,g,_)+R.badness;k<=C&&(w=R,C=k)}return{index:u,x:l,priorBreak:w,badness:C}}function xG(u){return u?xG(u.priorBreak).concat(u.index):[]}function j$(u){let l=.5,c=.5;switch(u){case"right":case"top-right":case"bottom-right":l=1;break;case"left":case"top-left":case"bottom-left":l=0}switch(u){case"bottom":case"bottom-right":case"bottom-left":c=1;break;case"top":case"top-right":case"top-left":c=0}return{horizontalAlign:l,verticalAlign:c}}function CG(u,l,c,d,g){if(!(l||c||d||g))return;const _=u.length-1,w=u[_],C=(w.x+w.metrics.advance*w.scale)*l;for(let R=0;R<=_;R++)u[R].x-=C,u[R].y+=c+d+g}function gge(u,l,c){const{horizontalAlign:d,verticalAlign:g}=j$(c),_=l[0]-u.displaySize[0]*d,w=l[1]-u.displaySize[1]*g;return{image:u,top:w,bottom:w+u.displaySize[1],left:_,right:_+u.displaySize[0]}}function EG(u,l,c,d,g,_){const w=u.image;let C;if(w.content){const oe=w.content,ge=w.pixelRatio||1;C=[oe[0]/ge,oe[1]/ge,w.displaySize[0]-oe[2]/ge,w.displaySize[1]-oe[3]/ge]}const R=l.left*_,k=l.right*_;let D,N,F,G;c==="width"||c==="both"?(G=g[0]+R-d[3],N=g[0]+k+d[1]):(G=g[0]+(R+k-w.displaySize[0])/2,N=G+w.displaySize[0]);const Y=l.top*_,J=l.bottom*_;return c==="height"||c==="both"?(D=g[1]+Y-d[0],F=g[1]+J+d[2]):(D=g[1]+(Y+J-w.displaySize[1])/2,F=D+w.displaySize[1]),{image:w,top:D,right:N,bottom:F,left:G,collisionPadding:C}}class Wu extends q{constructor(l,c,d,g,_){super(l,c),this.angle=g,this.z=d,_!==void 0&&(this.segment=_)}clone(){return new Wu(this.x,this.y,this.z,this.angle,this.segment)}}function TG(u,l,c,d,g){if(l.segment===void 0)return!0;let _=l,w=l.segment+1,C=0;for(;C>-c/2;){if(w--,w<0)return!1;C-=u[w].dist(_),_=u[w]}C+=u[w].dist(u[w+1]),w++;const R=[];let k=0;for(;C<c/2;){const D=u[w],N=u[w+1];if(!N)return!1;let F=u[w-1].angleTo(D)-D.angleTo(N);for(F=Math.abs((F+3*Math.PI)%(2*Math.PI)-Math.PI),R.push({distance:C,angleDelta:F}),k+=F;C-R[0].distance>d;)k-=R.shift().angleDelta;if(k>g)return!1;w++,C+=D.dist(N)}return!0}function OG(u){let l=0;for(let c=0;c<u.length-1;c++)l+=u[c].dist(u[c+1]);return l}function RG(u,l,c){return u?.6*l*c:0}function kG(u,l){return Math.max(u?u.right-u.left:0,l?l.right-l.left:0)}function yge(u,l,c,d,g,_){const w=RG(c,g,_),C=kG(c,d)*_;let R=0;const k=OG(u)/2;for(let D=0;D<u.length-1;D++){const N=u[D],F=u[D+1],G=N.dist(F);if(R+G>k){const Y=(k-R)/G,J=gn(N.x,F.x,Y),oe=gn(N.y,F.y,Y),ge=new Wu(J,oe,0,F.angleTo(N),D);return!w||TG(u,ge,C,w,l)?ge:void 0}R+=G}}function vge(u,l,c,d,g,_,w,C,R){const k=RG(d,_,w),D=kG(d,g),N=D*w,F=u[0].x===0||u[0].x===R||u[0].y===0||u[0].y===R;return l-N<l/4&&(l=N+l/4),PG(u,F?l/2*C%l:(D/2+2*_)*w*C%l,l,k,c,N,F,!1,R)}function PG(u,l,c,d,g,_,w,C,R){const k=_/2,D=OG(u);let N=0,F=l-c,G=[];for(let Y=0;Y<u.length-1;Y++){const J=u[Y],oe=u[Y+1],ge=J.dist(oe),Te=oe.angleTo(J);for(;F+c<N+ge;){F+=c;const he=(F-N)/ge,xe=gn(J.x,oe.x,he),Me=gn(J.y,oe.y,he);if(xe>=0&&xe<R&&Me>=0&&Me<R&&F-k>=0&&F+k<=D){const ke=new Wu(xe,Me,0,Te,Y);ke._round(),d&&!TG(u,ke,_,d,g)||G.push(ke)}}N+=ge}return C||G.length||w||(G=PG(u,N/2,c,d,g,_,w,!0,R)),G}function AG(u,l,c,d,g){const _=[];for(let w=0;w<u.length;w++){const C=u[w];let R;for(let k=0;k<C.length-1;k++){let D=C[k],N=C[k+1];D.x<l&&N.x<l||(D.x<l?D=new q(l,D.y+(l-D.x)/(N.x-D.x)*(N.y-D.y))._round():N.x<l&&(N=new q(l,D.y+(l-D.x)/(N.x-D.x)*(N.y-D.y))._round()),D.y<c&&N.y<c||(D.y<c?D=new q(D.x+(c-D.y)/(N.y-D.y)*(N.x-D.x),c)._round():N.y<c&&(N=new q(D.x+(c-D.y)/(N.y-D.y)*(N.x-D.x),c)._round()),D.x>=d&&N.x>=d||(D.x>=d?D=new q(d,D.y+(d-D.x)/(N.x-D.x)*(N.y-D.y))._round():N.x>=d&&(N=new q(d,D.y+(d-D.x)/(N.x-D.x)*(N.y-D.y))._round()),D.y>=g&&N.y>=g||(D.y>=g?D=new q(D.x+(g-D.y)/(N.y-D.y)*(N.x-D.x),g)._round():N.y>=g&&(N=new q(D.x+(g-D.y)/(N.y-D.y)*(N.x-D.x),g)._round()),R&&D.equals(R[R.length-1])||(R=[D],_.push(R)),R.push(N)))))}}return _}nr(Wu,"Anchor");const w0=1e20;function IG(u,l,c,d,g,_,w,C,R){for(let k=l;k<l+d;k++)MG(u,c*_+k,_,g,w,C,R);for(let k=c;k<c+g;k++)MG(u,k*_+l,1,d,w,C,R)}function MG(u,l,c,d,g,_,w){_[0]=0,w[0]=-w0,w[1]=w0,g[0]=u[l];for(let C=1,R=0,k=0;C<d;C++){g[C]=u[l+C*c];const D=C*C;do{const N=_[R];k=(g[C]-g[N]+D-N*N)/(C-N)/2}while(k<=w[R]&&--R>-1);R++,_[R]=C,w[R]=k,w[R+1]=w0}for(let C=0,R=0;C<d;C++){for(;w[R+1]<C;)R++;const k=_[R],D=C-k;u[l+C*c]=g[k]+D*D}}const F$={none:0,ideographs:1,all:2};class Bg{constructor(l,c,d){this.requestManager=l,this.localGlyphMode=c,this.localFontFamily=d,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(l){this.url=l}getGlyphs(l,c){const d=[];for(const g in l)for(const _ of l[g])d.push({stack:g,id:_});ie(d,({stack:g,id:_},w)=>{let C=this.entries[g];C||(C=this.entries[g]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let R=C.glyphs[_];if(R!==void 0)return void w(null,{stack:g,id:_,glyph:R});if(R=this._tinySDF(C,g,_),R)return C.glyphs[_]=R,void w(null,{stack:g,id:_,glyph:R});const k=Math.floor(_/256);if(256*k>65535)return void w(new Error("glyphs > 65535 not supported"));if(C.ranges[k])return void w(null,{stack:g,id:_,glyph:R});let D=C.requests[k];D||(D=C.requests[k]=[],Bg.loadGlyphRange(g,k,this.url,this.requestManager,(N,F)=>{if(F){C.ascender=F.ascender,C.descender=F.descender;for(const G in F.glyphs)this._doesCharSupportLocalGlyph(+G)||(C.glyphs[+G]=F.glyphs[+G]);C.ranges[k]=!0}for(const G of D)G(N,F);delete C.requests[k]})),D.push((N,F)=>{N?w(N):F&&w(null,{stack:g,id:_,glyph:F.glyphs[_]||null})})},(g,_)=>{if(g)c(g);else if(_){const w={};for(const{stack:C,id:R,glyph:k}of _)w[C]===void 0&&(w[C]={}),w[C].glyphs===void 0&&(w[C].glyphs={}),w[C].glyphs[R]=k&&{id:k.id,bitmap:k.bitmap.clone(),metrics:k.metrics},w[C].ascender=this.entries[C].ascender,w[C].descender=this.entries[C].descender;c(null,w)}})}_doesCharSupportLocalGlyph(l){return this.localGlyphMode!==F$.none&&(this.localGlyphMode===F$.all?!!this.localFontFamily:!!this.localFontFamily&&(Xw(l)||IT(l)||bg(l)||Tf(l)||Od(l)))}_tinySDF(l,c,d){const g=this.localFontFamily;if(!g||!this._doesCharSupportLocalGlyph(d))return;let _=l.tinySDF;if(!_){let J="400";/bold/i.test(c)?J="900":/medium/i.test(c)?J="500":/light/i.test(c)&&(J="200"),_=l.tinySDF=new Bg.TinySDF({fontFamily:g,fontWeight:J,fontSize:48,buffer:6,radius:16}),_.fontWeight=J}if(this.localGlyphs[_.fontWeight][d])return this.localGlyphs[_.fontWeight][d];const w=String.fromCharCode(d),{data:C,width:R,height:k,glyphWidth:D,glyphHeight:N,glyphLeft:F,glyphTop:G,glyphAdvance:Y}=_.draw(w);return this.localGlyphs[_.fontWeight][d]={id:d,bitmap:new Vu({width:R,height:k},C),metrics:{width:D/2,height:N/2,left:F/2,top:G/2-27,advance:Y/2,localGlyph:!0}}}}function $G(u,l,c,d){const g=[],_=u.image,w=_.pixelRatio,C=_.paddedRect.w-2,R=_.paddedRect.h-2,k=u.right-u.left,D=u.bottom-u.top,N=_.stretchX||[[0,C]],F=_.stretchY||[[0,R]],G=(gt,Et)=>gt+Et[1]-Et[0],Y=N.reduce(G,0),J=F.reduce(G,0),oe=C-Y,ge=R-J;let Te=0,he=Y,xe=0,Me=J,ke=0,lt=oe,it=0,xt=ge;if(_.content&&d){const gt=_.content;Te=oO(N,0,gt[0]),xe=oO(F,0,gt[1]),he=oO(N,gt[0],gt[2]),Me=oO(F,gt[1],gt[3]),ke=gt[0]-Te,it=gt[1]-xe,lt=gt[2]-gt[0]-he,xt=gt[3]-gt[1]-Me}const Bt=(gt,Et,Rt,$t)=>{const Ft=aO(gt.stretch-Te,he,k,u.left),yt=sO(gt.fixed-ke,lt,gt.stretch,Y),Yt=aO(Et.stretch-xe,Me,D,u.top),Er=sO(Et.fixed-it,xt,Et.stretch,J),er=aO(Rt.stretch-Te,he,k,u.left),lr=sO(Rt.fixed-ke,lt,Rt.stretch,Y),qt=aO($t.stretch-xe,Me,D,u.top),Rr=sO($t.fixed-it,xt,$t.stretch,J),Jr=new q(Ft,Yt),Kr=new q(er,Yt),Gr=new q(er,qt),kr=new q(Ft,qt),Pn=new q(yt/w,Er/w),Lr=new q(lr/w,Rr/w),Qr=l*Math.PI/180;if(Qr){const Wn=Math.sin(Qr),Zn=Math.cos(Qr),ei=[Zn,-Wn,Wn,Zn];Jr._matMult(ei),Kr._matMult(ei),kr._matMult(ei),Gr._matMult(ei)}const Mn=gt.stretch+gt.fixed,Xn=Et.stretch+Et.fixed;return{tl:Jr,tr:Kr,bl:kr,br:Gr,tex:{x:_.paddedRect.x+1+Mn,y:_.paddedRect.y+1+Xn,w:Rt.stretch+Rt.fixed-Mn,h:$t.stretch+$t.fixed-Xn},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Pn,pixelOffsetBR:Lr,minFontScaleX:lt/w/k,minFontScaleY:xt/w/D,isSDF:c}};if(d&&(_.stretchX||_.stretchY)){const gt=DG(N,oe,Y),Et=DG(F,ge,J);for(let Rt=0;Rt<gt.length-1;Rt++){const $t=gt[Rt],Ft=gt[Rt+1];for(let yt=0;yt<Et.length-1;yt++)g.push(Bt($t,Et[yt],Ft,Et[yt+1]))}}else g.push(Bt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:C+1},{fixed:0,stretch:R+1}));return g}function oO(u,l,c){let d=0;for(const g of u)d+=Math.max(l,Math.min(c,g[1]))-Math.max(l,Math.min(c,g[0]));return d}function DG(u,l,c){const d=[{fixed:-1,stretch:0}];for(const[g,_]of u){const w=d[d.length-1];d.push({fixed:g-w.stretch,stretch:w.stretch}),d.push({fixed:g-w.stretch,stretch:w.stretch+(_-g)})}return d.push({fixed:l+1,stretch:c}),d}function aO(u,l,c,d){return u/l*c+d}function sO(u,l,c,d){return u-l*c/d}function _ge(u,l,c,d){const g=l+u.positionedLines[d].lineOffset;return d===0?c+g/2:c+(g+(l+u.positionedLines[d-1].lineOffset))/2}Bg.loadGlyphRange=function(u,l,c,d,g){const _=256*l,w=_+255,C=d.transformRequest(d.normalizeGlyphsURL(c).replace("{fontstack}",u).replace("{range}",`${_}-${w}`),mt.Glyphs);Ir(C,(R,k)=>{if(R)g(R);else if(k){const D={},N=function(F){return new _0(F).readFields(fge,{})}(k);for(const F of N.glyphs)D[F.id]=F;g(null,{glyphs:D,ascender:N.ascender,descender:N.descender})}})},Bg.TinySDF=class{constructor({fontSize:u=24,buffer:l=3,radius:c=8,cutoff:d=.25,fontFamily:g="sans-serif",fontWeight:_="normal",fontStyle:w="normal"}={}){this.buffer=l,this.cutoff=d,this.radius=c;const C=this.size=u+4*l,R=this._createCanvas(C),k=this.ctx=R.getContext("2d",{willReadFrequently:!0});k.font=`${w} ${_} ${u}px ${g}`,k.textBaseline="alphabetic",k.textAlign="left",k.fillStyle="black",this.gridOuter=new Float64Array(C*C),this.gridInner=new Float64Array(C*C),this.f=new Float64Array(C),this.z=new Float64Array(C+1),this.v=new Uint16Array(C)}_createCanvas(u){const l=document.createElement("canvas");return l.width=l.height=u,l}draw(u){const{width:l,actualBoundingBoxAscent:c,actualBoundingBoxDescent:d,actualBoundingBoxLeft:g,actualBoundingBoxRight:_}=this.ctx.measureText(u),w=Math.ceil(c),C=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(_-g))),R=Math.min(this.size-this.buffer,w+Math.ceil(d)),k=C+2*this.buffer,D=R+2*this.buffer,N=Math.max(k*D,0),F=new Uint8ClampedArray(N),G={data:F,width:k,height:D,glyphWidth:C,glyphHeight:R,glyphTop:w,glyphLeft:0,glyphAdvance:l};if(C===0||R===0)return G;const{ctx:Y,buffer:J,gridInner:oe,gridOuter:ge}=this;Y.clearRect(J,J,C,R),Y.fillText(u,J,J+w);const Te=Y.getImageData(J,J,C,R);ge.fill(w0,0,N),oe.fill(0,0,N);for(let he=0;he<R;he++)for(let xe=0;xe<C;xe++){const Me=Te.data[4*(he*C+xe)+3]/255;if(Me===0)continue;const ke=(he+J)*k+xe+J;if(Me===1)ge[ke]=0,oe[ke]=w0;else{const lt=.5-Me;ge[ke]=lt>0?lt*lt:0,oe[ke]=lt<0?lt*lt:0}}IG(ge,0,0,k,D,k,this.f,this.v,this.z),IG(oe,J,J,C,R,k,this.f,this.v,this.z);for(let he=0;he<N;he++){const xe=Math.sqrt(ge[he])-Math.sqrt(oe[he]);F[he]=Math.round(255-255*(xe/this.radius+this.cutoff))}return G}};class bge{constructor(l=[],c=wge){if(this.data=l,this.length=this.data.length,this.compare=c,this.length>0)for(let d=(this.length>>1)-1;d>=0;d--)this._down(d)}push(l){this.data.push(l),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const l=this.data[0],c=this.data.pop();return this.length--,this.length>0&&(this.data[0]=c,this._down(0)),l}peek(){return this.data[0]}_up(l){const{data:c,compare:d}=this,g=c[l];for(;l>0;){const _=l-1>>1,w=c[_];if(d(g,w)>=0)break;c[l]=w,l=_}c[l]=g}_down(l){const{data:c,compare:d}=this,g=this.length>>1,_=c[l];for(;l<g;){let w=1+(l<<1),C=c[w];const R=w+1;if(R<this.length&&d(c[R],C)<0&&(w=R,C=c[R]),d(C,_)>=0)break;c[l]=C,l=w}c[l]=_}}function wge(u,l){return u<l?-1:u>l?1:0}function Sge(u,l=1,c=!1){let d=1/0,g=1/0,_=-1/0,w=-1/0;const C=u[0];for(let G=0;G<C.length;G++){const Y=C[G];(!G||Y.x<d)&&(d=Y.x),(!G||Y.y<g)&&(g=Y.y),(!G||Y.x>_)&&(_=Y.x),(!G||Y.y>w)&&(w=Y.y)}const R=Math.min(_-d,w-g);let k=R/2;const D=new bge([],xge);if(R===0)return new q(d,g);for(let G=d;G<_;G+=R)for(let Y=g;Y<w;Y+=R)D.push(new jg(G+k,Y+k,k,u));let N=function(G){let Y=0,J=0,oe=0;const ge=G[0];for(let Te=0,he=ge.length,xe=he-1;Te<he;xe=Te++){const Me=ge[Te],ke=ge[xe],lt=Me.x*ke.y-ke.x*Me.y;J+=(Me.x+ke.x)*lt,oe+=(Me.y+ke.y)*lt,Y+=3*lt}return new jg(J/Y,oe/Y,0,G)}(u),F=D.length;for(;D.length;){const G=D.pop();(G.d>N.d||!N.d)&&(N=G,c&&console.log("found best %d after %d probes",Math.round(1e4*G.d)/1e4,F)),G.max-N.d<=l||(k=G.h/2,D.push(new jg(G.p.x-k,G.p.y-k,k,u)),D.push(new jg(G.p.x+k,G.p.y-k,k,u)),D.push(new jg(G.p.x-k,G.p.y+k,k,u)),D.push(new jg(G.p.x+k,G.p.y+k,k,u)),F+=4)}return c&&(console.log(`num probes: ${F}`),console.log(`best distance: ${N.d}`)),N.p}function xge(u,l){return l.max-u.max}class jg{constructor(l,c,d,g){this.p=new q(l,c),this.h=d,this.d=function(_,w){let C=!1,R=1/0;for(let k=0;k<w.length;k++){const D=w[k];for(let N=0,F=D.length,G=F-1;N<F;G=N++){const Y=D[N],J=D[G];Y.y>_.y!=J.y>_.y&&_.x<(J.x-Y.x)*(_.y-Y.y)/(J.y-Y.y)+Y.x&&(C=!C),R=Math.min(R,M5(_,Y,J))}}return(C?1:-1)*Math.sqrt(R)}(this.p,g),this.max=this.d+this.h*Math.SQRT2}}const z$=Number.POSITIVE_INFINITY,Cge=Math.sqrt(2);function LG(u,[l,c]){let d=0,g=0;if(c===z$){l<0&&(l=0);const _=l/Cge;switch(u){case"top-right":case"top-left":g=_-7;break;case"bottom-right":case"bottom-left":g=7-_;break;case"bottom":g=7-l;break;case"top":g=l-7}switch(u){case"top-right":case"bottom-right":d=-_;break;case"top-left":case"bottom-left":d=_;break;case"left":d=l;break;case"right":d=-l}}else{switch(l=Math.abs(l),c=Math.abs(c),u){case"top-right":case"top-left":case"top":g=c-7;break;case"bottom-right":case"bottom-left":case"bottom":g=7-c}switch(u){case"top-right":case"bottom-right":case"right":d=-l;break;case"top-left":case"bottom-left":case"left":d=l}}return[d,g]}function Ege(u,l,c,d,g,_,w,C,R,k){u.createArrays(),u.tilePixelRatio=Pr/(512*u.overscaling),u.compareText={},u.iconsNeedLinear=!1;const D=u.layers[0].layout,N=u.layers[0]._unevaluatedLayout._values,F={};if(u.textSizeData.kind==="composite"){const{minZoom:J,maxZoom:oe}=u.textSizeData;F.compositeTextSizes=[N["text-size"].possiblyEvaluate(new Ze(J),C),N["text-size"].possiblyEvaluate(new Ze(oe),C)]}if(u.iconSizeData.kind==="composite"){const{minZoom:J,maxZoom:oe}=u.iconSizeData;F.compositeIconSizes=[N["icon-size"].possiblyEvaluate(new Ze(J),C),N["icon-size"].possiblyEvaluate(new Ze(oe),C)]}F.layoutTextSize=N["text-size"].possiblyEvaluate(new Ze(R+1),C),F.layoutIconSize=N["icon-size"].possiblyEvaluate(new Ze(R+1),C),F.textMaxSize=N["text-size"].possiblyEvaluate(new Ze(18),C);const G=D.get("text-rotation-alignment")==="map"&&D.get("symbol-placement")!=="point",Y=D.get("text-size");for(const J of u.features){const oe=D.get("text-font").evaluate(J,{},C).join(","),ge=Y.evaluate(J,{},C),Te=F.layoutTextSize.evaluate(J,{},C),he=(F.layoutIconSize.evaluate(J,{},C),{horizontal:{},vertical:void 0}),xe=J.text;let Me,ke=[0,0];if(xe){const xt=xe.toString(),Bt=D.get("text-letter-spacing").evaluate(J,{},C)*Oo,gt=D.get("text-line-height").evaluate(J,{},C)*Oo,Et=T(xt)?Bt:0,Rt=D.get("text-anchor").evaluate(J,{},C),$t=D.get("text-variable-anchor");if(!$t){const er=D.get("text-radial-offset").evaluate(J,{},C);ke=er?LG(Rt,[er*Oo,z$]):D.get("text-offset").evaluate(J,{},C).map(lr=>lr*Oo)}let Ft=G?"center":D.get("text-justify").evaluate(J,{},C);const yt=D.get("symbol-placement")==="point",Yt=yt?D.get("text-max-width").evaluate(J,{},C)*Oo:1/0,Er=er=>{u.allowVerticalPlacement&&x(xt)&&(he.vertical=B$(xe,l,c,g,oe,Yt,gt,Rt,er,Et,ke,Za.vertical,!0,Te,ge))};if(!G&&$t){const er=Ft==="auto"?$t.map(qt=>H$(qt)):[Ft];let lr=!1;for(let qt=0;qt<er.length;qt++){const Rr=er[qt];if(!he.horizontal[Rr])if(lr)he.horizontal[Rr]=he.horizontal[0];else{const Jr=B$(xe,l,c,g,oe,Yt,gt,"center",Rr,Et,ke,Za.horizontal,!1,Te,ge);Jr&&(he.horizontal[Rr]=Jr,lr=Jr.positionedLines.length===1)}}Er("left")}else{if(Ft==="auto"&&(Ft=H$(Rt)),yt||D.get("text-writing-mode").indexOf("horizontal")>=0||!x(xt)){const er=B$(xe,l,c,g,oe,Yt,gt,Rt,Ft,Et,ke,Za.horizontal,!1,Te,ge);er&&(he.horizontal[Ft]=er)}Er(yt?"left":Ft)}}let lt=!1;if(J.icon&&J.icon.name){const xt=d[J.icon.name];xt&&(Me=gge(g[J.icon.name],D.get("icon-offset").evaluate(J,{},C),D.get("icon-anchor").evaluate(J,{},C)),lt=xt.sdf,u.sdfIcons===void 0?u.sdfIcons=xt.sdf:u.sdfIcons!==xt.sdf&&jt("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(xt.pixelRatio!==u.pixelRatio||D.get("icon-rotate").constantOr(1)!==0)&&(u.iconsNeedLinear=!0))}const it=BG(he.horizontal)||he.vertical;u.iconsInText||(u.iconsInText=!!it&&it.iconsInText),(it||Me)&&Tge(u,J,he,Me,d,F,Te,0,ke,lt,w,C,k)}_&&u.generateCollisionDebugBuffers(R,u.collisionBoxArray)}function H$(u){switch(u){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Tge(u,l,c,d,g,_,w,C,R,k,D,N,F){let G=_.textMaxSize.evaluate(l,{},N);G===void 0&&(G=w);const Y=u.layers[0].layout,J=Y.get("icon-offset").evaluate(l,{},N),oe=BG(c.horizontal)||c.vertical,ge=F.name==="globe",Te=w/24,he=u.tilePixelRatio*G/24,xe=(Et=u.overscaling,u.zoom>18&&Et>2&&(Et>>=1),Math.max(Pr/(512*Et),1)*Y.get("symbol-spacing")),Me=Y.get("text-padding")*u.tilePixelRatio,ke=Y.get("icon-padding")*u.tilePixelRatio,lt=Le(Y.get("text-max-angle")),it=Y.get("text-rotation-alignment")==="map"&&Y.get("symbol-placement")!=="point",xt=Y.get("icon-rotation-alignment")==="map"&&Y.get("symbol-placement")!=="point",Bt=Y.get("symbol-placement"),gt=xe/2;var Et;const Rt=Y.get("icon-text-fit");let $t;d&&Rt!=="none"&&(u.allowVerticalPlacement&&c.vertical&&($t=EG(d,c.vertical,Rt,Y.get("icon-text-fit-padding"),J,Te)),oe&&(d=EG(d,oe,Rt,Y.get("icon-text-fit-padding"),J,Te)));const Ft=(yt,Yt,Er)=>{if(Yt.x<0||Yt.x>=Pr||Yt.y<0||Yt.y>=Pr)return;let er=null;if(ge){const{x:lr,y:qt,z:Rr}=F.projectTilePoint(Yt.x,Yt.y,Er);er={anchor:new Wu(lr,qt,Rr,0,void 0),up:F.upVector(Er,Yt.x,Yt.y)}}(function(lr,qt,Rr,Jr,Kr,Gr,kr,Pn,Lr,Qr,Mn,Xn,Wn,Zn,ei,gi,fo,An,Vi,Ai,Sn,li,Ki,$n,Ei){const No=lr.addToLineVertexArray(qt,Jr);let ho,po,qo,mo,Gu,Hg,R0,k0=0,d6=0,p6=0,m6=0,eD=-1,tD=-1;const Xl={};let g6=kd("");const zd=Rr?Rr.anchor:qt;let rD=0,nD=0;if(Lr._unevaluatedLayout.getValue("text-radial-offset")===void 0?[rD,nD]=Lr.layout.get("text-offset").evaluate(Sn,{},Ei).map(Ia=>Ia*Oo):(rD=Lr.layout.get("text-radial-offset").evaluate(Sn,{},Ei)*Oo,nD=z$),lr.allowVerticalPlacement&&Kr.vertical){const Ia=Kr.vertical;if(ei)Hg=V$(Ia),Pn&&(R0=V$(Pn));else{const Ma=Lr.layout.get("text-rotate").evaluate(Sn,{},Ei)+90;qo=lO(Qr,zd,qt,Mn,Xn,Wn,Ia,Zn,Ma,gi),Pn&&(mo=lO(Qr,zd,qt,Mn,Xn,Wn,Pn,An,Ma))}}if(Gr){const Ia=Lr.layout.get("icon-rotate").evaluate(Sn,{},Ei),Ma=Lr.layout.get("icon-text-fit")!=="none",P0=$G(Gr,Ia,Ki,Ma),oD=Pn?$G(Pn,Ia,Ki,Ma):void 0;po=lO(Qr,zd,qt,Mn,Xn,Wn,Gr,An,Ia),k0=4*P0.length;const y6=lr.iconSizeData;let Hd=null;y6.kind==="source"?(Hd=[Gl*Lr.layout.get("icon-size").evaluate(Sn,{},Ei)],Hd[0]>If&&jt(`${lr.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):y6.kind==="composite"&&(Hd=[Gl*li.compositeIconSizes[0].evaluate(Sn,{},Ei),Gl*li.compositeIconSizes[1].evaluate(Sn,{},Ei)],(Hd[0]>If||Hd[1]>If)&&jt(`${lr.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),lr.addSymbols(lr.icon,P0,Hd,Ai,Vi,Sn,!1,Rr,qt,No.lineStartIndex,No.lineLength,-1,$n,Ei),eD=lr.icon.placedSymbolArray.length-1,oD&&(d6=4*oD.length,lr.addSymbols(lr.icon,oD,Hd,Ai,Vi,Sn,Za.vertical,Rr,qt,No.lineStartIndex,No.lineLength,-1,$n,Ei),tD=lr.icon.placedSymbolArray.length-1)}for(const Ia in Kr.horizontal){const Ma=Kr.horizontal[Ia];ho||(g6=kd(Ma.text),ei?Gu=V$(Ma):ho=lO(Qr,zd,qt,Mn,Xn,Wn,Ma,Zn,Lr.layout.get("text-rotate").evaluate(Sn,{},Ei),gi));const P0=Ma.positionedLines.length===1;if(p6+=NG(lr,Rr,qt,Ma,kr,Lr,ei,Sn,gi,No,Kr.vertical?Za.horizontal:Za.horizontalOnly,P0?Object.keys(Kr.horizontal):[Ia],Xl,eD,li,$n,Ei),P0)break}Kr.vertical&&(m6+=NG(lr,Rr,qt,Kr.vertical,kr,Lr,ei,Sn,gi,No,Za.vertical,["vertical"],Xl,tD,li,$n,Ei));let Bf=-1;const iD=(Ia,Ma)=>Ia?Math.max(Ia,Ma):Ma;Bf=iD(Gu,Bf),Bf=iD(Hg,Bf),Bf=iD(R0,Bf);const eye=Bf>-1?1:0;lr.glyphOffsetArray.length>=$f.MAX_GLYPHS&&jt("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Sn.sortKey!==void 0&&lr.addToSortKeyRanges(lr.symbolInstances.length,Sn.sortKey),lr.symbolInstances.emplaceBack(zd.x,zd.y,zd.z,qt.x,qt.y,Xl.right>=0?Xl.right:-1,Xl.center>=0?Xl.center:-1,Xl.left>=0?Xl.left:-1,Xl.vertical>=0?Xl.vertical:-1,eD,tD,g6,ho!==void 0?ho:lr.collisionBoxArray.length,ho!==void 0?ho+1:lr.collisionBoxArray.length,qo!==void 0?qo:lr.collisionBoxArray.length,qo!==void 0?qo+1:lr.collisionBoxArray.length,po!==void 0?po:lr.collisionBoxArray.length,po!==void 0?po+1:lr.collisionBoxArray.length,mo||lr.collisionBoxArray.length,mo?mo+1:lr.collisionBoxArray.length,Mn,p6,m6,k0,d6,eye,0,rD,nD,Bf)})(u,Yt,er,yt,c,d,g,$t,u.layers[0],u.collisionBoxArray,l.index,l.sourceLayerIndex,u.index,Me,it,R,0,ke,xt,J,l,_,k,D,N)};if(Bt==="line")for(const yt of AG(l.geometry,0,0,Pr,Pr)){const Yt=vge(yt,xe,lt,c.vertical||oe,d,24,he,u.overscaling,Pr);for(const Er of Yt){const er=oe;er&&Oge(u,er.text,gt,Er)||Ft(yt,Er,N)}}else if(Bt==="line-center"){for(const yt of l.geometry)if(yt.length>1){const Yt=yge(yt,lt,c.vertical||oe,d,24,he);Yt&&Ft(yt,Yt,N)}}else if(l.type==="Polygon")for(const yt of P$(l.geometry,0)){const Yt=Sge(yt,16);Ft(yt[0],new Wu(Yt.x,Yt.y,0,0,void 0),N)}else if(l.type==="LineString")for(const yt of l.geometry)Ft(yt,new Wu(yt[0].x,yt[0].y,0,0,void 0),N);else if(l.type==="Point")for(const yt of l.geometry)for(const Yt of yt)Ft([Yt],new Wu(Yt.x,Yt.y,0,0,void 0),N)}const If=32640;function NG(u,l,c,d,g,_,w,C,R,k,D,N,F,G,Y,J,oe){const ge=function(xe,Me,ke,lt,it,xt,Bt,gt){const Et=[];if(Me.positionedLines.length===0)return Et;const Rt=lt.layout.get("text-rotate").evaluate(xt,{})*Math.PI/180,$t=function(er){const lr=er[0],qt=er[1],Rr=lr*qt;return Rr>0?[lr,-qt]:Rr<0?[-lr,qt]:lr===0?[qt,lr]:[qt,-lr]}(ke);let Ft=Math.abs(Me.top-Me.bottom);for(const er of Me.positionedLines)Ft-=er.lineOffset;const yt=Me.positionedLines.length,Yt=Ft/yt;let Er=Me.top-ke[1];for(let er=0;er<yt;++er){const lr=Me.positionedLines[er];Er=_ge(Me,Yt,Er,er);for(const qt of lr.positionedGlyphs){if(!qt.rect)continue;const Rr=qt.rect||{};let Jr=4,Kr=!0,Gr=1,kr=0;if(qt.imageName){const $n=Bt[qt.imageName];if(!$n)continue;if($n.sdf){jt("SDF images are not supported in formatted text and will be ignored.");continue}Kr=!1,Gr=$n.pixelRatio,Jr=1/Gr}const Pn=(it||gt)&&qt.vertical,Lr=qt.metrics.advance*qt.scale/2,Qr=qt.metrics,Mn=qt.rect;if(Mn===null)continue;gt&&Me.verticalizable&&(kr=qt.imageName?Lr-qt.metrics.width*qt.scale/2:0);const Xn=it?[qt.x+Lr,qt.y]:[0,0];let Wn=[0,0],Zn=[0,0],ei=!1;it||(Pn?(Zn=[qt.x+Lr+$t[0],qt.y+$t[1]-kr],ei=!0):Wn=[qt.x+Lr+ke[0],qt.y+ke[1]-kr]);const gi=Mn.w*qt.scale/(Gr*(qt.localGlyph?2:1)),fo=Mn.h*qt.scale/(Gr*(qt.localGlyph?2:1));let An,Vi,Ai,Sn;if(Pn){const $n=qt.y-Er,Ei=new q(-Lr,Lr-$n),No=-Math.PI/2,ho=new q(...Zn);An=new q(-Lr+Wn[0],Wn[1]),An._rotateAround(No,Ei)._add(ho),An.x+=-$n+Lr,An.y-=(Qr.left-Jr)*qt.scale;const po=qt.imageName?Qr.advance*qt.scale:Oo*qt.scale,qo=String.fromCharCode(qt.glyph);ege(qo)?An.x+=(1-Jr)*qt.scale:tge(qo)?An.x+=po-Qr.height*qt.scale+(-Jr-1)*qt.scale:An.x+=qt.imageName||Qr.width+2*Jr===Mn.w&&Qr.height+2*Jr===Mn.h?(po-fo)/2:(po-(Qr.height+2*Jr)*qt.scale)/2,Vi=new q(An.x,An.y-gi),Ai=new q(An.x+fo,An.y),Sn=new q(An.x+fo,An.y-gi)}else{const $n=(Qr.left-Jr)*qt.scale-Lr+Wn[0],Ei=(-Qr.top-Jr)*qt.scale+Wn[1],No=$n+gi,ho=Ei+fo;An=new q($n,Ei),Vi=new q(No,Ei),Ai=new q($n,ho),Sn=new q(No,ho)}if(Rt){let $n;$n=it?new q(0,0):ei?new q($t[0],$t[1]):new q(ke[0],ke[1]),An._rotateAround(Rt,$n),Vi._rotateAround(Rt,$n),Ai._rotateAround(Rt,$n),Sn._rotateAround(Rt,$n)}const li=new q(0,0),Ki=new q(0,0);Et.push({tl:An,tr:Vi,bl:Ai,br:Sn,tex:Rr,writingMode:Me.writingMode,glyphOffset:Xn,sectionIndex:qt.sectionIndex,isSDF:Kr,pixelOffsetTL:li,pixelOffsetBR:Ki,minFontScaleX:0,minFontScaleY:0})}}return Et}(0,d,R,_,w,C,g,u.allowVerticalPlacement),Te=u.textSizeData;let he=null;Te.kind==="source"?(he=[Gl*_.layout.get("text-size").evaluate(C,{},oe)],he[0]>If&&jt(`${u.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):Te.kind==="composite"&&(he=[Gl*Y.compositeTextSizes[0].evaluate(C,{},oe),Gl*Y.compositeTextSizes[1].evaluate(C,{},oe)],(he[0]>If||he[1]>If)&&jt(`${u.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),u.addSymbols(u.text,ge,he,R,w,C,D,l,c,k.lineStartIndex,k.lineLength,G,J,oe);for(const xe of N)F[xe]=u.text.placedSymbolArray.length-1;return 4*ge.length}function BG(u){for(const l in u)return u[l];return null}function lO(u,l,c,d,g,_,w,C,R,k){let D=w.top,N=w.bottom,F=w.left,G=w.right;const Y=w.collisionPadding;if(Y&&(F-=Y[0],D-=Y[1],G+=Y[2],N+=Y[3]),R){const J=new q(F,D),oe=new q(G,D),ge=new q(F,N),Te=new q(G,N),he=Le(R);let xe=new q(0,0);k&&(xe=new q(k[0],k[1])),J._rotateAround(he,xe),oe._rotateAround(he,xe),ge._rotateAround(he,xe),Te._rotateAround(he,xe),F=Math.min(J.x,oe.x,ge.x,Te.x),G=Math.max(J.x,oe.x,ge.x,Te.x),D=Math.min(J.y,oe.y,ge.y,Te.y),N=Math.max(J.y,oe.y,ge.y,Te.y)}return u.emplaceBack(l.x,l.y,l.z,c.x,c.y,F,D,G,N,C,d,g,_),u.length-1}function V$(u){u.collisionPadding&&(u.top-=u.collisionPadding[1],u.bottom+=u.collisionPadding[3]);const l=u.bottom-u.top;return l>0?Math.max(10,l):null}function Oge(u,l,c,d){const g=u.compareText;if(l in g){const _=g[l];for(let w=_.length-1;w>=0;w--)if(d.dist(_[w])<c)return!0}else g[l]=[];return g[l].push(d),!1}function jG(u,l){const c=u.fovAboveCenter,d=u.elevation?u.elevation.getMinElevationBelowMSL()*l:0,g=(u._camera.position[2]*u.worldSize-d)/Math.cos(u._pitch),_=Math.sin(c)*g/Math.sin(Math.max(Math.PI/2-u._pitch-c,.01)),w=Math.sin(u._pitch)*_+g;return Math.min(1.01*w,g*(1/u._horizonShift))}function jd(u,l){if(!l.isReprojectedInTileSpace)return{scale:1<<u.z,x:u.x,y:u.y,x2:u.x+1,y2:u.y+1,projection:l};const c=Math.pow(2,-u.z),d=u.x*c,g=(u.x+1)*c,_=u.y*c,w=(u.y+1)*c,C=Xa(d),R=Xa(g),k=Eo(_),D=Eo(w),N=l.project(C,k),F=l.project(R,k),G=l.project(R,D),Y=l.project(C,D);let J=Math.min(N.x,F.x,G.x,Y.x),oe=Math.min(N.y,F.y,G.y,Y.y),ge=Math.max(N.x,F.x,G.x,Y.x),Te=Math.max(N.y,F.y,G.y,Y.y);const he=c/16;function xe(ke,lt,it,xt,Bt,gt){const Et=(it+Bt)/2,Rt=(xt+gt)/2,$t=l.project(Xa(Et),Eo(Rt)),Ft=Math.max(0,J-$t.x,oe-$t.y,$t.x-ge,$t.y-Te);J=Math.min(J,$t.x),ge=Math.max(ge,$t.x),oe=Math.min(oe,$t.y),Te=Math.max(Te,$t.y),Ft>he&&(xe(ke,$t,it,xt,Et,Rt),xe($t,lt,Et,Rt,Bt,gt))}xe(N,F,d,_,g,_),xe(F,G,g,_,g,w),xe(G,Y,g,w,d,w),xe(Y,N,d,w,d,_),J-=he,oe-=he,ge+=he,Te+=he;const Me=1/Math.max(ge-J,Te-oe);return{scale:Me,x:J*Me,y:oe*Me,x2:ge*Me,y2:Te*Me,projection:l}}const Rge=ol(new Float32Array(16));class Mf{constructor(l){this.spec=l,this.name=l.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(l,c){return{x:0,y:0,z:0}}unproject(l,c){return new bn(0,0)}projectTilePoint(l,c,d){return{x:l,y:c,z:0}}locationPoint(l,c,d=!0){return l._coordinatePoint(l.locationCoordinate(c),d)}pixelsPerMeter(l,c){return sl(1,l)*c}pixelSpaceConversion(l,c,d){return 1}farthestPixelDistance(l){return jG(l,l.pixelsPerMeter)}pointCoordinate(l,c,d,g){const _=l.horizonLineFromTop(!1),w=new q(c,Math.max(_,d));return l.rayIntersectionCoordinate(l.pointRayIntersection(w,g))}pointCoordinate3D(l,c,d){const g=new q(c,d);if(l.elevation)return l.elevation.pointCoordinate(g);{const _=this.pointCoordinate(l,g.x,g.y,0);return[_.x,_.y,_.z]}}isPointAboveHorizon(l,c){if(l.elevation)return!this.pointCoordinate3D(l,c.x,c.y);const d=l.horizonLineFromTop();return c.y<d}createInversionMatrix(l,c){return Rge}createTileMatrix(l,c,d){let g,_,w;const C=d.canonical,R=ol(new Float64Array(16));if(this.isReprojectedInTileSpace){const k=jd(C,this);g=1,_=k.x+d.wrap*k.scale,w=k.y,Id(R,R,[g/k.scale,g/k.scale,l.pixelsPerMeter/c])}else g=c/l.zoomScale(C.z),_=(C.x+Math.pow(2,C.z)*d.wrap)*g,w=C.y*g;return Jw(R,R,[_,w,0]),Id(R,R,[g/Pr,g/Pr,1]),R}upVector(l,c,d){return[0,0,1]}upVectorScale(l,c,d){return{metersToTile:1}}}class kge extends Mf{constructor(l){super(l),this.range=[4,7],this.center=l.center||[-96,37.5];const[c,d]=this.parallels=l.parallels||[29.5,45.5],g=Math.sin(Le(c));this.n=(g+Math.sin(Le(d)))/2,this.c=1+g*(2*this.n-g),this.r0=Math.sqrt(this.c)/this.n}project(l,c){const{n:d,c:g,r0:_}=this,w=Le(l-this.center[0]),C=Le(c),R=Math.sqrt(g-2*d*Math.sin(C))/d;return{x:R*Math.sin(w*d),y:R*Math.cos(w*d)-_,z:0}}unproject(l,c){const{n:d,c:g,r0:_}=this,w=_+c;let C=Math.atan2(l,Math.abs(w))*Math.sign(w);w*d<0&&(C-=Math.PI*Math.sign(l)*Math.sign(w));const R=Le(this.center[0])*d;C=Ct(C,-Math.PI-R,Math.PI-R);const k=Ce(ze(C/d)+this.center[0],-180,180),D=Math.asin(Ce((g-(l*l+w*w)*d*d)/(2*d),-1,1)),N=Ce(ze(D),-To,To);return new bn(k,N)}}const S0=1.340264,x0=-.081106,C0=893e-6,E0=.003796,uO=Math.sqrt(3)/2;class Pge extends Mf{project(l,c){c=c/180*Math.PI,l=l/180*Math.PI;const d=Math.asin(uO*Math.sin(c)),g=d*d,_=g*g*g;return{x:.5*(l*Math.cos(d)/(uO*(S0+3*x0*g+_*(7*C0+9*E0*g)))/Math.PI+.5),y:1-.5*(d*(S0+x0*g+_*(C0+E0*g))/Math.PI+1),z:0}}unproject(l,c){l=(2*l-.5)*Math.PI;let d=c=(2*(1-c)-1)*Math.PI,g=d*d,_=g*g*g;for(let D,N,F,G=0;G<12&&(N=d*(S0+x0*g+_*(C0+E0*g))-c,F=S0+3*x0*g+_*(7*C0+9*E0*g),D=N/F,d=Ce(d-D,-Math.PI/3,Math.PI/3),g=d*d,_=g*g*g,!(Math.abs(D)<1e-12));++G);const w=uO*l*(S0+3*x0*g+_*(7*C0+9*E0*g))/Math.cos(d),C=Math.asin(Math.sin(d)/uO),R=Ce(180*w/Math.PI,-180,180),k=Ce(180*C/Math.PI,-To,To);return new bn(R,k)}}class Age extends Mf{constructor(l){super(l),this.wrap=!0,this.supportsWorldCopies=!0}project(l,c){return{x:.5+l/360,y:.5-c/360,z:0}}unproject(l,c){const d=360*(l-.5),g=Ce(360*(.5-c),-To,To);return new bn(d,g)}}const Fg=Math.PI/2;function cO(u){return Math.tan((Fg+u)/2)}class Ige extends Mf{constructor(l){super(l),this.center=l.center||[0,30];const[c,d]=this.parallels=l.parallels||[30,30];let g=Le(c),_=Le(d);this.southernCenter=g+_<0,this.southernCenter&&(g=-g,_=-_);const w=Math.cos(g),C=cO(g);this.n=g===_?Math.sin(g):Math.log(w/Math.cos(_))/Math.log(cO(_)/C),this.f=w*Math.pow(cO(g),this.n)/this.n}project(l,c){c=Le(c),this.southernCenter&&(c=-c),l=Le(l-this.center[0]);const d=1e-6,{n:g,f:_}=this;_>0?c<-Fg+d&&(c=-Fg+d):c>Fg-d&&(c=Fg-d);const w=_/Math.pow(cO(c),g);let C=w*Math.sin(g*l),R=_-w*Math.cos(g*l);return C=.5*(C/Math.PI+.5),R=.5*(R/Math.PI+.5),{x:C,y:this.southernCenter?R:1-R,z:0}}unproject(l,c){l=(2*l-.5)*Math.PI,this.southernCenter&&(c=1-c),c=(2*(1-c)-.5)*Math.PI;const{n:d,f:g}=this,_=g-c,w=Math.sign(_),C=Math.sign(d)*Math.sqrt(l*l+_*_);let R=Math.atan2(l,Math.abs(_))*w;_*d<0&&(R-=Math.PI*Math.sign(l)*w);const k=Ce(ze(R/d)+this.center[0],-180,180),D=Ce(ze(2*Math.atan(Math.pow(g/C,1/d))-Fg),-To,To);return new bn(k,this.southernCenter?-D:D)}}class FG extends Mf{constructor(l){super(l),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(l,c){return{x:Ul(l),y:Wl(c),z:0}}unproject(l,c){const d=Xa(l),g=Eo(c);return new bn(d,g)}}const zG=Le(To);class Mge extends Mf{project(l,c){const d=(c=Le(c))*c,g=d*d;return{x:.5*((l=Le(l))*(.8707-.131979*d+g*(g*(.003971*d-.001529*g)-.013791))/Math.PI+.5),y:1-.5*(c*(1.007226+d*(.015085+g*(.028874*d-.044475-.005916*g)))/Math.PI+1),z:0}}unproject(l,c){l=(2*l-.5)*Math.PI;let d=c=(2*(1-c)-1)*Math.PI,g=25,_=0,w=d*d;do{w=d*d;const k=w*w;_=(d*(1.007226+w*(.015085+k*(.028874*w-.044475-.005916*k)))-c)/(1.007226+w*(.045255+k*(.259866*w-.311325-.005916*11*k))),d=Ce(d-_,-zG,zG)}while(Math.abs(_)>1e-6&&--g>0);w=d*d;const C=Ce(ze(l/(.8707+w*(w*(w*w*w*(.003971-.001529*w)-.013791)-.131979))),-180,180),R=ze(d);return new bn(C,R)}}const HG=Le(To);class $ge extends Mf{project(l,c){c=Le(c),l=Le(l);const d=Math.cos(c),g=2/Math.PI,_=Math.acos(d*Math.cos(l/2)),w=Math.sin(_)/_,C=.5*(l*g+2*d*Math.sin(l/2)/w)||0,R=.5*(c+Math.sin(c)/w)||0;return{x:.5*(C/Math.PI+.5),y:1-.5*(R/Math.PI+1),z:0}}unproject(l,c){let d=l=(2*l-.5)*Math.PI,g=c=(2*(1-c)-1)*Math.PI,_=25;const w=1e-6;let C=0,R=0;do{const k=Math.cos(g),D=Math.sin(g),N=2*D*k,F=D*D,G=k*k,Y=Math.cos(d/2),J=Math.sin(d/2),oe=2*Y*J,ge=J*J,Te=1-G*Y*Y,he=Te?1/Te:0,xe=Te?Math.acos(k*Y)*Math.sqrt(1/Te):0,Me=.5*(2*xe*k*J+2*d/Math.PI)-l,ke=.5*(xe*D+g)-c,lt=.5*he*(G*ge+xe*k*Y*F)+1/Math.PI,it=he*(oe*N/4-xe*D*J),xt=.125*he*(N*J-xe*D*G*oe),Bt=.5*he*(F*Y+xe*ge*k)+.5,gt=it*xt-Bt*lt;C=(ke*it-Me*Bt)/gt,R=(Me*xt-ke*lt)/gt,d=Ce(d-C,-Math.PI,Math.PI),g=Ce(g-R,-HG,HG)}while((Math.abs(C)>w||Math.abs(R)>w)&&--_>0);return new bn(ze(d),ze(g))}}class VG extends Mf{constructor(l){super(l),this.center=l.center||[0,0],this.parallels=l.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(Le(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(l,c){const{scale:d,cosPhi:g}=this;return{x:Le(l)*g*d+.5,y:-Math.sin(Le(c))/g*d+.5,z:0}}unproject(l,c){const{scale:d,cosPhi:g}=this,_=-(c-.5)/d,w=Ce(ze((l-.5)/d)/g,-180,180),C=Math.asin(Ce(_*g,-1,1)),R=Ce(ze(C),-To,To);return new bn(w,R)}}class Dge extends FG{constructor(l){super(l),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(l,c,d){const g=a0(l,c,d);return Ci(g,g,s0(Vl(d))),{x:g[0],y:g[1],z:g[2]}}locationPoint(l,c){const d=Tg(c.lat,c.lng),g=Go([],d),_=l.elevation?l.elevation.getAtPointOrZero(l.locationCoordinate(c),l._centerAltitude):l._centerAltitude;r0(d,d,g,sl(1,0)*Pr*_);const w=ol(new Float64Array(16));return Ad(w,l.pixelMatrix,l.globeMatrix),Ci(d,d,w),new q(d[0],d[1])}pixelsPerMeter(l,c){return sl(1,0)*c}pixelSpaceConversion(l,c,d){const g=sl(1,l)*c,_=gn(sl(1,45)*c,g,d);return this.pixelsPerMeter(l,c)/_}createTileMatrix(l,c,d){const g=g$(Vl(d.canonical));return Ad(new Float64Array(16),l.globeMatrix,g)}createInversionMatrix(l,c){const{center:d}=l,g=s0(Vl(c));return jT(g,g,Le(d.lng)),s$(g,g,Le(d.lat)),Id(g,g,[l._pixelsPerMercatorPixel,l._pixelsPerMercatorPixel,1]),Float32Array.from(g)}pointCoordinate(l,c,d,g){return _5(l,c,d,!0)||new Rg(0,0)}pointCoordinate3D(l,c,d){const g=this.pointCoordinate(l,c,d,0);return[g.x,g.y,g.z]}isPointAboveHorizon(l,c){return!_5(l,c.x,c.y,!1)}farthestPixelDistance(l){const c=function(g,_){const w=g.cameraToCenterDistance,C=g._centerAltitude*_,R=g._camera,k=g._camera.forward(),D=zu([],qa([],k,-w),[0,0,C]),N=g.worldSize/(2*Math.PI),F=[0,0,-N],G=g.width/g.height,Y=Math.tan(g.fovAboveCenter),J=qa([],R.up(),Y),oe=qa([],R.right(),Y*G),ge=Go([],zu([],zu([],k,J),oe)),Te=[];let he;if(new f$(D,ge).closestPointOnSphere(F,N,Te)){const xe=zu([],Te,F),Me=al([],xe,D);he=Math.cos(g.fovAboveCenter)*Qw(Me)}else{const xe=al([],D,F),Me=al([],F,D);Go(Me,Me);const ke=Qw(xe)-N;he=Math.sqrt(ke*(ke+2*N));const lt=Math.acos(he/(N+ke))-Math.acos(Cs(k,Me));he*=Math.cos(lt)}return 1.01*he}(l,this.pixelsPerMeter(l.center.lat,l.worldSize)),d=Og(l.zoom);if(d>0){const g=jG(l,sl(1,l.center.lat)*l.worldSize),_=l.worldSize/(2*Math.PI),w=Math.max(l.width,l.height)/l.worldSize*Math.PI;return gn(c,g+_*(1-Math.cos(w)),Math.pow(d,10))}return c}upVector(l,c,d){return a0(c,d,l,1)}upVectorScale(l){return{metersToTile:FT(HT(Vl(l)))}}}function UG(u){const l=u.parallels,c=!!l&&Math.abs(l[0]+l[1])<.01;switch(u.name){case"mercator":return new FG(u);case"equirectangular":return new Age(u);case"naturalEarth":return new Mge(u);case"equalEarth":return new Pge(u);case"winkelTripel":return new $ge(u);case"albers":return c?new VG(u):new kge(u);case"lambertConformalConic":return c?new VG(u):new Ige(u);case"globe":return new Dge(u)}throw new Error(`Invalid projection name: ${u.name}`)}const Lge=JT.types,Nge=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function fO(u,l,c,d,g,_,w,C,R,k,D,N,F){const G=C?Math.min(If,Math.round(C[0])):0,Y=C?Math.min(If,Math.round(C[1])):0;u.emplaceBack(l,c,Math.round(32*d),Math.round(32*g),_,w,(G<<1)+(R?1:0),Y,16*k,16*D,256*N,256*F)}function hO(u,l,c,d,g,_,w){u.emplaceBack(l,c,d,g,_,w)}function dO(u,l,c,d,g){u.emplaceBack(l,c,d,g),u.emplaceBack(l,c,d,g),u.emplaceBack(l,c,d,g),u.emplaceBack(l,c,d,g)}function Bge(u){for(const l of u.sections)if(X(l.text))return!0;return!1}class U${constructor(l){this.layoutVertexArray=new tl,this.indexArray=new Co,this.programConfigurations=l,this.segments=new ki,this.dynamicLayoutVertexArray=new Nn,this.opacityVertexArray=new Bn,this.placedSymbolArray=new WW,this.globeExtVertexArray=new Qn}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(l,c,d,g){this.isEmpty()||(d&&(this.layoutVertexBuffer=l.createVertexBuffer(this.layoutVertexArray,Gme.members),this.indexBuffer=l.createIndexBuffer(this.indexArray,c),this.dynamicLayoutVertexBuffer=l.createVertexBuffer(this.dynamicLayoutVertexArray,Kme.members,!0),this.opacityVertexBuffer=l.createVertexBuffer(this.opacityVertexArray,Nge,!0),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=l.createVertexBuffer(this.globeExtVertexArray,Yme.members,!0)),this.opacityVertexBuffer.itemSize=1),(d||g)&&this.programConfigurations.upload(l))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}}nr(U$,"SymbolBuffers");class W${constructor(l,c,d){this.layoutVertexArray=new l,this.layoutAttributes=c,this.indexArray=new d,this.segments=new ki,this.collisionVertexArray=new qn,this.collisionVertexArrayExt=new xo}upload(l){this.layoutVertexBuffer=l.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=l.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=l.createVertexBuffer(this.collisionVertexArray,qme.members,!0),this.collisionVertexBufferExt=l.createVertexBuffer(this.collisionVertexArrayExt,Xme.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}nr(W$,"CollisionBuffers");class $f{constructor(l){this.collisionBoxArray=l.collisionBoxArray,this.zoom=l.zoom,this.overscaling=l.overscaling,this.layers=l.layers,this.layerIds=this.layers.map(w=>w.id),this.index=l.index,this.pixelRatio=l.pixelRatio,this.sourceLayerIndex=l.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=ol([]),this.placementViewportMatrix=ol([]);const c=this.layers[0]._unevaluatedLayout._values;this.textSizeData=$$(this.zoom,c["text-size"]),this.iconSizeData=$$(this.zoom,c["icon-size"]);const d=this.layers[0].layout,g=d.get("symbol-sort-key"),_=d.get("symbol-z-order");this.canOverlap=d.get("text-allow-overlap")||d.get("icon-allow-overlap")||d.get("text-ignore-placement")||d.get("icon-ignore-placement"),this.sortFeaturesByKey=_!=="viewport-y"&&g.constantOr(1)!==void 0,this.sortFeaturesByY=(_==="viewport-y"||_==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=d.get("text-writing-mode").map(w=>Za[w]),this.stateDependentLayerIds=this.layers.filter(w=>w.isStateDependent()).map(w=>w.id),this.sourceID=l.sourceID,this.projection=l.projection}createArrays(){this.text=new U$(new Pd(this.layers,this.zoom,l=>/^text/.test(l))),this.icon=new U$(new Pd(this.layers,this.zoom,l=>/^icon/.test(l))),this.glyphOffsetArray=new KW,this.lineVertexArray=new qW,this.symbolInstances=new YW}calculateGlyphDependencies(l,c,d,g,_){for(let w=0;w<l.length;w++)if(c[l.charCodeAt(w)]=!0,g&&_){const C=v0[l.charAt(w)];C&&(c[C.charCodeAt(0)]=!0)}}populate(l,c,d,g){const _=this.layers[0],w=_.layout,C=this.projection.name==="globe",R=w.get("text-font"),k=w.get("text-field"),D=w.get("icon-image"),N=(k.value.kind!=="constant"||k.value.value instanceof Uo&&!k.value.value.isEmpty()||k.value.value.toString().length>0)&&(R.value.kind!=="constant"||R.value.value.length>0),F=D.value.kind!=="constant"||!!D.value.value||Object.keys(D.parameters).length>0,G=w.get("symbol-sort-key");if(this.features=[],!N&&!F)return;const Y=c.iconDependencies,J=c.glyphDependencies,oe=c.availableImages,ge=new Ze(this.zoom);for(const{feature:Te,id:he,index:xe,sourceLayerIndex:Me}of l){const ke=_._featureFilter.needGeometry,lt=Ld(Te,ke);if(!_._featureFilter.filter(ge,lt,d))continue;if(ke||(lt.geometry=Hu(Te,d,g)),C&&Te.type!==1&&d.z<=5){const gt=lt.geometry,Et=.98078528056,Rt=($t,Ft)=>Cs(a0($t.x,$t.y,d,1),a0(Ft.x,Ft.y,d,1))<Et;for(let $t=0;$t<gt.length;$t++)gt[$t]=Kpe(gt[$t],Rt)}let it,xt;if(N){const gt=_.getValueAndResolveTokens("text-field",lt,d,oe),Et=Uo.factory(gt);Bge(Et)&&(this.hasRTLText=!0),(!this.hasRTLText||$e()==="unavailable"||this.hasRTLText&&Be.isParsed())&&(it=Qme(Et,_,lt))}if(F){const gt=_.getValueAndResolveTokens("icon-image",lt,d,oe);xt=gt instanceof Lo?gt:Lo.fromString(gt)}if(!it&&!xt)continue;const Bt=this.sortFeaturesByKey?G.evaluate(lt,{},d):void 0;if(this.features.push({id:he,text:it,icon:xt,index:xe,sourceLayerIndex:Me,geometry:lt.geometry,properties:Te.properties,type:Lge[Te.type],sortKey:Bt}),xt&&(Y[xt.name]=!0),it){const gt=R.evaluate(lt,{},d).join(","),Et=w.get("text-rotation-alignment")==="map"&&w.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Za.vertical)>=0;for(const Rt of it.sections)if(Rt.image)Y[Rt.image.name]=!0;else{const $t=x(it.toString()),Ft=Rt.fontStack||gt,yt=J[Ft]=J[Ft]||{};this.calculateGlyphDependencies(Rt.text,yt,Et,this.allowVerticalPlacement,$t)}}}w.get("symbol-placement")==="line"&&(this.features=function(Te){const he={},xe={},Me=[];let ke=0;function lt(gt){Me.push(Te[gt]),ke++}function it(gt,Et,Rt){const $t=xe[gt];return delete xe[gt],xe[Et]=$t,Me[$t].geometry[0].pop(),Me[$t].geometry[0]=Me[$t].geometry[0].concat(Rt[0]),$t}function xt(gt,Et,Rt){const $t=he[Et];return delete he[Et],he[gt]=$t,Me[$t].geometry[0].shift(),Me[$t].geometry[0]=Rt[0].concat(Me[$t].geometry[0]),$t}function Bt(gt,Et,Rt){const $t=Rt?Et[0][Et[0].length-1]:Et[0][0];return`${gt}:${$t.x}:${$t.y}`}for(let gt=0;gt<Te.length;gt++){const Et=Te[gt],Rt=Et.geometry,$t=Et.text?Et.text.toString():null;if(!$t){lt(gt);continue}const Ft=Bt($t,Rt),yt=Bt($t,Rt,!0);if(Ft in xe&&yt in he&&xe[Ft]!==he[yt]){const Yt=xt(Ft,yt,Rt),Er=it(Ft,yt,Me[Yt].geometry);delete he[Ft],delete xe[yt],xe[Bt($t,Me[Er].geometry,!0)]=Er,Me[Yt].geometry=null}else Ft in xe?it(Ft,yt,Rt):yt in he?xt(Ft,yt,Rt):(lt(gt),he[Ft]=ke-1,xe[yt]=ke-1)}return Me.filter(gt=>gt.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((Te,he)=>Te.sortKey-he.sortKey)}update(l,c,d,g){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(l,c,this.layers,d,g),this.icon.programConfigurations.updatePaintArrays(l,c,this.layers,d,g))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(l){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(l),this.iconCollisionBox.upload(l)),this.text.upload(l,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(l,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=UG(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(l,c){const d=this.lineVertexArray.length;if(l.segment!==void 0)for(const{x:g,y:_}of c)this.lineVertexArray.emplaceBack(g,_);return{lineStartIndex:d,lineLength:this.lineVertexArray.length-d}}addSymbols(l,c,d,g,_,w,C,R,k,D,N,F,G,Y){const J=l.indexArray,oe=l.layoutVertexArray,ge=l.globeExtVertexArray,Te=l.segments.prepareSegment(4*c.length,oe,J,this.canOverlap?w.sortKey:void 0),he=this.glyphOffsetArray.length,xe=Te.vertexLength,Me=this.allowVerticalPlacement&&C===Za.vertical?Math.PI/2:0,ke=w.text&&w.text.sections;for(let it=0;it<c.length;it++){const{tl:xt,tr:Bt,bl:gt,br:Et,tex:Rt,pixelOffsetTL:$t,pixelOffsetBR:Ft,minFontScaleX:yt,minFontScaleY:Yt,glyphOffset:Er,isSDF:er,sectionIndex:lr}=c[it],qt=Te.vertexLength,Rr=Er[1];if(fO(oe,k.x,k.y,xt.x,Rr+xt.y,Rt.x,Rt.y,d,er,$t.x,$t.y,yt,Yt),fO(oe,k.x,k.y,Bt.x,Rr+Bt.y,Rt.x+Rt.w,Rt.y,d,er,Ft.x,$t.y,yt,Yt),fO(oe,k.x,k.y,gt.x,Rr+gt.y,Rt.x,Rt.y+Rt.h,d,er,$t.x,Ft.y,yt,Yt),fO(oe,k.x,k.y,Et.x,Rr+Et.y,Rt.x+Rt.w,Rt.y+Rt.h,d,er,Ft.x,Ft.y,yt,Yt),R){const{x:Jr,y:Kr,z:Gr}=R.anchor,[kr,Pn,Lr]=R.up;hO(ge,Jr,Kr,Gr,kr,Pn,Lr),hO(ge,Jr,Kr,Gr,kr,Pn,Lr),hO(ge,Jr,Kr,Gr,kr,Pn,Lr),hO(ge,Jr,Kr,Gr,kr,Pn,Lr),dO(l.dynamicLayoutVertexArray,Jr,Kr,Gr,Me)}else dO(l.dynamicLayoutVertexArray,k.x,k.y,k.z,Me);J.emplaceBack(qt,qt+1,qt+2),J.emplaceBack(qt+1,qt+2,qt+3),Te.vertexLength+=4,Te.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Er[0]),it!==c.length-1&&lr===c[it+1].sectionIndex||l.programConfigurations.populatePaintArrays(oe.length,w,w.index,{},G,Y,ke&&ke[lr])}const lt=R?R.anchor:k;l.placedSymbolArray.emplaceBack(lt.x,lt.y,lt.z,k.x,k.y,he,this.glyphOffsetArray.length-he,xe,D,N,k.segment,d?d[0]:0,d?d[1]:0,g[0],g[1],C,0,!1,0,F,0)}_commitLayoutVertex(l,c,d,g,_,w,C){l.emplaceBack(c,d,g,_,w,Math.round(C.x),Math.round(C.y))}_addCollisionDebugVertices(l,c,d,g,_,w,C){const R=d.segments.prepareSegment(4,d.layoutVertexArray,d.indexArray),k=R.vertexLength,D=C.tileAnchorX,N=C.tileAnchorY;for(let G=0;G<4;G++)d.collisionVertexArray.emplaceBack(0,0,0,0);d.collisionVertexArrayExt.emplaceBack(c,-l.padding,-l.padding),d.collisionVertexArrayExt.emplaceBack(c,l.padding,-l.padding),d.collisionVertexArrayExt.emplaceBack(c,l.padding,l.padding),d.collisionVertexArrayExt.emplaceBack(c,-l.padding,l.padding),this._commitLayoutVertex(d.layoutVertexArray,g,_,w,D,N,new q(l.x1,l.y1)),this._commitLayoutVertex(d.layoutVertexArray,g,_,w,D,N,new q(l.x2,l.y1)),this._commitLayoutVertex(d.layoutVertexArray,g,_,w,D,N,new q(l.x2,l.y2)),this._commitLayoutVertex(d.layoutVertexArray,g,_,w,D,N,new q(l.x1,l.y2)),R.vertexLength+=4;const F=d.indexArray;F.emplaceBack(k,k+1),F.emplaceBack(k+1,k+2),F.emplaceBack(k+2,k+3),F.emplaceBack(k+3,k),R.primitiveLength+=4}_addTextDebugCollisionBoxes(l,c,d,g,_,w){for(let C=g;C<_;C++){const R=d.get(C),k=this.getSymbolInstanceTextSize(l,w,c,C);this._addCollisionDebugVertices(R,k,this.textCollisionBox,R.projectedAnchorX,R.projectedAnchorY,R.projectedAnchorZ,w)}}_addIconDebugCollisionBoxes(l,c,d,g,_,w){for(let C=g;C<_;C++){const R=d.get(C),k=this.getSymbolInstanceIconSize(l,c,w.placedIconSymbolIndex);this._addCollisionDebugVertices(R,k,this.iconCollisionBox,R.projectedAnchorX,R.projectedAnchorY,R.projectedAnchorZ,w)}}generateCollisionDebugBuffers(l,c){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new W$(mi,hG.members,Fl),this.iconCollisionBox=new W$(mi,hG.members,Fl);const d=$g(this.iconSizeData,l),g=$g(this.textSizeData,l);for(let _=0;_<this.symbolInstances.length;_++){const w=this.symbolInstances.get(_);this._addTextDebugCollisionBoxes(g,l,c,w.textBoxStartIndex,w.textBoxEndIndex,w),this._addTextDebugCollisionBoxes(g,l,c,w.verticalTextBoxStartIndex,w.verticalTextBoxEndIndex,w),this._addIconDebugCollisionBoxes(d,l,c,w.iconBoxStartIndex,w.iconBoxEndIndex,w),this._addIconDebugCollisionBoxes(d,l,c,w.verticalIconBoxStartIndex,w.verticalIconBoxEndIndex,w)}}getSymbolInstanceTextSize(l,c,d,g){const _=this.text.placedSymbolArray.get(c.rightJustifiedTextSymbolIndex>=0?c.rightJustifiedTextSymbolIndex:c.centerJustifiedTextSymbolIndex>=0?c.centerJustifiedTextSymbolIndex:c.leftJustifiedTextSymbolIndex>=0?c.leftJustifiedTextSymbolIndex:c.verticalPlacedTextSymbolIndex>=0?c.verticalPlacedTextSymbolIndex:g),w=rO(this.textSizeData,l,_)/Oo;return this.tilePixelRatio*w}getSymbolInstanceIconSize(l,c,d){const g=this.icon.placedSymbolArray.get(d),_=rO(this.iconSizeData,l,g);return this.tilePixelRatio*_}_commitDebugCollisionVertexUpdate(l,c,d){l.emplaceBack(c,-d,-d),l.emplaceBack(c,d,-d),l.emplaceBack(c,d,d),l.emplaceBack(c,-d,d)}_updateTextDebugCollisionBoxes(l,c,d,g,_,w){for(let C=g;C<_;C++){const R=d.get(C),k=this.getSymbolInstanceTextSize(l,w,c,C);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,k,R.padding)}}_updateIconDebugCollisionBoxes(l,c,d,g,_,w){for(let C=g;C<_;C++){const R=d.get(C),k=this.getSymbolInstanceIconSize(l,c,w);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,k,R.padding)}}updateCollisionDebugBuffers(l,c){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const d=$g(this.iconSizeData,l),g=$g(this.textSizeData,l);for(let _=0;_<this.symbolInstances.length;_++){const w=this.symbolInstances.get(_);this._updateTextDebugCollisionBoxes(g,l,c,w.textBoxStartIndex,w.textBoxEndIndex,w),this._updateTextDebugCollisionBoxes(g,l,c,w.verticalTextBoxStartIndex,w.verticalTextBoxEndIndex,w),this._updateIconDebugCollisionBoxes(d,l,c,w.iconBoxStartIndex,w.iconBoxEndIndex,w.placedIconSymbolIndex),this._updateIconDebugCollisionBoxes(d,l,c,w.verticalIconBoxStartIndex,w.verticalIconBoxEndIndex,w.placedIconSymbolIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(l,c,d,g,_,w,C,R,k){const D={};if(c<d){const{x1:N,y1:F,x2:G,y2:Y,padding:J,projectedAnchorX:oe,projectedAnchorY:ge,projectedAnchorZ:Te,tileAnchorX:he,tileAnchorY:xe,featureIndex:Me}=l.get(c);D.textBox={x1:N,y1:F,x2:G,y2:Y,padding:J,projectedAnchorX:oe,projectedAnchorY:ge,projectedAnchorZ:Te,tileAnchorX:he,tileAnchorY:xe},D.textFeatureIndex=Me}if(g<_){const{x1:N,y1:F,x2:G,y2:Y,padding:J,projectedAnchorX:oe,projectedAnchorY:ge,projectedAnchorZ:Te,tileAnchorX:he,tileAnchorY:xe,featureIndex:Me}=l.get(g);D.verticalTextBox={x1:N,y1:F,x2:G,y2:Y,padding:J,projectedAnchorX:oe,projectedAnchorY:ge,projectedAnchorZ:Te,tileAnchorX:he,tileAnchorY:xe},D.verticalTextFeatureIndex=Me}if(w<C){const{x1:N,y1:F,x2:G,y2:Y,padding:J,projectedAnchorX:oe,projectedAnchorY:ge,projectedAnchorZ:Te,tileAnchorX:he,tileAnchorY:xe,featureIndex:Me}=l.get(w);D.iconBox={x1:N,y1:F,x2:G,y2:Y,padding:J,projectedAnchorX:oe,projectedAnchorY:ge,projectedAnchorZ:Te,tileAnchorX:he,tileAnchorY:xe},D.iconFeatureIndex=Me}if(R<k){const{x1:N,y1:F,x2:G,y2:Y,padding:J,projectedAnchorX:oe,projectedAnchorY:ge,projectedAnchorZ:Te,tileAnchorX:he,tileAnchorY:xe,featureIndex:Me}=l.get(R);D.verticalIconBox={x1:N,y1:F,x2:G,y2:Y,padding:J,projectedAnchorX:oe,projectedAnchorY:ge,projectedAnchorZ:Te,tileAnchorX:he,tileAnchorY:xe},D.verticalIconFeatureIndex=Me}return D}deserializeCollisionBoxes(l){this.collisionArrays=[];for(let c=0;c<this.symbolInstances.length;c++){const d=this.symbolInstances.get(c);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(l,d.textBoxStartIndex,d.textBoxEndIndex,d.verticalTextBoxStartIndex,d.verticalTextBoxEndIndex,d.iconBoxStartIndex,d.iconBoxEndIndex,d.verticalIconBoxStartIndex,d.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(l,c){const d=l.placedSymbolArray.get(c),g=d.vertexStartIndex+4*d.numGlyphs;for(let _=d.vertexStartIndex;_<g;_+=4)l.indexArray.emplaceBack(_,_+1,_+2),l.indexArray.emplaceBack(_+1,_+2,_+3)}getSortedSymbolIndexes(l){if(this.sortedAngle===l&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const c=Math.sin(l),d=Math.cos(l),g=[],_=[],w=[];for(let C=0;C<this.symbolInstances.length;++C){w.push(C);const R=this.symbolInstances.get(C);g.push(0|Math.round(c*R.tileAnchorX+d*R.tileAnchorY)),_.push(R.featureIndex)}return w.sort((C,R)=>g[C]-g[R]||_[R]-_[C]),w}addToSortKeyRanges(l,c){const d=this.sortKeyRanges[this.sortKeyRanges.length-1];d&&d.sortKey===c?d.symbolInstanceEnd=l+1:this.sortKeyRanges.push({sortKey:c,symbolInstanceStart:l,symbolInstanceEnd:l+1})}sortFeatures(l){if(this.sortFeaturesByY&&this.sortedAngle!==l&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(l),this.sortedAngle=l,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const c of this.symbolInstanceIndexes){const d=this.symbolInstances.get(c);this.featureSortOrder.push(d.featureIndex);const{rightJustifiedTextSymbolIndex:g,centerJustifiedTextSymbolIndex:_,leftJustifiedTextSymbolIndex:w,verticalPlacedTextSymbolIndex:C,placedIconSymbolIndex:R,verticalPlacedIconSymbolIndex:k}=d;g>=0&&this.addIndicesForPlacedSymbol(this.text,g),_>=0&&_!==g&&this.addIndicesForPlacedSymbol(this.text,_),w>=0&&w!==_&&w!==g&&this.addIndicesForPlacedSymbol(this.text,w),C>=0&&this.addIndicesForPlacedSymbol(this.text,C),R>=0&&this.addIndicesForPlacedSymbol(this.icon,R),k>=0&&this.addIndicesForPlacedSymbol(this.icon,k)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}nr($f,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),$f.MAX_GLYPHS=65535,$f.addDynamicAttributes=dO;const jge=new Lt({"symbol-placement":new Ke(wt.layout_symbol["symbol-placement"]),"symbol-spacing":new Ke(wt.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Ke(wt.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new dt(wt.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Ke(wt.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Ke(wt.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Ke(wt.layout_symbol["icon-ignore-placement"]),"icon-optional":new Ke(wt.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Ke(wt.layout_symbol["icon-rotation-alignment"]),"icon-size":new dt(wt.layout_symbol["icon-size"]),"icon-text-fit":new Ke(wt.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Ke(wt.layout_symbol["icon-text-fit-padding"]),"icon-image":new dt(wt.layout_symbol["icon-image"]),"icon-rotate":new dt(wt.layout_symbol["icon-rotate"]),"icon-padding":new Ke(wt.layout_symbol["icon-padding"]),"icon-keep-upright":new Ke(wt.layout_symbol["icon-keep-upright"]),"icon-offset":new dt(wt.layout_symbol["icon-offset"]),"icon-anchor":new dt(wt.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Ke(wt.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Ke(wt.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Ke(wt.layout_symbol["text-rotation-alignment"]),"text-field":new dt(wt.layout_symbol["text-field"]),"text-font":new dt(wt.layout_symbol["text-font"]),"text-size":new dt(wt.layout_symbol["text-size"]),"text-max-width":new dt(wt.layout_symbol["text-max-width"]),"text-line-height":new dt(wt.layout_symbol["text-line-height"]),"text-letter-spacing":new dt(wt.layout_symbol["text-letter-spacing"]),"text-justify":new dt(wt.layout_symbol["text-justify"]),"text-radial-offset":new dt(wt.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Ke(wt.layout_symbol["text-variable-anchor"]),"text-anchor":new dt(wt.layout_symbol["text-anchor"]),"text-max-angle":new Ke(wt.layout_symbol["text-max-angle"]),"text-writing-mode":new Ke(wt.layout_symbol["text-writing-mode"]),"text-rotate":new dt(wt.layout_symbol["text-rotate"]),"text-padding":new Ke(wt.layout_symbol["text-padding"]),"text-keep-upright":new Ke(wt.layout_symbol["text-keep-upright"]),"text-transform":new dt(wt.layout_symbol["text-transform"]),"text-offset":new dt(wt.layout_symbol["text-offset"]),"text-allow-overlap":new Ke(wt.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Ke(wt.layout_symbol["text-ignore-placement"]),"text-optional":new Ke(wt.layout_symbol["text-optional"])});var G$={paint:new Lt({"icon-opacity":new dt(wt.paint_symbol["icon-opacity"]),"icon-color":new dt(wt.paint_symbol["icon-color"]),"icon-halo-color":new dt(wt.paint_symbol["icon-halo-color"]),"icon-halo-width":new dt(wt.paint_symbol["icon-halo-width"]),"icon-halo-blur":new dt(wt.paint_symbol["icon-halo-blur"]),"icon-translate":new Ke(wt.paint_symbol["icon-translate"]),"icon-translate-anchor":new Ke(wt.paint_symbol["icon-translate-anchor"]),"text-opacity":new dt(wt.paint_symbol["text-opacity"]),"text-color":new dt(wt.paint_symbol["text-color"],{runtimeType:ws,getOverride:u=>u.textColor,hasOverride:u=>!!u.textColor}),"text-halo-color":new dt(wt.paint_symbol["text-halo-color"]),"text-halo-width":new dt(wt.paint_symbol["text-halo-width"]),"text-halo-blur":new dt(wt.paint_symbol["text-halo-blur"]),"text-translate":new Ke(wt.paint_symbol["text-translate"]),"text-translate-anchor":new Ke(wt.paint_symbol["text-translate-anchor"])}),layout:jge};class WG{constructor(l){this.type=l.property.overrides?l.property.overrides.runtimeType:lf,this.defaultValue=l}evaluate(l){if(l.formattedSection){const c=this.defaultValue.property.overrides;if(c&&c.hasOverride(l.formattedSection))return c.getOverride(l.formattedSection)}return l.feature&&l.featureState?this.defaultValue.evaluate(l.feature,l.featureState):this.defaultValue.property.specification.default}eachChild(l){this.defaultValue.isConstant()||l(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}nr(WG,"FormatSectionOverride",{omit:["defaultValue"]});class pO extends il{constructor(l){super(l,G$)}recalculate(l,c){super.recalculate(l,c),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const d=this.layout.get("text-writing-mode");if(d){const g=[];for(const _ of d)g.indexOf(_)<0&&g.push(_);this.layout._values["text-writing-mode"]=g}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(l,c,d,g){const _=this.layout.get(l).evaluate(c,{},d,g),w=this._unevaluatedLayout._values[l];return w.isDataDriven()||bf(w.value)||!_?_:function(C,R){return R.replace(/{([^{}]+)}/g,(k,D)=>D in C?String(C[D]):"")}(c.properties,_)}createBucket(l){return new $f(l)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const l of G$.paint.overridableProperties){if(!pO.hasPaintOverride(this.layout,l))continue;const c=this.paint.get(l),d=new WG(c),g=new ug(d,c.property.specification);let _=null;_=c.value.kind==="constant"||c.value.kind==="source"?new cg("source",g):new Nu("composite",g,c.value.zoomStops,c.value._interpolationType),this.paint._values[l]=new Mt(c.property,_,c.parameters)}}_handleOverridablePaintPropertyUpdate(l,c,d){return!(!this.layout||c.isDataDriven()||d.isDataDriven())&&pO.hasPaintOverride(this.layout,l)}static hasPaintOverride(l,c){const d=l.get("text-field"),g=G$.paint.properties[c];let _=!1;const w=C=>{for(const R of C)if(g.overrides&&g.overrides.hasOverride(R))return void(_=!0)};if(d.value.kind==="constant"&&d.value.value instanceof Uo)w(d.value.value.sections);else if(d.value.kind==="source"){const C=k=>{_||(k instanceof nd&&Hi(k.value)===uf?w(k.value.sections):k instanceof id?w(k.sections):k.eachChild(C))},R=d.value;R._styleExpression&&C(R._styleExpression.expression)}return _}getProgramConfiguration(l){return new Pf(this,l)}}var Fge={paint:new Lt({"background-color":new Ke(wt.paint_background["background-color"]),"background-pattern":new Ke(wt.paint_background["background-pattern"]),"background-opacity":new Ke(wt.paint_background["background-opacity"])})},zge={paint:new Lt({"raster-opacity":new Ke(wt.paint_raster["raster-opacity"]),"raster-hue-rotate":new Ke(wt.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Ke(wt.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Ke(wt.paint_raster["raster-brightness-max"]),"raster-saturation":new Ke(wt.paint_raster["raster-saturation"]),"raster-contrast":new Ke(wt.paint_raster["raster-contrast"]),"raster-resampling":new Ke(wt.paint_raster["raster-resampling"]),"raster-fade-duration":new Ke(wt.paint_raster["raster-fade-duration"])})};class Hge extends il{constructor(l){super(l,{}),this.implementation=l}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}isLayerDraped(){return this.implementation.renderToTile!==void 0}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(l){this.implementation.onAdd&&this.implementation.onAdd(l,l.painter.context.gl)}onRemove(l){this.implementation.onRemove&&this.implementation.onRemove(l,l.painter.context.gl)}}var Vge={paint:new Lt({"sky-type":new Ke(wt.paint_sky["sky-type"]),"sky-atmosphere-sun":new Ke(wt.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new Ke(wt.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new Ke(wt.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new Ke(wt.paint_sky["sky-gradient-radius"]),"sky-gradient":new Pt(wt.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new Ke(wt.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new Ke(wt.paint_sky["sky-atmosphere-color"]),"sky-opacity":new Ke(wt.paint_sky["sky-opacity"])})};function Y$(u,l,c){const d=[0,0,1],g=p5([]);return g5(g,g,c?-Le(u)+Math.PI:Le(u)),m5(g,g,-Le(l)),c5(d,d,g),Go(d,d)}const Uge={circle:class extends il{constructor(u){super(u,tme)}createBucket(u){return new S$(u)}queryRadius(u){const l=u;return kg("circle-radius",this,l)+kg("circle-stroke-width",this,l)+WT(this.paint.get("circle-translate"))}queryIntersectsFeature(u,l,c,d,g,_,w,C){const R=N5(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),_.angle,u.pixelToTileUnitsFactor),k=this.paint.get("circle-radius").evaluate(l,c)+this.paint.get("circle-stroke-width").evaluate(l,c);return B5(u,d,_,w,C,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",R,k)}getProgramIds(){return["circle"]}getProgramConfiguration(u){return new Pf(this,u)}},heatmap:class extends il{createBucket(u){return new F5(u)}constructor(u){super(u,ome),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(u){u==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=T$({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(u){return kg("heatmap-radius",this,u)}queryIntersectsFeature(u,l,c,d,g,_,w,C){const R=this.paint.get("heatmap-radius").evaluate(l,c);return B5(u,d,_,w,C,!0,!0,new q(0,0),R)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getProgramConfiguration(u){return new Pf(this,u)}},hillshade:class extends il{constructor(u){super(u,ame)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}},fill:class extends il{constructor(u){super(u,Sme)}getProgramIds(){const u=this.paint.get("fill-pattern"),l=u&&u.constantOr(1),c=[l?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&c.push(l&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),c}getProgramConfiguration(u){return new Pf(this,u)}recalculate(u,l){super.recalculate(u,l);const c=this.paint._values["fill-outline-color"];c.value.kind==="constant"&&c.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(u){return new XT(u)}queryRadius(){return WT(this.paint.get("fill-translate"))}queryIntersectsFeature(u,l,c,d,g,_){return!u.queryGeometry.isAboveHorizon&&I5(L5(u.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),_.angle,u.pixelToTileUnitsFactor),d)}isTileClipped(){return!0}},"fill-extrusion":class extends il{constructor(u){super(u,Bme)}createBucket(u){return new m0(u)}queryRadius(){return WT(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(u){return new Pf(this,u)}queryIntersectsFeature(u,l,c,d,g,_,w,C,R){const k=N5(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),_.angle,u.pixelToTileUnitsFactor),D=this.paint.get("fill-extrusion-height").evaluate(l,c),N=this.paint.get("fill-extrusion-base").evaluate(l,c),F=[0,0],G=C&&_.elevation,Y=_.elevation?_.elevation.exaggeration():1,J=u.tile.getBucket(this);if(G&&J instanceof m0){const xe=J.centroidVertexArray,Me=R+1;Me<xe.length&&(F[0]=xe.geta_centroid_pos0(Me),F[1]=xe.geta_centroid_pos1(Me))}if(F[0]===0&&F[1]===1)return!1;_.projection.name==="globe"&&(d=iG([d],[new q(0,0),new q(Pr,Pr)],u.tileID.canonical).map(xe=>xe.polygon).flat());const oe=G?C:null,[ge,Te]=function(xe,Me,ke,lt,it,xt,Bt,gt,Et,Rt,$t){return xe.projection.name==="globe"?function(Ft,yt,Yt,Er,er,lr,qt,Rr,Jr,Kr,Gr){const kr=[],Pn=[],Lr=Ft.projection.upVectorScale(Gr,Ft.center.lat,Ft.worldSize).metersToTile,Qr=[0,0,0,1],Mn=[0,0,0,1],Xn=(Zn,ei,gi,fo)=>{Zn[0]=ei,Zn[1]=gi,Zn[2]=fo,Zn[3]=1},Wn=nG();Yt>0&&(Yt+=Wn),Er+=Wn;for(const Zn of yt){const ei=[],gi=[];for(const fo of Zn){const An=fo.x+er.x,Vi=fo.y+er.y,Ai=Ft.projection.projectTilePoint(An,Vi,Gr),Sn=Ft.projection.upVector(Gr,fo.x,fo.y);let li=Yt,Ki=Er;if(qt){const $n=lG(An,Vi,Yt,Er,qt,Rr,Jr,Kr);li+=$n.base,Ki+=$n.top}Yt!==0?Xn(Qr,Ai.x+Sn[0]*Lr*li,Ai.y+Sn[1]*Lr*li,Ai.z+Sn[2]*Lr*li):Xn(Qr,Ai.x,Ai.y,Ai.z),Xn(Mn,Ai.x+Sn[0]*Lr*Ki,Ai.y+Sn[1]*Lr*Ki,Ai.z+Sn[2]*Lr*Ki),Ci(Qr,Qr,lr),Ci(Mn,Mn,lr),ei.push(new Mg(Qr[0],Qr[1],Qr[2])),gi.push(new Mg(Mn[0],Mn[1],Mn[2]))}kr.push(ei),Pn.push(gi)}return[kr,Pn]}(xe,Me,ke,lt,it,xt,Bt,gt,Et,Rt,$t):Bt?function(Ft,yt,Yt,Er,er,lr,qt,Rr,Jr){const Kr=[],Gr=[],kr=[0,0,0,1];for(const Pn of Ft){const Lr=[],Qr=[];for(const Mn of Pn){const Xn=Mn.x+Er.x,Wn=Mn.y+Er.y,Zn=lG(Xn,Wn,yt,Yt,lr,qt,Rr,Jr);kr[0]=Xn,kr[1]=Wn,kr[2]=Zn.base,kr[3]=1,Md(kr,kr,er),kr[3]=Math.max(kr[3],1e-5);const ei=new Mg(kr[0]/kr[3],kr[1]/kr[3],kr[2]/kr[3]);kr[0]=Xn,kr[1]=Wn,kr[2]=Zn.top,kr[3]=1,Md(kr,kr,er),kr[3]=Math.max(kr[3],1e-5);const gi=new Mg(kr[0]/kr[3],kr[1]/kr[3],kr[2]/kr[3]);Lr.push(ei),Qr.push(gi)}Kr.push(Lr),Gr.push(Qr)}return[Kr,Gr]}(Me,ke,lt,it,xt,Bt,gt,Et,Rt):function(Ft,yt,Yt,Er,er){const lr=[],qt=[],Rr=er[8]*yt,Jr=er[9]*yt,Kr=er[10]*yt,Gr=er[11]*yt,kr=er[8]*Yt,Pn=er[9]*Yt,Lr=er[10]*Yt,Qr=er[11]*Yt;for(const Mn of Ft){const Xn=[],Wn=[];for(const Zn of Mn){const ei=Zn.x+Er.x,gi=Zn.y+Er.y,fo=er[0]*ei+er[4]*gi+er[12],An=er[1]*ei+er[5]*gi+er[13],Vi=er[2]*ei+er[6]*gi+er[14],Ai=er[3]*ei+er[7]*gi+er[15],Sn=fo+Rr,li=An+Jr,Ki=Vi+Kr,$n=Math.max(Ai+Gr,1e-5),Ei=fo+kr,No=An+Pn,ho=Vi+Lr,po=Math.max(Ai+Qr,1e-5);Xn.push(new Mg(Sn/$n,li/$n,Ki/$n)),Wn.push(new Mg(Ei/po,No/po,ho/po))}lr.push(Xn),qt.push(Wn)}return[lr,qt]}(Me,ke,lt,it,xt)}(_,d,N,D,k,w,oe,F,Y,_.center.lat,u.tileID.canonical),he=u.queryGeometry;return function(xe,Me,ke){let lt=1/0;I5(ke,Me)&&(lt=sG(ke,Me[0]));for(let it=0;it<Me.length;it++){const xt=Me[it],Bt=xe[it];for(let gt=0;gt<xt.length-1;gt++){const Et=xt[gt],Rt=[Et,xt[gt+1],Bt[gt+1],Bt[gt],Et];A5(ke,Rt)&&(lt=Math.min(lt,sG(ke,Rt)))}}return lt!==1/0&&lt}(ge,Te,he.isPointQuery()?he.screenBounds:he.screenGeometry)}},line:class extends il{constructor(u){super(u,uG),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(u){if(u==="line-gradient"){const l=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=l._styleExpression&&l._styleExpression.expression instanceof ww,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(u,l){super.recalculate(u,l),this.paint._values["line-floorwidth"]=cG.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,u)}createBucket(u){return new tO(u)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getProgramConfiguration(u){return new Pf(this,u)}queryRadius(u){const l=u,c=fG(kg("line-width",this,l),kg("line-gap-width",this,l)),d=kg("line-offset",this,l);return c/2+Math.abs(d)+WT(this.paint.get("line-translate"))}queryIntersectsFeature(u,l,c,d,g,_){if(u.queryGeometry.isAboveHorizon)return!1;const w=L5(u.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),_.angle,u.pixelToTileUnitsFactor),C=u.pixelToTileUnitsFactor/2*fG(this.paint.get("line-width").evaluate(l,c),this.paint.get("line-gap-width").evaluate(l,c)),R=this.paint.get("line-offset").evaluate(l,c);return R&&(d=function(k,D){const N=[],F=new q(0,0);for(let G=0;G<k.length;G++){const Y=k[G],J=[];for(let oe=0;oe<Y.length;oe++){const ge=Y[oe-1],Te=Y[oe],he=Y[oe+1],xe=oe===0?F:Te.sub(ge)._unit()._perp(),Me=oe===Y.length-1?F:he.sub(Te)._unit()._perp(),ke=xe._add(Me)._unit();ke._mult(1/(ke.x*Me.x+ke.y*Me.y)),J.push(ke._mult(D)._add(Te))}N.push(J)}return N}(d,R*u.pixelToTileUnitsFactor)),function(k,D,N){for(let F=0;F<D.length;F++){const G=D[F];if(k.length>=3){for(let Y=0;Y<G.length;Y++)if(Nd(k,G[Y]))return!0}if(Zpe(k,G,N))return!0}return!1}(w,d,C)}isTileClipped(){return!0}},symbol:pO,background:class extends il{constructor(u){super(u,Fge)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends il{constructor(u){super(u,zge)}getProgramIds(){return["raster"]}},sky:class extends il{constructor(u){super(u,Vge),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(u){u==="sky-gradient"?this._updateColorRamp():u!=="sky-atmosphere-sun"&&u!=="sky-atmosphere-halo-color"&&u!=="sky-atmosphere-color"&&u!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=T$({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(u){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const l=u.style.light.properties.get("position");return this._lightPosition.azimuthal!==l.azimuthal||this._lightPosition.polar!==l.polar}return!1}getCenter(u,l){if(this.paint.get("sky-type")==="atmosphere"){const d=this.paint.get("sky-atmosphere-sun"),g=!d,_=u.style.light,w=_.properties.get("position");return g&&_.properties.get("anchor")==="viewport"&&jt("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),g?Y$(w.azimuthal,90-w.polar,l):Y$(d[0],90-d[1],l)}const c=this.paint.get("sky-gradient-center");return Y$(c[0],90-c[1],l)}is3D(){return!1}isSky(){return!0}markSkyboxValid(u){this._skyboxInvalidated=!1,this._lightPosition=u.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const u=this.paint.get("sky-type");return u==="atmosphere"?["skyboxCapture","skybox"]:u==="gradient"?["skyboxGradient"]:null}}};class T0{constructor(l,c,d,g){this.context=l,this.format=d,this.texture=l.gl.createTexture(),this.update(c,g)}update(l,c,d){const{width:g,height:_}=l,{context:w}=this,{gl:C}=w,{HTMLImageElement:R,HTMLCanvasElement:k,HTMLVideoElement:D,ImageData:N,ImageBitmap:F}=h;if(C.bindTexture(C.TEXTURE_2D,this.texture),w.pixelStoreUnpackFlipY.set(!1),w.pixelStoreUnpack.set(1),w.pixelStoreUnpackPremultiplyAlpha.set(this.format===C.RGBA&&(!c||c.premultiply!==!1)),d||this.size&&this.size[0]===g&&this.size[1]===_){const{x:G,y:Y}=d||{x:0,y:0};l instanceof R||l instanceof k||l instanceof D||l instanceof N||F&&l instanceof F?C.texSubImage2D(C.TEXTURE_2D,0,G,Y,C.RGBA,C.UNSIGNED_BYTE,l):C.texSubImage2D(C.TEXTURE_2D,0,G,Y,g,_,C.RGBA,C.UNSIGNED_BYTE,l.data)}else this.size=[g,_],l instanceof R||l instanceof k||l instanceof D||l instanceof N||F&&l instanceof F?C.texImage2D(C.TEXTURE_2D,0,this.format,this.format,C.UNSIGNED_BYTE,l):C.texImage2D(C.TEXTURE_2D,0,this.format,g,_,0,this.format,C.UNSIGNED_BYTE,l.data);this.useMipmap=!!(c&&c.useMipmap&&this.isSizePowerOfTwo()),this.useMipmap&&C.generateMipmap(C.TEXTURE_2D)}bind(l,c){const{context:d}=this,{gl:g}=d;g.bindTexture(g.TEXTURE_2D,this.texture),l!==this.filter&&(g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MAG_FILTER,l),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MIN_FILTER,this.useMipmap?l===g.NEAREST?g.NEAREST_MIPMAP_NEAREST:g.LINEAR_MIPMAP_NEAREST:l),this.filter=l),c!==this.wrap&&(g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_S,c),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_T,c),this.wrap=c)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:l}=this.context;l.deleteTexture(this.texture),this.texture=null}}class Wge{constructor(l){this._callback=l,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class Gge{constructor(){this.tasks={},this.taskQueue=[],Je(["process"],this),this.invoker=new Wge(this.process),this.nextId=0}add(l,c){const d=this.nextId++,g=function({type:_,isSymbolTile:w,zoom:C}){return C=C||0,_==="message"?0:_!=="maybePrepare"||w?_!=="parseTile"||w?_==="parseTile"&&w?300-C:_==="maybePrepare"&&w?400-C:500:200-C:100-C}(c);if(g===0){yr();try{l()}finally{}return{cancel:()=>{}}}return this.tasks[d]={fn:l,metadata:c,priority:g,id:d},this.taskQueue.push(d),this.invoker.trigger(),{cancel:()=>{delete this.tasks[d]}}}process(){yr();try{if(this.taskQueue=this.taskQueue.filter(d=>!!this.tasks[d]),!this.taskQueue.length)return;const l=this.pick();if(l===null)return;const c=this.tasks[l];if(delete this.tasks[l],this.taskQueue.length&&this.invoker.trigger(),!c)return;c.fn()}finally{}}pick(){let l=null,c=1/0;for(let g=0;g<this.taskQueue.length;g++){const _=this.tasks[this.taskQueue[g]];_.priority<c&&(c=_.priority,l=g)}if(l===null)return null;const d=this.taskQueue[l];return this.taskQueue.splice(l,1),d}remove(){this.invoker.remove()}}class GG{constructor(l){this._stringToNumber={},this._numberToString=[];for(let c=0;c<l.length;c++){const d=l[c];this._stringToNumber[d]=c,this._numberToString[c]=d}}encode(l){return this._stringToNumber[l]}decode(l){return this._numberToString[l]}}const Yge=["tile","layer","source","sourceLayer","state"];class YG{constructor(l,c,d,g,_){this.type="Feature",this._vectorTileFeature=l,this._z=c,this._x=d,this._y=g,this.properties=l.properties,this.id=_}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(l){this._geometry=l}toJSON(){const l={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};this.id!==void 0&&(l.id=this.id);for(const c of Yge)this[c]!==void 0&&(l[c]=this[c]);return l}}const Os=32,Yl=33,Df=new Uint16Array(8184);for(let u=0;u<2046;u++){let l=u+2,c=0,d=0,g=0,_=0,w=0,C=0;for(1&l?g=_=w=Os:c=d=C=Os;(l>>=1)>1;){const k=c+g>>1,D=d+_>>1;1&l?(g=c,_=d,c=w,d=C):(c=g,d=_,g=w,_=C),w=k,C=D}const R=4*u;Df[R+0]=c,Df[R+1]=d,Df[R+2]=g,Df[R+3]=_}const Kl=new Uint16Array(2178),Lf=new Uint8Array(1089),mO=new Uint16Array(1089);function KG(u){return u===0?-.03125:u===32?.03125:0}var qG=hr([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const XG={type:2,extent:Pr,loadGeometry:()=>[[new q(0,0),new q(8193,0),new q(8193,8193),new q(0,8193),new q(0,0)]]};class K${constructor(l,c,d,g,_){this.tileID=l,this.uid=re(),this.uses=0,this.tileSize=c,this.tileZoom=d,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=_,this.expiredRequestCount=0,this.state="loading",g&&g.transform&&(this.projection=g.transform.projection)}registerFadeDuration(l){const c=l+this.timeAdded;c<mr.now()||this.fadeEndTime&&c<this.fadeEndTime||(this.fadeEndTime=c)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=jd(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(l,c,d){if(this.unloadVectorData(),this.state="loaded",l){l.featureIndex&&(this.latestFeatureIndex=l.featureIndex,l.rawTileData?(this.latestRawTileData=l.rawTileData,this.latestFeatureIndex.rawTileData=l.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=l.collisionBoxArray,this.buckets=function(g,_){const w={};if(!_)return w;for(const C of g){const R=C.layerIds.map(k=>_.getLayer(k)).filter(Boolean);if(R.length!==0){C.layers=R,C.stateDependentLayerIds&&(C.stateDependentLayers=C.stateDependentLayerIds.map(k=>R.filter(D=>D.id===k)[0]));for(const k of R)w[k.id]=C}}return w}(l.buckets,c.style),this.hasSymbolBuckets=!1;for(const g in this.buckets){const _=this.buckets[g];if(_ instanceof $f){if(this.hasSymbolBuckets=!0,!d)break;_.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const g in this.buckets){const _=this.buckets[g];if(_ instanceof $f&&_.hasRTLText){this.hasRTLText=!0,Be.isLoading()||Be.isLoaded()||$e()!=="deferred"||Ae();break}}this.queryPadding=0;for(const g in this.buckets){const _=this.buckets[g];this.queryPadding=Math.max(this.queryPadding,c.style.getLayer(g).queryRadius(_))}l.imageAtlas&&(this.imageAtlas=l.imageAtlas),l.glyphAtlasImage&&(this.glyphAtlasImage=l.glyphAtlasImage),l.lineAtlas&&(this.lineAtlas=l.lineAtlas)}else this.collisionBoxArray=new t$}unloadVectorData(){if(this.hasData()){for(const l in this.buckets)this.buckets[l].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(l){return this.buckets[l.id]}upload(l){for(const d in this.buckets){const g=this.buckets[d];g.uploadPending()&&g.upload(l)}const c=l.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new T0(l,this.imageAtlas.image,c.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new T0(l,this.glyphAtlasImage,c.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new T0(l,this.lineAtlas.image,c.ALPHA),this.lineAtlas.uploaded=!0)}prepare(l){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(l,this.imageAtlasTexture)}queryRenderedFeatures(l,c,d,g,_,w,C,R){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:g,pixelPosMatrix:C,transform:w,params:_,tileTransform:this.tileTransform},l,c,d):{}}querySourceFeatures(l,c){const d=this.latestFeatureIndex;if(!d||!d.rawTileData)return;const g=d.loadVTLayers(),_=c?c.sourceLayer:"",w=g._geojsonTileLayer||g[_];if(!w)return;const C=hg(c&&c.filter),{z:R,x:k,y:D}=this.tileID.canonical,N={z:R,x:k,y:D};for(let F=0;F<w.length;F++){const G=w.feature(F);if(C.needGeometry){const oe=Ld(G,!0);if(!C.filter(new Ze(this.tileID.overscaledZ),oe,this.tileID.canonical))continue}else if(!C.filter(new Ze(this.tileID.overscaledZ),G))continue;const Y=d.getId(G,_),J=new YG(G,R,k,D,Y);J.tile=N,l.push(J)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(l){const c=this.expirationTime;if(l.cacheControl){const d=Ar(l.cacheControl);d["max-age"]&&(this.expirationTime=Date.now()+1e3*d["max-age"])}else l.expires&&(this.expirationTime=new Date(l.expires).getTime());if(this.expirationTime){const d=Date.now();let g=!1;if(this.expirationTime>d)g=!1;else if(c)if(this.expirationTime<c)g=!0;else{const _=this.expirationTime-c;_?this.expirationTime=d+Math.max(_,3e4):g=!0}else g=!0;g?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(l,c){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(l).length===0||!c)return;const d=this.latestFeatureIndex.loadVTLayers(),g=c.style.listImages();for(const _ in this.buckets){if(!c.style.hasLayer(_))continue;const w=this.buckets[_],C=w.layers[0].sourceLayer||"_geojsonTileLayer",R=d[C],k=l[C];if(!R||!k||Object.keys(k).length===0)continue;if(w.update(k,R,g,this.imageAtlas&&this.imageAtlas.patternPositions||{}),w instanceof tO||w instanceof XT){const N=c.style._getSourceCache(w.layers[0].source);c._terrain&&c._terrain.enabled&&N&&w.programConfigurations.needsUpload&&c._terrain._clearRenderCacheForTile(N.id,this.tileID)}const D=c&&c.style&&c.style.getLayer(_);D&&(this.queryPadding=Math.max(this.queryPadding,D.queryRadius(w)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<mr.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(l){this.symbolFadeHoldUntil=mr.now()+l}setTexture(l,c){const d=c.context,g=d.gl;this.texture=this.texture||c.getTileTexture(l.width),this.texture?this.texture.update(l,{useMipmap:!0}):(this.texture=new T0(d,l,g.RGBA,{useMipmap:!0}),this.texture.bind(g.LINEAR,g.CLAMP_TO_EDGE))}setDependencies(l,c){const d={};for(const g of c)d[g]=!0;this.dependencies[l]=d}hasDependency(l,c){for(const d of l){const g=this.dependencies[d];if(g){for(const _ of c)if(g[_])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(l,c){if(!c||c.name==="mercator"||this._tileDebugBuffer)return;const d=Hu(XG,this.tileID.canonical,this.tileTransform)[0],g=new _r,_=new zl;for(let w=0;w<d.length;w++){const{x:C,y:R}=d[w];g.emplaceBack(C,R),_.emplaceBack(w)}_.emplaceBack(0),this._tileDebugIndexBuffer=l.createIndexBuffer(_),this._tileDebugBuffer=l.createVertexBuffer(g,i0.members),this._tileDebugSegments=ki.simpleSegment(0,0,g.length,_.length)}_makeTileBoundsBuffers(l,c){if(this._tileBoundsBuffer||!c||c.name==="mercator")return;const d=Hu(XG,this.tileID.canonical,this.tileTransform)[0];let g,_;if(this.isRaster){const w=function(C,R){const k=jd(C,R),D=Math.pow(2,C.z);for(let oe=0;oe<Yl;oe++)for(let ge=0;ge<Yl;ge++){const Te=Xa((C.x+(ge+KG(ge))/Os)/D),he=Eo((C.y+(oe+KG(oe))/Os)/D),xe=R.project(Te,he),Me=oe*Yl+ge;Kl[2*Me+0]=Math.round((xe.x*k.scale-k.x)*Pr),Kl[2*Me+1]=Math.round((xe.y*k.scale-k.y)*Pr)}Lf.fill(0),mO.fill(0);for(let oe=2045;oe>=0;oe--){const ge=4*oe,Te=Df[ge+0],he=Df[ge+1],xe=Df[ge+2],Me=Df[ge+3],ke=Te+xe>>1,lt=he+Me>>1,it=ke+lt-he,xt=lt+Te-ke,Bt=he*Yl+Te,gt=Me*Yl+xe,Et=lt*Yl+ke,Rt=Math.hypot((Kl[2*Bt+0]+Kl[2*gt+0])/2-Kl[2*Et+0],(Kl[2*Bt+1]+Kl[2*gt+1])/2-Kl[2*Et+1])>=16;if(Lf[Et]=Lf[Et]||(Rt?1:0),oe<1022){const $t=(he+xt>>1)*Yl+(Te+it>>1),Ft=(Me+xt>>1)*Yl+(xe+it>>1);Lf[Et]=Lf[Et]||Lf[$t]||Lf[Ft]}}const N=new kn,F=new Co;let G=0;function Y(oe,ge){const Te=ge*Yl+oe;return mO[Te]===0&&(N.emplaceBack(Kl[2*Te+0],Kl[2*Te+1],oe*Pr/Os,ge*Pr/Os),mO[Te]=++G),mO[Te]-1}function J(oe,ge,Te,he,xe,Me){const ke=oe+Te>>1,lt=ge+he>>1;if(Math.abs(oe-xe)+Math.abs(ge-Me)>1&&Lf[lt*Yl+ke])J(xe,Me,oe,ge,ke,lt),J(Te,he,xe,Me,ke,lt);else{const it=Y(oe,ge),xt=Y(Te,he),Bt=Y(xe,Me);F.emplaceBack(it,xt,Bt)}}return J(0,0,Os,Os,Os,0),J(Os,Os,0,0,0,Os),{vertices:N,indices:F}}(this.tileID.canonical,c);g=w.vertices,_=w.indices}else{g=new kn,_=new Co;for(const{x:C,y:R}of d)g.emplaceBack(C,R,0,0);const w=Pg(g.int16,void 0,4);for(let C=0;C<w.length;C+=3)_.emplaceBack(w[C],w[C+1],w[C+2])}this._tileBoundsBuffer=l.createVertexBuffer(g,qG.members),this._tileBoundsIndexBuffer=l.createIndexBuffer(_),this._tileBoundsSegments=ki.simpleSegment(0,0,g.length,_.length)}_makeGlobeTileDebugBuffers(l,c){const d=c.projection;if(!d||d.name!=="globe"||c.freezeTileCoverage)return;const g=this.tileID.canonical,_=s0(b5(g,c)),w=Og(c.zoom);let C;w>0&&(C=a$(new Float64Array(16),c.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(l,g,c,_,C,w),this._makeGlobeTileDebugTextBuffer(l,g,c,_,C,w)}_globePoint(l,c,d,g,_,w,C){let R=a0(l,c,d);if(w){const k=1<<d.z,D=Ul(g.center.lng),N=Wl(g.center.lat),F=(d.x+.5)/k-D;let G=0;F>.5?G=-1:F<-.5&&(G=1);let Y=(l/Pr+d.x)/k+G,J=(c/Pr+d.y)/k;Y=(Y-D)*g._pixelsPerMercatorPixel+D,J=(J-N)*g._pixelsPerMercatorPixel+N;const oe=[Y*g.worldSize,J*g.worldSize,0];Ci(oe,oe,w),R=Dd(R,oe,C)}return Ci(R,R,_)}_makeGlobeTileDebugBorderBuffer(l,c,d,g,_,w){const C=new _r,R=new zl,k=new On,D=(F,G,Y,J,oe)=>{const ge=(Y-F)/(oe-1),Te=(J-G)/(oe-1),he=C.length;for(let xe=0;xe<oe;xe++){const Me=F+xe*ge,ke=G+xe*Te;C.emplaceBack(Me,ke);const lt=this._globePoint(Me,ke,c,d,g,_,w);k.emplaceBack(lt[0],lt[1],lt[2]),R.emplaceBack(he+xe)}},N=Pr;D(0,0,N,0,16),D(N,0,N,N,16),D(N,N,0,N,16),D(0,N,0,0,16),this._tileDebugIndexBuffer=l.createIndexBuffer(R),this._tileDebugBuffer=l.createVertexBuffer(C,i0.members),this._globeTileDebugBorderBuffer=l.createVertexBuffer(k,v5.members),this._tileDebugSegments=ki.simpleSegment(0,0,C.length,R.length)}_makeGlobeTileDebugTextBuffer(l,c,d,g,_,w){const C=new _r,R=new Co,k=new On,D=25;R.reserve(32),C.reserve(D),k.reserve(D);const N=(F,G)=>D*F+G;for(let F=0;F<D;F++){const G=2048*F;for(let Y=0;Y<D;Y++){const J=2048*Y;C.emplaceBack(J,G);const oe=this._globePoint(J,G,c,d,g,_,w);k.emplaceBack(oe[0],oe[1],oe[2])}}for(let F=0;F<4;F++)for(let G=0;G<4;G++){const Y=N(F,G),J=N(F,G+1),oe=N(F+1,G),ge=N(F+1,G+1);R.emplaceBack(Y,J,oe),R.emplaceBack(oe,J,ge)}this._tileDebugTextIndexBuffer=l.createIndexBuffer(R),this._tileDebugTextBuffer=l.createVertexBuffer(C,i0.members),this._globeTileDebugTextBuffer=l.createVertexBuffer(k,v5.members),this._tileDebugTextSegments=ki.simpleSegment(0,0,D,32)}}class Kge{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(l,c,d){const g=String(c);if(this.stateChanges[l]=this.stateChanges[l]||{},this.stateChanges[l][g]=this.stateChanges[l][g]||{},U(this.stateChanges[l][g],d),this.deletedStates[l]===null){this.deletedStates[l]={};for(const _ in this.state[l])_!==g&&(this.deletedStates[l][_]=null)}else if(this.deletedStates[l]&&this.deletedStates[l][g]===null){this.deletedStates[l][g]={};for(const _ in this.state[l][g])d[_]||(this.deletedStates[l][g][_]=null)}else for(const _ in d)this.deletedStates[l]&&this.deletedStates[l][g]&&this.deletedStates[l][g][_]===null&&delete this.deletedStates[l][g][_]}removeFeatureState(l,c,d){if(this.deletedStates[l]===null)return;const g=String(c);if(this.deletedStates[l]=this.deletedStates[l]||{},d&&c!==void 0)this.deletedStates[l][g]!==null&&(this.deletedStates[l][g]=this.deletedStates[l][g]||{},this.deletedStates[l][g][d]=null);else if(c!==void 0)if(this.stateChanges[l]&&this.stateChanges[l][g])for(d in this.deletedStates[l][g]={},this.stateChanges[l][g])this.deletedStates[l][g][d]=null;else this.deletedStates[l][g]=null;else this.deletedStates[l]=null}getState(l,c){const d=String(c),g=U({},(this.state[l]||{})[d],(this.stateChanges[l]||{})[d]);if(this.deletedStates[l]===null)return{};if(this.deletedStates[l]){const _=this.deletedStates[l][c];if(_===null)return{};for(const w in _)delete g[w]}return g}initializeTileState(l,c){l.setFeatureState(this.state,c)}coalesceChanges(l,c){const d={};for(const g in this.stateChanges){this.state[g]=this.state[g]||{};const _={};for(const w in this.stateChanges[g])this.state[g][w]||(this.state[g][w]={}),U(this.state[g][w],this.stateChanges[g][w]),_[w]=this.state[g][w];d[g]=_}for(const g in this.deletedStates){this.state[g]=this.state[g]||{};const _={};if(this.deletedStates[g]===null)for(const w in this.state[g])_[w]={},this.state[g][w]={};else for(const w in this.deletedStates[g]){if(this.deletedStates[g][w]===null)this.state[g][w]={};else if(this.state[g][w])for(const C of Object.keys(this.deletedStates[g][w]))delete this.state[g][w][C];_[w]=this.state[g][w]}d[g]=d[g]||{},U(d[g],_)}if(this.stateChanges={},this.deletedStates={},Object.keys(d).length!==0)for(const g in l)l[g].setFeatureState(d,c)}}class ZG{constructor(l){this.size=l,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(l,c){const d=this.toIdx(l,c);return{min:this.minimums[d],max:this.maximums[d]}}isLeaf(l,c){return this.leaves[this.toIdx(l,c)]}toIdx(l,c){return c*this.size+l}}function JG(u,l,c,d){let g=0,_=Number.MAX_VALUE;for(let w=0;w<3;w++)if(Math.abs(d[w])<1e-15){if(c[w]<u[w]||c[w]>l[w])return null}else{const C=1/d[w];let R=(u[w]-c[w])*C,k=(l[w]-c[w])*C;if(R>k){const D=R;R=k,k=D}if(R>g&&(g=R),k<_&&(_=k),g>_)return null}return g}function QG(u,l,c,d,g,_,w,C,R,k,D){const N=d-u,F=g-l,G=_-c,Y=w-u,J=C-l,oe=R-c,ge=D[1]*oe-D[2]*J,Te=D[2]*Y-D[0]*oe,he=D[0]*J-D[1]*Y,xe=N*ge+F*Te+G*he;if(Math.abs(xe)<1e-15)return null;const Me=1/xe,ke=k[0]-u,lt=k[1]-l,it=k[2]-c,xt=(ke*ge+lt*Te+it*he)*Me;if(xt<0||xt>1)return null;const Bt=lt*G-it*F,gt=it*N-ke*G,Et=ke*F-lt*N,Rt=(D[0]*Bt+D[1]*gt+D[2]*Et)*Me;return Rt<0||xt+Rt>1?null:(Y*Bt+J*gt+oe*Et)*Me}function e6(u,l,c){return(u-l)/(c-l)}function t6(u,l,c,d,g,_,w,C,R){const k=1<<c,D=_-d,N=w-g,F=(u+1)/k*D+d,G=(l+0)/k*N+g,Y=(l+1)/k*N+g;C[0]=(u+0)/k*D+d,C[1]=G,R[0]=F,R[1]=Y}class r6{constructor(l){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=l,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const c=function(_){const w=Math.ceil(Math.log2(_.dim/8)),C=[];let R=Math.ceil(Math.pow(2,w));const k=1/R,D=(G,Y,J,oe,ge)=>{const Te=oe?1:0,he=(G+1)*J-Te,xe=Y*J,Me=(Y+1)*J-Te;ge[0]=G*J,ge[1]=xe,ge[2]=he,ge[3]=Me};let N=new ZG(R);const F=[];for(let G=0;G<R*R;G++){D(G%R,Math.floor(G/R),k,!1,F);const Y=Nf(F[0],F[1],_),J=Nf(F[2],F[1],_),oe=Nf(F[2],F[3],_),ge=Nf(F[0],F[3],_);N.minimums.push(Math.min(Y,J,oe,ge)),N.maximums.push(Math.max(Y,J,oe,ge)),N.leaves.push(1)}for(C.push(N),R/=2;R>=1;R/=2){const G=C[C.length-1];N=new ZG(R);for(let Y=0;Y<R*R;Y++){D(Y%R,Math.floor(Y/R),2,!0,F);const J=G.getElevation(F[0],F[1]),oe=G.getElevation(F[2],F[1]),ge=G.getElevation(F[2],F[3]),Te=G.getElevation(F[0],F[3]),he=G.isLeaf(F[0],F[1]),xe=G.isLeaf(F[2],F[1]),Me=G.isLeaf(F[2],F[3]),ke=G.isLeaf(F[0],F[3]),lt=Math.min(J.min,oe.min,ge.min,Te.min),it=Math.max(J.max,oe.max,ge.max,Te.max),xt=he&&xe&&Me&&ke;N.maximums.push(it),N.minimums.push(lt),N.leaves.push(it-lt<=5&&xt?1:0)}C.push(N)}return C}(this.dem),d=c.length-1,g=c[d];this._addNode(g.minimums[0],g.maximums[0],g.leaves[0]),this._construct(c,0,0,d,0)}raycastRoot(l,c,d,g,_,w,C=1){return JG([l,c,-100],[d,g,this.maximums[0]*C],_,w)}raycast(l,c,d,g,_,w,C=1){if(!this.nodeCount)return null;const R=this.raycastRoot(l,c,d,g,_,w,C);if(R==null)return null;const k=[],D=[],N=[],F=[],G=[{idx:0,t:R,nodex:0,nodey:0,depth:0}];for(;G.length>0;){const{idx:Y,t:J,nodex:oe,nodey:ge,depth:Te}=G.pop();if(this.leaves[Y]){t6(oe,ge,Te,l,c,d,g,N,F);const xe=1<<Te,Me=(oe+0)/xe,ke=(oe+1)/xe,lt=(ge+0)/xe,it=(ge+1)/xe,xt=Nf(Me,lt,this.dem)*C,Bt=Nf(ke,lt,this.dem)*C,gt=Nf(ke,it,this.dem)*C,Et=Nf(Me,it,this.dem)*C,Rt=QG(N[0],N[1],xt,F[0],N[1],Bt,F[0],F[1],gt,_,w),$t=QG(F[0],F[1],gt,N[0],F[1],Et,N[0],N[1],xt,_,w),Ft=Math.min(Rt!==null?Rt:Number.MAX_VALUE,$t!==null?$t:Number.MAX_VALUE);if(Ft!==Number.MAX_VALUE)return Ft;{const yt=r0([],_,w,J);if(n6(xt,Bt,Et,gt,e6(yt[0],N[0],F[0]),e6(yt[1],N[1],F[1]))>=yt[2])return J}continue}let he=0;for(let xe=0;xe<this._siblingOffset.length;xe++){t6((oe<<1)+this._siblingOffset[xe][0],(ge<<1)+this._siblingOffset[xe][1],Te+1,l,c,d,g,N,F),N[2]=-100,F[2]=this.maximums[this.childOffsets[Y]+xe]*C;const Me=JG(N,F,_,w);if(Me!=null){const ke=Me;k[xe]=ke;let lt=!1;for(let it=0;it<he&&!lt;it++)ke>=k[D[it]]&&(D.splice(it,0,xe),lt=!0);lt||(D[he]=xe),he++}}for(let xe=0;xe<he;xe++){const Me=D[xe];G.push({idx:this.childOffsets[Y]+Me,t:k[Me],nodex:(oe<<1)+this._siblingOffset[Me][0],nodey:(ge<<1)+this._siblingOffset[Me][1],depth:Te+1})}}return null}_addNode(l,c,d){return this.minimums.push(l),this.maximums.push(c),this.leaves.push(d),this.childOffsets.push(0),this.nodeCount++}_construct(l,c,d,g,_){if(l[g].isLeaf(c,d)===1)return;this.childOffsets[_]||(this.childOffsets[_]=this.nodeCount);const w=g-1,C=l[w];let R=0,k=0;for(let D=0;D<this._siblingOffset.length;D++){const N=2*c+this._siblingOffset[D][0],F=2*d+this._siblingOffset[D][1],G=C.getElevation(N,F),Y=C.isLeaf(N,F),J=this._addNode(G.min,G.max,Y);Y&&(R|=1<<D),k||(k=J)}for(let D=0;D<this._siblingOffset.length;D++)R&1<<D||this._construct(l,2*c+this._siblingOffset[D][0],2*d+this._siblingOffset[D][1],w,k+D)}}function n6(u,l,c,d,g,_){return gn(gn(u,c,_),gn(l,d,_),g)}function Nf(u,l,c){const d=c.dim,g=Ce(u*d-.5,0,d-1),_=Ce(l*d-.5,0,d-1),w=Math.floor(g),C=Math.floor(_),R=Math.min(w+1,d-1),k=Math.min(C+1,d-1);return n6(c.get(w,C),c.get(R,C),c.get(w,k),c.get(R,k),g-w,_-C)}const i6={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function qge(u,l,c){return(256*u*256+256*l+c)/10-1e4}function Xge(u,l,c){return 256*u+l+c/256-32768}class gO{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(l,c,d,g=!1,_=!1){if(this.uid=l,c.height!==c.width)throw new RangeError("DEM tiles must be square");if(d&&d!=="mapbox"&&d!=="terrarium")return jt(`"${d}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=c.height;const w=this.dim=c.height-2,C=new Uint32Array(c.data.buffer);if(this.pixels=new Uint8Array(c.data.buffer),this.encoding=d||"mapbox",this.borderReady=g,!g){for(let R=0;R<w;R++)C[this._idx(-1,R)]=C[this._idx(0,R)],C[this._idx(w,R)]=C[this._idx(w-1,R)],C[this._idx(R,-1)]=C[this._idx(R,0)],C[this._idx(R,w)]=C[this._idx(R,w-1)];C[this._idx(-1,-1)]=C[this._idx(0,0)],C[this._idx(w,-1)]=C[this._idx(w-1,0)],C[this._idx(-1,w)]=C[this._idx(0,w-1)],C[this._idx(w,w)]=C[this._idx(w-1,w-1)],_&&this._buildQuadTree()}}_buildQuadTree(){this._tree=new r6(this)}get(l,c,d=!1){d&&(l=Ce(l,-1,this.dim),c=Ce(c,-1,this.dim));const g=4*this._idx(l,c);return(this.encoding==="terrarium"?Xge:qge)(this.pixels[g],this.pixels[g+1],this.pixels[g+2])}static getUnpackVector(l){return i6[l]}get unpackVector(){return i6[this.encoding]}_idx(l,c){if(l<-1||l>=this.dim+1||c<-1||c>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(c+1)*this.stride+(l+1)}static pack(l,c){const d=[0,0,0,0],g=gO.getUnpackVector(c);let _=Math.floor((l+g[3])/g[2]);return d[2]=_%256,_=Math.floor(_/256),d[1]=_%256,_=Math.floor(_/256),d[0]=_,d}getPixels(){return new Aa({width:this.stride,height:this.stride},this.pixels)}backfillBorder(l,c,d){if(this.dim!==l.dim)throw new Error("dem dimension mismatch");let g=c*this.dim,_=c*this.dim+this.dim,w=d*this.dim,C=d*this.dim+this.dim;switch(c){case-1:g=_-1;break;case 1:_=g+1}switch(d){case-1:w=C-1;break;case 1:C=w+1}const R=-c*this.dim,k=-d*this.dim;for(let D=w;D<C;D++)for(let N=g;N<_;N++){const F=4*this._idx(N,D),G=4*this._idx(N+R,D+k);this.pixels[F+0]=l.pixels[G+0],this.pixels[F+1]=l.pixels[G+1],this.pixels[F+2]=l.pixels[G+2],this.pixels[F+3]=l.pixels[G+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}nr(gO,"DEMData"),nr(r6,"DemMinMaxQuadTree",{omit:["dem"]});class Zge{constructor(l,c){this.max=l,this.onRemove=c,this.reset()}reset(){for(const l in this.data)for(const c of this.data[l])c.timeout&&clearTimeout(c.timeout),this.onRemove(c.value);return this.data={},this.order=[],this}add(l,c,d){const g=l.wrapped().key;this.data[g]===void 0&&(this.data[g]=[]);const _={value:c,timeout:void 0};if(d!==void 0&&(_.timeout=setTimeout(()=>{this.remove(l,_)},d)),this.data[g].push(_),this.order.push(g),this.order.length>this.max){const w=this._getAndRemoveByKey(this.order[0]);w&&this.onRemove(w)}return this}has(l){return l.wrapped().key in this.data}getAndRemove(l){return this.has(l)?this._getAndRemoveByKey(l.wrapped().key):null}_getAndRemoveByKey(l){const c=this.data[l].shift();return c.timeout&&clearTimeout(c.timeout),this.data[l].length===0&&delete this.data[l],this.order.splice(this.order.indexOf(l),1),c.value}getByKey(l){const c=this.data[l];return c?c[0].value:null}get(l){return this.has(l)?this.data[l.wrapped().key][0].value:null}remove(l,c){if(!this.has(l))return this;const d=l.wrapped().key,g=c===void 0?0:this.data[d].indexOf(c),_=this.data[d][g];return this.data[d].splice(g,1),_.timeout&&clearTimeout(_.timeout),this.data[d].length===0&&delete this.data[d],this.onRemove(_.value),this.order.splice(this.order.indexOf(d),1),this}setMaxSize(l){for(this.max=l;this.order.length>this.max;){const c=this._getAndRemoveByKey(this.order[0]);c&&this.onRemove(c)}return this}filter(l){const c=[];for(const d in this.data)for(const g of this.data[d])l(g.value)||c.push(g);for(const d of c)this.remove(d.value.tileID,d)}}class zg{constructor(l,c,d){this.func=l,this.mask=c,this.range=d}}zg.ReadOnly=!1,zg.ReadWrite=!0,zg.disabled=new zg(519,zg.ReadOnly,[0,1]);const q$=7680;class X${constructor(l,c,d,g,_,w){this.test=l,this.ref=c,this.mask=d,this.fail=g,this.depthFail=_,this.pass=w}}X$.disabled=new X$({func:519,mask:0},0,0,q$,q$,q$);class ql{constructor(l,c,d){this.blendFunction=l,this.blendColor=c,this.mask=d}}ql.Replace=[1,0],ql.disabled=new ql(ql.Replace,xi.transparent,[!1,!1,!1,!1]),ql.unblended=new ql(ql.Replace,xi.transparent,[!0,!0,!0,!0]),ql.alphaBlended=new ql([1,771],xi.transparent,[!0,!0,!0,!0]);const Z$=1029,J$=2305;class ll{constructor(l,c,d){this.enable=l,this.mode=c,this.frontFace=d}}ll.disabled=new ll(!1,Z$,J$),ll.backCCW=new ll(!0,Z$,J$),ll.backCW=new ll(!0,Z$,2304),ll.frontCW=new ll(!0,1028,2304),ll.frontCCW=new ll(!0,1028,J$);class Fd extends Kn{constructor(l,c,d){super(),this.id=l,this._onlySymbols=d,c.on("data",g=>{g.dataType==="source"&&g.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&g.dataType==="source"&&g.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),c.on("error",()=>{this._sourceErrored=!0}),this._source=c,this._tiles={},this._cache=new Zge(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=c.minTileCacheSize,this._maxTileCacheSize=c.maxTileCacheSize,this._loadedParentTiles={},this._coveredTiles={},this._state=new Kge,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(l){this.map=l,this._minTileCacheSize=this._minTileCacheSize===void 0&&l?l._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&l?l._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const l in this._tiles){const c=this._tiles[l];if(c.state!=="loaded"&&c.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const l=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,l&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(l,c){return l.isSymbolTile=this._onlySymbols,this._source.loadTile(l,c)}_unloadTile(l){if(this._source.unloadTile)return this._source.unloadTile(l,()=>{})}_abortTile(l){if(this._source.abortTile)return this._source.abortTile(l,()=>{})}serialize(){return this._source.serialize()}prepare(l){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const c in this._tiles){const d=this._tiles[c];d.upload(l),d.prepare(this.map.style.imageManager)}}getIds(){return M(this._tiles).map(l=>l.tileID).sort(o6).map(l=>l.key)}getRenderableIds(l){const c=[];for(const d in this._tiles)this._isIdRenderable(+d,l)&&c.push(this._tiles[d]);return l?c.sort((d,g)=>{const _=d.tileID,w=g.tileID,C=new q(_.canonical.x,_.canonical.y)._rotate(this.transform.angle),R=new q(w.canonical.x,w.canonical.y)._rotate(this.transform.angle);return _.overscaledZ-w.overscaledZ||R.y-C.y||R.x-C.x}).map(d=>d.tileID.key):c.map(d=>d.tileID).sort(o6).map(d=>d.key)}hasRenderableParent(l){const c=this.findLoadedParent(l,0);return!!c&&this._isIdRenderable(c.tileID.key)}_isIdRenderable(l,c){return this._tiles[l]&&this._tiles[l].hasData()&&!this._coveredTiles[l]&&(c||!this._tiles[l].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const l in this._tiles)this._tiles[l].state!=="errored"&&this._reloadTile(+l,"reloading")}}_reloadTile(l,c){const d=this._tiles[l];d&&(d.state!=="loading"&&(d.state=c),this._loadTile(d,this._tileLoaded.bind(this,d,l,c)))}_tileLoaded(l,c,d,g){if(g)if(l.state="errored",g.status!==404)this._source.fire(new sa(g,{tile:l}));else if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const _=this.map.painter.terrain;this.update(this.transform,_.getScaledDemTileSize(),!0),_.resetTileLookupCache(this.id)}else this.update(this.transform);else l.timeAdded=mr.now(),d==="expired"&&(l.refreshedUponExpiration=!0),this._setTileReloadTimer(c,l),this._source.type==="raster-dem"&&l.dem&&this._backfillDEM(l),this._state.initializeTileState(l,this.map?this.map.painter:null),this._source.fire(new Nr("data",{dataType:"source",tile:l,coord:l.tileID,sourceCacheId:this.id}))}_backfillDEM(l){const c=this.getRenderableIds();for(let g=0;g<c.length;g++){const _=c[g];if(l.neighboringTiles&&l.neighboringTiles[_]){const w=this.getTileByID(_);d(l,w),d(w,l)}}function d(g,_){if(!g.dem||g.dem.borderReady)return;g.needsHillshadePrepare=!0,g.needsDEMTextureUpload=!0;let w=_.tileID.canonical.x-g.tileID.canonical.x;const C=_.tileID.canonical.y-g.tileID.canonical.y,R=Math.pow(2,g.tileID.canonical.z),k=_.tileID.key;w===0&&C===0||Math.abs(C)>1||(Math.abs(w)>1&&(Math.abs(w+R)===1?w+=R:Math.abs(w-R)===1&&(w-=R)),_.dem&&g.dem&&(g.dem.backfillBorder(_.dem,w,C),g.neighboringTiles&&g.neighboringTiles[k]&&(g.neighboringTiles[k].backfilled=!0)))}}getTile(l){return this.getTileByID(l.key)}getTileByID(l){return this._tiles[l]}_retainLoadedChildren(l,c,d,g){for(const _ in this._tiles){let w=this._tiles[_];if(g[_]||!w.hasData()||w.tileID.overscaledZ<=c||w.tileID.overscaledZ>d)continue;let C=w.tileID;for(;w&&w.tileID.overscaledZ>c+1;){const k=w.tileID.scaledTo(w.tileID.overscaledZ-1);w=this._tiles[k.key],w&&w.hasData()&&(C=k)}let R=C;for(;R.overscaledZ>c;)if(R=R.scaledTo(R.overscaledZ-1),l[R.key]){g[C.key]=C;break}}}findLoadedParent(l,c){if(l.key in this._loadedParentTiles){const d=this._loadedParentTiles[l.key];return d&&d.tileID.overscaledZ>=c?d:null}for(let d=l.overscaledZ-1;d>=c;d--){const g=l.scaledTo(d),_=this._getLoadedTile(g);if(_)return _}}_getLoadedTile(l){const c=this._tiles[l.key];return c&&c.hasData()?c:this._cache.getByKey(this._source.reparseOverscaled?l.wrapped().key:l.canonical.key)}updateCacheSize(l,c){c=c||this._source.tileSize;const d=Math.ceil(l.width/c)+1,g=Math.ceil(l.height/c)+1,_=Math.floor(d*g*5),w=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,_):_,C=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,w):w;this._cache.setMaxSize(C)}handleWrapJump(l){const c=Math.round((l-(this._prevLng===void 0?l:this._prevLng))/360);if(this._prevLng=l,c){const d={};for(const g in this._tiles){const _=this._tiles[g];_.tileID=_.tileID.unwrapTo(_.tileID.wrap+c),d[_.tileID.key]=_}this._tiles=d;for(const g in this._timers)clearTimeout(this._timers[g]),delete this._timers[g];for(const g in this._tiles)this._setTileReloadTimer(+g,this._tiles[g])}}update(l,c,d){if(this.transform=l,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!d)return;let g;this.updateCacheSize(l,c),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?g=l.getVisibleUnwrappedCoordinates(this._source.tileID).map(C=>new Ko(C.canonical.z,C.wrap,C.canonical.z,C.canonical.x,C.canonical.y)):(g=l.coveringTiles({tileSize:c||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!d,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(g=g.filter(C=>this._source.hasTile(C)))):g=[];const _=this._updateRetainedTiles(g);if(a6(this._source.type)&&g.length!==0){const C={},R={},k=Object.keys(_);for(const N of k){const F=_[N],G=this._tiles[N];if(!G||G.fadeEndTime&&G.fadeEndTime<=mr.now())continue;const Y=this.findLoadedParent(F,Math.max(F.overscaledZ-Fd.maxOverzooming,this._source.minzoom));Y&&(this._addTile(Y.tileID),C[Y.tileID.key]=Y.tileID),R[N]=F}const D=g[g.length-1].overscaledZ;for(const N in this._tiles){const F=this._tiles[N];if(_[N]||!F.hasData())continue;let G=F.tileID;for(;G.overscaledZ>D;){G=G.scaledTo(G.overscaledZ-1);const Y=this._tiles[G.key];if(Y&&Y.hasData()&&R[G.key]){_[N]=F.tileID;break}}}for(const N in C)_[N]||(this._coveredTiles[N]=!0,_[N]=C[N])}for(const C in _)this._tiles[C].clearFadeHold();const w=function(C,R){const k=[];for(const D in C)D in R||k.push(D);return k}(this._tiles,_);for(const C of w){const R=this._tiles[C];R.hasSymbolBuckets&&!R.holdingForFade()?R.setHoldDuration(this.map._fadeDuration):R.hasSymbolBuckets&&!R.symbolFadeFinished()||this._removeTile(+C)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const l in this._tiles)this._tiles[l].holdingForFade()&&this._removeTile(+l)}_updateRetainedTiles(l){const c={};if(l.length===0)return c;const d={},g=l.reduce((k,D)=>Math.min(k,D.overscaledZ),1/0),_=l[0].overscaledZ,w=Math.max(_-Fd.maxOverzooming,this._source.minzoom),C=Math.max(_+Fd.maxUnderzooming,this._source.minzoom),R={};for(const k of l){const D=this._addTile(k);c[k.key]=k,D.hasData()||g<this._source.maxzoom&&(R[k.key]=k)}this._retainLoadedChildren(R,g,C,c);for(const k of l){let D=this._tiles[k.key];if(D.hasData())continue;if(k.canonical.z>=this._source.maxzoom){const F=k.children(this._source.maxzoom)[0],G=this.getTile(F);if(G&&G.hasData()){c[F.key]=F;continue}}else{const F=k.children(this._source.maxzoom);if(c[F[0].key]&&c[F[1].key]&&c[F[2].key]&&c[F[3].key])continue}let N=D.wasRequested();for(let F=k.overscaledZ-1;F>=w;--F){const G=k.scaledTo(F);if(d[G.key]||(d[G.key]=!0,D=this.getTile(G),!D&&N&&(D=this._addTile(G)),D&&(c[G.key]=G,N=D.wasRequested(),D.hasData())))break}}return c}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const l in this._tiles){const c=[];let d,g=this._tiles[l].tileID;for(;g.overscaledZ>0;){if(g.key in this._loadedParentTiles){d=this._loadedParentTiles[g.key];break}c.push(g.key);const _=g.scaledTo(g.overscaledZ-1);if(d=this._getLoadedTile(_),d)break;g=_}for(const _ of c)this._loadedParentTiles[_]=d}}_addTile(l){let c=this._tiles[l.key];if(c)return c;c=this._cache.getAndRemove(l),c&&(this._setTileReloadTimer(l.key,c),c.tileID=l,this._state.initializeTileState(c,this.map?this.map.painter:null),this._cacheTimers[l.key]&&(clearTimeout(this._cacheTimers[l.key]),delete this._cacheTimers[l.key],this._setTileReloadTimer(l.key,c)));const d=!!c;if(!d){const g=this.map?this.map.painter:null;c=new K$(l,this._source.tileSize*l.overscaleFactor(),this.transform.tileZoom,g,this._isRaster),this._loadTile(c,this._tileLoaded.bind(this,c,l.key,c.state))}return c?(c.uses++,this._tiles[l.key]=c,d||this._source.fire(new Nr("dataloading",{tile:c,coord:c.tileID,dataType:"source"})),c):null}_setTileReloadTimer(l,c){l in this._timers&&(clearTimeout(this._timers[l]),delete this._timers[l]);const d=c.getExpiryTimeout();d&&(this._timers[l]=setTimeout(()=>{this._reloadTile(l,"expired"),delete this._timers[l]},d))}_removeTile(l){const c=this._tiles[l];c&&(c.uses--,delete this._tiles[l],this._timers[l]&&(clearTimeout(this._timers[l]),delete this._timers[l]),c.uses>0||(c.hasData()&&c.state!=="reloading"?this._cache.add(c.tileID,c,c.getExpiryTimeout()):(c.aborted=!0,this._abortTile(c),this._unloadTile(c))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const l in this._tiles)this._removeTile(+l);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(l,c,d){const g=[],_=this.transform;if(!_)return g;const w=_.projection.name==="globe",C=Ul(_.center.lng);for(const R in this._tiles){const k=this._tiles[R];if(d&&k.clearQueryDebugViz(),k.holdingForFade())continue;let D;if(w){const N=k.tileID.canonical;if(N.z===0){const F=[Math.abs(Ce(C,...O0(N,-1))-C),Math.abs(Ce(C,...O0(N,1))-C)];D=[0,2*F.indexOf(Math.min(...F))-1]}else{const F=[Math.abs(Ce(C,...O0(N,-1))-C),Math.abs(Ce(C,...O0(N,0))-C),Math.abs(Ce(C,...O0(N,1))-C)];D=[F.indexOf(Math.min(...F))-1]}}else D=[0];for(const N of D){const F=l.containsTile(k,_,c,N);F&&g.push(F)}}return g}getVisibleCoordinates(l){const c=this.getRenderableIds(l).map(d=>this._tiles[d].tileID);for(const d of c)d.projMatrix=this.transform.calculateProjMatrix(d.toUnwrapped());return c}hasTransition(){if(this._source.hasTransition())return!0;if(a6(this._source.type))for(const l in this._tiles){const c=this._tiles[l];if(c.fadeEndTime!==void 0&&c.fadeEndTime>=mr.now())return!0}return!1}setFeatureState(l,c,d){this._state.updateState(l=l||"_geojsonTileLayer",c,d)}removeFeatureState(l,c,d){this._state.removeFeatureState(l=l||"_geojsonTileLayer",c,d)}getFeatureState(l,c){return this._state.getState(l=l||"_geojsonTileLayer",c)}setDependencies(l,c,d){const g=this._tiles[l];g&&g.setDependencies(c,d)}reloadTilesForDependencies(l,c){for(const d in this._tiles)this._tiles[d].hasDependency(l,c)&&this._reloadTile(+d,"reloading");this._cache.filter(d=>!d.hasDependency(l,c))}_preloadTiles(l,c){const d=new Map,g=Array.isArray(l)?l:[l],_=this.map.painter.terrain,w=this.usedForTerrain&&_?_.getScaledDemTileSize():this._source.tileSize;for(const C of g){const R=C.coveringTiles({tileSize:w,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const k of R)d.set(k.key,k);this.usedForTerrain&&C.updateElevation(!1)}ie(Array.from(d.values()),(C,R)=>{const k=new K$(C,this._source.tileSize*C.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(k,D=>{this._source.type==="raster-dem"&&k.dem&&this._backfillDEM(k),R(D,k)})},c)}}function o6(u,l){const c=Math.abs(2*u.wrap)-+(u.wrap<0),d=Math.abs(2*l.wrap)-+(l.wrap<0);return u.overscaledZ-l.overscaledZ||d-c||l.canonical.y-u.canonical.y||l.canonical.x-u.canonical.x}function a6(u){return u==="raster"||u==="image"||u==="video"||u==="custom"}function O0(u,l){const c=1<<u.z;return[u.x/c+l,(u.x+1)/c+l]}Fd.maxOverzooming=10,Fd.maxUnderzooming=3;class yO{constructor(l,c,d){this._demTile=l,this._dem=this._demTile.dem,this._scale=c,this._offset=d}static create(l,c,d){const g=d||l.findDEMTileFor(c);if(!g||!g.dem)return;const _=g.dem,w=g.tileID,C=1<<c.canonical.z-w.canonical.z;return new yO(g,g.tileSize/Pr/C,[(c.canonical.x/C-w.canonical.x)*_.dim,(c.canonical.y/C-w.canonical.y)*_.dim])}tileCoordToPixel(l,c){const d=c*this._scale+this._offset[1],g=Math.floor(l*this._scale+this._offset[0]),_=Math.floor(d);return new q(g,_)}getElevationAt(l,c,d,g){const _=l*this._scale+this._offset[0],w=c*this._scale+this._offset[1],C=Math.floor(_),R=Math.floor(w),k=this._dem;return g=!!g,d?gn(gn(k.get(C,R,g),k.get(C,R+1,g),w-R),gn(k.get(C+1,R,g),k.get(C+1,R+1,g),w-R),_-C):k.get(C,R,g)}getElevationAtPixel(l,c,d){return this._dem.get(l,c,!!d)}getMeterToDEM(l){return(1<<this._demTile.tileID.canonical.z)*sl(1,l)*this._dem.stride}}class s6{constructor(l,c){this.tileID=l,this.x=l.canonical.x,this.y=l.canonical.y,this.z=l.canonical.z,this.grid=new Ef(Pr,16,0),this.featureIndexArray=new ZW,this.promoteId=c}insert(l,c,d,g,_,w=0){const C=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(d,g,_,w);const R=this.grid;for(let k=0;k<c.length;k++){const D=c[k],N=[1/0,1/0,-1/0,-1/0];for(let F=0;F<D.length;F++){const G=D[F];N[0]=Math.min(N[0],G.x),N[1]=Math.min(N[1],G.y),N[2]=Math.max(N[2],G.x),N[3]=Math.max(N[3],G.y)}N[0]<Pr&&N[1]<Pr&&N[2]>=0&&N[3]>=0&&R.insert(C,N[0],N[1],N[2],N[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new M$(new _0(this.rawTileData)).layers,this.sourceLayerCoder=new GG(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const l in this.vtLayers)this.vtFeatures[l]=[]}return this.vtLayers}query(l,c,d,g){this.loadVTLayers();const _=l.params||{},w=hg(_.filter),C=l.tileResult,R=l.transform,k=C.bufferedTilespaceBounds,D=this.grid.query(k.min.x,k.min.y,k.max.x,k.max.y,(Y,J,oe,ge)=>D5(C.bufferedTilespaceGeometry,Y,J,oe,ge));D.sort(Jge);let N=null;R.elevation&&D.length>0&&(N=yO.create(R.elevation,this.tileID));const F={};let G;for(let Y=0;Y<D.length;Y++){const J=D[Y];if(J===G)continue;G=J;const oe=this.featureIndexArray.get(J);let ge=null;this.loadMatchingFeature(F,oe,w,_.layers,_.availableImages,c,d,g,(Te,he,xe,Me=0)=>(ge||(ge=Hu(Te,this.tileID.canonical,l.tileTransform)),he.queryIntersectsFeature(C,Te,xe,ge,this.z,l.transform,l.pixelPosMatrix,N,Me)))}return F}loadMatchingFeature(l,c,d,g,_,w,C,R,k){const{featureIndex:D,bucketIndex:N,sourceLayerIndex:F,layoutVertexArrayOffset:G}=c,Y=this.bucketLayerIDs[N];if(g&&!function(Te,he){for(let xe=0;xe<Te.length;xe++)if(he.indexOf(Te[xe])>=0)return!0;return!1}(g,Y))return;const J=this.sourceLayerCoder.decode(F),oe=this.vtLayers[J].feature(D);if(d.needGeometry){const Te=Ld(oe,!0);if(!d.filter(new Ze(this.tileID.overscaledZ),Te,this.tileID.canonical))return}else if(!d.filter(new Ze(this.tileID.overscaledZ),oe))return;const ge=this.getId(oe,J);for(let Te=0;Te<Y.length;Te++){const he=Y[Te];if(g&&g.indexOf(he)<0)continue;const xe=w[he];if(!xe)continue;let Me={};ge!==void 0&&R&&(Me=R.getState(xe.sourceLayer||"_geojsonTileLayer",ge));const ke=U({},C[he]);ke.paint=l6(ke.paint,xe.paint,oe,Me,_),ke.layout=l6(ke.layout,xe.layout,oe,Me,_);const lt=!k||k(oe,xe,Me,G);if(!lt)continue;const it=new YG(oe,this.z,this.x,this.y,ge);it.layer=ke;let xt=l[he];xt===void 0&&(xt=l[he]=[]),xt.push({featureIndex:D,feature:it,intersectionZ:lt})}}lookupSymbolFeatures(l,c,d,g,_,w,C,R){const k={};this.loadVTLayers();const D=hg(_);for(const N of l)this.loadMatchingFeature(k,{bucketIndex:d,sourceLayerIndex:g,featureIndex:N,layoutVertexArrayOffset:0},D,w,C,R,c);return k}loadFeature(l){const{featureIndex:c,sourceLayerIndex:d}=l;this.loadVTLayers();const g=this.sourceLayerCoder.decode(d),_=this.vtFeatures[g];if(_[c])return _[c];const w=this.vtLayers[g].feature(c);return _[c]=w,w}hasLayer(l){for(const c of this.bucketLayerIDs)for(const d of c)if(l===d)return!0;return!1}getId(l,c){let d=l.id;if(this.promoteId){const g=typeof this.promoteId=="string"?this.promoteId:this.promoteId[c];g!=null&&(d=l.properties[g]),typeof d=="boolean"&&(d=Number(d))}return d}}function l6(u,l,c,d,g){return ft(u,(_,w)=>{const C=l instanceof st?l.get(w):null;return C&&C.evaluate?C.evaluate(c,d,g):C})}function Jge(u,l){return l-u}nr(s6,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});class u6{constructor(l,c){this.width=l,this.height=c,this.nextRow=0,this.image=new Vu({width:l,height:c}),this.positions={},this.uploaded=!1}getDash(l,c){const d=this.getKey(l,c);return this.positions[d]}trim(){const l=this.width,c=this.height=Oe(this.nextRow);this.image.resize({width:l,height:c})}getKey(l,c){return l.join(",")+c}getDashRanges(l,c,d){const g=[];let _=l.length%2==1?-l[l.length-1]*d:0,w=l[0]*d,C=!0;g.push({left:_,right:w,isDash:C,zeroLength:l[0]===0});let R=l[0];for(let k=1;k<l.length;k++){C=!C;const D=l[k];_=R*d,R+=D,w=R*d,g.push({left:_,right:w,isDash:C,zeroLength:D===0})}return g}addRoundDash(l,c,d){const g=c/2;for(let _=-d;_<=d;_++){const w=this.width*(this.nextRow+d+_);let C=0,R=l[C];for(let k=0;k<this.width;k++){k/R.right>1&&(R=l[++C]);const D=Math.abs(k-R.left),N=Math.abs(k-R.right),F=Math.min(D,N);let G;const Y=_/d*(g+1);if(R.isDash){const J=g-Math.abs(Y);G=Math.sqrt(F*F+J*J)}else G=g-Math.sqrt(F*F+Y*Y);this.image.data[w+k]=Math.max(0,Math.min(255,G+128))}}}addRegularDash(l,c){for(let R=l.length-1;R>=0;--R){const k=l[R],D=l[R+1];k.zeroLength?l.splice(R,1):D&&D.isDash===k.isDash&&(D.left=k.left,l.splice(R,1))}const d=l[0],g=l[l.length-1];d.isDash===g.isDash&&(d.left=g.left-this.width,g.right=d.right+this.width);const _=this.width*this.nextRow;let w=0,C=l[w];for(let R=0;R<this.width;R++){R/C.right>1&&(C=l[++w]);const k=Math.abs(R-C.left),D=Math.abs(R-C.right),N=Math.min(k,D);this.image.data[_+R]=Math.max(0,Math.min(255,(C.isDash?N:-N)+c+128))}}addDash(l,c){const d=this.getKey(l,c);if(this.positions[d])return this.positions[d];const g=c==="round",_=g?7:0,w=2*_+1;if(this.nextRow+w>this.height)return jt("LineAtlas out of space"),null;l.length===0&&l.push(1);let C=0;for(let D=0;D<l.length;D++)l[D]<0&&(jt("Negative value is found in line dasharray, replacing values with 0"),l[D]=0),C+=l[D];if(C!==0){const D=this.width/C,N=this.getDashRanges(l,this.width,D);g?this.addRoundDash(N,D,_):this.addRegularDash(N,c==="square"?.5*D:0)}const R=this.nextRow+_;this.nextRow+=w;const k={tl:[R,_],br:[C,0]};return this.positions[d]=k,k}}nr(u6,"LineAtlas");class c6{constructor(l){const c={},d=[];for(const C in l){const R=l[C],k=c[C]={};for(const D in R.glyphs){const N=R.glyphs[+D];if(!N||N.bitmap.width===0||N.bitmap.height===0)continue;const F=N.metrics.localGlyph?2:1,G={x:0,y:0,w:N.bitmap.width+2*F,h:N.bitmap.height+2*F};d.push(G),k[D]=G}}const{w:g,h:_}=L$(d),w=new Vu({width:g||1,height:_||1});for(const C in l){const R=l[C];for(const k in R.glyphs){const D=R.glyphs[+k];if(!D||D.bitmap.width===0||D.bitmap.height===0)continue;const N=c[C][k],F=D.metrics.localGlyph?2:1;Vu.copy(D.bitmap,w,{x:0,y:0},{x:N.x+F,y:N.y+F},D.bitmap)}}this.image=w,this.positions=c}}nr(c6,"GlyphAtlas");class Qge{constructor(l){this.tileID=new Ko(l.tileID.overscaledZ,l.tileID.wrap,l.tileID.canonical.z,l.tileID.canonical.x,l.tileID.canonical.y),this.tileZoom=l.tileZoom,this.uid=l.uid,this.zoom=l.zoom,this.canonical=l.tileID.canonical,this.pixelRatio=l.pixelRatio,this.tileSize=l.tileSize,this.source=l.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=l.showCollisionBoxes,this.collectResourceTiming=!!l.collectResourceTiming,this.returnDependencies=!!l.returnDependencies,this.promoteId=l.promoteId,this.enableTerrain=!!l.enableTerrain,this.isSymbolTile=l.isSymbolTile,this.tileTransform=jd(l.tileID.canonical,l.projection),this.projection=l.projection}parse(l,c,d,g,_){this.status="parsing",this.data=l,this.collisionBoxArray=new t$;const w=new GG(Object.keys(l.layers).sort()),C=new s6(this.tileID,this.promoteId);C.bucketLayerIDs=[];const R={},k=new u6(256,256),D={featureIndex:C,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:k,availableImages:d},N=c.familiesBySource[this.source];for(const Me in N){const ke=l.layers[Me];if(!ke)continue;let lt=!1,it=!1;for(const gt of N[Me])gt[0].type==="symbol"?lt=!0:it=!0;if(this.isSymbolTile===!0&&!lt||this.isSymbolTile===!1&&!it)continue;ke.version===1&&jt(`Vector tile source "${this.source}" layer "${Me}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const xt=w.encode(Me),Bt=[];for(let gt=0;gt<ke.length;gt++){const Et=ke.feature(gt),Rt=C.getId(Et,Me);Bt.push({feature:Et,id:Rt,index:gt,sourceLayerIndex:xt})}for(const gt of N[Me]){const Et=gt[0];this.isSymbolTile!==void 0&&Et.type==="symbol"!==this.isSymbolTile||Et.minzoom&&this.zoom<Math.floor(Et.minzoom)||Et.maxzoom&&this.zoom>=Et.maxzoom||Et.visibility!=="none"&&(Q$(gt,this.zoom,d),(R[Et.id]=Et.createBucket({index:C.bucketLayerIDs.length,layers:gt,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:xt,sourceID:this.source,enableTerrain:this.enableTerrain,projection:this.projection.spec,availableImages:d})).populate(Bt,D,this.tileID.canonical,this.tileTransform),C.bucketLayerIDs.push(gt.map(Rt=>Rt.id)))}}let F,G,Y,J;k.trim();const oe={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},ge=ft(D.glyphDependencies,Me=>Object.keys(Me).map(Number));Object.keys(ge).length?g.send("getGlyphs",{uid:this.uid,stacks:ge},(Me,ke)=>{F||(F=Me,G=ke,xe.call(this))},void 0,!1,oe):G={};const Te=Object.keys(D.iconDependencies);Te.length?g.send("getImages",{icons:Te,source:this.source,tileID:this.tileID,type:"icons"},(Me,ke)=>{F||(F=Me,Y=ke,xe.call(this))},void 0,!1,oe):Y={};const he=Object.keys(D.patternDependencies);function xe(){if(F)return _(F);if(G&&Y&&J){const Me=new c6(G),ke=new _G(Y,J);for(const lt in R){const it=R[lt];it instanceof $f?(Q$(it.layers,this.zoom,d),Ege(it,G,Me.positions,Y,ke.iconPositions,this.showCollisionBoxes,d,this.tileID.canonical,this.tileZoom,this.projection)):it.hasPattern&&(it instanceof tO||it instanceof XT||it instanceof m0)&&(Q$(it.layers,this.zoom,d),it.addFeatures(D,this.tileID.canonical,ke.patternPositions,d,this.tileTransform))}this.status="done",_(null,{buckets:M(R).filter(lt=>!lt.isEmpty()),featureIndex:C,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Me.image,lineAtlas:k,imageAtlas:ke,glyphMap:this.returnDependencies?G:null,iconMap:this.returnDependencies?Y:null,glyphPositions:this.returnDependencies?Me.positions:null})}}he.length?g.send("getImages",{icons:he,source:this.source,tileID:this.tileID,type:"patterns"},(Me,ke)=>{F||(F=Me,J=ke,xe.call(this))},void 0,!1,oe):J={},xe.call(this)}}function Q$(u,l,c){const d=new Ze(l);for(const g of u)g.recalculate(d,c)}class f6{constructor(l){this.entries={},this.scheduler=l}request(l,c,d,g){const _=this.entries[l]=this.entries[l]||{callbacks:[]};if(_.result){const[w,C]=_.result;return this.scheduler?this.scheduler.add(()=>{g(w,C)},c):g(w,C),()=>{}}return _.callbacks.push(g),_.cancel||(_.cancel=d((w,C)=>{_.result=[w,C];for(const R of _.callbacks)this.scheduler?this.scheduler.add(()=>{R(w,C)},c):R(w,C);setTimeout(()=>delete this.entries[l],3e3)})),()=>{_.result||(_.callbacks=_.callbacks.filter(w=>w!==g),_.callbacks.length||(_.cancel(),delete this.entries[l]))}}}function h6(u,l,c){const d=JSON.stringify(u.request);return u.data&&(this.deduped.entries[d]={result:[null,u.data]}),this.deduped.request(d,{type:"parseTile",isSymbolTile:u.isSymbolTile,zoom:u.tileZoom},g=>{const _=Ir(u.request,(w,C,R,k)=>{w?g(w):C&&g(null,{vectorTile:c?void 0:new M$(new _0(C)),rawData:C,cacheControl:R,expires:k})});return()=>{_.cancel(),g()}},l)}a.ARRAY_TYPE=Pa,a.AUTH_ERR_MSG=an,a.Aabb=Yo,a.Actor=class{constructor(u,l,c){this.target=u,this.parent=l,this.mapId=c,this.callbacks={},this.cancelCallbacks={},Je(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=yr()?u:h,this.scheduler=new Gge}send(u,l,c,d,g=!1,_){const w=Math.round(1e18*Math.random()).toString(36).substring(0,10);c&&(c.metadata=_,this.callbacks[w]=c);const C=vr(this.globalScope)?void 0:[];return this.target.postMessage({id:w,type:u,hasCallback:!!c,targetMapId:d,mustQueue:g,sourceMapId:this.mapId,data:Cd(l,C)},C),{cancel:()=>{c&&delete this.callbacks[w],this.target.postMessage({id:w,type:"<cancel>",targetMapId:d,sourceMapId:this.mapId})}}}receive(u){const l=u.data,c=l.id;if(c&&(!l.targetMapId||this.mapId===l.targetMapId))if(l.type==="<cancel>"){const d=this.cancelCallbacks[c];delete this.cancelCallbacks[c],d&&d.cancel()}else if(l.mustQueue||yr()){const d=this.callbacks[c];this.cancelCallbacks[c]=this.scheduler.add(()=>this.processTask(c,l),d&&d.metadata||{type:"message"})}else this.processTask(c,l)}processTask(u,l){if(l.type==="<response>"){const c=this.callbacks[u];delete this.callbacks[u],c&&(l.error?c(Ed(l.error)):c(null,Ed(l.data)))}else{const c=vr(this.globalScope)?void 0:[],d=l.hasCallback?(_,w)=>{delete this.cancelCallbacks[u],this.target.postMessage({id:u,type:"<response>",sourceMapId:this.mapId,error:_?Cd(_):null,data:Cd(w,c)},c)}:_=>{},g=Ed(l.data);if(this.parent[l.type])this.parent[l.type](l.sourceMapId,g,d);else if(this.parent.getWorkerSource){const _=l.type.split(".");this.parent.getWorkerSource(l.sourceMapId,_[0],g.source)[_[1]](g,d)}else d(new Error(`Could not find function ${l.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}},a.CanonicalTileID=eO,a.Color=xi,a.ColorMode=ql,a.CullFaceMode=ll,a.DEMData=gO,a.DataConstantProperty=Ke,a.DedupedRequest=f6,a.DepthMode=zg,a.EXTENT=Pr,a.Elevation=class{isDataAvailableAtPoint(u){const l=this._source();if(this.isUsingMockSource()||!l||u.y<0||u.y>1)return!1;const c=l.getSource().maxzoom,d=1<<c,g=Math.floor(u.x),_=Math.floor((u.x-g)*d),w=Math.floor(u.y*d),C=this.findDEMTileFor(new Ko(c,g,c,_,w));return!(!C||!C.dem)}getAtPointOrZero(u,l=0){return this.getAtPoint(u,l)||0}getAtPoint(u,l,c=!0){if(this.isUsingMockSource())return null;l==null&&(l=null);const d=this._source();if(!d||u.y<0||u.y>1)return l;const g=d.getSource().maxzoom,_=1<<g,w=Math.floor(u.x),C=u.x-w,R=new Ko(g,w,g,Math.floor(C*_),Math.floor(u.y*_)),k=this.findDEMTileFor(R);if(!k||!k.dem)return l;const D=k.dem,N=1<<k.tileID.canonical.z,F=(C*N-k.tileID.canonical.x)*D.dim,G=(u.y*N-k.tileID.canonical.y)*D.dim,Y=Math.floor(F),J=Math.floor(G);return(c?this.exaggeration():1)*gn(gn(D.get(Y,J),D.get(Y,J+1),G-J),gn(D.get(Y+1,J),D.get(Y+1,J+1),G-J),F-Y)}getAtTileOffset(u,l,c){const d=1<<u.canonical.z;return this.getAtPointOrZero(new Rg(u.wrap+(u.canonical.x+l/Pr)/d,(u.canonical.y+c/Pr)/d))}getAtTileOffsetFunc(u,l,c,d){return g=>{const _=this.getAtTileOffset(u,g.x,g.y),w=d.upVector(u.canonical,g.x,g.y);return qa(w,w,_*d.upVectorScale(u.canonical,l,c).metersToTile),w}}getForTilePoints(u,l,c,d){if(this.isUsingMockSource())return!1;const g=yO.create(this,u,d);return!!g&&(l.forEach(_=>{_[2]=this.exaggeration()*g.getElevationAt(_[0],_[1],c)}),!0)}getMinMaxForTile(u){if(this.isUsingMockSource())return null;const l=this.findDEMTileFor(u);if(!l||!l.dem)return null;const c=l.dem.tree,d=l.tileID,g=1<<u.canonical.z-d.canonical.z;let _=u.canonical.x/g-d.canonical.x,w=u.canonical.y/g-d.canonical.y,C=0;for(let R=0;R<u.canonical.z-d.canonical.z&&!c.leaves[C];R++){_*=2,w*=2;const k=2*Math.floor(w)+Math.floor(_);C=c.childOffsets[C]+k,_%=1,w%=1}return{min:this.exaggeration()*c.minimums[C],max:this.exaggeration()*c.maximums[C]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(u,l,c){throw new Error("Pure virtual method called.")}pointCoordinate(u){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(u){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}},a.ErrorEvent=sa,a.EvaluationParameters=Ze,a.Event=Nr,a.Evented=Kn,a.FillExtrusionBucket=m0,a.Frustum=d$,a.FrustumCorners=h$,a.GLOBE_RADIUS=Hl,a.GLOBE_SCALE_MATCH_LATITUDE=45,a.GLOBE_ZOOM_THRESHOLD_MAX=6,a.GLOBE_ZOOM_THRESHOLD_MIN=5,a.GlobeSharedBuffers=class{constructor(u){this._createGrid(u),this._createPoles(u)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const u of this._poleSegments)u.destroy();for(const u of this._gridSegments)u.withSkirts.destroy(),u.withoutSkirts.destroy();if(this._wireframeIndexBuffer){this._wireframeIndexBuffer.destroy();for(const u of this._wireframeSegments)u.destroy()}}_fillGridMeshWithLods(u,l){const c=new _r,d=new Co,g=[],_=u+1+2,w=l[0]+1,C=l[0]+1+(1+l.length),R=(k,D,N)=>{let F=k===_-1?k-2:k===0?k:k-1;return F+=N?24575:0,[F,D]};for(let k=0;k<_;++k)c.emplaceBack(...R(k,0,!0));for(let k=0;k<w;++k)for(let D=0;D<_;++D)c.emplaceBack(...R(D,k,(D===0||D===_-1)&&!0));for(let k=0;k<l.length;++k){const D=l[k];for(let N=0;N<_;++N)c.emplaceBack(...R(N,D,!0))}for(let k=0;k<l.length;++k){const D=d.length,N=l[k]+1+2,F=new Co;for(let J=0;J<N-1;J++){const oe=J===N-2,ge=oe?_*(C-l.length+k-J):_;for(let Te=0;Te<_-1;Te++){const he=J*_+Te;J===0||oe||Te===0||Te===_-2?(F.emplaceBack(he+1,he,he+ge),F.emplaceBack(he+ge,he+ge+1,he+1)):(d.emplaceBack(he+1,he,he+ge),d.emplaceBack(he+ge,he+ge+1,he+1))}}const G=ki.simpleSegment(0,D,c.length,d.length-D);for(let J=0;J<F.uint16.length;J+=3)d.emplaceBack(F.uint16[J],F.uint16[J+1],F.uint16[J+2]);const Y=ki.simpleSegment(0,D,c.length,d.length-D);g.push({withoutSkirts:G,withSkirts:Y})}return{vertices:c,indices:d,segments:g}}_createGrid(u){const l=this._fillGridMeshWithLods($d,o0);this._gridSegments=l.segments,this._gridBuffer=u.createVertexBuffer(l.vertices,i0.members),this._gridIndexBuffer=u.createIndexBuffer(l.indices,!0)}_createPoles(u){const l=new Co;for(let g=0;g<=$d;g++)l.emplaceBack(0,g+1,g+2);this._poleIndexBuffer=u.createIndexBuffer(l,!0);const c=new ka,d=new ka;this._poleSegments=[];for(let g=0,_=0;g<5;g++){const w=360/(1<<g);c.emplaceBack(0,-Hl,0,.5,0),d.emplaceBack(0,-Hl,0,.5,1);for(let C=0;C<=$d;C++){const R=C/$d,k=gn(0,w,R),[D,N,F]=Eg(Gpe,Ype,k,Hl);c.emplaceBack(D,N,F,R,0),d.emplaceBack(D,N,F,R,1)}this._poleSegments.push(ki.simpleSegment(_,0,66,64)),_+=66}this._poleNorthVertexBuffer=u.createVertexBuffer(c,y5,!1),this._poleSouthVertexBuffer=u.createVertexBuffer(d,y5,!1)}getGridBuffers(u,l){return[this._gridBuffer,this._gridIndexBuffer,l?this._gridSegments[u].withSkirts:this._gridSegments[u].withoutSkirts]}getPoleBuffers(u){return[this._poleNorthVertexBuffer,this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[u]]}getWirefameBuffers(u,l){if(!this._wireframeSegments){const c=new Fl,d=$d,g=d+1+2,_=1;this._wireframeSegments=[];for(let w=0,C=0;w<o0.length;w++){const R=o0[w];for(let D=_;D<R+_;D++)for(let N=_;N<d+_;N++){const F=D*g+N;c.emplaceBack(F,F+1),c.emplaceBack(F,F+g),c.emplaceBack(F,F+g+1)}const k=R*d*3;this._wireframeSegments.push(ki.simpleSegment(0,C,(R+1)*g,k)),C+=k}this._wireframeIndexBuffer=u.createIndexBuffer(c)}return[this._gridBuffer,this._wireframeIndexBuffer,this._wireframeSegments[l]]}},a.GlyphManager=Bg,a.ImagePosition=N$,a.LivePerformanceUtils=kt,a.LngLat=bn,a.LngLatBounds=Af,a.LocalGlyphMode=F$,a.MAX_MERCATOR_LATITUDE=To,a.MercatorCoordinate=Rg,a.ONE_EM=Oo,a.OverscaledTileID=Ko,a.PerformanceMarkers=nt,a.Properties=Lt,a.RGBAImage=Aa,a.Ray=f$,a.RequestManager=class{constructor(u,l,c){this._transformRequestFn=u,this._customAccessToken=l,this._silenceAuthErrors=!!c,this._createSkuToken()}_createSkuToken(){const u=function(){let l="";for(let c=0;c<10;c++)l+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",z,l].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=u.token,this._skuTokenExpiresAt=u.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(u,l){return this._transformRequestFn&&this._transformRequestFn(u,l)||{url:u}}normalizeStyleURL(u,l){if(!Hr(u))return u;const c=zr(u);return c.path=`/styles/v1${c.path}`,this._makeAPIURL(c,this._customAccessToken||l)}normalizeGlyphsURL(u,l){if(!Hr(u))return u;const c=zr(u);return c.path=`/fonts/v1${c.path}`,this._makeAPIURL(c,this._customAccessToken||l)}normalizeSourceURL(u,l,c,d){if(!Hr(u))return u;const g=zr(u);return g.path=`/v4/${g.authority}.json`,g.params.push("secure"),c&&g.params.push(`language=${c}`),d&&g.params.push(`worldview=${d}`),this._makeAPIURL(g,this._customAccessToken||l)}normalizeSpriteURL(u,l,c,d){const g=zr(u);return Hr(u)?(g.path=`/styles/v1${g.path}/sprite${l}${c}`,this._makeAPIURL(g,this._customAccessToken||d)):(g.path+=`${l}${c}`,bo(g))}normalizeTileURL(u,l,c){if(this._isSkuTokenExpired()&&this._createSkuToken(),u&&!Hr(u))return u;const d=zr(u);d.path=d.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${l||c&&d.authority!=="raster"&&c===512?"@2x":""}${E.supported?".webp":"$1"}`),d.authority==="raster"?d.path=`/${S.RASTER_URL_PREFIX}${d.path}`:(d.path=d.path.replace(/^.+\/v4\//,"/"),d.path=`/${S.TILE_URL_VERSION}${d.path}`);const g=this._customAccessToken||function(_){for(const w of _){const C=w.match(/^access_token=(.*)$/);if(C)return C[1]}return null}(d.params)||S.ACCESS_TOKEN;return S.REQUIRE_ACCESS_TOKEN&&g&&this._skuToken&&d.params.push(`sku=${this._skuToken}`),this._makeAPIURL(d,g)}canonicalizeTileURL(u,l){const c=zr(u);if(!c.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!c.path.match(/\.[\w]+$/))return u;let d="mapbox://";c.path.match(/^\/raster\/v1\//)?d+=`raster/${c.path.replace(`/${S.RASTER_URL_PREFIX}/`,"")}`:d+=`tiles/${c.path.replace(`/${S.TILE_URL_VERSION}/`,"")}`;let g=c.params;return l&&(g=g.filter(_=>!_.match(/^access_token=/))),g.length&&(d+=`?${g.join("&")}`),d}canonicalizeTileset(u,l){const c=!!l&&Hr(l),d=[];for(const g of u.tiles||[])Fr(g)?d.push(this.canonicalizeTileURL(g,c)):d.push(g);return d}_makeAPIURL(u,l){const c="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",d=zr(S.API_URL);if(u.protocol=d.protocol,u.authority=d.authority,u.protocol==="http"){const g=u.params.indexOf("secure");g>=0&&u.params.splice(g,1)}if(d.path!=="/"&&(u.path=`${d.path}${u.path}`),!S.REQUIRE_ACCESS_TOKEN)return bo(u);if(l=l||S.ACCESS_TOKEN,!this._silenceAuthErrors){if(!l)throw new Error(`An API access token is required to use Mapbox GL. ${c}`);if(l[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${c}`)}return u.params=u.params.filter(g=>g.indexOf("access_token")===-1),u.params.push(`access_token=${l||""}`),bo(u)}},a.ResourceType=mt,a.SegmentVector=ki,a.SourceCache=Fd,a.StencilMode=X$,a.StructArrayLayout1ui2=zl,a.StructArrayLayout2f1f2i16=So,a.StructArrayLayout2i4=_r,a.StructArrayLayout2ui4=Fl,a.StructArrayLayout3f12=xo,a.StructArrayLayout3ui6=Co,a.StructArrayLayout4i8=kn,a.StructArrayLayout5f20=ka,a.Texture=T0,a.Tile=K$,a.Transitionable=zt,a.Uniform1f=LT,a.Uniform1i=class extends ju{constructor(u){super(u),this.current=0}set(u,l,c){this.fetchUniformLocation(u,l)&&this.current!==c&&(this.current=c,this.gl.uniform1i(this.location,c))}},a.Uniform2f=class extends ju{constructor(u){super(u),this.current=[0,0]}set(u,l,c){this.fetchUniformLocation(u,l)&&(c[0]===this.current[0]&&c[1]===this.current[1]||(this.current=c,this.gl.uniform2f(this.location,c[0],c[1])))}},a.Uniform3f=class extends ju{constructor(u){super(u),this.current=[0,0,0]}set(u,l,c){this.fetchUniformLocation(u,l)&&(c[0]===this.current[0]&&c[1]===this.current[1]&&c[2]===this.current[2]||(this.current=c,this.gl.uniform3f(this.location,c[0],c[1],c[2])))}},a.Uniform4f=t5,a.UniformColor=r5,a.UniformMatrix2f=class extends ju{constructor(u){super(u),this.current=Ape}set(u,l,c){if(this.fetchUniformLocation(u,l)){for(let d=0;d<4;d++)if(c[d]!==this.current[d]){this.current=c,this.gl.uniformMatrix2fv(this.location,!1,c);break}}}},a.UniformMatrix3f=class extends ju{constructor(u){super(u),this.current=Ppe}set(u,l,c){if(this.fetchUniformLocation(u,l)){for(let d=0;d<9;d++)if(c[d]!==this.current[d]){this.current=c,this.gl.uniformMatrix3fv(this.location,!1,c);break}}}},a.UniformMatrix4f=class extends ju{constructor(u){super(u),this.current=kpe}set(u,l,c){if(this.fetchUniformLocation(u,l)){if(c[12]!==this.current[12]||c[0]!==this.current[0])return this.current=c,void this.gl.uniformMatrix4fv(this.location,!1,c);for(let d=1;d<16;d++)if(c[d]!==this.current[d]){this.current=c,this.gl.uniformMatrix4fv(this.location,!1,c);break}}}},a.UnwrappedTileID=aG,a.ValidationError=tr,a.VectorTileFeature=JT,a.VectorTileWorkerSource=class extends Kn{constructor(u,l,c,d,g){super(),this.actor=u,this.layerIndex=l,this.availableImages=c,this.loadVectorData=g||h6,this.loading={},this.loaded={},this.deduped=new f6(u.scheduler),this.isSpriteLoaded=d,this.scheduler=u.scheduler}loadTile(u,l){const c=u.uid,d=u&&u.request,g=d&&d.collectResourceTiming,_=this.loading[c]=new Qge(u);_.abort=this.loadVectorData(u,(w,C)=>{const R=!this.loading[c];if(delete this.loading[c],R||w||!C)return _.status="done",R||(this.loaded[c]=_),l(w);const k=C.rawData,D={};C.expires&&(D.expires=C.expires),C.cacheControl&&(D.cacheControl=C.cacheControl),_.vectorTile=C.vectorTile||new M$(new _0(k));const N=()=>{_.parse(_.vectorTile,this.layerIndex,this.availableImages,this.actor,(F,G)=>{if(F||!G)return l(F);const Y={};if(g){const J=Sr(d);J.length>0&&(Y.resourceTiming=JSON.parse(JSON.stringify(J)))}l(null,U({rawTileData:k.slice(0)},G,D,Y))})};this.isSpriteLoaded?N():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(N,{type:"parseTile",isSymbolTile:u.isSymbolTile,zoom:u.tileZoom}):N()}),this.loaded=this.loaded||{},this.loaded[c]=_})}reloadTile(u,l){const c=this.loaded,d=u.uid,g=this;if(c&&c[d]){const _=c[d];_.showCollisionBoxes=u.showCollisionBoxes,_.enableTerrain=!!u.enableTerrain,_.projection=u.projection,_.tileTransform=jd(u.tileID.canonical,u.projection);const w=(C,R)=>{const k=_.reloadCallback;k&&(delete _.reloadCallback,_.parse(_.vectorTile,g.layerIndex,this.availableImages,g.actor,k)),l(C,R)};_.status==="parsing"?_.reloadCallback=w:_.status==="done"&&(_.vectorTile?_.parse(_.vectorTile,this.layerIndex,this.availableImages,this.actor,w):w())}}abortTile(u,l){const c=u.uid,d=this.loading[c];d&&(d.abort&&d.abort(),delete this.loading[c]),l()}removeTile(u,l){const c=this.loaded,d=u.uid;c&&c[d]&&delete c[d],l()}},a.WritingMode=Za,a.ZoomDependentExpression=Nu,a.add=zu,a.addDynamicAttributes=dO,a.adjoint=function(u,l){var c=l[0],d=l[1],g=l[2],_=l[3],w=l[4],C=l[5],R=l[6],k=l[7],D=l[8];return u[0]=w*D-C*k,u[1]=g*k-d*D,u[2]=d*C-g*w,u[3]=C*R-_*D,u[4]=c*D-g*R,u[5]=g*_-c*C,u[6]=_*k-w*R,u[7]=d*R-c*k,u[8]=c*w-d*_,u},a.asyncAll=ie,a.bezier=Qe,a.bindAll=Je,a.boundsAttributes=qG,a.bufferConvexPolygon=function(u,l){const c=[];for(let d=0;d<u.length;d++){const g=Ct(d-1,-1,u.length-1),_=Ct(d+1,-1,u.length-1),w=u[d],C=u[_],R=u[g].sub(w).unit(),k=C.sub(w).unit(),D=k.angleWithSep(R.x,R.y),N=R.add(k).unit().mult(-1*l/Math.sin(D/2));c.push(w.add(N))}return c},a.cacheEntryPossiblyAdded=function(u){et++,et>tt&&(u.getActor().send("enforceCacheSizeLimit",je),et=0)},a.calculateGlobeLabelMatrix=function(u,l){const{x:c,y:d}=u.point,g=x5(c,d,u.worldSize/u._pixelsPerMercatorPixel,0,0);return Ad(g,g,g$(Vl(l)))},a.calculateGlobeMatrix=function(u){const{x:l,y:c}=u.point,{lng:d,lat:g}=u._center;return x5(l,c,u.worldSize,d,g)},a.calculateGlobeMercatorMatrix=function(u){const l=u.pixelsPerMeter,c=l/sl(1,u.center.lat),d=ol(new Float64Array(16));return Jw(d,d,[u.point.x,u.point.y,0]),Id(d,d,[c,c,l]),Float32Array.from(d)},a.circumferenceAtLatitude=v$,a.clamp=Ce,a.clearTileCache=function(u){if(!Ue())return;const l=h.caches.delete(ye);u&&l.catch(u).then(()=>u())},a.clipLine=AG,a.clone=function(u){var l=new Pa(16);return l[0]=u[0],l[1]=u[1],l[2]=u[2],l[3]=u[3],l[4]=u[4],l[5]=u[5],l[6]=u[6],l[7]=u[7],l[8]=u[8],l[9]=u[9],l[10]=u[10],l[11]=u[11],l[12]=u[12],l[13]=u[13],l[14]=u[14],l[15]=u[15],l},a.clone$1=Tt,a.collisionCircleLayout=Zme,a.config=S,a.conjugate=function(u,l){return u[0]=-l[0],u[1]=-l[1],u[2]=-l[2],u[3]=l[3],u},a.create=function(){var u=new Pa(16);return Pa!=Float32Array&&(u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[11]=0,u[12]=0,u[13]=0,u[14]=0),u[0]=1,u[5]=1,u[10]=1,u[15]=1,u},a.create$1=i5,a.createExpression=wf,a.createLayout=hr,a.createStyleLayer=function(u){return u.type==="custom"?new Hge(u):new Uge[u.type](u)},a.cross=c$,a.degToRad=Le,a.distance=function(u,l){return Math.hypot(l[0]-u[0],l[1]-u[1],l[2]-u[2])},a.div=function(u,l,c){return u[0]=l[0]/c[0],u[1]=l[1]/c[1],u[2]=l[2]/c[2],u},a.dot=Cs,a.earthRadius=l0,a.ease=de,a.easeCubicInOut=At,a.ecefToLatLng=function([u,l,c]){const d=Math.hypot(u,l,c),g=Math.atan2(u,c),_=.5*Math.PI-Math.acos(-l/d);return new bn(ze(g),ze(_))},a.emitValidationErrors=wT,a.endsWith=ht,a.enforceCacheSizeLimit=function(u){Ve(),Ee&&Ee.then(l=>{l.keys().then(c=>{for(let d=0;d<c.length-u;d++)l.delete(c[d])})})},a.evaluateSizeForFeature=rO,a.evaluateSizeForZoom=$g,a.evaluateVariableOffset=LG,a.evented=be,a.exactEquals=function(u,l){return u[0]===l[0]&&u[1]===l[1]&&u[2]===l[2]&&u[3]===l[3]},a.exactEquals$1=function(u,l){return u[0]===l[0]&&u[1]===l[1]&&u[2]===l[2]},a.exported=mr,a.exported$1=E,a.extend=U,a.extend$1=Ta,a.fillExtrusionHeightLift=nG,a.filterObject=St,a.fromMat4=function(u,l){return u[0]=l[0],u[1]=l[1],u[2]=l[2],u[3]=l[4],u[4]=l[5],u[5]=l[6],u[6]=l[8],u[7]=l[9],u[8]=l[10],u},a.fromQuat=function(u,l){var c=l[0],d=l[1],g=l[2],_=l[3],w=c+c,C=d+d,R=g+g,k=c*w,D=d*w,N=d*C,F=g*w,G=g*C,Y=g*R,J=_*w,oe=_*C,ge=_*R;return u[0]=1-N-Y,u[1]=D+ge,u[2]=F-oe,u[3]=0,u[4]=D-ge,u[5]=1-k-Y,u[6]=G+J,u[7]=0,u[8]=F+oe,u[9]=G-J,u[10]=1-k-N,u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1,u},a.fromRotation=function(u,l){var c=Math.sin(l),d=Math.cos(l);return u[0]=d,u[1]=c,u[2]=0,u[3]=-c,u[4]=d,u[5]=0,u[6]=0,u[7]=0,u[8]=1,u},a.fromScaling=a5,a.furthestTileCorner=function(u){const l=Math.round((u+45+360)%360/90)%4;return ct[l]},a.getAABBPointSquareDist=function(u,l,c){let d=0;for(let g=0;g<2;++g){const _=c?c[g]:0;u[g]>_&&(d+=(u[g]-_)*(u[g]-_)),l[g]<_&&(d+=(_-l[g])*(_-l[g]))}return d},a.getAnchorAlignment=j$,a.getAnchorJustification=H$,a.getBounds=function(u){let l=1/0,c=1/0,d=-1/0,g=-1/0;for(const _ of u)l=Math.min(l,_.x),c=Math.min(c,_.y),d=Math.max(d,_.x),g=Math.max(g,_.y);return{min:new q(l,c),max:new q(d,g)}},a.getColumn=se,a.getGridMatrix=function(u,l,c,d){const g=l.getNorth(),_=l.getSouth(),w=l.getWest(),C=l.getEast(),R=1<<u.z,k=C-w,D=g-_,N=k/$d,F=-D/o0[c],G=[0,N,0,F,0,0,g,w,0];if(u.z>0){const Y=180/d;o5(G,G,[Y/k+1,0,0,0,Y/D+1,0,-.5*Y/N,.5*Y/F,1])}return G[2]=R,G[5]=u.x,G[8]=u.y,G},a.getImage=ln,a.getJSON=function(u,l){return fr(U(u,{type:"json"}),l)},a.getLatitudinalLod=function(u){const l=To-5;u=Ce(u,-l,l)/l*90;const c=Math.pow(Math.abs(Math.sin(Le(u))),3);return Math.round(c*(o0.length-1))},a.getMapSessionAPI=Ge,a.getPerformanceMeasurement=Sr,a.getProjection=UG,a.getRTLTextPluginStatus=$e,a.getReferrer=or,a.getTilePoint=function(u,{x:l,y:c},d=0){return new q(((l-d)*u.scale-u.x)*Pr,(c*u.scale-u.y)*Pr)},a.getTileVec3=function(u,l,c=0){return Cg(((l.x-c)*u.scale-u.x)*Pr,(l.y*u.scale-u.y)*Pr,O5(l.z,l.y))},a.getVideo=function(u,l){const c=h.document.createElement("video");c.muted=!0,c.onloadstart=function(){l(null,c)};for(let d=0;d<u.length;d++){const g=h.document.createElement("source");Ur(u[d])||(c.crossOrigin="Anonymous"),g.src=u[d],c.appendChild(g)}return{cancel:()=>{}}},a.globeCenterToScreenPoint=function(u){const l=[0,0,0],c=ol(new Float64Array(16));return Ad(c,u.pixelMatrix,u.globeMatrix),Ci(l,l,c),new q(l[0],l[1])},a.globeDenormalizeECEF=g$,a.globeECEFOrigin=function(u,l){const c=[0,0,0];return Ci(c,c,s0(Vl(l.canonical))),Ci(c,c,u),c},a.globeMetersToEcef=FT,a.globeNormalizeECEF=s0,a.globePixelsToTileUnits=function(u,l){return Pr/(512*Math.pow(2,u))*HT(Vl(l))},a.globePoleMatrixForTile=function(u,l,c){const d=ol(new Float64Array(16)),g=(l/(1<<u)-.5)*Math.PI*2;return jT(d,c.globeMatrix,g),Float32Array.from(d)},a.globeTileBounds=Vl,a.globeTiltAtLngLat=C5,a.globeToMercatorTransition=Og,a.globeUseCustomAntiAliasing=function(u,l,c){const d=Og(c.zoom),g=u.style.map._antialias,_=!!l.extStandardDerivatives,w=l.extStandardDerivativesForceOff||u.terrain&&u.terrain.exaggeration()>0;return d===0&&!g&&!w&&_},a.identity=ol,a.identity$1=p5,a.invert=a$,a.isFullscreen=function(){return!!h.document.fullscreenElement||!!h.document.webkitFullscreenElement},a.isLngLatBehindGlobe=y$,a.isMapAuthenticated=function(u){return Ne.has(u)},a.isMapboxURL=Hr,a.isSafariWithAntialiasingBug=function(u){const l=u.navigator?u.navigator.userAgent:null;return!!vr(u)&&l&&(l.match("Version/15.4")||l.match("Version/15.5")||l.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},a.latFromMercatorY=Eo,a.latLngToECEF=Tg,a.len=Fpe,a.length=Qw,a.length$1=function(u){return Math.hypot(u[0],u[1],u[2],u[3])},a.lngFromMercatorX=Xa,a.loadVectorTile=h6,a.makeRequest=fr,a.mapValue=function(u,l,c,d,g){return Ce((u-l)/(c-l)*(g-d)+d,d,g)},a.mercatorScale=R5,a.mercatorXfromLng=Ul,a.mercatorYfromLat=Wl,a.mercatorZfromAltitude=sl,a.mul=Bpe,a.mul$1=jpe,a.multiply=Ad,a.multiply$1=o5,a.multiply$2=u5,a.nextPowerOfTwo=Oe,a.normalize=Go,a.normalize$1=zpe,a.normalize$2=h5,a.number=gn,a.ortho=function(u,l,c,d,g,_,w){var C=1/(l-c),R=1/(d-g),k=1/(_-w);return u[0]=-2*C,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=-2*R,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=2*k,u[11]=0,u[12]=(l+c)*C,u[13]=(g+d)*R,u[14]=(w+_)*k,u[15]=1,u},a.pbf=_0,a.perspective=function(u,l,c,d,g){var _,w=1/Math.tan(l/2);return u[0]=w/c,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=w,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[11]=-1,u[12]=0,u[13]=0,u[15]=0,g!=null&&g!==1/0?(u[10]=(g+d)*(_=1/(d-g)),u[14]=2*g*d*_):(u[10]=-1,u[14]=-2*d),u},a.pick=function(u,l){const c={};for(let d=0;d<l.length;d++){const g=l[d];g in u&&(c[g]=u[g])}return c},a.plugin=Be,a.pointGeometry=q,a.polesInViewport=function(u){const l=ol(new Float64Array(16));Ad(l,u.pixelMatrix,u.globeMatrix);const c=[0,Es,0],d=[0,Ts,0];return Ci(c,c,l),Ci(d,d,l),[c[0]>0&&c[0]<=u.width&&c[1]>0&&c[1]<=u.height&&!y$(u,new bn(u.center.lat,90)),d[0]>0&&d[0]<=u.width&&d[1]>0&&d[1]<=u.height&&!y$(u,new bn(u.center.lat,-90))]},a.polygonContainsPoint=Nd,a.polygonIntersectsBox=D5,a.polygonIntersectsPolygon=A5,a.polygonizeBounds=function(u,l,c=0,d=!0){const g=new q(c,c),_=u.sub(g),w=l.add(g),C=[_,new q(w.x,_.y),w,new q(_.x,w.y)];return d&&C.push(_.clone()),C},a.posAttributes=i0,a.postMapLoadEvent=fe,a.postPerformanceEvent=De,a.postTurnstileEvent=Z,a.potpack=L$,a.prevPowerOfTwo=function(u){return u<=1?1:Math.pow(2,Math.floor(Math.log(u)/Math.LN2))},a.radToDeg=ze,a.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],a.registerForPluginStateChange=function(u){return u({pluginStatus:ce,pluginURL:te}),be.on("pluginStateChange",u),u},a.removeAuthState=function(u){Ne.delete(u)},a.renderColorRamp=T$,a.resample=k5,a.rotateX=s$,a.rotateX$1=m5,a.rotateY=jT,a.rotateY$1=g5,a.rotateZ=function(u,l,c){var d=Math.sin(c),g=Math.cos(c),_=l[0],w=l[1],C=l[2],R=l[3],k=l[4],D=l[5],N=l[6],F=l[7];return l!==u&&(u[8]=l[8],u[9]=l[9],u[10]=l[10],u[11]=l[11],u[12]=l[12],u[13]=l[13],u[14]=l[14],u[15]=l[15]),u[0]=_*g+k*d,u[1]=w*g+D*d,u[2]=C*g+N*d,u[3]=R*g+F*d,u[4]=k*g-_*d,u[5]=D*g-w*d,u[6]=N*g-C*d,u[7]=F*g-R*d,u},a.rotateZ$1=function(u,l,c){c*=.5;var d=l[0],g=l[1],_=l[2],w=l[3],C=Math.sin(c),R=Math.cos(c);return u[0]=d*R+g*C,u[1]=g*R-d*C,u[2]=_*R+w*C,u[3]=w*R-_*C,u},a.scale=Id,a.scale$1=f5,a.scale$2=qa,a.scaleAndAdd=r0,a.set=function(u,l,c,d){return u[0]=l,u[1]=c,u[2]=d,u},a.setCacheLimits=function(u,l){je=u,tt=l},a.setColumn=function(u,l,c){u[4*l+0]=c[0],u[4*l+1]=c[1],u[4*l+2]=c[2],u[4*l+3]=c[3]},a.setRTLTextPlugin=function(u,l,c=!1){if(ce===ne||ce===ae||ce===le)throw new Error("setRTLTextPlugin cannot be called multiple times.");te=mr.resolveURL(u),ce=ne,ue=l,ve(),c||Ae()},a.smoothstep=pt,a.spec=wt,a.squaredLength=function(u){var l=u[0],c=u[1],d=u[2];return l*l+c*c+d*d},a.storeAuthState=function(u,l){l?Ne.add(u):Ne.delete(u)},a.sub=al,a.subtract=u$,a.symbolSize=Jme,a.tileAABB=function(u,l,c,d,g,_,w,C,R){if(R.name==="globe")return Wpe(u,l,new eO(c,d,g));const k=jd({z:c,x:d,y:g},R);return new Yo([(_+k.x/k.scale)*l,l*(k.y/k.scale),w],[(_+k.x2/k.scale)*l,l*(k.y2/k.scale),C])},a.tileCornersToBounds=zT,a.tileTransform=jd,a.transformMat3=function(u,l,c){var d=l[0],g=l[1],_=l[2];return u[0]=d*c[0]+g*c[3]+_*c[6],u[1]=d*c[1]+g*c[4]+_*c[7],u[2]=d*c[2]+g*c[5]+_*c[8],u},a.transformMat4=Ci,a.transformMat4$1=Md,a.transformQuat=c5,a.transitionTileAABBinECEF=b5,a.translate=Jw,a.transpose=function(u,l){if(u===l){var c=l[1],d=l[2],g=l[5];u[1]=l[3],u[2]=l[6],u[3]=c,u[5]=l[7],u[6]=d,u[7]=g}else u[0]=l[0],u[1]=l[3],u[2]=l[6],u[3]=l[1],u[4]=l[4],u[5]=l[7],u[6]=l[2],u[7]=l[5],u[8]=l[8];return u},a.triggerPluginCompletionEvent=_e,a.uniqueId=re,a.updateGlobeVertexNormal=function(u,l,c,d,g){const _=5*l+2;u.float32[_+0]=c,u.float32[_+1]=d,u.float32[_+2]=g},a.validateCustomStyleLayer=function(u){const l=[],c=u.id;return c===void 0&&l.push({message:`layers.${c}: missing required property "id"`}),u.render===void 0&&l.push({message:`layers.${c}: missing required method "render"`}),u.renderingMode&&u.renderingMode!=="2d"&&u.renderingMode!=="3d"&&l.push({message:`layers.${c}: property "renderingMode" must be either "2d" or "3d"`}),l},a.validateFilter=u=>el(Hw(u)),a.validateFog=u=>el(vT(u)),a.validateLayer=u=>el(Uw(u)),a.validateLight=u=>el(yT(u)),a.validateSource=u=>el(Sd(u)),a.validateStyle=_T,a.validateTerrain=u=>el(Ww(u)),a.values=M,a.vectorTile=ZT,a.version=p,a.warnOnce=jt,a.window=h,a.wrap=Ct}),o(["./shared"],function(a){function h(pe){if(typeof pe=="number"||typeof pe=="boolean"||typeof pe=="string"||pe==null)return JSON.stringify(pe);if(Array.isArray(pe)){let ee="[";for(const fe of pe)ee+=`${h(fe)},`;return`${ee}]`}let Z="{";for(const ee of Object.keys(pe).sort())Z+=`${ee}:${h(pe[ee])},`;return`${Z}}`}function p(pe){let Z="";for(const ee of a.refProperties)Z+=`/${h(pe[ee])}`;return Z}class y{constructor(Z){this.keyCache={},Z&&this.replace(Z)}replace(Z){this._layerConfigs={},this._layers={},this.update(Z,[])}update(Z,ee){for(const we of Z)this._layerConfigs[we.id]=we,(this._layers[we.id]=a.createStyleLayer(we)).compileFilter(),this.keyCache[we.id]&&delete this.keyCache[we.id];for(const we of ee)delete this.keyCache[we],delete this._layerConfigs[we],delete this._layers[we];this.familiesBySource={};const fe=function(we,De){const Xe={};for(let Ne=0;Ne<we.length;Ne++){const nt=De&&De[we[Ne].id]||p(we[Ne]);De&&(De[we[Ne].id]=nt);let kt=Xe[nt];kt||(kt=Xe[nt]=[]),kt.push(we[Ne])}const Ge=[];for(const Ne in Xe)Ge.push(Xe[Ne]);return Ge}(a.values(this._layerConfigs),this.keyCache);for(const we of fe){const De=we.map(Qt=>this._layers[Qt.id]),Xe=De[0];if(Xe.visibility==="none")continue;const Ge=Xe.source||"";let Ne=this.familiesBySource[Ge];Ne||(Ne=this.familiesBySource[Ge]={});const nt=Xe.sourceLayer||"_geojsonTileLayer";let kt=Ne[nt];kt||(kt=Ne[nt]=[]),kt.push(De)}}}class S{loadTile(Z,ee){const{uid:fe,encoding:we,rawImageData:De,padding:Xe,buildQuadTree:Ge}=Z,Ne=a.window.ImageBitmap&&De instanceof a.window.ImageBitmap?this.getImageData(De,Xe):De;ee(null,new a.DEMData(fe,Ne,we,Xe<1,Ge))}getImageData(Z,ee){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(Z.width,Z.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=Z.width,this.offscreenCanvas.height=Z.height,this.offscreenCanvasContext.drawImage(Z,0,0,Z.width,Z.height);const fe=this.offscreenCanvasContext.getImageData(-ee,-ee,Z.width+2*ee,Z.height+2*ee);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),fe}}var E=function pe(Z,ee){var fe,we=Z&&Z.type;if(we==="FeatureCollection")for(fe=0;fe<Z.features.length;fe++)pe(Z.features[fe],ee);else if(we==="GeometryCollection")for(fe=0;fe<Z.geometries.length;fe++)pe(Z.geometries[fe],ee);else if(we==="Feature")pe(Z.geometry,ee);else if(we==="Polygon")O(Z.coordinates,ee);else if(we==="MultiPolygon")for(fe=0;fe<Z.coordinates.length;fe++)O(Z.coordinates[fe],ee);return Z};function O(pe,Z){if(pe.length!==0){A(pe[0],Z);for(var ee=1;ee<pe.length;ee++)A(pe[ee],!Z)}}function A(pe,Z){for(var ee=0,fe=0,we=0,De=pe.length,Xe=De-1;we<De;Xe=we++){var Ge=(pe[we][0]-pe[Xe][0])*(pe[Xe][1]+pe[we][1]),Ne=ee+Ge;fe+=Math.abs(ee)>=Math.abs(Ge)?ee-Ne+Ge:Ge-Ne+ee,ee=Ne}ee+fe>=0!=!!Z&&pe.reverse()}const $=a.VectorTileFeature.prototype.toGeoJSON;class B{constructor(Z){this._feature=Z,this.extent=a.EXTENT,this.type=Z.type,this.properties=Z.tags,"id"in Z&&!isNaN(Z.id)&&(this.id=parseInt(Z.id,10))}loadGeometry(){if(this._feature.type===1){const Z=[];for(const ee of this._feature.geometry)Z.push([new a.pointGeometry(ee[0],ee[1])]);return Z}{const Z=[];for(const ee of this._feature.geometry){const fe=[];for(const we of ee)fe.push(new a.pointGeometry(we[0],we[1]));Z.push(fe)}return Z}}toGeoJSON(Z,ee,fe){return $.call(this,Z,ee,fe)}}class j{constructor(Z){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=a.EXTENT,this.length=Z.length,this._features=Z}feature(Z){return new B(this._features[Z])}}var z={},W={get exports(){return z},set exports(pe){z=pe}},Q=a.pointGeometry,q=a.vectorTile.VectorTileFeature,Se=Ie;function Ie(pe,Z){this.options=Z||{},this.features=pe,this.length=pe.length}function He(pe,Z){this.id=typeof pe.id=="number"?pe.id:void 0,this.type=pe.type,this.rawGeometry=pe.type===1?[pe.geometry]:pe.geometry,this.properties=pe.tags,this.extent=Z||4096}Ie.prototype.feature=function(pe){return new He(this.features[pe],this.options.extent)},He.prototype.loadGeometry=function(){var pe=this.rawGeometry;this.geometry=[];for(var Z=0;Z<pe.length;Z++){for(var ee=pe[Z],fe=[],we=0;we<ee.length;we++)fe.push(new Q(ee[we][0],ee[we][1]));this.geometry.push(fe)}return this.geometry},He.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var pe=this.geometry,Z=1/0,ee=-1/0,fe=1/0,we=-1/0,De=0;De<pe.length;De++)for(var Xe=pe[De],Ge=0;Ge<Xe.length;Ge++){var Ne=Xe[Ge];Z=Math.min(Z,Ne.x),ee=Math.max(ee,Ne.x),fe=Math.min(fe,Ne.y),we=Math.max(we,Ne.y)}return[Z,fe,ee,we]},He.prototype.toGeoJSON=q.prototype.toGeoJSON;var Le=a.pbf,ze=Se;function ct(pe){var Z=new Le;return function(ee,fe){for(var we in ee.layers)fe.writeMessage(3,At,ee.layers[we])}(pe,Z),Z.finish()}function At(pe,Z){var ee;Z.writeVarintField(15,pe.version||1),Z.writeStringField(1,pe.name||""),Z.writeVarintField(5,pe.extent||4096);var fe={keys:[],values:[],keycache:{},valuecache:{}};for(ee=0;ee<pe.length;ee++)fe.feature=pe.feature(ee),Z.writeMessage(2,Qe,fe);var we=fe.keys;for(ee=0;ee<we.length;ee++)Z.writeStringField(3,we[ee]);var De=fe.values;for(ee=0;ee<De.length;ee++)Z.writeMessage(4,ie,De[ee])}function Qe(pe,Z){var ee=pe.feature;ee.id!==void 0&&Z.writeVarintField(1,ee.id),Z.writeMessage(2,de,pe),Z.writeVarintField(3,ee.type),Z.writeMessage(4,Ct,ee)}function de(pe,Z){var ee=pe.feature,fe=pe.keys,we=pe.values,De=pe.keycache,Xe=pe.valuecache;for(var Ge in ee.properties){var Ne=ee.properties[Ge],nt=De[Ge];if(Ne!==null){nt===void 0&&(fe.push(Ge),De[Ge]=nt=fe.length-1),Z.writeVarint(nt);var kt=typeof Ne;kt!=="string"&&kt!=="boolean"&&kt!=="number"&&(Ne=JSON.stringify(Ne));var Qt=kt+":"+Ne,Nt=Xe[Qt];Nt===void 0&&(we.push(Ne),Xe[Qt]=Nt=we.length-1),Z.writeVarint(Nt)}}}function Ce(pe,Z){return(Z<<3)+(7&pe)}function pt(pe){return pe<<1^pe>>31}function Ct(pe,Z){for(var ee=pe.loadGeometry(),fe=pe.type,we=0,De=0,Xe=ee.length,Ge=0;Ge<Xe;Ge++){var Ne=ee[Ge],nt=1;fe===1&&(nt=Ne.length),Z.writeVarint(Ce(1,nt));for(var kt=fe===3?Ne.length-1:Ne.length,Qt=0;Qt<kt;Qt++){Qt===1&&fe!==1&&Z.writeVarint(Ce(2,kt-1));var Nt=Ne[Qt].x-we,Sr=Ne[Qt].y-De;Z.writeVarint(pt(Nt)),Z.writeVarint(pt(Sr)),we+=Nt,De+=Sr}fe===3&&Z.writeVarint(Ce(7,1))}}function ie(pe,Z){var ee=typeof pe;ee==="string"?Z.writeStringField(1,pe):ee==="boolean"?Z.writeBooleanField(7,pe):ee==="number"&&(pe%1!=0?Z.writeDoubleField(3,pe):pe<0?Z.writeSVarintField(6,pe):Z.writeVarintField(5,pe))}function M(pe,Z,ee,fe,we,De){if(we-fe<=ee)return;const Xe=fe+we>>1;U(pe,Z,Xe,fe,we,De%2),M(pe,Z,ee,fe,Xe-1,De+1),M(pe,Z,ee,Xe+1,we,De+1)}function U(pe,Z,ee,fe,we,De){for(;we>fe;){if(we-fe>600){const nt=we-fe+1,kt=ee-fe+1,Qt=Math.log(nt),Nt=.5*Math.exp(2*Qt/3),Sr=.5*Math.sqrt(Qt*Nt*(nt-Nt)/nt)*(kt-nt/2<0?-1:1);U(pe,Z,ee,Math.max(fe,Math.floor(ee-kt*Nt/nt+Sr)),Math.min(we,Math.floor(ee+(nt-kt)*Nt/nt+Sr)),De)}const Xe=Z[2*ee+De];let Ge=fe,Ne=we;for(K(pe,Z,fe,ee),Z[2*we+De]>Xe&&K(pe,Z,fe,we);Ge<Ne;){for(K(pe,Z,Ge,Ne),Ge++,Ne--;Z[2*Ge+De]<Xe;)Ge++;for(;Z[2*Ne+De]>Xe;)Ne--}Z[2*fe+De]===Xe?K(pe,Z,fe,Ne):(Ne++,K(pe,Z,Ne,we)),Ne<=ee&&(fe=Ne+1),ee<=Ne&&(we=Ne-1)}}function K(pe,Z,ee,fe){re(pe,ee,fe),re(Z,2*ee,2*fe),re(Z,2*ee+1,2*fe+1)}function re(pe,Z,ee){const fe=pe[Z];pe[Z]=pe[ee],pe[ee]=fe}function me(pe,Z,ee,fe){const we=pe-ee,De=Z-fe;return we*we+De*De}W.exports=ct,z.fromVectorTileJs=ct,z.fromGeojsonVt=function(pe,Z){Z=Z||{};var ee={};for(var fe in pe)ee[fe]=new ze(pe[fe].features,Z),ee[fe].name=fe,ee[fe].version=Z.version,ee[fe].extent=Z.extent;return ct({layers:ee})},z.GeoJSONWrapper=ze;const Oe=pe=>pe[0],We=pe=>pe[1];class Je{constructor(Z,ee=Oe,fe=We,we=64,De=Float64Array){this.nodeSize=we,this.points=Z;const Xe=Z.length<65536?Uint16Array:Uint32Array,Ge=this.ids=new Xe(Z.length),Ne=this.coords=new De(2*Z.length);for(let nt=0;nt<Z.length;nt++)Ge[nt]=nt,Ne[2*nt]=ee(Z[nt]),Ne[2*nt+1]=fe(Z[nt]);M(Ge,Ne,we,0,Ge.length-1,0)}range(Z,ee,fe,we){return function(De,Xe,Ge,Ne,nt,kt,Qt){const Nt=[0,De.length-1,0],Sr=[];let It,Re;for(;Nt.length;){const bt=Nt.pop(),Dt=Nt.pop(),mr=Nt.pop();if(Dt-mr<=Qt){for(let Nr=mr;Nr<=Dt;Nr++)It=Xe[2*Nr],Re=Xe[2*Nr+1],It>=Ge&&It<=nt&&Re>=Ne&&Re<=kt&&Sr.push(De[Nr]);continue}const sr=Math.floor((mr+Dt)/2);It=Xe[2*sr],Re=Xe[2*sr+1],It>=Ge&&It<=nt&&Re>=Ne&&Re<=kt&&Sr.push(De[sr]);const Br=(bt+1)%2;(bt===0?Ge<=It:Ne<=Re)&&(Nt.push(mr),Nt.push(sr-1),Nt.push(Br)),(bt===0?nt>=It:kt>=Re)&&(Nt.push(sr+1),Nt.push(Dt),Nt.push(Br))}return Sr}(this.ids,this.coords,Z,ee,fe,we,this.nodeSize)}within(Z,ee,fe){return function(we,De,Xe,Ge,Ne,nt){const kt=[0,we.length-1,0],Qt=[],Nt=Ne*Ne;for(;kt.length;){const Sr=kt.pop(),It=kt.pop(),Re=kt.pop();if(It-Re<=nt){for(let Br=Re;Br<=It;Br++)me(De[2*Br],De[2*Br+1],Xe,Ge)<=Nt&&Qt.push(we[Br]);continue}const bt=Math.floor((Re+It)/2),Dt=De[2*bt],mr=De[2*bt+1];me(Dt,mr,Xe,Ge)<=Nt&&Qt.push(we[bt]);const sr=(Sr+1)%2;(Sr===0?Xe-Ne<=Dt:Ge-Ne<=mr)&&(kt.push(Re),kt.push(bt-1),kt.push(sr)),(Sr===0?Xe+Ne>=Dt:Ge+Ne>=mr)&&(kt.push(bt+1),kt.push(It),kt.push(sr))}return Qt}(this.ids,this.coords,Z,ee,fe,this.nodeSize)}}const ht={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:pe=>pe},ft=Math.fround||(St=new Float32Array(1),pe=>(St[0]=+pe,St[0]));var St;class Tt{constructor(Z){this.options=vr(Object.create(ht),Z),this.trees=new Array(this.options.maxZoom+1)}load(Z){const{log:ee,minZoom:fe,maxZoom:we,nodeSize:De}=this.options;ee&&console.time("total time");const Xe=`prepare ${Z.length} points`;ee&&console.time(Xe),this.points=Z;let Ge=[];for(let Ne=0;Ne<Z.length;Ne++)Z[Ne].geometry&&Ge.push(jt(Z[Ne],Ne));this.trees[we+1]=new Je(Ge,Cr,se,De,Float32Array),ee&&console.timeEnd(Xe);for(let Ne=we;Ne>=fe;Ne--){const nt=+Date.now();Ge=this._cluster(Ge,Ne),this.trees[Ne]=new Je(Ge,Cr,se,De,Float32Array),ee&&console.log("z%d: %d clusters in %dms",Ne,Ge.length,+Date.now()-nt)}return ee&&console.timeEnd("total time"),this}getClusters(Z,ee){let fe=((Z[0]+180)%360+360)%360-180;const we=Math.max(-90,Math.min(90,Z[1]));let De=Z[2]===180?180:((Z[2]+180)%360+360)%360-180;const Xe=Math.max(-90,Math.min(90,Z[3]));if(Z[2]-Z[0]>=360)fe=-180,De=180;else if(fe>De){const kt=this.getClusters([fe,we,180,Xe],ee),Qt=this.getClusters([-180,we,De,Xe],ee);return kt.concat(Qt)}const Ge=this.trees[this._limitZoom(ee)],Ne=Ge.range(yr(fe),Ar(Xe),yr(De),Ar(we)),nt=[];for(const kt of Ne){const Qt=Ge.points[kt];nt.push(Qt.numPoints?Kt(Qt):this.points[Qt.index])}return nt}getChildren(Z){const ee=this._getOriginId(Z),fe=this._getOriginZoom(Z),we="No cluster with the specified id.",De=this.trees[fe];if(!De)throw new Error(we);const Xe=De.points[ee];if(!Xe)throw new Error(we);const Ge=this.options.radius/(this.options.extent*Math.pow(2,fe-1)),Ne=De.within(Xe.x,Xe.y,Ge),nt=[];for(const kt of Ne){const Qt=De.points[kt];Qt.parentId===Z&&nt.push(Qt.numPoints?Kt(Qt):this.points[Qt.index])}if(nt.length===0)throw new Error(we);return nt}getLeaves(Z,ee,fe){const we=[];return this._appendLeaves(we,Z,ee=ee||10,fe=fe||0,0),we}getTile(Z,ee,fe){const we=this.trees[this._limitZoom(Z)],De=Math.pow(2,Z),{extent:Xe,radius:Ge}=this.options,Ne=Ge/Xe,nt=(fe-Ne)/De,kt=(fe+1+Ne)/De,Qt={features:[]};return this._addTileFeatures(we.range((ee-Ne)/De,nt,(ee+1+Ne)/De,kt),we.points,ee,fe,De,Qt),ee===0&&this._addTileFeatures(we.range(1-Ne/De,nt,1,kt),we.points,De,fe,De,Qt),ee===De-1&&this._addTileFeatures(we.range(0,nt,Ne/De,kt),we.points,-1,fe,De,Qt),Qt.features.length?Qt:null}getClusterExpansionZoom(Z){let ee=this._getOriginZoom(Z)-1;for(;ee<=this.options.maxZoom;){const fe=this.getChildren(Z);if(ee++,fe.length!==1)break;Z=fe[0].properties.cluster_id}return ee}_appendLeaves(Z,ee,fe,we,De){const Xe=this.getChildren(ee);for(const Ge of Xe){const Ne=Ge.properties;if(Ne&&Ne.cluster?De+Ne.point_count<=we?De+=Ne.point_count:De=this._appendLeaves(Z,Ne.cluster_id,fe,we,De):De<we?De++:Z.push(Ge),Z.length===fe)break}return De}_addTileFeatures(Z,ee,fe,we,De,Xe){for(const Ge of Z){const Ne=ee[Ge],nt=Ne.numPoints;let kt,Qt,Nt;if(nt)kt=qe(Ne),Qt=Ne.x,Nt=Ne.y;else{const Re=this.points[Ne.index];kt=Re.properties,Qt=yr(Re.geometry.coordinates[0]),Nt=Ar(Re.geometry.coordinates[1])}const Sr={type:1,geometry:[[Math.round(this.options.extent*(Qt*De-fe)),Math.round(this.options.extent*(Nt*De-we))]],tags:kt};let It;nt?It=Ne.id:this.options.generateId?It=Ne.index:this.points[Ne.index].id&&(It=this.points[Ne.index].id),It!==void 0&&(Sr.id=It),Xe.features.push(Sr)}}_limitZoom(Z){return Math.max(this.options.minZoom,Math.min(Math.floor(+Z),this.options.maxZoom+1))}_cluster(Z,ee){const fe=[],{radius:we,extent:De,reduce:Xe,minPoints:Ge}=this.options,Ne=we/(De*Math.pow(2,ee));for(let nt=0;nt<Z.length;nt++){const kt=Z[nt];if(kt.zoom<=ee)continue;kt.zoom=ee;const Qt=this.trees[ee+1],Nt=Qt.within(kt.x,kt.y,Ne),Sr=kt.numPoints||1;let It=Sr;for(const Re of Nt){const bt=Qt.points[Re];bt.zoom>ee&&(It+=bt.numPoints||1)}if(It>Sr&&It>=Ge){let Re=kt.x*Sr,bt=kt.y*Sr,Dt=Xe&&Sr>1?this._map(kt,!0):null;const mr=(nt<<5)+(ee+1)+this.points.length;for(const sr of Nt){const Br=Qt.points[sr];if(Br.zoom<=ee)continue;Br.zoom=ee;const Nr=Br.numPoints||1;Re+=Br.x*Nr,bt+=Br.y*Nr,Br.parentId=mr,Xe&&(Dt||(Dt=this._map(kt,!0)),Xe(Dt,this._map(Br)))}kt.parentId=mr,fe.push(Xt(Re/It,bt/It,mr,It,Dt))}else if(fe.push(kt),It>1)for(const Re of Nt){const bt=Qt.points[Re];bt.zoom<=ee||(bt.zoom=ee,fe.push(bt))}}return fe}_getOriginId(Z){return Z-this.points.length>>5}_getOriginZoom(Z){return(Z-this.points.length)%32}_map(Z,ee){if(Z.numPoints)return ee?vr({},Z.properties):Z.properties;const fe=this.points[Z.index].properties,we=this.options.map(fe);return ee&&we===fe?vr({},we):we}}function Xt(pe,Z,ee,fe,we){return{x:ft(pe),y:ft(Z),zoom:1/0,id:ee,parentId:-1,numPoints:fe,properties:we}}function jt(pe,Z){const[ee,fe]=pe.geometry.coordinates;return{x:ft(yr(ee)),y:ft(Ar(fe)),zoom:1/0,index:Z,parentId:-1}}function Kt(pe){return{type:"Feature",id:pe.id,properties:qe(pe),geometry:{type:"Point",coordinates:[(Z=pe.x,360*(Z-.5)),wr(pe.y)]}};var Z}function qe(pe){const Z=pe.numPoints,ee=Z>=1e4?`${Math.round(Z/1e3)}k`:Z>=1e3?Math.round(Z/100)/10+"k":Z;return vr(vr({},pe.properties),{cluster:!0,cluster_id:pe.id,point_count:Z,point_count_abbreviated:ee})}function yr(pe){return pe/360+.5}function Ar(pe){const Z=Math.sin(pe*Math.PI/180),ee=.5-.25*Math.log((1+Z)/(1-Z))/Math.PI;return ee<0?0:ee>1?1:ee}function wr(pe){const Z=(180-360*pe)*Math.PI/180;return 360*Math.atan(Math.exp(Z))/Math.PI-90}function vr(pe,Z){for(const ee in Z)pe[ee]=Z[ee];return pe}function Cr(pe){return pe.x}function se(pe){return pe.y}function ye(pe,Z,ee,fe){for(var we,De=fe,Xe=ee-Z>>1,Ge=ee-Z,Ne=pe[Z],nt=pe[Z+1],kt=pe[ee],Qt=pe[ee+1],Nt=Z+3;Nt<ee;Nt+=3){var Sr=Ee(pe[Nt],pe[Nt+1],Ne,nt,kt,Qt);if(Sr>De)we=Nt,De=Sr;else if(Sr===De){var It=Math.abs(Nt-Xe);It<Ge&&(we=Nt,Ge=It)}}De>fe&&(we-Z>3&&ye(pe,Z,we,fe),pe[we+2]=De,ee-we>3&&ye(pe,we,ee,fe))}function Ee(pe,Z,ee,fe,we,De){var Xe=we-ee,Ge=De-fe;if(Xe!==0||Ge!==0){var Ne=((pe-ee)*Xe+(Z-fe)*Ge)/(Xe*Xe+Ge*Ge);Ne>1?(ee=we,fe=De):Ne>0&&(ee+=Xe*Ne,fe+=Ge*Ne)}return(Xe=pe-ee)*Xe+(Ge=Z-fe)*Ge}function Ye(pe,Z,ee,fe){var we={id:pe===void 0?null:pe,type:Z,geometry:ee,tags:fe,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(De){var Xe=De.geometry,Ge=De.type;if(Ge==="Point"||Ge==="MultiPoint"||Ge==="LineString")je(De,Xe);else if(Ge==="Polygon"||Ge==="MultiLineString")for(var Ne=0;Ne<Xe.length;Ne++)je(De,Xe[Ne]);else if(Ge==="MultiPolygon")for(Ne=0;Ne<Xe.length;Ne++)for(var nt=0;nt<Xe[Ne].length;nt++)je(De,Xe[Ne][nt])}(we),we}function je(pe,Z){for(var ee=0;ee<Z.length;ee+=3)pe.minX=Math.min(pe.minX,Z[ee]),pe.minY=Math.min(pe.minY,Z[ee+1]),pe.maxX=Math.max(pe.maxX,Z[ee]),pe.maxY=Math.max(pe.maxY,Z[ee+1])}function tt(pe,Z,ee,fe){if(Z.geometry){var we=Z.geometry.coordinates,De=Z.geometry.type,Xe=Math.pow(ee.tolerance/((1<<ee.maxZoom)*ee.extent),2),Ge=[],Ne=Z.id;if(ee.promoteId?Ne=Z.properties[ee.promoteId]:ee.generateId&&(Ne=fe||0),De==="Point")Ue(we,Ge);else if(De==="MultiPoint")for(var nt=0;nt<we.length;nt++)Ue(we[nt],Ge);else if(De==="LineString")Ve(we,Ge,Xe,!1);else if(De==="MultiLineString"){if(ee.lineMetrics){for(nt=0;nt<we.length;nt++)Ve(we[nt],Ge=[],Xe,!1),pe.push(Ye(Ne,"LineString",Ge,Z.properties));return}at(we,Ge,Xe,!1)}else if(De==="Polygon")at(we,Ge,Xe,!0);else{if(De!=="MultiPolygon"){if(De==="GeometryCollection"){for(nt=0;nt<Z.geometry.geometries.length;nt++)tt(pe,{id:Ne,geometry:Z.geometry.geometries[nt],properties:Z.properties},ee,fe);return}throw new Error("Input data is not a valid GeoJSON object.")}for(nt=0;nt<we.length;nt++){var kt=[];at(we[nt],kt,Xe,!0),Ge.push(kt)}}pe.push(Ye(Ne,De,Ge,Z.properties))}}function Ue(pe,Z){Z.push(et(pe[0])),Z.push(mt(pe[1])),Z.push(0)}function Ve(pe,Z,ee,fe){for(var we,De,Xe=0,Ge=0;Ge<pe.length;Ge++){var Ne=et(pe[Ge][0]),nt=mt(pe[Ge][1]);Z.push(Ne),Z.push(nt),Z.push(0),Ge>0&&(Xe+=fe?(we*nt-Ne*De)/2:Math.sqrt(Math.pow(Ne-we,2)+Math.pow(nt-De,2))),we=Ne,De=nt}var kt=Z.length-3;Z[2]=1,ye(Z,0,kt,ee),Z[kt+2]=1,Z.size=Math.abs(Xe),Z.start=0,Z.end=Z.size}function at(pe,Z,ee,fe){for(var we=0;we<pe.length;we++){var De=[];Ve(pe[we],De,ee,fe),Z.push(De)}}function et(pe){return pe/360+.5}function mt(pe){var Z=Math.sin(pe*Math.PI/180),ee=.5-.25*Math.log((1+Z)/(1-Z))/Math.PI;return ee<0?0:ee>1?1:ee}function Ht(pe,Z,ee,fe,we,De,Xe,Ge){if(fe/=Z,De>=(ee/=Z)&&Xe<fe)return pe;if(Xe<ee||De>=fe)return null;for(var Ne=[],nt=0;nt<pe.length;nt++){var kt=pe[nt],Qt=kt.geometry,Nt=kt.type,Sr=we===0?kt.minX:kt.minY,It=we===0?kt.maxX:kt.maxY;if(Sr>=ee&&It<fe)Ne.push(kt);else if(!(It<ee||Sr>=fe)){var Re=[];if(Nt==="Point"||Nt==="MultiPoint")or(Qt,Re,ee,fe,we);else if(Nt==="LineString")fr(Qt,Re,ee,fe,we,!1,Ge.lineMetrics);else if(Nt==="MultiLineString")Ur(Qt,Re,ee,fe,we,!1);else if(Nt==="Polygon")Ur(Qt,Re,ee,fe,we,!0);else if(Nt==="MultiPolygon")for(var bt=0;bt<Qt.length;bt++){var Dt=[];Ur(Qt[bt],Dt,ee,fe,we,!0),Dt.length&&Re.push(Dt)}if(Re.length){if(Ge.lineMetrics&&Nt==="LineString"){for(bt=0;bt<Re.length;bt++)Ne.push(Ye(kt.id,Nt,Re[bt],kt.tags));continue}Nt!=="LineString"&&Nt!=="MultiLineString"||(Re.length===1?(Nt="LineString",Re=Re[0]):Nt="MultiLineString"),Nt!=="Point"&&Nt!=="MultiPoint"||(Nt=Re.length===3?"Point":"MultiPoint"),Ne.push(Ye(kt.id,Nt,Re,kt.tags))}}}return Ne.length?Ne:null}function or(pe,Z,ee,fe,we){for(var De=0;De<pe.length;De+=3){var Xe=pe[De+we];Xe>=ee&&Xe<=fe&&(Z.push(pe[De]),Z.push(pe[De+1]),Z.push(pe[De+2]))}}function fr(pe,Z,ee,fe,we,De,Xe){for(var Ge,Ne,nt=Ir(pe),kt=we===0?$r:Mr,Qt=pe.start,Nt=0;Nt<pe.length-3;Nt+=3){var Sr=pe[Nt],It=pe[Nt+1],Re=pe[Nt+2],bt=pe[Nt+3],Dt=pe[Nt+4],mr=we===0?Sr:It,sr=we===0?bt:Dt,Br=!1;Xe&&(Ge=Math.sqrt(Math.pow(Sr-bt,2)+Math.pow(It-Dt,2))),mr<ee?sr>ee&&(Ne=kt(nt,Sr,It,bt,Dt,ee),Xe&&(nt.start=Qt+Ge*Ne)):mr>fe?sr<fe&&(Ne=kt(nt,Sr,It,bt,Dt,fe),Xe&&(nt.start=Qt+Ge*Ne)):_n(nt,Sr,It,Re),sr<ee&&mr>=ee&&(Ne=kt(nt,Sr,It,bt,Dt,ee),Br=!0),sr>fe&&mr<=fe&&(Ne=kt(nt,Sr,It,bt,Dt,fe),Br=!0),!De&&Br&&(Xe&&(nt.end=Qt+Ge*Ne),Z.push(nt),nt=Ir(pe)),Xe&&(Qt+=Ge)}var Nr=pe.length-3;Sr=pe[Nr],It=pe[Nr+1],Re=pe[Nr+2],(mr=we===0?Sr:It)>=ee&&mr<=fe&&_n(nt,Sr,It,Re),Nr=nt.length-3,De&&Nr>=3&&(nt[Nr]!==nt[0]||nt[Nr+1]!==nt[1])&&_n(nt,nt[0],nt[1],nt[2]),nt.length&&Z.push(nt)}function Ir(pe){var Z=[];return Z.size=pe.size,Z.start=pe.start,Z.end=pe.end,Z}function Ur(pe,Z,ee,fe,we,De){for(var Xe=0;Xe<pe.length;Xe++)fr(pe[Xe],Z,ee,fe,we,De,!1)}function _n(pe,Z,ee,fe){pe.push(Z),pe.push(ee),pe.push(fe)}function $r(pe,Z,ee,fe,we,De){var Xe=(De-Z)/(fe-Z);return pe.push(De),pe.push(ee+(we-ee)*Xe),pe.push(1),Xe}function Mr(pe,Z,ee,fe,we,De){var Xe=(De-ee)/(we-ee);return pe.push(Z+(fe-Z)*Xe),pe.push(De),pe.push(1),Xe}function ln(pe,Z){for(var ee=[],fe=0;fe<pe.length;fe++){var we,De=pe[fe],Xe=De.type;if(Xe==="Point"||Xe==="MultiPoint"||Xe==="LineString")we=an(De.geometry,Z);else if(Xe==="MultiLineString"||Xe==="Polygon"){we=[];for(var Ge=0;Ge<De.geometry.length;Ge++)we.push(an(De.geometry[Ge],Z))}else if(Xe==="MultiPolygon")for(we=[],Ge=0;Ge<De.geometry.length;Ge++){for(var Ne=[],nt=0;nt<De.geometry[Ge].length;nt++)Ne.push(an(De.geometry[Ge][nt],Z));we.push(Ne)}ee.push(Ye(De.id,Xe,we,De.tags))}return ee}function an(pe,Z){var ee=[];ee.size=pe.size,pe.start!==void 0&&(ee.start=pe.start,ee.end=pe.end);for(var fe=0;fe<pe.length;fe+=3)ee.push(pe[fe]+Z,pe[fe+1],pe[fe+2]);return ee}function Hr(pe,Z){if(pe.transformed)return pe;var ee,fe,we,De=1<<pe.z,Xe=pe.x,Ge=pe.y;for(ee=0;ee<pe.features.length;ee++){var Ne=pe.features[ee],nt=Ne.geometry,kt=Ne.type;if(Ne.geometry=[],kt===1)for(fe=0;fe<nt.length;fe+=2)Ne.geometry.push(Fr(nt[fe],nt[fe+1],Z,De,Xe,Ge));else for(fe=0;fe<nt.length;fe++){var Qt=[];for(we=0;we<nt[fe].length;we+=2)Qt.push(Fr(nt[fe][we],nt[fe][we+1],Z,De,Xe,Ge));Ne.geometry.push(Qt)}}return pe.transformed=!0,pe}function Fr(pe,Z,ee,fe,we,De){return[Math.round(ee*(pe*fe-we)),Math.round(ee*(Z*fe-De))]}function rn(pe,Z,ee,fe,we){for(var De=Z===we.maxZoom?0:we.tolerance/((1<<Z)*we.extent),Xe={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:ee,y:fe,z:Z,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Ge=0;Ge<pe.length;Ge++){Xe.numFeatures++,ri(Xe,pe[Ge],De,we);var Ne=pe[Ge].minX,nt=pe[Ge].minY,kt=pe[Ge].maxX,Qt=pe[Ge].maxY;Ne<Xe.minX&&(Xe.minX=Ne),nt<Xe.minY&&(Xe.minY=nt),kt>Xe.maxX&&(Xe.maxX=kt),Qt>Xe.maxY&&(Xe.maxY=Qt)}return Xe}function ri(pe,Z,ee,fe){var we=Z.geometry,De=Z.type,Xe=[];if(De==="Point"||De==="MultiPoint")for(var Ge=0;Ge<we.length;Ge+=3)Xe.push(we[Ge]),Xe.push(we[Ge+1]),pe.numPoints++,pe.numSimplified++;else if(De==="LineString")En(Xe,we,pe,ee,!1,!1);else if(De==="MultiLineString"||De==="Polygon")for(Ge=0;Ge<we.length;Ge++)En(Xe,we[Ge],pe,ee,De==="Polygon",Ge===0);else if(De==="MultiPolygon")for(var Ne=0;Ne<we.length;Ne++){var nt=we[Ne];for(Ge=0;Ge<nt.length;Ge++)En(Xe,nt[Ge],pe,ee,!0,Ge===0)}if(Xe.length){var kt=Z.tags||null;if(De==="LineString"&&fe.lineMetrics){for(var Qt in kt={},Z.tags)kt[Qt]=Z.tags[Qt];kt.mapbox_clip_start=we.start/we.size,kt.mapbox_clip_end=we.end/we.size}var Nt={geometry:Xe,type:De==="Polygon"||De==="MultiPolygon"?3:De==="LineString"||De==="MultiLineString"?2:1,tags:kt};Z.id!==null&&(Nt.id=Z.id),pe.features.push(Nt)}}function En(pe,Z,ee,fe,we,De){var Xe=fe*fe;if(fe>0&&Z.size<(we?Xe:fe))ee.numPoints+=Z.length/3;else{for(var Ge=[],Ne=0;Ne<Z.length;Ne+=3)(fe===0||Z[Ne+2]>Xe)&&(ee.numSimplified++,Ge.push(Z[Ne]),Ge.push(Z[Ne+1])),ee.numPoints++;we&&function(nt,kt){for(var Qt=0,Nt=0,Sr=nt.length,It=Sr-2;Nt<Sr;It=Nt,Nt+=2)Qt+=(nt[Nt]-nt[It])*(nt[Nt+1]+nt[It+1]);if(Qt>0===kt)for(Nt=0,Sr=nt.length;Nt<Sr/2;Nt+=2){var Re=nt[Nt],bt=nt[Nt+1];nt[Nt]=nt[Sr-2-Nt],nt[Nt+1]=nt[Sr-1-Nt],nt[Sr-2-Nt]=Re,nt[Sr-1-Nt]=bt}}(Ge,De),pe.push(Ge)}}function un(pe,Z){var ee=(Z=this.options=function(we,De){for(var Xe in De)we[Xe]=De[Xe];return we}(Object.create(this.options),Z)).debug;if(ee&&console.time("preprocess data"),Z.maxZoom<0||Z.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(Z.promoteId&&Z.generateId)throw new Error("promoteId and generateId cannot be used together.");var fe=function(we,De){var Xe=[];if(we.type==="FeatureCollection")for(var Ge=0;Ge<we.features.length;Ge++)tt(Xe,we.features[Ge],De,Ge);else tt(Xe,we.type==="Feature"?we:{geometry:we},De);return Xe}(pe,Z);this.tiles={},this.tileCoords=[],ee&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",Z.indexMaxZoom,Z.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),fe=function(we,De){var Xe=De.buffer/De.extent,Ge=we,Ne=Ht(we,1,-1-Xe,Xe,0,-1,2,De),nt=Ht(we,1,1-Xe,2+Xe,0,-1,2,De);return(Ne||nt)&&(Ge=Ht(we,1,-Xe,1+Xe,0,-1,2,De)||[],Ne&&(Ge=ln(Ne,1).concat(Ge)),nt&&(Ge=Ge.concat(ln(nt,-1)))),Ge}(fe,Z),fe.length&&this.splitTile(fe,0,0,0),ee&&(fe.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function zr(pe,Z,ee){return 32*((1<<pe)*ee+Z)+pe}function bo(pe,Z){const ee=pe.tileID.canonical;if(!this._geoJSONIndex)return Z(null,null);const fe=this._geoJSONIndex.getTile(ee.z,ee.x,ee.y);if(!fe)return Z(null,null);const we=new j(fe.features);let De=z(we);De.byteOffset===0&&De.byteLength===De.buffer.byteLength||(De=new Uint8Array(De)),Z(null,{vectorTile:we,rawData:De.buffer})}un.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},un.prototype.splitTile=function(pe,Z,ee,fe,we,De,Xe){for(var Ge=[pe,Z,ee,fe],Ne=this.options,nt=Ne.debug;Ge.length;){fe=Ge.pop(),ee=Ge.pop(),Z=Ge.pop(),pe=Ge.pop();var kt=1<<Z,Qt=zr(Z,ee,fe),Nt=this.tiles[Qt];if(!Nt&&(nt>1&&console.time("creation"),Nt=this.tiles[Qt]=rn(pe,Z,ee,fe,Ne),this.tileCoords.push({z:Z,x:ee,y:fe}),nt)){nt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",Z,ee,fe,Nt.numFeatures,Nt.numPoints,Nt.numSimplified),console.timeEnd("creation"));var Sr="z"+Z;this.stats[Sr]=(this.stats[Sr]||0)+1,this.total++}if(Nt.source=pe,we){if(Z===Ne.maxZoom||Z===we)continue;var It=1<<we-Z;if(ee!==Math.floor(De/It)||fe!==Math.floor(Xe/It))continue}else if(Z===Ne.indexMaxZoom||Nt.numPoints<=Ne.indexMaxPoints)continue;if(Nt.source=null,pe.length!==0){nt>1&&console.time("clipping");var Re,bt,Dt,mr,sr,Br,Nr=.5*Ne.buffer/Ne.extent,sa=.5-Nr,Kn=.5+Nr,wt=1+Nr;Re=bt=Dt=mr=null,sr=Ht(pe,kt,ee-Nr,ee+Kn,0,Nt.minX,Nt.maxX,Ne),Br=Ht(pe,kt,ee+sa,ee+wt,0,Nt.minX,Nt.maxX,Ne),pe=null,sr&&(Re=Ht(sr,kt,fe-Nr,fe+Kn,1,Nt.minY,Nt.maxY,Ne),bt=Ht(sr,kt,fe+sa,fe+wt,1,Nt.minY,Nt.maxY,Ne),sr=null),Br&&(Dt=Ht(Br,kt,fe-Nr,fe+Kn,1,Nt.minY,Nt.maxY,Ne),mr=Ht(Br,kt,fe+sa,fe+wt,1,Nt.minY,Nt.maxY,Ne),Br=null),nt>1&&console.timeEnd("clipping"),Ge.push(Re||[],Z+1,2*ee,2*fe),Ge.push(bt||[],Z+1,2*ee,2*fe+1),Ge.push(Dt||[],Z+1,2*ee+1,2*fe),Ge.push(mr||[],Z+1,2*ee+1,2*fe+1)}}},un.prototype.getTile=function(pe,Z,ee){var fe=this.options,we=fe.extent,De=fe.debug;if(pe<0||pe>24)return null;var Xe=1<<pe,Ge=zr(pe,Z=(Z%Xe+Xe)%Xe,ee);if(this.tiles[Ge])return Hr(this.tiles[Ge],we);De>1&&console.log("drilling down to z%d-%d-%d",pe,Z,ee);for(var Ne,nt=pe,kt=Z,Qt=ee;!Ne&&nt>0;)nt--,kt=Math.floor(kt/2),Qt=Math.floor(Qt/2),Ne=this.tiles[zr(nt,kt,Qt)];return Ne&&Ne.source?(De>1&&console.log("found parent tile z%d-%d-%d",nt,kt,Qt),De>1&&console.time("drilling down"),this.splitTile(Ne.source,nt,kt,Qt,pe,Z,ee),De>1&&console.timeEnd("drilling down"),this.tiles[Ge]?Hr(this.tiles[Ge],we):null):null};class aa extends a.VectorTileWorkerSource{constructor(Z,ee,fe,we,De){super(Z,ee,fe,we,bo),De&&(this.loadGeoJSON=De)}loadData(Z,ee){const fe=Z&&Z.request,we=fe&&fe.collectResourceTiming;this.loadGeoJSON(Z,(De,Xe)=>{if(De||!Xe)return ee(De);if(typeof Xe!="object")return ee(new Error(`Input data given to '${Z.source}' is not a valid GeoJSON object.`));{E(Xe,!0);try{if(Z.filter){const Ne=a.createExpression(Z.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Ne.result==="error")throw new Error(Ne.value.map(kt=>`${kt.key}: ${kt.message}`).join(", "));Xe={type:"FeatureCollection",features:Xe.features.filter(kt=>Ne.value.evaluate({zoom:0},kt))}}this._geoJSONIndex=Z.cluster?new Tt(function({superclusterOptions:Ne,clusterProperties:nt}){if(!nt||!Ne)return Ne;const kt={},Qt={},Nt={accumulated:null,zoom:0},Sr={properties:null},It=Object.keys(nt);for(const Re of It){const[bt,Dt]=nt[Re],mr=a.createExpression(Dt),sr=a.createExpression(typeof bt=="string"?[bt,["accumulated"],["get",Re]]:bt);kt[Re]=mr.value,Qt[Re]=sr.value}return Ne.map=Re=>{Sr.properties=Re;const bt={};for(const Dt of It)bt[Dt]=kt[Dt].evaluate(Nt,Sr);return bt},Ne.reduce=(Re,bt)=>{Sr.properties=bt;for(const Dt of It)Nt.accumulated=Re[Dt],Re[Dt]=Qt[Dt].evaluate(Nt,Sr)},Ne}(Z)).load(Xe.features):function(Ne,nt){return new un(Ne,nt)}(Xe,Z.geojsonVtOptions)}catch(Ne){return ee(Ne)}this.loaded={};const Ge={};if(we){const Ne=a.getPerformanceMeasurement(fe);Ne&&(Ge.resourceTiming={},Ge.resourceTiming[Z.source]=JSON.parse(JSON.stringify(Ne)))}ee(null,Ge)}})}reloadTile(Z,ee){const fe=this.loaded;return fe&&fe[Z.uid]?super.reloadTile(Z,ee):this.loadTile(Z,ee)}loadGeoJSON(Z,ee){if(Z.request)a.getJSON(Z.request,ee);else{if(typeof Z.data!="string")return ee(new Error(`Input data given to '${Z.source}' is not a valid GeoJSON object.`));try{return ee(null,JSON.parse(Z.data))}catch{return ee(new Error(`Input data given to '${Z.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(Z,ee){try{ee(null,this._geoJSONIndex.getClusterExpansionZoom(Z.clusterId))}catch(fe){ee(fe)}}getClusterChildren(Z,ee){try{ee(null,this._geoJSONIndex.getChildren(Z.clusterId))}catch(fe){ee(fe)}}getClusterLeaves(Z,ee){try{ee(null,this._geoJSONIndex.getLeaves(Z.clusterId,Z.limit,Z.offset))}catch(fe){ee(fe)}}}class zo{constructor(Z){this.self=Z,this.actor=new a.Actor(Z,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=a.getProjection({name:"mercator"}),this.workerSourceTypes={vector:a.VectorTileWorkerSource,geojson:aa},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(ee,fe)=>{if(this.workerSourceTypes[ee])throw new Error(`Worker source with name "${ee}" already registered.`);this.workerSourceTypes[ee]=fe},this.self.registerRTLTextPlugin=ee=>{if(a.plugin.isParsed())throw new Error("RTL text plugin already registered.");a.plugin.applyArabicShaping=ee.applyArabicShaping,a.plugin.processBidirectionalText=ee.processBidirectionalText,a.plugin.processStyledBidirectionalText=ee.processStyledBidirectionalText}}clearCaches(Z,ee,fe){delete this.layerIndexes[Z],delete this.availableImages[Z],delete this.workerSources[Z],delete this.demWorkerSources[Z],fe()}checkIfReady(Z,ee,fe){fe()}setReferrer(Z,ee){this.referrer=ee}spriteLoaded(Z,ee){this.isSpriteLoaded[Z]=ee;for(const fe in this.workerSources[Z]){const we=this.workerSources[Z][fe];for(const De in we)we[De]instanceof a.VectorTileWorkerSource&&(we[De].isSpriteLoaded=ee,we[De].fire(new a.Event("isSpriteLoaded")))}}setImages(Z,ee,fe){this.availableImages[Z]=ee;for(const we in this.workerSources[Z]){const De=this.workerSources[Z][we];for(const Xe in De)De[Xe].availableImages=ee}fe()}enableTerrain(Z,ee,fe){this.terrain=ee,fe()}setProjection(Z,ee){this.projections[Z]=a.getProjection(ee)}setLayers(Z,ee,fe){this.getLayerIndex(Z).replace(ee),fe()}updateLayers(Z,ee,fe){this.getLayerIndex(Z).update(ee.layers,ee.removedIds),fe()}loadTile(Z,ee,fe){const we=this.enableTerrain?a.extend({enableTerrain:this.terrain},ee):ee;we.projection=this.projections[Z]||this.defaultProjection,this.getWorkerSource(Z,ee.type,ee.source).loadTile(we,fe)}loadDEMTile(Z,ee,fe){const we=this.enableTerrain?a.extend({buildQuadTree:this.terrain},ee):ee;this.getDEMWorkerSource(Z,ee.source).loadTile(we,fe)}reloadTile(Z,ee,fe){const we=this.enableTerrain?a.extend({enableTerrain:this.terrain},ee):ee;we.projection=this.projections[Z]||this.defaultProjection,this.getWorkerSource(Z,ee.type,ee.source).reloadTile(we,fe)}abortTile(Z,ee,fe){this.getWorkerSource(Z,ee.type,ee.source).abortTile(ee,fe)}removeTile(Z,ee,fe){this.getWorkerSource(Z,ee.type,ee.source).removeTile(ee,fe)}removeSource(Z,ee,fe){if(!this.workerSources[Z]||!this.workerSources[Z][ee.type]||!this.workerSources[Z][ee.type][ee.source])return;const we=this.workerSources[Z][ee.type][ee.source];delete this.workerSources[Z][ee.type][ee.source],we.removeSource!==void 0?we.removeSource(ee,fe):fe()}loadWorkerSource(Z,ee,fe){try{this.self.importScripts(ee.url),fe()}catch(we){fe(we.toString())}}syncRTLPluginState(Z,ee,fe){try{a.plugin.setState(ee);const we=a.plugin.getPluginURL();if(a.plugin.isLoaded()&&!a.plugin.isParsed()&&we!=null){this.self.importScripts(we);const De=a.plugin.isParsed();fe(De?void 0:new Error(`RTL Text Plugin failed to import scripts from ${we}`),De)}}catch(we){fe(we.toString())}}getAvailableImages(Z){let ee=this.availableImages[Z];return ee||(ee=[]),ee}getLayerIndex(Z){let ee=this.layerIndexes[Z];return ee||(ee=this.layerIndexes[Z]=new y),ee}getWorkerSource(Z,ee,fe){if(this.workerSources[Z]||(this.workerSources[Z]={}),this.workerSources[Z][ee]||(this.workerSources[Z][ee]={}),!this.workerSources[Z][ee][fe]){const we={send:(De,Xe,Ge,Ne,nt,kt)=>{this.actor.send(De,Xe,Ge,Z,nt,kt)},scheduler:this.actor.scheduler};this.workerSources[Z][ee][fe]=new this.workerSourceTypes[ee](we,this.getLayerIndex(Z),this.getAvailableImages(Z),this.isSpriteLoaded[Z])}return this.workerSources[Z][ee][fe]}getDEMWorkerSource(Z,ee){return this.demWorkerSources[Z]||(this.demWorkerSources[Z]={}),this.demWorkerSources[Z][ee]||(this.demWorkerSources[Z][ee]=new S),this.demWorkerSources[Z][ee]}enforceCacheSizeLimit(Z,ee){a.enforceCacheSizeLimit(ee)}getWorkerPerformanceMetrics(Z,ee,fe){fe(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new zo(self)),zo}),o(["./shared"],function(a){function h(v,f){if(Array.isArray(v)){if(!Array.isArray(f)||v.length!==f.length)return!1;for(let m=0;m<v.length;m++)if(!h(v[m],f[m]))return!1;return!0}if(typeof v=="object"&&v!==null&&f!==null){if(typeof f!="object"||Object.keys(v).length!==Object.keys(f).length)return!1;for(const m in v)if(!h(v[m],f[m]))return!1;return!0}return v===f}var p=y;function y(v){return!function(f){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var b,x,T=new Blob([""],{type:"text/javascript"}),P=URL.createObjectURL(T);try{x=new Worker(P),b=!0}catch{b=!1}return x&&x.terminate(),URL.revokeObjectURL(P),b}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var b=document.createElement("canvas");b.width=b.height=1;var x=b.getContext("2d");if(!x)return!1;var T=x.getImageData(0,0,1,1);return T&&T.width===b.width}()?(S[m=f&&f.failIfMajorPerformanceCaveat]===void 0&&(S[m]=function(b){var x,T=function(P){var I=document.createElement("canvas"),L=Object.create(y.webGLContextAttributes);return L.failIfMajorPerformanceCaveat=P,I.getContext("webgl",L)||I.getContext("experimental-webgl",L)}(b);if(!T)return!1;try{x=T.createShader(T.VERTEX_SHADER)}catch{return!1}return!(!x||T.isContextLost())&&(T.shaderSource(x,"void main() {}"),T.compileShader(x),T.getShaderParameter(x,T.COMPILE_STATUS)===!0)}(m)),S[m]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var m}(v)}var S={};function E(v,f,m){const b=a.window.document.createElement(v);return f!==void 0&&(b.className=f),m&&m.appendChild(b),b}function O(v,f,m){const b=a.window.document.createElementNS("http://www.w3.org/2000/svg",v);for(const x of Object.keys(f))b.setAttributeNS(null,x,f[x]);return m&&m.appendChild(b),b}y.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const A=a.window.document&&a.window.document.documentElement.style,$=A&&A.userSelect!==void 0?"userSelect":"WebkitUserSelect";let B;function j(){A&&$&&(B=A[$],A[$]="none")}function z(){A&&$&&(A[$]=B)}function W(v){v.preventDefault(),v.stopPropagation(),a.window.removeEventListener("click",W,!0)}function Q(){a.window.addEventListener("click",W,!0),a.window.setTimeout(()=>{a.window.removeEventListener("click",W,!0)},0)}function q(v,f){const m=v.getBoundingClientRect();return He(v,m,f)}function Se(v,f){const m=v.getBoundingClientRect(),b=[];for(let x=0;x<f.length;x++)b.push(He(v,m,f[x]));return b}function Ie(v){return a.window.InstallTrigger!==void 0&&v.button===2&&v.ctrlKey&&a.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:v.button}function He(v,f,m){const b=v.offsetWidth===f.width?1:v.offsetWidth/f.width;return new a.pointGeometry((m.clientX-f.left)*b,(m.clientY-f.top)*b)}function Le(v,f){var m=f[0],b=f[1],x=f[2],T=f[3],P=m*T-x*b;return P?(v[0]=T*(P=1/P),v[1]=-b*P,v[2]=-x*P,v[3]=m*P,v):null}function ze(v){const{userImage:f}=v;return!!(f&&f.render&&f.render())&&(v.data.replace(new Uint8Array(f.data.buffer)),!0)}class ct extends a.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new a.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(f){if(this.loaded!==f&&(this.loaded=f,f)){for(const{ids:m,callback:b}of this.requestors)this._notify(m,b);this.requestors=[]}}hasImage(f){return!!this.getImage(f)}getImage(f){return this.images[f]}addImage(f,m){this._validate(f,m)&&(this.images[f]=m)}_validate(f,m){let b=!0;return this._validateStretch(m.stretchX,m.data&&m.data.width)||(this.fire(new a.ErrorEvent(new Error(`Image "${f}" has invalid "stretchX" value`))),b=!1),this._validateStretch(m.stretchY,m.data&&m.data.height)||(this.fire(new a.ErrorEvent(new Error(`Image "${f}" has invalid "stretchY" value`))),b=!1),this._validateContent(m.content,m)||(this.fire(new a.ErrorEvent(new Error(`Image "${f}" has invalid "content" value`))),b=!1),b}_validateStretch(f,m){if(!f)return!0;let b=0;for(const x of f){if(x[0]<b||x[1]<x[0]||m<x[1])return!1;b=x[1]}return!0}_validateContent(f,m){return!(f&&(f.length!==4||f[0]<0||m.data.width<f[0]||f[1]<0||m.data.height<f[1]||f[2]<0||m.data.width<f[2]||f[3]<0||m.data.height<f[3]||f[2]<f[0]||f[3]<f[1]))}updateImage(f,m){m.version=this.images[f].version+1,this.images[f]=m,this.updatedImages[f]=!0}removeImage(f){const m=this.images[f];delete this.images[f],delete this.patterns[f],m.userImage&&m.userImage.onRemove&&m.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(f,m){let b=!0;if(!this.isLoaded())for(const x of f)this.images[x]||(b=!1);this.isLoaded()||b?this._notify(f,m):this.requestors.push({ids:f,callback:m})}_notify(f,m){const b={};for(const x of f){this.images[x]||this.fire(new a.Event("styleimagemissing",{id:x}));const T=this.images[x];T?b[x]={data:T.data.clone(),pixelRatio:T.pixelRatio,sdf:T.sdf,version:T.version,stretchX:T.stretchX,stretchY:T.stretchY,content:T.content,hasRenderCallback:!!(T.userImage&&T.userImage.render)}:a.warnOnce(`Image "${x}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}m(null,b)}getPixelSize(){const{width:f,height:m}=this.atlasImage;return{width:f,height:m}}getPattern(f){const m=this.patterns[f],b=this.getImage(f);if(!b)return null;if(m&&m.position.version===b.version)return m.position;if(m)m.position.version=b.version;else{const x={w:b.data.width+2,h:b.data.height+2,x:0,y:0},T=new a.ImagePosition(x,b);this.patterns[f]={bin:x,position:T}}return this._updatePatternAtlas(),this.patterns[f].position}bind(f){const m=f.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new a.Texture(f,this.atlasImage,m.RGBA),this.atlasTexture&&this.atlasTexture.bind(m.LINEAR,m.CLAMP_TO_EDGE)}_updatePatternAtlas(){const f=[];for(const T in this.patterns)f.push(this.patterns[T].bin);const{w:m,h:b}=a.potpack(f),x=this.atlasImage;x.resize({width:m||1,height:b||1});for(const T in this.patterns){const{bin:P}=this.patterns[T],I=P.x+1,L=P.y+1,V=this.images[T].data,H=V.width,X=V.height;a.RGBAImage.copy(V,x,{x:0,y:0},{x:I,y:L},{width:H,height:X}),a.RGBAImage.copy(V,x,{x:0,y:X-1},{x:I,y:L-1},{width:H,height:1}),a.RGBAImage.copy(V,x,{x:0,y:0},{x:I,y:L+X},{width:H,height:1}),a.RGBAImage.copy(V,x,{x:H-1,y:0},{x:I-1,y:L},{width:1,height:X}),a.RGBAImage.copy(V,x,{x:0,y:0},{x:I+H,y:L},{width:1,height:X})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(f){for(const m of f){if(this.callbackDispatchedThisFrame[m])continue;this.callbackDispatchedThisFrame[m]=!0;const b=this.images[m];ze(b)&&this.updateImage(m,b)}}}const At=new a.Properties({anchor:new a.DataConstantProperty(a.spec.light.anchor),position:new class{constructor(){this.specification=a.spec.light.position}possiblyEvaluate(v,f){return function([m,b,x]){const T=a.degToRad(b+90),P=a.degToRad(x);return{x:m*Math.cos(T)*Math.sin(P),y:m*Math.sin(T)*Math.sin(P),z:m*Math.cos(P),azimuthal:b,polar:x}}(v.expression.evaluate(f))}interpolate(v,f,m){return{x:a.number(v.x,f.x,m),y:a.number(v.y,f.y,m),z:a.number(v.z,f.z,m),azimuthal:a.number(v.azimuthal,f.azimuthal,m),polar:a.number(v.polar,f.polar,m)}}},color:new a.DataConstantProperty(a.spec.light.color),intensity:new a.DataConstantProperty(a.spec.light.intensity)}),Qe="-transition";class de extends a.Evented{constructor(f){super(),this._transitionable=new a.Transitionable(At),this.setLight(f),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(f,m={}){if(!this._validate(a.validateLight,f,m))for(const b in f){const x=f[b];a.endsWith(b,Qe)?this._transitionable.setTransition(b.slice(0,-Qe.length),x):this._transitionable.setValue(b,x)}}updateTransitions(f){this._transitioning=this._transitionable.transitioned(f,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(f){this.properties=this._transitioning.possiblyEvaluate(f)}_validate(f,m,b){return(!b||b.validate!==!1)&&a.emitValidationErrors(this,f.call(a.validateStyle,a.extend({value:m,style:{glyphs:!0,sprite:!0},styleSpec:a.spec})))}}const Ce=new a.Properties({source:new a.DataConstantProperty(a.spec.terrain.source),exaggeration:new a.DataConstantProperty(a.spec.terrain.exaggeration)}),pt="-transition";class Ct extends a.Evented{constructor(f,m){super(),this._transitionable=new a.Transitionable(Ce),this.set(f),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=m}get(){return this._transitionable.serialize()}set(f){for(const m in f){const b=f[m];a.endsWith(m,pt)?this._transitionable.setTransition(m.slice(0,-pt.length),b):this._transitionable.setValue(m,b)}}updateTransitions(f){this._transitioning=this._transitionable.transitioned(f,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(f){this.properties=this._transitioning.possiblyEvaluate(f)}}function ie(v,f,m,b){const x=a.smoothstep(45,65,m),[T,P]=M(v,b),I=a.length(f);let L=1-Math.min(1,Math.exp((I-T)/(P-T)*-6));return L*=L*L,L=Math.min(1,1.00747*L),L*x*v.alpha}function M(v,f){const m=.5/Math.tan(.5*f);return[v.range[0]+m,v.range[1]+m]}const U=new a.Properties({range:new a.DataConstantProperty(a.spec.fog.range),color:new a.DataConstantProperty(a.spec.fog.color),"high-color":new a.DataConstantProperty(a.spec.fog["high-color"]),"space-color":new a.DataConstantProperty(a.spec.fog["space-color"]),"horizon-blend":new a.DataConstantProperty(a.spec.fog["horizon-blend"]),"star-intensity":new a.DataConstantProperty(a.spec.fog["star-intensity"])}),K="-transition";class re extends a.Evented{constructor(f,m){super(),this._transitionable=new a.Transitionable(U),this.set(f),this._transitioning=this._transitionable.untransitioned(),this._transform=m}get state(){const f=this._transform,m=f.projection.name==="globe",b=a.globeToMercatorTransition(f.zoom),x=this.properties.get("range"),T=[.5,3];return{range:m?[a.number(T[0],x[0],b),a.number(T[1],x[1],b)]:x,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(f,m={}){if(!this._validate(a.validateFog,f,m)){for(const b of Object.keys(a.spec.fog))f&&f[b]===void 0&&(f[b]=a.spec.fog[b].default);for(const b in f){const x=f[b];a.endsWith(b,K)?this._transitionable.setTransition(b.slice(0,-K.length),x):this._transitionable.setValue(b,x)}}}getOpacity(f){if(!this._transform.projection.supportsFog)return 0;const m=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:a.smoothstep(45,65,f))*m.a}getOpacityAtLatLng(f,m){return this._transform.projection.supportsFog?function(b,x,T){const P=a.MercatorCoordinate.fromLngLat(x),I=T.elevation?T.elevation.getAtPointOrZero(P):0,L=[P.x,P.y,I];return a.transformMat4(L,L,T.mercatorFogMatrix),ie(b,L,T.pitch,T._fov)}(this.state,f,m):0}getFovAdjustedRange(f){return this._transform.projection.supportsFog?M(this.state,f):[0,1]}updateTransitions(f){this._transitioning=this._transitionable.transitioned(f,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(f){this.properties=this._transitioning.possiblyEvaluate(f)}_validate(f,m,b){return(!b||b.validate!==!1)&&a.emitValidationErrors(this,f.call(a.validateStyle,a.extend({value:m,style:{glyphs:!0,sprite:!0},styleSpec:a.spec})))}}class me{constructor(f,m){this.workerPool=f,this.actors=[],this.currentActor=0,this.id=a.uniqueId();const b=this.workerPool.acquire(this.id);for(let x=0;x<b.length;x++){const T=new me.Actor(b[x],m,this.id);T.name=`Worker ${x}`,this.actors.push(T)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(f,m,b){a.asyncAll(this.actors,(x,T)=>{x.send(f,m,T)},b=b||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(f=>{f.remove()}),this.actors=[],this.workerPool.release(this.id)}}function Oe(v,f,m){return f*(a.EXTENT/(v.tileSize*Math.pow(2,m-v.tileID.overscaledZ)))}me.Actor=a.Actor;class We{constructor(f,m,b,x){this.screenBounds=f,this.cameraPoint=m,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=b,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,x)}static createFromScreenPoints(f,m){let b,x;if(f instanceof a.pointGeometry||typeof f[0]=="number"){const T=a.pointGeometry.convert(f);b=[T],x=m.isPointAboveHorizon(T)}else{const T=a.pointGeometry.convert(f[0]),P=a.pointGeometry.convert(f[1]);b=[T,P],x=a.polygonizeBounds(T,P).every(I=>m.isPointAboveHorizon(I))}return new We(b,m.getCameraPoint(),x,m)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(f){return a.polygonizeBounds(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],f)}bufferedCameraGeometry(f){const m=this.screenBounds[0],b=this.screenBounds.length===1?this.screenBounds[0].add(new a.pointGeometry(1,1)):this.screenBounds[1],x=a.polygonizeBounds(m,b,0,!1);return this.cameraPoint.y>b.y&&(this.cameraPoint.x>m.x&&this.cameraPoint.x<b.x?x.splice(3,0,this.cameraPoint):this.cameraPoint.x>=b.x?x[2]=this.cameraPoint:this.cameraPoint.x<=m.x&&(x[3]=this.cameraPoint)),a.bufferConvexPolygon(x,f)}bufferedCameraGeometryGlobe(f){const m=this.screenBounds[0],b=this.screenBounds.length===1?this.screenBounds[0].add(new a.pointGeometry(1,1)):this.screenBounds[1],x=a.polygonizeBounds(m,b,f),T=this.cameraPoint.clone();switch(3*((T.y>m.y)+(T.y>b.y))+((T.x>m.x)+(T.x>b.x))){case 0:x[0]=T,x[4]=T.clone();break;case 1:x.splice(1,0,T);break;case 2:x[1]=T;break;case 3:x.splice(4,0,T);break;case 5:x.splice(2,0,T);break;case 6:x[3]=T;break;case 7:x.splice(3,0,T);break;case 8:x[2]=T}return x}containsTile(f,m,b,x=0){const T=f.queryPadding/m._pixelsPerMercatorPixel+1,P=b?this._bufferedCameraMercator(T,m):this._bufferedScreenMercator(T,m);let I=f.tileID.wrap+(P.unwrapped?x:0);const L=P.polygon.map(ce=>a.getTilePoint(f.tileTransform,ce,I));if(!a.polygonIntersectsBox(L,0,0,a.EXTENT,a.EXTENT))return;I=f.tileID.wrap+(this.screenGeometryMercator.unwrapped?x:0);const V=this.screenGeometryMercator.polygon.map(ce=>a.getTileVec3(f.tileTransform,ce,I)),H=V.map(ce=>new a.pointGeometry(ce[0],ce[1])),X=m.getFreeCameraOptions().position||new a.MercatorCoordinate(0,0,0),ne=a.getTileVec3(f.tileTransform,X,I),ae=V.map(ce=>{const te=a.sub(ce,ce,ne);return a.normalize(te,te),new a.Ray(ne,te)}),le=Oe(f,1,m.zoom)*m._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:H,tilespaceRays:ae,bufferedTilespaceGeometry:L,bufferedTilespaceBounds:(ue=a.getBounds(L),ue.min.x=a.clamp(ue.min.x,0,a.EXTENT),ue.min.y=a.clamp(ue.min.y,0,a.EXTENT),ue.max.x=a.clamp(ue.max.x,0,a.EXTENT),ue.max.y=a.clamp(ue.max.y,0,a.EXTENT),ue),tile:f,tileID:f.tileID,pixelToTileUnitsFactor:le};var ue}_bufferedScreenMercator(f,m){const b=ft(f);if(this._screenRaycastCache[b])return this._screenRaycastCache[b];{let x;return x=m.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(f),m):{polygon:this.bufferedScreenGeometry(f).map(T=>m.pointCoordinate3D(T)),unwrapped:!0},this._screenRaycastCache[b]=x,x}}_bufferedCameraMercator(f,m){const b=ft(f);if(this._cameraRaycastCache[b])return this._cameraRaycastCache[b];{let x;return x=m.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(f),m):{polygon:this.bufferedCameraGeometry(f).map(T=>m.pointCoordinate3D(T)),unwrapped:!0},this._cameraRaycastCache[b]=x,x}}_projectAndResample(f,m){const b=function(T,P){const I=a.multiply([],P.pixelMatrix,P.globeMatrix),L=[0,-a.GLOBE_RADIUS,0,1],V=[0,a.GLOBE_RADIUS,0,1],H=[0,0,0,1];a.transformMat4$1(L,L,I),a.transformMat4$1(V,V,I),a.transformMat4$1(H,H,I);const X=new a.pointGeometry(L[0]/L[3],L[1]/L[3]),ne=new a.pointGeometry(V[0]/V[3],V[1]/V[3]),ae=a.polygonContainsPoint(T,X)&&L[3]<H[3],le=a.polygonContainsPoint(T,ne)&&V[3]<H[3];if(!ae&&!le)return null;const ue=function(Be,Ze,ot){for(let ut=1;ut<Be.length;ut++){const zt=ht(Ze.pointCoordinate3D(Be[ut-1]).x),rt=ht(Ze.pointCoordinate3D(Be[ut]).x);if(ot<0){if(zt<rt)return{idx:ut,t:-zt/(rt-1-zt)}}else if(rt<zt)return{idx:ut,t:(1-zt)/(rt+1-zt)}}return null}(T,P,ae?-1:1);if(!ue)return null;const{idx:ce,t:te}=ue;let _e=ce>1?Je(T.slice(0,ce),P):[],ve=ce<T.length?Je(T.slice(ce),P):[];_e=_e.map(Be=>new a.pointGeometry(ht(Be.x),Be.y)),ve=ve.map(Be=>new a.pointGeometry(ht(Be.x),Be.y));const be=[..._e];be.length===0&&be.push(ve[ve.length-1]);const $e=a.number(be[be.length-1].y,(ve.length===0?_e[0]:ve[0]).y,te);let Ae;return Ae=ae?[new a.pointGeometry(0,$e),new a.pointGeometry(0,0),new a.pointGeometry(1,0),new a.pointGeometry(1,$e)]:[new a.pointGeometry(1,$e),new a.pointGeometry(1,1),new a.pointGeometry(0,1),new a.pointGeometry(0,$e)],be.push(...Ae),ve.length===0?be.push(_e[0]):be.push(...ve),{polygon:be.map(Be=>new a.MercatorCoordinate(Be.x,Be.y)),unwrapped:!1}}(f,m);if(b)return b;const x=function(T,P){let I=!1,L=-1/0,V=0;for(let X=0;X<T.length-1;X++)T[X].x>L&&(L=T[X].x,V=X);for(let X=0;X<T.length-1;X++){const ne=(V+X)%(T.length-1),ae=T[ne],le=T[ne+1];Math.abs(ae.x-le.x)>.5&&(ae.x<le.x?(ae.x+=1,ne===0&&(T[T.length-1].x+=1)):(le.x+=1,ne+1===T.length-1&&(T[0].x+=1)),I=!0)}const H=a.mercatorXfromLng(P.center.lng);return I&&H<Math.abs(H-1)&&T.forEach(X=>{X.x-=1}),{polygon:T,unwrapped:I}}(Je(f,m).map(T=>new a.pointGeometry(ht(T.x),T.y)),m);return{polygon:x.polygon.map(T=>new a.MercatorCoordinate(T.x,T.y)),unwrapped:x.unwrapped}}}function Je(v,f){return a.resample(v,m=>{const b=f.pointCoordinate3D(m);m.x=b.x,m.y=b.y},1/256)}function ht(v){return v<0?1+v%1:v%1}function ft(v){return 100*v|0}function St(v,f,m,b,x){const T=function(P,I){if(P)return x(P);if(I){v.url&&I.tiles&&v.tiles&&delete v.tiles;const L=a.pick(a.extend(I,v),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);I.vector_layers&&(L.vectorLayers=I.vector_layers,L.vectorLayerIds=L.vectorLayers.map(V=>V.id)),L.tiles=f.canonicalizeTileset(L,v.url),x(null,L)}};return v.url?a.getJSON(f.transformRequest(f.normalizeSourceURL(v.url,null,m,b),a.ResourceType.Source),T):a.exported.frame(()=>T(null,v))}class Tt{constructor(f,m,b){this.bounds=a.LngLatBounds.convert(this.validateBounds(f)),this.minzoom=m||0,this.maxzoom=b||24}validateBounds(f){return Array.isArray(f)&&f.length===4?[Math.max(-180,f[0]),Math.max(-90,f[1]),Math.min(180,f[2]),Math.min(90,f[3])]:[-180,-90,180,90]}contains(f){const m=Math.pow(2,f.z),b=Math.floor(a.mercatorXfromLng(this.bounds.getWest())*m),x=Math.floor(a.mercatorYfromLat(this.bounds.getNorth())*m),T=Math.ceil(a.mercatorXfromLng(this.bounds.getEast())*m),P=Math.ceil(a.mercatorYfromLat(this.bounds.getSouth())*m);return f.x>=b&&f.x<T&&f.y>=x&&f.y<P}}class Xt{constructor(f,m,b){this.context=f;const x=f.gl;this.buffer=x.createBuffer(),this.dynamicDraw=!!b,this.context.unbindVAO(),f.bindElementBuffer.set(this.buffer),x.bufferData(x.ELEMENT_ARRAY_BUFFER,m.arrayBuffer,this.dynamicDraw?x.DYNAMIC_DRAW:x.STATIC_DRAW),this.dynamicDraw||m.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(f){const m=this.context.gl;this.context.unbindVAO(),this.bind(),m.bufferSubData(m.ELEMENT_ARRAY_BUFFER,0,f.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const jt={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Kt{constructor(f,m,b,x){this.length=m.length,this.attributes=b,this.itemSize=m.bytesPerElement,this.dynamicDraw=x,this.context=f;const T=f.gl;this.buffer=T.createBuffer(),f.bindVertexBuffer.set(this.buffer),T.bufferData(T.ARRAY_BUFFER,m.arrayBuffer,this.dynamicDraw?T.DYNAMIC_DRAW:T.STATIC_DRAW),this.dynamicDraw||m.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(f){const m=this.context.gl;this.bind(),m.bufferSubData(m.ARRAY_BUFFER,0,f.arrayBuffer)}enableAttributes(f,m){for(let b=0;b<this.attributes.length;b++){const x=m.attributes[this.attributes[b].name];x!==void 0&&f.enableVertexAttribArray(x)}}setVertexAttribPointers(f,m,b){for(let x=0;x<this.attributes.length;x++){const T=this.attributes[x],P=m.attributes[T.name];P!==void 0&&f.vertexAttribPointer(P,T.components,f[jt[T.type]],!1,this.itemSize,T.offset+this.itemSize*(b||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class qe{constructor(f){this.gl=f.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(f){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class yr extends qe{getDefault(){return a.Color.transparent}set(f){const m=this.current;(f.r!==m.r||f.g!==m.g||f.b!==m.b||f.a!==m.a||this.dirty)&&(this.gl.clearColor(f.r,f.g,f.b,f.a),this.current=f,this.dirty=!1)}}class Ar extends qe{getDefault(){return 1}set(f){(f!==this.current||this.dirty)&&(this.gl.clearDepth(f),this.current=f,this.dirty=!1)}}class wr extends qe{getDefault(){return 0}set(f){(f!==this.current||this.dirty)&&(this.gl.clearStencil(f),this.current=f,this.dirty=!1)}}class vr extends qe{getDefault(){return[!0,!0,!0,!0]}set(f){const m=this.current;(f[0]!==m[0]||f[1]!==m[1]||f[2]!==m[2]||f[3]!==m[3]||this.dirty)&&(this.gl.colorMask(f[0],f[1],f[2],f[3]),this.current=f,this.dirty=!1)}}class Cr extends qe{getDefault(){return!0}set(f){(f!==this.current||this.dirty)&&(this.gl.depthMask(f),this.current=f,this.dirty=!1)}}class se extends qe{getDefault(){return 255}set(f){(f!==this.current||this.dirty)&&(this.gl.stencilMask(f),this.current=f,this.dirty=!1)}}class ye extends qe{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(f){const m=this.current;(f.func!==m.func||f.ref!==m.ref||f.mask!==m.mask||this.dirty)&&(this.gl.stencilFunc(f.func,f.ref,f.mask),this.current=f,this.dirty=!1)}}class Ee extends qe{getDefault(){const f=this.gl;return[f.KEEP,f.KEEP,f.KEEP]}set(f){const m=this.current;(f[0]!==m[0]||f[1]!==m[1]||f[2]!==m[2]||this.dirty)&&(this.gl.stencilOp(f[0],f[1],f[2]),this.current=f,this.dirty=!1)}}class Ye extends qe{getDefault(){return!1}set(f){if(f===this.current&&!this.dirty)return;const m=this.gl;f?m.enable(m.STENCIL_TEST):m.disable(m.STENCIL_TEST),this.current=f,this.dirty=!1}}class je extends qe{getDefault(){return[0,1]}set(f){const m=this.current;(f[0]!==m[0]||f[1]!==m[1]||this.dirty)&&(this.gl.depthRange(f[0],f[1]),this.current=f,this.dirty=!1)}}class tt extends qe{getDefault(){return!1}set(f){if(f===this.current&&!this.dirty)return;const m=this.gl;f?m.enable(m.DEPTH_TEST):m.disable(m.DEPTH_TEST),this.current=f,this.dirty=!1}}class Ue extends qe{getDefault(){return this.gl.LESS}set(f){(f!==this.current||this.dirty)&&(this.gl.depthFunc(f),this.current=f,this.dirty=!1)}}class Ve extends qe{getDefault(){return!1}set(f){if(f===this.current&&!this.dirty)return;const m=this.gl;f?m.enable(m.BLEND):m.disable(m.BLEND),this.current=f,this.dirty=!1}}class at extends qe{getDefault(){const f=this.gl;return[f.ONE,f.ZERO]}set(f){const m=this.current;(f[0]!==m[0]||f[1]!==m[1]||this.dirty)&&(this.gl.blendFunc(f[0],f[1]),this.current=f,this.dirty=!1)}}class et extends qe{getDefault(){return a.Color.transparent}set(f){const m=this.current;(f.r!==m.r||f.g!==m.g||f.b!==m.b||f.a!==m.a||this.dirty)&&(this.gl.blendColor(f.r,f.g,f.b,f.a),this.current=f,this.dirty=!1)}}class mt extends qe{getDefault(){return this.gl.FUNC_ADD}set(f){(f!==this.current||this.dirty)&&(this.gl.blendEquation(f),this.current=f,this.dirty=!1)}}class Ht extends qe{getDefault(){return!1}set(f){if(f===this.current&&!this.dirty)return;const m=this.gl;f?m.enable(m.CULL_FACE):m.disable(m.CULL_FACE),this.current=f,this.dirty=!1}}class or extends qe{getDefault(){return this.gl.BACK}set(f){(f!==this.current||this.dirty)&&(this.gl.cullFace(f),this.current=f,this.dirty=!1)}}class fr extends qe{getDefault(){return this.gl.CCW}set(f){(f!==this.current||this.dirty)&&(this.gl.frontFace(f),this.current=f,this.dirty=!1)}}class Ir extends qe{getDefault(){return null}set(f){(f!==this.current||this.dirty)&&(this.gl.useProgram(f),this.current=f,this.dirty=!1)}}class Ur extends qe{getDefault(){return this.gl.TEXTURE0}set(f){(f!==this.current||this.dirty)&&(this.gl.activeTexture(f),this.current=f,this.dirty=!1)}}class _n extends qe{getDefault(){const f=this.gl;return[0,0,f.drawingBufferWidth,f.drawingBufferHeight]}set(f){const m=this.current;(f[0]!==m[0]||f[1]!==m[1]||f[2]!==m[2]||f[3]!==m[3]||this.dirty)&&(this.gl.viewport(f[0],f[1],f[2],f[3]),this.current=f,this.dirty=!1)}}class $r extends qe{getDefault(){return null}set(f){if(f===this.current&&!this.dirty)return;const m=this.gl;m.bindFramebuffer(m.FRAMEBUFFER,f),this.current=f,this.dirty=!1}}class Mr extends qe{getDefault(){return null}set(f){if(f===this.current&&!this.dirty)return;const m=this.gl;m.bindRenderbuffer(m.RENDERBUFFER,f),this.current=f,this.dirty=!1}}class ln extends qe{getDefault(){return null}set(f){if(f===this.current&&!this.dirty)return;const m=this.gl;m.bindTexture(m.TEXTURE_2D,f),this.current=f,this.dirty=!1}}class an extends qe{getDefault(){return null}set(f){if(f===this.current&&!this.dirty)return;const m=this.gl;m.bindBuffer(m.ARRAY_BUFFER,f),this.current=f,this.dirty=!1}}class Hr extends qe{getDefault(){return null}set(f){const m=this.gl;m.bindBuffer(m.ELEMENT_ARRAY_BUFFER,f),this.current=f,this.dirty=!1}}class Fr extends qe{constructor(f){super(f),this.vao=f.extVertexArrayObject}getDefault(){return null}set(f){this.vao&&(f!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(f),this.current=f,this.dirty=!1)}}class rn extends qe{getDefault(){return 4}set(f){if(f===this.current&&!this.dirty)return;const m=this.gl;m.pixelStorei(m.UNPACK_ALIGNMENT,f),this.current=f,this.dirty=!1}}class ri extends qe{getDefault(){return!1}set(f){if(f===this.current&&!this.dirty)return;const m=this.gl;m.pixelStorei(m.UNPACK_PREMULTIPLY_ALPHA_WEBGL,f),this.current=f,this.dirty=!1}}class En extends qe{getDefault(){return!1}set(f){if(f===this.current&&!this.dirty)return;const m=this.gl;m.pixelStorei(m.UNPACK_FLIP_Y_WEBGL,f),this.current=f,this.dirty=!1}}class un extends qe{constructor(f,m){super(f),this.context=f,this.parent=m}getDefault(){return null}}class zr extends un{setDirty(){this.dirty=!0}set(f){if(f===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const m=this.gl;m.framebufferTexture2D(m.FRAMEBUFFER,m.COLOR_ATTACHMENT0,m.TEXTURE_2D,f,0),this.current=f,this.dirty=!1}}class bo extends un{attachment(){return this.gl.DEPTH_ATTACHMENT}set(f){if(f===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const m=this.gl;m.framebufferRenderbuffer(m.FRAMEBUFFER,this.attachment(),m.RENDERBUFFER,f),this.current=f,this.dirty=!1}}class aa extends bo{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class zo{constructor(f,m,b,x){this.context=f,this.width=m,this.height=b;const T=this.framebuffer=f.gl.createFramebuffer();this.colorAttachment=new zr(f,T),x&&(this.depthAttachment=new bo(f,T))}destroy(){const f=this.context.gl,m=this.colorAttachment.get();if(m&&f.deleteTexture(m),this.depthAttachment){const b=this.depthAttachment.get();b&&f.deleteRenderbuffer(b)}f.deleteFramebuffer(this.framebuffer)}}class pe{constructor(f,m=!1){if(this.gl=f,this.isWebGL2=m,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),m){const b=f;this.extVertexArrayObject={createVertexArrayOES:b.createVertexArray.bind(f),deleteVertexArrayOES:b.deleteVertexArray.bind(f),bindVertexArrayOES:b.bindVertexArray.bind(f)}}this.clearColor=new yr(this),this.clearDepth=new Ar(this),this.clearStencil=new wr(this),this.colorMask=new vr(this),this.depthMask=new Cr(this),this.stencilMask=new se(this),this.stencilFunc=new ye(this),this.stencilOp=new Ee(this),this.stencilTest=new Ye(this),this.depthRange=new je(this),this.depthTest=new tt(this),this.depthFunc=new Ue(this),this.blend=new Ve(this),this.blendFunc=new at(this),this.blendColor=new et(this),this.blendEquation=new mt(this),this.cullFace=new Ht(this),this.cullFaceSide=new or(this),this.frontFace=new fr(this),this.program=new Ir(this),this.activeTexture=new Ur(this),this.viewport=new _n(this),this.bindFramebuffer=new $r(this),this.bindRenderbuffer=new Mr(this),this.bindTexture=new ln(this),this.bindVertexBuffer=new an(this),this.bindElementBuffer=new Hr(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new Fr(this),this.pixelStoreUnpack=new rn(this),this.pixelStoreUnpackPremultiplyAlpha=new ri(this),this.pixelStoreUnpackFlipY=new En(this),this.extTextureFilterAnisotropic=f.getExtension("EXT_texture_filter_anisotropic")||f.getExtension("MOZ_EXT_texture_filter_anisotropic")||f.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=f.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extStandardDerivativesForceOff=!1,this.extDebugRendererInfo=f.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=f.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=f.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),m||(this.extTextureHalfFloat=f.getExtension("OES_texture_half_float")),(m||this.extTextureHalfFloat&&f.getExtension("OES_texture_half_float_linear"))&&(this.extRenderToTextureHalfFloat=f.getExtension("EXT_color_buffer_half_float")),this.extStandardDerivatives=m||f.getExtension("OES_standard_derivatives"),this.extTimerQuery=f.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=f.getParameter(f.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(f,m){return new Xt(this,f,m)}createVertexBuffer(f,m,b){return new Kt(this,f,m,b)}createRenderbuffer(f,m,b){const x=this.gl,T=x.createRenderbuffer();return this.bindRenderbuffer.set(T),x.renderbufferStorage(x.RENDERBUFFER,f,m,b),this.bindRenderbuffer.set(null),T}createFramebuffer(f,m,b){return new zo(this,f,m,b)}clear({color:f,depth:m,stencil:b}){const x=this.gl;let T=0;f&&(T|=x.COLOR_BUFFER_BIT,this.clearColor.set(f),this.colorMask.set([!0,!0,!0,!0])),m!==void 0&&(T|=x.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(m),this.depthMask.set(!0)),b!==void 0&&(T|=x.STENCIL_BUFFER_BIT,this.clearStencil.set(b),this.stencilMask.set(255)),x.clear(T)}setCullFace(f){f.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(f.mode),this.frontFace.set(f.frontFace))}setDepthMode(f){f.func!==this.gl.ALWAYS||f.mask?(this.depthTest.set(!0),this.depthFunc.set(f.func),this.depthMask.set(f.mask),this.depthRange.set(f.range)):this.depthTest.set(!1)}setStencilMode(f){f.test.func!==this.gl.ALWAYS||f.mask?(this.stencilTest.set(!0),this.stencilMask.set(f.mask),this.stencilOp.set([f.fail,f.depthFail,f.pass]),this.stencilFunc.set({func:f.test.func,ref:f.ref,mask:f.test.mask})):this.stencilTest.set(!1)}setColorMode(f){h(f.blendFunction,a.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(f.blendFunction),this.blendColor.set(f.blendColor)),this.colorMask.set(f.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class Z extends a.Evented{constructor(f,m,b,x){if(super(),this.id=f,this.dispatcher=b,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,a.extend(this,a.pick(m,["url","scheme","tileSize","promoteId"])),this._options=a.extend({type:"vector"},m),this._collectResourceTiming=m.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(x),this._tileWorkers={},this._deduped=new a.DedupedRequest}load(f){this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"}));const m=Array.isArray(this.map._language)?this.map._language.join():this.map._language,b=this.map._worldview;this._tileJSONRequest=St(this._options,this.map._requestManager,m,b,(x,T)=>{this._tileJSONRequest=null,this._loaded=!0,x?(m&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${m}`),b&&b.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${b}`),this.fire(new a.ErrorEvent(x))):T&&(a.extend(this,T),T.bounds&&(this.tileBounds=new Tt(T.bounds,this.minzoom,this.maxzoom)),a.postTurnstileEvent(T.tiles,this.map._requestManager._customAccessToken),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"}))),f&&f(x)})}loaded(){return this._loaded}hasTile(f){return!this.tileBounds||this.tileBounds.contains(f.canonical)}onAdd(f){this.map=f,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(f){return this._options.tiles=f,this.reload(),this}setUrl(f){return this.url=f,this._options.url=f,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return a.extend({},this._options)}loadTile(f,m){const b=this.map._requestManager.normalizeTileURL(f.tileID.canonical.url(this.tiles,this.scheme)),x={request:this.map._requestManager.transformRequest(b,a.ResourceType.Tile),data:void 0,uid:f.uid,tileID:f.tileID,tileZoom:f.tileZoom,zoom:f.tileID.overscaledZ,tileSize:this.tileSize*f.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:a.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:f.isSymbolTile};if(x.request.collectResourceTiming=this._collectResourceTiming,f.actor&&f.state!=="expired")f.state==="loading"?f.reloadCallback=m:f.request=f.actor.send("reloadTile",x,T.bind(this));else if(f.actor=this._tileWorkers[b]=this._tileWorkers[b]||this.dispatcher.getActor(),this.dispatcher.ready)f.request=f.actor.send("loadTile",x,T.bind(this),void 0,!0);else{const P=a.loadVectorTile.call({deduped:this._deduped},x,(I,L)=>{I||!L?T.call(this,I):(x.data={cacheControl:L.cacheControl,expires:L.expires,rawData:L.rawData.slice(0)},f.actor&&f.actor.send("loadTile",x,T.bind(this),void 0,!0))},!0);f.request={cancel:P}}function T(P,I){return delete f.request,f.aborted?m(null):P&&P.status!==404?m(P):(I&&I.resourceTiming&&(f.resourceTiming=I.resourceTiming),this.map._refreshExpiredTiles&&I&&f.setExpiryData(I),f.loadVectorData(I,this.map.painter),a.cacheEntryPossiblyAdded(this.dispatcher),m(null),void(f.reloadCallback&&(this.loadTile(f,f.reloadCallback),f.reloadCallback=null)))}}abortTile(f){f.request&&(f.request.cancel(),delete f.request),f.actor&&f.actor.send("abortTile",{uid:f.uid,type:this.type,source:this.id})}unloadTile(f){f.unloadVectorData(),f.actor&&f.actor.send("removeTile",{uid:f.uid,type:this.type,source:this.id})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class ee extends a.Evented{constructor(f,m,b,x){super(),this.id=f,this.dispatcher=b,this.setEventedParent(x),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=a.extend({type:"raster"},m),a.extend(this,a.pick(m,["url","scheme","tileSize"]))}load(f){this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=St(this._options,this.map._requestManager,null,null,(m,b)=>{this._tileJSONRequest=null,this._loaded=!0,m?this.fire(new a.ErrorEvent(m)):b&&(a.extend(this,b),b.bounds&&(this.tileBounds=new Tt(b.bounds,this.minzoom,this.maxzoom)),a.postTurnstileEvent(b.tiles),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"}))),f&&f(m)})}loaded(){return this._loaded}onAdd(f){this.map=f,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(f){return this._options.tiles=f,this.reload(),this}setUrl(f){return this.url=f,this._options.url=f,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return a.extend({},this._options)}hasTile(f){return!this.tileBounds||this.tileBounds.contains(f.canonical)}loadTile(f,m){const b=a.exported.devicePixelRatio>=2,x=this.map._requestManager.normalizeTileURL(f.tileID.canonical.url(this.tiles,this.scheme),b,this.tileSize);f.request=a.getImage(this.map._requestManager.transformRequest(x,a.ResourceType.Tile),(T,P,I,L)=>(delete f.request,f.aborted?(f.state="unloaded",m(null)):T?(f.state="errored",m(T)):P?(this.map._refreshExpiredTiles&&f.setExpiryData({cacheControl:I,expires:L}),f.setTexture(P,this.map.painter),f.state="loaded",a.cacheEntryPossiblyAdded(this.dispatcher),void m(null)):m(null)))}static loadTileData(f,m,b){f.setTexture(m,b)}static unloadTileData(f,m){f.texture&&m.saveTileTexture(f.texture)}abortTile(f,m){f.request&&(f.request.cancel(),delete f.request),m()}unloadTile(f,m){f.texture&&this.map.painter.saveTileTexture(f.texture),m()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}let fe;function we(v,f,m,b,x,T,P,I){const L=[v,m,x,f,b,T,1,1,1],V=[P,I,1],H=a.adjoint([],L),[X,ne,ae]=a.transformMat3(V,V,a.transpose(H,H));return a.multiply$1(L,[X,0,0,0,ne,0,0,0,ae],L)}class De extends a.Evented{constructor(f,m,b,x){super(),this.id=f,this.dispatcher=b,this.coordinates=m.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(x),this.options=m,this._dirty=!1}load(f,m){this._loaded=m||!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this.url=this.options.url,this._imageRequest=a.getImage(this.map._requestManager.transformRequest(this.url,a.ResourceType.Image),(b,x)=>{if(this._imageRequest=null,this._loaded=!0,b)this.fire(new a.ErrorEvent(b));else if(x){const{HTMLImageElement:T}=a.window;this.image=x instanceof T?a.exported.getImageData(x):x,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,f&&(this.coordinates=f),this._finishLoading()}})}loaded(){return this._loaded}updateImage(f){return this.image&&f.url?(this._imageRequest&&f.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=f.url,this.load(f.coordinates,this._loaded),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(f){this.map=f,this.load()}onRemove(){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),this.texture&&this.texture.destroy()}setCoordinates(f){this.coordinates=f,this._boundsArray=void 0;const m=f.map(a.MercatorCoordinate.fromLngLat);return this.tileID=function(b){let x=1/0,T=1/0,P=-1/0,I=-1/0;for(const X of b)x=Math.min(x,X.x),T=Math.min(T,X.y),P=Math.max(P,X.x),I=Math.max(I,X.y);const L=Math.max(P-x,I-T),V=Math.max(0,Math.floor(-Math.log(L)/Math.LN2)),H=Math.pow(2,V);return new a.CanonicalTileID(V,Math.floor((x+P)/2*H),Math.floor((T+I)/2*H))}(m),this.minzoom=this.maxzoom=this.tileID.z,this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0}_prepareData(f){for(const L in this.tiles){const V=this.tiles[L];V.state!=="loaded"&&(V.state="loaded",V.texture=this.texture)}if(this._boundsArray)return;const m=a.tileTransform(this.tileID,this.map.transform.projection),[b,x,T,P]=this.coordinates.map(L=>{const V=m.projection.project(L[0],L[1]);return a.getTilePoint(m,V)._round()});this.perspectiveTransform=function(L,V,H,X,ne,ae,le,ue,ce,te){const _e=we(0,0,L,0,0,V,L,V),ve=we(H,X,ne,ae,le,ue,ce,te);return a.multiply$1(ve,a.adjoint(_e,_e),ve),[ve[6]/ve[8]*L/a.EXTENT,ve[7]/ve[8]*V/a.EXTENT]}(this.width,this.height,b.x,b.y,x.x,x.y,P.x,P.y,T.x,T.y);const I=this._boundsArray=new a.StructArrayLayout4i8;I.emplaceBack(b.x,b.y,0,0),I.emplaceBack(x.x,x.y,a.EXTENT,0),I.emplaceBack(P.x,P.y,0,a.EXTENT),I.emplaceBack(T.x,T.y,a.EXTENT,a.EXTENT),this.boundsBuffer&&this.boundsBuffer.destroy(),this.boundsBuffer=f.createVertexBuffer(I,a.boundsAttributes.members),this.boundsSegments=a.SegmentVector.simpleSegment(0,0,4,2)}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const f=this.map.painter.context,m=f.gl;this._dirty&&(this.texture?this.texture.update(this.image):(this.texture=new a.Texture(f,this.image,m.RGBA),this.texture.bind(m.LINEAR,m.CLAMP_TO_EDGE)),this._dirty=!1),this._prepareData(f)}loadTile(f,m){this.tileID&&this.tileID.equals(f.tileID.canonical)?(this.tiles[String(f.tileID.wrap)]=f,f.buckets={},m(null)):(f.state="errored",m(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}const Xe={vector:Z,raster:ee,"raster-dem":class extends ee{constructor(v,f,m,b){super(v,f,m,b),this.type="raster-dem",this.maxzoom=22,this._options=a.extend({type:"raster-dem"},f),this.encoding=f.encoding||"mapbox"}loadTile(v,f){const m=this.map._requestManager.normalizeTileURL(v.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function b(x,T){x&&(v.state="errored",f(x)),T&&(v.dem=T,v.dem.onDeserialize(),v.needsHillshadePrepare=!0,v.needsDEMTextureUpload=!0,v.state="loaded",f(null))}v.request=a.getImage(this.map._requestManager.transformRequest(m,a.ResourceType.Tile),function(x,T,P,I){if(delete v.request,v.aborted)v.state="unloaded",f(null);else if(x)v.state="errored",f(x);else if(T){this.map._refreshExpiredTiles&&v.setExpiryData({cacheControl:P,expires:I});const L=a.window.ImageBitmap&&T instanceof a.window.ImageBitmap&&(fe==null&&(fe=a.window.OffscreenCanvas&&new a.window.OffscreenCanvas(1,1).getContext("2d")&&typeof a.window.createImageBitmap=="function"),fe),V=1-(T.width-a.prevPowerOfTwo(T.width))/2;V<1||v.neighboringTiles||(v.neighboringTiles=this._getNeighboringTiles(v.tileID));const H=L?T:a.exported.getImageData(T,V),X={uid:v.uid,coord:v.tileID,source:this.id,rawImageData:H,encoding:this.encoding,padding:V};v.actor&&v.state!=="expired"||(v.actor=this.dispatcher.getActor(),v.actor.send("loadDEMTile",X,b.bind(this),void 0,!0))}}.bind(this))}_getNeighboringTiles(v){const f=v.canonical,m=Math.pow(2,f.z),b=(f.x-1+m)%m,x=f.x===0?v.wrap-1:v.wrap,T=(f.x+1+m)%m,P=f.x+1===m?v.wrap+1:v.wrap,I={};return I[new a.OverscaledTileID(v.overscaledZ,x,f.z,b,f.y).key]={backfilled:!1},I[new a.OverscaledTileID(v.overscaledZ,P,f.z,T,f.y).key]={backfilled:!1},f.y>0&&(I[new a.OverscaledTileID(v.overscaledZ,x,f.z,b,f.y-1).key]={backfilled:!1},I[new a.OverscaledTileID(v.overscaledZ,v.wrap,f.z,f.x,f.y-1).key]={backfilled:!1},I[new a.OverscaledTileID(v.overscaledZ,P,f.z,T,f.y-1).key]={backfilled:!1}),f.y+1<m&&(I[new a.OverscaledTileID(v.overscaledZ,x,f.z,b,f.y+1).key]={backfilled:!1},I[new a.OverscaledTileID(v.overscaledZ,v.wrap,f.z,f.x,f.y+1).key]={backfilled:!1},I[new a.OverscaledTileID(v.overscaledZ,P,f.z,T,f.y+1).key]={backfilled:!1}),I}unloadTile(v){v.demTexture&&this.map.painter.saveTileTexture(v.demTexture),v.fbo&&(v.fbo.destroy(),delete v.fbo),v.dem&&delete v.dem,delete v.neighboringTiles,v.state="unloaded"}},geojson:class extends a.Evented{constructor(v,f,m,b){super(),this.id=v,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=m.getActor(),this.setEventedParent(b),this._data=f.data,this._options=a.extend({},f),this._collectResourceTiming=f.collectResourceTiming,f.maxzoom!==void 0&&(this.maxzoom=f.maxzoom),f.type&&(this.type=f.type),f.attribution&&(this.attribution=f.attribution),this.promoteId=f.promoteId;const x=a.EXTENT/this.tileSize;this.workerOptions=a.extend({source:this.id,cluster:f.cluster||!1,geojsonVtOptions:{buffer:(f.buffer!==void 0?f.buffer:128)*x,tolerance:(f.tolerance!==void 0?f.tolerance:.375)*x,extent:a.EXTENT,maxZoom:this.maxzoom,lineMetrics:f.lineMetrics||!1,generateId:f.generateId||!1},superclusterOptions:{maxZoom:f.clusterMaxZoom!==void 0?f.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,f.clusterMinPoints||2),extent:a.EXTENT,radius:(f.clusterRadius!==void 0?f.clusterRadius:50)*x,log:!1,generateId:f.generateId||!1},clusterProperties:f.clusterProperties,filter:f.filter},f.workerOptions)}onAdd(v){this.map=v,this.setData(this._data)}setData(v){return this._data=v,this._updateWorkerData(),this}getClusterExpansionZoom(v,f){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:v,source:this.id},f),this}getClusterChildren(v,f){return this.actor.send("geojson.getClusterChildren",{clusterId:v,source:this.id},f),this}getClusterLeaves(v,f,m,b){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:v,limit:f,offset:m},b),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new a.Event("dataloading",{dataType:"source"})),this._loaded=!1;const v=a.extend({},this.workerOptions),f=this._data;typeof f=="string"?(v.request=this.map._requestManager.transformRequest(a.exported.resolveURL(f),a.ResourceType.Source),v.request.collectResourceTiming=this._collectResourceTiming):v.data=JSON.stringify(f),this._pendingLoad=this.actor.send(`${this.type}.loadData`,v,(m,b)=>{if(this._loaded=!0,this._pendingLoad=null,m)this.fire(new a.ErrorEvent(m));else{const x={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&b&&b.resourceTiming&&b.resourceTiming[this.id]&&(x.resourceTiming=b.resourceTiming[this.id]),this.fire(new a.Event("data",x)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(v,f){const m=v.actor?"reloadTile":"loadTile";v.actor=this.actor,v.request=this.actor.send(m,{type:this.type,uid:v.uid,tileID:v.tileID,tileZoom:v.tileZoom,zoom:v.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:a.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(b,x)=>(delete v.request,v.unloadVectorData(),v.aborted?f(null):b?f(b):(v.loadVectorData(x,this.map.painter,m==="reloadTile"),f(null))),void 0,m==="loadTile")}abortTile(v){v.request&&(v.request.cancel(),delete v.request),v.aborted=!0}unloadTile(v){v.unloadVectorData(),this.actor.send("removeTile",{uid:v.uid,type:this.type,source:this.id})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return a.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends De{constructor(v,f,m,b){super(v,f,m,b),this.roundZoom=!0,this.type="video",this.options=f}load(){this._loaded=!1;const v=this.options;this.urls=[];for(const f of v.urls)this.urls.push(this.map._requestManager.transformRequest(f,a.ResourceType.Source).url);a.getVideo(this.urls,(f,m)=>{this._loaded=!0,f?this.fire(new a.ErrorEvent(f)):m&&(this.video=m,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(v){if(this.video){const f=this.video.seekable;v<f.start(0)||v>f.end(0)?this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${f.start(0)} and ${f.end(0)}-second mark.`))):this.video.currentTime=v}}getVideo(){return this.video}onAdd(v){this.map||(this.map=v,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const v=this.map.painter.context,f=v.gl;this.texture?this.video.paused||(this.texture.bind(f.LINEAR,f.CLAMP_TO_EDGE),f.texSubImage2D(f.TEXTURE_2D,0,0,0,f.RGBA,f.UNSIGNED_BYTE,this.video)):(this.texture=new a.Texture(v,this.video,f.RGBA),this.texture.bind(f.LINEAR,f.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(v)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:De,canvas:class extends De{constructor(v,f,m,b){super(v,f,m,b),f.coordinates?Array.isArray(f.coordinates)&&f.coordinates.length===4&&!f.coordinates.some(x=>!Array.isArray(x)||x.length!==2||x.some(T=>typeof T!="number"))||this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${v}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${v}`,null,'missing required property "coordinates"'))),f.animate&&typeof f.animate!="boolean"&&this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${v}`,null,'optional "animate" property must be a boolean value'))),f.canvas?typeof f.canvas=="string"||f.canvas instanceof a.window.HTMLCanvasElement||this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${v}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${v}`,null,'missing required property "canvas"'))),this.options=f,this.animate=f.animate===void 0||f.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof a.window.HTMLCanvasElement?this.options.canvas:a.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new a.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(v){this.map=v,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let v=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,v=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,v=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const f=this.map.painter.context;this.texture?(v||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new a.Texture(f,this.canvas,f.gl.RGBA,{premultiply:!0}),this._prepareData(f)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const v of[this.canvas.width,this.canvas.height])if(isNaN(v)||v<=0)return!0;return!1}},custom:class extends a.Evented{constructor(v,f,m,b){super(),this.id=v,this.type="custom",this._dataType="raster",this._dispatcher=m,this._implementation=f,this.setEventedParent(b),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new a.ErrorEvent(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new a.ErrorEvent(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new Tt(this._implementation.bounds,this.minzoom,this.maxzoom)),f.update=this._update.bind(this),f.clearTiles=this._clearTiles.bind(this),f.coveringTiles=this._coveringTiles.bind(this),a.extend(this,a.pick(f,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return a.pick(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(v){this._map=v,this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(v),this.load()}onRemove(v){this._implementation.onRemove&&this._implementation.onRemove(v)}hasTile(v){if(this._implementation.hasTile){const{x:f,y:m,z:b}=v.canonical;return this._implementation.hasTile({x:f,y:m,z:b})}return!this.tileBounds||this.tileBounds.contains(v.canonical)}loadTile(v,f){const{x:m,y:b,z:x}=v.tileID.canonical,T=new a.window.AbortController;v.request=Promise.resolve(this._implementation.loadTile({x:m,y:b,z:x},{signal:T.signal})).then(function(P){return delete v.request,v.aborted?(v.state="unloaded",f(null)):P===void 0?(v.state="errored",f(null)):P===null?(this.loadTileData(v,{width:this.tileSize,height:this.tileSize,data:null}),v.state="loaded",f(null)):function(I){return I instanceof a.window.ImageData||I instanceof a.window.HTMLCanvasElement||I instanceof a.window.ImageBitmap||I instanceof a.window.HTMLImageElement}(P)?(this.loadTileData(v,P),v.state="loaded",void f(null)):(v.state="errored",f(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}.bind(this)).catch(P=>{P.code!==20&&(v.state="errored",f(P))}),v.request.cancel=()=>T.abort()}loadTileData(v,f){ee.loadTileData(v,f,this._map.painter)}unloadTileData(v){ee.unloadTileData(v,this._map.painter)}unloadTile(v,f){if(this.unloadTileData(v),this._implementation.unloadTile){const{x:m,y:b,z:x}=v.tileID.canonical;this._implementation.unloadTile({x:m,y:b,z:x})}f()}abortTile(v,f){v.request&&v.request.cancel&&(v.request.cancel(),delete v.request),f()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(v=>({x:v.canonical.x,y:v.canonical.y,z:v.canonical.z}))}_clearTiles(){this._map.style._clearSource(this.id)}_update(){this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"}))}}},Ge=function(v,f,m,b){const x=new Xe[f.type](v,f,m,b);if(x.id!==v)throw new Error(`Expected Source id to be ${v} instead of ${x.id}`);return a.bindAll(["load","abort","unload","serialize","prepare"],x),x};function Ne(v,f){const m=a.identity([]);return a.scale(m,m,[.5*v.width,.5*-v.height,1]),a.translate(m,m,[1,-1,0]),a.multiply(m,m,v.calculateProjMatrix(f.toUnwrapped())),Float32Array.from(m)}function nt(v,f,m,b,x,T,P,I=!1){const L=v.tilesIn(b,P,I);L.sort(Qt);const V=[];for(const X of L)V.push({wrappedTileID:X.tile.tileID.wrapped().key,queryResults:X.tile.queryRenderedFeatures(f,m,v._state,X,x,T,Ne(v.transform,X.tile.tileID),I)});const H=function(X){const ne={},ae={};for(const le of X){const ue=le.queryResults,ce=le.wrappedTileID,te=ae[ce]=ae[ce]||{};for(const _e in ue){const ve=ue[_e],be=te[_e]=te[_e]||{},$e=ne[_e]=ne[_e]||[];for(const Ae of ve)be[Ae.featureIndex]||(be[Ae.featureIndex]=!0,$e.push(Ae))}}return ne}(V);for(const X in H)H[X].forEach(ne=>{const ae=ne.feature,le=ae.layer;le&&le.type!=="background"&&le.type!=="sky"&&(ae.source=le.source,le["source-layer"]&&(ae.sourceLayer=le["source-layer"]),ae.state=ae.id!==void 0?v.getFeatureState(le["source-layer"],ae.id):{})});return H}function kt(v,f){const m=v.getRenderableIds().map(T=>v.getTileByID(T)),b=[],x={};for(let T=0;T<m.length;T++){const P=m[T],I=P.tileID.canonical.key;x[I]||(x[I]=!0,P.querySourceFeatures(b,f))}return b}function Qt(v,f){const m=v.tileID,b=f.tileID;return m.overscaledZ-b.overscaledZ||m.canonical.y-b.canonical.y||m.wrap-b.wrap||m.canonical.x-b.canonical.x}function Nt(){return Rd.workerClass!=null?new Rd.workerClass:new a.window.Worker(Rd.workerUrl)}const Sr="mapboxgl_preloaded_worker_pool";class It{constructor(){this.active={}}acquire(f){if(!this.workers)for(this.workers=[];this.workers.length<It.workerCount;)this.workers.push(new Nt);return this.active[f]=!0,this.workers.slice()}release(f){delete this.active[f],this.numActive()===0&&(this.workers.forEach(m=>{m.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Sr]}numActive(){return Object.keys(this.active).length}}let Re;function bt(){return Re||(Re=new It),Re}function Dt(v,f){const m={};for(const b in v)b!=="ref"&&(m[b]=v[b]);return a.refProperties.forEach(b=>{b in f&&(m[b]=f[b])}),m}function mr(v){v=v.slice();const f=Object.create(null);for(let m=0;m<v.length;m++)f[v[m].id]=v[m];for(let m=0;m<v.length;m++)"ref"in v[m]&&(v[m]=Dt(v[m],f[v[m].ref]));return v}It.workerCount=2;const sr={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setProjection:"setProjection"};function Br(v,f,m){m.push({command:sr.addSource,args:[v,f[v]]})}function Nr(v,f,m){f.push({command:sr.removeSource,args:[v]}),m[v]=!0}function sa(v,f,m,b){Nr(v,m,b),Br(v,f,m)}function Kn(v,f,m){let b;for(b in v[m])if(v[m].hasOwnProperty(b)&&b!=="data"&&!h(v[m][b],f[m][b]))return!1;for(b in f[m])if(f[m].hasOwnProperty(b)&&b!=="data"&&!h(v[m][b],f[m][b]))return!1;return!0}function wt(v,f,m,b,x,T){let P;for(P in f=f||{},v=v||{})v.hasOwnProperty(P)&&(h(v[P],f[P])||m.push({command:T,args:[b,P,f[P],x]}));for(P in f)f.hasOwnProperty(P)&&!v.hasOwnProperty(P)&&(h(v[P],f[P])||m.push({command:T,args:[b,P,f[P],x]}))}function Ta(v){return v.id}function Si(v,f){return v[f.id]=f,v}class $l{constructor(f,m){this.reset(f,m)}reset(f,m){this.points=f||[],this._distances=[0];for(let b=1;b<this.points.length;b++)this._distances[b]=this._distances[b-1]+this.points[b].dist(this.points[b-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(m||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(f){if(this.points.length===1)return this.points[0];f=a.clamp(f,0,1);let m=1,b=this._distances[m];const x=f*this.paddedLength+this.padding;for(;b<x&&m<this._distances.length;)b=this._distances[++m];const T=m-1,P=this._distances[T],I=b-P,L=I>0?(x-P)/I:0;return this.points[T].mult(1-L).add(this.points[m].mult(L))}}class LE{constructor(f,m,b){const x=this.boxCells=[],T=this.circleCells=[];this.xCellCount=Math.ceil(f/b),this.yCellCount=Math.ceil(m/b);for(let P=0;P<this.xCellCount*this.yCellCount;P++)x.push([]),T.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=f,this.height=m,this.xScale=this.xCellCount/f,this.yScale=this.yCellCount/m,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(f,m,b,x,T){this._forEachCell(m,b,x,T,this._insertBoxCell,this.boxUid++),this.boxKeys.push(f),this.bboxes.push(m),this.bboxes.push(b),this.bboxes.push(x),this.bboxes.push(T)}insertCircle(f,m,b,x){this._forEachCell(m-x,b-x,m+x,b+x,this._insertCircleCell,this.circleUid++),this.circleKeys.push(f),this.circles.push(m),this.circles.push(b),this.circles.push(x)}_insertBoxCell(f,m,b,x,T,P){this.boxCells[T].push(P)}_insertCircleCell(f,m,b,x,T,P){this.circleCells[T].push(P)}_query(f,m,b,x,T,P){if(b<0||f>this.width||x<0||m>this.height)return!T&&[];const I=[];if(f<=0&&m<=0&&this.width<=b&&this.height<=x){if(T)return!0;for(let L=0;L<this.boxKeys.length;L++)I.push({key:this.boxKeys[L],x1:this.bboxes[4*L],y1:this.bboxes[4*L+1],x2:this.bboxes[4*L+2],y2:this.bboxes[4*L+3]});for(let L=0;L<this.circleKeys.length;L++){const V=this.circles[3*L],H=this.circles[3*L+1],X=this.circles[3*L+2];I.push({key:this.circleKeys[L],x1:V-X,y1:H-X,x2:V+X,y2:H+X})}return P?I.filter(P):I}return this._forEachCell(f,m,b,x,this._queryCell,I,{hitTest:T,seenUids:{box:{},circle:{}}},P),T?I.length>0:I}_queryCircle(f,m,b,x,T){const P=f-b,I=f+b,L=m-b,V=m+b;if(I<0||P>this.width||V<0||L>this.height)return!x&&[];const H=[];return this._forEachCell(P,L,I,V,this._queryCellCircle,H,{hitTest:x,circle:{x:f,y:m,radius:b},seenUids:{box:{},circle:{}}},T),x?H.length>0:H}query(f,m,b,x,T){return this._query(f,m,b,x,!1,T)}hitTest(f,m,b,x,T){return this._query(f,m,b,x,!0,T)}hitTestCircle(f,m,b,x){return this._queryCircle(f,m,b,!0,x)}_queryCell(f,m,b,x,T,P,I,L){const V=I.seenUids,H=this.boxCells[T];if(H!==null){const ne=this.bboxes;for(const ae of H)if(!V.box[ae]){V.box[ae]=!0;const le=4*ae;if(f<=ne[le+2]&&m<=ne[le+3]&&b>=ne[le+0]&&x>=ne[le+1]&&(!L||L(this.boxKeys[ae]))){if(I.hitTest)return P.push(!0),!0;P.push({key:this.boxKeys[ae],x1:ne[le],y1:ne[le+1],x2:ne[le+2],y2:ne[le+3]})}}}const X=this.circleCells[T];if(X!==null){const ne=this.circles;for(const ae of X)if(!V.circle[ae]){V.circle[ae]=!0;const le=3*ae;if(this._circleAndRectCollide(ne[le],ne[le+1],ne[le+2],f,m,b,x)&&(!L||L(this.circleKeys[ae]))){if(I.hitTest)return P.push(!0),!0;{const ue=ne[le],ce=ne[le+1],te=ne[le+2];P.push({key:this.circleKeys[ae],x1:ue-te,y1:ce-te,x2:ue+te,y2:ce+te})}}}}}_queryCellCircle(f,m,b,x,T,P,I,L){const V=I.circle,H=I.seenUids,X=this.boxCells[T];if(X!==null){const ae=this.bboxes;for(const le of X)if(!H.box[le]){H.box[le]=!0;const ue=4*le;if(this._circleAndRectCollide(V.x,V.y,V.radius,ae[ue+0],ae[ue+1],ae[ue+2],ae[ue+3])&&(!L||L(this.boxKeys[le])))return P.push(!0),!0}}const ne=this.circleCells[T];if(ne!==null){const ae=this.circles;for(const le of ne)if(!H.circle[le]){H.circle[le]=!0;const ue=3*le;if(this._circlesCollide(ae[ue],ae[ue+1],ae[ue+2],V.x,V.y,V.radius)&&(!L||L(this.circleKeys[le])))return P.push(!0),!0}}}_forEachCell(f,m,b,x,T,P,I,L){const V=this._convertToXCellCoord(f),H=this._convertToYCellCoord(m),X=this._convertToXCellCoord(b),ne=this._convertToYCellCoord(x);for(let ae=V;ae<=X;ae++)for(let le=H;le<=ne;le++)if(T.call(this,f,m,b,x,this.xCellCount*le+ae,P,I,L))return}_convertToXCellCoord(f){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(f*this.xScale)))}_convertToYCellCoord(f){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(f*this.yScale)))}_circlesCollide(f,m,b,x,T,P){const I=x-f,L=T-m,V=b+P;return V*V>I*I+L*L}_circleAndRectCollide(f,m,b,x,T,P,I){const L=(P-x)/2,V=Math.abs(f-(x+L));if(V>L+b)return!1;const H=(I-T)/2,X=Math.abs(m-(T+H));if(X>H+b)return!1;if(V<=L||X<=H)return!0;const ne=V-L,ae=X-H;return ne*ne+ae*ae<=b*b}}const bs=Math.tan(85*Math.PI/180);function sf(v,f,m,b,x,T,P){const I=a.create();if(m)if(T.name==="globe"){const L=a.calculateGlobeLabelMatrix(x,f);a.multiply(I,I,L)}else{const L=Le([],P);I[0]=L[0],I[1]=L[1],I[4]=L[2],I[5]=L[3],b||a.rotateZ(I,I,x.angle)}else a.multiply(I,x.labelPlaneMatrix,v);return I}function NE(v,f,m,b,x,T,P){const I=sf(v,f,m,b,x,T,P);return T.name==="globe"&&m||(I[2]=I[6]=I[10]=I[14]=0),I}function lf(v,f,m,b,x,T,P){if(m){if(T.name==="globe"){const I=sf(v,f,m,b,x,T,P);return a.invert(I,I),a.multiply(I,v,I),I}{const I=a.clone(v),L=a.identity([]);return L[0]=P[0],L[1]=P[1],L[4]=P[2],L[5]=P[3],a.multiply(I,I,L),b||a.rotateZ(I,I,-x.angle),I}}return x.glCoordMatrix}function Gt(v,f,m,b){const x=[v,f,m,1];m?a.transformMat4$1(x,x,b):BE(x,x,b);const T=x[3];return x[0]/=T,x[1]/=T,x[2]/=T,x}function nn(v,f){return Math.min(.5+v/f*.5,1.5)}function Xr(v,f){const m=v[0]/v[3],b=v[1]/v[3];return m>=-f[0]&&m<=f[0]&&b>=-f[1]&&b<=f[1]}function ws(v,f,m,b,x,T,P,I,L,V){const H=m.transform,X=b?v.textSizeData:v.iconSizeData,ne=a.evaluateSizeForZoom(X,m.transform.zoom),ae=H.projection.name==="globe",le=[256/m.width*2+1,256/m.height*2+1],ue=b?v.text.dynamicLayoutVertexArray:v.icon.dynamicLayoutVertexArray;ue.clear();let ce=null;ae&&(ce=b?v.text.globeExtVertexArray:v.icon.globeExtVertexArray);const te=v.lineVertexArray,_e=b?v.text.placedSymbolArray:v.icon.placedSymbolArray,ve=m.transform.width/m.transform.height;let be,$e=!1;for(let Ae=0;Ae<_e.length;Ae++){const Be=_e.get(Ae),{numGlyphs:Ze,writingMode:ot}=Be;if(ot!==a.WritingMode.vertical||$e||be===a.WritingMode.horizontal||($e=!0),be=ot,(Be.hidden||ot===a.WritingMode.vertical)&&!$e){Hn(Ze,ue);continue}$e=!1;const ut=new a.pointGeometry(Be.tileAnchorX,Be.tileAnchorY);let{x:zt,y:rt,z:Ot}=H.projection.projectTilePoint(ut.x,ut.y,V.canonical);if(L){const[Vr,ir,rr]=L(ut);zt+=Vr,rt+=ir,Ot+=rr}const vt=[zt,rt,Ot,1];if(a.transformMat4$1(vt,vt,f),!Xr(vt,le)){Hn(Ze,ue);continue}const Mt=nn(m.transform.cameraToCenterDistance,vt[3]),st=a.evaluateSizeForFeature(X,ne,Be),Ke=P?st/Mt:st*Mt,dt=Gt(zt,rt,Ot,x);if(dt[3]<=0){Hn(Ze,ue);continue}let Pt={};const Lt=P?null:L,cr=Qh(Be,Ke,!1,I,f,x,T,v.glyphOffsetArray,te,ue,ce,dt,ut,Pt,ve,Lt,H.projection,V,P);$e=cr.useVertical,Lt&&cr.needsFlipping&&(Pt={}),(cr.notEnoughRoom||$e||cr.needsFlipping&&Qh(Be,Ke,!0,I,f,x,T,v.glyphOffsetArray,te,ue,ce,dt,ut,Pt,ve,Lt,H.projection,V,P).notEnoughRoom)&&Hn(Ze,ue)}b?(v.text.dynamicLayoutVertexBuffer.updateData(ue),ce&&v.text.globeExtVertexBuffer.updateData(ce)):(v.icon.dynamicLayoutVertexBuffer.updateData(ue),ce&&v.icon.globeExtVertexBuffer.updateData(ce))}function Au(v,f,m,b,x,T,P,I,L,V,H,X,ne,ae,le,ue){const{lineStartIndex:ce,glyphStartIndex:te,segment:_e}=I,ve=te+I.numGlyphs,be=ce+I.lineLength,$e=f.getoffsetX(te),Ae=f.getoffsetX(ve-1),Be=Do(v*$e,m,b,x,T,P,_e,ce,be,L,V,H,X,ne,!0,ae,le,ue);if(!Be)return null;const Ze=Do(v*Ae,m,b,x,T,P,_e,ce,be,L,V,H,X,ne,!0,ae,le,ue);return Ze?{first:Be,last:Ze}:null}function Yr(v,f,m,b){return v===a.WritingMode.horizontal&&Math.abs(b)>Math.abs(m)?{useVertical:!0}:v===a.WritingMode.vertical?b>0?{needsFlipping:!0}:null:f!==0&&function(x,T){return x===0||Math.abs(T/x)>bs}(m,b)?f===1?{needsFlipping:!0}:null:m<0?{needsFlipping:!0}:null}function Qh(v,f,m,b,x,T,P,I,L,V,H,X,ne,ae,le,ue,ce,te,_e){const ve=f/24,be=v.lineOffsetX*ve,$e=v.lineOffsetY*ve,{lineStartIndex:Ae,glyphStartIndex:Be,numGlyphs:Ze,segment:ot,writingMode:ut,flipState:zt}=v,rt=Ae+v.lineLength,Ot=vt=>{if(H){const[dt,Pt,Lt]=vt.up,cr=V.length;a.updateGlobeVertexNormal(H,cr+0,dt,Pt,Lt),a.updateGlobeVertexNormal(H,cr+1,dt,Pt,Lt),a.updateGlobeVertexNormal(H,cr+2,dt,Pt,Lt),a.updateGlobeVertexNormal(H,cr+3,dt,Pt,Lt)}const[Mt,st,Ke]=vt.point;a.addDynamicAttributes(V,Mt,st,Ke,vt.angle)};if(Ze>1){const vt=Au(ve,I,be,$e,m,X,ne,v,L,T,ae,ue,!1,ce,te,_e);if(!vt)return{notEnoughRoom:!0};if(b&&!m){let[Mt,st,Ke]=vt.first.point,[dt,Pt,Lt]=vt.last.point;[Mt,st]=Gt(Mt,st,Ke,P),[dt,Pt]=Gt(dt,Pt,Lt,P);const cr=Yr(ut,zt,(dt-Mt)*le,Pt-st);if(v.flipState=cr&&cr.needsFlipping?1:2,cr)return cr}Ot(vt.first);for(let Mt=Be+1;Mt<Be+Ze-1;Mt++){const st=Do(ve*I.getoffsetX(Mt),be,$e,m,X,ne,ot,Ae,rt,L,T,ae,ue,!1,!1,ce,te,_e);if(!st)return V.length-=4*(Mt-Be),{notEnoughRoom:!0};Ot(st)}Ot(vt.last)}else{if(b&&!m){const Mt=Gt(ne.x,ne.y,0,x),st=Ae+ot+1,Ke=new a.pointGeometry(L.getx(st),L.gety(st)),dt=Gt(Ke.x,Ke.y,0,x),Pt=dt[3]>0?dt:cf(ne,Ke,Mt,1,x,void 0,ce,te.canonical),Lt=Yr(ut,zt,(Pt[0]-Mt[0])*le,Pt[1]-Mt[1]);if(v.flipState=Lt&&Lt.needsFlipping?1:2,Lt)return Lt}const vt=Do(ve*I.getoffsetX(Be),be,$e,m,X,ne,ot,Ae,rt,L,T,ae,ue,!1,!1,ce,te,_e);if(!vt)return{notEnoughRoom:!0};Ot(vt)}return{}}function uf(v,f,m,b,x){const{x:T,y:P,z:I}=b.projectTilePoint(v.x,v.y,f);if(!x)return Gt(T,P,I,m);const[L,V,H]=x(v);return Gt(T+L,P+V,I+H,m)}function cf(v,f,m,b,x,T,P,I){const L=uf(v.sub(f)._unit()._add(v),I,x,P,T);return a.sub(L,m,L),a.normalize(L,L),a.scaleAndAdd(L,m,L,b)}function Do(v,f,m,b,x,T,P,I,L,V,H,X,ne,ae,le,ue,ce,te){const _e=b?v-f:v+f;let ve=_e>0?1:-1,be=0;b&&(ve*=-1,be=Math.PI),ve<0&&(be+=Math.PI);let $e=I+P+(ve>0?0:1)|0,Ae=x,Be=x,Ze=0,ot=0;const ut=Math.abs(_e),zt=[],rt=[];let Ot=T,vt=Ot;const Mt=()=>cf(vt,Ot,Be,ut-Ze+1,H,ne,ue,ce.canonical);for(;Ze+ot<=ut;){if($e+=ve,$e<I||$e>=L)return null;if(Be=Ae,vt=Ot,zt.push(Be),ae&&rt.push(vt),Ot=new a.pointGeometry(V.getx($e),V.gety($e)),Ae=X[$e],!Ae){const rr=uf(Ot,ce.canonical,H,ue,ne);Ae=rr[3]>0?X[$e]=rr:Mt()}Ze+=ot,ot=a.distance(Be,Ae)}le&&ne&&(X[$e]&&(Ae=Mt(),ot=a.distance(Be,Ae)),X[$e]=Ae);const st=(ut-Ze)/ot,Ke=Ot.sub(vt)._mult(st)._add(vt),dt=a.sub([],Ae,Be),Pt=a.scaleAndAdd([],Be,dt,st);let Lt=[0,0,1],cr=dt[0],Vr=dt[1];if(te&&(Lt=ue.upVector(ce.canonical,Ke.x,Ke.y),Lt[0]!==0||Lt[1]!==0||Lt[2]!==1)){const rr=[Lt[2],0,-Lt[0]],hr=a.cross([],Lt,rr);a.normalize(rr,rr),a.normalize(hr,hr),cr=a.dot(dt,rr),Vr=a.dot(dt,hr)}if(m){const rr=a.cross([],Lt,dt);a.normalize(rr,rr),a.scaleAndAdd(Pt,Pt,rr,m*ve)}const ir=be+Math.atan2(Vr,cr);return zt.push(Pt),ae&&rt.push(Ke),{point:Pt,angle:ir,path:zt,tilePath:rt,up:Lt}}function Hn(v,f){const m=f.length,b=m+4*v;f.resize(b),f.float32.fill(-1/0,4*m,4*b)}function BE(v,f,m){const b=f[0],x=f[1];return v[0]=m[0]*b+m[4]*x+m[12],v[1]=m[1]*b+m[5]*x+m[13],v[3]=m[3]*b+m[7]*x+m[15],v}const Ho=100;class cw{constructor(f,m,b=new LE(f.width+200,f.height+200,25),x=new LE(f.width+200,f.height+200,25)){this.transform=f,this.grid=b,this.ignoredGrid=x,this.pitchfactor=Math.cos(f._pitch)*f.cameraToCenterDistance,this.screenRightBoundary=f.width+Ho,this.screenBottomBoundary=f.height+Ho,this.gridRightBoundary=f.width+200,this.gridBottomBoundary=f.height+200,this.fogState=m}placeCollisionBox(f,m,b,x,T,P,I,L){let V=b.projectedAnchorX,H=b.projectedAnchorY,X=b.projectedAnchorZ;const ne=b.elevation,ae=b.tileID,le=f.getProjection();if(ne&&ae){const[Ae,Be,Ze]=le.upVector(ae.canonical,b.tileAnchorX,b.tileAnchorY),ot=le.upVectorScale(ae.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;V+=Ae*ne*ot,H+=Be*ne*ot,X+=Ze*ne*ot}const ue=this.projectAndGetPerspectiveRatio(I,V,H,X,b.tileID,le.name==="globe"||!!ne||this.transform.pitch>0,le),ce=P*ue.perspectiveRatio,te=(b.x1*m+x.x-b.padding)*ce+ue.point.x,_e=(b.y1*m+x.y-b.padding)*ce+ue.point.y,ve=(b.x2*m+x.x+b.padding)*ce+ue.point.x,be=(b.y2*m+x.y+b.padding)*ce+ue.point.y,$e=ue.perspectiveRatio<=.55||ue.occluded;return!this.isInsideGrid(te,_e,ve,be)||!T&&this.grid.hitTest(te,_e,ve,be,L)||$e?{box:[],offscreen:!1,occluded:ue.occluded}:{box:[te,_e,ve,be],offscreen:this.isOffscreen(te,_e,ve,be),occluded:!1}}placeCollisionCircles(f,m,b,x,T,P,I,L,V,H,X,ne,ae,le,ue){const ce=[],te=this.transform.elevation,_e=f.getProjection(),ve=te?te.getAtTileOffsetFunc(ue,this.transform.center.lat,this.transform.worldSize,_e):null,be=new a.pointGeometry(b.tileAnchorX,b.tileAnchorY);let{x:$e,y:Ae,z:Be}=_e.projectTilePoint(be.x,be.y,ue.canonical);if(ve){const[Ke,dt,Pt]=ve(be);$e+=Ke,Ae+=dt,Be+=Pt}const Ze=_e.name==="globe",ot=this.projectAndGetPerspectiveRatio(I,$e,Ae,Be,ue,Ze||!!te||this.transform.pitch>0,_e),{perspectiveRatio:ut}=ot,zt=(X?P/ut:P*ut)/a.ONE_EM,rt=Gt($e,Ae,Be,L),Ot=ot.signedDistanceFromCamera>0?Au(zt,T,b.lineOffsetX*zt,b.lineOffsetY*zt,!1,rt,be,b,x,L,{},te&&!X?ve:null,X&&!!te,_e,ue,X):null;let vt=!1,Mt=!1,st=!0;if(Ot&&!ot.occluded){const Ke=.5*ae*ut+le,dt=new a.pointGeometry(-100,-100),Pt=new a.pointGeometry(this.screenRightBoundary,this.screenBottomBoundary),Lt=new $l,{first:cr,last:Vr}=Ot,ir=cr.path.length;let rr=[];for(let _r=ir-1;_r>=1;_r--)rr.push(cr.path[_r]);for(let _r=1;_r<Vr.path.length;_r++)rr.push(Vr.path[_r]);const hr=2.5*Ke;V&&(rr=rr.map(([_r,On,kn],Vn)=>(ve&&!Ze&&(kn=ve(Vn<ir-1?cr.tilePath[ir-1-Vn]:Vr.tilePath[Vn-ir+2])[2]),Gt(_r,On,kn,V))),rr.some(_r=>_r[3]<=0)&&(rr=[]));let Zr=[];if(rr.length>0){let _r=1/0,On=-1/0,kn=1/0,Vn=-1/0;for(const Nn of rr)_r=Math.min(_r,Nn[0]),kn=Math.min(kn,Nn[1]),On=Math.max(On,Nn[0]),Vn=Math.max(Vn,Nn[1]);On>=dt.x&&_r<=Pt.x&&Vn>=dt.y&&kn<=Pt.y&&(Zr=[rr.map(Nn=>new a.pointGeometry(Nn[0],Nn[1]))],(_r<dt.x||On>Pt.x||kn<dt.y||Vn>Pt.y)&&(Zr=a.clipLine(Zr,dt.x,dt.y,Pt.x,Pt.y)))}for(const _r of Zr){Lt.reset(_r,.25*Ke);let On=0;On=Lt.length<=.5*Ke?1:Math.ceil(Lt.paddedLength/hr)+1;for(let kn=0;kn<On;kn++){const Vn=kn/Math.max(On-1,1),Nn=Lt.lerp(Vn),Ri=Nn.x+Ho,Wo=Nn.y+Ho;ce.push(Ri,Wo,Ke,0);const Ka=Ri-Ke,tl=Wo-Ke,Qn=Ri+Ke,Bn=Wo+Ke;if(st=st&&this.isOffscreen(Ka,tl,Qn,Bn),Mt=Mt||this.isInsideGrid(Ka,tl,Qn,Bn),!m&&this.grid.hitTestCircle(Ri,Wo,Ke,ne)&&(vt=!0,!H))return{circles:[],offscreen:!1,collisionDetected:vt,occluded:!1}}}}return{circles:!H&&vt||!Mt?[]:ce,offscreen:st,collisionDetected:vt,occluded:ot.occluded}}queryRenderedSymbols(f){if(f.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const m=[];let b=1/0,x=1/0,T=-1/0,P=-1/0;for(const H of f){const X=new a.pointGeometry(H.x+Ho,H.y+Ho);b=Math.min(b,X.x),x=Math.min(x,X.y),T=Math.max(T,X.x),P=Math.max(P,X.y),m.push(X)}const I=this.grid.query(b,x,T,P).concat(this.ignoredGrid.query(b,x,T,P)),L={},V={};for(const H of I){const X=H.key;if(L[X.bucketInstanceId]===void 0&&(L[X.bucketInstanceId]={}),L[X.bucketInstanceId][X.featureIndex])continue;const ne=[new a.pointGeometry(H.x1,H.y1),new a.pointGeometry(H.x2,H.y1),new a.pointGeometry(H.x2,H.y2),new a.pointGeometry(H.x1,H.y2)];a.polygonIntersectsPolygon(m,ne)&&(L[X.bucketInstanceId][X.featureIndex]=!0,V[X.bucketInstanceId]===void 0&&(V[X.bucketInstanceId]=[]),V[X.bucketInstanceId].push(X.featureIndex))}return V}insertCollisionBox(f,m,b,x,T){(m?this.ignoredGrid:this.grid).insert({bucketInstanceId:b,featureIndex:x,collisionGroupID:T},f[0],f[1],f[2],f[3])}insertCollisionCircles(f,m,b,x,T){const P=m?this.ignoredGrid:this.grid,I={bucketInstanceId:b,featureIndex:x,collisionGroupID:T};for(let L=0;L<f.length;L+=4)P.insertCircle(I,f[L],f[L+1],f[L+2])}projectAndGetPerspectiveRatio(f,m,b,x,T,P,I){const L=[m,b,x,1];let V=!1;if(x||this.transform.pitch>0){a.transformMat4$1(L,L,f);const X=I.name==="globe";this.fogState&&T&&!X&&(V=function(ae,le,ue,ce,te,_e){const ve=_e.calculateFogTileMatrix(te),be=[le,ue,ce];return a.transformMat4(be,be,ve),ie(ae,be,_e.pitch,_e._fov)}(this.fogState,m,b,x,T.toUnwrapped(),this.transform)>.9)}else BE(L,L,f);const H=L[3];return{point:new a.pointGeometry((L[0]/H+1)/2*this.transform.width+Ho,(-L[1]/H+1)/2*this.transform.height+Ho),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(I)/H*.5,1.5),signedDistanceFromCamera:H,occluded:P&&L[2]>H||V}}isOffscreen(f,m,b,x){return b<Ho||f>=this.screenRightBoundary||x<Ho||m>this.screenBottomBoundary}isInsideGrid(f,m,b,x){return b>=0&&f<this.gridRightBoundary&&x>=0&&m<this.gridBottomBoundary}getViewportMatrix(){const f=a.identity([]);return a.translate(f,f,[-100,-100,0]),f}}function Iu(v,f,m){const b=f.createTileMatrix(v,v.worldSize,m.toUnwrapped());return a.multiply(new Float32Array(16),v.projMatrix,b)}function fw(v,f,m){if(f.projection.name===m.projection.name)return v.projMatrix;const b=m.clone();return b.setProjection(f.projection),Iu(b,f.getProjection(),v)}function Hm(v,f,m){return f.name===m.projection.name?v.projMatrix:Iu(m,f,v)}class ed{constructor(f,m,b,x){this.opacity=f?Math.max(0,Math.min(1,f.opacity+(f.placed?m:-m))):x&&b?1:0,this.placed=b}isHidden(){return this.opacity===0&&!this.placed}}class Mu{constructor(f,m,b,x,T,P=!1){this.text=new ed(f?f.text:null,m,b,T),this.icon=new ed(f?f.icon:null,m,x,T),this.clipped=P}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class ff{constructor(f,m,b,x=!1){this.text=f,this.icon=m,this.skipFade=b,this.clipped=x}}class hw{constructor(){this.invProjMatrix=a.create(),this.viewportMatrix=a.create(),this.circles=[]}}class Vo{constructor(f,m,b,x,T){this.bucketInstanceId=f,this.featureIndex=m,this.sourceLayerIndex=b,this.bucketIndex=x,this.tileID=T}}class xi{constructor(f){this.crossSourceCollisions=f,this.maxGroupID=0,this.collisionGroups={}}get(f){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[f]){const m=++this.maxGroupID;this.collisionGroups[f]={ID:m,predicate:b=>b.collisionGroupID===m}}return this.collisionGroups[f]}}function Vm(v,f,m,b,x){const{horizontalAlign:T,verticalAlign:P}=a.getAnchorAlignment(v),I=-(T-.5)*f,L=-(P-.5)*m,V=a.evaluateVariableOffset(v,b);return new a.pointGeometry(I+V[0]*x,L+V[1]*x)}function td(v,f,m,b,x){const T=new a.pointGeometry(v,f);return m&&T._rotate(b?x:-x),T}class Uo{constructor(f,m,b,x,T){this.transform=f.clone(),this.projection=f.projection.name,this.collisionIndex=new cw(this.transform,T),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=m,this.retainedQueryData={},this.collisionGroups=new xi(b),this.collisionCircleArrays={},this.prevPlacement=x,x&&(x.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(f,m,b,x){const T=b.getBucket(m),P=b.latestFeatureIndex;if(!T||!P||m.id!==T.layerIds[0])return;const I=T.layers[0].layout,L=b.collisionBoxArray,V=Math.pow(2,this.transform.zoom-b.tileID.overscaledZ),H=b.tileSize/a.EXTENT,X=b.tileID.toUnwrapped();this.transform.setProjection(T.projection);const ne=(ae=b.tileID,le=T.getProjection(),ue=this.transform,le.name===this.projection?ue.calculateProjMatrix(ae.toUnwrapped()):Iu(ue,le,ae));var ae,le,ue;const ce=I.get("text-pitch-alignment")==="map",te=I.get("text-rotation-alignment")==="map";m.compileFilter();const _e=m.dynamicFilter(),ve=m.dynamicFilterNeedsFeature(),be=this.transform.calculatePixelsToTileUnitsMatrix(b),$e=NE(ne,b.tileID.canonical,ce,te,this.transform,T.getProjection(),be);let Ae=null;if(ce){const ot=lf(ne,b.tileID.canonical,ce,te,this.transform,T.getProjection(),be);Ae=a.multiply([],this.transform.labelPlaneMatrix,ot)}let Be=null;_e&&b.latestFeatureIndex&&(Be={unwrappedTileID:X,dynamicFilter:_e,dynamicFilterNeedsFeature:ve,featureIndex:b.latestFeatureIndex}),this.retainedQueryData[T.bucketInstanceId]=new Vo(T.bucketInstanceId,P,T.sourceLayerIndex,T.index,b.tileID);const Ze={bucket:T,layout:I,posMatrix:ne,textLabelPlaneMatrix:$e,labelToScreenMatrix:Ae,clippingData:Be,scale:V,textPixelRatio:H,holdingForFade:b.holdingForFade(),collisionBoxArray:L,partiallyEvaluatedTextSize:a.evaluateSizeForZoom(T.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:a.evaluateSizeForZoom(T.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(T.sourceID)};if(x)for(const ot of T.sortKeyRanges){const{sortKey:ut,symbolInstanceStart:zt,symbolInstanceEnd:rt}=ot;f.push({sortKey:ut,symbolInstanceStart:zt,symbolInstanceEnd:rt,parameters:Ze})}else f.push({symbolInstanceStart:0,symbolInstanceEnd:T.symbolInstances.length,parameters:Ze})}attemptAnchorPlacement(f,m,b,x,T,P,I,L,V,H,X,ne,ae,le,ue,ce,te,_e){const{textOffset0:ve,textOffset1:be,crossTileID:$e}=ne,Ae=[ve,be],Be=Vm(f,b,x,Ae,T),Ze=this.collisionIndex.placeCollisionBox(le,T,m,td(Be.x,Be.y,P,I,this.transform.angle),X,L,V,H.predicate);if(ce){const ot=le.getSymbolInstanceIconSize(_e,this.transform.zoom,ne.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(le,ot,ce,td(Be.x,Be.y,P,I,this.transform.angle),X,L,V,H.predicate).box.length===0)return}if(Ze.box.length>0){let ot;return this.prevPlacement&&this.prevPlacement.variableOffsets[$e]&&this.prevPlacement.placements[$e]&&this.prevPlacement.placements[$e].text&&(ot=this.prevPlacement.variableOffsets[$e].anchor),this.variableOffsets[$e]={textOffset:Ae,width:b,height:x,anchor:f,textScale:T,prevAnchor:ot},this.markUsedJustification(le,f,ne,ue),le.allowVerticalPlacement&&(this.markUsedOrientation(le,ue,ne),this.placedOrientations[$e]=ue),{shift:Be,placedGlyphBoxes:Ze}}}placeLayerBucketPart(f,m,b,x){const{bucket:T,layout:P,posMatrix:I,textLabelPlaneMatrix:L,labelToScreenMatrix:V,clippingData:H,textPixelRatio:X,holdingForFade:ne,collisionBoxArray:ae,partiallyEvaluatedTextSize:le,partiallyEvaluatedIconSize:ue,collisionGroup:ce}=f.parameters,te=P.get("text-optional"),_e=P.get("icon-optional"),ve=P.get("text-allow-overlap"),be=P.get("icon-allow-overlap"),$e=P.get("text-rotation-alignment")==="map",Ae=P.get("text-pitch-alignment")==="map",Be=P.get("icon-text-fit")!=="none",Ze=P.get("symbol-z-order")==="viewport-y";this.transform.setProjection(T.projection);let ot=ve&&(be||!T.hasIconData()||_e),ut=be&&(ve||!T.hasTextData()||te);!T.collisionArrays&&ae&&T.deserializeCollisionBoxes(ae),b&&x&&T.updateCollisionDebugBuffers(this.transform.zoom,ae);const zt=(rt,Ot,vt)=>{const{crossTileID:Mt,numVerticalGlyphVertices:st}=rt;if(H){const Qn={zoom:this.transform.zoom,pitch:this.transform.pitch};let Bn=null;if(H.dynamicFilterNeedsFeature){const wn=this.retainedQueryData[T.bucketInstanceId];Bn=H.featureIndex.loadFeature({featureIndex:rt.featureIndex,bucketIndex:wn.bucketIndex,sourceLayerIndex:wn.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,H.dynamicFilter)(Qn,Bn,this.retainedQueryData[T.bucketInstanceId].tileID.canonical,new a.pointGeometry(rt.tileAnchorX,rt.tileAnchorY),this.transform.calculateDistanceTileData(H.unwrappedTileID)))return this.placements[Mt]=new ff(!1,!1,!1,!0),void(m[Mt]=!0)}if(m[Mt])return;if(ne)return void(this.placements[Mt]=new ff(!1,!1,!1));let Ke=!1,dt=!1,Pt=!0,Lt=!1,cr=!1,Vr=null,ir={box:null,offscreen:null,occluded:null},rr={box:null,offscreen:null,occluded:null},hr=null,Zr=null,_r=null,On=0,kn=0,Vn=0;vt.textFeatureIndex?On=vt.textFeatureIndex:rt.useRuntimeCollisionCircles&&(On=rt.featureIndex),vt.verticalTextFeatureIndex&&(kn=vt.verticalTextFeatureIndex);const Nn=Qn=>{Qn.tileID=this.retainedQueryData[T.bucketInstanceId].tileID;const Bn=this.transform.elevation;(Bn||Qn.elevation)&&(Qn.elevation=Bn?Bn.getAtTileOffset(Qn.tileID,Qn.tileAnchorX,Qn.tileAnchorY):0)},Ri=vt.textBox;if(Ri){Nn(Ri);const Qn=wn=>{let mi=a.WritingMode.horizontal;if(T.allowVerticalPlacement&&!wn&&this.prevPlacement){const So=this.prevPlacement.placedOrientations[Mt];So&&(this.placedOrientations[Mt]=So,mi=So,this.markUsedOrientation(T,mi,rt))}return mi},Bn=(wn,mi)=>{if(T.allowVerticalPlacement&&st>0&&vt.verticalTextBox){for(const So of T.writingModes)if(So===a.WritingMode.vertical?(ir=mi(),rr=ir):ir=wn(),ir&&ir.box&&ir.box.length)break}else ir=wn()};if(P.get("text-variable-anchor")){let wn=P.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[Mt]){const qn=this.prevPlacement.variableOffsets[Mt];wn.indexOf(qn.anchor)>0&&(wn=wn.filter(xo=>xo!==qn.anchor),wn.unshift(qn.anchor))}const mi=(qn,xo,Co)=>{const jl=T.getSymbolInstanceTextSize(le,rt,this.transform.zoom,Ot),Of=(qn.x2-qn.x1)*jl+2*qn.padding,la=(qn.y2-qn.y1)*jl+2*qn.padding,ka=Be&&!be?xo:null;ka&&Nn(ka);let rl={box:[],offscreen:!1,occluded:!1};const Fl=ve?2*wn.length:wn.length;for(let zl=0;zl<Fl;++zl){const Rf=this.attemptAnchorPlacement(wn[zl%wn.length],qn,Of,la,jl,$e,Ae,X,I,ce,zl>=wn.length,rt,Ot,T,Co,ka,le,ue);if(Rf&&(rl=Rf.placedGlyphBoxes,rl&&rl.box&&rl.box.length)){Ke=!0,Vr=Rf.shift;break}}return rl};Bn(()=>mi(Ri,vt.iconBox,a.WritingMode.horizontal),()=>{const qn=vt.verticalTextBox;return qn&&Nn(qn),T.allowVerticalPlacement&&!(ir&&ir.box&&ir.box.length)&&st>0&&qn?mi(qn,vt.verticalIconBox,a.WritingMode.vertical):{box:null,offscreen:null,occluded:null}}),ir&&(Ke=ir.box,Pt=ir.offscreen,Lt=ir.occluded);const So=Qn(ir&&ir.box);if(!Ke&&this.prevPlacement){const qn=this.prevPlacement.variableOffsets[Mt];qn&&(this.variableOffsets[Mt]=qn,this.markUsedJustification(T,qn.anchor,rt,So))}}else{const wn=(mi,So)=>{const qn=T.getSymbolInstanceTextSize(le,rt,this.transform.zoom,Ot),xo=this.collisionIndex.placeCollisionBox(T,qn,mi,new a.pointGeometry(0,0),ve,X,I,ce.predicate);return xo&&xo.box&&xo.box.length&&(this.markUsedOrientation(T,So,rt),this.placedOrientations[Mt]=So),xo};Bn(()=>wn(Ri,a.WritingMode.horizontal),()=>{const mi=vt.verticalTextBox;return T.allowVerticalPlacement&&st>0&&mi?(Nn(mi),wn(mi,a.WritingMode.vertical)):{box:null,offscreen:null,occluded:null}}),Qn(ir&&ir.box&&ir.box.length)}}if(hr=ir,Ke=hr&&hr.box&&hr.box.length>0,Pt=hr&&hr.offscreen,Lt=hr&&hr.occluded,rt.useRuntimeCollisionCircles){const Qn=T.text.placedSymbolArray.get(rt.centerJustifiedTextSymbolIndex>=0?rt.centerJustifiedTextSymbolIndex:rt.verticalPlacedTextSymbolIndex),Bn=a.evaluateSizeForFeature(T.textSizeData,le,Qn),wn=P.get("text-padding");Zr=this.collisionIndex.placeCollisionCircles(T,ve,Qn,T.lineVertexArray,T.glyphOffsetArray,Bn,I,L,V,b,Ae,ce.predicate,rt.collisionCircleDiameter*Bn/a.ONE_EM,wn,this.retainedQueryData[T.bucketInstanceId].tileID),Ke=ve||Zr.circles.length>0&&!Zr.collisionDetected,Pt=Pt&&Zr.offscreen,Lt=Zr.occluded}if(vt.iconFeatureIndex&&(Vn=vt.iconFeatureIndex),vt.iconBox){const Qn=Bn=>{Nn(Bn);const wn=Be&&Vr?td(Vr.x,Vr.y,$e,Ae,this.transform.angle):new a.pointGeometry(0,0),mi=T.getSymbolInstanceIconSize(ue,this.transform.zoom,rt.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(T,mi,Bn,wn,be,X,I,ce.predicate)};rr&&rr.box&&rr.box.length&&vt.verticalIconBox?(_r=Qn(vt.verticalIconBox),dt=_r.box.length>0):(_r=Qn(vt.iconBox),dt=_r.box.length>0),Pt=Pt&&_r.offscreen,cr=_r.occluded}const Wo=te||rt.numHorizontalGlyphVertices===0&&st===0,Ka=_e||rt.numIconVertices===0;if(Wo||Ka?Ka?Wo||(dt=dt&&Ke):Ke=dt&&Ke:dt=Ke=dt&&Ke,Ke&&hr&&hr.box&&this.collisionIndex.insertCollisionBox(hr.box,P.get("text-ignore-placement"),T.bucketInstanceId,rr&&rr.box&&kn?kn:On,ce.ID),dt&&_r&&this.collisionIndex.insertCollisionBox(_r.box,P.get("icon-ignore-placement"),T.bucketInstanceId,Vn,ce.ID),Zr&&(Ke&&this.collisionIndex.insertCollisionCircles(Zr.circles,P.get("text-ignore-placement"),T.bucketInstanceId,On,ce.ID),b)){const Qn=T.bucketInstanceId;let Bn=this.collisionCircleArrays[Qn];Bn===void 0&&(Bn=this.collisionCircleArrays[Qn]=new hw);for(let wn=0;wn<Zr.circles.length;wn+=4)Bn.circles.push(Zr.circles[wn+0]),Bn.circles.push(Zr.circles[wn+1]),Bn.circles.push(Zr.circles[wn+2]),Bn.circles.push(Zr.collisionDetected?1:0)}const tl=T.projection.name!=="globe";ot=ot&&(tl||!Lt),ut=ut&&(tl||!cr),this.placements[Mt]=new ff(Ke||ot,dt||ut,Pt||T.justReloaded),m[Mt]=!0};if(Ze){const rt=T.getSortedSymbolIndexes(this.transform.angle);for(let Ot=rt.length-1;Ot>=0;--Ot){const vt=rt[Ot];zt(T.symbolInstances.get(vt),vt,T.collisionArrays[vt])}}else for(let rt=f.symbolInstanceStart;rt<f.symbolInstanceEnd;rt++)zt(T.symbolInstances.get(rt),rt,T.collisionArrays[rt]);if(b&&T.bucketInstanceId in this.collisionCircleArrays){const rt=this.collisionCircleArrays[T.bucketInstanceId];a.invert(rt.invProjMatrix,I),rt.viewportMatrix=this.collisionIndex.getViewportMatrix()}T.justReloaded=!1}markUsedJustification(f,m,b,x){const{leftJustifiedTextSymbolIndex:T,centerJustifiedTextSymbolIndex:P,rightJustifiedTextSymbolIndex:I,verticalPlacedTextSymbolIndex:L,crossTileID:V}=b,H=a.getAnchorJustification(m),X=x===a.WritingMode.vertical?L:H==="left"?T:H==="center"?P:H==="right"?I:-1;T>=0&&(f.text.placedSymbolArray.get(T).crossTileID=X>=0&&T!==X?0:V),P>=0&&(f.text.placedSymbolArray.get(P).crossTileID=X>=0&&P!==X?0:V),I>=0&&(f.text.placedSymbolArray.get(I).crossTileID=X>=0&&I!==X?0:V),L>=0&&(f.text.placedSymbolArray.get(L).crossTileID=X>=0&&L!==X?0:V)}markUsedOrientation(f,m,b){const x=m===a.WritingMode.horizontal||m===a.WritingMode.horizontalOnly?m:0,T=m===a.WritingMode.vertical?m:0,{leftJustifiedTextSymbolIndex:P,centerJustifiedTextSymbolIndex:I,rightJustifiedTextSymbolIndex:L,verticalPlacedTextSymbolIndex:V}=b,H=f.text.placedSymbolArray;P>=0&&(H.get(P).placedOrientation=x),I>=0&&(H.get(I).placedOrientation=x),L>=0&&(H.get(L).placedOrientation=x),V>=0&&(H.get(V).placedOrientation=T)}commit(f){this.commitTime=f,this.zoomAtLastRecencyCheck=this.transform.zoom;const m=this.prevPlacement;let b=!1;this.prevZoomAdjustment=m?m.zoomAdjustment(this.transform.zoom):0;const x=m?m.symbolFadeChange(f):1,T=m?m.opacities:{},P=m?m.variableOffsets:{},I=m?m.placedOrientations:{};for(const L in this.placements){const V=this.placements[L],H=T[L];H?(this.opacities[L]=new Mu(H,x,V.text,V.icon,null,V.clipped),b=b||V.text!==H.text.placed||V.icon!==H.icon.placed):(this.opacities[L]=new Mu(null,x,V.text,V.icon,V.skipFade,V.clipped),b=b||V.text||V.icon)}for(const L in T){const V=T[L];if(!this.opacities[L]){const H=new Mu(V,x,!1,!1);H.isHidden()||(this.opacities[L]=H,b=b||V.text.placed||V.icon.placed)}}for(const L in P)this.variableOffsets[L]||!this.opacities[L]||this.opacities[L].isHidden()||(this.variableOffsets[L]=P[L]);for(const L in I)this.placedOrientations[L]||!this.opacities[L]||this.opacities[L].isHidden()||(this.placedOrientations[L]=I[L]);b?this.lastPlacementChangeTime=f:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=m?m.lastPlacementChangeTime:f)}updateLayerOpacities(f,m){const b={};for(const x of m){const T=x.getBucket(f);T&&x.latestFeatureIndex&&f.id===T.layerIds[0]&&this.updateBucketOpacities(T,b,x.collisionBoxArray)}}updateBucketOpacities(f,m,b){f.hasTextData()&&f.text.opacityVertexArray.clear(),f.hasIconData()&&f.icon.opacityVertexArray.clear(),f.hasIconCollisionBoxData()&&f.iconCollisionBox.collisionVertexArray.clear(),f.hasTextCollisionBoxData()&&f.textCollisionBox.collisionVertexArray.clear();const x=f.layers[0].layout,T=!!f.layers[0].dynamicFilter(),P=new Mu(null,0,!1,!1,!0),I=x.get("text-allow-overlap"),L=x.get("icon-allow-overlap"),V=x.get("text-variable-anchor"),H=x.get("text-rotation-alignment")==="map",X=x.get("text-pitch-alignment")==="map",ne=x.get("icon-text-fit")!=="none",ae=new Mu(null,0,I&&(L||!f.hasIconData()||x.get("icon-optional")),L&&(I||!f.hasTextData()||x.get("text-optional")),!0);!f.collisionArrays&&b&&(f.hasIconCollisionBoxData()||f.hasTextCollisionBoxData())&&f.deserializeCollisionBoxes(b);const le=(ce,te,_e)=>{for(let ve=0;ve<te/4;ve++)ce.opacityVertexArray.emplaceBack(_e)};let ue=0;for(let ce=0;ce<f.symbolInstances.length;ce++){const te=f.symbolInstances.get(ce),{numHorizontalGlyphVertices:_e,numVerticalGlyphVertices:ve,crossTileID:be,numIconVertices:$e}=te;let Ae=this.opacities[be];m[be]?Ae=P:Ae||(Ae=ae,this.opacities[be]=Ae),m[be]=!0;const Be=_e>0||ve>0,Ze=$e>0,ot=this.placedOrientations[be],ut=ot===a.WritingMode.vertical,zt=ot===a.WritingMode.horizontal||ot===a.WritingMode.horizontalOnly;if(!Be&&!Ze||Ae.isHidden()||ue++,Be){const rt=Wm(Ae.text);le(f.text,_e,ut?hf:rt),le(f.text,ve,zt?hf:rt);const Ot=Ae.text.isHidden(),{leftJustifiedTextSymbolIndex:vt,centerJustifiedTextSymbolIndex:Mt,rightJustifiedTextSymbolIndex:st,verticalPlacedTextSymbolIndex:Ke}=te,dt=f.text.placedSymbolArray,Pt=Ot||ut?1:0;vt>=0&&(dt.get(vt).hidden=Pt),Mt>=0&&(dt.get(Mt).hidden=Pt),st>=0&&(dt.get(st).hidden=Pt),Ke>=0&&(dt.get(Ke).hidden=Ot||zt?1:0);const Lt=this.variableOffsets[be];Lt&&this.markUsedJustification(f,Lt.anchor,te,ot);const cr=this.placedOrientations[be];cr&&(this.markUsedJustification(f,"left",te,cr),this.markUsedOrientation(f,cr,te))}if(Ze){const rt=Wm(Ae.icon),{placedIconSymbolIndex:Ot,verticalPlacedIconSymbolIndex:vt}=te,Mt=f.icon.placedSymbolArray,st=Ae.icon.isHidden()?1:0;Ot>=0&&(le(f.icon,$e,ut?hf:rt),Mt.get(Ot).hidden=st),vt>=0&&(le(f.icon,te.numVerticalIconVertices,zt?hf:rt),Mt.get(vt).hidden=st)}if(f.hasIconCollisionBoxData()||f.hasTextCollisionBoxData()){const rt=f.collisionArrays[ce];if(rt){let Ot=new a.pointGeometry(0,0),vt=!0;if(rt.textBox||rt.verticalTextBox){if(V){const st=this.variableOffsets[be];st?(Ot=Vm(st.anchor,st.width,st.height,st.textOffset,st.textScale),H&&Ot._rotate(X?this.transform.angle:-this.transform.angle)):vt=!1}T&&(vt=!Ae.clipped),rt.textBox&&Lo(f.textCollisionBox.collisionVertexArray,Ae.text.placed,!vt||ut,Ot.x,Ot.y),rt.verticalTextBox&&Lo(f.textCollisionBox.collisionVertexArray,Ae.text.placed,!vt||zt,Ot.x,Ot.y)}const Mt=vt&&!!(!zt&&rt.verticalIconBox);rt.iconBox&&Lo(f.iconCollisionBox.collisionVertexArray,Ae.icon.placed,Mt,ne?Ot.x:0,ne?Ot.y:0),rt.verticalIconBox&&Lo(f.iconCollisionBox.collisionVertexArray,Ae.icon.placed,!Mt,ne?Ot.x:0,ne?Ot.y:0)}}}if(f.fullyClipped=ue===0,f.sortFeatures(this.transform.angle),this.retainedQueryData[f.bucketInstanceId]&&(this.retainedQueryData[f.bucketInstanceId].featureSortOrder=f.featureSortOrder),f.hasTextData()&&f.text.opacityVertexBuffer&&f.text.opacityVertexBuffer.updateData(f.text.opacityVertexArray),f.hasIconData()&&f.icon.opacityVertexBuffer&&f.icon.opacityVertexBuffer.updateData(f.icon.opacityVertexArray),f.hasIconCollisionBoxData()&&f.iconCollisionBox.collisionVertexBuffer&&f.iconCollisionBox.collisionVertexBuffer.updateData(f.iconCollisionBox.collisionVertexArray),f.hasTextCollisionBoxData()&&f.textCollisionBox.collisionVertexBuffer&&f.textCollisionBox.collisionVertexBuffer.updateData(f.textCollisionBox.collisionVertexArray),f.bucketInstanceId in this.collisionCircleArrays){const ce=this.collisionCircleArrays[f.bucketInstanceId];f.placementInvProjMatrix=ce.invProjMatrix,f.placementViewportMatrix=ce.viewportMatrix,f.collisionCircleArray=ce.circles,delete this.collisionCircleArrays[f.bucketInstanceId]}}symbolFadeChange(f){return this.fadeDuration===0?1:(f-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(f){return Math.max(0,(this.transform.zoom-f)/1.5)}hasTransitions(f){return this.stale||f-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(f,m){const b=this.zoomAtLastRecencyCheck===m?1-this.zoomAdjustment(m):1;return this.zoomAtLastRecencyCheck=m,this.commitTime+this.fadeDuration*b>f}setStale(){this.stale=!0}}function Lo(v,f,m,b,x){v.emplaceBack(f?1:0,m?1:0,b||0,x||0),v.emplaceBack(f?1:0,m?1:0,b||0,x||0),v.emplaceBack(f?1:0,m?1:0,b||0,x||0),v.emplaceBack(f?1:0,m?1:0,b||0,x||0)}const jE=Math.pow(2,25),Um=Math.pow(2,24),Hi=Math.pow(2,17),rd=Math.pow(2,16),dw=Math.pow(2,9),nd=Math.pow(2,8),co=Math.pow(2,1);function Wm(v){if(v.opacity===0&&!v.placed)return 0;if(v.opacity===1&&v.placed)return 4294967295;const f=v.placed?1:0,m=Math.floor(127*v.opacity);return m*jE+f*Um+m*Hi+f*rd+m*dw+f*nd+m*co+f}const hf=0;class Js{constructor(f){this._sortAcrossTiles=f.layout.get("symbol-z-order")!=="viewport-y"&&f.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(f,m,b,x,T){const P=this._bucketParts;for(;this._currentTileIndex<f.length;)if(m.getBucketParts(P,x,f[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,T())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,P.sort((I,L)=>I.sortKey-L.sortKey));this._currentPartIndex<P.length;){const I=P[this._currentPartIndex];if(m.placeLayerBucketPart(I,this._seenCrossTileIDs,b,I.symbolInstanceStart===0),this._currentPartIndex++,T())return!0}return!1}}class id{constructor(f,m,b,x,T,P,I,L){this.placement=new Uo(f,T,P,I,L),this._currentPlacementIndex=m.length-1,this._forceFullPlacement=b,this._showCollisionBoxes=x,this._done=!1}isDone(){return this._done}continuePlacement(f,m,b){const x=a.exported.now(),T=()=>{const P=a.exported.now()-x;return!this._forceFullPlacement&&P>2};for(;this._currentPlacementIndex>=0;){const P=m[f[this._currentPlacementIndex]],I=this.placement.collisionIndex.transform.zoom;if(P.type==="symbol"&&(!P.minzoom||P.minzoom<=I)&&(!P.maxzoom||P.maxzoom>I)){if(this._inProgressLayer||(this._inProgressLayer=new Js(P)),this._inProgressLayer.continuePlacement(b[P.source],this.placement,this._showCollisionBoxes,P,T))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(f){return this.placement.commit(f),this.placement}}const Gm=512/a.EXTENT/2;class VM{constructor(f,m,b){this.tileID=f,this.indexedSymbolInstances={},this.bucketInstanceId=b;for(let x=0;x<m.length;x++){const T=m.get(x),P=T.key;this.indexedSymbolInstances[P]||(this.indexedSymbolInstances[P]=[]),this.indexedSymbolInstances[P].push({crossTileID:T.crossTileID,coord:this.getScaledCoordinates(T,f)})}}getScaledCoordinates(f,m){const b=Gm/Math.pow(2,m.canonical.z-this.tileID.canonical.z);return{x:Math.floor((m.canonical.x*a.EXTENT+f.tileAnchorX)*b),y:Math.floor((m.canonical.y*a.EXTENT+f.tileAnchorY)*b)}}findMatches(f,m,b){const x=this.tileID.canonical.z<m.canonical.z?1:Math.pow(2,this.tileID.canonical.z-m.canonical.z);for(let T=0;T<f.length;T++){const P=f.get(T);if(P.crossTileID)continue;const I=this.indexedSymbolInstances[P.key];if(!I)continue;const L=this.getScaledCoordinates(P,m);for(const V of I)if(Math.abs(V.coord.x-L.x)<=x&&Math.abs(V.coord.y-L.y)<=x&&!b[V.crossTileID]){b[V.crossTileID]=!0,P.crossTileID=V.crossTileID;break}}}}class pw{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class df{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(f){const m=Math.round((f-this.lng)/360);if(m!==0)for(const b in this.indexes){const x=this.indexes[b],T={};for(const P in x){const I=x[P];I.tileID=I.tileID.unwrapTo(I.tileID.wrap+m),T[I.tileID.key]=I}this.indexes[b]=T}this.lng=f}addBucket(f,m,b){if(this.indexes[f.overscaledZ]&&this.indexes[f.overscaledZ][f.key]){if(this.indexes[f.overscaledZ][f.key].bucketInstanceId===m.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(f.overscaledZ,this.indexes[f.overscaledZ][f.key])}for(let T=0;T<m.symbolInstances.length;T++)m.symbolInstances.get(T).crossTileID=0;this.usedCrossTileIDs[f.overscaledZ]||(this.usedCrossTileIDs[f.overscaledZ]={});const x=this.usedCrossTileIDs[f.overscaledZ];for(const T in this.indexes){const P=this.indexes[T];if(Number(T)>f.overscaledZ)for(const I in P){const L=P[I];L.tileID.isChildOf(f)&&L.findMatches(m.symbolInstances,f,x)}else{const I=P[f.scaledTo(Number(T)).key];I&&I.findMatches(m.symbolInstances,f,x)}}for(let T=0;T<m.symbolInstances.length;T++){const P=m.symbolInstances.get(T);P.crossTileID||(P.crossTileID=b.generate(),x[P.crossTileID]=!0)}return this.indexes[f.overscaledZ]===void 0&&(this.indexes[f.overscaledZ]={}),this.indexes[f.overscaledZ][f.key]=new VM(f,m.symbolInstances,m.bucketInstanceId),!0}removeBucketCrossTileIDs(f,m){for(const b in m.indexedSymbolInstances)for(const x of m.indexedSymbolInstances[b])delete this.usedCrossTileIDs[f][x.crossTileID]}removeStaleBuckets(f){let m=!1;for(const b in this.indexes){const x=this.indexes[b];for(const T in x)f[x[T].bucketInstanceId]||(this.removeBucketCrossTileIDs(b,x[T]),delete x[T],m=!0)}return m}}class FE{constructor(){this.layerIndexes={},this.crossTileIDs=new pw,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(f,m,b,x){let T=this.layerIndexes[f.id];T===void 0&&(T=this.layerIndexes[f.id]=new df);let P=!1;const I={};x.name!=="globe"&&T.handleWrapJump(b);for(const L of m){const V=L.getBucket(f);V&&f.id===V.layerIds[0]&&(V.bucketInstanceId||(V.bucketInstanceId=++this.maxBucketInstanceId),T.addBucket(L.tileID,V,this.crossTileIDs)&&(P=!0),I[V.bucketInstanceId]=!0)}return T.removeStaleBuckets(I)&&(P=!0),P}pruneUnusedLayers(f){const m={};f.forEach(b=>{m[b]=!0});for(const b in this.layerIndexes)m[b]||delete this.layerIndexes[b]}}const od=(v,f)=>a.emitValidationErrors(v,f&&f.filter(m=>m.identifier!=="source.canvas")),pf=a.pick(sr,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection"]),Dl=a.pick(sr,["setCenter","setZoom","setBearing","setPitch"]),Ym={version:8,layers:[],sources:{}},Ll={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0};class Oa extends a.Evented{constructor(f,m={}){super(),this.map=f,this.dispatcher=new me(bt(),this),this.imageManager=new ct,this.imageManager.setEventedParent(this),this.glyphManager=new a.GlyphManager(f._requestManager,m.localFontFamily?a.LocalGlyphMode.all:m.localIdeographFontFamily?a.LocalGlyphMode.ideographs:a.LocalGlyphMode.none,m.localFontFamily||m.localIdeographFontFamily),this.crossTileSymbolIndex=new FE,this._layers={},this._num3DLayers=0,this._numSymbolLayers=0,this._numCircleLayers=0,this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._availableImages=[],this._order=[],this._drapedFirstOrder=[],this._markersNeedUpdate=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",a.getReferrer());const b=this;this._rtlTextPluginCallback=Oa.registerForPluginStateChange(x=>{b.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:x.pluginStatus,pluginURL:x.pluginURL},(T,P)=>{if(a.triggerPluginCompletionEvent(T),P&&P.every(I=>I))for(const I in b._sourceCaches){const L=b._sourceCaches[I],V=L.getSource().type;V!=="vector"&&V!=="geojson"||L.reload()}})}),this.on("data",x=>{if(x.dataType!=="source"||x.sourceDataType!=="metadata")return;const T=this.getSource(x.sourceId);if(T&&T.vectorLayerIds)for(const P in this._layers){const I=this._layers[P];I.source===T.id&&this._validateLayer(I)}})}loadURL(f,m={}){this.fire(new a.Event("dataloading",{dataType:"style"}));const b=typeof m.validate=="boolean"?m.validate:!a.isMapboxURL(f);f=this.map._requestManager.normalizeStyleURL(f,m.accessToken);const x=this.map._requestManager.transformRequest(f,a.ResourceType.Style);this._request=a.getJSON(x,(T,P)=>{this._request=null,T?this.fire(new a.ErrorEvent(T)):P&&this._load(P,b)})}loadJSON(f,m={}){this.fire(new a.Event("dataloading",{dataType:"style"})),this._request=a.exported.frame(()=>{this._request=null,this._load(f,m.validate!==!1)})}loadEmpty(){this.fire(new a.Event("dataloading",{dataType:"style"})),this._load(Ym,!1)}_updateLayerCount(f,m){const b=m?1:-1;f.is3D()&&(this._num3DLayers+=b),f.type==="circle"&&(this._numCircleLayers+=b),f.type==="symbol"&&(this._numSymbolLayers+=b)}_load(f,m){if(m&&od(this,a.validateStyle(f)))return;this._loaded=!0,this.stylesheet=a.clone$1(f),this._updateMapProjection();for(const x in f.sources)this.addSource(x,f.sources[x],{validate:!1});this._changed=!1,f.sprite?this._loadSprite(f.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(f.glyphs);const b=mr(this.stylesheet.layers);this._order=b.map(x=>x.id),this._layers={},this._serializedLayers={};for(const x of b){const T=a.createStyleLayer(x);T.setEventedParent(this,{layer:{id:T.id}}),this._layers[T.id]=T,this._serializedLayers[T.id]=T.serialize(),this._updateLayerCount(T,!0)}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new de(this.stylesheet.light),this.stylesheet.terrain&&!this.terrainSetForDrapingOnly()&&this._createTerrain(this.stylesheet.terrain,1),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this._updateDrapeFirstLayers(),this.fire(new a.Event("data",{dataType:"style"})),this.fire(new a.Event("style.load"))}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}setProjection(f){f?this.stylesheet.projection=f:delete this.stylesheet.projection,this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null))}_updateMapProjection(){this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.stylesheet.projection)}_loadSprite(f){this._spriteRequest=function(m,b,x){let T,P,I;const L=a.exported.devicePixelRatio>1?"@2x":"";let V=a.getJSON(b.transformRequest(b.normalizeSpriteURL(m,L,".json"),a.ResourceType.SpriteJSON),(ne,ae)=>{V=null,I||(I=ne,T=ae,X())}),H=a.getImage(b.transformRequest(b.normalizeSpriteURL(m,L,".png"),a.ResourceType.SpriteImage),(ne,ae)=>{H=null,I||(I=ne,P=ae,X())});function X(){if(I)x(I);else if(T&&P){const ne=a.exported.getImageData(P),ae={};for(const le in T){const{width:ue,height:ce,x:te,y:_e,sdf:ve,pixelRatio:be,stretchX:$e,stretchY:Ae,content:Be}=T[le],Ze=new a.RGBAImage({width:ue,height:ce});a.RGBAImage.copy(ne,Ze,{x:te,y:_e},{x:0,y:0},{width:ue,height:ce}),ae[le]={data:Ze,pixelRatio:be,sdf:ve,stretchX:$e,stretchY:Ae,content:Be}}x(null,ae)}}return{cancel(){V&&(V.cancel(),V=null),H&&(H.cancel(),H=null)}}}(f,this.map._requestManager,(m,b)=>{if(this._spriteRequest=null,m)this.fire(new a.ErrorEvent(m));else if(b)for(const x in b)this.imageManager.addImage(x,b[x]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.dispatcher.broadcast("spriteLoaded",!0),this.fire(new a.Event("data",{dataType:"style"}))})}_validateLayer(f){const m=this.getSource(f.source);if(!m)return;const b=f.sourceLayer;b&&(m.type==="geojson"||m.vectorLayerIds&&m.vectorLayerIds.indexOf(b)===-1)&&this.fire(new a.ErrorEvent(new Error(`Source layer "${b}" does not exist on source "${m.id}" as specified by style layer "${f.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const f in this._sourceCaches)if(!this._sourceCaches[f].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(f){const m=[];for(const b of f){const x=this._layers[b];x.type!=="custom"&&m.push(x.serialize())}return m}hasTransitions(){if(this.light&&this.light.hasTransition()||this.fog&&this.fog.hasTransition())return!0;for(const f in this._sourceCaches)if(this._sourceCaches[f].hasTransition())return!0;for(const f in this._layers)if(this._layers[f].hasTransition())return!0;return!1}get order(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}isLayerDraped(f){return!!this.terrain&&(typeof f.isLayerDraped=="function"?f.isLayerDraped():Ll[f.type])}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(f){if(!this._loaded)return;const m=this._changed;if(this._changed){const x=Object.keys(this._updatedLayers),T=Object.keys(this._removedLayers);(x.length||T.length)&&this._updateWorkerLayers(x,T);for(const P in this._updatedSources){const I=this._updatedSources[P];I==="reload"?this._reloadSource(P):I==="clear"&&this._clearSource(P)}this._updateTilesForChangedImages();for(const P in this._updatedPaintProps)this._layers[P].updateTransitions(f);this.light.updateTransitions(f),this.fog&&this.fog.updateTransitions(f),this._resetUpdates()}const b={};for(const x in this._sourceCaches){const T=this._sourceCaches[x];b[x]=T.used,T.used=!1}for(const x of this._order){const T=this._layers[x];if(T.recalculate(f,this._availableImages),!T.isHidden(f.zoom)){const I=this._getLayerSourceCache(T);I&&(I.used=!0)}const P=this.map.painter;if(P){const I=T.getProgramIds();if(!I)continue;const L=T.getProgramConfiguration(f.zoom);for(const V of I)P.useProgram(V,L)}}for(const x in b){const T=this._sourceCaches[x];b[x]!==T.used&&T.getSource().fire(new a.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:T.getSource().id}))}this.light.recalculate(f),this.terrain&&this.terrain.recalculate(f),this.fog&&this.fog.recalculate(f),this.z=f.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),m&&this.fire(new a.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const f=Object.keys(this._changedImages);if(f.length){for(const m in this._sourceCaches)this._sourceCaches[m].reloadTilesForDependencies(["icons","patterns"],f);this._changedImages={}}}_updateWorkerLayers(f,m){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(f),removedIds:m})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(f){if(this._checkLoaded(),od(this,a.validateStyle(f)))return!1;(f=a.clone$1(f)).layers=mr(f.layers);const m=function(x,T){if(!x)return[{command:sr.setStyle,args:[T]}];let P=[];try{if(!h(x.version,T.version))return[{command:sr.setStyle,args:[T]}];h(x.center,T.center)||P.push({command:sr.setCenter,args:[T.center]}),h(x.zoom,T.zoom)||P.push({command:sr.setZoom,args:[T.zoom]}),h(x.bearing,T.bearing)||P.push({command:sr.setBearing,args:[T.bearing]}),h(x.pitch,T.pitch)||P.push({command:sr.setPitch,args:[T.pitch]}),h(x.sprite,T.sprite)||P.push({command:sr.setSprite,args:[T.sprite]}),h(x.glyphs,T.glyphs)||P.push({command:sr.setGlyphs,args:[T.glyphs]}),h(x.transition,T.transition)||P.push({command:sr.setTransition,args:[T.transition]}),h(x.light,T.light)||P.push({command:sr.setLight,args:[T.light]}),h(x.fog,T.fog)||P.push({command:sr.setFog,args:[T.fog]}),h(x.projection,T.projection)||P.push({command:sr.setProjection,args:[T.projection]});const I={},L=[];(function(X,ne,ae,le){let ue;for(ue in ne=ne||{},X=X||{})X.hasOwnProperty(ue)&&(ne.hasOwnProperty(ue)||Nr(ue,ae,le));for(ue in ne){if(!ne.hasOwnProperty(ue))continue;const ce=ne[ue];X.hasOwnProperty(ue)?h(X[ue],ce)||(X[ue].type==="geojson"&&ce.type==="geojson"&&Kn(X,ne,ue)?ae.push({command:sr.setGeoJSONSourceData,args:[ue,ce.data]}):sa(ue,ne,ae,le)):Br(ue,ne,ae)}})(x.sources,T.sources,L,I);const V=[];x.layers&&x.layers.forEach(X=>{X.source&&I[X.source]?P.push({command:sr.removeLayer,args:[X.id]}):V.push(X)});let H=x.terrain;H&&I[H.source]&&(P.push({command:sr.setTerrain,args:[void 0]}),H=void 0),P=P.concat(L),h(H,T.terrain)||P.push({command:sr.setTerrain,args:[T.terrain]}),function(X,ne,ae){ne=ne||[];const le=(X=X||[]).map(Ta),ue=ne.map(Ta),ce=X.reduce(Si,{}),te=ne.reduce(Si,{}),_e=le.slice(),ve=Object.create(null);let be,$e,Ae,Be,Ze,ot,ut;for(be=0,$e=0;be<le.length;be++)Ae=le[be],te.hasOwnProperty(Ae)?$e++:(ae.push({command:sr.removeLayer,args:[Ae]}),_e.splice(_e.indexOf(Ae,$e),1));for(be=0,$e=0;be<ue.length;be++)Ae=ue[ue.length-1-be],_e[_e.length-1-be]!==Ae&&(ce.hasOwnProperty(Ae)?(ae.push({command:sr.removeLayer,args:[Ae]}),_e.splice(_e.lastIndexOf(Ae,_e.length-$e),1)):$e++,ot=_e[_e.length-be],ae.push({command:sr.addLayer,args:[te[Ae],ot]}),_e.splice(_e.length-be,0,Ae),ve[Ae]=!0);for(be=0;be<ue.length;be++)if(Ae=ue[be],Be=ce[Ae],Ze=te[Ae],!ve[Ae]&&!h(Be,Ze))if(h(Be.source,Ze.source)&&h(Be["source-layer"],Ze["source-layer"])&&h(Be.type,Ze.type)){for(ut in wt(Be.layout,Ze.layout,ae,Ae,null,sr.setLayoutProperty),wt(Be.paint,Ze.paint,ae,Ae,null,sr.setPaintProperty),h(Be.filter,Ze.filter)||ae.push({command:sr.setFilter,args:[Ae,Ze.filter]}),h(Be.minzoom,Ze.minzoom)&&h(Be.maxzoom,Ze.maxzoom)||ae.push({command:sr.setLayerZoomRange,args:[Ae,Ze.minzoom,Ze.maxzoom]}),Be)Be.hasOwnProperty(ut)&&ut!=="layout"&&ut!=="paint"&&ut!=="filter"&&ut!=="metadata"&&ut!=="minzoom"&&ut!=="maxzoom"&&(ut.indexOf("paint.")===0?wt(Be[ut],Ze[ut],ae,Ae,ut.slice(6),sr.setPaintProperty):h(Be[ut],Ze[ut])||ae.push({command:sr.setLayerProperty,args:[Ae,ut,Ze[ut]]}));for(ut in Ze)Ze.hasOwnProperty(ut)&&!Be.hasOwnProperty(ut)&&ut!=="layout"&&ut!=="paint"&&ut!=="filter"&&ut!=="metadata"&&ut!=="minzoom"&&ut!=="maxzoom"&&(ut.indexOf("paint.")===0?wt(Be[ut],Ze[ut],ae,Ae,ut.slice(6),sr.setPaintProperty):h(Be[ut],Ze[ut])||ae.push({command:sr.setLayerProperty,args:[Ae,ut,Ze[ut]]}))}else ae.push({command:sr.removeLayer,args:[Ae]}),ot=_e[_e.lastIndexOf(Ae)+1],ae.push({command:sr.addLayer,args:[Ze,ot]})}(V,T.layers,P)}catch(I){console.warn("Unable to compute style diff:",I),P=[{command:sr.setStyle,args:[T]}]}return P}(this.serialize(),f).filter(x=>!(x.command in Dl));if(m.length===0)return!1;const b=m.filter(x=>!(x.command in pf));if(b.length>0)throw new Error(`Unimplemented: ${b.map(x=>x.command).join(", ")}.`);return m.forEach(x=>{x.command!=="setTransition"&&x.command!=="setProjection"&&this[x.command].apply(this,x.args)}),this.stylesheet=f,this._updateMapProjection(),!0}addImage(f,m){return this.getImage(f)?this.fire(new a.ErrorEvent(new Error("An image with this name already exists."))):(this.imageManager.addImage(f,m),this._afterImageUpdated(f),this)}updateImage(f,m){this.imageManager.updateImage(f,m)}getImage(f){return this.imageManager.getImage(f)}removeImage(f){return this.getImage(f)?(this.imageManager.removeImage(f),this._afterImageUpdated(f),this):this.fire(new a.ErrorEvent(new Error("No image with this name exists.")))}_afterImageUpdated(f){this._availableImages=this.imageManager.listImages(),this._changedImages[f]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new a.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addSource(f,m,b={}){if(this._checkLoaded(),this.getSource(f)!==void 0)throw new Error("There is already a source with this ID");if(!m.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(m).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(m.type)>=0&&this._validate(a.validateSource,`sources.${f}`,m,null,b))return;this.map&&this.map._collectResourceTiming&&(m.collectResourceTiming=!0);const x=Ge(f,m,this.dispatcher,this);x.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(f),source:x.serialize(),sourceId:f}));const T=P=>{const I=(P?"symbol:":"other:")+f,L=this._sourceCaches[I]=new a.SourceCache(I,x,P);(P?this._symbolSourceCaches:this._otherSourceCaches)[f]=L,L.style=this,L.onAdd(this.map)};T(!1),m.type!=="vector"&&m.type!=="geojson"||T(!0),x.onAdd&&x.onAdd(this.map),this._changed=!0}removeSource(f){this._checkLoaded();const m=this.getSource(f);if(!m)throw new Error("There is no source with this ID");for(const x in this._layers)if(this._layers[x].source===f)return this.fire(new a.ErrorEvent(new Error(`Source "${f}" cannot be removed while layer "${x}" is using it.`)));if(this.terrain&&this.terrain.get().source===f)return this.fire(new a.ErrorEvent(new Error(`Source "${f}" cannot be removed while terrain is using it.`)));const b=this._getSourceCaches(f);for(const x of b)delete this._sourceCaches[x.id],delete this._updatedSources[x.id],x.fire(new a.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:x.getSource().id})),x.setEventedParent(null),x.clearTiles();return delete this._otherSourceCaches[f],delete this._symbolSourceCaches[f],m.setEventedParent(null),m.onRemove&&m.onRemove(this.map),this._changed=!0,this}setGeoJSONSourceData(f,m){this._checkLoaded(),this.getSource(f).setData(m),this._changed=!0}getSource(f){const m=this._getSourceCache(f);return m&&m.getSource()}_getSources(){const f=[];for(const m in this._otherSourceCaches){const b=this._getSourceCache(m);b&&f.push(b.getSource())}return f}addLayer(f,m,b={}){this._checkLoaded();const x=f.id;if(this.getLayer(x))return void this.fire(new a.ErrorEvent(new Error(`Layer with id "${x}" already exists on this map`)));let T;if(f.type==="custom"){if(od(this,a.validateCustomStyleLayer(f)))return;T=a.createStyleLayer(f)}else{if(typeof f.source=="object"&&(this.addSource(x,f.source),f=a.clone$1(f),f=a.extend(f,{source:x})),this._validate(a.validateLayer,`layers.${x}`,f,{arrayIndex:-1},b))return;T=a.createStyleLayer(f),this._validateLayer(T),T.setEventedParent(this,{layer:{id:x}}),this._serializedLayers[T.id]=T.serialize(),this._updateLayerCount(T,!0)}const P=m?this._order.indexOf(m):this._order.length;if(m&&P===-1)return void this.fire(new a.ErrorEvent(new Error(`Layer with id "${m}" does not exist on this map.`)));this._order.splice(P,0,x),this._layerOrderChanged=!0,this._layers[x]=T;const I=this._getLayerSourceCache(T);if(this._removedLayers[x]&&T.source&&I&&T.type!=="custom"){const L=this._removedLayers[x];delete this._removedLayers[x],L.type!==T.type?this._updatedSources[T.source]="clear":(this._updatedSources[T.source]="reload",I.pause())}this._updateLayer(T),T.onAdd&&T.onAdd(this.map),this._updateDrapeFirstLayers()}moveLayer(f,m){if(this._checkLoaded(),this._changed=!0,!this._layers[f])return void this.fire(new a.ErrorEvent(new Error(`The layer '${f}' does not exist in the map's style and cannot be moved.`)));if(f===m)return;const b=this._order.indexOf(f);this._order.splice(b,1);const x=m?this._order.indexOf(m):this._order.length;m&&x===-1?this.fire(new a.ErrorEvent(new Error(`Layer with id "${m}" does not exist on this map.`))):(this._order.splice(x,0,f),this._layerOrderChanged=!0,this._updateDrapeFirstLayers())}removeLayer(f){this._checkLoaded();const m=this._layers[f];if(!m)return void this.fire(new a.ErrorEvent(new Error(`The layer '${f}' does not exist in the map's style and cannot be removed.`)));m.setEventedParent(null),this._updateLayerCount(m,!1);const b=this._order.indexOf(f);this._order.splice(b,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[f]=m,delete this._layers[f],delete this._serializedLayers[f],delete this._updatedLayers[f],delete this._updatedPaintProps[f],m.onRemove&&m.onRemove(this.map),this._updateDrapeFirstLayers()}getLayer(f){return this._layers[f]}hasLayer(f){return f in this._layers}hasLayerType(f){for(const m in this._layers)if(this._layers[m].type===f)return!0;return!1}setLayerZoomRange(f,m,b){this._checkLoaded();const x=this.getLayer(f);x?x.minzoom===m&&x.maxzoom===b||(m!=null&&(x.minzoom=m),b!=null&&(x.maxzoom=b),this._updateLayer(x)):this.fire(new a.ErrorEvent(new Error(`The layer '${f}' does not exist in the map's style and cannot have zoom extent.`)))}setFilter(f,m,b={}){this._checkLoaded();const x=this.getLayer(f);if(x){if(!h(x.filter,m))return m==null?(x.filter=void 0,void this._updateLayer(x)):void(this._validate(a.validateFilter,`layers.${x.id}.filter`,m,{layerType:x.type},b)||(x.filter=a.clone$1(m),this._updateLayer(x)))}else this.fire(new a.ErrorEvent(new Error(`The layer '${f}' does not exist in the map's style and cannot be filtered.`)))}getFilter(f){const m=this.getLayer(f);return m&&a.clone$1(m.filter)}setLayoutProperty(f,m,b,x={}){this._checkLoaded();const T=this.getLayer(f);T?h(T.getLayoutProperty(m),b)||(T.setLayoutProperty(m,b,x),this._updateLayer(T)):this.fire(new a.ErrorEvent(new Error(`The layer '${f}' does not exist in the map's style and cannot be styled.`)))}getLayoutProperty(f,m){const b=this.getLayer(f);if(b)return b.getLayoutProperty(m);this.fire(new a.ErrorEvent(new Error(`The layer '${f}' does not exist in the map's style.`)))}setPaintProperty(f,m,b,x={}){this._checkLoaded();const T=this.getLayer(f);T?h(T.getPaintProperty(m),b)||(T.setPaintProperty(m,b,x)&&this._updateLayer(T),this._changed=!0,this._updatedPaintProps[f]=!0):this.fire(new a.ErrorEvent(new Error(`The layer '${f}' does not exist in the map's style and cannot be styled.`)))}getPaintProperty(f,m){const b=this.getLayer(f);return b&&b.getPaintProperty(m)}setFeatureState(f,m){this._checkLoaded();const b=f.source,x=f.sourceLayer,T=this.getSource(b);if(!T)return void this.fire(new a.ErrorEvent(new Error(`The source '${b}' does not exist in the map's style.`)));const P=T.type;if(P==="geojson"&&x)return void this.fire(new a.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(P==="vector"&&!x)return void this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));f.id===void 0&&this.fire(new a.ErrorEvent(new Error("The feature id parameter must be provided.")));const I=this._getSourceCaches(b);for(const L of I)L.setFeatureState(x,f.id,m)}removeFeatureState(f,m){this._checkLoaded();const b=f.source,x=this.getSource(b);if(!x)return void this.fire(new a.ErrorEvent(new Error(`The source '${b}' does not exist in the map's style.`)));const T=x.type,P=T==="vector"?f.sourceLayer:void 0;if(T==="vector"&&!P)return void this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));if(m&&typeof f.id!="string"&&typeof f.id!="number")return void this.fire(new a.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));const I=this._getSourceCaches(b);for(const L of I)L.removeFeatureState(P,f.id,m)}getFeatureState(f){this._checkLoaded();const m=f.source,b=f.sourceLayer,x=this.getSource(m);if(x){if(x.type!=="vector"||b)return f.id===void 0&&this.fire(new a.ErrorEvent(new Error("The feature id parameter must be provided."))),this._getSourceCaches(m)[0].getFeatureState(b,f.id);this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new a.ErrorEvent(new Error(`The source '${m}' does not exist in the map's style.`)))}getTransition(){return a.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const f={};for(const m in this._sourceCaches){const b=this._sourceCaches[m].getSource();f[b.id]||(f[b.id]=b.serialize())}return a.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.getTerrain()||void 0,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:f,layers:this._serializeLayers(this._order)},m=>m!==void 0)}_updateLayer(f){this._updatedLayers[f.id]=!0;const m=this._getLayerSourceCache(f);f.source&&!this._updatedSources[f.source]&&m&&m.getSource().type!=="raster"&&(this._updatedSources[f.source]="reload",m.pause()),this._changed=!0,f.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(f){const m=P=>this._layers[P].type==="fill-extrusion",b={},x=[];for(let P=this._order.length-1;P>=0;P--){const I=this._order[P];if(m(I)){b[I]=P;for(const L of f){const V=L[I];if(V)for(const H of V)x.push(H)}}}x.sort((P,I)=>I.intersectionZ-P.intersectionZ);const T=[];for(let P=this._order.length-1;P>=0;P--){const I=this._order[P];if(m(I))for(let L=x.length-1;L>=0;L--){const V=x[L].feature;if(b[V.layer.id]<P)break;T.push(V),x.pop()}else for(const L of f){const V=L[I];if(V)for(const H of V)T.push(H.feature)}}return T}queryRenderedFeatures(f,m,b){m&&m.filter&&this._validate(a.validateFilter,"queryRenderedFeatures.filter",m.filter,null,m);const x={};if(m&&m.layers){if(!Array.isArray(m.layers))return this.fire(new a.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const L of m.layers){const V=this._layers[L];if(!V)return this.fire(new a.ErrorEvent(new Error(`The layer '${L}' does not exist in the map's style and cannot be queried for features.`))),[];x[V.source]=!0}}const T=[];m.availableImages=this._availableImages;const P=m&&m.layers?m.layers.some(L=>{const V=this.getLayer(L);return V&&V.is3D()}):this.has3DLayers(),I=We.createFromScreenPoints(f,b);for(const L in this._sourceCaches){const V=this._sourceCaches[L].getSource().id;m.layers&&!x[V]||T.push(nt(this._sourceCaches[L],this._layers,this._serializedLayers,I,m,b,P,!!this.map._showQueryGeometry))}return this.placement&&T.push(function(L,V,H,X,ne,ae,le){const ue={},ce=ae.queryRenderedSymbols(X),te=[];for(const _e of Object.keys(ce).map(Number))te.push(le[_e]);te.sort(Qt);for(const _e of te){const ve=_e.featureIndex.lookupSymbolFeatures(ce[_e.bucketInstanceId],V,_e.bucketIndex,_e.sourceLayerIndex,ne.filter,ne.layers,ne.availableImages,L);for(const be in ve){const $e=ue[be]=ue[be]||[],Ae=ve[be];Ae.sort((Be,Ze)=>{const ot=_e.featureSortOrder;if(ot){const ut=ot.indexOf(Be.featureIndex);return ot.indexOf(Ze.featureIndex)-ut}return Ze.featureIndex-Be.featureIndex});for(const Be of Ae)$e.push(Be)}}for(const _e in ue)ue[_e].forEach(ve=>{const be=ve.feature,$e=H(L[_e]);if(!$e)return;const Ae=$e.getFeatureState(be.layer["source-layer"],be.id);be.source=be.layer.source,be.layer["source-layer"]&&(be.sourceLayer=be.layer["source-layer"]),be.state=Ae});return ue}(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),I.screenGeometry,m,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(T)}querySourceFeatures(f,m){m&&m.filter&&this._validate(a.validateFilter,"querySourceFeatures.filter",m.filter,null,m);const b=this._getSourceCaches(f);let x=[];for(const T of b)x=x.concat(kt(T,m));return x}addSourceType(f,m,b){return Oa.getSourceType(f)?b(new Error(`A source type called "${f}" already exists.`)):(Oa.setSourceType(f,m),m.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:f,url:m.workerSourceURL},b):b(null,null))}getLight(){return this.light.getLight()}setLight(f,m={}){this._checkLoaded();const b=this.light.getLight();let x=!1;for(const P in f)if(!h(f[P],b[P])){x=!0;break}if(!x)return;const T=this._setTransitionParameters({duration:300,delay:0});this.light.setLight(f,m),this.light.updateTransitions(T)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(f,m=1){if(this._checkLoaded(),!f)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);let b=f;if(m===1){if(typeof b.source=="object"){const x="terrain-dem-src";this.addSource(x,b.source),b=a.clone$1(b),b=a.extend(b,{source:x})}if(this._validate(a.validateTerrain,"terrain",b))return}if(!this.terrain||this.terrain&&m!==this.terrain.drapeRenderMode){if(!b)return;this._createTerrain(b,m)}else{const x=this.terrain,T=x.get();for(const P of Object.keys(a.spec.terrain))!b.hasOwnProperty(P)&&a.spec.terrain[P].default&&(b[P]=a.spec.terrain[P].default);for(const P in b)if(!h(b[P],T[P])){x.set(b),this.stylesheet.terrain=b;const I=this._setTransitionParameters({duration:0});x.updateTransitions(I);break}}this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(f){const m=this.fog=new re(f,this.map.transform);this.stylesheet.fog=f;const b=this._setTransitionParameters({duration:0});m.updateTransitions(b)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const f of this.map._markers)f._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(f){if(this._checkLoaded(),!f)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const m=this.fog,b=m.get();Object.keys(f).length===0&&m.set(f);for(const x in f)if(!h(f[x],b[x])){m.set(f),this.stylesheet.fog=f;const T=this._setTransitionParameters({duration:0});m.updateTransitions(T);break}}else this._createFog(f);this._markersNeedUpdate=!0}_setTransitionParameters(f){return{now:a.exported.now(),transition:a.extend(f,this.stylesheet.transition)}}_updateDrapeFirstLayers(){if(!this.map._optimizeForTerrain||!this.terrain)return;const f=this._order.filter(b=>this.isLayerDraped(this._layers[b])),m=this._order.filter(b=>!this.isLayerDraped(this._layers[b]));this._drapedFirstOrder=[],this._drapedFirstOrder.push(...f),this._drapedFirstOrder.push(...m)}_createTerrain(f,m){const b=this.terrain=new Ct(f,m);this.stylesheet.terrain=f,this.dispatcher.broadcast("enableTerrain",!this.terrainSetForDrapingOnly()),this._force3DLayerUpdate();const x=this._setTransitionParameters({duration:0});b.updateTransitions(x)}_force3DLayerUpdate(){for(const f in this._layers){const m=this._layers[f];m.type==="fill-extrusion"&&this._updateLayer(m)}}_forceSymbolLayerUpdate(){for(const f in this._layers){const m=this._layers[f];m.type==="symbol"&&this._updateLayer(m)}}_validate(f,m,b,x,T={}){return(!T||T.validate!==!1)&&od(this,f.call(a.validateStyle,a.extend({key:m,style:this.serialize(),value:b,styleSpec:a.spec},x)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),a.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const f in this._layers)this._layers[f].setEventedParent(null);for(const f in this._sourceCaches)this._sourceCaches[f].clearTiles(),this._sourceCaches[f].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(f){const m=this._getSourceCaches(f);for(const b of m)b.clearTiles()}_reloadSource(f){const m=this._getSourceCaches(f);for(const b of m)b.resume(),b.reload()}_reloadSources(){for(const f of this._getSources())f.reload&&f.reload()}_updateSources(f){for(const m in this._sourceCaches)this._sourceCaches[m].update(f)}_generateCollisionBoxes(){for(const f in this._sourceCaches){const m=this._sourceCaches[f];m.resume(),m.reload()}}_updatePlacement(f,m,b,x,T=!1){let P=!1,I=!1;const L={};for(const V of this._order){const H=this._layers[V];if(H.type!=="symbol")continue;if(!L[H.source]){const ne=this._getLayerSourceCache(H);if(!ne)continue;L[H.source]=ne.getRenderableIds(!0).map(ae=>ne.getTileByID(ae)).sort((ae,le)=>le.tileID.overscaledZ-ae.tileID.overscaledZ||(ae.tileID.isLessThan(le.tileID)?-1:1))}const X=this.crossTileSymbolIndex.addLayer(H,L[H.source],f.center.lng,f.projection);P=P||X}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),T=T||this._layerOrderChanged||b===0,this._layerOrderChanged&&this.fire(new a.Event("neworder")),(T||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(a.exported.now(),f.zoom))&&(this.pauseablePlacement=new id(f,this._order,T,m,b,x,this.placement,this.fog&&f.projection.supportsFog?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,L),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(a.exported.now()),I=!0),P&&this.pauseablePlacement.placement.setStale()),I||P)for(const V of this._order){const H=this._layers[V];H.type==="symbol"&&this.placement.updateLayerOpacities(H,L[H.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(a.exported.now())}_releaseSymbolFadeTiles(){for(const f in this._sourceCaches)this._sourceCaches[f].releaseSymbolFadeTiles()}getImages(f,m,b){this.imageManager.getImages(m.icons,b),this._updateTilesForChangedImages();const x=T=>{T&&T.setDependencies(m.tileID.key,m.type,m.icons)};x(this._otherSourceCaches[m.source]),x(this._symbolSourceCaches[m.source])}getGlyphs(f,m,b){this.glyphManager.getGlyphs(m.stacks,b)}getResource(f,m,b){return a.makeRequest(m,b)}_getSourceCache(f){return this._otherSourceCaches[f]}_getLayerSourceCache(f){return f.type==="symbol"?this._symbolSourceCaches[f.source]:this._otherSourceCaches[f.source]}_getSourceCaches(f){const m=[];return this._otherSourceCaches[f]&&m.push(this._otherSourceCaches[f]),this._symbolSourceCaches[f]&&m.push(this._symbolSourceCaches[f]),m}_isSourceCacheLoaded(f){const m=this._getSourceCaches(f);return m.length===0?(this.fire(new a.ErrorEvent(new Error(`There is no source with ID '${f}'`))),!1):m.every(b=>b.loaded())}has3DLayers(){return this._num3DLayers>0}hasSymbolLayers(){return this._numSymbolLayers>0}hasCircleLayers(){return this._numCircleLayers>0}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}Oa.getSourceType=function(v){return Xe[v]},Oa.setSourceType=function(v,f){Xe[v]=f},Oa.registerForPluginStateChange=a.registerForPluginStateChange;var ad=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#define EXTENT 8192.0
#define HALF_PI PI/2.0
#define QUARTER_PI PI/4.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0`,zE="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",HE=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)
{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}
#ifdef TERRAIN
#ifdef TERRAIN_DEM_FLOAT_FORMAT
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;
#else
uniform sampler2D u_dem;uniform sampler2D u_dem_prev;
#endif
uniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));
#ifdef TERRAIN_DEM_NEAREST_FILTER
return u_exaggeration*tl;
#endif
float tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(
unpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))
);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
float tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;
#else
vec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);
#endif
return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }
#endif`,Km=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,VE=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump float u_fog_temporal_offset;varying vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`;let mw={},gw={};const mf=[];$u(ad,mf),$u(HE,mf),$u(Km,mf),$u(VE,mf),mw=Tn("",HE),gw=Tn(VE,Km);const UE=Tn(`
#if __VERSION__ >=300
#define varying in
#define gl_FragColor glFragColor
#define texture2D texture
#define textureCube texture
out vec4 glFragColor;
#endif
highp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}`,`
#if __VERSION__ >=300
#define attribute in
#define varying out
#define texture2D texture
#endif
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered.`),qm=ad,Xm=`
#ifdef GL_ES
precision mediump float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`;var yw={background:Tn(`uniform vec4 u_color;uniform float u_opacity;
#ifdef LIGHTING_3D_MODE
varying vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#ifdef LIGHTING_3D_MODE
uniform vec4 u_color;varying vec4 v_color;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting(u_color);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:Tn(`uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos;void main() {vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),circle:Tn(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
gl_FragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:Tn("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Tn(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {gl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:Tn(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:Tn("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:Tn("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}",`attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:Tn("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}",`attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;
#endif
varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),fill:Tn(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutline:Tn(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:Tn(`uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;varying vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;varying vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:Tn(`uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:Tn(`varying vec4 v_color;
#ifdef RENDER_SHADOWS
varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef ZERO_ROOF_RADIUS
varying vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
varying highp vec3 v_normal;
#endif
void main() {
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
vec3 normal=v_normal;
#endif
float z;vec4 color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);color=mix(v_color,v_roof_color,z);
#else
color=v_color;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);color.rgb=color.rgb*shade;
#endif
#ifdef RENDER_SHADOWS
#ifdef ZERO_ROOF_RADIUS
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#endif
color.xyz=shadowed_color_normal(color.xyz,normalize(normal),v_pos_light_view_0,v_pos_light_view_1,v_depth);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec4 v_color;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;
#endif
#ifdef ZERO_ROOF_RADIUS
varying vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
varying highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
v_normal=normal;
#endif
base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele;vec3 pos;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);
#ifdef RENDER_SHADOWS
v_pos_light_view_0=u_light_matrix_0*vec4(pos,1);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1);v_depth=gl_Position.w;
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}v_color=vec4(0.0,0.0,0.0,1.0);
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting(color,NdotL);
#else
v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));
#endif
v_color*=u_opacity;
#ifdef ZERO_ROOF_RADIUS
v_roof_color=vec4(0.0,0.0,0.0,1.0);
#ifdef LIGHTING_3D_MODE
v_roof_color=apply_lighting(color,calculate_NdotL(vec3(0.0,0.0,1.0)));
#else
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));
#endif
v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionPattern:Tn(`uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
varying float v_NdotL;
#endif
varying vec2 v_pos;varying vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,v_NdotL)*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec2 v_pos;varying vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
varying float v_NdotL;
#endif
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_NdotL=NdotL;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif 
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),hillshadePrepare:Tn(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
return texture2D(u_image,coord).a/4.0;
#else
vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;
#endif
}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Tn(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
gl_FragColor=apply_lighting(gl_FragColor);
#endif
#ifdef FOG
gl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:Tn(`uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;varying vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
uniform float u_border_width;uniform vec4 u_border_color;float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist=texture2D(u_dash_image,v_tex).a;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture2D(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
float trimmed=1.0;
#ifdef RENDER_LINE_TRIM_OFFSET
highp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {out_color=vec4(0,0,0,0);trimmed=0.0;}}
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef RENDER_LINE_ALPHA_DISCARD
if (alpha < u_alpha_discard_threshold) {discard;}
#endif
#ifdef RENDER_LINE_BORDER
float edgeBlur=(u_border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);
#ifdef RENDER_LINE_BORDER_AUTO
float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}
#else
out_color.rgb=mix(u_border_color.rgb*u_border_color.a*trimmed,out_color.rgb,smoothAlpha);
#endif
}
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define EXTRUDE_SCALE 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
attribute highp vec4 a_packed;
#endif
#ifdef RENDER_LINE_DASH
attribute float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;varying vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);
#else
v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),linePattern:Tn(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;vec2 pattern_size=vec2(display_size.x/u_tile_units_to_pixels,display_size.y);float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x=mod(v_linesofar/pattern_size.x*aspect,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));vec4 color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
color=apply_lighting(color);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),raster:Tn(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply(out_color,v_fog_pos));
#endif
gl_FragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {float w=1.0+dot(a_texture_pos,u_perspective_transform);gl_Position=u_matrix*vec4(a_pos*w,0,w);v_pos0=a_texture_pos/8192.0;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),symbolIcon:Tn(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;}`),symbolSDF:Tn(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float gamma_scale=gl_Position.w;float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade);}`),symbolTextAndIcon:Tn(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade,is_sdf);}`),terrainRaster:Tn(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#endif
void main() {vec4 color=texture2D(u_image0,v_pos0);
#ifdef RENDER_SHADOWS
color.xyz=shadowed_color(color.xyz,v_pos_light_view_0,v_pos_light_view_1,v_depth);
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#endif
const float wireframeOffset=0.00015;void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;
#ifdef TERRAIN_WIREFRAME
elevation+=wireframeOffset;
#endif
v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);v_depth=gl_Position.w;
#endif
}`),terrainDepth:Tn(`#ifdef GL_ES
precision highp float;
#endif
varying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}`,"uniform mat4 u_matrix;attribute vec2 a_pos;varying float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:Tn(`
varying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,zE),skyboxGradient:Tn(`varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,zE),skyboxCapture:Tn(`
varying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;
#ifdef GL_ES
precision highp float;
#endif
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}`,"attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:Tn(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture2D(u_image0,v_pos0);color=vec4(raster.rgb*antialias,raster.a*antialias);
#else
color=texture2D(u_image0,v_pos0);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;
#ifdef GLOBE_POLES
attribute vec3 a_globe_pos;attribute vec2 a_uv;
#else
attribute vec2 a_pos;
#endif
varying vec2 v_pos0;const float wireframeOffset=1e3;float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(QUARTER_PI+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;
#ifdef GLOBE_POLES
vec3 up_vector=globe_derived_up_vector;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);
#ifdef TERRAIN_WIREFRAME
height+=wireframeOffset;
#endif
globe_pos+=up_vector*height;
#ifndef GLOBE_POLES
globe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;
#endif
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:Tn(`uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec3 u_start_color;uniform vec4 u_color;uniform vec4 u_space_color;uniform vec4 u_high_color;uniform float u_star_intensity;uniform float u_star_size;uniform float u_star_density;uniform float u_horizon_angle;uniform mat4 u_rotation_matrix;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;highp float random(highp vec3 p) {p=fract(p*vec3(23.2342,97.1231,91.2342));p+=dot(p.zxy,p.yxz+123.1234);return fract(p.x*p.y);}float stars(vec3 p,float scale,vec2 offset) {vec2 uv_scale=(u_viewport/u_star_size)*scale;vec3 position=vec3(p.xy*uv_scale+offset*u_viewport,p.z);vec3 q=fract(position)-0.5;vec3 id=floor(position);float random_visibility=step(random(id),u_star_density);float circle=smoothstep(0.5+u_star_intensity,0.5,length(q));return circle*random_visibility;}void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {discard;return;}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(dot(dir,horizon_dir)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;float closest_point_to_center=length(closest_point-u_globe_pos);float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c =mix(color_stop_2,c2,t);float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);vec2 uv=gl_FragCoord.xy/u_viewport-0.5;float aspect_ratio=u_viewport.x/u_viewport.y;vec4 uv_dir=vec4(normalize(vec3(uv.x*aspect_ratio,uv.y,1.0)),1.0);uv_dir=u_rotation_matrix*uv_dir;vec3 n=abs(uv_dir.xyz);vec2 uv_remap=(n.x > n.y && n.x > n.z) ? uv_dir.yz/uv_dir.x:
(n.y > n.x && n.y > n.z) ? uv_dir.zx/uv_dir.y:
uv_dir.xy/uv_dir.z;uv_remap.x/=aspect_ratio;vec3 D=vec3(uv_remap,1.0);highp float star_field=0.0;if (u_star_intensity > 0.0) {star_field+=stars(D,1.2,vec2(0.0,0.0));star_field+=stars(D,1.0,vec2(1.0,0.0));star_field+=stars(D,0.8,vec2(0.0,1.0));star_field+=stars(D,0.6,vec2(1.0,1.0));star_field*=(1.0-pow(t,0.25+(1.0-u_high_color.a)*0.75));c+=star_field*alpha_2;}c=dither(c,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=vec4(c,a);}`,`attribute vec3 a_pos;attribute vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`)};function $u(v,f){const m=v.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let b of m)if(b=b.trim(),b[0]==="#"&&b.includes("if")&&!b.includes("endif")){b=b.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const x=b.split(" ");for(const T of x)f.includes(T)||f.push(T)}}function Tn(v,f){const m=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,b=f.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),x={},T=[...mf];return $u(v,T),$u(f,T),{fragmentSource:v=v.replace(m,(P,I,L,V,H)=>(x[H]=!0,I==="define"?`
#ifndef HAS_UNIFORM_u_${H}
varying ${L} ${V} ${H};
#else
uniform ${L} ${V} u_${H};
#endif
`:`
#ifdef HAS_UNIFORM_u_${H}
    ${L} ${V} ${H} = u_${H};
#endif
`)),vertexSource:f=f.replace(m,(P,I,L,V,H)=>{const X=V==="float"?"vec2":"vec4",ne=H.match(/color/)?"color":X;return x[H]?I==="define"?`
#ifndef HAS_UNIFORM_u_${H}
uniform lowp float u_${H}_t;
attribute ${L} ${X} a_${H};
varying ${L} ${V} ${H};
#else
uniform ${L} ${V} u_${H};
#endif
`:ne==="vec4"?`
#ifndef HAS_UNIFORM_u_${H}
    ${H} = a_${H};
#else
    ${L} ${V} ${H} = u_${H};
#endif
`:`
#ifndef HAS_UNIFORM_u_${H}
    ${H} = unpack_mix_${ne}(a_${H}, u_${H}_t);
#else
    ${L} ${V} ${H} = u_${H};
#endif
`:I==="define"?`
#ifndef HAS_UNIFORM_u_${H}
uniform lowp float u_${H}_t;
attribute ${L} ${X} a_${H};
#else
uniform ${L} ${V} u_${H};
#endif
`:ne==="vec4"?`
#ifndef HAS_UNIFORM_u_${H}
    ${L} ${V} ${H} = a_${H};
#else
    ${L} ${V} ${H} = u_${H};
#endif
`:`
#ifndef HAS_UNIFORM_u_${H}
    ${L} ${V} ${H} = unpack_mix_${ne}(a_${H}, u_${H}_t);
#else
    ${L} ${V} ${H} = u_${H};
#endif
`}),staticAttributes:b,usedDefines:T}}class sd{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(f,m,b,x,T,P,I){this.context=f;let L=this.boundPaintVertexBuffers.length!==x.length;for(let H=0;!L&&H<x.length;H++)this.boundPaintVertexBuffers[H]!==x[H]&&(L=!0);let V=this.boundDynamicVertexBuffers.length!==I.length;for(let H=0;!V&&H<I.length;H++)this.boundDynamicVertexBuffers[H]!==I[H]&&(V=!0);if(!f.extVertexArrayObject||!this.vao||this.boundProgram!==m||this.boundLayoutVertexBuffer!==b||L||V||this.boundIndexBuffer!==T||this.boundVertexOffset!==P)this.freshBind(m,b,x,T,P,I);else{f.bindVertexArrayOES.set(this.vao);for(const H of I)H&&H.bind();T&&T.dynamicDraw&&T.bind()}}freshBind(f,m,b,x,T,P){let I;const L=f.numAttributes,V=this.context,H=V.gl;if(V.extVertexArrayObject)this.vao&&this.destroy(),this.vao=V.extVertexArrayObject.createVertexArrayOES(),V.bindVertexArrayOES.set(this.vao),I=0,this.boundProgram=f,this.boundLayoutVertexBuffer=m,this.boundPaintVertexBuffers=b,this.boundIndexBuffer=x,this.boundVertexOffset=T,this.boundDynamicVertexBuffers=P;else{I=V.currentNumAttributes||0;for(let X=L;X<I;X++)H.disableVertexAttribArray(X)}m.enableAttributes(H,f),m.bind(),m.setVertexAttribPointers(H,f,T);for(const X of b)X.enableAttributes(H,f),X.bind(),X.setVertexAttribPointers(H,f,T);for(const X of P)X&&(X.enableAttributes(H,f),X.bind(),X.setVertexAttribPointers(H,f,T));x&&x.bind(),V.currentNumAttributes=L}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function vw(v,f){const m=Math.pow(2,f.canonical.z),b=f.canonical.y;return[new a.MercatorCoordinate(0,b/m).toLngLat().lat,new a.MercatorCoordinate(0,(b+1)/m).toLngLat().lat]}function ld(v,f,m,b,x,T,P){const I=v.context,L=I.gl,V=m.fbo;if(!V)return;v.prepareDrawTile();const H=v.useProgram("hillshade");I.activeTexture.set(L.TEXTURE0),L.bindTexture(L.TEXTURE_2D,V.colorAttachment.get());const X=((ue,ce,te,_e)=>{const ve=te.paint.get("hillshade-shadow-color"),be=te.paint.get("hillshade-highlight-color"),$e=te.paint.get("hillshade-accent-color");let Ae=te.paint.get("hillshade-illumination-direction")*(Math.PI/180);te.paint.get("hillshade-illumination-anchor")==="viewport"&&(Ae-=ue.transform.angle);const Be=!ue.options.moving;return{u_matrix:_e||ue.transform.calculateProjMatrix(ce.tileID.toUnwrapped(),Be),u_image:0,u_latrange:vw(0,ce.tileID),u_light:[te.paint.get("hillshade-exaggeration"),Ae],u_shadow:ve,u_highlight:be,u_accent:$e}})(v,m,b,v.terrain?f.projMatrix:null);v.prepareDrawProgram(I,H,f.toUnwrapped());const{tileBoundsBuffer:ne,tileBoundsIndexBuffer:ae,tileBoundsSegments:le}=v.getTileBoundsBuffers(m);H.draw(I,L.TRIANGLES,x,T,P,a.CullFaceMode.disabled,X,b.id,ne,ae,le)}function ud(v,f,m){if(!f.needsDEMTextureUpload)return;const b=v.context,x=b.gl;b.pixelStoreUnpackPremultiplyAlpha.set(!1),f.demTexture=f.demTexture||v.getTileTexture(m.stride);const T=m.getPixels();f.demTexture?f.demTexture.update(T,{premultiply:!1}):f.demTexture=new a.Texture(b,T,x.RGBA,{premultiply:!1}),f.needsDEMTextureUpload=!1}function Zm(v,f,m,b,x,T){const P=v.context,I=P.gl;if(!f.dem)return;const L=f.dem;if(P.activeTexture.set(I.TEXTURE1),ud(v,f,L),!f.demTexture)return;f.demTexture.bind(I.NEAREST,I.CLAMP_TO_EDGE);const V=L.dim;P.activeTexture.set(I.TEXTURE0);let H=f.fbo;if(!H){const le=new a.Texture(P,{width:V,height:V,data:null},I.RGBA);le.bind(I.LINEAR,I.CLAMP_TO_EDGE),H=f.fbo=P.createFramebuffer(V,V,!0),H.colorAttachment.set(le.texture)}P.bindFramebuffer.set(H.framebuffer),P.viewport.set([0,0,V,V]);const{tileBoundsBuffer:X,tileBoundsIndexBuffer:ne,tileBoundsSegments:ae}=v.getMercatorTileBoundsBuffers();v.useProgram("hillshadePrepare").draw(P,I.TRIANGLES,b,x,T,a.CullFaceMode.disabled,((le,ue)=>{const ce=ue.stride,te=a.create();return a.ortho(te,0,a.EXTENT,-a.EXTENT,0,0,1),a.translate(te,te,[0,-a.EXTENT,0]),{u_matrix:te,u_image:1,u_dimension:[ce,ce],u_zoom:le.overscaledZ,u_unpack:ue.unpackVector}})(f.tileID,L),m.id,X,ne,ae),f.needsHillshadePrepare=!1}const Jm=v=>({u_matrix:new a.UniformMatrix4f(v),u_image0:new a.Uniform1i(v),u_skirt_height:new a.Uniform1f(v)}),_w=(v,f)=>({u_matrix:v,u_image0:0,u_skirt_height:f}),Qm=(v,f,m,b,x,T,P,I,L,V,H,X,ne,ae,le)=>({u_proj_matrix:Float32Array.from(v),u_globe_matrix:f,u_normalize_matrix:Float32Array.from(b),u_merc_matrix:m,u_zoom_transition:x,u_merc_center:T,u_image0:0,u_frustum_tl:P,u_frustum_tr:I,u_frustum_br:L,u_frustum_bl:V,u_globe_pos:H,u_globe_radius:X,u_viewport:ne,u_grid_matrix:le?Float32Array.from(le):new Float32Array(9),u_skirt_height:ae});function bw(v,f){return v!=null&&f!=null&&!(!v.hasData()||!f.hasData())&&v.demTexture!=null&&f.demTexture!=null&&v.tileID.key!==f.tileID.key}const Nl=new class{constructor(){this.operations={}}newMorphing(v,f,m,b,x){if(v in this.operations){const T=this.operations[v];T.to.tileID.key!==m.tileID.key&&(T.queued=m)}else this.operations[v]={startTime:b,phase:0,duration:x,from:f,to:m,queued:null}}getMorphValuesForProxy(v){if(!(v in this.operations))return null;const f=this.operations[v];return{from:f.from,to:f.to,phase:f.phase}}update(v){for(const f in this.operations){const m=this.operations[f];for(m.phase=(v-m.startTime)/m.duration;m.phase>=1||!this._validOp(m);)if(!this._nextOp(m,v)){delete this.operations[f];break}}}_nextOp(v,f){return!!v.queued&&(v.from=v.to,v.to=v.queued,v.queued=null,v.phase=0,v.startTime=f,!0)}_validOp(v){return v.from.hasData()&&v.to.hasData()}},Du={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function eg(v){return 6*Math.pow(1.5,22-v)}function ww(v,f){const m=1<<v.z;return!f&&(v.x===0||v.x===m-1)||v.y===0||v.y===m-1}const gn=v=>({u_matrix:v});function cd(v,f,m,b,x){if(x>0){const T=a.exported.now(),P=(T-v.timeAdded)/x,I=f?(T-f.timeAdded)/x:-1,L=m.getSource(),V=b.coveringZoomLevel({tileSize:L.tileSize,roundZoom:L.roundZoom}),H=!f||Math.abs(f.tileID.overscaledZ-V)>Math.abs(v.tileID.overscaledZ-V),X=H&&v.refreshedUponExpiration?1:a.clamp(H?P:1-I,0,1);return v.refreshedUponExpiration&&P>=1&&(v.refreshedUponExpiration=!1),f?{opacity:1,mix:1-X}:{opacity:X,mix:0}}return{opacity:1,mix:0}}class WE extends a.SourceCache{constructor(f){const m={type:"raster-dem",maxzoom:f.transform.maxZoom},b=new me(bt(),null),x=Ge("mock-dem",m,b,f.style);super("mock-dem",x,!1),x.setEventedParent(this),this._sourceLoaded=!0}_loadTile(f,m){f.state="loaded",m(null)}}class GE extends a.SourceCache{constructor(f){const m=Ge("proxy",{type:"geojson",maxzoom:f.transform.maxZoom},new me(bt(),null),f.style);super("proxy",m,!1),m.setEventedParent(this),this.map=this.getSource().map=f,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(f,m,b){if(f.freezeTileCoverage)return;this.transform=f;const x=f.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((T,P)=>{if(T[P.key]="",!this._tiles[P.key]){const I=new a.Tile(P,this._source.tileSize*P.overscaleFactor(),f.tileZoom);I.state="loaded",this._tiles[P.key]=I}return T},{});for(const T in this._tiles)T in x||(this.freeFBO(T),this._tiles[T].unloadVectorData(),delete this._tiles[T])}freeFBO(f){const m=this.proxyCachedFBO[f];if(m!==void 0){const b=Object.values(m);this.renderCachePool.push(...b),delete this.proxyCachedFBO[f]}}deallocRenderCache(){this.renderCache.forEach(f=>f.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class Sw extends a.OverscaledTileID{constructor(f,m,b){super(f.overscaledZ,f.wrap,f.canonical.z,f.canonical.x,f.canonical.y),this.proxyTileKey=m,this.projMatrix=b}}class xw extends a.Elevation{constructor(f,m){super(),this.painter=f,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[b,x,T]=function(L){const V=new a.StructArrayLayout2i4,H=new a.StructArrayLayout3ui6,X=131;V.reserve(17161),H.reserve(33800);const ne=a.EXTENT/128,ae=a.EXTENT+ne/2,le=ae+ne;for(let ce=-ne;ce<le;ce+=ne)for(let te=-ne;te<le;te+=ne){const _e=te<0||te>ae||ce<0||ce>ae?24575:0,ve=a.clamp(Math.round(te),0,a.EXTENT),be=a.clamp(Math.round(ce),0,a.EXTENT);V.emplaceBack(ve+_e,be)}const ue=(ce,te)=>{const _e=te*X+ce;H.emplaceBack(_e+1,_e,_e+X),H.emplaceBack(_e+X,_e+X+1,_e+1)};for(let ce=1;ce<129;ce++)for(let te=1;te<129;te++)ue(te,ce);return[0,129].forEach(ce=>{for(let te=0;te<130;te++)ue(te,ce),ue(ce,te)}),[V,H,32768]}(),P=f.context;this.gridBuffer=P.createVertexBuffer(b,a.posAttributes.members),this.gridIndexBuffer=P.createIndexBuffer(x),this.gridSegments=a.SegmentVector.simpleSegment(0,0,b.length,x.length),this.gridNoSkirtSegments=a.SegmentVector.simpleSegment(0,0,b.length,T),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new GE(m.map),this.orthoMatrix=a.create(),a.ortho(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,a.EXTENT,0,a.EXTENT,0,1);const I=P.gl;this._overlapStencilMode=new a.StencilMode({func:I.GEQUAL,mask:255},0,255,I.KEEP,I.KEEP,I.REPLACE),this._previousZoom=f.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=m,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new WE(m.map)}set style(f){f.on("data",this._onStyleDataEvent.bind(this)),f.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=f,this._checkRenderCacheEfficiency(),this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(f,m,b){if(f&&f.terrain){this._style!==f&&(this.style=f),this.enabled=!0;const x=f.terrain.properties;this.sourceCache=f.terrain.drapeRenderMode===0?this._mockSourceCache:f._getSourceCache(x.get("source")),this._exaggeration=x.get("exaggeration");const T=()=>{this.sourceCache.used&&a.warnOnce(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const P=this.getScaledDemTileSize();this.sourceCache.update(m,P,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,T(),this._initializing=!0),T(),m.updateElevation(!0,b),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(m),this._emptyDEMTextureDirty=!0}else this._disable()}resetTileLookupCache(f){this._findCoveringTileCache[f]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_checkRenderCacheEfficiency(){const f=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||f.efficiency!==100&&a.warnOnce(`Terrain render cache efficiency is not optimal (${f.efficiency}%) and performance
                may be affected negatively, consider placing all background, fill and line layers before layer
                with id '${f.firstUndrapedLayer}' or create a map using optimizeForTerrain: true option.`)}_onStyleDataEvent(f){f.coord&&f.dataType==="source"?this._clearRenderCacheForTile(f.sourceCacheId,f.coord):f.dataType==="style"&&(this._invalidateRenderCache=!0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const f in this._style._sourceCaches)this._style._sourceCaches[f].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(f=>f.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0)}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const f=2*this.proxySourceCache.getSource().tileSize;return[f,f]}set useVertexMorphing(f){this._useVertexMorphing=f}updateTileBinding(f){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const m=this.proxySourceCache,b=this.painter.transform;this._initializing&&(this._initializing=b._centerAltitude===0&&this.getAtPointOrZero(a.MercatorCoordinate.fromLngLat(b.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const x=this.proxyCoords=m.getIds().map(L=>{const V=m.getTileByID(L).tileID;return V.projMatrix=b.calculateProjMatrix(V.toUnwrapped()),V});(function(L,V){const H=V.transform.pointCoordinate(V.transform.getCameraPoint()),X=new a.pointGeometry(H.x,H.y);L.sort((ne,ae)=>{if(ae.overscaledZ-ne.overscaledZ)return ae.overscaledZ-ne.overscaledZ;const le=new a.pointGeometry(ne.canonical.x+(1<<ne.canonical.z)*ne.wrap,ne.canonical.y),ue=new a.pointGeometry(ae.canonical.x+(1<<ae.canonical.z)*ae.wrap,ae.canonical.y),ce=X.mult(1<<ne.canonical.z);return ce.x-=.5,ce.y-=.5,ce.distSqr(le)-ce.distSqr(ue)})})(x,this.painter),this._previousZoom=b.zoom;const T=this.proxyToSource||{};this.proxyToSource={},x.forEach(L=>{this.proxyToSource[L.key]={}}),this.terrainTileForTile={};const P=this._style._sourceCaches;for(const L in P){const V=P[L];if(!V.used||(V!==this.sourceCache&&this.resetTileLookupCache(V.id),this._setupProxiedCoordsForOrtho(V,f[L],T),V.usedForTerrain))continue;const H=f[L];V.getSource().reparseOverscaled&&this._assignTerrainTiles(H)}this.proxiedCoords[m.id]=x.map(L=>new Sw(L,L.key,this.orthoMatrix)),this._assignTerrainTiles(x),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(T),this.renderingToTexture=!1,this._updateTimestamp=a.exported.now();const I={};this._visibleDemTiles=[];for(const L of this.proxyCoords){const V=this.terrainTileForTile[L.key];if(!V)continue;const H=V.tileID.key;H in I||(this._visibleDemTiles.push(V),I[H]=H)}}_assignTerrainTiles(f){this._initializing||f.forEach(m=>{if(this.terrainTileForTile[m.key])return;const b=this._findTileCoveringTileID(m,this.sourceCache);b&&(this.terrainTileForTile[m.key]=b)})}_prepareDEMTextures(){const f=this.painter.context,m=f.gl;for(const b in this.terrainTileForTile){const x=this.terrainTileForTile[b],T=x.dem;!T||x.demTexture&&!x.needsDEMTextureUpload||(f.activeTexture.set(m.TEXTURE1),ud(this.painter,x,T))}}_prepareDemTileUniforms(f,m,b,x){if(!m||m.demTexture==null)return!1;const T=f.tileID.canonical,P=Math.pow(2,m.tileID.canonical.z-T.z),I=x||"";return b[`u_dem_tl${I}`]=[T.x*P%1,T.y*P%1],b[`u_dem_scale${I}`]=P,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const f=this.painter.context,m=f.gl;if(!this._emptyDepthBufferTexture){const b=new a.RGBAImage({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new a.Texture(f,b,m.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let f=0;const m=this._visibleDemTiles.reduce((b,x)=>{if(!x.dem)return b;const T=x.dem.tree.minimums[0];return T>0&&f++,b+T},0);return f?m/f:0}_updateEmptyDEMTexture(){const f=this.painter.context,m=f.gl;f.activeTexture.set(m.TEXTURE2);const b=this._getLoadedAreaMinimum(),x=new a.RGBAImage({width:1,height:1},new Uint8Array(a.DEMData.pack(b,this.sourceCache.getSource().encoding)));this._emptyDEMTextureDirty=!1;let T=this._emptyDEMTexture;return T?T.update(x,{premultiply:!1}):T=this._emptyDEMTexture=new a.Texture(f,x,m.RGBA,{premultiply:!1}),T}setupElevationDraw(f,m,b){const x=this.painter.context,T=x.gl,P=(I=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:a.DEMData.getUnpackVector(I),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0});var I;P.u_dem_size=this.sourceCache.getSource().tileSize,P.u_exaggeration=this.exaggeration();let L=null,V=null,H=1;if(b&&b.morphing&&this._useVertexMorphing){const X=b.morphing.srcDemTile,ne=b.morphing.dstDemTile;H=b.morphing.phase,X&&ne&&(this._prepareDemTileUniforms(f,X,P,"_prev")&&(V=X),this._prepareDemTileUniforms(f,ne,P)&&(L=ne))}if(V&&L?(x.activeTexture.set(T.TEXTURE2),L.demTexture.bind(T.NEAREST,T.CLAMP_TO_EDGE,T.NEAREST),x.activeTexture.set(T.TEXTURE4),V.demTexture.bind(T.NEAREST,T.CLAMP_TO_EDGE,T.NEAREST),P.u_dem_lerp=H):(L=this.terrainTileForTile[f.tileID.key],x.activeTexture.set(T.TEXTURE2),(this._prepareDemTileUniforms(f,L,P)?L.demTexture:this.emptyDEMTexture).bind(T.NEAREST,T.CLAMP_TO_EDGE)),x.activeTexture.set(T.TEXTURE3),b&&b.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(T.NEAREST,T.CLAMP_TO_EDGE),this._depthFBO&&(P.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(T.NEAREST,T.CLAMP_TO_EDGE),P.u_depth_size_inv=[1,1]),b&&b.useMeterToDem&&L){const X=(1<<L.tileID.canonical.z)*a.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;P.u_meter_to_dem=X}if(b&&b.labelPlaneMatrixInv&&(P.u_label_plane_matrix_inv=b.labelPlaneMatrixInv),m.setTerrainUniformValues(x,P),this.painter.transform.projection.name==="globe"){const X=this.globeUniformValues(this.painter.transform,f.tileID.canonical,b&&b.useDenormalizedUpVectorScale);m.setGlobeUniformValues(x,X)}}globeUniformValues(f,m,b){const x=f.projection;return{u_tile_tl_up:x.upVector(m,0,0),u_tile_tr_up:x.upVector(m,a.EXTENT,0),u_tile_br_up:x.upVector(m,a.EXTENT,a.EXTENT),u_tile_bl_up:x.upVector(m,0,a.EXTENT),u_tile_up_scale:b?a.globeMetersToEcef(1):x.upVectorScale(m,f.center.lat,f.worldSize).metersToTile}}renderToBackBuffer(f){const m=this.painter,b=this.painter.context;f.length!==0&&(b.bindFramebuffer.set(null),b.viewport.set([0,0,m.width,m.height]),m.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(x,T,P,I,L){if(x.transform.projection.name==="globe")(function(V,H,X,ne,ae){const le=V.context,ue=le.gl;let ce,te;const _e=V.options.showTerrainWireframe?2:0,ve=V.transform,be=a.globeUseCustomAntiAliasing(V,le,ve),$e=(Mt,st)=>{if(te===Mt)return;const Ke=[Du[Mt],"PROJECTION_GLOBE_VIEW"];be&&Ke.push("CUSTOM_ANTIALIASING"),st&&Ke.push(Du[_e]),ce=V.useProgram("globeRaster",null,Ke),te=Mt},Ae=V.colorModeForRenderPass(),Be=new a.DepthMode(ue.LEQUAL,a.DepthMode.ReadWrite,V.depthRangeFor3D);Nl.update(ae);const Ze=a.calculateGlobeMercatorMatrix(ve),ot=[a.mercatorXfromLng(ve.center.lng),a.mercatorYfromLat(ve.center.lat)],ut=_e?[!1,!0]:[!1],zt=V.globeSharedBuffers,rt=[ve.width*a.exported.devicePixelRatio,ve.height*a.exported.devicePixelRatio],Ot=Float32Array.from(ve.globeMatrix),vt={useDenormalizedUpVectorScale:!0};if(ut.forEach(Mt=>{const st=V.transform,Ke=eg(st.zoom)*H.exaggeration();te=-1;const dt=Mt?ue.LINES:ue.TRIANGLES;for(const Pt of ne){const Lt=X.getTile(Pt),cr=a.StencilMode.disabled,Vr=H.prevTerrainTileForTile[Pt.key],ir=H.terrainTileForTile[Pt.key];bw(Vr,ir)&&Nl.newMorphing(Pt.key,Vr,ir,ae,250),le.activeTexture.set(ue.TEXTURE0),Lt.texture.bind(ue.LINEAR,ue.CLAMP_TO_EDGE);const rr=Nl.getMorphValuesForProxy(Pt.key),hr=rr?1:0;rr&&a.extend$1(vt,{morphing:{srcDemTile:rr.from,dstDemTile:rr.to,phase:a.easeCubicInOut(rr.phase)}});const Zr=a.tileCornersToBounds(Pt.canonical),_r=a.getLatitudinalLod(Zr.getCenter().lat),On=a.getGridMatrix(Pt.canonical,Zr,_r,st.worldSize/st._pixelsPerMercatorPixel),kn=a.globeNormalizeECEF(a.globeTileBounds(Pt.canonical)),Vn=Qm(st.projMatrix,Ot,Ze,kn,a.globeToMercatorTransition(st.zoom),ot,st.frustumCorners.TL,st.frustumCorners.TR,st.frustumCorners.BR,st.frustumCorners.BL,st.globeCenterInViewSpace,st.globeRadius,rt,Ke,On);if($e(hr,Mt),H.setupElevationDraw(Lt,ce,vt),V.prepareDrawProgram(le,ce,Pt.toUnwrapped()),zt){const[Nn,Ri,Wo]=Mt?zt.getWirefameBuffers(V.context,_r):zt.getGridBuffers(_r,Ke!==0);ce.draw(le,dt,Be,cr,Ae,a.CullFaceMode.backCCW,Vn,"globe_raster",Nn,Ri,Wo)}}}),zt){const Mt=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];be&&Mt.push("CUSTOM_ANTIALIASING"),ce=V.useProgram("globeRaster",null,Mt);for(const st of ne){const{x:Ke,y:dt,z:Pt}=st.canonical,Lt=dt===0,cr=dt===(1<<Pt)-1,[Vr,ir,rr,hr]=zt.getPoleBuffers(Pt);if(hr&&(Lt||cr)){const Zr=X.getTile(st);le.activeTexture.set(ue.TEXTURE0),Zr.texture.bind(ue.LINEAR,ue.CLAMP_TO_EDGE);let _r=a.globePoleMatrixForTile(Pt,Ke,ve);const On=a.globeNormalizeECEF(a.globeTileBounds(st.canonical)),kn=(Vn,Nn)=>Vn.draw(le,ue.TRIANGLES,Be,a.StencilMode.disabled,Ae,a.CullFaceMode.disabled,Qm(ve.projMatrix,_r,_r,On,0,ot,ve.frustumCorners.TL,ve.frustumCorners.TR,ve.frustumCorners.BR,ve.frustumCorners.BL,ve.globeCenterInViewSpace,ve.globeRadius,rt,0),"globe_pole_raster",Nn,rr,hr);H.setupElevationDraw(Zr,ce,vt),V.prepareDrawProgram(le,ce,st.toUnwrapped()),Lt&&kn(ce,Vr),cr&&(_r=a.scale(a.create(),_r,[1,-1,1]),kn(ce,ir))}}}})(x,T,P,I,L);else{const V=x.context,H=V.gl;let X,ne;const ae=x.options.showTerrainWireframe?2:0,le=(ve,be)=>{if(ne===ve)return;const $e=[Du[ve]];be&&$e.push(Du[ae]),X=x.useProgram("terrainRaster",null,$e),ne=ve},ue=x.colorModeForRenderPass(),ce=new a.DepthMode(H.LEQUAL,a.DepthMode.ReadWrite,x.depthRangeFor3D);Nl.update(L);const te=x.transform,_e=eg(te.zoom)*T.exaggeration();(ae?[!1,!0]:[!1]).forEach(ve=>{ne=-1;const be=ve?H.LINES:H.TRIANGLES,[$e,Ae]=ve?T.getWirefameBuffer():[T.gridIndexBuffer,T.gridSegments];for(const Be of I){const Ze=P.getTile(Be),ot=a.StencilMode.disabled,ut=T.prevTerrainTileForTile[Be.key],zt=T.terrainTileForTile[Be.key];bw(ut,zt)&&Nl.newMorphing(Be.key,ut,zt,L,250),V.activeTexture.set(H.TEXTURE0),Ze.texture.bind(H.LINEAR,H.CLAMP_TO_EDGE,H.LINEAR_MIPMAP_NEAREST);const rt=Nl.getMorphValuesForProxy(Be.key),Ot=rt?1:0;let vt;rt&&(vt={morphing:{srcDemTile:rt.from,dstDemTile:rt.to,phase:a.easeCubicInOut(rt.phase)}});const Mt=_w(Be.projMatrix,ww(Be.canonical,te.renderWorldCopies)?_e/10:_e);le(Ot,ve),T.setupElevationDraw(Ze,X,vt),x.prepareDrawProgram(V,X,Be.toUnwrapped()),X.draw(V,be,ce,ot,ue,a.CullFaceMode.backCCW,Mt,"terrain_raster",T.gridBuffer,$e,Ae)}})}}(m,this,this.proxySourceCache,f,this._updateTimestamp),this.renderingToTexture=!0,m.gpuTimingDeferredRenderEnd(),f.splice(0,f.length))}renderBatch(f){if(this._drapedRenderBatches.length===0)return f+1;this.renderingToTexture=!0;const m=this.painter,b=this.painter.context,x=this.proxySourceCache,T=this.proxiedCoords[x.id],P=this._drapedRenderBatches.shift(),I=[],L=m.style.order;let V=0;for(const H of T){const X=x.getTileByID(H.proxyTileKey),ne=x.proxyCachedFBO[H.key]?x.proxyCachedFBO[H.key][f]:void 0,ae=ne!==void 0?x.renderCache[ne]:this.pool[V++],le=ne!==void 0;if(X.texture=ae.tex,le&&!ae.dirty){I.push(X.tileID);continue}let ue;b.bindFramebuffer.set(ae.fb.framebuffer),this.renderedToTile=!1,ae.dirty&&(b.clear({color:a.Color.transparent,stencil:0}),ae.dirty=!1);for(let ce=P.start;ce<=P.end;++ce){const te=m.style._layers[L[ce]];if(te.isHidden(m.transform.zoom))continue;const _e=m.style._getLayerSourceCache(te),ve=_e?this.proxyToSource[H.key][_e.id]:[H];if(!ve)continue;const be=ve;b.viewport.set([0,0,ae.fb.width,ae.fb.height]),ue!==(_e?_e.id:null)&&(this._setupStencil(ae,ve,te,_e),ue=_e?_e.id:null),m.renderLayer(m,_e,te,be)}this.renderedToTile?(ae.dirty=!0,I.push(X.tileID)):le||--V,V===5&&(V=0,this.renderToBackBuffer(I))}return this.renderToBackBuffer(I),this.renderingToTexture=!1,b.bindFramebuffer.set(null),b.viewport.set([0,0,m.width,m.height]),P.end+1}postRender(){}renderCacheEfficiency(f){const m=f.order.length;if(m===0)return{efficiency:100};let b,x=0,T=0,P=!1;for(let I=0;I<m;++I){const L=f._layers[f.order[I]];this._style.isLayerDraped(L)?(P&&++x,++T):P||(P=!0,b=L.id)}return T===0?{efficiency:100}:{efficiency:100*(1-x/T),firstUndrapedLayer:b}}getMinElevationBelowMSL(){let f=0;return this._visibleDemTiles.filter(m=>m.dem).forEach(m=>{f=Math.min(f,m.dem.tree.minimums[0])}),f===0?f:(f-30)*this._exaggeration}raycast(f,m,b){if(!this._visibleDemTiles)return null;const x=this._visibleDemTiles.filter(T=>T.dem).map(T=>{const P=T.tileID,I=1<<P.overscaledZ,{x:L,y:V}=P.canonical,H=L/I,X=(L+1)/I,ne=V/I,ae=(V+1)/I;return{minx:H,miny:ne,maxx:X,maxy:ae,t:T.dem.tree.raycastRoot(H,ne,X,ae,f,m,b),tile:T}});x.sort((T,P)=>(T.t!==null?T.t:Number.MAX_VALUE)-(P.t!==null?P.t:Number.MAX_VALUE));for(const T of x){if(T.t==null)return null;const P=T.tile.dem.tree.raycast(T.minx,T.miny,T.maxx,T.maxy,f,m,b);if(P!=null)return P}return null}_createFBO(){const f=this.painter.context,m=f.gl,b=this.drapeBufferSize;f.activeTexture.set(m.TEXTURE0);const x=new a.Texture(f,{width:b[0],height:b[1],data:null},m.RGBA);x.bind(m.LINEAR,m.CLAMP_TO_EDGE);const T=f.createFramebuffer(b[0],b[1],!1);return T.colorAttachment.set(x.texture),T.depthAttachment=new aa(f,T.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=f.createRenderbuffer(f.gl.DEPTH_STENCIL,b[0],b[1]),this._stencilRef=0,T.depthAttachment.set(this._sharedDepthStencil),f.clear({stencil:0})):T.depthAttachment.set(this._sharedDepthStencil),f.extTextureFilterAnisotropic&&!f.extTextureFilterAnisotropicForceOff&&m.texParameterf(m.TEXTURE_2D,f.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,f.extTextureFilterAnisotropicMax),{fb:T,tex:x,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.light&&this._style.light.hasTransition())return!0;for(const f in this._style._sourceCaches)if(this._style._sourceCaches[f].hasTransition())return!0;return this._style.order.some(f=>{const m=this._style._layers[f],b=m.isHidden(this.painter.transform.zoom);return m.type==="custom"?!b&&m.shouldRedrape():!b&&m.hasTransition()})}_clearLineLayersFromRenderCache(){let f=!1;for(const b of this._style._getSources())if(b instanceof Z){f=!0;break}if(!f)return;const m={};for(let b=0;b<this._style.order.length;++b){const x=this._style._layers[this._style.order[b]],T=this._style._getLayerSourceCache(x);if(T&&!m[T.id]&&!x.isHidden(this.painter.transform.zoom)&&x.type==="line"&&x.widthExpression()instanceof a.ZoomDependentExpression){m[T.id]=!0;for(const P of this.proxyCoords){const I=this.proxyToSource[P.key][T.id];if(I)for(const L of I)this._clearRenderCacheForTile(T.id,L)}}}}_clearRasterLayersFromRenderCache(){let f=!1;for(const b in this._style._sourceCaches)if(this._style._sourceCaches[b]._source instanceof ee){f=!0;break}if(!f)return;const m={};for(let b=0;b<this._style.order.length;++b){const x=this._style._layers[this._style.order[b]],T=this._style._getLayerSourceCache(x);if(!T||m[T.id]||x.isHidden(this.painter.transform.zoom)||x.type!=="raster")continue;const P=x.paint.get("raster-fade-duration");for(const I of this.proxyCoords){const L=this.proxyToSource[I.key][T.id];if(L)for(const V of L){const H=cd(T.getTile(V),T.findLoadedParent(V,0),T,this.painter.transform,P);(H.opacity!==1||H.mix!==0)&&this._clearRenderCacheForTile(T.id,V)}}}}_setupDrapedRenderBatches(){const f=this._style.order,m=f.length;if(m===0)return;const b=[];let x,T=0,P=this._style._layers[f[T]];for(;!this._style.isLayerDraped(P)&&P.isHidden(this.painter.transform.zoom)&&++T<m;)P=this._style._layers[f[T]];for(;T<m;++T){const I=this._style._layers[f[T]];I.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(I)?x===void 0&&(x=T):x!==void 0&&(b.push({start:x,end:T-1}),x=void 0))}x!==void 0&&b.push({start:x,end:T-1}),this._drapedRenderBatches=b}_setupRenderCache(f){const m=this.proxySourceCache;if(this._shouldDisableRenderCache()||this._invalidateRenderCache){if(this._invalidateRenderCache=!1,m.renderCache.length>m.renderCachePool.length){const P=Object.values(m.proxyCachedFBO);m.proxyCachedFBO={};for(let I=0;I<P.length;++I){const L=Object.values(P[I]);m.renderCachePool.push(...L)}}return}this._clearRasterLayersFromRenderCache();const b=this.proxyCoords,x=this._tilesDirty;for(let P=b.length-1;P>=0;P--){const I=b[P];if(m.getTileByID(I.key),m.proxyCachedFBO[I.key]!==void 0){const L=f[I.key],V=this.proxyToSource[I.key];let H=0;for(const X in V){const ne=V[X],ae=L[X];if(!ae||ae.length!==ne.length||ne.some((le,ue)=>le!==ae[ue]||x[X]&&x[X].hasOwnProperty(le.key))){H=-1;break}++H}for(const X in m.proxyCachedFBO[I.key])m.renderCache[m.proxyCachedFBO[I.key][X]].dirty=H<0||H!==Object.values(L).length}}const T=[...this._drapedRenderBatches];T.sort((P,I)=>I.end-I.start-(P.end-P.start));for(const P of T)for(const I of b){if(m.proxyCachedFBO[I.key])continue;let L=m.renderCachePool.pop();L===void 0&&m.renderCache.length<50&&(L=m.renderCache.length,m.renderCache.push(this._createFBO())),L!==void 0&&(m.proxyCachedFBO[I.key]={},m.proxyCachedFBO[I.key][P.start]=L,m.renderCache[L].dirty=!0)}this._tilesDirty={}}_setupStencil(f,m,b,x){if(!x||!this._sourceTilesOverlap[x.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const T=this.painter.context,P=T.gl;if(m.length<=1)return void(this._overlapStencilType=!1);let I;if(b.isTileClipped())I=m.length,this._overlapStencilMode.test={func:P.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(m[0].overscaledZ>m[m.length-1].overscaledZ))return void(this._overlapStencilType=!1);I=1,this._overlapStencilMode.test={func:P.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+I>255&&(T.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=I,this._overlapStencilMode.ref=this._stencilRef,b.isTileClipped()&&this._renderTileClippingMasks(m,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(f){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[f.key]),this._overlapStencilMode):a.StencilMode.disabled}_renderTileClippingMasks(f,m){const b=this.painter,x=this.painter.context,T=x.gl;b._tileClippingMaskIDs={},x.setColorMode(a.ColorMode.disabled),x.setDepthMode(a.DepthMode.disabled);const P=b.useProgram("clippingMask");for(const I of f){const L=b._tileClippingMaskIDs[I.key]=--m;P.draw(x,T.TRIANGLES,a.DepthMode.disabled,new a.StencilMode({func:T.ALWAYS,mask:0},L,255,T.KEEP,T.KEEP,T.REPLACE),a.ColorMode.disabled,a.CullFaceMode.disabled,gn(I.projMatrix),"$clipping",b.tileExtentBuffer,b.quadTriangleIndexBuffer,b.tileExtentSegments)}}pointCoordinate(f){const m=this.painter.transform;if(f.x<0||f.x>m.width||f.y<0||f.y>m.height)return null;const b=[f.x,f.y,1,1];a.transformMat4$1(b,b,m.pixelMatrixInverse),a.scale$1(b,b,1/b[3]),b[0]/=m.worldSize,b[1]/=m.worldSize;const x=m._camera.position,T=a.mercatorZfromAltitude(1,m.center.lat),P=[x[0],x[1],x[2]/T,0],I=a.subtract([],b.slice(0,3),P);a.normalize(I,I);const L=this.raycast(P,I,this._exaggeration);return L!==null&&L?(a.scaleAndAdd(P,P,I,L),P[3]=P[2],P[2]*=T,P):null}drawDepth(){const f=this.painter,m=f.context,b=this.proxySourceCache,x=Math.ceil(f.width),T=Math.ceil(f.height);if(!this._depthFBO||this._depthFBO.width===x&&this._depthFBO.height===T||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const P=m.gl,I=m.createFramebuffer(x,T,!0);m.activeTexture.set(P.TEXTURE0);const L=new a.Texture(m,{width:x,height:T,data:null},P.RGBA);L.bind(P.NEAREST,P.CLAMP_TO_EDGE),I.colorAttachment.set(L.texture);const V=m.createRenderbuffer(m.gl.DEPTH_COMPONENT16,x,T);I.depthAttachment.set(V),this._depthFBO=I,this._depthTexture=L}m.bindFramebuffer.set(this._depthFBO.framebuffer),m.viewport.set([0,0,x,T]),function(P,I,L,V){if(P.transform.projection.name==="globe")return;const H=P.context,X=H.gl;H.clear({depth:1});const ne=P.useProgram("terrainDepth"),ae=new a.DepthMode(X.LESS,a.DepthMode.ReadWrite,P.depthRangeFor3D);for(const le of V){const ue=L.getTile(le),ce=_w(le.projMatrix,0);I.setupElevationDraw(ue,ne),ne.draw(H,X.TRIANGLES,ae,a.StencilMode.disabled,a.ColorMode.unblended,a.CullFaceMode.backCCW,ce,"terrain_depth",I.gridBuffer,I.gridIndexBuffer,I.gridNoSkirtSegments)}}(f,this,b,this.proxyCoords)}_setupProxiedCoordsForOrtho(f,m,b){if(f.getSource()instanceof De)return this._setupProxiedCoordsForImageSource(f,m,b);this._findCoveringTileCache[f.id]=this._findCoveringTileCache[f.id]||{};const x=this.proxiedCoords[f.id]=[],T=this.proxyCoords;for(let I=0;I<T.length;I++){const L=T[I],V=this._findTileCoveringTileID(L,f);if(V){const H=this._createProxiedId(L,V,b[L.key]&&b[L.key][f.id]);x.push(H),this.proxyToSource[L.key][f.id]=[H]}}let P=!1;for(let I=0;I<m.length;I++){const L=f.getTile(m[I]);if(!L||!L.hasData())continue;const V=this._findTileCoveringTileID(L.tileID,this.proxySourceCache);if(V&&V.tileID.canonical.z!==L.tileID.canonical.z){const H=this.proxyToSource[V.tileID.key][f.id],X=this._createProxiedId(V.tileID,L,b[V.tileID.key]&&b[V.tileID.key][f.id]);H?H.splice(H.length-1,0,X):this.proxyToSource[V.tileID.key][f.id]=[X],x.push(X),P=!0}}this._sourceTilesOverlap[f.id]=P}_setupProxiedCoordsForImageSource(f,m,b){if(!f.getSource().loaded())return;const x=this.proxiedCoords[f.id]=[],T=this.proxyCoords,P=f.getSource(),I=new a.pointGeometry(P.tileID.x,P.tileID.y)._div(1<<P.tileID.z),L=P.coordinates.map(a.MercatorCoordinate.fromLngLat).reduce((H,X)=>(H.min.x=Math.min(H.min.x,X.x-I.x),H.min.y=Math.min(H.min.y,X.y-I.y),H.max.x=Math.max(H.max.x,X.x-I.x),H.max.y=Math.max(H.max.y,X.y-I.y),H),{min:new a.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE),max:new a.pointGeometry(-Number.MAX_VALUE,-Number.MAX_VALUE)}),V=(H,X)=>{const ne=H.wrap+H.canonical.x/(1<<H.canonical.z),ae=H.canonical.y/(1<<H.canonical.z),le=a.EXTENT/(1<<H.canonical.z),ue=X.wrap+X.canonical.x/(1<<X.canonical.z),ce=X.canonical.y/(1<<X.canonical.z);return ne+le<ue+L.min.x||ne>ue+L.max.x||ae+le<ce+L.min.y||ae>ce+L.max.y};for(let H=0;H<T.length;H++){const X=T[H];for(let ne=0;ne<m.length;ne++){const ae=f.getTile(m[ne]);if(!ae||!ae.hasData()||V(X,ae.tileID))continue;const le=this._createProxiedId(X,ae,b[X.key]&&b[X.key][f.id]),ue=this.proxyToSource[X.key][f.id];ue?ue.push(le):this.proxyToSource[X.key][f.id]=[le],x.push(le)}}}_createProxiedId(f,m,b){let x=this.orthoMatrix;if(b){const T=b.find(P=>P.key===m.tileID.key);if(T)return T}if(m.tileID.key!==f.key){const T=f.canonical.z-m.tileID.canonical.z;let P,I,L;x=a.create();const V=m.tileID.wrap-f.wrap<<f.overscaledZ;T>0?(P=a.EXTENT>>T,I=P*((m.tileID.canonical.x<<T)-f.canonical.x+V),L=P*((m.tileID.canonical.y<<T)-f.canonical.y)):(P=a.EXTENT<<-T,I=a.EXTENT*(m.tileID.canonical.x-(f.canonical.x+V<<-T)),L=a.EXTENT*(m.tileID.canonical.y-(f.canonical.y<<-T))),a.ortho(x,0,P,0,P,0,1),a.translate(x,x,[I,L,0])}return new Sw(m.tileID,f.key,x)}_findTileCoveringTileID(f,m){let b=m.getTile(f);if(b&&b.hasData())return b;const x=this._findCoveringTileCache[m.id],T=x[f.key];if(b=T?m.getTileByID(T):null,b&&b.hasData()||T===null)return b;let P=b?b.tileID:f,I=P.overscaledZ;const L=m.getSource().minzoom,V=[];if(!T){const X=m.getSource().maxzoom;if(f.canonical.z>=X){const ne=f.canonical.z-X;m.getSource().reparseOverscaled?(I=Math.max(f.canonical.z+2,m.transform.tileZoom),P=new a.OverscaledTileID(I,f.wrap,X,f.canonical.x>>ne,f.canonical.y>>ne)):ne!==0&&(I=X,P=new a.OverscaledTileID(I,f.wrap,X,f.canonical.x>>ne,f.canonical.y>>ne))}P.key!==f.key&&(V.push(P.key),b=m.getTile(P))}const H=X=>{V.forEach(ne=>{x[ne]=X}),V.length=0};for(I-=1;I>=L&&(!b||!b.hasData());I--){b&&H(b.tileID.key);const X=P.calculateScaledKey(I);if(b=m.getTileByID(X),b&&b.hasData())break;const ne=x[X];if(ne===null)break;ne===void 0?V.push(X):b=m.getTileByID(ne)}return H(b?b.tileID.key:null),b&&b.hasData()?b:null}findDEMTileFor(f){return this.enabled?this._findTileCoveringTileID(f,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(f,m){let b=this._tilesDirty[f];b||(b=this._tilesDirty[f]={}),b[m.key]=!0}getWirefameBuffer(){if(!this.wireframeSegments){const f=function(m){let b=0;const x=new a.StructArrayLayout2ui4,T=131;for(let P=1;P<129;P++){for(let I=1;I<129;I++)b=P*T+I,x.emplaceBack(b,b+1),x.emplaceBack(b,b+T),x.emplaceBack(b+1,b+T),P===128&&x.emplaceBack(b+T,b+T+1);x.emplaceBack(b+1,b+1+T)}return x}();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(f),this.wireframeSegments=a.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,f.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}}class Cw{static cacheKey(f,m,b,x){let T=`${m}${x?x.cacheKey:""}`;for(const P of b)f.usedDefines.includes(P)&&(T+=`/${P}`);return T}constructor(f,m,b,x,T,P){const I=f.gl;this.program=I.createProgram();const L=function(te){const _e=[];for(let ve=0;ve<te.length;ve++){if(te[ve]===null)continue;const be=te[ve].split(" ");_e.push(be.pop())}return _e}(b.staticAttributes),V=x?x.getBinderAttributes():[],H=L.concat(V);let X=x?x.defines():[];X=X.concat(P.map(te=>`#define ${te}`));const ne=f.isWebGL2?`#version 300 es
`:"",ae=ne+X.concat(f.extStandardDerivatives&&ne.length===0?`#extension GL_OES_standard_derivatives : enable
`.concat(Xm):Xm,Xm,qm,UE.fragmentSource,gw.fragmentSource,b.fragmentSource).join(`
`),le=ne+X.concat(`
#ifdef GL_ES
precision highp float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`,qm,UE.vertexSource,gw.vertexSource,mw.vertexSource,b.vertexSource).join(`
`),ue=I.createShader(I.FRAGMENT_SHADER);if(I.isContextLost())return void(this.failedToCreate=!0);I.shaderSource(ue,ae),I.compileShader(ue),I.attachShader(this.program,ue);const ce=I.createShader(I.VERTEX_SHADER);if(I.isContextLost())this.failedToCreate=!0;else{I.shaderSource(ce,le),I.compileShader(ce),I.attachShader(this.program,ce),this.attributes={},this.numAttributes=H.length;for(let te=0;te<this.numAttributes;te++)H[te]&&(I.bindAttribLocation(this.program,te,H[te]),this.attributes[H[te]]=te);I.linkProgram(this.program),I.deleteShader(ce),I.deleteShader(ue),this.fixedUniforms=T(f),this.binderUniforms=x?x.getUniforms(f):[],P.includes("TERRAIN")&&(this.terrainUniforms=(te=>({u_dem:new a.Uniform1i(te),u_dem_prev:new a.Uniform1i(te),u_dem_unpack:new a.Uniform4f(te),u_dem_tl:new a.Uniform2f(te),u_dem_scale:new a.Uniform1f(te),u_dem_tl_prev:new a.Uniform2f(te),u_dem_scale_prev:new a.Uniform1f(te),u_dem_size:new a.Uniform1f(te),u_dem_lerp:new a.Uniform1f(te),u_exaggeration:new a.Uniform1f(te),u_depth:new a.Uniform1i(te),u_depth_size_inv:new a.Uniform2f(te),u_meter_to_dem:new a.Uniform1f(te),u_label_plane_matrix_inv:new a.UniformMatrix4f(te)}))(f)),P.includes("GLOBE")&&(this.globeUniforms=(te=>({u_tile_tl_up:new a.Uniform3f(te),u_tile_tr_up:new a.Uniform3f(te),u_tile_br_up:new a.Uniform3f(te),u_tile_bl_up:new a.Uniform3f(te),u_tile_up_scale:new a.Uniform1f(te)}))(f)),P.includes("FOG")&&(this.fogUniforms=(te=>({u_fog_matrix:new a.UniformMatrix4f(te),u_fog_range:new a.Uniform2f(te),u_fog_color:new a.Uniform4f(te),u_fog_horizon_blend:new a.Uniform1f(te),u_fog_temporal_offset:new a.Uniform1f(te),u_frustum_tl:new a.Uniform3f(te),u_frustum_tr:new a.Uniform3f(te),u_frustum_br:new a.Uniform3f(te),u_frustum_bl:new a.Uniform3f(te),u_globe_pos:new a.Uniform3f(te),u_globe_radius:new a.Uniform1f(te),u_globe_transition:new a.Uniform1f(te),u_is_globe:new a.Uniform1i(te),u_viewport:new a.Uniform2f(te)}))(f))}}setTerrainUniformValues(f,m){if(!this.terrainUniforms)return;const b=this.terrainUniforms;if(!this.failedToCreate){f.program.set(this.program);for(const x in m)b[x]&&b[x].set(this.program,x,m[x])}}setGlobeUniformValues(f,m){if(!this.globeUniforms)return;const b=this.globeUniforms;if(!this.failedToCreate){f.program.set(this.program);for(const x in m)b[x]&&b[x].set(this.program,x,m[x])}}setFogUniformValues(f,m){if(!this.fogUniforms)return;const b=this.fogUniforms;if(!this.failedToCreate){f.program.set(this.program);for(const x in m)b[x].set(this.program,x,m[x])}}draw(f,m,b,x,T,P,I,L,V,H,X,ne,ae,le,ue){const ce=f.gl;if(this.failedToCreate)return;f.program.set(this.program),f.setDepthMode(b),f.setStencilMode(x),f.setColorMode(T),f.setCullFace(P);for(const _e of Object.keys(this.fixedUniforms))this.fixedUniforms[_e].set(this.program,_e,I[_e]);le&&le.setUniforms(this.program,f,this.binderUniforms,ne,{zoom:ae});const te={[ce.LINES]:2,[ce.TRIANGLES]:3,[ce.LINE_STRIP]:1}[m];for(const _e of X.get()){const ve=_e.vaos||(_e.vaos={});(ve[L]||(ve[L]=new sd)).bind(f,this,V,le?le.getPaintVertexBuffers():[],H,_e.vertexOffset,ue||[]),ce.drawElements(m,_e.primitiveLength*te,ce.UNSIGNED_SHORT,_e.primitiveOffset*te*2)}}}function YE(v,f){const m=Math.pow(2,f.tileID.overscaledZ),b=f.tileSize*Math.pow(2,v.transform.tileZoom)/m,x=b*(f.tileID.canonical.x+f.tileID.wrap*m),T=b*f.tileID.canonical.y;return{u_image:0,u_texsize:f.imageAtlasTexture.size,u_tile_units_to_pixels:1/Oe(f,1,v.transform.tileZoom),u_pixel_coord_upper:[x>>16,T>>16],u_pixel_coord_lower:[65535&x,65535&T]}}const UM=a.create(),tg=(v,f,m,b,x,T,P,I,L,V,H)=>{const X=f.style.light,ne=X.properties.get("position"),ae=[ne.x,ne.y,ne.z],le=a.create$1();X.properties.get("anchor")==="viewport"&&(a.fromRotation(le,-f.transform.angle),a.transformMat3(ae,ae,le));const ue=X.properties.get("color"),ce=f.transform,te={u_matrix:v,u_lightpos:ae,u_lightintensity:X.properties.get("intensity"),u_lightcolor:[ue.r,ue.g,ue.b],u_vertical_gradient:+m,u_opacity:b,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:UM,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:x,u_edge_radius:T};return ce.projection.name==="globe"&&(te.u_tile_id=[P.canonical.x,P.canonical.y,1<<P.canonical.z],te.u_zoom_transition=L,te.u_inv_rot_matrix=H,te.u_merc_center=V,te.u_up_dir=ce.projection.upVector(new a.CanonicalTileID(0,0,0),V[0]*a.EXTENT,V[1]*a.EXTENT),te.u_height_lift=I),te},Ew=(v,f,m,b,x,T,P,I,L,V,H,X)=>{const ne=tg(v,f,m,b,x,T,P,L,V,H,X),ae={u_height_factor:-Math.pow(2,P.overscaledZ)/I.tileSize/8};return a.extend(ne,YE(f,I),ae)},rg=v=>({u_matrix:v}),ng=(v,f,m)=>a.extend(rg(v),YE(f,m)),KE=(v,f)=>({u_matrix:v,u_world:f}),qE=(v,f,m,b)=>a.extend(ng(v,f,m),{u_world:b}),WM=a.create(),fd=(v,f,m,b,x,T)=>{const P=v.transform,I=P.projection.name==="globe";let L;if(T.paint.get("circle-pitch-alignment")==="map")if(I){const H=a.globePixelsToTileUnits(P.zoom,f.canonical)*P._pixelsPerMercatorPixel;L=Float32Array.from([H,0,0,H])}else L=P.calculatePixelsToTileUnitsMatrix(m);else L=new Float32Array([P.pixelsToGLUnits[0],0,0,P.pixelsToGLUnits[1]]);const V={u_camera_to_center_distance:P.cameraToCenterDistance,u_matrix:v.translatePosMatrix(f.projMatrix,m,T.paint.get("circle-translate"),T.paint.get("circle-translate-anchor")),u_device_pixel_ratio:a.exported.devicePixelRatio,u_extrude_scale:L,u_inv_rot_matrix:WM,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(I){V.u_inv_rot_matrix=b,V.u_merc_center=x,V.u_tile_id=[f.canonical.x,f.canonical.y,1<<f.canonical.z],V.u_zoom_transition=a.globeToMercatorTransition(P.zoom);const H=x[0]*a.EXTENT,X=x[1]*a.EXTENT;V.u_up_dir=P.projection.upVector(new a.CanonicalTileID(0,0,0),H,X)}return V},hd=v=>{const f=[];return v.paint.get("circle-pitch-alignment")==="map"&&f.push("PITCH_WITH_MAP"),v.paint.get("circle-pitch-scale")==="map"&&f.push("SCALE_WITH_MAP"),f},XE=(v,f,m,b)=>{const x=a.EXTENT/m.tileSize;return{u_matrix:v,u_camera_to_center_distance:f.getCameraToCenterDistance(b),u_extrude_scale:[f.pixelsToGLUnits[0]/x,f.pixelsToGLUnits[1]/x]}},dd=(v,f,m=1)=>({u_matrix:v,u_color:f,u_overlay:0,u_overlay_scale:m}),Tw=a.create(),Ss=(v,f,m,b,x,T,P)=>{const I=v.transform,L=I.projection.name==="globe",V=L?a.globePixelsToTileUnits(I.zoom,f.canonical)*I._pixelsPerMercatorPixel:Oe(m,1,T),H={u_matrix:f.projMatrix,u_extrude_scale:V,u_intensity:P,u_inv_rot_matrix:Tw,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(L){H.u_inv_rot_matrix=b,H.u_merc_center=x,H.u_tile_id=[f.canonical.x,f.canonical.y,1<<f.canonical.z],H.u_zoom_transition=a.globeToMercatorTransition(I.zoom);const X=x[0]*a.EXTENT,ne=x[1]*a.EXTENT;H.u_up_dir=I.projection.upVector(new a.CanonicalTileID(0,0,0),X,ne)}return H},Ow=(v,f,m,b,x,T,P)=>{const I=v.transform,L=I.calculatePixelsToTileUnitsMatrix(f);return{u_matrix:Rw(v,f,m,b),u_pixels_to_tile_units:L,u_device_pixel_ratio:T,u_units_to_pixels:[1/I.pixelsToGLUnits[0],1/I.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:x,u_texsize:og(m)?f.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:ig(f,v.transform),u_alpha_discard_threshold:0,u_trim_offset:P}},ZE=(v,f,m,b,x)=>{const T=v.transform;return{u_matrix:Rw(v,f,m,b),u_texsize:f.imageAtlasTexture.size,u_pixels_to_tile_units:T.calculatePixelsToTileUnitsMatrix(f),u_device_pixel_ratio:x,u_image:0,u_tile_units_to_pixels:ig(f,T),u_units_to_pixels:[1/T.pixelsToGLUnits[0],1/T.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}};function ig(v,f){return 1/Oe(v,1,f.tileZoom)}function Rw(v,f,m,b){return v.translatePosMatrix(b||f.tileID.projMatrix,f,m.paint.get("line-translate"),m.paint.get("line-translate-anchor"))}function og(v){const f=v.paint.get("line-dasharray").value;return f.value||f.kind!=="constant"}const GM=(v,f,m,b,x,T)=>{return{u_matrix:v,u_tl_parent:f,u_scale_parent:m,u_fade_t:b.mix,u_opacity:b.opacity*x.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:x.paint.get("raster-brightness-min"),u_brightness_high:x.paint.get("raster-brightness-max"),u_saturation_factor:(I=x.paint.get("raster-saturation"),I>0?1-1/(1.001-I):-I),u_contrast_factor:(P=x.paint.get("raster-contrast"),P>0?1/(1-P):1+P),u_spin_weights:kw(x.paint.get("raster-hue-rotate")),u_perspective_transform:T};var P,I};function kw(v){v*=Math.PI/180;const f=Math.sin(v),m=Math.cos(v);return[(2*m+1)/3,(-Math.sqrt(3)*f-m+1)/3,(Math.sqrt(3)*f-m+1)/3]}const JE=a.create(),pd=(v,f,m,b,x,T,P,I,L,V,H,X,ne,ae,le,ue)=>{const ce=x.transform,te={u_is_size_zoom_constant:+(v==="constant"||v==="source"),u_is_size_feature_constant:+(v==="constant"||v==="camera"),u_size_t:f?f.uSizeT:0,u_size:f?f.uSize:0,u_camera_to_center_distance:ce.cameraToCenterDistance,u_rotate_symbol:+m,u_aspect_ratio:ce.width/ce.height,u_fade_change:x.options.fadeDuration?x.symbolFadeChange:1,u_matrix:T,u_label_plane_matrix:P,u_coord_matrix:I,u_is_text:+L,u_pitch_with_map:+b,u_texsize:V,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:JE,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:JE,u_up_vector:[0,-1,0]};return ue.name==="globe"&&(te.u_tile_id=[H.canonical.x,H.canonical.y,1<<H.canonical.z],te.u_zoom_transition=X,te.u_inv_rot_matrix=ae,te.u_merc_center=ne,te.u_camera_forward=ce._camera.forward(),te.u_ecef_origin=a.globeECEFOrigin(ce.globeMatrix,H.toUnwrapped()),te.u_tile_matrix=Float32Array.from(ce.globeMatrix),te.u_up_vector=le),te},QE=(v,f,m,b,x,T,P,I,L,V,H,X,ne,ae,le,ue,ce)=>a.extend(pd(v,f,m,b,x,T,P,I,L,V,X,ne,ae,le,ue,ce),{u_gamma_scale:b?x.transform.cameraToCenterDistance*Math.cos(x.terrain?0:x.transform._pitch):1,u_device_pixel_ratio:a.exported.devicePixelRatio,u_is_halo:+H}),Pw=(v,f,m,b,x,T,P,I,L,V,H,X,ne,ae,le,ue)=>a.extend(QE(v,f,m,b,x,T,P,I,!0,L,!0,H,X,ne,ae,le,ue),{u_texsize_icon:V,u_texture_icon:1}),YM=(v,f,m)=>({u_matrix:v,u_opacity:f,u_color:m}),Aw=(v,f,m,b,x)=>a.extend(function(T,P,I){const L=P.imageManager.getPattern(T.toString()),{width:V,height:H}=P.imageManager.getPixelSize(),X=Math.pow(2,I.tileID.overscaledZ),ne=I.tileSize*Math.pow(2,P.transform.tileZoom)/X,ae=ne*(I.tileID.canonical.x+I.tileID.wrap*X),le=ne*I.tileID.canonical.y;return{u_image:0,u_pattern_tl:L.tl,u_pattern_br:L.br,u_texsize:[V,H],u_pattern_size:L.displaySize,u_tile_units_to_pixels:1/Oe(I,1,P.transform.tileZoom),u_pixel_coord_upper:[ae>>16,le>>16],u_pixel_coord_lower:[65535&ae,65535&le]}}(b,m,x),{u_matrix:v,u_opacity:f}),KM={fillExtrusion:v=>({u_matrix:new a.UniformMatrix4f(v),u_lightpos:new a.Uniform3f(v),u_lightintensity:new a.Uniform1f(v),u_lightcolor:new a.Uniform3f(v),u_vertical_gradient:new a.Uniform1f(v),u_opacity:new a.Uniform1f(v),u_edge_radius:new a.Uniform1f(v),u_ao:new a.Uniform2f(v),u_tile_id:new a.Uniform3f(v),u_zoom_transition:new a.Uniform1f(v),u_inv_rot_matrix:new a.UniformMatrix4f(v),u_merc_center:new a.Uniform2f(v),u_up_dir:new a.Uniform3f(v),u_height_lift:new a.Uniform1f(v)}),fillExtrusionPattern:v=>({u_matrix:new a.UniformMatrix4f(v),u_lightpos:new a.Uniform3f(v),u_lightintensity:new a.Uniform1f(v),u_lightcolor:new a.Uniform3f(v),u_vertical_gradient:new a.Uniform1f(v),u_height_factor:new a.Uniform1f(v),u_edge_radius:new a.Uniform1f(v),u_ao:new a.Uniform2f(v),u_tile_id:new a.Uniform3f(v),u_zoom_transition:new a.Uniform1f(v),u_inv_rot_matrix:new a.UniformMatrix4f(v),u_merc_center:new a.Uniform2f(v),u_up_dir:new a.Uniform3f(v),u_height_lift:new a.Uniform1f(v),u_image:new a.Uniform1i(v),u_texsize:new a.Uniform2f(v),u_pixel_coord_upper:new a.Uniform2f(v),u_pixel_coord_lower:new a.Uniform2f(v),u_tile_units_to_pixels:new a.Uniform1f(v),u_opacity:new a.Uniform1f(v)}),fill:v=>({u_matrix:new a.UniformMatrix4f(v)}),fillPattern:v=>({u_matrix:new a.UniformMatrix4f(v),u_image:new a.Uniform1i(v),u_texsize:new a.Uniform2f(v),u_pixel_coord_upper:new a.Uniform2f(v),u_pixel_coord_lower:new a.Uniform2f(v),u_tile_units_to_pixels:new a.Uniform1f(v)}),fillOutline:v=>({u_matrix:new a.UniformMatrix4f(v),u_world:new a.Uniform2f(v)}),fillOutlinePattern:v=>({u_matrix:new a.UniformMatrix4f(v),u_world:new a.Uniform2f(v),u_image:new a.Uniform1i(v),u_texsize:new a.Uniform2f(v),u_pixel_coord_upper:new a.Uniform2f(v),u_pixel_coord_lower:new a.Uniform2f(v),u_tile_units_to_pixels:new a.Uniform1f(v)}),circle:v=>({u_camera_to_center_distance:new a.Uniform1f(v),u_extrude_scale:new a.UniformMatrix2f(v),u_device_pixel_ratio:new a.Uniform1f(v),u_matrix:new a.UniformMatrix4f(v),u_inv_rot_matrix:new a.UniformMatrix4f(v),u_merc_center:new a.Uniform2f(v),u_tile_id:new a.Uniform3f(v),u_zoom_transition:new a.Uniform1f(v),u_up_dir:new a.Uniform3f(v)}),collisionBox:v=>({u_matrix:new a.UniformMatrix4f(v),u_camera_to_center_distance:new a.Uniform1f(v),u_extrude_scale:new a.Uniform2f(v)}),collisionCircle:v=>({u_matrix:new a.UniformMatrix4f(v),u_inv_matrix:new a.UniformMatrix4f(v),u_camera_to_center_distance:new a.Uniform1f(v),u_viewport_size:new a.Uniform2f(v)}),debug:v=>({u_color:new a.UniformColor(v),u_matrix:new a.UniformMatrix4f(v),u_overlay:new a.Uniform1i(v),u_overlay_scale:new a.Uniform1f(v)}),clippingMask:v=>({u_matrix:new a.UniformMatrix4f(v)}),heatmap:v=>({u_extrude_scale:new a.Uniform1f(v),u_intensity:new a.Uniform1f(v),u_matrix:new a.UniformMatrix4f(v),u_inv_rot_matrix:new a.UniformMatrix4f(v),u_merc_center:new a.Uniform2f(v),u_tile_id:new a.Uniform3f(v),u_zoom_transition:new a.Uniform1f(v),u_up_dir:new a.Uniform3f(v)}),heatmapTexture:v=>({u_image:new a.Uniform1i(v),u_color_ramp:new a.Uniform1i(v),u_opacity:new a.Uniform1f(v)}),hillshade:v=>({u_matrix:new a.UniformMatrix4f(v),u_image:new a.Uniform1i(v),u_latrange:new a.Uniform2f(v),u_light:new a.Uniform2f(v),u_shadow:new a.UniformColor(v),u_highlight:new a.UniformColor(v),u_accent:new a.UniformColor(v)}),hillshadePrepare:v=>({u_matrix:new a.UniformMatrix4f(v),u_image:new a.Uniform1i(v),u_dimension:new a.Uniform2f(v),u_zoom:new a.Uniform1f(v),u_unpack:new a.Uniform4f(v)}),line:v=>({u_matrix:new a.UniformMatrix4f(v),u_pixels_to_tile_units:new a.UniformMatrix2f(v),u_device_pixel_ratio:new a.Uniform1f(v),u_units_to_pixels:new a.Uniform2f(v),u_dash_image:new a.Uniform1i(v),u_gradient_image:new a.Uniform1i(v),u_image_height:new a.Uniform1f(v),u_texsize:new a.Uniform2f(v),u_tile_units_to_pixels:new a.Uniform1f(v),u_alpha_discard_threshold:new a.Uniform1f(v),u_trim_offset:new a.Uniform2f(v)}),linePattern:v=>({u_matrix:new a.UniformMatrix4f(v),u_texsize:new a.Uniform2f(v),u_pixels_to_tile_units:new a.UniformMatrix2f(v),u_device_pixel_ratio:new a.Uniform1f(v),u_image:new a.Uniform1i(v),u_units_to_pixels:new a.Uniform2f(v),u_tile_units_to_pixels:new a.Uniform1f(v),u_alpha_discard_threshold:new a.Uniform1f(v)}),raster:v=>({u_matrix:new a.UniformMatrix4f(v),u_tl_parent:new a.Uniform2f(v),u_scale_parent:new a.Uniform1f(v),u_fade_t:new a.Uniform1f(v),u_opacity:new a.Uniform1f(v),u_image0:new a.Uniform1i(v),u_image1:new a.Uniform1i(v),u_brightness_low:new a.Uniform1f(v),u_brightness_high:new a.Uniform1f(v),u_saturation_factor:new a.Uniform1f(v),u_contrast_factor:new a.Uniform1f(v),u_spin_weights:new a.Uniform3f(v),u_perspective_transform:new a.Uniform2f(v)}),symbolIcon:v=>({u_is_size_zoom_constant:new a.Uniform1i(v),u_is_size_feature_constant:new a.Uniform1i(v),u_size_t:new a.Uniform1f(v),u_size:new a.Uniform1f(v),u_camera_to_center_distance:new a.Uniform1f(v),u_rotate_symbol:new a.Uniform1i(v),u_aspect_ratio:new a.Uniform1f(v),u_fade_change:new a.Uniform1f(v),u_matrix:new a.UniformMatrix4f(v),u_label_plane_matrix:new a.UniformMatrix4f(v),u_coord_matrix:new a.UniformMatrix4f(v),u_is_text:new a.Uniform1i(v),u_pitch_with_map:new a.Uniform1i(v),u_texsize:new a.Uniform2f(v),u_tile_id:new a.Uniform3f(v),u_zoom_transition:new a.Uniform1f(v),u_inv_rot_matrix:new a.UniformMatrix4f(v),u_merc_center:new a.Uniform2f(v),u_camera_forward:new a.Uniform3f(v),u_tile_matrix:new a.UniformMatrix4f(v),u_up_vector:new a.Uniform3f(v),u_ecef_origin:new a.Uniform3f(v),u_texture:new a.Uniform1i(v)}),symbolSDF:v=>({u_is_size_zoom_constant:new a.Uniform1i(v),u_is_size_feature_constant:new a.Uniform1i(v),u_size_t:new a.Uniform1f(v),u_size:new a.Uniform1f(v),u_camera_to_center_distance:new a.Uniform1f(v),u_rotate_symbol:new a.Uniform1i(v),u_aspect_ratio:new a.Uniform1f(v),u_fade_change:new a.Uniform1f(v),u_matrix:new a.UniformMatrix4f(v),u_label_plane_matrix:new a.UniformMatrix4f(v),u_coord_matrix:new a.UniformMatrix4f(v),u_is_text:new a.Uniform1i(v),u_pitch_with_map:new a.Uniform1i(v),u_texsize:new a.Uniform2f(v),u_texture:new a.Uniform1i(v),u_gamma_scale:new a.Uniform1f(v),u_device_pixel_ratio:new a.Uniform1f(v),u_tile_id:new a.Uniform3f(v),u_zoom_transition:new a.Uniform1f(v),u_inv_rot_matrix:new a.UniformMatrix4f(v),u_merc_center:new a.Uniform2f(v),u_camera_forward:new a.Uniform3f(v),u_tile_matrix:new a.UniformMatrix4f(v),u_up_vector:new a.Uniform3f(v),u_ecef_origin:new a.Uniform3f(v),u_is_halo:new a.Uniform1i(v)}),symbolTextAndIcon:v=>({u_is_size_zoom_constant:new a.Uniform1i(v),u_is_size_feature_constant:new a.Uniform1i(v),u_size_t:new a.Uniform1f(v),u_size:new a.Uniform1f(v),u_camera_to_center_distance:new a.Uniform1f(v),u_rotate_symbol:new a.Uniform1i(v),u_aspect_ratio:new a.Uniform1f(v),u_fade_change:new a.Uniform1f(v),u_matrix:new a.UniformMatrix4f(v),u_label_plane_matrix:new a.UniformMatrix4f(v),u_coord_matrix:new a.UniformMatrix4f(v),u_is_text:new a.Uniform1i(v),u_pitch_with_map:new a.Uniform1i(v),u_texsize:new a.Uniform2f(v),u_texsize_icon:new a.Uniform2f(v),u_texture:new a.Uniform1i(v),u_texture_icon:new a.Uniform1i(v),u_gamma_scale:new a.Uniform1f(v),u_device_pixel_ratio:new a.Uniform1f(v),u_is_halo:new a.Uniform1i(v)}),background:v=>({u_matrix:new a.UniformMatrix4f(v),u_opacity:new a.Uniform1f(v),u_color:new a.UniformColor(v)}),backgroundPattern:v=>({u_matrix:new a.UniformMatrix4f(v),u_opacity:new a.Uniform1f(v),u_image:new a.Uniform1i(v),u_pattern_tl:new a.Uniform2f(v),u_pattern_br:new a.Uniform2f(v),u_texsize:new a.Uniform2f(v),u_pattern_size:new a.Uniform2f(v),u_pixel_coord_upper:new a.Uniform2f(v),u_pixel_coord_lower:new a.Uniform2f(v),u_tile_units_to_pixels:new a.Uniform1f(v)}),terrainRaster:Jm,terrainDepth:Jm,skybox:v=>({u_matrix:new a.UniformMatrix4f(v),u_sun_direction:new a.Uniform3f(v),u_cubemap:new a.Uniform1i(v),u_opacity:new a.Uniform1f(v),u_temporal_offset:new a.Uniform1f(v)}),skyboxGradient:v=>({u_matrix:new a.UniformMatrix4f(v),u_color_ramp:new a.Uniform1i(v),u_center_direction:new a.Uniform3f(v),u_radius:new a.Uniform1f(v),u_opacity:new a.Uniform1f(v),u_temporal_offset:new a.Uniform1f(v)}),skyboxCapture:v=>({u_matrix_3f:new a.UniformMatrix3f(v),u_sun_direction:new a.Uniform3f(v),u_sun_intensity:new a.Uniform1f(v),u_color_tint_r:new a.Uniform4f(v),u_color_tint_m:new a.Uniform4f(v),u_luminance:new a.Uniform1f(v)}),globeRaster:v=>({u_proj_matrix:new a.UniformMatrix4f(v),u_globe_matrix:new a.UniformMatrix4f(v),u_normalize_matrix:new a.UniformMatrix4f(v),u_merc_matrix:new a.UniformMatrix4f(v),u_zoom_transition:new a.Uniform1f(v),u_merc_center:new a.Uniform2f(v),u_image0:new a.Uniform1i(v),u_grid_matrix:new a.UniformMatrix3f(v),u_skirt_height:new a.Uniform1f(v),u_frustum_tl:new a.Uniform3f(v),u_frustum_tr:new a.Uniform3f(v),u_frustum_br:new a.Uniform3f(v),u_frustum_bl:new a.Uniform3f(v),u_globe_pos:new a.Uniform3f(v),u_globe_radius:new a.Uniform1f(v),u_viewport:new a.Uniform2f(v)}),globeAtmosphere:v=>({u_frustum_tl:new a.Uniform3f(v),u_frustum_tr:new a.Uniform3f(v),u_frustum_br:new a.Uniform3f(v),u_frustum_bl:new a.Uniform3f(v),u_horizon:new a.Uniform1f(v),u_transition:new a.Uniform1f(v),u_fadeout_range:new a.Uniform1f(v),u_color:new a.Uniform4f(v),u_high_color:new a.Uniform4f(v),u_space_color:new a.Uniform4f(v),u_star_intensity:new a.Uniform1f(v),u_star_density:new a.Uniform1f(v),u_star_size:new a.Uniform1f(v),u_temporal_offset:new a.Uniform1f(v),u_horizon_angle:new a.Uniform1f(v),u_rotation_matrix:new a.UniformMatrix4f(v)})};let Lu;function eT(v,f,m,b,x,T,P){const I=v.context,L=I.gl,V=v.transform,H=v.useProgram("collisionBox"),X=[];let ne=0,ae=0;for(let be=0;be<b.length;be++){const $e=b[be],Ae=f.getTile($e),Be=Ae.getBucket(m);if(!Be)continue;const Ze=fw($e,Be,V);let ot=Ze;x[0]===0&&x[1]===0||(ot=v.translatePosMatrix(Ze,Ae,x,T));const ut=P?Be.textCollisionBox:Be.iconCollisionBox,zt=Be.collisionCircleArray;if(zt.length>0){const rt=a.create(),Ot=ot;a.mul(rt,Be.placementInvProjMatrix,V.glCoordMatrix),a.mul(rt,rt,Be.placementViewportMatrix),X.push({circleArray:zt,circleOffset:ae,transform:Ot,invTransform:rt,projection:Be.getProjection()}),ne+=zt.length/4,ae=ne}ut&&(v.terrain&&v.terrain.setupElevationDraw(Ae,H),H.draw(I,L.LINES,a.DepthMode.disabled,a.StencilMode.disabled,v.colorModeForRenderPass(),a.CullFaceMode.disabled,XE(ot,V,Ae,Be.getProjection()),m.id,ut.layoutVertexBuffer,ut.indexBuffer,ut.segments,null,V.zoom,null,[ut.collisionVertexBuffer,ut.collisionVertexBufferExt]))}if(!P||!X.length)return;const le=v.useProgram("collisionCircle"),ue=new a.StructArrayLayout2f1f2i16;ue.resize(4*ne),ue._trim();let ce=0;for(const be of X)for(let $e=0;$e<be.circleArray.length/4;$e++){const Ae=4*$e,Be=be.circleArray[Ae+0],Ze=be.circleArray[Ae+1],ot=be.circleArray[Ae+2],ut=be.circleArray[Ae+3];ue.emplace(ce++,Be,Ze,ot,ut,0),ue.emplace(ce++,Be,Ze,ot,ut,1),ue.emplace(ce++,Be,Ze,ot,ut,2),ue.emplace(ce++,Be,Ze,ot,ut,3)}(!Lu||Lu.length<2*ne)&&(Lu=function(be){const $e=2*be,Ae=new a.StructArrayLayout3ui6;Ae.resize($e),Ae._trim();for(let Be=0;Be<$e;Be++){const Ze=6*Be;Ae.uint16[Ze+0]=4*Be+0,Ae.uint16[Ze+1]=4*Be+1,Ae.uint16[Ze+2]=4*Be+2,Ae.uint16[Ze+3]=4*Be+2,Ae.uint16[Ze+4]=4*Be+3,Ae.uint16[Ze+5]=4*Be+0}return Ae}(ne));const te=I.createIndexBuffer(Lu,!0),_e=I.createVertexBuffer(ue,a.collisionCircleLayout.members,!0);for(const be of X){const $e={u_matrix:be.transform,u_inv_matrix:be.invTransform,u_camera_to_center_distance:(ve=V).getCameraToCenterDistance(be.projection),u_viewport_size:[ve.width,ve.height]};le.draw(I,L.TRIANGLES,a.DepthMode.disabled,a.StencilMode.disabled,v.colorModeForRenderPass(),a.CullFaceMode.disabled,$e,m.id,_e,te,a.SegmentVector.simpleSegment(0,2*be.circleOffset,be.circleArray.length,be.circleArray.length/2),null,V.zoom)}var ve;_e.destroy(),te.destroy()}const Iw=a.create();function tT({width:v,height:f,anchor:m,textOffset:b,textScale:x},T){const{horizontalAlign:P,verticalAlign:I}=a.getAnchorAlignment(m),L=-(P-.5)*v,V=-(I-.5)*f,H=a.evaluateVariableOffset(m,b);return new a.pointGeometry((L/x+H[0])*T,(V/x+H[1])*T)}function gf(v,f,m,b,x,T,P,I,L,V,H){const X=v.text.placedSymbolArray,ne=v.text.dynamicLayoutVertexArray,ae=v.icon.dynamicLayoutVertexArray,le={},ue=v.getProjection(),ce=Hm(I,ue,T),te=T.elevation,_e=ue.upVectorScale(I.canonical,T.center.lat,T.worldSize).metersToTile;ne.clear();for(let ve=0;ve<X.length;ve++){const be=X.get(ve),{tileAnchorX:$e,tileAnchorY:Ae,numGlyphs:Be}=be,Ze=v.allowVerticalPlacement&&!be.placedOrientation,ot=be.hidden||!be.crossTileID||Ze?null:b[be.crossTileID];if(ot){let ut=0,zt=0,rt=0;if(te){const cr=te?te.getAtTileOffset(I,$e,Ae):0,[Vr,ir,rr]=ue.upVector(I.canonical,$e,Ae);ut=cr*Vr*_e,zt=cr*ir*_e,rt=cr*rr*_e}let[Ot,vt,Mt,st]=Gt(be.projectedAnchorX+ut,be.projectedAnchorY+zt,be.projectedAnchorZ+rt,m?ce:P);const Ke=nn(T.getCameraToCenterDistance(ue),st);let dt=x.evaluateSizeForFeature(v.textSizeData,V,be)*Ke/a.ONE_EM;m&&(dt*=v.tilePixelRatio/L);const Pt=tT(ot,dt);m?({x:Ot,y:vt,z:Mt}=ue.projectTilePoint($e+Pt.x,Ae+Pt.y,I.canonical),[Ot,vt,Mt]=Gt(Ot+ut,vt+zt,Mt+rt,P)):(f&&Pt._rotate(-T.angle),Ot+=Pt.x,vt+=Pt.y,Mt=0);const Lt=v.allowVerticalPlacement&&be.placedOrientation===a.WritingMode.vertical?Math.PI/2:0;for(let cr=0;cr<Be;cr++)a.addDynamicAttributes(ne,Ot,vt,Mt,Lt);H&&be.associatedIconIndex>=0&&(le[be.associatedIconIndex]={x:Ot,y:vt,z:Mt,angle:Lt})}else Hn(Be,ne)}if(H){ae.clear();const ve=v.icon.placedSymbolArray;for(let be=0;be<ve.length;be++){const $e=ve.get(be),{numGlyphs:Ae}=$e,Be=le[be];if($e.hidden||!Be)Hn(Ae,ae);else{const{x:Ze,y:ot,z:ut,angle:zt}=Be;for(let rt=0;rt<Ae;rt++)a.addDynamicAttributes(ae,Ze,ot,ut,zt)}}v.icon.dynamicLayoutVertexBuffer.updateData(ae)}v.text.dynamicLayoutVertexBuffer.updateData(ne)}function qM(v,f,m){return m.iconsInText&&f?"symbolTextAndIcon":v?"symbolSDF":"symbolIcon"}function rT(v,f,m,b,x,T,P,I,L,V,H,X){const ne=v.context,ae=ne.gl,le=v.transform,ue=I==="map",ce=L==="map",te=ue&&m.layout.get("symbol-placement")!=="point",_e=ue&&!ce&&!te,ve=m.layout.get("symbol-sort-key").constantOr(1)!==void 0;let be=!1;const $e=v.depthModeForSublayer(0,a.DepthMode.ReadOnly),Ae=[a.mercatorXfromLng(le.center.lng),a.mercatorYfromLat(le.center.lat)],Be=m.layout.get("text-variable-anchor"),Ze=le.projection.name==="globe",ot=[],ut=[0,-1,0];let zt=ut;!Ze&&!le.mercatorFromTransition||ue||(zt=function(rt){const Ot=rt._camera.getWorldToCamera(rt.worldSize,1),vt=a.multiply([],Ot,rt.globeMatrix);a.invert(vt,vt);const Mt=[0,0,0],st=[0,1,0,0];return a.transformMat4$1(st,st,vt),Mt[0]=st[0],Mt[1]=st[1],Mt[2]=st[2],a.normalize(Mt,Mt),Mt}(le));for(const rt of b){const Ot=f.getTile(rt),vt=Ot.getBucket(m);if(!vt||vt.projection.name==="mercator"&&Ze)continue;const Mt=x?vt.text:vt.icon;if(!Mt||vt.fullyClipped||!Mt.segments.get().length)continue;const st=Mt.programConfigurations.get(m.id),Ke=x||vt.sdfIcons,dt=x?vt.textSizeData:vt.iconSizeData,Pt=ce||le.pitch!==0,Lt=a.evaluateSizeForZoom(dt,le.zoom);let cr,Vr,ir,rr,hr=[0,0],Zr=null;if(x){if(Vr=Ot.glyphAtlasTexture,ir=ae.LINEAR,cr=Ot.glyphAtlasTexture.size,vt.iconsInText){hr=Ot.imageAtlasTexture.size,Zr=Ot.imageAtlasTexture;const la=dt.kind==="composite"||dt.kind==="camera";rr=Pt||v.options.rotating||v.options.zooming||la?ae.LINEAR:ae.NEAREST}}else{const la=m.layout.get("icon-size").constantOr(0)!==1||vt.iconsNeedLinear;Vr=Ot.imageAtlasTexture,ir=Ke||v.options.rotating||v.options.zooming||la||Pt?ae.LINEAR:ae.NEAREST,cr=Ot.imageAtlasTexture.size}const _r=vt.projection.name==="globe",On=_r?zt:ut,kn=_r?a.globeToMercatorTransition(le.zoom):0,Vn=Hm(rt,vt.getProjection(),le),Nn=le.calculatePixelsToTileUnitsMatrix(Ot),Ri=sf(Vn,Ot.tileID.canonical,ce,ue,le,vt.getProjection(),Nn),Wo=v.terrain&&ce&&te?a.invert(a.create(),Ri):Iw,Ka=lf(Vn,Ot.tileID.canonical,ce,ue,le,vt.getProjection(),Nn),tl=Be&&vt.hasTextData(),Qn=m.layout.get("icon-text-fit")!=="none"&&tl&&vt.hasIconData();if(te){const la=le.elevation,ka=la?la.getAtTileOffsetFunc(rt,le.center.lat,le.worldSize,vt.getProjection()):null,rl=NE(Vn,Ot.tileID.canonical,ce,ue,le,vt.getProjection(),Nn);ws(vt,Vn,v,x,rl,Ka,ce,V,ka,rt)}const Bn=te||x&&Be||Qn,wn=v.translatePosMatrix(Vn,Ot,T,P),mi=Bn?Iw:Ri,So=v.translatePosMatrix(Ka,Ot,T,P,!0),qn=vt.getProjection().createInversionMatrix(le,rt.canonical),xo=[];v.terrainRenderModeElevated()&&ce&&xo.push("PITCH_WITH_MAP_TERRAIN"),_r&&xo.push("PROJECTION_GLOBE_VIEW"),Bn&&xo.push("PROJECTED_POS_ON_VIEWPORT");const Co=Ke&&m.paint.get(x?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let jl;jl=Ke?vt.iconsInText?Pw(dt.kind,Lt,_e,ce,v,wn,mi,So,cr,hr,rt,kn,Ae,qn,On,vt.getProjection()):QE(dt.kind,Lt,_e,ce,v,wn,mi,So,x,cr,!0,rt,kn,Ae,qn,On,vt.getProjection()):pd(dt.kind,Lt,_e,ce,v,wn,mi,So,x,cr,rt,kn,Ae,qn,On,vt.getProjection());const Of={program:v.useProgram(qM(Ke,x,vt),st,xo),buffers:Mt,uniformValues:jl,atlasTexture:Vr,atlasTextureIcon:Zr,atlasInterpolation:ir,atlasInterpolationIcon:rr,isSDF:Ke,hasHalo:Co,tile:Ot,labelPlaneMatrixInv:Wo};if(ve&&vt.canOverlap){be=!0;const la=Mt.segments.get();for(const ka of la)ot.push({segments:new a.SegmentVector([ka]),sortKey:ka.sortKey,state:Of})}else ot.push({segments:Mt.segments,sortKey:0,state:Of})}be&&ot.sort((rt,Ot)=>rt.sortKey-Ot.sortKey);for(const rt of ot){const Ot=rt.state;if(v.terrain&&v.terrain.setupElevationDraw(Ot.tile,Ot.program,{useDepthForOcclusion:!Ze,labelPlaneMatrixInv:Ot.labelPlaneMatrixInv}),ne.activeTexture.set(ae.TEXTURE0),Ot.atlasTexture.bind(Ot.atlasInterpolation,ae.CLAMP_TO_EDGE),Ot.atlasTextureIcon&&(ne.activeTexture.set(ae.TEXTURE1),Ot.atlasTextureIcon&&Ot.atlasTextureIcon.bind(Ot.atlasInterpolationIcon,ae.CLAMP_TO_EDGE)),Ot.isSDF){const vt=Ot.uniformValues;Ot.hasHalo&&(vt.u_is_halo=1,nT(Ot.buffers,rt.segments,m,v,Ot.program,$e,H,X,vt)),vt.u_is_halo=0}nT(Ot.buffers,rt.segments,m,v,Ot.program,$e,H,X,Ot.uniformValues)}}function nT(v,f,m,b,x,T,P,I,L){const V=b.context,H=[v.dynamicLayoutVertexBuffer,v.opacityVertexBuffer,v.globeExtVertexBuffer];x.draw(V,V.gl.TRIANGLES,T,P,I,a.CullFaceMode.disabled,L,m.id,v.layoutVertexBuffer,v.indexBuffer,f,m.paint,b.transform.zoom,v.programConfigurations.get(m.id),H)}function iT(v,f,m,b,x,T,P){const I=v.context.gl,L=m.paint.get("fill-pattern"),V=L&&L.constantOr(1);let H,X,ne,ae,le;P?(X=V&&!m.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",H=I.LINES):(X=V?"fillPattern":"fill",H=I.TRIANGLES);for(const ue of b){const ce=f.getTile(ue);if(V&&!ce.patternsLoaded())continue;const te=ce.getBucket(m);if(!te)continue;v.prepareDrawTile();const _e=te.programConfigurations.get(m.id),ve=v.useProgram(X,_e);V&&(v.context.activeTexture.set(I.TEXTURE0),ce.imageAtlasTexture.bind(I.LINEAR,I.CLAMP_TO_EDGE),_e.updatePaintBuffers());const be=L.constantOr(null);if(be&&ce.imageAtlas){const Ae=ce.imageAtlas.patternPositions[be.toString()];Ae&&_e.setConstantPatternPositions(Ae)}const $e=v.translatePosMatrix(ue.projMatrix,ce,m.paint.get("fill-translate"),m.paint.get("fill-translate-anchor"));if(P){ae=te.indexBuffer2,le=te.segments2;const Ae=v.terrain&&v.terrain.renderingToTexture?v.terrain.drapeBufferSize:[I.drawingBufferWidth,I.drawingBufferHeight];ne=X==="fillOutlinePattern"&&V?qE($e,v,ce,Ae):KE($e,Ae)}else ae=te.indexBuffer,le=te.segments,ne=V?ng($e,v,ce):rg($e);v.prepareDrawProgram(v.context,ve,ue.toUnwrapped()),ve.draw(v.context,H,x,v.stencilModeForClipping(ue),T,a.CullFaceMode.disabled,ne,m.id,te.layoutVertexBuffer,ae,le,m.paint,v.transform.zoom,_e)}}function Mw(v,f,m,b,x,T,P){const I=v.context,L=I.gl,V=v.transform,H=m.paint.get("fill-extrusion-pattern"),X=H.constantOr(1),ne=m.paint.get("fill-extrusion-opacity"),ae=[m.paint.get("fill-extrusion-ambient-occlusion-intensity"),m.paint.get("fill-extrusion-ambient-occlusion-radius")],le=m.layout.get("fill-extrusion-edge-radius"),ue=V.projection.name==="globe"?a.fillExtrusionHeightLift():0,ce=V.projection.name==="globe",te=ce?a.globeToMercatorTransition(V.zoom):0,_e=[a.mercatorXfromLng(V.center.lng),a.mercatorYfromLat(V.center.lat)],ve=[];ce&&ve.push("PROJECTION_GLOBE_VIEW"),ae[0]>0&&ve.push("FAUX_AO");for(const be of b){const $e=f.getTile(be),Ae=$e.getBucket(m);if(!Ae||Ae.projection.name!==V.projection.name)continue;const Be=Ae.programConfigurations.get(m.id),Ze=v.useProgram(X?"fillExtrusionPattern":"fillExtrusion",Be,ve);if(v.terrain){const Mt=v.terrain;if(v.style.terrainSetForDrapingOnly())Mt.setupElevationDraw($e,Ze,{useMeterToDem:!0});else{if(!Ae.enableTerrain)continue;if(Mt.setupElevationDraw($e,Ze,{useMeterToDem:!0}),XM(I,f,be,Ae,m,Mt),!Ae.centroidVertexBuffer){const st=Ze.attributes.a_centroid_pos;st!==void 0&&L.vertexAttrib2f(st,0,0)}}}X&&(v.context.activeTexture.set(L.TEXTURE0),$e.imageAtlasTexture.bind(L.LINEAR,L.CLAMP_TO_EDGE),Be.updatePaintBuffers());const ot=H.constantOr(null);if(ot&&$e.imageAtlas){const Mt=$e.imageAtlas.patternPositions[ot.toString()];Mt&&Be.setConstantPatternPositions(Mt)}const ut=v.translatePosMatrix(be.projMatrix,$e,m.paint.get("fill-extrusion-translate"),m.paint.get("fill-extrusion-translate-anchor")),zt=V.projection.createInversionMatrix(V,be.canonical),rt=m.paint.get("fill-extrusion-vertical-gradient"),Ot=X?Ew(ut,v,rt,ne,ae,le,be,$e,ue,te,_e,zt):tg(ut,v,rt,ne,ae,le,be,ue,te,_e,zt);v.prepareDrawProgram(I,Ze,be.toUnwrapped());const vt=[];v.terrain&&vt.push(Ae.centroidVertexBuffer),ce&&vt.push(Ae.layoutVertexExtBuffer),Ze.draw(I,I.gl.TRIANGLES,x,T,P,a.CullFaceMode.backCCW,Ot,m.id,Ae.layoutVertexBuffer,Ae.indexBuffer,Ae.segments,m.paint,v.transform.zoom,Be,vt)}}function XM(v,f,m,b,x,T){const P=[te=>{let _e=te.canonical.x-1,ve=te.wrap;return _e<0&&(_e=(1<<te.canonical.z)-1,ve--),new a.OverscaledTileID(te.overscaledZ,ve,te.canonical.z,_e,te.canonical.y)},te=>{let _e=te.canonical.x+1,ve=te.wrap;return _e===1<<te.canonical.z&&(_e=0,ve++),new a.OverscaledTileID(te.overscaledZ,ve,te.canonical.z,_e,te.canonical.y)},te=>new a.OverscaledTileID(te.overscaledZ,te.wrap,te.canonical.z,te.canonical.x,(te.canonical.y===0?1<<te.canonical.z:te.canonical.y)-1),te=>new a.OverscaledTileID(te.overscaledZ,te.wrap,te.canonical.z,te.canonical.x,te.canonical.y===(1<<te.canonical.z)-1?0:te.canonical.y+1)],I=te=>{const _e=f.getSource().minzoom,ve=$e=>{const Ae=f.getTileByID($e);if(Ae&&Ae.hasData())return Ae.getBucket(x)},be=[0,-1,1];for(const $e of be){if(te.overscaledZ+$e<_e)continue;const Ae=ve(te.calculateScaledKey(te.overscaledZ+$e));if(Ae)return Ae}},L=[0,0,0],V=(te,_e)=>(L[0]=Math.min(te.min.y,_e.min.y),L[1]=Math.max(te.max.y,_e.max.y),L[2]=a.EXTENT-_e.min.x>te.max.x?_e.min.x-a.EXTENT:te.max.x,L),H=(te,_e)=>(L[0]=Math.min(te.min.x,_e.min.x),L[1]=Math.max(te.max.x,_e.max.x),L[2]=a.EXTENT-_e.min.y>te.max.y?_e.min.y-a.EXTENT:te.max.y,L),X=[(te,_e)=>V(te,_e),(te,_e)=>V(_e,te),(te,_e)=>H(te,_e),(te,_e)=>H(_e,te)],ne=new a.pointGeometry(0,0);let ae,le,ue;const ce=(te,_e,ve,be,$e)=>{const Ae=[[be?ve:te,be?te:ve,0],[be?ve:_e,be?_e:ve,0]],Be=$e<0?a.EXTENT+$e:$e,Ze=[be?Be:(te+_e)/2,be?(te+_e)/2:Be,0];return ve===0&&$e<0||ve!==0&&$e>0?T.getForTilePoints(ue,[Ze],!0,le):Ae.push(Ze),T.getForTilePoints(m,Ae,!0,ae),Math.max(Ae[0][2],Ae[1][2],Ze[2])/T.exaggeration()};for(let te=0;te<4;te++){const _e=(te<2?1:5)-te,ve=b.borders[te];if(ve.length===0)continue;const be=ue=P[te](m),$e=I(be);if(!($e&&$e instanceof a.FillExtrusionBucket&&$e.enableTerrain)||b.borderDoneWithNeighborZ[te]===$e.canonical.z&&$e.borderDoneWithNeighborZ[_e]===b.canonical.z||(le=T.findDEMTileFor(be),!le||!le.dem))continue;if(!ae){const ot=T.findDEMTileFor(m);if(!ot||!ot.dem)return;ae=ot}const Ae=$e.borders[_e];let Be=0;const Ze=$e.borderDoneWithNeighborZ[_e]!==b.canonical.z;if(b.canonical.z===$e.canonical.z){for(let ot=0;ot<ve.length;ot++){const ut=b.featuresOnBorder[ve[ot]],zt=ut.borders[te];let rt;for(;Be<Ae.length&&(rt=$e.featuresOnBorder[Ae[Be]],!(rt.borders[_e][1]>zt[0]+3));)Ze&&$e.encodeCentroid(void 0,rt,!1),Be++;if(rt&&Be<Ae.length){const Ot=Be;let vt=0;for(;!(rt.borders[_e][0]>zt[1]-3)&&(vt++,++Be!==Ae.length);)rt=$e.featuresOnBorder[Ae[Be]];if(rt=$e.featuresOnBorder[Ae[Ot]],ut.intersectsCount()>1||rt.intersectsCount()>1||vt!==1){vt!==1&&(Be=Ot),b.encodeCentroid(void 0,ut,!1),Ze&&$e.encodeCentroid(void 0,rt,!1);continue}const Mt=X[te](ut,rt),st=te%2?a.EXTENT-1:0;ne.x=ce(Mt[0],Math.min(a.EXTENT-1,Mt[1]),st,te<2,Mt[2]),ne.y=0,b.encodeCentroid(ne,ut,!1),Ze&&$e.encodeCentroid(ne,rt,!1)}else b.encodeCentroid(void 0,ut,!1)}b.borderDoneWithNeighborZ[te]=$e.canonical.z,b.needsCentroidUpdate=!0,Ze&&($e.borderDoneWithNeighborZ[_e]=b.canonical.z,$e.needsCentroidUpdate=!0)}else{for(const ot of ve)b.encodeCentroid(void 0,b.featuresOnBorder[ot],!1);if(Ze){for(const ot of Ae)$e.encodeCentroid(void 0,$e.featuresOnBorder[ot],!1);$e.borderDoneWithNeighborZ[_e]=b.canonical.z,$e.needsCentroidUpdate=!0}b.borderDoneWithNeighborZ[te]=$e.canonical.z,b.needsCentroidUpdate=!0}}(b.needsCentroidUpdate||!b.centroidVertexBuffer&&b.centroidVertexArray.length!==0)&&b.uploadCentroid(v)}const $w=new a.Color(1,0,0,1),Dw=new a.Color(0,1,0,1),oT=new a.Color(0,0,1,1),aT=new a.Color(1,0,1,1),sT=new a.Color(0,1,1,1);function Lw(v,f,m){const b=v.context,x=v.transform,T=b.gl,P=x.projection.name==="globe",I=P?["PROJECTION_GLOBE_VIEW"]:null;let L=m.projMatrix;if(P&&a.globeToMercatorTransition(x.zoom)>0){const ut=a.transitionTileAABBinECEF(m.canonical,x),zt=a.globeDenormalizeECEF(ut);L=a.multiply(new Float32Array(16),x.globeMatrix,zt),a.multiply(L,x.projMatrix,L)}const V=v.useProgram("debug",null,I),H=f.getTileByID(m.key);v.terrain&&v.terrain.setupElevationDraw(H,V);const X=a.DepthMode.disabled,ne=a.StencilMode.disabled,ae=v.colorModeForRenderPass(),le="$debug";b.activeTexture.set(T.TEXTURE0),v.emptyTexture.bind(T.LINEAR,T.CLAMP_TO_EDGE),P?H._makeGlobeTileDebugBuffers(v.context,x):H._makeDebugTileBoundsBuffers(v.context,x.projection);const ue=H._tileDebugBuffer||v.debugBuffer,ce=H._tileDebugIndexBuffer||v.debugIndexBuffer,te=H._tileDebugSegments||v.debugSegments;V.draw(b,T.LINE_STRIP,X,ne,ae,a.CullFaceMode.disabled,dd(L,a.Color.red),le,ue,ce,te,null,null,null,[H._globeTileDebugBorderBuffer]);const _e=H.latestRawTileData,ve=Math.floor((_e&&_e.byteLength||0)/1024),be=f.getTile(m).tileSize,$e=512/Math.min(be,512)*(m.overscaledZ/x.zoom)*.5;let Ae=m.canonical.toString();m.overscaledZ!==m.canonical.z&&(Ae+=` => ${m.overscaledZ}`),Ae+=` ${ve}kb`,function(ut,zt){ut.initDebugOverlayCanvas();const rt=ut.debugOverlayCanvas,Ot=ut.context.gl,vt=ut.debugOverlayCanvas.getContext("2d");vt.clearRect(0,0,rt.width,rt.height),vt.shadowColor="white",vt.shadowBlur=2,vt.lineWidth=1.5,vt.strokeStyle="white",vt.textBaseline="top",vt.font="bold 36px Open Sans, sans-serif",vt.fillText(zt,5,5),vt.strokeText(zt,5,5),ut.debugOverlayTexture.update(rt),ut.debugOverlayTexture.bind(Ot.LINEAR,Ot.CLAMP_TO_EDGE)}(v,Ae);const Be=H._tileDebugTextBuffer||v.debugBuffer,Ze=H._tileDebugTextIndexBuffer||v.quadTriangleIndexBuffer,ot=H._tileDebugTextSegments||v.debugSegments;V.draw(b,T.TRIANGLES,X,ne,a.ColorMode.alphaBlended,a.CullFaceMode.disabled,dd(L,a.Color.transparent,$e),le,Be,Ze,ot,null,null,null,[H._globeTileDebugTextBuffer])}function Bl(v,f,m,b){md(v,0,f+m/2,v.transform.width,m,b)}function yf(v,f,m,b){md(v,f-m/2,0,m,v.transform.height,b)}function md(v,f,m,b,x,T){const P=v.context,I=P.gl;I.enable(I.SCISSOR_TEST),I.scissor(f*a.exported.devicePixelRatio,m*a.exported.devicePixelRatio,b*a.exported.devicePixelRatio,x*a.exported.devicePixelRatio),P.clear({color:T}),I.disable(I.SCISSOR_TEST)}const vf=a.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:_f}=vf;function Qs(v,f,m,b){v.emplaceBack(f,m,b)}class ag{constructor(f){this.vertexArray=new a.StructArrayLayout3f12,this.indices=new a.StructArrayLayout3ui6,Qs(this.vertexArray,-1,-1,1),Qs(this.vertexArray,1,-1,1),Qs(this.vertexArray,-1,1,1),Qs(this.vertexArray,1,1,1),Qs(this.vertexArray,-1,-1,-1),Qs(this.vertexArray,1,-1,-1),Qs(this.vertexArray,-1,1,-1),Qs(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=f.createVertexBuffer(this.vertexArray,_f),this.indexBuffer=f.createIndexBuffer(this.indices),this.segment=a.SegmentVector.simpleSegment(0,0,36,12)}}function cn(v,f,m,b,x,T){const P=v.gl,I=f.paint.get("sky-atmosphere-color"),L=f.paint.get("sky-atmosphere-halo-color"),V=f.paint.get("sky-atmosphere-sun-intensity"),H=((X,ne,ae,le,ue)=>({u_matrix_3f:X,u_sun_direction:ne,u_sun_intensity:ae,u_color_tint_r:[le.r,le.g,le.b,le.a],u_color_tint_m:[ue.r,ue.g,ue.b,ue.a],u_luminance:5e-5}))(a.fromMat4(a.create$1(),b),x,V,I,L);P.framebufferTexture2D(P.FRAMEBUFFER,P.COLOR_ATTACHMENT0,P.TEXTURE_CUBE_MAP_POSITIVE_X+T,f.skyboxTexture,0),m.draw(v,P.TRIANGLES,a.DepthMode.disabled,a.StencilMode.disabled,a.ColorMode.unblended,a.CullFaceMode.frontCW,H,"skyboxCapture",f.skyboxGeometry.vertexBuffer,f.skyboxGeometry.indexBuffer,f.skyboxGeometry.segment)}const sg=a.createLayout([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class ZM{constructor(f){const m=new a.StructArrayLayout5f20;m.emplaceBack(-1,1,1,0,0),m.emplaceBack(1,1,1,1,0),m.emplaceBack(1,-1,1,1,1),m.emplaceBack(-1,-1,1,0,1);const b=new a.StructArrayLayout3ui6;b.emplaceBack(0,1,2),b.emplaceBack(2,3,0),this.vertexBuffer=f.createVertexBuffer(m,sg.members),this.indexBuffer=f.createIndexBuffer(b),this.segments=a.SegmentVector.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const Nw={symbol:function(v,f,m,b,x){if(v.renderPass!=="translucent")return;const T=a.StencilMode.disabled,P=v.colorModeForRenderPass();m.layout.get("text-variable-anchor")&&function(I,L,V,H,X,ne,ae){const le=L.transform,ue=X==="map",ce=ne==="map";for(const te of I){const _e=H.getTile(te),ve=_e.getBucket(V);if(!ve||!ve.text||!ve.text.segments.get().length)continue;const be=a.evaluateSizeForZoom(ve.textSizeData,le.zoom),$e=Hm(te,ve.getProjection(),le),Ae=le.calculatePixelsToTileUnitsMatrix(_e),Be=sf($e,_e.tileID.canonical,ce,ue,le,ve.getProjection(),Ae),Ze=V.layout.get("icon-text-fit")!=="none"&&ve.hasIconData();if(be){const ot=Math.pow(2,le.zoom-_e.tileID.overscaledZ);gf(ve,ue,ce,ae,a.symbolSize,le,Be,te,ot,be,Ze)}}}(b,v,m,f,m.layout.get("text-rotation-alignment"),m.layout.get("text-pitch-alignment"),x),m.paint.get("icon-opacity").constantOr(1)!==0&&rT(v,f,m,b,!1,m.paint.get("icon-translate"),m.paint.get("icon-translate-anchor"),m.layout.get("icon-rotation-alignment"),m.layout.get("icon-pitch-alignment"),m.layout.get("icon-keep-upright"),T,P),m.paint.get("text-opacity").constantOr(1)!==0&&rT(v,f,m,b,!0,m.paint.get("text-translate"),m.paint.get("text-translate-anchor"),m.layout.get("text-rotation-alignment"),m.layout.get("text-pitch-alignment"),m.layout.get("text-keep-upright"),T,P),f.map.showCollisionBoxes&&(eT(v,f,m,b,m.paint.get("text-translate"),m.paint.get("text-translate-anchor"),!0),eT(v,f,m,b,m.paint.get("icon-translate"),m.paint.get("icon-translate-anchor"),!1))},circle:function(v,f,m,b){if(v.renderPass!=="translucent")return;const x=m.paint.get("circle-opacity"),T=m.paint.get("circle-stroke-width"),P=m.paint.get("circle-stroke-opacity"),I=m.layout.get("circle-sort-key").constantOr(1)!==void 0;if(x.constantOr(1)===0&&(T.constantOr(1)===0||P.constantOr(1)===0))return;const L=v.context,V=L.gl,H=v.transform,X=v.depthModeForSublayer(0,a.DepthMode.ReadOnly),ne=a.StencilMode.disabled,ae=v.colorModeForRenderPass(),le=H.projection.name==="globe",ue=[a.mercatorXfromLng(H.center.lng),a.mercatorYfromLat(H.center.lat)],ce=[];for(let _e=0;_e<b.length;_e++){const ve=b[_e],be=f.getTile(ve),$e=be.getBucket(m);if(!$e||$e.projection.name!==H.projection.name)continue;const Ae=$e.programConfigurations.get(m.id),Be=hd(m);le&&Be.push("PROJECTION_GLOBE_VIEW");const Ze=v.useProgram("circle",Ae,Be),ot=$e.layoutVertexBuffer,ut=$e.globeExtVertexBuffer,zt=$e.indexBuffer,rt=H.projection.createInversionMatrix(H,ve.canonical),Ot={programConfiguration:Ae,program:Ze,layoutVertexBuffer:ot,globeExtVertexBuffer:ut,indexBuffer:zt,uniformValues:fd(v,ve,be,rt,ue,m),tile:be};if(I){const vt=$e.segments.get();for(const Mt of vt)ce.push({segments:new a.SegmentVector([Mt]),sortKey:Mt.sortKey,state:Ot})}else ce.push({segments:$e.segments,sortKey:0,state:Ot})}I&&ce.sort((_e,ve)=>_e.sortKey-ve.sortKey);const te={useDepthForOcclusion:!le};for(const _e of ce){const{programConfiguration:ve,program:be,layoutVertexBuffer:$e,globeExtVertexBuffer:Ae,indexBuffer:Be,uniformValues:Ze,tile:ot}=_e.state,ut=_e.segments;v.terrain&&v.terrain.setupElevationDraw(ot,be,te),v.prepareDrawProgram(L,be,ot.tileID.toUnwrapped()),be.draw(L,V.TRIANGLES,X,ne,ae,a.CullFaceMode.disabled,Ze,m.id,$e,Be,ut,m.paint,H.zoom,ve,[Ae])}},heatmap:function(v,f,m,b){if(m.paint.get("heatmap-opacity")!==0)if(v.renderPass==="offscreen"){const x=v.context,T=x.gl,P=a.StencilMode.disabled,I=new a.ColorMode([T.ONE,T.ONE],a.Color.transparent,[!0,!0,!0,!0]);(function(ae,le,ue,ce){const te=ae.gl,_e=le.width*ce,ve=le.height*ce;ae.activeTexture.set(te.TEXTURE1),ae.viewport.set([0,0,_e,ve]);let be=ue.heatmapFbo;if(!be||be&&(be.width!==_e||be.height!==ve)){be&&be.destroy();const $e=te.createTexture();te.bindTexture(te.TEXTURE_2D,$e),te.texParameteri(te.TEXTURE_2D,te.TEXTURE_WRAP_S,te.CLAMP_TO_EDGE),te.texParameteri(te.TEXTURE_2D,te.TEXTURE_WRAP_T,te.CLAMP_TO_EDGE),te.texParameteri(te.TEXTURE_2D,te.TEXTURE_MIN_FILTER,te.LINEAR),te.texParameteri(te.TEXTURE_2D,te.TEXTURE_MAG_FILTER,te.LINEAR),be=ue.heatmapFbo=ae.createFramebuffer(_e,ve,!1),function(Ae,Be,Ze,ot,ut,zt){const rt=Ae.gl;rt.texImage2D(rt.TEXTURE_2D,0,Ae.isWebGL2&&Ae.extRenderToTextureHalfFloat?rt.RGBA16F:rt.RGBA,ut,zt,0,rt.RGBA,Ae.extRenderToTextureHalfFloat?Ae.isWebGL2?rt.HALF_FLOAT:Ae.extTextureHalfFloat.HALF_FLOAT_OES:rt.UNSIGNED_BYTE,null),ot.colorAttachment.set(Ze)}(ae,0,$e,be,_e,ve)}else te.bindTexture(te.TEXTURE_2D,be.colorAttachment.get()),ae.bindFramebuffer.set(be.framebuffer)})(x,v,m,v.transform.projection.name==="globe"?.5:.25),x.clear({color:a.Color.transparent});const L=v.transform,V=L.projection.name==="globe",H=V?["PROJECTION_GLOBE_VIEW"]:null,X=V?a.CullFaceMode.frontCCW:a.CullFaceMode.disabled,ne=[a.mercatorXfromLng(L.center.lng),a.mercatorYfromLat(L.center.lat)];for(let ae=0;ae<b.length;ae++){const le=b[ae];if(f.hasRenderableParent(le))continue;const ue=f.getTile(le),ce=ue.getBucket(m);if(!ce||ce.projection.name!==L.projection.name)continue;const te=ce.programConfigurations.get(m.id),_e=v.useProgram("heatmap",te,H),{zoom:ve}=v.transform;v.terrain&&v.terrain.setupElevationDraw(ue,_e),v.prepareDrawProgram(x,_e,le.toUnwrapped());const be=L.projection.createInversionMatrix(L,le.canonical);_e.draw(x,T.TRIANGLES,a.DepthMode.disabled,P,I,X,Ss(v,le,ue,be,ne,ve,m.paint.get("heatmap-intensity")),m.id,ce.layoutVertexBuffer,ce.indexBuffer,ce.segments,m.paint,v.transform.zoom,te,V?[ce.globeExtVertexBuffer]:null)}x.viewport.set([0,0,v.width,v.height])}else v.renderPass==="translucent"&&(v.context.setColorMode(v.colorModeForRenderPass()),function(x,T){const P=x.context,I=P.gl,L=T.heatmapFbo;if(!L)return;P.activeTexture.set(I.TEXTURE0),I.bindTexture(I.TEXTURE_2D,L.colorAttachment.get()),P.activeTexture.set(I.TEXTURE1);let V=T.colorRampTexture;V||(V=T.colorRampTexture=new a.Texture(P,T.colorRamp,I.RGBA)),V.bind(I.LINEAR,I.CLAMP_TO_EDGE),x.useProgram("heatmapTexture").draw(P,I.TRIANGLES,a.DepthMode.disabled,a.StencilMode.disabled,x.colorModeForRenderPass(),a.CullFaceMode.disabled,((H,X,ne,ae)=>({u_image:0,u_color_ramp:1,u_opacity:X.paint.get("heatmap-opacity")}))(0,T),T.id,x.viewportBuffer,x.quadTriangleIndexBuffer,x.viewportSegments,T.paint,x.transform.zoom)}(v,m))},line:function(v,f,m,b){if(v.renderPass!=="translucent")return;const x=m.paint.get("line-opacity"),T=m.paint.get("line-width");if(x.constantOr(1)===0||T.constantOr(1)===0)return;const P=v.depthModeForSublayer(0,a.DepthMode.ReadOnly),I=v.colorModeForRenderPass(),L=v.terrain&&v.terrain.renderingToTexture?1:a.exported.devicePixelRatio,V=m.paint.get("line-dasharray"),H=V.constantOr(1),X=m.layout.get("line-cap"),ne=m.paint.get("line-pattern"),ae=ne.constantOr(1),le=m.paint.get("line-gradient"),ue=ae?"linePattern":"line",ce=v.context,te=ce.gl,_e=(be=>{const $e=[];og(be)&&$e.push("RENDER_LINE_DASH"),be.paint.get("line-gradient")&&$e.push("RENDER_LINE_GRADIENT");const Ae=be.paint.get("line-trim-offset");Ae[0]===0&&Ae[1]===0||$e.push("RENDER_LINE_TRIM_OFFSET");const Be=be.paint.get("line-pattern").constantOr(1),Ze=be.paint.get("line-opacity").constantOr(1)!==1;return!Be&&Ze&&$e.push("RENDER_LINE_ALPHA_DISCARD"),$e})(m);let ve=_e.includes("RENDER_LINE_ALPHA_DISCARD");v.terrain&&v.terrain.clipOrMaskOverlapStencilType()&&(ve=!1);for(const be of b){const $e=f.getTile(be);if(ae&&!$e.patternsLoaded())continue;const Ae=$e.getBucket(m);if(!Ae)continue;v.prepareDrawTile();const Be=Ae.programConfigurations.get(m.id),Ze=v.useProgram(ue,Be,_e),ot=ne.constantOr(null);if(ot&&$e.imageAtlas){const Ke=$e.imageAtlas.patternPositions[ot.toString()];Ke&&Be.setConstantPatternPositions(Ke)}const ut=V.constantOr(null),zt=X.constantOr(null);if(!ae&&ut&&zt&&$e.lineAtlas){const Ke=$e.lineAtlas.getDash(ut,zt);Ke&&Be.setConstantPatternPositions(Ke)}let[rt,Ot]=m.paint.get("line-trim-offset");(zt==="round"||zt==="square")&&rt!==Ot&&(rt===0&&(rt-=1),Ot===1&&(Ot+=1));const vt=v.terrain?be.projMatrix:null,Mt=ae?ZE(v,$e,m,vt,L):Ow(v,$e,m,vt,Ae.lineClipsArray.length,L,[rt,Ot]);if(le){const Ke=Ae.gradients[m.id];let dt=Ke.texture;if(m.gradientVersion!==Ke.version){let Pt=256;if(m.stepInterpolant){const Lt=f.getSource().maxzoom,cr=be.canonical.z===Lt?Math.ceil(1<<v.transform.maxZoom-be.canonical.z):1;Pt=a.clamp(a.nextPowerOfTwo(Ae.maxLineLength/a.EXTENT*1024*cr),256,ce.maxTextureSize)}Ke.gradient=a.renderColorRamp({expression:m.gradientExpression(),evaluationKey:"lineProgress",resolution:Pt,image:Ke.gradient||void 0,clips:Ae.lineClipsArray}),Ke.texture?Ke.texture.update(Ke.gradient):Ke.texture=new a.Texture(ce,Ke.gradient,te.RGBA),Ke.version=m.gradientVersion,dt=Ke.texture}ce.activeTexture.set(te.TEXTURE1),dt.bind(m.stepInterpolant?te.NEAREST:te.LINEAR,te.CLAMP_TO_EDGE)}H&&(ce.activeTexture.set(te.TEXTURE0),$e.lineAtlasTexture.bind(te.LINEAR,te.REPEAT),Be.updatePaintBuffers()),ae&&(ce.activeTexture.set(te.TEXTURE0),$e.imageAtlasTexture.bind(te.LINEAR,te.CLAMP_TO_EDGE),Be.updatePaintBuffers()),v.prepareDrawProgram(ce,Ze,be.toUnwrapped());const st=Ke=>{Ze.draw(ce,te.TRIANGLES,P,Ke,I,a.CullFaceMode.disabled,Mt,m.id,Ae.layoutVertexBuffer,Ae.indexBuffer,Ae.segments,m.paint,v.transform.zoom,Be,[Ae.layoutVertexBuffer2])};if(ve){const Ke=v.stencilModeForClipping(be).ref;Ke===0&&v.terrain&&ce.clear({stencil:0});const dt={func:te.EQUAL,mask:255};Mt.u_alpha_discard_threshold=.8,st(new a.StencilMode(dt,Ke,255,te.KEEP,te.KEEP,te.INVERT)),Mt.u_alpha_discard_threshold=0,st(new a.StencilMode(dt,Ke,255,te.KEEP,te.KEEP,te.KEEP))}else st(v.stencilModeForClipping(be))}ve&&(v.resetStencilClippingMasks(),v.terrain&&ce.clear({stencil:0}))},fill:function(v,f,m,b){const x=m.paint.get("fill-color"),T=m.paint.get("fill-opacity");if(T.constantOr(1)===0)return;const P=v.colorModeForRenderPass(),I=m.paint.get("fill-pattern"),L=v.opaquePassEnabledForLayer()&&!I.constantOr(1)&&x.constantOr(a.Color.transparent).a===1&&T.constantOr(0)===1?"opaque":"translucent";if(v.renderPass===L){const V=v.depthModeForSublayer(1,v.renderPass==="opaque"?a.DepthMode.ReadWrite:a.DepthMode.ReadOnly);iT(v,f,m,b,V,P,!1)}if(v.renderPass==="translucent"&&m.paint.get("fill-antialias")){const V=v.depthModeForSublayer(m.getPaintProperty("fill-outline-color")?2:0,a.DepthMode.ReadOnly);iT(v,f,m,b,V,P,!0)}},"fill-extrusion":function(v,f,m,b){const x=m.paint.get("fill-extrusion-opacity");if(x!==0&&v.renderPass==="translucent"){const T=new a.DepthMode(v.context.gl.LEQUAL,a.DepthMode.ReadWrite,v.depthRangeFor3D);if(x!==1||m.paint.get("fill-extrusion-pattern").constantOr(1))Mw(v,f,m,b,T,a.StencilMode.disabled,a.ColorMode.disabled),Mw(v,f,m,b,T,v.stencilModeFor3D(),v.colorModeForRenderPass()),v.resetStencilClippingMasks();else{const P=v.colorModeForRenderPass();Mw(v,f,m,b,T,a.StencilMode.disabled,P)}}},hillshade:function(v,f,m,b){if(v.renderPass!=="offscreen"&&v.renderPass!=="translucent")return;const x=v.context,T=v.depthModeForSublayer(0,a.DepthMode.ReadOnly),P=v.colorModeForRenderPass(),I=v.terrain&&v.terrain.renderingToTexture,[L,V]=v.renderPass!=="translucent"||I?[{},b]:v.stencilConfigForOverlap(b);for(const H of V){const X=f.getTile(H);if(X.needsHillshadePrepare&&v.renderPass==="offscreen")Zm(v,X,m,T,a.StencilMode.disabled,P);else if(v.renderPass==="translucent"){const ne=I&&v.terrain?v.terrain.stencilModeForRTTOverlap(H):L[H.overscaledZ];ld(v,H,X,m,T,ne,P)}}x.viewport.set([0,0,v.width,v.height]),v.resetStencilClippingMasks()},raster:function(v,f,m,b,x,T){if(v.renderPass!=="translucent"||m.paint.get("raster-opacity")===0||!b.length)return;const P=v.context,I=P.gl,L=f.getSource(),V=v.useProgram("raster"),H=v.colorModeForRenderPass(),X=v.terrain&&v.terrain.renderingToTexture,[ne,ae]=L instanceof De||X?[{},b]:v.stencilConfigForOverlap(b),le=ae[ae.length-1].overscaledZ,ue=!v.options.moving;for(const ce of ae){const te=X?a.DepthMode.disabled:v.depthModeForSublayer(ce.overscaledZ-le,m.paint.get("raster-opacity")===1?a.DepthMode.ReadWrite:a.DepthMode.ReadOnly,I.LESS),_e=ce.toUnwrapped(),ve=f.getTile(ce);if(X&&(!ve||!ve.hasData()))continue;const be=X?ce.projMatrix:v.transform.calculateProjMatrix(_e,ue),$e=v.terrain&&X?v.terrain.stencilModeForRTTOverlap(ce):ne[ce.overscaledZ],Ae=T?0:m.paint.get("raster-fade-duration");ve.registerFadeDuration(Ae);const Be=f.findLoadedParent(ce,0),Ze=cd(ve,Be,f,v.transform,Ae);let ot,ut;v.terrain&&v.terrain.prepareDrawTile();const zt=m.paint.get("raster-resampling")==="nearest"?I.NEAREST:I.LINEAR;P.activeTexture.set(I.TEXTURE0),ve.texture.bind(zt,I.CLAMP_TO_EDGE),P.activeTexture.set(I.TEXTURE1),Be?(Be.texture.bind(zt,I.CLAMP_TO_EDGE),ot=Math.pow(2,Be.tileID.overscaledZ-ve.tileID.overscaledZ),ut=[ve.tileID.canonical.x*ot%1,ve.tileID.canonical.y*ot%1]):ve.texture.bind(zt,I.CLAMP_TO_EDGE),ve.texture.useMipmap&&P.extTextureFilterAnisotropic&&v.transform.pitch>20&&I.texParameterf(I.TEXTURE_2D,P.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,P.extTextureFilterAnisotropicMax);const rt=GM(be,ut||[0,0],ot||1,Ze,m,L instanceof De?L.perspectiveTransform:[0,0]);if(v.prepareDrawProgram(P,V,_e),L instanceof De)L.boundsBuffer&&L.boundsSegments&&V.draw(P,I.TRIANGLES,te,a.StencilMode.disabled,H,a.CullFaceMode.disabled,rt,m.id,L.boundsBuffer,v.quadTriangleIndexBuffer,L.boundsSegments);else{const{tileBoundsBuffer:Ot,tileBoundsIndexBuffer:vt,tileBoundsSegments:Mt}=v.getTileBoundsBuffers(ve);V.draw(P,I.TRIANGLES,te,$e,H,a.CullFaceMode.disabled,rt,m.id,Ot,vt,Mt)}}v.resetStencilClippingMasks()},background:function(v,f,m,b){const x=m.paint.get("background-color"),T=m.paint.get("background-opacity");if(T===0)return;const P=v.context,I=P.gl,L=v.transform,V=L.tileSize,H=m.paint.get("background-pattern");if(v.isPatternMissing(H))return;const X=!H&&x.a===1&&T===1&&v.opaquePassEnabledForLayer()?"opaque":"translucent";if(v.renderPass!==X)return;const ne=a.StencilMode.disabled,ae=v.depthModeForSublayer(0,X==="opaque"?a.DepthMode.ReadWrite:a.DepthMode.ReadOnly),le=v.colorModeForRenderPass(),ue=v.useProgram(H?"backgroundPattern":"background");let ce,te=b;te||(ce=v.getBackgroundTiles(),te=Object.values(ce).map(_e=>_e.tileID)),H&&(P.activeTexture.set(I.TEXTURE0),v.imageManager.bind(v.context));for(const _e of te){const ve=_e.toUnwrapped(),be=b?_e.projMatrix:v.transform.calculateProjMatrix(ve);v.prepareDrawTile();const $e=f?f.getTile(_e):ce?ce[_e.key]:new a.Tile(_e,V,L.zoom,v),Ae=H?Aw(be,T,v,H,{tileID:_e,tileSize:V}):YM(be,T,x);v.prepareDrawProgram(P,ue,ve);const{tileBoundsBuffer:Be,tileBoundsIndexBuffer:Ze,tileBoundsSegments:ot}=v.getTileBoundsBuffers($e);ue.draw(P,I.TRIANGLES,ae,ne,le,a.CullFaceMode.disabled,Ae,m.id,Be,Ze,ot)}},sky:function(v,f,m){const b=v.transform,x=b.projection.name==="mercator"||b.projection.name==="globe"?1:a.smoothstep(7,8,b.zoom),T=m.paint.get("sky-opacity")*x;if(T===0)return;const P=v.context,I=m.paint.get("sky-type"),L=new a.DepthMode(P.gl.LEQUAL,a.DepthMode.ReadOnly,[0,1]),V=v.frameCounter/1e3%1;I==="atmosphere"?v.renderPass==="offscreen"?m.needsSkyboxCapture(v)&&(function(H,X,ne,ae){const le=H.context,ue=le.gl;let ce=X.skyboxFbo;if(!ce){ce=X.skyboxFbo=le.createFramebuffer(32,32,!1),X.skyboxGeometry=new ag(le),X.skyboxTexture=le.gl.createTexture(),ue.bindTexture(ue.TEXTURE_CUBE_MAP,X.skyboxTexture),ue.texParameteri(ue.TEXTURE_CUBE_MAP,ue.TEXTURE_WRAP_S,ue.CLAMP_TO_EDGE),ue.texParameteri(ue.TEXTURE_CUBE_MAP,ue.TEXTURE_WRAP_T,ue.CLAMP_TO_EDGE),ue.texParameteri(ue.TEXTURE_CUBE_MAP,ue.TEXTURE_MIN_FILTER,ue.LINEAR),ue.texParameteri(ue.TEXTURE_CUBE_MAP,ue.TEXTURE_MAG_FILTER,ue.LINEAR);for(let be=0;be<6;++be)ue.texImage2D(ue.TEXTURE_CUBE_MAP_POSITIVE_X+be,0,ue.RGBA,32,32,0,ue.RGBA,ue.UNSIGNED_BYTE,null)}le.bindFramebuffer.set(ce.framebuffer),le.viewport.set([0,0,32,32]);const te=X.getCenter(H,!0),_e=H.useProgram("skyboxCapture"),ve=new Float64Array(16);a.identity(ve),a.rotateY(ve,ve,.5*-Math.PI),cn(le,X,_e,ve,te,0),a.identity(ve),a.rotateY(ve,ve,.5*Math.PI),cn(le,X,_e,ve,te,1),a.identity(ve),a.rotateX(ve,ve,.5*-Math.PI),cn(le,X,_e,ve,te,2),a.identity(ve),a.rotateX(ve,ve,.5*Math.PI),cn(le,X,_e,ve,te,3),a.identity(ve),cn(le,X,_e,ve,te,4),a.identity(ve),a.rotateY(ve,ve,Math.PI),cn(le,X,_e,ve,te,5),le.viewport.set([0,0,H.width,H.height])}(v,m),m.markSkyboxValid(v)):v.renderPass==="sky"&&function(H,X,ne,ae,le){const ue=H.context,ce=ue.gl,te=H.transform,_e=H.useProgram("skybox");ue.activeTexture.set(ce.TEXTURE0),ce.bindTexture(ce.TEXTURE_CUBE_MAP,X.skyboxTexture);const ve=((be,$e,Ae,Be,Ze)=>({u_matrix:be,u_sun_direction:$e,u_cubemap:0,u_opacity:Be,u_temporal_offset:Ze}))(te.skyboxMatrix,X.getCenter(H,!1),0,ae,le);H.prepareDrawProgram(ue,_e),_e.draw(ue,ce.TRIANGLES,ne,a.StencilMode.disabled,H.colorModeForRenderPass(),a.CullFaceMode.backCW,ve,"skybox",X.skyboxGeometry.vertexBuffer,X.skyboxGeometry.indexBuffer,X.skyboxGeometry.segment)}(v,m,L,T,V):I==="gradient"&&v.renderPass==="sky"&&function(H,X,ne,ae,le){const ue=H.context,ce=ue.gl,te=H.transform,_e=H.useProgram("skyboxGradient");X.skyboxGeometry||(X.skyboxGeometry=new ag(ue)),ue.activeTexture.set(ce.TEXTURE0);let ve=X.colorRampTexture;ve||(ve=X.colorRampTexture=new a.Texture(ue,X.colorRamp,ce.RGBA)),ve.bind(ce.LINEAR,ce.CLAMP_TO_EDGE);const be=(($e,Ae,Be,Ze,ot)=>({u_matrix:$e,u_color_ramp:0,u_center_direction:Ae,u_radius:a.degToRad(Be),u_opacity:Ze,u_temporal_offset:ot}))(te.skyboxMatrix,X.getCenter(H,!1),X.paint.get("sky-gradient-radius"),ae,le);H.prepareDrawProgram(ue,_e),_e.draw(ue,ce.TRIANGLES,ne,a.StencilMode.disabled,H.colorModeForRenderPass(),a.CullFaceMode.backCW,be,"skyboxGradient",X.skyboxGeometry.vertexBuffer,X.skyboxGeometry.indexBuffer,X.skyboxGeometry.segment)}(v,m,L,T,V)},debug:function(v,f,m){for(let b=0;b<m.length;b++)Lw(v,f,m[b])},custom:function(v,f,m,b){const x=v.context,T=m.implementation;if(!v.transform.projection.unsupportedLayers||!v.transform.projection.unsupportedLayers.includes("custom")||v.terrain&&(v.terrain.renderingToTexture||v.renderPass==="offscreen")&&m.isLayerDraped()){if(v.renderPass==="offscreen"){const P=T.prerender;if(P){if(v.setCustomLayerDefaults(),x.setColorMode(v.colorModeForRenderPass()),v.transform.projection.name==="globe"){const I=v.transform.pointMerc;P.call(T,x.gl,v.transform.customLayerMatrix(),v.transform.getProjection(),v.transform.globeToMercatorMatrix(),a.globeToMercatorTransition(v.transform.zoom),[I.x,I.y],v.transform.pixelsPerMeterRatio)}else P.call(T,x.gl,v.transform.customLayerMatrix());x.setDirty(),v.setBaseState()}}else if(v.renderPass==="translucent"){if(v.terrain&&v.terrain.renderingToTexture){const I=T.renderToTile;if(I){const L=b[0].canonical,V=new a.MercatorCoordinate(L.x+b[0].wrap*(1<<L.z),L.y,L.z);x.setDepthMode(a.DepthMode.disabled),x.setStencilMode(a.StencilMode.disabled),x.setColorMode(v.colorModeForRenderPass()),v.setCustomLayerDefaults(),I.call(T,x.gl,V),x.setDirty(),v.setBaseState()}return}v.setCustomLayerDefaults(),x.setColorMode(v.colorModeForRenderPass()),x.setStencilMode(a.StencilMode.disabled);const P=T.renderingMode==="3d"?new a.DepthMode(v.context.gl.LEQUAL,a.DepthMode.ReadWrite,v.depthRangeFor3D):v.depthModeForSublayer(0,a.DepthMode.ReadOnly);if(x.setDepthMode(P),v.transform.projection.name==="globe"){const I=v.transform.pointMerc;T.render(x.gl,v.transform.customLayerMatrix(),v.transform.getProjection(),v.transform.globeToMercatorMatrix(),a.globeToMercatorTransition(v.transform.zoom),[I.x,I.y],v.transform.pixelsPerMeterRatio)}else T.render(x.gl,v.transform.customLayerMatrix());x.setDirty(),v.setBaseState(),x.bindFramebuffer.set(null)}}else a.warnOnce("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")}};class gd{constructor(f,m,b=!1){this.context=new pe(f,b),this.transform=m,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=a.SourceCache.maxUnderzooming+a.SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new FE,this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={}}updateTerrain(f,m){const b=!!f&&!!f.terrain&&this.transform.projection.supportsTerrain;if(!(b||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new xw(this,f));const x=this._terrain;this.transform.elevation=b?x:null,x.update(f,this.transform,m)}_updateFog(f){const m=f.fog;if(!m||this.transform.projection.name==="globe"||m.getOpacity(this.transform.pitch)<1||m.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[b,x]=m.getFovAdjustedRange(this.transform._fov);if(b>x)return void(this.transform.fogCullDistSq=null);const T=b+.78*(x-b);this.transform.fogCullDistSq=T*T}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}resize(f,m){if(this.width=f*a.exported.devicePixelRatio,this.height=m*a.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const b of this.style.order)this.style._layers[b].resize()}setup(){const f=this.context,m=new a.StructArrayLayout2i4;m.emplaceBack(0,0),m.emplaceBack(a.EXTENT,0),m.emplaceBack(0,a.EXTENT),m.emplaceBack(a.EXTENT,a.EXTENT),this.tileExtentBuffer=f.createVertexBuffer(m,a.posAttributes.members),this.tileExtentSegments=a.SegmentVector.simpleSegment(0,0,4,2);const b=new a.StructArrayLayout2i4;b.emplaceBack(0,0),b.emplaceBack(a.EXTENT,0),b.emplaceBack(0,a.EXTENT),b.emplaceBack(a.EXTENT,a.EXTENT),this.debugBuffer=f.createVertexBuffer(b,a.posAttributes.members),this.debugSegments=a.SegmentVector.simpleSegment(0,0,4,5);const x=new a.StructArrayLayout2i4;x.emplaceBack(-1,-1),x.emplaceBack(1,-1),x.emplaceBack(-1,1),x.emplaceBack(1,1),this.viewportBuffer=f.createVertexBuffer(x,a.posAttributes.members),this.viewportSegments=a.SegmentVector.simpleSegment(0,0,4,2);const T=new a.StructArrayLayout4i8;T.emplaceBack(0,0,0,0),T.emplaceBack(a.EXTENT,0,a.EXTENT,0),T.emplaceBack(0,a.EXTENT,0,a.EXTENT),T.emplaceBack(a.EXTENT,a.EXTENT,a.EXTENT,a.EXTENT),this.mercatorBoundsBuffer=f.createVertexBuffer(T,a.boundsAttributes.members),this.mercatorBoundsSegments=a.SegmentVector.simpleSegment(0,0,4,2);const P=new a.StructArrayLayout3ui6;P.emplaceBack(0,1,2),P.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=f.createIndexBuffer(P);const I=new a.StructArrayLayout1ui2;for(const V of[0,1,3,2,0])I.emplaceBack(V);this.debugIndexBuffer=f.createIndexBuffer(I),this.emptyTexture=new a.Texture(f,new a.RGBAImage({width:1,height:1},Uint8Array.of(0,0,0,0)),f.gl.RGBA),this.identityMat=a.create();const L=this.context.gl;this.stencilClearMode=new a.StencilMode({func:L.ALWAYS,mask:0},0,255,L.ZERO,L.ZERO,L.ZERO),this.loadTimeStamps.push(a.window.performance.now()),this.atmosphereBuffer=new ZM(this.context)}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(f){return f._makeTileBoundsBuffers(this.context,this.transform.projection),f._tileBoundsBuffer?{tileBoundsBuffer:f._tileBoundsBuffer,tileBoundsIndexBuffer:f._tileBoundsIndexBuffer,tileBoundsSegments:f._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const f=this.context,m=f.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.useProgram("clippingMask").draw(f,m.TRIANGLES,a.DepthMode.disabled,this.stencilClearMode,a.ColorMode.disabled,a.CullFaceMode.disabled,gn(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(f,m,b){if(!m||this.currentStencilSource===m.id||!f.isTileClipped()||!b||b.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let I=!1;for(const L of b)if(this._tileClippingMaskIDs[L.key]===void 0){I=!0;break}if(!I)return}this.currentStencilSource=m.id;const x=this.context,T=x.gl;this.nextStencilID+b.length>256&&this.clearStencil(),x.setColorMode(a.ColorMode.disabled),x.setDepthMode(a.DepthMode.disabled);const P=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const I of b){const L=m.getTile(I),V=this._tileClippingMaskIDs[I.key]=this.nextStencilID++,{tileBoundsBuffer:H,tileBoundsIndexBuffer:X,tileBoundsSegments:ne}=this.getTileBoundsBuffers(L);P.draw(x,T.TRIANGLES,a.DepthMode.disabled,new a.StencilMode({func:T.ALWAYS,mask:0},V,255,T.KEEP,T.KEEP,T.REPLACE),a.ColorMode.disabled,a.CullFaceMode.disabled,gn(I.projMatrix),"$clipping",H,X,ne)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const f=this.nextStencilID++,m=this.context.gl;return new a.StencilMode({func:m.NOTEQUAL,mask:255},f,255,m.KEEP,m.KEEP,m.REPLACE)}stencilModeForClipping(f){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(f);const m=this.context.gl;return new a.StencilMode({func:m.EQUAL,mask:255},this._tileClippingMaskIDs[f.key],0,m.KEEP,m.KEEP,m.REPLACE)}stencilConfigForOverlap(f){const m=this.context.gl,b=f.sort((P,I)=>I.overscaledZ-P.overscaledZ),x=b[b.length-1].overscaledZ,T=b[0].overscaledZ-x+1;if(T>1){this.currentStencilSource=void 0,this.nextStencilID+T>256&&this.clearStencil();const P={};for(let I=0;I<T;I++)P[I+x]=new a.StencilMode({func:m.GEQUAL,mask:255},I+this.nextStencilID,255,m.KEEP,m.KEEP,m.REPLACE);return this.nextStencilID+=T,[P,b]}return[{[x]:a.StencilMode.disabled},b]}colorModeForRenderPass(){const f=this.context.gl;return this._showOverdrawInspector?new a.ColorMode([f.CONSTANT_COLOR,f.ONE],new a.Color(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?a.ColorMode.unblended:a.ColorMode.alphaBlended}depthModeForSublayer(f,m,b){if(!this.opaquePassEnabledForLayer())return a.DepthMode.disabled;const x=1-((1+this.currentLayer)*this.numSublayers+f)*this.depthEpsilon;return new a.DepthMode(b||this.context.gl.LEQUAL,m,[x,x])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(f,m){this.style=f,this.options=m,this.imageManager=f.imageManager,this.glyphManager=f.glyphManager,this.symbolFadeChange=f.placement.symbolFadeChange(a.exported.now()),this.imageManager.beginFrame();const b=this.style.order,x=this.style._sourceCaches;for(const V in x){const H=x[V];H.used&&H.prepare(this.context)}const T={},P={},I={};for(const V in x){const H=x[V];T[V]=H.getVisibleCoordinates(),P[V]=T[V].slice().reverse(),I[V]=H.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let V=0;V<b.length;V++)if(this.style._layers[b[V]].is3D()){this.opaquePassCutoff=V;break}if(this.terrain&&(this.terrain.updateTileBinding(I),this.opaquePassCutoff=0),this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new a.GlobeSharedBuffers(this.context)),!a.isMapAuthenticated(this.context.gl))return;this.renderPass="offscreen";for(const V of b){const H=this.style._layers[V],X=f._getLayerSourceCache(H);if(!H.hasOffscreenPass()||H.isHidden(this.transform.zoom))continue;const ne=X?P[X.id]:void 0;(H.type==="custom"||H.isSky()||ne&&ne.length)&&this.renderLayer(this,X,H,ne)}this.depthRangeFor3D=[0,1-(f.order.length+2)*this.numSublayers*this.depthEpsilon];const L=this.terrain;if(L&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&L.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]),this.context.clear({color:m.showOverdrawInspector?a.Color.black:a.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=m.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=b.length-1;this.currentLayer>=0;this.currentLayer--){const V=this.style._layers[b[this.currentLayer]],H=f._getLayerSourceCache(V);if(V.isSky())continue;const X=H?P[H.id]:void 0;this._renderTileClippingMasks(V,H,X),this.renderLayer(this,H,V,X)}if(this.style.fog&&this.transform.projection.supportsFog&&function(V,H){const X=V.context,ne=X.gl,ae=V.transform,le=new a.DepthMode(ne.LEQUAL,a.DepthMode.ReadOnly,[0,1]),ue=V.useProgram("globeAtmosphere",null,ae.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"]),ce=a.globeToMercatorTransition(ae.zoom),te=H.properties.get("color").toArray01(),_e=H.properties.get("high-color").toArray01(),ve=H.properties.get("space-color").toArray01PremultipliedAlpha(),be=a.identity$1([]);a.rotateY$1(be,be,-a.degToRad(ae._center.lng)),a.rotateX$1(be,be,a.degToRad(ae._center.lat)),a.rotateZ$1(be,be,ae.angle),a.rotateX$1(be,be,-ae._pitch);const $e=a.fromQuat(new Float32Array(16),be),Ae=a.mapValue(H.properties.get("star-intensity"),0,1,0,.25),Be=5e-4,Ze=a.mapValue(H.properties.get("horizon-blend"),0,1,Be,.25),ot=a.globeUseCustomAntiAliasing(V,X,ae)&&Ze===Be?ae.worldSize/(2*Math.PI*1.025)-1:ae.globeRadius,ut=V.frameCounter/1e3%1,zt=a.length(ae.globeCenterInViewSpace),rt=Math.sqrt(Math.pow(zt,2)-Math.pow(ot,2)),Ot=Math.acos(rt/zt),vt=((st,Ke,dt,Pt,Lt,cr,Vr,ir,rr,hr,Zr,_r,On,kn)=>({u_frustum_tl:st,u_frustum_tr:Ke,u_frustum_br:dt,u_frustum_bl:Pt,u_horizon:Lt,u_transition:cr,u_fadeout_range:Vr,u_color:ir,u_high_color:rr,u_space_color:hr,u_star_intensity:Zr,u_star_size:5*a.exported.devicePixelRatio,u_star_density:0,u_temporal_offset:_r,u_horizon_angle:On,u_rotation_matrix:kn}))(ae.frustumCorners.TL,ae.frustumCorners.TR,ae.frustumCorners.BR,ae.frustumCorners.BL,ae.frustumCorners.horizon,ce,Ze,te,_e,ve,Ae,ut,Ot,$e);V.prepareDrawProgram(X,ue);const Mt=V.atmosphereBuffer;Mt&&ue.draw(X,ne.TRIANGLES,le,a.StencilMode.disabled,a.ColorMode.alphaBlended,a.CullFaceMode.backCW,vt,"skybox",Mt.vertexBuffer,Mt.indexBuffer,Mt.segments)}(this,this.style.fog),this.renderPass="sky",(a.globeToMercatorTransition(this.transform.zoom)>0||this.transform.projection.name!=="globe")&&this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<b.length;this.currentLayer++){const V=this.style._layers[b[this.currentLayer]],H=f._getLayerSourceCache(V);V.isSky()&&this.renderLayer(this,H,V,H?P[H.id]:void 0)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<b.length;){const V=this.style._layers[b[this.currentLayer]],H=f._getLayerSourceCache(V);if(V.isSky()){++this.currentLayer;continue}if(this.terrain&&this.style.isLayerDraped(V)){if(V.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer);continue}const X=H?(V.type==="symbol"?I:P)[H.id]:void 0;this._renderTileClippingMasks(V,H,H?T[H.id]:void 0),this.renderLayer(this,H,V,X),++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let V=null;a.values(this.style._layers).forEach(H=>{const X=f._getLayerSourceCache(H);X&&!H.isHidden(this.transform.zoom)&&(!V||V.getSource().maxzoom<X.getSource().maxzoom)&&(V=X)}),V&&this.options.showTileBoundaries&&Nw.debug(this,V,V.getVisibleCoordinates())}this.options.showPadding&&function(V){const H=V.transform.padding;Bl(V,V.transform.height-(H.top||0),3,$w),Bl(V,H.bottom||0,3,Dw),yf(V,H.left||0,3,oT),yf(V,V.transform.width-(H.right||0),3,aT);const X=V.transform.centerPoint;(function(ne,ae,le,ue){md(ne,ae-1,le-10,2,20,ue),md(ne,ae-10,le-1,20,2,ue)})(V,X.x,V.transform.height-X.y,sT)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(a.window.performance.now()),this.saveCanvasCopy())}renderLayer(f,m,b,x){b.isHidden(this.transform.zoom)||(b.type==="background"||b.type==="sky"||b.type==="custom"||x&&x.length)&&(this.id=b.id,this.gpuTimingStart(b),(!f.transform.projection.unsupportedLayers||!f.transform.projection.unsupportedLayers.includes(b.type)||f.terrain&&b.type==="custom")&&Nw[b.type](f,m,b,x,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(f){if(!this.options.gpuTiming)return;const m=this.context.extTimerQuery;let b=this.gpuTimers[f.id];b||(b=this.gpuTimers[f.id]={calls:0,cpuTime:0,query:m.createQueryEXT()}),b.calls++,m.beginQueryEXT(m.TIME_ELAPSED_EXT,b.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const f=this.context.extTimerQuery,m=f.createQueryEXT();this.deferredRenderGpuTimeQueries.push(m),f.beginQueryEXT(f.TIME_ELAPSED_EXT,m)}}gpuTimingDeferredRenderEnd(){if(!this.options.gpuTimingDeferredRender)return;const f=this.context.extTimerQuery;f.endQueryEXT(f.TIME_ELAPSED_EXT)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const f=this.context.extTimerQuery;f.endQueryEXT(f.TIME_ELAPSED_EXT)}collectGpuTimers(){const f=this.gpuTimers;return this.gpuTimers={},f}collectDeferredRenderGpuQueries(){const f=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],f}queryGpuTimers(f){const m={};for(const b in f){const x=f[b],T=this.context.extTimerQuery,P=T.getQueryObjectEXT(x.query,T.QUERY_RESULT_EXT)/1e6;T.deleteQueryEXT(x.query),m[b]=P}return m}queryGpuTimeDeferredRender(f){if(!this.options.gpuTimingDeferredRender)return 0;const m=this.context.extTimerQuery;let b=0;for(const x of f)b+=m.getQueryObjectEXT(x,m.QUERY_RESULT_EXT)/1e6,m.deleteQueryEXT(x);return b}translatePosMatrix(f,m,b,x,T){if(!b[0]&&!b[1])return f;const P=T?x==="map"?this.transform.angle:0:x==="viewport"?-this.transform.angle:0;if(P){const V=Math.sin(P),H=Math.cos(P);b=[b[0]*H-b[1]*V,b[0]*V+b[1]*H]}const I=[T?b[0]:Oe(m,b[0],this.transform.zoom),T?b[1]:Oe(m,b[1],this.transform.zoom),0],L=new Float32Array(16);return a.translate(L,f,I),L}saveTileTexture(f){const m=this._tileTextures[f.size[0]];m?m.push(f):this._tileTextures[f.size[0]]=[f]}getTileTexture(f){const m=this._tileTextures[f];return m&&m.length>0?m.pop():null}isPatternMissing(f){return f===null||f!==void 0&&!this.imageManager.getPattern(f.toString())}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture}currentGlobalDefines(){const f=this.terrain&&this.terrain.renderingToTexture,m=this.terrain&&this.terrain.exaggeration()===0,b=this.style&&this.style.fog,x=[];return this.terrainRenderModeElevated()&&x.push("TERRAIN"),this.transform.projection.name==="globe"&&x.push("GLOBE"),m&&x.push("ZERO_EXAGGERATION"),b&&!f&&b.getOpacity(this.transform.pitch)!==0&&x.push("FOG"),f&&x.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&x.push("OVERDRAW_INSPECTOR"),x}useProgram(f,m,b){this.cache=this.cache||{};const x=b||[],T=this.currentGlobalDefines().concat(x),P=Cw.cacheKey(yw[f],f,T,m);return this.cache[P]||(this.cache[P]=new Cw(this.context,f,yw[f],m,KM[f],T)),this.cache[P]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const f=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(f.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=a.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new a.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this.atmosphereBuffer&&this.atmosphereBuffer.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}prepareDrawProgram(f,m,b){if(this.terrain&&this.terrain.renderingToTexture)return;const x=this.style.fog;if(x){const T=x.getOpacity(this.transform.pitch),P=((I,L,V,H,X,ne,ae,le,ue,ce,te)=>{const _e=I.transform,ve=L.properties.get("color").toArray01();ve[3]=H;const be=I.frameCounter/1e3%1;return{u_fog_matrix:V?_e.calculateFogTileMatrix(V):I.identityMat,u_fog_range:L.getFovAdjustedRange(_e._fov),u_fog_color:ve,u_fog_horizon_blend:L.properties.get("horizon-blend"),u_fog_temporal_offset:be,u_frustum_tl:X,u_frustum_tr:ne,u_frustum_br:ae,u_frustum_bl:le,u_globe_pos:ue,u_globe_radius:ce,u_viewport:te,u_globe_transition:a.globeToMercatorTransition(_e.zoom),u_is_globe:+(_e.projection.name==="globe")}})(this,x,b,T,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*a.exported.devicePixelRatio,this.transform.height*a.exported.devicePixelRatio]);m.setFogUniformValues(f,P)}}setTileLoadedFlag(f){this.tileLoaded=f}saveCanvasCopy(){const f=this.canvasCopy();f&&(this.frameCopies.push(f),this.tileLoaded=!1)}canvasCopy(){const f=this.context.gl,m=f.createTexture();return f.bindTexture(f.TEXTURE_2D,m),f.copyTexImage2D(f.TEXTURE_2D,0,f.RGBA,0,0,f.drawingBufferWidth,f.drawingBufferHeight,0),m}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const f=this.style&&this.style.fog;return!!f&&f.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const f=this._backgroundTiles,m=this._backgroundTiles={},b=this.transform.coveringTiles({tileSize:512});for(const x of b)m[x.key]=f[x.key]||new a.Tile(x,512,this.transform.tileZoom,this);return m}clearBackgroundTiles(){this._backgroundTiles={}}}class Bw{constructor(f=0,m=0,b=0,x=0){if(isNaN(f)||f<0||isNaN(m)||m<0||isNaN(b)||b<0||isNaN(x)||x<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=f,this.bottom=m,this.left=b,this.right=x}interpolate(f,m,b){return m.top!=null&&f.top!=null&&(this.top=a.number(f.top,m.top,b)),m.bottom!=null&&f.bottom!=null&&(this.bottom=a.number(f.bottom,m.bottom,b)),m.left!=null&&f.left!=null&&(this.left=a.number(f.left,m.left,b)),m.right!=null&&f.right!=null&&(this.right=a.number(f.right,m.right,b)),this}getCenter(f,m){const b=a.clamp((this.left+f-this.right)/2,0,f),x=a.clamp((this.top+m-this.bottom)/2,0,m);return new a.pointGeometry(b,x)}equals(f){return this.top===f.top&&this.bottom===f.bottom&&this.left===f.left&&this.right===f.right}clone(){return new Bw(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function lT(v,f){const m=a.getColumn(v,3);a.fromQuat(v,f),a.setColumn(v,3,m)}function lg(v,f){const m=a.identity$1([]);return a.rotateZ$1(m,m,-f),a.rotateX$1(m,m,-v),m}function uT(v,f){const m=[v[0],v[1],0],b=[f[0],f[1],0];if(a.length(m)>=1e-15){const P=a.normalize([],m);a.scale$2(b,P,a.dot(b,P)),f[0]=b[0],f[1]=b[1]}const x=a.cross([],f,v);if(a.len(x)<1e-15)return null;const T=Math.atan2(-x[1],x[0]);return lg(Math.atan2(Math.sqrt(v[0]*v[0]+v[1]*v[1]),-v[2]),T)}class ug{constructor(f,m){this.position=f,this.orientation=m}get position(){return this._position}set position(f){if(f){const m=f instanceof a.MercatorCoordinate?f:new a.MercatorCoordinate(f[0],f[1],f[2]);this._renderWorldCopies&&(m.x=a.wrap(m.x,0,1)),this._position=m}else this._position=null}lookAtPoint(f,m){if(this.orientation=null,!this.position)return;const b=this.position,x=this._elevation?this._elevation.getAtPointOrZero(a.MercatorCoordinate.fromLngLat(f)):0,T=a.MercatorCoordinate.fromLngLat(f,x),P=[T.x-b.x,T.y-b.y,T.z-b.z];m||(m=[0,0,1]),m[2]=Math.abs(m[2]),this.orientation=uT(P,m)}setPitchBearing(f,m){this.orientation=lg(a.degToRad(f),a.degToRad(-m))}}class bf{constructor(f,m){this._transform=a.identity([]),this.orientation=m,this.position=f}get mercatorPosition(){const f=this.position;return new a.MercatorCoordinate(f[0],f[1],f[2])}get position(){const f=a.getColumn(this._transform,3);return[f[0],f[1],f[2]]}set position(f){var m;f&&a.setColumn(this._transform,3,[(m=f)[0],m[1],m[2],1])}get orientation(){return this._orientation}set orientation(f){this._orientation=f||a.identity$1([]),f&&lT(this._transform,this._orientation)}getPitchBearing(){const f=this.forward(),m=this.right();return{bearing:Math.atan2(-m[1],m[0]),pitch:Math.atan2(Math.sqrt(f[0]*f[0]+f[1]*f[1]),-f[2])}}setPitchBearing(f,m){this._orientation=lg(f,m),lT(this._transform,this._orientation)}forward(){const f=a.getColumn(this._transform,2);return[-f[0],-f[1],-f[2]]}up(){const f=a.getColumn(this._transform,1);return[-f[0],-f[1],-f[2]]}right(){const f=a.getColumn(this._transform,0);return[f[0],f[1],f[2]]}getCameraToWorld(f,m){const b=new Float64Array(16);return a.invert(b,this.getWorldToCamera(f,m)),b}getWorldToCameraPosition(f,m,b){const x=this.position;a.scale$2(x,x,-f);const T=new Float64Array(16);return a.fromScaling(T,[b,b,b]),a.translate(T,T,x),T[10]*=m,T}getWorldToCamera(f,m){const b=new Float64Array(16),x=new Float64Array(4),T=this.position;return a.conjugate(x,this._orientation),a.scale$2(T,T,-f),a.fromQuat(b,x),a.translate(b,b,T),b[1]*=-1,b[5]*=-1,b[9]*=-1,b[13]*=-1,b[8]*=m,b[9]*=m,b[10]*=m,b[11]*=m,b}getCameraToClipPerspective(f,m,b,x){const T=new Float64Array(16);return a.perspective(T,f,m,b,x),T}getDistanceToElevation(f,m=!1){const b=f===0?0:a.mercatorZfromAltitude(f,m?a.latFromMercatorY(this.position[1]):this.position[1]),x=this.forward();return(b-this.position[2])/x[2]}clone(){return new bf([...this.position],[...this.orientation])}}function wf(v,f){const m=Nu(v.projection,v.zoom,v.width,v.height),b=function(T,P,I,L,V){const H=new a.LngLat(I.lng-180*Bu,I.lat),X=new a.LngLat(I.lng+180*Bu,I.lat),ne=T.project(H.lng,H.lat),ae=T.project(X.lng,X.lat),le=-Math.atan2(ae.y-ne.y,ae.x-ne.x),ue=a.MercatorCoordinate.fromLngLat(I);ue.y=a.clamp(ue.y,-.999975,.999975);const ce=ue.toLngLat(),te=T.project(ce.lng,ce.lat),_e=a.MercatorCoordinate.fromLngLat(ce);_e.x+=Bu;const ve=_e.toLngLat(),be=T.project(ve.lng,ve.lat),$e=vd(be.x-te.x,be.y-te.y,le),Ae=a.MercatorCoordinate.fromLngLat(ce);Ae.y+=Bu;const Be=Ae.toLngLat(),Ze=T.project(Be.lng,Be.lat),ot=vd(Ze.x-te.x,Ze.y-te.y,le),ut=Math.abs($e.x)/Math.abs(ot.y),zt=a.identity([]);a.rotateZ(zt,zt,-le*(1-(V?0:L)));const rt=a.identity([]);return a.scale(rt,rt,[1,1-(1-ut)*L,1]),rt[4]=-ot.x/ot.y*L,a.rotateZ(rt,rt,le),a.multiply(rt,zt,rt),rt}(v.projection,0,v.center,m,f),x=cg(v);return a.scale(b,b,[x,x,1]),b}function cg(v){const f=v.projection,m=Nu(v.projection,v.zoom,v.width,v.height),b=yd(f,v.center),x=yd(f,a.LngLat.convert(f.center));return Math.pow(2,b*m+(1-m)*x)}function Nu(v,f,m,b,x=1/0){const T=v.range;if(!T)return 0;const P=Math.min(x,Math.max(m,b)),I=Math.log(P/1024)/Math.LN2;return a.smoothstep(T[0]+I,T[1]+I,f)}const Bu=1/4e4;function yd(v,f){const m=a.clamp(f.lat,-a.MAX_MERCATOR_LATITUDE,a.MAX_MERCATOR_LATITUDE),b=new a.LngLat(f.lng-180*Bu,m),x=new a.LngLat(f.lng+180*Bu,m),T=v.project(b.lng,m),P=v.project(x.lng,m),I=a.MercatorCoordinate.fromLngLat(b),L=a.MercatorCoordinate.fromLngLat(x),V=P.x-T.x,H=P.y-T.y,X=L.x-I.x,ne=L.y-I.y,ae=Math.sqrt((X*X+ne*ne)/(V*V+H*H));return Math.log(ae)/Math.LN2}function vd(v,f,m){const b=Math.cos(m),x=Math.sin(m);return{x:v*b-f*x,y:v*x+f*b}}class tr{constructor(f,m,b,x,T,P,I){this.tileSize=512,this._renderWorldCopies=T===void 0||T,this._minZoom=f||0,this._maxZoom=m||22,this._minPitch=b??0,this._maxPitch=x??60,this.setProjection(P),this.setMaxBounds(I),this.width=0,this.height=0,this._center=new a.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new Bw,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._distanceTileDataCache={},this._camera=new bf,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._horizonShift=.1}clone(){const f=new tr(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return f._elevation=this._elevation,f._centerAltitude=this._centerAltitude,f._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,f.tileSize=this.tileSize,f.mercatorFromTransition=this.mercatorFromTransition,f.width=this.width,f.height=this.height,f.cameraElevationReference=this.cameraElevationReference,f._center=this._center,f._setZoom(this.zoom),f._seaLevelZoom=this._seaLevelZoom,f.angle=this.angle,f._fov=this._fov,f._pitch=this._pitch,f._nearZ=this._nearZ,f._farZ=this._farZ,f._averageElevation=this._averageElevation,f._unmodified=this._unmodified,f._edgeInsets=this._edgeInsets.clone(),f._camera=this._camera.clone(),f._calcMatrices(),f.freezeTileCoverage=this.freezeTileCoverage,f.frustumCorners=this.frustumCorners,f}get elevation(){return this._elevation}set elevation(f){this._elevation!==f&&(this._elevation=f,this._updateCameraOnTerrain(),this._calcMatrices())}updateElevation(f,m=!1){const b=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||b)&&this._updateCameraOnTerrain(),(f||b)&&this._constrainCamera(m),this._calcMatrices()}getProjection(){return a.pick(this.projection,["name","center","parallels"])}setProjection(f){this.projectionOptions=f||{name:"mercator"};const m=this.projection?this.getProjection():void 0;this.projection=a.getProjection(this.projectionOptions);const b=!h(m,this.getProjection());return b&&this._calcMatrices(),this.mercatorFromTransition=!1,b}setMercatorFromTransition(){const f=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=a.getProjection({name:"mercator"});const m=f!==this.projection.name;return m&&this._calcMatrices(),m}get minZoom(){return this._minZoom}set minZoom(f){this._minZoom!==f&&(this._minZoom=f,this.zoom=Math.max(this.zoom,f))}get maxZoom(){return this._maxZoom}set maxZoom(f){this._maxZoom!==f&&(this._maxZoom=f,this.zoom=Math.min(this.zoom,f))}get minPitch(){return this._minPitch}set minPitch(f){this._minPitch!==f&&(this._minPitch=f,this.pitch=Math.max(this.pitch,f))}get maxPitch(){return this._maxPitch}set maxPitch(f){this._maxPitch!==f&&(this._maxPitch=f,this.pitch=Math.min(this.pitch,f))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(f){f===void 0?f=!0:f===null&&(f=!1),this._renderWorldCopies=f}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const f=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(f))}get cameraWorldSize(){const f=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(f))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return a.mercatorZfromAltitude(this.center.lat,this.cameraWorldSizeForFog)}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new a.pointGeometry(this.width,this.height)}get bearing(){return a.wrap(this.rotation,-180,180)}set bearing(f){this.rotation=f}get rotation(){return-this.angle/Math.PI*180}set rotation(f){const m=-f*Math.PI/180;var b;this.angle!==m&&(this._unmodified=!1,this.angle=m,this._calcMatrices(),this.rotationMatrix=(b=new a.ARRAY_TYPE(4),a.ARRAY_TYPE!=Float32Array&&(b[1]=0,b[2]=0),b[0]=1,b[3]=1,b),function(x,T,P){var I=T[0],L=T[1],V=T[2],H=T[3],X=Math.sin(P),ne=Math.cos(P);x[0]=I*ne+V*X,x[1]=L*ne+H*X,x[2]=I*-X+V*ne,x[3]=L*-X+H*ne}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(f){const m=a.clamp(f,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==m&&(this._unmodified=!1,this._pitch=m,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}get fovX(){return this._fov}get fovY(){const f=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/f)}set fov(f){f=Math.max(.01,Math.min(60,f)),this._fov!==f&&(this._unmodified=!1,this._fov=a.degToRad(f),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(f){this._averageElevation=f,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(f){const m=Math.min(Math.max(f,this.minZoom),this.maxZoom);this._zoom!==m&&(this._unmodified=!1,this._setZoom(m),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(f){this._zoom=f,this.scale=this.zoomScale(f),this.tileZoom=Math.floor(f),this.zoomFraction=f-this.tileZoom}_updateCameraOnTerrain(){if(!this._elevation||!this._elevation.isDataAvailableAtPoint(this.locationCoordinate(this.center)))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const f=this._elevation;this._centerAltitude=f.getAtPointOrZero(this.locationCoordinate(this.center)),this._centerAltitudeValidForExaggeration=f.exaggeration(),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){this._centerAltitudeValidForExaggeration!==void 0&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const f=this._elevation,m=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],b=this.horizonLineFromTop();let x=0,T=0;for(let P=0;P<m.length;P++){const I=new a.pointGeometry(m[P][0]*this.width,b+m[P][1]*(this.height-b)),L=f.pointCoordinate(I);if(!L)continue;const V=1/Math.hypot(L[0]-this._camera.position[0],L[1]-this._camera.position[1]);x+=L[3]*V,T+=V}return T===0?NaN:x/T}get center(){return this._center}set center(f){f.lat===this._center.lat&&f.lng===this._center.lng||(this._unmodified=!1,this._center=f,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const f=this._seaLevelZoom,m=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),b=this.pixelsPerMeter/this.worldSize*m,x=this._mercatorZfromZoom(f),T=this._mercatorZfromZoom(this._maxZoom),P=Math.max(x-b,T);this._setZoom(this._zoomFromMercatorZ(P))}get padding(){return this._edgeInsets.toJSON()}set padding(f){this._edgeInsets.equals(f)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,f,1),this._calcMatrices())}computeZoomRelativeTo(f){const m=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,f.toAltitude()));let b;b=f.z<this._camera.position[2]?[m.x,m.y,m.z]:[f.x,f.y,f.z];const x=a.length(a.sub([],this._camera.position,b));return a.clamp(this._zoomFromMercatorZ(x),this._minZoom,this._maxZoom)}setFreeCameraOptions(f){if(!this.height||!f.position&&!f.orientation)return;this._updateCameraState();let m=!1;if(f.orientation&&!a.exactEquals(f.orientation,this._camera.orientation)&&(m=this._setCameraOrientation(f.orientation)),f.position){const b=[f.position.x,f.position.y,f.position.z];a.exactEquals$1(b,this._camera.position)||(this._setCameraPosition(b),m=!0)}m&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const f=this._camera.position,m=new ug;return m.position=new a.MercatorCoordinate(f[0],f[1],f[2]),m.orientation=this._camera.orientation,m._elevation=this.elevation,m._renderWorldCopies=this.renderWorldCopies,m}_setCameraOrientation(f){if(!a.length$1(f))return!1;a.normalize$1(f,f);const m=a.transformQuat([],[0,0,-1],f),b=a.transformQuat([],[0,-1,0],f);if(b[2]<0)return!1;const x=uT(m,b);return!!x&&(this._camera.orientation=x,!0)}_setCameraPosition(f){const m=this.zoomScale(this.minZoom)*this.tileSize,b=this.zoomScale(this.maxZoom)*this.tileSize,x=this.cameraToCenterDistance;f[2]=a.clamp(f[2],x/b,x/m),this._camera.position=f}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(f){return this._edgeInsets.equals(f)}interpolatePadding(f,m,b){this._unmodified=!1,this._edgeInsets.interpolate(f,m,b),this._constrain(),this._calcMatrices()}coveringZoomLevel(f){const m=(f.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/f.tileSize));return Math.max(0,m)}getVisibleUnwrappedCoordinates(f){const m=[new a.UnwrappedTileID(0,f)];if(this.renderWorldCopies){const b=this.pointCoordinate(new a.pointGeometry(0,0)),x=this.pointCoordinate(new a.pointGeometry(this.width,0)),T=this.pointCoordinate(new a.pointGeometry(this.width,this.height)),P=this.pointCoordinate(new a.pointGeometry(0,this.height)),I=Math.floor(Math.min(b.x,x.x,T.x,P.x)),L=Math.floor(Math.max(b.x,x.x,T.x,P.x)),V=1;for(let H=I-V;H<=L+V;H++)H!==0&&m.push(new a.UnwrappedTileID(H,f))}return m}coveringTiles(f){let m=this.coveringZoomLevel(f);const b=m,x=this.elevation&&!f.isTerrainDEM,T=this.projection.name==="mercator";if(f.minzoom!==void 0&&m<f.minzoom)return[];f.maxzoom!==void 0&&m>f.maxzoom&&(m=f.maxzoom);const P=this.locationCoordinate(this.center),I=this.center.lat,L=1<<m,V=[L*P.x,L*P.y,0],H=this.projection.name==="globe",X=!H,ne=a.Frustum.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,m,X),ae=H?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),le=L*a.mercatorZfromAltitude(1,this.center.lat),ue=this._camera.position[2]/a.mercatorZfromAltitude(1,this.center.lat),ce=[L*ae.x,L*ae.y,ue*(X?1:le)],te=this.cameraToCenterDistance/f.tileSize*(f.roundZoom?1:.502),_e=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace?m:0,ve=f.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,be=f.isTerrainDEM?-ve:this._elevation?this._elevation.getMinElevationBelowMSL():0,$e=this.projection.isReprojectedInTileSpace?cg(this):1,Ae=st=>{const dt=new a.MercatorCoordinate(st.x+25e-6,st.y,st.z),Pt=new a.MercatorCoordinate(st.x,st.y+25e-6,st.z),Lt=st.toLngLat(),cr=dt.toLngLat(),Vr=Pt.toLngLat(),ir=this.locationCoordinate(Lt),rr=this.locationCoordinate(cr),hr=this.locationCoordinate(Vr),Zr=Math.hypot(rr.x-ir.x,rr.y-ir.y),_r=Math.hypot(hr.x-ir.x,hr.y-ir.y);return Math.sqrt(Zr*_r)*$e/25e-6},Be=st=>{const Ke=ve,dt=be;return{aabb:a.tileAABB(this,L,0,0,0,st,dt,Ke,this.projection),zoom:0,x:0,y:0,minZ:dt,maxZ:Ke,wrap:st,fullyVisible:!1}},Ze=[];let ot=[];const ut=m,zt=f.reparseOverscaled?b:m,rt=st=>st*st,Ot=rt((ue-this._centerAltitude)*le),vt=st=>{if(!this._elevation||!st.tileID||!T)return;const Ke=this._elevation.getMinMaxForTile(st.tileID),dt=st.aabb;Ke?(dt.min[2]=Ke.min,dt.max[2]=Ke.max,dt.center[2]=(dt.min[2]+dt.max[2])/2):(st.shouldSplit=Mt(st),st.shouldSplit||(dt.min[2]=dt.max[2]=dt.center[2]=this._centerAltitude))},Mt=st=>{if(st.zoom<_e)return!0;if(st.zoom===ut)return!1;if(st.shouldSplit!=null)return st.shouldSplit;const Ke=st.aabb.distanceX(ce),dt=st.aabb.distanceY(ce);let Pt=Ot,Lt=1;if(H){Pt=rt(st.aabb.distanceZ(ce));const ir=Math.pow(2,st.zoom),rr=a.latFromMercatorY((st.y+1)/ir),hr=a.latFromMercatorY(st.y/ir),Zr=Math.min(Math.max(I,rr),hr),_r=a.circumferenceAtLatitude(Zr)/a.circumferenceAtLatitude(I);if(Lt=Zr===I?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,_r/this._mercatorScaleRatio),this.zoom<=a.GLOBE_ZOOM_THRESHOLD_MIN&&st.zoom===ut-1&&_r>=.9)return!0}else if(x&&(Pt=rt(st.aabb.distanceZ(ce)*le)),this.projection.isReprojectedInTileSpace&&b<=5){const ir=Math.pow(2,st.zoom),rr=Ae(new a.MercatorCoordinate((st.x+.5)/ir,(st.y+.5)/ir));Lt=rr>.85?1:rr}const cr=Ke*Ke+dt*dt+Pt,Vr=rt((1<<ut-st.zoom)*te*Lt*((ir,rr)=>{if(rr*rt(.707)<ir)return 1;const hr=Math.sqrt(rr/ir);return hr/(1.4144271570014144+(Math.pow(1.1,hr-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(Pt,Ot),cr));return cr<Vr};if(this.renderWorldCopies)for(let st=1;st<=3;st++)Ze.push(Be(-st)),Ze.push(Be(st));for(Ze.push(Be(0));Ze.length>0;){const st=Ze.pop(),Ke=st.x,dt=st.y;let Pt=st.fullyVisible;if(!Pt){const Lt=st.aabb.intersects(ne);if(Lt===0)continue;Pt=Lt===2}if(st.zoom!==ut&&Mt(st))for(let Lt=0;Lt<4;Lt++){const cr=(Ke<<1)+Lt%2,Vr=(dt<<1)+(Lt>>1),ir={aabb:T?st.aabb.quadrant(Lt):a.tileAABB(this,L,st.zoom+1,cr,Vr,st.wrap,st.minZ,st.maxZ,this.projection),zoom:st.zoom+1,x:cr,y:Vr,wrap:st.wrap,fullyVisible:Pt,tileID:void 0,shouldSplit:void 0,minZ:st.minZ,maxZ:st.maxZ};x&&!H&&(ir.tileID=new a.OverscaledTileID(st.zoom+1===ut?zt:st.zoom+1,st.wrap,st.zoom+1,cr,Vr),vt(ir)),Ze.push(ir)}else{const Lt=st.zoom===ut?zt:st.zoom;if(f.minzoom&&f.minzoom>Lt)continue;const cr=V[0]-(.5+Ke+(st.wrap<<st.zoom))*(1<<m-st.zoom),Vr=V[1]-.5-dt,ir=st.tileID?st.tileID:new a.OverscaledTileID(Lt,st.wrap,st.zoom,Ke,dt);ot.push({tileID:ir,distanceSq:cr*cr+Vr*Vr})}}if(this.fogCullDistSq){const st=this.fogCullDistSq,Ke=this.horizonLineFromTop();ot=ot.filter(dt=>{const Pt=[0,0,0,1],Lt=[a.EXTENT,a.EXTENT,0,1],cr=this.calculateFogTileMatrix(dt.tileID.toUnwrapped());a.transformMat4$1(Pt,Pt,cr),a.transformMat4$1(Lt,Lt,cr);const Vr=a.getAABBPointSquareDist(Pt,Lt);if(Vr===0)return!0;let ir=!1;const rr=this._elevation;if(rr&&Vr>st&&Ke!==0){const hr=this.calculateProjMatrix(dt.tileID.toUnwrapped());let Zr;f.isTerrainDEM||(Zr=rr.getMinMaxForTile(dt.tileID)),Zr||(Zr={min:be,max:ve});const _r=a.furthestTileCorner(this.rotation),On=[_r[0]*a.EXTENT,_r[1]*a.EXTENT,Zr.max];a.transformMat4(On,On,hr),ir=(1-On[1])*this.height*.5<Ke}return Vr<st||ir})}return ot.sort((st,Ke)=>st.distanceSq-Ke.distanceSq).map(st=>st.tileID)}resize(f,m){this.width=f,this.height=m,this.pixelsToGLUnits=[2/f,-2/m],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(f){return Math.pow(2,f)}scaleZoom(f){return Math.log(f)/Math.LN2}project(f){const m=a.clamp(f.lat,-a.MAX_MERCATOR_LATITUDE,a.MAX_MERCATOR_LATITUDE),b=this.projection.project(f.lng,m);return new a.pointGeometry(b.x*this.worldSize,b.y*this.worldSize)}unproject(f){return this.projection.unproject(f.x/this.worldSize,f.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/a.mercatorZfromAltitude(1,this.center.lat)/this.worldSize}setLocationAtPoint(f,m){let b,x;const T=this.centerPoint;if(this.projection.name==="globe"){const I=this.worldSize;b=(m.x-T.x)/I,x=(m.y-T.y)/I}else{const I=this.pointCoordinate(m),L=this.pointCoordinate(T);b=I.x-L.x,x=I.y-L.y}const P=this.locationCoordinate(f);this.setLocation(new a.MercatorCoordinate(P.x-b,P.y-x))}setLocation(f){this.center=this.coordinateLocation(f),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(f){return this.projection.locationPoint(this,f)}locationPoint3D(f){return this.projection.locationPoint(this,f,!0)}pointLocation(f){return this.coordinateLocation(this.pointCoordinate(f))}pointLocation3D(f){return this.coordinateLocation(this.pointCoordinate3D(f))}locationCoordinate(f,m){const b=m?a.mercatorZfromAltitude(m,f.lat):void 0,x=this.projection.project(f.lng,f.lat);return new a.MercatorCoordinate(x.x,x.y,b)}coordinateLocation(f){return this.projection.unproject(f.x,f.y)}pointRayIntersection(f,m){const b=m??this._centerAltitude,x=[f.x,f.y,0,1],T=[f.x,f.y,1,1];a.transformMat4$1(x,x,this.pixelMatrixInverse),a.transformMat4$1(T,T,this.pixelMatrixInverse);const P=T[3];a.scale$1(x,x,1/x[3]),a.scale$1(T,T,1/P);const I=x[2],L=T[2];return{p0:x,p1:T,t:I===L?0:(b-I)/(L-I)}}screenPointToMercatorRay(f){const m=[f.x,f.y,0,1],b=[f.x,f.y,1,1];return a.transformMat4$1(m,m,this.pixelMatrixInverse),a.transformMat4$1(b,b,this.pixelMatrixInverse),a.scale$1(m,m,1/m[3]),a.scale$1(b,b,1/b[3]),m[2]=a.mercatorZfromAltitude(m[2],this._center.lat)*this.worldSize,b[2]=a.mercatorZfromAltitude(b[2],this._center.lat)*this.worldSize,a.scale$1(m,m,1/this.worldSize),a.scale$1(b,b,1/this.worldSize),new a.Ray([m[0],m[1],m[2]],a.normalize([],a.sub([],b,m)))}rayIntersectionCoordinate(f){const{p0:m,p1:b,t:x}=f,T=a.mercatorZfromAltitude(m[2],this._center.lat),P=a.mercatorZfromAltitude(b[2],this._center.lat);return new a.MercatorCoordinate(a.number(m[0],b[0],x)/this.worldSize,a.number(m[1],b[1],x)/this.worldSize,a.number(T,P,x))}pointCoordinate(f,m=this._centerAltitude){return this.projection.pointCoordinate(this,f.x,f.y,m)}pointCoordinate3D(f){if(!this.elevation)return this.pointCoordinate(f);let m=this.projection.pointCoordinate3D(this,f.x,f.y);if(m)return new a.MercatorCoordinate(m[0],m[1],m[2]);let b=0,x=this.horizonLineFromTop();if(f.y>x)return this.pointCoordinate(f);const T=.02*x,P=f.clone();for(let I=0;I<10&&x-b>T;I++){P.y=a.number(b,x,.66);const L=this.projection.pointCoordinate3D(this,P.x,P.y);L?(x=P.y,m=L):b=P.y}return m?new a.MercatorCoordinate(m[0],m[1],m[2]):this.pointCoordinate(f)}isPointAboveHorizon(f){return this.projection.isPointAboveHorizon(this,f)}_coordinatePoint(f,m){const b=m&&this.elevation?this.elevation.getAtPointOrZero(f,this._centerAltitude):this._centerAltitude,x=[f.x*this.worldSize,f.y*this.worldSize,b+f.toAltitude(),1];return a.transformMat4$1(x,x,this.pixelMatrix),x[3]>0?new a.pointGeometry(x[0]/x[3],x[1]/x[3]):new a.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:f,left:m}=this._edgeInsets,b=this.height-this._edgeInsets.bottom,x=this.width-this._edgeInsets.right,T=this.pointLocation3D(new a.pointGeometry(m,f)),P=this.pointLocation3D(new a.pointGeometry(x,f)),I=this.pointLocation3D(new a.pointGeometry(x,b)),L=this.pointLocation3D(new a.pointGeometry(m,b));let V=Math.min(T.lng,P.lng,I.lng,L.lng),H=Math.max(T.lng,P.lng,I.lng,L.lng),X=Math.min(T.lat,P.lat,I.lat,L.lat),ne=Math.max(T.lat,P.lat,I.lat,L.lat);const ae=Math.pow(2,-this.zoom)/16*270,le=this.projection.name==="globe"?1:4,ue=(ce,te,_e,ve,be)=>{const $e=(ce+_e)/2,Ae=(te+ve)/2,Be=new a.pointGeometry($e,Ae),{lng:Ze,lat:ot}=this.pointLocation3D(Be),ut=Math.max(0,V-Ze,X-ot,Ze-H,ot-ne);V=Math.min(V,Ze),H=Math.max(H,Ze),X=Math.min(X,ot),ne=Math.max(ne,ot),(be<le||ut>ae)&&(ue(ce,te,$e,Ae,be+1),ue($e,Ae,_e,ve,be+1))};if(ue(m,f,x,f,1),ue(x,f,x,b,1),ue(x,b,m,b,1),ue(m,b,m,f,1),this.projection.name==="globe"){const[ce,te]=a.polesInViewport(this);ce?(ne=90,H=180,V=-180):te&&(X=-90,H=180,V=-180)}return new a.LngLatBounds(new a.LngLat(V,X),new a.LngLat(H,ne))}_getBoundsRectangular(f,m){const{top:b,left:x}=this._edgeInsets,T=this.height-this._edgeInsets.bottom,P=this.width-this._edgeInsets.right,I=new a.pointGeometry(x,b),L=new a.pointGeometry(P,b),V=new a.pointGeometry(P,T),H=new a.pointGeometry(x,T);let X=this.pointCoordinate(I,f),ne=this.pointCoordinate(L,f);const ae=this.pointCoordinate(V,m),le=this.pointCoordinate(H,m),ue=(ce,te)=>(te.y-ce.y)/(te.x-ce.x);return X.y>1&&ne.y>=0?X=new a.MercatorCoordinate((1-le.y)/ue(le,X)+le.x,1):X.y<0&&ne.y<=1&&(X=new a.MercatorCoordinate(-le.y/ue(le,X)+le.x,0)),ne.y>1&&X.y>=0?ne=new a.MercatorCoordinate((1-ae.y)/ue(ae,ne)+ae.x,1):ne.y<0&&X.y<=1&&(ne=new a.MercatorCoordinate(-ae.y/ue(ae,ne)+ae.x,0)),new a.LngLatBounds().extend(this.coordinateLocation(X)).extend(this.coordinateLocation(ne)).extend(this.coordinateLocation(le)).extend(this.coordinateLocation(ae))}_getBoundsRectangularTerrain(){const f=this.elevation;if(!f.visibleDemTiles.length||f.isUsingMockSource())return this._getBoundsRectangular(0,0);const m=f.visibleDemTiles.reduce((b,x)=>{if(x.dem){const T=x.dem.tree;b.min=Math.min(b.min,T.minimums[0]),b.max=Math.max(b.max,T.maximums[0])}return b},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(m.min*f.exaggeration(),m.max*f.exaggeration())}getBounds(){return this.projection.name==="mercator"||this.projection.name==="equirectangular"?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(f=!0){const m=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,b=this.height/2-m*(1-this._horizonShift);return f?Math.max(0,b):b}getMaxBounds(){return this.maxBounds}setMaxBounds(f){this.maxBounds=f,this.minLat=-a.MAX_MERCATOR_LATITUDE,this.maxLat=a.MAX_MERCATOR_LATITUDE,this.minLng=-180,this.maxLng=180,f&&(this.minLat=f.getSouth(),this.maxLat=f.getNorth(),this.minLng=f.getWest(),this.maxLng=f.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=a.mercatorXfromLng(this.minLng)*this.tileSize,this.worldMaxX=a.mercatorXfromLng(this.maxLng)*this.tileSize,this.worldMinY=a.mercatorYfromLat(this.maxLat)*this.tileSize,this.worldMaxY=a.mercatorYfromLat(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(f,m){return this.projection.createTileMatrix(this,m,f)}calculateDistanceTileData(f){const m=f.key,b=this._distanceTileDataCache;if(b[m])return b[m];const x=f.canonical,T=1/this.height,P=this.cameraWorldSize,I=P/this.zoomScale(x.z),L=(x.x+Math.pow(2,x.z)*f.wrap)*I,V=x.y*I,H=this.point;H.x*=P/this.worldSize,H.y*=P/this.worldSize;const X=this.angle,ne=Math.sin(-X),ae=-Math.cos(-X);return b[m]={bearing:[ne,ae],center:[(H.x-L)*T,(H.y-V)*T],scale:I/a.EXTENT*T},b[m]}calculateFogTileMatrix(f){const m=f.key,b=this._fogTileMatrixCache;if(b[m])return b[m];const x=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,f);return a.multiply(x,this.worldToFogMatrix,x),b[m]=new Float32Array(x),b[m]}calculateProjMatrix(f,m=!1){const b=f.key,x=m?this._alignedProjMatrixCache:this._projMatrixCache;if(x[b])return x[b];const T=this.calculatePosMatrix(f,this.worldSize);return a.multiply(T,this.projection.isReprojectedInTileSpace?this.mercatorMatrix:m?this.alignedProjMatrix:this.projMatrix,T),x[b]=new Float32Array(T),x[b]}calculatePixelsToTileUnitsMatrix(f){const m=f.tileID.key,b=this._pixelsToTileUnitsCache;if(b[m])return b[m];const x=function(T,P){const{scale:I}=T.tileTransform,L=I*a.EXTENT/(T.tileSize*Math.pow(2,P.zoom-T.tileID.overscaledZ+T.tileID.canonical.z));return V=new Float32Array(4),ne=(H=P.inverseAdjustmentMatrix)[1],ae=H[2],le=H[3],ce=(X=[L,L])[1],V[0]=H[0]*(ue=X[0]),V[1]=ne*ue,V[2]=ae*ce,V[3]=le*ce,V;var V,H,X,ne,ae,le,ue,ce}(f,this);return b[m]=x,b[m]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if(this.projection.name==="globe"){const f=1/this.worldSize,m=a.fromScaling([],[f,f,f]);return a.multiply(m,m,this.globeMatrix),m}}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const f=this._elevation;this._updateCameraState();const m=a.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,b=this._computeCameraPosition(m),x=this._camera.forward(),T=a.mercatorZfromAltitude(1,this._center.lat);b[2]/=T,x[2]/=T,a.normalize(x,x);const P=f.raycast(b,x,f.exaggeration());if(P){const I=a.scaleAndAdd([],b,x,P),L=new a.MercatorCoordinate(I[0],I[1],a.mercatorZfromAltitude(I[2],a.latFromMercatorY(I[1]))),V=(L.z+a.length([L.x-b[0],L.y-b[1],L.z-b[2]*T]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(V),this._centerAltitude=L.toAltitude(),this._center=this.coordinateLocation(L),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(f=!1){if(!this._elevation)return;const m=this._elevation,b=a.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,x=this._computeCameraPosition(b),T=m.getAtPointOrZero(new a.MercatorCoordinate(...x)),P=this.pixelsPerMeter/this.worldSize*T,I=this._minimumHeightOverTerrain(),L=x[2]-P;if(L<=I)if(L<0||f){const V=this.locationCoordinate(this._center,this._centerAltitude),H=[x[0],x[1],V.z-x[2]],X=a.length(H);H[2]-=(I-L)/this._pixelsPerMercatorPixel;const ne=a.length(H);if(ne===0)return;a.scale$2(H,H,X/ne*this._pixelsPerMercatorPixel),this._camera.position=[x[0],x[1],V.z*this._pixelsPerMercatorPixel-H[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const f=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||f){const ne=this.center;return ne.lat=a.clamp(ne.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!f)&&(ne.lng=a.clamp(ne.lng,this.minLng,this.maxLng)),this.center=ne,void(this._constraining=!1)}const m=this._unmodified,{x:b,y:x}=this.point;let T=0,P=b,I=x;const L=this.width/2,V=this.height/2,H=this.worldMinY*this.scale,X=this.worldMaxY*this.scale;if(x-V<H&&(I=H+V),x+V>X&&(I=X-V),X-H<this.height&&(T=Math.max(T,this.height/(X-H)),I=(X+H)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const ne=this.worldMinX*this.scale,ae=this.worldMaxX*this.scale,le=this.worldSize/2-(ne+ae)/2;P=(b+le+this.worldSize)%this.worldSize-le,P-L<ne&&(P=ne+L),P+L>ae&&(P=ae-L),ae-ne<this.width&&(T=Math.max(T,this.width/(ae-ne)),P=(ae+ne)/2)}P===b&&I===x||(this.center=this.unproject(new a.pointGeometry(P,I))),T&&(this.zoom+=this.scaleZoom(T)),this._constrainCamera(),this._unmodified=m,this._constraining=!1}_minZoomForBounds(){let f=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(f=Math.max(f,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),f}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const f=this.centerOffset,m=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=a.mercatorZfromAltitude(1,this.center.lat)/a.mercatorZfromAltitude(1,a.GLOBE_SCALE_MATCH_LATITUDE));const b=Nu(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,b),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const x=this.projection.zAxisUnit==="meters"?m:1,T=this._camera.getWorldToCamera(this.worldSize,x),P=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);P[8]=2*-f.x/this.width,P[9]=2*f.y/this.height;let I=a.mul([],P,T);if(this.projection.isReprojectedInTileSpace){const Ae=this.locationCoordinate(this.center),Be=a.identity([]);a.translate(Be,Be,[Ae.x*this.worldSize,Ae.y*this.worldSize,0]),a.multiply(Be,Be,wf(this)),a.translate(Be,Be,[-Ae.x*this.worldSize,-Ae.y*this.worldSize,0]),a.multiply(I,I,Be),this.inverseAdjustmentMatrix=function(Ze){const ot=wf(Ze,!0);return Le([],[ot[0],ot[1],ot[4],ot[5]])}(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];this.mercatorMatrix=a.scale([],I,[this.worldSize,this.worldSize,this.worldSize/x,1]),this.projMatrix=I,this.invProjMatrix=a.invert(new Float64Array(16),this.projMatrix);const L=a.invert([],P);this.frustumCorners=a.FrustumCorners.fromInvProjectionMatrix(L,this.horizonLineFromTop(),this.height);const V=new Float32Array(16);a.identity(V),a.scale(V,V,[1,-1,1]),a.rotateX(V,V,this._pitch),a.rotateZ(V,V,this.angle);const H=a.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ),X=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;H[8]=2*-f.x/this.width,H[9]=2*(f.y+X)/this.height,this.skyboxMatrix=a.multiply(V,H,V);const ne=this.point,ae=ne.x,le=ne.y,ue=this.width%2/2,ce=this.height%2/2,te=Math.cos(this.angle),_e=Math.sin(this.angle),ve=ae-Math.round(ae)+te*ue+_e*ce,be=le-Math.round(le)+te*ce+_e*ue,$e=new Float64Array(I);if(a.translate($e,$e,[ve>.5?ve-1:ve,be>.5?be-1:be,0]),this.alignedProjMatrix=$e,I=a.create(),a.scale(I,I,[this.width/2,-this.height/2,1]),a.translate(I,I,[1,-1,0]),this.labelPlaneMatrix=I,I=a.create(),a.scale(I,I,[1,-1,1]),a.translate(I,I,[-1,-1,0]),a.scale(I,I,[2/this.width,2/this.height,1]),this.glCoordMatrix=I,this.pixelMatrix=a.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),this._calcFogMatrices(),this._distanceTileDataCache={},I=a.invert(new Float64Array(16),this.pixelMatrix),!I)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=I,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=a.calculateGlobeMatrix(this);const Ae=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=a.transformMat4(Ae,Ae,T),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=I;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const f=this.cameraWorldSizeForFog,m=this.cameraPixelsPerMeter,b=this._camera.position,x=1/this.height/this._pixelsPerMercatorPixel,T=[f,f,m];a.scale$2(T,T,x),a.scale$2(b,b,-1),a.multiply$2(b,b,T);const P=a.create();a.translate(P,P,b),a.scale(P,P,T),this.mercatorFogMatrix=P,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(f,m,x)}_computeCameraPosition(f){const m=(f=f||this.pixelsPerMeter)/this.pixelsPerMeter,b=this._camera.forward(),x=this.point,T=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*m-f/this.worldSize*this._centerAltitude;return[x.x/this.worldSize-b[0]*T,x.y/this.worldSize-b[1]*T,f/this.worldSize*this._centerAltitude-b[2]*T]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(f){const m=this._maxCameraBoundsDistance()*Math.cos(this._pitch),b=this._camera.position[2],x=f[2];let T=1;this.projection.wrap&&(this.center=this.center.wrap()),x>0&&(T=Math.min((m-b)/x,1)),this._camera.position=a.scaleAndAdd([],this._camera.position,f,T),this._updateStateFromCamera()}_updateStateFromCamera(){const f=this._camera.position,m=this._camera.forward(),{pitch:b,bearing:x}=this._camera.getPitchBearing(),T=a.mercatorZfromAltitude(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,P=this._mercatorZfromZoom(this._maxZoom)*Math.cos(a.degToRad(this._maxPitch)),I=Math.max((f[2]-T)/Math.cos(b),P),L=this._zoomFromMercatorZ(I);a.scaleAndAdd(f,f,m,I),this._pitch=a.clamp(b,a.degToRad(this.minPitch),a.degToRad(this.maxPitch)),this.angle=a.wrap(x,-Math.PI,Math.PI),this._setZoom(a.clamp(L,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new a.MercatorCoordinate(f[0],f[1],f[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(f){return Math.pow(2,f)*this.tileSize}_mercatorZfromZoom(f){return this.cameraToCenterDistance/this._worldSizeFromZoom(f)}_minimumHeightOverTerrain(){const f=Math.min((this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom)+4,this._maxZoom);return this._mercatorZfromZoom(f)}_zoomFromMercatorZ(f){return this.scaleZoom(this.cameraToCenterDistance/(f*this.tileSize))}zoomFromMercatorZAdjusted(f){let m=0,b=a.GLOBE_ZOOM_THRESHOLD_MAX,x=0,T=1/0;for(;b-m>1e-6&&b>m;){const P=m+.5*(b-m),I=this.tileSize*Math.pow(2,P),L=this.getCameraToCenterDistance(this.projection,P,I),V=this.scaleZoom(L/(f*this.tileSize)),H=Math.abs(P-V);H<T&&(T=H,x=P),P<V?m=P:b=P}return x}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(a.warnOnce("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(f,m){const b=Math.min(f.x,m.x),x=Math.max(f.x,m.x),T=Math.min(f.y,m.y),P=Math.max(f.y,m.y);if(T<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const I=[new a.pointGeometry(b,T),new a.pointGeometry(x,P),new a.pointGeometry(b,P),new a.pointGeometry(x,T)],L=this.renderWorldCopies?-3:0,V=this.renderWorldCopies?4:1;for(const H of I){const X=this.pointRayIntersection(H);if(X.t<0)return!0;const ne=this.rayIntersectionCoordinate(X);if(ne.x<L||ne.y<0||ne.x>V||ne.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+a.radToDeg(this.fovAboveCenter)>88||this.anyCornerOffEdge(new a.pointGeometry(0,0),new a.pointGeometry(this.width,this.height))}zoomDeltaToMovement(f,m){const b=a.length(a.sub([],this._camera.position,f)),x=this._zoomFromMercatorZ(b)+m;return b-this._mercatorZfromZoom(x)}getCameraPoint(){if(this.projection.name==="globe"){const f=function([m,b,x],T){const P=[m,b,x,1];a.transformMat4$1(P,P,T);const I=P[3]=Math.max(P[3],1e-6);return P[0]/=I,P[1]/=I,P[2]/=I,P}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new a.pointGeometry(f[0],f[1])}{const f=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new a.pointGeometry(0,f))}}getCameraToCenterDistance(f,m=this.zoom,b=this.worldSize){const x=Nu(f,m,this.width,this.height,1024),T=f.pixelSpaceConversion(this.center.lat,b,x);return .5/Math.tan(.5*this._fov)*this.height*T}getWorldToCameraMatrix(){const f=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&a.multiply(f,f,this.globeMatrix),f}}function Ra(v,f){let m=!1,b=null;const x=()=>{b=null,m&&(v(),b=setTimeout(x,f),m=!1)};return()=>(m=!0,b||x(),b)}class cT{constructor(f){this._hashName=f&&encodeURIComponent(f),a.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=Ra(this._updateHashUnthrottled.bind(this),300)}addTo(f){return this._map=f,a.window.addEventListener("hashchange",this._onHashChange,!1),f.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),a.window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const f=this._map;if(!f)return"";const m=jw(f);if(this._hashName){const b=this._hashName;let x=!1;const T=a.window.location.hash.slice(1).split("&").map(P=>{const I=P.split("=")[0];return I===b?(x=!0,`${I}=${m}`):P}).filter(P=>P);return x||T.push(`${b}=${m}`),`#${T.join("&")}`}return`#${m}`}_getCurrentHash(){const f=a.window.location.hash.replace("#","");if(this._hashName){let m;return f.split("&").map(b=>b.split("=")).forEach(b=>{b[0]===this._hashName&&(m=b)}),(m&&m[1]||"").split("/")}return f.split("/")}_onHashChange(){const f=this._map;if(!f)return!1;const m=this._getCurrentHash();if(m.length>=3&&!m.some(b=>isNaN(b))){const b=f.dragRotate.isEnabled()&&f.touchZoomRotate.isEnabled()?+(m[3]||0):f.getBearing();return f.jumpTo({center:[+m[2],+m[1]],zoom:+m[0],bearing:b,pitch:+(m[4]||0)}),!0}return!1}_updateHashUnthrottled(){const f=a.window.location.href.replace(/(#.+)?$/,this.getHashString());a.window.history.replaceState(a.window.history.state,null,f)}}function jw(v,f){const m=v.getCenter(),b=Math.round(100*v.getZoom())/100,x=Math.ceil((b*Math.LN2+Math.log(512/360/.5))/Math.LN10),T=Math.pow(10,x),P=Math.round(m.lng*T)/T,I=Math.round(m.lat*T)/T,L=v.getBearing(),V=v.getPitch();let H=f?`/${P}/${I}/${b}`:`${b}/${I}/${P}`;return(L||V)&&(H+="/"+Math.round(10*L)/10),V&&(H+=`/${Math.round(V)}`),H}const _d={linearity:.3,easing:a.bezier(0,0,.3,1)},Sf=a.extend({deceleration:2500,maxSpeed:1400},_d),fT=a.extend({deceleration:20,maxSpeed:1400},_d),fg=a.extend({deceleration:1e3,maxSpeed:360},_d),Fw=a.extend({deceleration:1e3,maxSpeed:90},_d);class hg{constructor(f){this._map=f,this.clear()}clear(){this._inertiaBuffer=[]}record(f){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:a.exported.now(),settings:f})}_drainInertiaBuffer(){const f=this._inertiaBuffer,m=a.exported.now();for(;f.length>0&&m-f[0].time>160;)f.shift()}_onMoveEnd(f){if(a.exported.prefersReducedMotion||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const m={zoom:0,bearing:0,pitch:0,pan:new a.pointGeometry(0,0),pinchAround:void 0,around:void 0};for(const{settings:T}of this._inertiaBuffer)m.zoom+=T.zoomDelta||0,m.bearing+=T.bearingDelta||0,m.pitch+=T.pitchDelta||0,T.panDelta&&m.pan._add(T.panDelta),T.around&&(m.around=T.around),T.pinchAround&&(m.pinchAround=T.pinchAround);const b=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,x={};if(m.pan.mag()){const T=wd(m.pan.mag(),b,a.extend({},Sf,f||{}));x.offset=m.pan.mult(T.amount/m.pan.mag()),x.center=this._map.transform.center,bd(x,T)}if(m.zoom){const T=wd(m.zoom,b,fT);x.zoom=this._map.transform.zoom+T.amount,bd(x,T)}if(m.bearing){const T=wd(m.bearing,b,fg);x.bearing=this._map.transform.bearing+a.clamp(T.amount,-179,179),bd(x,T)}if(m.pitch){const T=wd(m.pitch,b,Fw);x.pitch=this._map.transform.pitch+T.amount,bd(x,T)}if(x.zoom||x.bearing){const T=m.pinchAround===void 0?m.around:m.pinchAround;x.around=T?this._map.unproject(T):this._map.getCenter()}return this.clear(),x.noMoveStart=!0,x}}function bd(v,f){(!v.duration||v.duration<f.duration)&&(v.duration=f.duration,v.easing=f.easing)}function wd(v,f,m){const{maxSpeed:b,linearity:x,deceleration:T}=m,P=a.clamp(v*x/(f/1e3),-b,b),I=Math.abs(P)/(T*x);return{easing:m.easing,duration:1e3*I,amount:P*(I/2)}}class no extends a.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(f,m,b,x={}){const T=q(m.getCanvasContainer(),b),P=m.unproject(T);super(f,a.extend({point:T,lngLat:P,originalEvent:b},x)),this._defaultPrevented=!1,this.target=m}}class dg extends a.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(f,m,b){const x=f==="touchend"?b.changedTouches:b.touches,T=Se(m.getCanvasContainer(),x),P=T.map(L=>m.unproject(L)),I=T.reduce((L,V,H,X)=>L.add(V.div(X.length)),new a.pointGeometry(0,0));super(f,{points:T,point:I,lngLats:P,lngLat:m.unproject(I),originalEvent:b}),this._defaultPrevented=!1}}class JM extends a.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(f,m,b){super(f,{originalEvent:b}),this._defaultPrevented=!1}}class hT{constructor(f,m){this._map=f,this._clickTolerance=m.clickTolerance}reset(){this._mousedownPos=void 0}wheel(f){return this._firePreventable(new JM(f.type,this._map,f))}mousedown(f,m){return this._mousedownPos=m,this._firePreventable(new no(f.type,this._map,f))}mouseup(f){this._map.fire(new no(f.type,this._map,f))}preclick(f){const m=a.extend({},f);m.type="preclick",this._map.fire(new no(m.type,this._map,m))}click(f,m){this._mousedownPos&&this._mousedownPos.dist(m)>=this._clickTolerance||(this.preclick(f),this._map.fire(new no(f.type,this._map,f)))}dblclick(f){return this._firePreventable(new no(f.type,this._map,f))}mouseover(f){this._map.fire(new no(f.type,this._map,f))}mouseout(f){this._map.fire(new no(f.type,this._map,f))}touchstart(f){return this._firePreventable(new dg(f.type,this._map,f))}touchmove(f){this._map.fire(new dg(f.type,this._map,f))}touchend(f){this._map.fire(new dg(f.type,this._map,f))}touchcancel(f){this._map.fire(new dg(f.type,this._map,f))}_firePreventable(f){if(this._map.fire(f),f.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class pg{constructor(f){this._map=f}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(f){this._map.fire(new no(f.type,this._map,f))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new no("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(f){this._delayContextMenu?this._contextMenuEvent=f:this._map.fire(new no(f.type,this._map,f)),this._map.listens("contextmenu")&&f.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class zw{constructor(f,m){this._map=f,this._el=f.getCanvasContainer(),this._container=f.getContainer(),this._clickTolerance=m.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(f,m){this.isEnabled()&&f.shiftKey&&f.button===0&&(j(),this._startPos=this._lastPos=m,this._active=!0)}mousemoveWindow(f,m){if(!this._active)return;const b=m,x=this._startPos,T=this._lastPos;if(!x||!T||T.equals(b)||!this._box&&b.dist(x)<this._clickTolerance)return;this._lastPos=b,this._box||(this._box=E("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",f));const P=Math.min(x.x,b.x),I=Math.max(x.x,b.x),L=Math.min(x.y,b.y),V=Math.max(x.y,b.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${P}px,${L}px)`,this._box.style.width=I-P+"px",this._box.style.height=V-L+"px")})}mouseupWindow(f,m){if(!this._active)return;const b=this._startPos,x=m;if(b&&f.button===0){if(this.reset(),Q(),b.x!==x.x||b.y!==x.y)return this._map.fire(new a.Event("boxzoomend",{originalEvent:f})),{cameraAnimation:T=>T.fitScreenCoordinates(b,x,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",f)}}keydown(f){this._active&&f.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",f))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),z(),delete this._startPos,delete this._lastPos}_fireEvent(f,m){return this._map.fire(new a.Event(f,{originalEvent:m}))}}function mg(v,f){const m={};for(let b=0;b<v.length;b++)m[v[b].identifier]=f[b];return m}class dT{constructor(f){this.reset(),this.numTouches=f.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(f,m,b){(this.centroid||b.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=f.timeStamp),b.length===this.numTouches&&(this.centroid=function(x){const T=new a.pointGeometry(0,0);for(const P of x)T._add(P);return T.div(x.length)}(m),this.touches=mg(b,m)))}touchmove(f,m,b){if(this.aborted||!this.centroid)return;const x=mg(b,m);for(const T in this.touches){const P=this.touches[T],I=x[T];(!I||I.dist(P)>30)&&(this.aborted=!0)}}touchend(f,m,b){if((!this.centroid||f.timeStamp-this.startTime>500)&&(this.aborted=!0),b.length===0){const x=!this.aborted&&this.centroid;if(this.reset(),x)return x}}}class xf{constructor(f){this.singleTap=new dT(f),this.numTaps=f.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(f,m,b){this.singleTap.touchstart(f,m,b)}touchmove(f,m,b){this.singleTap.touchmove(f,m,b)}touchend(f,m,b){const x=this.singleTap.touchend(f,m,b);if(x){const T=f.timeStamp-this.lastTime<500,P=!this.lastTap||this.lastTap.dist(x)<30;if(T&&P||this.reset(),this.count++,this.lastTime=f.timeStamp,this.lastTap=x,this.count===this.numTaps)return this.reset(),x}}}class Hw{constructor(){this._zoomIn=new xf({numTouches:1,numTaps:2}),this._zoomOut=new xf({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(f,m,b){this._zoomIn.touchstart(f,m,b),this._zoomOut.touchstart(f,m,b)}touchmove(f,m,b){this._zoomIn.touchmove(f,m,b),this._zoomOut.touchmove(f,m,b)}touchend(f,m,b){const x=this._zoomIn.touchend(f,m,b),T=this._zoomOut.touchend(f,m,b);return x?(this._active=!0,f.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:P=>P.easeTo({duration:300,zoom:P.getZoom()+1,around:P.unproject(x)},{originalEvent:f})}):T?(this._active=!0,f.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:P=>P.easeTo({duration:300,zoom:P.getZoom()-1,around:P.unproject(T)},{originalEvent:f})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const pT={0:1,2:2};class gg{constructor(f){this.reset(),this._clickTolerance=f.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(f,m){return!1}_move(f,m){return{}}mousedown(f,m){if(this._lastPoint)return;const b=Ie(f);this._correctButton(f,b)&&(this._lastPoint=m,this._eventButton=b)}mousemoveWindow(f,m){const b=this._lastPoint;if(b){if(f.preventDefault(),this._eventButton!=null&&function(x,T){const P=pT[T];return x.buttons===void 0||(x.buttons&P)!==P}(f,this._eventButton))this.reset();else if(this._moved||!(m.dist(b)<this._clickTolerance))return this._moved=!0,this._lastPoint=m,this._move(b,m)}}mouseupWindow(f){this._lastPoint&&Ie(f)===this._eventButton&&(this._moved&&Q(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class mT extends gg{mousedown(f,m){super.mousedown(f,m),this._lastPoint&&(this._active=!0)}_correctButton(f,m){return m===0&&!f.ctrlKey}_move(f,m){return{around:m,panDelta:m.sub(f)}}}class Vw extends gg{_correctButton(f,m){return m===0&&f.ctrlKey||m===2}_move(f,m){const b=.8*(m.x-f.x);if(b)return this._active=!0,{bearingDelta:b}}contextmenu(f){f.preventDefault()}}class Uw extends gg{_correctButton(f,m){return m===0&&f.ctrlKey||m===2}_move(f,m){const b=-.5*(m.y-f.y);if(b)return this._active=!0,{pitchDelta:b}}contextmenu(f){f.preventDefault()}}class Cf{constructor(f,m){this._map=f,this._el=f.getCanvasContainer(),this._minTouches=1,this._clickTolerance=m.clickTolerance||1,this.reset(),a.bindAll(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new a.pointGeometry(0,0)}touchstart(f,m,b){return this._calculateTransform(f,m,b)}touchmove(f,m,b){if(this._active&&!(b.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(b.length===1&&!a.isFullscreen())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return f.cancelable&&f.preventDefault(),this._calculateTransform(f,m,b)}}touchend(f,m,b){this._calculateTransform(f,m,b),this._active&&b.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(f,m,b){b.length>0&&(this._active=!0);const x=mg(b,m),T=new a.pointGeometry(0,0),P=new a.pointGeometry(0,0);let I=0;for(const V in x){const H=x[V],X=this._touches[V];X&&(T._add(H),P._add(H.sub(X)),I++,x[V]=H)}if(this._touches=x,I<this._minTouches||!P.mag())return;const L=P.div(I);return this._sum._add(L),this._sum.mag()<this._clickTolerance?void 0:{around:T.div(I),panDelta:L}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=E("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","null")},500)}}class yg{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(f){}_move(f,m,b){return{}}touchstart(f,m,b){this._firstTwoTouches||b.length<2||(this._firstTwoTouches=[b[0].identifier,b[1].identifier],this._start([m[0],m[1]]))}touchmove(f,m,b){const x=this._firstTwoTouches;if(!x)return;f.preventDefault();const[T,P]=x,I=Sd(b,m,T),L=Sd(b,m,P);if(!I||!L)return;const V=this._aroundCenter?null:I.add(L).div(2);return this._move([I,L],V,f)}touchend(f,m,b){if(!this._firstTwoTouches)return;const[x,T]=this._firstTwoTouches,P=Sd(b,m,x),I=Sd(b,m,T);P&&I||(this._active&&Q(),this.reset())}touchcancel(){this.reset()}enable(f){this._enabled=!0,this._aroundCenter=!!f&&f.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Sd(v,f,m){for(let b=0;b<v.length;b++)if(v[b].identifier===m)return f[b]}function gT(v,f){return Math.log(v/f)/Math.LN2}class yT extends yg{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(f){this._startDistance=this._distance=f[0].dist(f[1])}_move(f,m){const b=this._distance;if(this._distance=f[0].dist(f[1]),this._active||!(Math.abs(gT(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:gT(this._distance,b),pinchAround:m}}}function Ww(v,f){return 180*v.angleWith(f)/Math.PI}class vT extends yg{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(f){this._startVector=this._vector=f[0].sub(f[1]),this._minDiameter=f[0].dist(f[1])}_move(f,m){const b=this._vector;if(this._vector=f[0].sub(f[1]),b&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:Ww(this._vector,b),pinchAround:m}}_isBelowThreshold(f){this._minDiameter=Math.min(this._minDiameter,f.mag());const m=25/(Math.PI*this._minDiameter)*360,b=this._startVector;if(!b)return!1;const x=Ww(f,b);return Math.abs(x)<m}}function vg(v){return Math.abs(v.y)>Math.abs(v.x)}class wo extends yg{constructor(f){super(),this._map=f}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(f){this._lastPoints=f,vg(f[0].sub(f[1]))&&(this._valid=!1)}_move(f,m,b){const x=this._lastPoints;if(!x)return;const T=f[0].sub(x[0]),P=f[1].sub(x[1]);return this._map._cooperativeGestures&&!a.isFullscreen()&&b.touches.length<3||(this._valid=this.gestureBeginsVertically(T,P,b.timeStamp),!this._valid)?void 0:(this._lastPoints=f,this._active=!0,{pitchDelta:(T.y+P.y)/2*-.5})}gestureBeginsVertically(f,m,b){if(this._valid!==void 0)return this._valid;const x=f.mag()>=2,T=m.mag()>=2;if(!x&&!T)return;if(!x||!T)return this._firstMove==null&&(this._firstMove=b),b-this._firstMove<100&&void 0;const P=f.y>0==m.y>0;return vg(f)&&vg(m)&&P}}const QM={panStep:100,bearingStep:15,pitchStep:10};class _T{constructor(){const f=QM;this._panStep=f.panStep,this._bearingStep=f.bearingStep,this._pitchStep=f.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(f){if(f.altKey||f.ctrlKey||f.metaKey)return;let m=0,b=0,x=0,T=0,P=0;switch(f.keyCode){case 61:case 107:case 171:case 187:m=1;break;case 189:case 109:case 173:m=-1;break;case 37:f.shiftKey?b=-1:(f.preventDefault(),T=-1);break;case 39:f.shiftKey?b=1:(f.preventDefault(),T=1);break;case 38:f.shiftKey?x=1:(f.preventDefault(),P=-1);break;case 40:f.shiftKey?x=-1:(f.preventDefault(),P=1);break;default:return}return this._rotationDisabled&&(b=0,x=0),{cameraAnimation:I=>{const L=I.getZoom();I.easeTo({duration:300,easeId:"keyboardHandler",easing:e$,zoom:m?Math.round(L)+m*(f.shiftKey?2:1):L,bearing:I.getBearing()+b*this._bearingStep,pitch:I.getPitch()+x*this._pitchStep,offset:[-T*this._panStep,-P*this._panStep],center:I.getCenter()},{originalEvent:f})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function e$(v){return v*(2-v)}const bT=4.000244140625;class el{constructor(f,m){this._map=f,this._el=f.getCanvasContainer(),this._handler=m,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,a.bindAll(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(f){this._defaultZoomRate=f}setWheelZoomRate(f){this._wheelZoomRate=f}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(f){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!f&&f.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(f){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(f.ctrlKey||f.metaKey||this.isZooming()||a.isFullscreen()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let m=f.deltaMode===a.window.WheelEvent.DOM_DELTA_LINE?40*f.deltaY:f.deltaY;const b=a.exported.now(),x=b-(this._lastWheelEventTime||0);this._lastWheelEventTime=b,m!==0&&m%bT==0?this._type="wheel":m!==0&&Math.abs(m)<4?this._type="trackpad":x>400?(this._type=null,this._lastValue=m,this._timeout=setTimeout(this._onTimeout,40,f)):this._type||(this._type=Math.abs(x*m)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,m+=this._lastValue)),f.shiftKey&&m&&(m/=4),this._type&&(this._lastWheelEvent=f,this._delta-=m,this._active||this._start(f)),f.preventDefault()}_onTimeout(f){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(f)}_start(f){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const m=q(this._el,f);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:m,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const f=this._map.transform;this._type==="wheel"&&f.projection.wrap&&(f._center.lng>=180||f._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const m=()=>f._terrainEnabled()&&this._aroundCoord?f.computeZoomRelativeTo(this._aroundCoord):f.zoom;if(this._delta!==0){const L=this._type==="wheel"&&Math.abs(this._delta)>bT?this._wheelZoomRate:this._defaultZoomRate;let V=2/(1+Math.exp(-Math.abs(this._delta*L)));this._delta<0&&V!==0&&(V=1/V);const H=m(),X=Math.pow(2,H),ne=typeof this._targetZoom=="number"?f.zoomScale(this._targetZoom):X;this._targetZoom=Math.min(f.maxZoom,Math.max(f.minZoom,f.scaleZoom(ne*V))),this._type==="wheel"&&(this._startZoom=H,this._easing=this._smoothOutEasing(200)),this._delta=0}const b=typeof this._targetZoom=="number"?this._targetZoom:m(),x=this._startZoom,T=this._easing;let P,I=!1;if(this._type==="wheel"&&x&&T){const L=Math.min((a.exported.now()-this._lastWheelEventTime)/200,1),V=T(L);P=a.number(x,b,V),L<1?this._frameId||(this._frameId=!0):I=!0}else P=b,I=!0;return this._active=!0,I&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!I,zoomDelta:P-m(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(f){let m=a.ease;if(this._prevEase){const b=this._prevEase,x=(a.exported.now()-b.start)/b.duration,T=b.easing(x+.01)-b.easing(x),P=.27/Math.sqrt(T*T+1e-4)*.01,I=Math.sqrt(.0729-P*P);m=a.bezier(P,I,.25,1)}return this._prevEase={start:a.exported.now(),duration:f,easing:m},m}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=E("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(a.window.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","null")},200)}}class wT{constructor(f,m){this._clickZoom=f,this._tapZoom=m}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Ef{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(f,m){return f.preventDefault(),{cameraAnimation:b=>{b.easeTo({duration:300,zoom:b.getZoom()+(f.shiftKey?-1:1),around:b.unproject(m)},{originalEvent:f})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class xs{constructor(){this._tap=new xf({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(f,m,b){this._swipePoint||(this._tapTime&&f.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?b.length>0&&(this._swipePoint=m[0],this._swipeTouch=b[0].identifier):this._tap.touchstart(f,m,b))}touchmove(f,m,b){if(this._tapTime){if(this._swipePoint){if(b[0].identifier!==this._swipeTouch)return;const x=m[0],T=x.y-this._swipePoint.y;return this._swipePoint=x,f.preventDefault(),this._active=!0,{zoomDelta:T/128}}}else this._tap.touchmove(f,m,b)}touchend(f,m,b){this._tapTime?this._swipePoint&&b.length===0&&this.reset():this._tap.touchend(f,m,b)&&(this._tapTime=f.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class _g{constructor(f,m,b){this._el=f,this._mousePan=m,this._touchPan=b}enable(f){this._inertiaOptions=f||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class nr{constructor(f,m,b){this._pitchWithRotate=f.pitchWithRotate,this._mouseRotate=m,this._mousePitch=b}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class ST{constructor(f,m,b,x){this._el=f,this._touchZoom=m,this._touchRotate=b,this._tapDragZoom=x,this._rotationDisabled=!1,this._enabled=!0}enable(f){this._touchZoom.enable(f),this._rotationDisabled||this._touchRotate.enable(f),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const xd=v=>v.zoom||v.drag||v.pitch||v.rotate;class Cd extends a.Event{}class Ed{constructor(){this.constants=[1,1,.01],this.radius=0}setup(f,m){const b=a.sub([],m,f);this.radius=a.length(b[2]<0?a.div([],b,this.constants):[b[0],b[1],0])}projectRay(f){a.div(f,f,this.constants),a.normalize(f,f),a.mul$1(f,f,this.constants);const m=a.scale$2([],f,this.radius);if(m[2]>0){const b=a.scale$2([],[0,0,1],a.dot(m,[0,0,1])),x=a.scale$2([],a.normalize([],[m[0],m[1],0]),this.radius),T=a.add([],m,a.scale$2([],a.sub([],a.add([],x,b),m),2));m[0]=T[0],m[1]=T[1]}return m}}function Td(v){return v.panDelta&&v.panDelta.mag()||v.zoomDelta||v.bearingDelta||v.pitchDelta}class xT{constructor(f,m){this._map=f,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new hg(f),this._bearingSnap=m.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new Ed,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(m),a.bindAll(["handleEvent","handleWindowEvent"],this);const b=this._el;this._listeners=[[b,"touchstart",{passive:!0}],[b,"touchmove",{passive:!1}],[b,"touchend",void 0],[b,"touchcancel",void 0],[b,"mousedown",void 0],[b,"mousemove",void 0],[b,"mouseup",void 0],[a.window.document,"mousemove",{capture:!0}],[a.window.document,"mouseup",void 0],[b,"mouseover",void 0],[b,"mouseout",void 0],[b,"dblclick",void 0],[b,"click",void 0],[b,"keydown",{capture:!1}],[b,"keyup",void 0],[b,"wheel",{passive:!1}],[b,"contextmenu",void 0],[a.window,"blur",void 0]];for(const[x,T,P]of this._listeners)x.addEventListener(T,x===a.window.document?this.handleWindowEvent:this.handleEvent,P)}destroy(){for(const[f,m,b]of this._listeners)f.removeEventListener(m,f===a.window.document?this.handleWindowEvent:this.handleEvent,b)}_addDefaultHandlers(f){const m=this._map,b=m.getCanvasContainer();this._add("mapEvent",new hT(m,f));const x=m.boxZoom=new zw(m,f);this._add("boxZoom",x);const T=new Hw,P=new Ef;m.doubleClickZoom=new wT(P,T),this._add("tapZoom",T),this._add("clickZoom",P);const I=new xs;this._add("tapDragZoom",I);const L=m.touchPitch=new wo(m);this._add("touchPitch",L);const V=new Vw(f),H=new Uw(f);m.dragRotate=new nr(f,V,H),this._add("mouseRotate",V,["mousePitch"]),this._add("mousePitch",H,["mouseRotate"]);const X=new mT(f),ne=new Cf(m,f);m.dragPan=new _g(b,X,ne),this._add("mousePan",X),this._add("touchPan",ne,["touchZoom","touchRotate"]);const ae=new vT,le=new yT;m.touchZoomRotate=new ST(b,le,ae,I),this._add("touchRotate",ae,["touchPan","touchZoom"]),this._add("touchZoom",le,["touchPan","touchRotate"]),this._add("blockableMapEvent",new pg(m));const ue=m.scrollZoom=new el(m,this);this._add("scrollZoom",ue,["mousePan"]);const ce=m.keyboard=new _T;this._add("keyboard",ce);for(const te of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])f.interactive&&f[te]&&m[te].enable(f[te])}_add(f,m,b){this._handlers.push({handlerName:f,handler:m,allowed:b}),this._handlersById[f]=m}stop(f){if(!this._updatingCamera){for(const{handler:m}of this._handlers)m.reset();this._inertia.clear(),this._fireEvents({},{},f),this._changes=[]}}isActive(){for(const{handler:f}of this._handlers)if(f.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!xd(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(f,m,b){for(const x in f)if(x!==b&&(!m||m.indexOf(x)<0))return!0;return!1}handleWindowEvent(f){this.handleEvent(f,`${f.type}Window`)}_getMapTouches(f){const m=[];for(const b of f)this._el.contains(b.target)&&m.push(b);return m}handleEvent(f,m){this._updatingCamera=!0;const b=f.type==="renderFrame",x=b?void 0:f,T={needsRenderFrame:!1},P={},I={},L=f.touches?this._getMapTouches(f.touches):void 0,V=L?Se(this._el,L):b?void 0:q(this._el,f);for(const{handlerName:ne,handler:ae,allowed:le}of this._handlers){if(!ae.isEnabled())continue;let ue;this._blockedByActive(I,le,ne)?ae.reset():ae[m||f.type]&&(ue=ae[m||f.type](f,V,L),this.mergeHandlerResult(T,P,ue,ne,x),ue&&ue.needsRenderFrame&&this._triggerRenderFrame()),(ue||ae.isActive())&&(I[ne]=ae)}const H={};for(const ne in this._previousActiveHandlers)I[ne]||(H[ne]=x);this._previousActiveHandlers=I,(Object.keys(H).length||Td(T))&&(this._changes.push([T,P,H]),this._triggerRenderFrame()),(Object.keys(I).length||Td(T))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:X}=T;X&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],X(this._map))}mergeHandlerResult(f,m,b,x,T){if(!b)return;a.extend(f,b);const P={handlerName:x,originalEvent:b.originalEvent||T};b.zoomDelta!==void 0&&(m.zoom=P),b.panDelta!==void 0&&(m.drag=P),b.pitchDelta!==void 0&&(m.pitch=P),b.bearingDelta!==void 0&&(m.rotate=P)}_applyChanges(){const f={},m={},b={};for(const[x,T,P]of this._changes)x.panDelta&&(f.panDelta=(f.panDelta||new a.pointGeometry(0,0))._add(x.panDelta)),x.zoomDelta&&(f.zoomDelta=(f.zoomDelta||0)+x.zoomDelta),x.bearingDelta&&(f.bearingDelta=(f.bearingDelta||0)+x.bearingDelta),x.pitchDelta&&(f.pitchDelta=(f.pitchDelta||0)+x.pitchDelta),x.around!==void 0&&(f.around=x.around),x.aroundCoord!==void 0&&(f.aroundCoord=x.aroundCoord),x.pinchAround!==void 0&&(f.pinchAround=x.pinchAround),x.noInertia&&(f.noInertia=x.noInertia),a.extend(m,T),a.extend(b,P);this._updateMapTransform(f,m,b),this._changes=[]}_updateMapTransform(f,m,b){const x=this._map,T=x.transform,P=_e=>[_e.x,_e.y,_e.z];if((_e=>{const ve=this._eventsInProgress.drag;return ve&&!this._handlersById[ve.handlerName].isActive()})()&&!Td(f)){const _e=T.zoom;T.cameraElevationReference="sea",T.recenterOnTerrain(),T.cameraElevationReference="ground",_e!==T.zoom&&this._map._update(!0)}if(T._isCameraConstrained&&x._stop(!0),!Td(f))return void this._fireEvents(m,b,!0);let{panDelta:I,zoomDelta:L,bearingDelta:V,pitchDelta:H,around:X,aroundCoord:ne,pinchAround:ae}=f;T._isCameraConstrained&&(L>0&&(L=0),T._isCameraConstrained=!1),ae!==void 0&&(X=ae),(L||(_e=>m.drag&&!this._eventsInProgress.drag)())&&X&&(this._dragOrigin=P(T.pointCoordinate3D(X)),this._trackingEllipsoid.setup(T._camera.position,this._dragOrigin)),T.cameraElevationReference="sea",x._stop(!0),X=X||x.transform.centerPoint,V&&(T.bearing+=V),H&&(T.pitch+=H),T._updateCameraState();const le=[0,0,0];if(I)if(T.projection.name==="mercator"){const _e=this._trackingEllipsoid.projectRay(T.screenPointToMercatorRay(X).dir),ve=this._trackingEllipsoid.projectRay(T.screenPointToMercatorRay(X.sub(I)).dir);le[0]=ve[0]-_e[0],le[1]=ve[1]-_e[1]}else{const _e=T.pointCoordinate(X);if(T.projection.name==="globe"){I=I.rotate(-T.angle);const ve=T._pixelsPerMercatorPixel/T.worldSize;le[0]=-I.x*a.mercatorScale(a.latFromMercatorY(_e.y))*ve,le[1]=-I.y*a.mercatorScale(T.center.lat)*ve}else{const ve=T.pointCoordinate(X.sub(I));_e&&ve&&(le[0]=ve.x-_e.x,le[1]=ve.y-_e.y)}}const ue=T.zoom,ce=[0,0,0];if(L){const _e=P(ne||T.pointCoordinate3D(X)),ve={dir:a.normalize([],a.sub([],_e,T._camera.position))};if(ve.dir[2]<0){const be=T.zoomDeltaToMovement(_e,L);a.scale$2(ce,ve.dir,be)}}const te=a.add(le,le,ce);T._translateCameraConstrained(te),L&&Math.abs(T.zoom-ue)>1e-4&&T.recenterOnTerrain(),T.cameraElevationReference="ground",this._map._update(),f.noInertia||this._inertia.record(f),this._fireEvents(m,b,!0)}_fireEvents(f,m,b){const x=xd(this._eventsInProgress),T=xd(f),P={};for(const H in f){const{originalEvent:X}=f[H];this._eventsInProgress[H]||(P[`${H}start`]=X),this._eventsInProgress[H]=f[H]}!x&&T&&this._fireEvent("movestart",T.originalEvent);for(const H in P)this._fireEvent(H,P[H]);T&&this._fireEvent("move",T.originalEvent);for(const H in f){const{originalEvent:X}=f[H];this._fireEvent(H,X)}const I={};let L;for(const H in this._eventsInProgress){const{handlerName:X,originalEvent:ne}=this._eventsInProgress[H];this._handlersById[X].isActive()||(delete this._eventsInProgress[H],L=m[X]||ne,I[`${H}end`]=L)}for(const H in I)this._fireEvent(H,I[H]);const V=xd(this._eventsInProgress);if(b&&(x||T)&&!V){this._updatingCamera=!0;const H=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),X=ne=>ne!==0&&-this._bearingSnap<ne&&ne<this._bearingSnap;H?(X(H.bearing||this._map.getBearing())&&(H.bearing=0),this._map.easeTo(H,{originalEvent:L})):(this._map.fire(new a.Event("moveend",{originalEvent:L})),X(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(f,m){this._map.fire(new a.Event(f,m?{originalEvent:m}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(f=>{this._frameId=void 0,this.handleEvent(new Cd("renderFrame",{timeStamp:f})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const Gw="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class CT extends a.Evented{constructor(f,m){super(),this._moving=!1,this._zooming=!1,this.transform=f,this._bearingSnap=m.bearingSnap,a.bindAll(["_renderFrameCallback"],this)}getCenter(){return new a.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(f,m){return this.jumpTo({center:f},m)}panBy(f,m,b){return f=a.pointGeometry.convert(f).mult(-1),this.panTo(this.transform.center,a.extend({offset:f},m),b)}panTo(f,m,b){return this.easeTo(a.extend({center:f},m),b)}getZoom(){return this.transform.zoom}setZoom(f,m){return this.jumpTo({zoom:f},m),this}zoomTo(f,m,b){return this.easeTo(a.extend({zoom:f},m),b)}zoomIn(f,m){return this.zoomTo(this.getZoom()+1,f,m),this}zoomOut(f,m){return this.zoomTo(this.getZoom()-1,f,m),this}getBearing(){return this.transform.bearing}setBearing(f,m){return this.jumpTo({bearing:f},m),this}getPadding(){return this.transform.padding}setPadding(f,m){return this.jumpTo({padding:f},m),this}rotateTo(f,m,b){return this.easeTo(a.extend({bearing:f},m),b)}resetNorth(f,m){return this.rotateTo(0,a.extend({duration:1e3},f),m),this}resetNorthPitch(f,m){return this.easeTo(a.extend({bearing:0,pitch:0,duration:1e3},f),m),this}snapToNorth(f,m){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(f,m):this}getPitch(){return this.transform.pitch}setPitch(f,m){return this.jumpTo({pitch:f},m),this}cameraForBounds(f,m){f=a.LngLatBounds.convert(f);const b=m&&m.bearing||0,x=m&&m.pitch||0,T=f.getNorthWest(),P=f.getSouthEast();return this._cameraForBounds(this.transform,T,P,b,x,m)}_extendCameraOptions(f){const m={top:0,bottom:0,right:0,left:0};if(typeof(f=a.extend({padding:m,offset:[0,0],maxZoom:this.transform.maxZoom},f)).padding=="number"){const b=f.padding;f.padding={top:b,bottom:b,right:b,left:b}}return f.padding=a.extend(m,f.padding),f}_minimumAABBFrustumDistance(f,m){const b=m.max[0]-m.min[0],x=m.max[1]-m.min[1];return b/x>f.aspect?b/(2*Math.tan(.5*f.fovX)*f.aspect):x/(2*Math.tan(.5*f.fovY)*f.aspect)}_cameraForBoundsOnGlobe(f,m,b,x,T,P){const I=f.clone(),L=this._extendCameraOptions(P);I.bearing=x,I.pitch=T;const V=a.LngLat.convert(m),H=a.LngLat.convert(b),X=.5*(V.lat+H.lat),ne=.5*(V.lng+H.lng),ae=a.latLngToECEF(X,ne),le=a.normalize([],ae),ue=a.normalize([],a.cross([],le,[0,1,0])),ce=a.cross([],ue,le),te=[ue[0],ue[1],ue[2],0,ce[0],ce[1],ce[2],0,le[0],le[1],le[2],0,0,0,0,1],_e=[ae,a.latLngToECEF(V.lat,V.lng),a.latLngToECEF(H.lat,V.lng),a.latLngToECEF(H.lat,H.lng),a.latLngToECEF(V.lat,H.lng),a.latLngToECEF(X,V.lng),a.latLngToECEF(X,H.lng),a.latLngToECEF(V.lat,ne),a.latLngToECEF(H.lat,ne)];let ve=a.Aabb.fromPoints(_e.map(Pt=>[a.dot(ue,Pt),a.dot(ce,Pt),a.dot(le,Pt)]));const be=a.transformMat4([],ve.center,te);a.squaredLength(be)===0&&a.set(be,0,0,1),a.normalize(be,be),a.scale$2(be,be,a.GLOBE_RADIUS),I.center=a.ecefToLatLng(be);const $e=I.getWorldToCameraMatrix(),Ae=a.invert(new Float64Array(16),$e);ve=a.Aabb.applyTransform(ve,a.multiply([],$e,te)),a.transformMat4(be,be,$e);const Be=.5*(ve.max[2]-ve.min[2]),Ze=this._minimumAABBFrustumDistance(I,ve),ot=a.scale$2([],[0,0,1],Be),ut=a.add(ot,be,ot),zt=Ze+(I.pitch===0?0:a.distance(be,ut)),rt=I.globeCenterInViewSpace,Ot=a.sub([],be,[rt[0],rt[1],rt[2]]);a.normalize(Ot,Ot),a.scale$2(Ot,Ot,zt);const vt=a.add([],be,Ot);a.transformMat4(vt,vt,Ae);const Mt=a.earthRadius/a.GLOBE_RADIUS,st=a.length(vt),Ke=a.mercatorZfromAltitude(Math.max(st*Mt-a.earthRadius,Number.EPSILON),0),dt=Math.min(I.zoomFromMercatorZAdjusted(Ke),L.maxZoom);return dt>.5*(a.GLOBE_ZOOM_THRESHOLD_MIN+a.GLOBE_ZOOM_THRESHOLD_MAX)?(I.setProjection({name:"mercator"}),I.zoom=dt,this._cameraForBounds(I,m,b,x,T,P)):{center:I.center,zoom:dt,bearing:x,pitch:T}}queryTerrainElevation(f,m){const b=this.transform.elevation;return b?(m=a.extend({},{exaggerated:!0},m),b.getAtPoint(a.MercatorCoordinate.fromLngLat(f),null,m.exaggerated)):null}_cameraForBounds(f,m,b,x,T,P){if(f.projection.name==="globe")return this._cameraForBoundsOnGlobe(f,m,b,x,T,P);const I=f.clone(),L=this._extendCameraOptions(P),V=I.padding;I.bearing=x,I.pitch=T;const H=a.LngLat.convert(m),X=a.LngLat.convert(b),ne=new a.LngLat(H.lng,X.lat),ae=new a.LngLat(X.lng,H.lat),le=I.project(H),ue=I.project(X),ce=this.queryTerrainElevation(H),te=this.queryTerrainElevation(X),_e=this.queryTerrainElevation(ne),ve=this.queryTerrainElevation(ae),be=[[le.x,le.y,Math.min(ce||0,te||0,_e||0,ve||0)],[ue.x,ue.y,Math.max(ce||0,te||0,_e||0,ve||0)]];let $e=a.Aabb.fromPoints(be);const Ae=I.getWorldToCameraMatrix(),Be=a.invert(new Float64Array(16),Ae);$e=a.Aabb.applyTransform($e,Ae);const Ze=a.sub([],$e.max,$e.min),ot=V.left||0,ut=V.right||0,zt=V.bottom||0,rt=V.top||0,{left:Ot,right:vt,top:Mt,bottom:st}=L.padding,Ke=.5*(ot+ut),dt=.5*(rt+zt),Pt=Math.min(I.scaleZoom(I.scale*Math.min((I.width-(ot+ut+Ot+vt))/Ze[0],(I.height-(zt+rt+st+Mt))/Ze[1])),L.maxZoom),Lt=I.scale/I.zoomScale(Pt);$e=new a.Aabb([$e.min[0]-(Ot+Ke)*Lt,$e.min[1]-(st+dt)*Lt,$e.min[2]],[$e.max[0]+(vt+Ke)*Lt,$e.max[1]+(Mt+dt)*Lt,$e.max[2]]);const cr=.5*Ze[2],Vr=this._minimumAABBFrustumDistance(I,$e),ir=[0,0,1,0];a.transformMat4$1(ir,ir,Ae),a.normalize$2(ir,ir);const rr=a.scale$2([],ir,Vr+cr),hr=a.add([],$e.center,rr),Zr=(typeof L.offset.x=="number"&&typeof L.offset.y=="number"?new a.pointGeometry(L.offset.x,L.offset.y):a.pointGeometry.convert(L.offset)).rotate(-a.degToRad(x));$e.center[0]-=Zr.x*Lt,$e.center[1]+=Zr.y*Lt,a.transformMat4($e.center,$e.center,Be),a.transformMat4(hr,hr,Be);const _r=[$e.center[0],$e.center[1],hr[2]*I.pixelsPerMeter];a.scale$2(_r,_r,1/I.worldSize);const On=a.lngFromMercatorX(_r[0]),kn=a.latFromMercatorY(_r[1]),Vn=Math.min(I._zoomFromMercatorZ(_r[2]),L.maxZoom),Nn=new a.LngLat(On,kn);return I.mercatorFromTransition&&Vn<.5*(a.GLOBE_ZOOM_THRESHOLD_MIN+a.GLOBE_ZOOM_THRESHOLD_MAX)?(I.setProjection({name:"globe"}),I.zoom=Vn,this._cameraForBounds(I,m,b,x,T,P)):{center:Nn,zoom:Vn,bearing:x,pitch:T}}fitBounds(f,m,b){const x=this.cameraForBounds(f,m);return this._fitInternal(x,m,b)}fitScreenCoordinates(f,m,b,x,T){const P=a.pointGeometry.convert(f),I=a.pointGeometry.convert(m),L=new a.pointGeometry(Math.min(P.x,I.x),Math.min(P.y,I.y)),V=new a.pointGeometry(Math.max(P.x,I.x),Math.max(P.y,I.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(P,I))return this;const H=this.transform.pointLocation3D(L),X=this.transform.pointLocation3D(V),ne=this.transform.pointLocation3D(new a.pointGeometry(L.x,V.y)),ae=this.transform.pointLocation3D(new a.pointGeometry(V.x,L.y)),le=[Math.min(H.lng,X.lng,ne.lng,ae.lng),Math.min(H.lat,X.lat,ne.lat,ae.lat)],ue=[Math.max(H.lng,X.lng,ne.lng,ae.lng),Math.max(H.lat,X.lat,ne.lat,ae.lat)],ce=x&&x.pitch?x.pitch:this.getPitch(),te=this._cameraForBounds(this.transform,le,ue,b,ce,x);return this._fitInternal(te,x,T)}_fitInternal(f,m,b){return f?(delete(m=a.extend(f,m)).padding,m.linear?this.easeTo(m,b):this.flyTo(m,b)):this}jumpTo(f,m){this.stop();const b=f.preloadOnly?this.transform.clone():this.transform;let x=!1,T=!1,P=!1;return"zoom"in f&&b.zoom!==+f.zoom&&(x=!0,b.zoom=+f.zoom),f.center!==void 0&&(b.center=a.LngLat.convert(f.center)),"bearing"in f&&b.bearing!==+f.bearing&&(T=!0,b.bearing=+f.bearing),"pitch"in f&&b.pitch!==+f.pitch&&(P=!0,b.pitch=+f.pitch),f.padding==null||b.isPaddingEqual(f.padding)||(b.padding=f.padding),f.preloadOnly?(this._preloadTiles(b),this):(this.fire(new a.Event("movestart",m)).fire(new a.Event("move",m)),x&&this.fire(new a.Event("zoomstart",m)).fire(new a.Event("zoom",m)).fire(new a.Event("zoomend",m)),T&&this.fire(new a.Event("rotatestart",m)).fire(new a.Event("rotate",m)).fire(new a.Event("rotateend",m)),P&&this.fire(new a.Event("pitchstart",m)).fire(new a.Event("pitch",m)).fire(new a.Event("pitchend",m)),this.fire(new a.Event("moveend",m)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||a.warnOnce(Gw),this.transform.getFreeCameraOptions()}setFreeCameraOptions(f,m){const b=this.transform;if(!b.projection.supportsFreeCamera)return a.warnOnce(Gw),this;this.stop();const x=b.zoom,T=b.pitch,P=b.bearing;b.setFreeCameraOptions(f);const I=x!==b.zoom,L=T!==b.pitch,V=P!==b.bearing;return this.fire(new a.Event("movestart",m)).fire(new a.Event("move",m)),I&&this.fire(new a.Event("zoomstart",m)).fire(new a.Event("zoom",m)).fire(new a.Event("zoomend",m)),V&&this.fire(new a.Event("rotatestart",m)).fire(new a.Event("rotate",m)).fire(new a.Event("rotateend",m)),L&&this.fire(new a.Event("pitchstart",m)).fire(new a.Event("pitch",m)).fire(new a.Event("pitchend",m)),this.fire(new a.Event("moveend",m)),this}easeTo(f,m){this._stop(!1,f.easeId),((f=a.extend({offset:[0,0],duration:500,easing:a.ease},f)).animate===!1||!f.essential&&a.exported.prefersReducedMotion)&&(f.duration=0);const b=this.transform,x=this.getZoom(),T=this.getBearing(),P=this.getPitch(),I=this.getPadding(),L="zoom"in f?+f.zoom:x,V="bearing"in f?this._normalizeBearing(f.bearing,T):T,H="pitch"in f?+f.pitch:P,X="padding"in f?f.padding:b.padding,ne=a.pointGeometry.convert(f.offset);let ae,le,ue;if(b.projection.name==="globe"){const ot=a.MercatorCoordinate.fromLngLat(b.center),ut=ne.rotate(-b.angle);ot.x+=ut.x/b.worldSize,ot.y+=ut.y/b.worldSize;const zt=ot.toLngLat(),rt=a.LngLat.convert(f.center||zt);this._normalizeCenter(rt),ae=b.centerPoint.add(ut),le=new a.pointGeometry(ot.x,ot.y).mult(b.worldSize),ue=new a.pointGeometry(a.mercatorXfromLng(rt.lng),a.mercatorYfromLat(rt.lat)).mult(b.worldSize).sub(le)}else{ae=b.centerPoint.add(ne);const ot=b.pointLocation(ae),ut=a.LngLat.convert(f.center||ot);this._normalizeCenter(ut),le=b.project(ot),ue=b.project(ut).sub(le)}const ce=b.zoomScale(L-x);let te,_e;f.around&&(te=a.LngLat.convert(f.around),_e=b.locationPoint(te));const ve=this._zooming||L!==x,be=this._rotating||T!==V,$e=this._pitching||H!==P,Ae=!b.isPaddingEqual(X),Be=ot=>ut=>{if(ve&&(ot.zoom=a.number(x,L,ut)),be&&(ot.bearing=a.number(T,V,ut)),$e&&(ot.pitch=a.number(P,H,ut)),Ae&&(ot.interpolatePadding(I,X,ut),ae=ot.centerPoint.add(ne)),te)ot.setLocationAtPoint(te,_e);else{const zt=ot.zoomScale(ot.zoom-x),rt=L>x?Math.min(2,ce):Math.max(.5,ce),Ot=Math.pow(rt,1-ut),vt=ot.unproject(le.add(ue.mult(ut*Ot)).mult(zt));ot.setLocationAtPoint(ot.renderWorldCopies?vt.wrap():vt,ae)}return f.preloadOnly||this._fireMoveEvents(m),ot};if(f.preloadOnly){const ot=this._emulate(Be,f.duration,b);return this._preloadTiles(ot),this}const Ze={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=ve,this._rotating=be,this._pitching=$e,this._padding=Ae,this._easeId=f.easeId,this._prepareEase(m,f.noMoveStart,Ze),this._ease(Be(b),ot=>{b.recenterOnTerrain(),this._afterEase(m,ot)},f),this}_prepareEase(f,m,b={}){this._moving=!0,this.transform.cameraElevationReference="sea",m||b.moving||this.fire(new a.Event("movestart",f)),this._zooming&&!b.zooming&&this.fire(new a.Event("zoomstart",f)),this._rotating&&!b.rotating&&this.fire(new a.Event("rotatestart",f)),this._pitching&&!b.pitching&&this.fire(new a.Event("pitchstart",f))}_fireMoveEvents(f){this.fire(new a.Event("move",f)),this._zooming&&this.fire(new a.Event("zoom",f)),this._rotating&&this.fire(new a.Event("rotate",f)),this._pitching&&this.fire(new a.Event("pitch",f))}_afterEase(f,m){if(this._easeId&&m&&this._easeId===m)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const b=this._zooming,x=this._rotating,T=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,b&&this.fire(new a.Event("zoomend",f)),x&&this.fire(new a.Event("rotateend",f)),T&&this.fire(new a.Event("pitchend",f)),this.fire(new a.Event("moveend",f))}flyTo(f,m){if(!f.essential&&a.exported.prefersReducedMotion){const Pt=a.pick(f,["center","zoom","bearing","pitch","around"]);return this.jumpTo(Pt,m)}this.stop(),f=a.extend({offset:[0,0],speed:1.2,curve:1.42,easing:a.ease},f);const b=this.transform,x=this.getZoom(),T=this.getBearing(),P=this.getPitch(),I=this.getPadding(),L="zoom"in f?a.clamp(+f.zoom,b.minZoom,b.maxZoom):x,V="bearing"in f?this._normalizeBearing(f.bearing,T):T,H="pitch"in f?+f.pitch:P,X="padding"in f?f.padding:b.padding,ne=b.zoomScale(L-x),ae=a.pointGeometry.convert(f.offset);let le=b.centerPoint.add(ae);const ue=b.pointLocation(le),ce=a.LngLat.convert(f.center||ue);this._normalizeCenter(ce);const te=b.project(ue),_e=b.project(ce).sub(te);let ve=f.curve;const be=Math.max(b.width,b.height),$e=be/ne,Ae=_e.mag();if("minZoom"in f){const Pt=a.clamp(Math.min(f.minZoom,x,L),b.minZoom,b.maxZoom),Lt=be/b.zoomScale(Pt-x);ve=Math.sqrt(Lt/Ae*2)}const Be=ve*ve;function Ze(Pt){const Lt=($e*$e-be*be+(Pt?-1:1)*Be*Be*Ae*Ae)/(2*(Pt?$e:be)*Be*Ae);return Math.log(Math.sqrt(Lt*Lt+1)-Lt)}function ot(Pt){return(Math.exp(Pt)-Math.exp(-Pt))/2}function ut(Pt){return(Math.exp(Pt)+Math.exp(-Pt))/2}const zt=Ze(0);let rt=function(Pt){return ut(zt)/ut(zt+ve*Pt)},Ot=function(Pt){return be*((ut(zt)*(ot(Lt=zt+ve*Pt)/ut(Lt))-ot(zt))/Be)/Ae;var Lt},vt=(Ze(1)-zt)/ve;if(Math.abs(Ae)<1e-6||!isFinite(vt)){if(Math.abs(be-$e)<1e-6)return this.easeTo(f,m);const Pt=$e<be?-1:1;vt=Math.abs(Math.log($e/be))/ve,Ot=function(){return 0},rt=function(Lt){return Math.exp(Pt*ve*Lt)}}f.duration="duration"in f?+f.duration:1e3*vt/("screenSpeed"in f?+f.screenSpeed/ve:+f.speed),f.maxDuration&&f.duration>f.maxDuration&&(f.duration=0);const Mt=T!==V,st=H!==P,Ke=!b.isPaddingEqual(X),dt=Pt=>Lt=>{const cr=Lt*vt,Vr=1/rt(cr);Pt.zoom=Lt===1?L:x+Pt.scaleZoom(Vr),Mt&&(Pt.bearing=a.number(T,V,Lt)),st&&(Pt.pitch=a.number(P,H,Lt)),Ke&&(Pt.interpolatePadding(I,X,Lt),le=Pt.centerPoint.add(ae));const ir=Lt===1?ce:Pt.unproject(te.add(_e.mult(Ot(cr))).mult(Vr));return Pt.setLocationAtPoint(Pt.renderWorldCopies?ir.wrap():ir,le),Pt._updateCameraOnTerrain(),f.preloadOnly||this._fireMoveEvents(m),Pt};if(f.preloadOnly){const Pt=this._emulate(dt,f.duration,b);return this._preloadTiles(Pt),this}return this._zooming=!0,this._rotating=Mt,this._pitching=st,this._padding=Ke,this._prepareEase(m,!1),this._ease(dt(b),()=>this._afterEase(m),f),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(f,m){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const b=this._onEaseEnd;this._onEaseEnd=void 0,b.call(this,m)}if(!f){const b=this.handlers;b&&b.stop(!1)}return this}_ease(f,m,b){b.animate===!1||b.duration===0?(f(1),m()):(this._easeStart=a.exported.now(),this._easeOptions=b,this._onEaseFrame=f,this._onEaseEnd=m,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const f=Math.min((a.exported.now()-this._easeStart)/this._easeOptions.duration,1),m=this._onEaseFrame;m&&m(this._easeOptions.easing(f)),f<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(f,m){f=a.wrap(f,-180,180);const b=Math.abs(f-m);return Math.abs(f-360-m)<b&&(f-=360),Math.abs(f+360-m)<b&&(f+=360),f}_normalizeCenter(f){const m=this.transform;if(!m.renderWorldCopies||m.maxBounds)return;const b=f.lng-m.center.lng;f.lng+=b>180?-360:b<-180?360:0}_emulate(f,m,b){const x=Math.ceil(15*m/1e3),T=[],P=f(b.clone());for(let I=0;I<=x;I++){const L=P(I/x);T.push(L.clone())}return T}}class Yw{constructor(f={}){this.options=f,a.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(f){const m=this.options&&this.options.compact;return this._map=f,this._container=E("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=E("button","mapboxgl-ctrl-attrib-button",this._container),E("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=E("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),m&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),m===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(f,m){const b=this._map._getUIString(`AttributionControl.${m}`);f.setAttribute("aria-label",b),f.removeAttribute("title"),f.firstElementChild&&f.firstElementChild.setAttribute("title",b)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let f=this._editLink;f||(f=this._editLink=this._container.querySelector(".mapbox-improve-map"));const m=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||a.config.ACCESS_TOKEN}];if(f){const b=m.reduce((x,T,P)=>(T.value&&(x+=`${T.key}=${T.value}${P<m.length-1?"&":""}`),x),"?");f.href=`${a.config.FEEDBACK_URL}/${b}#${jw(this._map,!0)}`,f.rel="noopener nofollow",this._setElementTitle(f,"MapFeedback")}}_updateData(f){!f||f.sourceDataType!=="metadata"&&f.sourceDataType!=="visibility"&&f.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let f=[];if(this._map.style.stylesheet){const x=this._map.style.stylesheet;this.styleOwner=x.owner,this.styleId=x.id}const m=this._map.style._sourceCaches;for(const x in m){const T=m[x];if(T.used){const P=T.getSource();P.attribution&&f.indexOf(P.attribution)<0&&f.push(P.attribution)}}f.sort((x,T)=>x.length-T.length),f=f.filter((x,T)=>{for(let P=T+1;P<f.length;P++)if(f[P].indexOf(x)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?f=[...this.options.customAttribution,...f]:f.unshift(this.options.customAttribution));const b=f.join(" | ");b!==this._attribHTML&&(this._attribHTML=b,f.length?(this._innerContainer.innerHTML=b,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class Kw{constructor(){a.bindAll(["_updateLogo","_updateCompact"],this)}onAdd(f){this._map=f,this._container=E("div","mapboxgl-ctrl");const m=E("a","mapboxgl-ctrl-logo");return m.target="_blank",m.rel="noopener nofollow",m.href="https://www.mapbox.com/",m.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),m.setAttribute("rel","noopener nofollow"),this._container.appendChild(m),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(f){f&&f.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const f=this._map.style._sourceCaches;if(Object.entries(f).length===0)return!0;for(const m in f){const b=f[m].getSource();if(b.hasOwnProperty("mapbox_logo")&&!b.mapbox_logo)return!1}return!0}_updateCompact(){const f=this._container.children;if(f.length){const m=f[0];this._map.getCanvasContainer().offsetWidth<250?m.classList.add("mapboxgl-compact"):m.classList.remove("mapboxgl-compact")}}}class Od{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(f){const m=++this._id;return this._queue.push({callback:f,id:m,cancelled:!1}),m}remove(f){const m=this._currentlyRunning,b=m?this._queue.concat(m):this._queue;for(const x of b)if(x.id===f)return void(x.cancelled=!0)}run(f=0){const m=this._currentlyRunning=this._queue;this._queue=[];for(const b of m)if(!b.cancelled&&(b.callback(f),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function bg(v,f,m){if(v=new a.LngLat(v.lng,v.lat),f){const b=new a.LngLat(v.lng-360,v.lat),x=new a.LngLat(v.lng+360,v.lat),T=360*Math.ceil(Math.abs(v.lng-m.center.lng)/360),P=m.locationPoint(v).distSqr(f),I=f.x<0||f.y<0||f.x>m.width||f.y>m.height;m.locationPoint(b).distSqr(f)<P&&(I||Math.abs(b.lng-m.center.lng)<T)?v=b:m.locationPoint(x).distSqr(f)<P&&(I||Math.abs(x.lng-m.center.lng)<T)&&(v=x)}for(;Math.abs(v.lng-m.center.lng)>180;){const b=m.locationPoint(v);if(b.x>=0&&b.y>=0&&b.x<=m.width&&b.y<=m.height)break;v.lng>m.center.lng?v.lng-=360:v.lng+=360}return v}const Tf={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class wg extends a.Evented{constructor(f,m){if(super(),(f instanceof a.window.HTMLElement||m)&&(f=a.extend({element:f},m)),a.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=f&&f.anchor||"center",this._color=f&&f.color||"#3FB1CE",this._scale=f&&f.scale||1,this._draggable=f&&f.draggable||!1,this._clickTolerance=f&&f.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=f&&f.rotation||0,this._rotationAlignment=f&&f.rotationAlignment||"auto",this._pitchAlignment=f&&f.pitchAlignment&&f.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=f&&f.occludedOpacity||.2,f&&f.element)this._element=f.element,this._offset=a.pointGeometry.convert(f&&f.offset||[0,0]);else{this._defaultMarker=!0,this._element=E("div");const x=41,T=27,P=O("svg",{display:"block",height:x*this._scale+"px",width:T*this._scale+"px",viewBox:`0 0 ${T} ${x}`},this._element),I=O("radialGradient",{id:"shadowGradient"},O("defs",{},P));O("stop",{offset:"10%","stop-opacity":.4},I),O("stop",{offset:"100%","stop-opacity":.05},I),O("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},P),O("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},P),O("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},P),O("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},P),this._offset=a.pointGeometry.convert(f&&f.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",x=>{x.preventDefault()}),this._element.addEventListener("mousedown",x=>{x.preventDefault()});const b=this._element.classList;for(const x in Tf)b.remove(`mapboxgl-marker-anchor-${x}`);b.add(`mapboxgl-marker-anchor-${this._anchor}`),this._popup=null}addTo(f){return f===this._map||(this.remove(),this._map=f,f.getCanvasContainer().appendChild(this._element),f.on("move",this._updateMoving),f.on("moveend",this._update),f.on("remove",this._clearFadeTimer),f._addMarker(this),this.setDraggable(this._draggable),this._update(),f.on("click",this._onMapClick)),this}remove(){const f=this._map;return f&&(f.off("click",this._onMapClick),f.off("move",this._updateMoving),f.off("moveend",this._update),f.off("mousedown",this._addDragHandler),f.off("touchstart",this._addDragHandler),f.off("mouseup",this._onUp),f.off("touchend",this._onUp),f.off("mousemove",this._onMove),f.off("touchmove",this._onMove),f.off("remove",this._clearFadeTimer),f._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(f){return this._lngLat=a.LngLat.convert(f),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(f){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),f){if(!("offset"in f.options)){const x=Math.sqrt(Math.pow(13.5,2)/2);f.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[x,-1*(38.1-13.5+x)],"bottom-right":[-x,-1*(38.1-13.5+x)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=f,f._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(f){const m=f.code,b=f.charCode||f.keyCode;m!=="Space"&&m!=="Enter"&&b!==32&&b!==13||this.togglePopup()}_onMapClick(f){const m=f.originalEvent.target,b=this._element;this._popup&&(m===b||b.contains(m))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const f=this._popup;return f?(f.isOpen()?(f.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(f.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const f=this._map,m=this._pos;if(!f||!m)return!1;const b=f.unproject(m),x=f.getFreeCameraOptions();if(!x.position)return!1;const T=x.position.toLngLat();return T.distanceTo(b)<.9*T.distanceTo(this._lngLat)}_evaluateOpacity(){const f=this._map;if(!f)return;const m=this._pos;if(!m||m.x<0||m.x>f.transform.width||m.y<0||m.y>f.transform.height)return void this._clearFadeTimer();const b=f.unproject(m);let x;f._showingGlobe()&&a.isLngLatBehindGlobe(f.transform,this._lngLat)?x=0:(x=1-f._queryFogOpacity(b),f.transform._terrainEnabled()&&f.getTerrain()&&this._behindTerrain()&&(x*=this._occludedOpacity)),this._element.style.opacity=`${x}`,this._element.style.pointerEvents=x>0?"auto":"none",this._popup&&this._popup._setOpacity(x),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const f=this._pos;if(!f||!this._map)return;const m=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${f.x}px,${f.y}px)
            ${Tf[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${m.x}px,${m.y}px)
        `}_calculateXYTransform(){const f=this._pos,m=this._map,b=this.getPitchAlignment();if(!m||!f||b!=="map")return"";if(!m._showingGlobe()){const L=m.getPitch();return L?`rotateX(${L}deg)`:""}const x=a.radToDeg(a.globeTiltAtLngLat(m.transform,this._lngLat)),T=f.sub(a.globeCenterToScreenPoint(m.transform)),P=Math.abs(T.x)+Math.abs(T.y);if(P===0)return"";const I=x/P;return`rotateX(${-T.y*I}deg) rotateY(${T.x*I}deg)`}_calculateZTransform(){const f=this._pos,m=this._map;if(!m||!f)return"";let b=0;const x=this.getRotationAlignment();if(x==="map")if(m._showingGlobe()){const T=m.project(new a.LngLat(this._lngLat.lng,this._lngLat.lat+.001)),P=m.project(new a.LngLat(this._lngLat.lng,this._lngLat.lat-.001)).sub(T);b=a.radToDeg(Math.atan2(P.y,P.x))-90}else b=-m.getBearing();else if(x==="horizon"){const T=a.smoothstep(4,6,m.getZoom()),P=a.globeCenterToScreenPoint(m.transform);P.y+=T*m.transform.height;const I=f.sub(P),L=a.radToDeg(Math.atan2(I.y,I.x));b=(L>90?L-270:L+90)*(1-T)}return b+=this._rotation,b?`rotateZ(${b}deg)`:""}_update(f){a.window.cancelAnimationFrame(this._updateFrameId);const m=this._map;m&&(m.transform.renderWorldCopies&&(this._lngLat=bg(this._lngLat,this._pos,m.transform)),this._pos=m.project(this._lngLat),f===!0?this._updateFrameId=a.window.requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),m._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(m._showingGlobe()||m.getTerrain()||m.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(f){return this._offset=a.pointGeometry.convert(f),this._update(),this}_onMove(f){const m=this._map;if(!m)return;const b=this._pointerdownPos,x=this._positionDelta;if(b&&x){if(!this._isDragging){const T=this._clickTolerance||m._clickTolerance;if(f.point.dist(b)<T)return;this._isDragging=!0}this._pos=f.point.sub(x),this._lngLat=m.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new a.Event("dragstart"))),this.fire(new a.Event("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const f=this._map;f&&(f.off("mousemove",this._onMove),f.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new a.Event("dragend")),this._state="inactive"}_addDragHandler(f){const m=this._map,b=this._pos;m&&b&&this._element.contains(f.originalEvent.target)&&(f.preventDefault(),this._positionDelta=f.point.sub(b),this._pointerdownPos=f.point,this._state="pending",m.on("mousemove",this._onMove),m.on("touchmove",this._onMove),m.once("mouseup",this._onUp),m.once("touchend",this._onUp))}setDraggable(f){this._draggable=!!f;const m=this._map;return m&&(f?(m.on("mousedown",this._addDragHandler),m.on("touchstart",this._addDragHandler)):(m.off("mousedown",this._addDragHandler),m.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(f){return this._rotation=f||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(f){return this._rotationAlignment=f||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(f){return this._pitchAlignment=f||"auto",this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(f){return this._occludedOpacity=f||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const ET={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},TT=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function qw(v=new a.pointGeometry(0,0),f="bottom"){if(typeof v=="number"){const m=Math.round(Math.sqrt(.5*Math.pow(v,2)));switch(f){case"top":return new a.pointGeometry(0,v);case"top-left":return new a.pointGeometry(m,m);case"top-right":return new a.pointGeometry(-m,m);case"bottom":return new a.pointGeometry(0,-v);case"bottom-left":return new a.pointGeometry(m,-m);case"bottom-right":return new a.pointGeometry(-m,-m);case"left":return new a.pointGeometry(v,0);case"right":return new a.pointGeometry(-v,0)}return new a.pointGeometry(0,0)}return v instanceof a.pointGeometry||Array.isArray(v)?a.pointGeometry.convert(v):a.pointGeometry.convert(v[f]||[0,0])}class OT{constructor(f){this.jumpTo(f)}getValue(f){if(f<=this._startTime)return this._start;if(f>=this._endTime)return this._end;const m=a.easeCubicInOut((f-this._startTime)/(this._endTime-this._startTime));return this._start*(1-m)+this._end*m}isEasing(f){return f>=this._startTime&&f<=this._endTime}jumpTo(f){this._startTime=-1/0,this._endTime=-1/0,this._start=f,this._end=f}easeTo(f,m,b){this._start=this.getValue(m),this._end=f,this._startTime=m,this._endTime=m+b}}const RT={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use  + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},kT={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},Xw={showCompass:!0,showZoom:!0,visualizePitch:!1};class PT{constructor(f,m,b=!1){this._clickTolerance=10,this.element=m,this.mouseRotate=new Vw({clickTolerance:f.dragRotate._mouseRotate._clickTolerance}),this.map=f,b&&(this.mousePitch=new Uw({clickTolerance:f.dragRotate._mousePitch._clickTolerance})),a.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),m.addEventListener("mousedown",this.mousedown),m.addEventListener("touchstart",this.touchstart,{passive:!1}),m.addEventListener("touchmove",this.touchmove),m.addEventListener("touchend",this.touchend),m.addEventListener("touchcancel",this.reset)}down(f,m){this.mouseRotate.mousedown(f,m),this.mousePitch&&this.mousePitch.mousedown(f,m),j()}move(f,m){const b=this.map,x=this.mouseRotate.mousemoveWindow(f,m),T=x&&x.bearingDelta;if(T&&b.setBearing(b.getBearing()+T),this.mousePitch){const P=this.mousePitch.mousemoveWindow(f,m),I=P&&P.pitchDelta;I&&b.setPitch(b.getPitch()+I)}}off(){const f=this.element;f.removeEventListener("mousedown",this.mousedown),f.removeEventListener("touchstart",this.touchstart,{passive:!1}),f.removeEventListener("touchmove",this.touchmove),f.removeEventListener("touchend",this.touchend),f.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){z(),a.window.removeEventListener("mousemove",this.mousemove),a.window.removeEventListener("mouseup",this.mouseup)}mousedown(f){this.down(a.extend({},f,{ctrlKey:!0,preventDefault:()=>f.preventDefault()}),q(this.element,f)),a.window.addEventListener("mousemove",this.mousemove),a.window.addEventListener("mouseup",this.mouseup)}mousemove(f){this.move(f,q(this.element,f))}mouseup(f){this.mouseRotate.mouseupWindow(f),this.mousePitch&&this.mousePitch.mouseupWindow(f),this.offTemp()}touchstart(f){f.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=Se(this.element,f.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>f.preventDefault()},this._startPos))}touchmove(f){f.targetTouches.length!==1?this.reset():(this._lastPos=Se(this.element,f.targetTouches)[0],this.move({preventDefault:()=>f.preventDefault()},this._lastPos))}touchend(f){f.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const AT={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},IT={maxWidth:100,unit:"metric"};function MT(v,f,m){const b=Sg(f),x=b/f,T={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"}[m];this._map._requestDomTask(()=>{this._container.style.width=v*x+"px",this._container.innerHTML=`${b}&nbsp;${T}`})}function Sg(v){const f=Math.pow(10,`${Math.floor(v)}`.length-1);let m=v/f;return m=m>=10?10:m>=5?5:m>=3?3:m>=2?2:m>=1?1:function(b){const x=Math.pow(10,Math.ceil(-Math.log(b)/Math.LN10));return Math.round(b*x)/x}(m),f*m}const Rd={version:a.version,supported:p,setRTLTextPlugin:a.setRTLTextPlugin,getRTLTextPluginStatus:a.getRTLTextPluginStatus,Map:class extends CT{constructor(v){if(a.LivePerformanceUtils.mark(a.PerformanceMarkers.create),(v=a.extend({},kT,v)).minZoom!=null&&v.maxZoom!=null&&v.minZoom>v.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(v.minPitch!=null&&v.maxPitch!=null&&v.minPitch>v.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(v.minPitch!=null&&v.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(v.maxPitch!=null&&v.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(v.antialias&&a.isSafariWithAntialiasingBug(a.window)&&(v.antialias=!1,a.warnOnce("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new tr(v.minZoom,v.maxZoom,v.minPitch,v.maxPitch,v.renderWorldCopies),v),this._interactive=v.interactive,this._minTileCacheSize=v.minTileCacheSize,this._maxTileCacheSize=v.maxTileCacheSize,this._failIfMajorPerformanceCaveat=v.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=v.preserveDrawingBuffer,this._antialias=v.antialias,this._useWebGL2=v.useWebGL2,this._trackResize=v.trackResize,this._bearingSnap=v.bearingSnap,this._refreshExpiredTiles=v.refreshExpiredTiles,this._fadeDuration=v.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=v.crossSourceCollisions,this._collectResourceTiming=v.collectResourceTiming,this._optimizeForTerrain=v.optimizeForTerrain,this._language=this._parseLanguage(v.language),this._worldview=v.worldview,this._renderTaskQueue=new Od,this._domRenderTaskQueue=new Od,this._controls=[],this._markers=[],this._popups=[],this._mapId=a.uniqueId(),this._locale=a.extend({},RT,v.locale),this._clickTolerance=v.clickTolerance,this._cooperativeGestures=v.cooperativeGestures,this._performanceMetricsCollection=v.performanceMetricsCollection,this._containerWidth=0,this._containerHeight=0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new OT(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._requestManager=new a.RequestManager(v.transformRequest,v.accessToken,v.testMode),this._silenceAuthErrors=!!v.testMode,typeof v.container=="string"){if(this._container=a.window.document.getElementById(v.container),!this._container)throw new Error(`Container '${v.container}' not found.`)}else{if(!(v.container instanceof a.window.HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=v.container}if(this._container.childNodes.length>0&&a.warnOnce("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),v.maxBounds&&this.setMaxBounds(v.maxBounds),a.bindAll(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),a.window!==void 0&&(a.window.addEventListener("online",this._onWindowOnline,!1),a.window.addEventListener("resize",this._onWindowResize,!1),a.window.addEventListener("orientationchange",this._onWindowResize,!1),a.window.addEventListener("webkitfullscreenchange",this._onWindowResize,!1),a.window.addEventListener("visibilitychange",this._onVisibilityChange,!1)),this.handlers=new xT(this,v),this._localFontFamily=v.localFontFamily,this._localIdeographFontFamily=v.localIdeographFontFamily,v.style&&this.setStyle(v.style,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),v.projection&&this.setProjection(v.projection),this._hash=v.hash&&new cT(typeof v.hash=="string"&&v.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:v.center,zoom:v.zoom,bearing:v.bearing,pitch:v.pitch}),v.bounds&&(this.resize(),this.fitBounds(v.bounds,a.extend({},v.fitBoundsOptions,{duration:0})))),this.resize(),v.attributionControl&&this.addControl(new Yw({customAttribution:v.customAttribution})),this._logoControl=new Kw,this.addControl(this._logoControl,v.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",f=>{this._update(f.dataType==="style"),this.fire(new a.Event(`${f.dataType}data`,f))}),this.on("dataloading",f=>{this.fire(new a.Event(`${f.dataType}dataloading`,f))})}_getMapId(){return this._mapId}addControl(v,f){if(f===void 0&&(f=v.getDefaultPosition?v.getDefaultPosition():"top-right"),!v||!v.onAdd)return this.fire(new a.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const m=v.onAdd(this);this._controls.push(v);const b=this._controlPositions[f];return f.indexOf("bottom")!==-1?b.insertBefore(m,b.firstChild):b.appendChild(m),this}removeControl(v){if(!v||!v.onRemove)return this.fire(new a.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const f=this._controls.indexOf(v);return f>-1&&this._controls.splice(f,1),v.onRemove(this),this}hasControl(v){return this._controls.indexOf(v)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(v){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const f=!this._moving;return f&&this.fire(new a.Event("movestart",v)).fire(new a.Event("move",v)),this.fire(new a.Event("resize",v)),f&&this.fire(new a.Event("moveend",v)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(v){return this.transform.setMaxBounds(a.LngLatBounds.convert(v)),this._update()}setMinZoom(v){if((v=v??-2)>=-2&&v<=this.transform.maxZoom)return this.transform.minZoom=v,this._update(),this.getZoom()<v?this.setZoom(v):this.fire(new a.Event("zoomstart")).fire(new a.Event("zoom")).fire(new a.Event("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(v){if((v=v??22)>=this.transform.minZoom)return this.transform.maxZoom=v,this._update(),this.getZoom()>v?this.setZoom(v):this.fire(new a.Event("zoomstart")).fire(new a.Event("zoom")).fire(new a.Event("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(v){if((v=v??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(v>=0&&v<=this.transform.maxPitch)return this.transform.minPitch=v,this._update(),this.getPitch()<v?this.setPitch(v):this.fire(new a.Event("pitchstart")).fire(new a.Event("pitch")).fire(new a.Event("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(v){if((v=v??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(v>=this.transform.minPitch)return this.transform.maxPitch=v,this._update(),this.getPitch()>v?this.setPitch(v):this.fire(new a.Event("pitchstart")).fire(new a.Event("pitch")).fire(new a.Event("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(v){return this.transform.renderWorldCopies=v,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(v){return v==="auto"?a.window.navigator.language:Array.isArray(v)?v.length===0?void 0:v.map(f=>f==="auto"?a.window.navigator.language:f):v}setLanguage(v){const f=this._parseLanguage(v);if(!this.style||f===this._language)return this;this._language=f,this.style._reloadSources();for(const m of this._controls)m._setLanguage&&m._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(v){return this.style&&v!==this._worldview?(this._worldview=v,this.style._reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(v){return this._lazyInitEmptyStyle(),v?typeof v=="string"&&(v={name:v}):v=null,this._useExplicitProjection=!!v,this._prioritizeAndUpdateProjection(v,this.style.stylesheet?this.style.stylesheet.projection:null)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;const v=this.transform,f=v.projection.name;let m;f==="globe"&&v.zoom>=a.GLOBE_ZOOM_THRESHOLD_MAX?(v.setMercatorFromTransition(),m=!0):f==="mercator"&&v.zoom<a.GLOBE_ZOOM_THRESHOLD_MAX&&(v.setProjection({name:"globe"}),m=!0),m&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(v,f){return this._updateProjection(v||f||{name:"mercator"})}_updateProjection(v){let f;if(f=v.name==="globe"&&this.transform.zoom>=a.GLOBE_ZOOM_THRESHOLD_MAX?this.transform.setMercatorFromTransition():this.transform.setProjection(v),this.style.applyProjectionUpdate(),f){this.painter.clearBackgroundTiles();for(const m in this.style._sourceCaches)this.style._sourceCaches[m].clearTiles();this._update(!0),this._forceMarkerAndPopupUpdate(!0)}return this}project(v){return this.transform.locationPoint3D(a.LngLat.convert(v))}unproject(v){return this.transform.pointLocation3D(a.pointGeometry.convert(v))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(v,f,m){if(v==="mouseenter"||v==="mouseover"){let b=!1;const x=P=>{const I=f.filter(V=>this.getLayer(V)),L=I.length?this.queryRenderedFeatures(P.point,{layers:I}):[];L.length?b||(b=!0,m.call(this,new no(v,this,P.originalEvent,{features:L}))):b=!1},T=()=>{b=!1};return{layers:new Set(f),listener:m,delegates:{mousemove:x,mouseout:T}}}if(v==="mouseleave"||v==="mouseout"){let b=!1;const x=P=>{const I=f.filter(L=>this.getLayer(L));(I.length?this.queryRenderedFeatures(P.point,{layers:I}):[]).length?b=!0:b&&(b=!1,m.call(this,new no(v,this,P.originalEvent)))},T=P=>{b&&(b=!1,m.call(this,new no(v,this,P.originalEvent)))};return{layers:new Set(f),listener:m,delegates:{mousemove:x,mouseout:T}}}{const b=x=>{const T=f.filter(I=>this.getLayer(I)),P=T.length?this.queryRenderedFeatures(x.point,{layers:T}):[];P.length&&(x.features=P,m.call(this,x),delete x.features)};return{layers:new Set(f),listener:m,delegates:{[v]:b}}}}on(v,f,m){if(m===void 0)return super.on(v,f);Array.isArray(f)||(f=[f]);const b=this._createDelegatedListener(v,f,m);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[v]=this._delegatedListeners[v]||[],this._delegatedListeners[v].push(b);for(const x in b.delegates)this.on(x,b.delegates[x]);return this}once(v,f,m){if(m===void 0)return super.once(v,f);Array.isArray(f)||(f=[f]);const b=this._createDelegatedListener(v,f,m);for(const x in b.delegates)this.once(x,b.delegates[x]);return this}off(v,f,m){if(m===void 0)return super.off(v,f);f=new Set(Array.isArray(f)?f:[f]);const b=(T,P)=>{if(T.size!==P.size)return!1;for(const I of T)if(!P.has(I))return!1;return!0},x=this._delegatedListeners?this._delegatedListeners[v]:void 0;return x&&(T=>{for(let P=0;P<T.length;P++){const I=T[P];if(I.listener===m&&b(I.layers,f)){for(const L in I.delegates)this.off(L,I.delegates[L]);return T.splice(P,1),this}}})(x),this}queryRenderedFeatures(v,f){return this.style?(f!==void 0||v===void 0||v instanceof a.pointGeometry||Array.isArray(v)||(f=v,v=void 0),this.style.queryRenderedFeatures(v=v||[[0,0],[this.transform.width,this.transform.height]],f=f||{},this.transform)):[]}querySourceFeatures(v,f){return this.style.querySourceFeatures(v,f)}setStyle(v,f){return(f=a.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},f)).diff!==!1&&f.localIdeographFontFamily===this._localIdeographFontFamily&&f.localFontFamily===this._localFontFamily&&this.style&&v?(this._diffStyle(v,f),this):(this._localIdeographFontFamily=f.localIdeographFontFamily,this._localFontFamily=f.localFontFamily,this._updateStyle(v,f))}_getUIString(v){const f=this._locale[v];if(f==null)throw new Error(`Missing UI string '${v}'`);return f}_updateStyle(v,f){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),v&&(this.style=new Oa(this,f||{}),this.style.setEventedParent(this,{style:this.style}),typeof v=="string"?this.style.loadURL(v):this.style.loadJSON(v)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new Oa(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(v,f){if(typeof v=="string"){const m=this._requestManager.normalizeStyleURL(v),b=this._requestManager.transformRequest(m,a.ResourceType.Style);a.getJSON(b,(x,T)=>{x?this.fire(new a.ErrorEvent(x)):T&&this._updateDiff(T,f)})}else typeof v=="object"&&this._updateDiff(v,f)}_updateDiff(v,f){try{this.style.setState(v)&&this._update(!0)}catch(m){a.warnOnce(`Unable to perform style diff: ${m.message||m.error||m}.  Rebuilding the style from scratch.`),this._updateStyle(v,f)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(a.warnOnce("There is no style added to the map."),!1)}addSource(v,f){return this._lazyInitEmptyStyle(),this.style.addSource(v,f),this._update(!0)}isSourceLoaded(v){return!!this.style&&this.style._isSourceCacheLoaded(v)}areTilesLoaded(){const v=this.style&&this.style._sourceCaches;for(const f in v){const m=v[f]._tiles;for(const b in m){const x=m[b];if(x.state!=="loaded"&&x.state!=="errored")return!1}}return!0}addSourceType(v,f,m){this._lazyInitEmptyStyle(),this.style.addSourceType(v,f,m)}removeSource(v){return this.style.removeSource(v),this._updateTerrain(),this._update(!0)}getSource(v){return this.style.getSource(v)}addImage(v,f,{pixelRatio:m=1,sdf:b=!1,stretchX:x,stretchY:T,content:P}={}){if(this._lazyInitEmptyStyle(),f instanceof a.window.HTMLImageElement||a.window.ImageBitmap&&f instanceof a.window.ImageBitmap){const{width:I,height:L,data:V}=a.exported.getImageData(f);this.style.addImage(v,{data:new a.RGBAImage({width:I,height:L},V),pixelRatio:m,stretchX:x,stretchY:T,content:P,sdf:b,version:0})}else if(f.width===void 0||f.height===void 0)this.fire(new a.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:I,height:L}=f,V=f;this.style.addImage(v,{data:new a.RGBAImage({width:I,height:L},new Uint8Array(V.data)),pixelRatio:m,stretchX:x,stretchY:T,content:P,sdf:b,version:0,userImage:V}),V.onAdd&&V.onAdd(this,v)}}updateImage(v,f){const m=this.style.getImage(v);if(!m)return void this.fire(new a.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const b=f instanceof a.window.HTMLImageElement||a.window.ImageBitmap&&f instanceof a.window.ImageBitmap?a.exported.getImageData(f):f,{width:x,height:T}=b;x!==void 0&&T!==void 0?x===m.data.width&&T===m.data.height?(m.data.replace(b.data,!(f instanceof a.window.HTMLImageElement||a.window.ImageBitmap&&f instanceof a.window.ImageBitmap)),this.style.updateImage(v,m)):this.fire(new a.ErrorEvent(new Error(`The width and height of the updated image (${x}, ${T})
                must be that same as the previous version of the image
                (${m.data.width}, ${m.data.height})`))):this.fire(new a.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")))}hasImage(v){return v?!!this.style.getImage(v):(this.fire(new a.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(v){this.style.removeImage(v)}loadImage(v,f){a.getImage(this._requestManager.transformRequest(v,a.ResourceType.Image),(m,b)=>{f(m,b instanceof a.window.HTMLImageElement?a.exported.getImageData(b):b)})}listImages(){return this.style.listImages()}addLayer(v,f){return this._lazyInitEmptyStyle(),this.style.addLayer(v,f),this._update(!0)}moveLayer(v,f){return this.style.moveLayer(v,f),this._update(!0)}removeLayer(v){return this.style.removeLayer(v),this._update(!0)}getLayer(v){return this.style.getLayer(v)}setLayerZoomRange(v,f,m){return this.style.setLayerZoomRange(v,f,m),this._update(!0)}setFilter(v,f,m={}){return this.style.setFilter(v,f,m),this._update(!0)}getFilter(v){return this.style.getFilter(v)}setPaintProperty(v,f,m,b={}){return this.style.setPaintProperty(v,f,m,b),this._update(!0)}getPaintProperty(v,f){return this.style.getPaintProperty(v,f)}setLayoutProperty(v,f,m,b={}){return this.style.setLayoutProperty(v,f,m,b),this._update(!0)}getLayoutProperty(v,f){return this.style.getLayoutProperty(v,f)}setLight(v,f={}){return this._lazyInitEmptyStyle(),this.style.setLight(v,f),this._update(!0)}getLight(){return this.style.getLight()}setTerrain(v){return this._lazyInitEmptyStyle(),!v&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(v),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(v){return this._lazyInitEmptyStyle(),this.style.setFog(v),this._update(!0)}getFog(){return this.style?this.style.getFog():null}_queryFogOpacity(v){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(a.LngLat.convert(v),this.transform):0}setFeatureState(v,f){return this.style.setFeatureState(v,f),this._update()}removeFeatureState(v,f){return this.style.removeFeatureState(v,f),this._update()}getFeatureState(v){return this.style.getFeatureState(v)}_updateContainerDimensions(){if(!this._container)return;const v=this._container.getBoundingClientRect().width||400,f=this._container.getBoundingClientRect().height||300;let m,b,x,T=this._container;for(;T&&(!b||!x);){const P=a.window.getComputedStyle(T).transform;P&&P!=="none"&&(m=P.match(/matrix.*\((.+)\)/)[1].split(", "),m[0]&&m[0]!=="0"&&m[0]!=="1"&&(b=m[0]),m[3]&&m[3]!=="0"&&m[3]!=="1"&&(x=m[3])),T=T.parentElement}this._containerWidth=b?Math.abs(v/b):v,this._containerHeight=x?Math.abs(f/x):f}_detectMissingCSS(){a.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&a.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const v=this._container;v.classList.add("mapboxgl-map"),(this._missingCSSCanary=E("div","mapboxgl-canary",v)).style.visibility="hidden",this._detectMissingCSS();const f=this._canvasContainer=E("div","mapboxgl-canvas-container",v);this._interactive&&f.classList.add("mapboxgl-interactive"),this._canvas=E("canvas","mapboxgl-canvas",f),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const m=this._controlContainer=E("div","mapboxgl-control-container",v),b=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(x=>{b[x]=E("div",`mapboxgl-ctrl-${x}`,m)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(v,f){const m=a.exported.devicePixelRatio||1;this._canvas.width=m*Math.ceil(v),this._canvas.height=m*Math.ceil(f),this._canvas.style.width=`${v}px`,this._canvas.style.height=`${f}px`}_addMarker(v){this._markers.push(v)}_removeMarker(v){const f=this._markers.indexOf(v);f!==-1&&this._markers.splice(f,1)}_addPopup(v){this._popups.push(v)}_removePopup(v){const f=this._popups.indexOf(v);f!==-1&&this._popups.splice(f,1)}_setupPainter(){const v=a.extend({},p.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),f=this._useWebGL2&&this._canvas.getContext("webgl2",v),m=f||this._canvas.getContext("webgl",v)||this._canvas.getContext("experimental-webgl",v);m?(this._useWebGL2&&!f&&a.warnOnce("Failed to create WebGL 2 context. Using WebGL 1."),a.storeAuthState(m,!0),this.painter=new gd(m,this.transform,!!f),this.on("data",b=>{b.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),a.exported$1.testSupport(m)):this.fire(new a.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(v){v.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new a.Event("webglcontextlost",{originalEvent:v}))}_contextRestored(v){this._setupPainter(),this.resize(),this._update(),this.fire(new a.Event("webglcontextrestored",{originalEvent:v}))}_onMapScroll(v){if(v.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(v){return this.style?(this._styleDirty=this._styleDirty||v,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(v){return this._update(),this._renderTaskQueue.add(v)}_cancelRenderFrame(v){this._renderTaskQueue.remove(v)}_requestDomTask(v){!this.loaded()||this.loaded()&&!this.isMoving()?v():this._domRenderTaskQueue.add(v)}_render(v){let f;const m=this.painter.context.extTimerQuery,b=a.exported.now();if(this.listens("gpu-timing-frame")&&(f=m.createQueryEXT(),m.beginQueryEXT(m.TIME_ELAPSED_EXT,f)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],a.window.performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],a.window.performance.now())),this._renderTaskQueue.run(v),this._domRenderTaskQueue.run(v),this._removed)return;this._updateProjectionTransition();const x=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const I=this.transform.zoom,L=this.transform.pitch,V=a.exported.now(),H=new a.EvaluationParameters(I,{now:V,fadeDuration:x,pitch:L,transition:this.style.getTransition()});this.style.update(H)}this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let T=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),T=this._updateAverageElevation(b),this.style._updateSources(this.transform),this._forceMarkerAndPopupUpdate()):T=this._updateAverageElevation(b),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,x,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:x,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new a.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new a.Event("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),f){const I=a.exported.now()-b;m.endQueryEXT(m.TIME_ELAPSED_EXT,f),setTimeout(()=>{const L=m.getQueryObjectEXT(f,m.QUERY_RESULT_EXT)/1e6;m.deleteQueryEXT(f),this.fire(new a.Event("gpu-timing-frame",{cpuTime:I,gpuTime:L})),a.window.performance.mark("frame-gpu",{startTime:b,detail:{gpuTime:L}})},50)}if(this.listens("gpu-timing-layer")){const I=this.painter.collectGpuTimers();setTimeout(()=>{const L=this.painter.queryGpuTimers(I);this.fire(new a.Event("gpu-timing-layer",{layerTimes:L}))},50)}if(this.listens("gpu-timing-deferred-render")){const I=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const L=this.painter.queryGpuTimeDeferredRender(I);this.fire(new a.Event("gpu-timing-deferred-render",{gpuTime:L}))},50)}const P=this._sourcesDirty||this._styleDirty||this._placementDirty||T;if(P||this._repaint)this.triggerRepaint();else{const I=!this.isMoving()&&this.loaded();if(I&&(T=this._updateAverageElevation(b,!0)),T)this.triggerRepaint();else if(this._triggerFrame(!1),I&&(this.fire(new a.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const L=this._calculateSpeedIndex();this.fire(new a.Event("speedindexcompleted",{speedIndex:L})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||P||(this._fullyLoaded=!0,a.LivePerformanceUtils.mark(a.PerformanceMarkers.fullLoad),this._performanceMetricsCollection&&a.postPerformanceEvent(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(v){for(const f of this._markers)v&&!this.getRenderWorldCopies()&&(f._lngLat=f._lngLat.wrap()),f._update();for(const f of this._popups)!v||this.getRenderWorldCopies()||f._trackPointer||(f._lngLat=f._lngLat.wrap()),f._update()}_updateAverageElevation(v,f=!1){const m=b=>(this.transform.averageElevation=b,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&m(0);if((f||v-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(v)){const b=this.transform.averageElevation;let x=this.transform.sampleAverageElevation(),T=!1;this.transform.elevation&&(T=this.transform.elevation.exaggeration()!==this._averageElevationExaggeration,this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(x)?x=0:this._averageElevationLastSampledAt=v;const P=Math.abs(b-x);if(P>1){if(this._isInitialLoad||T)return this._averageElevation.jumpTo(x),m(x);this._averageElevation.easeTo(x,v,300)}else if(P>1e-4)return this._averageElevation.jumpTo(x),m(x)}return!!this._averageElevation.isEasing(v)&&m(this._averageElevation.getValue(v))}_authenticate(){a.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,v=>{if(v&&(v.message===a.AUTH_ERR_MSG||v.status===401)){const f=this.painter.context.gl;a.storeAuthState(f,!1),this._logoControl instanceof Kw&&this._logoControl._updateLogo(),f&&f.clear(f.DEPTH_BUFFER_BIT|f.COLOR_BUFFER_BIT|f.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new a.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),a.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){const v=this._isDragging();this.painter.updateTerrain(this.style,v)}_calculateSpeedIndex(){const v=this.painter.canvasCopy(),f=this.painter.getCanvasCopiesAndTimestamps();f.timeStamps.push(performance.now());const m=this.painter.context.gl,b=m.createFramebuffer();function x(T){m.framebufferTexture2D(m.FRAMEBUFFER,m.COLOR_ATTACHMENT0,m.TEXTURE_2D,T,0);const P=new Uint8Array(m.drawingBufferWidth*m.drawingBufferHeight*4);return m.readPixels(0,0,m.drawingBufferWidth,m.drawingBufferHeight,m.RGBA,m.UNSIGNED_BYTE,P),P}return m.bindFramebuffer(m.FRAMEBUFFER,b),this._canvasPixelComparison(x(v),f.canvasCopies.map(x),f.timeStamps)}_canvasPixelComparison(v,f,m){let b=m[1]-m[0];const x=v.length/4;for(let T=0;T<f.length;T++){const P=f[T];let I=0;for(let L=0;L<P.length;L+=4)P[L]===v[L]&&P[L+1]===v[L+1]&&P[L+2]===v[L+2]&&P[L+3]===v[L+3]&&(I+=1);b+=(m[T+2]-m[T+1])*(1-I/x)}return b}remove(){this._hash&&this._hash.remove();for(const f of this._controls)f.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),a.window!==void 0&&(a.window.removeEventListener("resize",this._onWindowResize,!1),a.window.removeEventListener("orientationchange",this._onWindowResize,!1),a.window.removeEventListener("webkitfullscreenchange",this._onWindowResize,!1),a.window.removeEventListener("online",this._onWindowOnline,!1),a.window.removeEventListener("visibilitychange",this._onVisibilityChange,!1));const v=this.painter.context.gl.getExtension("WEBGL_lose_context");v&&v.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),a.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new a.Event("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(v){this._renderNextFrame=this._renderNextFrame||v,this.style&&!this._frame&&(this._frame=a.exported.frame(f=>{const m=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,m&&this._render(f)}))}_preloadTiles(v){const f=this.style?Object.values(this.style._sourceCaches):[];return a.asyncAll(f,(m,b)=>m._preloadTiles(v,b),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(v){this._trackResize&&this.resize({originalEvent:v})._update()}_onVisibilityChange(){a.window.document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(v){this._showTileBoundaries!==v&&(this._showTileBoundaries=v,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(v){this._showTerrainWireframe!==v&&(this._showTerrainWireframe=v,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(v){this._speedIndexTiming!==v&&(this._speedIndexTiming=v,this._update())}get showPadding(){return!!this._showPadding}set showPadding(v){this._showPadding!==v&&(this._showPadding=v,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(v){this._showCollisionBoxes!==v&&(this._showCollisionBoxes=v,v?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(v){this._showOverdrawInspector!==v&&(this._showOverdrawInspector=v,this._update())}get repaint(){return!!this._repaint}set repaint(v){this._repaint!==v&&(this._repaint=v,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(v){this._vertices=v,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(v){this._showTileAABBs!==v&&(this._showTileAABBs=v,v&&this._update())}_setCacheLimits(v,f){a.setCacheLimits(v,f)}get version(){return a.version}},NavigationControl:class{constructor(v){this.options=a.extend({},Xw,v),this._container=E("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",f=>f.preventDefault()),this.options.showZoom&&(a.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",f=>{this._map&&this._map.zoomIn({},{originalEvent:f})}),E("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",f=>{this._map&&this._map.zoomOut({},{originalEvent:f})}),E("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(a.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",f=>{const m=this._map;m&&(this.options.visualizePitch?m.resetNorthPitch({},{originalEvent:f}):m.resetNorth({},{originalEvent:f}))}),this._compassIcon=E("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const v=this._map;if(!v)return;const f=v.getZoom(),m=f===v.getMaxZoom(),b=f===v.getMinZoom();this._zoomInButton.disabled=m,this._zoomOutButton.disabled=b,this._zoomInButton.setAttribute("aria-disabled",m.toString()),this._zoomOutButton.setAttribute("aria-disabled",b.toString())}_rotateCompassArrow(){const v=this._map;if(!v)return;const f=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(v.transform.pitch*(Math.PI/180)),.5)}) rotateX(${v.transform.pitch}deg) rotateZ(${v.transform.angle*(180/Math.PI)}deg)`:`rotate(${v.transform.angle*(180/Math.PI)}deg)`;v._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=f)})}onAdd(v){return this._map=v,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),v.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&v.on("pitch",this._rotateCompassArrow),v.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new PT(v,this._compass,this.options.visualizePitch)),this._container}onRemove(){const v=this._map;v&&(this._container.remove(),this.options.showZoom&&v.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&v.off("pitch",this._rotateCompassArrow),v.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(v,f){const m=E("button",v,this._container);return m.type="button",m.addEventListener("click",f),m}_setButtonTitle(v,f){if(!this._map)return;const m=this._map._getUIString(`NavigationControl.${f}`);v.setAttribute("aria-label",m),v.firstElementChild&&v.firstElementChild.setAttribute("title",m)}},GeolocateControl:class extends a.Evented{constructor(v){super(),this.options=a.extend({geolocation:a.window.navigator.geolocation},AT,v),a.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=Ra(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(v){return this._map=v,this._container=E("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(v){const f=(m=!!this.options.geolocation)=>{this._supportsGeolocation=m,v(m)};this._supportsGeolocation!==void 0?v(this._supportsGeolocation):a.window.navigator.permissions!==void 0?a.window.navigator.permissions.query({name:"geolocation"}).then(m=>f(m.state!=="denied")).catch(()=>f()):f()}_isOutOfMapMaxBounds(v){const f=this._map.getMaxBounds(),m=v.coords;return!!f&&(m.longitude<f.getWest()||m.longitude>f.getEast()||m.latitude<f.getSouth()||m.latitude>f.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(v){if(this._map){if(this._isOutOfMapMaxBounds(v))return this._setErrorState(),this.fire(new a.Event("outofmaxbounds",v)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=v,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(v),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(v),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new a.Event("geolocate",v)),this._finish()}}_updateCamera(v){const f=new a.LngLat(v.coords.longitude,v.coords.latitude),m=v.coords.accuracy,b=this._map.getBearing(),x=a.extend({bearing:b},this.options.fitBoundsOptions);this._map.fitBounds(f.toBounds(m),x,{geolocateSource:!0})}_updateMarker(v){if(v){const f=new a.LngLat(v.coords.longitude,v.coords.latitude);this._accuracyCircleMarker.setLngLat(f).addTo(this._map),this._userLocationDotMarker.setLngLat(f).addTo(this._map),this._accuracy=v.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const v=this._map.transform,f=a.mercatorZfromAltitude(1,v._center.lat)*v.worldSize,m=Math.ceil(2*this._accuracy*f);this._circleElement.style.width=`${m}px`,this._circleElement.style.height=`${m}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._dotElement.classList.add("mapboxgl-user-location-show-heading")):(this._dotElement.classList.remove("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(v){if(this._map){if(this.options.trackUserLocation)if(v.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const f=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",f),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",f),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(v.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new a.Event("error",v)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(v){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",f=>f.preventDefault()),this._geolocateButton=E("button","mapboxgl-ctrl-geolocate",this._container),E("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",v===!1){a.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const f=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",f),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",f)}else{const f=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",f),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",f)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=E("div","mapboxgl-user-location"),this._dotElement.appendChild(E("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(E("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new wg({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=E("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new wg({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",f=>{f.geolocateSource||this._watchState!=="ACTIVE_LOCK"||f.originalEvent&&f.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new a.Event("trackuserlocationend")))})}}_onDeviceOrientation(v){this._userLocationDotMarker&&(v.webkitCompassHeading?this._heading=v.webkitCompassHeading:v.absolute===!0&&(this._heading=-1*v.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return a.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new a.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new a.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new a.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let v;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(v={maximumAge:6e5,timeout:0},this._noTimeout=!0):(v=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,v),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const v=()=>{a.window.addEventListener("ondeviceorientationabsolute"in a.window?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientation)};a.window.DeviceMotionEvent!==void 0&&typeof a.window.DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(f=>{f==="granted"&&v()}).catch(console.error):v()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),a.window.removeEventListener("deviceorientation",this._onDeviceOrientation),a.window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:Yw,ScaleControl:class{constructor(v){this.options=a.extend({},IT,v),function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"narrow",unit:"meter"}),!0}catch{return!1}}()||(this._setScale=MT.bind(this)),a.bindAll(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const v=this.options.maxWidth||100,f=this._map,m=f._containerHeight/2,b=f._containerWidth/2-v/2,x=f.unproject([b,m]),T=f.unproject([b+v,m]),P=x.distanceTo(T);if(this.options.unit==="imperial"){const I=3.2808*P;I>5280?this._setScale(v,I/5280,"mile"):this._setScale(v,I,"foot")}else this.options.unit==="nautical"?this._setScale(v,P/1852,"nautical-mile"):P>=1e3?this._setScale(v,P/1e3,"kilometer"):this._setScale(v,P,"meter")}_setScale(v,f,m){const b=Sg(f),x=b/f;this._map._requestDomTask(()=>{this._container.style.width=v*x+"px",this._container.innerHTML=m!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"narrow",unit:m}).format(b):`${b}&nbsp;nm`})}onAdd(v){return this._map=v,this._language=v.getLanguage(),this._container=E("div","mapboxgl-ctrl mapboxgl-ctrl-scale",v.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(v){this._language=v,this._update()}setUnit(v){this.options.unit=v,this._update()}},FullscreenControl:class{constructor(v){this._fullscreen=!1,v&&v.container&&(v.container instanceof a.window.HTMLElement?this._container=v.container:a.warnOnce("Full screen control 'container' must be a DOM element.")),a.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in a.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in a.window.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(v){return this._map=v,this._container||(this._container=this._map.getContainer()),this._controlContainer=E("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",a.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,a.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!a.window.document.fullscreenEnabled&&!a.window.document.webkitFullscreenEnabled)}_setupUI(){const v=this._fullscreenButton=E("button","mapboxgl-ctrl-fullscreen",this._controlContainer);E("span","mapboxgl-ctrl-icon",v).setAttribute("aria-hidden","true"),v.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),a.window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const v=this._getTitle();this._fullscreenButton.setAttribute("aria-label",v),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",v)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(a.window.document.fullscreenElement||a.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?a.window.document.exitFullscreen?a.window.document.exitFullscreen():a.window.document.webkitCancelFullScreen&&a.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends a.Evented{constructor(v){super(),this.options=a.extend(Object.create(ET),v),a.bindAll(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(v&&v.className?v.className.trim().split(/\s+/):[])}addTo(v){return this._map&&this.remove(),this._map=v,this.options.closeOnClick&&v.on("preclick",this._onClose),this.options.closeOnMove&&v.on("move",this._onClose),v.on("remove",this.remove),this._update(),v._addPopup(this),this._focusFirstElement(),this._trackPointer?(v.on("mousemove",this._onMouseEvent),v.on("mouseup",this._onMouseEvent),v._canvasContainer.classList.add("mapboxgl-track-pointer")):v.on("move",this._update),this.fire(new a.Event("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const v=this._map;return v&&(v.off("move",this._update),v.off("move",this._onClose),v.off("preclick",this._onClose),v.off("click",this._onClose),v.off("remove",this.remove),v.off("mousemove",this._onMouseEvent),v.off("mouseup",this._onMouseEvent),v.off("drag",this._onMouseEvent),v._canvasContainer&&v._canvasContainer.classList.remove("mapboxgl-track-pointer"),v._removePopup(this),this._map=void 0),this.fire(new a.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(v){this._lngLat=a.LngLat.convert(v),this._pos=null,this._trackPointer=!1,this._update();const f=this._map;return f&&(f.on("move",this._update),f.off("mousemove",this._onMouseEvent),f._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const v=this._map;return v&&(v.off("move",this._update),v.on("mousemove",this._onMouseEvent),v.on("drag",this._onMouseEvent),v._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(v){return this.setDOMContent(a.window.document.createTextNode(v))}setHTML(v){const f=a.window.document.createDocumentFragment(),m=a.window.document.createElement("body");let b;for(m.innerHTML=v;b=m.firstChild,b;)f.appendChild(b);return this.setDOMContent(f)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(v){return this.options.maxWidth=v,this._update(),this}setDOMContent(v){let f=this._content;if(f)for(;f.hasChildNodes();)f.firstChild&&f.removeChild(f.firstChild);else f=this._content=E("div","mapboxgl-popup-content",this._container||void 0);if(f.appendChild(v),this.options.closeButton){const m=this._closeButton=E("button","mapboxgl-popup-close-button",f);m.type="button",m.setAttribute("aria-label","Close popup"),m.setAttribute("aria-hidden","true"),m.innerHTML="&#215;",m.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(v){return this._classList.add(v),this._updateClassList(),this}removeClassName(v){return this._classList.delete(v),this._updateClassList(),this}setOffset(v){return this.options.offset=v,this._update(),this}toggleClassName(v){let f;return this._classList.delete(v)?f=!1:(this._classList.add(v),f=!0),this._updateClassList(),f}_onMouseEvent(v){this._update(v.point)}_getAnchor(v){if(this.options.anchor)return this.options.anchor;const f=this._map,m=this._container,b=this._pos;if(!f||!m||!b)return"bottom";const x=m.offsetWidth,T=m.offsetHeight,P=b.x<x/2,I=b.x>f.transform.width-x/2;if(b.y+v<T)return P?"top-left":I?"top-right":"top";if(b.y>f.transform.height-T){if(P)return"bottom-left";if(I)return"bottom-right"}return P?"left":I?"right":"bottom"}_updateClassList(){const v=this._container;if(!v)return;const f=[...this._classList];f.push("mapboxgl-popup"),this._anchor&&f.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&f.push("mapboxgl-popup-track-pointer"),v.className=f.join(" ")}_update(v){const f=this._map,m=this._content;if(!f||!this._lngLat&&!this._trackPointer||!m)return;let b=this._container;if(b||(b=this._container=E("div","mapboxgl-popup",f.getContainer()),this._tip=E("div","mapboxgl-popup-tip",b),b.appendChild(m)),this.options.maxWidth&&b.style.maxWidth!==this.options.maxWidth&&(b.style.maxWidth=this.options.maxWidth),f.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=bg(this._lngLat,this._pos,f.transform)),!this._trackPointer||v){const x=this._pos=this._trackPointer&&v?v:f.project(this._lngLat),T=qw(this.options.offset),P=this._anchor=this._getAnchor(T.y),I=qw(this.options.offset,P),L=x.add(I).round();f._requestDomTask(()=>{this._container&&P&&(this._container.style.transform=`${Tf[P]} translate(${L.x}px,${L.y}px)`)})}if(!this._marker&&f._showingGlobe()){const x=a.isLngLatBehindGlobe(f.transform,this._lngLat)?0:1;this._setOpacity(x)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const v=this._container.querySelector(TT);v&&v.focus()}_onClose(){this.remove()}_setOpacity(v){this._container&&(this._container.style.opacity=`${v}`),this._content&&(this._content.style.pointerEvents=v?"auto":"none")}},Marker:wg,Style:Oa,LngLat:a.LngLat,LngLatBounds:a.LngLatBounds,Point:a.pointGeometry,MercatorCoordinate:a.MercatorCoordinate,FreeCameraOptions:ug,Evented:a.Evented,config:a.config,prewarm:function(){bt().acquire(Sr)},clearPrewarmedResources:function(){const v=Re;v&&(v.isPreloaded()&&v.numActive()===1?(v.release(Sr),Re=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return a.config.ACCESS_TOKEN},set accessToken(v){a.config.ACCESS_TOKEN=v},get baseApiUrl(){return a.config.API_URL},set baseApiUrl(v){a.config.API_URL=v},get workerCount(){return It.workerCount},set workerCount(v){It.workerCount=v},get maxParallelImageRequests(){return a.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(v){a.config.MAX_PARALLEL_IMAGE_REQUESTS=v},clearStorage(v){a.clearTileCache(v)},workerUrl:"",workerClass:null,setNow:a.exported.setNow,restoreNow:a.exported.restoreNow};return Rd});var s=i;return s})})(mae);var jEe=mae.exports;const cl=jb(jEe),FEe=io.memo(function({routeData:t,driverload:r}){cl.accessToken="pk.eyJ1IjoibmV1cmFsbm9uZSIsImEiOiJjbGdiNGw0Y3ExMDZnM2xvdzlveTRidXdsIn0.FBhHUHf-tc6vVp0RDn4awQ";const n=_t.useRef(null),i=_t.useRef(null),[o,s]=_t.useState(-111.8998),[a,h]=_t.useState(33.2343),[p,y]=_t.useState(8),S=_t.useState([]);_t.useState(!1);let E=_t.useRef(null);const[O,A]=_t.useState(0);let $;const B=[],j=[],z=Qe=>{const de=r.length;for(let Ce=0;Ce<de;Ce++)if(r[Ce].Name==Qe)return Ce;return-1};function W(Qe){const de=Q(Qe),Ce=(de.r+de.g+de.b)/3,Ct=Ce>127.5?Ce/-3.5:(255-Ce)/3.5;return Ct>0?Ct>30?30:Ct:Ct<-30?-30:Ct}function Q(Qe){var de=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;Qe=Qe.replace(de,function(pt,Ct,ie,M){return Ct+Ct+ie+ie+M+M});var Ce=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(Qe);return Ce?{r:parseInt(Ce[1],16),g:parseInt(Ce[2],16),b:parseInt(Ce[3],16)}:null}function q(Qe,de){Qe=Qe.replace(/^\s*#|\s*$/g,""),Qe.length===3&&(Qe=Qe.replace(/(.)/g,"$1$1"));var Ce=parseInt(Qe.substr(0,2),16),pt=parseInt(Qe.substr(2,2),16),Ct=parseInt(Qe.substr(4,2),16);de<0?(de=Math.abs(de),Ce=Math.round(Ce*(100-de)/100),pt=Math.round(pt*(100-de)/100),Ct=Math.round(Ct*(100-de)/100)):(Ce+=Math.round((255-Ce)*(de/100)),pt+=Math.round((255-pt)*(de/100)),Ct+=Math.round((255-Ct)*(de/100)));var ie=Ce.toString(16).length===1?"0"+Ce.toString(16):Ce.toString(16),M=pt.toString(16).length===1?"0"+pt.toString(16):pt.toString(16),U=Ct.toString(16).length===1?"0"+Ct.toString(16):Ct.toString(16);return"#"+ie+M+U}_t.useEffect(()=>{if(t!=null)return i.current==null?setTimeout(()=>{Se(),He()},100):O>0?setTimeout(()=>{Se(),He()},100):(Se(),He()),()=>{Le()}},[t,O]);const Se=()=>{const Qe=t.qGeo.length;for(let de=0;de<Qe;de++){let Ce=function(){if(M<Ct){for(let K=0;K<U;K++)M+K<Ct&&ie.features[0].geometry.coordinates.push([t.qGeo[de].features.geometry.coordinates[M+K][0],t.qGeo[de].features.geometry.coordinates[M+K][1]]);i.current.getSource(de).setData(ie),M+=U,requestAnimationFrame(Ce)}};const pt=z(t.qGeo[de].features.properties.RouteDriver),Ct=t.qGeo[de].features.geometry.coordinates.length,ie={type:"FeatureCollection",features:[{type:"Feature",geometry:{type:"LineString",coordinates:[[t.qGeo[de].features.geometry.coordinates[0][0],t.qGeo[de].features.geometry.coordinates[0][1]]]}}]};ct(de,de,t.qGeo,0),At(de,de,t.qGeo,0),i.current.addSource(de,{type:"geojson",data:ie}),ze(de,q(r[pt].Color,W(r[pt].Color))),i.current.addLayer({id:`${de}`,type:"line",source:`${de}`,layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":r[pt].Color,"line-width":7,"line-blur":1}});let M=1;const U=5;Ce()}},Ie=Qe=>{const de=S.length;if(de>0){for(let Ce=0;Ce<de;Ce++)if(S[Ce]==t.rGeo[Qe].features.properties.RouteName)return!0;return!1}else return!1},He=()=>{const Qe=t.rGeo.length;for(let de=0;de<Qe;de++){let Ce=function(){if(U<ie){for(let re=0;re<K;re++)U+re<ie&&M.features[0].geometry.coordinates.push([t.rGeo[de].features.geometry.coordinates[U+re][0],t.rGeo[de].features.geometry.coordinates[U+re][1]]);i.current.getSource(pt).setData(M),U+=K,requestAnimationFrame(Ce)}};$=Ie(de),S.push(t.rGeo[de].features.properties.RouteName);const pt=Qe+de,Ct=z(t.rGeo[de].features.properties.RouteDriver),ie=t.rGeo[de].features.geometry.coordinates.length,M={type:"FeatureCollection",features:[{type:"Feature",geometry:{type:"LineString",coordinates:[[t.rGeo[de].features.geometry.coordinates[0][0],t.rGeo[de].features.geometry.coordinates[0][1]]]}}]};ct(pt,de,t.rGeo,1),At(pt,de,t.rGeo,1),i.current.addSource(pt,{type:"geojson",data:M}),ze(pt,q(r[Ct].Color,W(r[Ct].Color))),i.current.addLayer({id:`${pt}`,type:"line",source:`${pt}`,layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":r[Ct].Color,"line-width":7,"line-blur":1}});let U=1;const K=10;Ce()}},Le=()=>{if(t==null)return;const Qe=t.qGeo.length;for(let de=0;de<Qe;de++){const Ce=Qe+de;i.current.getLayer(de)&&(i.current.removeLayer(de),i.current.removeSource(de),B[de].remove(),j[de].remove()),i.current.getLayer(de+"border")&&i.current.removeLayer(de+"border"),i.current.getLayer(Ce+"border")&&i.current.removeLayer(Ce+"border"),i.current.getLayer(Ce)&&(i.current.removeLayer(Ce),i.current.removeSource(Ce),B[Ce].remove(),j[Ce].remove())}},ze=(Qe,de)=>{i.current.addLayer({id:`${Qe+"border"}`,type:"line",source:`${Qe}`,layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":de,"line-width":10}})},ct=(Qe,de,Ce,pt)=>{const Ct=Ce[de].features.geometry.coordinates[0][0],ie=Ce[de].features.geometry.coordinates[0][1],M=Ce[de].features.properties.RouteName,U=Ce[de].features.properties.RouteDriver;let K=document.createElement("div");return K.className=pt==0?"marker-set":"marker-set-route-pickup",B[Qe]=new cl.Marker({element:K,offset:$==!0?pt==0?[0,0]:[-20,0]:[0,0]}).setLngLat([Ct,ie]).addTo(i.current).setPopup(new cl.Popup().setHTML(`<div>
          <p>Driver: ${U}</p>
          <p>Patient: ${M}</p>
          <p>${$==!0?"Return":""} Pickup Time: ${$==!1?t.Sched.schedule.Patients[M].pickuptime[0]:t.Sched.schedule.Patients[M].pickuptime[1]}</p>
        
        </div>`)),()=>{let re=B.length;for(let me=0;me<re;me++)B[me].remove()}},At=(Qe,de,Ce,pt)=>{const Ct=Ce[de].features.geometry.coordinates.length-1,ie=Ce[de].features.geometry.coordinates[Ct][0],M=Ce[de].features.geometry.coordinates[Ct][1],U=Ce[de].features.properties.RouteName,K=Ce[de].features.properties.RouteDriver;let re=document.createElement("div");return re.className=pt==0?"marker-set":"marker-set-route",j[Qe]=new cl.Marker({element:re,offset:$==!0?pt==0?[0,0]:[-20,0]:[0,0]}).setLngLat([ie,M]).addTo(i.current).setPopup(new cl.Popup().setHTML(`<div>
        <p>Driver: ${K}</p>
        <p>Patient: ${U}</p>
        <p>${$==!0?"Return":""} Dropoff Time: ${$==!1?t.Sched.schedule.Patients[U].dropofftime[0]:t.Sched.schedule.Patients[U].dropofftime[1]}</p>
      
      </div>`)),()=>{const me=j.length;for(let Oe=0;Oe<me;Oe++)j[Oe].remove()}};return _t.useEffect(()=>{i.current=new cl.Map({container:n.current,style:"mapbox://styles/mapbox/dark-v11",center:[o,a],zoom:p,attributionControl:!1});const Qe=new cl.AttributionControl({customAttribution:"Map Designed by Ahmed"}),de=new cl.GeolocateControl({positionOptions:{enableHighAccuracy:!0},trackUserLocation:!0,showUserHeading:!0}),Ce=new cl.NavigationControl({visualizePitch:!0});E=new MapboxGeocoder({accessToken:cl.accessToken,mapboxgl:cl}),i.current.addControl(Ce,"top-right"),i.current.addControl(Qe),i.current.addControl(de),i.current.addControl(E,"top-left")},[]),_t.useEffect(()=>{if(i.current)return i.current.on("move",()=>{s(i.current.getCenter().lng.toFixed(4)),h(i.current.getCenter().lat.toFixed(4)),y(i.current.getZoom().toFixed(2))}),()=>{i.current.off("move",()=>{s(o),h(a),y(p)})}}),Pe.jsx(Pe.Fragment,{children:Pe.jsx("div",{ref:n,className:"map"})})});function zEe({index:e,Name:t,Status:r,Color:n,supabase:i,driverload:o}){const[s,a]=_t.useState(r),[h,p]=_t.useState(n),y=async(E,O,A)=>{const{data:$,error:B}=await i.from("user_drivers").update({Status:E}).eq("Name",O);B?console.log(B):(a(E),o[A].Status=E)},S=async()=>{const{data:E,error:O}=await i.from("user_drivers").update({Color:h}).eq("Name",t);O?console.log(O):o[e].Color=h};return Pe.jsx(Pe.Fragment,{children:Pe.jsx("li",{id:t,style:{listStyleType:"none"},children:Pe.jsxs("div",{className:"driver-input-class-map",children:[Pe.jsx("div",{className:"name-div",children:t}),Pe.jsx("div",{className:"test-overflow-div",children:Pe.jsx("input",{className:"color-picker-div",id:"color-picker",type:"color",onChange:E=>{p(E.target.value)},value:h,onBlur:()=>S()})}),Pe.jsx("div",{className:"switch-div",children:Pe.jsxs("label",{className:"switch",children:[Pe.jsx("input",{type:"checkbox",onChange:()=>y(!s,t,e),checked:!s}),Pe.jsx("span",{className:"slider round"})]})})]})},e)})}function HEe({fileName:e,selectFile:t,userFiles:r,queryRouteAPI:n,reformatDataForRouteQuery:i,driverload:o,supabase:s}){const[a,h]=_t.useState(0),[p,y]=_t.useState(0);_t.useState(!1);const S=()=>{h(a+1)};return Pe.jsxs(Pe.Fragment,{children:[Pe.jsxs("div",{className:"input-div",children:[Pe.jsx("button",{className:"input-button",onClick:S,children:"Select a schedule"}),Pe.jsx("div",{className:"create-schedule"+(a===0?"":a%2===0?" inactive":" active"),children:Pe.jsx("ul",{children:r.map((E,O)=>Pe.jsx("li",{id:E,className:e!=""&&(p==O||e==E)?"list-css list-css-active":"list-css",onMouseEnter:()=>y(O),onMouseLeave:()=>y(-1),onMouseDown:()=>t(E),children:Pe.jsxs("div",{className:"holder-hold-div",children:[Pe.jsx("div",{style:{display:"inline-block"},children:Pe.jsx("span",{className:"glyphicon glyphicon-th sched-glyph"})}),Pe.jsx("div",{className:"files-div",children:E.replace(/\*/g,"/")}),Pe.jsx("div",{className:"border-div"})]})},O))})}),Pe.jsx("button",{className:"button-colors input-button-import",onClick:()=>i(),children:"Route schedule"})]}),Pe.jsxs("div",{className:"driver-input-div-map",children:[Pe.jsxs("p",{className:"sched-index",children:["Drivers (",o.length,")"]}),o.map((E,O)=>{const A=O;return Pe.jsx(zEe,{index:A,Name:E.Name,Status:E.Status,Color:E.Color,supabase:s,driverload:o},A)})]})]})}var on=function(e){try{return!!e()}catch{return!0}},VEe=on,GC=!VEe(function(){var e=function(){}.bind();return typeof e!="function"||e.hasOwnProperty("prototype")}),yae=GC,vae=Function.prototype,NB=vae.call,UEe=yae&&vae.bind.bind(NB,NB),sn=yae?UEe:function(e){return function(){return NB.apply(e,arguments)}},_ae=sn,WEe=_ae({}.toString),GEe=_ae("".slice),Tu=function(e){return GEe(WEe(e),8,-1)},YEe=sn,KEe=on,qEe=Tu,e2=Object,XEe=YEe("".split),YC=KEe(function(){return!e2("z").propertyIsEnumerable(0)})?function(e){return qEe(e)=="String"?XEe(e,""):e2(e)}:e2,Il=function(e){return e==null},ZEe=Il,JEe=TypeError,Wa=function(e){if(ZEe(e))throw JEe("Can't call method on "+e);return e},QEe=YC,eTe=Wa,ys=function(e){return QEe(eTe(e))},YO=function(e){return e&&e.Math==Math&&e},oi=YO(typeof globalThis=="object"&&globalThis)||YO(typeof window=="object"&&window)||YO(typeof self=="object"&&self)||YO(typeof Zy=="object"&&Zy)||function(){return this}()||Zy||Function("return this")(),bae={exports:{}},tTe=!1,kY=oi,rTe=Object.defineProperty,Q3=function(e,t){try{rTe(kY,e,{value:t,configurable:!0,writable:!0})}catch{kY[e]=t}return t},nTe=oi,iTe=Q3,PY="__core-js_shared__",oTe=nTe[PY]||iTe(PY,{}),eV=oTe,AY=eV;(bae.exports=function(e,t){return AY[e]||(AY[e]=t!==void 0?t:{})})("versions",[]).push({version:"3.30.2",mode:"global",copyright:" 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.30.2/LICENSE",source:"https://github.com/zloirock/core-js"});var qb=bae.exports,aTe=Wa,sTe=Object,Ga=function(e){return sTe(aTe(e))},lTe=sn,uTe=Ga,cTe=lTe({}.hasOwnProperty),ji=Object.hasOwn||function(t,r){return cTe(uTe(t),r)},fTe=sn,hTe=0,dTe=Math.random(),pTe=fTe(1 .toString),OI=function(e){return"Symbol("+(e===void 0?"":e)+")_"+pTe(++hTe+dTe,36)},Pm=typeof navigator<"u"&&String(navigator.userAgent)||"",wae=oi,t2=Pm,IY=wae.process,MY=wae.Deno,$Y=IY&&IY.versions||MY&&MY.version,DY=$Y&&$Y.v8,bl,MP;DY&&(bl=DY.split("."),MP=bl[0]>0&&bl[0]<4?1:+(bl[0]+bl[1]));!MP&&t2&&(bl=t2.match(/Edge\/(\d+)/),(!bl||bl[1]>=74)&&(bl=t2.match(/Chrome\/(\d+)/),bl&&(MP=+bl[1])));var KC=MP,LY=KC,mTe=on,gTe=oi,yTe=gTe.String,Xb=!!Object.getOwnPropertySymbols&&!mTe(function(){var e=Symbol();return!yTe(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&LY&&LY<41}),vTe=Xb,Sae=vTe&&!Symbol.sham&&typeof Symbol.iterator=="symbol",_Te=oi,bTe=qb,NY=ji,wTe=OI,STe=Xb,xTe=Sae,Yy=_Te.Symbol,r2=bTe("wks"),CTe=xTe?Yy.for||Yy:Yy&&Yy.withoutSetter||wTe,pi=function(e){return NY(r2,e)||(r2[e]=STe&&NY(Yy,e)?Yy[e]:CTe("Symbol."+e)),r2[e]},BB=typeof document=="object"&&document.all,ETe=typeof BB>"u"&&BB!==void 0,xae={all:BB,IS_HTMLDDA:ETe},Cae=xae,TTe=Cae.all,bi=Cae.IS_HTMLDDA?function(e){return typeof e=="function"||e===TTe}:function(e){return typeof e=="function"},BY=bi,Eae=xae,OTe=Eae.all,Qi=Eae.IS_HTMLDDA?function(e){return typeof e=="object"?e!==null:BY(e)||e===OTe}:function(e){return typeof e=="object"?e!==null:BY(e)},RTe=Qi,kTe=String,PTe=TypeError,Yi=function(e){if(RTe(e))return e;throw PTe(kTe(e)+" is not an object")},tV={},ATe=on,eo=!ATe(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7}),ITe=eo,MTe=on,Tae=ITe&&MTe(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!=42}),Ca={},$Te=oi,jY=Qi,jB=$Te.document,DTe=jY(jB)&&jY(jB.createElement),RI=function(e){return DTe?jB.createElement(e):{}},LTe=eo,NTe=on,BTe=RI,Oae=!LTe&&!NTe(function(){return Object.defineProperty(BTe("div"),"a",{get:function(){return 7}}).a!=7}),jTe=GC,KO=Function.prototype.call,uo=jTe?KO.bind(KO):function(){return KO.apply(KO,arguments)},n2=oi,FTe=bi,zTe=function(e){return FTe(e)?e:void 0},tf=function(e,t){return arguments.length<2?zTe(n2[e]):n2[e]&&n2[e][t]},HTe=sn,Kh=HTe({}.isPrototypeOf),VTe=tf,UTe=bi,WTe=Kh,GTe=Sae,YTe=Object,qC=GTe?function(e){return typeof e=="symbol"}:function(e){var t=VTe("Symbol");return UTe(t)&&WTe(t.prototype,YTe(e))},KTe=String,Zb=function(e){try{return KTe(e)}catch{return"Object"}},qTe=bi,XTe=Zb,ZTe=TypeError,Am=function(e){if(qTe(e))return e;throw ZTe(XTe(e)+" is not a function")},JTe=Am,QTe=Il,Im=function(e,t){var r=e[t];return QTe(r)?void 0:JTe(r)},i2=uo,o2=bi,a2=Qi,eOe=TypeError,Rae=function(e,t){var r,n;if(t==="string"&&o2(r=e.toString)&&!a2(n=i2(r,e))||o2(r=e.valueOf)&&!a2(n=i2(r,e))||t!=="string"&&o2(r=e.toString)&&!a2(n=i2(r,e)))return n;throw eOe("Can't convert object to primitive value")},tOe=uo,FY=Qi,zY=qC,rOe=Im,nOe=Rae,iOe=pi,oOe=TypeError,aOe=iOe("toPrimitive"),kae=function(e,t){if(!FY(e)||zY(e))return e;var r=rOe(e,aOe),n;if(r){if(t===void 0&&(t="default"),n=tOe(r,e,t),!FY(n)||zY(n))return n;throw oOe("Can't convert object to primitive value")}return t===void 0&&(t="number"),nOe(e,t)},sOe=kae,lOe=qC,kI=function(e){var t=sOe(e,"string");return lOe(t)?t:t+""},uOe=eo,cOe=Oae,fOe=Tae,qO=Yi,HY=kI,hOe=TypeError,s2=Object.defineProperty,dOe=Object.getOwnPropertyDescriptor,l2="enumerable",u2="configurable",c2="writable";Ca.f=uOe?fOe?function(t,r,n){if(qO(t),r=HY(r),qO(n),typeof t=="function"&&r==="prototype"&&"value"in n&&c2 in n&&!n[c2]){var i=dOe(t,r);i&&i[c2]&&(t[r]=n.value,n={configurable:u2 in n?n[u2]:i[u2],enumerable:l2 in n?n[l2]:i[l2],writable:!1})}return s2(t,r,n)}:s2:function(t,r,n){if(qO(t),r=HY(r),qO(n),cOe)try{return s2(t,r,n)}catch{}if("get"in n||"set"in n)throw hOe("Accessors not supported");return"value"in n&&(t[r]=n.value),t};var pOe=Math.ceil,mOe=Math.floor,gOe=Math.trunc||function(t){var r=+t;return(r>0?mOe:pOe)(r)},yOe=gOe,qh=function(e){var t=+e;return t!==t||t===0?0:yOe(t)},vOe=qh,_Oe=Math.max,bOe=Math.min,XC=function(e,t){var r=vOe(e);return r<0?_Oe(r+t,0):bOe(r,t)},wOe=qh,SOe=Math.min,Mm=function(e){return e>0?SOe(wOe(e),9007199254740991):0},xOe=Mm,Ys=function(e){return xOe(e.length)},COe=ys,EOe=XC,TOe=Ys,VY=function(e){return function(t,r,n){var i=COe(t),o=TOe(i),s=EOe(n,o),a;if(e&&r!=r){for(;o>s;)if(a=i[s++],a!=a)return!0}else for(;o>s;s++)if((e||s in i)&&i[s]===r)return e||s||0;return!e&&-1}},rV={includes:VY(!0),indexOf:VY(!1)},ZC={},OOe=sn,f2=ji,ROe=ys,kOe=rV.indexOf,POe=ZC,UY=OOe([].push),Pae=function(e,t){var r=ROe(e),n=0,i=[],o;for(o in r)!f2(POe,o)&&f2(r,o)&&UY(i,o);for(;t.length>n;)f2(r,o=t[n++])&&(~kOe(i,o)||UY(i,o));return i},nV=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],AOe=Pae,IOe=nV,JC=Object.keys||function(t){return AOe(t,IOe)},MOe=eo,$Oe=Tae,DOe=Ca,LOe=Yi,NOe=ys,BOe=JC;tV.f=MOe&&!$Oe?Object.defineProperties:function(t,r){LOe(t);for(var n=NOe(r),i=BOe(r),o=i.length,s=0,a;o>s;)DOe.f(t,a=i[s++],n[a]);return t};var jOe=tf,Aae=jOe("document","documentElement"),FOe=qb,zOe=OI,WY=FOe("keys"),PI=function(e){return WY[e]||(WY[e]=zOe(e))},HOe=Yi,VOe=tV,GY=nV,UOe=ZC,WOe=Aae,GOe=RI,YOe=PI,YY=">",KY="<",FB="prototype",zB="script",Iae=YOe("IE_PROTO"),h2=function(){},Mae=function(e){return KY+zB+YY+e+KY+"/"+zB+YY},qY=function(e){e.write(Mae("")),e.close();var t=e.parentWindow.Object;return e=null,t},KOe=function(){var e=GOe("iframe"),t="java"+zB+":",r;return e.style.display="none",WOe.appendChild(e),e.src=String(t),r=e.contentWindow.document,r.open(),r.write(Mae("document.F=Object")),r.close(),r.F},XO,pk=function(){try{XO=new ActiveXObject("htmlfile")}catch{}pk=typeof document<"u"?document.domain&&XO?qY(XO):KOe():qY(XO);for(var e=GY.length;e--;)delete pk[FB][GY[e]];return pk()};UOe[Iae]=!0;var Jb=Object.create||function(t,r){var n;return t!==null?(h2[FB]=HOe(t),n=new h2,h2[FB]=null,n[Iae]=t):n=pk(),r===void 0?n:VOe.f(n,r)},qOe=pi,XOe=Jb,ZOe=Ca.f,HB=qOe("unscopables"),VB=Array.prototype;VB[HB]==null&&ZOe(VB,HB,{configurable:!0,value:XOe(null)});var QC=function(e){VB[HB][e]=!0},eE={},JOe=oi,QOe=bi,XY=JOe.WeakMap,$ae=QOe(XY)&&/native code/.test(String(XY)),tE=function(e,t){return{enumerable:!(e&1),configurable:!(e&2),writable:!(e&4),value:t}},eRe=eo,tRe=Ca,rRe=tE,$m=eRe?function(e,t,r){return tRe.f(e,t,rRe(1,r))}:function(e,t,r){return e[t]=r,e},nRe=$ae,Dae=oi,iRe=Qi,oRe=$m,d2=ji,p2=eV,aRe=PI,sRe=ZC,ZY="Object already initialized",UB=Dae.TypeError,lRe=Dae.WeakMap,$P,C1,DP,uRe=function(e){return DP(e)?C1(e):$P(e,{})},cRe=function(e){return function(t){var r;if(!iRe(t)||(r=C1(t)).type!==e)throw UB("Incompatible receiver, "+e+" required");return r}};if(nRe||p2.state){var Ql=p2.state||(p2.state=new lRe);Ql.get=Ql.get,Ql.has=Ql.has,Ql.set=Ql.set,$P=function(e,t){if(Ql.has(e))throw UB(ZY);return t.facade=e,Ql.set(e,t),t},C1=function(e){return Ql.get(e)||{}},DP=function(e){return Ql.has(e)}}else{var Kg=aRe("state");sRe[Kg]=!0,$P=function(e,t){if(d2(e,Kg))throw UB(ZY);return t.facade=e,oRe(e,Kg,t),t},C1=function(e){return d2(e,Kg)?e[Kg]:{}},DP=function(e){return d2(e,Kg)}}var rf={set:$P,get:C1,has:DP,enforce:uRe,getterFor:cRe},Ou={},rE={},Lae={}.propertyIsEnumerable,Nae=Object.getOwnPropertyDescriptor,fRe=Nae&&!Lae.call({1:2},1);rE.f=fRe?function(t){var r=Nae(this,t);return!!r&&r.enumerable}:Lae;var hRe=eo,dRe=uo,pRe=rE,mRe=tE,gRe=ys,yRe=kI,vRe=ji,_Re=Oae,JY=Object.getOwnPropertyDescriptor;Ou.f=hRe?JY:function(t,r){if(t=gRe(t),r=yRe(r),_Re)try{return JY(t,r)}catch{}if(vRe(t,r))return mRe(!dRe(pRe.f,t,r),t[r])};var Bae={exports:{}},WB=eo,bRe=ji,jae=Function.prototype,wRe=WB&&Object.getOwnPropertyDescriptor,iV=bRe(jae,"name"),SRe=iV&&function(){}.name==="something",xRe=iV&&(!WB||WB&&wRe(jae,"name").configurable),nE={EXISTS:iV,PROPER:SRe,CONFIGURABLE:xRe},CRe=sn,ERe=bi,GB=eV,TRe=CRe(Function.toString);ERe(GB.inspectSource)||(GB.inspectSource=function(e){return TRe(e)});var Fae=GB.inspectSource,oV=sn,ORe=on,RRe=bi,ZO=ji,YB=eo,kRe=nE.CONFIGURABLE,PRe=Fae,zae=rf,ARe=zae.enforce,IRe=zae.get,QY=String,mk=Object.defineProperty,MRe=oV("".slice),$Re=oV("".replace),DRe=oV([].join),LRe=YB&&!ORe(function(){return mk(function(){},"length",{value:8}).length!==8}),NRe=String(String).split("String"),BRe=Bae.exports=function(e,t,r){MRe(QY(t),0,7)==="Symbol("&&(t="["+$Re(QY(t),/^Symbol\(([^)]*)\)/,"$1")+"]"),r&&r.getter&&(t="get "+t),r&&r.setter&&(t="set "+t),(!ZO(e,"name")||kRe&&e.name!==t)&&(YB?mk(e,"name",{value:t,configurable:!0}):e.name=t),LRe&&r&&ZO(r,"arity")&&e.length!==r.arity&&mk(e,"length",{value:r.arity});try{r&&ZO(r,"constructor")&&r.constructor?YB&&mk(e,"prototype",{writable:!1}):e.prototype&&(e.prototype=void 0)}catch{}var n=ARe(e);return ZO(n,"source")||(n.source=DRe(NRe,typeof t=="string"?t:"")),e};Function.prototype.toString=BRe(function(){return RRe(this)&&IRe(this).source||PRe(this)},"toString");var Hae=Bae.exports,jRe=bi,FRe=Ca,zRe=Hae,HRe=Q3,Ks=function(e,t,r,n){n||(n={});var i=n.enumerable,o=n.name!==void 0?n.name:t;if(jRe(r)&&zRe(r,o,n),n.global)i?e[t]=r:HRe(t,r);else{try{n.unsafe?e[t]&&(i=!0):delete e[t]}catch{}i?e[t]=r:FRe.f(e,t,{value:r,enumerable:!1,configurable:!n.nonConfigurable,writable:!n.nonWritable})}return e},Dm={},VRe=Pae,URe=nV,WRe=URe.concat("length","prototype");Dm.f=Object.getOwnPropertyNames||function(t){return VRe(t,WRe)};var iE={};iE.f=Object.getOwnPropertySymbols;var GRe=tf,YRe=sn,KRe=Dm,qRe=iE,XRe=Yi,ZRe=YRe([].concat),Vae=GRe("Reflect","ownKeys")||function(t){var r=KRe.f(XRe(t)),n=qRe.f;return n?ZRe(r,n(t)):r},eK=ji,JRe=Vae,QRe=Ou,eke=Ca,Uae=function(e,t,r){for(var n=JRe(t),i=eke.f,o=QRe.f,s=0;s<n.length;s++){var a=n[s];!eK(e,a)&&!(r&&eK(r,a))&&i(e,a,o(t,a))}},tke=on,rke=bi,nke=/#|\.prototype\./,oE=function(e,t){var r=oke[ike(e)];return r==ske?!0:r==ake?!1:rke(t)?tke(t):!!t},ike=oE.normalize=function(e){return String(e).replace(nke,".").toLowerCase()},oke=oE.data={},ake=oE.NATIVE="N",ske=oE.POLYFILL="P",AI=oE,m2=oi,lke=Ou.f,uke=$m,cke=Ks,fke=Q3,hke=Uae,dke=AI,jr=function(e,t){var r=e.target,n=e.global,i=e.stat,o,s,a,h,p,y;if(n?s=m2:i?s=m2[r]||fke(r,{}):s=(m2[r]||{}).prototype,s)for(a in t){if(p=t[a],e.dontCallGetSet?(y=lke(s,a),h=y&&y.value):h=s[a],o=dke(n?a:r+(i?".":"#")+a,e.forced),!o&&h!==void 0){if(typeof p==typeof h)continue;hke(p,h)}(e.sham||h&&h.sham)&&uke(p,"sham",!0),cke(s,a,p,e)}},pke=on,Wae=!pke(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}),mke=ji,gke=bi,yke=Ga,vke=PI,_ke=Wae,tK=vke("IE_PROTO"),KB=Object,bke=KB.prototype,II=_ke?KB.getPrototypeOf:function(e){var t=yke(e);if(mke(t,tK))return t[tK];var r=t.constructor;return gke(r)&&t instanceof r?r.prototype:t instanceof KB?bke:null},wke=on,Ske=bi,xke=Qi,rK=II,Cke=Ks,Eke=pi,qB=Eke("iterator"),Gae=!1,um,g2,y2;[].keys&&(y2=[].keys(),"next"in y2?(g2=rK(rK(y2)),g2!==Object.prototype&&(um=g2)):Gae=!0);var Tke=!xke(um)||wke(function(){var e={};return um[qB].call(e)!==e});Tke&&(um={});Ske(um[qB])||Cke(um,qB,function(){return this});var Yae={IteratorPrototype:um,BUGGY_SAFARI_ITERATORS:Gae},Oke=Ca.f,Rke=ji,kke=pi,nK=kke("toStringTag"),MI=function(e,t,r){e&&!r&&(e=e.prototype),e&&!Rke(e,nK)&&Oke(e,nK,{configurable:!0,value:t})},Pke=Yae.IteratorPrototype,Ake=Jb,Ike=tE,Mke=MI,$ke=eE,Dke=function(){return this},Lke=function(e,t,r,n){var i=t+" Iterator";return e.prototype=Ake(Pke,{next:Ike(+!n,r)}),Mke(e,i,!1),$ke[i]=Dke,e},Nke=sn,Bke=Am,jke=function(e,t,r){try{return Nke(Bke(Object.getOwnPropertyDescriptor(e,t)[r]))}catch{}},Fke=bi,zke=String,Hke=TypeError,Vke=function(e){if(typeof e=="object"||Fke(e))return e;throw Hke("Can't set "+zke(e)+" as a prototype")},Uke=jke,Wke=Yi,Gke=Vke,aV=Object.setPrototypeOf||("__proto__"in{}?function(){var e=!1,t={},r;try{r=Uke(Object.prototype,"__proto__","set"),r(t,[]),e=t instanceof Array}catch{}return function(i,o){return Wke(i),Gke(o),e?r(i,o):i.__proto__=o,i}}():void 0),Yke=jr,Kke=uo,Kae=nE,qke=bi,Xke=Lke,iK=II,oK=aV,Zke=MI,Jke=$m,v2=Ks,Qke=pi,ePe=eE,qae=Yae,tPe=Kae.PROPER,rPe=Kae.CONFIGURABLE,aK=qae.IteratorPrototype,JO=qae.BUGGY_SAFARI_ITERATORS,H0=Qke("iterator"),sK="keys",V0="values",lK="entries",nPe=function(){return this},sV=function(e,t,r,n,i,o,s){Xke(r,t,n);var a=function(j){if(j===i&&E)return E;if(!JO&&j in y)return y[j];switch(j){case sK:return function(){return new r(this,j)};case V0:return function(){return new r(this,j)};case lK:return function(){return new r(this,j)}}return function(){return new r(this)}},h=t+" Iterator",p=!1,y=e.prototype,S=y[H0]||y["@@iterator"]||i&&y[i],E=!JO&&S||a(i),O=t=="Array"&&y.entries||S,A,$,B;if(O&&(A=iK(O.call(new e)),A!==Object.prototype&&A.next&&(iK(A)!==aK&&(oK?oK(A,aK):qke(A[H0])||v2(A,H0,nPe)),Zke(A,h,!0))),tPe&&i==V0&&S&&S.name!==V0&&(rPe?Jke(y,"name",V0):(p=!0,E=function(){return Kke(S,this)})),i)if($={values:a(V0),keys:o?E:a(sK),entries:a(lK)},s)for(B in $)(JO||p||!(B in y))&&v2(y,B,$[B]);else Yke({target:t,proto:!0,forced:JO||p},$);return y[H0]!==E&&v2(y,H0,E,{name:i}),ePe[t]=E,$},lV=function(e,t){return{value:e,done:t}},iPe=ys,uV=QC,uK=eE,Xae=rf,oPe=Ca.f,aPe=sV,QO=lV,sPe=eo,Zae="Array Iterator",lPe=Xae.set,uPe=Xae.getterFor(Zae),cPe=aPe(Array,"Array",function(e,t){lPe(this,{type:Zae,target:iPe(e),index:0,kind:t})},function(){var e=uPe(this),t=e.target,r=e.kind,n=e.index++;return!t||n>=t.length?(e.target=void 0,QO(void 0,!0)):r=="keys"?QO(n,!1):r=="values"?QO(t[n],!1):QO([n,t[n]],!1)},"values"),cK=uK.Arguments=uK.Array;uV("keys");uV("values");uV("entries");if(sPe&&cK.name!=="values")try{oPe(cK,"name",{value:"values"})}catch{}var fPe=pi,hPe=fPe("toStringTag"),Jae={};Jae[hPe]="z";var cV=String(Jae)==="[object z]",dPe=cV,pPe=bi,gk=Tu,mPe=pi,gPe=mPe("toStringTag"),yPe=Object,vPe=gk(function(){return arguments}())=="Arguments",_Pe=function(e,t){try{return e[t]}catch{}},$I=dPe?gk:function(e){var t,r,n;return e===void 0?"Undefined":e===null?"Null":typeof(r=_Pe(t=yPe(e),gPe))=="string"?r:vPe?gk(t):(n=gk(t))=="Object"&&pPe(t.callee)?"Arguments":n},bPe=cV,wPe=$I,SPe=bPe?{}.toString:function(){return"[object "+wPe(this)+"]"},xPe=cV,CPe=Ks,EPe=SPe;xPe||CPe(Object.prototype,"toString",EPe,{unsafe:!0});var TPe=$I,OPe=String,to=function(e){if(TPe(e)==="Symbol")throw TypeError("Cannot convert a Symbol value to a string");return OPe(e)},fV=sn,RPe=qh,kPe=to,PPe=Wa,APe=fV("".charAt),fK=fV("".charCodeAt),IPe=fV("".slice),hK=function(e){return function(t,r){var n=kPe(PPe(t)),i=RPe(r),o=n.length,s,a;return i<0||i>=o?e?"":void 0:(s=fK(n,i),s<55296||s>56319||i+1===o||(a=fK(n,i+1))<56320||a>57343?e?APe(n,i):s:e?IPe(n,i,i+2):(s-55296<<10)+(a-56320)+65536)}},hV={codeAt:hK(!1),charAt:hK(!0)},MPe=hV.charAt,$Pe=to,Qae=rf,DPe=sV,dK=lV,ese="String Iterator",LPe=Qae.set,NPe=Qae.getterFor(ese);DPe(String,"String",function(e){LPe(this,{type:ese,string:$Pe(e),index:0})},function(){var t=NPe(this),r=t.string,n=t.index,i;return n>=r.length?dK(void 0,!0):(i=MPe(r,n),t.index+=i.length,dK(i,!1))});var BPe=on,dV=!BPe(function(){return Object.isExtensible(Object.preventExtensions({}))}),jPe=Ks,pV=function(e,t,r){for(var n in t)jPe(e,n,t[n],r);return e},tse={exports:{}},mV={},FPe=kI,zPe=Ca,HPe=tE,Qb=function(e,t,r){var n=FPe(t);n in e?zPe.f(e,n,HPe(0,r)):e[n]=r},pK=XC,VPe=Ys,UPe=Qb,WPe=Array,GPe=Math.max,gV=function(e,t,r){for(var n=VPe(e),i=pK(t,n),o=pK(r===void 0?n:r,n),s=WPe(GPe(o-i,0)),a=0;i<o;i++,a++)UPe(s,a,e[i]);return s.length=a,s},YPe=Tu,KPe=ys,rse=Dm.f,qPe=gV,nse=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],XPe=function(e){try{return rse(e)}catch{return qPe(nse)}};mV.f=function(t){return nse&&YPe(t)=="Window"?XPe(t):rse(KPe(t))};var ZPe=on,JPe=ZPe(function(){if(typeof ArrayBuffer=="function"){var e=new ArrayBuffer(8);Object.isExtensible(e)&&Object.defineProperty(e,"a",{value:8})}}),QPe=on,eAe=Qi,tAe=Tu,mK=JPe,yk=Object.isExtensible,rAe=QPe(function(){yk(1)}),nAe=rAe||mK?function(t){return!eAe(t)||mK&&tAe(t)=="ArrayBuffer"?!1:yk?yk(t):!0}:yk,iAe=jr,oAe=sn,aAe=ZC,sAe=Qi,yV=ji,lAe=Ca.f,gK=Dm,uAe=mV,vV=nAe,cAe=OI,fAe=dV,ise=!1,Kc=cAe("meta"),hAe=0,_V=function(e){lAe(e,Kc,{value:{objectID:"O"+hAe++,weakData:{}}})},dAe=function(e,t){if(!sAe(e))return typeof e=="symbol"?e:(typeof e=="string"?"S":"P")+e;if(!yV(e,Kc)){if(!vV(e))return"F";if(!t)return"E";_V(e)}return e[Kc].objectID},pAe=function(e,t){if(!yV(e,Kc)){if(!vV(e))return!0;if(!t)return!1;_V(e)}return e[Kc].weakData},mAe=function(e){return fAe&&ise&&vV(e)&&!yV(e,Kc)&&_V(e),e},gAe=function(){yAe.enable=function(){},ise=!0;var e=gK.f,t=oAe([].splice),r={};r[Kc]=1,e(r).length&&(gK.f=function(n){for(var i=e(n),o=0,s=i.length;o<s;o++)if(i[o]===Kc){t(i,o,1);break}return i},iAe({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:uAe.f}))},yAe=tse.exports={enable:gAe,fastKey:dAe,getWeakData:pAe,onFreeze:mAe};aAe[Kc]=!0;var aE=tse.exports,vAe=Tu,_Ae=sn,sE=function(e){if(vAe(e)==="Function")return _Ae(e)},yK=sE,bAe=Am,wAe=GC,SAe=yK(yK.bind),lE=function(e,t){return bAe(e),t===void 0?e:wAe?SAe(e,t):function(){return e.apply(t,arguments)}},xAe=pi,CAe=eE,EAe=xAe("iterator"),TAe=Array.prototype,ose=function(e){return e!==void 0&&(CAe.Array===e||TAe[EAe]===e)},OAe=$I,vK=Im,RAe=Il,kAe=eE,PAe=pi,AAe=PAe("iterator"),bV=function(e){if(!RAe(e))return vK(e,AAe)||vK(e,"@@iterator")||kAe[OAe(e)]},IAe=uo,MAe=Am,$Ae=Yi,DAe=Zb,LAe=bV,NAe=TypeError,ase=function(e,t){var r=arguments.length<2?LAe(e):t;if(MAe(r))return $Ae(IAe(r,e));throw NAe(DAe(e)+" is not iterable")},BAe=uo,_K=Yi,jAe=Im,sse=function(e,t,r){var n,i;_K(e);try{if(n=jAe(e,"return"),!n){if(t==="throw")throw r;return r}n=BAe(n,e)}catch(o){i=!0,n=o}if(t==="throw")throw r;if(i)throw n;return _K(n),r},FAe=lE,zAe=uo,HAe=Yi,VAe=Zb,UAe=ose,WAe=Ys,bK=Kh,GAe=ase,YAe=bV,wK=sse,KAe=TypeError,vk=function(e,t){this.stopped=e,this.result=t},SK=vk.prototype,wV=function(e,t,r){var n=r&&r.that,i=!!(r&&r.AS_ENTRIES),o=!!(r&&r.IS_RECORD),s=!!(r&&r.IS_ITERATOR),a=!!(r&&r.INTERRUPTED),h=FAe(t,n),p,y,S,E,O,A,$,B=function(z){return p&&wK(p,"normal",z),new vk(!0,z)},j=function(z){return i?(HAe(z),a?h(z[0],z[1],B):h(z[0],z[1])):a?h(z,B):h(z)};if(o)p=e.iterator;else if(s)p=e;else{if(y=YAe(e),!y)throw KAe(VAe(e)+" is not iterable");if(UAe(y)){for(S=0,E=WAe(e);E>S;S++)if(O=j(e[S]),O&&bK(SK,O))return O;return new vk(!1)}p=GAe(e,y)}for(A=o?e.next:p.next;!($=zAe(A,p)).done;){try{O=j($.value)}catch(z){wK(p,"throw",z)}if(typeof O=="object"&&O&&bK(SK,O))return O}return new vk(!1)},qAe=Kh,XAe=TypeError,SV=function(e,t){if(qAe(t,e))return e;throw XAe("Incorrect invocation")},ZAe=pi,lse=ZAe("iterator"),use=!1;try{var JAe=0,xK={next:function(){return{done:!!JAe++}},return:function(){use=!0}};xK[lse]=function(){return this},Array.from(xK,function(){throw 2})}catch{}var cse=function(e,t){if(!t&&!use)return!1;var r=!1;try{var n={};n[lse]=function(){return{next:function(){return{done:r=!0}}}},e(n)}catch{}return r},QAe=bi,eIe=Qi,CK=aV,xV=function(e,t,r){var n,i;return CK&&QAe(n=t.constructor)&&n!==r&&eIe(i=n.prototype)&&i!==r.prototype&&CK(e,i),e},tIe=jr,rIe=oi,nIe=sn,EK=AI,iIe=Ks,oIe=aE,aIe=wV,sIe=SV,lIe=bi,uIe=Il,_2=Qi,b2=on,cIe=cse,fIe=MI,hIe=xV,DI=function(e,t,r){var n=e.indexOf("Map")!==-1,i=e.indexOf("Weak")!==-1,o=n?"set":"add",s=rIe[e],a=s&&s.prototype,h=s,p={},y=function(j){var z=nIe(a[j]);iIe(a,j,j=="add"?function(Q){return z(this,Q===0?0:Q),this}:j=="delete"?function(W){return i&&!_2(W)?!1:z(this,W===0?0:W)}:j=="get"?function(Q){return i&&!_2(Q)?void 0:z(this,Q===0?0:Q)}:j=="has"?function(Q){return i&&!_2(Q)?!1:z(this,Q===0?0:Q)}:function(Q,q){return z(this,Q===0?0:Q,q),this})},S=EK(e,!lIe(s)||!(i||a.forEach&&!b2(function(){new s().entries().next()})));if(S)h=r.getConstructor(t,e,n,o),oIe.enable();else if(EK(e,!0)){var E=new h,O=E[o](i?{}:-0,1)!=E,A=b2(function(){E.has(1)}),$=cIe(function(j){new s(j)}),B=!i&&b2(function(){for(var j=new s,z=5;z--;)j[o](z,z);return!j.has(-0)});$||(h=t(function(j,z){sIe(j,a);var W=hIe(new s,j,h);return uIe(z)||aIe(z,W[o],{that:W,AS_ENTRIES:n}),W}),h.prototype=a,a.constructor=h),(A||B)&&(y("delete"),y("has"),n&&y("get")),(B||O)&&y(o),i&&a.clear&&delete a.clear}return p[e]=h,tIe({global:!0,constructor:!0,forced:h!=s},p),fIe(h,e),i||r.setStrong(h,e,n),h},dIe=Tu,ew=Array.isArray||function(t){return dIe(t)=="Array"},pIe=sn,mIe=on,fse=bi,gIe=$I,yIe=tf,vIe=Fae,hse=function(){},_Ie=[],dse=yIe("Reflect","construct"),CV=/^\s*(?:class|function)\b/,bIe=pIe(CV.exec),wIe=!CV.exec(hse),U0=function(t){if(!fse(t))return!1;try{return dse(hse,_Ie,t),!0}catch{return!1}},pse=function(t){if(!fse(t))return!1;switch(gIe(t)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return wIe||!!bIe(CV,vIe(t))}catch{return!0}};pse.sham=!0;var LI=!dse||mIe(function(){var e;return U0(U0.call)||!U0(Object)||!U0(function(){e=!0})||e})?pse:U0,TK=ew,SIe=LI,xIe=Qi,CIe=pi,EIe=CIe("species"),OK=Array,TIe=function(e){var t;return TK(e)&&(t=e.constructor,SIe(t)&&(t===OK||TK(t.prototype))?t=void 0:xIe(t)&&(t=t[EIe],t===null&&(t=void 0))),t===void 0?OK:t},OIe=TIe,EV=function(e,t){return new(OIe(e))(t===0?0:t)},RIe=lE,kIe=sn,PIe=YC,AIe=Ga,IIe=Ys,MIe=EV,RK=kIe([].push),Hf=function(e){var t=e==1,r=e==2,n=e==3,i=e==4,o=e==6,s=e==7,a=e==5||o;return function(h,p,y,S){for(var E=AIe(h),O=PIe(E),A=RIe(p,y),$=IIe(O),B=0,j=S||MIe,z=t?j(h,$):r||s?j(h,0):void 0,W,Q;$>B;B++)if((a||B in O)&&(W=O[B],Q=A(W,B,E),e))if(t)z[B]=Q;else if(Q)switch(e){case 3:return!0;case 5:return W;case 6:return B;case 2:RK(z,W)}else switch(e){case 4:return!1;case 7:RK(z,W)}return o?-1:n||i?i:z}},Lm={forEach:Hf(0),map:Hf(1),filter:Hf(2),some:Hf(3),every:Hf(4),find:Hf(5),findIndex:Hf(6),filterReject:Hf(7)},$Ie=sn,kK=pV,eR=aE.getWeakData,DIe=SV,LIe=Yi,NIe=Il,w2=Qi,BIe=wV,mse=Lm,PK=ji,gse=rf,jIe=gse.set,FIe=gse.getterFor,zIe=mse.find,HIe=mse.findIndex,VIe=$Ie([].splice),UIe=0,tR=function(e){return e.frozen||(e.frozen=new yse)},yse=function(){this.entries=[]},S2=function(e,t){return zIe(e.entries,function(r){return r[0]===t})};yse.prototype={get:function(e){var t=S2(this,e);if(t)return t[1]},has:function(e){return!!S2(this,e)},set:function(e,t){var r=S2(this,e);r?r[1]=t:this.entries.push([e,t])},delete:function(e){var t=HIe(this.entries,function(r){return r[0]===e});return~t&&VIe(this.entries,t,1),!!~t}};var vse={getConstructor:function(e,t,r,n){var i=e(function(h,p){DIe(h,o),jIe(h,{type:t,id:UIe++,frozen:void 0}),NIe(p)||BIe(p,h[n],{that:h,AS_ENTRIES:r})}),o=i.prototype,s=FIe(t),a=function(h,p,y){var S=s(h),E=eR(LIe(p),!0);return E===!0?tR(S).set(p,y):E[S.id]=y,h};return kK(o,{delete:function(h){var p=s(this);if(!w2(h))return!1;var y=eR(h);return y===!0?tR(p).delete(h):y&&PK(y,p.id)&&delete y[p.id]},has:function(p){var y=s(this);if(!w2(p))return!1;var S=eR(p);return S===!0?tR(y).has(p):S&&PK(S,y.id)}}),kK(o,r?{get:function(p){var y=s(this);if(w2(p)){var S=eR(p);return S===!0?tR(y).get(p):S?S[y.id]:void 0}},set:function(p,y){return a(this,p,y)}}:{add:function(p){return a(this,p,!0)}}),i}},WIe=dV,AK=oi,_k=sn,IK=pV,GIe=aE,YIe=DI,_se=vse,rR=Qi,nR=rf.enforce,KIe=on,qIe=$ae,uE=Object,XIe=Array.isArray,iR=uE.isExtensible,bse=uE.isFrozen,ZIe=uE.isSealed,wse=uE.freeze,JIe=uE.seal,MK={},$K={},QIe=!AK.ActiveXObject&&"ActiveXObject"in AK,W0,Sse=function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},xse=YIe("WeakMap",Sse,_se),ky=xse.prototype,bk=_k(ky.set),eMe=function(){return WIe&&KIe(function(){var e=wse([]);return bk(new xse,e,1),!bse(e)})};if(qIe)if(QIe){W0=_se.getConstructor(Sse,"WeakMap",!0),GIe.enable();var DK=_k(ky.delete),oR=_k(ky.has),LK=_k(ky.get);IK(ky,{delete:function(e){if(rR(e)&&!iR(e)){var t=nR(this);return t.frozen||(t.frozen=new W0),DK(this,e)||t.frozen.delete(e)}return DK(this,e)},has:function(t){if(rR(t)&&!iR(t)){var r=nR(this);return r.frozen||(r.frozen=new W0),oR(this,t)||r.frozen.has(t)}return oR(this,t)},get:function(t){if(rR(t)&&!iR(t)){var r=nR(this);return r.frozen||(r.frozen=new W0),oR(this,t)?LK(this,t):r.frozen.get(t)}return LK(this,t)},set:function(t,r){if(rR(t)&&!iR(t)){var n=nR(this);n.frozen||(n.frozen=new W0),oR(this,t)?bk(this,t,r):n.frozen.set(t,r)}else bk(this,t,r);return this}})}else eMe()&&IK(ky,{set:function(t,r){var n;return XIe(t)&&(bse(t)?n=MK:ZIe(t)&&(n=$K)),bk(this,t,r),n==MK&&wse(t),n==$K&&JIe(t),this}});var Cse={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},tMe=RI,x2=tMe("span").classList,NK=x2&&x2.constructor&&x2.constructor.prototype,Ese=NK===Object.prototype?void 0:NK,BK=oi,Tse=Cse,rMe=Ese,SS=cPe,C2=$m,Ose=pi,E2=Ose("iterator"),jK=Ose("toStringTag"),T2=SS.values,Rse=function(e,t){if(e){if(e[E2]!==T2)try{C2(e,E2,T2)}catch{e[E2]=T2}if(e[jK]||C2(e,jK,t),Tse[t]){for(var r in SS)if(e[r]!==SS[r])try{C2(e,r,SS[r])}catch{e[r]=SS[r]}}}};for(var O2 in Tse)Rse(BK[O2]&&BK[O2].prototype,O2);Rse(rMe,"DOMTokenList");var nMe=on,tw=function(e,t){var r=[][e];return!!r&&nMe(function(){r.call(null,t||function(){return 1},1)})},iMe=jr,oMe=sE,aMe=rV.indexOf,sMe=tw,XB=oMe([].indexOf),kse=!!XB&&1/XB([1],1,-0)<0,lMe=kse||!sMe("indexOf");iMe({target:"Array",proto:!0,forced:lMe},{indexOf:function(t){var r=arguments.length>1?arguments[1]:void 0;return kse?XB(this,t,r)||0:aMe(this,t,r)}});var FK=Zb,uMe=TypeError,Pse=function(e,t){if(!delete e[t])throw uMe("Cannot delete property "+FK(t)+" of "+FK(e))},zK=gV,cMe=Math.floor,ZB=function(e,t){var r=e.length,n=cMe(r/2);return r<8?fMe(e,t):hMe(e,ZB(zK(e,0,n),t),ZB(zK(e,n),t),t)},fMe=function(e,t){for(var r=e.length,n=1,i,o;n<r;){for(o=n,i=e[n];o&&t(e[o-1],i)>0;)e[o]=e[--o];o!==n++&&(e[o]=i)}return e},hMe=function(e,t,r,n){for(var i=t.length,o=r.length,s=0,a=0;s<i||a<o;)e[s+a]=s<i&&a<o?n(t[s],r[a])<=0?t[s++]:r[a++]:s<i?t[s++]:r[a++];return e},dMe=ZB,pMe=Pm,HK=pMe.match(/firefox\/(\d+)/i),mMe=!!HK&&+HK[1],gMe=Pm,yMe=/MSIE|Trident/.test(gMe),vMe=Pm,VK=vMe.match(/AppleWebKit\/(\d+)\./),_Me=!!VK&&+VK[1],bMe=jr,Ase=sn,wMe=Am,SMe=Ga,UK=Ys,xMe=Pse,WK=to,TV=on,CMe=dMe,EMe=tw,GK=mMe,TMe=yMe,YK=KC,KK=_Me,lh=[],qK=Ase(lh.sort),OMe=Ase(lh.push),RMe=TV(function(){lh.sort(void 0)}),kMe=TV(function(){lh.sort(null)}),PMe=EMe("sort"),Ise=!TV(function(){if(YK)return YK<70;if(!(GK&&GK>3)){if(TMe)return!0;if(KK)return KK<603;var e="",t,r,n,i;for(t=65;t<76;t++){switch(r=String.fromCharCode(t),t){case 66:case 69:case 70:case 72:n=3;break;case 68:case 71:n=4;break;default:n=2}for(i=0;i<47;i++)lh.push({k:r+i,v:n})}for(lh.sort(function(o,s){return s.v-o.v}),i=0;i<lh.length;i++)r=lh[i].k.charAt(0),e.charAt(e.length-1)!==r&&(e+=r);return e!=="DGBEFHACIJK"}}),AMe=RMe||!kMe||!PMe||!Ise,IMe=function(e){return function(t,r){return r===void 0?-1:t===void 0?1:e!==void 0?+e(t,r)||0:WK(t)>WK(r)?1:-1}};bMe({target:"Array",proto:!0,forced:AMe},{sort:function(t){t!==void 0&&wMe(t);var r=SMe(this);if(Ise)return t===void 0?qK(r):qK(r,t);var n=[],i=UK(r),o,s;for(s=0;s<i;s++)s in r&&OMe(n,r[s]);for(CMe(n,IMe(t)),o=UK(n),s=0;s<o;)r[s]=n[s++];for(;s<i;)xMe(r,s++);return r}});var MMe=jr,$Me=Lm.find,DMe=QC,JB="find",Mse=!0;JB in[]&&Array(1)[JB](function(){Mse=!1});MMe({target:"Array",proto:!0,forced:Mse},{find:function(t){return $Me(this,t,arguments.length>1?arguments[1]:void 0)}});DMe(JB);var LMe=Yi,$se=function(){var e=LMe(this),t="";return e.hasIndices&&(t+="d"),e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.unicodeSets&&(t+="v"),e.sticky&&(t+="y"),t},OV=on,NMe=oi,RV=NMe.RegExp,kV=OV(function(){var e=RV("a","y");return e.lastIndex=2,e.exec("abcd")!=null}),BMe=kV||OV(function(){return!RV("a","y").sticky}),jMe=kV||OV(function(){var e=RV("^r","gy");return e.lastIndex=2,e.exec("str")!=null}),PV={BROKEN_CARET:jMe,MISSED_STICKY:BMe,UNSUPPORTED_Y:kV},FMe=on,zMe=oi,HMe=zMe.RegExp,Dse=FMe(function(){var e=HMe(".","s");return!(e.dotAll&&e.exec(`
`)&&e.flags==="s")}),VMe=on,UMe=oi,WMe=UMe.RegExp,Lse=VMe(function(){var e=WMe("(?<a>b)","g");return e.exec("b").groups.a!=="b"||"b".replace(e,"$<a>c")!=="bc"}),Ky=uo,NI=sn,GMe=to,YMe=$se,KMe=PV,qMe=qb,XMe=Jb,ZMe=rf.get,JMe=Dse,QMe=Lse,e$e=qMe("native-string-replace",String.prototype.replace),LP=RegExp.prototype.exec,QB=LP,t$e=NI("".charAt),r$e=NI("".indexOf),n$e=NI("".replace),R2=NI("".slice),ej=function(){var e=/a/,t=/b*/g;return Ky(LP,e,"a"),Ky(LP,t,"a"),e.lastIndex!==0||t.lastIndex!==0}(),Nse=KMe.BROKEN_CARET,tj=/()??/.exec("")[1]!==void 0,i$e=ej||tj||Nse||JMe||QMe;i$e&&(QB=function(t){var r=this,n=ZMe(r),i=GMe(t),o=n.raw,s,a,h,p,y,S,E;if(o)return o.lastIndex=r.lastIndex,s=Ky(QB,o,i),r.lastIndex=o.lastIndex,s;var O=n.groups,A=Nse&&r.sticky,$=Ky(YMe,r),B=r.source,j=0,z=i;if(A&&($=n$e($,"y",""),r$e($,"g")===-1&&($+="g"),z=R2(i,r.lastIndex),r.lastIndex>0&&(!r.multiline||r.multiline&&t$e(i,r.lastIndex-1)!==`
`)&&(B="(?: "+B+")",z=" "+z,j++),a=new RegExp("^(?:"+B+")",$)),tj&&(a=new RegExp("^"+B+"$(?!\\s)",$)),ej&&(h=r.lastIndex),p=Ky(LP,A?a:r,z),A?p?(p.input=R2(p.input,j),p[0]=R2(p[0],j),p.index=r.lastIndex,r.lastIndex+=p[0].length):r.lastIndex=0:ej&&p&&(r.lastIndex=r.global?p.index+p[0].length:h),tj&&p&&p.length>1&&Ky(e$e,p[0],a,function(){for(y=1;y<arguments.length-2;y++)arguments[y]===void 0&&(p[y]=void 0)}),p&&O)for(p.groups=S=XMe(null),y=0;y<O.length;y++)E=O[y],S[E[0]]=p[E[1]];return p});var BI=QB,o$e=jr,XK=BI;o$e({target:"RegExp",proto:!0,forced:/./.exec!==XK},{exec:XK});var a$e=GC,Bse=Function.prototype,ZK=Bse.apply,JK=Bse.call,Nm=typeof Reflect=="object"&&Reflect.apply||(a$e?JK.bind(ZK):function(){return JK.apply(ZK,arguments)}),QK=sE,eq=Ks,s$e=BI,tq=on,jse=pi,l$e=$m,u$e=jse("species"),k2=RegExp.prototype,jI=function(e,t,r,n){var i=jse(e),o=!tq(function(){var p={};return p[i]=function(){return 7},""[e](p)!=7}),s=o&&!tq(function(){var p=!1,y=/a/;return e==="split"&&(y={},y.constructor={},y.constructor[u$e]=function(){return y},y.flags="",y[i]=/./[i]),y.exec=function(){return p=!0,null},y[i](""),!p});if(!o||!s||r){var a=QK(/./[i]),h=t(i,""[e],function(p,y,S,E,O){var A=QK(p),$=y.exec;return $===s$e||$===k2.exec?o&&!O?{done:!0,value:a(y,S,E)}:{done:!0,value:A(S,y,E)}:{done:!1}});eq(String.prototype,e,h[0]),eq(k2,i,h[1])}n&&l$e(k2[i],"sham",!0)},c$e=hV.charAt,AV=function(e,t,r){return t+(r?c$e(e,t).length:1)},IV=sn,f$e=Ga,h$e=Math.floor,P2=IV("".charAt),d$e=IV("".replace),A2=IV("".slice),p$e=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,m$e=/\$([$&'`]|\d{1,2})/g,g$e=function(e,t,r,n,i,o){var s=r+e.length,a=n.length,h=m$e;return i!==void 0&&(i=f$e(i),h=p$e),d$e(o,h,function(p,y){var S;switch(P2(y,0)){case"$":return"$";case"&":return e;case"`":return A2(t,0,r);case"'":return A2(t,s);case"<":S=i[A2(y,1,-1)];break;default:var E=+y;if(E===0)return p;if(E>a){var O=h$e(E/10);return O===0?p:O<=a?n[O-1]===void 0?P2(y,1):n[O-1]+P2(y,1):p}S=n[E-1]}return S===void 0?"":S})},rq=uo,y$e=Yi,v$e=bi,_$e=Tu,b$e=BI,w$e=TypeError,FI=function(e,t){var r=e.exec;if(v$e(r)){var n=rq(r,e,t);return n!==null&&y$e(n),n}if(_$e(e)==="RegExp")return rq(b$e,e,t);throw w$e("RegExp#exec called on incompatible receiver")},S$e=Nm,nq=uo,zI=sn,x$e=jI,C$e=on,E$e=Yi,T$e=bi,O$e=Il,R$e=qh,k$e=Mm,qg=to,P$e=Wa,A$e=AV,I$e=Im,M$e=g$e,$$e=FI,D$e=pi,rj=D$e("replace"),L$e=Math.max,N$e=Math.min,B$e=zI([].concat),I2=zI([].push),iq=zI("".indexOf),oq=zI("".slice),j$e=function(e){return e===void 0?e:String(e)},F$e=function(){return"a".replace(/./,"$0")==="$0"}(),aq=function(){return/./[rj]?/./[rj]("a","$0")==="":!1}(),z$e=!C$e(function(){var e=/./;return e.exec=function(){var t=[];return t.groups={a:"7"},t},"".replace(e,"$<a>")!=="7"});x$e("replace",function(e,t,r){var n=aq?"$":"$0";return[function(o,s){var a=P$e(this),h=O$e(o)?void 0:I$e(o,rj);return h?nq(h,o,a,s):nq(t,qg(a),o,s)},function(i,o){var s=E$e(this),a=qg(i);if(typeof o=="string"&&iq(o,n)===-1&&iq(o,"$<")===-1){var h=r(t,s,a,o);if(h.done)return h.value}var p=T$e(o);p||(o=qg(o));var y=s.global;if(y){var S=s.unicode;s.lastIndex=0}for(var E=[];;){var O=$$e(s,a);if(O===null||(I2(E,O),!y))break;var A=qg(O[0]);A===""&&(s.lastIndex=A$e(a,k$e(s.lastIndex),S))}for(var $="",B=0,j=0;j<E.length;j++){O=E[j];for(var z=qg(O[0]),W=L$e(N$e(R$e(O.index),a.length),0),Q=[],q=1;q<O.length;q++)I2(Q,j$e(O[q]));var Se=O.groups;if(p){var Ie=B$e([z],Q,W,a);Se!==void 0&&I2(Ie,Se);var He=qg(S$e(o,void 0,Ie))}else He=M$e(z,a,W,Q,Se,o);W>=B&&($+=oq(a,B,W)+He,B=W+z.length)}return $+oq(a,B)}]},!z$e||!F$e||aq);var H$e=on,V$e=pi,U$e=KC,W$e=V$e("species"),cE=function(e){return U$e>=51||!H$e(function(){var t=[],r=t.constructor={};return r[W$e]=function(){return{foo:1}},t[e](Boolean).foo!==1})},G$e=jr,Y$e=Lm.filter,K$e=cE,q$e=K$e("filter");G$e({target:"Array",proto:!0,forced:!q$e},{filter:function(t){return Y$e(this,t,arguments.length>1?arguments[1]:void 0)}});var X$e=oi,Fse=X$e,MV={},Z$e=pi;MV.f=Z$e;var sq=Fse,J$e=ji,Q$e=MV,eDe=Ca.f,$V=function(e){var t=sq.Symbol||(sq.Symbol={});J$e(t,e)||eDe(t,e,{value:Q$e.f(e)})},tDe=uo,rDe=tf,nDe=pi,iDe=Ks,zse=function(){var e=rDe("Symbol"),t=e&&e.prototype,r=t&&t.valueOf,n=nDe("toPrimitive");t&&!t[n]&&iDe(t,n,function(i){return tDe(r,this)},{arity:1})},oDe=$V,aDe=zse;oDe("toPrimitive");aDe();var sDe=Yi,lDe=Rae,uDe=TypeError,cDe=function(e){if(sDe(this),e==="string"||e==="default")e="string";else if(e!=="number")throw uDe("Incorrect hint");return lDe(this,e)},fDe=ji,hDe=Ks,dDe=cDe,pDe=pi,lq=pDe("toPrimitive"),uq=Date.prototype;fDe(uq,lq)||hDe(uq,lq,dDe);var cq=Hae,mDe=Ca,fE=function(e,t,r){return r.get&&cq(r.get,t,{getter:!0}),r.set&&cq(r.set,t,{setter:!0}),mDe.f(e,t,r)},HI=jr,DV=oi,LV=uo,gDe=sn,Mv=eo,$v=Xb,yDe=on,Ao=ji,vDe=Kh,nj=Yi,VI=ys,NV=kI,_De=to,ij=tE,E1=Jb,Hse=JC,bDe=Dm,Vse=mV,wDe=iE,Use=Ou,Wse=Ca,SDe=tV,Gse=rE,M2=Ks,xDe=fE,BV=qb,CDe=PI,Yse=ZC,fq=OI,EDe=pi,TDe=MV,ODe=$V,RDe=zse,kDe=MI,Kse=rf,UI=Lm.forEach,ja=CDe("hidden"),WI="Symbol",T1="prototype",PDe=Kse.set,hq=Kse.getterFor(WI),Bs=Object[T1],Zp=DV.Symbol,xS=Zp&&Zp[T1],ADe=DV.TypeError,$2=DV.QObject,qse=Use.f,pp=Wse.f,Xse=Vse.f,IDe=Gse.f,Zse=gDe([].push),qc=BV("symbols"),hE=BV("op-symbols"),MDe=BV("wks"),oj=!$2||!$2[T1]||!$2[T1].findChild,aj=Mv&&yDe(function(){return E1(pp({},"a",{get:function(){return pp(this,"a",{value:7}).a}})).a!=7})?function(e,t,r){var n=qse(Bs,t);n&&delete Bs[t],pp(e,t,r),n&&e!==Bs&&pp(Bs,t,n)}:pp,D2=function(e,t){var r=qc[e]=E1(xS);return PDe(r,{type:WI,tag:e,description:t}),Mv||(r.description=t),r},GI=function(t,r,n){t===Bs&&GI(hE,r,n),nj(t);var i=NV(r);return nj(n),Ao(qc,i)?(n.enumerable?(Ao(t,ja)&&t[ja][i]&&(t[ja][i]=!1),n=E1(n,{enumerable:ij(0,!1)})):(Ao(t,ja)||pp(t,ja,ij(1,{})),t[ja][i]=!0),aj(t,i,n)):pp(t,i,n)},jV=function(t,r){nj(t);var n=VI(r),i=Hse(n).concat(ele(n));return UI(i,function(o){(!Mv||LV(sj,n,o))&&GI(t,o,n[o])}),t},$De=function(t,r){return r===void 0?E1(t):jV(E1(t),r)},sj=function(t){var r=NV(t),n=LV(IDe,this,r);return this===Bs&&Ao(qc,r)&&!Ao(hE,r)?!1:n||!Ao(this,r)||!Ao(qc,r)||Ao(this,ja)&&this[ja][r]?n:!0},Jse=function(t,r){var n=VI(t),i=NV(r);if(!(n===Bs&&Ao(qc,i)&&!Ao(hE,i))){var o=qse(n,i);return o&&Ao(qc,i)&&!(Ao(n,ja)&&n[ja][i])&&(o.enumerable=!0),o}},Qse=function(t){var r=Xse(VI(t)),n=[];return UI(r,function(i){!Ao(qc,i)&&!Ao(Yse,i)&&Zse(n,i)}),n},ele=function(e){var t=e===Bs,r=Xse(t?hE:VI(e)),n=[];return UI(r,function(i){Ao(qc,i)&&(!t||Ao(Bs,i))&&Zse(n,qc[i])}),n};$v||(Zp=function(){if(vDe(xS,this))throw ADe("Symbol is not a constructor");var t=!arguments.length||arguments[0]===void 0?void 0:_De(arguments[0]),r=fq(t),n=function(i){this===Bs&&LV(n,hE,i),Ao(this,ja)&&Ao(this[ja],r)&&(this[ja][r]=!1),aj(this,r,ij(1,i))};return Mv&&oj&&aj(Bs,r,{configurable:!0,set:n}),D2(r,t)},xS=Zp[T1],M2(xS,"toString",function(){return hq(this).tag}),M2(Zp,"withoutSetter",function(e){return D2(fq(e),e)}),Gse.f=sj,Wse.f=GI,SDe.f=jV,Use.f=Jse,bDe.f=Vse.f=Qse,wDe.f=ele,TDe.f=function(e){return D2(EDe(e),e)},Mv&&(xDe(xS,"description",{configurable:!0,get:function(){return hq(this).description}}),M2(Bs,"propertyIsEnumerable",sj,{unsafe:!0})));HI({global:!0,constructor:!0,wrap:!0,forced:!$v,sham:!$v},{Symbol:Zp});UI(Hse(MDe),function(e){ODe(e)});HI({target:WI,stat:!0,forced:!$v},{useSetter:function(){oj=!0},useSimple:function(){oj=!1}});HI({target:"Object",stat:!0,forced:!$v,sham:!Mv},{create:$De,defineProperty:GI,defineProperties:jV,getOwnPropertyDescriptor:Jse});HI({target:"Object",stat:!0,forced:!$v},{getOwnPropertyNames:Qse});RDe();kDe(Zp,WI);Yse[ja]=!0;var DDe=Xb,tle=DDe&&!!Symbol.for&&!!Symbol.keyFor,LDe=jr,NDe=tf,BDe=ji,jDe=to,rle=qb,FDe=tle,L2=rle("string-to-symbol-registry"),zDe=rle("symbol-to-string-registry");LDe({target:"Symbol",stat:!0,forced:!FDe},{for:function(e){var t=jDe(e);if(BDe(L2,t))return L2[t];var r=NDe("Symbol")(t);return L2[t]=r,zDe[r]=t,r}});var HDe=jr,VDe=ji,UDe=qC,WDe=Zb,GDe=qb,YDe=tle,dq=GDe("symbol-to-string-registry");HDe({target:"Symbol",stat:!0,forced:!YDe},{keyFor:function(t){if(!UDe(t))throw TypeError(WDe(t)+" is not a symbol");if(VDe(dq,t))return dq[t]}});var KDe=sn,dE=KDe([].slice),qDe=sn,pq=ew,XDe=bi,mq=Tu,ZDe=to,gq=qDe([].push),JDe=function(e){if(XDe(e))return e;if(pq(e)){for(var t=e.length,r=[],n=0;n<t;n++){var i=e[n];typeof i=="string"?gq(r,i):(typeof i=="number"||mq(i)=="Number"||mq(i)=="String")&&gq(r,ZDe(i))}var o=r.length,s=!0;return function(a,h){if(s)return s=!1,h;if(pq(this))return h;for(var p=0;p<o;p++)if(r[p]===a)return h}}},QDe=jr,nle=tf,ile=Nm,e2e=uo,pE=sn,ole=on,yq=bi,vq=qC,ale=dE,t2e=JDe,r2e=Xb,n2e=String,wh=nle("JSON","stringify"),aR=pE(/./.exec),_q=pE("".charAt),i2e=pE("".charCodeAt),o2e=pE("".replace),a2e=pE(1 .toString),s2e=/[\uD800-\uDFFF]/g,bq=/^[\uD800-\uDBFF]$/,wq=/^[\uDC00-\uDFFF]$/,Sq=!r2e||ole(function(){var e=nle("Symbol")();return wh([e])!="[null]"||wh({a:e})!="{}"||wh(Object(e))!="{}"}),xq=ole(function(){return wh("\uDF06\uD834")!=='"\\udf06\\ud834"'||wh("\uDEAD")!=='"\\udead"'}),l2e=function(e,t){var r=ale(arguments),n=t2e(t);if(!(!yq(n)&&(e===void 0||vq(e))))return r[1]=function(i,o){if(yq(n)&&(o=e2e(n,this,n2e(i),o)),!vq(o))return o},ile(wh,null,r)},u2e=function(e,t,r){var n=_q(r,t-1),i=_q(r,t+1);return aR(bq,e)&&!aR(wq,i)||aR(wq,e)&&!aR(bq,n)?"\\u"+a2e(i2e(e,0),16):e};wh&&QDe({target:"JSON",stat:!0,arity:3,forced:Sq||xq},{stringify:function(t,r,n){var i=ale(arguments),o=ile(Sq?l2e:wh,null,i);return xq&&typeof o=="string"?o2e(o,s2e,u2e):o}});var c2e=jr,f2e=Xb,h2e=on,sle=iE,d2e=Ga,p2e=!f2e||h2e(function(){sle.f(1)});c2e({target:"Object",stat:!0,forced:p2e},{getOwnPropertySymbols:function(t){var r=sle.f;return r?r(d2e(t)):[]}});var m2e=jr,g2e=eo,y2e=oi,sR=sn,v2e=ji,_2e=bi,b2e=Kh,w2e=to,S2e=fE,x2e=Uae,rc=y2e.Symbol,Ud=rc&&rc.prototype;if(g2e&&_2e(rc)&&(!("description"in Ud)||rc().description!==void 0)){var Cq={},lR=function(){var t=arguments.length<1||arguments[0]===void 0?void 0:w2e(arguments[0]),r=b2e(Ud,this)?new rc(t):t===void 0?rc():rc(t);return t===""&&(Cq[r]=!0),r};x2e(lR,rc),lR.prototype=Ud,Ud.constructor=lR;var C2e=String(rc("test"))=="Symbol(test)",E2e=sR(Ud.valueOf),T2e=sR(Ud.toString),O2e=/^Symbol\((.*)\)[^)]+$/,R2e=sR("".replace),k2e=sR("".slice);S2e(Ud,"description",{configurable:!0,get:function(){var t=E2e(this);if(v2e(Cq,t))return"";var r=T2e(t),n=C2e?k2e(r,7,-1):R2e(r,O2e,"$1");return n===""?void 0:n}}),m2e({global:!0,constructor:!0,forced:!0},{Symbol:lR})}var P2e=sn,lle=P2e(1 .valueOf),ule=`	
\v\f\r \u2028\u2029\uFEFF`,A2e=sn,I2e=Wa,M2e=to,lj=ule,Eq=A2e("".replace),$2e=RegExp("^["+lj+"]+"),D2e=RegExp("(^|[^"+lj+"])["+lj+"]+$"),N2=function(e){return function(t){var r=M2e(I2e(t));return e&1&&(r=Eq(r,$2e,"")),e&2&&(r=Eq(r,D2e,"$1")),r}},cle={start:N2(1),end:N2(2),trim:N2(3)},L2e=jr,fle=tTe,N2e=eo,hle=oi,dle=Fse,ple=sn,B2e=AI,Tq=ji,j2e=xV,F2e=Kh,z2e=qC,mle=kae,H2e=on,V2e=Dm.f,U2e=Ou.f,W2e=Ca.f,G2e=lle,Y2e=cle.trim,YI="Number",iv=hle[YI];dle[YI];var FV=iv.prototype,K2e=hle.TypeError,q2e=ple("".slice),uR=ple("".charCodeAt),X2e=function(e){var t=mle(e,"number");return typeof t=="bigint"?t:Z2e(t)},Z2e=function(e){var t=mle(e,"number"),r,n,i,o,s,a,h,p;if(z2e(t))throw K2e("Cannot convert a Symbol value to a number");if(typeof t=="string"&&t.length>2){if(t=Y2e(t),r=uR(t,0),r===43||r===45){if(n=uR(t,2),n===88||n===120)return NaN}else if(r===48){switch(uR(t,1)){case 66:case 98:i=2,o=49;break;case 79:case 111:i=8,o=55;break;default:return+t}for(s=q2e(t,2),a=s.length,h=0;h<a;h++)if(p=uR(s,h),p<48||p>o)return NaN;return parseInt(s,i)}}return+t},zV=B2e(YI,!iv(" 0o1")||!iv("0b1")||iv("+0x1")),J2e=function(e){return F2e(FV,e)&&H2e(function(){G2e(e)})},KI=function(t){var r=arguments.length<1?0:iv(X2e(t));return J2e(this)?j2e(Object(r),this,KI):r};KI.prototype=FV;zV&&!fle&&(FV.constructor=KI);L2e({global:!0,constructor:!0,wrap:!0,forced:zV},{Number:KI});var Q2e=function(e,t){for(var r=N2e?V2e(t):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),n=0,i;r.length>n;n++)Tq(t,i=r[n])&&!Tq(e,i)&&W2e(e,i,U2e(t,i))};(zV||fle)&&Q2e(dle[YI],iv);var eLe=jr,tLe=aV;eLe({target:"Object",stat:!0},{setPrototypeOf:tLe});var rLe=jr,nLe=on,iLe=Ga,gle=II,oLe=Wae,aLe=nLe(function(){gle(1)});rLe({target:"Object",stat:!0,forced:aLe,sham:!oLe},{getPrototypeOf:function(t){return gle(iLe(t))}});var yle=sn,sLe=Am,lLe=Qi,uLe=ji,Oq=dE,cLe=GC,vle=Function,fLe=yle([].concat),hLe=yle([].join),B2={},dLe=function(e,t,r){if(!uLe(B2,t)){for(var n=[],i=0;i<t;i++)n[i]="a["+i+"]";B2[t]=vle("C,a","return new C("+hLe(n,",")+")")}return B2[t](e,r)},pLe=cLe?vle.bind:function(t){var r=sLe(this),n=r.prototype,i=Oq(arguments,1),o=function(){var a=fLe(i,Oq(arguments));return this instanceof o?dLe(r,a.length,a):r.apply(t,a)};return lLe(n)&&(o.prototype=n),o},mLe=LI,gLe=Zb,yLe=TypeError,_le=function(e){if(mLe(e))return e;throw yLe(gLe(e)+" is not a constructor")},vLe=jr,_Le=tf,j2=Nm,bLe=pLe,Rq=_le,wLe=Yi,kq=Qi,SLe=Jb,ble=on,HV=_Le("Reflect","construct"),xLe=Object.prototype,CLe=[].push,wle=ble(function(){function e(){}return!(HV(function(){},[],e)instanceof e)}),Sle=!ble(function(){HV(function(){})}),Pq=wle||Sle;vLe({target:"Reflect",stat:!0,forced:Pq,sham:Pq},{construct:function(t,r){Rq(t),wLe(r);var n=arguments.length<3?t:Rq(arguments[2]);if(Sle&&!wle)return HV(t,r,n);if(t==n){switch(r.length){case 0:return new t;case 1:return new t(r[0]);case 2:return new t(r[0],r[1]);case 3:return new t(r[0],r[1],r[2]);case 4:return new t(r[0],r[1],r[2],r[3])}var i=[null];return j2(CLe,i,r),new(j2(bLe,t,i))}var o=n.prototype,s=SLe(kq(o)?o:xLe),a=j2(t,s,r);return kq(a)?a:s}});var Aq=ji,ELe=function(e){return e!==void 0&&(Aq(e,"value")||Aq(e,"writable"))},TLe=jr,OLe=uo,RLe=Qi,kLe=Yi,PLe=ELe,ALe=Ou,ILe=II;function xle(e,t){var r=arguments.length<3?e:arguments[2],n,i;if(kLe(e)===r)return e[t];if(n=ALe.f(e,t),n)return PLe(n)?n.value:n.get===void 0?void 0:OLe(n.get,r);if(RLe(i=ILe(e)))return xle(i,t,r)}TLe({target:"Reflect",stat:!0},{get:xle});var MLe=jr,$Le=on,DLe=ys,Cle=Ou.f,Ele=eo,LLe=!Ele||$Le(function(){Cle(1)});MLe({target:"Object",stat:!0,forced:LLe,sham:!Ele},{getOwnPropertyDescriptor:function(t,r){return Cle(DLe(t),r)}});var NLe=$V;NLe("iterator");var BLe=jr,Iq=ew,jLe=LI,FLe=Qi,Mq=XC,zLe=Ys,HLe=ys,VLe=Qb,ULe=pi,WLe=cE,GLe=dE,YLe=WLe("slice"),KLe=ULe("species"),F2=Array,qLe=Math.max;BLe({target:"Array",proto:!0,forced:!YLe},{slice:function(t,r){var n=HLe(this),i=zLe(n),o=Mq(t,i),s=Mq(r===void 0?i:r,i),a,h,p;if(Iq(n)&&(a=n.constructor,jLe(a)&&(a===F2||Iq(a.prototype))?a=void 0:FLe(a)&&(a=a[KLe],a===null&&(a=void 0)),a===F2||a===void 0))return GLe(n,o,s);for(h=new(a===void 0?F2:a)(qLe(s-o,0)),p=0;o<s;o++,p++)o in n&&VLe(h,p,n[o]);return h.length=p,h}});var XLe=eo,ZLe=nE.EXISTS,Tle=sn,JLe=fE,Ole=Function.prototype,QLe=Tle(Ole.toString),Rle=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,eNe=Tle(Rle.exec),tNe="name";XLe&&!ZLe&&JLe(Ole,tNe,{configurable:!0,get:function(){try{return eNe(Rle,QLe(this))[1]}catch{return""}}});var rNe=Yi,nNe=sse,iNe=function(e,t,r,n){try{return n?t(rNe(r)[0],r[1]):t(r)}catch(i){nNe(e,"throw",i)}},oNe=lE,aNe=uo,sNe=Ga,lNe=iNe,uNe=ose,cNe=LI,fNe=Ys,$q=Qb,hNe=ase,dNe=bV,Dq=Array,pNe=function(t){var r=sNe(t),n=cNe(this),i=arguments.length,o=i>1?arguments[1]:void 0,s=o!==void 0;s&&(o=oNe(o,i>2?arguments[2]:void 0));var a=dNe(r),h=0,p,y,S,E,O,A;if(a&&!(this===Dq&&uNe(a)))for(E=hNe(r,a),O=E.next,y=n?new this:[];!(S=aNe(O,E)).done;h++)A=s?lNe(E,o,[S.value,h],!0):S.value,$q(y,h,A);else for(p=fNe(r),y=n?new this(p):Dq(p);p>h;h++)A=s?o(r[h],h):r[h],$q(y,h,A);return y.length=h,y},mNe=jr,gNe=pNe,yNe=cse,vNe=!yNe(function(e){Array.from(e)});mNe({target:"Array",stat:!0,forced:vNe},{from:gNe});var _Ne=jr,bNe=dV,wNe=on,SNe=Qi,xNe=aE.onFreeze,uj=Object.freeze,CNe=wNe(function(){uj(1)});_Ne({target:"Object",stat:!0,forced:CNe,sham:!bNe},{freeze:function(t){return uj&&SNe(t)?uj(xNe(t)):t}});var ENe=nE.PROPER,TNe=on,Lq=ule,Nq="",ONe=function(e){return TNe(function(){return!!Lq[e]()||Nq[e]()!==Nq||ENe&&Lq[e].name!==e})},RNe=jr,kNe=cle.trim,PNe=ONe;RNe({target:"String",proto:!0,forced:PNe("trim")},{trim:function(){return kNe(this)}});var ANe=jr,INe=rV.includes,MNe=on,$Ne=QC,DNe=MNe(function(){return!Array(1).includes()});ANe({target:"Array",proto:!0,forced:DNe},{includes:function(t){return INe(this,t,arguments.length>1?arguments[1]:void 0)}});$Ne("includes");var LNe=uo,NNe=ji,BNe=Kh,jNe=$se,Bq=RegExp.prototype,kle=function(e){var t=e.flags;return t===void 0&&!("flags"in Bq)&&!NNe(e,"flags")&&BNe(Bq,e)?LNe(jNe,e):t},FNe=nE.PROPER,zNe=Ks,HNe=Yi,jq=to,VNe=on,UNe=kle,VV="toString",WNe=RegExp.prototype,Ple=WNe[VV],GNe=VNe(function(){return Ple.call({source:"a",flags:"b"})!="/a/b"}),YNe=FNe&&Ple.name!=VV;(GNe||YNe)&&zNe(RegExp.prototype,VV,function(){var t=HNe(this),r=jq(t.source),n=jq(UNe(t));return"/"+r+"/"+n},{unsafe:!0});var KNe=jr,qNe=hV.codeAt;KNe({target:"String",proto:!0},{codePointAt:function(t){return qNe(this,t)}});var XNe=qh,ZNe=to,JNe=Wa,QNe=RangeError,Ale=function(t){var r=ZNe(JNe(this)),n="",i=XNe(t);if(i<0||i==1/0)throw QNe("Wrong number of repetitions");for(;i>0;(i>>>=1)&&(r+=r))i&1&&(n+=r);return n},Ile=sn,eBe=Mm,Fq=to,tBe=Ale,rBe=Wa,nBe=Ile(tBe),iBe=Ile("".slice),oBe=Math.ceil,zq=function(e){return function(t,r,n){var i=Fq(rBe(t)),o=eBe(r),s=i.length,a=n===void 0?" ":Fq(n),h,p;return o<=s||a==""?i:(h=o-s,p=nBe(a,oBe(h/a.length)),p.length>h&&(p=iBe(p,0,h)),e?i+p:p+i)}},aBe={start:zq(!1),end:zq(!0)},sBe=Pm,lBe=/Version\/10(?:\.\d+){1,2}(?: [\w./]+)?(?: Mobile\/\w+)? Safari\//.test(sBe),uBe=jr,cBe=aBe.start,fBe=lBe;uBe({target:"String",proto:!0,forced:fBe},{padStart:function(t){return cBe(this,t,arguments.length>1?arguments[1]:void 0)}});//! moment.js
//! version : 2.29.4
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var Mle;function Ut(){return Mle.apply(null,arguments)}function hBe(e){Mle=e}function Ol(e){return e instanceof Array||Object.prototype.toString.call(e)==="[object Array]"}function Jp(e){return e!=null&&Object.prototype.toString.call(e)==="[object Object]"}function Fn(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function UV(e){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(e).length===0;var t;for(t in e)if(Fn(e,t))return!1;return!0}function La(e){return e===void 0}function Xc(e){return typeof e=="number"||Object.prototype.toString.call(e)==="[object Number]"}function mE(e){return e instanceof Date||Object.prototype.toString.call(e)==="[object Date]"}function $le(e,t){var r=[],n,i=e.length;for(n=0;n<i;++n)r.push(t(e[n],n));return r}function uh(e,t){for(var r in t)Fn(t,r)&&(e[r]=t[r]);return Fn(t,"toString")&&(e.toString=t.toString),Fn(t,"valueOf")&&(e.valueOf=t.valueOf),e}function Ru(e,t,r,n){return iue(e,t,r,n,!0).utc()}function dBe(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function fn(e){return e._pf==null&&(e._pf=dBe()),e._pf}var cj;Array.prototype.some?cj=Array.prototype.some:cj=function(e){var t=Object(this),r=t.length>>>0,n;for(n=0;n<r;n++)if(n in t&&e.call(this,t[n],n,t))return!0;return!1};function WV(e){if(e._isValid==null){var t=fn(e),r=cj.call(t.parsedDateParts,function(i){return i!=null}),n=!isNaN(e._d.getTime())&&t.overflow<0&&!t.empty&&!t.invalidEra&&!t.invalidMonth&&!t.invalidWeekday&&!t.weekdayMismatch&&!t.nullInput&&!t.invalidFormat&&!t.userInvalidated&&(!t.meridiem||t.meridiem&&r);if(e._strict&&(n=n&&t.charsLeftOver===0&&t.unusedTokens.length===0&&t.bigHour===void 0),Object.isFrozen==null||!Object.isFrozen(e))e._isValid=n;else return n}return e._isValid}function qI(e){var t=Ru(NaN);return e!=null?uh(fn(t),e):fn(t).userInvalidated=!0,t}var Hq=Ut.momentProperties=[],z2=!1;function GV(e,t){var r,n,i,o=Hq.length;if(La(t._isAMomentObject)||(e._isAMomentObject=t._isAMomentObject),La(t._i)||(e._i=t._i),La(t._f)||(e._f=t._f),La(t._l)||(e._l=t._l),La(t._strict)||(e._strict=t._strict),La(t._tzm)||(e._tzm=t._tzm),La(t._isUTC)||(e._isUTC=t._isUTC),La(t._offset)||(e._offset=t._offset),La(t._pf)||(e._pf=fn(t)),La(t._locale)||(e._locale=t._locale),o>0)for(r=0;r<o;r++)n=Hq[r],i=t[n],La(i)||(e[n]=i);return e}function gE(e){GV(this,e),this._d=new Date(e._d!=null?e._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),z2===!1&&(z2=!0,Ut.updateOffset(this),z2=!1)}function Rl(e){return e instanceof gE||e!=null&&e._isAMomentObject!=null}function Dle(e){Ut.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+e)}function qs(e,t){var r=!0;return uh(function(){if(Ut.deprecationHandler!=null&&Ut.deprecationHandler(null,e),r){var n=[],i,o,s,a=arguments.length;for(o=0;o<a;o++){if(i="",typeof arguments[o]=="object"){i+=`
[`+o+"] ";for(s in arguments[0])Fn(arguments[0],s)&&(i+=s+": "+arguments[0][s]+", ");i=i.slice(0,-2)}else i=arguments[o];n.push(i)}Dle(e+`
Arguments: `+Array.prototype.slice.call(n).join("")+`
`+new Error().stack),r=!1}return t.apply(this,arguments)},t)}var Vq={};function Lle(e,t){Ut.deprecationHandler!=null&&Ut.deprecationHandler(e,t),Vq[e]||(Dle(t),Vq[e]=!0)}Ut.suppressDeprecationWarnings=!1;Ut.deprecationHandler=null;function ku(e){return typeof Function<"u"&&e instanceof Function||Object.prototype.toString.call(e)==="[object Function]"}function pBe(e){var t,r;for(r in e)Fn(e,r)&&(t=e[r],ku(t)?this[r]=t:this["_"+r]=t);this._config=e,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function fj(e,t){var r=uh({},e),n;for(n in t)Fn(t,n)&&(Jp(e[n])&&Jp(t[n])?(r[n]={},uh(r[n],e[n]),uh(r[n],t[n])):t[n]!=null?r[n]=t[n]:delete r[n]);for(n in e)Fn(e,n)&&!Fn(t,n)&&Jp(e[n])&&(r[n]=uh({},r[n]));return r}function YV(e){e!=null&&this.set(e)}var hj;Object.keys?hj=Object.keys:hj=function(e){var t,r=[];for(t in e)Fn(e,t)&&r.push(t);return r};var mBe={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function gBe(e,t,r){var n=this._calendar[e]||this._calendar.sameElse;return ku(n)?n.call(t,r):n}function xu(e,t,r){var n=""+Math.abs(e),i=t-n.length,o=e>=0;return(o?r?"+":"":"-")+Math.pow(10,Math.max(0,i)).toString().substr(1)+n}var KV=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,cR=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,H2={},ov={};function Dr(e,t,r,n){var i=n;typeof n=="string"&&(i=function(){return this[n]()}),e&&(ov[e]=i),t&&(ov[t[0]]=function(){return xu(i.apply(this,arguments),t[1],t[2])}),r&&(ov[r]=function(){return this.localeData().ordinal(i.apply(this,arguments),e)})}function yBe(e){return e.match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function vBe(e){var t=e.match(KV),r,n;for(r=0,n=t.length;r<n;r++)ov[t[r]]?t[r]=ov[t[r]]:t[r]=yBe(t[r]);return function(i){var o="",s;for(s=0;s<n;s++)o+=ku(t[s])?t[s].call(i,e):t[s];return o}}function wk(e,t){return e.isValid()?(t=Nle(t,e.localeData()),H2[t]=H2[t]||vBe(t),H2[t](e)):e.localeData().invalidDate()}function Nle(e,t){var r=5;function n(i){return t.longDateFormat(i)||i}for(cR.lastIndex=0;r>=0&&cR.test(e);)e=e.replace(cR,n),cR.lastIndex=0,r-=1;return e}var _Be={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function bBe(e){var t=this._longDateFormat[e],r=this._longDateFormat[e.toUpperCase()];return t||!r?t:(this._longDateFormat[e]=r.match(KV).map(function(n){return n==="MMMM"||n==="MM"||n==="DD"||n==="dddd"?n.slice(1):n}).join(""),this._longDateFormat[e])}var wBe="Invalid date";function SBe(){return this._invalidDate}var xBe="%d",CBe=/\d{1,2}/;function EBe(e){return this._ordinal.replace("%d",e)}var TBe={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function OBe(e,t,r,n){var i=this._relativeTime[r];return ku(i)?i(e,t,r,n):i.replace(/%d/i,e)}function RBe(e,t){var r=this._relativeTime[e>0?"future":"past"];return ku(r)?r(t):r.replace(/%s/i,t)}var HS={};function na(e,t){var r=e.toLowerCase();HS[r]=HS[r+"s"]=HS[t]=e}function Xs(e){return typeof e=="string"?HS[e]||HS[e.toLowerCase()]:void 0}function qV(e){var t={},r,n;for(n in e)Fn(e,n)&&(r=Xs(n),r&&(t[r]=e[n]));return t}var Ble={};function ia(e,t){Ble[e]=t}function kBe(e){var t=[],r;for(r in e)Fn(e,r)&&t.push({unit:r,priority:Ble[r]});return t.sort(function(n,i){return n.priority-i.priority}),t}function XI(e){return e%4===0&&e%100!==0||e%400===0}function Ds(e){return e<0?Math.ceil(e)||0:Math.floor(e)}function Cn(e){var t=+e,r=0;return t!==0&&isFinite(t)&&(r=Ds(t)),r}function rw(e,t){return function(r){return r!=null?(jle(this,e,r),Ut.updateOffset(this,t),this):NP(this,e)}}function NP(e,t){return e.isValid()?e._d["get"+(e._isUTC?"UTC":"")+t]():NaN}function jle(e,t,r){e.isValid()&&!isNaN(r)&&(t==="FullYear"&&XI(e.year())&&e.month()===1&&e.date()===29?(r=Cn(r),e._d["set"+(e._isUTC?"UTC":"")+t](r,e.month(),rM(r,e.month()))):e._d["set"+(e._isUTC?"UTC":"")+t](r))}function PBe(e){return e=Xs(e),ku(this[e])?this[e]():this}function ABe(e,t){if(typeof e=="object"){e=qV(e);var r=kBe(e),n,i=r.length;for(n=0;n<i;n++)this[r[n].unit](e[r[n].unit])}else if(e=Xs(e),ku(this[e]))return this[e](t);return this}var Fle=/\d/,vs=/\d\d/,zle=/\d{3}/,XV=/\d{4}/,ZI=/[+-]?\d{6}/,wi=/\d\d?/,Hle=/\d\d\d\d?/,Vle=/\d\d\d\d\d\d?/,JI=/\d{1,3}/,ZV=/\d{1,4}/,QI=/[+-]?\d{1,6}/,nw=/\d+/,eM=/[+-]?\d+/,IBe=/Z|[+-]\d\d:?\d\d/gi,tM=/Z|[+-]\d\d(?::?\d\d)?/gi,MBe=/[+-]?\d+(\.\d{1,3})?/,yE=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,BP;BP={};function br(e,t,r){BP[e]=ku(t)?t:function(n,i){return n&&r?r:t}}function $Be(e,t){return Fn(BP,e)?BP[e](t._strict,t._locale):new RegExp(DBe(e))}function DBe(e){return ss(e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(t,r,n,i,o){return r||n||i||o}))}function ss(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}var dj={};function ai(e,t){var r,n=t,i;for(typeof e=="string"&&(e=[e]),Xc(t)&&(n=function(o,s){s[t]=Cn(o)}),i=e.length,r=0;r<i;r++)dj[e[r]]=n}function vE(e,t){ai(e,function(r,n,i,o){i._w=i._w||{},t(r,i._w,i,o)})}function LBe(e,t,r){t!=null&&Fn(dj,e)&&dj[e](t,r._a,r,e)}var ta=0,fc=1,pu=2,vo=3,xl=4,hc=5,wp=6,NBe=7,BBe=8;function jBe(e,t){return(e%t+t)%t}var Xi;Array.prototype.indexOf?Xi=Array.prototype.indexOf:Xi=function(e){var t;for(t=0;t<this.length;++t)if(this[t]===e)return t;return-1};function rM(e,t){if(isNaN(e)||isNaN(t))return NaN;var r=jBe(t,12);return e+=(t-r)/12,r===1?XI(e)?29:28:31-r%7%2}Dr("M",["MM",2],"Mo",function(){return this.month()+1});Dr("MMM",0,0,function(e){return this.localeData().monthsShort(this,e)});Dr("MMMM",0,0,function(e){return this.localeData().months(this,e)});na("month","M");ia("month",8);br("M",wi);br("MM",wi,vs);br("MMM",function(e,t){return t.monthsShortRegex(e)});br("MMMM",function(e,t){return t.monthsRegex(e)});ai(["M","MM"],function(e,t){t[fc]=Cn(e)-1});ai(["MMM","MMMM"],function(e,t,r,n){var i=r._locale.monthsParse(e,n,r._strict);i!=null?t[fc]=i:fn(r).invalidMonth=e});var FBe="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),Ule="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),Wle=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,zBe=yE,HBe=yE;function VBe(e,t){return e?Ol(this._months)?this._months[e.month()]:this._months[(this._months.isFormat||Wle).test(t)?"format":"standalone"][e.month()]:Ol(this._months)?this._months:this._months.standalone}function UBe(e,t){return e?Ol(this._monthsShort)?this._monthsShort[e.month()]:this._monthsShort[Wle.test(t)?"format":"standalone"][e.month()]:Ol(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function WBe(e,t,r){var n,i,o,s=e.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],n=0;n<12;++n)o=Ru([2e3,n]),this._shortMonthsParse[n]=this.monthsShort(o,"").toLocaleLowerCase(),this._longMonthsParse[n]=this.months(o,"").toLocaleLowerCase();return r?t==="MMM"?(i=Xi.call(this._shortMonthsParse,s),i!==-1?i:null):(i=Xi.call(this._longMonthsParse,s),i!==-1?i:null):t==="MMM"?(i=Xi.call(this._shortMonthsParse,s),i!==-1?i:(i=Xi.call(this._longMonthsParse,s),i!==-1?i:null)):(i=Xi.call(this._longMonthsParse,s),i!==-1?i:(i=Xi.call(this._shortMonthsParse,s),i!==-1?i:null))}function GBe(e,t,r){var n,i,o;if(this._monthsParseExact)return WBe.call(this,e,t,r);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),n=0;n<12;n++){if(i=Ru([2e3,n]),r&&!this._longMonthsParse[n]&&(this._longMonthsParse[n]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i"),this._shortMonthsParse[n]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")),!r&&!this._monthsParse[n]&&(o="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[n]=new RegExp(o.replace(".",""),"i")),r&&t==="MMMM"&&this._longMonthsParse[n].test(e))return n;if(r&&t==="MMM"&&this._shortMonthsParse[n].test(e))return n;if(!r&&this._monthsParse[n].test(e))return n}}function Gle(e,t){var r;if(!e.isValid())return e;if(typeof t=="string"){if(/^\d+$/.test(t))t=Cn(t);else if(t=e.localeData().monthsParse(t),!Xc(t))return e}return r=Math.min(e.date(),rM(e.year(),t)),e._d["set"+(e._isUTC?"UTC":"")+"Month"](t,r),e}function Yle(e){return e!=null?(Gle(this,e),Ut.updateOffset(this,!0),this):NP(this,"Month")}function YBe(){return rM(this.year(),this.month())}function KBe(e){return this._monthsParseExact?(Fn(this,"_monthsRegex")||Kle.call(this),e?this._monthsShortStrictRegex:this._monthsShortRegex):(Fn(this,"_monthsShortRegex")||(this._monthsShortRegex=zBe),this._monthsShortStrictRegex&&e?this._monthsShortStrictRegex:this._monthsShortRegex)}function qBe(e){return this._monthsParseExact?(Fn(this,"_monthsRegex")||Kle.call(this),e?this._monthsStrictRegex:this._monthsRegex):(Fn(this,"_monthsRegex")||(this._monthsRegex=HBe),this._monthsStrictRegex&&e?this._monthsStrictRegex:this._monthsRegex)}function Kle(){function e(s,a){return a.length-s.length}var t=[],r=[],n=[],i,o;for(i=0;i<12;i++)o=Ru([2e3,i]),t.push(this.monthsShort(o,"")),r.push(this.months(o,"")),n.push(this.months(o,"")),n.push(this.monthsShort(o,""));for(t.sort(e),r.sort(e),n.sort(e),i=0;i<12;i++)t[i]=ss(t[i]),r[i]=ss(r[i]);for(i=0;i<24;i++)n[i]=ss(n[i]);this._monthsRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+t.join("|")+")","i")}Dr("Y",0,0,function(){var e=this.year();return e<=9999?xu(e,4):"+"+e});Dr(0,["YY",2],0,function(){return this.year()%100});Dr(0,["YYYY",4],0,"year");Dr(0,["YYYYY",5],0,"year");Dr(0,["YYYYYY",6,!0],0,"year");na("year","y");ia("year",1);br("Y",eM);br("YY",wi,vs);br("YYYY",ZV,XV);br("YYYYY",QI,ZI);br("YYYYYY",QI,ZI);ai(["YYYYY","YYYYYY"],ta);ai("YYYY",function(e,t){t[ta]=e.length===2?Ut.parseTwoDigitYear(e):Cn(e)});ai("YY",function(e,t){t[ta]=Ut.parseTwoDigitYear(e)});ai("Y",function(e,t){t[ta]=parseInt(e,10)});function VS(e){return XI(e)?366:365}Ut.parseTwoDigitYear=function(e){return Cn(e)+(Cn(e)>68?1900:2e3)};var qle=rw("FullYear",!0);function XBe(){return XI(this.year())}function ZBe(e,t,r,n,i,o,s){var a;return e<100&&e>=0?(a=new Date(e+400,t,r,n,i,o,s),isFinite(a.getFullYear())&&a.setFullYear(e)):a=new Date(e,t,r,n,i,o,s),a}function O1(e){var t,r;return e<100&&e>=0?(r=Array.prototype.slice.call(arguments),r[0]=e+400,t=new Date(Date.UTC.apply(null,r)),isFinite(t.getUTCFullYear())&&t.setUTCFullYear(e)):t=new Date(Date.UTC.apply(null,arguments)),t}function jP(e,t,r){var n=7+t-r,i=(7+O1(e,0,n).getUTCDay()-t)%7;return-i+n-1}function Xle(e,t,r,n,i){var o=(7+r-n)%7,s=jP(e,n,i),a=1+7*(t-1)+o+s,h,p;return a<=0?(h=e-1,p=VS(h)+a):a>VS(e)?(h=e+1,p=a-VS(e)):(h=e,p=a),{year:h,dayOfYear:p}}function R1(e,t,r){var n=jP(e.year(),t,r),i=Math.floor((e.dayOfYear()-n-1)/7)+1,o,s;return i<1?(s=e.year()-1,o=i+zc(s,t,r)):i>zc(e.year(),t,r)?(o=i-zc(e.year(),t,r),s=e.year()+1):(s=e.year(),o=i),{week:o,year:s}}function zc(e,t,r){var n=jP(e,t,r),i=jP(e+1,t,r);return(VS(e)-n+i)/7}Dr("w",["ww",2],"wo","week");Dr("W",["WW",2],"Wo","isoWeek");na("week","w");na("isoWeek","W");ia("week",5);ia("isoWeek",5);br("w",wi);br("ww",wi,vs);br("W",wi);br("WW",wi,vs);vE(["w","ww","W","WW"],function(e,t,r,n){t[n.substr(0,1)]=Cn(e)});function JBe(e){return R1(e,this._week.dow,this._week.doy).week}var QBe={dow:0,doy:6};function eje(){return this._week.dow}function tje(){return this._week.doy}function rje(e){var t=this.localeData().week(this);return e==null?t:this.add((e-t)*7,"d")}function nje(e){var t=R1(this,1,4).week;return e==null?t:this.add((e-t)*7,"d")}Dr("d",0,"do","day");Dr("dd",0,0,function(e){return this.localeData().weekdaysMin(this,e)});Dr("ddd",0,0,function(e){return this.localeData().weekdaysShort(this,e)});Dr("dddd",0,0,function(e){return this.localeData().weekdays(this,e)});Dr("e",0,0,"weekday");Dr("E",0,0,"isoWeekday");na("day","d");na("weekday","e");na("isoWeekday","E");ia("day",11);ia("weekday",11);ia("isoWeekday",11);br("d",wi);br("e",wi);br("E",wi);br("dd",function(e,t){return t.weekdaysMinRegex(e)});br("ddd",function(e,t){return t.weekdaysShortRegex(e)});br("dddd",function(e,t){return t.weekdaysRegex(e)});vE(["dd","ddd","dddd"],function(e,t,r,n){var i=r._locale.weekdaysParse(e,n,r._strict);i!=null?t.d=i:fn(r).invalidWeekday=e});vE(["d","e","E"],function(e,t,r,n){t[n]=Cn(e)});function ije(e,t){return typeof e!="string"?e:isNaN(e)?(e=t.weekdaysParse(e),typeof e=="number"?e:null):parseInt(e,10)}function oje(e,t){return typeof e=="string"?t.weekdaysParse(e)%7||7:isNaN(e)?null:e}function JV(e,t){return e.slice(t,7).concat(e.slice(0,t))}var aje="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),Zle="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),sje="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),lje=yE,uje=yE,cje=yE;function fje(e,t){var r=Ol(this._weekdays)?this._weekdays:this._weekdays[e&&e!==!0&&this._weekdays.isFormat.test(t)?"format":"standalone"];return e===!0?JV(r,this._week.dow):e?r[e.day()]:r}function hje(e){return e===!0?JV(this._weekdaysShort,this._week.dow):e?this._weekdaysShort[e.day()]:this._weekdaysShort}function dje(e){return e===!0?JV(this._weekdaysMin,this._week.dow):e?this._weekdaysMin[e.day()]:this._weekdaysMin}function pje(e,t,r){var n,i,o,s=e.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],n=0;n<7;++n)o=Ru([2e3,1]).day(n),this._minWeekdaysParse[n]=this.weekdaysMin(o,"").toLocaleLowerCase(),this._shortWeekdaysParse[n]=this.weekdaysShort(o,"").toLocaleLowerCase(),this._weekdaysParse[n]=this.weekdays(o,"").toLocaleLowerCase();return r?t==="dddd"?(i=Xi.call(this._weekdaysParse,s),i!==-1?i:null):t==="ddd"?(i=Xi.call(this._shortWeekdaysParse,s),i!==-1?i:null):(i=Xi.call(this._minWeekdaysParse,s),i!==-1?i:null):t==="dddd"?(i=Xi.call(this._weekdaysParse,s),i!==-1||(i=Xi.call(this._shortWeekdaysParse,s),i!==-1)?i:(i=Xi.call(this._minWeekdaysParse,s),i!==-1?i:null)):t==="ddd"?(i=Xi.call(this._shortWeekdaysParse,s),i!==-1||(i=Xi.call(this._weekdaysParse,s),i!==-1)?i:(i=Xi.call(this._minWeekdaysParse,s),i!==-1?i:null)):(i=Xi.call(this._minWeekdaysParse,s),i!==-1||(i=Xi.call(this._weekdaysParse,s),i!==-1)?i:(i=Xi.call(this._shortWeekdaysParse,s),i!==-1?i:null))}function mje(e,t,r){var n,i,o;if(this._weekdaysParseExact)return pje.call(this,e,t,r);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),n=0;n<7;n++){if(i=Ru([2e3,1]).day(n),r&&!this._fullWeekdaysParse[n]&&(this._fullWeekdaysParse[n]=new RegExp("^"+this.weekdays(i,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[n]=new RegExp("^"+this.weekdaysShort(i,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[n]=new RegExp("^"+this.weekdaysMin(i,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[n]||(o="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[n]=new RegExp(o.replace(".",""),"i")),r&&t==="dddd"&&this._fullWeekdaysParse[n].test(e))return n;if(r&&t==="ddd"&&this._shortWeekdaysParse[n].test(e))return n;if(r&&t==="dd"&&this._minWeekdaysParse[n].test(e))return n;if(!r&&this._weekdaysParse[n].test(e))return n}}function gje(e){if(!this.isValid())return e!=null?this:NaN;var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return e!=null?(e=ije(e,this.localeData()),this.add(e-t,"d")):t}function yje(e){if(!this.isValid())return e!=null?this:NaN;var t=(this.day()+7-this.localeData()._week.dow)%7;return e==null?t:this.add(e-t,"d")}function vje(e){if(!this.isValid())return e!=null?this:NaN;if(e!=null){var t=oje(e,this.localeData());return this.day(this.day()%7?t:t-7)}else return this.day()||7}function _je(e){return this._weekdaysParseExact?(Fn(this,"_weekdaysRegex")||QV.call(this),e?this._weekdaysStrictRegex:this._weekdaysRegex):(Fn(this,"_weekdaysRegex")||(this._weekdaysRegex=lje),this._weekdaysStrictRegex&&e?this._weekdaysStrictRegex:this._weekdaysRegex)}function bje(e){return this._weekdaysParseExact?(Fn(this,"_weekdaysRegex")||QV.call(this),e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(Fn(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=uje),this._weekdaysShortStrictRegex&&e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function wje(e){return this._weekdaysParseExact?(Fn(this,"_weekdaysRegex")||QV.call(this),e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(Fn(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=cje),this._weekdaysMinStrictRegex&&e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function QV(){function e(y,S){return S.length-y.length}var t=[],r=[],n=[],i=[],o,s,a,h,p;for(o=0;o<7;o++)s=Ru([2e3,1]).day(o),a=ss(this.weekdaysMin(s,"")),h=ss(this.weekdaysShort(s,"")),p=ss(this.weekdays(s,"")),t.push(a),r.push(h),n.push(p),i.push(a),i.push(h),i.push(p);t.sort(e),r.sort(e),n.sort(e),i.sort(e),this._weekdaysRegex=new RegExp("^("+i.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+t.join("|")+")","i")}function eU(){return this.hours()%12||12}function Sje(){return this.hours()||24}Dr("H",["HH",2],0,"hour");Dr("h",["hh",2],0,eU);Dr("k",["kk",2],0,Sje);Dr("hmm",0,0,function(){return""+eU.apply(this)+xu(this.minutes(),2)});Dr("hmmss",0,0,function(){return""+eU.apply(this)+xu(this.minutes(),2)+xu(this.seconds(),2)});Dr("Hmm",0,0,function(){return""+this.hours()+xu(this.minutes(),2)});Dr("Hmmss",0,0,function(){return""+this.hours()+xu(this.minutes(),2)+xu(this.seconds(),2)});function Jle(e,t){Dr(e,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)})}Jle("a",!0);Jle("A",!1);na("hour","h");ia("hour",13);function Qle(e,t){return t._meridiemParse}br("a",Qle);br("A",Qle);br("H",wi);br("h",wi);br("k",wi);br("HH",wi,vs);br("hh",wi,vs);br("kk",wi,vs);br("hmm",Hle);br("hmmss",Vle);br("Hmm",Hle);br("Hmmss",Vle);ai(["H","HH"],vo);ai(["k","kk"],function(e,t,r){var n=Cn(e);t[vo]=n===24?0:n});ai(["a","A"],function(e,t,r){r._isPm=r._locale.isPM(e),r._meridiem=e});ai(["h","hh"],function(e,t,r){t[vo]=Cn(e),fn(r).bigHour=!0});ai("hmm",function(e,t,r){var n=e.length-2;t[vo]=Cn(e.substr(0,n)),t[xl]=Cn(e.substr(n)),fn(r).bigHour=!0});ai("hmmss",function(e,t,r){var n=e.length-4,i=e.length-2;t[vo]=Cn(e.substr(0,n)),t[xl]=Cn(e.substr(n,2)),t[hc]=Cn(e.substr(i)),fn(r).bigHour=!0});ai("Hmm",function(e,t,r){var n=e.length-2;t[vo]=Cn(e.substr(0,n)),t[xl]=Cn(e.substr(n))});ai("Hmmss",function(e,t,r){var n=e.length-4,i=e.length-2;t[vo]=Cn(e.substr(0,n)),t[xl]=Cn(e.substr(n,2)),t[hc]=Cn(e.substr(i))});function xje(e){return(e+"").toLowerCase().charAt(0)==="p"}var Cje=/[ap]\.?m?\.?/i,Eje=rw("Hours",!0);function Tje(e,t,r){return e>11?r?"pm":"PM":r?"am":"AM"}var eue={calendar:mBe,longDateFormat:_Be,invalidDate:wBe,ordinal:xBe,dayOfMonthOrdinalParse:CBe,relativeTime:TBe,months:FBe,monthsShort:Ule,week:QBe,weekdays:aje,weekdaysMin:sje,weekdaysShort:Zle,meridiemParse:Cje},Ti={},G0={},k1;function Oje(e,t){var r,n=Math.min(e.length,t.length);for(r=0;r<n;r+=1)if(e[r]!==t[r])return r;return n}function Uq(e){return e&&e.toLowerCase().replace("_","-")}function Rje(e){for(var t=0,r,n,i,o;t<e.length;){for(o=Uq(e[t]).split("-"),r=o.length,n=Uq(e[t+1]),n=n?n.split("-"):null;r>0;){if(i=nM(o.slice(0,r).join("-")),i)return i;if(n&&n.length>=r&&Oje(o,n)>=r-1)break;r--}t++}return k1}function kje(e){return e.match("^[^/\\\\]*$")!=null}function nM(e){var t=null,r;if(Ti[e]===void 0&&typeof rP<"u"&&rP&&rP.exports&&kje(e))try{t=k1._abbr,r=require,r("./locale/"+e),Sh(t)}catch{Ti[e]=null}return Ti[e]}function Sh(e,t){var r;return e&&(La(t)?r=nf(e):r=tU(e,t),r?k1=r:typeof console<"u"&&console.warn&&console.warn("Locale "+e+" not found. Did you forget to load it?")),k1._abbr}function tU(e,t){if(t!==null){var r,n=eue;if(t.abbr=e,Ti[e]!=null)Lle("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),n=Ti[e]._config;else if(t.parentLocale!=null)if(Ti[t.parentLocale]!=null)n=Ti[t.parentLocale]._config;else if(r=nM(t.parentLocale),r!=null)n=r._config;else return G0[t.parentLocale]||(G0[t.parentLocale]=[]),G0[t.parentLocale].push({name:e,config:t}),null;return Ti[e]=new YV(fj(n,t)),G0[e]&&G0[e].forEach(function(i){tU(i.name,i.config)}),Sh(e),Ti[e]}else return delete Ti[e],null}function Pje(e,t){if(t!=null){var r,n,i=eue;Ti[e]!=null&&Ti[e].parentLocale!=null?Ti[e].set(fj(Ti[e]._config,t)):(n=nM(e),n!=null&&(i=n._config),t=fj(i,t),n==null&&(t.abbr=e),r=new YV(t),r.parentLocale=Ti[e],Ti[e]=r),Sh(e)}else Ti[e]!=null&&(Ti[e].parentLocale!=null?(Ti[e]=Ti[e].parentLocale,e===Sh()&&Sh(e)):Ti[e]!=null&&delete Ti[e]);return Ti[e]}function nf(e){var t;if(e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr),!e)return k1;if(!Ol(e)){if(t=nM(e),t)return t;e=[e]}return Rje(e)}function Aje(){return hj(Ti)}function rU(e){var t,r=e._a;return r&&fn(e).overflow===-2&&(t=r[fc]<0||r[fc]>11?fc:r[pu]<1||r[pu]>rM(r[ta],r[fc])?pu:r[vo]<0||r[vo]>24||r[vo]===24&&(r[xl]!==0||r[hc]!==0||r[wp]!==0)?vo:r[xl]<0||r[xl]>59?xl:r[hc]<0||r[hc]>59?hc:r[wp]<0||r[wp]>999?wp:-1,fn(e)._overflowDayOfYear&&(t<ta||t>pu)&&(t=pu),fn(e)._overflowWeeks&&t===-1&&(t=NBe),fn(e)._overflowWeekday&&t===-1&&(t=BBe),fn(e).overflow=t),e}var Ije=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Mje=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,$je=/Z|[+-]\d\d(?::?\d\d)?/,fR=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],V2=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],Dje=/^\/?Date\((-?\d+)/i,Lje=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,Nje={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function tue(e){var t,r,n=e._i,i=Ije.exec(n)||Mje.exec(n),o,s,a,h,p=fR.length,y=V2.length;if(i){for(fn(e).iso=!0,t=0,r=p;t<r;t++)if(fR[t][1].exec(i[1])){s=fR[t][0],o=fR[t][2]!==!1;break}if(s==null){e._isValid=!1;return}if(i[3]){for(t=0,r=y;t<r;t++)if(V2[t][1].exec(i[3])){a=(i[2]||" ")+V2[t][0];break}if(a==null){e._isValid=!1;return}}if(!o&&a!=null){e._isValid=!1;return}if(i[4])if($je.exec(i[4]))h="Z";else{e._isValid=!1;return}e._f=s+(a||"")+(h||""),iU(e)}else e._isValid=!1}function Bje(e,t,r,n,i,o){var s=[jje(e),Ule.indexOf(t),parseInt(r,10),parseInt(n,10),parseInt(i,10)];return o&&s.push(parseInt(o,10)),s}function jje(e){var t=parseInt(e,10);return t<=49?2e3+t:t<=999?1900+t:t}function Fje(e){return e.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function zje(e,t,r){if(e){var n=Zle.indexOf(e),i=new Date(t[0],t[1],t[2]).getDay();if(n!==i)return fn(r).weekdayMismatch=!0,r._isValid=!1,!1}return!0}function Hje(e,t,r){if(e)return Nje[e];if(t)return 0;var n=parseInt(r,10),i=n%100,o=(n-i)/100;return o*60+i}function rue(e){var t=Lje.exec(Fje(e._i)),r;if(t){if(r=Bje(t[4],t[3],t[2],t[5],t[6],t[7]),!zje(t[1],r,e))return;e._a=r,e._tzm=Hje(t[8],t[9],t[10]),e._d=O1.apply(null,e._a),e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),fn(e).rfc2822=!0}else e._isValid=!1}function Vje(e){var t=Dje.exec(e._i);if(t!==null){e._d=new Date(+t[1]);return}if(tue(e),e._isValid===!1)delete e._isValid;else return;if(rue(e),e._isValid===!1)delete e._isValid;else return;e._strict?e._isValid=!1:Ut.createFromInputFallback(e)}Ut.createFromInputFallback=qs("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))});function Py(e,t,r){return e??t??r}function Uje(e){var t=new Date(Ut.now());return e._useUTC?[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()]:[t.getFullYear(),t.getMonth(),t.getDate()]}function nU(e){var t,r,n=[],i,o,s;if(!e._d){for(i=Uje(e),e._w&&e._a[pu]==null&&e._a[fc]==null&&Wje(e),e._dayOfYear!=null&&(s=Py(e._a[ta],i[ta]),(e._dayOfYear>VS(s)||e._dayOfYear===0)&&(fn(e)._overflowDayOfYear=!0),r=O1(s,0,e._dayOfYear),e._a[fc]=r.getUTCMonth(),e._a[pu]=r.getUTCDate()),t=0;t<3&&e._a[t]==null;++t)e._a[t]=n[t]=i[t];for(;t<7;t++)e._a[t]=n[t]=e._a[t]==null?t===2?1:0:e._a[t];e._a[vo]===24&&e._a[xl]===0&&e._a[hc]===0&&e._a[wp]===0&&(e._nextDay=!0,e._a[vo]=0),e._d=(e._useUTC?O1:ZBe).apply(null,n),o=e._useUTC?e._d.getUTCDay():e._d.getDay(),e._tzm!=null&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),e._nextDay&&(e._a[vo]=24),e._w&&typeof e._w.d<"u"&&e._w.d!==o&&(fn(e).weekdayMismatch=!0)}}function Wje(e){var t,r,n,i,o,s,a,h,p;t=e._w,t.GG!=null||t.W!=null||t.E!=null?(o=1,s=4,r=Py(t.GG,e._a[ta],R1(_i(),1,4).year),n=Py(t.W,1),i=Py(t.E,1),(i<1||i>7)&&(h=!0)):(o=e._locale._week.dow,s=e._locale._week.doy,p=R1(_i(),o,s),r=Py(t.gg,e._a[ta],p.year),n=Py(t.w,p.week),t.d!=null?(i=t.d,(i<0||i>6)&&(h=!0)):t.e!=null?(i=t.e+o,(t.e<0||t.e>6)&&(h=!0)):i=o),n<1||n>zc(r,o,s)?fn(e)._overflowWeeks=!0:h!=null?fn(e)._overflowWeekday=!0:(a=Xle(r,n,i,o,s),e._a[ta]=a.year,e._dayOfYear=a.dayOfYear)}Ut.ISO_8601=function(){};Ut.RFC_2822=function(){};function iU(e){if(e._f===Ut.ISO_8601){tue(e);return}if(e._f===Ut.RFC_2822){rue(e);return}e._a=[],fn(e).empty=!0;var t=""+e._i,r,n,i,o,s,a=t.length,h=0,p,y;for(i=Nle(e._f,e._locale).match(KV)||[],y=i.length,r=0;r<y;r++)o=i[r],n=(t.match($Be(o,e))||[])[0],n&&(s=t.substr(0,t.indexOf(n)),s.length>0&&fn(e).unusedInput.push(s),t=t.slice(t.indexOf(n)+n.length),h+=n.length),ov[o]?(n?fn(e).empty=!1:fn(e).unusedTokens.push(o),LBe(o,n,e)):e._strict&&!n&&fn(e).unusedTokens.push(o);fn(e).charsLeftOver=a-h,t.length>0&&fn(e).unusedInput.push(t),e._a[vo]<=12&&fn(e).bigHour===!0&&e._a[vo]>0&&(fn(e).bigHour=void 0),fn(e).parsedDateParts=e._a.slice(0),fn(e).meridiem=e._meridiem,e._a[vo]=Gje(e._locale,e._a[vo],e._meridiem),p=fn(e).era,p!==null&&(e._a[ta]=e._locale.erasConvertYear(p,e._a[ta])),nU(e),rU(e)}function Gje(e,t,r){var n;return r==null?t:e.meridiemHour!=null?e.meridiemHour(t,r):(e.isPM!=null&&(n=e.isPM(r),n&&t<12&&(t+=12),!n&&t===12&&(t=0)),t)}function Yje(e){var t,r,n,i,o,s,a=!1,h=e._f.length;if(h===0){fn(e).invalidFormat=!0,e._d=new Date(NaN);return}for(i=0;i<h;i++)o=0,s=!1,t=GV({},e),e._useUTC!=null&&(t._useUTC=e._useUTC),t._f=e._f[i],iU(t),WV(t)&&(s=!0),o+=fn(t).charsLeftOver,o+=fn(t).unusedTokens.length*10,fn(t).score=o,a?o<n&&(n=o,r=t):(n==null||o<n||s)&&(n=o,r=t,s&&(a=!0));uh(e,r||t)}function Kje(e){if(!e._d){var t=qV(e._i),r=t.day===void 0?t.date:t.day;e._a=$le([t.year,t.month,r,t.hour,t.minute,t.second,t.millisecond],function(n){return n&&parseInt(n,10)}),nU(e)}}function qje(e){var t=new gE(rU(nue(e)));return t._nextDay&&(t.add(1,"d"),t._nextDay=void 0),t}function nue(e){var t=e._i,r=e._f;return e._locale=e._locale||nf(e._l),t===null||r===void 0&&t===""?qI({nullInput:!0}):(typeof t=="string"&&(e._i=t=e._locale.preparse(t)),Rl(t)?new gE(rU(t)):(mE(t)?e._d=t:Ol(r)?Yje(e):r?iU(e):Xje(e),WV(e)||(e._d=null),e))}function Xje(e){var t=e._i;La(t)?e._d=new Date(Ut.now()):mE(t)?e._d=new Date(t.valueOf()):typeof t=="string"?Vje(e):Ol(t)?(e._a=$le(t.slice(0),function(r){return parseInt(r,10)}),nU(e)):Jp(t)?Kje(e):Xc(t)?e._d=new Date(t):Ut.createFromInputFallback(e)}function iue(e,t,r,n,i){var o={};return(t===!0||t===!1)&&(n=t,t=void 0),(r===!0||r===!1)&&(n=r,r=void 0),(Jp(e)&&UV(e)||Ol(e)&&e.length===0)&&(e=void 0),o._isAMomentObject=!0,o._useUTC=o._isUTC=i,o._l=r,o._i=e,o._f=t,o._strict=n,qje(o)}function _i(e,t,r,n){return iue(e,t,r,n,!1)}var Zje=qs("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=_i.apply(null,arguments);return this.isValid()&&e.isValid()?e<this?this:e:qI()}),Jje=qs("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=_i.apply(null,arguments);return this.isValid()&&e.isValid()?e>this?this:e:qI()});function oue(e,t){var r,n;if(t.length===1&&Ol(t[0])&&(t=t[0]),!t.length)return _i();for(r=t[0],n=1;n<t.length;++n)(!t[n].isValid()||t[n][e](r))&&(r=t[n]);return r}function Qje(){var e=[].slice.call(arguments,0);return oue("isBefore",e)}function eFe(){var e=[].slice.call(arguments,0);return oue("isAfter",e)}var tFe=function(){return Date.now?Date.now():+new Date},Y0=["year","quarter","month","week","day","hour","minute","second","millisecond"];function rFe(e){var t,r=!1,n,i=Y0.length;for(t in e)if(Fn(e,t)&&!(Xi.call(Y0,t)!==-1&&(e[t]==null||!isNaN(e[t]))))return!1;for(n=0;n<i;++n)if(e[Y0[n]]){if(r)return!1;parseFloat(e[Y0[n]])!==Cn(e[Y0[n]])&&(r=!0)}return!0}function nFe(){return this._isValid}function iFe(){return Ml(NaN)}function iM(e){var t=qV(e),r=t.year||0,n=t.quarter||0,i=t.month||0,o=t.week||t.isoWeek||0,s=t.day||0,a=t.hour||0,h=t.minute||0,p=t.second||0,y=t.millisecond||0;this._isValid=rFe(t),this._milliseconds=+y+p*1e3+h*6e4+a*1e3*60*60,this._days=+s+o*7,this._months=+i+n*3+r*12,this._data={},this._locale=nf(),this._bubble()}function Sk(e){return e instanceof iM}function pj(e){return e<0?Math.round(-1*e)*-1:Math.round(e)}function oFe(e,t,r){var n=Math.min(e.length,t.length),i=Math.abs(e.length-t.length),o=0,s;for(s=0;s<n;s++)(r&&e[s]!==t[s]||!r&&Cn(e[s])!==Cn(t[s]))&&o++;return o+i}function aue(e,t){Dr(e,0,0,function(){var r=this.utcOffset(),n="+";return r<0&&(r=-r,n="-"),n+xu(~~(r/60),2)+t+xu(~~r%60,2)})}aue("Z",":");aue("ZZ","");br("Z",tM);br("ZZ",tM);ai(["Z","ZZ"],function(e,t,r){r._useUTC=!0,r._tzm=oU(tM,e)});var aFe=/([\+\-]|\d\d)/gi;function oU(e,t){var r=(t||"").match(e),n,i,o;return r===null?null:(n=r[r.length-1]||[],i=(n+"").match(aFe)||["-",0,0],o=+(i[1]*60)+Cn(i[2]),o===0?0:i[0]==="+"?o:-o)}function aU(e,t){var r,n;return t._isUTC?(r=t.clone(),n=(Rl(e)||mE(e)?e.valueOf():_i(e).valueOf())-r.valueOf(),r._d.setTime(r._d.valueOf()+n),Ut.updateOffset(r,!1),r):_i(e).local()}function mj(e){return-Math.round(e._d.getTimezoneOffset())}Ut.updateOffset=function(){};function sFe(e,t,r){var n=this._offset||0,i;if(!this.isValid())return e!=null?this:NaN;if(e!=null){if(typeof e=="string"){if(e=oU(tM,e),e===null)return this}else Math.abs(e)<16&&!r&&(e=e*60);return!this._isUTC&&t&&(i=mj(this)),this._offset=e,this._isUTC=!0,i!=null&&this.add(i,"m"),n!==e&&(!t||this._changeInProgress?uue(this,Ml(e-n,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,Ut.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?n:mj(this)}function lFe(e,t){return e!=null?(typeof e!="string"&&(e=-e),this.utcOffset(e,t),this):-this.utcOffset()}function uFe(e){return this.utcOffset(0,e)}function cFe(e){return this._isUTC&&(this.utcOffset(0,e),this._isUTC=!1,e&&this.subtract(mj(this),"m")),this}function fFe(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var e=oU(IBe,this._i);e!=null?this.utcOffset(e):this.utcOffset(0,!0)}return this}function hFe(e){return this.isValid()?(e=e?_i(e).utcOffset():0,(this.utcOffset()-e)%60===0):!1}function dFe(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function pFe(){if(!La(this._isDSTShifted))return this._isDSTShifted;var e={},t;return GV(e,this),e=nue(e),e._a?(t=e._isUTC?Ru(e._a):_i(e._a),this._isDSTShifted=this.isValid()&&oFe(e._a,t.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function mFe(){return this.isValid()?!this._isUTC:!1}function gFe(){return this.isValid()?this._isUTC:!1}function sue(){return this.isValid()?this._isUTC&&this._offset===0:!1}var yFe=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,vFe=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function Ml(e,t){var r=e,n=null,i,o,s;return Sk(e)?r={ms:e._milliseconds,d:e._days,M:e._months}:Xc(e)||!isNaN(+e)?(r={},t?r[t]=+e:r.milliseconds=+e):(n=yFe.exec(e))?(i=n[1]==="-"?-1:1,r={y:0,d:Cn(n[pu])*i,h:Cn(n[vo])*i,m:Cn(n[xl])*i,s:Cn(n[hc])*i,ms:Cn(pj(n[wp]*1e3))*i}):(n=vFe.exec(e))?(i=n[1]==="-"?-1:1,r={y:Wd(n[2],i),M:Wd(n[3],i),w:Wd(n[4],i),d:Wd(n[5],i),h:Wd(n[6],i),m:Wd(n[7],i),s:Wd(n[8],i)}):r==null?r={}:typeof r=="object"&&("from"in r||"to"in r)&&(s=_Fe(_i(r.from),_i(r.to)),r={},r.ms=s.milliseconds,r.M=s.months),o=new iM(r),Sk(e)&&Fn(e,"_locale")&&(o._locale=e._locale),Sk(e)&&Fn(e,"_isValid")&&(o._isValid=e._isValid),o}Ml.fn=iM.prototype;Ml.invalid=iFe;function Wd(e,t){var r=e&&parseFloat(e.replace(",","."));return(isNaN(r)?0:r)*t}function Wq(e,t){var r={};return r.months=t.month()-e.month()+(t.year()-e.year())*12,e.clone().add(r.months,"M").isAfter(t)&&--r.months,r.milliseconds=+t-+e.clone().add(r.months,"M"),r}function _Fe(e,t){var r;return e.isValid()&&t.isValid()?(t=aU(t,e),e.isBefore(t)?r=Wq(e,t):(r=Wq(t,e),r.milliseconds=-r.milliseconds,r.months=-r.months),r):{milliseconds:0,months:0}}function lue(e,t){return function(r,n){var i,o;return n!==null&&!isNaN(+n)&&(Lle(t,"moment()."+t+"(period, number) is deprecated. Please use moment()."+t+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),o=r,r=n,n=o),i=Ml(r,n),uue(this,i,e),this}}function uue(e,t,r,n){var i=t._milliseconds,o=pj(t._days),s=pj(t._months);e.isValid()&&(n=n??!0,s&&Gle(e,NP(e,"Month")+s*r),o&&jle(e,"Date",NP(e,"Date")+o*r),i&&e._d.setTime(e._d.valueOf()+i*r),n&&Ut.updateOffset(e,o||s))}var bFe=lue(1,"add"),wFe=lue(-1,"subtract");function cue(e){return typeof e=="string"||e instanceof String}function SFe(e){return Rl(e)||mE(e)||cue(e)||Xc(e)||CFe(e)||xFe(e)||e===null||e===void 0}function xFe(e){var t=Jp(e)&&!UV(e),r=!1,n=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],i,o,s=n.length;for(i=0;i<s;i+=1)o=n[i],r=r||Fn(e,o);return t&&r}function CFe(e){var t=Ol(e),r=!1;return t&&(r=e.filter(function(n){return!Xc(n)&&cue(e)}).length===0),t&&r}function EFe(e){var t=Jp(e)&&!UV(e),r=!1,n=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],i,o;for(i=0;i<n.length;i+=1)o=n[i],r=r||Fn(e,o);return t&&r}function TFe(e,t){var r=e.diff(t,"days",!0);return r<-6?"sameElse":r<-1?"lastWeek":r<0?"lastDay":r<1?"sameDay":r<2?"nextDay":r<7?"nextWeek":"sameElse"}function OFe(e,t){arguments.length===1&&(arguments[0]?SFe(arguments[0])?(e=arguments[0],t=void 0):EFe(arguments[0])&&(t=arguments[0],e=void 0):(e=void 0,t=void 0));var r=e||_i(),n=aU(r,this).startOf("day"),i=Ut.calendarFormat(this,n)||"sameElse",o=t&&(ku(t[i])?t[i].call(this,r):t[i]);return this.format(o||this.localeData().calendar(i,this,_i(r)))}function RFe(){return new gE(this)}function kFe(e,t){var r=Rl(e)?e:_i(e);return this.isValid()&&r.isValid()?(t=Xs(t)||"millisecond",t==="millisecond"?this.valueOf()>r.valueOf():r.valueOf()<this.clone().startOf(t).valueOf()):!1}function PFe(e,t){var r=Rl(e)?e:_i(e);return this.isValid()&&r.isValid()?(t=Xs(t)||"millisecond",t==="millisecond"?this.valueOf()<r.valueOf():this.clone().endOf(t).valueOf()<r.valueOf()):!1}function AFe(e,t,r,n){var i=Rl(e)?e:_i(e),o=Rl(t)?t:_i(t);return this.isValid()&&i.isValid()&&o.isValid()?(n=n||"()",(n[0]==="("?this.isAfter(i,r):!this.isBefore(i,r))&&(n[1]===")"?this.isBefore(o,r):!this.isAfter(o,r))):!1}function IFe(e,t){var r=Rl(e)?e:_i(e),n;return this.isValid()&&r.isValid()?(t=Xs(t)||"millisecond",t==="millisecond"?this.valueOf()===r.valueOf():(n=r.valueOf(),this.clone().startOf(t).valueOf()<=n&&n<=this.clone().endOf(t).valueOf())):!1}function MFe(e,t){return this.isSame(e,t)||this.isAfter(e,t)}function $Fe(e,t){return this.isSame(e,t)||this.isBefore(e,t)}function DFe(e,t,r){var n,i,o;if(!this.isValid())return NaN;if(n=aU(e,this),!n.isValid())return NaN;switch(i=(n.utcOffset()-this.utcOffset())*6e4,t=Xs(t),t){case"year":o=xk(this,n)/12;break;case"month":o=xk(this,n);break;case"quarter":o=xk(this,n)/3;break;case"second":o=(this-n)/1e3;break;case"minute":o=(this-n)/6e4;break;case"hour":o=(this-n)/36e5;break;case"day":o=(this-n-i)/864e5;break;case"week":o=(this-n-i)/6048e5;break;default:o=this-n}return r?o:Ds(o)}function xk(e,t){if(e.date()<t.date())return-xk(t,e);var r=(t.year()-e.year())*12+(t.month()-e.month()),n=e.clone().add(r,"months"),i,o;return t-n<0?(i=e.clone().add(r-1,"months"),o=(t-n)/(n-i)):(i=e.clone().add(r+1,"months"),o=(t-n)/(i-n)),-(r+o)||0}Ut.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";Ut.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function LFe(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function NFe(e){if(!this.isValid())return null;var t=e!==!0,r=t?this.clone().utc():this;return r.year()<0||r.year()>9999?wk(r,t?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):ku(Date.prototype.toISOString)?t?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",wk(r,"Z")):wk(r,t?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function BFe(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var e="moment",t="",r,n,i,o;return this.isLocal()||(e=this.utcOffset()===0?"moment.utc":"moment.parseZone",t="Z"),r="["+e+'("]',n=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",i="-MM-DD[T]HH:mm:ss.SSS",o=t+'[")]',this.format(r+n+i+o)}function jFe(e){e||(e=this.isUtc()?Ut.defaultFormatUtc:Ut.defaultFormat);var t=wk(this,e);return this.localeData().postformat(t)}function FFe(e,t){return this.isValid()&&(Rl(e)&&e.isValid()||_i(e).isValid())?Ml({to:this,from:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function zFe(e){return this.from(_i(),e)}function HFe(e,t){return this.isValid()&&(Rl(e)&&e.isValid()||_i(e).isValid())?Ml({from:this,to:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function VFe(e){return this.to(_i(),e)}function fue(e){var t;return e===void 0?this._locale._abbr:(t=nf(e),t!=null&&(this._locale=t),this)}var hue=qs("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(e){return e===void 0?this.localeData():this.locale(e)});function due(){return this._locale}var FP=1e3,av=60*FP,zP=60*av,pue=(365*400+97)*24*zP;function sv(e,t){return(e%t+t)%t}function mue(e,t,r){return e<100&&e>=0?new Date(e+400,t,r)-pue:new Date(e,t,r).valueOf()}function gue(e,t,r){return e<100&&e>=0?Date.UTC(e+400,t,r)-pue:Date.UTC(e,t,r)}function UFe(e){var t,r;if(e=Xs(e),e===void 0||e==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?gue:mue,e){case"year":t=r(this.year(),0,1);break;case"quarter":t=r(this.year(),this.month()-this.month()%3,1);break;case"month":t=r(this.year(),this.month(),1);break;case"week":t=r(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":t=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":t=r(this.year(),this.month(),this.date());break;case"hour":t=this._d.valueOf(),t-=sv(t+(this._isUTC?0:this.utcOffset()*av),zP);break;case"minute":t=this._d.valueOf(),t-=sv(t,av);break;case"second":t=this._d.valueOf(),t-=sv(t,FP);break}return this._d.setTime(t),Ut.updateOffset(this,!0),this}function WFe(e){var t,r;if(e=Xs(e),e===void 0||e==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?gue:mue,e){case"year":t=r(this.year()+1,0,1)-1;break;case"quarter":t=r(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":t=r(this.year(),this.month()+1,1)-1;break;case"week":t=r(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":t=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":t=r(this.year(),this.month(),this.date()+1)-1;break;case"hour":t=this._d.valueOf(),t+=zP-sv(t+(this._isUTC?0:this.utcOffset()*av),zP)-1;break;case"minute":t=this._d.valueOf(),t+=av-sv(t,av)-1;break;case"second":t=this._d.valueOf(),t+=FP-sv(t,FP)-1;break}return this._d.setTime(t),Ut.updateOffset(this,!0),this}function GFe(){return this._d.valueOf()-(this._offset||0)*6e4}function YFe(){return Math.floor(this.valueOf()/1e3)}function KFe(){return new Date(this.valueOf())}function qFe(){var e=this;return[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]}function XFe(){var e=this;return{years:e.year(),months:e.month(),date:e.date(),hours:e.hours(),minutes:e.minutes(),seconds:e.seconds(),milliseconds:e.milliseconds()}}function ZFe(){return this.isValid()?this.toISOString():null}function JFe(){return WV(this)}function QFe(){return uh({},fn(this))}function eze(){return fn(this).overflow}function tze(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}Dr("N",0,0,"eraAbbr");Dr("NN",0,0,"eraAbbr");Dr("NNN",0,0,"eraAbbr");Dr("NNNN",0,0,"eraName");Dr("NNNNN",0,0,"eraNarrow");Dr("y",["y",1],"yo","eraYear");Dr("y",["yy",2],0,"eraYear");Dr("y",["yyy",3],0,"eraYear");Dr("y",["yyyy",4],0,"eraYear");br("N",sU);br("NN",sU);br("NNN",sU);br("NNNN",hze);br("NNNNN",dze);ai(["N","NN","NNN","NNNN","NNNNN"],function(e,t,r,n){var i=r._locale.erasParse(e,n,r._strict);i?fn(r).era=i:fn(r).invalidEra=e});br("y",nw);br("yy",nw);br("yyy",nw);br("yyyy",nw);br("yo",pze);ai(["y","yy","yyy","yyyy"],ta);ai(["yo"],function(e,t,r,n){var i;r._locale._eraYearOrdinalRegex&&(i=e.match(r._locale._eraYearOrdinalRegex)),r._locale.eraYearOrdinalParse?t[ta]=r._locale.eraYearOrdinalParse(e,i):t[ta]=parseInt(e,10)});function rze(e,t){var r,n,i,o=this._eras||nf("en")._eras;for(r=0,n=o.length;r<n;++r){switch(typeof o[r].since){case"string":i=Ut(o[r].since).startOf("day"),o[r].since=i.valueOf();break}switch(typeof o[r].until){case"undefined":o[r].until=1/0;break;case"string":i=Ut(o[r].until).startOf("day").valueOf(),o[r].until=i.valueOf();break}}return o}function nze(e,t,r){var n,i,o=this.eras(),s,a,h;for(e=e.toUpperCase(),n=0,i=o.length;n<i;++n)if(s=o[n].name.toUpperCase(),a=o[n].abbr.toUpperCase(),h=o[n].narrow.toUpperCase(),r)switch(t){case"N":case"NN":case"NNN":if(a===e)return o[n];break;case"NNNN":if(s===e)return o[n];break;case"NNNNN":if(h===e)return o[n];break}else if([s,a,h].indexOf(e)>=0)return o[n]}function ize(e,t){var r=e.since<=e.until?1:-1;return t===void 0?Ut(e.since).year():Ut(e.since).year()+(t-e.offset)*r}function oze(){var e,t,r,n=this.localeData().eras();for(e=0,t=n.length;e<t;++e)if(r=this.clone().startOf("day").valueOf(),n[e].since<=r&&r<=n[e].until||n[e].until<=r&&r<=n[e].since)return n[e].name;return""}function aze(){var e,t,r,n=this.localeData().eras();for(e=0,t=n.length;e<t;++e)if(r=this.clone().startOf("day").valueOf(),n[e].since<=r&&r<=n[e].until||n[e].until<=r&&r<=n[e].since)return n[e].narrow;return""}function sze(){var e,t,r,n=this.localeData().eras();for(e=0,t=n.length;e<t;++e)if(r=this.clone().startOf("day").valueOf(),n[e].since<=r&&r<=n[e].until||n[e].until<=r&&r<=n[e].since)return n[e].abbr;return""}function lze(){var e,t,r,n,i=this.localeData().eras();for(e=0,t=i.length;e<t;++e)if(r=i[e].since<=i[e].until?1:-1,n=this.clone().startOf("day").valueOf(),i[e].since<=n&&n<=i[e].until||i[e].until<=n&&n<=i[e].since)return(this.year()-Ut(i[e].since).year())*r+i[e].offset;return this.year()}function uze(e){return Fn(this,"_erasNameRegex")||lU.call(this),e?this._erasNameRegex:this._erasRegex}function cze(e){return Fn(this,"_erasAbbrRegex")||lU.call(this),e?this._erasAbbrRegex:this._erasRegex}function fze(e){return Fn(this,"_erasNarrowRegex")||lU.call(this),e?this._erasNarrowRegex:this._erasRegex}function sU(e,t){return t.erasAbbrRegex(e)}function hze(e,t){return t.erasNameRegex(e)}function dze(e,t){return t.erasNarrowRegex(e)}function pze(e,t){return t._eraYearOrdinalRegex||nw}function lU(){var e=[],t=[],r=[],n=[],i,o,s=this.eras();for(i=0,o=s.length;i<o;++i)t.push(ss(s[i].name)),e.push(ss(s[i].abbr)),r.push(ss(s[i].narrow)),n.push(ss(s[i].name)),n.push(ss(s[i].abbr)),n.push(ss(s[i].narrow));this._erasRegex=new RegExp("^("+n.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+t.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+e.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+r.join("|")+")","i")}Dr(0,["gg",2],0,function(){return this.weekYear()%100});Dr(0,["GG",2],0,function(){return this.isoWeekYear()%100});function oM(e,t){Dr(0,[e,e.length],0,t)}oM("gggg","weekYear");oM("ggggg","weekYear");oM("GGGG","isoWeekYear");oM("GGGGG","isoWeekYear");na("weekYear","gg");na("isoWeekYear","GG");ia("weekYear",1);ia("isoWeekYear",1);br("G",eM);br("g",eM);br("GG",wi,vs);br("gg",wi,vs);br("GGGG",ZV,XV);br("gggg",ZV,XV);br("GGGGG",QI,ZI);br("ggggg",QI,ZI);vE(["gggg","ggggg","GGGG","GGGGG"],function(e,t,r,n){t[n.substr(0,2)]=Cn(e)});vE(["gg","GG"],function(e,t,r,n){t[n]=Ut.parseTwoDigitYear(e)});function mze(e){return yue.call(this,e,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function gze(e){return yue.call(this,e,this.isoWeek(),this.isoWeekday(),1,4)}function yze(){return zc(this.year(),1,4)}function vze(){return zc(this.isoWeekYear(),1,4)}function _ze(){var e=this.localeData()._week;return zc(this.year(),e.dow,e.doy)}function bze(){var e=this.localeData()._week;return zc(this.weekYear(),e.dow,e.doy)}function yue(e,t,r,n,i){var o;return e==null?R1(this,n,i).year:(o=zc(e,n,i),t>o&&(t=o),wze.call(this,e,t,r,n,i))}function wze(e,t,r,n,i){var o=Xle(e,t,r,n,i),s=O1(o.year,0,o.dayOfYear);return this.year(s.getUTCFullYear()),this.month(s.getUTCMonth()),this.date(s.getUTCDate()),this}Dr("Q",0,"Qo","quarter");na("quarter","Q");ia("quarter",7);br("Q",Fle);ai("Q",function(e,t){t[fc]=(Cn(e)-1)*3});function Sze(e){return e==null?Math.ceil((this.month()+1)/3):this.month((e-1)*3+this.month()%3)}Dr("D",["DD",2],"Do","date");na("date","D");ia("date",9);br("D",wi);br("DD",wi,vs);br("Do",function(e,t){return e?t._dayOfMonthOrdinalParse||t._ordinalParse:t._dayOfMonthOrdinalParseLenient});ai(["D","DD"],pu);ai("Do",function(e,t){t[pu]=Cn(e.match(wi)[0])});var vue=rw("Date",!0);Dr("DDD",["DDDD",3],"DDDo","dayOfYear");na("dayOfYear","DDD");ia("dayOfYear",4);br("DDD",JI);br("DDDD",zle);ai(["DDD","DDDD"],function(e,t,r){r._dayOfYear=Cn(e)});function xze(e){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return e==null?t:this.add(e-t,"d")}Dr("m",["mm",2],0,"minute");na("minute","m");ia("minute",14);br("m",wi);br("mm",wi,vs);ai(["m","mm"],xl);var Cze=rw("Minutes",!1);Dr("s",["ss",2],0,"second");na("second","s");ia("second",15);br("s",wi);br("ss",wi,vs);ai(["s","ss"],hc);var Eze=rw("Seconds",!1);Dr("S",0,0,function(){return~~(this.millisecond()/100)});Dr(0,["SS",2],0,function(){return~~(this.millisecond()/10)});Dr(0,["SSS",3],0,"millisecond");Dr(0,["SSSS",4],0,function(){return this.millisecond()*10});Dr(0,["SSSSS",5],0,function(){return this.millisecond()*100});Dr(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});Dr(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});Dr(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});Dr(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});na("millisecond","ms");ia("millisecond",16);br("S",JI,Fle);br("SS",JI,vs);br("SSS",JI,zle);var ch,_ue;for(ch="SSSS";ch.length<=9;ch+="S")br(ch,nw);function Tze(e,t){t[wp]=Cn(("0."+e)*1e3)}for(ch="S";ch.length<=9;ch+="S")ai(ch,Tze);_ue=rw("Milliseconds",!1);Dr("z",0,0,"zoneAbbr");Dr("zz",0,0,"zoneName");function Oze(){return this._isUTC?"UTC":""}function Rze(){return this._isUTC?"Coordinated Universal Time":""}var Jt=gE.prototype;Jt.add=bFe;Jt.calendar=OFe;Jt.clone=RFe;Jt.diff=DFe;Jt.endOf=WFe;Jt.format=jFe;Jt.from=FFe;Jt.fromNow=zFe;Jt.to=HFe;Jt.toNow=VFe;Jt.get=PBe;Jt.invalidAt=eze;Jt.isAfter=kFe;Jt.isBefore=PFe;Jt.isBetween=AFe;Jt.isSame=IFe;Jt.isSameOrAfter=MFe;Jt.isSameOrBefore=$Fe;Jt.isValid=JFe;Jt.lang=hue;Jt.locale=fue;Jt.localeData=due;Jt.max=Jje;Jt.min=Zje;Jt.parsingFlags=QFe;Jt.set=ABe;Jt.startOf=UFe;Jt.subtract=wFe;Jt.toArray=qFe;Jt.toObject=XFe;Jt.toDate=KFe;Jt.toISOString=NFe;Jt.inspect=BFe;typeof Symbol<"u"&&Symbol.for!=null&&(Jt[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});Jt.toJSON=ZFe;Jt.toString=LFe;Jt.unix=YFe;Jt.valueOf=GFe;Jt.creationData=tze;Jt.eraName=oze;Jt.eraNarrow=aze;Jt.eraAbbr=sze;Jt.eraYear=lze;Jt.year=qle;Jt.isLeapYear=XBe;Jt.weekYear=mze;Jt.isoWeekYear=gze;Jt.quarter=Jt.quarters=Sze;Jt.month=Yle;Jt.daysInMonth=YBe;Jt.week=Jt.weeks=rje;Jt.isoWeek=Jt.isoWeeks=nje;Jt.weeksInYear=_ze;Jt.weeksInWeekYear=bze;Jt.isoWeeksInYear=yze;Jt.isoWeeksInISOWeekYear=vze;Jt.date=vue;Jt.day=Jt.days=gje;Jt.weekday=yje;Jt.isoWeekday=vje;Jt.dayOfYear=xze;Jt.hour=Jt.hours=Eje;Jt.minute=Jt.minutes=Cze;Jt.second=Jt.seconds=Eze;Jt.millisecond=Jt.milliseconds=_ue;Jt.utcOffset=sFe;Jt.utc=uFe;Jt.local=cFe;Jt.parseZone=fFe;Jt.hasAlignedHourOffset=hFe;Jt.isDST=dFe;Jt.isLocal=mFe;Jt.isUtcOffset=gFe;Jt.isUtc=sue;Jt.isUTC=sue;Jt.zoneAbbr=Oze;Jt.zoneName=Rze;Jt.dates=qs("dates accessor is deprecated. Use date instead.",vue);Jt.months=qs("months accessor is deprecated. Use month instead",Yle);Jt.years=qs("years accessor is deprecated. Use year instead",qle);Jt.zone=qs("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",lFe);Jt.isDSTShifted=qs("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",pFe);function kze(e){return _i(e*1e3)}function Pze(){return _i.apply(null,arguments).parseZone()}function bue(e){return e}var zn=YV.prototype;zn.calendar=gBe;zn.longDateFormat=bBe;zn.invalidDate=SBe;zn.ordinal=EBe;zn.preparse=bue;zn.postformat=bue;zn.relativeTime=OBe;zn.pastFuture=RBe;zn.set=pBe;zn.eras=rze;zn.erasParse=nze;zn.erasConvertYear=ize;zn.erasAbbrRegex=cze;zn.erasNameRegex=uze;zn.erasNarrowRegex=fze;zn.months=VBe;zn.monthsShort=UBe;zn.monthsParse=GBe;zn.monthsRegex=qBe;zn.monthsShortRegex=KBe;zn.week=JBe;zn.firstDayOfYear=tje;zn.firstDayOfWeek=eje;zn.weekdays=fje;zn.weekdaysMin=dje;zn.weekdaysShort=hje;zn.weekdaysParse=mje;zn.weekdaysRegex=_je;zn.weekdaysShortRegex=bje;zn.weekdaysMinRegex=wje;zn.isPM=xje;zn.meridiem=Tje;function HP(e,t,r,n){var i=nf(),o=Ru().set(n,t);return i[r](o,e)}function wue(e,t,r){if(Xc(e)&&(t=e,e=void 0),e=e||"",t!=null)return HP(e,t,r,"month");var n,i=[];for(n=0;n<12;n++)i[n]=HP(e,n,r,"month");return i}function uU(e,t,r,n){typeof e=="boolean"?(Xc(t)&&(r=t,t=void 0),t=t||""):(t=e,r=t,e=!1,Xc(t)&&(r=t,t=void 0),t=t||"");var i=nf(),o=e?i._week.dow:0,s,a=[];if(r!=null)return HP(t,(r+o)%7,n,"day");for(s=0;s<7;s++)a[s]=HP(t,(s+o)%7,n,"day");return a}function Aze(e,t){return wue(e,t,"months")}function Ize(e,t){return wue(e,t,"monthsShort")}function Mze(e,t,r){return uU(e,t,r,"weekdays")}function $ze(e,t,r){return uU(e,t,r,"weekdaysShort")}function Dze(e,t,r){return uU(e,t,r,"weekdaysMin")}Sh("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10,r=Cn(e%100/10)===1?"th":t===1?"st":t===2?"nd":t===3?"rd":"th";return e+r}});Ut.lang=qs("moment.lang is deprecated. Use moment.locale instead.",Sh);Ut.langData=qs("moment.langData is deprecated. Use moment.localeData instead.",nf);var Ku=Math.abs;function Lze(){var e=this._data;return this._milliseconds=Ku(this._milliseconds),this._days=Ku(this._days),this._months=Ku(this._months),e.milliseconds=Ku(e.milliseconds),e.seconds=Ku(e.seconds),e.minutes=Ku(e.minutes),e.hours=Ku(e.hours),e.months=Ku(e.months),e.years=Ku(e.years),this}function Sue(e,t,r,n){var i=Ml(t,r);return e._milliseconds+=n*i._milliseconds,e._days+=n*i._days,e._months+=n*i._months,e._bubble()}function Nze(e,t){return Sue(this,e,t,1)}function Bze(e,t){return Sue(this,e,t,-1)}function Gq(e){return e<0?Math.floor(e):Math.ceil(e)}function jze(){var e=this._milliseconds,t=this._days,r=this._months,n=this._data,i,o,s,a,h;return e>=0&&t>=0&&r>=0||e<=0&&t<=0&&r<=0||(e+=Gq(gj(r)+t)*864e5,t=0,r=0),n.milliseconds=e%1e3,i=Ds(e/1e3),n.seconds=i%60,o=Ds(i/60),n.minutes=o%60,s=Ds(o/60),n.hours=s%24,t+=Ds(s/24),h=Ds(xue(t)),r+=h,t-=Gq(gj(h)),a=Ds(r/12),r%=12,n.days=t,n.months=r,n.years=a,this}function xue(e){return e*4800/146097}function gj(e){return e*146097/4800}function Fze(e){if(!this.isValid())return NaN;var t,r,n=this._milliseconds;if(e=Xs(e),e==="month"||e==="quarter"||e==="year")switch(t=this._days+n/864e5,r=this._months+xue(t),e){case"month":return r;case"quarter":return r/3;case"year":return r/12}else switch(t=this._days+Math.round(gj(this._months)),e){case"week":return t/7+n/6048e5;case"day":return t+n/864e5;case"hour":return t*24+n/36e5;case"minute":return t*1440+n/6e4;case"second":return t*86400+n/1e3;case"millisecond":return Math.floor(t*864e5)+n;default:throw new Error("Unknown unit "+e)}}function zze(){return this.isValid()?this._milliseconds+this._days*864e5+this._months%12*2592e6+Cn(this._months/12)*31536e6:NaN}function of(e){return function(){return this.as(e)}}var Hze=of("ms"),Vze=of("s"),Uze=of("m"),Wze=of("h"),Gze=of("d"),Yze=of("w"),Kze=of("M"),qze=of("Q"),Xze=of("y");function Zze(){return Ml(this)}function Jze(e){return e=Xs(e),this.isValid()?this[e+"s"]():NaN}function Bm(e){return function(){return this.isValid()?this._data[e]:NaN}}var Qze=Bm("milliseconds"),eHe=Bm("seconds"),tHe=Bm("minutes"),rHe=Bm("hours"),nHe=Bm("days"),iHe=Bm("months"),oHe=Bm("years");function aHe(){return Ds(this.days()/7)}var nc=Math.round,qy={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function sHe(e,t,r,n,i){return i.relativeTime(t||1,!!r,e,n)}function lHe(e,t,r,n){var i=Ml(e).abs(),o=nc(i.as("s")),s=nc(i.as("m")),a=nc(i.as("h")),h=nc(i.as("d")),p=nc(i.as("M")),y=nc(i.as("w")),S=nc(i.as("y")),E=o<=r.ss&&["s",o]||o<r.s&&["ss",o]||s<=1&&["m"]||s<r.m&&["mm",s]||a<=1&&["h"]||a<r.h&&["hh",a]||h<=1&&["d"]||h<r.d&&["dd",h];return r.w!=null&&(E=E||y<=1&&["w"]||y<r.w&&["ww",y]),E=E||p<=1&&["M"]||p<r.M&&["MM",p]||S<=1&&["y"]||["yy",S],E[2]=t,E[3]=+e>0,E[4]=n,sHe.apply(null,E)}function uHe(e){return e===void 0?nc:typeof e=="function"?(nc=e,!0):!1}function cHe(e,t){return qy[e]===void 0?!1:t===void 0?qy[e]:(qy[e]=t,e==="s"&&(qy.ss=t-1),!0)}function fHe(e,t){if(!this.isValid())return this.localeData().invalidDate();var r=!1,n=qy,i,o;return typeof e=="object"&&(t=e,e=!1),typeof e=="boolean"&&(r=e),typeof t=="object"&&(n=Object.assign({},qy,t),t.s!=null&&t.ss==null&&(n.ss=t.s-1)),i=this.localeData(),o=lHe(this,!r,n,i),r&&(o=i.pastFuture(+this,o)),i.postformat(o)}var U2=Math.abs;function Xg(e){return(e>0)-(e<0)||+e}function aM(){if(!this.isValid())return this.localeData().invalidDate();var e=U2(this._milliseconds)/1e3,t=U2(this._days),r=U2(this._months),n,i,o,s,a=this.asSeconds(),h,p,y,S;return a?(n=Ds(e/60),i=Ds(n/60),e%=60,n%=60,o=Ds(r/12),r%=12,s=e?e.toFixed(3).replace(/\.?0+$/,""):"",h=a<0?"-":"",p=Xg(this._months)!==Xg(a)?"-":"",y=Xg(this._days)!==Xg(a)?"-":"",S=Xg(this._milliseconds)!==Xg(a)?"-":"",h+"P"+(o?p+o+"Y":"")+(r?p+r+"M":"")+(t?y+t+"D":"")+(i||n||e?"T":"")+(i?S+i+"H":"")+(n?S+n+"M":"")+(e?S+s+"S":"")):"P0D"}var In=iM.prototype;In.isValid=nFe;In.abs=Lze;In.add=Nze;In.subtract=Bze;In.as=Fze;In.asMilliseconds=Hze;In.asSeconds=Vze;In.asMinutes=Uze;In.asHours=Wze;In.asDays=Gze;In.asWeeks=Yze;In.asMonths=Kze;In.asQuarters=qze;In.asYears=Xze;In.valueOf=zze;In._bubble=jze;In.clone=Zze;In.get=Jze;In.milliseconds=Qze;In.seconds=eHe;In.minutes=tHe;In.hours=rHe;In.days=nHe;In.weeks=aHe;In.months=iHe;In.years=oHe;In.humanize=fHe;In.toISOString=aM;In.toString=aM;In.toJSON=aM;In.locale=fue;In.localeData=due;In.toIsoString=qs("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",aM);In.lang=hue;Dr("X",0,0,"unix");Dr("x",0,0,"valueOf");br("x",eM);br("X",MBe);ai("X",function(e,t,r){r._d=new Date(parseFloat(e)*1e3)});ai("x",function(e,t,r){r._d=new Date(Cn(e))});//! moment.js
Ut.version="2.29.4";hBe(_i);Ut.fn=Jt;Ut.min=Qje;Ut.max=eFe;Ut.now=tFe;Ut.utc=Ru;Ut.unix=kze;Ut.months=Aze;Ut.isDate=mE;Ut.locale=Sh;Ut.invalid=qI;Ut.duration=Ml;Ut.isMoment=Rl;Ut.weekdays=Mze;Ut.parseZone=Pze;Ut.localeData=nf;Ut.isDuration=Sk;Ut.monthsShort=Ize;Ut.weekdaysMin=Dze;Ut.defineLocale=tU;Ut.updateLocale=Pje;Ut.locales=Aje;Ut.weekdaysShort=$ze;Ut.normalizeUnits=Xs;Ut.relativeTimeRounding=uHe;Ut.relativeTimeThreshold=cHe;Ut.calendarFormat=TFe;Ut.prototype=Jt;Ut.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};const hHe=Object.freeze(Object.defineProperty({__proto__:null,default:Ut},Symbol.toStringTag,{value:"Module"}));var dHe=TypeError,pHe=9007199254740991,Cue=function(e){if(e>pHe)throw dHe("Maximum allowed index exceeded");return e},mHe=jr,gHe=on,yHe=ew,vHe=Qi,_He=Ga,bHe=Ys,Yq=Cue,Kq=Qb,wHe=EV,SHe=cE,xHe=pi,CHe=KC,Eue=xHe("isConcatSpreadable"),EHe=CHe>=51||!gHe(function(){var e=[];return e[Eue]=!1,e.concat()[0]!==e}),THe=function(e){if(!vHe(e))return!1;var t=e[Eue];return t!==void 0?!!t:yHe(e)},OHe=!EHe||!SHe("concat");mHe({target:"Array",proto:!0,arity:1,forced:OHe},{concat:function(t){var r=_He(this),n=wHe(r,0),i=0,o,s,a,h,p;for(o=-1,a=arguments.length;o<a;o++)if(p=o===-1?r:arguments[o],THe(p))for(h=bHe(p),Yq(i+h),s=0;s<h;s++,i++)s in p&&Kq(n,i,p[s]);else Yq(i+1),Kq(n,i++,p);return n.length=i,n}});var RHe=Qi,kHe=Tu,PHe=pi,AHe=PHe("match"),cU=function(e){var t;return RHe(e)&&((t=e[AHe])!==void 0?!!t:kHe(e)=="RegExp")},IHe=cU,MHe=TypeError,fU=function(e){if(IHe(e))throw MHe("The method doesn't accept regular expressions");return e},$He=pi,DHe=$He("match"),hU=function(e){var t=/./;try{"/./"[e](t)}catch{try{return t[DHe]=!1,"/./"[e](t)}catch{}}return!1},LHe=jr,NHe=sn,BHe=fU,jHe=Wa,qq=to,FHe=hU,zHe=NHe("".indexOf);LHe({target:"String",proto:!0,forced:!FHe("includes")},{includes:function(t){return!!~zHe(qq(jHe(this)),qq(BHe(t)),arguments.length>1?arguments[1]:void 0)}});var HHe=tf,VHe=fE,UHe=pi,WHe=eo,Xq=UHe("species"),Tue=function(e){var t=HHe(e);WHe&&t&&!t[Xq]&&VHe(t,Xq,{configurable:!0,get:function(){return this}})},GHe=Jb,YHe=fE,Zq=pV,KHe=lE,qHe=SV,XHe=Il,ZHe=wV,JHe=sV,hR=lV,QHe=Tue,K0=eo,Jq=aE.fastKey,Oue=rf,Qq=Oue.set,W2=Oue.getterFor,Rue={getConstructor:function(e,t,r,n){var i=e(function(p,y){qHe(p,o),Qq(p,{type:t,index:GHe(null),first:void 0,last:void 0,size:0}),K0||(p.size=0),XHe(y)||ZHe(y,p[n],{that:p,AS_ENTRIES:r})}),o=i.prototype,s=W2(t),a=function(p,y,S){var E=s(p),O=h(p,y),A,$;return O?O.value=S:(E.last=O={index:$=Jq(y,!0),key:y,value:S,previous:A=E.last,next:void 0,removed:!1},E.first||(E.first=O),A&&(A.next=O),K0?E.size++:p.size++,$!=="F"&&(E.index[$]=O)),p},h=function(p,y){var S=s(p),E=Jq(y),O;if(E!=="F")return S.index[E];for(O=S.first;O;O=O.next)if(O.key==y)return O};return Zq(o,{clear:function(){for(var y=this,S=s(y),E=S.index,O=S.first;O;)O.removed=!0,O.previous&&(O.previous=O.previous.next=void 0),delete E[O.index],O=O.next;S.first=S.last=void 0,K0?S.size=0:y.size=0},delete:function(p){var y=this,S=s(y),E=h(y,p);if(E){var O=E.next,A=E.previous;delete S.index[E.index],E.removed=!0,A&&(A.next=O),O&&(O.previous=A),S.first==E&&(S.first=O),S.last==E&&(S.last=A),K0?S.size--:y.size--}return!!E},forEach:function(y){for(var S=s(this),E=KHe(y,arguments.length>1?arguments[1]:void 0),O;O=O?O.next:S.first;)for(E(O.value,O.key,this);O&&O.removed;)O=O.previous},has:function(y){return!!h(this,y)}}),Zq(o,r?{get:function(y){var S=h(this,y);return S&&S.value},set:function(y,S){return a(this,y===0?0:y,S)}}:{add:function(y){return a(this,y=y===0?0:y,y)}}),K0&&YHe(o,"size",{configurable:!0,get:function(){return s(this).size}}),i},setStrong:function(e,t,r){var n=t+" Iterator",i=W2(t),o=W2(n);JHe(e,t,function(s,a){Qq(this,{type:n,target:s,state:i(s),kind:a,last:void 0})},function(){for(var s=o(this),a=s.kind,h=s.last;h&&h.removed;)h=h.previous;return!s.target||!(s.last=h=h?h.next:s.state.first)?(s.target=void 0,hR(void 0,!0)):a=="keys"?hR(h.key,!1):a=="values"?hR(h.value,!1):hR([h.key,h.value],!1)},r?"entries":"values",!r,!0),QHe(t)}},e3e=DI,t3e=Rue;e3e("Set",function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},t3e);var e9=Yi,r3e=_le,n3e=Il,i3e=pi,o3e=i3e("species"),a3e=function(e,t){var r=e9(e).constructor,n;return r===void 0||n3e(n=e9(r)[o3e])?t:r3e(n)},s3e=Nm,q0=uo,dU=sn,l3e=jI,u3e=Yi,c3e=Il,f3e=cU,t9=Wa,h3e=a3e,d3e=AV,p3e=Mm,G2=to,m3e=Im,r9=gV,n9=FI,g3e=BI,y3e=PV,v3e=on,Zg=y3e.UNSUPPORTED_Y,i9=4294967295,_3e=Math.min,kue=[].push,b3e=dU(/./.exec),Jg=dU(kue),X0=dU("".slice),w3e=!v3e(function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var r="ab".split(e);return r.length!==2||r[0]!=="a"||r[1]!=="b"});l3e("split",function(e,t,r){var n;return"abbc".split(/(b)*/)[1]=="c"||"test".split(/(?:)/,-1).length!=4||"ab".split(/(?:ab)*/).length!=2||".".split(/(.?)(.?)/).length!=4||".".split(/()()/).length>1||"".split(/.?/).length?n=function(i,o){var s=G2(t9(this)),a=o===void 0?i9:o>>>0;if(a===0)return[];if(i===void 0)return[s];if(!f3e(i))return q0(t,s,i,a);for(var h=[],p=(i.ignoreCase?"i":"")+(i.multiline?"m":"")+(i.unicode?"u":"")+(i.sticky?"y":""),y=0,S=new RegExp(i.source,p+"g"),E,O,A;(E=q0(g3e,S,s))&&(O=S.lastIndex,!(O>y&&(Jg(h,X0(s,y,E.index)),E.length>1&&E.index<s.length&&s3e(kue,h,r9(E,1)),A=E[0].length,y=O,h.length>=a)));)S.lastIndex===E.index&&S.lastIndex++;return y===s.length?(A||!b3e(S,""))&&Jg(h,""):Jg(h,X0(s,y)),h.length>a?r9(h,0,a):h}:"0".split(void 0,0).length?n=function(i,o){return i===void 0&&o===0?[]:q0(t,this,i,o)}:n=t,[function(o,s){var a=t9(this),h=c3e(o)?void 0:m3e(o,e);return h?q0(h,o,a,s):q0(n,G2(a),o,s)},function(i,o){var s=u3e(this),a=G2(i),h=r(n,s,a,o,n!==t);if(h.done)return h.value;var p=h3e(s,RegExp),y=s.unicode,S=(s.ignoreCase?"i":"")+(s.multiline?"m":"")+(s.unicode?"u":"")+(Zg?"g":"y"),E=new p(Zg?"^(?:"+s.source+")":s,S),O=o===void 0?i9:o>>>0;if(O===0)return[];if(a.length===0)return n9(E,a)===null?[a]:[];for(var A=0,$=0,B=[];$<a.length;){E.lastIndex=Zg?0:$;var j=n9(E,Zg?X0(a,$):a),z;if(j===null||(z=_3e(p3e(E.lastIndex+(Zg?$:0)),a.length))===A)$=d3e(a,$,y);else{if(Jg(B,X0(a,A,$)),B.length===O)return B;for(var W=1;W<=j.length-1;W++)if(Jg(B,j[W]),B.length===O)return B;$=A=z}}return Jg(B,X0(a,A)),B}]},!w3e,Zg);function S3e(e){for(var t=e.length,r=0;r<t;)e[r]=[e[r]],r+=1}function o9(e,t){for(var r=t.length,n=0;n<r;)e.push(t[n]),n+=1}function Ck(e){var t=[];if(!e||e.length===0||!e[0]||e[0].length===0)return t;for(var r=e.length,n=e[0].length,i=0;i<r;i++)for(var o=0;o<n;o++)t[o]||(t[o]=[]),t[o][i]=e[i][o];return t}function oa(e,t,r,n){var i=-1,o=e,s=r;Array.isArray(e)||(o=Array.from(e));var a=o.length;for(n&&a&&(i+=1,s=o[i]),i+=1;i<a;)s=t(s,o[i],i,o),i+=1;return s}function Us(e,t){var r=0,n=e;Array.isArray(e)||(n=Array.from(e));for(var i=n.length,o=[],s=-1;r<i;){var a=n[r];t(a,r,n)&&(s+=1,o[s]=a),r+=1}return o}function dn(e,t){var r=0,n=e;Array.isArray(e)||(n=Array.from(e));for(var i=n.length,o=[],s=-1;r<i;){var a=n[r];s+=1,o[s]=t(a,r,n),r+=1}return o}function Fe(e,t){var r=0,n=e;Array.isArray(e)||(n=Array.from(e));for(var i=n.length;r<i&&t(n[r],r,n)!==!1;)r+=1;return e}function Pue(e){var t=[];return Fe(e,function(r){t.indexOf(r)===-1&&t.push(r)}),t}function a9(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=[].concat(t),i=n[0],o=n.slice(1),s=i;return Fe(o,function(a){s=s.filter(function(h){return!a.includes(h)})}),s}function s9(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return e.split(t)}function Jn(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var i=oa(e,function(o,s,a){var h=s.replace(/\r?\n\s*/g,""),p=r[a]?r[a]:"";return o+h+p},"");return i.trim()}var l9,u9,c9,f9,h9,d9;function lv(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function yj(e){"@babel/helpers - typeof";return yj=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yj(e)}function Ji(e){var t;switch(yj(e)){case"string":case"number":t="".concat(e);break;case"object":t=e===null?"":e.toString();break;case"undefined":t="";break;default:t=e.toString();break}return t}function pr(e){return typeof e<"u"}function ui(e){return typeof e>"u"}function _o(e){return e===null||e===""||ui(e)}function x3e(e){return Object.prototype.toString.call(e)==="[object RegExp]"}var CS="length",US=function(t){return parseInt(t,16)},p9=function(t){return parseInt(t,10)},VP=function(t,r,n){return t.substr(r,n)},WS=function(t){return t.codePointAt(0)-65},vj=function(t){return"".concat(t).replace(/\-/g,"")},C3e=function(t){return US(VP(vj(t),US("12"),WS("F")))/(US(VP(vj(t),WS("B"),~~![][CS]))||9)},E3e=function(){return typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host)},m9=!1,g9={invalid:function(){return Jn(l9||(l9=lv([`
    The license key for Handsontable is invalid. 
    If you need any help, contact us at support@handsontable.com.`],[`
    The license key for Handsontable is invalid.\\x20
    If you need any help, contact us at support@handsontable.com.`])))},expired:function(t){var r=t.keyValidityDate,n=t.hotVersion;return Jn(u9||(u9=lv([`
    The license key for Handsontable expired on `,`, and is not valid for the installed 
    version `,`. Renew your license key at handsontable.com or downgrade to a version released prior 
    to `,". If you need any help, contact us at sales@handsontable.com."],[`
    The license key for Handsontable expired on `,`, and is not valid for the installed\\x20
    version `,`. Renew your license key at handsontable.com or downgrade to a version released prior\\x20
    to `,". If you need any help, contact us at sales@handsontable.com."])),r,n,r)},missing:function(){return Jn(c9||(c9=lv([`
    The license key for Handsontable is missing. Use your purchased key to activate the product. 
    Alternatively, you can activate Handsontable to use for non-commercial purposes by 
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact 
    us at support@handsontable.com.`],[`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\\x20
    us at support@handsontable.com.`])))},non_commercial:function(){return""}},y9={invalid:function(){return Jn(f9||(f9=lv([`
    The license key for Handsontable is invalid. 
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to 
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`],[`
    The license key for Handsontable is invalid.\\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`])))},expired:function(t){var r=t.keyValidityDate,n=t.hotVersion;return Jn(h9||(h9=lv([`
    The license key for Handsontable expired on `,`, and is not valid for the installed 
    version `,`. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your 
    license key or downgrade to a version released prior to `,`. If you need any 
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`],[`
    The license key for Handsontable expired on `,`, and is not valid for the installed\\x20
    version `,`. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\\x20
    license key or downgrade to a version released prior to `,`. If you need any\\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`])),r,n,r)},missing:function(){return Jn(d9||(d9=lv([`
    The license key for Handsontable is missing. Use your purchased key to activate the product. 
    Alternatively, you can activate Handsontable to use for non-commercial purposes by 
    passing the key: 'non-commercial-and-evaluation'. 
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in 
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`],[`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\\x20
    passing the key: 'non-commercial-and-evaluation'.\\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`])))},non_commercial:function(){return""}};function T3e(e,t){var r=!_o(e),n=typeof e=="string"&&e.toLowerCase()==="non-commercial-and-evaluation",i="12.3.3",o,s="invalid",a="invalid";e=vj(e||"");var h=O3e(e);if(r||n||h)if(h){var p=Ut("28/03/2023","DD/MM/YYYY"),y=Math.floor(p.toDate().getTime()/864e5),S=C3e(e);o=Ut((S+1)*864e5,"x").format("MMMM DD, YYYY"),y>S?(s="expired",a="expired"):(s="valid",a="valid")}else n?(s="non_commercial",a="valid"):(s="invalid",a="invalid");else s="missing",a="missing";if(E3e()&&(s="valid",a="valid"),!m9&&s!=="valid"){var E=g9[s]({keyValidityDate:o,hotVersion:i});E&&console[s==="non_commercial"?"info":"warn"](g9[s]({keyValidityDate:o,hotVersion:i})),m9=!0}if(a!=="valid"&&t.parentNode){var O=y9[a]({keyValidityDate:o,hotVersion:i});if(O){var A=document.createElement("div");A.className="hot-display-license-info",A.innerHTML=y9[a]({keyValidityDate:o,hotVersion:i}),t.parentNode.insertBefore(A,t.nextSibling)}}}function O3e(e){var t=[][CS],r=t;if(e[CS]!==WS("Z"))return!1;for(var n="",i="B<H4P+".split(""),o=WS(i.shift());o;o=WS(i.shift()||"A"))--o<""[CS]?r=r|(p9("".concat(p9(US(n)+(US(VP(e,Math.abs(o),2))+[]).padStart(2,"0"))))%97||2)>>1:n=VP(e,o,o?i[CS]===1?9:8:6);return r===t}var R3e=Ga,v9=XC,k3e=Ys,P3e=function(t){for(var r=R3e(this),n=k3e(r),i=arguments.length,o=v9(i>1?arguments[1]:void 0,n),s=i>2?arguments[2]:void 0,a=s===void 0?n:v9(s,n);a>o;)r[o++]=t;return r},A3e=jr,I3e=P3e,M3e=QC;A3e({target:"Array",proto:!0},{fill:I3e});M3e("fill");var $3e=Lm.forEach,D3e=tw,L3e=D3e("forEach"),N3e=L3e?[].forEach:function(t){return $3e(this,t,arguments.length>1?arguments[1]:void 0)},_9=oi,b9=Cse,B3e=Ese,Y2=N3e,j3e=$m,Aue=function(e){if(e&&e.forEach!==Y2)try{j3e(e,"forEach",Y2)}catch{e.forEach=Y2}};for(var K2 in b9)b9[K2]&&Aue(_9[K2]&&_9[K2].prototype);Aue(B3e);function w9(e,t,r){return t=F3e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function F3e(e){var t=z3e(e,"string");return Zc(t)==="symbol"?t:String(t)}function z3e(e,t){if(Zc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Zc(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Zc(e){"@babel/helpers - typeof";return Zc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zc(e)}function P1(e){var t;return Array.isArray(e)?t=e.length?new Array(e.length).fill(null):[]:(t={},mn(e,function(r,n){n!=="__children"&&(r&&Zc(r)==="object"&&!Array.isArray(r)?t[n]=P1(r):Array.isArray(r)?r.length&&Zc(r[0])==="object"&&!Array.isArray(r[0])?t[n]=[P1(r[0])]:t[n]=[]:t[n]=null)})),t}function Xh(e,t){return t.prototype.constructor=t,e.prototype=new t,e.prototype.constructor=e,e}function lo(e,t,r){var n=Array.isArray(r);return mn(t,function(i,o){(n===!1||r.includes(o))&&(e[o]=i)}),e}function sM(e,t){mn(t,function(r,n){t[n]&&Zc(t[n])==="object"?(e[n]||(Array.isArray(t[n])?e[n]=[]:Object.prototype.toString.call(t[n])==="[object Date]"?e[n]=t[n]:e[n]={}),sM(e[n],t[n])):e[n]=t[n]})}function ba(e){return Zc(e)==="object"?JSON.parse(JSON.stringify(e)):e}function za(e){var t={};return mn(e,function(r,n){t[n]=r}),t}function ci(e){e.MIXINS||(e.MIXINS=[]);for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return Fe(r,function(i){e.MIXINS.push(i.MIXIN_NAME),mn(i,function(o,s){if(e.prototype[s]!==void 0)throw new Error("Mixin conflict. Property '".concat(s,"' already exist and cannot be overwritten."));if(typeof o=="function")e.prototype[s]=o;else{var a=function(y,S){var E="_".concat(y),O=function($){var B=$;return(Array.isArray(B)||pn(B))&&(B=ba(B)),B};return function(){return this[E]===void 0&&(this[E]=O(S)),this[E]}},h=function(y){var S="_".concat(y);return function(E){this[S]=E}};Object.defineProperty(e.prototype,s,{get:a(s,o),set:h(s),configurable:!0})}})}),e}function Iue(e,t){return JSON.stringify(e)===JSON.stringify(t)}function pn(e){return Object.prototype.toString.call(e)==="[object Object]"}function af(e,t,r,n){n.value=r,n.writable=n.writable!==!1,n.enumerable=n.enumerable!==!1,n.configurable=n.configurable!==!1,Object.defineProperty(e,t,n)}function mn(e,t){for(var r in e)if((!e.hasOwnProperty||e.hasOwnProperty&&Object.prototype.hasOwnProperty.call(e,r))&&t(e[r],r,e)===!1)break;return e}function H3e(e,t){var r=t.split("."),n=e;return mn(r,function(i){if(n=n[i],n===void 0)return n=void 0,!1}),n}function q2(e,t,r){var n=t.split("."),i=e;n.forEach(function(o,s){s!==n.length-1?(Gi(i,o)||(i[o]={}),i=i[o]):i[o]=r})}function pU(e){if(!pn(e))return 0;var t=function r(n){var i=0;return pn(n)?mn(n,function(o,s){s!=="__children"&&(i+=r(o))}):i+=1,i};return t(e)}function Dv(e){var t,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value",n="_".concat(r),i=(t={_touched:!1},w9(t,n,e),w9(t,"isTouched",function(){return this._touched}),t);return Object.defineProperty(i,r,{get:function(){return this[n]},set:function(s){this._touched=!0,this[n]=s},enumerable:!0,configurable:!0}),i}function Gi(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var Na=function(t){var r={value:!1};return r.test=function(n,i){r.value=t(n,i)},r},Pu={chrome:Na(function(e,t){return/Chrome/.test(e)&&/Google/.test(t)}),chromeWebKit:Na(function(e){return/CriOS/.test(e)}),edge:Na(function(e){return/Edge/.test(e)}),edgeWebKit:Na(function(e){return/EdgiOS/.test(e)}),firefox:Na(function(e){return/Firefox/.test(e)}),firefoxWebKit:Na(function(e){return/FxiOS/.test(e)}),ie:Na(function(e){return/Trident/.test(e)}),ie9:Na(function(){return!!document.documentMode}),mobile:Na(function(e){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(e)}),safari:Na(function(e,t){return/Safari/.test(e)&&/Apple Computer/.test(t)})},_E={mac:Na(function(e){return/^Mac/.test(e)}),win:Na(function(e){return/^Win/.test(e)}),linux:Na(function(e){return/^Linux/.test(e)}),ios:Na(function(e){return/iPhone|iPad|iPod/i.test(e)})};function V3e(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.userAgent,r=t===void 0?navigator.userAgent:t,n=e.vendor,i=n===void 0?navigator.vendor:n;mn(Pu,function(o){var s=o.test;return void s(r,i)})}function U3e(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.platform,r=t===void 0?navigator.platform:t;mn(_E,function(n){var i=n.test;return void i(r)})}V3e();U3e();function Mue(){return Pu.chrome.value}function W3e(){return Pu.chromeWebKit.value}function X2(){return Pu.firefox.value}function G3e(){return Pu.firefoxWebKit.value}function Y3e(){return Pu.safari.value}function K3e(){return Pu.edge.value}function q3e(){return Pu.ie.value}function X3e(){return Pu.ie9.value}function gu(){return Pu.mobile.value}function $ue(){return _E.ios.value}function Due(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator,t=e.maxTouchPoints;return t>2&&_E.mac.value}function S9(){return _E.win.value}function x9(){return _E.mac.value}var Tr={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:X2()?182:174,AUDIO_MUTE:X2()?181:173,AUDIO_UP:X2()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},Z3e=[Tr.ALT,Tr.ARROW_DOWN,Tr.ARROW_LEFT,Tr.ARROW_RIGHT,Tr.ARROW_UP,Tr.AUDIO_DOWN,Tr.AUDIO_MUTE,Tr.AUDIO_UP,Tr.BACKSPACE,Tr.CAPS_LOCK,Tr.DELETE,Tr.END,Tr.ENTER,Tr.ESCAPE,Tr.F1,Tr.F2,Tr.F3,Tr.F4,Tr.F5,Tr.F6,Tr.F7,Tr.F8,Tr.F9,Tr.F10,Tr.F11,Tr.F12,Tr.F13,Tr.F14,Tr.F15,Tr.F16,Tr.F17,Tr.F18,Tr.F19,Tr.HOME,Tr.INSERT,Tr.MEDIA_NEXT,Tr.MEDIA_PLAY_PAUSE,Tr.MEDIA_PREV,Tr.MEDIA_STOP,Tr.NULL,Tr.NUM_LOCK,Tr.PAGE_DOWN,Tr.PAGE_UP,Tr.PAUSE,Tr.SCROLL_LOCK,Tr.SHIFT,Tr.TAB];function J3e(e){return e===32||e>=48&&e<=57||e>=96&&e<=111||e>=186&&e<=192||e>=219&&e<=222||e>=226||e>=65&&e<=90}function Lue(e){return Z3e.includes(e)}function Q3e(e){return[Tr.CONTROL,Tr.COMMAND_LEFT,Tr.COMMAND_RIGHT,Tr.COMMAND_FIREFOX].includes(e)}function A1(e,t){var r=t.split("|"),n=!1;return Fe(r,function(i){if(e===Tr[i])return n=!0,!1}),n}function Cu(e){e.isImmediatePropagationEnabled=!1,e.cancelBubble=!0}function Ay(e){return e.isImmediatePropagationEnabled===!1}function cm(e){return e.button===2}function mU(e){return e.button===0}var eVe=Ca.f,tVe=function(e,t,r){r in e||eVe(e,r,{configurable:!0,get:function(){return t[r]},set:function(n){t[r]=n}})},rVe=eo,gU=oi,bE=sn,nVe=AI,iVe=xV,oVe=$m,aVe=Dm.f,C9=Kh,sVe=cU,E9=to,lVe=kle,Nue=PV,uVe=tVe,cVe=Ks,fVe=on,hVe=ji,dVe=rf.enforce,pVe=Tue,mVe=pi,Bue=Dse,jue=Lse,gVe=mVe("match"),xh=gU.RegExp,Iy=xh.prototype,yVe=gU.SyntaxError,vVe=bE(Iy.exec),UP=bE("".charAt),T9=bE("".replace),O9=bE("".indexOf),_Ve=bE("".slice),bVe=/^\?<[^\s\d!#%&*+<=>@^][^\s!#%&*+<=>@^]*>/,Qp=/a/g,Z2=/a/g,wVe=new xh(Qp)!==Qp,Fue=Nue.MISSED_STICKY,SVe=Nue.UNSUPPORTED_Y,xVe=rVe&&(!wVe||Fue||Bue||jue||fVe(function(){return Z2[gVe]=!1,xh(Qp)!=Qp||xh(Z2)==Z2||xh(Qp,"i")!="/a/i"})),CVe=function(e){for(var t=e.length,r=0,n="",i=!1,o;r<=t;r++){if(o=UP(e,r),o==="\\"){n+=o+UP(e,++r);continue}!i&&o==="."?n+="[\\s\\S]":(o==="["?i=!0:o==="]"&&(i=!1),n+=o)}return n},EVe=function(e){for(var t=e.length,r=0,n="",i=[],o={},s=!1,a=!1,h=0,p="",y;r<=t;r++){if(y=UP(e,r),y==="\\")y=y+UP(e,++r);else if(y==="]")s=!1;else if(!s)switch(!0){case y==="[":s=!0;break;case y==="(":vVe(bVe,_Ve(e,r+1))&&(r+=2,a=!0),n+=y,h++;continue;case(y===">"&&a):if(p===""||hVe(o,p))throw new yVe("Invalid capture group name");o[p]=!0,i[i.length]=[p,h],a=!1,p="";continue}a?p+=y:n+=y}return[n,i]};if(nVe("RegExp",xVe)){for(var Gd=function(t,r){var n=C9(Iy,this),i=sVe(t),o=r===void 0,s=[],a=t,h,p,y,S,E,O;if(!n&&i&&o&&t.constructor===Gd)return t;if((i||C9(Iy,t))&&(t=t.source,o&&(r=lVe(a))),t=t===void 0?"":E9(t),r=r===void 0?"":E9(r),a=t,Bue&&"dotAll"in Qp&&(p=!!r&&O9(r,"s")>-1,p&&(r=T9(r,/s/g,""))),h=r,Fue&&"sticky"in Qp&&(y=!!r&&O9(r,"y")>-1,y&&SVe&&(r=T9(r,/y/g,""))),jue&&(S=EVe(t),t=S[0],s=S[1]),E=iVe(xh(t,r),n?this:Iy,Gd),(p||y||s.length)&&(O=dVe(E),p&&(O.dotAll=!0,O.raw=Gd(CVe(t),h)),y&&(O.sticky=!0),s.length&&(O.groups=s)),t!==a)try{oVe(E,"source",a===""?"(?:)":a)}catch{}return E},R9=aVe(xh),k9=0;R9.length>k9;)uVe(Gd,xh,R9[k9++]);Iy.constructor=Gd,Gd.prototype=Iy,cVe(gU,"RegExp",Gd,{constructor:!0})}pVe("RegExp");var TVe=jr,OVe=sn,RVe=YC,kVe=ys,PVe=tw,AVe=OVe([].join),IVe=RVe!=Object,MVe=IVe||!PVe("join",",");TVe({target:"Array",proto:!0,forced:MVe},{join:function(t){return AVe(kVe(this),t===void 0?",":t)}});function _j(e){"@babel/helpers - typeof";return _j=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_j(e)}function yU(e){return window.requestAnimationFrame(e)}function $Ve(){return!!document.documentElement.classList}function DVe(){return!!document.createTextNode("test").textContent}function LVe(){return!!window.getComputedStyle}function WP(e){window.cancelAnimationFrame(e)}function zue(){return"ontouchstart"in window}var bj;function NVe(){var e=document.createElement("TABLE");e.style.borderSpacing="0",e.style.borderWidth="0",e.style.padding="0";var t=document.createElement("TBODY");e.appendChild(t),t.appendChild(document.createElement("TR")),t.firstChild.appendChild(document.createElement("TD")),t.firstChild.firstChild.innerHTML="<tr><td>t<br>t</td></tr>";var r=document.createElement("CAPTION");r.innerHTML="c<br>c<br>c<br>c",r.style.padding="0",r.style.margin="0",e.insertBefore(r,t),document.body.appendChild(e),bj=e.offsetHeight<2*e.lastChild.offsetHeight,document.body.removeChild(e)}function Hue(){return bj===void 0&&NVe(),bj}var Qg;function BVe(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Qg||((typeof Intl>"u"?"undefined":_j(Intl))==="object"?Qg=new Intl.Collator(e,t).compare:typeof String.prototype.localeCompare=="function"?Qg=function(n,i){return"".concat(n).localeCompare(i)}:Qg=function(n,i){return n===i?0:n>i?-1:1},Qg)}var Z0;function jVe(){if(Z0!==void 0)return Z0;try{var e={get passive(){Z0=!0}};window.addEventListener("test",e,e),window.removeEventListener("test",e,e)}catch{Z0=!1}return Z0}/*! @license DOMPurify 2.4.5 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.4.5/LICENSE */function nh(e){"@babel/helpers - typeof";return nh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nh(e)}function wj(e,t){return wj=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},wj(e,t)}function FVe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ek(e,t,r){return FVe()?Ek=Reflect.construct:Ek=function(i,o,s){var a=[null];a.push.apply(a,o);var h=Function.bind.apply(i,a),p=new h;return s&&wj(p,s.prototype),p},Ek.apply(null,arguments)}function pl(e){return zVe(e)||HVe(e)||VVe(e)||UVe()}function zVe(e){if(Array.isArray(e))return Sj(e)}function HVe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function VVe(e,t){if(e){if(typeof e=="string")return Sj(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Sj(e,t)}}function Sj(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function UVe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var WVe=Object.hasOwnProperty,P9=Object.setPrototypeOf,GVe=Object.isFrozen,YVe=Object.getPrototypeOf,KVe=Object.getOwnPropertyDescriptor,wa=Object.freeze,kl=Object.seal,qVe=Object.create,Vue=typeof Reflect<"u"&&Reflect,GP=Vue.apply,xj=Vue.construct;GP||(GP=function(t,r,n){return t.apply(r,n)});wa||(wa=function(t){return t});kl||(kl=function(t){return t});xj||(xj=function(t,r){return Ek(t,pl(r))});var XVe=Ws(Array.prototype.forEach),A9=Ws(Array.prototype.pop),J0=Ws(Array.prototype.push),Tk=Ws(String.prototype.toLowerCase),J2=Ws(String.prototype.toString),ZVe=Ws(String.prototype.match),fl=Ws(String.prototype.replace),JVe=Ws(String.prototype.indexOf),QVe=Ws(String.prototype.trim),ua=Ws(RegExp.prototype.test),Q2=eUe(TypeError);function Ws(e){return function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return GP(e,t,n)}}function eUe(e){return function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return xj(e,r)}}function yn(e,t,r){r=r||Tk,P9&&P9(e,null);for(var n=t.length;n--;){var i=t[n];if(typeof i=="string"){var o=r(i);o!==i&&(GVe(t)||(t[n]=o),i=o)}e[i]=!0}return e}function Yd(e){var t=qVe(null),r;for(r in e)GP(WVe,e,[r])===!0&&(t[r]=e[r]);return t}function dR(e,t){for(;e!==null;){var r=KVe(e,t);if(r){if(r.get)return Ws(r.get);if(typeof r.value=="function")return Ws(r.value)}e=YVe(e)}function n(i){return console.warn("fallback value for",i),null}return n}var I9=wa(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),eL=wa(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),tL=wa(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),tUe=wa(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),rL=wa(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),rUe=wa(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),M9=wa(["#text"]),$9=wa(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),nL=wa(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),D9=wa(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),pR=wa(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),nUe=kl(/\{\{[\w\W]*|[\w\W]*\}\}/gm),iUe=kl(/<%[\w\W]*|[\w\W]*%>/gm),oUe=kl(/\${[\w\W]*}/gm),aUe=kl(/^data-[\-\w.\u00B7-\uFFFF]/),sUe=kl(/^aria-[\-\w]+$/),lUe=kl(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),uUe=kl(/^(?:\w+script|data):/i),cUe=kl(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),fUe=kl(/^html$/i),hUe=function(){return typeof window>"u"?null:window},dUe=function(t,r){if(nh(t)!=="object"||typeof t.createPolicy!="function")return null;var n=null,i="data-tt-policy-suffix";r.currentScript&&r.currentScript.hasAttribute(i)&&(n=r.currentScript.getAttribute(i));var o="dompurify"+(n?"#"+n:"");try{return t.createPolicy(o,{createHTML:function(a){return a},createScriptURL:function(a){return a}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}};function Uue(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:hUe(),t=function(Re){return Uue(Re)};if(t.version="2.4.5",t.removed=[],!e||!e.document||e.document.nodeType!==9)return t.isSupported=!1,t;var r=e.document,n=e.document,i=e.DocumentFragment,o=e.HTMLTemplateElement,s=e.Node,a=e.Element,h=e.NodeFilter,p=e.NamedNodeMap,y=p===void 0?e.NamedNodeMap||e.MozNamedAttrMap:p,S=e.HTMLFormElement,E=e.DOMParser,O=e.trustedTypes,A=a.prototype,$=dR(A,"cloneNode"),B=dR(A,"nextSibling"),j=dR(A,"childNodes"),z=dR(A,"parentNode");if(typeof o=="function"){var W=n.createElement("template");W.content&&W.content.ownerDocument&&(n=W.content.ownerDocument)}var Q=dUe(O,r),q=Q?Q.createHTML(""):"",Se=n,Ie=Se.implementation,He=Se.createNodeIterator,Le=Se.createDocumentFragment,ze=Se.getElementsByTagName,ct=r.importNode,At={};try{At=Yd(n).documentMode?n.documentMode:{}}catch{}var Qe={};t.isSupported=typeof z=="function"&&Ie&&typeof Ie.createHTMLDocument<"u"&&At!==9;var de=nUe,Ce=iUe,pt=oUe,Ct=aUe,ie=sUe,M=uUe,U=cUe,K=lUe,re=null,me=yn({},[].concat(pl(I9),pl(eL),pl(tL),pl(rL),pl(M9))),Oe=null,We=yn({},[].concat(pl($9),pl(nL),pl(D9),pl(pR))),Je=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),ht=null,ft=null,St=!0,Tt=!0,Xt=!1,jt=!0,Kt=!1,qe=!1,yr=!1,Ar=!1,wr=!1,vr=!1,Cr=!1,se=!0,ye=!1,Ee="user-content-",Ye=!0,je=!1,tt={},Ue=null,Ve=yn({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),at=null,et=yn({},["audio","video","img","source","image","track"]),mt=null,Ht=yn({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),or="http://www.w3.org/1998/Math/MathML",fr="http://www.w3.org/2000/svg",Ir="http://www.w3.org/1999/xhtml",Ur=Ir,_n=!1,$r=null,Mr=yn({},[or,fr,Ir],J2),ln,an=["application/xhtml+xml","text/html"],Hr="text/html",Fr,rn=null,ri=n.createElement("form"),En=function(Re){return Re instanceof RegExp||Re instanceof Function},un=function(Re){rn&&rn===Re||((!Re||nh(Re)!=="object")&&(Re={}),Re=Yd(Re),ln=an.indexOf(Re.PARSER_MEDIA_TYPE)===-1?ln=Hr:ln=Re.PARSER_MEDIA_TYPE,Fr=ln==="application/xhtml+xml"?J2:Tk,re="ALLOWED_TAGS"in Re?yn({},Re.ALLOWED_TAGS,Fr):me,Oe="ALLOWED_ATTR"in Re?yn({},Re.ALLOWED_ATTR,Fr):We,$r="ALLOWED_NAMESPACES"in Re?yn({},Re.ALLOWED_NAMESPACES,J2):Mr,mt="ADD_URI_SAFE_ATTR"in Re?yn(Yd(Ht),Re.ADD_URI_SAFE_ATTR,Fr):Ht,at="ADD_DATA_URI_TAGS"in Re?yn(Yd(et),Re.ADD_DATA_URI_TAGS,Fr):et,Ue="FORBID_CONTENTS"in Re?yn({},Re.FORBID_CONTENTS,Fr):Ve,ht="FORBID_TAGS"in Re?yn({},Re.FORBID_TAGS,Fr):{},ft="FORBID_ATTR"in Re?yn({},Re.FORBID_ATTR,Fr):{},tt="USE_PROFILES"in Re?Re.USE_PROFILES:!1,St=Re.ALLOW_ARIA_ATTR!==!1,Tt=Re.ALLOW_DATA_ATTR!==!1,Xt=Re.ALLOW_UNKNOWN_PROTOCOLS||!1,jt=Re.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Kt=Re.SAFE_FOR_TEMPLATES||!1,qe=Re.WHOLE_DOCUMENT||!1,wr=Re.RETURN_DOM||!1,vr=Re.RETURN_DOM_FRAGMENT||!1,Cr=Re.RETURN_TRUSTED_TYPE||!1,Ar=Re.FORCE_BODY||!1,se=Re.SANITIZE_DOM!==!1,ye=Re.SANITIZE_NAMED_PROPS||!1,Ye=Re.KEEP_CONTENT!==!1,je=Re.IN_PLACE||!1,K=Re.ALLOWED_URI_REGEXP||K,Ur=Re.NAMESPACE||Ir,Je=Re.CUSTOM_ELEMENT_HANDLING||{},Re.CUSTOM_ELEMENT_HANDLING&&En(Re.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(Je.tagNameCheck=Re.CUSTOM_ELEMENT_HANDLING.tagNameCheck),Re.CUSTOM_ELEMENT_HANDLING&&En(Re.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(Je.attributeNameCheck=Re.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),Re.CUSTOM_ELEMENT_HANDLING&&typeof Re.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(Je.allowCustomizedBuiltInElements=Re.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Kt&&(Tt=!1),vr&&(wr=!0),tt&&(re=yn({},pl(M9)),Oe=[],tt.html===!0&&(yn(re,I9),yn(Oe,$9)),tt.svg===!0&&(yn(re,eL),yn(Oe,nL),yn(Oe,pR)),tt.svgFilters===!0&&(yn(re,tL),yn(Oe,nL),yn(Oe,pR)),tt.mathMl===!0&&(yn(re,rL),yn(Oe,D9),yn(Oe,pR))),Re.ADD_TAGS&&(re===me&&(re=Yd(re)),yn(re,Re.ADD_TAGS,Fr)),Re.ADD_ATTR&&(Oe===We&&(Oe=Yd(Oe)),yn(Oe,Re.ADD_ATTR,Fr)),Re.ADD_URI_SAFE_ATTR&&yn(mt,Re.ADD_URI_SAFE_ATTR,Fr),Re.FORBID_CONTENTS&&(Ue===Ve&&(Ue=Yd(Ue)),yn(Ue,Re.FORBID_CONTENTS,Fr)),Ye&&(re["#text"]=!0),qe&&yn(re,["html","head","body"]),re.table&&(yn(re,["tbody"]),delete ht.tbody),wa&&wa(Re),rn=Re)},zr=yn({},["mi","mo","mn","ms","mtext"]),bo=yn({},["foreignobject","desc","title","annotation-xml"]),aa=yn({},["title","style","font","a","script"]),zo=yn({},eL);yn(zo,tL),yn(zo,tUe);var pe=yn({},rL);yn(pe,rUe);var Z=function(Re){var bt=z(Re);(!bt||!bt.tagName)&&(bt={namespaceURI:Ur,tagName:"template"});var Dt=Tk(Re.tagName),mr=Tk(bt.tagName);return $r[Re.namespaceURI]?Re.namespaceURI===fr?bt.namespaceURI===Ir?Dt==="svg":bt.namespaceURI===or?Dt==="svg"&&(mr==="annotation-xml"||zr[mr]):!!zo[Dt]:Re.namespaceURI===or?bt.namespaceURI===Ir?Dt==="math":bt.namespaceURI===fr?Dt==="math"&&bo[mr]:!!pe[Dt]:Re.namespaceURI===Ir?bt.namespaceURI===fr&&!bo[mr]||bt.namespaceURI===or&&!zr[mr]?!1:!pe[Dt]&&(aa[Dt]||!zo[Dt]):!!(ln==="application/xhtml+xml"&&$r[Re.namespaceURI]):!1},ee=function(Re){J0(t.removed,{element:Re});try{Re.parentNode.removeChild(Re)}catch{try{Re.outerHTML=q}catch{Re.remove()}}},fe=function(Re,bt){try{J0(t.removed,{attribute:bt.getAttributeNode(Re),from:bt})}catch{J0(t.removed,{attribute:null,from:bt})}if(bt.removeAttribute(Re),Re==="is"&&!Oe[Re])if(wr||vr)try{ee(bt)}catch{}else try{bt.setAttribute(Re,"")}catch{}},we=function(Re){var bt,Dt;if(Ar)Re="<remove></remove>"+Re;else{var mr=ZVe(Re,/^[\r\n\t ]+/);Dt=mr&&mr[0]}ln==="application/xhtml+xml"&&Ur===Ir&&(Re='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+Re+"</body></html>");var sr=Q?Q.createHTML(Re):Re;if(Ur===Ir)try{bt=new E().parseFromString(sr,ln)}catch{}if(!bt||!bt.documentElement){bt=Ie.createDocument(Ur,"template",null);try{bt.documentElement.innerHTML=_n?q:sr}catch{}}var Br=bt.body||bt.documentElement;return Re&&Dt&&Br.insertBefore(n.createTextNode(Dt),Br.childNodes[0]||null),Ur===Ir?ze.call(bt,qe?"html":"body")[0]:qe?bt.documentElement:Br},De=function(Re){return He.call(Re.ownerDocument||Re,Re,h.SHOW_ELEMENT|h.SHOW_COMMENT|h.SHOW_TEXT,null,!1)},Xe=function(Re){return Re instanceof S&&(typeof Re.nodeName!="string"||typeof Re.textContent!="string"||typeof Re.removeChild!="function"||!(Re.attributes instanceof y)||typeof Re.removeAttribute!="function"||typeof Re.setAttribute!="function"||typeof Re.namespaceURI!="string"||typeof Re.insertBefore!="function"||typeof Re.hasChildNodes!="function")},Ge=function(Re){return nh(s)==="object"?Re instanceof s:Re&&nh(Re)==="object"&&typeof Re.nodeType=="number"&&typeof Re.nodeName=="string"},Ne=function(Re,bt,Dt){Qe[Re]&&XVe(Qe[Re],function(mr){mr.call(t,bt,Dt,rn)})},nt=function(Re){var bt;if(Ne("beforeSanitizeElements",Re,null),Xe(Re)||ua(/[\u0080-\uFFFF]/,Re.nodeName))return ee(Re),!0;var Dt=Fr(Re.nodeName);if(Ne("uponSanitizeElement",Re,{tagName:Dt,allowedTags:re}),Re.hasChildNodes()&&!Ge(Re.firstElementChild)&&(!Ge(Re.content)||!Ge(Re.content.firstElementChild))&&ua(/<[/\w]/g,Re.innerHTML)&&ua(/<[/\w]/g,Re.textContent)||Dt==="select"&&ua(/<template/i,Re.innerHTML))return ee(Re),!0;if(!re[Dt]||ht[Dt]){if(!ht[Dt]&&Qt(Dt)&&(Je.tagNameCheck instanceof RegExp&&ua(Je.tagNameCheck,Dt)||Je.tagNameCheck instanceof Function&&Je.tagNameCheck(Dt)))return!1;if(Ye&&!Ue[Dt]){var mr=z(Re)||Re.parentNode,sr=j(Re)||Re.childNodes;if(sr&&mr)for(var Br=sr.length,Nr=Br-1;Nr>=0;--Nr)mr.insertBefore($(sr[Nr],!0),B(Re))}return ee(Re),!0}return Re instanceof a&&!Z(Re)||(Dt==="noscript"||Dt==="noembed")&&ua(/<\/no(script|embed)/i,Re.innerHTML)?(ee(Re),!0):(Kt&&Re.nodeType===3&&(bt=Re.textContent,bt=fl(bt,de," "),bt=fl(bt,Ce," "),bt=fl(bt,pt," "),Re.textContent!==bt&&(J0(t.removed,{element:Re.cloneNode()}),Re.textContent=bt)),Ne("afterSanitizeElements",Re,null),!1)},kt=function(Re,bt,Dt){if(se&&(bt==="id"||bt==="name")&&(Dt in n||Dt in ri))return!1;if(!(Tt&&!ft[bt]&&ua(Ct,bt))){if(!(St&&ua(ie,bt))){if(!Oe[bt]||ft[bt]){if(!(Qt(Re)&&(Je.tagNameCheck instanceof RegExp&&ua(Je.tagNameCheck,Re)||Je.tagNameCheck instanceof Function&&Je.tagNameCheck(Re))&&(Je.attributeNameCheck instanceof RegExp&&ua(Je.attributeNameCheck,bt)||Je.attributeNameCheck instanceof Function&&Je.attributeNameCheck(bt))||bt==="is"&&Je.allowCustomizedBuiltInElements&&(Je.tagNameCheck instanceof RegExp&&ua(Je.tagNameCheck,Dt)||Je.tagNameCheck instanceof Function&&Je.tagNameCheck(Dt))))return!1}else if(!mt[bt]){if(!ua(K,fl(Dt,U,""))){if(!((bt==="src"||bt==="xlink:href"||bt==="href")&&Re!=="script"&&JVe(Dt,"data:")===0&&at[Re])){if(!(Xt&&!ua(M,fl(Dt,U,"")))){if(Dt)return!1}}}}}}return!0},Qt=function(Re){return Re.indexOf("-")>0},Nt=function(Re){var bt,Dt,mr,sr;Ne("beforeSanitizeAttributes",Re,null);var Br=Re.attributes;if(Br){var Nr={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:Oe};for(sr=Br.length;sr--;){bt=Br[sr];var sa=bt,Kn=sa.name,wt=sa.namespaceURI;if(Dt=Kn==="value"?bt.value:QVe(bt.value),mr=Fr(Kn),Nr.attrName=mr,Nr.attrValue=Dt,Nr.keepAttr=!0,Nr.forceKeepAttr=void 0,Ne("uponSanitizeAttribute",Re,Nr),Dt=Nr.attrValue,!Nr.forceKeepAttr&&(fe(Kn,Re),!!Nr.keepAttr)){if(!jt&&ua(/\/>/i,Dt)){fe(Kn,Re);continue}Kt&&(Dt=fl(Dt,de," "),Dt=fl(Dt,Ce," "),Dt=fl(Dt,pt," "));var Ta=Fr(Re.nodeName);if(kt(Ta,mr,Dt)){if(ye&&(mr==="id"||mr==="name")&&(fe(Kn,Re),Dt=Ee+Dt),Q&&nh(O)==="object"&&typeof O.getAttributeType=="function"&&!wt)switch(O.getAttributeType(Ta,mr)){case"TrustedHTML":Dt=Q.createHTML(Dt);break;case"TrustedScriptURL":Dt=Q.createScriptURL(Dt);break}try{wt?Re.setAttributeNS(wt,Kn,Dt):Re.setAttribute(Kn,Dt),A9(t.removed)}catch{}}}}Ne("afterSanitizeAttributes",Re,null)}},Sr=function It(Re){var bt,Dt=De(Re);for(Ne("beforeSanitizeShadowDOM",Re,null);bt=Dt.nextNode();)Ne("uponSanitizeShadowNode",bt,null),!nt(bt)&&(bt.content instanceof i&&It(bt.content),Nt(bt));Ne("afterSanitizeShadowDOM",Re,null)};return t.sanitize=function(It){var Re=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},bt,Dt,mr,sr,Br;if(_n=!It,_n&&(It="<!-->"),typeof It!="string"&&!Ge(It)){if(typeof It.toString!="function")throw Q2("toString is not a function");if(It=It.toString(),typeof It!="string")throw Q2("dirty is not a string, aborting")}if(!t.isSupported){if(nh(e.toStaticHTML)==="object"||typeof e.toStaticHTML=="function"){if(typeof It=="string")return e.toStaticHTML(It);if(Ge(It))return e.toStaticHTML(It.outerHTML)}return It}if(yr||un(Re),t.removed=[],typeof It=="string"&&(je=!1),je){if(It.nodeName){var Nr=Fr(It.nodeName);if(!re[Nr]||ht[Nr])throw Q2("root node is forbidden and cannot be sanitized in-place")}}else if(It instanceof s)bt=we("<!---->"),Dt=bt.ownerDocument.importNode(It,!0),Dt.nodeType===1&&Dt.nodeName==="BODY"||Dt.nodeName==="HTML"?bt=Dt:bt.appendChild(Dt);else{if(!wr&&!Kt&&!qe&&It.indexOf("<")===-1)return Q&&Cr?Q.createHTML(It):It;if(bt=we(It),!bt)return wr?null:Cr?q:""}bt&&Ar&&ee(bt.firstChild);for(var sa=De(je?It:bt);mr=sa.nextNode();)mr.nodeType===3&&mr===sr||nt(mr)||(mr.content instanceof i&&Sr(mr.content),Nt(mr),sr=mr);if(sr=null,je)return It;if(wr){if(vr)for(Br=Le.call(bt.ownerDocument);bt.firstChild;)Br.appendChild(bt.firstChild);else Br=bt;return(Oe.shadowroot||Oe.shadowrootmod)&&(Br=ct.call(r,Br,!0)),Br}var Kn=qe?bt.outerHTML:bt.innerHTML;return qe&&re["!doctype"]&&bt.ownerDocument&&bt.ownerDocument.doctype&&bt.ownerDocument.doctype.name&&ua(fUe,bt.ownerDocument.doctype.name)&&(Kn="<!DOCTYPE "+bt.ownerDocument.doctype.name+`>
`+Kn),Kt&&(Kn=fl(Kn,de," "),Kn=fl(Kn,Ce," "),Kn=fl(Kn,pt," ")),Q&&Cr?Q.createHTML(Kn):Kn},t.setConfig=function(It){un(It),yr=!0},t.clearConfig=function(){rn=null,yr=!1},t.isValidAttribute=function(It,Re,bt){rn||un({});var Dt=Fr(It),mr=Fr(Re);return kt(Dt,mr,bt)},t.addHook=function(It,Re){typeof Re=="function"&&(Qe[It]=Qe[It]||[],J0(Qe[It],Re))},t.removeHook=function(It){if(Qe[It])return A9(Qe[It])},t.removeHooks=function(It){Qe[It]&&(Qe[It]=[])},t.removeAllHooks=function(){Qe={}},t}var pUe=Uue();function Hc(e){return e[0].toUpperCase()+e.substr(1)}function Wue(){function e(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return e()+e()+e()+e()}function Gue(e){return/^([0-9][0-9]?%$)|(^100%$)/.test(e)}function Yue(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return"".concat(e).replace(/(?:\\)?\[([^[\]]+)]/g,function(r,n){return r.charAt(0)==="\\"?r.substr(1,r.length-1):t[n]===void 0?"":t[n]})}function L9(e){return vU("".concat(e),{ALLOWED_TAGS:[]})}function vU(e,t){return pUe.sanitize(e,t)}function N9(e){return vUe(e)||yUe(e)||gUe(e)||mUe()}function mUe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function gUe(e,t){if(e){if(typeof e=="string")return Cj(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Cj(e,t)}}function yUe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function vUe(e){if(Array.isArray(e))return Cj(e)}function Cj(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _Ue(e){for(var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=-1,n=null,i=e;i!==null;){if(r===t){n=i;break}i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:(r+=1,i=i.parentNode)}return n}function bUe(e){return Object.getPrototypeOf(e.parent)&&e.frameElement}function YP(e){return bUe(e)&&e.parent}function em(e){for(var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0,n=Node,i=n.ELEMENT_NODE,o=n.DOCUMENT_FRAGMENT_NODE,s=e;s!=null&&s!==r;){var a=s,h=a.nodeType,p=a.nodeName;if(h===i&&(t.includes(p)||t.includes(s)))return s;var y=s,S=y.host;S&&h===o?s=S:s=s.parentNode}return null}function mR(e,t,r){for(var n=[],i=e;i&&(i=em(i,t,r),!(!i||r&&!r.contains(i)));)n.push(i),i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:i=i.parentNode;var o=n.length;return o?n[o-1]:null}function tm(e,t){var r=e.parentNode,n=[];for(typeof t=="string"?e.defaultView?n=Array.prototype.slice.call(e.querySelectorAll(t),0):n=Array.prototype.slice.call(e.ownerDocument.querySelectorAll(t),0):n.push(t);r!==null;){if(n.indexOf(r)>-1)return!0;r=r.parentNode}return!1}function wUe(e){var t=0,r=e;if(r.previousSibling)for(;r=r.previousSibling;)t+=1;return t}function Kd(e,t,r){var n=r.parentElement.querySelector(".ht_clone_".concat(e));return n?n.contains(t):null}var Ej,Tj,Oj;function gR(e){return!e||!e.length?[]:e.filter(function(t){return!!t})}if($Ve()){var B9=function(t){var r=t.createElement("div");return r.classList.add("test","test2"),r.classList.contains("test2")};Ej=function(t,r){return t.classList===void 0||typeof r!="string"||r===""?!1:t.classList.contains(r)},Tj=function(t,r){var n=t.ownerDocument,i=r;if(typeof i=="string"&&(i=i.split(" ")),i=gR(i),i.length>0)if(B9(n)){var o;(o=t.classList).add.apply(o,N9(i))}else for(var s=0;i[s];)t.classList.add(i[s]),s+=1},Oj=function(t,r){var n=t.ownerDocument,i=r;if(typeof i=="string"&&(i=i.split(" ")),i=gR(i),i.length>0)if(B9(n)){var o;(o=t.classList).remove.apply(o,N9(i))}else for(var s=0;i[s];)t.classList.remove(i[s]),s+=1}}else{var iL=function(t){return new RegExp("(\\s|^)".concat(t,"(\\s|$)"))};Ej=function(t,r){return t.className!==void 0&&iL(r).test(t.className)},Tj=function(t,r){var n=t.className,i=r;if(typeof i=="string"&&(i=i.split(" ")),i=gR(i),n==="")n=i.join(" ");else for(var o=0;o<i.length;o++)i[o]&&!iL(i[o]).test(n)&&(n+=" ".concat(i[o]));t.className=n},Oj=function(t,r){var n=0,i=t.className,o=r;for(typeof o=="string"&&(o=o.split(" ")),o=gR(o);o[n];)i=i.replace(iL(o[n])," ").trim(),n+=1;t.className!==i&&(t.className=i)}}function Wr(e,t){return Ej(e,t)}function Vt(e,t){Tj(e,t)}function qr(e,t){Oj(e,t)}function Kue(e){if(e.nodeType===3)e.parentNode.removeChild(e);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(e.nodeName)>-1)for(var t=e.childNodes,r=t.length-1;r>=0;r--)Kue(t[r])}function Eu(e){for(var t;t=e.lastChild;)e.removeChild(t)}var SUe=/(<(.*)>|&(.*);)/;function iw(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;SUe.test(t)?e.innerHTML=r?vU(t):t:fm(e,t)}function fm(e,t){var r=e.firstChild;r&&r.nodeType===3&&r.nextSibling===null?DVe?r.textContent=t:r.data=t:(Eu(e),e.appendChild(e.ownerDocument.createTextNode(t)))}function I1(e){for(var t=e.ownerDocument.documentElement,r=e;r!==t;){if(r===null)return!1;if(r.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(r.host){if(r.host.impl)return I1(r.host.impl);if(r.host)return I1(r.host);throw new Error("Lost in Web Components world")}else return!1;else if(r.style&&r.style.display==="none")return!1;r=r.parentNode}return!0}function ao(e){var t=e.ownerDocument,r=t.defaultView,n=t.documentElement,i=e,o,s,a,h;if(Hue()&&i.firstChild&&i.firstChild.nodeName==="CAPTION")return h=i.getBoundingClientRect(),{top:h.top+(r.pageYOffset||n.scrollTop)-(n.clientTop||0),left:h.left+(r.pageXOffset||n.scrollLeft)-(n.clientLeft||0)};for(o=i.offsetLeft,s=i.offsetTop,a=i;(i=i.offsetParent)&&i!==t.body;)o+=i.offsetLeft,s+=i.offsetTop,a=i;return a&&a.style.position==="fixed"&&(o+=r.pageXOffset||n.scrollLeft,s+=r.pageYOffset||n.scrollTop),{left:o,top:s}}function M1(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,t=e.scrollY;return t===void 0&&(t=e.document.documentElement.scrollTop),t}function Lv(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,t=e.scrollX;return t===void 0&&(t=e.document.documentElement.scrollLeft),t}function KP(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return e===t?M1(t):e.scrollTop}function Rj(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return e===t?Lv(t):e.scrollLeft}function qP(e){var t=e.ownerDocument,r=t?t.defaultView:void 0;t||(t=e.document?e.document:e,r=t.defaultView);for(var n=["auto","scroll"],i=LVe(),o=e.parentNode;o&&o.style&&t.body!==o;){var s=o.style,a=s.overflow,h=s.overflowX,p=s.overflowY;if([a,h,p].includes("scroll"))return o;if(i){var y=r.getComputedStyle(o);if(a=y.overflow,h=y.overflowX,p=y.overflowY,n.includes(a)||n.includes(h)||n.includes(p))return o}if(o.clientHeight<=o.scrollHeight+1&&(n.includes(p)||n.includes(a))||o.clientWidth<=o.scrollWidth+1&&(n.includes(h)||n.includes(a)))return o;o=o.parentNode}return r}function $1(e){for(var t=e.ownerDocument,r=t.defaultView,n=e.parentNode;n&&n.style&&t.body!==n;){if(n.style.overflow!=="visible"&&n.style.overflow!=="")return n;var i=hm(n,r),o=["scroll","hidden","auto"],s=i.getPropertyValue("overflow"),a=i.getPropertyValue("overflow-y"),h=i.getPropertyValue("overflow-x");if(o.includes(s)||o.includes(a)||o.includes(h))return n;n=n.parentNode}return r}function D1(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(e){if(e===r)return t==="width"?"".concat(r.innerWidth,"px"):t==="height"?"".concat(r.innerHeight,"px"):void 0}else return;var n=e.style[t];if(n!==""&&n!==void 0)return n;var i=hm(e,r);if(i[t]!==""&&i[t]!==void 0)return i[t]}function hm(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return e.currentStyle||t.getComputedStyle(e)}function ii(e){return e.offsetWidth}function Ni(e){return Hue()&&e.firstChild&&e.firstChild.nodeName==="CAPTION"?e.offsetHeight+e.firstChild.offsetHeight:e.offsetHeight}function fh(e){return e.clientHeight||e.innerHeight}function Ok(e){return e.clientWidth||e.innerWidth}function que(e){var t=e.ownerDocument;if(e.selectionStart)return e.selectionStart;if(t.selection){e.focus();var r=t.selection.createRange();if(r===null)return 0;var n=e.createTextRange(),i=n.duplicate();return n.moveToBookmark(r.getBookmark()),i.setEndPoint("EndToStart",n),i.text.length}return 0}function xUe(e){var t=e.ownerDocument;if(e.selectionEnd)return e.selectionEnd;if(t.selection){var r=t.selection.createRange();if(r===null)return 0;var n=e.createTextRange();return n.text.indexOf(r.text)+r.text.length}return 0}function CUe(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,t=e.document,r="";return e.getSelection?r=e.getSelection().toString():t.selection&&t.selection.type!=="Control"&&(r=t.selection.createRange().text),r}function j9(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,t=e.document;e.getSelection?e.getSelection().empty?e.getSelection().empty():e.getSelection().removeAllRanges&&e.getSelection().removeAllRanges():t.selection&&t.selection.empty()}function lM(e,t,r){if(r===void 0&&(r=t),e.setSelectionRange){e.focus();try{e.setSelectionRange(t,r)}catch{var n=e.parentNode,i=n.style.display;n.style.display="block",e.setSelectionRange(t,r),n.style.display=i}}}var oL;function EUe(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document,t=e.createElement("div");t.style.height="200px",t.style.width="100%";var r=e.createElement("div");r.style.boxSizing="content-box",r.style.height="150px",r.style.left="0px",r.style.overflow="hidden",r.style.position="absolute",r.style.top="0px",r.style.width="200px",r.style.visibility="hidden",r.appendChild(t),(e.body||e.documentElement).appendChild(r);var n=t.offsetWidth;r.style.overflow="scroll";var i=t.offsetWidth;return n===i&&(i=r.clientWidth),(e.body||e.documentElement).removeChild(r),n-i}function Mo(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return oL===void 0&&(oL=EUe(e)),oL}function TUe(e){return e.offsetWidth!==e.clientWidth}function OUe(e){return e.offsetHeight!==e.clientHeight}function _U(e,t,r){X3e()?(e.style.top=r,e.style.left=t):Y3e()?e.style["-webkit-transform"]="translate3d(".concat(t,",").concat(r,",0)"):e.style.transform="translate3d(".concat(t,",").concat(r,",0)")}function uM(e){e.style.transform&&e.style.transform!==""?e.style.transform="":e.style["-webkit-transform"]&&e.style["-webkit-transform"]!==""&&(e.style["-webkit-transform"]="")}function XP(e){var t=["INPUT","SELECT","TEXTAREA"];return e&&(t.indexOf(e.nodeName)>-1||e.contentEditable==="true")}function bU(e){return XP(e)&&e.hasAttribute("data-hot-input")===!1}function RUe(e){var t=e.ownerDocument.activeElement;bU(t)||e.select()}function Xue(e){return!e.parentNode}function kUe(e,t){var r=new IntersectionObserver(function(n,i){n.forEach(function(o){o.isIntersecting&&e.offsetParent!==null&&(t(),i.unobserve(e))})},{root:e.ownerDocument.body});r.observe(e)}var PUe=DI,AUe=Rue;PUe("Map",function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},AUe);var IUe=eo,MUe=ew,$Ue=TypeError,DUe=Object.getOwnPropertyDescriptor,LUe=IUe&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(e){return e instanceof TypeError}}(),NUe=LUe?function(e,t){if(MUe(e)&&!DUe(e,"length").writable)throw $Ue("Cannot set read only .length");return e.length=t}:function(e,t){return e.length=t},BUe=jr,jUe=Ga,FUe=XC,zUe=qh,HUe=Ys,VUe=NUe,UUe=Cue,WUe=EV,GUe=Qb,aL=Pse,YUe=cE,KUe=YUe("splice"),qUe=Math.max,XUe=Math.min;BUe({target:"Array",proto:!0,forced:!KUe},{splice:function(t,r){var n=jUe(this),i=HUe(n),o=FUe(t,i),s=arguments.length,a,h,p,y,S,E;for(s===0?a=h=0:s===1?(a=0,h=i-o):(a=s-2,h=XUe(qUe(zUe(r),0),i-o)),UUe(i+a-h),p=WUe(n,h),y=0;y<h;y++)S=o+y,S in n&&GUe(p,y,n[S]);if(p.length=h,a<h){for(y=o;y<i-h;y++)S=y+h,E=y+a,S in n?n[E]=n[S]:aL(n,E);for(y=i;y>i-h+a;y--)aL(n,y-1)}else if(a>h)for(y=i-h;y>o;y--)S=y+h-1,E=y+a-1,S in n?n[E]=n[S]:aL(n,E);for(y=0;y<a;y++)n[y+o]=arguments[y+2];return VUe(n,i-h+a),p}});function ni(){if(pr(console)){var e;(e=console).warn.apply(e,arguments)}}function wU(){if(pr(console)){var e;(e=console).error.apply(e,arguments)}}var ZUe=typeof Bun=="function"&&Bun&&typeof Bun.version=="string",JUe=TypeError,Zue=function(e,t){if(e<t)throw JUe("Not enough arguments");return e},Jue=oi,QUe=Nm,e4e=bi,t4e=ZUe,r4e=Pm,n4e=dE,i4e=Zue,o4e=Jue.Function,a4e=/MSIE .\./.test(r4e)||t4e&&function(){var e=Jue.Bun.version.split(".");return e.length<3||e[0]==0&&(e[1]<3||e[1]==3&&e[2]==0)}(),SU=function(e,t){var r=t?2:1;return a4e?function(n,i){var o=i4e(arguments.length,1)>r,s=e4e(n)?n:o4e(n),a=o?n4e(arguments,r):[],h=o?function(){QUe(s,this,a)}:s;return t?e(h,i):e(h)}:e},s4e=jr,Que=oi,l4e=SU,F9=l4e(Que.setInterval,!0);s4e({global:!0,bind:!0,forced:Que.setInterval!==F9},{setInterval:F9});var u4e=jr,ece=oi,c4e=SU,z9=c4e(ece.setTimeout,!0);u4e({global:!0,bind:!0,forced:ece.setTimeout!==z9},{setTimeout:z9});var f4e=jr,h4e=sn,d4e=ew,p4e=h4e([].reverse),H9=[1,2];f4e({target:"Array",proto:!0,forced:String(H9)===String(H9.reverse())},{reverse:function(){return d4e(this)&&(this.length=this.length),p4e(this)}});function hi(e){return typeof e=="function"}function tce(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,r=null,n;function i(){for(var o=this,s=arguments.length,a=new Array(s),h=0;h<s;h++)a[h]=arguments[h];return r&&clearTimeout(r),r=setTimeout(function(){n=e.apply(o,a)},t),n}return i}function rce(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return e.apply(this,r.concat(s))}}function m4e(e){var t=e.length;function r(n){return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];var h=n.concat(s),p;return h.length>=t?p=e.apply(this,h):p=r(h),p}}return r([])}function kj(e,t,r,n,i,o,s,a){return pr(a)?e.call(t,r,n,i,o,s,a):pr(s)?e.call(t,r,n,i,o,s):pr(o)?e.call(t,r,n,i,o):pr(i)?e.call(t,r,n,i):pr(n)?e.call(t,r,n):pr(r)?e.call(t,r):e.call(t)}function L1(e){"@babel/helpers - typeof";return L1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},L1(e)}var V9;function g4e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function U9(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,v4e(n.key),n)}}function y4e(e,t,r){return t&&U9(e.prototype,t),r&&U9(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function v4e(e){var t=_4e(e,"string");return L1(t)==="symbol"?t:String(t)}function _4e(e,t){if(L1(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(L1(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function b4e(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var ey=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterScrollHorizontally","afterScrollVertically","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeSetCellMeta","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyRowHeader","modifyRowHeight","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","beforeAutofillInsidePopulate","modifyTransformStart","modifyTransformEnd","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],w4e=Jn(V9||(V9=b4e([`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion]. 
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to 
  learn about the migration path.`],[`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\\x20
  learn about the migration path.`]))),sL=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),lL=new Map([["beforeAutofillInsidePopulate",'The plugin hook "beforeAutofillInsidePopulate" is deprecated and will be removed in the next major release.']]),nce=function(){function e(){g4e(this,e),this.globalBucket=this.createEmptyBucket()}return y4e(e,[{key:"createEmptyBucket",value:function(){var r=Object.create(null);return Fe(ey,function(n){return r[n]=[]}),r}},{key:"getBucket",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return r?(r.pluginHookBucket||(r.pluginHookBucket=this.createEmptyBucket()),r.pluginHookBucket):this.globalBucket}},{key:"add",value:function(r,n){var i=this,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;if(Array.isArray(n))Fe(n,function(h){return i.add(r,h,o)});else{sL.has(r)&&ni(Yue(w4e,{hookName:r,removedInVersion:sL.get(r)})),lL.has(r)&&ni(lL.get(r));var s=this.getBucket(o);if(typeof s[r]>"u"&&(this.register(r),s[r]=[]),n.skip=!1,s[r].indexOf(n)===-1){var a=!1;n.initialHook&&Fe(s[r],function(h,p){if(h.initialHook)return s[r][p]=n,a=!0,!1}),a||s[r].push(n)}}return this}},{key:"once",value:function(r,n){var i=this,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;Array.isArray(n)?Fe(n,function(s){return i.once(r,s,o)}):(n.runOnce=!0,this.add(r,n,o))}},{key:"remove",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,o=this.getBucket(i);return typeof o[r]<"u"&&o[r].indexOf(n)>=0?(n.skip=!0,!0):!1}},{key:"has",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,i=this.getBucket(n);return!!(i[r]!==void 0&&i[r].length)}},{key:"run",value:function(r,n,i,o,s,a,h,p){{var y=this.globalBucket[n],S=y?y.length:0,E=0;if(S)for(;E<S;){if(!y[E]||y[E].skip){E+=1;continue}var O=kj(y[E],r,i,o,s,a,h,p);O!==void 0&&(i=O),y[E]&&y[E].runOnce&&this.remove(n,y[E]),E+=1}}{var A=this.getBucket(r)[n],$=A?A.length:0,B=0;if($)for(;B<$;){if(!A[B]||A[B].skip){B+=1;continue}var j=kj(A[B],r,i,o,s,a,h,p);j!==void 0&&(i=j),A[B]&&A[B].runOnce&&this.remove(n,A[B],r),B+=1}}return i}},{key:"destroy",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;mn(this.getBucket(r),function(n,i,o){return o[i].length=0})}},{key:"register",value:function(r){this.isRegistered(r)||ey.push(r)}},{key:"deregister",value:function(r){this.isRegistered(r)&&ey.splice(ey.indexOf(r),1)}},{key:"isDeprecated",value:function(r){return lL.has(r)||sL.has(r)}},{key:"isRegistered",value:function(r){return ey.indexOf(r)>=0}},{key:"getRegistered",value:function(){return ey}}],[{key:"getSingleton",value:function(){return x4e()}}]),e}(),S4e=new nce;function x4e(){return S4e}const gr=nce;function W9(e){return O4e(e)||T4e(e)||E4e(e)||C4e()}function C4e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function E4e(e,t){if(e){if(typeof e=="string")return Pj(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Pj(e,t)}}function T4e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function O4e(e){if(Array.isArray(e))return Pj(e)}function Pj(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var uL=new Map;function Zs(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";uL.has(e)||uL.set(e,new Map);var t=uL.get(e);function r(a,h){t.set(a,h)}function n(a){return t.get(a)}function i(a){return t.has(a)}function o(){return W9(t.keys())}function s(){return W9(t.values())}return{register:r,getItem:n,hasItem:i,getNames:o,getValues:s}}var Aj=new WeakMap,wE=Zs("editors"),R4e=wE.register,ice=wE.getItem,oce=wE.hasItem;wE.getNames;wE.getValues;function k4e(e){var t={},r=e;this.getConstructor=function(){return e},this.getInstance=function(n){return n.guid in t||(t[n.guid]=new r(n)),t[n.guid]},gr.getSingleton().add("afterDestroy",function(){t[this.guid]=null})}function ace(e,t){var r;if(typeof e=="function")Aj.get(e)||ns(null,e),r=Aj.get(e);else if(typeof e=="string")r=ice(e);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!r)throw Error('No editor registered under name "'.concat(e,'"'));return r.getInstance(t)}function G9(e){if(typeof e=="function")return e;if(!oce(e))throw Error('No registered editor found under "'.concat(e,'" name'));return ice(e).getConstructor()}function ns(e,t){e&&typeof e!="string"&&(t=e,e=t.EDITOR_TYPE);var r=new k4e(t);typeof e=="string"&&R4e(e,r),Aj.set(t,r)}function N1(e){"@babel/helpers - typeof";return N1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},N1(e)}function P4e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Y9(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,I4e(n.key),n)}}function A4e(e,t,r){return t&&Y9(e.prototype,t),r&&Y9(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function I4e(e){var t=M4e(e,"string");return N1(t)==="symbol"?t:String(t)}function M4e(e,t){if(N1(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(N1(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var $4e=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;P4e(this,e),this.context=t||this,this.context.eventListeners||(this.context.eventListeners=[])}return A4e(e,[{key:"addEventListener",value:function(r,n,i){var o=this,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function a(h){i.call(this,D4e(h))}return typeof s!="boolean"&&!jVe()&&(s=!1),this.context.eventListeners.push({element:r,event:n,callback:i,callbackProxy:a,options:s,eventManager:this}),r.addEventListener(n,a,s),function(){o.removeEventListener(r,n,i)}}},{key:"removeEventListener",value:function(r,n,i){for(var o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,s=this.context.eventListeners.length,a;s;)if(s-=1,a=this.context.eventListeners[s],a.event===n&&a.element===r){if(i&&i!==a.callback||o&&a.eventManager!==this)continue;this.context.eventListeners.splice(s,1),a.element.removeEventListener(a.event,a.callbackProxy,a.options)}}},{key:"clearEvents",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.context)for(var n=this.context.eventListeners.length;n;){n-=1;var i=this.context.eventListeners[n];r&&i.eventManager!==this||(this.context.eventListeners.splice(n,1),i.element.removeEventListener(i.event,i.callbackProxy,i.options))}}},{key:"clear",value:function(){this.clearEvents()}},{key:"destroy",value:function(){this.clearEvents(),this.context=null}},{key:"destroyWithOwnEventsOnly",value:function(){this.clearEvents(!0),this.context=null}},{key:"fireEvent",value:function(r,n){var i=r.document,o=r;i||(i=r.ownerDocument?r.ownerDocument:r,o=i.defaultView);var s={bubbles:!0,cancelable:n!=="mousemove",view:o,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0},a;i.createEvent?(a=i.createEvent("MouseEvents"),a.initMouseEvent(n,s.bubbles,s.cancelable,s.view,s.detail,s.screenX,s.screenY,s.clientX,s.clientY,s.ctrlKey,s.altKey,s.shiftKey,s.metaKey,s.button,i.body.parentNode)):a=i.createEventObject(),r.dispatchEvent?r.dispatchEvent(a):r.fireEvent("on".concat(n),a)}}]),e}();function D4e(e){var t=e.stopImmediatePropagation;return e.stopImmediatePropagation=function(){t.apply(this),Cu(this)},e}const Fi=$4e;function B1(e){"@babel/helpers - typeof";return B1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},B1(e)}function L4e(e,t){return F4e(e)||j4e(e,t)||B4e(e,t)||N4e()}function N4e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function B4e(e,t){if(e){if(typeof e=="string")return K9(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return K9(e,t)}}function K9(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function j4e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],h=!0,p=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;h=!1}else for(;!(h=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);h=!0);}catch(y){p=!0,i=y}finally{try{if(!h&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(p)throw i}}return a}}function F4e(e){if(Array.isArray(e))return e}function z4e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function q9(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,V4e(n.key),n)}}function H4e(e,t,r){return t&&q9(e.prototype,t),r&&q9(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function V4e(e){var t=U4e(e,"string");return B1(t)==="symbol"?t:String(t)}function U4e(e,t){if(B1(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(B1(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var cM="editorManager.navigation",GS="editorManager.handlingEditor",Ij=function(){function e(t,r,n){var i=this;z4e(this,e),this.instance=t,this.tableMeta=r,this.selection=n,this.eventManager=new Fi(t),this.destroyed=!1,this.lock=!1,this.activeEditor=void 0,this.cellProperties=void 0;var o=this.instance.getShortcutManager();o.addContext("editor"),this.registerShortcuts(),this.instance.addHook("afterDocumentKeyDown",function(s){return i.onAfterDocumentKeyDown(s)}),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"compositionstart",function(s){!i.destroyed&&i.instance.isListening()&&i.openEditor("",s)}),this.instance.view._wt.update("onCellDblClick",function(s,a,h){return i.onCellDblClick(s,a,h)})}return H4e(e,[{key:"registerShortcuts",value:function(){var r=this,n=this.instance.getShortcutManager(),i=n.getContext("grid"),o=n.getContext("editor"),s={group:GS};o.addShortcuts([{keys:[["Enter"],["Enter","Shift"],["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],callback:function(h,p){r.closeEditorAndSaveChanges(n.isCtrlPressed()),r.moveSelectionAfterEnter(p.includes("shift"))}},{keys:[["Escape"],["Escape","Control/Meta"]],callback:function(){r.closeEditorAndRestoreOriginalValue(n.isCtrlPressed()),r.activeEditor.focus()}}],s),i.addShortcuts([{keys:[["F2"]],callback:function(h){r.openEditor(null,h,!0)}},{keys:[["Backspace"],["Delete"]],callback:function(){r.instance.emptySelectedCells(),r.prepareEditor()}},{keys:[["Enter"],["Enter","Shift"]],callback:function(h,p){r.instance.getSettings().enterBeginsEditing?r.cellProperties.readOnly?r.moveSelectionAfterEnter():r.openEditor(null,h,!0):r.moveSelectionAfterEnter(p.includes("shift")),Cu(h)}}],s)}},{key:"lockEditor",value:function(){this.lock=!0}},{key:"unlockEditor",value:function(){this.lock=!1}},{key:"destroyEditor",value:function(r){this.lock||this.closeEditor(r)}},{key:"getActiveEditor",value:function(){return this.activeEditor}},{key:"prepareEditor",value:function(){var r=this;if(!this.lock){if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,function($){$&&r.prepareEditor()});return}var n=this.instance.getSelectedRangeLast().highlight,i=n.row,o=n.col,s=this.instance.runHooks("modifyGetCellCoords",i,o),a=i,h=o;if(Array.isArray(s)){var p=L4e(s,2);a=p[0],h=p[1]}this.cellProperties=this.instance.getCellMeta(a,h);var y=this.instance.rootDocument.activeElement;if(y&&bU(y)&&y.blur(),!this.isCellEditable()){this.clearActiveEditor();return}var S=this.instance.getCell(i,o,!0);if(S){var E=this.instance.getCellEditor(this.cellProperties),O=this.instance.colToProp(h),A=this.instance.getSourceDataAtCell(this.instance.toPhysicalRow(a),h);this.activeEditor=ace(E,this.instance),this.activeEditor.prepare(i,o,O,S,A,this.cellProperties)}}}},{key:"isEditorOpened",value:function(){return this.activeEditor&&this.activeEditor.isOpened()}},{key:"openEditor",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}if(!this.activeEditor){var o=this.instance.getSelectedRangeLast().highlight,s=o.row,a=o.col,h=this.instance.rowIndexMapper.getRenderableFromVisualIndex(s),p=this.instance.columnIndexMapper.getRenderableFromVisualIndex(a);this.instance.view.scrollViewport(this.instance._createCellCoords(h,p)),this.instance.view.render(),this.prepareEditor()}this.activeEditor&&(i&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(r,n))}},{key:"closeEditor",value:function(r,n,i){this.activeEditor?this.activeEditor.finishEditing(r,n,i):i&&i(!1)}},{key:"closeEditorAndSaveChanges",value:function(r){this.closeEditor(!1,r)}},{key:"closeEditorAndRestoreOriginalValue",value:function(r){this.closeEditor(!0,r)}},{key:"clearActiveEditor",value:function(){this.activeEditor=void 0}},{key:"isCellEditable",value:function(){var r=this.instance.getCellEditor(this.cellProperties),n=this.instance.getSelectedRangeLast().highlight,i=n.row,o=n.col,s=this.instance,a=s.rowIndexMapper,h=s.columnIndexMapper,p=a.isHidden(this.instance.toPhysicalRow(i))||h.isHidden(this.instance.toPhysicalColumn(o));return!(this.cellProperties.readOnly||!r||p)}},{key:"moveSelectionAfterEnter",value:function(r){var n=typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(event):this.tableMeta.enterMoves;r?this.selection.transformStart(-n.row,-n.col):this.selection.transformStart(n.row,n.col,!0)}},{key:"onAfterDocumentKeyDown",value:function(r){var n=this;if(this.instance.isListening()){var i=r.keyCode;if(this.selection.isSelected()){var o=(r.ctrlKey||r.metaKey)&&!r.altKey;if((!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!Lue(i)&&!Q3e(i)&&!o&&!this.isEditorOpened()){var s=this.instance.getShortcutManager(),a=s.getContext("editor"),h={runOnlyIf:function(){return pr(n.instance.getSelected())},group:cM};a.addShortcuts([{keys:[["ArrowUp"]],callback:function(){n.instance.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:function(){n.instance.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:function(){n.instance.selection.transformStart(0,-1*n.instance.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:function(){n.instance.selection.transformStart(0,n.instance.getDirectionFactor())}}],h),this.openEditor("",r)}}}}},{key:"onCellDblClick",value:function(r,n,i){i.nodeName==="TD"&&this.openEditor(null,r,!0)}},{key:"destroy",value:function(){this.destroyed=!0,this.eventManager.destroy()}}]),e}(),X9=new WeakMap;Ij.getInstance=function(e,t,r){var n=X9.get(e);return n||(n=new Ij(e,t,r),X9.set(e,n)),n};const W4e=Ij;var G4e="hooksRefRegisterer",sce={_hooksStorage:Object.create(null),addHook:function(t,r){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,r),this._hooksStorage[t].push(r),this},removeHooksByKey:function(t){var r=this;Fe(this._hooksStorage[t]||[],function(n){r.hot.removeHook(t,n)})},clearHooks:function(){var t=this;mn(this._hooksStorage,function(r,n){return t.removeHooksByKey(n)}),this._hooksStorage={}}};af(sce,"MIXIN_NAME",G4e,{writable:!1,enumerable:!1});const Y4e=sce;function Nv(e){"@babel/helpers - typeof";return Nv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nv(e)}function K4e(e,t){return J4e(e)||Z4e(e,t)||X4e(e,t)||q4e()}function q4e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function X4e(e,t){if(e){if(typeof e=="string")return Z9(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Z9(e,t)}}function Z9(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Z4e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],h=!0,p=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;h=!1}else for(;!(h=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);h=!0);}catch(y){p=!0,i=y}finally{try{if(!h&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(p)throw i}}return a}}function J4e(e){if(Array.isArray(e))return e}function Q4e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Mj(e,t)}function Mj(e,t){return Mj=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Mj(e,t)}function eWe(e){var t=nWe();return function(){var n=ZP(e),i;if(t){var o=ZP(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return tWe(this,i)}}function tWe(e,t){if(t&&(Nv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return rWe(e)}function rWe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function nWe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ZP(e){return ZP=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ZP(e)}function J9(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Q9(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,iWe(n.key),n)}}function e7(e,t,r){return t&&Q9(e.prototype,t),r&&Q9(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function iWe(e){var t=oWe(e,"string");return Nv(t)==="symbol"?t:String(t)}function oWe(e,t){if(Nv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Nv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var aWe="base",Ro=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"}),$j="baseEditor",ow=function(){function e(t){J9(this,e),this.hot=t,this.instance=t,this.state=Ro.VIRGIN,this._opened=!1,this._fullEditMode=!1,this._closeCallback=null,this.TD=null,this.row=null,this.col=null,this.prop=null,this.originalValue=null,this.cellProperties=null,this.init()}return e7(e,[{key:"_fireCallbacks",value:function(r){this._closeCallback&&(this._closeCallback(r),this._closeCallback=null)}},{key:"init",value:function(){}},{key:"getValue",value:function(){throw Error("Editor getValue() method unimplemented")}},{key:"setValue",value:function(){throw Error("Editor setValue() method unimplemented")}},{key:"open",value:function(){throw Error("Editor open() method unimplemented")}},{key:"close",value:function(){throw Error("Editor close() method unimplemented")}},{key:"prepare",value:function(r,n,i,o,s,a){this.TD=o,this.row=r,this.col=n,this.prop=i,this.originalValue=s,this.cellProperties=a,this.state=Ro.VIRGIN}},{key:"extend",value:function(){return function(r){Q4e(i,r);var n=eWe(i);function i(){return J9(this,i),n.apply(this,arguments)}return e7(i)}(this.constructor)}},{key:"saveValue",value:function(r,n){var i=this,o,s,a,h;if(n){var p=this.hot.getSelectedLast();o=Math.max(Math.min(p[0],p[2]),0),s=Math.max(Math.min(p[1],p[3]),0),a=Math.max(p[0],p[2]),h=Math.max(p[1],p[3])}else{var y=[this.row,this.col,null,null];o=y[0],s=y[1],a=y[2],h=y[3]}var S=this.hot.runHooks("modifyGetCellCoords",o,s);if(Array.isArray(S)){var E=K4e(S,2);o=E[0],s=E[1]}var O=this.hot.getShortcutManager(),A=O.getContext("editor"),$={runOnlyIf:function(){return pr(i.hot.getSelected())},group:$j};this.isInFullEditMode()&&A.addShortcuts([{keys:[["ArrowUp"]],callback:function(){i.hot.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:function(){i.hot.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:function(){i.hot.selection.transformStart(0,-1*i.hot.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:function(){i.hot.selection.transformStart(0,i.hot.getDirectionFactor())}}],$),this.hot.populateFromArray(o,s,r,a,h,"edit")}},{key:"beginEditing",value:function(r,n){if(this.state===Ro.VIRGIN){var i=this.hot,o=i.rowIndexMapper.getRenderableFromVisualIndex(this.row),s=i.columnIndexMapper.getRenderableFromVisualIndex(this.col);if(i.view.scrollViewport(i._createCellCoords(o,s)),this.state=Ro.EDITING,this.isInFullEditMode()){var a=typeof r=="string"?r:Ji(this.originalValue);this.setValue(a)}this.open(n),this._opened=!0,this.focus(),i.view.render(),i.runHooks("afterBeginEditing",this.row,this.col)}}},{key:"finishEditing",value:function(r,n,i){var o=this,s;if(i){var a=this._closeCallback;this._closeCallback=function(S){a&&a(S),i(S),o.hot.view.render()}}if(!this.isWaiting()){var h=this.hot.getShortcutManager(),p=h.getContext("editor");if(p.removeShortcutsByGroup($j),p.removeShortcutsByGroup(cM),this.state===Ro.VIRGIN){this.hot._registerTimeout(function(){o._fireCallbacks(!0)});return}if(this.state===Ro.EDITING){if(r){this.cancelChanges(),this.hot.view.render();return}var y=this.getValue();this.cellProperties.trimWhitespace?s=[[typeof y=="string"?String.prototype.trim.call(y||""):y]]:s=[[y]],this.state=Ro.WAITING,this.saveValue(s,n),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",function(S){o.state=Ro.FINISHED,o.discardEditor(S)}):(this.state=Ro.FINISHED,this.discardEditor(!0))}}}},{key:"cancelChanges",value:function(){this.state=Ro.FINISHED,this.discardEditor()}},{key:"discardEditor",value:function(r){if(this.state===Ro.FINISHED)if(r===!1&&this.cellProperties.allowInvalid!==!0)this.hot.selectCell(this.row,this.col),this.focus(),this.state=Ro.EDITING,this._fireCallbacks(!1);else{this.close(),this._opened=!1,this._fullEditMode=!1,this.state=Ro.VIRGIN,this._fireCallbacks(!0);var n=this.hot.getShortcutManager();n.setActiveContextName("grid")}}},{key:"enableFullEditMode",value:function(){this._fullEditMode=!0}},{key:"isInFullEditMode",value:function(){return this._fullEditMode}},{key:"isOpened",value:function(){return this._opened}},{key:"isWaiting",value:function(){return this.state===Ro.WAITING}},{key:"getEditedCellRect",value:function(){var r,n=this.getEditedCell();if(n){var i=this.hot.view._wt,o=i.wtOverlays,s=i.wtViewport,a=this.hot.rootWindow,h=ao(n),p=ii(n),y=ao(this.hot.rootElement),S=ii(this.hot.rootElement),E=o.topOverlay.holder,O=o.inlineStartOverlay.holder,A=E!==a?E.scrollTop:0,$=O!==a?O.scrollLeft:0,B=a.innerWidth-y.left-S,j=(r=o.getParentOverlay(n))!==null&&r!==void 0?r:this.hot.view._wt,z=j.wtTable,W=z.name,Q=["master","inline_start"].includes(W)?A:0,q=["master","top","bottom"].includes(W)?$:0,Se=h.top===y.top?0:1,Ie=h.top-y.top-Se-Q,He=0;this.hot.isRtl()?He=a.innerWidth-h.left-p-B-1+q:He=h.left-y.left-1-q,["top","top_inline_start_corner"].includes(W)&&(Ie+=o.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(W)&&(He+=Math.abs(o.inlineStartOverlay.getOverlayOffset()));var Le=this.hot.hasColHeaders(),ze=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),ct=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),At=this.hot.rowIndexMapper.getRenderableIndexesLength(),Qe=At-this.hot.view._wt.getSetting("fixedRowsBottom");(Le&&ze<=0||ze===Qe)&&(Ie+=1),ct<=0&&(He+=1);var de=s.rowsRenderCalculator.startPosition,Ce=s.columnsRenderCalculator.startPosition,pt=Math.abs(o.inlineStartOverlay.getScrollPosition()),Ct=o.topOverlay.getScrollPosition(),ie=Mo(this.hot.rootDocument),M=n.offsetTop+de-Ct,U=0;if(this.hot.isRtl()){var K=n.offsetLeft;K>=0?U=z.getWidth()-n.offsetLeft:U=Math.abs(K),U+=Ce-pt-p}else U=n.offsetLeft+Ce-pt;var re=hm(this.TD,this.hot.rootWindow),me=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",Oe=parseInt(re[me],10)>0?0:1,We=parseInt(re.borderTopWidth,10)>0?0:1,Je=ii(n)+Oe,ht=Ni(n)+We,ft=TUe(E)?ie:0,St=OUe(O)?ie:0,Tt=this.hot.view.maximumVisibleElementWidth(U)-ft+Oe,Xt=Math.max(this.hot.view.maximumVisibleElementHeight(M)-St+We,23);return{top:Ie,start:He,height:ht,maxHeight:Xt,width:Je,maxWidth:Tt}}}},{key:"getEditedCellsLayerClass",value:function(){var r=this.checkEditorSection();switch(r){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}},{key:"getEditedCell",value:function(){return this.hot.getCell(this.row,this.col,!0)}},{key:"checkEditorSection",value:function(){var r=this.hot.countRows(),n="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?n="top-inline-start-corner":n="top":this.hot.getSettings().fixedRowsBottom&&this.row>=r-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?n="bottom-inline-start-corner":n="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(n="inline-start"),n}}],[{key:"EDITOR_TYPE",get:function(){return aWe}}]),e}();ci(ow,Y4e);var sWe=jr,lWe=Lm.map,uWe=cE,cWe=uWe("map");sWe({target:"Array",proto:!0,forced:!cWe},{map:function(t){return lWe(this,t,arguments.length>1?arguments[1]:void 0)}});function fWe(e){return mWe(e)||pWe(e)||dWe(e)||hWe()}function hWe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function dWe(e,t){if(e){if(typeof e=="string")return Dj(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Dj(e,t)}}function pWe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function mWe(e){if(Array.isArray(e))return Dj(e)}function Dj(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Lj(e){"@babel/helpers - typeof";return Lj=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lj(e)}function Ls(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=Lj(e);if(r==="number")return!isNaN(e)&&isFinite(e);if(r==="string"){if(e.length===0)return!1;if(e.length===1)return/\d/.test(e);var n=Array.from(new Set(["."].concat(fWe(t)))).map(function(i){return"\\".concat(i)}).join("|");return new RegExp("^[+-]?\\s*(((".concat(n,")?\\d+((").concat(n,")\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$"),"i").test(e.trim())}else if(r==="object")return!!e&&typeof e.valueOf()=="number"&&!(e instanceof Date);return!1}function gWe(e){return Ls(e,[","])}function Or(e,t,r){var n=-1;for(typeof t=="function"?(r=t,t=e):n=e-1;++n<=t&&r(n)!==!1;);}function Nj(e,t,r){var n=e+1;for(typeof t=="function"&&(r=t,t=0);--n>=t&&r(n)!==!1;);}function lce(e,t){return t=parseInt(t.toString().replace("%",""),10),t=isNaN(t)?0:t,parseInt(e*t/100,10)}function yWe(){var e={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},t,r=document.body,n=document.createTextNode(""),i=document.createElement("SPAN"),o=function(O,A,$){O.addEventListener(A,$,!1)},s=function(O,A,$){O.removeEventListener(A,$,!1)},a=function(O){var A,$;O?/^[a-zA-Z \.,\\\/\|0-9]$/.test(O)||(O="."):O="",n.textContent!==void 0?n.textContent=t.value+O:n.data=t.value+O,i.style.position="absolute",i.style.fontSize=S(t).fontSize,i.style.fontFamily=S(t).fontFamily,i.style.whiteSpace="pre",r.appendChild(i),A=i.clientWidth+2,r.removeChild(i),t.style.height=e.minHeight+"px",e.minWidth>A?t.style.width=e.minWidth+"px":A>e.maxWidth?t.style.width=e.maxWidth+"px":t.style.width=A+"px",$=t.scrollHeight?t.scrollHeight-1:0,e.minHeight>$?t.style.height=e.minHeight+"px":e.maxHeight<$?(t.style.height=e.maxHeight+"px",t.style.overflowY="visible"):t.style.height=$+"px"},h=function(){window.setTimeout(a,0)},p=function(O){if(O&&O.minHeight)if(O.minHeight=="inherit")e.minHeight=t.clientHeight;else{var A=parseInt(O.minHeight);isNaN(A)||(e.minHeight=A)}if(O&&O.maxHeight)if(O.maxHeight=="inherit")e.maxHeight=t.clientHeight;else{var $=parseInt(O.maxHeight);isNaN($)||(e.maxHeight=$)}if(O&&O.minWidth)if(O.minWidth=="inherit")e.minWidth=t.clientWidth;else{var B=parseInt(O.minWidth);isNaN(B)||(e.minWidth=B)}if(O&&O.maxWidth)if(O.maxWidth=="inherit")e.maxWidth=t.clientWidth;else{var j=parseInt(O.maxWidth);isNaN(j)||(e.maxWidth=j)}i.firstChild||(i.className="autoResize",i.style.display="inline-block",i.appendChild(n))},y=function(O,A,$){t=O,p(A),t.nodeName=="TEXTAREA"&&(t.style.resize="none",t.style.overflowY="",t.style.height=e.minHeight+"px",t.style.minWidth=e.minWidth+"px",t.style.maxWidth=e.maxWidth+"px",t.style.overflowY="hidden"),$&&(o(t,"change",a),o(t,"cut",h),o(t,"paste",h),o(t,"drop",h),o(t,"keydown",h),o(t,"focus",a),o(t,"compositionstart",h),o(t,"compositionupdate",h),o(t,"compositionend",h)),a()};function S(E){return E.currentStyle||document.defaultView.getComputedStyle(E)}return{init:function(O,A,$){y(O,A,$)},unObserve:function(){s(t,"change",a),s(t,"cut",h),s(t,"paste",h),s(t,"drop",h),s(t,"keydown",h),s(t,"focus",a),s(t,"compositionstart",h),s(t,"compositionupdate",h),s(t,"compositionend",h)},resize:a}}function t7(e,t){for(var r=que(t),n=t.value.split(`
`),i=r,o=0,s=0;s<n.length;s++){var a=n[s];s!==0&&(o+=n[s-1].length+1);var h=o+a.length;if(e==="home"?i=o:e==="end"&&(i=h),r<=h)break}lM(t,i)}function Bv(e){"@babel/helpers - typeof";return Bv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bv(e)}function r7(e,t){return wWe(e)||bWe(e,t)||_We(e,t)||vWe()}function vWe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _We(e,t){if(e){if(typeof e=="string")return n7(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return n7(e,t)}}function n7(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function bWe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],h=!0,p=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;h=!1}else for(;!(h=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);h=!0);}catch(y){p=!0,i=y}finally{try{if(!h&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(p)throw i}}return a}}function wWe(e){if(Array.isArray(e))return e}function SWe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,CWe(n.key),n)}}function xWe(e,t,r){return t&&i7(e.prototype,t),r&&i7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function CWe(e){var t=EWe(e,"string");return Bv(t)==="symbol"?t:String(t)}function EWe(e,t){if(Bv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Bv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function YS(){return typeof Reflect<"u"&&Reflect.get?YS=Reflect.get.bind():YS=function(t,r,n){var i=TWe(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},YS.apply(this,arguments)}function TWe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=dm(e),e!==null););return e}function OWe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Bj(e,t)}function Bj(e,t){return Bj=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Bj(e,t)}function RWe(e){var t=PWe();return function(){var n=dm(e),i;if(t){var o=dm(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return kWe(this,i)}}function kWe(e,t){if(t&&(Bv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return uce(e)}function uce(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function PWe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function dm(e){return dm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},dm(e)}var AWe="ht_editor_visible",yR="ht_editor_hidden",o7="textEditor",IWe="text",jm=function(e){OWe(r,e);var t=RWe(r);function r(n){var i;return SWe(this,r),i=t.call(this,n),i.eventManager=new Fi(uce(i)),i.autoResize=yWe(),i.TEXTAREA=void 0,i.textareaStyle=void 0,i.TEXTAREA_PARENT=void 0,i.textareaParentStyle=void 0,i.layerClass=void 0,i.createElements(),i.bindEvents(),i.hot.addHookOnce("afterDestroy",function(){return i.destroy()}),i}return xWe(r,[{key:"getValue",value:function(){return this.TEXTAREA.value}},{key:"setValue",value:function(i){this.TEXTAREA.value=i}},{key:"open",value:function(){var i=this;this.refreshDimensions(),this.showEditableElement();var o=this.hot.getShortcutManager();o.setActiveContextName("editor"),this.addHook("afterDocumentKeyDown",function(s){return i.onAfterDocumentKeyDown(s)}),this.registerShortcuts()}},{key:"close",value:function(){this.autoResize.unObserve(),this.hot.rootDocument.activeElement===this.TEXTAREA&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts(),this.removeHooksByKey("afterDocumentKeyDown")}},{key:"prepare",value:function(i,o,s,a,h,p){var y=this.state;if(YS(dm(r.prototype),"prepare",this).call(this,i,o,s,a,h,p),!p.readOnly){this.refreshDimensions(!0);var S=p.allowInvalid,E=p.fragmentSelection;S&&(this.TEXTAREA.value=""),y!==Ro.FINISHED&&this.hideEditableElement();var O=!E;O&&!gu()&&this.focus()}}},{key:"beginEditing",value:function(i,o){this.state===Ro.VIRGIN&&(this.TEXTAREA.value="",YS(dm(r.prototype),"beginEditing",this).call(this,i,o))}},{key:"focus",value:function(){this.TEXTAREA.select(),lM(this.TEXTAREA,this.TEXTAREA.value.length)}},{key:"createElements",value:function(){var i=this.hot.rootDocument;this.TEXTAREA=i.createElement("TEXTAREA"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.tabIndex=-1,Vt(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=i.createElement("DIV"),Vt(this.TEXTAREA_PARENT,"handsontableInputHolder"),Wr(this.TEXTAREA_PARENT,this.layerClass)&&qr(this.TEXTAREA_PARENT,this.layerClass),Vt(this.TEXTAREA_PARENT,yR),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}},{key:"hideEditableElement",value:function(){(q3e()||K3e())&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",qr(this.TEXTAREA_PARENT,this.layerClass),Vt(this.TEXTAREA_PARENT,yR)}},{key:"showEditableElement",value:function(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="",this.textareaStyle.overflowY="hidden";var i=this.TEXTAREA_PARENT.childNodes,o=!1;Or(i.length-1,function(s){var a=i[s];if(Wr(a,"handsontableEditor"))return o=!0,!1}),Wr(this.TEXTAREA_PARENT,yR)&&qr(this.TEXTAREA_PARENT,yR),o?(this.layerClass=AWe,Vt(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),Vt(this.TEXTAREA_PARENT,this.layerClass))}},{key:"refreshValue",value:function(){var i=this.hot.toPhysicalRow(this.row),o=this.hot.getSourceDataAtCell(i,this.col);this.originalValue=o,this.setValue(o),this.refreshDimensions()}},{key:"refreshDimensions",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!(this.state!==Ro.EDITING&&!i)){if(this.TD=this.getEditedCell(),!this.TD){i||this.close();return}var o=this.getEditedCellRect(),s=o.top,a=o.start,h=o.width,p=o.maxWidth,y=o.height,S=o.maxHeight;this.textareaParentStyle.top="".concat(s,"px"),this.textareaParentStyle[this.hot.isRtl()?"right":"left"]="".concat(a,"px"),this.showEditableElement();var E=hm(this.TD,this.hot.rootWindow);this.TEXTAREA.style.fontSize=E.fontSize,this.TEXTAREA.style.fontFamily=E.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor;var O=hm(this.TEXTAREA),A=parseInt(O.paddingLeft,10)+parseInt(O.paddingRight,10),$=parseInt(O.paddingTop,10)+parseInt(O.paddingBottom,10),B=h-A,j=y-$,z=p-A,W=S-$;this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(B,z),minHeight:Math.min(j,W),maxWidth:z,maxHeight:W},!0)}}},{key:"bindEvents",value:function(){var i=this;this.eventManager.addEventListener(this.TEXTAREA,"cut",function(o){return o.stopPropagation()}),this.eventManager.addEventListener(this.TEXTAREA,"paste",function(o){return o.stopPropagation()}),$ue()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",function(){return i.finishEditing(!1)}),this.addHook("afterScrollHorizontally",function(){return i.refreshDimensions()}),this.addHook("afterScrollVertically",function(){return i.refreshDimensions()}),this.addHook("afterColumnResize",function(){i.refreshDimensions(),i.focus()}),this.addHook("afterRowResize",function(){i.refreshDimensions(),i.focus()})}},{key:"allowKeyEventPropagation",value:function(){}},{key:"destroy",value:function(){this.eventManager.destroy(),this.clearHooks()}},{key:"registerShortcuts",value:function(){var i=this,o=this.hot.getShortcutManager(),s=o.getContext("editor"),a={runOnlyIf:function(){return pr(i.hot.getSelected())},group:o7},h=function(){i.hot.rootDocument.execCommand("insertText",!1,`
`)};s.addShortcuts([{keys:[["Tab"]],callback:function(y){var S=i.hot.getSettings(),E=typeof S.tabMoves=="function"?S.tabMoves(y):S.tabMoves;i.hot.selection.transformStart(E.row,E.col,!0)}},{keys:[["Shift","Tab"]],callback:function(y){var S=i.hot.getSettings(),E=typeof S.tabMoves=="function"?S.tabMoves(y):S.tabMoves;i.hot.selection.transformStart(-E.row,-E.col)}},{keys:[["Control","Enter"]],callback:function(){return h(),!1},runOnlyIf:function(y){return!i.hot.selection.isMultiple()&&!y.altKey},relativeToGroup:GS,position:"before"},{keys:[["Meta","Enter"]],callback:function(){return h(),!1},runOnlyIf:function(){return!i.hot.selection.isMultiple()},relativeToGroup:GS,position:"before"},{keys:[["Alt","Enter"]],callback:function(){return h(),!1},relativeToGroup:GS,position:"before"},{keys:[["PageUp"]],callback:function(){i.hot.selection.transformStart(-i.hot.countVisibleRows(),0)}},{keys:[["PageDown"]],callback:function(){i.hot.selection.transformStart(i.hot.countVisibleRows(),0)}},{keys:[["Home"]],callback:function(y,S){var E=r7(S,1),O=E[0];t7(O,i.TEXTAREA)}},{keys:[["End"]],callback:function(y,S){var E=r7(S,1),O=E[0];t7(O,i.TEXTAREA)}},{keys:[["Control/Meta","Z"]],preventDefault:!1,callback:function(){i.hot._registerTimeout(function(){i.autoResize.resize()},10)}},{keys:[["Control/Meta","Shift","Z"]],preventDefault:!1,callback:function(){i.hot._registerTimeout(function(){i.autoResize.resize()},10)}}],a)}},{key:"unregisterShortcuts",value:function(){var i=this.hot.getShortcutManager(),o=i.getContext("editor");o.removeShortcutsByGroup(cM),o.removeShortcutsByGroup(o7),o.removeShortcutsByGroup($j)}},{key:"onAfterDocumentKeyDown",value:function(i){var o=[Tr.ARROW_UP,Tr.ARROW_RIGHT,Tr.ARROW_DOWN,Tr.ARROW_LEFT];o.indexOf(i.keyCode)===-1&&this.autoResize.resize(String.fromCharCode(i.keyCode))}}],[{key:"EDITOR_TYPE",get:function(){return IWe}}]),r}(ow);function jv(e){"@babel/helpers - typeof";return jv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jv(e)}function MWe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,DWe(n.key),n)}}function $We(e,t,r){return t&&a7(e.prototype,t),r&&a7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function DWe(e){var t=LWe(e,"string");return jv(t)==="symbol"?t:String(t)}function LWe(e,t){if(jv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(jv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function gl(){return typeof Reflect<"u"&&Reflect.get?gl=Reflect.get.bind():gl=function(t,r,n){var i=NWe(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},gl.apply(this,arguments)}function NWe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=as(e),e!==null););return e}function BWe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&jj(e,t)}function jj(e,t){return jj=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},jj(e,t)}function jWe(e){var t=HWe();return function(){var n=as(e),i;if(t){var o=as(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return FWe(this,i)}}function FWe(e,t){if(t&&(jv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return zWe(e)}function zWe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function HWe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function as(e){return as=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},as(e)}var s7="handsontableEditor",VWe="handsontable",xU=function(e){BWe(r,e);var t=jWe(r);function r(){return MWe(this,r),t.apply(this,arguments)}return $We(r,[{key:"open",value:function(){gl(as(r.prototype),"open",this).call(this),this.htEditor&&this.htEditor.destroy(),this.htContainer.style.display==="none"&&(this.htContainer.style.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),lM(this.TEXTAREA,0,this.TEXTAREA.value.length),this.refreshDimensions()}},{key:"close",value:function(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),gl(as(r.prototype),"close",this).call(this)}},{key:"prepare",value:function(i,o,s,a,h,p){gl(as(r.prototype),"prepare",this).call(this,i,o,s,a,h,p);var y=this,S={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,afterOnCellMouseDown:function(O,A){var $=this.getSourceData(A.row,A.col);$!==void 0&&y.setValue($),y.instance.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&lo(S,p.handsontable),this.htOptions=S}},{key:"beginEditing",value:function(i,o){var s=this.hot.getSettings().onBeginEditing;s&&s()===!1||gl(as(r.prototype),"beginEditing",this).call(this,i,o)}},{key:"createElements",value:function(){gl(as(r.prototype),"createElements",this).call(this);var i=this.hot.rootDocument.createElement("DIV");i.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(i),this.htContainer=i,this.assignHooks()}},{key:"finishEditing",value:function(i,o,s){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){var a=this.htEditor.getInstance().getValue();a!==void 0&&this.setValue(a)}gl(as(r.prototype),"finishEditing",this).call(this,i,o,s)}},{key:"assignHooks",value:function(){var i=this;this.hot.addHook("afterDestroy",function(){i.htEditor&&i.htEditor.destroy()})}},{key:"registerShortcuts",value:function(){var i=this,o=this.hot.getShortcutManager(),s=o.getContext("editor");gl(as(r.prototype),"registerShortcuts",this).call(this);var a={group:s7,relativeToGroup:cM,position:"before"},h=function(y,S){var E=i.htEditor.getInstance();if(y!==void 0&&(y<0||E.flipped&&y>E.countRows()-1?E.deselectCell():E.selectCell(y,0),E.getData().length))return S.preventDefault(),Cu(S),i.hot.listen(),i.TEXTAREA.focus(),!1};s.addShortcuts([{keys:[["ArrowUp"]],callback:function(y){var S=i.htEditor.getInstance(),E,O;return!S.getSelectedLast()&&S.flipped?E=S.countRows()-1:S.getSelectedLast()&&(S.flipped?(O=S.getSelectedLast()[0],E=Math.max(0,O-1)):(O=S.getSelectedLast()[0],E=O-1)),h(E,y)},preventDefault:!1},{keys:[["ArrowDown"]],callback:function(y){var S=i.htEditor.getInstance(),E,O;if(!S.getSelectedLast()&&!S.flipped)E=0;else if(S.getSelectedLast()){if(S.flipped)E=S.getSelectedLast()[0]+1;else if(!S.flipped){var A=S.countRows()-1;O=S.getSelectedLast()[0],E=Math.min(A,O+1)}}return h(E,y)},preventDefault:!1}],a)}},{key:"unregisterShortcuts",value:function(){gl(as(r.prototype),"unregisterShortcuts",this).call(this);var i=this.hot.getShortcutManager(),o=i.getContext("editor");o.removeShortcutsByGroup(s7)}}],[{key:"EDITOR_TYPE",get:function(){return VWe}}]),r}(jm),UWe="base";function SE(e,t,r,n,i,o,s){var a=[],h=[];s.className&&Vt(t,s.className),s.readOnly&&a.push(s.readOnlyCellClassName),s.valid===!1&&s.invalidCellClassName?a.push(s.invalidCellClassName):h.push(s.invalidCellClassName),s.wordWrap===!1&&s.noWordWrapClassName&&a.push(s.noWordWrapClassName),!o&&s.placeholder&&a.push(s.placeholderCellClassName),qr(t,h),Vt(t,a)}SE.RENDERER_TYPE=UWe;var WWe="text";function Zh(e,t,r,n,i,o,s){SE.apply(this,[e,t,r,n,i,o,s]);var a=o;if(!a&&s.placeholder&&(a=s.placeholder),a=Ji(a),s.trimWhitespace&&(a=a.trim()),s.rendererTemplate){Eu(t);var h=e.rootDocument.createElement("TEMPLATE");h.setAttribute("bind","{{}}"),h.innerHTML=s.rendererTemplate,HTMLTemplateElement.decorate(h),h.model=e.getSourceDataAtRow(r),t.appendChild(h)}else fm(t,a)}Zh.RENDERER_TYPE=WWe;function Fv(e){"@babel/helpers - typeof";return Fv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fv(e)}function GWe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,cce(n.key),n)}}function YWe(e,t,r){return t&&l7(e.prototype,t),r&&l7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Sp(){return typeof Reflect<"u"&&Reflect.get?Sp=Reflect.get.bind():Sp=function(t,r,n){var i=KWe(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Sp.apply(this,arguments)}function KWe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=dc(e),e!==null););return e}function qWe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Fj(e,t)}function Fj(e,t){return Fj=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Fj(e,t)}function XWe(e){var t=JWe();return function(){var n=dc(e),i;if(t){var o=dc(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return ZWe(this,i)}}function ZWe(e,t){if(t&&(Fv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return zj(e)}function zj(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function JWe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function dc(e){return dc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},dc(e)}function QWe(e,t,r){return t=cce(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function cce(e){var t=e5e(e,"string");return Fv(t)==="symbol"?t:String(t)}function e5e(e,t){if(Fv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Fv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var cL=new WeakMap,t5e="autocomplete",CU=function(e){qWe(r,e);var t=XWe(r);function r(n){var i;return GWe(this,r),i=t.call(this,n),QWe(zj(i),"sortByRelevance",function(o,s,a){var h=[],p=[],y=o.length,S=s.length,E,O,A,$;if(y===0){for(A=0;A<S;A++)p.push(A);return p}for(A=0;A<S;A++){if(O=L9(Ji(s[A])),a)$=O.indexOf(o);else{var B=this.cellProperties.locale;$=O.toLocaleLowerCase(B).indexOf(o.toLocaleLowerCase(B))}$!==-1&&(E=O.length-$-y,h.push({baseIndex:A,index:$,charsLeft:E,value:O}))}for(h.sort(function(j,z){if(z.index===-1)return-1;if(j.index===-1)return 1;if(j.index<z.index)return-1;if(z.index<j.index)return 1;if(j.index===z.index){if(j.charsLeft<z.charsLeft)return-1;if(j.charsLeft>z.charsLeft)return 1}return 0}),A=0,S=h.length;A<S;A++)p.push(h[A].baseIndex);return p}),i.query=null,i.strippedChoices=[],i.rawChoices=[],cL.set(zj(i),{skipOne:!1,isMacOS:i.hot.rootWindow.navigator.platform.indexOf("Mac")>-1}),i}return YWe(r,[{key:"getValue",value:function(){var i=this,o=this.rawChoices.find(function(s){var a=i.stripValueIfNeeded(s);return a===i.TEXTAREA.value});return pr(o)?o:this.TEXTAREA.value}},{key:"createElements",value:function(){Sp(dc(r.prototype),"createElements",this).call(this),Vt(this.htContainer,"autocompleteEditor"),Vt(this.htContainer,this.hot.rootWindow.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll")}},{key:"open",value:function(){var i=this,o=cL.get(this);Sp(dc(r.prototype),"open",this).call(this);var s=this.htEditor.getInstance(),a=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown;this.showEditableElement(),this.focus();var h=Mo();h===0&&o.isMacOS&&(h+=15),this.addHook("beforeKeyDown",function(p){return i.onBeforeKeyDown(p)}),s.updateSettings({colWidths:a?[ii(this.TEXTAREA)-2]:void 0,width:a?ii(this.TEXTAREA)+h:void 0,renderer:function(y,S,E,O,A,$,B){Zh(y,S,E,O,A,$,B);var j=i.cellProperties,z=j.filteringCaseSensitive,W=j.allowHtml,Q=j.locale,q=i.query,Se=Ji($),Ie,He;Se&&!W&&(Ie=z===!0?Se.indexOf(q):Se.toLocaleLowerCase(Q).indexOf(q.toLocaleLowerCase(Q)),Ie!==-1&&(He=Se.substr(Ie,q.length),Se=Se.replace(He,"<strong>".concat(He,"</strong>")))),S.innerHTML=Se},autoColumnSize:!0}),o.skipOne&&(o.skipOne=!1),this.hot._registerTimeout(function(){i.queryChoices(i.TEXTAREA.value)})}},{key:"close",value:function(){this.removeHooksByKey("beforeKeyDown"),Sp(dc(r.prototype),"close",this).call(this)}},{key:"discardEditor",value:function(i){Sp(dc(r.prototype),"discardEditor",this).call(this,i),this.hot.view.render()}},{key:"queryChoices",value:function(i){var o=this,s=this.cellProperties.source;this.query=i,typeof s=="function"?s.call(this.cellProperties,i,function(a){o.rawChoices=a,o.updateChoicesList(o.stripValuesIfNeeded(a))}):Array.isArray(s)?(this.rawChoices=s,this.updateChoicesList(this.stripValuesIfNeeded(s))):this.updateChoicesList([])}},{key:"updateChoicesList",value:function(i){var o=que(this.TEXTAREA),s=xUe(this.TEXTAREA),a=this.cellProperties.sortByRelevance,h=this.cellProperties.filter,p=null,y=null,S=i;a&&(p=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),S,this.cellProperties.filteringCaseSensitive));var E=Array.isArray(p)?p.length:0;if(h===!1)E&&(y=p[0]);else{for(var O=[],A=0,$=S.length;A<$&&!(a&&E<=A);A++)E?O.push(S[p[A]]):O.push(S[A]);y=0,S=O}this.strippedChoices=S,this.htEditor.loadData(Ck([S])),this.updateDropdownHeight(),this.flipDropdownIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(y),this.hot.listen(),lM(this.TEXTAREA,o,o===s?void 0:s)}},{key:"flipDropdownIfNeeded",value:function(){var i=$1(this.hot.view._wt.wtTable.TABLE),o=i===this.hot.rootWindow,s=this.cellProperties.preventOverflow;if(o||!o&&(s||s==="horizontal"))return!1;var a=ao(this.TEXTAREA),h=Ni(this.TEXTAREA),p=this.getDropdownHeight(),y=i.scrollTop,S=Ni(this.hot.view._wt.wtTable.THEAD),E=ao(i),O=a.top-E.top-S+y,A=i.scrollHeight-O-S-h,$=p>A&&O>A;return $?this.flipDropdown(p):this.unflipDropdown(),this.limitDropdownIfNeeded($?O:A,p),$}},{key:"limitDropdownIfNeeded",value:function(i,o){if(o>i){var s=0,a=0,h=0,p=null;do h=this.htEditor.getRowHeight(a)||this.htEditor.view._wt.getSetting("defaultRowHeight"),s+=h,a+=1;while(s<i);p=s-h,this.htEditor.flipped&&(this.htEditor.rootElement.style.top="".concat(parseInt(this.htEditor.rootElement.style.top,10)+o-p,"px")),this.setDropdownHeight(s-h)}}},{key:"flipDropdown",value:function(i){var o=this.htEditor.rootElement.style;o.position="absolute",o.top="".concat(-i,"px"),this.htEditor.flipped=!0}},{key:"unflipDropdown",value:function(){var i=this.htEditor.rootElement.style;i.position="absolute",i.top="",this.htEditor.flipped=void 0}},{key:"updateDropdownHeight",value:function(){var i=this.htEditor.getColWidth(0)+Mo(this.hot.rootDocument)+2,o=this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:o?void 0:i}),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}},{key:"setDropdownHeight",value:function(i){this.htEditor.updateSettings({height:i})}},{key:"highlightBestMatchingChoice",value:function(i){typeof i=="number"?this.htEditor.selectCell(i,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}},{key:"getDropdownHeight",value:function(){var i=this.htEditor.getInstance().getRowHeight(0)||23,o=this.cellProperties.visibleRows;return this.strippedChoices.length>=o?o*i:this.strippedChoices.length*i+8}},{key:"stripValueIfNeeded",value:function(i){return this.stripValuesIfNeeded([i])[0]}},{key:"stripValuesIfNeeded",value:function(i){var o=this.cellProperties.allowHtml,s=dn(i,function(h){return Ji(h)}),a=dn(s,function(h){return o?h:L9(h)});return a}},{key:"allowKeyEventPropagation",value:function(i){var o=this.htEditor.getSelectedRangeLast(),s={row:o?o.from.row:-1},a=!1;return i===Tr.ARROW_DOWN&&s.row>0&&s.row<this.htEditor.countRows()-1&&(a=!0),i===Tr.ARROW_UP&&s.row>-1&&(a=!0),a}},{key:"onBeforeKeyDown",value:function(i){var o=this,s=cL.get(this);if(s.skipOne=!1,J3e(i.keyCode)||i.keyCode===Tr.BACKSPACE||i.keyCode===Tr.DELETE||i.keyCode===Tr.INSERT){var a=10;if(i.keyCode===Tr.C&&(i.ctrlKey||i.metaKey))return;this.isOpened()||(a+=10),this.htEditor&&this.hot._registerTimeout(function(){o.queryChoices(o.TEXTAREA.value),s.skipOne=!0},a)}}}],[{key:"EDITOR_TYPE",get:function(){return t5e}}]),r}(xU);function zv(e){"@babel/helpers - typeof";return zv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zv(e)}function r5e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,i5e(n.key),n)}}function n5e(e,t,r){return t&&u7(e.prototype,t),r&&u7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function i5e(e){var t=o5e(e,"string");return zv(t)==="symbol"?t:String(t)}function o5e(e,t){if(zv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(zv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function a5e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Hj(e,t)}function Hj(e,t){return Hj=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Hj(e,t)}function s5e(e){var t=c5e();return function(){var n=JP(e),i;if(t){var o=JP(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return l5e(this,i)}}function l5e(e,t){if(t&&(zv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return u5e(e)}function u5e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function c5e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function JP(e){return JP=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},JP(e)}var f5e="checkbox",fce=function(e){a5e(r,e);var t=s5e(r);function r(){return r5e(this,r),t.apply(this,arguments)}return n5e(r,[{key:"beginEditing",value:function(i,o){if(o&&o.type==="mouseup"){var s=this.TD.querySelector('input[type="checkbox"]');Wr(s,"htBadValue")||s.click()}}},{key:"finishEditing",value:function(){}},{key:"init",value:function(){}},{key:"open",value:function(){}},{key:"close",value:function(){}},{key:"getValue",value:function(){}},{key:"setValue",value:function(){}},{key:"focus",value:function(){}}],[{key:"EDITOR_TYPE",get:function(){return f5e}}]),r}(ow),hce={exports:{}};const h5e=nye(hHe);/*!
 * Pikaday
 *
 * Copyright  2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
 */(function(e,t){(function(r,n){var i;{try{i=h5e}catch{}e.exports=n(i)}})(Zy,function(r){var n=typeof r=="function",i=!!window.addEventListener,o=window.document,s=window.setTimeout,a=function(ie,M,U,K){i?ie.addEventListener(M,U,!!K):ie.attachEvent("on"+M,U)},h=function(ie,M,U,K){i?ie.removeEventListener(M,U,!!K):ie.detachEvent("on"+M,U)},p=function(ie){return ie.trim?ie.trim():ie.replace(/^\s+|\s+$/g,"")},y=function(ie,M){return(" "+ie.className+" ").indexOf(" "+M+" ")!==-1},S=function(ie,M){y(ie,M)||(ie.className=ie.className===""?M:ie.className+" "+M)},E=function(ie,M){ie.className=p((" "+ie.className+" ").replace(" "+M+" "," "))},O=function(ie){return/Array/.test(Object.prototype.toString.call(ie))},A=function(ie){return/Date/.test(Object.prototype.toString.call(ie))&&!isNaN(ie.getTime())},$=function(ie){var M=ie.getDay();return M===0||M===6},B=function(ie){return ie%4===0&&ie%100!==0||ie%400===0},j=function(ie,M){return[31,B(ie)?29:28,31,30,31,30,31,31,30,31,30,31][M]},z=function(ie){A(ie)&&ie.setHours(0,0,0,0)},W=function(ie,M){return ie.getTime()===M.getTime()},Q=function(ie,M,U){var K,re;for(K in M)re=ie[K]!==void 0,re&&typeof M[K]=="object"&&M[K]!==null&&M[K].nodeName===void 0?A(M[K])?U&&(ie[K]=new Date(M[K].getTime())):O(M[K])?U&&(ie[K]=M[K].slice(0)):ie[K]=Q({},M[K],U):(U||!re)&&(ie[K]=M[K]);return ie},q=function(ie,M,U){var K;o.createEvent?(K=o.createEvent("HTMLEvents"),K.initEvent(M,!0,!1),K=Q(K,U),ie.dispatchEvent(K)):o.createEventObject&&(K=o.createEventObject(),K=Q(K,U),ie.fireEvent("on"+M,K))},Se=function(ie){return ie.month<0&&(ie.year-=Math.ceil(Math.abs(ie.month)/12),ie.month+=12),ie.month>11&&(ie.year+=Math.floor(Math.abs(ie.month)/12),ie.month-=12),ie},Ie={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},He=function(ie,M,U){for(M+=ie.firstDay;M>=7;)M-=7;return U?ie.i18n.weekdaysShort[M]:ie.i18n.weekdays[M]},Le=function(ie){var M=[],U="false";if(ie.isEmpty)if(ie.showDaysInNextAndPreviousMonths)M.push("is-outside-current-month"),ie.enableSelectionDaysInNextAndPreviousMonths||M.push("is-selection-disabled");else return'<td class="is-empty"></td>';return ie.isDisabled&&M.push("is-disabled"),ie.isToday&&M.push("is-today"),ie.isSelected&&(M.push("is-selected"),U="true"),ie.hasEvent&&M.push("has-event"),ie.isInRange&&M.push("is-inrange"),ie.isStartRange&&M.push("is-startrange"),ie.isEndRange&&M.push("is-endrange"),'<td data-day="'+ie.day+'" class="'+M.join(" ")+'" aria-selected="'+U+'"><button class="pika-button pika-day" type="button" data-pika-year="'+ie.year+'" data-pika-month="'+ie.month+'" data-pika-day="'+ie.day+'">'+ie.day+"</button></td>"},ze=function(ie,M){ie.setHours(0,0,0,0);var U=ie.getDate(),K=ie.getDay(),re=M,me=re-1,Oe=7,We=function(Tt){return(Tt+Oe-1)%Oe};ie.setDate(U+me-We(K));var Je=new Date(ie.getFullYear(),0,re),ht=24*60*60*1e3,ft=(ie.getTime()-Je.getTime())/ht,St=1+Math.round((ft-me+We(Je.getDay()))/Oe);return St},ct=function(ie,M,U,K){var re=new Date(U,M,ie),me=n?r(re).isoWeek():ze(re,K);return'<td class="pika-week">'+me+"</td>"},At=function(ie,M,U,K){return'<tr class="pika-row'+(U?" pick-whole-week":"")+(K?" is-selected":"")+'">'+(M?ie.reverse():ie).join("")+"</tr>"},Qe=function(ie){return"<tbody>"+ie.join("")+"</tbody>"},de=function(ie){var M,U=[];for(ie.showWeekNumber&&U.push("<th></th>"),M=0;M<7;M++)U.push('<th scope="col"><abbr title="'+He(ie,M)+'">'+He(ie,M,!0)+"</abbr></th>");return"<thead><tr>"+(ie.isRTL?U.reverse():U).join("")+"</tr></thead>"},Ce=function(ie,M,U,K,re,me){var Oe,We,Je,ht=ie._o,ft=U===ht.minYear,St=U===ht.maxYear,Tt='<div id="'+me+'" class="pika-title" role="heading" aria-live="assertive">',Xt,jt,Kt=!0,qe=!0;for(Je=[],Oe=0;Oe<12;Oe++)Je.push('<option value="'+(U===re?Oe-M:12+Oe-M)+'"'+(Oe===K?' selected="selected"':"")+(ft&&Oe<ht.minMonth||St&&Oe>ht.maxMonth?' disabled="disabled"':"")+">"+ht.i18n.months[Oe]+"</option>");for(Xt='<div class="pika-label">'+ht.i18n.months[K]+'<select class="pika-select pika-select-month" tabindex="-1">'+Je.join("")+"</select></div>",O(ht.yearRange)?(Oe=ht.yearRange[0],We=ht.yearRange[1]+1):(Oe=U-ht.yearRange,We=1+U+ht.yearRange),Je=[];Oe<We&&Oe<=ht.maxYear;Oe++)Oe>=ht.minYear&&Je.push('<option value="'+Oe+'"'+(Oe===U?' selected="selected"':"")+">"+Oe+"</option>");return jt='<div class="pika-label">'+U+ht.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+Je.join("")+"</select></div>",ht.showMonthAfterYear?Tt+=jt+Xt:Tt+=Xt+jt,ft&&(K===0||ht.minMonth>=K)&&(Kt=!1),St&&(K===11||ht.maxMonth<=K)&&(qe=!1),M===0&&(Tt+='<button class="pika-prev'+(Kt?"":" is-disabled")+'" type="button">'+ht.i18n.previousMonth+"</button>"),M===ie._o.numberOfMonths-1&&(Tt+='<button class="pika-next'+(qe?"":" is-disabled")+'" type="button">'+ht.i18n.nextMonth+"</button>"),Tt+="</div>"},pt=function(ie,M,U){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+U+'">'+de(ie)+Qe(M)+"</table>"},Ct=function(ie){var M=this,U=M.config(ie);M._onMouseDown=function(re){if(M._v){re=re||window.event;var me=re.target||re.srcElement;if(me)if(y(me,"is-disabled")||(y(me,"pika-button")&&!y(me,"is-empty")&&!y(me.parentNode,"is-disabled")?(M.setDate(new Date(me.getAttribute("data-pika-year"),me.getAttribute("data-pika-month"),me.getAttribute("data-pika-day"))),U.bound&&s(function(){M.hide(),U.blurFieldOnSelect&&U.field&&U.field.blur()},100)):y(me,"pika-prev")?M.prevMonth():y(me,"pika-next")&&M.nextMonth()),y(me,"pika-select"))M._c=!0;else if(re.preventDefault)re.preventDefault();else return re.returnValue=!1,!1}},M._onChange=function(re){re=re||window.event;var me=re.target||re.srcElement;me&&(y(me,"pika-select-month")?M.gotoMonth(me.value):y(me,"pika-select-year")&&M.gotoYear(me.value))},M._onKeyChange=function(re){if(re=re||window.event,M.isVisible())switch(re.keyCode){case 13:case 27:U.field&&U.field.blur();break;case 37:M.adjustDate("subtract",1);break;case 38:M.adjustDate("subtract",7);break;case 39:M.adjustDate("add",1);break;case 40:M.adjustDate("add",7);break;case 8:case 46:M.setDate(null);break}},M._parseFieldValue=function(){if(U.parse)return U.parse(U.field.value,U.format);if(n){var re=r(U.field.value,U.format,U.formatStrict);return re&&re.isValid()?re.toDate():null}else return new Date(Date.parse(U.field.value))},M._onInputChange=function(re){var me;re.firedBy!==M&&(me=M._parseFieldValue(),A(me)&&M.setDate(me),M._v||M.show())},M._onInputFocus=function(){M.show()},M._onInputClick=function(){M.show()},M._onInputBlur=function(){var re=o.activeElement;do if(y(re,"pika-single"))return;while(re=re.parentNode);M._c||(M._b=s(function(){M.hide()},50)),M._c=!1},M._onClick=function(re){re=re||window.event;var me=re.target||re.srcElement,Oe=me;if(me){!i&&y(me,"pika-select")&&(me.onchange||(me.setAttribute("onchange","return;"),a(me,"change",M._onChange)));do if(y(Oe,"pika-single")||Oe===U.trigger)return;while(Oe=Oe.parentNode);M._v&&me!==U.trigger&&Oe!==U.trigger&&M.hide()}},M.el=o.createElement("div"),M.el.className="pika-single"+(U.isRTL?" is-rtl":"")+(U.theme?" "+U.theme:""),a(M.el,"mousedown",M._onMouseDown,!0),a(M.el,"touchend",M._onMouseDown,!0),a(M.el,"change",M._onChange),U.keyboardInput&&a(o,"keydown",M._onKeyChange),U.field&&(U.container?U.container.appendChild(M.el):U.bound?o.body.appendChild(M.el):U.field.parentNode.insertBefore(M.el,U.field.nextSibling),a(U.field,"change",M._onInputChange),U.defaultDate||(U.defaultDate=M._parseFieldValue(),U.setDefaultDate=!0));var K=U.defaultDate;A(K)?U.setDefaultDate?M.setDate(K,!0):M.gotoDate(K):M.gotoDate(new Date),U.bound?(this.hide(),M.el.className+=" is-bound",a(U.trigger,"click",M._onInputClick),a(U.trigger,"focus",M._onInputFocus),a(U.trigger,"blur",M._onInputBlur)):this.show()};return Ct.prototype={config:function(ie){this._o||(this._o=Q({},Ie,!0));var M=Q(this._o,ie,!0);M.isRTL=!!M.isRTL,M.field=M.field&&M.field.nodeName?M.field:null,M.theme=typeof M.theme=="string"&&M.theme?M.theme:null,M.bound=!!(M.bound!==void 0?M.field&&M.bound:M.field),M.trigger=M.trigger&&M.trigger.nodeName?M.trigger:M.field,M.disableWeekends=!!M.disableWeekends,M.disableDayFn=typeof M.disableDayFn=="function"?M.disableDayFn:null;var U=parseInt(M.numberOfMonths,10)||1;if(M.numberOfMonths=U>4?4:U,A(M.minDate)||(M.minDate=!1),A(M.maxDate)||(M.maxDate=!1),M.minDate&&M.maxDate&&M.maxDate<M.minDate&&(M.maxDate=M.minDate=!1),M.minDate&&this.setMinDate(M.minDate),M.maxDate&&this.setMaxDate(M.maxDate),O(M.yearRange)){var K=new Date().getFullYear()-10;M.yearRange[0]=parseInt(M.yearRange[0],10)||K,M.yearRange[1]=parseInt(M.yearRange[1],10)||K}else M.yearRange=Math.abs(parseInt(M.yearRange,10))||Ie.yearRange,M.yearRange>100&&(M.yearRange=100);return M},toString:function(ie){return ie=ie||this._o.format,A(this._d)?this._o.toString?this._o.toString(this._d,ie):n?r(this._d).format(ie):this._d.toDateString():""},getMoment:function(){return n?r(this._d):null},setMoment:function(ie,M){n&&r.isMoment(ie)&&this.setDate(ie.toDate(),M)},getDate:function(){return A(this._d)?new Date(this._d.getTime()):null},setDate:function(ie,M){if(!ie)return this._d=null,this._o.field&&(this._o.field.value="",q(this._o.field,"change",{firedBy:this})),this.draw();if(typeof ie=="string"&&(ie=new Date(Date.parse(ie))),!!A(ie)){var U=this._o.minDate,K=this._o.maxDate;A(U)&&ie<U?ie=U:A(K)&&ie>K&&(ie=K),this._d=new Date(ie.getTime()),z(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),q(this._o.field,"change",{firedBy:this})),!M&&typeof this._o.onSelect=="function"&&this._o.onSelect.call(this,this.getDate())}},clear:function(){this.setDate(null)},gotoDate:function(ie){var M=!0;if(A(ie)){if(this.calendars){var U=new Date(this.calendars[0].year,this.calendars[0].month,1),K=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),re=ie.getTime();K.setMonth(K.getMonth()+1),K.setDate(K.getDate()-1),M=re<U.getTime()||K.getTime()<re}M&&(this.calendars=[{month:ie.getMonth(),year:ie.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(ie,M){var U=this.getDate()||new Date,K=parseInt(M)*24*60*60*1e3,re;ie==="add"?re=new Date(U.valueOf()+K):ie==="subtract"&&(re=new Date(U.valueOf()-K)),this.setDate(re)},adjustCalendars:function(){this.calendars[0]=Se(this.calendars[0]);for(var ie=1;ie<this._o.numberOfMonths;ie++)this.calendars[ie]=Se({month:this.calendars[0].month+ie,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(ie){isNaN(ie)||(this.calendars[0].month=parseInt(ie,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(ie){isNaN(ie)||(this.calendars[0].year=parseInt(ie,10),this.adjustCalendars())},setMinDate:function(ie){ie instanceof Date?(z(ie),this._o.minDate=ie,this._o.minYear=ie.getFullYear(),this._o.minMonth=ie.getMonth()):(this._o.minDate=Ie.minDate,this._o.minYear=Ie.minYear,this._o.minMonth=Ie.minMonth,this._o.startRange=Ie.startRange),this.draw()},setMaxDate:function(ie){ie instanceof Date?(z(ie),this._o.maxDate=ie,this._o.maxYear=ie.getFullYear(),this._o.maxMonth=ie.getMonth()):(this._o.maxDate=Ie.maxDate,this._o.maxYear=Ie.maxYear,this._o.maxMonth=Ie.maxMonth,this._o.endRange=Ie.endRange),this.draw()},setStartRange:function(ie){this._o.startRange=ie},setEndRange:function(ie){this._o.endRange=ie},draw:function(ie){if(!(!this._v&&!ie)){var M=this._o,U=M.minYear,K=M.maxYear,re=M.minMonth,me=M.maxMonth,Oe="",We;this._y<=U&&(this._y=U,!isNaN(re)&&this._m<re&&(this._m=re)),this._y>=K&&(this._y=K,!isNaN(me)&&this._m>me&&(this._m=me));for(var Je=0;Je<M.numberOfMonths;Je++)We="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),Oe+='<div class="pika-lendar">'+Ce(this,Je,this.calendars[Je].year,this.calendars[Je].month,this.calendars[0].year,We)+this.render(this.calendars[Je].year,this.calendars[Je].month,We)+"</div>";this.el.innerHTML=Oe,M.bound&&M.field.type!=="hidden"&&s(function(){M.trigger.focus()},1),typeof this._o.onDraw=="function"&&this._o.onDraw(this),M.bound&&M.field.setAttribute("aria-label",M.ariaLabel)}},adjustPosition:function(){var ie,M,U,K,re,me,Oe,We,Je,ht,ft,St;if(!this._o.container){if(this.el.style.position="absolute",ie=this._o.trigger,M=ie,U=this.el.offsetWidth,K=this.el.offsetHeight,re=window.innerWidth||o.documentElement.clientWidth,me=window.innerHeight||o.documentElement.clientHeight,Oe=window.pageYOffset||o.body.scrollTop||o.documentElement.scrollTop,ft=!0,St=!0,typeof ie.getBoundingClientRect=="function")ht=ie.getBoundingClientRect(),We=ht.left+window.pageXOffset,Je=ht.bottom+window.pageYOffset;else for(We=M.offsetLeft,Je=M.offsetTop+M.offsetHeight;M=M.offsetParent;)We+=M.offsetLeft,Je+=M.offsetTop;(this._o.reposition&&We+U>re||this._o.position.indexOf("right")>-1&&We-U+ie.offsetWidth>0)&&(We=We-U+ie.offsetWidth,ft=!1),(this._o.reposition&&Je+K>me+Oe||this._o.position.indexOf("top")>-1&&Je-K-ie.offsetHeight>0)&&(Je=Je-K-ie.offsetHeight,St=!1),this.el.style.left=We+"px",this.el.style.top=Je+"px",S(this.el,ft?"left-aligned":"right-aligned"),S(this.el,St?"bottom-aligned":"top-aligned"),E(this.el,ft?"right-aligned":"left-aligned"),E(this.el,St?"top-aligned":"bottom-aligned")}},render:function(ie,M,U){var K=this._o,re=new Date,me=j(ie,M),Oe=new Date(ie,M,1).getDay(),We=[],Je=[];z(re),K.firstDay>0&&(Oe-=K.firstDay,Oe<0&&(Oe+=7));for(var ht=M===0?11:M-1,ft=M===11?0:M+1,St=M===0?ie-1:ie,Tt=M===11?ie+1:ie,Xt=j(St,ht),jt=me+Oe,Kt=jt;Kt>7;)Kt-=7;jt+=7-Kt;for(var qe=!1,yr=0,Ar=0;yr<jt;yr++){var wr=new Date(ie,M,1+(yr-Oe)),vr=A(this._d)?W(wr,this._d):!1,Cr=W(wr,re),se=K.events.indexOf(wr.toDateString())!==-1,ye=yr<Oe||yr>=me+Oe,Ee=1+(yr-Oe),Ye=M,je=ie,tt=K.startRange&&W(K.startRange,wr),Ue=K.endRange&&W(K.endRange,wr),Ve=K.startRange&&K.endRange&&K.startRange<wr&&wr<K.endRange,at=K.minDate&&wr<K.minDate||K.maxDate&&wr>K.maxDate||K.disableWeekends&&$(wr)||K.disableDayFn&&K.disableDayFn(wr);ye&&(yr<Oe?(Ee=Xt+Ee,Ye=ht,je=St):(Ee=Ee-me,Ye=ft,je=Tt));var et={day:Ee,month:Ye,year:je,hasEvent:se,isSelected:vr,isToday:Cr,isDisabled:at,isEmpty:ye,isStartRange:tt,isEndRange:Ue,isInRange:Ve,showDaysInNextAndPreviousMonths:K.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:K.enableSelectionDaysInNextAndPreviousMonths};K.pickWholeWeek&&vr&&(qe=!0),Je.push(Le(et)),++Ar===7&&(K.showWeekNumber&&Je.unshift(ct(yr-Oe,M,ie,K.firstWeekOfYearMinDays)),We.push(At(Je,K.isRTL,K.pickWholeWeek,qe)),Je=[],Ar=0,qe=!1)}return pt(K,We,U)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),E(this.el,"is-hidden"),this._o.bound&&(a(o,"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){var ie=this._v;ie!==!1&&(this._o.bound&&h(o,"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),S(this.el,"is-hidden"),this._v=!1,ie!==void 0&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){var ie=this._o;this.hide(),h(this.el,"mousedown",this._onMouseDown,!0),h(this.el,"touchend",this._onMouseDown,!0),h(this.el,"change",this._onChange),ie.keyboardInput&&h(o,"keydown",this._onKeyChange),ie.field&&(h(ie.field,"change",this._onInputChange),ie.bound&&(h(ie.trigger,"click",this._onInputClick),h(ie.trigger,"focus",this._onInputFocus),h(ie.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}},Ct})})(hce);var d5e=hce.exports;const c7=jb(d5e);function Hv(e){"@babel/helpers - typeof";return Hv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hv(e)}function p5e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,g5e(n.key),n)}}function m5e(e,t,r){return t&&f7(e.prototype,t),r&&f7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function g5e(e){var t=y5e(e,"string");return Hv(t)==="symbol"?t:String(t)}function y5e(e,t){if(Hv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Hv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ac(){return typeof Reflect<"u"&&Reflect.get?ac=Reflect.get.bind():ac=function(t,r,n){var i=v5e(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},ac.apply(this,arguments)}function v5e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=wl(e),e!==null););return e}function _5e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Vj(e,t)}function Vj(e,t){return Vj=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Vj(e,t)}function b5e(e){var t=x5e();return function(){var n=wl(e),i;if(t){var o=wl(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return w5e(this,i)}}function w5e(e,t){if(t&&(Hv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return S5e(e)}function S5e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function x5e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function wl(e){return wl=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},wl(e)}var dce="date",h7="dateEditor",pce=function(e){_5e(r,e);var t=b5e(r);function r(n){var i;return p5e(this,r),i=t.call(this,n),i.defaultDateFormat="DD/MM/YYYY",i.isCellEdited=!1,i.parentDestroyed=!1,i.$datePicker=null,i}return m5e(r,[{key:"init",value:function(){var i=this;if(typeof Ut!="function")throw new Error("You need to include moment.js to your project.");if(typeof c7!="function")throw new Error("You need to include Pikaday to your project.");ac(wl(r.prototype),"init",this).call(this),this.instance.addHook("afterDestroy",function(){i.parentDestroyed=!0,i.destroyElements()})}},{key:"createElements",value:function(){ac(wl(r.prototype),"createElements",this).call(this),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),Vt(this.datePicker,"htDatepickerHolder"),this.hot.rootDocument.body.appendChild(this.datePicker);var i=new Fi(this);i.addEventListener(this.datePicker,"mousedown",function(o){return o.stopPropagation()})}},{key:"destroyElements",value:function(){var i=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),i&&i.removeChild(this.datePicker)}},{key:"prepare",value:function(i,o,s,a,h,p){ac(wl(r.prototype),"prepare",this).call(this,i,o,s,a,h,p)}},{key:"open",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,o=this.hot.getShortcutManager(),s=o.getContext("editor");ac(wl(r.prototype),"open",this).call(this),this.showDatepicker(i),s.addShortcut({keys:[["Enter"]],callback:function(h){h.stopPropagation()},group:h7})}},{key:"close",value:function(){var i,o=this;this._opened=!1,(i=this.$datePicker)!==null&&i!==void 0&&i.destroy&&this.$datePicker.destroy(),this.instance._registerTimeout(function(){o.instance._refreshBorders()});var s=this.hot.getShortcutManager(),a=s.getContext("editor");a.removeShortcutsByGroup(h7),ac(wl(r.prototype),"close",this).call(this)}},{key:"finishEditing",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(i){var s=this.originalValue;s!==void 0&&this.setValue(s)}ac(wl(r.prototype),"finishEditing",this).call(this,i,o)}},{key:"showDatepicker",value:function(i){var o=this.TD.getBoundingClientRect(),s=this.cellProperties.dateFormat||this.defaultDateFormat,a=this.instance.view.isMouseDown(),h=i?Lue(i.keyCode):!1,p;this.datePicker.style.display="block",this.$datePicker=new c7(this.getDatePickerConfig()),this.$datePicker._onInputFocus=function(){},this.datePickerStyle.top="".concat(this.hot.rootWindow.pageYOffset+o.top+Ni(this.TD),"px");var y=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?y=o.right-ii(this.datePicker):y=o.left,this.datePickerStyle.left="".concat(y,"px"),this.originalValue?(p=this.originalValue,Ut(p,s,!0).isValid()&&this.$datePicker.setMoment(Ut(p,s),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!h&&!a&&this.setValue("")):this.cellProperties.defaultDate?(p=this.cellProperties.defaultDate,Ut(p,s,!0).isValid()&&this.$datePicker.setMoment(Ut(p,s),!0),!h&&!a&&this.setValue("")):this.$datePicker.gotoToday()}},{key:"hideDatepicker",value:function(){this.datePickerStyle.display="none",this.$datePicker.hide()}},{key:"getDatePickerConfig",value:function(){var i=this,o=this.TEXTAREA,s={};this.cellProperties&&this.cellProperties.datePickerConfig&&sM(s,this.cellProperties.datePickerConfig);var a=s.onSelect,h=s.onClose;return s.field=o,s.trigger=o,s.container=this.datePicker,s.bound=!1,s.format=s.format||this.defaultDateFormat,s.reposition=s.reposition||!1,s.isRTL=!1,s.onSelect=function(p){var y=p;isNaN(y.getTime())||(y=Ut(y).format(i.cellProperties.dateFormat||i.defaultDateFormat)),i.setValue(y),i.hideDatepicker(),a&&a()},s.onClose=function(){i.parentDestroyed||i.finishEditing(!1),h&&h()},s}}],[{key:"EDITOR_TYPE",get:function(){return dce}}]),r}(jm);function Vv(e){"@babel/helpers - typeof";return Vv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vv(e)}function C5e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,T5e(n.key),n)}}function E5e(e,t,r){return t&&d7(e.prototype,t),r&&d7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function T5e(e){var t=O5e(e,"string");return Vv(t)==="symbol"?t:String(t)}function O5e(e,t){if(Vv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Vv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Rk(){return typeof Reflect<"u"&&Reflect.get?Rk=Reflect.get.bind():Rk=function(t,r,n){var i=R5e(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Rk.apply(this,arguments)}function R5e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Uv(e),e!==null););return e}function k5e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Uj(e,t)}function Uj(e,t){return Uj=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Uj(e,t)}function P5e(e){var t=M5e();return function(){var n=Uv(e),i;if(t){var o=Uv(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return A5e(this,i)}}function A5e(e,t){if(t&&(Vv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return I5e(e)}function I5e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function M5e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Uv(e){return Uv=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Uv(e)}var $5e="dropdown",EU=function(e){k5e(r,e);var t=P5e(r);function r(){return C5e(this,r),t.apply(this,arguments)}return E5e(r,[{key:"prepare",value:function(i,o,s,a,h,p){Rk(Uv(r.prototype),"prepare",this).call(this,i,o,s,a,h,p),this.cellProperties.filter=!1,this.cellProperties.strict=!0}}],[{key:"EDITOR_TYPE",get:function(){return $5e}}]),r}(CU);gr.getSingleton().add("beforeValidate",function(e,t,r){var n=this.getCellMeta(t,this.propToCol(r));n.editor===EU&&n.strict===void 0&&(n.filter=!1,n.strict=!0)});function Wv(e){"@babel/helpers - typeof";return Wv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wv(e)}function D5e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,N5e(n.key),n)}}function L5e(e,t,r){return t&&p7(e.prototype,t),r&&p7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function N5e(e){var t=B5e(e,"string");return Wv(t)==="symbol"?t:String(t)}function B5e(e,t){if(Wv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Wv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function j5e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Wj(e,t)}function Wj(e,t){return Wj=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Wj(e,t)}function F5e(e){var t=V5e();return function(){var n=QP(e),i;if(t){var o=QP(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return z5e(this,i)}}function z5e(e,t){if(t&&(Wv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return H5e(e)}function H5e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function V5e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function QP(e){return QP=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},QP(e)}var U5e="numeric",mce=function(e){j5e(r,e);var t=F5e(r);function r(){return D5e(this,r),t.apply(this,arguments)}return L5e(r,null,[{key:"EDITOR_TYPE",get:function(){return U5e}}]),r}(jm);function Gv(e){"@babel/helpers - typeof";return Gv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gv(e)}function W5e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function m7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Y5e(n.key),n)}}function G5e(e,t,r){return t&&m7(e.prototype,t),r&&m7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Y5e(e){var t=K5e(e,"string");return Gv(t)==="symbol"?t:String(t)}function K5e(e,t){if(Gv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Gv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function kk(){return typeof Reflect<"u"&&Reflect.get?kk=Reflect.get.bind():kk=function(t,r,n){var i=q5e(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},kk.apply(this,arguments)}function q5e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Yv(e),e!==null););return e}function X5e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Gj(e,t)}function Gj(e,t){return Gj=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Gj(e,t)}function Z5e(e){var t=eGe();return function(){var n=Yv(e),i;if(t){var o=Yv(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return J5e(this,i)}}function J5e(e,t){if(t&&(Gv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Q5e(e)}function Q5e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function eGe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Yv(e){return Yv=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Yv(e)}var tGe="password",gce=function(e){X5e(r,e);var t=Z5e(r);function r(){return W5e(this,r),t.apply(this,arguments)}return G5e(r,[{key:"createElements",value:function(){kk(Yv(r.prototype),"createElements",this).call(this),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,Eu(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}],[{key:"EDITOR_TYPE",get:function(){return tGe}}]),r}(jm);function pm(e){"@babel/helpers - typeof";return pm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pm(e)}function rGe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function g7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,iGe(n.key),n)}}function nGe(e,t,r){return t&&g7(e.prototype,t),r&&g7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function iGe(e){var t=oGe(e,"string");return pm(t)==="symbol"?t:String(t)}function oGe(e,t){if(pm(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(pm(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Pk(){return typeof Reflect<"u"&&Reflect.get?Pk=Reflect.get.bind():Pk=function(t,r,n){var i=aGe(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Pk.apply(this,arguments)}function aGe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Kv(e),e!==null););return e}function sGe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Yj(e,t)}function Yj(e,t){return Yj=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Yj(e,t)}function lGe(e){var t=fGe();return function(){var n=Kv(e),i;if(t){var o=Kv(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return uGe(this,i)}}function uGe(e,t){if(t&&(pm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return cGe(e)}function cGe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function fGe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Kv(e){return Kv=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Kv(e)}var fL="ht_editor_visible",y7="selectEditor",hGe="select",dGe=function(e){sGe(r,e);var t=lGe(r);function r(){return rGe(this,r),t.apply(this,arguments)}return nGe(r,[{key:"init",value:function(){this.select=this.hot.rootDocument.createElement("SELECT"),Vt(this.select,"htSelectEditor"),this.select.style.display="none",this.hot.rootElement.appendChild(this.select),this.registerHooks()}},{key:"getValue",value:function(){return this.select.value}},{key:"setValue",value:function(i){this.select.value=i}},{key:"open",value:function(){this._opened=!0,this.refreshDimensions(),this.select.style.display="";var i=this.hot.getShortcutManager();i.setActiveContextName("editor"),this.registerShortcuts()}},{key:"close",value:function(){this._opened=!1,this.select.style.display="none",Wr(this.select,fL)&&qr(this.select,fL),this.unregisterShortcuts(),this.clearHooks()}},{key:"focus",value:function(){this.select.focus()}},{key:"registerHooks",value:function(){var i=this;this.addHook("afterScrollHorizontally",function(){return i.refreshDimensions()}),this.addHook("afterScrollVertically",function(){return i.refreshDimensions()}),this.addHook("afterColumnResize",function(){return i.refreshDimensions()}),this.addHook("afterRowResize",function(){return i.refreshDimensions()})}},{key:"prepare",value:function(i,o,s,a,h,p){var y=this;Pk(Kv(r.prototype),"prepare",this).call(this,i,o,s,a,h,p);var S=this.cellProperties.selectOptions,E;typeof S=="function"?E=this.prepareOptions(S(this.row,this.col,this.prop)):E=this.prepareOptions(S),Eu(this.select),mn(E,function(O,A){var $=y.hot.rootDocument.createElement("OPTION");$.value=A,iw($,O),y.select.appendChild($)})}},{key:"prepareOptions",value:function(i){var o={};if(Array.isArray(i))for(var s=0,a=i.length;s<a;s++)o[i[s]]=i[s];else pm(i)==="object"&&(o=i);return o}},{key:"refreshValue",value:function(){var i=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=i,this.setValue(i),this.refreshDimensions()}},{key:"refreshDimensions",value:function(){if(this.state===Ro.EDITING){if(this.TD=this.getEditedCell(),!this.TD){this.close();return}var i=this.getEditedCellRect(),o=i.top,s=i.start,a=i.width,h=i.height,p=this.select.style;p.height="".concat(h,"px"),p.width="".concat(a,"px"),p.top="".concat(o,"px"),p[this.hot.isRtl()?"right":"left"]="".concat(s,"px"),p.margin="0px",Vt(this.select,fL)}}},{key:"registerShortcuts",value:function(){var i=this,o=this.hot.getShortcutManager(),s=o.getContext("editor"),a={group:y7};this.isInFullEditMode()!==!1&&s.addShortcuts([{keys:[["ArrowUp"]],callback:function(){var p=i.select.selectedIndex-1;p>=0&&(i.select[p].selected=!0)}},{keys:[["ArrowDown"]],callback:function(){var p=i.select.selectedIndex+1;p<=i.select.length-1&&(i.select[p].selected=!0)}}],a)}},{key:"unregisterShortcuts",value:function(){var i=this.hot.getShortcutManager(),o=i.getContext("editor");o.removeShortcutsByGroup(y7)}}],[{key:"EDITOR_TYPE",get:function(){return hGe}}]),r}(ow);function qv(e){"@babel/helpers - typeof";return qv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qv(e)}function pGe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function v7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,gGe(n.key),n)}}function mGe(e,t,r){return t&&v7(e.prototype,t),r&&v7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function gGe(e){var t=yGe(e,"string");return qv(t)==="symbol"?t:String(t)}function yGe(e,t){if(qv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(qv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ak(){return typeof Reflect<"u"&&Reflect.get?Ak=Reflect.get.bind():Ak=function(t,r,n){var i=vGe(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Ak.apply(this,arguments)}function vGe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Xv(e),e!==null););return e}function _Ge(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Kj(e,t)}function Kj(e,t){return Kj=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Kj(e,t)}function bGe(e){var t=xGe();return function(){var n=Xv(e),i;if(t){var o=Xv(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return wGe(this,i)}}function wGe(e,t){if(t&&(qv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return SGe(e)}function SGe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function xGe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Xv(e){return Xv=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Xv(e)}var CGe="time",yce=function(e){_Ge(r,e);var t=bGe(r);function r(){return pGe(this,r),t.apply(this,arguments)}return mGe(r,[{key:"prepare",value:function(i,o,s,a,h,p){Ak(Xv(r.prototype),"prepare",this).call(this,i,o,s,a,h,p),this.TEXTAREA.dir="ltr"}}],[{key:"EDITOR_TYPE",get:function(){return CGe}}]),r}(jm);function EGe(){ns(ow),ns(CU),ns(fce),ns(pce),ns(EU),ns(xU),ns(mce),ns(gce),ns(dGe),ns(jm),ns(yce)}var TGe="html";function TU(e,t,r,n,i,o,s){SE.apply(this,[e,t,r,n,i,o,s]),iw(t,o??"",!1)}TU.RENDERER_TYPE=TGe;var OGe="autocomplete";function aw(e,t,r,n,i,o,s){var a=e.rootDocument,h=s.allowHtml?TU:Zh,p=a.createElement("DIV");if(p.className="htAutocompleteArrow",p.appendChild(a.createTextNode(String.fromCharCode(9660))),h.apply(this,[e,t,r,n,i,o,s]),t.firstChild||t.appendChild(a.createTextNode(String.fromCharCode(160))),t.insertBefore(p,t.firstChild),Vt(t,"htAutocomplete"),!e.acArrowListener){var y=new Fi(e);e.acArrowListener=function(S){Wr(S.target,"htAutocompleteArrow")&&e.view._wt.getSetting("onCellDblClick",null,e._createCellCoords(r,n),t)},y.addEventListener(e.rootElement,"mousedown",e.acArrowListener),e.addHookOnce("afterDestroy",function(){y.destroy()})}}aw.RENDERER_TYPE=OGe;var _7=new WeakMap,b7=new WeakMap,RGe="htBadValue",Zv="data-row",Jv="data-col",kGe="checkboxRenderer",vce="checkbox";gr.getSingleton().add("modifyAutoColumnSizeSeed",function(e,t,r){var n=t.label,i=t.type,o=t.row,s=t.column,a=t.prop;if(i===vce){if(n){var h=n.value,p=n.property,y=r;if(h)y=typeof h=="function"?h(o,s,a,r):h;else if(p){var S=this.getDataAtRowProp(o,p);y=S!==null?S:r}e=y}return e}});function OU(e,t,r,n,i,o,s){var a=e.rootDocument;SE.apply(this,[e,t,r,n,i,o,s]),PGe(e);var h=AGe(a),p=s.label,y=!1;if(typeof s.checkedTemplate>"u"&&(s.checkedTemplate=!0),typeof s.uncheckedTemplate>"u"&&(s.uncheckedTemplate=!1),Eu(t),o===s.checkedTemplate||Ji(o).toLocaleLowerCase(s.locale)===Ji(s.checkedTemplate).toLocaleLowerCase(s.locale)?h.checked=!0:o===s.uncheckedTemplate||Ji(o).toLocaleLowerCase(s.locale)===Ji(s.uncheckedTemplate).toLocaleLowerCase(s.locale)?h.checked=!1:_o(o)?Vt(h,"noValue"):(h.style.display="none",Vt(h,RGe),y=!0),h.setAttribute(Zv,r),h.setAttribute(Jv,n),!y&&p){var S="";if(p.value)S=typeof p.value=="function"?p.value.call(this,r,n,i,o):p.value;else if(p.property){var E=e.getDataAtRowProp(r,p.property);S=E!==null?E:""}var O=IGe(a,S,p.separated!==!0);p.position==="before"?p.separated?(t.appendChild(O),t.appendChild(h)):(O.appendChild(h),h=O):(!p.position||p.position==="after")&&(p.separated?(t.appendChild(h),t.appendChild(O)):(O.insertBefore(h,O.firstChild),h=O))}(!p||p&&!p.separated)&&t.appendChild(h),y&&t.appendChild(a.createTextNode("#bad-value#")),_7.has(e)||(_7.set(e,!0),A());function A(){var j=e.getShortcutManager(),z=j.getContext("grid"),W={group:kGe};z.addShortcuts([{keys:[["space"]],callback:function(){return $(),!B()}},{keys:[["enter"]],callback:function(){return $(),!B()},runOnlyIf:function(){return e.getSettings().enterBeginsEditing}},{keys:[["delete"],["backspace"]],callback:function(){return $(!0),!B()},relativeToGroup:GS,position:"before"}],W)}function $(){var j=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,z=e.getSelectedRange();if(z)for(var W=0;W<z.length;W++){for(var Q=z[W].getTopStartCorner(),q=Q.row,Se=Q.col,Ie=z[W].getBottomEndCorner(),He=Ie.row,Le=Ie.col,ze=[],ct=q;ct<=He;ct+=1)for(var At=Se;At<=Le;At+=1){var Qe=e.getCellMeta(ct,At);if(Qe.type!=="checkbox")return;if(Qe.readOnly!==!0){typeof Qe.checkedTemplate>"u"&&(Qe.checkedTemplate=!0),typeof Qe.uncheckedTemplate>"u"&&(Qe.uncheckedTemplate=!1);var de=e.getDataAtCell(ct,At);j===!1?[Qe.checkedTemplate,Qe.checkedTemplate.toString()].includes(de)?ze.push([ct,At,Qe.uncheckedTemplate]):[Qe.uncheckedTemplate,Qe.uncheckedTemplate.toString(),null,void 0].includes(de)&&ze.push([ct,At,Qe.checkedTemplate]):ze.push([ct,At,Qe.uncheckedTemplate])}}ze.length>0&&e.setDataAtCell(ze)}}function B(){var j=e.getSelectedRange();if(j){for(var z=0;z<j.length;z++)for(var W=j[z].getTopStartCorner(),Q=j[z].getBottomEndCorner(),q=W.row;q<=Q.row;q++)for(var Se=W.col;Se<=Q.col;Se++){var Ie=e.getCellMeta(q,Se);if(Ie.type!=="checkbox")return!1;var He=e.getCell(q,Se);if(He==null)return!0;var Le=He.querySelectorAll("input[type=checkbox]");if(Le.length>0&&!Ie.readOnly)return!0}return!1}}}OU.RENDERER_TYPE=vce;function PGe(e){var t=b7.get(e);if(!t){var r=e.rootElement;t=new Fi(e),t.addEventListener(r,"click",function(n){return $Ge(n,e)}),t.addEventListener(r,"mouseup",function(n){return MGe(n,e)}),t.addEventListener(r,"change",function(n){return DGe(n,e)}),b7.set(e,t)}return t}function AGe(e){var t=e.createElement("input");return t.className="htCheckboxRendererInput",t.type="checkbox",t.setAttribute("autocomplete","off"),t.setAttribute("tabindex","-1"),t.cloneNode(!1)}function IGe(e,t,r){var n=e.createElement("label");return n.className="htCheckboxRendererLabel ".concat(r?"fullWidth":""),n.appendChild(e.createTextNode(t)),n.cloneNode(!0)}function MGe(e,t){var r=e.target;RU(r)&&(!r.hasAttribute(Zv)||!r.hasAttribute(Jv)||setTimeout(t.listen,10))}function $Ge(e,t){var r=e.target;if(RU(r)&&!(!r.hasAttribute(Zv)||!r.hasAttribute(Jv))){var n=parseInt(r.getAttribute(Zv),10),i=parseInt(r.getAttribute(Jv),10),o=t.getCellMeta(n,i);o.readOnly&&e.preventDefault()}}function DGe(e,t){var r=e.target;if(RU(r)&&!(!r.hasAttribute(Zv)||!r.hasAttribute(Jv))){var n=parseInt(r.getAttribute(Zv),10),i=parseInt(r.getAttribute(Jv),10),o=t.getCellMeta(n,i);if(!o.readOnly){var s=null;e.target.checked?s=o.uncheckedTemplate===void 0?!0:o.checkedTemplate:s=o.uncheckedTemplate===void 0?!1:o.uncheckedTemplate,t.setDataAtCell(n,i,s)}}}function RU(e){return e.tagName==="INPUT"&&e.getAttribute("type")==="checkbox"}function vR(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var _ce={exports:{}};(function(e,t){(function(r){e.exports=r()})(function(){return function r(n,i,o){function s(p,y){if(!i[p]){if(!n[p]){var S=typeof vR=="function"&&vR;if(!y&&S)return S(p,!0);if(a)return a(p,!0);var E=new Error("Cannot find module '"+p+"'");throw E.code="MODULE_NOT_FOUND",E}var O=i[p]={exports:{}};n[p][0].call(O.exports,function(A){return s(n[p][1][A]||A)},O,O.exports,r,n,i,o)}return i[p].exports}for(var a=typeof vR=="function"&&vR,h=0;h<o.length;h++)s(o[h]);return s}({1:[function(r,n,i){(function(o){var s,a=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,h=Math.ceil,p=Math.floor,y="[BigNumber Error] ",S=y+"Number primitive has more than 15 significant digits: ",E=1e14,O=14,A=9007199254740991,$=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],B=1e7,j=1e9;function z(Le){var ze=0|Le;return 0<Le||Le===ze?ze:ze-1}function W(Le){for(var ze,ct,At=1,Qe=Le.length,de=Le[0]+"";At<Qe;){for(ze=Le[At++]+"",ct=O-ze.length;ct--;ze="0"+ze);de+=ze}for(Qe=de.length;de.charCodeAt(--Qe)===48;);return de.slice(0,Qe+1||1)}function Q(Le,ze){var ct,At,Qe=Le.c,de=ze.c,Ce=Le.s,pt=ze.s,Ct=Le.e,ie=ze.e;if(!Ce||!pt)return null;if(ct=Qe&&!Qe[0],At=de&&!de[0],ct||At)return ct?At?0:-pt:Ce;if(Ce!=pt)return Ce;if(ct=Ce<0,At=Ct==ie,!Qe||!de)return At?0:!Qe^ct?1:-1;if(!At)return ie<Ct^ct?1:-1;for(pt=(Ct=Qe.length)<(ie=de.length)?Ct:ie,Ce=0;Ce<pt;Ce++)if(Qe[Ce]!=de[Ce])return Qe[Ce]>de[Ce]^ct?1:-1;return Ct==ie?0:ie<Ct^ct?1:-1}function q(Le,ze,ct,At){if(Le<ze||ct<Le||Le!==(Le<0?h(Le):p(Le)))throw Error(y+(At||"Argument")+(typeof Le=="number"?Le<ze||ct<Le?" out of range: ":" not an integer: ":" not a primitive number: ")+String(Le))}function Se(Le){var ze=Le.c.length-1;return z(Le.e/O)==ze&&Le.c[ze]%2!=0}function Ie(Le,ze){return(1<Le.length?Le.charAt(0)+"."+Le.slice(1):Le)+(ze<0?"e":"e+")+ze}function He(Le,ze,ct){var At,Qe;if(ze<0){for(Qe=ct+".";++ze;Qe+=ct);Le=Qe+Le}else if(++ze>(At=Le.length)){for(Qe=ct,ze-=At;--ze;Qe+=ct);Le+=Qe}else ze<At&&(Le=Le.slice(0,ze)+"."+Le.slice(ze));return Le}(s=function Le(ze){var ct,At,Qe,de,Ce,pt,Ct,ie,M,U,K=qe.prototype={constructor:qe,toString:null,valueOf:null},re=new qe(1),me=20,Oe=4,We=-7,Je=21,ht=-1e7,ft=1e7,St=!1,Tt=1,Xt=0,jt={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"",suffix:""},Kt="0123456789abcdefghijklmnopqrstuvwxyz";function qe(se,ye){var Ee,Ye,je,tt,Ue,Ve,at,et,mt=this;if(!(mt instanceof qe))return new qe(se,ye);if(ye==null){if(se instanceof qe)return mt.s=se.s,mt.e=se.e,void(mt.c=(se=se.c)?se.slice():se);if((Ve=typeof se=="number")&&0*se==0){if(mt.s=1/se<0?(se=-se,-1):1,se===~~se){for(tt=0,Ue=se;10<=Ue;Ue/=10,tt++);return mt.e=tt,void(mt.c=[se])}et=String(se)}else{if(et=String(se),!a.test(et))return Qe(mt,et,Ve);mt.s=et.charCodeAt(0)==45?(et=et.slice(1),-1):1}-1<(tt=et.indexOf("."))&&(et=et.replace(".","")),0<(Ue=et.search(/e/i))?(tt<0&&(tt=Ue),tt+=+et.slice(Ue+1),et=et.substring(0,Ue)):tt<0&&(tt=et.length)}else{if(q(ye,2,Kt.length,"Base"),et=String(se),ye==10)return vr(mt=new qe(se instanceof qe?se:et),me+mt.e+1,Oe);if(Ve=typeof se=="number"){if(0*se!=0)return Qe(mt,et,Ve,ye);if(mt.s=1/se<0?(et=et.slice(1),-1):1,qe.DEBUG&&15<et.replace(/^0\.0*|\./,"").length)throw Error(S+se);Ve=!1}else mt.s=et.charCodeAt(0)===45?(et=et.slice(1),-1):1;for(Ee=Kt.slice(0,ye),tt=Ue=0,at=et.length;Ue<at;Ue++)if(Ee.indexOf(Ye=et.charAt(Ue))<0){if(Ye=="."){if(tt<Ue){tt=at;continue}}else if(!je&&(et==et.toUpperCase()&&(et=et.toLowerCase())||et==et.toLowerCase()&&(et=et.toUpperCase()))){je=!0,Ue=-1,tt=0;continue}return Qe(mt,String(se),Ve,ye)}-1<(tt=(et=At(et,ye,10,mt.s)).indexOf("."))?et=et.replace(".",""):tt=et.length}for(Ue=0;et.charCodeAt(Ue)===48;Ue++);for(at=et.length;et.charCodeAt(--at)===48;);if(et=et.slice(Ue,++at)){if(at-=Ue,Ve&&qe.DEBUG&&15<at&&(A<se||se!==p(se)))throw Error(S+mt.s*se);if(ft<(tt=tt-Ue-1))mt.c=mt.e=null;else if(tt<ht)mt.c=[mt.e=0];else{if(mt.e=tt,mt.c=[],Ue=(tt+1)%O,tt<0&&(Ue+=O),Ue<at){for(Ue&&mt.c.push(+et.slice(0,Ue)),at-=O;Ue<at;)mt.c.push(+et.slice(Ue,Ue+=O));et=et.slice(Ue),Ue=O-et.length}else Ue-=at;for(;Ue--;et+="0");mt.c.push(+et)}}else mt.c=[mt.e=0]}function yr(se,ye,Ee,Ye){var je,tt,Ue,Ve,at;if(Ee==null?Ee=Oe:q(Ee,0,8),!se.c)return se.toString();if(je=se.c[0],Ue=se.e,ye==null)at=W(se.c),at=Ye==1||Ye==2&&(Ue<=We||Je<=Ue)?Ie(at,Ue):He(at,Ue,"0");else if(tt=(se=vr(new qe(se),ye,Ee)).e,Ve=(at=W(se.c)).length,Ye==1||Ye==2&&(ye<=tt||tt<=We)){for(;Ve<ye;at+="0",Ve++);at=Ie(at,tt)}else if(ye-=Ue,at=He(at,tt,"0"),Ve<tt+1){if(0<--ye)for(at+=".";ye--;at+="0");}else if(0<(ye+=tt-Ve))for(tt+1==Ve&&(at+=".");ye--;at+="0");return se.s<0&&je?"-"+at:at}function Ar(se,ye){for(var Ee,Ye=1,je=new qe(se[0]);Ye<se.length;Ye++){if(!(Ee=new qe(se[Ye])).s){je=Ee;break}ye.call(je,Ee)&&(je=Ee)}return je}function wr(se,ye,Ee){for(var Ye=1,je=ye.length;!ye[--je];ye.pop());for(je=ye[0];10<=je;je/=10,Ye++);return(Ee=Ye+Ee*O-1)>ft?se.c=se.e=null:se.c=Ee<ht?[se.e=0]:(se.e=Ee,ye),se}function vr(se,ye,Ee,Ye){var je,tt,Ue,Ve,at,et,mt,Ht=se.c,or=$;if(Ht){e:{for(je=1,Ve=Ht[0];10<=Ve;Ve/=10,je++);if((tt=ye-je)<0)tt+=O,Ue=ye,mt=(at=Ht[et=0])/or[je-Ue-1]%10|0;else if((et=h((tt+1)/O))>=Ht.length){if(!Ye)break e;for(;Ht.length<=et;Ht.push(0));at=mt=0,Ue=(tt%=O)-O+(je=1)}else{for(at=Ve=Ht[et],je=1;10<=Ve;Ve/=10,je++);mt=(Ue=(tt%=O)-O+je)<0?0:at/or[je-Ue-1]%10|0}if(Ye=Ye||ye<0||Ht[et+1]!=null||(Ue<0?at:at%or[je-Ue-1]),Ye=Ee<4?(mt||Ye)&&(Ee==0||Ee==(se.s<0?3:2)):5<mt||mt==5&&(Ee==4||Ye||Ee==6&&(0<tt?0<Ue?at/or[je-Ue]:0:Ht[et-1])%10&1||Ee==(se.s<0?8:7)),ye<1||!Ht[0])return Ht.length=0,Ye?(ye-=se.e+1,Ht[0]=or[(O-ye%O)%O],se.e=-ye||0):Ht[0]=se.e=0,se;if(tt==0?(Ht.length=et,Ve=1,et--):(Ht.length=et+1,Ve=or[O-tt],Ht[et]=0<Ue?p(at/or[je-Ue]%or[Ue])*Ve:0),Ye)for(;;){if(et==0){for(tt=1,Ue=Ht[0];10<=Ue;Ue/=10,tt++);for(Ue=Ht[0]+=Ve,Ve=1;10<=Ue;Ue/=10,Ve++);tt!=Ve&&(se.e++,Ht[0]==E&&(Ht[0]=1));break}if(Ht[et]+=Ve,Ht[et]!=E)break;Ht[et--]=0,Ve=1}for(tt=Ht.length;Ht[--tt]===0;Ht.pop());}se.e>ft?se.c=se.e=null:se.e<ht&&(se.c=[se.e=0])}return se}function Cr(se){var ye,Ee=se.e;return Ee===null?se.toString():(ye=W(se.c),ye=Ee<=We||Je<=Ee?Ie(ye,Ee):He(ye,Ee,"0"),se.s<0?"-"+ye:ye)}return qe.clone=Le,qe.ROUND_UP=0,qe.ROUND_DOWN=1,qe.ROUND_CEIL=2,qe.ROUND_FLOOR=3,qe.ROUND_HALF_UP=4,qe.ROUND_HALF_DOWN=5,qe.ROUND_HALF_EVEN=6,qe.ROUND_HALF_CEIL=7,qe.ROUND_HALF_FLOOR=8,qe.EUCLID=9,qe.config=qe.set=function(se){var ye,Ee;if(se!=null){if(typeof se!="object")throw Error(y+"Object expected: "+se);if(se.hasOwnProperty(ye="DECIMAL_PLACES")&&(q(Ee=se[ye],0,j,ye),me=Ee),se.hasOwnProperty(ye="ROUNDING_MODE")&&(q(Ee=se[ye],0,8,ye),Oe=Ee),se.hasOwnProperty(ye="EXPONENTIAL_AT")&&((Ee=se[ye])&&Ee.pop?(q(Ee[0],-j,0,ye),q(Ee[1],0,j,ye),We=Ee[0],Je=Ee[1]):(q(Ee,-j,j,ye),We=-(Je=Ee<0?-Ee:Ee))),se.hasOwnProperty(ye="RANGE"))if((Ee=se[ye])&&Ee.pop)q(Ee[0],-j,-1,ye),q(Ee[1],1,j,ye),ht=Ee[0],ft=Ee[1];else{if(q(Ee,-j,j,ye),!Ee)throw Error(y+ye+" cannot be zero: "+Ee);ht=-(ft=Ee<0?-Ee:Ee)}if(se.hasOwnProperty(ye="CRYPTO")){if((Ee=se[ye])!==!!Ee)throw Error(y+ye+" not true or false: "+Ee);if(Ee){if(typeof crypto>"u"||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw St=!Ee,Error(y+"crypto unavailable");St=Ee}else St=Ee}if(se.hasOwnProperty(ye="MODULO_MODE")&&(q(Ee=se[ye],0,9,ye),Tt=Ee),se.hasOwnProperty(ye="POW_PRECISION")&&(q(Ee=se[ye],0,j,ye),Xt=Ee),se.hasOwnProperty(ye="FORMAT")){if(typeof(Ee=se[ye])!="object")throw Error(y+ye+" not an object: "+Ee);jt=Ee}if(se.hasOwnProperty(ye="ALPHABET")){if(typeof(Ee=se[ye])!="string"||/^.$|[+-.\s]|(.).*\1/.test(Ee))throw Error(y+ye+" invalid: "+Ee);Kt=Ee}}return{DECIMAL_PLACES:me,ROUNDING_MODE:Oe,EXPONENTIAL_AT:[We,Je],RANGE:[ht,ft],CRYPTO:St,MODULO_MODE:Tt,POW_PRECISION:Xt,FORMAT:jt,ALPHABET:Kt}},qe.isBigNumber=function(se){return se instanceof qe||se&&se._isBigNumber===!0||!1},qe.maximum=qe.max=function(){return Ar(arguments,K.lt)},qe.minimum=qe.min=function(){return Ar(arguments,K.gt)},qe.random=(de=9007199254740992,Ce=Math.random()*de&2097151?function(){return p(Math.random()*de)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(se){var ye,Ee,Ye,je,tt,Ue=0,Ve=[],at=new qe(re);if(se==null?se=me:q(se,0,j),je=h(se/O),St)if(crypto.getRandomValues){for(ye=crypto.getRandomValues(new Uint32Array(je*=2));Ue<je;)9e15<=(tt=131072*ye[Ue]+(ye[Ue+1]>>>11))?(Ee=crypto.getRandomValues(new Uint32Array(2)),ye[Ue]=Ee[0],ye[Ue+1]=Ee[1]):(Ve.push(tt%1e14),Ue+=2);Ue=je/2}else{if(!crypto.randomBytes)throw St=!1,Error(y+"crypto unavailable");for(ye=crypto.randomBytes(je*=7);Ue<je;)9e15<=(tt=281474976710656*(31&ye[Ue])+1099511627776*ye[Ue+1]+4294967296*ye[Ue+2]+16777216*ye[Ue+3]+(ye[Ue+4]<<16)+(ye[Ue+5]<<8)+ye[Ue+6])?crypto.randomBytes(7).copy(ye,Ue):(Ve.push(tt%1e14),Ue+=7);Ue=je/7}if(!St)for(;Ue<je;)(tt=Ce())<9e15&&(Ve[Ue++]=tt%1e14);for(je=Ve[--Ue],se%=O,je&&se&&(tt=$[O-se],Ve[Ue]=p(je/tt)*tt);Ve[Ue]===0;Ve.pop(),Ue--);if(Ue<0)Ve=[Ye=0];else{for(Ye=-1;Ve[0]===0;Ve.splice(0,1),Ye-=O);for(Ue=1,tt=Ve[0];10<=tt;tt/=10,Ue++);Ue<O&&(Ye-=O-Ue)}return at.e=Ye,at.c=Ve,at}),qe.sum=function(){for(var se=1,ye=arguments,Ee=new qe(ye[0]);se<ye.length;)Ee=Ee.plus(ye[se++]);return Ee},At=function(){var se="0123456789";function ye(Ee,Ye,je,tt){for(var Ue,Ve,at=[0],et=0,mt=Ee.length;et<mt;){for(Ve=at.length;Ve--;at[Ve]*=Ye);for(at[0]+=tt.indexOf(Ee.charAt(et++)),Ue=0;Ue<at.length;Ue++)at[Ue]>je-1&&(at[Ue+1]==null&&(at[Ue+1]=0),at[Ue+1]+=at[Ue]/je|0,at[Ue]%=je)}return at.reverse()}return function(Ee,Ye,je,tt,Ue){var Ve,at,et,mt,Ht,or,fr,Ir,Ur=Ee.indexOf("."),_n=me,$r=Oe;for(0<=Ur&&(mt=Xt,Xt=0,Ee=Ee.replace(".",""),or=(Ir=new qe(Ye)).pow(Ee.length-Ur),Xt=mt,Ir.c=ye(He(W(or.c),or.e,"0"),10,je,se),Ir.e=Ir.c.length),et=mt=(fr=ye(Ee,Ye,je,Ue?(Ve=Kt,se):(Ve=se,Kt))).length;fr[--mt]==0;fr.pop());if(!fr[0])return Ve.charAt(0);if(Ur<0?--et:(or.c=fr,or.e=et,or.s=tt,fr=(or=ct(or,Ir,_n,$r,je)).c,Ht=or.r,et=or.e),Ur=fr[at=et+_n+1],mt=je/2,Ht=Ht||at<0||fr[at+1]!=null,Ht=$r<4?(Ur!=null||Ht)&&($r==0||$r==(or.s<0?3:2)):mt<Ur||Ur==mt&&($r==4||Ht||$r==6&&1&fr[at-1]||$r==(or.s<0?8:7)),at<1||!fr[0])Ee=Ht?He(Ve.charAt(1),-_n,Ve.charAt(0)):Ve.charAt(0);else{if(fr.length=at,Ht)for(--je;++fr[--at]>je;)fr[at]=0,at||(++et,fr=[1].concat(fr));for(mt=fr.length;!fr[--mt];);for(Ur=0,Ee="";Ur<=mt;Ee+=Ve.charAt(fr[Ur++]));Ee=He(Ee,et,Ve.charAt(0))}return Ee}}(),ct=function(){function se(Ye,je,tt){var Ue,Ve,at,et,mt=0,Ht=Ye.length,or=je%B,fr=je/B|0;for(Ye=Ye.slice();Ht--;)mt=((Ve=or*(at=Ye[Ht]%B)+(Ue=fr*at+(et=Ye[Ht]/B|0)*or)%B*B+mt)/tt|0)+(Ue/B|0)+fr*et,Ye[Ht]=Ve%tt;return mt&&(Ye=[mt].concat(Ye)),Ye}function ye(Ye,je,tt,Ue){var Ve,at;if(tt!=Ue)at=Ue<tt?1:-1;else for(Ve=at=0;Ve<tt;Ve++)if(Ye[Ve]!=je[Ve]){at=Ye[Ve]>je[Ve]?1:-1;break}return at}function Ee(Ye,je,tt,Ue){for(var Ve=0;tt--;)Ye[tt]-=Ve,Ve=Ye[tt]<je[tt]?1:0,Ye[tt]=Ve*Ue+Ye[tt]-je[tt];for(;!Ye[0]&&1<Ye.length;Ye.splice(0,1));}return function(Ye,je,tt,Ue,Ve){var at,et,mt,Ht,or,fr,Ir,Ur,_n,$r,Mr,ln,an,Hr,Fr,rn,ri,En=Ye.s==je.s?1:-1,un=Ye.c,zr=je.c;if(!(un&&un[0]&&zr&&zr[0]))return new qe(Ye.s&&je.s&&(un?!zr||un[0]!=zr[0]:zr)?un&&un[0]==0||!zr?0*En:En/0:NaN);for(_n=(Ur=new qe(En)).c=[],En=tt+(et=Ye.e-je.e)+1,Ve||(Ve=E,et=z(Ye.e/O)-z(je.e/O),En=En/O|0),mt=0;zr[mt]==(un[mt]||0);mt++);if(zr[mt]>(un[mt]||0)&&et--,En<0)_n.push(1),Ht=!0;else{for(Hr=un.length,rn=zr.length,En+=2,1<(or=p(Ve/(zr[mt=0]+1)))&&(zr=se(zr,or,Ve),un=se(un,or,Ve),rn=zr.length,Hr=un.length),an=rn,Mr=($r=un.slice(0,rn)).length;Mr<rn;$r[Mr++]=0);ri=zr.slice(),ri=[0].concat(ri),Fr=zr[0],zr[1]>=Ve/2&&Fr++;do{if(or=0,(at=ye(zr,$r,rn,Mr))<0){if(ln=$r[0],rn!=Mr&&(ln=ln*Ve+($r[1]||0)),1<(or=p(ln/Fr)))for(Ve<=or&&(or=Ve-1),Ir=(fr=se(zr,or,Ve)).length,Mr=$r.length;ye(fr,$r,Ir,Mr)==1;)or--,Ee(fr,rn<Ir?ri:zr,Ir,Ve),Ir=fr.length,at=1;else or==0&&(at=or=1),Ir=(fr=zr.slice()).length;if(Ir<Mr&&(fr=[0].concat(fr)),Ee($r,fr,Mr,Ve),Mr=$r.length,at==-1)for(;ye(zr,$r,rn,Mr)<1;)or++,Ee($r,rn<Mr?ri:zr,Mr,Ve),Mr=$r.length}else at===0&&(or++,$r=[0]);_n[mt++]=or,$r[0]?$r[Mr++]=un[an]||0:($r=[un[an]],Mr=1)}while((an++<Hr||$r[0]!=null)&&En--);Ht=$r[0]!=null,_n[0]||_n.splice(0,1)}if(Ve==E){for(mt=1,En=_n[0];10<=En;En/=10,mt++);vr(Ur,tt+(Ur.e=mt+et*O-1)+1,Ue,Ht)}else Ur.e=et,Ur.r=+Ht;return Ur}}(),pt=/^(-?)0([xbo])(?=\w[\w.]*$)/i,Ct=/^([^.]+)\.$/,ie=/^\.([^.]+)$/,M=/^-?(Infinity|NaN)$/,U=/^\s*\+(?=[\w.])|^\s+|\s+$/g,Qe=function(se,ye,Ee,Ye){var je,tt=Ee?ye:ye.replace(U,"");if(M.test(tt))se.s=isNaN(tt)?null:tt<0?-1:1,se.c=se.e=null;else{if(!Ee&&(tt=tt.replace(pt,function(Ue,Ve,at){return je=(at=at.toLowerCase())=="x"?16:at=="b"?2:8,Ye&&Ye!=je?Ue:Ve}),Ye&&(je=Ye,tt=tt.replace(Ct,"$1").replace(ie,"0.$1")),ye!=tt))return new qe(tt,je);if(qe.DEBUG)throw Error(y+"Not a"+(Ye?" base "+Ye:"")+" number: "+ye);se.c=se.e=se.s=null}},K.absoluteValue=K.abs=function(){var se=new qe(this);return se.s<0&&(se.s=1),se},K.comparedTo=function(se,ye){return Q(this,new qe(se,ye))},K.decimalPlaces=K.dp=function(se,ye){var Ee,Ye,je;if(se!=null)return q(se,0,j),ye==null?ye=Oe:q(ye,0,8),vr(new qe(this),se+this.e+1,ye);if(!(Ee=this.c))return null;if(Ye=((je=Ee.length-1)-z(this.e/O))*O,je=Ee[je])for(;je%10==0;je/=10,Ye--);return Ye<0&&(Ye=0),Ye},K.dividedBy=K.div=function(se,ye){return ct(this,new qe(se,ye),me,Oe)},K.dividedToIntegerBy=K.idiv=function(se,ye){return ct(this,new qe(se,ye),0,1)},K.exponentiatedBy=K.pow=function(se,ye){var Ee,Ye,je,tt,Ue,Ve,at,et,mt=this;if((se=new qe(se)).c&&!se.isInteger())throw Error(y+"Exponent not an integer: "+Cr(se));if(ye!=null&&(ye=new qe(ye)),Ue=14<se.e,!mt.c||!mt.c[0]||mt.c[0]==1&&!mt.e&&mt.c.length==1||!se.c||!se.c[0])return et=new qe(Math.pow(+Cr(mt),Ue?2-Se(se):+Cr(se))),ye?et.mod(ye):et;if(Ve=se.s<0,ye){if(ye.c?!ye.c[0]:!ye.s)return new qe(NaN);(Ye=!Ve&&mt.isInteger()&&ye.isInteger())&&(mt=mt.mod(ye))}else{if(9<se.e&&(0<mt.e||mt.e<-1||(mt.e==0?1<mt.c[0]||Ue&&24e7<=mt.c[1]:mt.c[0]<8e13||Ue&&mt.c[0]<=9999975e7)))return tt=mt.s<0&&Se(se)?-0:0,-1<mt.e&&(tt=1/tt),new qe(Ve?1/tt:tt);Xt&&(tt=h(Xt/O+2))}for(at=Ue?(Ee=new qe(.5),Ve&&(se.s=1),Se(se)):(je=Math.abs(+Cr(se)))%2,et=new qe(re);;){if(at){if(!(et=et.times(mt)).c)break;tt?et.c.length>tt&&(et.c.length=tt):Ye&&(et=et.mod(ye))}if(je){if((je=p(je/2))===0)break;at=je%2}else if(vr(se=se.times(Ee),se.e+1,1),14<se.e)at=Se(se);else{if((je=+Cr(se))==0)break;at=je%2}mt=mt.times(mt),tt?mt.c&&mt.c.length>tt&&(mt.c.length=tt):Ye&&(mt=mt.mod(ye))}return Ye?et:(Ve&&(et=re.div(et)),ye?et.mod(ye):tt?vr(et,Xt,Oe,void 0):et)},K.integerValue=function(se){var ye=new qe(this);return se==null?se=Oe:q(se,0,8),vr(ye,ye.e+1,se)},K.isEqualTo=K.eq=function(se,ye){return Q(this,new qe(se,ye))===0},K.isFinite=function(){return!!this.c},K.isGreaterThan=K.gt=function(se,ye){return 0<Q(this,new qe(se,ye))},K.isGreaterThanOrEqualTo=K.gte=function(se,ye){return(ye=Q(this,new qe(se,ye)))===1||ye===0},K.isInteger=function(){return!!this.c&&z(this.e/O)>this.c.length-2},K.isLessThan=K.lt=function(se,ye){return Q(this,new qe(se,ye))<0},K.isLessThanOrEqualTo=K.lte=function(se,ye){return(ye=Q(this,new qe(se,ye)))===-1||ye===0},K.isNaN=function(){return!this.s},K.isNegative=function(){return this.s<0},K.isPositive=function(){return 0<this.s},K.isZero=function(){return!!this.c&&this.c[0]==0},K.minus=function(se,ye){var Ee,Ye,je,tt,Ue=this,Ve=Ue.s;if(ye=(se=new qe(se,ye)).s,!Ve||!ye)return new qe(NaN);if(Ve!=ye)return se.s=-ye,Ue.plus(se);var at=Ue.e/O,et=se.e/O,mt=Ue.c,Ht=se.c;if(!at||!et){if(!mt||!Ht)return mt?(se.s=-ye,se):new qe(Ht?Ue:NaN);if(!mt[0]||!Ht[0])return Ht[0]?(se.s=-ye,se):new qe(mt[0]?Ue:Oe==3?-0:0)}if(at=z(at),et=z(et),mt=mt.slice(),Ve=at-et){for((je=(tt=Ve<0)?(Ve=-Ve,mt):(et=at,Ht)).reverse(),ye=Ve;ye--;je.push(0));je.reverse()}else for(Ye=(tt=(Ve=mt.length)<(ye=Ht.length))?Ve:ye,Ve=ye=0;ye<Ye;ye++)if(mt[ye]!=Ht[ye]){tt=mt[ye]<Ht[ye];break}if(tt&&(je=mt,mt=Ht,Ht=je,se.s=-se.s),0<(ye=(Ye=Ht.length)-(Ee=mt.length)))for(;ye--;mt[Ee++]=0);for(ye=E-1;Ve<Ye;){if(mt[--Ye]<Ht[Ye]){for(Ee=Ye;Ee&&!mt[--Ee];mt[Ee]=ye);--mt[Ee],mt[Ye]+=E}mt[Ye]-=Ht[Ye]}for(;mt[0]==0;mt.splice(0,1),--et);return mt[0]?wr(se,mt,et):(se.s=Oe==3?-1:1,se.c=[se.e=0],se)},K.modulo=K.mod=function(se,ye){var Ee,Ye,je=this;return se=new qe(se,ye),!je.c||!se.s||se.c&&!se.c[0]?new qe(NaN):!se.c||je.c&&!je.c[0]?new qe(je):(Tt==9?(Ye=se.s,se.s=1,Ee=ct(je,se,0,3),se.s=Ye,Ee.s*=Ye):Ee=ct(je,se,0,Tt),(se=je.minus(Ee.times(se))).c[0]||Tt!=1||(se.s=je.s),se)},K.multipliedBy=K.times=function(se,ye){var Ee,Ye,je,tt,Ue,Ve,at,et,mt,Ht,or,fr,Ir,Ur,_n,$r=this,Mr=$r.c,ln=(se=new qe(se,ye)).c;if(!(Mr&&ln&&Mr[0]&&ln[0]))return!$r.s||!se.s||Mr&&!Mr[0]&&!ln||ln&&!ln[0]&&!Mr?se.c=se.e=se.s=null:(se.s*=$r.s,Mr&&ln?(se.c=[0],se.e=0):se.c=se.e=null),se;for(Ye=z($r.e/O)+z(se.e/O),se.s*=$r.s,(at=Mr.length)<(Ht=ln.length)&&(Ir=Mr,Mr=ln,ln=Ir,je=at,at=Ht,Ht=je),je=at+Ht,Ir=[];je--;Ir.push(0));for(Ur=E,_n=B,je=Ht;0<=--je;){for(Ee=0,or=ln[je]%_n,fr=ln[je]/_n|0,tt=je+(Ue=at);je<tt;)Ee=((et=or*(et=Mr[--Ue]%_n)+(Ve=fr*et+(mt=Mr[Ue]/_n|0)*or)%_n*_n+Ir[tt]+Ee)/Ur|0)+(Ve/_n|0)+fr*mt,Ir[tt--]=et%Ur;Ir[tt]=Ee}return Ee?++Ye:Ir.splice(0,1),wr(se,Ir,Ye)},K.negated=function(){var se=new qe(this);return se.s=-se.s||null,se},K.plus=function(se,ye){var Ee,Ye=this,je=Ye.s;if(ye=(se=new qe(se,ye)).s,!je||!ye)return new qe(NaN);if(je!=ye)return se.s=-ye,Ye.minus(se);var tt=Ye.e/O,Ue=se.e/O,Ve=Ye.c,at=se.c;if(!tt||!Ue){if(!Ve||!at)return new qe(je/0);if(!Ve[0]||!at[0])return at[0]?se:new qe(Ve[0]?Ye:0*je)}if(tt=z(tt),Ue=z(Ue),Ve=Ve.slice(),je=tt-Ue){for((Ee=0<je?(Ue=tt,at):(je=-je,Ve)).reverse();je--;Ee.push(0));Ee.reverse()}for((je=Ve.length)-(ye=at.length)<0&&(Ee=at,at=Ve,Ve=Ee,ye=je),je=0;ye;)je=(Ve[--ye]=Ve[ye]+at[ye]+je)/E|0,Ve[ye]=E===Ve[ye]?0:Ve[ye]%E;return je&&(Ve=[je].concat(Ve),++Ue),wr(se,Ve,Ue)},K.precision=K.sd=function(se,ye){var Ee,Ye,je;if(se!=null&&se!==!!se)return q(se,1,j),ye==null?ye=Oe:q(ye,0,8),vr(new qe(this),se,ye);if(!(Ee=this.c))return null;if(Ye=(je=Ee.length-1)*O+1,je=Ee[je]){for(;je%10==0;je/=10,Ye--);for(je=Ee[0];10<=je;je/=10,Ye++);}return se&&this.e+1>Ye&&(Ye=this.e+1),Ye},K.shiftedBy=function(se){return q(se,-A,A),this.times("1e"+se)},K.squareRoot=K.sqrt=function(){var se,ye,Ee,Ye,je,tt=this,Ue=tt.c,Ve=tt.s,at=tt.e,et=me+4,mt=new qe("0.5");if(Ve!==1||!Ue||!Ue[0])return new qe(!Ve||Ve<0&&(!Ue||Ue[0])?NaN:Ue?tt:1/0);if((Ee=(Ve=Math.sqrt(+Cr(tt)))==0||Ve==1/0?(((ye=W(Ue)).length+at)%2==0&&(ye+="0"),Ve=Math.sqrt(+ye),at=z((at+1)/2)-(at<0||at%2),new qe(ye=Ve==1/0?"1e"+at:(ye=Ve.toExponential()).slice(0,ye.indexOf("e")+1)+at)):new qe(Ve+"")).c[0]){for((Ve=(at=Ee.e)+et)<3&&(Ve=0);;)if(je=Ee,Ee=mt.times(je.plus(ct(tt,je,et,1))),W(je.c).slice(0,Ve)===(ye=W(Ee.c)).slice(0,Ve)){if(Ee.e<at&&--Ve,(ye=ye.slice(Ve-3,Ve+1))!="9999"&&(Ye||ye!="4999")){+ye&&(+ye.slice(1)||ye.charAt(0)!="5")||(vr(Ee,Ee.e+me+2,1),se=!Ee.times(Ee).eq(tt));break}if(!Ye&&(vr(je,je.e+me+2,0),je.times(je).eq(tt))){Ee=je;break}et+=4,Ve+=4,Ye=1}}return vr(Ee,Ee.e+me+1,Oe,se)},K.toExponential=function(se,ye){return se!=null&&(q(se,0,j),se++),yr(this,se,ye,1)},K.toFixed=function(se,ye){return se!=null&&(q(se,0,j),se=se+this.e+1),yr(this,se,ye)},K.toFormat=function(se,ye,Ee){var Ye;if(Ee==null)se!=null&&ye&&typeof ye=="object"?(Ee=ye,ye=null):se&&typeof se=="object"?(Ee=se,se=ye=null):Ee=jt;else if(typeof Ee!="object")throw Error(y+"Argument not an object: "+Ee);if(Ye=this.toFixed(se,ye),this.c){var je,tt=Ye.split("."),Ue=+Ee.groupSize,Ve=+Ee.secondaryGroupSize,at=Ee.groupSeparator||"",et=tt[0],mt=tt[1],Ht=this.s<0,or=Ht?et.slice(1):et,fr=or.length;if(Ve&&(je=Ue,Ue=Ve,fr-=Ve=je),0<Ue&&0<fr){for(je=fr%Ue||Ue,et=or.substr(0,je);je<fr;je+=Ue)et+=at+or.substr(je,Ue);0<Ve&&(et+=at+or.slice(je)),Ht&&(et="-"+et)}Ye=mt?et+(Ee.decimalSeparator||"")+((Ve=+Ee.fractionGroupSize)?mt.replace(new RegExp("\\d{"+Ve+"}\\B","g"),"$&"+(Ee.fractionGroupSeparator||"")):mt):et}return(Ee.prefix||"")+Ye+(Ee.suffix||"")},K.toFraction=function(se){var ye,Ee,Ye,je,tt,Ue,Ve,at,et,mt,Ht,or,fr=this,Ir=fr.c;if(se!=null&&(!(Ve=new qe(se)).isInteger()&&(Ve.c||Ve.s!==1)||Ve.lt(re)))throw Error(y+"Argument "+(Ve.isInteger()?"out of range: ":"not an integer: ")+Cr(Ve));if(!Ir)return new qe(fr);for(ye=new qe(re),et=Ee=new qe(re),Ye=at=new qe(re),or=W(Ir),tt=ye.e=or.length-fr.e-1,ye.c[0]=$[(Ue=tt%O)<0?O+Ue:Ue],se=!se||0<Ve.comparedTo(ye)?0<tt?ye:et:Ve,Ue=ft,ft=1/0,Ve=new qe(or),at.c[0]=0;mt=ct(Ve,ye,0,1),(je=Ee.plus(mt.times(Ye))).comparedTo(se)!=1;)Ee=Ye,Ye=je,et=at.plus(mt.times(je=et)),at=je,ye=Ve.minus(mt.times(je=ye)),Ve=je;return je=ct(se.minus(Ee),Ye,0,1),at=at.plus(je.times(et)),Ee=Ee.plus(je.times(Ye)),at.s=et.s=fr.s,Ht=ct(et,Ye,tt*=2,Oe).minus(fr).abs().comparedTo(ct(at,Ee,tt,Oe).minus(fr).abs())<1?[et,Ye]:[at,Ee],ft=Ue,Ht},K.toNumber=function(){return+Cr(this)},K.toPrecision=function(se,ye){return se!=null&&q(se,1,j),yr(this,se,ye,2)},K.toString=function(se){var ye,Ee=this,Ye=Ee.s,je=Ee.e;return je===null?Ye?(ye="Infinity",Ye<0&&(ye="-"+ye)):ye="NaN":(ye=se==null?je<=We||Je<=je?Ie(W(Ee.c),je):He(W(Ee.c),je,"0"):se===10?He(W((Ee=vr(new qe(Ee),me+je+1,Oe)).c),Ee.e,"0"):(q(se,2,Kt.length,"Base"),At(He(W(Ee.c),je,"0"),10,se,Ye,!0)),Ye<0&&Ee.c[0]&&(ye="-"+ye)),ye},K.valueOf=K.toJSON=function(){return Cr(this)},K._isBigNumber=!0,typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"&&(K[Symbol.toStringTag]="BigNumber",K[Symbol.for("nodejs.util.inspect.custom")]=K.valueOf),ze!=null&&qe.set(ze),qe}()).default=s.BigNumber=s,n!==void 0&&n.exports?n.exports=s:(o||(o=typeof self<"u"&&self?self:window),o.BigNumber=s)})(this)},{}],2:[function(r,n,i){n.exports={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(o){var s=o%10;return~~(o%100/10)==1?"th":s===1?"st":s===2?"nd":s===3?"rd":"th"},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}},{}],3:[function(r,n,i){function o(z,W){return function(Q){if(Array.isArray(Q))return Q}(z)||function(Q,q){var Se=[],Ie=!0,He=!1,Le=void 0;try{for(var ze,ct=Q[Symbol.iterator]();!(Ie=(ze=ct.next()).done)&&(Se.push(ze.value),!q||Se.length!==q);Ie=!0);}catch(At){He=!0,Le=At}finally{try{Ie||ct.return==null||ct.return()}finally{if(He)throw Le}}return Se}(z,W)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var s=r("./globalState"),a=r("./validating"),h=r("./parsing"),p=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],y={general:{scale:1024,suffixes:p,marker:"bd"},binary:{scale:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],marker:"b"},decimal:{scale:1e3,suffixes:p,marker:"d"}},S={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1};function E(z){var W=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{},Q=2<arguments.length?arguments[2]:void 0;if(typeof W=="string"&&(W=h.parseFormat(W)),!a.validateFormat(W))return"ERROR: invalid format";var q=W.prefix||"",Se=W.postfix||"",Ie=function(He,Le,ze){switch(Le.output){case"currency":return Le=j(Le,s.currentCurrencyDefaultFormat()),function(Kt,qe,yr){var Ar=yr.currentCurrency(),wr=Object.assign({},S,qe),vr=void 0,Cr="",se=!!wr.totalLength||!!wr.forceAverage||wr.average,ye=qe.currencyPosition||Ar.position,Ee=qe.currencySymbol||Ar.symbol;wr.spaceSeparated&&(Cr=" "),ye==="infix"&&(vr=Cr+Ee+Cr);var Ye=B({instance:Kt,providedFormat:qe,state:yr,decimalSeparator:vr});return ye==="prefix"&&(Ye=Kt._value<0&&wr.negative==="sign"?"-".concat(Cr).concat(Ee).concat(Ye.slice(1)):Ee+Cr+Ye),ye&&ye!=="postfix"||(Ye=Ye+(Cr=se?"":Cr)+Ee),Ye}(He,Le,s);case"percent":return Le=j(Le,s.currentPercentageDefaultFormat()),function(Kt,qe,yr,Ar){var wr=qe.prefixSymbol,vr=B({instance:Ar(100*Kt._value),providedFormat:qe,state:yr}),Cr=Object.assign({},S,qe);return wr?"%".concat(Cr.spaceSeparated?" ":"").concat(vr):"".concat(vr).concat(Cr.spaceSeparated?" ":"","%")}(He,Le,s,ze);case"byte":return Le=j(Le,s.currentByteDefaultFormat()),re=He,Oe=s,We=ze,Je=(me=Le).base||"binary",ht=y[Je],ft=O(re._value,ht.suffixes,ht.scale),St=ft.value,Tt=ft.suffix,Xt=B({instance:We(St),providedFormat:me,state:Oe,defaults:Oe.currentByteDefaultFormat()}),jt=Oe.currentAbbreviations(),"".concat(Xt).concat(jt.spaced?" ":"").concat(Tt);case"time":return Le=j(Le,s.currentTimeDefaultFormat()),ie=He,M=Math.floor(ie._value/60/60),U=Math.floor((ie._value-60*M*60)/60),K=Math.round(ie._value-60*M*60-60*U),"".concat(M,":").concat(U<10?"0":"").concat(U,":").concat(K<10?"0":"").concat(K);case"ordinal":return Le=j(Le,s.currentOrdinalDefaultFormat()),ct=He,At=Le,de=(Qe=s).currentOrdinal(),Ce=Object.assign({},S,At),pt=B({instance:ct,providedFormat:At,state:Qe}),Ct=de(ct._value),"".concat(pt).concat(Ce.spaceSeparated?" ":"").concat(Ct);case"number":default:return B({instance:He,providedFormat:Le,numbro:ze})}var ct,At,Qe,de,Ce,pt,Ct,ie,M,U,K,re,me,Oe,We,Je,ht,ft,St,Tt,Xt,jt}(z,W,Q);return Ie=(Ie=q+Ie)+Se}function O(z,W,Q){var q=W[0],Se=Math.abs(z);if(Q<=Se){for(var Ie=1;Ie<W.length;++Ie){var He=Math.pow(Q,Ie),Le=Math.pow(Q,Ie+1);if(He<=Se&&Se<Le){q=W[Ie],z/=He;break}}q===W[0]&&(z/=Math.pow(Q,W.length-1),q=W[W.length-1])}return{value:z,suffix:q}}function A(z){for(var W="",Q=0;Q<z;Q++)W+="0";return W}function $(z,W){return z.toString().indexOf("e")!==-1?function(Q,q){var Se=Q.toString(),Ie=o(Se.split("e"),2),He=Ie[0],Le=Ie[1],ze=o(He.split("."),2),ct=ze[0],At=ze[1],Qe=At===void 0?"":At;if(0<+Le)Se=ct+Qe+A(Le-Qe.length);else{var de=".";de=+ct<0?"-0".concat(de):"0".concat(de);var Ce=(A(-Le-1)+Math.abs(ct)+Qe).substr(0,q);Ce.length<q&&(Ce+=A(q-Ce.length)),Se=de+Ce}return 0<+Le&&0<q&&(Se+=".".concat(A(q))),Se}(z,W):(Math.round(+"".concat(z,"e+").concat(W))/Math.pow(10,W)).toFixed(W)}function B(z){var W=z.instance,Q=z.providedFormat,q=z.state,Se=q===void 0?s:q,Ie=z.decimalSeparator,He=z.defaults,Le=He===void 0?Se.currentDefaults():He,ze=W._value;if(ze===0&&Se.hasZeroFormat())return Se.getZeroFormat();if(!isFinite(ze))return ze.toString();var ct,At,Qe,de,Ce,pt,Ct,ie,M=Object.assign({},S,Le,Q),U=M.totalLength,K=U?0:M.characteristic,re=M.optionalCharacteristic,me=M.forceAverage,Oe=!!U||!!me||M.average,We=U?-1:Oe&&Q.mantissa===void 0?0:M.mantissa,Je=!U&&(Q.optionalMantissa===void 0?We===-1:M.optionalMantissa),ht=M.trimMantissa,ft=M.thousandSeparated,St=M.spaceSeparated,Tt=M.negative,Xt=M.forceSign,jt=M.exponential,Kt="";if(Oe){var qe=function(se){var ye=se.value,Ee=se.forceAverage,Ye=se.abbreviations,je=se.spaceSeparated,tt=je!==void 0&&je,Ue=se.totalLength,Ve=Ue===void 0?0:Ue,at="",et=Math.abs(ye),mt=-1;if(et>=Math.pow(10,12)&&!Ee||Ee==="trillion"?(at=Ye.trillion,ye/=Math.pow(10,12)):et<Math.pow(10,12)&&et>=Math.pow(10,9)&&!Ee||Ee==="billion"?(at=Ye.billion,ye/=Math.pow(10,9)):et<Math.pow(10,9)&&et>=Math.pow(10,6)&&!Ee||Ee==="million"?(at=Ye.million,ye/=Math.pow(10,6)):(et<Math.pow(10,6)&&et>=Math.pow(10,3)&&!Ee||Ee==="thousand")&&(at=Ye.thousand,ye/=Math.pow(10,3)),at&&(at=(tt?" ":"")+at),Ve){var Ht=ye.toString().split(".")[0];mt=Math.max(Ve-Ht.length,0)}return{value:ye,abbreviation:at,mantissaPrecision:mt}}({value:ze,forceAverage:me,abbreviations:Se.currentAbbreviations(),spaceSeparated:St,totalLength:U});ze=qe.value,Kt+=qe.abbreviation,U&&(We=qe.mantissaPrecision)}if(jt){var yr=(At=(ct={value:ze,characteristicPrecision:K}).value,Qe=ct.characteristicPrecision,de=Qe===void 0?0:Qe,Ce=o(At.toExponential().split("e"),2),pt=Ce[0],Ct=Ce[1],ie=+pt,de&&1<de&&(ie*=Math.pow(10,de-1),Ct=0<=(Ct=+Ct-(de-1))?"+".concat(Ct):Ct),{value:ie,abbreviation:"e".concat(Ct)});ze=yr.value,Kt=yr.abbreviation+Kt}var Ar,wr,vr,Cr=function(se,ye,Ee,Ye,je){if(Ye===-1)return se;var tt=$(ye,Ye),Ue=o(tt.toString().split("."),2),Ve=Ue[0],at=Ue[1],et=at===void 0?"":at;if(et.match(/^0+$/)&&(Ee||je))return Ve;var mt=et.match(/0+$/);return je&&mt?"".concat(Ve,".").concat(et.toString().slice(0,mt.index)):tt.toString()}(ze.toString(),ze,Je,We,ht);return Cr=function(se,ye,Ee,Ye,je){var tt=Ye.currentDelimiters(),Ue=tt.thousands;je=je||tt.decimal;var Ve=tt.thousandsSize||3,at=se.toString(),et=at.split(".")[0],mt=at.split(".")[1];return Ee&&(ye<0&&(et=et.slice(1)),function(Ht,or){for(var fr=[],Ir=0,Ur=Ht;0<Ur;Ur--)Ir===or&&(fr.unshift(Ur),Ir=0),Ir++;return fr}(et.length,Ve).forEach(function(Ht,or){et=et.slice(0,Ht+or)+Ue+et.slice(Ht+or)}),ye<0&&(et="-".concat(et))),at=mt?et+je+mt:et}(Cr=function(se,ye,Ee,Ye){var je=se,tt=o(je.toString().split("."),2),Ue=tt[0],Ve=tt[1];if(Ue.match(/^-?0$/)&&Ee)return Ve?"".concat(Ue.replace("0",""),".").concat(Ve):Ue.replace("0","");if(Ue.length<Ye)for(var at=Ye-Ue.length,et=0;et<at;et++)je="0".concat(je);return je.toString()}(Cr,0,re,K),ze,ft,Se,Ie),(Oe||jt)&&(Cr=Cr+Kt),(Xt||ze<0)&&(Ar=Cr,vr=Tt,Cr=(wr=ze)===0?Ar:+Ar==0?Ar.replace("-",""):0<wr?"+".concat(Ar):vr==="sign"?Ar:"(".concat(Ar.replace("-",""),")")),Cr}function j(z,W){if(!z)return W;var Q=Object.keys(z);return Q.length===1&&Q[0]==="output"?W:z}n.exports=function(z){return{format:function(){for(var W=arguments.length,Q=new Array(W),q=0;q<W;q++)Q[q]=arguments[q];return E.apply(void 0,Q.concat([z]))},getByteUnit:function(){for(var W=arguments.length,Q=new Array(W),q=0;q<W;q++)Q[q]=arguments[q];return function(Se){var Ie=y.general;return O(Se._value,Ie.suffixes,Ie.scale).suffix}.apply(void 0,Q.concat([z]))},getBinaryByteUnit:function(){for(var W=arguments.length,Q=new Array(W),q=0;q<W;q++)Q[q]=arguments[q];return function(Se){var Ie=y.binary;return O(Se._value,Ie.suffixes,Ie.scale).suffix}.apply(void 0,Q.concat([z]))},getDecimalByteUnit:function(){for(var W=arguments.length,Q=new Array(W),q=0;q<W;q++)Q[q]=arguments[q];return function(Se){var Ie=y.decimal;return O(Se._value,Ie.suffixes,Ie.scale).suffix}.apply(void 0,Q.concat([z]))},formatOrDefault:j}}},{"./globalState":4,"./parsing":8,"./validating":10}],4:[function(r,n,i){var o=r("./en-US"),s=r("./validating"),a=r("./parsing"),h={},p=void 0,y={},S=null,E={};function O($){p=$}function A(){return y[p]}h.languages=function(){return Object.assign({},y)},h.currentLanguage=function(){return p},h.currentCurrency=function(){return A().currency},h.currentAbbreviations=function(){return A().abbreviations},h.currentDelimiters=function(){return A().delimiters},h.currentOrdinal=function(){return A().ordinal},h.currentDefaults=function(){return Object.assign({},A().defaults,E)},h.currentOrdinalDefaultFormat=function(){return Object.assign({},h.currentDefaults(),A().ordinalFormat)},h.currentByteDefaultFormat=function(){return Object.assign({},h.currentDefaults(),A().byteFormat)},h.currentPercentageDefaultFormat=function(){return Object.assign({},h.currentDefaults(),A().percentageFormat)},h.currentCurrencyDefaultFormat=function(){return Object.assign({},h.currentDefaults(),A().currencyFormat)},h.currentTimeDefaultFormat=function(){return Object.assign({},h.currentDefaults(),A().timeFormat)},h.setDefaults=function($){$=a.parseFormat($),s.validateFormat($)&&(E=$)},h.getZeroFormat=function(){return S},h.setZeroFormat=function($){return S=typeof $=="string"?$:null},h.hasZeroFormat=function(){return S!==null},h.languageData=function($){if($){if(y[$])return y[$];throw new Error('Unknown tag "'.concat($,'"'))}return A()},h.registerLanguage=function($){var B=1<arguments.length&&arguments[1]!==void 0&&arguments[1];if(!s.validateLanguage($))throw new Error("Invalid language data");y[$.languageTag]=$,B&&O($.languageTag)},h.setLanguage=function($){var B=1<arguments.length&&arguments[1]!==void 0?arguments[1]:o.languageTag;if(!y[$]){var j=$.split("-")[0],z=Object.keys(y).find(function(W){return W.split("-")[0]===j});return y[z]?void O(z):void O(B)}O($)},h.registerLanguage(o),p=o.languageTag,n.exports=h},{"./en-US":2,"./parsing":8,"./validating":10}],5:[function(r,n,i){n.exports=function(o){return{loadLanguagesInNode:function(s){return a=o,void s.forEach(function(h){var p=void 0;try{p=r("../languages/".concat(h))}catch{console.error('Unable to load "'.concat(h,'". No matching language file found.'))}p&&a.registerLanguage(p)});var a}}}},{}],6:[function(r,n,i){var o=r("bignumber.js");function s(a,h,p){var y=new o(a._value),S=h;return p.isNumbro(h)&&(S=h._value),S=new o(S),a._value=y.minus(S).toNumber(),a}n.exports=function(a){return{add:function(h,p){return S=p,E=a,O=new o((y=h)._value),A=S,E.isNumbro(S)&&(A=S._value),A=new o(A),y._value=O.plus(A).toNumber(),y;var y,S,E,O,A},subtract:function(h,p){return s(h,p,a)},multiply:function(h,p){return S=p,E=a,O=new o((y=h)._value),A=S,E.isNumbro(S)&&(A=S._value),A=new o(A),y._value=O.times(A).toNumber(),y;var y,S,E,O,A},divide:function(h,p){return S=p,E=a,O=new o((y=h)._value),A=S,E.isNumbro(S)&&(A=S._value),A=new o(A),y._value=O.dividedBy(A).toNumber(),y;var y,S,E,O,A},set:function(h,p){return y=h,E=S=p,a.isNumbro(S)&&(E=S._value),y._value=E,y;var y,S,E},difference:function(h,p){return y=p,s(E=(S=a)(h._value),y,S),Math.abs(E._value);var y,S,E}}}},{"bignumber.js":1}],7:[function(r,n,i){function o(B,j){for(var z=0;z<j.length;z++){var W=j[z];W.enumerable=W.enumerable||!1,W.configurable=!0,"value"in W&&(W.writable=!0),Object.defineProperty(B,W.key,W)}}var s=r("./globalState"),a=r("./validating"),h=r("./loading")($),p=r("./unformatting"),y=r("./formatting")($),S=r("./manipulating")($),E=r("./parsing"),O=function(){function B(W){(function(Q,q){if(!(Q instanceof q))throw new TypeError("Cannot call a class as a function")})(this,B),this._value=W}var j,z;return j=B,(z=[{key:"clone",value:function(){return $(this._value)}},{key:"format",value:function(){var W=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return y.format(this,W)}},{key:"formatCurrency",value:function(W){return typeof W=="string"&&(W=E.parseFormat(W)),(W=y.formatOrDefault(W,s.currentCurrencyDefaultFormat())).output="currency",y.format(this,W)}},{key:"formatTime",value:function(){var W=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return W.output="time",y.format(this,W)}},{key:"binaryByteUnits",value:function(){return y.getBinaryByteUnit(this)}},{key:"decimalByteUnits",value:function(){return y.getDecimalByteUnit(this)}},{key:"byteUnits",value:function(){return y.getByteUnit(this)}},{key:"difference",value:function(W){return S.difference(this,W)}},{key:"add",value:function(W){return S.add(this,W)}},{key:"subtract",value:function(W){return S.subtract(this,W)}},{key:"multiply",value:function(W){return S.multiply(this,W)}},{key:"divide",value:function(W){return S.divide(this,W)}},{key:"set",value:function(W){return S.set(this,A(W))}},{key:"value",value:function(){return this._value}},{key:"valueOf",value:function(){return this._value}}])&&o(j.prototype,z),B}();function A(B){var j=B;return $.isNumbro(B)?j=B._value:typeof B=="string"?j=$.unformat(B):isNaN(B)&&(j=NaN),j}function $(B){return new O(A(B))}$.version="2.1.2",$.isNumbro=function(B){return B instanceof O},$.language=s.currentLanguage,$.registerLanguage=s.registerLanguage,$.setLanguage=s.setLanguage,$.languages=s.languages,$.languageData=s.languageData,$.zeroFormat=s.setZeroFormat,$.defaultFormat=s.currentDefaults,$.setDefaults=s.setDefaults,$.defaultCurrencyFormat=s.currentCurrencyDefaultFormat,$.validate=a.validate,$.loadLanguagesInNode=h.loadLanguagesInNode,$.unformat=p.unformat,n.exports=$},{"./formatting":3,"./globalState":4,"./loading":5,"./manipulating":6,"./parsing":8,"./unformatting":9,"./validating":10}],8:[function(r,n,i){n.exports={parseFormat:function(o){var s,a,h,p,y,S,E,O,A,$,B,j,z,W,Q,q,Se,Ie,He,Le,ze=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{};return typeof o!="string"?o:(a=ze,o=(h=(s=o).match(/^{([^}]*)}/))?(a.prefix=h[1],s.slice(h[0].length)):s,y=ze,function(ct,At){if(ct.indexOf("$")===-1){if(ct.indexOf("%")===-1)return ct.indexOf("bd")!==-1?(At.output="byte",At.base="general"):ct.indexOf("b")!==-1?(At.output="byte",At.base="binary"):ct.indexOf("d")!==-1?(At.output="byte",At.base="decimal"):ct.indexOf(":")===-1?ct.indexOf("o")!==-1&&(At.output="ordinal"):At.output="time";At.output="percent"}else At.output="currency"}(o=(S=(p=o).match(/{([^}]*)}$/))?(y.postfix=S[1],p.slice(0,-S[0].length)):p,ze),E=ze,(O=o.match(/[1-9]+[0-9]*/))&&(E.totalLength=+O[0]),A=ze,($=o.split(".")[0].match(/0+/))&&(A.characteristic=$[0].length),function(ct,At){if(ct.indexOf(".")!==-1){var Qe=ct.split(".")[0];At.optionalCharacteristic=Qe.indexOf("0")===-1}}(o,ze),B=ze,o.indexOf("a")!==-1&&(B.average=!0),z=ze,(j=o).indexOf("K")!==-1?z.forceAverage="thousand":j.indexOf("M")!==-1?z.forceAverage="million":j.indexOf("B")!==-1?z.forceAverage="billion":j.indexOf("T")!==-1&&(z.forceAverage="trillion"),function(ct,At){var Qe=ct.split(".")[1];if(Qe){var de=Qe.match(/0+/);de&&(At.mantissa=de[0].length)}}(o,ze),Q=ze,(W=o).match(/\[\.]/)?Q.optionalMantissa=!0:W.match(/\./)&&(Q.optionalMantissa=!1),q=ze,o.indexOf(",")!==-1&&(q.thousandSeparated=!0),Se=ze,o.indexOf(" ")!==-1&&(Se.spaceSeparated=!0),He=ze,(Ie=o).match(/^\+?\([^)]*\)$/)&&(He.negative="parenthesis"),Ie.match(/^\+?-/)&&(He.negative="sign"),Le=ze,o.match(/^\+/)&&(Le.forceSign=!0),ze)}}},{}],9:[function(r,n,i){var o=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function s(h){return h.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function a(h,p){var y=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",S=3<arguments.length?arguments[3]:void 0,E=4<arguments.length?arguments[4]:void 0,O=5<arguments.length?arguments[5]:void 0,A=6<arguments.length?arguments[6]:void 0;if(h!=="")return h===E?0:function $(B,j){var z=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",W=3<arguments.length?arguments[3]:void 0,Q=4<arguments.length?arguments[4]:void 0,q=5<arguments.length?arguments[5]:void 0,Se=6<arguments.length?arguments[6]:void 0;if(!isNaN(+B))return+B;var Ie="",He=B.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(He!==B)return-1*$(He,j,z,W,Q,q,Se);for(var Le=0;Le<o.length;Le++){var ze=o[Le];if((Ie=B.replace(ze.key,""))!==B)return $(Ie,j,z,W,Q,q,Se)*ze.factor}if((Ie=B.replace("%",""))!==B)return $(Ie,j,z,W,Q,q,Se)/100;var ct=parseFloat(B);if(!isNaN(ct)){var At=W(ct);if(At&&At!=="."&&(Ie=B.replace(new RegExp("".concat(s(At),"$")),""))!==B)return $(Ie,j,z,W,Q,q,Se);var Qe={};Object.keys(q).forEach(function(U){Qe[q[U]]=U});for(var de=Object.keys(Qe).sort().reverse(),Ce=de.length,pt=0;pt<Ce;pt++){var Ct=de[pt],ie=Qe[Ct];if((Ie=B.replace(Ct,""))!==B){var M=void 0;switch(ie){case"thousand":M=Math.pow(10,3);break;case"million":M=Math.pow(10,6);break;case"billion":M=Math.pow(10,9);break;case"trillion":M=Math.pow(10,12)}return $(Ie,j,z,W,Q,q,Se)*M}}}}(function($,B){var j=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",z=$.replace(j,"");return z=(z=z.replace(new RegExp("([0-9])".concat(s(B.thousands),"([0-9])"),"g"),"$1$2")).replace(B.decimal,".")}(h,p,y),p,y,S,E,O,A)}n.exports={unformat:function(h,p){var y,S,E,O=r("./globalState"),A=O.currentDelimiters(),$=O.currentCurrency().symbol,B=O.currentOrdinal(),j=O.getZeroFormat(),z=O.currentAbbreviations(),W=void 0;if(typeof h=="string")W=function(Q,q){if(!Q.indexOf(":")||q.thousands===":")return!1;var Se=Q.split(":");if(Se.length!==3)return!1;var Ie=+Se[0],He=+Se[1],Le=+Se[2];return!isNaN(Ie)&&!isNaN(He)&&!isNaN(Le)}(h,A)?(y=h.split(":"),S=+y[0],E=+y[1],+y[2]+60*E+3600*S):a(h,A,$,B,j,z,p);else{if(typeof h!="number")return;W=h}if(W!==void 0)return W}}},{"./globalState":4}],10:[function(r,n,i){function o(A){return function($){if(Array.isArray($)){for(var B=0,j=new Array($.length);B<$.length;B++)j[B]=$[B];return j}}(A)||function($){if(Symbol.iterator in Object($)||Object.prototype.toString.call($)==="[object Arguments]")return Array.from($)}(A)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function s(A){return(s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function($){return typeof $}:function($){return $&&typeof Symbol=="function"&&$.constructor===Symbol&&$!==Symbol.prototype?"symbol":typeof $})(A)}var a=r("./unformatting"),h=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,p={output:{type:"string",validValues:["currency","percent","byte","time","ordinal","number"]},base:{type:"string",validValues:["decimal","binary","general"],restriction:function(A,$){return $.output==="byte"},message:"`base` must be provided only when the output is `byte`",mandatory:function(A){return A.output==="byte"}},characteristic:{type:"number",restriction:function(A){return 0<=A},message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:["trillion","billion","million","thousand"]},average:"boolean",currencyPosition:{type:"string",validValues:["prefix","infix","postfix"]},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:function(A){return 0<=A},message:"value must be positive"},{restriction:function(A,$){return!$.exponential},message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:function(A){return 0<=A},message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:["sign","parenthesis"]},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:function(A,$){return $.output==="percent"},message:"`prefixSymbol` can be provided only when the output is `percent`"}},y={languageTag:{type:"string",mandatory:!0,restriction:function(A){return A.match(h)},message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:{type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},spaceSeparated:"boolean",ordinal:{type:"function",mandatory:!0},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function S(A){return!!a.unformat(A)}function E(A,$,B){var j=3<arguments.length&&arguments[3]!==void 0&&arguments[3],z=Object.keys(A).map(function(W){if(!$[W])return console.error("".concat(B," Invalid key: ").concat(W)),!1;var Q=A[W],q=$[W];if(typeof q=="string"&&(q={type:q}),q.type==="format"){if(!E(Q,p,"[Validate ".concat(W,"]"),!0))return!1}else if(s(Q)!==q.type)return console.error("".concat(B," ").concat(W,' type mismatched: "').concat(q.type,'" expected, "').concat(s(Q),'" provided')),!1;if(q.restrictions&&q.restrictions.length)for(var Se=q.restrictions.length,Ie=0;Ie<Se;Ie++){var He=q.restrictions[Ie],Le=He.restriction,ze=He.message;if(!Le(Q,A))return console.error("".concat(B," ").concat(W," invalid value: ").concat(ze)),!1}return q.restriction&&!q.restriction(Q,A)?(console.error("".concat(B," ").concat(W," invalid value: ").concat(q.message)),!1):q.validValues&&q.validValues.indexOf(Q)===-1?(console.error("".concat(B," ").concat(W," invalid value: must be among ").concat(JSON.stringify(q.validValues),', "').concat(Q,'" provided')),!1):!(q.children&&!E(Q,q.children,"[Validate ".concat(W,"]")))});return j||z.push.apply(z,o(Object.keys($).map(function(W){var Q=$[W];if(typeof Q=="string"&&(Q={type:Q}),Q.mandatory){var q=Q.mandatory;if(typeof q=="function"&&(q=q(A)),q&&A[W]===void 0)return console.error("".concat(B,' Missing mandatory key "').concat(W,'"')),!1}return!0}))),z.reduce(function(W,Q){return W&&Q},!0)}function O(A){return E(A,p,"[Validate format]")}n.exports={validate:function(A,$){var B=S(A),j=O($);return B&&j},validateFormat:O,validateInput:S,validateLanguage:function(A){return E(A,y,"[Validate language]")}}},{"./unformatting":9}]},{},[7])(7)})})(_ce);var LGe=_ce.exports;const qd=jb(LGe);var NGe="numeric";function kU(e,t,r,n,i,o,s){var a=o;if(Ls(a)){var h=s.numericFormat,p=h&&h.culture||"-",y=h&&h.pattern,S=s.className||"",E=S.length?S.split(" "):[];if(typeof p<"u"&&!qd.languages()[p]){var O=p.replace("-",""),A=qd.allLanguages?qd.allLanguages[p]:qd[O];A&&qd.registerLanguage(A)}qd.setLanguage(p),a=qd(a).format(y||"0"),E.indexOf("htLeft")<0&&E.indexOf("htCenter")<0&&E.indexOf("htRight")<0&&E.indexOf("htJustify")<0&&E.push("htRight"),E.indexOf("htNumeric")<0&&E.push("htNumeric"),s.className=E.join(" "),t.dir="ltr"}Zh(e,t,r,n,i,a,s)}kU.RENDERER_TYPE=NGe;var BGe="password";function PU(e,t,r,n,i,o,s){Zh.apply(this,[e,t,r,n,i,o,s]);var a=s.hashLength||t.innerHTML.length,h=s.hashSymbol||"*",p="";Or(a-1,function(){p+=h}),iw(t,p)}PU.RENDERER_TYPE=BGe;var jGe="time";function AU(e,t,r,n,i,o,s){Zh.apply(this,[e,t,r,n,i,o,s]),t.dir="ltr"}AU.RENDERER_TYPE=jGe;var xE=Zs("renderers"),FGe=xE.register,zGe=xE.getItem,bce=xE.hasItem;xE.getNames;xE.getValues;function w7(e){if(typeof e=="function")return e;if(!bce(e))throw Error('No registered renderer found under "'.concat(e,'" name'));return zGe(e)}function ec(e,t){typeof e!="string"&&(t=e,e=t.RENDERER_TYPE),FGe(e,t)}function HGe(){ec(aw),ec(SE),ec(OU),ec(TU),ec(kU),ec(PU),ec(Zh),ec(AU)}var VGe="autocomplete";function fM(e,t){var r=e;if(r==null&&(r=""),this.allowEmpty&&r===""){t(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(r,S7(r,t)):S7(r,t)(this.source):t(!0)}fM.VALIDATOR_TYPE=VGe;function S7(e,t){var r=e;return function(n){for(var i=!1,o=0,s=n.length;o<s;o++)if(r===n[o]){i=!0;break}t(i)}}var UGe=Object.is||function(t,r){return t===r?t!==0||1/t===1/r:t!=t&&r!=r},WGe=uo,GGe=jI,YGe=Yi,KGe=Il,qGe=Wa,x7=UGe,C7=to,XGe=Im,ZGe=FI;GGe("search",function(e,t,r){return[function(i){var o=qGe(this),s=KGe(i)?void 0:XGe(i,e);return s?WGe(s,i,o):new RegExp(i)[e](C7(o))},function(n){var i=YGe(this),o=C7(n),s=r(t,i,o);if(s.done)return s.value;var a=i.lastIndex;x7(a,0)||(i.lastIndex=0);var h=ZGe(i,o);return x7(i.lastIndex,a)||(i.lastIndex=a),h===null?-1:h.index}]});function JGe(e){var t=new Date(e);return isNaN(new Date("".concat(e,"T00:00")).getDate())?t:new Date(t.getTime()+t.getTimezoneOffset()*6e4)}var QGe="date";function IU(e,t){var r=ace(dce,this.instance),n=e,i=!0;n==null&&(n="");var o=Ut(n,this.dateFormat||r.defaultDateFormat,!0).isValid(),s=Ut(new Date(n)).isValid()||o;if(this.allowEmpty&&n===""&&(s=!0,o=!0),s||(i=!1),!s&&o&&(i=!0),s&&!o)if(this.correctFormat===!0){var a=e6e(n,this.dateFormat),h=this.instance.toVisualRow(this.row),p=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(h,p,a,"dateValidator"),i=!0}else i=!1;t(i)}IU.VALIDATOR_TYPE=QGe;function e6e(e,t){var r=Ut(JGe(e)),n=Ut(e,t),i=e.search(/[A-z]/g)>-1,o;return r.isValid()&&r.format("x")===n.format("x")||!n.isValid()||i?o=r:o=n,o.format(t)}var t6e="numeric";function MU(e,t){var r=e;r==null&&(r=""),this.allowEmpty&&r===""?t(!0):t(r===""?!1:Ls(e))}MU.VALIDATOR_TYPE=t6e;var r6e=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],n6e="time";function $U(e,t){var r=this.timeFormat||"h:mm:ss a",n=!0,i=e;i===null&&(i=""),i=/^\d{3,}$/.test(i)?parseInt(i,10):i;var o=/^\d{1,2}$/.test(i);o&&(i+=":00");var s=Ut(i,r6e,!0).isValid()?Ut(i):Ut(i,r),a=s.isValid(),h=Ut(i,r,!0).isValid()&&!o;if(this.allowEmpty&&i===""&&(a=!0,h=!0),a||(n=!1),!a&&h&&(n=!0),a&&!h)if(this.correctFormat===!0){var p=s.format(r),y=this.instance.toVisualRow(this.row),S=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(y,S,p,"timeValidator"),n=!0}else n=!1;t(n)}$U.VALIDATOR_TYPE=n6e;var CE=Zs("validators"),i6e=CE.register,o6e=CE.getItem,wce=CE.hasItem;CE.getNames;CE.getValues;function a6e(e){if(typeof e=="function")return e;if(!wce(e))throw Error('No registered validator found under "'.concat(e,'" name'));return o6e(e)}function ES(e,t){typeof e!="string"&&(t=e,e=t.VALIDATOR_TYPE),i6e(e,t)}function s6e(){ES(fM),ES(IU),ES(MU),ES($U)}var l6e="autocomplete",u6e={CELL_TYPE:l6e,editor:CU,renderer:aw,validator:fM},c6e="checkbox",f6e={CELL_TYPE:c6e,editor:fce,renderer:OU},h6e="date",d6e={CELL_TYPE:h6e,editor:pce,renderer:aw,validator:IU},p6e="dropdown",m6e={CELL_TYPE:p6e,editor:EU,renderer:aw,validator:fM},g6e="handsontable",y6e={CELL_TYPE:g6e,editor:xU,renderer:aw},v6e="numeric",_6e={CELL_TYPE:v6e,editor:mce,renderer:kU,validator:MU,dataType:"number"},b6e="password",w6e={CELL_TYPE:b6e,editor:gce,renderer:PU,copyable:!1},S6e="text",Sce={CELL_TYPE:S6e,editor:jm,renderer:Zh},x6e="time",C6e={CELL_TYPE:x6e,editor:yce,renderer:AU,validator:$U},EE=Zs("cellTypes"),E6e=EE.register,T6e=EE.getItem,xce=EE.hasItem;EE.getNames;EE.getValues;function O6e(e){if(!xce(e))throw Error('You declared cell type "'.concat(e,`" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`));return T6e(e)}function uu(e,t){typeof e!="string"&&(t=e,e=t.CELL_TYPE);var r=t,n=r.editor,i=r.renderer,o=r.validator;n&&ns(e,n),i&&ec(e,i),o&&ES(e,o),E6e(e,t)}function R6e(){uu(u6e),uu(f6e),uu(d6e),uu(m6e),uu(y6e),uu(_6e),uu(w6e),uu(Sce),uu(C6e)}var k6e=DI,P6e=vse;k6e("WeakSet",function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},P6e);function A6e(e){return $6e(e)||M6e(e)||Cce(e)||I6e()}function I6e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function M6e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function $6e(e){if(Array.isArray(e))return qj(e)}function D6e(e,t){return B6e(e)||N6e(e,t)||Cce(e,t)||L6e()}function L6e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Cce(e,t){if(e){if(typeof e=="string")return qj(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return qj(e,t)}}function qj(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function N6e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],h=!0,p=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;h=!1}else for(;!(h=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);h=!0);}catch(y){p=!0,i=y}finally{try{if(!h&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(p)throw i}}return a}}function B6e(e){if(Array.isArray(e))return e}var Xj="asc",j6e="desc",E7=new Map([[Xj,[-1,1]],[j6e,[1,-1]]]),F6e=function(t){return"The priority '".concat(t,"' is already declared in a map.")},z6e=function(t){return"The priority '".concat(t,"' is not a number.")};function H6e(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.errorPriorityExists,r=e.errorPriorityNaN,n=new Map;t=hi(t)?t:F6e,r=hi(r)?r:z6e;function i(s,a){if(!Ls(s))throw new Error(r(s));if(n.has(s))throw new Error(t(s));n.set(s,a)}function o(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Xj,a=E7.get(s)||E7.get(Xj),h=D6e(a,2),p=h[0],y=h[1];return A6e(n).sort(function(S,E){return S[0]<E[0]?p:y}).map(function(S){return S[1]})}return{addItem:i,getItems:o}}function V6e(e){return G6e(e)||W6e(e)||Ece(e)||U6e()}function U6e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function W6e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function G6e(e){if(Array.isArray(e))return Zj(e)}function T7(e,t){return q6e(e)||K6e(e,t)||Ece(e,t)||Y6e()}function Y6e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ece(e,t){if(e){if(typeof e=="string")return Zj(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Zj(e,t)}}function Zj(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function K6e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],h=!0,p=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;h=!1}else for(;!(h=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);h=!0);}catch(y){p=!0,i=y}finally{try{if(!h&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(p)throw i}}return a}}function q6e(e){if(Array.isArray(e))return e}var X6e=function(t){return"The id '".concat(t,"' is already declared in a map.")};function hM(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.errorIdExists,r=new Map;t=hi(t)?t:X6e;function n(y,S){if(p(y))throw new Error(t(y));r.set(y,S)}function i(y){return r.delete(y)}function o(){r.clear()}function s(y){var S=h().find(function(A){var $=T7(A,2),B=$[0],j=$[1];return y===j?B:!1})||[null],E=T7(S,1),O=E[0];return O}function a(y){return r.get(y)}function h(){return V6e(r)}function p(y){return r.has(y)}return{addItem:n,clear:o,getId:s,getItem:a,getItems:h,hasItem:p,removeItem:i}}function Z6e(e){return t8e(e)||e8e(e)||Q6e(e)||J6e()}function J6e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Q6e(e,t){if(e){if(typeof e=="string")return Jj(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Jj(e,t)}}function e8e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function t8e(e){if(Array.isArray(e))return Jj(e)}function Jj(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var r8e=function(t){return"'".concat(t,"' value is already declared in a unique set.")};function n8e(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.errorItemExists,r=new Set;t=hi(t)?t:r8e;function n(s){if(r.has(s))throw new Error(t(s));r.add(s)}function i(){return Z6e(r)}function o(){r.clear()}return{addItem:n,clear:o,getItems:i}}function i8e(e,t){return s8e(e)||a8e(e,t)||Tce(e,t)||o8e()}function o8e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function a8e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],h=!0,p=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;h=!1}else for(;!(h=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);h=!0);}catch(y){p=!0,i=y}finally{try{if(!h&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(p)throw i}}return a}}function s8e(e){if(Array.isArray(e))return e}function O7(e){return c8e(e)||u8e(e)||Tce(e)||l8e()}function l8e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Tce(e,t){if(e){if(typeof e=="string")return Qj(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Qj(e,t)}}function u8e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function c8e(e){if(Array.isArray(e))return Qj(e)}function Qj(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var DU=function(t){return'There is already registered "'.concat(t,'" plugin.')},f8e=function(t){return'There is already registered plugin on priority "'.concat(t,'".')},h8e=function(t){return'The priority "'.concat(t,'" is not a number.')},Oce=H6e({errorPriorityExists:f8e,errorPriorityNaN:h8e}),Rce=n8e({errorItemExists:DU}),eF=hM({errorIdExists:DU});function kce(){return[].concat(O7(Oce.getItems()),O7(Rce.getItems()))}function LU(e){var t=Hc(e);return eF.getItem(t)}function d8e(e){return!!LU(e)}function Dn(e,t,r){var n=m8e(e,t,r),i=i8e(n,3);e=i[0],t=i[1],r=i[2],LU(e)===void 0&&p8e(e,t,r)}function p8e(e,t,r){var n=Hc(e);if(eF.hasItem(n))throw new Error(DU(n));r===void 0?Rce.addItem(n):Oce.addItem(r,n),eF.addItem(n,t)}function m8e(e,t,r){return typeof e=="function"&&(t=e,e=t.PLUGIN_KEY,r=t.PLUGIN_PRIORITY),[e,t,r]}function j1(e){"@babel/helpers - typeof";return j1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},j1(e)}function g8e(e,t){return b8e(e)||_8e(e,t)||v8e(e,t)||y8e()}function y8e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function v8e(e,t){if(e){if(typeof e=="string")return R7(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return R7(e,t)}}function R7(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _8e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],h=!0,p=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;h=!1}else for(;!(h=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);h=!0);}catch(y){p=!0,i=y}finally{try{if(!h&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(p)throw i}}return a}}function b8e(e){if(Array.isArray(e))return e}function w8e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function k7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,x8e(n.key),n)}}function S8e(e,t,r){return t&&k7(e.prototype,t),r&&k7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function x8e(e){var t=C8e(e,"string");return j1(t)==="symbol"?t:String(t)}function C8e(e,t){if(j1(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(j1(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function E8e(e,t){T8e(e,t),t.add(e)}function T8e(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function O8e(e,t,r){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return r}var P7=new Map([["plugin",d8e],["cell-type",xce],["editor",oce],["renderer",bce],["validator",wce]]),R8e="base",Xd=new WeakMap,hL=[],eu=null,A7=new WeakSet,Yn=function(){function e(t){var r=this;w8e(this,e),E8e(this,A7),af(this,"hot",t,{writable:!1}),Xd.set(this,{hooks:{}}),eu=null,this.pluginName=null,this.pluginsInitializedCallbacks=[],this.isPluginsReady=!1,this.enabled=!1,this.initialized=!1,this.hot.addHook("afterPluginsInitialized",function(){return r.onAfterPluginsInitialized()}),this.hot.addHook("afterUpdateSettings",function(n){return r.onUpdateSettings(n)}),this.hot.addHook("beforeInit",function(){return r.init()})}return S8e(e,[{key:"init",value:function(){var r=this;this.pluginName=this.hot.getPluginName(this);var n=this.constructor.PLUGIN_DEPS,i=Array.isArray(n)?n:[];if(i.length>0){var o=[];if(i.forEach(function(p){var y=p.split(":"),S=g8e(y,2),E=S[0],O=S[1];if(!P7.has(E))throw new Error('Unknown plugin dependency type "'.concat(E,'" was found.'));P7.get(E)(O)||o.push(" - ".concat(O," (").concat(E,")"))}),o.length>0){var s=["The ".concat(this.pluginName,` plugin requires the following modules:
`),"".concat(o.join(`
`),`
`)].join("");hL.push(s)}}eu||(eu=kce()),eu.indexOf("UndoRedo")>=0&&eu.splice(eu.indexOf("UndoRedo"),1),eu.indexOf(this.pluginName)>=0&&eu.splice(eu.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",function(){r.isEnabled&&r.isEnabled()&&r.enablePlugin()});var a=eu.length===0;if(a){if(hL.length>0){var h=["".concat(hL.join(`
`),`
`),"You have to import and register them manually."].join("");throw new Error(h)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}},{key:"enablePlugin",value:function(){this.enabled=!0}},{key:"disablePlugin",value:function(){this.eventManager&&this.eventManager.clear(),this.clearHooks(),this.enabled=!1}},{key:"addHook",value:function(r,n){Xd.get(this).hooks[r]=Xd.get(this).hooks[r]||[];var i=Xd.get(this).hooks[r];this.hot.addHook(r,n),i.push(n),Xd.get(this).hooks[r]=i}},{key:"removeHooks",value:function(r){var n=this;Fe(Xd.get(this).hooks[r]||[],function(i){n.hot.removeHook(r,i)})}},{key:"clearHooks",value:function(){var r=this,n=Xd.get(this).hooks;mn(n,function(i,o){return r.removeHooks(o)}),n.length=0}},{key:"callOnPluginsReady",value:function(r){this.isPluginsReady?r():this.pluginsInitializedCallbacks.push(r)}},{key:"onAfterPluginsInitialized",value:function(){Fe(this.pluginsInitializedCallbacks,function(r){return r()}),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}},{key:"onUpdateSettings",value:function(r){var n=O8e(this,A7,k8e).call(this,r);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&n&&this.updatePlugin(r))}},{key:"updatePlugin",value:function(){}},{key:"destroy",value:function(){var r=this;this.eventManager&&this.eventManager.destroy(),this.clearHooks(),mn(this,function(n,i){i!=="hot"&&(r[i]=null)}),delete this.t,delete this.hot}}],[{key:"PLUGIN_KEY",get:function(){return R8e}},{key:"SETTING_KEYS",get:function(){return[this.PLUGIN_KEY]}}]),e}();function k8e(e){if(!e)return!1;var t=this.constructor.SETTING_KEYS;if(typeof t=="boolean")return t;for(var r=0;r<t.length;r++)if(e[t[r]]!==void 0)return!0;return!1}function F1(e){"@babel/helpers - typeof";return F1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},F1(e)}function P8e(e,t){return $8e(e)||M8e(e,t)||I8e(e,t)||A8e()}function A8e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function I8e(e,t){if(e){if(typeof e=="string")return I7(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return I7(e,t)}}function I7(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function M8e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],h=!0,p=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;h=!1}else for(;!(h=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);h=!0);}catch(y){p=!0,i=y}finally{try{if(!h&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(p)throw i}}return a}}function $8e(e){if(Array.isArray(e))return e}function D8e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function M7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,N8e(n.key),n)}}function L8e(e,t,r){return t&&M7(e.prototype,t),r&&M7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function N8e(e){var t=B8e(e,"string");return F1(t)==="symbol"?t:String(t)}function B8e(e,t){if(F1(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(F1(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var j8e=function(){function e(t){D8e(this,e),this.hot=t,this.container=null,this.injected=!1,this.rows=[],this.columns=[],this.samples=null,this.settings={useHeaders:!0}}return L8e(e,[{key:"addRow",value:function(r,n){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));var i={row:r};this.rows.push(i),this.samples=n,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.table.tr.appendChild(this.createRow(r)),this.container.container.appendChild(this.table.fragment),i.table=this.table.table}},{key:"addColumnHeadersRow",value:function(r){var n=this.hot.getColHeader(0);if(n!=null){var i={row:-1};this.rows.push(i),this.container=this.createContainer(this.hot.rootElement.className),this.samples=r,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),i.table=this.table.table}}},{key:"addColumn",value:function(r,n){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));var i={col:r};this.columns.push(i),this.samples=n,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(r)!==null&&this.hot.view.appendColHeader(r,this.table.th),this.table.tBody.appendChild(this.createCol(r)),this.container.container.appendChild(this.table.fragment),i.table=this.table.table}},{key:"getHeights",value:function(r){this.injected||this.injectTable(),Fe(this.rows,function(n){r(n.row,Ni(n.table)-1)})}},{key:"getWidths",value:function(r){this.injected||this.injectTable(),Fe(this.columns,function(n){var i=n.table.getBoundingClientRect(),o=i.width;r(n.col,Math.ceil(o))})}},{key:"setSettings",value:function(r){this.settings=r}},{key:"setSetting",value:function(r,n){this.settings||(this.settings={}),this.settings[r]=n}},{key:"getSettings",value:function(){return this.settings}},{key:"getSetting",value:function(r){return this.settings?this.settings[r]:null}},{key:"createColGroupsCol",value:function(){var r=this,n=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&n.appendChild(this.createColElement(-1)),this.samples.forEach(function(i){Fe(i.strings,function(o){n.appendChild(r.createColElement(o.col))})}),n}},{key:"createRow",value:function(r){var n=this,i=this.hot.rootDocument,o=i.createDocumentFragment(),s=i.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(r,s),o.appendChild(s)),this.samples.forEach(function(a){Fe(a.strings,function(h){var p=h.col,y=n.hot.getCellMeta(r,p);y.col=p,y.row=r;var S=n.hot.getCellRenderer(y),E=i.createElement("td");E.setAttribute("ghost-table",1),S(n.hot,E,r,p,n.hot.colToProp(p),h.value,y),o.appendChild(E)})}),o}},{key:"appendColumnHeadersRow",value:function(){var r=this,n=this.hot.rootDocument,i=n.createDocumentFragment(),o=[];if(this.hot.hasRowHeaders()){var s=n.createElement("th");o.push([-1,s]),i.appendChild(s)}this.samples.forEach(function(a){Fe(a.strings,function(h){var p=h.col,y=n.createElement("th");o.push([p,y]),i.appendChild(y)})}),this.table.tHead.appendChild(i),Fe(o,function(a){var h=P8e(a,2),p=h[0],y=h[1];r.hot.view.appendColHeader(p,y)})}},{key:"createCol",value:function(r){var n=this,i=this.hot.rootDocument,o=i.createDocumentFragment();return this.samples.forEach(function(s){Fe(s.strings,function(a){var h=a.row,p=n.hot.getCellMeta(h,r);p.col=r,p.row=h;var y=n.hot.getCellRenderer(p),S=i.createElement("td"),E=i.createElement("tr");S.setAttribute("ghost-table",1),y(n.hot,S,h,r,n.hot.colToProp(r),a.value,p),E.appendChild(S),o.appendChild(E)})}),o}},{key:"clean",value:function(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}},{key:"injectTable",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((r||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}},{key:"removeTable",value:function(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}},{key:"createColElement",value:function(r){var n=this.hot.rootDocument.createElement("col");return n.style.width="".concat(this.hot.view._wt.wtTable.getStretchedColumnWidth(r),"px"),n}},{key:"createTable",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=this.hot.rootDocument,i=n.createDocumentFragment(),o=n.createElement("table"),s=n.createElement("thead"),a=n.createElement("tbody"),h=n.createElement("colgroup"),p=n.createElement("tr"),y=n.createElement("th");return this.isVertical()&&o.appendChild(h),this.isHorizontal()&&(p.appendChild(y),s.appendChild(p),o.style.tableLayout="auto",o.style.width="auto"),o.appendChild(s),this.isVertical()&&a.appendChild(p),o.appendChild(a),Vt(o,r),i.appendChild(o),{fragment:i,table:o,tHead:s,tBody:a,colGroup:h,tr:p,th:y}}},{key:"createContainer",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=this.hot.rootDocument,i=n.createDocumentFragment(),o=n.createElement("div"),s="htGhostTable htAutoSize ".concat(r.trim());return Vt(o,s),i.appendChild(o),{fragment:i,container:o}}},{key:"isVertical",value:function(){return!!(this.rows.length&&!this.columns.length)}},{key:"isHorizontal",value:function(){return!!(this.columns.length&&!this.rows.length)}}]),e}();const Pce=j8e;var F8e=jr,z8e=Ga,Ace=JC,H8e=on,V8e=H8e(function(){Ace(1)});F8e({target:"Object",stat:!0,forced:V8e},{keys:function(t){return Ace(z8e(t))}});function z1(e){"@babel/helpers - typeof";return z1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},z1(e)}function U8e(e,t,r){return t=Ice(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function W8e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ice(n.key),n)}}function G8e(e,t,r){return t&&$7(e.prototype,t),r&&$7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ice(e){var t=Y8e(e,"string");return z1(t)==="symbol"?t:String(t)}function Y8e(e,t){if(z1(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(z1(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var K8e=function(){function e(t){W8e(this,e),this.samples=null,this.dataFactory=t,this.customSampleCount=null,this.allowDuplicates=!1}return G8e(e,[{key:"getSampleCount",value:function(){return this.customSampleCount?this.customSampleCount:e.SAMPLE_COUNT}},{key:"setSampleCount",value:function(r){this.customSampleCount=r}},{key:"setAllowDuplicates",value:function(r){this.allowDuplicates=r}},{key:"generateRowSamples",value:function(r,n){return this.generateSamples("row",n,r)}},{key:"generateColumnSamples",value:function(r,n){return this.generateSamples("col",n,r)}},{key:"generateSamples",value:function(r,n,i){var o=this,s=new Map,a=typeof i=="number"?{from:i,to:i}:i,h=a.from,p=a.to;return Or(h,p,function(y){var S=o.generateSample(r,n,y);s.set(y,S)}),s}},{key:"generateSample",value:function(r,n,i){var o=this;if(r!=="row"&&r!=="col")throw new Error("Unsupported sample type");var s=new Map,a=r==="row"?"col":"row",h=[];return Or(n.from,n.to,function(p){var y=r==="row"?o.dataFactory(i,p):o.dataFactory(p,i),S=y.value,E=y.bundleSeed,O=typeof E=="string"&&E.length>0,A;O?A=E:pn(S)?A="".concat(Object.keys(S).length):Array.isArray(S)?A="".concat(S.length):A="".concat(Ji(S).length),s.has(A)||s.set(A,{needed:o.getSampleCount(),strings:[]});var $=s.get(A);if($.needed){var B=h.indexOf(S)>-1;(!B||o.allowDuplicates||O)&&($.strings.push(U8e({value:S},a,p)),h.push(S),$.needed-=1)}}),s}}],[{key:"SAMPLE_COUNT",get:function(){return 3}}]),e}();const Mce=K8e;var mp=1,ea=2;function H1(e){"@babel/helpers - typeof";return H1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},H1(e)}function q8e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function D7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Z8e(n.key),n)}}function X8e(e,t,r){return t&&D7(e.prototype,t),r&&D7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Z8e(e){var t=J8e(e,"string");return H1(t)==="symbol"?t:String(t)}function J8e(e,t){if(H1(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(H1(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ty=new WeakMap,Q8e=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.viewportSize,n=t.scrollOffset,i=t.totalItems,o=t.itemSizeFn,s=t.overrideFn,a=t.calculationType,h=t.stretchMode,p=t.stretchingItemWidthFn,y=p===void 0?function(E){return E}:p,S=t.inlineStartOffset;q8e(this,e),ty.set(this,{viewportWidth:r,scrollOffset:n,totalColumns:i,columnWidthFn:o,overrideFn:s,calculationType:a,stretchingColumnWidthFn:y,inlineStartOffset:S}),this.count=0,this.startColumn=null,this.endColumn=null,this.startPosition=null,this.isVisibleInTrimmingContainer=!1,this.stretchAllRatio=0,this.stretchLastWidth=0,this.stretch=h,this.totalTargetWidth=0,this.needVerifyLastColumnWidth=!0,this.stretchAllColumnsWidth=[],this.calculate()}return X8e(e,[{key:"calculate",value:function(){for(var r=0,n=!0,i=[],o,s=0,a=0,h=ty.get(this),p=h.calculationType,y=h.overrideFn,S=h.scrollOffset,E=Math.max(h.scrollOffset,0),O=h.totalColumns,A=h.viewportWidth,$=E>0?A+1:A,B=0;B<O;B++)if(o=this._getColumnWidth(B),r<=E&&p!==ea&&(this.startColumn=B,s=o),r>=E&&r+(p===ea?o:0)<=E+$&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=B,s=o),this.endColumn=B),i.push(r),r+=o,a=o,p!==ea&&(this.endColumn=B),r>=E+A){n=!1;break}var j=S+A-$,z=p===ea?0:a,W=p===ea?s:0;if(j<-1*h.inlineStartOffset||S>i.at(-1)+z||-1*h.scrollOffset-h.viewportWidth>-1*W?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endColumn===O-1&&n)for(this.startColumn=this.endColumn;this.startColumn>0;){var Q=i[this.endColumn]+o-i[this.startColumn-1];if((Q<=A||p!==ea)&&(this.startColumn-=1),Q>A)break}p===mp&&this.startColumn!==null&&y&&y(this),this.startPosition=i[this.startColumn],this.startPosition===void 0&&(this.startPosition=null),O<this.endColumn&&(this.endColumn=O-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}},{key:"refreshStretching",value:function(r){if(this.stretch!=="none"){var n=r;this.totalTargetWidth=n;for(var i=ty.get(this),o=i.totalColumns,s=0,a=0;a<o;a++){var h=this._getColumnWidth(a),p=i.stretchingColumnWidthFn(void 0,a);typeof p=="number"?n-=p:s+=h}var y=n-s;if(this.stretch==="all"&&y>0)this.stretchAllRatio=n/s,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if(this.stretch==="last"&&n!==1/0){var S=this._getColumnWidth(o-1),E=y+S;this.stretchLastWidth=E>=0?E:S}}}},{key:"getStretchedColumnWidth",value:function(r,n){var i=null;return this.stretch==="all"&&this.stretchAllRatio!==0?i=this._getStretchedAllColumnWidth(r,n):this.stretch==="last"&&this.stretchLastWidth!==0&&(i=this._getStretchedLastColumnWidth(r)),i}},{key:"_getStretchedAllColumnWidth",value:function(r,n){var i=0,o=ty.get(this),s=o.totalColumns;if(!this.stretchAllColumnsWidth[r]){var a=Math.round(n*this.stretchAllRatio),h=o.stretchingColumnWidthFn(a,r);h===void 0?this.stretchAllColumnsWidth[r]=a:this.stretchAllColumnsWidth[r]=isNaN(h)?this._getColumnWidth(r):h}if(this.stretchAllColumnsWidth.length===s&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(var p=0;p<this.stretchAllColumnsWidth.length;p++)i+=this.stretchAllColumnsWidth[p];i!==this.totalTargetWidth&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=this.totalTargetWidth-i)}return this.stretchAllColumnsWidth[r]}},{key:"_getStretchedLastColumnWidth",value:function(r){var n=ty.get(this),i=n.totalColumns;return r===i-1?this.stretchLastWidth:null}},{key:"_getColumnWidth",value:function(r){var n=ty.get(this).columnWidthFn(r);return isNaN(n)&&(n=e.DEFAULT_WIDTH),n}}],[{key:"DEFAULT_WIDTH",get:function(){return 50}}]),e}();const NU=Q8e;function V1(e){"@babel/helpers - typeof";return V1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},V1(e)}function eYe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function L7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,rYe(n.key),n)}}function tYe(e,t,r){return t&&L7(e.prototype,t),r&&L7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function rYe(e){var t=nYe(e,"string");return V1(t)==="symbol"?t:String(t)}function nYe(e,t){if(V1(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(V1(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var N7=new WeakMap,iYe=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.viewportSize,n=t.scrollOffset,i=t.totalItems,o=t.itemSizeFn,s=t.overrideFn,a=t.calculationType,h=t.scrollbarHeight;eYe(this,e),N7.set(this,{viewportHeight:r,scrollOffset:n,totalRows:i,rowHeightFn:o,overrideFn:s,calculationType:a,horizontalScrollbarHeight:h}),this.count=0,this.startRow=null,this.endRow=null,this.startPosition=null,this.isVisibleInTrimmingContainer=!1,this.calculate()}return tYe(e,[{key:"calculate",value:function(){for(var r=N7.get(this),n=r.calculationType,i=r.overrideFn,o=r.rowHeightFn,s=r.scrollOffset,a=Math.max(r.scrollOffset,0),h=r.totalRows,p=r.viewportHeight,y=r.horizontalScrollbarHeight||0,S=0,E=!0,O=[],A,$=0,B=0,j=0;j<h;j++)if(A=o(j),isNaN(A)&&(A=e.DEFAULT_HEIGHT),S<=a&&n!==ea&&(this.startRow=j,$=A),S>=a&&S+(n===ea?A:0)<=a+p-y&&(this.startRow===null&&(this.startRow=j,$=A),this.endRow=j),O.push(S),S+=A,B=A,n!==ea&&(this.endRow=j),S>=a+p-y){E=!1;break}var z=s+p-y,W=n===ea?$:0,Q=n===ea?0:B;if(z<W||s>O.at(-1)+Q?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endRow===h-1&&E)for(this.startRow=this.endRow;this.startRow>0;){var q=O[this.endRow]+A-O[this.startRow-1];if((q<=p-y||n!==ea)&&(this.startRow-=1),q>=p-y)break}n===mp&&this.startRow!==null&&i&&i(this),this.startPosition=O[this.startRow],this.startPosition===void 0&&(this.startPosition=null),h<this.endRow&&(this.endRow=h-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}],[{key:"DEFAULT_HEIGHT",get:function(){return 23}}]),e}();const $ce=iYe;function U1(e){"@babel/helpers - typeof";return U1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},U1(e)}function oYe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function B7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Dce(n.key),n)}}function aYe(e,t,r){return t&&B7(e.prototype,t),r&&B7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function sYe(e,t,r){lYe(e,t),t.set(e,r)}function lYe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function j7(e,t,r){return t=Dce(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Dce(e){var t=uYe(e,"string");return U1(t)==="symbol"?t:String(t)}function uYe(e,t){if(U1(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(U1(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Q0(e,t){var r=Lce(e,t,"get");return cYe(e,r)}function cYe(e,t){return t.get?t.get.call(e):t.value}function fYe(e,t,r){var n=Lce(e,t,"set");return hYe(e,n,r),r}function Lce(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function hYe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var Zd=new WeakMap,dYe=function(){function e(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;oYe(this,e),j7(this,"row",null),j7(this,"col",null),sYe(this,Zd,{writable:!0,value:!1}),fYe(this,Zd,n),typeof t<"u"&&typeof r<"u"&&(this.row=t,this.col=r)}return aYe(e,[{key:"isValid",value:function(r){return!(this.row<0||this.col<0||this.row>=r.getSetting("totalRows")||this.col>=r.getSetting("totalColumns"))}},{key:"isEqual",value:function(r){return r===this?!0:this.row===r.row&&this.col===r.col}},{key:"isSouthEastOf",value:function(r){return this.row>=r.row&&(Q0(this,Zd)?this.col<=r.col:this.col>=r.col)}},{key:"isNorthWestOf",value:function(r){return this.row<=r.row&&(Q0(this,Zd)?this.col>=r.col:this.col<=r.col)}},{key:"isSouthWestOf",value:function(r){return this.row>=r.row&&(Q0(this,Zd)?this.col>=r.col:this.col<=r.col)}},{key:"isNorthEastOf",value:function(r){return this.row<=r.row&&(Q0(this,Zd)?this.col<=r.col:this.col>=r.col)}},{key:"normalize",value:function(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}},{key:"clone",value:function(){return new e(this.row,this.col,Q0(this,Zd))}},{key:"toObject",value:function(){return{row:this.row,col:this.col}}}]),e}();const eA=dYe;function W1(e){"@babel/helpers - typeof";return W1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},W1(e)}function pYe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function F7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Nce(n.key),n)}}function mYe(e,t,r){return t&&F7(e.prototype,t),r&&F7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function gYe(e,t,r){yYe(e,t),t.set(e,r)}function yYe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function dL(e,t,r){return t=Nce(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Nce(e){var t=vYe(e,"string");return W1(t)==="symbol"?t:String(t)}function vYe(e,t){if(W1(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(W1(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function tu(e,t){var r=Bce(e,t,"get");return _Ye(e,r)}function _Ye(e,t){return t.get?t.get.call(e):t.value}function bYe(e,t,r){var n=Bce(e,t,"set");return wYe(e,n,r),r}function Bce(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function wYe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var ks=new WeakMap,SYe=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;pYe(this,e),dL(this,"highlight",null),dL(this,"from",null),dL(this,"to",null),gYe(this,ks,{writable:!0,value:!1}),this.highlight=t.clone().normalize(),this.from=r.clone(),this.to=n.clone(),bYe(this,ks,i)}return mYe(e,[{key:"setHighlight",value:function(r){return this.highlight=r.clone().normalize(),this}},{key:"setFrom",value:function(r){return this.from=r.clone(),this}},{key:"setTo",value:function(r){return this.to=r.clone(),this}},{key:"isValid",value:function(r){return this.from.isValid(r)&&this.to.isValid(r)}},{key:"isSingle",value:function(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}},{key:"getOuterHeight",value:function(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}},{key:"getOuterWidth",value:function(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}},{key:"getHeight",value:function(){if(this.from.row<0&&this.to.row<0)return 0;var r=Math.max(this.from.row,0),n=Math.max(this.to.row,0);return Math.max(r,n)-Math.min(r,n)+1}},{key:"getWidth",value:function(){if(this.from.col<0&&this.to.col<0)return 0;var r=Math.max(this.from.col,0),n=Math.max(this.to.col,0);return Math.max(r,n)-Math.min(r,n)+1}},{key:"getCellsCount",value:function(){return this.getWidth()*this.getHeight()}},{key:"includes",value:function(r){var n=r.row,i=r.col,o=this.getOuterTopStartCorner(),s=this.getOuterBottomEndCorner();return o.row<=n&&s.row>=n&&o.col<=i&&s.col>=i}},{key:"includesRange",value:function(r){return this.includes(r.getOuterTopStartCorner())&&this.includes(r.getOuterBottomEndCorner())}},{key:"isEqual",value:function(r){return Math.min(this.from.row,this.to.row)===Math.min(r.from.row,r.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(r.from.row,r.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(r.from.col,r.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(r.from.col,r.to.col)}},{key:"overlaps",value:function(r){return r.isSouthEastOf(this.getOuterTopLeftCorner())&&r.isNorthWestOf(this.getOuterBottomRightCorner())}},{key:"isSouthEastOf",value:function(r){return this.getOuterTopLeftCorner().isSouthEastOf(r)||this.getOuterBottomRightCorner().isSouthEastOf(r)}},{key:"isNorthWestOf",value:function(r){return this.getOuterTopLeftCorner().isNorthWestOf(r)||this.getOuterBottomRightCorner().isNorthWestOf(r)}},{key:"isOverlappingHorizontally",value:function(r){return this.getOuterTopRightCorner().col>=r.getOuterTopLeftCorner().col&&this.getOuterTopRightCorner().col<=r.getOuterTopRightCorner().col||this.getOuterTopLeftCorner().col<=r.getOuterTopRightCorner().col&&this.getOuterTopLeftCorner().col>=r.getOuterTopLeftCorner().col}},{key:"isOverlappingVertically",value:function(r){return this.getOuterBottomRightCorner().row>=r.getOuterTopRightCorner().row&&this.getOuterBottomRightCorner().row<=r.getOuterBottomRightCorner().row||this.getOuterTopRightCorner().row<=r.getOuterBottomRightCorner().row&&this.getOuterTopRightCorner().row>=r.getOuterTopRightCorner().row}},{key:"expand",value:function(r){var n=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner();return r.row<n.row||r.col<n.col||r.row>i.row||r.col>i.col?(this.from=this._createCellCoords(Math.min(n.row,r.row),Math.min(n.col,r.col)),this.to=this._createCellCoords(Math.max(i.row,r.row),Math.max(i.col,r.col)),!0):!1}},{key:"expandByRange",value:function(r){if(this.includesRange(r)||!this.overlaps(r))return!1;var n=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner(),o=this.getDirection(),s=r.getOuterTopStartCorner(),a=r.getOuterBottomEndCorner(),h=Math.min(n.row,s.row),p=Math.min(n.col,s.col),y=Math.max(i.row,a.row),S=Math.max(i.col,a.col),E=this._createCellCoords(h,p),O=this._createCellCoords(y,S);return this.from=E,this.to=O,this.setDirection(o),this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally(),!0}},{key:"getDirection",value:function(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}},{key:"setDirection",value:function(r){switch(r){case"NW-SE":var n=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];this.from=n[0],this.to=n[1];break;case"NE-SW":var i=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];this.from=i[0],this.to=i[1];break;case"SE-NW":var o=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];this.from=o[0],this.to=o[1];break;case"SW-NE":var s=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];this.from=s[0],this.to=s[1];break}}},{key:"getVerticalDirection",value:function(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}},{key:"getHorizontalDirection",value:function(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}},{key:"flipDirectionVertically",value:function(){var r=this.getDirection();switch(r){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}},{key:"flipDirectionHorizontally",value:function(){var r=this.getDirection();switch(r){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}},{key:"getTopStartCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}},{key:"getTopLeftCorner",value:function(){return tu(this,ks)?this.getTopEndCorner():this.getTopStartCorner()}},{key:"getBottomEndCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}},{key:"getBottomRightCorner",value:function(){return tu(this,ks)?this.getBottomStartCorner():this.getBottomEndCorner()}},{key:"getTopEndCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}},{key:"getTopRightCorner",value:function(){return tu(this,ks)?this.getTopStartCorner():this.getTopEndCorner()}},{key:"getBottomStartCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}},{key:"getBottomLeftCorner",value:function(){return tu(this,ks)?this.getBottomEndCorner():this.getBottomStartCorner()}},{key:"getOuterTopStartCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"getOuterTopLeftCorner",value:function(){return tu(this,ks)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}},{key:"getOuterBottomEndCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getOuterBottomRightCorner",value:function(){return tu(this,ks)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}},{key:"getOuterTopEndCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getOuterTopRightCorner",value:function(){return tu(this,ks)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}},{key:"getOuterBottomStartCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"getOuterBottomLeftCorner",value:function(){return tu(this,ks)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}},{key:"isCorner",value:function(r,n){return n&&n.includes(r)&&(this.getOuterTopLeftCorner().isEqual(this._createCellCoords(n.from.row,n.from.col))||this.getOuterTopRightCorner().isEqual(this._createCellCoords(n.from.row,n.to.col))||this.getOuterBottomLeftCorner().isEqual(this._createCellCoords(n.to.row,n.from.col))||this.getOuterBottomRightCorner().isEqual(this._createCellCoords(n.to.row,n.to.col)))?!0:r.isEqual(this.getOuterTopLeftCorner())||r.isEqual(this.getOuterTopRightCorner())||r.isEqual(this.getOuterBottomLeftCorner())||r.isEqual(this.getOuterBottomRightCorner())}},{key:"getOppositeCorner",value:function(r,n){if(!(r instanceof eA))return!1;if(n){var i=n.from,o=n.to;if(n.includes(r)){if(this.getOuterTopStartCorner().isEqual(this._createCellCoords(i.row,i.col)))return this.getOuterBottomEndCorner();if(this.getOuterTopEndCorner().isEqual(this._createCellCoords(i.row,o.col)))return this.getOuterBottomStartCorner();if(this.getOuterBottomStartCorner().isEqual(this._createCellCoords(o.row,i.col)))return this.getOuterTopEndCorner();if(this.getOuterBottomEndCorner().isEqual(this._createCellCoords(o.row,o.col)))return this.getOuterTopStartCorner()}}if(r.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(r.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(r.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(r.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}},{key:"getBordersSharedWith",value:function(r){if(!this.includesRange(r))return[];var n={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},i={top:Math.min(r.from.row,r.to.row),bottom:Math.max(r.from.row,r.to.row),left:Math.min(r.from.col,r.to.col),right:Math.max(r.from.col,r.to.col)},o=[];return n.top===i.top&&o.push("top"),n.right===i.right&&o.push("right"),n.bottom===i.bottom&&o.push("bottom"),n.left===i.left&&o.push("left"),o}},{key:"getInner",value:function(){for(var r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),i=[],o=r.row;o<=n.row;o++)for(var s=r.col;s<=n.col;s++)!(this.from.row===o&&this.from.col===s)&&!(this.to.row===o&&this.to.col===s)&&i.push(this._createCellCoords(o,s));return i}},{key:"getAll",value:function(){for(var r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),i=[],o=r.row;o<=n.row;o++)for(var s=r.col;s<=n.col;s++)r.row===o&&r.col===s?i.push(r):n.row===o&&n.col===s?i.push(n):i.push(this._createCellCoords(o,s));return i}},{key:"forAll",value:function(r){for(var n=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner(),o=n.row;o<=i.row;o++)for(var s=n.col;s<=i.col;s++){var a=r(o,s);if(a===!1)return}}},{key:"clone",value:function(){return new e(this.highlight,this.from,this.to,tu(this,ks))}},{key:"toObject",value:function(){return{from:this.from.toObject(),to:this.to.toObject()}}},{key:"_createCellCoords",value:function(r,n){return new eA(r,n,tu(this,ks))}}]),e}();const BU=SYe;function G1(e){"@babel/helpers - typeof";return G1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},G1(e)}function xYe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function z7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,EYe(n.key),n)}}function CYe(e,t,r){return t&&z7(e.prototype,t),r&&z7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function EYe(e){var t=TYe(e,"string");return G1(t)==="symbol"?t:String(t)}function TYe(e,t){if(G1(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(G1(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ry=new WeakMap,OYe=function(){function e(t,r,n,i,o,s){var a=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;xYe(this,e),this.wtSettings=n,this.domBindings=r,this.wtTable=o,this.selections=s,this.parent=a,this.eventManager=i,this.facadeGetter=t,ry.set(this,{selectedCellBeforeTouchEnd:void 0,dblClickTimeout:[null,null],dblClickOrigin:[null,null]}),this.registerEvents()}return CYe(e,[{key:"registerEvents",value:function(){var r=this;this.eventManager.addEventListener(this.wtTable.holder,"contextmenu",function(o){return r.onContextMenu(o)}),this.eventManager.addEventListener(this.wtTable.TABLE,"mouseover",function(o){return r.onMouseOver(o)}),this.eventManager.addEventListener(this.wtTable.TABLE,"mouseout",function(o){return r.onMouseOut(o)});var n=function(){r.eventManager.addEventListener(r.wtTable.holder,"touchstart",function(s){return r.onTouchStart(s)}),r.eventManager.addEventListener(r.wtTable.holder,"touchend",function(s){return r.onTouchEnd(s)}),r.momentumScrolling||(r.momentumScrolling={}),r.eventManager.addEventListener(r.wtTable.holder,"scroll",function(){clearTimeout(r.momentumScrolling._timeout),r.momentumScrolling.ongoing||r.wtSettings.getSetting("onBeforeTouchScroll"),r.momentumScrolling.ongoing=!0,r.momentumScrolling._timeout=setTimeout(function(){r.touchApplied||(r.momentumScrolling.ongoing=!1,r.wtSettings.getSetting("onAfterMomentumScroll"))},200)})},i=function(){r.eventManager.addEventListener(r.wtTable.holder,"mouseup",function(s){return r.onMouseUp(s)}),r.eventManager.addEventListener(r.wtTable.holder,"mousedown",function(s){return r.onMouseDown(s)})};gu()?n():(zue()&&n(),i())}},{key:"selectedCellWasTouched",value:function(r){var n=ry.get(this),i=this.parentCell(r),o=i.coords;if(n.selectedCellBeforeTouchEnd&&o){var s=[o.row,n.selectedCellBeforeTouchEnd.from.row],a=s[0],h=s[1],p=[o.col,n.selectedCellBeforeTouchEnd.from.col],y=p[0],S=p[1];return a===h&&y===S}return!1}},{key:"parentCell",value:function(r){var n={},i=this.wtTable.TABLE,o=mR(r,["TD","TH"],i);return o?(n.coords=this.wtTable.getCoords(o),n.TD=o):Wr(r,"wtBorder")&&Wr(r,"current")?(n.coords=this.selections.getCell().cellRange.highlight,n.TD=this.wtTable.getCell(n.coords)):Wr(r,"wtBorder")&&Wr(r,"area")&&this.selections.createOrGetArea().cellRange&&(n.coords=this.selections.createOrGetArea().cellRange.to,n.TD=this.wtTable.getCell(n.coords)),n}},{key:"onMouseDown",value:function(r){var n=ry.get(this),i=this.domBindings.rootDocument.activeElement,o=rce(_Ue,r.target),s=r.target;if(!(s===i||o(0)===i||o(1)===i)){var a=this.parentCell(s);Wr(s,"corner")?this.wtSettings.getSetting("onCellCornerMouseDown",r,s):a.TD&&this.wtSettings.has("onCellMouseDown")&&this.callListener("onCellMouseDown",r,a.coords,a.TD),(r.button===0||this.touchApplied)&&a.TD&&(n.dblClickOrigin[0]=a.TD,clearTimeout(n.dblClickTimeout[0]),n.dblClickTimeout[0]=setTimeout(function(){n.dblClickOrigin[0]=null},1e3))}}},{key:"onContextMenu",value:function(r){if(this.wtSettings.has("onCellContextMenu")){var n=this.parentCell(r.target);n.TD&&this.callListener("onCellContextMenu",r,n.coords,n.TD)}}},{key:"onMouseOver",value:function(r){if(this.wtSettings.has("onCellMouseOver")){var n=this.wtTable.TABLE,i=mR(r.target,["TD","TH"],n),o=this.parent||this;i&&i!==o.lastMouseOver&&tm(i,n)&&(o.lastMouseOver=i,this.callListener("onCellMouseOver",r,this.wtTable.getCoords(i),i))}}},{key:"onMouseOut",value:function(r){if(this.wtSettings.has("onCellMouseOut")){var n=this.wtTable.TABLE,i=mR(r.target,["TD","TH"],n),o=mR(r.relatedTarget,["TD","TH"],n);i&&i!==o&&tm(i,n)&&this.callListener("onCellMouseOut",r,this.wtTable.getCoords(i),i)}}},{key:"onMouseUp",value:function(r){var n=ry.get(this),i=this.parentCell(r.target);i.TD&&this.wtSettings.has("onCellMouseUp")&&this.callListener("onCellMouseUp",r,i.coords,i.TD),!(r.button!==0&&!this.touchApplied)&&(i.TD===n.dblClickOrigin[0]&&i.TD===n.dblClickOrigin[1]?(Wr(r.target,"corner")?this.callListener("onCellCornerDblClick",r,i.coords,i.TD):this.callListener("onCellDblClick",r,i.coords,i.TD),n.dblClickOrigin[0]=null,n.dblClickOrigin[1]=null):i.TD===n.dblClickOrigin[0]&&(n.dblClickOrigin[1]=i.TD,clearTimeout(n.dblClickTimeout[1]),n.dblClickTimeout[1]=setTimeout(function(){n.dblClickOrigin[1]=null},500)))}},{key:"onTouchStart",value:function(r){var n=ry.get(this);n.selectedCellBeforeTouchEnd=this.selections.getCell().cellRange,this.touchApplied=!0,this.onMouseDown(r)}},{key:"onTouchEnd",value:function(r){var n,i=r.target,o=(n=this.parentCell(i))===null||n===void 0?void 0:n.coords,s=pr(o)&&o.row>=0&&o.col>=0,a=r.cancelable&&s&&this.wtSettings.getSetting("isDataViewInstance");if(a){var h=["A","BUTTON","INPUT"];$ue()&&(W3e()||G3e())&&this.selectedCellWasTouched(i)&&!h.includes(i.tagName)?r.preventDefault():this.selectedCellWasTouched(i)||r.preventDefault()}this.onMouseUp(r),this.touchApplied=!1}},{key:"callListener",value:function(r,n,i,o){var s=this.wtSettings.getSettingPure(r);s&&s(n,i,o,this.facadeGetter())}},{key:"destroy",value:function(){var r=ry.get(this);clearTimeout(r.dblClickTimeout[0]),clearTimeout(r.dblClickTimeout[1]),this.eventManager.destroy()}}]),e}();const jce=OYe;function Y1(e){"@babel/helpers - typeof";return Y1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Y1(e)}function RYe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function H7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,PYe(n.key),n)}}function kYe(e,t,r){return t&&H7(e.prototype,t),r&&H7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function PYe(e){var t=AYe(e,"string");return Y1(t)==="symbol"?t:String(t)}function AYe(e,t){if(Y1(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Y1(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var IYe=function(){function e(t,r,n){RYe(this,e),this.offset=t,this.total=r,this.countTH=n}return kYe(e,[{key:"offsetted",value:function(r){return r+this.offset}},{key:"unOffsetted",value:function(r){return r-this.offset}},{key:"renderedToSource",value:function(r){return this.offsetted(r)}},{key:"sourceToRendered",value:function(r){return this.unOffsetted(r)}},{key:"offsettedTH",value:function(r){return r-this.countTH}},{key:"unOffsettedTH",value:function(r){return r+this.countTH}},{key:"visibleRowHeadedColumnToSourceColumn",value:function(r){return this.renderedToSource(this.offsettedTH(r))}},{key:"sourceColumnToVisibleRowHeadedColumn",value:function(r){return this.unOffsettedTH(this.sourceToRendered(r))}}]),e}();const MYe=IYe;function K1(e){"@babel/helpers - typeof";return K1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},K1(e)}function $Ye(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function V7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,LYe(n.key),n)}}function DYe(e,t,r){return t&&V7(e.prototype,t),r&&V7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function LYe(e){var t=NYe(e,"string");return K1(t)==="symbol"?t:String(t)}function NYe(e,t){if(K1(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(K1(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var BYe=function(){function e(t,r,n){$Ye(this,e),this.offset=t,this.total=r,this.countTH=n}return DYe(e,[{key:"offsetted",value:function(r){return r+this.offset}},{key:"unOffsetted",value:function(r){return r-this.offset}},{key:"renderedToSource",value:function(r){return this.offsetted(r)}},{key:"sourceToRendered",value:function(r){return this.unOffsetted(r)}},{key:"offsettedTH",value:function(r){return r-this.countTH}},{key:"unOffsettedTH",value:function(r){return r+this.countTH}},{key:"visibleColHeadedRowToSourceRow",value:function(r){return this.renderedToSource(this.offsettedTH(r))}},{key:"sourceRowToVisibleColHeadedRow",value:function(r){return this.unOffsettedTH(this.sourceToRendered(r))}}]),e}();const jYe=BYe;var FYe=0,tA=1,rA=2;function q1(e){"@babel/helpers - typeof";return q1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},q1(e)}function zYe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function U7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,VYe(n.key),n)}}function HYe(e,t,r){return t&&U7(e.prototype,t),r&&U7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function VYe(e){var t=UYe(e,"string");return q1(t)==="symbol"?t:String(t)}function UYe(e,t){if(q1(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(q1(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var W7=function(){function e(){zYe(this,e),this.currentSize=0,this.nextSize=0,this.currentOffset=0,this.nextOffset=0}return HYe(e,[{key:"setSize",value:function(r){this.currentSize=this.nextSize,this.nextSize=r}},{key:"setOffset",value:function(r){this.currentOffset=this.nextOffset,this.nextOffset=r}}]),e}();function X1(e){"@babel/helpers - typeof";return X1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},X1(e)}function WYe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function G7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,YYe(n.key),n)}}function GYe(e,t,r){return t&&G7(e.prototype,t),r&&G7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function YYe(e){var t=KYe(e,"string");return X1(t)==="symbol"?t:String(t)}function KYe(e,t){if(X1(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(X1(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var qYe=function(){function e(){WYe(this,e),this.size=new W7,this.workingSpace=FYe,this.sharedSize=null}return GYe(e,[{key:"setSize",value:function(r){this.size.setSize(r)}},{key:"setOffset",value:function(r){this.size.setOffset(r)}},{key:"getViewSize",value:function(){return this.size}},{key:"isShared",value:function(){return this.sharedSize instanceof W7}},{key:"isPlaceOn",value:function(r){return this.workingSpace===r}},{key:"append",value:function(r){this.workingSpace=tA,r.workingSpace=rA,this.sharedSize=r.getViewSize()}},{key:"prepend",value:function(r){this.workingSpace=rA,r.workingSpace=tA,this.sharedSize=r.getViewSize()}}]),e}();function Z1(e){"@babel/helpers - typeof";return Z1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Z1(e)}function XYe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Y7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,JYe(n.key),n)}}function ZYe(e,t,r){return t&&Y7(e.prototype,t),r&&Y7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function JYe(e){var t=QYe(e,"string");return Z1(t)==="symbol"?t:String(t)}function QYe(e,t){if(Z1(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Z1(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Fce=function(){function e(t,r,n){XYe(this,e),this.rootNode=t,this.nodesPool=r,this.sizeSet=new qYe,this.childNodeType=n.toUpperCase(),this.visualIndex=0,this.collectedNodes=[]}return ZYe(e,[{key:"setSize",value:function(r){return this.sizeSet.setSize(r),this}},{key:"setOffset",value:function(r){return this.sizeSet.setOffset(r),this}},{key:"isSharedViewSet",value:function(){return this.sizeSet.isShared()}},{key:"getNode",value:function(r){return r<this.collectedNodes.length?this.collectedNodes[r]:null}},{key:"getCurrentNode",value:function(){var r=this.collectedNodes.length;return r>0?this.collectedNodes[r-1]:null}},{key:"getRenderedChildCount",value:function(){var r=this.rootNode,n=this.sizeSet,i=0;if(this.isSharedViewSet())for(var o=r.firstElementChild;o;){if(o.tagName===this.childNodeType)i+=1;else if(n.isPlaceOn(tA))break;o=o.nextElementSibling}else i=r.childElementCount;return i}},{key:"start",value:function(){this.collectedNodes.length=0,this.visualIndex=0;for(var r=this.rootNode,n=this.sizeSet,i=this.isSharedViewSet(),o=n.getViewSize(),s=o.nextSize,a=this.getRenderedChildCount();a<s;){var h=this.nodesPool();!i||i&&n.isPlaceOn(rA)?r.appendChild(h):r.insertBefore(h,r.firstChild),a+=1}for(var p=i&&n.isPlaceOn(tA);a>s;)r.removeChild(p?r.firstChild:r.lastChild),a-=1}},{key:"render",value:function(){var r=this.rootNode,n=this.sizeSet,i=this.visualIndex;this.isSharedViewSet()&&n.isPlaceOn(rA)&&(i+=n.sharedSize.nextSize);var o=r.childNodes[i];if(o.tagName!==this.childNodeType){var s=this.nodesPool();r.replaceChild(s,o),o=s}this.collectedNodes.push(o),this.visualIndex+=1}},{key:"end",value:function(){}}]),e}();function Qv(e){"@babel/helpers - typeof";return Qv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qv(e)}function eKe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function K7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,rKe(n.key),n)}}function tKe(e,t,r){return t&&K7(e.prototype,t),r&&K7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function rKe(e){var t=nKe(e,"string");return Qv(t)==="symbol"?t:String(t)}function nKe(e,t){if(Qv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Qv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function iKe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&tF(e,t)}function tF(e,t){return tF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},tF(e,t)}function oKe(e){var t=lKe();return function(){var n=nA(e),i;if(t){var o=nA(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return aKe(this,i)}}function aKe(e,t){if(t&&(Qv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return sKe(e)}function sKe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function lKe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function nA(e){return nA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},nA(e)}var zce=function(e){iKe(r,e);var t=oKe(r);function r(){return eKe(this,r),t.apply(this,arguments)}return tKe(r,[{key:"prependView",value:function(i){return this.sizeSet.prepend(i.sizeSet),i.sizeSet.append(this.sizeSet),this}},{key:"appendView",value:function(i){return this.sizeSet.append(i.sizeSet),i.sizeSet.prepend(this.sizeSet),this}}]),r}(Fce);function J1(e){"@babel/helpers - typeof";return J1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},J1(e)}function uKe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function q7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,fKe(n.key),n)}}function cKe(e,t,r){return t&&q7(e.prototype,t),r&&q7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function fKe(e){var t=hKe(e,"string");return J1(t)==="symbol"?t:String(t)}function hKe(e,t){if(J1(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(J1(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var dKe=function(){function e(t){uKe(this,e),this.nodeType=t.toUpperCase()}return cKe(e,[{key:"setRootDocument",value:function(r){this.rootDocument=r}},{key:"obtain",value:function(){return this.rootDocument.createElement(this.nodeType)}}]),e}();function Q1(e){"@babel/helpers - typeof";return Q1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Q1(e)}function pKe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function X7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,gKe(n.key),n)}}function mKe(e,t,r){return t&&X7(e.prototype,t),r&&X7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function gKe(e){var t=yKe(e,"string");return Q1(t)==="symbol"?t:String(t)}function yKe(e,t){if(Q1(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Q1(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var TE=function(){function e(t,r){pKe(this,e),this.nodesPool=typeof t=="string"?new dKe(t):null,this.nodeType=t,this.rootNode=r,this.table=null,this.renderedNodes=0}return mKe(e,[{key:"setTable",value:function(r){this.nodesPool&&this.nodesPool.setRootDocument(r.rootDocument),this.table=r}},{key:"adjust",value:function(){}},{key:"render",value:function(){}}]),e}();function e_(e){"@babel/helpers - typeof";return e_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},e_(e)}function vKe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Z7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,bKe(n.key),n)}}function _Ke(e,t,r){return t&&Z7(e.prototype,t),r&&Z7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function bKe(e){var t=wKe(e,"string");return e_(t)==="symbol"?t:String(t)}function wKe(e,t){if(e_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(e_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function SKe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&rF(e,t)}function rF(e,t){return rF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},rF(e,t)}function xKe(e){var t=TKe();return function(){var n=iA(e),i;if(t){var o=iA(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return CKe(this,i)}}function CKe(e,t){if(t&&(e_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return EKe(e)}function EKe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function TKe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function iA(e){return iA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},iA(e)}var OKe=function(e){SKe(r,e);var t=xKe(r);function r(){var n;return vKe(this,r),n=t.call(this,"TH"),n.orderViews=new WeakMap,n.sourceRowIndex=0,n}return _Ke(r,[{key:"obtainOrderView",value:function(i){var o=this,s;return this.orderViews.has(i)?s=this.orderViews.get(i):(s=new zce(i,function(a){return o.nodesPool.obtain(o.sourceRowIndex,a)},this.nodeType),this.orderViews.set(i,s)),s}},{key:"render",value:function(){for(var i=this.table,o=i.rowsToRender,s=i.rowHeaderFunctions,a=i.rowHeadersCount,h=i.rows,p=i.cells,y=0;y<o;y++){var S=this.table.renderedRowToSource(y),E=h.getRenderedNode(y);this.sourceRowIndex=S;var O=this.obtainOrderView(E),A=p.obtainOrderView(E);O.appendView(A).setSize(a).setOffset(this.table.renderedColumnToSource(0)).start();for(var $=0;$<a;$++){O.render();var B=O.getCurrentNode();B.className="",B.removeAttribute("style"),s[$](S,B,$)}O.end()}}}]),r}(TE);function t_(e){"@babel/helpers - typeof";return t_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t_(e)}function RKe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function J7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,PKe(n.key),n)}}function kKe(e,t,r){return t&&J7(e.prototype,t),r&&J7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function PKe(e){var t=AKe(e,"string");return t_(t)==="symbol"?t:String(t)}function AKe(e,t){if(t_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(t_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function IKe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&nF(e,t)}function nF(e,t){return nF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},nF(e,t)}function MKe(e){var t=LKe();return function(){var n=oA(e),i;if(t){var o=oA(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return $Ke(this,i)}}function $Ke(e,t){if(t&&(t_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return DKe(e)}function DKe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function LKe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function oA(e){return oA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},oA(e)}var NKe=function(e){IKe(r,e);var t=MKe(r);function r(n){return RKe(this,r),t.call(this,null,n)}return kKe(r,[{key:"adjust",value:function(){var i=this.table,o=i.columnHeadersCount,s=i.rowHeadersCount,a=this.rootNode.firstChild;if(o){for(var h=this.table.columnsToRender,p=h+s,y=0,S=o;y<S;y++){for(a=this.rootNode.childNodes[y],a||(a=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(a)),this.renderedNodes=a.childNodes.length;this.renderedNodes<p;)a.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>p;)a.removeChild(a.lastChild),this.renderedNodes-=1}var E=this.rootNode.childNodes.length;if(E>o)for(var O=o;O<E;O++)this.rootNode.removeChild(this.rootNode.lastChild)}else a&&Eu(a)}},{key:"render",value:function(){for(var i=this.table.columnHeadersCount,o=0;o<i;o+=1)for(var s=this.table,a=s.columnHeaderFunctions,h=s.columnsToRender,p=s.rowHeadersCount,y=this.rootNode.childNodes[o],S=-1*p;S<h;S+=1){var E=this.table.renderedColumnToSource(S),O=y.childNodes[S+p];O.className="",O.removeAttribute("style"),a[o](E,O,o)}}}]),r}(TE);function r_(e){"@babel/helpers - typeof";return r_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r_(e)}function BKe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Q7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,FKe(n.key),n)}}function jKe(e,t,r){return t&&Q7(e.prototype,t),r&&Q7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function FKe(e){var t=zKe(e,"string");return r_(t)==="symbol"?t:String(t)}function zKe(e,t){if(r_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(r_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function HKe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&iF(e,t)}function iF(e,t){return iF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},iF(e,t)}function VKe(e){var t=GKe();return function(){var n=aA(e),i;if(t){var o=aA(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return UKe(this,i)}}function UKe(e,t){if(t&&(r_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return WKe(e)}function WKe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function GKe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function aA(e){return aA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},aA(e)}var YKe=function(e){HKe(r,e);var t=VKe(r);function r(n){return BKe(this,r),t.call(this,null,n)}return jKe(r,[{key:"adjust",value:function(){for(var i=this.table,o=i.columnsToRender,s=i.rowHeadersCount,a=o+s;this.renderedNodes<a;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>a;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}},{key:"render",value:function(){this.adjust();for(var i=this.table,o=i.columnsToRender,s=i.rowHeadersCount,a=0;a<s;a++){var h=this.table.renderedColumnToSource(a),p=this.table.columnUtils.getHeaderWidth(h);this.rootNode.childNodes[a].style.width="".concat(p,"px")}for(var y=0;y<o;y++){var S=this.table.renderedColumnToSource(y),E=this.table.columnUtils.getStretchedColumnWidth(S);this.rootNode.childNodes[y+s].style.width="".concat(E,"px")}var O=this.rootNode.firstChild;O&&Vt(O,"rowHeader")}}]),r}(TE);function n_(e){"@babel/helpers - typeof";return n_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n_(e)}var eX;function KKe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function qKe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function tX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ZKe(n.key),n)}}function XKe(e,t,r){return t&&tX(e.prototype,t),r&&tX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ZKe(e){var t=JKe(e,"string");return n_(t)==="symbol"?t:String(t)}function JKe(e,t){if(n_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(n_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function QKe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&oF(e,t)}function oF(e,t){return oF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},oF(e,t)}function eqe(e){var t=nqe();return function(){var n=sA(e),i;if(t){var o=sA(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return tqe(this,i)}}function tqe(e,t){if(t&&(n_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return rqe(e)}function rqe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function nqe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function sA(e){return sA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},sA(e)}var rX=!1,iqe=function(e){QKe(r,e);var t=eqe(r);function r(n){var i;return qKe(this,r),i=t.call(this,"TR",n),i.orderView=new Fce(n,function(o){return i.nodesPool.obtain(o)},i.nodeType),i}return XKe(r,[{key:"getRenderedNode",value:function(i){return this.orderView.getNode(i)}},{key:"render",value:function(){var i=this.table.rowsToRender;!rX&&i>1e3&&(rX=!0,ni(Jn(eX||(eX=KKe([`Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting 
        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.`],[`Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting\\x20
        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.`]))))),this.orderView.setSize(i).setOffset(this.table.renderedRowToSource(0)).start();for(var o=0;o<i;o++)this.orderView.render();this.orderView.end()}}]),r}(TE);function i_(e){"@babel/helpers - typeof";return i_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i_(e)}function oqe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function nX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,sqe(n.key),n)}}function aqe(e,t,r){return t&&nX(e.prototype,t),r&&nX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function sqe(e){var t=lqe(e,"string");return i_(t)==="symbol"?t:String(t)}function lqe(e,t){if(i_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(i_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function uqe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&aF(e,t)}function aF(e,t){return aF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},aF(e,t)}function cqe(e){var t=dqe();return function(){var n=lA(e),i;if(t){var o=lA(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return fqe(this,i)}}function fqe(e,t){if(t&&(i_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return hqe(e)}function hqe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function dqe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function lA(e){return lA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},lA(e)}var pqe=function(e){uqe(r,e);var t=cqe(r);function r(){var n;return oqe(this,r),n=t.call(this,"TD"),n.orderViews=new WeakMap,n.sourceRowIndex=0,n}return aqe(r,[{key:"obtainOrderView",value:function(i){var o=this,s;return this.orderViews.has(i)?s=this.orderViews.get(i):(s=new zce(i,function(a){return o.nodesPool.obtain(o.sourceRowIndex,a)},this.nodeType),this.orderViews.set(i,s)),s}},{key:"render",value:function(){for(var i=this.table,o=i.rowsToRender,s=i.columnsToRender,a=i.rows,h=i.rowHeaders,p=0;p<o;p++){var y=this.table.renderedRowToSource(p),S=a.getRenderedNode(p);this.sourceRowIndex=y;var E=this.obtainOrderView(S),O=h.obtainOrderView(S);E.prependView(O).setSize(s).setOffset(this.table.renderedColumnToSource(0)).start();for(var A=0;A<s;A++){E.render();var $=E.getCurrentNode(),B=this.table.renderedColumnToSource(A);Wr($,"hide")||($.className=""),$.removeAttribute("style"),$.removeAttribute("dir"),this.table.cellRenderer(y,B,$)}E.end()}}}]),r}(TE);function ex(e){"@babel/helpers - typeof";return ex=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ex(e)}function mqe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function iX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,yqe(n.key),n)}}function gqe(e,t,r){return t&&iX(e.prototype,t),r&&iX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function yqe(e){var t=vqe(e,"string");return ex(t)==="symbol"?t:String(t)}function vqe(e,t){if(ex(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ex(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var _qe=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=r.cellRenderer;mqe(this,e),this.rootNode=t,this.rootDocument=this.rootNode.ownerDocument,this.rowHeaders=null,this.columnHeaders=null,this.colGroup=null,this.rows=null,this.cells=null,this.rowFilter=null,this.columnFilter=null,this.rowUtils=null,this.columnUtils=null,this.rowsToRender=0,this.columnsToRender=0,this.rowHeaderFunctions=[],this.rowHeadersCount=0,this.columnHeaderFunctions=[],this.columnHeadersCount=0,this.cellRenderer=n}return gqe(e,[{key:"setAxisUtils",value:function(r,n){this.rowUtils=r,this.columnUtils=n}},{key:"setViewportSize",value:function(r,n){this.rowsToRender=r,this.columnsToRender=n}},{key:"setFilters",value:function(r,n){this.rowFilter=r,this.columnFilter=n}},{key:"setHeaderContentRenderers",value:function(r,n){this.rowHeaderFunctions=r,this.rowHeadersCount=r.length,this.columnHeaderFunctions=n,this.columnHeadersCount=n.length}},{key:"setRenderers",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=r.rowHeaders,i=r.columnHeaders,o=r.colGroup,s=r.rows,a=r.cells;n.setTable(this),i.setTable(this),o.setTable(this),s.setTable(this),a.setTable(this),this.rowHeaders=n,this.columnHeaders=i,this.colGroup=o,this.rows=s,this.cells=a}},{key:"renderedRowToSource",value:function(r){return this.rowFilter.renderedToSource(r)}},{key:"renderedColumnToSource",value:function(r){return this.columnFilter.renderedToSource(r)}},{key:"render",value:function(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();for(var r=this.rowsToRender,n=this.rows,i=0;i<r;i++){var o=n.getRenderedNode(i);if(o.firstChild){var s=this.renderedRowToSource(i),a=this.rowUtils.getHeight(s);a?o.firstChild.style.height="".concat(a-1,"px"):o.firstChild.style.height=""}}}}]),e}();function tx(e){"@babel/helpers - typeof";return tx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tx(e)}function bqe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function oX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Sqe(n.key),n)}}function wqe(e,t,r){return t&&oX(e.prototype,t),r&&oX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Sqe(e){var t=xqe(e,"string");return tx(t)==="symbol"?t:String(t)}function xqe(e,t){if(tx(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(tx(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Cqe=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.TABLE,n=t.THEAD,i=t.COLGROUP,o=t.TBODY,s=t.rowUtils,a=t.columnUtils,h=t.cellRenderer;bqe(this,e),this.renderer=new _qe(r,{cellRenderer:h}),this.renderer.setRenderers({rowHeaders:new OKe,columnHeaders:new NKe(n),colGroup:new YKe(i),rows:new iqe(o),cells:new pqe}),this.renderer.setAxisUtils(s,a)}return wqe(e,[{key:"setFilters",value:function(r,n){return this.renderer.setFilters(r,n),this}},{key:"setViewportSize",value:function(r,n){return this.renderer.setViewportSize(r,n),this}},{key:"setHeaderContentRenderers",value:function(r,n){return this.renderer.setHeaderContentRenderers(r,n),this}},{key:"adjust",value:function(){this.renderer.adjust()}},{key:"render",value:function(){this.renderer.render()}}]),e}();function rx(e){"@babel/helpers - typeof";return rx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rx(e)}function Eqe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function aX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Oqe(n.key),n)}}function Tqe(e,t,r){return t&&aX(e.prototype,t),r&&aX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Oqe(e){var t=Rqe(e,"string");return rx(t)==="symbol"?t:String(t)}function Rqe(e,t){if(rx(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(rx(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var kqe=function(){function e(t,r){Eqe(this,e),this.dataAccessObject=t,this.wtSettings=r,this.headerWidths=new Map}return Tqe(e,[{key:"getWidth",value:function(r){return this.wtSettings.getSetting("columnWidth",r)||this.wtSettings.getSetting("defaultColumnWidth")}},{key:"getStretchedColumnWidth",value:function(r){var n=this.dataAccessObject.wtViewport.columnsRenderCalculator,i=this.getWidth(r);if(n){var o=n.getStretchedColumnWidth(r,i);o&&(i=o)}return i}},{key:"getHeaderHeight",value:function(r){var n=this.wtSettings.getSetting("defaultRowHeight"),i=this.dataAccessObject.wtViewport.oversizedColumnHeaders[r];return i!==void 0&&(n=n?Math.max(n,i):i),n}},{key:"getHeaderWidth",value:function(r){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(r))}},{key:"calculateWidths",value:function(){var r=this.wtSettings,n=this.dataAccessObject,i=n.wtTable,o=n.wtViewport,s=n.cloneSource,a=s?s.wtTable.holder:i.holder,h=a.offsetHeight<a.scrollHeight?Mo():0,p=r.getSetting("rowHeaderWidth");if(o.columnsRenderCalculator.refreshStretching(o.getViewportWidth()-h),p=r.getSetting("onModifyRowHeaderWidth",p),p!=null)for(var y=r.getSetting("rowHeaders").length,S=r.getSetting("defaultColumnWidth"),E=0;E<y;E++){var O=Array.isArray(p)?p[E]:p;O=O??S,this.headerWidths.set(E,O)}}}]),e}();function nx(e){"@babel/helpers - typeof";return nx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nx(e)}function Pqe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function sX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Iqe(n.key),n)}}function Aqe(e,t,r){return t&&sX(e.prototype,t),r&&sX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Iqe(e){var t=Mqe(e,"string");return nx(t)==="symbol"?t:String(t)}function Mqe(e,t){if(nx(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(nx(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var $qe=function(){function e(t,r){Pqe(this,e),this.dataAccessObject=t,this.wtSettings=r}return Aqe(e,[{key:"getHeight",value:function(r){var n=this.wtSettings.getSetting("rowHeight",r),i=this.dataAccessObject.wtViewport.oversizedRows[r];return i!==void 0&&(n=n===void 0?i:Math.max(n,i)),n}}]),e}();function ix(e){"@babel/helpers - typeof";return ix=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ix(e)}function Dqe(e){return Bqe(e)||Nqe(e)||Hce(e)||Lqe()}function Lqe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Nqe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Bqe(e){if(Array.isArray(e))return sF(e)}function jqe(e,t){return Hqe(e)||zqe(e,t)||Hce(e,t)||Fqe()}function Fqe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Hce(e,t){if(e){if(typeof e=="string")return sF(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return sF(e,t)}}function sF(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function zqe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],h=!0,p=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;h=!1}else for(;!(h=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);h=!0);}catch(y){p=!0,i=y}finally{try{if(!h&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(p)throw i}}return a}}function Hqe(e){if(Array.isArray(e))return e}function Vqe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function lX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Vce(n.key),n)}}function Uqe(e,t,r){return t&&lX(e.prototype,t),r&&lX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ru(e,t,r){return t=Vce(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Vce(e){var t=Wqe(e,"string");return ix(t)==="symbol"?t:String(t)}function Wqe(e,t){if(ix(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ix(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Gqe=function(){function e(t,r,n,i,o){var s=this;Vqe(this,e),ru(this,"wtSettings",null),ru(this,"domBindings",void 0),ru(this,"TBODY",null),ru(this,"THEAD",null),ru(this,"COLGROUP",null),ru(this,"hasTableHeight",!0),ru(this,"hasTableWidth",!0),ru(this,"isTableVisible",!1),ru(this,"tableOffset",0),ru(this,"holderOffset",0),this.domBindings=n,this.isMaster=o==="master",this.name=o,this.dataAccessObject=t,this.facadeGetter=r,this.wtSettings=i,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=n.rootTable,Kue(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;var a=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",function(){return s._modifyRowHeaderWidth(a)}),this.rowUtils=new $qe(this.dataAccessObject,this.wtSettings),this.columnUtils=new kqe(this.dataAccessObject,this.wtSettings),this.tableRenderer=new Cqe({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer")})}return Uqe(e,[{key:"is",value:function(r){return this.name===r}},{key:"fixTableDomTree",value:function(){var r=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=r.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=r.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=r.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}},{key:"createSpreader",value:function(r){var n=r.parentNode,i;return(!n||n.nodeType!==Node.ELEMENT_NODE||!Wr(n,"wtHolder"))&&(i=this.domBindings.rootDocument.createElement("div"),i.className="wtSpreader",n&&n.insertBefore(i,r),i.appendChild(r)),i.style.position="relative",i}},{key:"createHider",value:function(r){var n=r.parentNode,i;return(!n||n.nodeType!==Node.ELEMENT_NODE||!Wr(n,"wtHolder"))&&(i=this.domBindings.rootDocument.createElement("div"),i.className="wtHider",n&&n.insertBefore(i,r),i.appendChild(r)),i}},{key:"createHolder",value:function(r){var n=r.parentNode,i;return(!n||n.nodeType!==Node.ELEMENT_NODE||!Wr(n,"wtHolder"))&&(i=this.domBindings.rootDocument.createElement("div"),i.style.position="relative",i.className="wtHolder",n&&n.insertBefore(i,r),this.isMaster&&(i.parentNode.className+="ht_master handsontable",i.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr")),i.appendChild(r)),i}},{key:"draw",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.wtSettings,i=this.dataAccessObject,o=i.wtOverlays,s=i.wtViewport,a=n.getSetting("totalRows"),h=n.getSetting("totalColumns"),p=n.getSetting("rowHeaders"),y=p.length,S=n.getSetting("columnHeaders"),E=S.length,O=!1,A=r;if(this.isMaster&&(this.holderOffset=ao(this.holder),A=s.createRenderCalculators(A),y&&!n.getSetting("fixedColumnsStart"))){var $=o.inlineStartOverlay.getScrollPosition(),B=this.correctHeaderWidth;this.correctHeaderWidth=$!==0,B!==this.correctHeaderWidth&&(A=!1)}if(this.isMaster&&(O=o.updateStateOfRendering()),A)this.isMaster&&s.createVisibleCalculators(),o&&o.refresh(!0);else{this.isMaster?this.tableOffset=ao(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;var j=a>0?this.getFirstRenderedRow():0,z=h>0?this.getFirstRenderedColumn():0;this.rowFilter=new jYe(j,a,E),this.columnFilter=new MYe(z,h,y);var W=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();var Q={};this.wtSettings.getSetting("beforeDraw",!0,Q),W=Q.skipRender!==!0}if(W){this.tableRenderer.setHeaderContentRenderers(p,S),(this.is(mu)||this.is(Ch))&&this.tableRenderer.setHeaderContentRenderers(p,[]),this.resetOversizedRows(),this.tableRenderer.setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render();var q;if(this.isMaster&&(q=this.dataAccessObject.workspaceWidth,this.dataAccessObject.wtViewport.containerWidth=null,this.markOversizedColumnHeaders()),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(mu))&&this.markOversizedRows(),this.isMaster){this.dataAccessObject.wtViewport.createVisibleCalculators(),this.dataAccessObject.wtOverlays.refresh(!1),this.dataAccessObject.wtOverlays.applyToDOM();var Se=ii(this.hider),Ie=ii(this.TABLE);Se!==0&&Ie!==Se&&(this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),q!==this.dataAccessObject.wtViewport.getWorkspaceWidth()&&(this.dataAccessObject.wtViewport.containerWidth=null,this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),this.wtSettings.getSetting("onDraw",!0)}else this.is(mu)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize()}}var He=!1;return this.isMaster&&(He=o.topOverlay.resetFixedPosition(),o.bottomOverlay.clone&&(He=o.bottomOverlay.resetFixedPosition()||He),He=o.inlineStartOverlay.resetFixedPosition()||He,o.topInlineStartCornerOverlay&&o.topInlineStartCornerOverlay.resetFixedPosition(),o.bottomInlineStartCornerOverlay&&o.bottomInlineStartCornerOverlay.clone&&o.bottomInlineStartCornerOverlay.resetFixedPosition()),He?(o.refreshAll(),o.adjustElementsSize()):this.refreshSelections(A),O&&o.syncScrollWithMaster(),this.dataAccessObject.drawn=!0,this}},{key:"markIfOversizedColumnHeader",value:function(r){for(var n=this.columnFilter.renderedToSource(r),i=this.wtSettings.getSetting("columnHeaders").length,o=this.wtSettings.getSetting("defaultRowHeight"),s,a,h,p=this.wtSettings.getSetting("columnHeaderHeight")||[];i;)i-=1,s=this.getColumnHeaderHeight(i),a=this.getColumnHeader(n,i),a&&(h=fh(a),(!s&&o<h||s<h)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=h),Array.isArray(p)?p[i]!==null&&p[i]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=p[i]):isNaN(p)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=p),this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]<(p[i]||p)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=p[i]||p))}},{key:"adjustColumnHeaderHeights",value:function(){for(var r=this.wtSettings,n=this.THEAD.childNodes,i=this.dataAccessObject.wtViewport.oversizedColumnHeaders,o=r.getSetting("columnHeaders"),s=0,a=o.length;s<a;s++)if(i[s]){if(!n[s]||n[s].childNodes.length===0)return;n[s].childNodes[0].style.height="".concat(i[s],"px")}}},{key:"resetOversizedRows",value:function(){var r=this.wtSettings,n=this.dataAccessObject.wtViewport;if(!(!this.isMaster&&!this.is(mu))&&!r.getSetting("externalRowCalculator"))for(var i=this.getRenderedRowsCount(),o=0;o<i;o++){var s=this.rowFilter.renderedToSource(o);n.oversizedRows&&n.oversizedRows[s]&&(n.oversizedRows[s]=void 0)}}},{key:"removeClassFromCells",value:function(r){for(var n=this.TABLE.querySelectorAll(".".concat(r)),i=0,o=n.length;i<o;i++)qr(n[i],r)}},{key:"refreshSelections",value:function(r){var n=this.wtSettings,i=this.dataAccessObject.selections;if(i){var o=Array.from(i),s=o.length;if(r){for(var a=[],h=0;h<s;h++){for(var p=o[h].settings,y=p.highlightHeaderClassName,S=p.highlightRowClassName,E=p.highlightColumnClassName,O=o[h].classNames,A=O.length,$=0;$<A;$++)a.includes(O[$])||a.push(O[$]);y&&!a.includes(y)&&a.push(y),S&&!a.includes(S)&&a.push(S),E&&!a.includes(E)&&a.push(E)}var B=n.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(B))for(var j=0;j<B.length;j++)a.push(B[j]);for(var z=a.length,W=0;W<z;W++)this.removeClassFromCells(a[W])}for(var Q=0;Q<s;Q++)o[Q].draw(this.facadeGetter(),r)}}},{key:"getCell",value:function(r){var n=r.row,i=r.col,o=this.wtSettings.getSetting("onModifyGetCellCoords",n,i);if(o&&Array.isArray(o)){var s=jqe(o,2);n=s[0],i=s[1]}if(this.isRowBeforeRenderedRows(n))return-1;if(this.isRowAfterRenderedRows(n))return-2;if(this.isColumnBeforeRenderedColumns(i))return-3;if(this.isColumnAfterRenderedColumns(i))return-4;var a=this.getRow(n);if(!a&&n>=0)throw new Error("TR was expected to be rendered but is not");var h=a.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(i)];if(!h&&i>=0)throw new Error("TD or TH was expected to be rendered but is not");return h}},{key:"getRow",value:function(r){var n=null,i=null;if(r<0){var o;n=(o=this.rowFilter)===null||o===void 0?void 0:o.sourceRowToVisibleColHeadedRow(r),i=this.THEAD}else{var s;n=(s=this.rowFilter)===null||s===void 0?void 0:s.sourceToRendered(r),i=this.TBODY}return n!==void 0&&i!==void 0?i.childNodes.length<n+1?!1:i.childNodes[n]:!1}},{key:"getColumnHeader",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=this.THEAD.childNodes[n];return i==null?void 0:i.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r)]}},{key:"getColumnHeaders",value:function(r){var n=[],i=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r);return this.THEAD.childNodes.forEach(function(o){var s=o.childNodes[i];s&&n.push(s)}),n}},{key:"getRowHeader",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0)!==0){var i=this.wtSettings.getSetting("rowHeaders").length;if(!(n>=i)){var o=this.TBODY.childNodes[this.rowFilter.sourceToRendered(r)];return o==null?void 0:o.childNodes[n]}}}},{key:"getRowHeaders",value:function(r){if(this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0)===0)return[];for(var n=[],i=this.wtSettings.getSetting("rowHeaders").length,o=0;o<i;o++){var s=this.TBODY.childNodes[this.rowFilter.sourceToRendered(r)],a=s==null?void 0:s.childNodes[o];a&&n.push(a)}return n}},{key:"getCoords",value:function(r){var n=r;if(n.nodeName!=="TD"&&n.nodeName!=="TH"&&(n=em(n,["TD","TH"])),n===null)return null;var i=n.parentNode,o=i.parentNode,s=wUe(i),a=n.cellIndex;if(Kd(ym,n,this.wtRootElement)||Kd(mm,n,this.wtRootElement))o.nodeName==="THEAD"&&(s-=o.childNodes.length);else if(Kd(Ch,n,this.wtRootElement)||Kd(mu,n,this.wtRootElement)){var h=this.wtSettings.getSetting("totalRows");s=h-o.childNodes.length+s}else o===this.THEAD?s=this.rowFilter.visibleColHeadedRowToSourceRow(s):s=this.rowFilter.renderedToSource(s);return Kd(ym,n,this.wtRootElement)||Kd(gm,n,this.wtRootElement)||Kd(Ch,n,this.wtRootElement)?a=this.columnFilter.offsettedTH(a):a=this.columnFilter.visibleRowHeadedColumnToSourceColumn(a),this.wot.createCellCoords(s,a)}},{key:"markOversizedRows",value:function(){if(!this.wtSettings.getSetting("externalRowCalculator")){var r=this.TBODY.childNodes.length,n=r*this.wtSettings.getSetting("defaultRowHeight"),i=fh(this.TBODY)-1,o,s,a,h,p;if(!(n===i&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;r;)r-=1,a=this.rowFilter.renderedToSource(r),o=this.getRowHeight(a),h=this.getTrForRow(a),p=h.querySelector("th"),p?s=fh(p):s=fh(h)-1,(!o&&this.wtSettings.getSetting("defaultRowHeight")<s||o<s)&&(s+=1,this.dataAccessObject.wtViewport.oversizedRows[a]=s)}}},{key:"getTrForRow",value:function(r){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(r)]}},{key:"isColumnHeaderRendered",value:function(r){if(r>=0)return!1;var n=this.wtSettings.getSetting("rowHeaders"),i=n.length;return Math.abs(r)<=i}},{key:"isRowHeaderRendered",value:function(r){if(r>=0)return!1;var n=this.wtSettings.getSetting("columnHeaders"),i=n.length;return Math.abs(r)<=i}},{key:"isRowBeforeRenderedRows",value:function(r){var n=this.getFirstRenderedRow();return r<0&&n<=0?!this.isRowHeaderRendered(r):r<n}},{key:"isRowAfterRenderedRows",value:function(r){return r>this.getLastRenderedRow()}},{key:"isColumnBeforeRenderedColumns",value:function(r){var n=this.getFirstRenderedColumn();return r<0&&n<=0?!this.isColumnHeaderRendered(r):r<n}},{key:"isColumnAfterRenderedColumns",value:function(r){return this.columnFilter&&r>this.getLastRenderedColumn()}},{key:"isColumnAfterViewport",value:function(r){return this.columnFilter&&r>this.getLastVisibleColumn()}},{key:"isRowAfterViewport",value:function(r){return this.rowFilter&&r>this.getLastVisibleRow()}},{key:"isColumnBeforeViewport",value:function(r){return this.columnFilter&&this.columnFilter.sourceToRendered(r)<0&&r>=0}},{key:"isLastRowFullyVisible",value:function(){return this.getLastVisibleRow()===this.getLastRenderedRow()}},{key:"isLastColumnFullyVisible",value:function(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}},{key:"allRowsInViewport",value:function(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}},{key:"allColumnsInViewport",value:function(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}},{key:"getRowHeight",value:function(r){return this.rowUtils.getHeight(r)}},{key:"getColumnHeaderHeight",value:function(r){return this.columnUtils.getHeaderHeight(r)}},{key:"getColumnWidth",value:function(r){return this.columnUtils.getWidth(r)}},{key:"getStretchedColumnWidth",value:function(r){return this.columnUtils.getStretchedColumnWidth(r)}},{key:"hasDefinedSize",value:function(){return this.hasTableHeight&&this.hasTableWidth}},{key:"getWidth",value:function(){return ii(this.TABLE)}},{key:"getHeight",value:function(){return Ni(this.TABLE)}},{key:"getTotalWidth",value:function(){var r=ii(this.hider);return r!==0?r:this.getWidth()}},{key:"getTotalHeight",value:function(){var r=Ni(this.hider);return r!==0?r:this.getHeight()}},{key:"isVisible",value:function(){return I1(this.TABLE)}},{key:"_modifyRowHeaderWidth",value:function(r){var n=hi(r)?r():null;return Array.isArray(n)?(n=Dqe(n),n[n.length-1]=this._correctRowHeaderWidth(n[n.length-1])):n=this._correctRowHeaderWidth(n),n}},{key:"_correctRowHeaderWidth",value:function(r){var n=r;return typeof r!="number"&&(n=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(n+=1),n}}]),e}();const sw=Gqe;var Yqe="stickyRowsBottom",Uce={getFirstRenderedRow:function(){var t=this.wtSettings.getSetting("totalRows"),r=this.wtSettings.getSetting("fixedRowsBottom"),n=t-r;return t===0||r===0?-1:n<0?0:n},getFirstVisibleRow:function(){return this.getFirstRenderedRow()},getLastRenderedRow:function(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow:function(){return this.getLastRenderedRow()},getRenderedRowsCount:function(){var t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),t)},getVisibleRowsCount:function(){return this.getRenderedRowsCount()}};af(Uce,"MIXIN_NAME",Yqe,{writable:!1,enumerable:!1});const Wce=Uce;var Kqe="stickyColumnsStart",Gce={getFirstRenderedColumn:function(){var t=this.wtSettings.getSetting("totalColumns");return t===0?-1:0},getFirstVisibleColumn:function(){return this.getFirstRenderedColumn()},getLastRenderedColumn:function(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn:function(){return this.getLastRenderedColumn()},getRenderedColumnsCount:function(){var t=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),t)},getVisibleColumnsCount:function(){return this.getRenderedColumnsCount()}};af(Gce,"MIXIN_NAME",Kqe,{writable:!1,enumerable:!1});const jU=Gce;function o_(e){"@babel/helpers - typeof";return o_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o_(e)}function uX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Xqe(n.key),n)}}function qqe(e,t,r){return t&&uX(e.prototype,t),r&&uX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Xqe(e){var t=Zqe(e,"string");return o_(t)==="symbol"?t:String(t)}function Zqe(e,t){if(o_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(o_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Jqe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Qqe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&lF(e,t)}function lF(e,t){return lF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},lF(e,t)}function e9e(e){var t=n9e();return function(){var n=uA(e),i;if(t){var o=uA(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return t9e(this,i)}}function t9e(e,t){if(t&&(o_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return r9e(e)}function r9e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function n9e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function uA(e){return uA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},uA(e)}var FU=function(e){Qqe(r,e);var t=e9e(r);function r(n,i,o,s){return Jqe(this,r),t.call(this,n,i,o,s,Ch)}return qqe(r)}(sw);ci(FU,Wce);ci(FU,jU);const i9e=FU;var mm="top",mu="bottom",gm="inline_start",ym="top_inline_start_corner",Ch="bottom_inline_start_corner",o9e=[mm,mu,gm,ym,Ch],a9e=new Map([[mm,"ht_clone_".concat(mm)],[mu,"ht_clone_".concat(mu)],[gm,"ht_clone_".concat(gm," ht_clone_left")],[ym,"ht_clone_".concat(ym," ht_clone_top_left_corner")],[Ch,"ht_clone_".concat(Ch," ht_clone_bottom_left_corner")]]),s9e=Qi,l9e=Math.floor,u9e=Number.isInteger||function(t){return!s9e(t)&&isFinite(t)&&l9e(t)===t},c9e=jr,f9e=u9e;c9e({target:"Number",stat:!0},{isInteger:f9e});function ox(e){"@babel/helpers - typeof";return ox=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ox(e)}function h9e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function cX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Yce(n.key),n)}}function d9e(e,t,r){return t&&cX(e.prototype,t),r&&cX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function pL(e,t,r){return t=Yce(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Yce(e){var t=p9e(e,"string");return ox(t)==="symbol"?t:String(t)}function p9e(e,t){if(ox(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ox(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var m9e=function(){function e(t){h9e(this,e),pL(this,"dataAccessObject",void 0),pL(this,"lastScrolledColumnPos",-1),pL(this,"lastScrolledRowPos",-1),this.dataAccessObject=t}return d9e(e,[{key:"scrollViewport",value:function(r,n,i,o,s){var a=this.scrollViewportHorizontally(r.col,i,s),h=this.scrollViewportVertically(r.row,n,o);return a||h}},{key:"scrollViewportHorizontally",value:function(r,n,i){var o=this.dataAccessObject,s=o.drawn,a=o.totalColumns;if(!s||!Number.isInteger(r)||r<0||r>a)return!1;var h=this.getFirstVisibleColumn(),p=this.getLastVisibleColumn(),y=n===void 0&&i===void 0,S=this.dataAccessObject,E=S.fixedColumnsStart,O=S.inlineStartOverlay;if(y&&r<E)return!1;var A=!1;return h===-1?A=O.scrollTo(r,y?r>this.lastScrolledColumnPos:n):(y&&(r<h||r>p)||!y)&&(A=O.scrollTo(r,y?r>p:n)),A&&(this.lastScrolledColumnPos=r),A}},{key:"scrollViewportVertically",value:function(r,n,i){var o=this.dataAccessObject,s=o.drawn,a=o.totalRows;if(!s||!Number.isInteger(r)||r<0||r>a)return!1;var h=this.getFirstVisibleRow(),p=this.getLastVisibleRow(),y=n===void 0&&i===void 0,S=this.dataAccessObject,E=S.fixedRowsBottom,O=S.fixedRowsTop,A=S.topOverlay;if(y&&(r<O||r>a-E-1))return!1;var $=!1;return h===-1?$=A.scrollTo(r,y?r>this.lastScrolledRowPos:i):(y&&(r<h||r>p)||!y)&&($=A.scrollTo(r,y?r>p:i)),$&&(this.lastScrolledRowPos=r),$}},{key:"getFirstVisibleRow",value:function(){var r=this.dataAccessObject,n=r.topOverlay,i=r.wtTable,o=r.wtViewport,s=r.totalRows,a=r.fixedRowsTop,h=r.rootWindow,p=i.getFirstVisibleRow();if(n.mainTableScrollableElement===h){var y=ao(i.wtRootElement),S=fh(i.hider),E=fh(h),O=KP(h,h);if(y.top+S-E<=O){var A=o.getColumnHeaderHeight();A+=n.sumCellSizes(0,a);for(var $=s;$>0;$--)if(A+=n.sumCellSizes($-1,$),y.top+S-A<=O){p=$;break}}}return p}},{key:"getLastVisibleRow",value:function(){var r=this.dataAccessObject,n=r.topOverlay,i=r.wtTable,o=r.wtViewport,s=r.totalRows,a=r.rootWindow,h=i.getLastVisibleRow();if(n.mainTableScrollableElement===a){var p=ao(i.wtRootElement),y=KP(a,a);if(p.top>y){for(var S=fh(a),E=o.getColumnHeaderHeight(),O=1;O<=s;O++)if(E+=n.sumCellSizes(O-1,O),p.top+E-y>=S){h=O-2;break}}}return h}},{key:"getFirstVisibleColumn",value:function(){var r=this.dataAccessObject,n=r.inlineStartOverlay,i=r.wtTable,o=r.wtViewport,s=r.totalColumns,a=r.rootWindow,h=i.getFirstVisibleColumn();if(n.mainTableScrollableElement===a){var p=ao(i.wtRootElement),y=Ok(i.hider),S=Ok(a),E=Math.abs(Rj(a,a));if(p.left+y-S<=E){for(var O=o.getRowHeaderWidth(),A=s;A>0;A--)if(O+=n.sumCellSizes(A-1,A),p.left+y-O<=E){h=A;break}}}return h}},{key:"getLastVisibleColumn",value:function(){var r=this.dataAccessObject,n=r.wtSettings,i=r.inlineStartOverlay,o=r.wtTable,s=r.wtViewport,a=r.totalColumns,h=r.rootWindow,p=o.getLastVisibleColumn();if(i.mainTableScrollableElement===h){var y=n.getSetting("rtlMode"),S=null;if(y){var E=o.TABLE.getBoundingClientRect(),O=this.dataAccessObject.rootWindow.document,A=O.documentElement.offsetWidth;S=Math.abs(E.right-A)}else{var $=ao(o.wtRootElement);S=$.left}var B=Math.abs(Rj(h,h));if(S>B){for(var j=Ok(h),z=s.getRowHeaderWidth(),W=1;W<=a;W++)if(z+=i.sumCellSizes(W-1,W),S+z-B>=j){p=W-2;break}}}return p}}]),e}();const g9e=m9e;function ax(e){"@babel/helpers - typeof";return ax=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ax(e)}function y9e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Kce(n.key),n)}}function v9e(e,t,r){return t&&fX(e.prototype,t),r&&fX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function hl(e,t,r){return t=Kce(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Kce(e){var t=_9e(e,"string");return ax(t)==="symbol"?t:String(t)}function _9e(e,t){if(ax(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ax(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var zU=function(){function e(t,r){y9e(this,e),hl(this,"wtTable",void 0),hl(this,"wtScroll",void 0),hl(this,"wtViewport",void 0),hl(this,"wtOverlays",void 0),hl(this,"selections",void 0),hl(this,"wtEvent",void 0),hl(this,"guid","wt_".concat(Wue())),hl(this,"drawInterrupted",!1),hl(this,"drawn",!1),hl(this,"domBindings",void 0),hl(this,"wtSettings",void 0),this.domBindings={rootTable:t,rootDocument:t.ownerDocument,rootWindow:t.ownerDocument.defaultView},this.wtSettings=r,this.wtScroll=new g9e(this.createScrollDao())}return v9e(e,[{key:"eventManager",get:function(){return new Fi(this)}},{key:"findOriginalHeaders",value:function(){var r=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(var n=0,i=this.wtTable.THEAD.childNodes[0].childNodes.length;n<i;n++)r.push(this.wtTable.THEAD.childNodes[0].childNodes[n].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(o,s){fm(s,r[o])}])}}},{key:"createCellCoords",value:function(r,n){return new eA(r,n,this.wtSettings.getSetting("rtlMode"))}},{key:"createCellRange",value:function(r,n,i){return new BU(r,n,i,this.wtSettings.getSetting("rtlMode"))}},{key:"draw",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,!r&&!this.wtTable.isVisible()?this.drawInterrupted=!0:this.wtTable.draw(r),this}},{key:"getCell",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(!n)return this.wtTable.getCell(r);var i=this.wtSettings.getSetting("totalRows"),o=this.wtSettings.getSetting("fixedRowsTop"),s=this.wtSettings.getSetting("fixedRowsBottom"),a=this.wtSettings.getSetting("fixedColumnsStart");if(r.row<o&&r.col<a)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(r);if(r.row<o)return this.wtOverlays.topOverlay.clone.wtTable.getCell(r);if(r.col<a&&r.row>=i-s){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(r)}else{if(r.col<a)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(r);if(r.row<i&&r.row>=i-s&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(r)}return this.wtTable.getCell(r)}},{key:"scrollViewport",value:function(r,n,i,o,s){return r.col<0||r.row<0?!1:this.wtScroll.scrollViewport(r,n,i,o,s)}},{key:"scrollViewportHorizontally",value:function(r,n,i){return r<0?!1:this.wtScroll.scrollViewportHorizontally(r,n,i)}},{key:"scrollViewportVertically",value:function(r,n,i){return r<0?!1:this.wtScroll.scrollViewportVertically(r,n,i)}},{key:"getViewport",value:function(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}},{key:"destroy",value:function(){this.wtOverlays.destroy(),this.wtEvent.destroy()}},{key:"createScrollDao",value:function(){var r=this;return{get drawn(){return r.drawn},get topOverlay(){return r.wtOverlays.topOverlay},get inlineStartOverlay(){return r.wtOverlays.inlineStartOverlay},get wtTable(){return r.wtTable},get wtViewport(){return r.wtViewport},get wtSettings(){return r.wtSettings},get rootWindow(){return r.domBindings.rootWindow},get totalRows(){return r.wtSettings.getSetting("totalRows")},get totalColumns(){return r.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return r.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return r.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return r.wtSettings.getSetting("fixedColumnsStart")}}}},{key:"getTableDao",value:function(){var r=this;return{get wot(){return r},get parentTableOffset(){return r.cloneSource.wtTable.tableOffset},get cloneSource(){return r.cloneSource},get workspaceWidth(){return r.wtViewport.getWorkspaceWidth()},get wtViewport(){return r.wtViewport},get wtOverlays(){return r.wtOverlays},get selections(){return r.selections},get drawn(){return r.drawn},set drawn(n){r.drawn=n},get wtTable(){return r.wtTable},get startColumnRendered(){return r.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return r.wtViewport.columnsVisibleCalculator.startColumn},get endColumnRendered(){return r.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return r.wtViewport.columnsVisibleCalculator.endColumn},get countColumnsRendered(){return r.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return r.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return r.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return r.wtViewport.rowsVisibleCalculator.startRow},get endRowRendered(){return r.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return r.wtViewport.rowsVisibleCalculator.endRow},get countRowsRendered(){return r.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return r.wtViewport.rowsVisibleCalculator.count}}}}]),e}();function a_(e){"@babel/helpers - typeof";return a_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a_(e)}function hX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,qce(n.key),n)}}function b9e(e,t,r){return t&&hX(e.prototype,t),r&&hX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function w9e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function S9e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&uF(e,t)}function uF(e,t){return uF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},uF(e,t)}function x9e(e){var t=E9e();return function(){var n=cA(e),i;if(t){var o=cA(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return C9e(this,i)}}function C9e(e,t){if(t&&(a_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ik(e)}function Ik(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function E9e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function cA(e){return cA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},cA(e)}function dX(e,t,r){return t=qce(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function qce(e){var t=T9e(e,"string");return a_(t)==="symbol"?t:String(t)}function T9e(e,t){if(a_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(a_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var O9e=function(e){S9e(r,e);var t=x9e(r);function r(n,i,o){var s;w9e(this,r),s=t.call(this,n,i),dX(Ik(s),"cloneSource",void 0),dX(Ik(s),"cloneOverlay",void 0);var a=s.wtSettings.getSetting("facade",Ik(s));return s.cloneSource=o.source,s.cloneOverlay=o.overlay,s.wtTable=s.cloneOverlay.createTable(s.getTableDao(),a,s.domBindings,s.wtSettings),s.wtViewport=o.viewport,s.selections=o.selections,s.wtEvent=new jce(a,s.domBindings,s.wtSettings,s.eventManager,s.wtTable,s.selections,o.event),s.findOriginalHeaders(),s}return b9e(r)}(zU);function sx(e){"@babel/helpers - typeof";return sx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sx(e)}function R9e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Xce(n.key),n)}}function k9e(e,t,r){return t&&pX(e.prototype,t),r&&pX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function P9e(e,t,r){return t=Xce(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Xce(e){var t=A9e(e,"string");return sx(t)==="symbol"?t:String(t)}function A9e(e,t){if(sx(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(sx(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var OE=function(){function e(t,r,n,i,o){R9e(this,e),P9e(this,"wtSettings",null),af(this,"wot",t,{writable:!1}),this.domBindings=o,this.facadeGetter=r,this.wtSettings=i;var s=this.wot.wtTable,a=s.TABLE,h=s.hider,p=s.spreader,y=s.holder,S=s.wtRootElement;this.instance=this.wot,this.type=n,this.mainTableScrollableElement=null,this.TABLE=a,this.hider=h,this.spreader=p,this.holder=y,this.wtRootElement=S,this.trimmingContainer=$1(this.hider.parentNode.parentNode),this.updateStateOfRendering(),this.clone=this.makeClone()}return k9e(e,[{key:"updateStateOfRendering",value:function(){var r=this.needFullRender;this.needFullRender=this.shouldBeRendered();var n=r!==this.needFullRender;return n&&!this.needFullRender&&this.reset(),n}},{key:"shouldBeRendered",value:function(){return!0}},{key:"updateTrimmingContainer",value:function(){this.trimmingContainer=$1(this.hider.parentNode.parentNode)}},{key:"updateMainScrollableElement",value:function(){var r=this.wot.wtTable,n=this.domBindings.rootWindow;n.getComputedStyle(r.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=qP(r.TABLE)}},{key:"getRelativeCellPosition",value:function(r,n,i){if(this.clone.wtTable.holder.contains(r)===!1){ni("The provided element is not a child of the ".concat(this.type," overlay"));return}var o=this.mainTableScrollableElement===this.domBindings.rootWindow,s=i<this.wtSettings.getSetting("fixedColumnsStart"),a=n<this.wtSettings.getSetting("fixedRowsTop"),h=n>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),p=this.clone.wtTable.spreader,y={start:this.getRelativeStartPosition(p),top:p.offsetTop},S={start:this.getRelativeStartPosition(r),top:r.offsetTop},E=null;return o?E=this.getRelativeCellPositionWithinWindow(a,s,S,y):E=this.getRelativeCellPositionWithinHolder(a,h,s,S,y),E}},{key:"getRelativeStartPosition",value:function(r){return this.isRtl()?r.offsetParent.offsetWidth-r.offsetLeft-r.offsetWidth:r.offsetLeft}},{key:"getRelativeCellPositionWithinWindow",value:function(r,n,i,o){var s=this.wot.wtTable.wtRootElement.getBoundingClientRect(),a=0,h=0;if(!n)a=o.start;else{var p=s.left;this.isRtl()&&(p=this.domBindings.rootWindow.innerWidth-(s.left+s.width+Mo())),a=p<=0?-1*p:0}if(r){var y=this.clone.wtTable.TABLE.getBoundingClientRect();h=y.top-s.top}else h=o.top;return{start:i.start+a,top:i.top+h}}},{key:"getRelativeCellPositionWithinHolder",value:function(r,n,i,o,s){var a={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()},h=0,p=0;if(i||(h=a.horizontal-s.start),n){var y=this.wot.wtTable.wtRootElement.getBoundingClientRect(),S=this.clone.wtTable.TABLE.getBoundingClientRect();p=S.top*-1+y.top}else r||(p=a.vertical-s.top);return{start:o.start-h,top:o.top-p}}},{key:"makeClone",value:function(){if(o9e.indexOf(this.type)===-1)throw new Error('Clone type "'.concat(this.type,'" is not supported.'));var r=this.wot.wtTable,n=this.domBindings,i=n.rootDocument,o=n.rootWindow,s=i.createElement("DIV"),a=i.createElement("TABLE"),h=r.wtRootElement.parentNode;s.className="".concat(a9e.get(this.type)," handsontable"),s.setAttribute("dir",this.isRtl()?"rtl":"ltr"),s.style.position="absolute",s.style.top=0,s.style.overflow="visible",this.isRtl()?s.style.right=0:s.style.left=0,a.className=r.TABLE.className,s.appendChild(a),h.appendChild(s);var p=this.wtSettings.getSetting("preventOverflow");return p===!0||p==="horizontal"&&this.type===mm||p==="vertical"&&this.type===gm?this.mainTableScrollableElement=o:o.getComputedStyle(h).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=r.holder:this.mainTableScrollableElement=qP(r.TABLE),new O9e(a,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selections:this.wot.selections})}},{key:"refresh",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.shouldBeRendered();this.clone&&(this.needFullRender||n)&&this.clone.draw(r),this.needFullRender=n}},{key:"reset",value:function(){if(this.clone){var r=this.clone.wtTable.holder,n=this.clone.wtTable.hider,i=r.style,o=n.style,s=r.parentNode.style;Fe([i,o,s],function(a){a.width="",a.height=""})}}},{key:"isRtl",value:function(){return this.wtSettings.getSetting("rtlMode")}},{key:"destroy",value:function(){this.clone.eventManager.destroy()}}]),e}();function s_(e){"@babel/helpers - typeof";return s_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s_(e)}function Mk(e,t,r){return Zce()?Mk=Reflect.construct.bind():Mk=function(i,o,s){var a=[null];a.push.apply(a,o);var h=Function.bind.apply(i,a),p=new h;return s&&fA(p,s.prototype),p},Mk.apply(null,arguments)}function I9e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,$9e(n.key),n)}}function M9e(e,t,r){return t&&mX(e.prototype,t),r&&mX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function $9e(e){var t=D9e(e,"string");return s_(t)==="symbol"?t:String(t)}function D9e(e,t){if(s_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(s_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function L9e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&fA(e,t)}function fA(e,t){return fA=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},fA(e,t)}function N9e(e){var t=Zce();return function(){var n=hA(e),i;if(t){var o=hA(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return B9e(this,i)}}function B9e(e,t){if(t&&(s_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return j9e(e)}function j9e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Zce(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function hA(e){return hA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},hA(e)}var F9e=function(e){L9e(r,e);var t=N9e(r);function r(n,i,o,s,a,h){var p;return I9e(this,r),p=t.call(this,n,i,Ch,o,s),p.bottomOverlay=a,p.inlineStartOverlay=h,p}return M9e(r,[{key:"createTable",value:function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Mk(i9e,o)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){var i=this.wot;if(this.updateTrimmingContainer(),!i.wtTable.holder.parentNode)return!1;var o=this.clone.wtTable.holder.parentNode;if(o.style.top="",this.trimmingContainer===this.domBindings.rootWindow){var s=this.inlineStartOverlay.getOverlayOffset(),a=this.bottomOverlay.getOverlayOffset();o.style[this.isRtl()?"right":"left"]="".concat(s,"px"),o.style.bottom="".concat(a,"px")}else uM(o),this.repositionOverlay();var h=Ni(this.clone.wtTable.TABLE),p=ii(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(h=0),o.style.height="".concat(h,"px"),o.style.width="".concat(p,"px"),!1}},{key:"repositionOverlay",value:function(){var i=this.wot,o=i.wtTable,s=i.wtViewport,a=this.domBindings.rootDocument,h=this.clone.wtTable.holder.parentNode,p=0;s.hasVerticalScroll()||(p+=s.getWorkspaceHeight()-o.getTotalHeight()),s.hasVerticalScroll()&&s.hasHorizontalScroll()&&(p+=Mo(a)),h.style.bottom="".concat(p,"px")}}]),r}(OE),z9e="calculatedColumns",Jce={getFirstRenderedColumn:function(){var t=this.dataAccessObject.startColumnRendered;return t===null?-1:t},getFirstVisibleColumn:function(){var t=this.dataAccessObject.startColumnVisible;return t===null?-1:t},getLastRenderedColumn:function(){var t=this.dataAccessObject.endColumnRendered;return t===null?-1:t},getLastVisibleColumn:function(){var t=this.dataAccessObject.endColumnVisible;return t===null?-1:t},getRenderedColumnsCount:function(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount:function(){return this.dataAccessObject.countColumnsVisible}};af(Jce,"MIXIN_NAME",z9e,{writable:!1,enumerable:!1});const HU=Jce;function l_(e){"@babel/helpers - typeof";return l_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l_(e)}function gX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,V9e(n.key),n)}}function H9e(e,t,r){return t&&gX(e.prototype,t),r&&gX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function V9e(e){var t=U9e(e,"string");return l_(t)==="symbol"?t:String(t)}function U9e(e,t){if(l_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(l_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function W9e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function G9e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&cF(e,t)}function cF(e,t){return cF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},cF(e,t)}function Y9e(e){var t=X9e();return function(){var n=dA(e),i;if(t){var o=dA(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return K9e(this,i)}}function K9e(e,t){if(t&&(l_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return q9e(e)}function q9e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function X9e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function dA(e){return dA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},dA(e)}var VU=function(e){G9e(r,e);var t=Y9e(r);function r(n,i,o,s){return W9e(this,r),t.call(this,n,i,o,s,mu)}return H9e(r)}(sw);ci(VU,Wce);ci(VU,HU);const Z9e=VU;function u_(e){"@babel/helpers - typeof";return u_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u_(e)}function $k(e,t,r){return efe()?$k=Reflect.construct.bind():$k=function(i,o,s){var a=[null];a.push.apply(a,o);var h=Function.bind.apply(i,a),p=new h;return s&&pA(p,s.prototype),p},$k.apply(null,arguments)}function J9e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,tfe(n.key),n)}}function Q9e(e,t,r){return t&&yX(e.prototype,t),r&&yX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function e7e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&pA(e,t)}function pA(e,t){return pA=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},pA(e,t)}function t7e(e){var t=efe();return function(){var n=mA(e),i;if(t){var o=mA(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return r7e(this,i)}}function r7e(e,t){if(t&&(u_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Qce(e)}function Qce(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function efe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function mA(e){return mA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},mA(e)}function n7e(e,t,r){return t=tfe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function tfe(e){var t=i7e(e,"string");return u_(t)==="symbol"?t:String(t)}function i7e(e,t){if(u_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(u_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var o7e=function(e){e7e(r,e);var t=t7e(r);function r(n,i,o,s){var a;return J9e(this,r),a=t.call(this,n,i,mu,o,s),n7e(Qce(a),"cachedFixedRowsBottom",-1),a.cachedFixedRowsBottom=a.wtSettings.getSetting("fixedRowsBottom"),a}return Q9e(r,[{key:"createTable",value:function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return $k(Z9e,o)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}},{key:"resetFixedPosition",value:function(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;var i=this.domBindings.rootWindow,o=this.clone.wtTable.holder.parentNode;o.style.top="";var s=0,a=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===i&&(!a||a!=="vertical")?(s=this.getOverlayOffset(),o.style.bottom="".concat(s,"px")):(s=this.getScrollPosition(),this.repositionOverlay());var h=this.adjustHeaderBordersPosition(s);return this.adjustElementsSize(),h}},{key:"repositionOverlay",value:function(){var i=this.wot,o=i.wtTable,s=i.wtViewport,a=this.domBindings.rootDocument,h=this.clone.wtTable.holder.parentNode,p=0;s.hasVerticalScroll()||(p+=s.getWorkspaceHeight()-o.getTotalHeight()),s.hasVerticalScroll()&&s.hasHorizontalScroll()&&(p+=Mo(a)),h.style.bottom="".concat(p,"px")}},{key:"setScrollPosition",value:function(i){var o=this.domBindings.rootWindow,s=!1;return this.mainTableScrollableElement===o?(o.scrollTo(Lv(o),i),s=!0):this.mainTableScrollableElement.scrollTop!==i&&(this.mainTableScrollableElement.scrollTop=i,s=!0),s}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollHorizontally")}},{key:"sumCellSizes",value:function(i,o){for(var s=this.wot,a=s.wtTable,h=s.wtSettings,p=h.getSetting("defaultRowHeight"),y=i,S=0;y<o;){var E=a.getRowHeight(y);S+=E===void 0?p:E,y+=1}return S}},{key:"adjustElementsSize",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||i)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var i=this.wot,o=i.wtTable,s=i.wtViewport,a=this.domBindings,h=a.rootDocument,p=a.rootWindow,y=Mo(h),S=this.clone.wtTable.holder.parentNode,E=S.style,O=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==p||O==="horizontal"){var A=s.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(A-=y),A=Math.min(A,o.wtRootElement.scrollWidth),E.width="".concat(A,"px")}else E.width="";this.clone.wtTable.holder.style.width=E.width;var $=Ni(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||($=0),E.height="".concat($,"px")}},{key:"adjustRootChildrenSize",value:function(){var i=this.clone.wtTable.holder;this.clone.wtTable.hider.style.width=this.hider.style.width,i.style.width=i.parentNode.style.width,i.style.height=i.parentNode.style.height}},{key:"applyToDOM",value:function(){var i=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px");else if(i===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){var i=this.isRtl()?"right":"left",o=this.clone.wtTable.spreader;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?o.style[i]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px"):o.style[i]=""}},{key:"scrollTo",value:function(i,o){var s=this.getTableParentOffset(),a=this.wot.cloneSource?this.wot.cloneSource:this.wot,h=a.wtTable.holder,p=0;o&&h.offsetHeight!==h.clientHeight&&(p=Mo(this.domBindings.rootDocument)),o?(s+=this.sumCellSizes(0,i+1),s-=this.wot.wtViewport.getViewportHeight(),s+=1):s+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),i),s+=p,this.setScrollPosition(s)}},{key:"getTableParentOffset",value:function(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}},{key:"getScrollPosition",value:function(){return KP(this.mainTableScrollableElement,this.domBindings.rootWindow)}},{key:"getOverlayOffset",value:function(){var i=this.domBindings.rootWindow,o=this.wtSettings.getSetting("preventOverflow"),s=0;if(this.trimmingContainer===i&&(!o||o!=="vertical")){var a=this.wot.wtTable.getTotalHeight(),h=this.clone.wtTable.getTotalHeight(),p=a-h,y=this.domBindings.rootDocument.documentElement.clientHeight;s=Math.max(this.getTableParentOffset()-this.getScrollPosition()-y+a,0),s>p&&(s=0)}return s}},{key:"adjustHeaderBordersPosition",value:function(i){var o=this.wtSettings.getSetting("fixedRowsBottom"),s=this.cachedFixedRowsBottom!==o,a=this.wtSettings.getSetting("columnHeaders"),h=!1;if((s||o===0)&&a.length>0){var p=this.wot.wtTable.holder.parentNode,y=Wr(p,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),i||this.wtSettings.getSetting("totalRows")===0?(Vt(p,"innerBorderBottom"),h=!y):(qr(p,"innerBorderBottom"),h=y)}return h}}]),r}(OE),a7e="calculatedRows",rfe={getFirstRenderedRow:function(){var t=this.dataAccessObject.startRowRendered;return t===null?-1:t},getFirstVisibleRow:function(){var t=this.dataAccessObject.startRowVisible;return t===null?-1:t},getLastRenderedRow:function(){var t=this.dataAccessObject.endRowRendered;return t===null?-1:t},getLastVisibleRow:function(){var t=this.dataAccessObject.endRowVisible;return t===null?-1:t},getRenderedRowsCount:function(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount:function(){return this.dataAccessObject.countRowsVisible}};af(rfe,"MIXIN_NAME",a7e,{writable:!1,enumerable:!1});const nfe=rfe;function c_(e){"@babel/helpers - typeof";return c_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},c_(e)}function vX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,l7e(n.key),n)}}function s7e(e,t,r){return t&&vX(e.prototype,t),r&&vX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function l7e(e){var t=u7e(e,"string");return c_(t)==="symbol"?t:String(t)}function u7e(e,t){if(c_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(c_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function c7e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f7e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&fF(e,t)}function fF(e,t){return fF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},fF(e,t)}function h7e(e){var t=m7e();return function(){var n=gA(e),i;if(t){var o=gA(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return d7e(this,i)}}function d7e(e,t){if(t&&(c_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return p7e(e)}function p7e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function m7e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function gA(e){return gA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},gA(e)}var UU=function(e){f7e(r,e);var t=h7e(r);function r(n,i,o,s){return c7e(this,r),t.call(this,n,i,o,s,gm)}return s7e(r)}(sw);ci(UU,nfe);ci(UU,jU);const g7e=UU;function f_(e){"@babel/helpers - typeof";return f_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},f_(e)}function Dk(e,t,r){return ife()?Dk=Reflect.construct.bind():Dk=function(i,o,s){var a=[null];a.push.apply(a,o);var h=Function.bind.apply(i,a),p=new h;return s&&yA(p,s.prototype),p},Dk.apply(null,arguments)}function y7e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _X(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_7e(n.key),n)}}function v7e(e,t,r){return t&&_X(e.prototype,t),r&&_X(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _7e(e){var t=b7e(e,"string");return f_(t)==="symbol"?t:String(t)}function b7e(e,t){if(f_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(f_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function w7e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&yA(e,t)}function yA(e,t){return yA=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},yA(e,t)}function S7e(e){var t=ife();return function(){var n=vA(e),i;if(t){var o=vA(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return x7e(this,i)}}function x7e(e,t){if(t&&(f_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return C7e(e)}function C7e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ife(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function vA(e){return vA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},vA(e)}var E7e=function(e){w7e(r,e);var t=S7e(r);function r(n,i,o,s){return y7e(this,r),t.call(this,n,i,gm,o,s)}return v7e(r,[{key:"createTable",value:function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Dk(g7e,o)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){var i=this.wot.wtTable;if(!this.needFullRender||!i.holder.parentNode)return!1;var o=this.domBindings.rootWindow,s=this.clone.wtTable.holder.parentNode,a=this.wtSettings.getSetting("preventOverflow"),h=0;this.trimmingContainer===o&&(!a||a!=="horizontal")?(h=this.getOverlayOffset()*(this.isRtl()?-1:1),_U(s,"".concat(h,"px"),"0px")):(h=this.getScrollPosition(),uM(s));var p=this.adjustHeaderBordersPosition(h);return this.adjustElementsSize(),p}},{key:"setScrollPosition",value:function(i){var o=this.domBindings.rootWindow,s=!1;return this.isRtl()&&(i=-i),this.mainTableScrollableElement===o&&o.scrollX!==i?(o.scrollTo(i,M1(o)),s=!0):this.mainTableScrollableElement.scrollLeft!==i&&(this.mainTableScrollableElement.scrollLeft=i,s=!0),s}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollVertically")}},{key:"sumCellSizes",value:function(i,o){for(var s=this.wtSettings.getSetting("defaultColumnWidth"),a=i,h=0;a<o;)h+=this.wot.wtTable.getStretchedColumnWidth(a)||s,a+=1;return h}},{key:"adjustElementsSize",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||i)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var i=this.wot.wtTable,o=this.domBindings,s=o.rootDocument,a=o.rootWindow,h=Mo(s),p=this.clone.wtTable.holder.parentNode,y=p.style,S=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==a||S==="vertical"){var E=this.wot.wtViewport.getWorkspaceHeight();this.wot.wtOverlays.hasScrollbarBottom&&(E-=h),E=Math.min(E,i.wtRootElement.scrollHeight),y.height="".concat(E,"px")}else y.height="";this.clone.wtTable.holder.style.height=y.height;var O=ii(this.clone.wtTable.TABLE);y.width="".concat(O,"px")}},{key:"adjustRootChildrenSize",value:function(){var i,o=this.clone.wtTable.holder,s=this.wot.selections,a=this.facadeGetter(),h=Math.abs((i=s==null?void 0:s.getCell().getBorder(a).cornerCenterPointOffset)!==null&&i!==void 0?i:0);this.clone.wtTable.hider.style.height=this.hider.style.height,o.style.height=o.parentNode.style.height,o.style.width="".concat(parseInt(o.parentNode.style.width,10)+h,"px")}},{key:"applyToDOM",value:function(){var i=this.wtSettings.getSetting("totalColumns"),o=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[o]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px");else if(i===0)this.spreader.style[o]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px"):this.clone.wtTable.spreader.style.top=""}},{key:"scrollTo",value:function(i,o){var s=this.getTableParentOffset(),a=this.wot.cloneSource?this.wot.cloneSource:this.wot,h=a.wtTable.holder,p=0;if(o){var y=this.wot.wtTable.getColumnWidth(i),S=this.wot.wtViewport.getViewportWidth();y>S&&(o=!1)}return o&&h.offsetWidth!==h.clientWidth&&(p=Mo(this.domBindings.rootDocument)),o?(s+=this.sumCellSizes(0,i+1),s-=this.wot.wtViewport.getViewportWidth()):s+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),i),s+=p,this.setScrollPosition(s)}},{key:"getTableParentOffset",value:function(){var i=this.wtSettings.getSetting("preventOverflow"),o=0;return!i&&this.trimmingContainer===this.domBindings.rootWindow&&(o=this.wot.wtTable.holderOffset.left),o}},{key:"getScrollPosition",value:function(){return Math.abs(Rj(this.mainTableScrollableElement,this.domBindings.rootWindow))}},{key:"getOverlayOffset",value:function(){var i=this.domBindings.rootWindow,o=this.wtSettings.getSetting("preventOverflow"),s=0;if(this.trimmingContainer===i&&(!o||o!=="horizontal")){this.isRtl()?s=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):s=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);var a=this.wot.wtTable.getTotalWidth(),h=this.clone.wtTable.getTotalWidth(),p=a-h;s>p&&(s=0)}return s}},{key:"adjustHeaderBordersPosition",value:function(i){var o=this.wot.wtTable.holder.parentNode,s=this.wtSettings.getSetting("rowHeaders"),a=this.wtSettings.getSetting("fixedColumnsStart"),h=this.wtSettings.getSetting("totalRows");h?qr(o,"emptyRows"):Vt(o,"emptyRows");var p=!1;if(a&&!s.length)Vt(o,"innerBorderLeft innerBorderInlineStart");else if(!a&&s.length){var y=Wr(o,"innerBorderInlineStart");i?(Vt(o,"innerBorderLeft innerBorderInlineStart"),p=!y):(qr(o,"innerBorderLeft innerBorderInlineStart"),p=y)}return p}}]),r}(OE),T7e="stickyRowsTop",ofe={getFirstRenderedRow:function(){var t=this.wtSettings.getSetting("totalRows");return t===0?-1:0},getFirstVisibleRow:function(){return this.getFirstRenderedRow()},getLastRenderedRow:function(){return this.getRenderedRowsCount()-1},getLastVisibleRow:function(){return this.getLastRenderedRow()},getRenderedRowsCount:function(){var t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),t)},getVisibleRowsCount:function(){return this.getRenderedRowsCount()}};af(ofe,"MIXIN_NAME",T7e,{writable:!1,enumerable:!1});const afe=ofe;function h_(e){"@babel/helpers - typeof";return h_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},h_(e)}function bX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,R7e(n.key),n)}}function O7e(e,t,r){return t&&bX(e.prototype,t),r&&bX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function R7e(e){var t=k7e(e,"string");return h_(t)==="symbol"?t:String(t)}function k7e(e,t){if(h_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(h_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function P7e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function A7e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&hF(e,t)}function hF(e,t){return hF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},hF(e,t)}function I7e(e){var t=D7e();return function(){var n=_A(e),i;if(t){var o=_A(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return M7e(this,i)}}function M7e(e,t){if(t&&(h_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return $7e(e)}function $7e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function D7e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _A(e){return _A=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_A(e)}var WU=function(e){A7e(r,e);var t=I7e(r);function r(n,i,o,s){return P7e(this,r),t.call(this,n,i,o,s,ym)}return O7e(r)}(sw);ci(WU,afe);ci(WU,jU);const L7e=WU;function d_(e){"@babel/helpers - typeof";return d_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},d_(e)}function Lk(e,t,r){return sfe()?Lk=Reflect.construct.bind():Lk=function(i,o,s){var a=[null];a.push.apply(a,o);var h=Function.bind.apply(i,a),p=new h;return s&&bA(p,s.prototype),p},Lk.apply(null,arguments)}function N7e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function wX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,lfe(n.key),n)}}function B7e(e,t,r){return t&&wX(e.prototype,t),r&&wX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function j7e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&bA(e,t)}function bA(e,t){return bA=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},bA(e,t)}function F7e(e){var t=sfe();return function(){var n=wA(e),i;if(t){var o=wA(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return z7e(this,i)}}function z7e(e,t){if(t&&(d_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return dF(e)}function dF(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function sfe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function wA(e){return wA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},wA(e)}function SX(e,t,r){return t=lfe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function lfe(e){var t=H7e(e,"string");return d_(t)==="symbol"?t:String(t)}function H7e(e,t){if(d_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(d_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var V7e=function(e){j7e(r,e);var t=F7e(r);function r(n,i,o,s,a,h){var p;return N7e(this,r),p=t.call(this,n,i,ym,o,s),SX(dF(p),"topOverlay",void 0),SX(dF(p),"inlineStartOverlay",void 0),p.topOverlay=a,p.inlineStartOverlay=h,p}return B7e(r,[{key:"createTable",value:function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Lk(L7e,o)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;var i=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){var o=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),s=this.topOverlay.getOverlayOffset();_U(i,"".concat(o,"px"),"".concat(s,"px"))}else uM(i);var a=Ni(this.clone.wtTable.TABLE),h=ii(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(a=0),i.style.height="".concat(a,"px"),i.style.width="".concat(h,"px"),!1}}]),r}(OE);function p_(e){"@babel/helpers - typeof";return p_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},p_(e)}function xX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,W7e(n.key),n)}}function U7e(e,t,r){return t&&xX(e.prototype,t),r&&xX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function W7e(e){var t=G7e(e,"string");return p_(t)==="symbol"?t:String(t)}function G7e(e,t){if(p_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(p_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Y7e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function K7e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&pF(e,t)}function pF(e,t){return pF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},pF(e,t)}function q7e(e){var t=J7e();return function(){var n=SA(e),i;if(t){var o=SA(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return X7e(this,i)}}function X7e(e,t){if(t&&(p_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Z7e(e)}function Z7e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function J7e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function SA(e){return SA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},SA(e)}var GU=function(e){K7e(r,e);var t=q7e(r);function r(n,i,o,s){return Y7e(this,r),t.call(this,n,i,o,s,mm)}return U7e(r)}(sw);ci(GU,afe);ci(GU,HU);const Q7e=GU;function m_(e){"@babel/helpers - typeof";return m_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},m_(e)}function Nk(e,t,r){return cfe()?Nk=Reflect.construct.bind():Nk=function(i,o,s){var a=[null];a.push.apply(a,o);var h=Function.bind.apply(i,a),p=new h;return s&&xA(p,s.prototype),p},Nk.apply(null,arguments)}function eXe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function CX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ffe(n.key),n)}}function tXe(e,t,r){return t&&CX(e.prototype,t),r&&CX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function rXe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&xA(e,t)}function xA(e,t){return xA=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},xA(e,t)}function nXe(e){var t=cfe();return function(){var n=CA(e),i;if(t){var o=CA(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return iXe(this,i)}}function iXe(e,t){if(t&&(m_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ufe(e)}function ufe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function cfe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function CA(e){return CA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},CA(e)}function oXe(e,t,r){return t=ffe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ffe(e){var t=aXe(e,"string");return m_(t)==="symbol"?t:String(t)}function aXe(e,t){if(m_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(m_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var sXe=function(e){rXe(r,e);var t=nXe(r);function r(n,i,o,s){var a;return eXe(this,r),a=t.call(this,n,i,mm,o,s),oXe(ufe(a),"cachedFixedRowsTop",-1),a.cachedFixedRowsTop=a.wtSettings.getSetting("fixedRowsTop"),a}return tXe(r,[{key:"createTable",value:function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Nk(Q7e,o)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}},{key:"resetFixedPosition",value:function(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;var i=this.clone.wtTable.holder.parentNode,o=this.domBindings.rootWindow,s=this.wtSettings.getSetting("preventOverflow"),a=0,h=!1;if(this.trimmingContainer===o&&(!s||s!=="vertical")){var p=this.wot.wtTable,y=p.hider.getBoundingClientRect(),S=Math.ceil(y.bottom),E=i.offsetHeight;h=S===E,a=this.getOverlayOffset(),_U(i,"0px","".concat(a,"px"))}else a=this.getScrollPosition(),uM(i);var O=this.adjustHeaderBordersPosition(a,h);return this.adjustElementsSize(),O}},{key:"setScrollPosition",value:function(i){var o=this.domBindings.rootWindow,s=!1;return this.mainTableScrollableElement===o&&o.scrollY!==i?(o.scrollTo(Lv(o),i),s=!0):this.mainTableScrollableElement.scrollTop!==i&&(this.mainTableScrollableElement.scrollTop=i,s=!0),s}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollHorizontally")}},{key:"sumCellSizes",value:function(i,o){for(var s=this.wtSettings.getSetting("defaultRowHeight"),a=i,h=0;a<o;){var p=this.wot.wtTable.getRowHeight(a);h+=p===void 0?s:p,a+=1}return h}},{key:"adjustElementsSize",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||i)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var i=this.wot.wtTable,o=this.domBindings,s=o.rootDocument,a=o.rootWindow,h=Mo(s),p=this.clone.wtTable.holder.parentNode,y=p.style,S=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==a||S==="horizontal"){var E=this.wot.wtViewport.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(E-=h),E=Math.min(E,i.wtRootElement.scrollWidth),y.width="".concat(E,"px")}else y.width="";this.clone.wtTable.holder.style.width=y.width;var O=Ni(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(O=0),y.height="".concat(O,"px")}},{key:"adjustRootChildrenSize",value:function(){var i,o=this.clone.wtTable.holder,s=this.wot.selections,a=this.facadeGetter(),h=Math.abs((i=s==null?void 0:s.getCell().getBorder(a).cornerCenterPointOffset)!==null&&i!==void 0?i:0);this.clone.wtTable.hider.style.width=this.hider.style.width,o.style.width=o.parentNode.style.width,o.style.height="".concat(parseInt(o.parentNode.style.height,10)+h,"px")}},{key:"applyToDOM",value:function(){var i=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px");else if(i===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){var i=this.isRtl()?"right":"left",o=this.clone.wtTable.spreader;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?o.style[i]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px"):o.style[i]=""}},{key:"scrollTo",value:function(i,o){var s=this.wot,a=this.wtSettings,h=s.cloneSource?s.cloneSource:s,p=h.wtTable.holder,y=this.getTableParentOffset(),S=0;if(o){var E=this.wot.wtTable.getRowHeight(i),O=this.wot.wtViewport.getViewportHeight();E>O&&(o=!1)}if(o&&p.offsetHeight!==p.clientHeight&&(S=Mo(this.domBindings.rootDocument)),o){var A=a.getSetting("fixedRowsBottom"),$=a.getSetting("totalRows");y+=this.sumCellSizes(0,i+1),y-=s.wtViewport.getViewportHeight()-this.sumCellSizes($-A,$),y+=1}else y+=this.sumCellSizes(a.getSetting("fixedRowsTop"),i);return y+=S,this.setScrollPosition(y)}},{key:"getTableParentOffset",value:function(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}},{key:"getScrollPosition",value:function(){return KP(this.mainTableScrollableElement,this.domBindings.rootWindow)}},{key:"getOverlayOffset",value:function(){var i=this.domBindings.rootWindow,o=this.wtSettings.getSetting("preventOverflow"),s=0;if(this.trimmingContainer===i&&(!o||o!=="vertical")){var a=this.wot.wtTable.getTotalHeight(),h=this.clone.wtTable.getTotalHeight(),p=a-h;s=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),s>p&&(s=0)}return s}},{key:"adjustHeaderBordersPosition",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,s=this.wot.wtTable.holder.parentNode,a=this.wtSettings.getSetting("totalColumns");a?qr(s,"emptyColumns"):Vt(s,"emptyColumns");var h=!1;if(!o){var p=this.wtSettings.getSetting("fixedRowsTop"),y=this.cachedFixedRowsTop!==p,S=this.wtSettings.getSetting("columnHeaders");if((y||p===0)&&S.length>0){var E=Wr(s,"innerBorderTop");this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop"),i||this.wtSettings.getSetting("totalRows")===0?(Vt(s,"innerBorderTop"),h=!E):(qr(s,"innerBorderTop"),h=E)}}return h}}]),r}(OE);function lx(e){"@babel/helpers - typeof";return lx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lx(e)}function ih(e,t,r){return lXe()?ih=Reflect.construct.bind():ih=function(i,o,s){var a=[null];a.push.apply(a,o);var h=Function.bind.apply(i,a),p=new h;return s&&mF(p,s.prototype),p},ih.apply(null,arguments)}function lXe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function mF(e,t){return mF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},mF(e,t)}function uXe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function EX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,hfe(n.key),n)}}function cXe(e,t,r){return t&&EX(e.prototype,t),r&&EX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function qu(e,t,r){return t=hfe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function hfe(e){var t=fXe(e,"string");return lx(t)==="symbol"?t:String(t)}function fXe(e,t){if(lx(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(lx(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var hXe=function(){function e(t,r,n,i,o,s){var a=this;uXe(this,e),qu(this,"wot",null),qu(this,"topOverlay",null),qu(this,"bottomOverlay",null),qu(this,"inlineStartOverlay",null),qu(this,"topInlineStartCornerOverlay",null),qu(this,"bottomInlineStartCornerOverlay",null),qu(this,"browserLineHeight",void 0),qu(this,"wtSettings",null),qu(this,"resizeObserver",new ResizeObserver(function(E){yU(function(){!Array.isArray(E)||!E.length||a.wtSettings.getSetting("onContainerElementResize")})})),this.wot=t,this.wtSettings=i,this.domBindings=n,this.facadeGetter=r,this.wtTable=s;var h=this.domBindings,p=h.rootDocument,y=h.rootWindow;this.instance=this.wot,this.eventManager=o,this.scrollbarSize=Mo(p);var S=y.getComputedStyle(s.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=S?s.holder:qP(s.TABLE),this.initOverlays(),this.hasScrollbarBottom=!1,this.hasScrollbarRight=!1,this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=y.scrollX,this.lastScrollY=y.scrollY}return cXe(e,[{key:"getOverlays",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=[this.topOverlay,this.topInlineStartCornerOverlay,this.inlineStartOverlay,this.bottomOverlay,this.bottomInlineStartCornerOverlay];return r&&n.push(this.wtTable),n}},{key:"initBrowserLineHeight",value:function(){var r=this.domBindings,n=r.rootWindow,i=r.rootDocument,o=n.getComputedStyle(i.body),s=parseInt(o.lineHeight,10),a=parseInt(o.fontSize,10)*1.2;this.browserLineHeight=s||a}},{key:"initOverlays",value:function(){var r=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=ih(sXe,r),this.bottomOverlay=ih(o7e,r),this.inlineStartOverlay=ih(E7e,r),this.topInlineStartCornerOverlay=ih(V7e,r.concat([this.topOverlay,this.inlineStartOverlay])),this.bottomInlineStartCornerOverlay=ih(F9e,r.concat([this.bottomOverlay,this.inlineStartOverlay]))}},{key:"updateStateOfRendering",value:function(){var r=this.topOverlay.updateStateOfRendering();return r=this.bottomOverlay.updateStateOfRendering()||r,r=this.inlineStartOverlay.updateStateOfRendering()||r,this.inlineStartOverlay.needFullRender&&(this.topOverlay.needFullRender&&(r=this.topInlineStartCornerOverlay.updateStateOfRendering()||r),this.bottomOverlay.needFullRender&&(r=this.bottomInlineStartCornerOverlay.updateStateOfRendering()||r)),r}},{key:"refreshAll",value:function(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}},{key:"registerListeners",value:function(){var r=this,n=this.domBindings,i=n.rootDocument,o=n.rootWindow,s=this.topOverlay.mainTableScrollableElement,a=this.inlineStartOverlay.mainTableScrollableElement;this.eventManager.addEventListener(i.documentElement,"keydown",function(A){return r.onKeyDown(A)}),this.eventManager.addEventListener(i.documentElement,"keyup",function(){return r.onKeyUp()}),this.eventManager.addEventListener(i,"visibilitychange",function(){return r.onKeyUp()}),this.eventManager.addEventListener(s,"scroll",function(A){return r.onTableScroll(A)},{passive:!0}),s!==a&&this.eventManager.addEventListener(a,"scroll",function(A){return r.onTableScroll(A)},{passive:!0});var h=o.devicePixelRatio&&o.devicePixelRatio>1,p=this.scrollableElement===o,y=this.wtSettings.getSetting("preventWheel"),S={passive:p};(y||h||!Mue())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",function(A){return r.onCloneWheel(A,y)},S);var E=[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];E.forEach(function(A){if(A&&A.needFullRender){var $=A.clone.wtTable.holder;r.eventManager.addEventListener($,"wheel",function(B){return r.onCloneWheel(B,y)},S)}});var O;this.eventManager.addEventListener(o,"resize",function(){clearTimeout(O),O=setTimeout(function(){r.wtSettings.getSetting("onWindowResize")},200)}),p||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}},{key:"deregisterListeners",value:function(){this.eventManager.clearEvents(!0)}},{key:"onTableScroll",value:function(r){var n=this.domBindings.rootWindow,i=this.inlineStartOverlay.mainTableScrollableElement,o=this.topOverlay.mainTableScrollableElement,s=r.target;this.keyPressed&&(o!==n&&s!==n&&!r.target.contains(o)||i!==n&&s!==n&&!r.target.contains(i))||this.syncScrollPositions(r)}},{key:"onCloneWheel",value:function(r,n){var i=this.domBindings.rootWindow,o=this.inlineStartOverlay.mainTableScrollableElement,s=this.topOverlay.mainTableScrollableElement,a=r.target,h=s!==i&&a!==i&&!a.contains(s),p=o!==i&&a!==i&&!a.contains(o);if(!(this.keyPressed&&(h||p))){var y=this.translateMouseWheelToScroll(r);(n||this.scrollableElement!==i&&y)&&r.preventDefault()}}},{key:"onKeyDown",value:function(r){this.keyPressed=A1(r.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}},{key:"onKeyUp",value:function(){this.keyPressed=!1}},{key:"translateMouseWheelToScroll",value:function(r){var n=isNaN(r.deltaY)?-1*r.wheelDeltaY:r.deltaY,i=isNaN(r.deltaX)?-1*r.wheelDeltaX:r.deltaX;r.deltaMode===1&&(i+=i*this.browserLineHeight,n+=n*this.browserLineHeight);var o=this.scrollVertically(n),s=this.scrollHorizontally(i);return o||s}},{key:"scrollVertically",value:function(r){var n=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=r,n!==this.scrollableElement.scrollTop}},{key:"scrollHorizontally",value:function(r){var n=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=r,n!==this.scrollableElement.scrollLeft}},{key:"syncScrollPositions",value:function(){if(!this.destroyed){var r=this.domBindings.rootWindow,n=this.topOverlay.clone.wtTable.holder,i=this.inlineStartOverlay.clone.wtTable.holder,o=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop],s=o[0],a=o[1];if(this.horizontalScrolling=n.scrollLeft!==s||this.lastScrollX!==r.scrollX,this.verticalScrolling=i.scrollTop!==a||this.lastScrollY!==r.scrollY,this.lastScrollX=r.scrollX,this.lastScrollY=r.scrollY,this.horizontalScrolling){n.scrollLeft=s;var h=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;h&&(h.scrollLeft=s)}this.verticalScrolling&&(i.scrollTop=a),this.refreshAll()}}},{key:"syncScrollWithMaster",value:function(){var r=this.topOverlay.mainTableScrollableElement,n=r.scrollLeft,i=r.scrollTop;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=n),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=n),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=i)}},{key:"updateMainScrollableElements",value:function(){this.deregisterListeners(),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();var r=this.wtTable,n=this.domBindings.rootWindow;n.getComputedStyle(r.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=r.holder:this.scrollableElement=qP(r.TABLE),this.registerListeners()}},{key:"destroy",value:function(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}},{key:"refresh",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.updateLastSpreaderSize();n&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(r),this.inlineStartOverlay.refresh(r),this.topOverlay.refresh(r),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(r),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(r)}},{key:"updateLastSpreaderSize",value:function(){var r=this.wtTable.spreader,n=r.clientWidth,i=r.clientHeight,o=n!==this.spreaderLastSize.width||i!==this.spreaderLastSize.height;return o&&(this.spreaderLastSize.width=n,this.spreaderLastSize.height=i),o}},{key:"adjustElementsSize",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.wot.wtViewport,i=this.wtTable,o=this.wtSettings.getSetting("totalColumns"),s=this.wtSettings.getSetting("totalRows"),a=n.getRowHeaderWidth(),h=n.getColumnHeaderHeight(),p=i.hider.style;if(p.width="".concat(a+this.inlineStartOverlay.sumCellSizes(0,o),"px"),p.height="".concat(h+this.topOverlay.sumCellSizes(0,s)+1,"px"),this.scrollbarSize>0){var y=i.wtRootElement,S=y.scrollHeight,E=y.scrollWidth,O=i.holder,A=O.scrollHeight,$=O.scrollWidth;this.hasScrollbarRight=S<A,this.hasScrollbarBottom=E<$,this.hasScrollbarRight&&i.hider.scrollWidth+this.scrollbarSize>E?this.hasScrollbarBottom=!0:this.hasScrollbarBottom&&i.hider.scrollHeight+this.scrollbarSize>S&&(this.hasScrollbarRight=!0)}this.topOverlay.adjustElementsSize(r),this.inlineStartOverlay.adjustElementsSize(r),this.bottomOverlay.adjustElementsSize(r)}},{key:"applyToDOM",value:function(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}},{key:"getParentOverlay",value:function(r){if(!r)return null;var n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay],i=null;return Fe(n,function(o){o&&o.clone&&o.clone.wtTable.TABLE.contains(r)&&(i=o.clone)}),i}},{key:"syncOverlayTableClassNames",value:function(){var r=this.wtTable.TABLE,n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];Fe(n,function(i){i&&(i.clone.wtTable.TABLE.className=r.className)})}}]),e}();const dXe=hXe;function ux(e){"@babel/helpers - typeof";return ux=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ux(e)}function pXe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function TX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,dfe(n.key),n)}}function mXe(e,t,r){return t&&TX(e.prototype,t),r&&TX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function OX(e,t,r){return t=dfe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function dfe(e){var t=gXe(e,"string");return ux(t)==="symbol"?t:String(t)}function gXe(e,t){if(ux(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ux(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var yXe=function(){function e(t){var r=this;pXe(this,e),OX(this,"settings",{}),OX(this,"defaults",Object.freeze(this.getDefaults())),mn(this.defaults,function(n,i){if(t[i]!==void 0)r.settings[i]=t[i];else{if(n===void 0)throw new Error('A required setting "'.concat(i,'" was not provided'));r.settings[i]=n}})}return mXe(e,[{key:"getDefaults",value:function(){var r=this;return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow:function(){return!1},preventWheel:!1,data:void 0,freezeOverlays:!1,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:function(){return r.getSetting("fixedColumnsStart")>0||r.getSetting("rowHeaders").length>0},shouldRenderTopOverlay:function(){return r.getSetting("fixedRowsTop")>0||r.getSetting("columnHeaders").length>0},shouldRenderBottomOverlay:function(){return r.getSetting("fixedRowsBottom")>0},minSpareRows:0,rowHeaders:function(){return[]},columnHeaders:function(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:function(i,o,s){var a=r.getSetting("data",i,o);fm(s,a??"")},columnWidth:function(){},rowHeight:function(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onScrollVertically:null,onScrollHorizontally:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:function(i){return i},onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onBeforeHighlightingRowHeader:function(i){return i},onBeforeHighlightingColumnHeader:function(i){return i},onWindowResize:null,onContainerElementResize:null,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1}}},{key:"update",value:function(r,n){var i=this;return n===void 0?mn(r,function(o,s){i.settings[s]=o}):this.settings[r]=n,this}},{key:"getSetting",value:function(r,n,i,o,s){return typeof this.settings[r]=="function"?this.settings[r](n,i,o,s):n!==void 0&&Array.isArray(this.settings[r])?this.settings[r][n]:this.settings[r]}},{key:"getSettingPure",value:function(r){return this.settings[r]}},{key:"has",value:function(r){return!!this.settings[r]}}]),e}();function g_(e){"@babel/helpers - typeof";return g_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},g_(e)}function vXe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function RX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,bXe(n.key),n)}}function _Xe(e,t,r){return t&&RX(e.prototype,t),r&&RX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function bXe(e){var t=wXe(e,"string");return g_(t)==="symbol"?t:String(t)}function wXe(e,t){if(g_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(g_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function SXe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&gF(e,t)}function gF(e,t){return gF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},gF(e,t)}function xXe(e){var t=TXe();return function(){var n=EA(e),i;if(t){var o=EA(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return CXe(this,i)}}function CXe(e,t){if(t&&(g_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return EXe(e)}function EXe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function TXe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function EA(e){return EA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},EA(e)}var YU=function(e){SXe(r,e);var t=xXe(r);function r(n,i,o,s){return vXe(this,r),t.call(this,n,i,o,s,"master")}return _Xe(r,[{key:"alignOverlaysWithTrimmingContainer",value:function(){var i=$1(this.wtRootElement),o=this.domBindings.rootWindow;if(i===o){var s=this.wtSettings.getSetting("preventOverflow");s||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible")}else{var a=i.parentElement,h=D1(i,"height",o),p=D1(i,"overflow",o),y=this.holder.style,S=i.scrollWidth,E=i.scrollHeight,O=i.getBoundingClientRect(),A=O.width,$=O.height,B=["auto","hidden","scroll"];if(a&&B.includes(p)){var j=i.cloneNode(!1);j.style.overflow="auto",j.style.position="absolute",i.nextElementSibling?a.insertBefore(j,i.nextElementSibling):a.appendChild(j);var z=parseInt(hm(j,o).height,10);a.removeChild(j),z===0&&($=0)}$=Math.min($,E),y.height=h==="auto"?"auto":"".concat($,"px"),A=Math.min(A,S),y.width="".concat(A,"px"),y.overflow="",this.hasTableHeight=y.height==="auto"?!0:$>0,this.hasTableWidth=A>0}this.isTableVisible=I1(this.TABLE)}},{key:"markOversizedColumnHeaders",value:function(){var i=this.wtSettings,o=this.dataAccessObject.wtViewport,s="master",a=i.getSetting("columnHeaders"),h=a.length;if(h&&!o.hasOversizedColumnHeadersMarked[s]){for(var p=i.getSetting("rowHeaders"),y=p.length,S=this.getRenderedColumnsCount(),E=0;E<h;E++)for(var O=-1*y;O<S;O++)this.markIfOversizedColumnHeader(O);o.hasOversizedColumnHeadersMarked[s]=!0}}}]),r}(sw);ci(YU,nfe);ci(YU,HU);const OXe=YU;function cx(e){"@babel/helpers - typeof";return cx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cx(e)}function RXe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,PXe(n.key),n)}}function kXe(e,t,r){return t&&kX(e.prototype,t),r&&kX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function PXe(e){var t=AXe(e,"string");return cx(t)==="symbol"?t:String(t)}function AXe(e,t){if(cx(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(cx(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var IXe=function(){function e(t,r,n,i,o){var s=this;RXe(this,e),this.dataAccessObject=t,this.wot=t.wot,this.instance=this.wot,this.domBindings=r,this.wtSettings=n,this.wtTable=o,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.eventManager=i,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",function(){s.clientHeight=s.getWorkspaceHeight()})}return kXe(e,[{key:"getWorkspaceHeight",value:function(){var r=this.domBindings.rootDocument,n=this.dataAccessObject.topOverlayTrimmingContainer,i=0;if(n===this.domBindings.rootWindow)i=r.documentElement.clientHeight;else{var o=Ni(n);i=o>0&&n.clientHeight>0?n.clientHeight:1/0}return i}},{key:"getWorkspaceWidth",value:function(){var r=this.wtSettings,n=this.domBindings,i=n.rootDocument,o=n.rootWindow,s=this.dataAccessObject.inlineStartOverlayTrimmingContainer,a=i.documentElement.offsetWidth,h=r.getSetting("totalColumns"),p=r.getSetting("preventOverflow"),y=r.getSetting("rtlMode"),S=this.wtTable.TABLE.getBoundingClientRect(),E=y?S.right-a:S.left,O=a-E,A,$;if(p)return ii(this.wtTable.wtRootElement);if(r.getSetting("freezeOverlays")?A=Math.min(O,a):A=Math.min(this.getContainerFillWidth(),O,a),s===o&&h>0&&this.sumColumnWidths(0,h-1)>A)return i.documentElement.clientWidth;if(s!==o&&($=D1(this.dataAccessObject.inlineStartOverlayTrimmingContainer,"overflow",o),$==="scroll"||$==="hidden"||$==="auto"))return Math.max(A,s.clientWidth);var B=r.getSetting("stretchH");return B==="none"||!B?Math.max(A,ii(this.wtTable.TABLE)):A}},{key:"hasVerticalScroll",value:function(){return this.wtTable.hider.offsetHeight>this.getWorkspaceHeight()}},{key:"hasHorizontalScroll",value:function(){return this.wtTable.hider.offsetWidth>this.getWorkspaceWidth()}},{key:"sumColumnWidths",value:function(r,n){for(var i=0,o=r;o<n;)i+=this.wtTable.getColumnWidth(o),o+=1;return i}},{key:"getContainerFillWidth",value:function(){if(this.containerWidth)return this.containerWidth;var r=this.wtTable.holder,n=this.domBindings.rootDocument.createElement("div");n.style.width="100%",n.style.height="1px",r.appendChild(n);var i=n.offsetWidth;return this.containerWidth=i,r.removeChild(n),i}},{key:"getWorkspaceOffset",value:function(){return ao(this.wtTable.TABLE)}},{key:"getColumnHeaderHeight",value:function(){var r=this.wtSettings.getSetting("columnHeaders");return r.length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=Ni(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}},{key:"getViewportHeight",value:function(){var r=this.getWorkspaceHeight();if(r===1/0)return r;var n=this.getColumnHeaderHeight();return n>0&&(r-=n),r}},{key:"getRowHeaderWidth",value:function(){var r=this.wtSettings.getSetting("rowHeaderWidth"),n=this.wtSettings.getSetting("rowHeaders");if(r){this.rowHeaderWidth=0;for(var i=0,o=n.length;i<o;i++)this.rowHeaderWidth+=r[i]||r}if(isNaN(this.rowHeaderWidth))if(n.length){var s=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(var a=0,h=n.length;a<h;a++)s?(this.rowHeaderWidth+=ii(s),s=s.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}},{key:"getViewportWidth",value:function(){var r=this.getWorkspaceWidth();if(r===1/0)return r;var n=this.getRowHeaderWidth();return n>0?r-n:r}},{key:"createRowsCalculator",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:mp,n=this.wtSettings,i=this.wtTable,o,s,a;this.rowHeaderWidth=NaN,n.getSetting("renderAllRows")&&r===mp?o=1/0:o=this.getViewportHeight();var h=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset,p=n.getSetting("fixedRowsTop"),y=n.getSetting("fixedRowsBottom"),S=n.getSetting("totalRows");return p&&h>=0&&(a=this.dataAccessObject.topOverlay.sumCellSizes(0,p),h+=a,o-=a),y&&this.dataAccessObject.bottomOverlay.clone&&(a=this.dataAccessObject.bottomOverlay.sumCellSizes(S-y,S),o-=a),i.holder.clientHeight===i.holder.offsetHeight?s=0:s=Mo(this.domBindings.rootDocument),new $ce({viewportSize:o,scrollOffset:h,totalItems:n.getSetting("totalRows"),itemSizeFn:function(O){return i.getRowHeight(O)},overrideFn:n.getSettingPure("viewportRowCalculatorOverride"),calculationType:r,scrollbarHeight:s})}},{key:"createColumnsCalculator",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:mp,n=this.wtSettings,i=this.wtTable,o=this.getViewportWidth(),s=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;var a=n.getSetting("fixedColumnsStart");if(a&&s>=0){var h=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,a);s+=h,o-=h}return i.holder.clientWidth!==i.holder.offsetWidth&&(o-=Mo(this.domBindings.rootDocument)),new NU({viewportSize:o,scrollOffset:s,totalItems:n.getSetting("totalColumns"),itemSizeFn:function(y){return i.getColumnWidth(y)},overrideFn:n.getSettingPure("viewportColumnCalculatorOverride"),calculationType:r,stretchMode:n.getSetting("stretchH"),stretchingItemWidthFn:function(y,S){return n.getSetting("onBeforeStretchingColumnWidth",y,S)},inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}},{key:"createRenderCalculators",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=r;if(n){var i=this.createRowsCalculator(ea),o=this.createColumnsCalculator(ea);this.areAllProposedVisibleRowsAlreadyRendered(i)&&this.areAllProposedVisibleColumnsAlreadyRendered(o)||(n=!1)}return n||(this.rowsRenderCalculator=this.createRowsCalculator(mp),this.columnsRenderCalculator=this.createColumnsCalculator(mp)),this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,n}},{key:"createVisibleCalculators",value:function(){this.rowsVisibleCalculator=this.createRowsCalculator(ea),this.columnsVisibleCalculator=this.createColumnsCalculator(ea)}},{key:"areAllProposedVisibleRowsAlreadyRendered",value:function(r){if(!this.rowsVisibleCalculator)return!1;var n=r.startRow,i=r.endRow,o=r.isVisibleInTrimmingContainer;if(n===null&&i===null)return!o;var s=this.rowsRenderCalculator,a=s.startRow,h=s.endRow;return n<a||n===a&&n>0?!1:!(i>h||i===h&&i<this.wtSettings.getSetting("totalRows")-1)}},{key:"areAllProposedVisibleColumnsAlreadyRendered",value:function(r){if(!this.columnsVisibleCalculator)return!1;var n=r.startColumn,i=r.endColumn,o=r.isVisibleInTrimmingContainer;if(n===null&&i===null)return!o;var s=this.columnsRenderCalculator,a=s.startColumn,h=s.endColumn;return n<a||n===a&&n>0?!1:!(i>h||i===h&&i<this.wtSettings.getSetting("totalColumns")-1)}},{key:"resetHasOversizedColumnHeadersMarked",value:function(){mn(this.hasOversizedColumnHeadersMarked,function(r,n,i){i[n]=void 0})}}]),e}();const MXe=IXe;function y_(e){"@babel/helpers - typeof";return y_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},y_(e)}function $Xe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function PX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,LXe(n.key),n)}}function DXe(e,t,r){return t&&PX(e.prototype,t),r&&PX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function LXe(e){var t=NXe(e,"string");return y_(t)==="symbol"?t:String(t)}function NXe(e,t){if(y_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(y_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function BXe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&yF(e,t)}function yF(e,t){return yF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},yF(e,t)}function jXe(e){var t=zXe();return function(){var n=TA(e),i;if(t){var o=TA(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return FXe(this,i)}}function FXe(e,t){if(t&&(y_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return vF(e)}function vF(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function zXe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function TA(e){return TA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},TA(e)}var HXe=function(e){BXe(r,e);var t=jXe(r);function r(n,i){var o;$Xe(this,r),o=t.call(this,n,new yXe(i));var s=o.wtSettings.getSetting("facade",vF(o));return o.wtTable=new OXe(o.getTableDao(),s,o.domBindings,o.wtSettings),o.wtViewport=new MXe(o.getViewportDao(),o.domBindings,o.wtSettings,o.eventManager,o.wtTable),o.selections=o.wtSettings.getSetting("selections"),o.wtEvent=new jce(s,o.domBindings,o.wtSettings,o.eventManager,o.wtTable,o.selections),o.wtOverlays=new dXe(vF(o),s,o.domBindings,o.wtSettings,o.eventManager,o.wtTable),o.exportSettingsAsClassNames(),o.findOriginalHeaders(),o}return DXe(r,[{key:"exportSettingsAsClassNames",value:function(){var i=this,o={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},s=[],a=[];mn(o,function(h,p){i.wtSettings.getSetting(p).length&&a.push(h),s.push(h)}),qr(this.wtTable.wtRootElement.parentNode,s),Vt(this.wtTable.wtRootElement.parentNode,a)}},{key:"getViewportDao",value:function(){var i=this;return{get wot(){return i},get topOverlayTrimmingContainer(){return i.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return i.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return i.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return i.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return i.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return i.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return i.wtOverlays.topOverlay},get inlineStartOverlay(){return i.wtOverlays.inlineStartOverlay},get bottomOverlay(){return i.wtOverlays.bottomOverlay}}}}]),r}(zU);function fx(e){"@babel/helpers - typeof";return fx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fx(e)}function VXe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function AX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,WXe(n.key),n)}}function UXe(e,t,r){return t&&AX(e.prototype,t),r&&AX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function WXe(e){var t=GXe(e,"string");return fx(t)==="symbol"?t:String(t)}function GXe(e,t){if(fx(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(fx(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var YXe=function(){function e(t){VXe(this,e),t instanceof zU?this._wot=t:this._initFromSettings(t)}return UXe(e,[{key:"_initFromSettings",value:function(r){r.facade=function(n){var i=new e(n);return function(){return i}},this._wot=new HXe(r.table,r)}},{key:"guid",get:function(){return this._wot.guid}},{key:"rootDocument",get:function(){return this._wot.domBindings.rootDocument}},{key:"rootWindow",get:function(){return this._wot.domBindings.rootWindow}},{key:"wtSettings",get:function(){return this._wot.wtSettings}},{key:"cloneSource",get:function(){return this._wot.cloneSource}},{key:"cloneOverlay",get:function(){return this._wot.cloneOverlay}},{key:"selections",get:function(){return this._wot.selections}},{key:"wtViewport",get:function(){return this._wot.wtViewport}},{key:"wtOverlays",get:function(){return this._wot.wtOverlays}},{key:"wtTable",get:function(){return this._wot.wtTable}},{key:"wtEvent",get:function(){return this._wot.wtEvent}},{key:"wtScroll",get:function(){return this._wot.wtScroll}},{key:"drawn",get:function(){return this._wot.drawn},set:function(r){this._wot.drawn=r}},{key:"drawInterrupted",get:function(){return this._wot.drawInterrupted},set:function(r){this._wot.drawInterrupted=r}},{key:"lastMouseOver",get:function(){return this._wot.lastMouseOver},set:function(r){this._wot.lastMouseOver=r}},{key:"momentumScrolling",get:function(){return this._wot.momentumScrolling},set:function(r){this._wot.momentumScrolling=r}},{key:"touchApplied",get:function(){return this._wot.touchApplied},set:function(r){this._wot.touchApplied=r}},{key:"domBindings",get:function(){return this._wot.domBindings}},{key:"eventListeners",get:function(){return this._wot.eventListeners},set:function(r){this._wot.eventListeners=r}},{key:"eventManager",get:function(){return this._wot.eventManager}},{key:"createCellCoords",value:function(r,n){return this._wot.createCellCoords(r,n)}},{key:"createCellRange",value:function(r,n,i){return this._wot.createCellRange(r,n,i)}},{key:"draw",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(r),this}},{key:"getCell",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(r,n)}},{key:"scrollViewport",value:function(r,n,i,o,s){return this._wot.scrollViewport(r,n,i,o,s)}},{key:"scrollViewportHorizontally",value:function(r,n,i){return this._wot.scrollViewportHorizontally(r,n,i)}},{key:"scrollViewportVertically",value:function(r,n,i){return this._wot.scrollViewportVertically(r,n,i)}},{key:"getViewport",value:function(){return this._wot.getViewport()}},{key:"getOverlayName",value:function(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}},{key:"exportSettingsAsClassNames",value:function(){return this._wot.exportSettingsAsClassNames()}},{key:"update",value:function(r,n){return this._wot.wtSettings.update(r,n),this}},{key:"getSetting",value:function(r,n,i,o,s){return this._wot.wtSettings.getSetting(r,n,i,o,s)}},{key:"hasSetting",value:function(r){return this._wot.wtSettings.hasSetting(r)}},{key:"destroy",value:function(){this._wot.destroy()}}]),e}(),KXe=eo,pfe=sn,qXe=JC,XXe=ys,ZXe=rE.f,JXe=pfe(ZXe),QXe=pfe([].push),IX=function(e){return function(t){for(var r=XXe(t),n=qXe(r),i=n.length,o=0,s=[],a;i>o;)a=n[o++],(!KXe||JXe(r,a))&&QXe(s,e?[a,r[a]]:r[a]);return s}},eZe={entries:IX(!0),values:IX(!1)},tZe=jr,rZe=eZe.values;tZe({target:"Object",stat:!0},{values:function(t){return rZe(t)}});function hx(e){"@babel/helpers - typeof";return hx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hx(e)}function mL(e,t){return aZe(e)||oZe(e,t)||iZe(e,t)||nZe()}function nZe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function iZe(e,t){if(e){if(typeof e=="string")return MX(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return MX(e,t)}}function MX(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function oZe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],h=!0,p=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;h=!1}else for(;!(h=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);h=!0);}catch(y){p=!0,i=y}finally{try{if(!h&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(p)throw i}}return a}}function aZe(e){if(Array.isArray(e))return e}function sZe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $X(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,uZe(n.key),n)}}function lZe(e,t,r){return t&&$X(e.prototype,t),r&&$X(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function uZe(e){var t=cZe(e,"string");return hx(t)==="symbol"?t:String(t)}function cZe(e,t){if(hx(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(hx(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var fZe=function(){function e(t,r){sZe(this,e),r&&(this.eventManager=t.eventManager,this.instance=t,this.wot=t,this.settings=r,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle={width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"},this.cornerCenterPointOffset=-(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(r),this.registerListeners())}return lZe(e,[{key:"registerListeners",value:function(){var r=this,n=this.wot.rootDocument.body;this.eventManager.addEventListener(n,"mousedown",function(){return r.onMouseDown()}),this.eventManager.addEventListener(n,"mouseup",function(){return r.onMouseUp()});for(var i=function(h){var p=r.main.childNodes[h];r.eventManager.addEventListener(p,"mouseenter",function(y){return r.onMouseEnter(y,r.main.childNodes[h])})},o=0,s=this.main.childNodes.length;o<s;o++)i(o)}},{key:"onMouseDown",value:function(){this.mouseDown=!0}},{key:"onMouseUp",value:function(){this.mouseDown=!1}},{key:"onMouseEnter",value:function(r,n){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;r.preventDefault(),Cu(r);var i=this,o=this.wot.rootDocument.body,s=n.getBoundingClientRect();n.style.display="none";function a(p){if(p.clientY<Math.floor(s.top)||p.clientY>Math.ceil(s.top+s.height)||p.clientX<Math.floor(s.left)||p.clientX>Math.ceil(s.left+s.width))return!0}function h(p){a(p)&&(i.eventManager.removeEventListener(o,"mousemove",h),n.style.display="block")}this.eventManager.addEventListener(o,"mousemove",h)}},{key:"createBorders",value:function(r){var n=this.wot.rootDocument;this.main=n.createElement("div");var i=["top","start","bottom","end","corner"],o=this.main.style;o.position="absolute",o.top=0,o.left=0;for(var s=0;s<5;s++){var a=i[s],h=n.createElement("div");h.className="wtBorder ".concat(this.settings.className||""),this.settings[a]&&this.settings[a].hide&&(h.className+=" hidden"),o=h.style,o.backgroundColor=this.settings[a]&&this.settings[a].color?this.settings[a].color:r.border.color,o.height=this.settings[a]&&this.settings[a].width?"".concat(this.settings[a].width,"px"):"".concat(r.border.width,"px"),o.width=this.settings[a]&&this.settings[a].width?"".concat(this.settings[a].width,"px"):"".concat(r.border.width,"px"),this.main.appendChild(h)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),gu()&&this.createMultipleSelectorHandles(),this.disappear();var p=this.wot.wtTable,y=p.bordersHolder;y||(y=n.createElement("div"),y.className="htBorders",p.bordersHolder=y,p.spreader.appendChild(y)),y.appendChild(this.main)}},{key:"createMultipleSelectorHandles",value:function(){var r=this,n=this.wot.rootDocument;this.selectionHandles={top:n.createElement("DIV"),topHitArea:n.createElement("DIV"),bottom:n.createElement("DIV"),bottomHitArea:n.createElement("DIV")};var i=10,o=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};var s={position:"absolute",height:"".concat(o,"px"),width:"".concat(o,"px"),"border-radius":"".concat(parseInt(o/1.5,10),"px")};mn(s,function(h,p){r.selectionHandles.styles.bottomHitArea[p]=h,r.selectionHandles.styles.topHitArea[p]=h});var a={position:"absolute",height:"".concat(i,"px"),width:"".concat(i,"px"),"border-radius":"".concat(parseInt(i/1.5,10),"px"),background:"#F5F5FF",border:"1px solid #4285c8"};mn(a,function(h,p){r.selectionHandles.styles.bottom[p]=h,r.selectionHandles.styles.top[p]=h}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}},{key:"isPartRange",value:function(r,n){var i=this.wot.selections.createOrGetArea();return!!(i.cellRange&&(r!==i.cellRange.to.row||n!==i.cellRange.to.col))}},{key:"updateMultipleSelectionHandlesPosition",value:function(r,n,i,o,s,a){var h=this.wot.wtSettings.getSetting("rtlMode"),p=h?"right":"left",y=this.selectionHandles.styles,S=y.top,E=y.topHitArea,O=y.bottom,A=y.bottomHitArea,$=parseInt(S.borderWidth,10),B=parseInt(S.width,10),j=parseInt(E.width,10),z=this.wot.wtTable.getWidth(),W=this.wot.wtTable.getHeight();S.top="".concat(parseInt(i-B-1,10),"px"),S[p]="".concat(parseInt(o-B-1,10),"px"),E.top="".concat(parseInt(i-j/4*3,10),"px"),E[p]="".concat(parseInt(o-j/4*3,10),"px");var Q=Math.min(parseInt(o+s,10),z-B-$*2),q=Math.min(parseInt(o+s-j/4,10),z-j-$*2);O[p]="".concat(Q,"px"),A[p]="".concat(q,"px");var Se=Math.min(parseInt(i+a,10),W-B-$*2),Ie=Math.min(parseInt(i+a-j/4,10),W-j-$*2);O.top="".concat(Se,"px"),A.top="".concat(Ie,"px"),this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(S.display="block",E.display="block",this.isPartRange(r,n)?(O.display="none",A.display="none"):(O.display="block",A.display="block")):(S.display="none",O.display="none",E.display="none",A.display="none"),r===this.wot.wtSettings.getSetting("fixedRowsTop")||n===this.wot.wtSettings.getSetting("fixedColumnsStart")?(S.zIndex="9999",E.zIndex="9999"):(S.zIndex="",E.zIndex="")}},{key:"appear",value:function(r){if(!this.disabled){for(var n=this.wot,i=n.wtTable,o=n.rootDocument,s=n.rootWindow,a,h,p,y,S,E,O=i.getRenderedRowsCount(),A=0;A<O;A+=1){var $=i.rowFilter.renderedToSource(A);if($>=r[0]&&$<=r[2]){a=$,S=r[0];break}}for(var B=O-1;B>=0;B-=1){var j=i.rowFilter.renderedToSource(B);if(j>=r[0]&&j<=r[2]){h=j;break}}for(var z=i.getRenderedColumnsCount(),W=0;W<z;W+=1){var Q=i.columnFilter.renderedToSource(W);if(Q>=r[1]&&Q<=r[3]){p=Q,E=r[1];break}}for(var q=z-1;q>=0;q-=1){var Se=i.columnFilter.renderedToSource(q);if(Se>=r[1]&&Se<=r[3]){y=Se;break}}if(a===void 0||p===void 0){this.disappear();return}var Ie=i.getCell(this.wot.createCellCoords(a,p)),He=a!==h||p!==y,Le=He?i.getCell(this.wot.createCellCoords(h,y)):Ie,ze=ao(Ie),ct=He?ao(Le):ze,At=ao(i.TABLE),Qe=ii(i.TABLE),de=ze.top,Ce=ze.left,pt=this.wot.wtSettings.getSetting("rtlMode"),Ct=0,ie=0;if(pt){var M=ii(Ie),U=s.innerWidth-At.left-Qe;ie=Ce+M-ct.left,Ct=s.innerWidth-Ce-M-U-1}else ie=ct.left+ii(Le)-Ce,Ct=Ce-At.left-1;if(this.isEntireColumnSelected(a,h)){var K=this.getDimensionsFromHeader("columns",p,y,S,At),re=null;if(K){var me=mL(K,3);re=me[0],Ct=me[1],ie=me[2]}re&&(Ie=re)}var Oe=de-At.top-1,We=ct.top+Ni(Le)-de;if(this.isEntireRowSelected(p,y)){var Je=this.getDimensionsFromHeader("rows",a,h,E,At),ht=null;if(Je){var ft=mL(Je,3);ht=ft[0],Oe=ft[1],We=ft[2]}ht&&(Ie=ht)}var St=hm(Ie,s);parseInt(St.borderTopWidth,10)>0&&(Oe+=1,We=We>0?We-1:0),parseInt(St[pt?"borderRightWidth":"borderLeftWidth"],10)>0&&(Ct+=1,ie=ie>0?ie-1:0);var Tt=pt?"right":"left";this.topStyle.top="".concat(Oe,"px"),this.topStyle[Tt]="".concat(Ct,"px"),this.topStyle.width="".concat(ie,"px"),this.topStyle.display="block",this.startStyle.top="".concat(Oe,"px"),this.startStyle[Tt]="".concat(Ct,"px"),this.startStyle.height="".concat(We,"px"),this.startStyle.display="block";var Xt=Math.floor(this.settings.border.width/2);this.bottomStyle.top="".concat(Oe+We-Xt,"px"),this.bottomStyle[Tt]="".concat(Ct,"px"),this.bottomStyle.width="".concat(ie,"px"),this.bottomStyle.display="block",this.endStyle.top="".concat(Oe,"px"),this.endStyle[Tt]="".concat(Ct+ie-Xt,"px"),this.endStyle.height="".concat(We+1,"px"),this.endStyle.display="block";var jt=this.settings.border.cornerVisible;jt=typeof jt=="function"?jt(this.settings.layerLevel):jt;var Kt=this.wot.getSetting("onModifyGetCellCoords",h,y),qe=h,yr=y;if(Kt&&Array.isArray(Kt)){var Ar=mL(Kt,4);qe=Ar[2],yr=Ar[3]}if(gu()||!jt||this.isPartRange(qe,yr))this.cornerStyle.display="none";else{this.cornerStyle.top="".concat(Oe+We+this.cornerCenterPointOffset-1,"px"),this.cornerStyle[Tt]="".concat(Ct+ie+this.cornerCenterPointOffset-1,"px"),this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";var wr=$1(i.TABLE),vr=wr===s;vr&&(wr=o.documentElement);var Cr=parseInt(this.cornerDefaultStyle.width,10)/2,se=parseInt(this.cornerDefaultStyle.height,10)/2;if(y===this.wot.getSetting("totalColumns")-1){var ye=vr?Le.getBoundingClientRect().left:Le.offsetLeft,Ee=!1,Ye=0;pt?(Ye=ye-parseInt(this.cornerDefaultStyle.width,10)/2,Ee=Ye<0):(Ye=ye+ii(Le)+parseInt(this.cornerDefaultStyle.width,10)/2,Ee=Ye>=Ok(wr)),Ee&&(this.cornerStyle[Tt]="".concat(Math.floor(Ct+ie+this.cornerCenterPointOffset-Cr),"px"),this.cornerStyle[pt?"borderLeftWidth":"borderRightWidth"]=0)}if(h===this.wot.getSetting("totalRows")-1){var je=vr?Le.getBoundingClientRect().top:Le.offsetTop,tt=je+Ni(Le)+parseInt(this.cornerDefaultStyle.height,10)/2,Ue=tt>=fh(wr);Ue&&(this.cornerStyle.top="".concat(Math.floor(Oe+We+this.cornerCenterPointOffset-se),"px"),this.cornerStyle.borderBottomWidth=0)}this.cornerStyle.display="block"}gu()&&this.updateMultipleSelectionHandlesPosition(h,y,Oe,Ct,ie,We)}}},{key:"isEntireColumnSelected",value:function(r,n){return r===this.wot.wtTable.getFirstRenderedRow()&&n===this.wot.wtTable.getLastRenderedRow()}},{key:"isEntireRowSelected",value:function(r,n){return r===this.wot.wtTable.getFirstRenderedColumn()&&n===this.wot.wtTable.getLastRenderedColumn()}},{key:"getDimensionsFromHeader",value:function(r,n,i,o,s){var a=this.wot.wtTable,h=a.wtRootElement.parentNode,p=null,y=null,S=null,E=null,O=null,A=null,$=null,B=null;switch(r){case"rows":p=function(){return a.getRowHeader.apply(a,arguments)},y=function(){return Ni.apply(void 0,arguments)},S="ht__selection--rows",A="top";break;case"columns":p=function(){return a.getColumnHeader.apply(a,arguments)},y=function(){return ii.apply(void 0,arguments)},S="ht__selection--columns",A="left";break}if(h.classList.contains(S)){var j=this.wot.getSetting("columnHeaders").length;if($=p(n,j-o),B=p(i,j-o),!$||!B)return!1;var z=ao($),W=ao(B);return $&&B&&(E=z[A]-s[A]-1,O=W[A]+y(B)-z[A]),[$,E,O]}return!1}},{key:"changeBorderStyle",value:function(r,n){var i=this[r].style,o=n[r];!o||o.hide?Vt(this[r],"hidden"):(Wr(this[r],"hidden")&&qr(this[r],"hidden"),i.backgroundColor=o.color,(r==="top"||r==="bottom")&&(i.height="".concat(o.width,"px")),(r==="start"||r==="end")&&(i.width="".concat(o.width,"px")))}},{key:"changeBorderToDefaultStyle",value:function(r){var n={width:1,color:"#000"},i=this[r].style;i.backgroundColor=n.color,i.width="".concat(n.width,"px"),i.height="".concat(n.width,"px")}},{key:"toggleHiddenClass",value:function(r,n){this.changeBorderToDefaultStyle(r),n?Vt(this[r],"hidden"):qr(this[r],"hidden")}},{key:"disappear",value:function(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",gu()&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}},{key:"destroy",value:function(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}]),e}();const hZe=fZe;function dZe(e,t){return yZe(e)||gZe(e,t)||mZe(e,t)||pZe()}function pZe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function mZe(e,t){if(e){if(typeof e=="string")return DX(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return DX(e,t)}}function DX(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function gZe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],h=!0,p=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;h=!1}else for(;!(h=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);h=!0);}catch(y){p=!0,i=y}finally{try{if(!h&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(p)throw i}}return a}}function yZe(e){if(Array.isArray(e))return e}function v_(e){"@babel/helpers - typeof";return v_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},v_(e)}function vZe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function LX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,bZe(n.key),n)}}function _Ze(e,t,r){return t&&LX(e.prototype,t),r&&LX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function bZe(e){var t=wZe(e,"string");return v_(t)==="symbol"?t:String(t)}function wZe(e,t){if(v_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(v_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var SZe=function(){function e(t,r){vZe(this,e),this.settings=t,this.cellRange=r||null,this.instanceBorders={},this.classNames=[this.settings.className],this.classNameGenerator=this.linearClassNameGenerator(this.settings.className,this.settings.layerLevel)}return _Ze(e,[{key:"getBorder",value:function(r){return this.instanceBorders[r.guid]||(this.instanceBorders[r.guid]=new hZe(r,this.settings)),this.instanceBorders[r.guid]}},{key:"isEmpty",value:function(){return this.cellRange===null}},{key:"add",value:function(r){return this.isEmpty()?this.cellRange=this.settings.createCellRange(r):this.cellRange.expand(r),this}},{key:"replace",value:function(r,n){if(!this.isEmpty()){if(this.cellRange.from.isEqual(r))return this.cellRange.from=n,!0;if(this.cellRange.to.isEqual(r))return this.cellRange.to=n,!0}return!1}},{key:"clear",value:function(){return this.cellRange=null,this}},{key:"getCorners",value:function(){var r=this.cellRange.getOuterTopStartCorner(),n=this.cellRange.getOuterBottomEndCorner();return[r.row,r.col,n.row,n.col]}},{key:"addClassAtCoords",value:function(r,n,i,o){var s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,a=r.wtTable.getCell(this.settings.createCellCoords(n,i));if(v_(a)==="object"){var h=o;s&&(h=this.classNameGenerator(a),this.classNames.includes(h)||this.classNames.push(h)),Vt(a,h)}return this}},{key:"linearClassNameGenerator",value:function(r,n){return function i(o){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;if(n===0||s===0)return r;var a=s>=0?s:n,h=r;a-=1;var p=a===0?r:"".concat(r,"-").concat(a);if(Wr(o,p)){var y=a+1;h="".concat(r,"-").concat(y)}else h=i(o,a);return h}}},{key:"draw",value:function(r){if(this.isEmpty()){this.settings.border&&this.getBorder(r).disappear();return}var n=r.wtTable.getRenderedRowsCount(),i=r.wtTable.getRenderedColumnsCount(),o=this.getCorners(),s=dZe(o,4),a=s[0],h=s[1],p=s[2],y=s[3],S=this.settings,E=S.highlightHeaderClassName,O=S.highlightColumnClassName,A=S.highlightRowClassName,$=S.highlightOnlyClosestHeader,B=S.selectionType,j=B===void 0||["active-header","header"].includes(B);if(j&&h!==null&&y!==null)for(var z=0,W=0;W<i;W+=1){var Q=r.wtTable.columnFilter.renderedToSource(W);if(Q>=h&&Q<=y){var q=r.wtTable.getColumnHeaders(Q),Se=q.length-1;$&&q.length>1&&(q=[q[Se]]);for(var Ie=0;Ie<q.length;Ie+=1){var He=[],Le=q[Ie];E&&He.push(E),O&&He.push(O),Ie=$?Se:Ie;var ze=r.getSetting("onBeforeHighlightingColumnHeader",Q,Ie,{selectionType:B,columnCursor:z,selectionWidth:y-h+1,classNames:He});ze!==Q&&(Le=r.wtTable.getColumnHeader(ze,Ie)),Vt(Le,He)}z+=1}}if(a!==null&&p!==null)for(var ct=0,At=0;At<n;At+=1){var Qe=r.wtTable.rowFilter.renderedToSource(At);if(j&&Qe>=a&&Qe<=p){var de=r.wtTable.getRowHeaders(Qe),Ce=de.length-1;$&&de.length>1&&(de=[de[Ce]]);for(var pt=0;pt<de.length;pt+=1){var Ct=[],ie=de[pt];E&&Ct.push(E),A&&Ct.push(A),pt=$?Ce:pt;var M=r.getSetting("onBeforeHighlightingRowHeader",Qe,pt,{selectionType:B,rowCursor:ct,selectionHeight:p-a+1,classNames:Ct});M!==Qe&&(ie=r.wtTable.getRowHeader(M,pt)),Vt(ie,Ct)}ct+=1}if(h!==null&&y!==null)for(var U=0;U<i;U+=1){var K=r.wtTable.columnFilter.renderedToSource(U);Qe>=a&&Qe<=p&&K>=h&&K<=y?this.settings.className&&this.addClassAtCoords(r,Qe,K,this.settings.className,this.settings.markIntersections):Qe>=a&&Qe<=p?A&&this.addClassAtCoords(r,Qe,K,A):K>=h&&K<=y&&O&&this.addClassAtCoords(r,Qe,K,O);var re=r.getSetting("onAfterDrawSelection",Qe,K,this.settings.layerLevel);typeof re=="string"&&this.addClassAtCoords(r,Qe,K,re)}}r.getSetting("onBeforeDrawBorders",o,this.settings.className),this.settings.border&&this.getBorder(r).appear(o)}},{key:"destroy",value:function(){Object.values(this.instanceBorders).forEach(function(r){return r.destroy()})}}]),e}();const xZe=SZe;var CZe=jr,EZe=Lm.findIndex,TZe=QC,_F="findIndex",mfe=!0;_F in[]&&Array(1)[_F](function(){mfe=!1});CZe({target:"Array",proto:!0,forced:mfe},{findIndex:function(t){return EZe(this,t,arguments.length>1?arguments[1]:void 0)}});TZe(_F);var OZe="localHooks",gfe={_localHooks:Object.create(null),addLocalHook:function(t,r){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(r),this},runLocalHooks:function(t,r,n,i,o,s,a){if(this._localHooks[t])for(var h=this._localHooks[t].length,p=0;p<h;p++)kj(this._localHooks[t][p],this,r,n,i,o,s,a)},clearLocalHooks:function(){return this._localHooks={},this}};af(gfe,"MIXIN_NAME",OZe,{writable:!1,enumerable:!1});const Ya=gfe;function dx(e){"@babel/helpers - typeof";return dx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},dx(e)}function RZe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function NX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,PZe(n.key),n)}}function kZe(e,t,r){return t&&NX(e.prototype,t),r&&NX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function PZe(e){var t=AZe(e,"string");return dx(t)==="symbol"?t:String(t)}function AZe(e,t){if(dx(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(dx(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Fm=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;RZe(this,e),this.indexedValues=[],this.initValueOrFn=t}return kZe(e,[{key:"getValues",value:function(){return this.indexedValues}},{key:"getValueAtIndex",value:function(r){var n=this.indexedValues;if(r<n.length)return n[r]}},{key:"setValues",value:function(r){this.indexedValues=r.slice(),this.runLocalHooks("change")}},{key:"setValueAtIndex",value:function(r,n){return r<this.indexedValues.length?(this.indexedValues[r]=n,this.runLocalHooks("change"),!0):!1}},{key:"clear",value:function(){this.setDefaultValues()}},{key:"getLength",value:function(){return this.getValues().length}},{key:"setDefaultValues",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,hi(this.initValueOrFn)?Or(n-1,function(i){return r.indexedValues.push(r.initValueOrFn(i))}):Or(n-1,function(){return r.indexedValues.push(r.initValueOrFn)}),this.runLocalHooks("change")}},{key:"init",value:function(r){return this.setDefaultValues(r),this.runLocalHooks("init"),this}},{key:"insert",value:function(){this.runLocalHooks("change")}},{key:"remove",value:function(){this.runLocalHooks("change")}},{key:"destroy",value:function(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}]),e}();ci(Fm,Ya);function gL(e){return DZe(e)||$Ze(e)||MZe(e)||IZe()}function IZe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function MZe(e,t){if(e){if(typeof e=="string")return bF(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return bF(e,t)}}function $Ze(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function DZe(e){if(Array.isArray(e))return bF(e)}function bF(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function KU(e,t,r,n){var i=r.length?r[0]:void 0;return[].concat(gL(e.slice(0,i)),gL(r.map(function(o,s){return hi(n)?n(o,s):n})),gL(i===void 0?[]:e.slice(i)))}function qU(e,t){return Us(e,function(r,n){return t.includes(n)===!1})}function __(e){"@babel/helpers - typeof";return __=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},__(e)}function LZe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function BX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,BZe(n.key),n)}}function NZe(e,t,r){return t&&BX(e.prototype,t),r&&BX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function BZe(e){var t=jZe(e,"string");return __(t)==="symbol"?t:String(t)}function jZe(e,t){if(__(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(__(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function KS(){return typeof Reflect<"u"&&Reflect.get?KS=Reflect.get.bind():KS=function(t,r,n){var i=FZe(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},KS.apply(this,arguments)}function FZe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=vm(e),e!==null););return e}function zZe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&wF(e,t)}function wF(e,t){return wF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},wF(e,t)}function HZe(e){var t=WZe();return function(){var n=vm(e),i;if(t){var o=vm(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return VZe(this,i)}}function VZe(e,t){if(t&&(__(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return UZe(e)}function UZe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function WZe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function vm(e){return vm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},vm(e)}var Jh=function(e){zZe(r,e);var t=HZe(r);function r(){return LZe(this,r),t.apply(this,arguments)}return NZe(r,[{key:"insert",value:function(i,o){this.indexedValues=KU(this.indexedValues,i,o,this.initValueOrFn),KS(vm(r.prototype),"insert",this).call(this,i,o)}},{key:"remove",value:function(i){this.indexedValues=qU(this.indexedValues,i),KS(vm(r.prototype),"remove",this).call(this,i)}}]),r}(Fm);function b_(e){"@babel/helpers - typeof";return b_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},b_(e)}function GZe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,KZe(n.key),n)}}function YZe(e,t,r){return t&&jX(e.prototype,t),r&&jX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function KZe(e){var t=qZe(e,"string");return b_(t)==="symbol"?t:String(t)}function qZe(e,t){if(b_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(b_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function XZe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&SF(e,t)}function SF(e,t){return SF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},SF(e,t)}function ZZe(e){var t=eJe();return function(){var n=OA(e),i;if(t){var o=OA(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return JZe(this,i)}}function JZe(e,t){if(t&&(b_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return QZe(e)}function QZe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function eJe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function OA(e){return OA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},OA(e)}var dM=function(e){XZe(r,e);var t=ZZe(r);function r(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return GZe(this,r),t.call(this,n)}return YZe(r,[{key:"getHiddenIndexes",value:function(){return oa(this.getValues(),function(i,o,s){return o&&i.push(s),i},[])}}]),r}(Jh);function yL(e){return iJe(e)||nJe(e)||rJe(e)||tJe()}function tJe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function rJe(e,t){if(e){if(typeof e=="string")return xF(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return xF(e,t)}}function nJe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function iJe(e){if(Array.isArray(e))return xF(e)}function xF(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function XU(e,t,r){return[].concat(yL(e.slice(0,t)),yL(r),yL(e.slice(t)))}function px(e,t){return Us(e,function(r){return t.includes(r)===!1})}function ZU(e,t){return dn(e,function(r){return r-t.filter(function(n){return n<r}).length})}function JU(e,t){var r=t[0],n=t.length;return dn(e,function(i){return i>=r?i+n:i})}function w_(e){"@babel/helpers - typeof";return w_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},w_(e)}function oJe(e){return uJe(e)||lJe(e)||sJe(e)||aJe()}function aJe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function sJe(e,t){if(e){if(typeof e=="string")return CF(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return CF(e,t)}}function lJe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function uJe(e){if(Array.isArray(e))return CF(e)}function CF(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function cJe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function FX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,vfe(n.key),n)}}function fJe(e,t,r){return t&&FX(e.prototype,t),r&&FX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function sc(){return typeof Reflect<"u"&&Reflect.get?sc=Reflect.get.bind():sc=function(t,r,n){var i=hJe(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},sc.apply(this,arguments)}function hJe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Sl(e),e!==null););return e}function dJe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&EF(e,t)}function EF(e,t){return EF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},EF(e,t)}function pJe(e){var t=gJe();return function(){var n=Sl(e),i;if(t){var o=Sl(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return mJe(this,i)}}function mJe(e,t){if(t&&(w_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return yfe(e)}function yfe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function gJe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Sl(e){return Sl=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Sl(e)}function yJe(e,t,r){return t=vfe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function vfe(e){var t=vJe(e,"string");return w_(t)==="symbol"?t:String(t)}function vJe(e,t){if(w_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(w_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var pM=function(e){dJe(r,e);var t=pJe(r);function r(){var n;cJe(this,r);for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n=t.call.apply(t,[this].concat(o)),yJe(yfe(n),"orderOfIndexes",[]),n}return fJe(r,[{key:"getValues",value:function(){var i=this;return this.orderOfIndexes.map(function(o){return i.indexedValues[o]})}},{key:"setValues",value:function(i){this.orderOfIndexes=oJe(Array(i.length).keys()),sc(Sl(r.prototype),"setValues",this).call(this,i)}},{key:"setValueAtIndex",value:function(i,o){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return i<this.indexedValues.length?(this.indexedValues[i]=o,this.orderOfIndexes.includes(i)===!1&&this.orderOfIndexes.splice(s,0,i),this.runLocalHooks("change"),!0):!1}},{key:"clearValue",value:function(i){this.orderOfIndexes=px(this.orderOfIndexes,[i]),hi(this.initValueOrFn)?sc(Sl(r.prototype),"setValueAtIndex",this).call(this,i,this.initValueOrFn(i)):sc(Sl(r.prototype),"setValueAtIndex",this).call(this,i,this.initValueOrFn)}},{key:"getLength",value:function(){return this.orderOfIndexes.length}},{key:"setDefaultValues",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,sc(Sl(r.prototype),"setDefaultValues",this).call(this,i)}},{key:"insert",value:function(i,o){this.indexedValues=KU(this.indexedValues,i,o,this.initValueOrFn),this.orderOfIndexes=JU(this.orderOfIndexes,o),sc(Sl(r.prototype),"insert",this).call(this,i,o)}},{key:"remove",value:function(i){this.indexedValues=qU(this.indexedValues,i),this.orderOfIndexes=px(this.orderOfIndexes,i),this.orderOfIndexes=ZU(this.orderOfIndexes,i),sc(Sl(r.prototype),"remove",this).call(this,i)}},{key:"getEntries",value:function(){var i=this;return this.orderOfIndexes.map(function(o){return[o,i.getValueAtIndex(o)]})}}]),r}(Fm);function S_(e){"@babel/helpers - typeof";return S_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},S_(e)}function _Je(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function zX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,wJe(n.key),n)}}function bJe(e,t,r){return t&&zX(e.prototype,t),r&&zX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function wJe(e){var t=SJe(e,"string");return S_(t)==="symbol"?t:String(t)}function SJe(e,t){if(S_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(S_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function xJe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&TF(e,t)}function TF(e,t){return TF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},TF(e,t)}function CJe(e){var t=OJe();return function(){var n=RA(e),i;if(t){var o=RA(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return EJe(this,i)}}function EJe(e,t){if(t&&(S_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return TJe(e)}function TJe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function OJe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function RA(e){return RA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},RA(e)}var RE=function(e){xJe(r,e);var t=CJe(r);function r(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return _Je(this,r),t.call(this,n)}return bJe(r,[{key:"getTrimmedIndexes",value:function(){return oa(this.getValues(),function(i,o,s){return o&&i.push(s),i},[])}}]),r}(Jh),HX=new Map([["indexesSequence",{getListWithInsertedItems:XU,getListWithRemovedItems:px}],["physicallyIndexed",{getListWithInsertedItems:KU,getListWithRemovedItems:qU}]]),_fe=function(t){if(HX.has(t)===!1)throw new Error("Alter strategy with ID '".concat(t,"' does not exist."));return HX.get(t)};function x_(e){"@babel/helpers - typeof";return x_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},x_(e)}function RJe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function VX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,PJe(n.key),n)}}function kJe(e,t,r){return t&&VX(e.prototype,t),r&&VX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function PJe(e){var t=AJe(e,"string");return x_(t)==="symbol"?t:String(t)}function AJe(e,t){if(x_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(x_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function qS(){return typeof Reflect<"u"&&Reflect.get?qS=Reflect.get.bind():qS=function(t,r,n){var i=IJe(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},qS.apply(this,arguments)}function IJe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=_m(e),e!==null););return e}function MJe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&OF(e,t)}function OF(e,t){return OF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},OF(e,t)}function $Je(e){var t=NJe();return function(){var n=_m(e),i;if(t){var o=_m(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return DJe(this,i)}}function DJe(e,t){if(t&&(x_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return LJe(e)}function LJe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function NJe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _m(e){return _m=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_m(e)}var bfe=function(e){MJe(r,e);var t=$Je(r);function r(){return RJe(this,r),t.call(this,function(n){return n})}return kJe(r,[{key:"insert",value:function(i,o){var s=JU(this.indexedValues,o);this.indexedValues=XU(s,i,o),qS(_m(r.prototype),"insert",this).call(this,i,o)}},{key:"remove",value:function(i){var o=px(this.indexedValues,i);this.indexedValues=ZU(o,i),qS(_m(r.prototype),"remove",this).call(this,i)}}]),r}(Fm),UX=new Map([["hiding",dM],["index",Fm],["linkedPhysicalIndexToValue",pM],["physicalIndexToValue",Jh],["trimming",RE]]);function BJe(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!UX.has(e))throw new Error('The provided map type ("'.concat(e,'") does not exist.'));return new(UX.get(e))(t)}function mx(e){"@babel/helpers - typeof";return mx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mx(e)}function jJe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function WX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,zJe(n.key),n)}}function FJe(e,t,r){return t&&WX(e.prototype,t),r&&WX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function zJe(e){var t=HJe(e,"string");return mx(t)==="symbol"?t:String(t)}function HJe(e,t){if(mx(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(mx(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var QU=function(){function e(){jJe(this,e),this.collection=new Map}return FJe(e,[{key:"register",value:function(r,n){var i=this;this.collection.has(r)===!1&&(this.collection.set(r,n),n.addLocalHook("change",function(){return i.runLocalHooks("change",n)}))}},{key:"unregister",value:function(r){var n=this.collection.get(r);pr(n)&&(n.destroy(),this.collection.delete(r),this.runLocalHooks("change",n))}},{key:"unregisterAll",value:function(){var r=this;this.collection.forEach(function(n,i){return r.unregister(i)}),this.collection.clear()}},{key:"get",value:function(r){return ui(r)?Array.from(this.collection.values()):this.collection.get(r)}},{key:"getLength",value:function(){return this.collection.size}},{key:"removeFromEvery",value:function(r){this.collection.forEach(function(n){n.remove(r)})}},{key:"insertToEvery",value:function(r,n){this.collection.forEach(function(i){i.insert(r,n)})}},{key:"initEvery",value:function(r){this.collection.forEach(function(n){n.init(r)})}}]),e}();ci(QU,Ya);function C_(e){"@babel/helpers - typeof";return C_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},C_(e)}function VJe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function GX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,WJe(n.key),n)}}function UJe(e,t,r){return t&&GX(e.prototype,t),r&&GX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function WJe(e){var t=GJe(e,"string");return C_(t)==="symbol"?t:String(t)}function GJe(e,t){if(C_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(C_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function YJe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&RF(e,t)}function RF(e,t){return RF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},RF(e,t)}function KJe(e){var t=ZJe();return function(){var n=kA(e),i;if(t){var o=kA(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return qJe(this,i)}}function qJe(e,t){if(t&&(C_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return XJe(e)}function XJe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ZJe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function kA(e){return kA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},kA(e)}var YX=function(e){YJe(r,e);var t=KJe(r);function r(n,i){var o;return VJe(this,r),o=t.call(this),o.mergedValuesCache=[],o.aggregationFunction=n,o.fallbackValue=i,o}return UJe(r,[{key:"getMergedValues",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(i===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];for(var o=dn(this.get(),function(S){return S.getValues()}),s=[],a=pr(o[0])&&o[0].length||0,h=0;h<a;h+=1){for(var p=[],y=0;y<this.getLength();y+=1)p.push(o[y][h]);s.push(p)}return dn(s,this.aggregationFunction)}},{key:"getMergedValueAtIndex",value:function(i,o){var s=this.getMergedValues(o)[i];return pr(s)?s:this.fallbackValue}},{key:"updateCache",value:function(){this.mergedValuesCache=this.getMergedValues(!1)}}]),r}(QU);function gx(e){"@babel/helpers - typeof";return gx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gx(e)}function JJe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function KX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,eQe(n.key),n)}}function QJe(e,t,r){return t&&KX(e.prototype,t),r&&KX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function eQe(e){var t=tQe(e,"string");return gx(t)==="symbol"?t:String(t)}function tQe(e,t){if(gx(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(gx(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function rQe(e,t,r){nQe(e,t),t.set(e,r)}function nQe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function iQe(e,t,r){var n=wfe(e,t,"set");return oQe(e,n,r),r}function oQe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}function aQe(e,t){var r=wfe(e,t,"get");return sQe(e,r)}function wfe(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function sQe(e,t){return t.get?t.get.call(e):t.value}var vL=new WeakMap,Sfe=function(){function e(){JJe(this,e),rQe(this,vL,{writable:!0,value:[]})}return QJe(e,[{key:"subscribe",value:function(r){return this.addLocalHook("change",r),this._write(aQe(this,vL)),this}},{key:"unsubscribe",value:function(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}},{key:"_write",value:function(r){return r.length>0&&this.runLocalHooks("change",r),this}},{key:"_writeInitialChanges",value:function(r){iQe(this,vL,r)}}]),e}();ci(Sfe,Ya);function qX(e,t){for(var r=[],n=0,i=0;n<e.length&&i<t.length;n++,i++)e[n]!==t[i]&&r.push({op:"replace",index:i,oldValue:e[n],newValue:t[i]});for(;n<t.length;n++)r.push({op:"insert",index:n,oldValue:void 0,newValue:t[n]});for(;i<e.length;i++)r.push({op:"remove",index:i,oldValue:e[i],newValue:void 0});return r}function yx(e){"@babel/helpers - typeof";return yx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yx(e)}function lQe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function XX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,cQe(n.key),n)}}function uQe(e,t,r){return t&&XX(e.prototype,t),r&&XX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function cQe(e){var t=fQe(e,"string");return yx(t)==="symbol"?t:String(t)}function fQe(e,t){if(yx(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(yx(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function eS(e,t,r){hQe(e,t),t.set(e,r)}function hQe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ps(e,t){var r=xfe(e,t,"get");return dQe(e,r)}function dQe(e,t){return t.get?t.get.call(e):t.value}function _R(e,t,r){var n=xfe(e,t,"set");return pQe(e,n,r),r}function xfe(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function pQe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var bR=new WeakMap,tS=new WeakMap,wR=new WeakMap,SR=new WeakMap,xR=new WeakMap,mQe=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.initialIndexValue;lQe(this,e),eS(this,bR,{writable:!0,value:new Set}),eS(this,tS,{writable:!0,value:[]}),eS(this,wR,{writable:!0,value:[]}),eS(this,SR,{writable:!0,value:!1}),eS(this,xR,{writable:!0,value:!1}),_R(this,xR,r??!1)}return uQe(e,[{key:"createObserver",value:function(){var r=this,n=new Sfe;return Ps(this,bR).add(n),n.addLocalHook("unsubscribe",function(){Ps(r,bR).delete(n)}),n._writeInitialChanges(qX(Ps(this,tS),Ps(this,wR))),n}},{key:"emit",value:function(r){var n=Ps(this,wR);(!Ps(this,SR)||Ps(this,tS).length!==r.length)&&(r.length===0?r=new Array(n.length).fill(Ps(this,xR)):_R(this,tS,new Array(r.length).fill(Ps(this,xR))),Ps(this,SR)||(_R(this,SR,!0),n=Ps(this,tS)));var i=qX(n,r);Ps(this,bR).forEach(function(o){return o._write(i)}),_R(this,wR,r)}}]),e}();function vx(e){"@babel/helpers - typeof";return vx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vx(e)}var ZX;function _L(e){return _Qe(e)||vQe(e)||yQe(e)||gQe()}function gQe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function yQe(e,t){if(e){if(typeof e=="string")return kF(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return kF(e,t)}}function vQe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function _Qe(e){if(Array.isArray(e))return kF(e)}function kF(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function bQe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function wQe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function JX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,xQe(n.key),n)}}function SQe(e,t,r){return t&&JX(e.prototype,t),r&&JX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function xQe(e){var t=CQe(e,"string");return vx(t)==="symbol"?t:String(t)}function CQe(e,t){if(vx(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(vx(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var QX=new Set(["getFirstNotHiddenIndex"]),PF=function(){function e(){var t=this;wQe(this,e),this.indexesSequence=new bfe,this.trimmingMapsCollection=new YX(function(r){return r.some(function(n){return n===!0})},!1),this.hidingMapsCollection=new YX(function(r){return r.some(function(n){return n===!0})},!1),this.variousMapsCollection=new QU,this.hidingChangesObservable=new mQe({initialIndexValue:!1}),this.notTrimmedIndexesCache=[],this.notHiddenIndexesCache=[],this.isBatched=!1,this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1,this.renderablePhysicalIndexesCache=[],this.fromPhysicalToVisualIndexesCache=new Map,this.fromVisualToRenderableIndexesCache=new Map,this.indexesSequence.addLocalHook("change",function(){t.indexesSequenceChanged=!0,t.updateCache(),t.runLocalHooks("change",t.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",function(r){t.trimmedIndexesChanged=!0,t.updateCache(),t.runLocalHooks("change",r,t.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",function(r){t.hiddenIndexesChanged=!0,t.updateCache(),t.runLocalHooks("change",r,t.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",function(r){t.runLocalHooks("change",r,t.variousMapsCollection)})}return SQe(e,[{key:"suspendOperations",value:function(){this.isBatched=!0}},{key:"resumeOperations",value:function(){this.isBatched=!1,this.updateCache()}},{key:"createChangesObserver",value:function(r){if(r!=="hiding")throw new Error('Unsupported index map type "'.concat(r,'".'));return this.hidingChangesObservable.createObserver()}},{key:"createAndRegisterIndexMap",value:function(r,n,i){return this.registerMap(r,BJe(n,i))}},{key:"registerMap",value:function(r,n){if(this.trimmingMapsCollection.get(r)||this.hidingMapsCollection.get(r)||this.variousMapsCollection.get(r))throw Error('Map with name "'.concat(r,'" has been already registered.'));n instanceof RE?this.trimmingMapsCollection.register(r,n):n instanceof dM?this.hidingMapsCollection.register(r,n):this.variousMapsCollection.register(r,n);var i=this.getNumberOfIndexes();return i>0&&n.init(i),n}},{key:"unregisterMap",value:function(r){this.trimmingMapsCollection.unregister(r),this.hidingMapsCollection.unregister(r),this.variousMapsCollection.unregister(r)}},{key:"unregisterAll",value:function(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}},{key:"getPhysicalFromVisualIndex",value:function(r){var n=this.notTrimmedIndexesCache[r];return pr(n)?n:null}},{key:"getPhysicalFromRenderableIndex",value:function(r){var n=this.renderablePhysicalIndexesCache[r];return pr(n)?n:null}},{key:"getVisualFromPhysicalIndex",value:function(r){var n=this.fromPhysicalToVisualIndexesCache.get(r);return pr(n)?n:null}},{key:"getVisualFromRenderableIndex",value:function(r){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(r))}},{key:"getRenderableFromVisualIndex",value:function(r){var n=this.fromVisualToRenderableIndexesCache.get(r);return pr(n)?n:null}},{key:"getFirstNotHiddenIndex",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:r-n;QX.has("getFirstNotHiddenIndex")&&(QX.delete("getFirstNotHiddenIndex"),ni(Jn(ZX||(ZX=bQe([`The method "getFirstNotHiddenIndex" is deprecated and will be removed in the next 
                        major release. Please use "getNearestNotHiddenIndex" instead.`],[`The method "getFirstNotHiddenIndex" is deprecated and will be removed in the next\\x20
                        major release. Please use "getNearestNotHiddenIndex" instead.`])))));var s=this.getPhysicalFromVisualIndex(r);return s===null?i===!0&&o!==r-n?this.getFirstNotHiddenIndex(o,-n,!1,o):null:this.isHidden(s)===!1?r:this.getFirstNotHiddenIndex(r+n,n,i,o)}},{key:"getNearestNotHiddenIndex",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=this.getPhysicalFromVisualIndex(r);if(o===null)return null;if(this.fromVisualToRenderableIndexesCache.has(r))return r;var s=Array.from(this.fromVisualToRenderableIndexesCache.keys()),a=-1;return n>0?a=s.findIndex(function(h){return h>r}):a=s.reverse().findIndex(function(h){return h<r}),a===-1?i?this.getNearestNotHiddenIndex(r,-n,!1):null:s[a]}},{key:"initToLength",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=_L(new Array(r).keys()),this.notHiddenIndexesCache=_L(new Array(r).keys()),this.suspendOperations(),this.indexesSequence.init(r),this.trimmingMapsCollection.initEvery(r),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(r),this.variousMapsCollection.initEvery(r),this.resumeOperations(),this.runLocalHooks("init")}},{key:"fitToLength",value:function(r){var n=this.getNumberOfIndexes();if(r<n){var i=_L(Array(this.getNumberOfIndexes()-r).keys()).map(function(o){return o+r});this.removeIndexes(i)}else this.insertIndexes(n,r-n)}},{key:"getIndexesSequence",value:function(){return this.indexesSequence.getValues()}},{key:"setIndexesSequence",value:function(r){this.indexesSequence.setValues(r)}},{key:"getNotTrimmedIndexes",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(n===!0)return this.notTrimmedIndexesCache;var i=this.getIndexesSequence();return i.filter(function(o){return r.isTrimmed(o)===!1})}},{key:"getNotTrimmedIndexesLength",value:function(){return this.getNotTrimmedIndexes().length}},{key:"getNotHiddenIndexes",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(n===!0)return this.notHiddenIndexesCache;var i=this.getIndexesSequence();return i.filter(function(o){return r.isHidden(o)===!1})}},{key:"getNotHiddenIndexesLength",value:function(){return this.getNotHiddenIndexes().length}},{key:"getRenderableIndexes",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(n===!0)return this.renderablePhysicalIndexesCache;var i=this.getNotTrimmedIndexes();return i.filter(function(o){return r.isHidden(o)===!1})}},{key:"getRenderableIndexesLength",value:function(){return this.getRenderableIndexes().length}},{key:"getNumberOfIndexes",value:function(){return this.getIndexesSequence().length}},{key:"moveIndexes",value:function(r,n){var i=this;typeof r=="number"&&(r=[r]);var o=dn(r,function(S){return i.getPhysicalFromVisualIndex(S)}),s=this.getNotTrimmedIndexesLength(),a=r.length,h=px(this.getIndexesSequence(),o),p=s-a;if(n+a<s){var y=h.filter(function(S){return i.isTrimmed(S)===!1})[n];p=h.indexOf(y)}this.setIndexesSequence(XU(h,p,o))}},{key:"isTrimmed",value:function(r){return this.trimmingMapsCollection.getMergedValueAtIndex(r)}},{key:"isHidden",value:function(r){return this.hidingMapsCollection.getMergedValueAtIndex(r)}},{key:"insertIndexes",value:function(r,n){var i=this.getNotTrimmedIndexes()[r],o=pr(i)?i:this.getNumberOfIndexes(),s=this.getIndexesSequence().includes(i)?this.getIndexesSequence().indexOf(i):this.getNumberOfIndexes(),a=dn(new Array(n).fill(o),function(h,p){return h+p});this.suspendOperations(),this.indexesSequence.insert(s,a),this.trimmingMapsCollection.insertToEvery(s,a),this.hidingMapsCollection.insertToEvery(s,a),this.variousMapsCollection.insertToEvery(s,a),this.resumeOperations()}},{key:"removeIndexes",value:function(r){this.suspendOperations(),this.indexesSequence.remove(r),this.trimmingMapsCollection.removeFromEvery(r),this.hidingMapsCollection.removeFromEvery(r),this.variousMapsCollection.removeFromEvery(r),this.resumeOperations()}},{key:"updateCache",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(r===!0||this.isBatched===!1&&n===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}},{key:"cacheFromPhysicalToVisualIndexes",value:function(){var r=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(var n=0;n<r;n+=1){var i=this.getPhysicalFromVisualIndex(n);this.fromPhysicalToVisualIndexesCache.set(i,n)}}},{key:"cacheFromVisualToRenderableIndexes",value:function(){var r=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(var n=0;n<r;n+=1){var i=this.getPhysicalFromRenderableIndex(n),o=this.getVisualFromPhysicalIndex(i);this.fromVisualToRenderableIndexesCache.set(o,n)}}}]),e}();ci(PF,Ya);function E_(e){"@babel/helpers - typeof";return E_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},E_(e)}function eZ(e,t){return RQe(e)||OQe(e,t)||TQe(e,t)||EQe()}function EQe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function TQe(e,t){if(e){if(typeof e=="string")return tZ(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return tZ(e,t)}}function tZ(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function OQe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],h=!0,p=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;h=!1}else for(;!(h=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);h=!0);}catch(y){p=!0,i=y}finally{try{if(!h&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(p)throw i}}return a}}function RQe(e){if(Array.isArray(e))return e}function kQe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function rZ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,AQe(n.key),n)}}function PQe(e,t,r){return t&&rZ(e.prototype,t),r&&rZ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function AQe(e){var t=IQe(e,"string");return E_(t)==="symbol"?t:String(t)}function IQe(e,t){if(E_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(E_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function xp(){return typeof Reflect<"u"&&Reflect.get?xp=Reflect.get.bind():xp=function(t,r,n){var i=MQe(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},xp.apply(this,arguments)}function MQe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=pc(e),e!==null););return e}function $Qe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&AF(e,t)}function AF(e,t){return AF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},AF(e,t)}function DQe(e){var t=NQe();return function(){var n=pc(e),i;if(t){var o=pc(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return LQe(this,i)}}function LQe(e,t){if(t&&(E_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Cfe(e)}function Cfe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function NQe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function pc(e){return pc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},pc(e)}gr.getSingleton().register("modifyAutoColumnSizeSeed");var rS="autoColumnSize",BQe=10,bL=new WeakMap,jQe="autoColumnSize",FQe=function(e){$Qe(r,e);var t=DQe(r);function r(n){var i;return kQe(this,r),i=t.call(this,n),bL.set(Cfe(i),{cachedColumnHeaders:[]}),i.ghostTable=new Pce(i.hot),i.samplesGenerator=new Mce(function(o,s){var a=i.hot.getCellMeta(o,s),h="";a.spanned||(h=i.hot.getDataAtCell(o,s));var p="";return i.hot.hasHook("modifyAutoColumnSizeSeed")&&(p=i.hot.runHooks("modifyAutoColumnSizeSeed",p,a,h)),{value:h,bundleSeed:p}}),i.firstCalculation=!0,i.inProgress=!1,i.measuredColumns=0,i.columnWidthsMap=new Jh,i.hot.columnIndexMapper.registerMap(jQe,i.columnWidthsMap),i.addHook("beforeColumnResize",function(o,s,a){return i.onBeforeColumnResize(o,s,a)}),i}return PQe(r,[{key:"isEnabled",value:function(){return this.hot.getSettings()[rS]!==!1&&!this.hot.getSettings().colWidths}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){var o=this.hot.getSettings()[rS];o&&o.useHeaders!==null&&o.useHeaders!==void 0&&this.ghostTable.setSetting("useHeaders",o.useHeaders),this.setSamplingOptions(),this.addHook("afterLoadData",function(){return i.onAfterLoadData.apply(i,arguments)}),this.addHook("beforeChangeRender",function(s){return i.onBeforeChange(s)}),this.addHook("afterFormulasValuesUpdate",function(s){return i.onAfterFormulasValuesUpdate(s)}),this.addHook("beforeViewRender",function(s){return i.onBeforeViewRender(s)}),this.addHook("modifyColWidth",function(s,a){return i.getColumnWidth(a,s)}),this.addHook("afterInit",function(){return i.onAfterInit()}),xp(pc(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){var i=this.findColumnsWhereHeaderWasChanged();i.length&&(this.clearCache(i),this.calculateVisibleColumnsWidth()),xp(pc(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var i=this;xp(pc(r.prototype),"disablePlugin",this).call(this),this.addHook("beforeColumnResize",function(o,s,a){return i.onBeforeColumnResize(o,s,a)})}},{key:"calculateVisibleColumnsWidth",value:function(){var i=this.hot.countRows();if(i){var o=this.hot.renderCall,s=this.getFirstVisibleColumn(),a=this.getLastVisibleColumn();s===-1||a===-1||this.calculateColumnsWidth({from:s,to:a},void 0,o)}}},{key:"calculateColumnsWidth",value:function(){var i=this,o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,h=typeof o=="number"?{from:o,to:o}:o,p=typeof s=="number"?{from:s,to:s}:s;Or(h.from,h.to,function(y){var S=i.hot.toPhysicalColumn(y);if(S===null&&(S=y),a||i.columnWidthsMap.getValueAtIndex(S)===null&&!i.hot._getColWidthFromSettings(S)){var E=i.samplesGenerator.generateColumnSamples(y,p);Fe(E,function(O){var A=eZ(O,2),$=A[0],B=A[1];return i.ghostTable.addColumn($,B)})}}),this.ghostTable.columns.length&&(this.hot.batchExecution(function(){i.ghostTable.getWidths(function(y,S){var E=i.hot.toPhysicalColumn(y);i.columnWidthsMap.setValueAtIndex(E,S)})},!0),this.measuredColumns=h.to+1,this.ghostTable.clean())}},{key:"calculateAllColumnsWidth",value:function(){var i=this,o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},s=0,a=this.hot.countCols()-1,h=null;this.inProgress=!0;var p=function S(){if(!i.hot){WP(h),i.inProgress=!1;return}i.calculateColumnsWidth({from:s,to:Math.min(s+r.CALCULATION_STEP,a)},o),s=s+r.CALCULATION_STEP+1,s<a?h=yU(S):(WP(h),i.inProgress=!1,i.hot.view.adjustElementsSize())},y=this.getSyncCalculationLimit();this.firstCalculation&&y>=0&&(this.calculateColumnsWidth({from:0,to:y},o),this.firstCalculation=!1,s=y+1),s<a?p():this.inProgress=!1}},{key:"setSamplingOptions",value:function(){var i=this.hot.getSettings()[rS],o=i&&Gi(i,"samplingRatio")?i.samplingRatio:void 0,s=i&&Gi(i,"allowSampleDuplicates")?i.allowSampleDuplicates:void 0;o&&!isNaN(o)&&this.samplesGenerator.setSampleCount(parseInt(o,10)),s&&this.samplesGenerator.setAllowDuplicates(s)}},{key:"recalculateAllColumnsWidth",value:function(){this.hot.view&&this.hot.view._wt.wtTable.isVisible()&&(this.clearCache(),this.calculateAllColumnsWidth())}},{key:"getSyncCalculationLimit",value:function(){var i=this.hot.getSettings()[rS],o=r.SYNC_CALCULATION_LIMIT,s=this.hot.countCols()-1;return pn(i)&&(o=i.syncLimit,Gue(o)?o=lce(s,o):o>>=0),Math.min(o,s)}},{key:"getColumnWidth",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,a=o;return a===void 0&&(a=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(i)),s&&typeof a=="number"&&(a=Math.max(a,NU.DEFAULT_WIDTH))),a}},{key:"getFirstVisibleColumn",value:function(){var i=this.hot.view._wt;if(i.wtViewport.columnsVisibleCalculator){var o=i.wtTable.getFirstVisibleColumn();if(o!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(o)}if(i.wtViewport.columnsRenderCalculator){var s=i.wtTable.getFirstRenderedColumn();if(s!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(s)}return-1}},{key:"getLastVisibleColumn",value:function(){var i=this.hot.view._wt;if(i.wtViewport.columnsVisibleCalculator){var o=i.wtTable.getLastVisibleColumn();if(o!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(o)}if(i.wtViewport.columnsRenderCalculator){var s=i.wtTable.getLastRenderedColumn();if(s!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(s)}return-1}},{key:"findColumnsWhereHeaderWasChanged",value:function(){var i=this.hot.getColHeader(),o=bL.get(this),s=o.cachedColumnHeaders,a=oa(i,function(h,p,y){var S=s.length;return(S-1<y||s[y]!==p)&&h.push(y),S-1<y?s.push(p):s[y]=p,h},[]);return a}},{key:"clearCache",value:function(){var i=this,o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];o.length?this.hot.batchExecution(function(){Fe(o,function(s){i.columnWidthsMap.setValueAtIndex(s,null)})},!0):this.columnWidthsMap.clear()}},{key:"isNeedRecalculate",value:function(){return!!Us(this.columnWidthsMap.getValues().slice(0,this.measuredColumns),function(i){return i===null}).length}},{key:"onBeforeViewRender",value:function(){this.calculateVisibleColumnsWidth(),this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllColumnsWidth()}},{key:"onAfterLoadData",value:function(){var i=this;this.hot.view?this.recalculateAllColumnsWidth():setTimeout(function(){i.hot&&i.recalculateAllColumnsWidth()},0)}},{key:"onBeforeChange",value:function(i){var o=this,s=dn(i,function(a){var h=eZ(a,2),p=h[1];return o.hot.toPhysicalColumn(o.hot.propToCol(p))});this.clearCache(Array.from(new Set(s)))}},{key:"onBeforeColumnResize",value:function(i,o,s){var a=i;return s&&(this.calculateColumnsWidth(o,void 0,!0),a=this.getColumnWidth(o,void 0,!1)),a}},{key:"onAfterInit",value:function(){bL.get(this).cachedColumnHeaders=this.hot.getColHeader()}},{key:"onAfterFormulasValuesUpdate",value:function(i){var o=Us(i,function(a){var h;return pr((h=a.address)===null||h===void 0?void 0:h.col)}),s=dn(o,function(a){return a.address.col});this.clearCache(Array.from(new Set(s)))}},{key:"destroy",value:function(){this.ghostTable.clean(),xp(pc(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return rS}},{key:"PLUGIN_PRIORITY",get:function(){return BQe}},{key:"SETTING_KEYS",get:function(){return!0}},{key:"CALCULATION_STEP",get:function(){return 50}},{key:"SYNC_CALCULATION_LIMIT",get:function(){return 50}}]),r}(Yn),Cp={horizontal:"horizontal",vertical:"vertical"};function zQe(e,t,r,n){var i=r.length,o=r?r[0].length:0,s=[],a=t.row-e.row,h=t.col-e.col;if(["down","up"].indexOf(n)!==-1){for(var p=[],y=0;y<h;y++){var S=parseInt(r[0][y],10),E=parseInt(r[i-1][y],10),O=(n==="down"?E-S:S-E)/(i-1)||0;p.push(O)}s.push(p)}if(["right","left"].indexOf(n)!==-1)for(var A=0;A<a;A++){var $=parseInt(r[A][0],10),B=parseInt(r[A][o-1],10),j=(n==="right"?B-$:$-B)/(o-1)||0;s.push([j])}return s}function HQe(e,t,r){var n,i,o;return t[0]===e[0]&&t[1]<e[1]?(o="left",n=r(t[0],t[1]),i=r(t[2],e[1]-1)):t[2]===e[2]&&t[0]===e[0]&&t[3]>e[3]?(o="right",n=r(t[0],e[3]+1),i=r(t[2],t[3])):t[0]<e[0]&&t[1]===e[1]?(o="up",n=r(t[0],t[1]),i=r(e[0]-1,t[3])):t[2]>e[2]&&t[1]===e[1]&&(o="down",n=r(e[2]+1,t[1]),i=r(t[2],t[3])),n&&n.normalize(),i&&i.normalize(),{directionOfDrag:o,startOfDragCoords:n,endOfDragCoords:i}}function VQe(e){var t={};return e===!0?(t.directions=Object.keys(Cp),t.autoInsertRow=!0):pn(e)?(pr(e.autoInsertRow)?e.direction===Cp.horizontal?t.autoInsertRow=!1:t.autoInsertRow=e.autoInsertRow:t.autoInsertRow=!1,pr(e.direction)?t.directions=[e.direction]:t.directions=Object.keys(Cp)):typeof e=="string"?(t.directions=[e],t.autoInsertRow=!0):(t.directions=[],t.autoInsertRow=!1),t}function T_(e){"@babel/helpers - typeof";return T_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},T_(e)}function UQe(e){return YQe(e)||GQe(e)||Efe(e)||WQe()}function WQe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function GQe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function YQe(e){if(Array.isArray(e))return IF(e)}function KQe(e,t){return ZQe(e)||XQe(e,t)||Efe(e,t)||qQe()}function qQe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Efe(e,t){if(e){if(typeof e=="string")return IF(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return IF(e,t)}}function IF(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function XQe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],h=!0,p=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;h=!1}else for(;!(h=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);h=!0);}catch(y){p=!0,i=y}finally{try{if(!h&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(p)throw i}}return a}}function ZQe(e){if(Array.isArray(e))return e}function JQe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function nZ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,eet(n.key),n)}}function QQe(e,t,r){return t&&nZ(e.prototype,t),r&&nZ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function eet(e){var t=tet(e,"string");return T_(t)==="symbol"?t:String(t)}function tet(e,t){if(T_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(T_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ep(){return typeof Reflect<"u"&&Reflect.get?Ep=Reflect.get.bind():Ep=function(t,r,n){var i=ret(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Ep.apply(this,arguments)}function ret(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=mc(e),e!==null););return e}function net(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&MF(e,t)}function MF(e,t){return MF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},MF(e,t)}function iet(e){var t=aet();return function(){var n=mc(e),i;if(t){var o=mc(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return oet(this,i)}}function oet(e,t){if(t&&(T_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Tfe(e)}function Tfe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function aet(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function mc(e){return mc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},mc(e)}gr.getSingleton().register("modifyAutofillRange");gr.getSingleton().register("beforeAutofill");gr.getSingleton().register("afterAutofill");var iZ="autofill",set=20,uet=["fillHandle"],cet="insert_row_below",fet=200,het=function(e){net(r,e);var t=iet(r);function r(n){var i;return JQe(this,r),i=t.call(this,n),i.eventManager=new Fi(Tfe(i)),i.addingStarted=!1,i.mouseDownOnCellCorner=!1,i.mouseDragOutside=!1,i.handleDraggedCells=0,i.directions=[],i.autoInsertRow=!1,i}return QQe(r,[{key:"isEnabled",value:function(){return this.hot.getSettings().fillHandle}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",function(o){return i.onAfterCellCornerMouseDown(o)}),this.addHook("afterOnCellCornerDblClick",function(o){return i.onCellCornerDblClick(o)}),this.addHook("beforeOnCellMouseOver",function(o,s){return i.onBeforeCellMouseOver(s)}),Ep(mc(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Ep(mc(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.clearMappedSettings(),Ep(mc(r.prototype),"disablePlugin",this).call(this)}},{key:"getSelectionData",value:function(){var i=this,o=this.hot.getSelectedRangeLast(),s=o.getTopStartCorner(),a=s.row,h=s.col,p=o.getBottomEndCorner(),y=p.row,S=p.col,E=this.hot.runHooks("modifyCopyableRange",[{startRow:a,startCol:h,endRow:y,endCol:S}]),O=[],A=[],$=[];return Fe(E,function(B){for(var j=B.startRow;j<=B.endRow;j+=1)O.indexOf(j)===-1&&O.push(j);for(var z=B.startCol;z<=B.endCol;z+=1)A.indexOf(z)===-1&&A.push(z)}),Fe(O,function(B){var j=[];Fe(A,function(z){j.push(i.hot.getCopyableData(B,z))}),$.push(j)}),$}},{key:"fillIn",value:function(){var i=this;if(this.hot.selection.highlight.getFill().isEmpty())return!1;var o=this.hot.selection.highlight.getFill().getVisualCorners(),s=KQe(o,4),a=s[0],h=s[1],p=s[2],y=s[3],S=this.hot.getSelectedRangeLast(),E=S.getTopStartCorner(),O=S.getBottomEndCorner();this.resetSelectionOfDraggedArea();var A=[E.row,E.col,O.row,O.col],$=this.hot.runHooks("modifyAutofillRange",[Math.min(E.row,a),Math.min(E.col,h),Math.max(O.row,p),Math.max(O.col,y)],A),B=HQe(A,$,function(ie,M){return i.hot._createCellCoords(ie,M)}),j=B.directionOfDrag,z=B.startOfDragCoords,W=B.endOfDragCoords;if(z&&z.row>-1&&z.col>-1){var Q=this.getSelectionData(),q=S.clone(),Se=this.hot._createCellRange(z,z,W),Ie=this.hot.runHooks("beforeAutofill",Q,q,Se,j);if(Ie===!1)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;var He=zQe(z,W,Q,j),Le=Ie,ze=Ie;if(["up","left"].indexOf(j)>-1&&!(ze.length===1&&ze[0].length===0))if(Le=[],j==="up")for(var ct=W.row-z.row+1,At=ct%ze.length,Qe=0;Qe<ct;Qe++)Le.push(ze[(Qe+(ze.length-At))%ze.length]);else for(var de=W.col-z.col+1,Ce=de%ze[0].length,pt=0;pt<ze.length;pt++){Le.push([]);for(var Ct=0;Ct<de;Ct++)Le[pt].push(ze[pt][(Ct+(ze[pt].length-Ce))%ze[pt].length])}this.hot.populateFromArray(z.row,z.col,Le,W.row,W.col,"".concat(this.pluginName,".fill"),null,j,He),this.setSelection($),this.hot.runHooks("afterAutofill",Le,q,Se,j),this.hot.render()}else this.hot._refreshBorders();return!0}},{key:"reduceSelectionAreaIfNeeded",value:function(i){return i.row<0&&(i.row=0),i.col<0&&(i.col=0),i}},{key:"getCoordsOfDragAndDropBorders",value:function(i){var o=this.hot.getSelectedRangeLast(),s=o.getBottomEndCorner(),a=i;if(this.directions.includes(Cp.vertical)&&this.directions.includes(Cp.horizontal)){var h=o.getTopStartCorner();(s.col<=i.col||h.col>=i.col)&&(a=this.hot._createCellCoords(s.row,i.col)),(s.row<i.row||h.row>i.row)&&(a=this.hot._createCellCoords(i.row,s.col))}else if(this.directions.includes(Cp.vertical))a=this.hot._createCellCoords(i.row,s.col);else if(this.directions.includes(Cp.horizontal))a=this.hot._createCellCoords(s.row,i.col);else return;return this.reduceSelectionAreaIfNeeded(a)}},{key:"showBorder",value:function(i){var o=this.getCoordsOfDragAndDropBorders(i);o&&this.redrawBorders(o)}},{key:"addRow",value:function(){var i=this;this.hot._registerTimeout(function(){i.hot.alter(cet,void 0,1,"".concat(i.pluginName,".fill")),i.addingStarted=!1},fet)}},{key:"addNewRowIfNeeded",value:function(){if(!this.hot.selection.highlight.getFill().isEmpty()&&this.addingStarted===!1&&this.autoInsertRow){var i=this.hot.getSelectedLast(),o=this.hot.selection.highlight.getFill().getVisualCorners(),s=this.hot.countRows();i[2]<s-1&&o[2]===s-1&&(this.addingStarted=!0,this.addRow())}}},{key:"getIndexOfLastAdjacentFilledInRow",value:function(i){for(var o=this.hot.getData(),s=this.hot.countRows(),a,h=i[2]+1;h<s;h++){for(var p=i[1];p<=i[3];p++){var y=o[h][p];if(y)return-1}var S=o[h][i[1]-1],E=o[h][i[3]+1];(S||E)&&(a=h)}return a}},{key:"addSelectionFromStartAreaToSpecificRowIndex",value:function(i,o){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(i[0],i[1])).add(this.hot._createCellCoords(o,i[3])).commit()}},{key:"setSelection",value:function(i){var o;(o=this.hot).selectCell.apply(o,UQe(dn(i,function(s){return Math.max(s,0)})).concat([!1,!1]))}},{key:"selectAdjacent",value:function(){var i=this.hot.getSelectedLast(),o=this.getIndexOfLastAdjacentFilledInRow(i);return o===-1||o===void 0?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(i,o),!0)}},{key:"resetSelectionOfDraggedArea",value:function(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}},{key:"redrawBorders",value:function(i){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(i).commit(),this.hot.view.render()}},{key:"getIfMouseWasDraggedOutside",value:function(i){var o=this.hot.rootDocument.documentElement,s=ao(this.hot.table).top-(this.hot.rootWindow.pageYOffset||o.scrollTop)+Ni(this.hot.table),a=ao(this.hot.table).left-(this.hot.rootWindow.pageXOffset||o.scrollLeft)+ii(this.hot.table);return i.clientY>s&&i.clientX<=a}},{key:"registerEvents",value:function(){var i=this,o=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(o,"mouseup",function(){return i.onMouseUp()}),this.eventManager.addEventListener(o,"mousemove",function(s){return i.onMouseMove(s)})}},{key:"onCellCornerDblClick",value:function(){var i=this.selectAdjacent();i&&this.fillIn()}},{key:"onAfterCellCornerMouseDown",value:function(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}},{key:"onBeforeCellMouseOver",value:function(i){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(i),this.addNewRowIfNeeded())}},{key:"onMouseUp",value:function(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}},{key:"onMouseMove",value:function(i){var o=this.getIfMouseWasDraggedOutside(i);this.addingStarted===!1&&this.handleDraggedCells>0&&o?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}},{key:"clearMappedSettings",value:function(){this.directions.length=0,this.autoInsertRow=!1}},{key:"mapSettings",value:function(){var i=VQe(this.hot.getSettings().fillHandle);this.directions=i.directions,this.autoInsertRow=i.autoInsertRow}},{key:"destroy",value:function(){Ep(mc(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return iZ}},{key:"PLUGIN_PRIORITY",get:function(){return set}},{key:"SETTING_KEYS",get:function(){return[iZ].concat(uet)}}]),r}(Yn);function O_(e){"@babel/helpers - typeof";return O_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},O_(e)}function det(e,t){return yet(e)||get(e,t)||met(e,t)||pet()}function pet(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function met(e,t){if(e){if(typeof e=="string")return oZ(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return oZ(e,t)}}function oZ(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function get(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],h=!0,p=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;h=!1}else for(;!(h=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);h=!0);}catch(y){p=!0,i=y}finally{try{if(!h&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(p)throw i}}return a}}function yet(e){if(Array.isArray(e))return e}function vet(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function aZ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,bet(n.key),n)}}function _et(e,t,r){return t&&aZ(e.prototype,t),r&&aZ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function bet(e){var t=wet(e,"string");return O_(t)==="symbol"?t:String(t)}function wet(e,t){if(O_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(O_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function uv(){return typeof Reflect<"u"&&Reflect.get?uv=Reflect.get.bind():uv=function(t,r,n){var i=xet(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},uv.apply(this,arguments)}function xet(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Eh(e),e!==null););return e}function Cet(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&$F(e,t)}function $F(e,t){return $F=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},$F(e,t)}function Eet(e){var t=Ret();return function(){var n=Eh(e),i;if(t){var o=Eh(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Tet(this,i)}}function Tet(e,t){if(t&&(O_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Oet(e)}function Oet(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ret(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Eh(e){return Eh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Eh(e)}var CR="autoRowSize",ket=40,Pet="autoRowSize",Aet=function(e){Cet(r,e);var t=Eet(r);function r(n){var i;return vet(this,r),i=t.call(this,n),i.rowHeightsMap=void 0,i.headerHeight=null,i.ghostTable=new Pce(i.hot),i.samplesGenerator=new Mce(function(o,s){var a;return o>=0?a=i.hot.getDataAtCell(o,s):o===-1&&(a=i.hot.getColHeader(s)),{value:a}}),i.firstCalculation=!0,i.inProgress=!1,i.measuredRows=0,i.rowHeightsMap=new Jh,i.hot.rowIndexMapper.registerMap(Pet,i.rowHeightsMap),i.addHook("beforeRowResize",function(o,s,a){return i.onBeforeRowResize(o,s,a)}),i}return _et(r,[{key:"isEnabled",value:function(){var i=this.hot.getSettings()[CR];return i===!0||pn(i)}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.setSamplingOptions(),this.addHook("afterLoadData",function(){return i.onAfterLoadData.apply(i,arguments)}),this.addHook("beforeChangeRender",function(o){return i.onBeforeChange(o)}),this.addHook("beforeColumnResize",function(){return i.recalculateAllRowsHeight()}),this.addHook("beforeViewRender",function(o){return i.onBeforeViewRender(o)}),this.addHook("modifyRowHeight",function(o,s){return i.getRowHeight(s,o)}),this.addHook("modifyColumnHeaderHeight",function(){return i.getColumnHeaderHeight()}),uv(Eh(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var i=this;this.headerHeight=null,uv(Eh(r.prototype),"disablePlugin",this).call(this),this.addHook("beforeRowResize",function(o,s,a){return i.onBeforeRowResize(o,s,a)})}},{key:"calculateRowsHeight",value:function(){var i=this,o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,h=typeof o=="number"?{from:o,to:o}:o,p=typeof s=="number"?{from:s,to:s}:s;if(this.hot.getColHeader(0)!==null){var y=this.samplesGenerator.generateRowSamples(-1,p);this.ghostTable.addColumnHeadersRow(y.get(-1))}Or(h.from,h.to,function(S){if(a||i.rowHeightsMap.getValueAtIndex(S)===null){var E=i.samplesGenerator.generateRowSamples(S,p);Fe(E,function(O){var A=det(O,2),$=A[0],B=A[1];return i.ghostTable.addRow($,B)})}}),this.ghostTable.rows.length&&(this.hot.batchExecution(function(){i.ghostTable.getHeights(function(S,E){S<0?i.headerHeight=E:i.rowHeightsMap.setValueAtIndex(i.hot.toPhysicalRow(S),E)})},!0),this.measuredRows=h.to+1,this.ghostTable.clean())}},{key:"calculateAllRowsHeight",value:function(){var i=this,o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},s=0,a=this.hot.countRows()-1,h=null;this.inProgress=!0;var p=function S(){if(!i.hot){WP(h),i.inProgress=!1;return}i.calculateRowsHeight({from:s,to:Math.min(s+r.CALCULATION_STEP,a)},o),s=s+r.CALCULATION_STEP+1,s<a?h=yU(S):(WP(h),i.inProgress=!1,i.hot.view.adjustElementsSize(!0),i.hot.view._wt.wtOverlays.inlineStartOverlay.needFullRender&&i.hot.view._wt.wtOverlays.inlineStartOverlay.clone.draw())},y=this.getSyncCalculationLimit();this.firstCalculation&&y>=0&&(this.calculateRowsHeight({from:0,to:y},o),this.firstCalculation=!1,s=y+1),s<a?p():(this.inProgress=!1,this.hot.view.adjustElementsSize(!1))}},{key:"setSamplingOptions",value:function(){var i=this.hot.getSettings()[CR],o=i&&Gi(i,"samplingRatio")?i.samplingRatio:void 0,s=i&&Gi(i,"allowSampleDuplicates")?i.allowSampleDuplicates:void 0;o&&!isNaN(o)&&this.samplesGenerator.setSampleCount(parseInt(o,10)),s&&this.samplesGenerator.setAllowDuplicates(s)}},{key:"recalculateAllRowsHeight",value:function(){I1(this.hot.view._wt.wtTable.TABLE)&&(this.clearCache(),this.calculateAllRowsHeight())}},{key:"getSyncCalculationLimit",value:function(){var i=this.hot.getSettings()[CR],o=r.SYNC_CALCULATION_LIMIT,s=this.hot.countRows()-1;return pn(i)&&(o=i.syncLimit,Gue(o)?o=lce(s,o):o>>=0),Math.min(o,s)}},{key:"getRowHeight",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,s=i<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(i)),a=o;return s!==null&&s>(o||0)&&(a=s),a}},{key:"getColumnHeaderHeight",value:function(){return this.headerHeight}},{key:"getFirstVisibleRow",value:function(){var i=this.hot.view._wt;return i.wtViewport.rowsVisibleCalculator?i.wtTable.getFirstVisibleRow():i.wtViewport.rowsRenderCalculator?i.wtTable.getFirstRenderedRow():-1}},{key:"getLastVisibleRow",value:function(){var i=this.hot.view._wt;return i.wtViewport.rowsVisibleCalculator?i.wtTable.getLastVisibleRow():i.wtViewport.rowsRenderCalculator?i.wtTable.getLastRenderedRow():-1}},{key:"clearCache",value:function(){this.headerHeight=null,this.rowHeightsMap.init()}},{key:"clearCacheByRange",value:function(i){var o=this,s=typeof i=="number"?{from:i,to:i}:i,a=s.from,h=s.to;this.hot.batchExecution(function(){Or(Math.min(a,h),Math.max(a,h),function(p){o.rowHeightsMap.setValueAtIndex(p,null)})},!0)}},{key:"isNeedRecalculate",value:function(){return!!Us(this.rowHeightsMap.getValues().slice(0,this.measuredRows),function(i){return i===null}).length}},{key:"onBeforeViewRender",value:function(){var i=this.hot.renderCall,o=this.hot.getSettings().fixedRowsBottom,s=this.getFirstVisibleRow(),a=this.getLastVisibleRow();if(!(s===-1||a===-1)){if(this.calculateRowsHeight({from:s,to:a},void 0,i),o){var h=this.hot.countRows()-1;this.calculateRowsHeight({from:h-o,to:h})}this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllRowsHeight()}}},{key:"onBeforeRowMove",value:function(i,o){this.clearCacheByRange({from:i,to:o}),this.calculateAllRowsHeight()}},{key:"onBeforeRowResize",value:function(i,o,s){var a=i;return s&&(this.calculateRowsHeight(o,void 0,!0),a=this.getRowHeight(o)),a}},{key:"onAfterLoadData",value:function(){var i=this;this.hot.view?this.recalculateAllRowsHeight():setTimeout(function(){i.hot&&i.recalculateAllRowsHeight()},0)}},{key:"onBeforeChange",value:function(i){var o=null;i.length===1?o=i[0][0]:i.length>1&&(o={from:i[0][0],to:i[i.length-1][0]}),o!==null&&this.clearCacheByRange(o)}},{key:"destroy",value:function(){this.ghostTable.clean(),uv(Eh(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return CR}},{key:"PLUGIN_PRIORITY",get:function(){return ket}},{key:"SETTING_KEYS",get:function(){return!0}},{key:"CALCULATION_STEP",get:function(){return 50}},{key:"SYNC_CALCULATION_LIMIT",get:function(){return 500}}]),r}(Yn);function R_(e){"@babel/helpers - typeof";return R_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},R_(e)}function Iet(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function sZ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,$et(n.key),n)}}function Met(e,t,r){return t&&sZ(e.prototype,t),r&&sZ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function $et(e){var t=Det(e,"string");return R_(t)==="symbol"?t:String(t)}function Det(e,t){if(R_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(R_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function XS(){return typeof Reflect<"u"&&Reflect.get?XS=Reflect.get.bind():XS=function(t,r,n){var i=Let(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},XS.apply(this,arguments)}function Let(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=bm(e),e!==null););return e}function Net(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&DF(e,t)}function DF(e,t){return DF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},DF(e,t)}function Bet(e){var t=zet();return function(){var n=bm(e),i;if(t){var o=bm(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return jet(this,i)}}function jet(e,t){if(t&&(R_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Fet(e)}function Fet(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function zet(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function bm(e){return bm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},bm(e)}var Ofe=_fe("physicallyIndexed"),Het=Ofe.getListWithInsertedItems,Vet=Ofe.getListWithRemovedItems,Uet=function(e){Net(r,e);var t=Bet(r);function r(){return Iet(this,r),t.call(this,function(n){return n})}return Met(r,[{key:"insert",value:function(i,o){var s=JU(this.indexedValues,o);this.indexedValues=Het(s,i,o,this.initValueOrFn),XS(bm(r.prototype),"insert",this).call(this,i,o)}},{key:"remove",value:function(i){var o=Vet(this.indexedValues,i);this.indexedValues=ZU(o,i),XS(bm(r.prototype),"remove",this).call(this,i)}}]),r}(Fm);const Wet=Uet;function k_(e){"@babel/helpers - typeof";return k_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},k_(e)}function Get(e){return Xet(e)||qet(e)||Ket(e)||Yet()}function Yet(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ket(e,t){if(e){if(typeof e=="string")return LF(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return LF(e,t)}}function qet(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Xet(e){if(Array.isArray(e))return LF(e)}function LF(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Zet(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function lZ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Qet(n.key),n)}}function Jet(e,t,r){return t&&lZ(e.prototype,t),r&&lZ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Qet(e){var t=ett(e,"string");return k_(t)==="symbol"?t:String(t)}function ett(e,t){if(k_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(k_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ZS(){return typeof Reflect<"u"&&Reflect.get?ZS=Reflect.get.bind():ZS=function(t,r,n){var i=ttt(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},ZS.apply(this,arguments)}function ttt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=wm(e),e!==null););return e}function rtt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&NF(e,t)}function NF(e,t){return NF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},NF(e,t)}function ntt(e){var t=att();return function(){var n=wm(e),i;if(t){var o=wm(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return itt(this,i)}}function itt(e,t){if(t&&(k_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ott(e)}function ott(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function att(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function wm(e){return wm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},wm(e)}var Rfe=_fe("physicallyIndexed"),stt=Rfe.getListWithInsertedItems,ltt=Rfe.getListWithRemovedItems,utt=function(e){rtt(r,e);var t=ntt(r);function r(){return Zet(this,r),t.call(this,function(n){return n})}return Jet(r,[{key:"insert",value:function(i,o){var s=this;this.indexedValues=stt(this.indexedValues,i,o,function(a,h){return s.getNextValue(h)}),ZS(wm(r.prototype),"insert",this).call(this,i,o)}},{key:"remove",value:function(i){this.indexedValues=ltt(this.indexedValues,i),ZS(wm(r.prototype),"remove",this).call(this,i)}},{key:"getNextValue",value:function(i){return Math.max.apply(Math,Get(this.getValues()))+1+i}}]),r}(Fm);const ctt=utt;function P_(e){"@babel/helpers - typeof";return P_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},P_(e)}function ftt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function uZ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,dtt(n.key),n)}}function htt(e,t,r){return t&&uZ(e.prototype,t),r&&uZ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function dtt(e){var t=ptt(e,"string");return P_(t)==="symbol"?t:String(t)}function ptt(e,t){if(P_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(P_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function cv(){return typeof Reflect<"u"&&Reflect.get?cv=Reflect.get.bind():cv=function(t,r,n){var i=mtt(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},cv.apply(this,arguments)}function mtt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Th(e),e!==null););return e}function gtt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&BF(e,t)}function BF(e,t){return BF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},BF(e,t)}function ytt(e){var t=btt();return function(){var n=Th(e),i;if(t){var o=Th(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return vtt(this,i)}}function vtt(e,t){if(t&&(P_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _tt(e)}function _tt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function btt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Th(e){return Th=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Th(e)}var wL="bindRowsWithHeaders",wtt=210,Stt="loose",xtt=new Map([["loose",Wet],["strict",ctt]]),Ctt=function(e){gtt(r,e);var t=ytt(r);function r(n){var i;return ftt(this,r),i=t.call(this,n),i.headerIndexes=null,i}return htt(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[wL]}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){var o=this.hot.getSettings()[wL];typeof o!="string"&&(o=Stt);var s=xtt.get(o);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new s),this.addHook("modifyRowHeader",function(a){return i.onModifyRowHeader(a)}),cv(Th(r.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),cv(Th(r.prototype),"disablePlugin",this).call(this)}},{key:"onModifyRowHeader",value:function(i){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(i))}},{key:"destroy",value:function(){cv(Th(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return wL}},{key:"PLUGIN_PRIORITY",get:function(){return wtt}}]),r}(Yn);function A_(e){"@babel/helpers - typeof";return A_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},A_(e)}function cZ(e){return Rtt(e)||Ott(e)||Ttt(e)||Ett()}function Ett(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ttt(e,t){if(e){if(typeof e=="string")return jF(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return jF(e,t)}}function Ott(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Rtt(e){if(Array.isArray(e))return jF(e)}function jF(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ktt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fZ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,kfe(n.key),n)}}function Ptt(e,t,r){return t&&fZ(e.prototype,t),r&&fZ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Tp(){return typeof Reflect<"u"&&Reflect.get?Tp=Reflect.get.bind():Tp=function(t,r,n){var i=Att(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Tp.apply(this,arguments)}function Att(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=gc(e),e!==null););return e}function Itt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&FF(e,t)}function FF(e,t){return FF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},FF(e,t)}function Mtt(e){var t=Dtt();return function(){var n=gc(e),i;if(t){var o=gc(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return $tt(this,i)}}function $tt(e,t){if(t&&(A_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return My(e)}function My(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Dtt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function gc(e){return gc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},gc(e)}function Ltt(e,t,r){Ntt(e,t),t.set(e,r)}function Ntt(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function SL(e,t,r){return t=kfe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function kfe(e){var t=Btt(e,"string");return A_(t)==="symbol"?t:String(t)}function Btt(e,t){if(A_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(A_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function hZ(e,t){var r=Pfe(e,t,"get");return jtt(e,r)}function jtt(e,t){return t.get?t.get.call(e):t.value}function xL(e,t,r){var n=Pfe(e,t,"set");return Ftt(e,n,r),r}function Pfe(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function Ftt(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var CL="collapsibleColumns",ztt=290,Htt=["nestedHeaders"],ny="collapsibleIndicator",dZ=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]),iy=new WeakMap,Vtt=function(e){Itt(r,e);var t=Mtt(r);function r(){var n;ktt(this,r);for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n=t.call.apply(t,[this].concat(o)),SL(My(n),"nestedHeadersPlugin",null),SL(My(n),"eventManager",new Fi(My(n))),SL(My(n),"headerStateManager",null),Ltt(My(n),iy,{writable:!0,value:null}),n}return Ptt(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[CL]}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){var o=this.hot.getSettings(),s=o.nestedHeaders;s||ni("You need to configure the Nested Headers plugin in order to use collapsible headers."),xL(this,iy,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",function(){return i.onInit()}),this.addHook("afterLoadData",function(){return i.onAfterLoadData.apply(i,arguments)}),this.addHook("afterGetColHeader",function(){return i.onAfterGetColHeader.apply(i,arguments)}),this.addHook("beforeOnCellMouseDown",function(a,h,p){return i.onBeforeOnCellMouseDown(a,h,p)}),Tp(gc(r.prototype),"enablePlugin",this).call(this),this.updatePlugin()}}},{key:"updatePlugin",value:function(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){var i=this.hot.getSettings(),o=i.collapsibleColumns;typeof o=="boolean"?this.headerStateManager.mapState(function(s){return{collapsible:s.origColspan>1}}):Array.isArray(o)&&(this.headerStateManager.mapState(function(){return{collapsible:!1}}),this.headerStateManager.mergeStateWith(o))}Tp(gc(r.prototype),"updatePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),xL(this,iy,null),this.nestedHeadersPlugin=null,this.clearButtons(),Tp(gc(r.prototype),"disablePlugin",this).call(this)}},{key:"clearButtons",value:function(){if(this.hot.view){var i=this.hot.view._wt.getSetting("columnHeaders").length,o=this.hot.view._wt.wtTable.THEAD,s=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,a=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,h=function(y){y&&y.parentNode.removeChild(y)};Or(0,i-1,function(p){var y=o.childNodes[p],S=s.childNodes[p],E=a?a.childNodes[p]:null;Or(0,y.childNodes.length-1,function(O){var A=y.childNodes[O].querySelector(".".concat(ny));h(A),S&&S.childNodes[O]&&(A=S.childNodes[O].querySelector(".".concat(ny)),h(A)),a&&E&&E.childNodes[O]&&(A=E.childNodes[O].querySelector(".".concat(ny)),h(A))})})}}},{key:"expandSection",value:function(i){this.toggleCollapsibleSection([i],"expand")}},{key:"collapseSection",value:function(i){this.toggleCollapsibleSection([i],"collapse")}},{key:"toggleAllCollapsibleSections",value:function(i){var o=this,s=this.headerStateManager.mapNodes(function(a){var h=a.collapsible,p=a.origColspan,y=a.headerLevel,S=a.columnIndex,E=a.isCollapsed;if(h===!0&&p>1&&(E&&i==="expand"||!E&&i==="collapse"))return{row:o.headerStateManager.levelToRowCoords(y),col:S}});this.toggleCollapsibleSection(s,i)}},{key:"collapseAll",value:function(){this.toggleAllCollapsibleSections("collapse")}},{key:"expandAll",value:function(){this.toggleAllCollapsibleSections("expand")}},{key:"toggleCollapsibleSection",value:function(i,o){var s=this;if(!dZ.has(o))throw new Error("Unsupported action is passed (".concat(o,")."));if(Array.isArray(i)){var a=Us(i,function(B){var j=B.row;return j<0}),h=a.length>0;Fe(a,function(B){var j,z=B.row,W=B.col,Q=(j=s.headerStateManager.getHeaderSettings(z,W))!==null&&j!==void 0?j:{},q=Q.collapsible,Se=Q.isCollapsed;if(!q||Se&&o==="collapse"||!Se&&o==="expand")return h=!1,!1});var p=[],y=[];h&&Fe(a,function(B){var j=B.row,z=B.col,W=s.headerStateManager.triggerNodeModification(o,j,z),Q=W.colspanCompensation,q=W.affectedColumns,Se=W.rollbackModification;Q>0&&(y.push.apply(y,cZ(q)),p.push(Se))});var S=this.getCollapsedColumns(),E=[];o==="collapse"?E=Pue([].concat(cZ(S),y)):o==="expand"&&(E=Us(S,function(B){return!y.includes(B)}));var O=dZ.get(o),A=this.hot.runHooks(O.beforeHook,S,E,h);if(A===!1){Fe(p,function(B){B()});return}this.hot.batchExecution(function(){Fe(y,function(B){hZ(s,iy).setValueAtIndex(s.hot.toPhysicalColumn(B),O.hideColumn)})},!0);var $=this.getCollapsedColumns().length!==S.length;this.hot.runHooks(O.afterHook,S,E,h,$),this.hot.render(),this.hot.view.adjustElementsSize(!0)}}},{key:"getCollapsedColumns",value:function(){return hZ(this,iy).getHiddenIndexes()}},{key:"onAfterGetColHeader",value:function(i,o,s){var a,h=(a=this.headerStateManager.getHeaderSettings(s,i))!==null&&a!==void 0?a:{},p=h.collapsible,y=h.origColspan,S=h.isCollapsed,E=p&&y>1&&i>=this.hot.getSettings().fixedColumnsStart,O=o.querySelector(".".concat(ny));if(E)O||(O=this.hot.rootDocument.createElement("div"),Vt(O,ny),o.querySelector("div:first-child").appendChild(O)),qr(O,["collapsed","expanded"]),S?(Vt(O,"collapsed"),fm(O,"+")):(Vt(O,"expanded"),fm(O,"-"));else{var A;(A=O)===null||A===void 0||A.remove()}}},{key:"onBeforeOnCellMouseDown",value:function(i,o){Wr(i.target,ny)&&(Wr(i.target,"expanded")?(this.eventManager.fireEvent(i.target,"mouseup"),this.toggleCollapsibleSection([o],"collapse")):Wr(i.target,"collapsed")&&(this.eventManager.fireEvent(i.target,"mouseup"),this.toggleCollapsibleSection([o],"expand")),Cu(i))}},{key:"onInit",value:function(){this.updatePlugin()}},{key:"onAfterLoadData",value:function(i,o){o||this.updatePlugin()}},{key:"destroy",value:function(){xL(this,iy,null),Tp(gc(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return CL}},{key:"PLUGIN_PRIORITY",get:function(){return ztt}},{key:"PLUGIN_DEPS",get:function(){return["plugin:NestedHeaders"]}},{key:"SETTING_KEYS",get:function(){return[CL].concat(Htt)}}]),r}(Yn),Utt=jr,Wtt=eo,Gtt=Vae,Ytt=ys,Ktt=Ou,qtt=Qb;Utt({target:"Object",stat:!0,sham:!Wtt},{getOwnPropertyDescriptors:function(t){for(var r=Ytt(t),n=Ktt.f,i=Gtt(r),o={},s=0,a,h;i.length>s;)h=n(r,a=i[s++]),h!==void 0&&qtt(o,a,h);return o}});var pZ=eo,Xtt=sn,Ztt=uo,Jtt=on,EL=JC,Qtt=iE,ert=rE,trt=Ga,rrt=YC,oy=Object.assign,mZ=Object.defineProperty,nrt=Xtt([].concat),irt=!oy||Jtt(function(){if(pZ&&oy({b:1},oy(mZ({},"a",{enumerable:!0,get:function(){mZ(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var e={},t={},r=Symbol(),n="abcdefghijklmnopqrst";return e[r]=7,n.split("").forEach(function(i){t[i]=i}),oy({},e)[r]!=7||EL(oy({},t)).join("")!=n})?function(t,r){for(var n=trt(t),i=arguments.length,o=1,s=Qtt.f,a=ert.f;i>o;)for(var h=rrt(arguments[o++]),p=s?nrt(EL(h),s(h)):EL(h),y=p.length,S=0,E;y>S;)E=p[S++],(!pZ||Ztt(a,h,E))&&(n[E]=h[E]);return n}:oy,ort=jr,gZ=irt;ort({target:"Object",stat:!0,arity:2,forced:Object.assign!==gZ},{assign:gZ});function _x(e){"@babel/helpers - typeof";return _x=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_x(e)}function yZ(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function art(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?yZ(Object(r),!0).forEach(function(n){srt(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):yZ(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function srt(e,t,r){return t=Afe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function vZ(e,t){return frt(e)||crt(e,t)||urt(e,t)||lrt()}function lrt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function urt(e,t){if(e){if(typeof e=="string")return _Z(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _Z(e,t)}}function _Z(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function crt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],h=!0,p=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;h=!1}else for(;!(h=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);h=!0);}catch(y){p=!0,i=y}finally{try{if(!h&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(p)throw i}}return a}}function frt(e){if(Array.isArray(e))return e}function hrt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function bZ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Afe(n.key),n)}}function drt(e,t,r){return t&&bZ(e.prototype,t),r&&bZ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Afe(e){var t=prt(e,"string");return _x(t)==="symbol"?t:String(t)}function prt(e,t){if(_x(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_x(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var mrt=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],grt=!1,yrt=!0,vrt=!0,_rt=function(){function e(t,r){hrt(this,e),this.hot=t,this.sortingStates=new pM,this.sortEmptyCells=grt,this.indicator=yrt,this.headerAction=vrt,this.compareFunctionFactory=void 0,this.mapName=r,this.hot.columnIndexMapper.registerMap(r,this.sortingStates)}return drt(e,[{key:"updateAllColumnsProperties",value:function(r){var n=this;pn(r)&&mn(r,function(i,o){mrt.includes(o)&&(n[o]=i)})}},{key:"getAllColumnsProperties",value:function(){var r={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return typeof this.compareFunctionFactory=="function"&&(r.compareFunctionFactory=this.compareFunctionFactory),r}},{key:"getSortOrderOfColumn",value:function(r){var n;return(n=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(r)))===null||n===void 0?void 0:n.sortOrder}},{key:"getIndexOfColumnInSortQueue",value:function(r){return r=this.hot.toPhysicalColumn(r),this.sortingStates.getEntries().findIndex(function(n){var i=vZ(n,1),o=i[0];return o===r})}},{key:"getNumberOfSortedColumns",value:function(){return this.sortingStates.getLength()}},{key:"isListOfSortedColumnsEmpty",value:function(){return this.getNumberOfSortedColumns()===0}},{key:"isColumnSorted",value:function(r){return pn(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(r)))}},{key:"getSortStates",value:function(){var r=this;if(this.sortingStates===null)return[];var n=this.sortingStates.getEntries();return n.map(function(i){var o=vZ(i,2),s=o[0],a=o[1];return art({column:r.hot.toVisualColumn(s)},a)})}},{key:"getColumnSortState",value:function(r){var n=this.getSortOrderOfColumn(r);if(pr(n))return{column:r,sortOrder:n}}},{key:"setSortStates",value:function(r){this.sortingStates.clear();for(var n=0;n<r.length;n+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(r[n].column),{sortOrder:r[n].sortOrder})}},{key:"destroy",value:function(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}]),e}(),PA="asc",AA="desc",brt="colHeader";function wrt(e){if(pn(e)===!1)return!1;var t=e.column,r=e.sortOrder;return Number.isInteger(t)&&[PA,AA].includes(r)}function Srt(e){if(e.some(function(r){return wrt(r)===!1}))return!1;var t=e.map(function(r){var n=r.column;return n});return new Set(t).size===t.length}function wZ(e){if(e!==AA)return e===PA?AA:PA}function SZ(e){var t=e.querySelector(".".concat(brt));return t}function xZ(e,t){if(e<0||!t.parentNode)return!1;var r=t.parentNode.parentNode.childNodes,n=Array.from(r).indexOf(t.parentNode)-r.length;return n===-1}function zF(e,t,r){return e===-1&&t>=0&&cm(r)===!1}var xrt="ascending",Crt="descending",Ife="indicatorDisabled",Mfe="columnSorting",$fe="sortAction",Dfe=new Map([[PA,xrt],[AA,Crt]]);function Ert(e,t,r,n){var i=[Mfe];if(n&&i.push($fe),r===!1)return i.push(Ife),i;var o=e.getSortOrderOfColumn(t);return pr(o)&&i.push(Dfe.get(o)),i}function Trt(){return Array.from(Dfe.values()).concat($fe,Ife,Mfe)}function Lfe(e,t,r){var n=t.locale;return function(i,o){var s=r.sortEmptyCells;return typeof i=="string"&&(i=i.toLocaleLowerCase(n)),typeof o=="string"&&(o=o.toLocaleLowerCase(n)),i===o?wu:_o(i)?_o(o)?wu:s&&e==="asc"?$i:Di:_o(o)?s&&e==="asc"?Di:$i:isNaN(i)&&!isNaN(o)?e==="asc"?Di:$i:!isNaN(i)&&isNaN(o)||(isNaN(i)||isNaN(o)||(i=parseFloat(i),o=parseFloat(o)),i<o)?e==="asc"?$i:Di:i>o?e==="asc"?Di:$i:wu}}var Nfe="default";function Ort(e,t,r){return function(n,i){var o=parseFloat(n),s=parseFloat(i),a=r.sortEmptyCells;if(o===s||isNaN(o)&&isNaN(s))return wu;if(a){if(_o(n))return e==="asc"?$i:Di;if(_o(i))return e==="asc"?Di:$i}return isNaN(o)?Di:isNaN(s)?$i:o<s?e==="asc"?$i:Di:o>s?e==="asc"?Di:$i:wu}}var Rrt="numeric";function krt(e,t,r){var n=t.checkedTemplate,i=t.uncheckedTemplate,o=r.sortEmptyCells;return function(s,a){var h=_o(s),p=_o(a),y=h?i:s,S=p?i:a,E=y===i||y===n,O=S===i||S===n;if(o===!1){if(h&&p===!1)return Di;if(h===!1&&p)return $i}return E===!1&&O?e==="asc"?$i:Di:E&&O===!1?e==="asc"?Di:$i:E===!1&&O===!1?Lfe(e,t,r)(s,a):y===i&&S===n?e==="asc"?$i:Di:y===n&&S===i?e==="asc"?Di:$i:wu}}var Prt="checkbox";function Art(e,t,r){return function(n,i){var o=r.sortEmptyCells;if(n===i)return wu;if(_o(n))return _o(i)?wu:o&&e==="asc"?$i:Di;if(_o(i))return o&&e==="asc"?Di:$i;var s=t.dateFormat,a=Ut(n,s),h=Ut(i,s);return a.isValid()?h.isValid()?h.isAfter(a)?e==="asc"?$i:Di:h.isBefore(a)?e==="asc"?Di:$i:wu:$i:Di}}var Irt="date",e4=Zs("sorting.compareFunctionFactory"),mM=e4.register,CZ=e4.getItem,Mrt=e4.hasItem,Bfe=Zs("sorting.mainSortComparator"),jfe=Bfe.register,$rt=Bfe.getItem;function Ffe(e){return Mrt(e)?CZ(e):CZ(Nfe)}mM(Rrt,Ort);mM(Prt,krt);mM(Irt,Art);mM(Nfe,Lfe);var wu=0,$i=-1,Di=1;function Drt(e,t){for(var r=$rt(t),n=arguments.length,i=new Array(n>2?n-2:0),o=2;o<n;o++)i[o-2]=arguments[o];e.sort(r.apply(void 0,i))}function EZ(e){return jrt(e)||Brt(e)||Nrt(e)||Lrt()}function Lrt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Nrt(e,t){if(e){if(typeof e=="string")return TZ(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return TZ(e,t)}}function TZ(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Brt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function jrt(e){if(Array.isArray(e))return e}function Frt(e,t){return function(r,n){var i=EZ(r),o=i.slice(1),s=EZ(n),a=s.slice(1);return function(p){var y=e[p],S=t[p],E=o[p],O=a[p],A=S.columnSorting,$=A.compareFunctionFactory?A.compareFunctionFactory:Ffe(S.type),B=$(y,S,A)(E,O);return B}(0)}}function I_(e){"@babel/helpers - typeof";return I_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},I_(e)}var zrt=["column"],Hrt=["column"];function ay(e){return Grt(e)||Wrt(e)||Urt(e)||Vrt()}function Vrt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Urt(e,t){if(e){if(typeof e=="string")return HF(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return HF(e,t)}}function Wrt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Grt(e){if(Array.isArray(e))return HF(e)}function HF(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function OZ(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function RZ(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?OZ(Object(r),!0).forEach(function(n){Yrt(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):OZ(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Yrt(e,t,r){return t=zfe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function kZ(e,t){if(e==null)return{};var r=Krt(e,t),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Krt(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,o;for(o=0;o<n.length;o++)i=n[o],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function qrt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function PZ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,zfe(n.key),n)}}function Xrt(e,t,r){return t&&PZ(e.prototype,t),r&&PZ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function zfe(e){var t=Zrt(e,"string");return I_(t)==="symbol"?t:String(t)}function Zrt(e,t){if(I_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(I_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Op(){return typeof Reflect<"u"&&Reflect.get?Op=Reflect.get.bind():Op=function(t,r,n){var i=Jrt(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Op.apply(this,arguments)}function Jrt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=yc(e),e!==null););return e}function Qrt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&VF(e,t)}function VF(e,t){return VF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},VF(e,t)}function ent(e){var t=nnt();return function(){var n=yc(e),i;if(t){var o=yc(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return tnt(this,i)}}function tnt(e,t){if(t&&(I_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return rnt(e)}function rnt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function nnt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function yc(e){return yc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},yc(e)}var UF="columnSorting",int=50,AZ="append",ont="replace";jfe(UF,Frt);gr.getSingleton().register("beforeColumnSort");gr.getSingleton().register("afterColumnSort");var Hfe=function(e){Qrt(r,e);var t=ent(r);function r(n){var i;return qrt(this,r),i=t.call(this,n),i.columnStatesManager=null,i.columnMetaCache=null,i.pluginKey=UF,i.indexesSequenceCache=null,i}return Xrt(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[this.pluginKey]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.columnStatesManager=new _rt(this.hot,"".concat(this.pluginKey,".sortingStates")),this.columnMetaCache=new Jh(function(o){var s=i.hot.toVisualColumn(o);return s===null&&(s=o),i.getMergedPluginSettings(s)}),this.hot.columnIndexMapper.registerMap("".concat(this.pluginKey,".columnMeta"),this.columnMetaCache),this.addHook("afterGetColHeader",function(o,s){return i.onAfterGetColHeader(o,s)}),this.addHook("beforeOnCellMouseDown",function(){return i.onBeforeOnCellMouseDown.apply(i,arguments)}),this.addHook("afterOnCellMouseDown",function(o,s){return i.onAfterOnCellMouseDown(o,s)}),this.addHook("afterInit",function(){return i.loadOrSortBySettings()}),this.addHook("afterLoadData",function(){return i.onAfterLoadData.apply(i,arguments)}),this.hot.view&&this.loadOrSortBySettings(),Op(yc(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var i=this,o=function(a,h){var p=SZ(h);xZ(a,h)===!1||p===null||i.updateHeaderClasses(p)};this.hot.addHook("afterGetColHeader",o),this.hot.addHookOnce("afterViewRender",function(){i.hot.removeHook("afterGetColHeader",o)}),this.hot.batchExecution(function(){i.indexesSequenceCache!==null&&(i.hot.rowIndexMapper.setIndexesSequence(i.indexesSequenceCache.getValues()),i.hot.rowIndexMapper.unregisterMap(i.pluginKey))},!0),this.hot.columnIndexMapper.unregisterMap("".concat(this.pluginKey,".columnMeta")),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,Op(yc(r.prototype),"disablePlugin",this).call(this)}},{key:"sort",value:function(i){var o=this.getSortConfig(),s=this.getNormalizedSortConfigs(i),a=this.areValidSortConfigs(s),h=this.hot.runHooks("beforeColumnSort",o,s,a);h!==!1&&(o.length===0&&this.indexesSequenceCache===null&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new bfe),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),a&&(this.columnStatesManager.setSortStates(s),this.sortByPresetSortStates(s),this.saveAllSortSettings(s)),this.hot.runHooks("afterColumnSort",o,a?s:o,a),a&&(this.hot.render(),this.hot.forceFullRender=!1,this.hot.view.render()))}},{key:"clearSort",value:function(){this.sort([])}},{key:"isSorted",value:function(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}},{key:"getSortConfig",value:function(i){return pr(i)?this.columnStatesManager.getColumnSortState(i):this.columnStatesManager.getSortStates()}},{key:"setSortConfig",value:function(i){var o=this.getNormalizedSortConfigs(i);this.areValidSortConfigs(o)&&this.columnStatesManager.setSortStates(o)}},{key:"getNormalizedSortConfigs",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(i)?i.slice(0,1):[i]}},{key:"areValidSortConfigs",value:function(i){var o=this.hot.countCols();return Srt(i)&&i.every(function(s){var a=s.column;return a<=o&&a>=0})}},{key:"saveAllSortSettings",value:function(i){var o=this,s=this.columnStatesManager.getAllColumnsProperties(),a=function(p){var y=p.column,S=kZ(p,zrt);return RZ({column:o.hot.toPhysicalColumn(y)},S)};s.initialConfig=dn(i,a),this.hot.runHooks("persistentStateSave","columnSorting",s)}},{key:"getAllSavedSortSettings",value:function(){var i=this,o={};this.hot.runHooks("persistentStateLoad","columnSorting",o);var s=o.value,a=function(p){var y=p.column,S=kZ(p,Hrt);return RZ({column:i.hot.toVisualColumn(y)},S)};return pr(s)&&Array.isArray(s.initialConfig)&&(s.initialConfig=dn(s.initialConfig,a)),s}},{key:"getColumnNextConfig",value:function(i){var o=this.columnStatesManager.getSortOrderOfColumn(i);if(pr(o)){var s=wZ(o);return pr(s)?{column:i,sortOrder:s}:void 0}var a=this.hot.countCols();if(Number.isInteger(i)&&i>=0&&i<a)return{column:i,sortOrder:wZ()}}},{key:"getNextSortConfig",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:AZ,s=this.columnStatesManager.getIndexOfColumnInSortQueue(i),a=s!==-1,h=this.getSortConfig(),p=this.getColumnNextConfig(i);if(a){if(ui(p))return[].concat(ay(h.slice(0,s)),ay(h.slice(s+1)));if(o===AZ)return[].concat(ay(h.slice(0,s)),ay(h.slice(s+1)),[p]);if(o===ont)return[].concat(ay(h.slice(0,s)),[p],ay(h.slice(s+1)))}return pr(p)?h.concat(p):h}},{key:"getPluginColumnConfig",value:function(i){if(pn(i)){var o=i[this.pluginKey];if(pn(o))return o}return{}}},{key:"getMergedPluginSettings",value:function(i){var o=this.hot.getSettings()[this.pluginKey],s=this.columnStatesManager.getAllColumnsProperties(),a=this.hot.getCellMeta(0,i),h=Object.getPrototypeOf(a);return Array.isArray(h.columns)?Object.assign(s,o,this.getPluginColumnConfig(h.columns[i])):hi(h.columns)?Object.assign(s,o,this.getPluginColumnConfig(h.columns(i))):Object.assign(s,o)}},{key:"getFirstCellSettings",value:function(i){var o=this.hot.getCellMeta(0,i),s=Object.create(o);return s[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(i)),s}},{key:"getNumberOfRowsToSort",value:function(i){var o=this.hot.getSettings();return o.maxRows<=i?o.maxRows:i-o.minSpareRows}},{key:"sortByPresetSortStates",value:function(i){var o=this;if(i.length===0){this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues());return}for(var s=[],a=this.hot.countRows(),h=function(B){return dn(i,function(j){return o.hot.getDataAtCell(B,j.column)})},p=0;p<this.getNumberOfRowsToSort(a);p+=1)s.push([this.hot.toPhysicalRow(p)].concat(h(p)));var y=dn(s,function($){return $[0]});Drt(s,this.pluginKey,dn(i,function($){return $.sortOrder}),dn(i,function($){return o.getFirstCellSettings($.column)}));for(var S=s.length;S<a;S+=1)s.push([S].concat(h(S)));var E=dn(s,function($){return $[0]}),O=new Map(dn(y,function($,B){return[$,E[B]]})),A=dn(this.hot.rowIndexMapper.getIndexesSequence(),function($){return O.has($)?O.get($):$});this.hot.rowIndexMapper.setIndexesSequence(A)}},{key:"loadOrSortBySettings",value:function(){var i=this.getAllSavedSortSettings();if(pn(i))this.sortBySettings(i);else{var o=this.hot.getSettings()[this.pluginKey];this.sortBySettings(o)}}},{key:"sortBySettings",value:function(i){if(pn(i)){this.columnStatesManager.updateAllColumnsProperties(i);var o=i.initialConfig;(Array.isArray(o)||pn(o))&&this.sort(o)}else this.hot.render()}},{key:"onAfterGetColHeader",value:function(i,o){var s=SZ(o);if(!(xZ(i,o)===!1||s===null)){var a=this.getFirstCellSettings(i)[this.pluginKey],h=a.indicator,p=a.headerAction;this.updateHeaderClasses(s,this.columnStatesManager,i,h,p)}}},{key:"updateHeaderClasses",value:function(i){if(qr(i,Trt()),this.enabled!==!1){for(var o=arguments.length,s=new Array(o>1?o-1:0),a=1;a<o;a++)s[a-1]=arguments[a];Vt(i,Ert.apply(void 0,s))}}},{key:"onUpdateSettings",value:function(i){Op(yc(r.prototype),"onUpdateSettings",this).call(this),this.columnMetaCache!==null&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),pr(i[this.pluginKey])&&this.sortBySettings(i[this.pluginKey])}},{key:"onAfterLoadData",value:function(i){i===!0&&this.hot.view&&this.loadOrSortBySettings()}},{key:"wasClickableHeaderClicked",value:function(i,o){var s=this.getFirstCellSettings(o)[this.pluginKey],a=s.headerAction;return a&&i.target.nodeName==="SPAN"}},{key:"onBeforeOnCellMouseDown",value:function(i,o,s,a){zF(o.row,o.col,i)!==!1&&this.wasClickableHeaderClicked(i,o.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(a.column=!0)}},{key:"onAfterOnCellMouseDown",value:function(i,o){zF(o.row,o.col,i)!==!1&&this.wasClickableHeaderClicked(i,o.col)&&(this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(o.col)),this.sort(this.getColumnNextConfig(o.col)))}},{key:"destroy",value:function(){var i;(i=this.columnStatesManager)===null||i===void 0||i.destroy(),Op(yc(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return UF}},{key:"PLUGIN_PRIORITY",get:function(){return int}}]),r}(Yn),ant=jr,t4=sn,snt=qh,lnt=lle,unt=Ale,IZ=on,cnt=RangeError,Vfe=String,Ufe=Math.floor,WF=t4(unt),MZ=t4("".slice),nS=t4(1 .toFixed),Xy=function(e,t,r){return t===0?r:t%2===1?Xy(e,t-1,r*e):Xy(e*e,t/2,r)},fnt=function(e){for(var t=0,r=e;r>=4096;)t+=12,r/=4096;for(;r>=2;)t+=1,r/=2;return t},sy=function(e,t,r){for(var n=-1,i=r;++n<6;)i+=t*e[n],e[n]=i%1e7,i=Ufe(i/1e7)},TL=function(e,t){for(var r=6,n=0;--r>=0;)n+=e[r],e[r]=Ufe(n/t),n=n%t*1e7},$Z=function(e){for(var t=6,r="";--t>=0;)if(r!==""||t===0||e[t]!==0){var n=Vfe(e[t]);r=r===""?n:r+WF("0",7-n.length)+n}return r},hnt=IZ(function(){return nS(8e-5,3)!=="0.000"||nS(.9,0)!=="1"||nS(1.255,2)!=="1.25"||nS(0xde0b6b3a7640080,0)!=="1000000000000000128"})||!IZ(function(){nS({})});ant({target:"Number",proto:!0,forced:hnt},{toFixed:function(t){var r=lnt(this),n=snt(t),i=[0,0,0,0,0,0],o="",s="0",a,h,p,y;if(n<0||n>20)throw cnt("Incorrect fraction digits");if(r!=r)return"NaN";if(r<=-1e21||r>=1e21)return Vfe(r);if(r<0&&(o="-",r=-r),r>1e-21)if(a=fnt(r*Xy(2,69,1))-69,h=a<0?r*Xy(2,-a,1):r/Xy(2,a,1),h*=4503599627370496,a=52-a,a>0){for(sy(i,0,h),p=n;p>=7;)sy(i,1e7,0),p-=7;for(sy(i,Xy(10,p,1),0),p=a-1;p>=23;)TL(i,1<<23),p-=23;TL(i,1<<p),sy(i,1,1),TL(i,2),s=$Z(i)}else sy(i,0,h),sy(i,1<<-a,0),s=$Z(i)+WF("0",n);return n>0?(y=s.length,s=o+(y<=n?"0."+WF("0",n-y)+s:MZ(s,0,y-n)+"."+MZ(s,y-n))):s=o+s,s}});function bx(e){"@babel/helpers - typeof";return bx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bx(e)}function dnt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function DZ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,mnt(n.key),n)}}function pnt(e,t,r){return t&&DZ(e.prototype,t),r&&DZ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function mnt(e){var t=gnt(e,"string");return bx(t)==="symbol"?t:String(t)}function gnt(e,t){if(bx(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(bx(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ynt=function(){function e(t,r){dnt(this,e),this.plugin=t,this.hot=this.plugin.hot,this.endpoints=[],this.settings=r,this.settingsType="array",this.currentEndpoint=null,this.cellsToSetCache=[]}return pnt(e,[{key:"getEndpoint",value:function(r){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[r]:this.endpoints[r]}},{key:"getAllEndpoints",value:function(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}},{key:"fillMissingEndpointData",value:function(r){return this.parseSettings(r.call(this))}},{key:"parseSettings",value:function(r){var n=this,i=[],o=r;if(!o&&typeof this.settings=="function"){this.settingsType="function";return}return o||(o=this.settings),Fe(o,function(s){var a={};n.assignSetting(s,a,"ranges",[[0,n.hot.countRows()-1]]),n.assignSetting(s,a,"reversedRowCoords",!1),n.assignSetting(s,a,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),n.assignSetting(s,a,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),n.assignSetting(s,a,"sourceColumn",s.destinationColumn),n.assignSetting(s,a,"type","sum"),n.assignSetting(s,a,"forceNumeric",!1),n.assignSetting(s,a,"suppressDataTypeErrors",!0),n.assignSetting(s,a,"suppressDataTypeErrors",!0),n.assignSetting(s,a,"customFunction",null),n.assignSetting(s,a,"readOnly",!0),n.assignSetting(s,a,"roundFloat",!1),i.push(a)}),i}},{key:"assignSetting",value:function(r,n,i,o){if(i==="ranges"&&r[i]===void 0){n[i]=o;return}else if(i==="ranges"&&r[i].length===0)return;if(r[i]===void 0){if(o instanceof Error)throw o;n[i]=o}else i==="destinationRow"&&n.reversedRowCoords?n[i]=this.hot.countRows()-r[i]-1:n[i]=r[i]}},{key:"resetSetupBeforeStructureAlteration",value:function(r,n,i){if(this.settingsType==="function"){var o=r.indexOf("row")>-1?"row":"col",s=this.getAllEndpoints();Fe(s,function(a){o==="row"&&a.destinationRow>=n&&(r==="insert_row"?a.alterRowOffset=i:r==="remove_row"&&(a.alterRowOffset=-1*i)),o==="col"&&a.destinationColumn>=n&&(r==="insert_col"?a.alterColumnOffset=i:r==="remove_col"&&(a.alterColumnOffset=-1*i))}),this.resetAllEndpoints(s,!1)}}},{key:"resetSetupAfterStructureAlteration",value:function(r,n,i,o,s){var a=this,h=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;if(this.settingsType==="function"){var p=function $(){return a.hot.removeHook("beforeViewRender",$),a.refreshAllEndpoints()};this.hot.addHookOnce("beforeViewRender",p);return}var y=r.indexOf("row")>-1?"row":"col",S=r.indexOf("remove")>-1?-1:1,E=this.getAllEndpoints(),O=r.indexOf("move_row")===0,A=n;Fe(E,function($){y==="row"&&$.destinationRow>=A&&($.alterRowOffset=S*i),y==="col"&&$.destinationColumn>=A&&($.alterColumnOffset=S*i)}),this.resetAllEndpoints(E,!O),O?Fe(E,function($){a.extendEndpointRanges($,A,o[0],o.length),a.recreatePhysicalRanges($),a.clearOffsetInformation($)}):Fe(E,function($){a.shiftEndpointCoordinates($,A)}),h&&this.refreshAllEndpoints()}},{key:"clearOffsetInformation",value:function(r){r.alterRowOffset=void 0,r.alterColumnOffset=void 0}},{key:"extendEndpointRanges",value:function(r,n,i,o){Fe(r.ranges,function(s){s[1]&&(n>=s[0]&&n<=s[1]?i>s[1]?s[1]+=o:i<s[0]&&(s[0]-=o):i>=s[0]&&i<=s[1]&&(s[1]-=o,n<=s[0]&&(s[0]+=1,s[1]+=1)))})}},{key:"recreatePhysicalRanges",value:function(r){var n=this,i=r.ranges,o=[],s=[];Fe(i,function(a){var h=[];if(a[1])for(var p=a[0];p<=a[1];p++)h.push(n.hot.toPhysicalRow(p));else h.push(n.hot.toPhysicalRow(a[0]));s.push(h)}),Fe(s,function(a){var h=[];Fe(a,function(p,y){y===0?h.push(p):a[y]!==a[y-1]+1&&(h.push(a[y-1]),o.push(h),h=[],h.push(p)),y===a.length-1&&(h.push(p),o.push(h))})}),r.ranges=o}},{key:"shiftEndpointCoordinates",value:function(r,n){r.alterRowOffset&&r.alterRowOffset!==0?(r.destinationRow+=r.alterRowOffset||0,Fe(r.ranges,function(i){Fe(i,function(o,s){o>=n&&(i[s]+=r.alterRowOffset||0)})})):r.alterColumnOffset&&r.alterColumnOffset!==0&&(r.destinationColumn+=r.alterColumnOffset||0,r.sourceColumn+=r.alterColumnOffset||0)}},{key:"resetAllEndpoints",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getAllEndpoints(),i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,o=n.some(function(s){var a=s.alterRowOffset||0,h=s.alterColumnOffset||0;return s.destinationRow+a>=r.hot.countRows()||s.destinationColumn+h>=r.hot.countCols()});o||(this.cellsToSetCache=[],Fe(n,function(s){r.resetEndpointValue(s,i)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}},{key:"refreshAllEndpoints",value:function(){var r=this;this.cellsToSetCache=[],Fe(this.getAllEndpoints(),function(n){r.currentEndpoint=n,r.plugin.calculate(n),r.setEndpointValue(n,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}},{key:"refreshChangedEndpoints",value:function(r){var n=this,i=[];this.cellsToSetCache=[],Fe(r,function(o,s,a){"".concat(o[2]||"")!=="".concat(o[3])&&Fe(n.getAllEndpoints(),function(h,p){n.hot.propToCol(a[s][1])===h.sourceColumn&&i.indexOf(p)===-1&&i.push(p)})}),Fe(i,function(o){n.refreshEndpoint(n.getEndpoint(o))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}},{key:"refreshEndpoint",value:function(r){this.currentEndpoint=r,this.plugin.calculate(r),this.setEndpointValue(r),this.currentEndpoint=null}},{key:"resetEndpointValue",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=r.alterRowOffset||0,o=r.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(r.destinationRow+(n?i:0)),this.hot.toVisualColumn(r.destinationColumn+(n?o:0)),""])}},{key:"setEndpointValue",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=this.hot.toVisualRow(r.destinationRow);if(r.destinationRow>=this.hot.countRows()||r.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}var s=this.hot.toVisualRow(r.destinationRow);if(s!==null){var a=this.hot.getCellMeta(s,r.destinationColumn);(n==="init"||a.readOnly!==r.readOnly)&&(a.readOnly=r.readOnly,a.className="columnSummaryResult")}r.roundFloat&&!isNaN(r.result)&&(r.result=r.result.toFixed(r.roundFloat)),i?this.hot.setDataAtCell(o,r.destinationColumn,r.result,"ColumnSummary.set"):this.cellsToSetCache.push([o,r.destinationColumn,r.result]),r.alterRowOffset=void 0,r.alterColumnOffset=void 0}},{key:"throwOutOfBoundsWarning",value:function(){ni("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}]),e}();const vnt=ynt;function OL(e){return e==null||isNaN(e)}function M_(e){"@babel/helpers - typeof";return M_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},M_(e)}var LZ;function _nt(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function bnt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function NZ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Snt(n.key),n)}}function wnt(e,t,r){return t&&NZ(e.prototype,t),r&&NZ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Snt(e){var t=xnt(e,"string");return M_(t)==="symbol"?t:String(t)}function xnt(e,t){if(M_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(M_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Bk(){return typeof Reflect<"u"&&Reflect.get?Bk=Reflect.get.bind():Bk=function(t,r,n){var i=Cnt(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Bk.apply(this,arguments)}function Cnt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=$_(e),e!==null););return e}function Ent(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&GF(e,t)}function GF(e,t){return GF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},GF(e,t)}function Tnt(e){var t=knt();return function(){var n=$_(e),i;if(t){var o=$_(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Ont(this,i)}}function Ont(e,t){if(t&&(M_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Rnt(e)}function Rnt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function knt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function $_(e){return $_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},$_(e)}var RL="columnSummary",Pnt=220,Ant=function(e){Ent(r,e);var t=Tnt(r);function r(n){var i;return bnt(this,r),i=t.call(this,n),i.endpoints=null,i}return wnt(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[RL]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.settings=this.hot.getSettings()[RL],this.endpoints=new vnt(this,this.settings),this.addHook("afterInit",function(){return i.onAfterInit.apply(i,arguments)}),this.addHook("afterChange",function(){return i.onAfterChange.apply(i,arguments)}),this.addHook("beforeCreateRow",function(o,s,a){return i.endpoints.resetSetupBeforeStructureAlteration("insert_row",o,s,null,a)}),this.addHook("beforeCreateCol",function(o,s,a){return i.endpoints.resetSetupBeforeStructureAlteration("insert_col",o,s,null,a)}),this.addHook("beforeRemoveRow",function(){for(var o,s=arguments.length,a=new Array(s),h=0;h<s;h++)a[h]=arguments[h];return(o=i.endpoints).resetSetupBeforeStructureAlteration.apply(o,["remove_row"].concat(a))}),this.addHook("beforeRemoveCol",function(){for(var o,s=arguments.length,a=new Array(s),h=0;h<s;h++)a[h]=arguments[h];return(o=i.endpoints).resetSetupBeforeStructureAlteration.apply(o,["remove_col"].concat(a))}),this.addHook("afterCreateRow",function(o,s,a){return i.endpoints.resetSetupAfterStructureAlteration("insert_row",o,s,null,a)}),this.addHook("afterCreateCol",function(o,s,a){return i.endpoints.resetSetupAfterStructureAlteration("insert_col",o,s,null,a)}),this.addHook("afterRemoveRow",function(){for(var o,s=arguments.length,a=new Array(s),h=0;h<s;h++)a[h]=arguments[h];return(o=i.endpoints).resetSetupAfterStructureAlteration.apply(o,["remove_row"].concat(a))}),this.addHook("afterRemoveCol",function(){for(var o,s=arguments.length,a=new Array(s),h=0;h<s;h++)a[h]=arguments[h];return(o=i.endpoints).resetSetupAfterStructureAlteration.apply(o,["remove_col"].concat(a))}),this.addHook("afterRowMove",function(){return i.onAfterRowMove.apply(i,arguments)}),Bk($_(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.endpoints=null,this.settings=null,this.currentEndpoint=null}},{key:"calculate",value:function(i){switch(i.type.toLowerCase()){case"sum":i.result=this.calculateSum(i);break;case"min":i.result=this.calculateMinMax(i,i.type);break;case"max":i.result=this.calculateMinMax(i,i.type);break;case"count":i.result=this.countEntries(i);break;case"average":i.result=this.calculateAverage(i);break;case"custom":i.result=i.customFunction.call(this,i);break}}},{key:"calculateSum",value:function(i){var o=this,s=0;return mn(i.ranges,function(a){s+=o.getPartialSum(a,i.sourceColumn)}),s}},{key:"getPartialSum",value:function(i,o){var s=0,a=i[1]||i[0],h=null,p=0;do{if(h=this.getCellValue(a,o),h=OL(h)?null:h,h!==null){var y=("".concat(h).split(".")[1]||[]).length||1;y>p&&(p=y)}s+=h||0,a-=1}while(a>=i[0]);return Math.round(s*Math.pow(10,p))/Math.pow(10,p)}},{key:"calculateMinMax",value:function(i,o){var s=this,a=null;return mn(i.ranges,function(h){var p=s.getPartialMinMax(h,i.sourceColumn,o);if(a===null&&p!==null&&(a=p),p!==null)switch(o){case"min":a=Math.min(a,p);break;case"max":a=Math.max(a,p);break}}),a===null?"Not enough data":a}},{key:"getPartialMinMax",value:function(i,o,s){var a=null,h=i[1]||i[0],p;do{if(p=this.getCellValue(h,o),p=OL(p)?null:p,a===null)a=p;else if(p!==null)switch(s){case"min":a=Math.min(a,p);break;case"max":a=Math.max(a,p);break}h-=1}while(h>=i[0]);return a}},{key:"countEmpty",value:function(i,o){var s,a=0,h=i[1]||i[0];do s=this.getCellValue(h,o),s=OL(s)?null:s,s===null&&(a+=1),h-=1;while(h>=i[0]);return a}},{key:"countEntries",value:function(i){var o=this,s=0,a=i.ranges;return mn(a,function(h){var p=h[1]===void 0?1:h[1]-h[0]+1,y=o.countEmpty(h,i.sourceColumn);s+=p,s-=y}),s}},{key:"calculateAverage",value:function(i){var o=this.calculateSum(i),s=this.countEntries(i);return o/s}},{key:"getCellValue",value:function(i,o){var s=this.hot.toVisualRow(i),a=this.hot.toVisualColumn(o),h=this.hot.getSourceDataAtCell(i,o),p="";if(s!==null&&a!==null&&(p=this.hot.getCellMeta(s,a).className||""),p.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof h=="string"&&(h=h.replace(/,/,".")),h=parseFloat(h)),isNaN(h)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(Jn(LZ||(LZ=_nt(["ColumnSummary plugin: cell at (",", ",`) is not in a 
          numeric format. Cannot do the calculation.`],["ColumnSummary plugin: cell at (",", ",`) is not in a\\x20
          numeric format. Cannot do the calculation.`])),i,o));return h}},{key:"onAfterInit",value:function(){this.endpoints.endpoints=this.endpoints.parseSettings(),this.endpoints.refreshAllEndpoints(!0)}},{key:"onAfterChange",value:function(i,o){i&&o!=="ColumnSummary.reset"&&o!=="ColumnSummary.set"&&o!=="loadData"&&this.endpoints.refreshChangedEndpoints(i)}},{key:"onAfterRowMove",value:function(i,o){this.endpoints.resetSetupBeforeStructureAlteration("move_row",i[0],i.length,i,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",o,i.length,i,this.pluginName)}}],[{key:"PLUGIN_KEY",get:function(){return RL}},{key:"PLUGIN_PRIORITY",get:function(){return Pnt}}]),r}(Yn);function wx(e){"@babel/helpers - typeof";return wx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wx(e)}function Int(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function BZ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,$nt(n.key),n)}}function Mnt(e,t,r){return t&&BZ(e.prototype,t),r&&BZ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function $nt(e){var t=Dnt(e,"string");return wx(t)==="symbol"?t:String(t)}function Dnt(e,t){if(wx(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(wx(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Lnt=function(){function e(t,r){Int(this,e),this.rootDocument=t,this.isRtl=r,this.container=null,this.editor=this.createEditor(),this.editorStyle=this.editor.style,this.hidden=!0,this.hide()}return Mnt(e,[{key:"setPosition",value:function(r,n){this.editorStyle.left="".concat(r,"px"),this.editorStyle.top="".concat(n,"px")}},{key:"setSize",value:function(r,n){if(r&&n){var i=this.getInputElement();i.style.width="".concat(r,"px"),i.style.height="".concat(n,"px")}}},{key:"getSize",value:function(){return{width:ii(this.getInputElement()),height:Ni(this.getInputElement())}}},{key:"resetSize",value:function(){var r=this.getInputElement();r.style.width="",r.style.height=""}},{key:"setReadOnlyState",value:function(r){var n=this.getInputElement();n.readOnly=r}},{key:"show",value:function(){this.editorStyle.display="block",this.hidden=!1}},{key:"hide",value:function(){this.hidden||(this.editorStyle.display="none"),this.hidden=!0}},{key:"isVisible",value:function(){return this.editorStyle.display==="block"}},{key:"setValue",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=r||"";this.getInputElement().value=n}},{key:"getValue",value:function(){return this.getInputElement().value}},{key:"isFocused",value:function(){return this.rootDocument.activeElement===this.getInputElement()}},{key:"focus",value:function(){this.getInputElement().focus()}},{key:"createEditor",value:function(){var r=this.rootDocument.createElement("div"),n=this.rootDocument.createElement("textarea");return r.style.display="none",this.container=this.rootDocument.createElement("div"),this.container.setAttribute("dir",this.isRtl?"rtl":"ltr"),Vt(this.container,e.CLASS_EDITOR_CONTAINER),this.rootDocument.body.appendChild(this.container),Vt(r,e.CLASS_EDITOR),Vt(n,e.CLASS_INPUT),r.appendChild(n),this.container.appendChild(r),r}},{key:"getInputElement",value:function(){return this.editor.querySelector(".".concat(e.CLASS_INPUT))}},{key:"destroy",value:function(){var r=this.container?this.container.parentNode:null;this.editor.parentNode.removeChild(this.editor),this.editor=null,this.editorStyle=null,r&&r.removeChild(this.container)}}],[{key:"CLASS_EDITOR_CONTAINER",get:function(){return"htCommentsContainer"}},{key:"CLASS_EDITOR",get:function(){return"htComments"}},{key:"CLASS_INPUT",get:function(){return"htCommentTextArea"}},{key:"CLASS_CELL",get:function(){return"htCommentCell"}}]),e}();const Nnt=Lnt;var hn="---------";function Bnt(){return{name:hn}}function jnt(e){return dn(e,function(t){return{start:t.getTopStartCorner(),end:t.getBottomEndCorner()}})}function ER(e){return Wr(e,"htSeparator")}function Fnt(e){return Wr(e,"htSubmenu")}function TR(e){return Wr(e,"htDisabled")}function OR(e){return Wr(e,"htSelectionDisabled")}function zm(e){var t=e.getSelected();return!t||t[0]<0?null:t}function znt(e,t){if(e.indexOf(t)!==-1)return e;var r=e.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","");return"".concat(r," ").concat(t)}function Hnt(e,t){if(e.indexOf(t)!==-1)return e;var r=e.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","");return"".concat(r," ").concat(t)}function Jd(e,t){var r={};return Fe(e,function(n){n.forAll(function(i,o){i>=0&&o>=0&&(r[i]||(r[i]=[]),r[i][o]=t(i,o))})}),r}function Zf(e,t,r,n,i){Fe(e,function(o){o.forAll(function(s,a){s>=0&&a>=0&&Vnt(s,a,t,r,n,i)})})}function Vnt(e,t,r,n,i,o){var s=i(e,t),a=n;s.className&&(r==="vertical"?a=znt(s.className,n):a=Hnt(s.className,n)),o(e,t,"className",a)}function hu(e,t){var r=!1;return Array.isArray(e)&&Fe(e,function(n){return n.forAll(function(i,o){if(i>=0&&o>=0&&t(i,o))return r=!0,!1}),r}),r}function ic(e){return'<span class="selected">'.concat(String.fromCharCode(10003),"</span>").concat(e)}function Unt(e,t){return!e.hidden||!(typeof e.hidden=="function"&&e.hidden.call(t))}function Wfe(e,t){for(var r=e.slice(0),n=0;n<r.length&&r[n].name===t;)r.shift();return r}function Wnt(e,t){var r=e.slice(0);return r.reverse(),r=Wfe(r,t),r.reverse(),r}function Gnt(e){var t=[];return Fe(e,function(r,n){n>0?t[t.length-1].name!==r.name&&t.push(r):t.push(r)}),t}function Ynt(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:hn,r=e.slice(0);return r=Wfe(r,t),r=Wnt(r,t),r=Gnt(r),r}function Sx(e){"@babel/helpers - typeof";return Sx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sx(e)}function Knt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jZ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Xnt(n.key),n)}}function qnt(e,t,r){return t&&jZ(e.prototype,t),r&&jZ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Xnt(e){var t=Znt(e,"string");return Sx(t)==="symbol"?t:String(t)}function Znt(e,t){if(Sx(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Sx(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Jnt=250,Qnt=250,Gfe=function(){function e(t){Knt(this,e),this.wasLastActionShow=!0,this.showDebounced=null,this.hidingTimer=null,this.updateDelay(t)}return qnt(e,[{key:"hide",value:function(){var r=this;this.wasLastActionShow=!1,this.hidingTimer=setTimeout(function(){r.wasLastActionShow===!1&&r.runLocalHooks("hide")},Qnt)}},{key:"show",value:function(r){this.wasLastActionShow=!0,this.showDebounced(r)}},{key:"cancelHiding",value:function(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}},{key:"updateDelay",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Jnt;this.showDebounced=tce(function(i){r.wasLastActionShow&&r.runLocalHooks("show",i.from.row,i.from.col)},n)}},{key:"destroy",value:function(){this.clearLocalHooks()}}]),e}();ci(Gfe,Ya);const eit=Gfe;var Yfe="ContextMenu:items",tn=Yfe,r4="".concat(tn,".noItems"),n4="".concat(tn,".insertRowAbove"),i4="".concat(tn,".insertRowBelow"),o4="".concat(tn,".insertColumnOnTheLeft"),a4="".concat(tn,".insertColumnOnTheRight"),s4="".concat(tn,".removeRow"),l4="".concat(tn,".removeColumn"),u4="".concat(tn,".undo"),c4="".concat(tn,".redo"),f4="".concat(tn,".readOnly"),h4="".concat(tn,".clearColumn"),d4="".concat(tn,".copy"),p4="".concat(tn,".copyWithHeaders"),m4="".concat(tn,".copyWithGroupHeaders"),g4="".concat(tn,".copyHeadersOnly"),y4="".concat(tn,".cut"),v4="".concat(tn,".freezeColumn"),_4="".concat(tn,".unfreezeColumn"),b4="".concat(tn,".mergeCells"),w4="".concat(tn,".unmergeCells"),S4="".concat(tn,".addComment"),x4="".concat(tn,".editComment"),C4="".concat(tn,".removeComment"),E4="".concat(tn,".readOnlyComment"),T4="".concat(tn,".align"),O4="".concat(tn,".align.left"),R4="".concat(tn,".align.center"),k4="".concat(tn,".align.right"),P4="".concat(tn,".align.justify"),A4="".concat(tn,".align.top"),I4="".concat(tn,".align.middle"),M4="".concat(tn,".align.bottom"),$4="".concat(tn,".borders"),D4="".concat(tn,".borders.top"),L4="".concat(tn,".borders.right"),N4="".concat(tn,".borders.bottom"),B4="".concat(tn,".borders.left"),j4="".concat(tn,".borders.remove"),F4="".concat(tn,".nestedHeaders.insertChildRow"),z4="".concat(tn,".nestedHeaders.detachFromParent"),H4="".concat(tn,".hideColumn"),V4="".concat(tn,".showColumn"),U4="".concat(tn,".hideRow"),W4="".concat(tn,".showRow"),Ea="Filters:",zi="".concat(Ea,"conditions"),gM="".concat(zi,".none"),G4="".concat(zi,".isEmpty"),Y4="".concat(zi,".isNotEmpty"),K4="".concat(zi,".isEqualTo"),q4="".concat(zi,".isNotEqualTo"),X4="".concat(zi,".beginsWith"),Z4="".concat(zi,".endsWith"),J4="".concat(zi,".contains"),Q4="".concat(zi,".doesNotContain"),tit="".concat(zi,".byValue"),eW="".concat(zi,".greaterThan"),tW="".concat(zi,".greaterThanOrEqualTo"),rW="".concat(zi,".lessThan"),nW="".concat(zi,".lessThanOrEqualTo"),iW="".concat(zi,".isBetween"),oW="".concat(zi,".isNotBetween"),aW="".concat(zi,".after"),sW="".concat(zi,".before"),lW="".concat(zi,".today"),uW="".concat(zi,".tomorrow"),cW="".concat(zi,".yesterday"),fW="".concat(Ea,"labels.filterByCondition"),hW="".concat(Ea,"labels.filterByValue"),dW="".concat(Ea,"labels.conjunction"),yM="".concat(Ea,"labels.disjunction"),IA="".concat(Ea,"values.blankCells"),pW="".concat(Ea,"buttons.selectAll"),mW="".concat(Ea,"buttons.clear"),gW="".concat(Ea,"buttons.ok"),yW="".concat(Ea,"buttons.cancel"),vW="".concat(Ea,"buttons.placeholder.search"),_W="".concat(Ea,"buttons.placeholder.value"),bW="".concat(Ea,"buttons.placeholder.secondValue");const rit=Object.freeze(Object.defineProperty({__proto__:null,CONTEXTMENU_ITEMS_ADD_COMMENT:S4,CONTEXTMENU_ITEMS_ALIGNMENT:T4,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:M4,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:R4,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:P4,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:O4,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:I4,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:k4,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:A4,CONTEXTMENU_ITEMS_BORDERS:$4,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:N4,CONTEXTMENU_ITEMS_BORDERS_LEFT:B4,CONTEXTMENU_ITEMS_BORDERS_RIGHT:L4,CONTEXTMENU_ITEMS_BORDERS_TOP:D4,CONTEXTMENU_ITEMS_CLEAR_COLUMN:h4,CONTEXTMENU_ITEMS_COPY:d4,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:g4,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:m4,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:p4,CONTEXTMENU_ITEMS_CUT:y4,CONTEXTMENU_ITEMS_EDIT_COMMENT:x4,CONTEXTMENU_ITEMS_FREEZE_COLUMN:v4,CONTEXTMENU_ITEMS_HIDE_COLUMN:H4,CONTEXTMENU_ITEMS_HIDE_ROW:U4,CONTEXTMENU_ITEMS_INSERT_LEFT:o4,CONTEXTMENU_ITEMS_INSERT_RIGHT:a4,CONTEXTMENU_ITEMS_MERGE_CELLS:b4,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:z4,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:F4,CONTEXTMENU_ITEMS_NO_ITEMS:r4,CONTEXTMENU_ITEMS_READ_ONLY:f4,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:E4,CONTEXTMENU_ITEMS_REDO:c4,CONTEXTMENU_ITEMS_REMOVE_BORDERS:j4,CONTEXTMENU_ITEMS_REMOVE_COLUMN:l4,CONTEXTMENU_ITEMS_REMOVE_COMMENT:C4,CONTEXTMENU_ITEMS_REMOVE_ROW:s4,CONTEXTMENU_ITEMS_ROW_ABOVE:n4,CONTEXTMENU_ITEMS_ROW_BELOW:i4,CONTEXTMENU_ITEMS_SHOW_COLUMN:V4,CONTEXTMENU_ITEMS_SHOW_ROW:W4,CONTEXTMENU_ITEMS_UNDO:u4,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:_4,CONTEXTMENU_ITEMS_UNMERGE_CELLS:w4,CONTEXT_MENU_ITEMS_NAMESPACE:Yfe,FILTERS_BUTTONS_CANCEL:yW,FILTERS_BUTTONS_CLEAR:mW,FILTERS_BUTTONS_OK:gW,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:vW,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:bW,FILTERS_BUTTONS_PLACEHOLDER_VALUE:_W,FILTERS_BUTTONS_SELECT_ALL:pW,FILTERS_CONDITIONS_AFTER:aW,FILTERS_CONDITIONS_BEFORE:sW,FILTERS_CONDITIONS_BEGINS_WITH:X4,FILTERS_CONDITIONS_BETWEEN:iW,FILTERS_CONDITIONS_BY_VALUE:tit,FILTERS_CONDITIONS_CONTAINS:J4,FILTERS_CONDITIONS_EMPTY:G4,FILTERS_CONDITIONS_ENDS_WITH:Z4,FILTERS_CONDITIONS_EQUAL:K4,FILTERS_CONDITIONS_GREATER_THAN:eW,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:tW,FILTERS_CONDITIONS_LESS_THAN:rW,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:nW,FILTERS_CONDITIONS_NAMESPACE:zi,FILTERS_CONDITIONS_NONE:gM,FILTERS_CONDITIONS_NOT_BETWEEN:oW,FILTERS_CONDITIONS_NOT_CONTAIN:Q4,FILTERS_CONDITIONS_NOT_EMPTY:Y4,FILTERS_CONDITIONS_NOT_EQUAL:q4,FILTERS_CONDITIONS_TODAY:lW,FILTERS_CONDITIONS_TOMORROW:uW,FILTERS_CONDITIONS_YESTERDAY:cW,FILTERS_DIVS_FILTER_BY_CONDITION:fW,FILTERS_DIVS_FILTER_BY_VALUE:hW,FILTERS_LABELS_CONJUNCTION:dW,FILTERS_LABELS_DISJUNCTION:yM,FILTERS_NAMESPACE:Ea,FILTERS_VALUES_BLANK_CELLS:IA},Symbol.toStringTag,{value:"Module"}));function D_(e){"@babel/helpers - typeof";return D_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},D_(e)}function kL(e,t,r){return t=Kfe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function nit(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function FZ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Kfe(n.key),n)}}function iit(e,t,r){return t&&FZ(e.prototype,t),r&&FZ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Kfe(e){var t=oit(e,"string");return D_(t)==="symbol"?t:String(t)}function oit(e,t){if(D_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(D_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Rp(){return typeof Reflect<"u"&&Reflect.get?Rp=Reflect.get.bind():Rp=function(t,r,n){var i=ait(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Rp.apply(this,arguments)}function ait(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=vc(e),e!==null););return e}function sit(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&YF(e,t)}function YF(e,t){return YF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},YF(e,t)}function lit(e){var t=cit();return function(){var n=vc(e),i;if(t){var o=vc(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return uit(this,i)}}function uit(e,t){if(t&&(D_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return qfe(e)}function qfe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function cit(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function vc(e){return vc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},vc(e)}var PL="comments",fit=60,RR=new WeakMap,nu="comment",ly="value",zZ="style",kR="readOnly",hit=function(e){sit(r,e);var t=lit(r);function r(n){var i;return nit(this,r),i=t.call(this,n),i.editor=null,i.displaySwitch=null,i.eventManager=null,i.range={},i.preventEditorAutoSwitch=!1,RR.set(qfe(i),{tempEditorDimensions:{},cellBelowCursor:null}),i}return iit(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[PL]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.editor||(this.editor=new Nnt(this.hot.rootDocument,this.hot.isRtl())),this.eventManager||(this.eventManager=new Fi(this)),this.displaySwitch||(this.displaySwitch=new eit(this.getDisplayDelaySetting())),this.addHook("afterContextMenuDefaultOptions",function(o){return i.addToContextMenu(o)}),this.addHook("afterRenderer",function(o,s,a,h,p,y){return i.onAfterRenderer(o,y)}),this.addHook("afterScrollHorizontally",function(){return i.hide()}),this.addHook("afterScrollVertically",function(){return i.hide()}),this.addHook("afterBeginEditing",function(){return i.hide()}),this.displaySwitch.addLocalHook("hide",function(){return i.hide()}),this.displaySwitch.addLocalHook("show",function(o,s){return i.showAtCell(o,s)}),this.registerListeners(),Rp(vc(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Rp(vc(r.prototype),"updatePlugin",this).call(this),this.displaySwitch.updateDelay(this.getDisplayDelaySetting())}},{key:"disablePlugin",value:function(){Rp(vc(r.prototype),"disablePlugin",this).call(this)}},{key:"registerListeners",value:function(){var i=this,o=this.hot.rootDocument;this.eventManager.addEventListener(o,"mouseover",function(s){return i.onMouseOver(s)}),this.eventManager.addEventListener(o,"mousedown",function(s){return i.onMouseDown(s)}),this.eventManager.addEventListener(o,"mouseup",function(){return i.onMouseUp()}),this.eventManager.addEventListener(this.editor.getInputElement(),"blur",function(){return i.onEditorBlur()}),this.eventManager.addEventListener(this.editor.getInputElement(),"mousedown",function(s){return i.onEditorMouseDown(s)}),this.eventManager.addEventListener(this.editor.getInputElement(),"mouseup",function(s){return i.onEditorMouseUp(s)})}},{key:"setRange",value:function(i){this.range=i}},{key:"clearRange",value:function(){this.range={}}},{key:"targetIsCellWithComment",value:function(i){var o=em(i.target,"TD","TBODY");return!!(o&&Wr(o,"htCommentCell")&&em(o,[this.hot.rootElement]))}},{key:"targetIsCommentTextArea",value:function(i){return this.editor.getInputElement()===i.target}},{key:"setComment",value:function(i){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');var o=this.editor.getValue(),s="";i!=null?s=i:o!=null&&(s=o);var a=this.range.from.row,h=this.range.from.col;this.updateCommentMeta(a,h,kL({},ly,s)),this.hot.render()}},{key:"setCommentAtCell",value:function(i,o,s){this.setRange({from:this.hot._createCellCoords(i,o)}),this.setComment(s)}},{key:"removeComment",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,nu),i&&this.hot.render(),this.hide()}},{key:"removeCommentAtCell",value:function(i,o){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setRange({from:this.hot._createCellCoords(i,o)}),this.removeComment(s)}},{key:"getComment",value:function(){var i=this.range.from.row,o=this.range.from.col;return this.getCommentMeta(i,o,ly)}},{key:"getCommentAtCell",value:function(i,o){return this.getCommentMeta(i,o,ly)}},{key:"show",value:function(){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');var i=this.range.from,o=i.row,s=i.col;if(o<0||o>this.hot.countSourceRows()-1||s<0||s>this.hot.countSourceCols()-1)return!1;var a=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return this.editor.setValue(a[nu]?a[nu][ly]:""),this.editor.show(),this.refreshEditor(!0),!0}},{key:"showAtCell",value:function(i,o){return this.setRange({from:this.hot._createCellCoords(i,o)}),this.show()}},{key:"hide",value:function(){this.editor.hide()}},{key:"refreshEditor",value:function(){var i,o,s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!(!s&&(!this.range.from||!this.editor.isVisible()))){var a=this.hot,h=a.rowIndexMapper,p=a.columnIndexMapper,y=this.range.from,S=y.row,E=y.col,O=h.getRenderableFromVisualIndex(S),A=p.getRenderableFromVisualIndex(E),$=O===null;this.editor.setPosition(0,0),O===null&&(O=h.getRenderableFromVisualIndex(h.getNearestNotHiddenIndex(S,-1))),A===null&&(A=p.getRenderableFromVisualIndex(p.getNearestNotHiddenIndex(E,-1)));var B=O===null,j=A===null;O=(i=O)!==null&&i!==void 0?i:0,A=(o=A)!==null&&o!==void 0?o:0;var z=this.hot,W=z.rootWindow,Q=z.view._wt,q=Q.wtTable,Se=Q.getCell({row:O,col:A},!0),Ie=this.getCommentMeta(S,E,zZ);Ie?this.editor.setSize(Ie.width,Ie.height):this.editor.resetSize();var He=j?0:q.getStretchedColumnWidth(A),Le=$&&!B?Ni(Se):0,ze=Se.getBoundingClientRect(),ct=ze.left,At=ze.top,Qe=ze.width,de=ze.height,Ce=this.editor.getSize(),pt=Ce.width,Ct=Ce.height,ie=this.hot.rootWindow,M=ie.innerWidth,U=ie.innerHeight,K=this.hot.rootDocument.documentElement,re=ct+W.scrollX+He,me=At+W.scrollY+Le;this.hot.isRtl()&&(re-=pt+He),this.hot.isLtr()&&ct+Qe+pt>M?re=ct+W.scrollX-pt-1:this.hot.isRtl()&&re<-(K.scrollWidth-K.clientWidth)&&(re=ct+W.scrollX+He+1),At+Ct>U&&(me-=Ct-de+1),this.editor.setPosition(re,me),this.editor.setReadOnlyState(this.getCommentMeta(S,E,kR))}}},{key:"checkSelectionCommentsConsistency",value:function(){var i=this.hot.getSelectedRangeLast();if(!i)return!1;var o=!1,s=i.getTopStartCorner();return this.getCommentMeta(s.row,s.col,ly)&&(o=!0),o}},{key:"updateCommentMeta",value:function(i,o,s){var a=this.hot.getCellMeta(i,o)[nu],h;a?(h=ba(a),sM(h,s)):h=s,this.hot.setCellMeta(i,o,nu,h)}},{key:"getCommentMeta",value:function(i,o,s){var a=this.hot.getCellMeta(i,o);if(a[nu])return a[nu][s]}},{key:"onMouseDown",value:function(i){if(!(!this.hot.view||!this.hot.view._wt)&&!this.preventEditorAutoSwitch&&!this.targetIsCommentTextArea(i)){var o=em(i.target,"TD","TBODY"),s=null;o&&(s=this.hot.getCoords(o)),(!o||this.range.from&&s&&(this.range.from.row!==s.row||this.range.from.col!==s.col))&&this.hide()}}},{key:"onMouseOver",value:function(i){var o=RR.get(this),s=this.hot.rootDocument;if(!(this.preventEditorAutoSwitch||this.editor.isFocused()||Wr(i.target,"wtBorder")||o.cellBelowCursor===i.target||!this.editor))if(o.cellBelowCursor=s.elementFromPoint(i.clientX,i.clientY),this.targetIsCellWithComment(i)){var a=this.hot._createCellRange(this.hot.getCoords(i.target));this.displaySwitch.show(a)}else tm(i.target,s)&&!this.targetIsCommentTextArea(i)&&this.displaySwitch.hide()}},{key:"onMouseUp",value:function(){this.preventEditorAutoSwitch=!1}},{key:"onAfterRenderer",value:function(i,o){o[nu]&&o[nu][ly]&&Vt(i,o.commentedCellClassName)}},{key:"onEditorBlur",value:function(){this.setComment()}},{key:"onEditorMouseDown",value:function(i){var o=RR.get(this);o.tempEditorDimensions={width:ii(i.target),height:Ni(i.target)}}},{key:"onEditorMouseUp",value:function(i){var o=RR.get(this),s=ii(i.target),a=Ni(i.target);(s!==o.tempEditorDimensions.width+1||a!==o.tempEditorDimensions.height+2)&&this.updateCommentMeta(this.range.from.row,this.range.from.col,kL({},zZ,{width:s,height:a}))}},{key:"onContextMenuAddComment",value:function(){var i=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,this.displaySwitch.cancelHiding(),this.setRange({from:i.highlight}),this.show(),this.hot.deselectCell(),this.editor.focus()}},{key:"onContextMenuRemoveComment",value:function(){var i=this,o=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,o.forAll(function(s,a){s>=0&&a>=0&&i.removeCommentAtCell(s,a,!1)}),this.hot.render()}},{key:"onContextMenuMakeReadOnly",value:function(){var i=this,o=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,o.forAll(function(s,a){if(s>=0&&a>=0){var h=!!i.getCommentMeta(s,a,kR);i.updateCommentMeta(s,a,kL({},kR,!h))}})}},{key:"addToContextMenu",value:function(i){var o=this,s=function(){return o.hot.rowIndexMapper.getRenderableIndexesLength()>0&&o.hot.columnIndexMapper.getRenderableIndexesLength()>0};i.items.push({name:"---------"},{key:"commentsAddEdit",name:function(){return o.checkSelectionCommentsConsistency()?o.hot.getTranslatedPhrase(x4):o.hot.getTranslatedPhrase(S4)},callback:function(){return o.onContextMenuAddComment()},disabled:function(){return s()?!(o.hot.getSelectedLast()&&!o.hot.selection.isSelectedByCorner()):!0}},{key:"commentsRemove",name:function(){return this.getTranslatedPhrase(C4)},callback:function(){return o.onContextMenuRemoveComment()},disabled:function(){return s()?!(o.hot.getSelectedLast()&&!o.hot.selection.isSelectedByCorner()):!0}},{key:"commentsReadOnly",name:function(){var h=this,p=this.getTranslatedPhrase(E4),y=hu(this.getSelectedRangeLast(),function(S,E){var O=h.getCellMeta(S,E)[nu];if(O&&(O=O[kR]),O)return!0});return y&&(p=ic(p)),p},callback:function(){return o.onContextMenuMakeReadOnly()},disabled:function(){return s()?!(o.hot.getSelectedLast()&&!o.hot.selection.isSelectedByCorner())||!o.checkSelectionCommentsConsistency():!0}})}},{key:"getDisplayDelaySetting",value:function(){var i=this.hot.getSettings()[PL];if(pn(i))return i.displayDelay}},{key:"destroy",value:function(){this.editor&&this.editor.destroy(),this.displaySwitch&&this.displaySwitch.destroy(),Rp(vc(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return PL}},{key:"PLUGIN_PRIORITY",get:function(){return fit}}]),r}(Yn);function xx(e){"@babel/helpers - typeof";return xx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xx(e)}function dit(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function HZ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,mit(n.key),n)}}function pit(e,t,r){return t&&HZ(e.prototype,t),r&&HZ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function mit(e){var t=git(e,"string");return xx(t)==="symbol"?t:String(t)}function git(e,t){if(xx(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(xx(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var yit=function(){function e(t){dit(this,e),this.hot=t,this.commands={},this.commonCallback=null}return pit(e,[{key:"registerCommand",value:function(r,n){this.commands[r]=n}},{key:"setCommonCallback",value:function(r){this.commonCallback=r}},{key:"execute",value:function(r){for(var n=this,i=arguments.length,o=new Array(i>1?i-1:0),s=1;s<i;s++)o[s-1]=arguments[s];var a=r.split(":"),h=a[0],p=a.length===2?a[1]:null,y=this.commands[h];if(!y)throw new Error("Menu command '".concat(h,"' not exists."));if(p&&y.submenu&&(y=vit(p,y.submenu.items)),y.disabled!==!0&&!(typeof y.disabled=="function"&&y.disabled.call(this.hot)===!0)&&!Gi(y,"submenu")){var S=[];typeof y.callback=="function"&&S.push(y.callback),typeof this.commonCallback=="function"&&S.push(this.commonCallback),o.unshift(a.join(":")),Fe(S,function(E){return E.apply(n.hot,o)})}}}]),e}();function vit(e,t){var r;return Fe(t,function(n){var i=n.key?n.key.split(":"):null;if(Array.isArray(i)&&i[1]===e)return r=n,!1}),r}const Xfe=yit;var Is="alignment";function _it(){return{key:Is,name:function(){return this.getTranslatedPhrase(T4)},disabled:function(){return this.countRows()===0||this.countCols()===0?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:"".concat(Is,":left"),name:function(){var t=this,r=this.getTranslatedPhrase(O4),n=hu(this.getSelectedRange(),function(i,o){var s=t.getCellMeta(i,o).className;if(s&&s.indexOf("htLeft")!==-1)return!0});return n&&(r=ic(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Jd(r,function(s,a){return t.getCellMeta(s,a).className}),i="horizontal",o="htLeft";this.runHooks("beforeCellAlignment",n,r,i,o),Zf(r,i,o,function(s,a){return t.getCellMeta(s,a)},function(s,a,h,p){return t.setCellMeta(s,a,h,p)}),this.render()},disabled:!1},{key:"".concat(Is,":center"),name:function(){var t=this,r=this.getTranslatedPhrase(R4),n=hu(this.getSelectedRange(),function(i,o){var s=t.getCellMeta(i,o).className;if(s&&s.indexOf("htCenter")!==-1)return!0});return n&&(r=ic(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Jd(r,function(s,a){return t.getCellMeta(s,a).className}),i="horizontal",o="htCenter";this.runHooks("beforeCellAlignment",n,r,i,o),Zf(r,i,o,function(s,a){return t.getCellMeta(s,a)},function(s,a,h,p){return t.setCellMeta(s,a,h,p)}),this.render()},disabled:!1},{key:"".concat(Is,":right"),name:function(){var t=this,r=this.getTranslatedPhrase(k4),n=hu(this.getSelectedRange(),function(i,o){var s=t.getCellMeta(i,o).className;if(s&&s.indexOf("htRight")!==-1)return!0});return n&&(r=ic(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Jd(r,function(s,a){return t.getCellMeta(s,a).className}),i="horizontal",o="htRight";this.runHooks("beforeCellAlignment",n,r,i,o),Zf(r,i,o,function(s,a){return t.getCellMeta(s,a)},function(s,a,h,p){return t.setCellMeta(s,a,h,p)}),this.render()},disabled:!1},{key:"".concat(Is,":justify"),name:function(){var t=this,r=this.getTranslatedPhrase(P4),n=hu(this.getSelectedRange(),function(i,o){var s=t.getCellMeta(i,o).className;if(s&&s.indexOf("htJustify")!==-1)return!0});return n&&(r=ic(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Jd(r,function(s,a){return t.getCellMeta(s,a).className}),i="horizontal",o="htJustify";this.runHooks("beforeCellAlignment",n,r,i,o),Zf(r,i,o,function(s,a){return t.getCellMeta(s,a)},function(s,a,h,p){return t.setCellMeta(s,a,h,p)}),this.render()},disabled:!1},{name:hn},{key:"".concat(Is,":top"),name:function(){var t=this,r=this.getTranslatedPhrase(A4),n=hu(this.getSelectedRange(),function(i,o){var s=t.getCellMeta(i,o).className;if(s&&s.indexOf("htTop")!==-1)return!0});return n&&(r=ic(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Jd(r,function(s,a){return t.getCellMeta(s,a).className}),i="vertical",o="htTop";this.runHooks("beforeCellAlignment",n,r,i,o),Zf(r,i,o,function(s,a){return t.getCellMeta(s,a)},function(s,a,h,p){return t.setCellMeta(s,a,h,p)}),this.render()},disabled:!1},{key:"".concat(Is,":middle"),name:function(){var t=this,r=this.getTranslatedPhrase(I4),n=hu(this.getSelectedRange(),function(i,o){var s=t.getCellMeta(i,o).className;if(s&&s.indexOf("htMiddle")!==-1)return!0});return n&&(r=ic(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Jd(r,function(s,a){return t.getCellMeta(s,a).className}),i="vertical",o="htMiddle";this.runHooks("beforeCellAlignment",n,r,i,o),Zf(r,i,o,function(s,a){return t.getCellMeta(s,a)},function(s,a,h,p){return t.setCellMeta(s,a,h,p)}),this.render()},disabled:!1},{key:"".concat(Is,":bottom"),name:function(){var t=this,r=this.getTranslatedPhrase(M4),n=hu(this.getSelectedRange(),function(i,o){var s=t.getCellMeta(i,o).className;if(s&&s.indexOf("htBottom")!==-1)return!0});return n&&(r=ic(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Jd(r,function(s,a){return t.getCellMeta(s,a).className}),i="vertical",o="htBottom";this.runHooks("beforeCellAlignment",n,r,i,o),Zf(r,i,o,function(s,a){return t.getCellMeta(s,a)},function(s,a,h,p){return t.setCellMeta(s,a,h,p)}),this.render()},disabled:!1}]}}}var vM="clear_column";function bit(){return{key:vM,name:function(){return this.getTranslatedPhrase(h4)},callback:function(t,r){var n=r[0].start.col,i=r[0].end.col;this.countRows()&&this.populateFromArray(0,n,[[null]],Math.max(r[0].start.row,r[0].end.row),i,"ContextMenu.clearColumn")},disabled:function(){var t=zm(this);return t?!this.selection.isSelectedByColumnHeader():!0}}}var kE="col_left";function wit(){return{key:kE,name:function(){return this.getTranslatedPhrase(o4)},callback:function(){var t=this.getSelectedRangeLast().getTopLeftCorner(),r=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(r,t.col,1,"ContextMenu.columnLeft")},disabled:function(){if(!this.isColumnModificationAllowed())return!0;var t=zm(this);if(!t)return!0;if(this.selection.isSelectedByCorner()){var r=this.countCols();return r===0}return this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden:function(){return!this.getSettings().allowInsertColumn}}}var PE="col_right";function Sit(){return{key:PE,name:function(){return this.getTranslatedPhrase(a4)},callback:function(){var t=this.getSelectedRangeLast().getTopRightCorner(),r=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(r,t.col,1,"ContextMenu.columnRight")},disabled:function(){if(!this.isColumnModificationAllowed())return!0;var t=zm(this);return t?this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols:!0},hidden:function(){return!this.getSettings().allowInsertColumn}}}var AE="make_read_only";function xit(){return{key:AE,name:function(){var t=this,r=this.getTranslatedPhrase(f4),n=hu(this.getSelectedRange(),function(i,o){return t.getCellMeta(i,o).readOnly});return n&&(r=ic(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=hu(r,function(i,o){return t.getCellMeta(i,o).readOnly});Fe(r,function(i){i.forAll(function(o,s){o>=0&&s>=0&&t.setCellMeta(o,s,"readOnly",!n)})}),this.render()},disabled:function(){return!!(this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}var _M="redo";function Cit(){return{key:_M,name:function(){return this.getTranslatedPhrase(c4)},callback:function(){this.redo()},hidden:function(){var t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled:function(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}function Zfe(e,t){return Rit(e)||Oit(e,t)||Tit(e,t)||Eit()}function Eit(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Tit(e,t){if(e){if(typeof e=="string")return VZ(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return VZ(e,t)}}function VZ(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Oit(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],h=!0,p=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;h=!1}else for(;!(h=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);h=!0);}catch(y){p=!0,i=y}finally{try{if(!h&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(p)throw i}}return a}}function Rit(e){if(Array.isArray(e))return e}function KF(e){"@babel/helpers - typeof";return KF=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},KF(e)}var bM=0,wM=1,Jfe=2,wW=3,kit=[wW,Jfe],Pit=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],AL=Symbol("root"),UZ=Symbol("child");function L_(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:AL;if(t!==AL&&t!==UZ)throw new Error("The second argument is used internally only and cannot be overwritten.");var r=Array.isArray(e),n=t===AL,i=bM;if(r){var o=e[0];if(e.length===0)i=wM;else if(n&&o instanceof BU)i=wW;else if(n&&Array.isArray(o))i=L_(o,UZ);else if(e.length>=2&&e.length<=4){var s=!e.some(function(a,h){return!Pit[h].includes(KF(a))});s&&(i=Jfe)}}return i}function Cx(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=t.keepDirection,n=r===void 0?!1:r,i=t.propToCol;if(!kit.includes(e))throw new Error("Unsupported selection ranges schema type was provided.");return function(o){var s=e===wW,a=s?o.from.row:o[0],h=s?o.from.col:o[1],p=s?o.to.row:o[2],y=s?o.to.col:o[3];if(typeof i=="function"&&(typeof h=="string"&&(h=i(h)),typeof y=="string"&&(y=i(y))),ui(p)&&(p=a),ui(y)&&(y=h),!n){var S=a,E=h,O=p,A=y;a=Math.min(S,O),h=Math.min(E,A),p=Math.max(S,O),y=Math.max(E,A)}return[a,h,p,y]}}function Ait(e){var t=L_(e);if(t===bM||t===wM)return[];var r=Cx(t),n=new Set;Fe(e,function(s){var a=r(s),h=Zfe(a,4),p=h[1],y=h[3],S=Math.max(p,0),E=y-S+1;Fe(Array.from(new Array(E),function(O,A){return S+A}),function(O){n.has(O)||n.add(O)})});var i=Array.from(n).sort(function(s,a){return s-a}),o=oa(i,function(s,a,h,p){return h!==0&&a===p[h-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s},[]);return o}function Iit(e){var t=L_(e);if(t===bM||t===wM)return[];var r=Cx(t),n=new Set;Fe(e,function(s){var a=r(s),h=Zfe(a,3),p=h[0],y=h[2],S=Math.max(p,0),E=y-S+1;Fe(Array.from(new Array(E),function(O,A){return S+A}),function(O){n.has(O)||n.add(O)})});var i=Array.from(n).sort(function(s,a){return s-a}),o=oa(i,function(s,a,h,p){return h!==0&&a===p[h-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s},[]);return o}function Vf(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;return typeof e=="number"&&e>=0&&e<t}function Mit(e,t){return Nit(e)||Lit(e,t)||Dit(e,t)||$it()}function $it(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Dit(e,t){if(e){if(typeof e=="string")return WZ(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return WZ(e,t)}}function WZ(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Lit(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],h=!0,p=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;h=!1}else for(;!(h=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);h=!0);}catch(y){p=!0,i=y}finally{try{if(!h&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(p)throw i}}return a}}function Nit(e){if(Array.isArray(e))return e}var IE="remove_col";function Bit(){return{key:IE,name:function(){var t=this.getSelected(),r=0;if(t)if(t.length>1)r=1;else{var n=Mit(t[0],4),i=n[1],o=n[3];i-o!==0&&(r=1)}return this.getTranslatedPhrase(l4,r)},callback:function(){this.alter("remove_col",Ait(this.getSelected()),null,"ContextMenu.removeColumn")},disabled:function(){if(!this.isColumnModificationAllowed())return!0;var t=zm(this);if(!t)return!0;var r=this.countCols();return this.selection.isSelectedByCorner()?r===0:this.selection.isSelectedByRowHeader()||r===0},hidden:function(){return!this.getSettings().allowRemoveColumn}}}function jit(e,t){return Vit(e)||Hit(e,t)||zit(e,t)||Fit()}function Fit(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zit(e,t){if(e){if(typeof e=="string")return GZ(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return GZ(e,t)}}function GZ(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Hit(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],h=!0,p=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;h=!1}else for(;!(h=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);h=!0);}catch(y){p=!0,i=y}finally{try{if(!h&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(p)throw i}}return a}}function Vit(e){if(Array.isArray(e))return e}var SM="remove_row";function Uit(){return{key:SM,name:function(){var t=this.getSelected(),r=0;if(t)if(t.length>1)r=1;else{var n=jit(t[0],3),i=n[0],o=n[2];i-o!==0&&(r=1)}return this.getTranslatedPhrase(s4,r)},callback:function(){this.alter("remove_row",Iit(this.getSelected()),1,"ContextMenu.removeRow")},disabled:function(){var t=zm(this);if(!t)return!0;var r=this.countRows();return this.selection.isSelectedByCorner()?r===0:this.selection.isSelectedByColumnHeader()||r===0},hidden:function(){return!this.getSettings().allowRemoveRow}}}var xM="row_above";function Wit(){return{key:xM,name:function(){return this.getTranslatedPhrase(n4)},callback:function(){var t=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",t.row,1,"ContextMenu.rowAbove")},disabled:function(){var t=zm(this);if(!t)return!0;if(this.selection.isSelectedByCorner()){var r=this.countRows();return r===0}return this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden:function(){return!this.getSettings().allowInsertRow}}}var CM="row_below";function Git(){return{key:CM,name:function(){return this.getTranslatedPhrase(i4)},callback:function(){var t=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",t.row,1,"ContextMenu.rowBelow")},disabled:function(){var t=zm(this);return t?this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows:!0},hidden:function(){return!this.getSettings().allowInsertRow}}}var Ex="no_items";function Yit(){return{key:Ex,name:function(){return this.getTranslatedPhrase(r4)},disabled:!0,isCommand:!1}}var EM="undo";function Kit(){return{key:EM,name:function(){return this.getTranslatedPhrase(u4)},callback:function(){this.undo()},hidden:function(){var t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled:function(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}function Tx(e){"@babel/helpers - typeof";return Tx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Tx(e)}var ca;function Ja(e,t,r){return t=qit(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function qit(e){var t=Xit(e,"string");return Tx(t)==="symbol"?t:String(t)}function Xit(e,t){if(Tx(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Tx(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Zit=[xM,CM,kE,PE,vM,SM,IE,EM,_M,AE,Is,hn,Ex],Jit=(ca={},Ja(ca,hn,Bnt),Ja(ca,Ex,Yit),Ja(ca,xM,Wit),Ja(ca,CM,Git),Ja(ca,kE,wit),Ja(ca,PE,Sit),Ja(ca,vM,bit),Ja(ca,SM,Uit),Ja(ca,IE,Bit),Ja(ca,EM,Kit),Ja(ca,_M,Cit),Ja(ca,AE,xit),Ja(ca,Is,_it),ca);function Qfe(){var e={};return mn(Jit,function(t,r){e[r]=t()}),e}function Ox(e){"@babel/helpers - typeof";return Ox=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ox(e)}function Qit(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function YZ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,tot(n.key),n)}}function eot(e,t,r){return t&&YZ(e.prototype,t),r&&YZ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function tot(e){var t=rot(e,"string");return Ox(t)==="symbol"?t:String(t)}function rot(e,t){if(Ox(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ox(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var not=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;Qit(this,e),this.hot=t,this.predefinedItems=Qfe(),this.defaultOrderPattern=r}return eot(e,[{key:"setPredefinedItems",value:function(r){var n=this,i={};this.defaultOrderPattern.length=0,mn(r,function(o,s){var a="";o.name===hn?(i[hn]=o,a=hn):isNaN(parseInt(s,10))?(o.key=o.key===void 0?s:o.key,i[s]=o,a=o.key):(i[o.key]=o,a=o.key),n.defaultOrderPattern.push(a)}),this.predefinedItems=i}},{key:"getItems",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return iot(r,this.defaultOrderPattern,this.predefinedItems)}}]),e}();function iot(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=[],i=e;return i&&i.items?i=i.items:Array.isArray(i)||(i=t),pn(i)?mn(i,function(o,s){var a=r[typeof o=="string"?o:s];a||(a=o),pn(o)?lo(a,o):typeof a=="string"&&(a={name:a}),a.key===void 0&&(a.key=s),n.push(a)}):Fe(i,function(o,s){var a=r[o];!a&&Zit.indexOf(o)>=0||(a||(a={name:o,key:"".concat(s)}),pn(o)&&lo(a,o),a.key===void 0&&(a.key=s),n.push(a))}),n}const ehe=not;function Rx(e){"@babel/helpers - typeof";return Rx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rx(e)}function oot(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function KZ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,sot(n.key),n)}}function aot(e,t,r){return t&&KZ(e.prototype,t),r&&KZ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function sot(e){var t=lot(e,"string");return Rx(t)==="symbol"?t:String(t)}function lot(e,t){if(Rx(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Rx(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var uot=function(){function e(t,r){oot(this,e);var n=M1(r),i=Lv(r),o,s,a,h,p,y;this.rootWindow=r,this.type=this.getSourceType(t),this.type==="literal"?(o=parseInt(t.top,10),a=parseInt(t.left,10),p=t.height||0,y=t.width||0,s=o,h=a,o+=n,a+=i):this.type==="event"&&(o=parseInt(t.pageY,10),a=parseInt(t.pageX,10),p=t.target.clientHeight,y=t.target.clientWidth,s=o-n,h=a-i),this.top=o,this.topRelative=s,this.left=a,this.leftRelative=h,this.scrollTop=n,this.scrollLeft=i,this.cellHeight=p,this.cellWidth=y}return aot(e,[{key:"getSourceType",value:function(r){var n="literal";return r instanceof Event&&(n="event"),n}},{key:"fitsAbove",value:function(r){return this.topRelative>=r.offsetHeight}},{key:"fitsBelow",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+r.offsetHeight<=n}},{key:"fitsOnRight",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+r.offsetWidth<=n}},{key:"fitsOnLeft",value:function(r){return this.leftRelative>=r.offsetWidth}}]),e}();const cot=uot;var fot=Pm,hot=/(?:ipad|iphone|ipod).*applewebkit/i.test(fot),dot=Tu,the=typeof process<"u"&&dot(process)=="process",us=oi,pot=Nm,mot=lE,qZ=bi,got=ji,rhe=on,XZ=Aae,yot=dE,ZZ=RI,vot=Zue,_ot=hot,bot=the,qF=us.setImmediate,XF=us.clearImmediate,wot=us.process,IL=us.Dispatch,Sot=us.Function,JZ=us.MessageChannel,xot=us.String,ML=0,JS={},QZ="onreadystatechange",kx,Qd,$L,DL;rhe(function(){kx=us.location});var SW=function(e){if(got(JS,e)){var t=JS[e];delete JS[e],t()}},LL=function(e){return function(){SW(e)}},eJ=function(e){SW(e.data)},tJ=function(e){us.postMessage(xot(e),kx.protocol+"//"+kx.host)};(!qF||!XF)&&(qF=function(t){vot(arguments.length,1);var r=qZ(t)?t:Sot(t),n=yot(arguments,1);return JS[++ML]=function(){pot(r,void 0,n)},Qd(ML),ML},XF=function(t){delete JS[t]},bot?Qd=function(e){wot.nextTick(LL(e))}:IL&&IL.now?Qd=function(e){IL.now(LL(e))}:JZ&&!_ot?($L=new JZ,DL=$L.port2,$L.port1.onmessage=eJ,Qd=mot(DL.postMessage,DL)):us.addEventListener&&qZ(us.postMessage)&&!us.importScripts&&kx&&kx.protocol!=="file:"&&!rhe(tJ)?(Qd=tJ,us.addEventListener("message",eJ,!1)):QZ in ZZ("script")?Qd=function(e){XZ.appendChild(ZZ("script"))[QZ]=function(){XZ.removeChild(this),SW(e)}}:Qd=function(e){setTimeout(LL(e),0)});var nhe={set:qF,clear:XF},Cot=jr,Eot=oi,rJ=nhe.clear;Cot({global:!0,bind:!0,enumerable:!0,forced:Eot.clearImmediate!==rJ},{clearImmediate:rJ});var Tot=jr,ihe=oi,nJ=nhe.set,Oot=SU,iJ=ihe.setImmediate?Oot(nJ,!1):nJ;Tot({global:!0,bind:!0,enumerable:!0,forced:ihe.setImmediate!==iJ},{setImmediate:iJ});var Rot=uo,kot=jI,Pot=Yi,Aot=Il,Iot=Mm,NL=to,Mot=Wa,$ot=Im,Dot=AV,oJ=FI;kot("match",function(e,t,r){return[function(i){var o=Mot(this),s=Aot(i)?void 0:$ot(i,e);return s?Rot(s,i,o):new RegExp(i)[e](NL(o))},function(n){var i=Pot(this),o=NL(n),s=r(t,i,o);if(s.done)return s.value;if(!i.global)return oJ(i,o);var a=i.unicode;i.lastIndex=0;for(var h=[],p=0,y;(y=oJ(i,o))!==null;){var S=NL(y[0]);h[p]=S,S===""&&(i.lastIndex=Dot(o,Iot(i.lastIndex),a)),p++}return p===0?null:h}]});var Lot=Nm,Not=ys,Bot=qh,jot=Ys,Fot=tw,zot=Math.min,ZF=[].lastIndexOf,ohe=!!ZF&&1/[1].lastIndexOf(1,-0)<0,Hot=Fot("lastIndexOf"),Vot=ohe||!Hot,Uot=Vot?function(t){if(ohe)return Lot(ZF,this,arguments)||0;var r=Not(this),n=jot(r),i=n-1;for(arguments.length>1&&(i=zot(i,Bot(arguments[1]))),i<0&&(i=n+i);i>=0;i--)if(i in r&&r[i]===t)return i||0;return-1}:ZF,Wot=jr,aJ=Uot;Wot({target:"Array",proto:!0,forced:aJ!==[].lastIndexOf},{lastIndexOf:aJ});var Got=Am,Yot=Ga,Kot=YC,qot=Ys,Xot=TypeError,sJ=function(e){return function(t,r,n,i){Got(r);var o=Yot(t),s=Kot(o),a=qot(o),h=e?a-1:0,p=e?-1:1;if(n<2)for(;;){if(h in s){i=s[h],h+=p;break}if(h+=p,e?h<0:a<=h)throw Xot("Reduce of empty array with no initial value")}for(;e?h>=0:a>h;h+=p)h in s&&(i=r(i,s[h],h,o));return i}},Zot={left:sJ(!1),right:sJ(!0)},Jot=jr,Qot=Zot.left,eat=tw,lJ=KC,tat=the,rat=!tat&&lJ>79&&lJ<83,nat=rat||!eat("reduce");Jot({target:"Array",proto:!0,forced:nat},{reduce:function(t){var r=arguments.length;return Qot(this,t,r,r>1?arguments[1]:void 0)}});function BL(e){return sat(e)||aat(e)||oat(e)||iat()}function iat(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function oat(e,t){if(e){if(typeof e=="string")return JF(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return JF(e,t)}}function aat(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function sat(e){if(Array.isArray(e))return JF(e)}function JF(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var ahe={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},lat=new RegExp(Object.keys(ahe).map(function(e){return"(".concat(e,")")}).join("|"),"gi");function uat(e){return(e&&e.nodeName||"")==="TABLE"}function uJ(e){for(var t=e.hasColHeaders(),r=e.hasRowHeaders(),n=[t?-1:0,r?-1:0,e.countRows()-1,e.countCols()-1],i=e.getData.apply(e,n),o=i.length,s=o>0?i[0].length:0,a=["<table>","</table>"],h=t?["<thead>","</thead>"]:[],p=["<tbody>","</tbody>"],y=r?1:0,S=t?1:0,E=0;E<o;E+=1){for(var O=t&&E===0,A=[],$=0;$<s;$+=1){var B=!O&&r&&$===0,j="";if(O)j="<th>".concat(e.getColHeader($-y),"</th>");else if(B)j="<th>".concat(e.getRowHeader(E-S),"</th>");else{var z=i[E][$],W=e.getCellMeta(E-S,$-y),Q=W.hidden,q=W.rowspan,Se=W.colspan;if(!Q){var Ie=[];if(q&&Ie.push('rowspan="'.concat(q,'"')),Se&&Ie.push('colspan="'.concat(Se,'"')),_o(z))j="<td ".concat(Ie.join(" "),"></td>");else{var He=z.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");j="<td ".concat(Ie.join(" "),">").concat(He,"</td>")}}}A.push(j)}var Le=["<tr>"].concat(A,["</tr>"]).join("");O?h.splice(1,0,Le):p.splice(-1,0,Le)}return a.splice(1,0,h.join(""),p.join("")),a.join("")}function cJ(e){for(var t=e.length,r=["<table>"],n=0;n<t;n+=1){var i=e[n],o=i.length,s=[];n===0&&r.push("<tbody>");for(var a=0;a<o;a+=1){var h=i[a],p=_o(h)?"":h.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");s.push("<td>".concat(p,"</td>"))}r.push.apply(r,["<tr>"].concat(s,["</tr>"])),n+1===t&&r.push("</tbody>")}return r.push("</table>"),r.join("")}function cat(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document,r={},n=t.createDocumentFragment(),i=t.createElement("div");n.appendChild(i);var o=e;if(typeof o=="string"){var s=o.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,function(re){var me=re.match(/<td\b[^>]*?>/g)[0],Oe=re.substring(me.length,re.lastIndexOf("<")).replace(/(<(?!br)([^>]+)>)/gi,""),We="</td>";return"".concat(me).concat(Oe).concat(We)});i.insertAdjacentHTML("afterbegin","".concat(s)),o=i.querySelector("table")}if(!(!o||!uat(o))){var a=i.querySelector('meta[name$="enerator"]'),h=o.querySelector("tbody th")!==null,p=o.querySelector("tr"),y=p?Array.from(p.cells).reduce(function(re,me){return re+me.colSpan},0)-(h?1:0):0,S=o.tFoot&&Array.from(o.tFoot.rows)||[],E=[],O=!1,A=0,$=0;if(o.tHead){var B=Array.from(o.tHead.rows).filter(function(re){var me=re.querySelector("td")!==null;return me&&E.push(re),!me});A=B.length,O=A>0,A>1?r.nestedHeaders=Array.from(B).reduce(function(re,me){var Oe=Array.from(me.cells).reduce(function(We,Je,ht){if(h&&ht===0)return We;var ft=Je.colSpan,St=Je.innerHTML,Tt=ft>1?{label:St,colspan:ft}:St;return We.push(Tt),We},[]);return re.push(Oe),re},[]):O&&(r.colHeaders=Array.from(B[0].children).reduce(function(re,me,Oe){return h&&Oe===0||re.push(me.innerHTML),re},[]))}E.length&&(r.fixedRowsTop=E.length),S.length&&(r.fixedRowsBottom=S.length);var j=[].concat(E,BL(Array.from(o.tBodies).reduce(function(re,me){return re.push.apply(re,BL(Array.from(me.rows))),re},[])),BL(S));$=j.length;for(var z=new Array($),W=0;W<$;W++)z[W]=new Array(y);for(var Q=[],q=[],Se=0;Se<$;Se++)for(var Ie=j[Se],He=Array.from(Ie.cells),Le=He.length,ze=0;ze<Le;ze++){var ct=He[ze],At=ct.nodeName,Qe=ct.innerHTML,de=ct.rowSpan,Ce=ct.colSpan,pt=z[Se].findIndex(function(re){return re===void 0});if(At==="TD"){if(de>1||Ce>1){for(var Ct=Se;Ct<Se+de;Ct++)if(Ct<$)for(var ie=pt;ie<pt+Ce;ie++)z[Ct][ie]=null;var M=ct.getAttribute("style"),U=M&&M.includes("mso-ignore:colspan");U||Q.push({col:pt,row:Se,rowspan:de,colspan:Ce})}var K="";a&&/excel/gi.test(a.content)?K=Qe.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):K=Qe.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),z[Se][pt]=K.replace(lat,function(re){return ahe[re]})}else q.push(Qe)}return Q.length&&(r.mergeCells=Q),q.length&&(r.rowHeaders=q),z.length&&(r.data=z),r}}function fJ(e){var t=e.isShiftKey,r=e.isLeftClick,n=e.isRightClick,i=e.coords,o=e.selection,s=e.controller,a=e.cellCoordsFactory,h=o.isSelected()?o.getSelectedRange().current():null,p=o.isSelectedByCorner(),y=o.isSelectedByRowHeader();if(t&&h)i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(i):(p||y)&&i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(a(i.row,i.col)):p&&i.row<0&&!s.column?o.setRangeEnd(a(h.to.row,i.col)):y&&i.col<0&&!s.row?o.setRangeEnd(a(i.row,h.to.col)):(!p&&!y&&i.col<0||p&&i.col<0)&&!s.row?o.selectRows(Math.max(h.from.row,0),i.row,i.col):(!p&&!y&&i.row<0||y&&i.row<0)&&!s.column&&o.selectColumns(Math.max(h.from.col,0),i.col,i.row);else{var S=!o.inInSelection(i),E=r||n&&S;i.row<0&&i.col>=0&&!s.column?E&&o.selectColumns(i.col,i.col,i.row):i.col<0&&i.row>=0&&!s.row?E&&o.selectRows(i.row,i.row,i.col):i.col>=0&&i.row>=0&&!s.cell?E&&o.setRangeStart(i):i.col<0&&i.row<0&&o.selectAll(!0,!0)}}function fat(e){var t=e.isLeftClick,r=e.coords,n=e.selection,i=e.controller,o=e.cellCoordsFactory;if(t){var s=n.isSelectedByRowHeader(),a=n.isSelectedByColumnHeader(),h=n.tableProps.countCols(),p=n.tableProps.countRows();a&&!i.column?n.setRangeEnd(o(p-1,r.col)):s&&!i.row?n.setRangeEnd(o(r.row,h-1)):i.cell||n.setRangeEnd(r)}}var hat=new Map([["mousedown",fJ],["mouseover",fat],["touchstart",fJ]]);function hJ(e,t){var r=t.coords,n=t.selection,i=t.controller,o=t.cellCoordsFactory;hat.get(e.type)({coords:r,selection:n,controller:i,cellCoordsFactory:o,isShiftKey:e.shiftKey,isLeftClick:mU(e)||e.type==="touchstart",isRightClick:cm(e)})}var she=new WeakMap,xW=Symbol("rootInstance");function dat(e){she.set(e,!0)}function pat(e){return e===xW}function QF(e){return she.has(e)}function Px(e){"@babel/helpers - typeof";return Px=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Px(e)}function iS(e,t){return yat(e)||gat(e,t)||lhe(e,t)||mat()}function mat(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function gat(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],h=!0,p=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;h=!1}else for(;!(h=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);h=!0);}catch(y){p=!0,i=y}finally{try{if(!h&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(p)throw i}}return a}}function yat(e){if(Array.isArray(e))return e}function dJ(e){return bat(e)||_at(e)||lhe(e)||vat()}function vat(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function lhe(e,t){if(e){if(typeof e=="string")return ez(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ez(e,t)}}function _at(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function bat(e){if(Array.isArray(e))return ez(e)}function ez(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function wat(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pJ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,uhe(n.key),n)}}function Sat(e,t,r){return t&&pJ(e.prototype,t),r&&pJ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function mJ(e,t,r){xat(e,t),t.set(e,r)}function xat(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Uf(e,t,r){return t=uhe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function uhe(e){var t=Cat(e,"string");return Px(t)==="symbol"?t:String(t)}function Cat(e,t){if(Px(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Px(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function gJ(e,t){var r=che(e,t,"get");return Eat(e,r)}function Eat(e,t){return t.get?t.get.call(e):t.value}function yJ(e,t,r){var n=che(e,t,"set");return Tat(e,n,r),r}function che(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function Tat(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var ep=new WeakMap,jL=new WeakMap,FL=new WeakMap,Oat=function(){function e(t){wat(this,e),Uf(this,"instance",void 0),Uf(this,"eventManager",void 0),Uf(this,"settings",void 0),Uf(this,"THEAD",void 0),Uf(this,"TBODY",void 0),Uf(this,"_wt",void 0),Uf(this,"activeWt",void 0),mJ(this,jL,{writable:!0,value:0}),mJ(this,FL,{writable:!0,value:0}),Uf(this,"postponedAdjustElementsSize",!1),this.instance=t,this.eventManager=new Fi(this.instance),this.settings=this.instance.getSettings(),ep.set(this,{selectionMouseDown:!1,mouseDown:void 0,table:void 0,lastWidth:0,lastHeight:0}),this.createElements(),this.registerEvents(),this.initializeWalkontable()}return Sat(e,[{key:"render",value:function(){this.instance.isRenderSuspended()||(this.instance.runHooks("beforeRender",this.instance.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this._wt.draw(!this.instance.forceFullRender),this.instance.runHooks("afterRender",this.instance.forceFullRender),this.instance.forceFullRender=!1,this.instance.renderCall=!1)}},{key:"adjustElementsSize",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.instance.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize(r)}},{key:"getCellAtCoords",value:function(r,n){var i=this._wt.getCell(r,n);return i<0?null:i}},{key:"scrollViewport",value:function(r,n,i,o,s){return this._wt.scrollViewport(r,n,i,o,s)}},{key:"scrollViewportHorizontally",value:function(r,n,i){return this._wt.scrollViewportHorizontally(r,n,i)}},{key:"scrollViewportVertically",value:function(r,n,i){return this._wt.scrollViewportVertically(r,n,i)}},{key:"createElements",value:function(){var r=ep.get(this),n=this.instance,i=n.rootElement,o=n.rootDocument,s=i.getAttribute("style");s&&i.setAttribute("data-originalstyle",s),Vt(i,"handsontable"),r.table=o.createElement("TABLE"),Vt(r.table,"htCore"),this.instance.getSettings().tableClassName&&Vt(r.table,this.instance.getSettings().tableClassName),this.THEAD=o.createElement("THEAD"),r.table.appendChild(this.THEAD),this.TBODY=o.createElement("TBODY"),r.table.appendChild(this.TBODY),this.instance.table=r.table,this.instance.container.insertBefore(r.table,this.instance.container.firstChild)}},{key:"registerEvents",value:function(){var r=this,n=ep.get(this),i=this.instance,o=i.rootElement,s=i.rootDocument,a=i.selection,h=s.documentElement;this.eventManager.addEventListener(o,"mousedown",function(p){if(n.selectionMouseDown=!0,!r.isTextSelectionAllowed(p.target)){var y=r.instance.rootWindow;j9(y),p.preventDefault(),y.focus()}}),this.eventManager.addEventListener(o,"mouseup",function(){n.selectionMouseDown=!1}),this.eventManager.addEventListener(o,"mousemove",function(p){n.selectionMouseDown&&!r.isTextSelectionAllowed(p.target)&&(r.settings.fragmentSelection&&j9(r.instance.rootWindow),p.preventDefault())}),this.eventManager.addEventListener(h,"keyup",function(p){a.isInProgress()&&!p.shiftKey&&a.finish()}),this.eventManager.addEventListener(h,"mouseup",function(p){a.isInProgress()&&mU(p)&&a.finish(),n.mouseDown=!1,(bU(s.activeElement)||!a.isSelected()&&!a.isSelectedByAnyHeader()&&!o.contains(p.target)&&!cm(p))&&r.instance.unlisten()}),this.eventManager.addEventListener(h,"contextmenu",function(p){a.isInProgress()&&cm(p)&&(a.finish(),n.mouseDown=!1)}),this.eventManager.addEventListener(h,"touchend",function(){a.isInProgress()&&a.finish(),n.mouseDown=!1}),this.eventManager.addEventListener(h,"mousedown",function(p){var y=p.target,S=p.x||p.clientX,E=p.y||p.clientY,O=p.target;if(!(n.mouseDown||!o||!r.instance.view)){var A=r.instance.view._wt.wtTable.holder;if(O===A){var $=Mo(s);if(s.elementFromPoint(S+$,E)!==A||s.elementFromPoint(S,E+$)!==A)return}else for(;O!==h;){if(O===null){if(p.isTargetWebComponent)break;return}if(O===o)return;O=O.parentNode}var B=typeof r.settings.outsideClickDeselects=="function"?r.settings.outsideClickDeselects(y):r.settings.outsideClickDeselects;B?r.instance.deselectCell():r.instance.destroyEditor(!1,!1)}}),this.eventManager.addEventListener(n.table,"selectstart",function(p){r.settings.fragmentSelection||XP(p.target)||p.preventDefault()})}},{key:"translateFromRenderableToVisualCoords",value:function(r){var n,i=r.row,o=r.col;return(n=this.instance)._createCellCoords.apply(n,dJ(this.translateFromRenderableToVisualIndex(i,o)))}},{key:"translateFromRenderableToVisualIndex",value:function(r,n){var i=r>=0?this.instance.rowIndexMapper.getVisualFromRenderableIndex(r):r,o=n>=0?this.instance.columnIndexMapper.getVisualFromRenderableIndex(n):n;return i===null&&(i=r),o===null&&(o=n),[i,o]}},{key:"countRenderableIndexes",value:function(r,n){var i=Math.min(r.getNotTrimmedIndexesLength(),n),o=r.getNearestNotHiddenIndex(i-1,-1);return o===null?0:r.getRenderableFromVisualIndex(o)+1}},{key:"countRenderableColumns",value:function(){return this.countRenderableIndexes(this.instance.columnIndexMapper,this.settings.maxCols)}},{key:"countRenderableRows",value:function(){return this.countRenderableIndexes(this.instance.rowIndexMapper,this.settings.maxRows)}},{key:"countNotHiddenRowIndexes",value:function(r,n){return this.countNotHiddenIndexes(r,n,this.instance.rowIndexMapper,this.countRenderableRows())}},{key:"countNotHiddenColumnIndexes",value:function(r,n){return this.countNotHiddenIndexes(r,n,this.instance.columnIndexMapper,this.countRenderableColumns())}},{key:"countNotHiddenIndexes",value:function(r,n,i,o){if(isNaN(r)||r<0)return 0;var s=i.getNearestNotHiddenIndex(r,n),a=i.getRenderableFromVisualIndex(s);if(!Number.isInteger(a))return 0;var h=0;return n<0?h=a+1:n>0&&(h=o-a),h}},{key:"countNotHiddenFixedColumnsStart",value:function(){var r=this.instance.countCols(),n=Math.min(parseInt(this.settings.fixedColumnsStart,10),r)-1;return this.countNotHiddenColumnIndexes(n,-1)}},{key:"countNotHiddenFixedRowsTop",value:function(){var r=this.instance.countRows(),n=Math.min(parseInt(this.settings.fixedRowsTop,10),r)-1;return this.countNotHiddenRowIndexes(n,-1)}},{key:"countNotHiddenFixedRowsBottom",value:function(){var r=this.instance.countRows(),n=Math.max(r-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(n,1)}},{key:"isMainTableNotFullyCoveredByOverlays",value:function(){var r=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),n=this.countNotHiddenFixedColumnsStart();return this.instance.countRenderedRows()>r&&this.instance.countRenderedCols()>n}},{key:"initializeWalkontable",value:function(){var r=this,n=ep.get(this),i={rtlMode:this.instance.isRtl(),externalRowCalculator:this.instance.getPlugin("autoRowSize")&&this.instance.getPlugin("autoRowSize").isEnabled(),table:n.table,isDataViewInstance:function(){return QF(r.instance)},preventOverflow:function(){return r.settings.preventOverflow},preventWheel:function(){return r.settings.preventWheel},stretchH:function(){return r.settings.stretchH},data:function(y,S){var E;return(E=r.instance).getDataAtCell.apply(E,dJ(r.translateFromRenderableToVisualIndex(y,S)))},totalRows:function(){return r.countRenderableRows()},totalColumns:function(){return r.countRenderableColumns()},fixedColumnsStart:function(){return r.countNotHiddenFixedColumnsStart()},fixedRowsTop:function(){return r.countNotHiddenFixedRowsTop()},fixedRowsBottom:function(){return r.countNotHiddenFixedRowsBottom()},shouldRenderInlineStartOverlay:function(){return r.settings.fixedColumnsStart>0||i.rowHeaders().length>0},shouldRenderTopOverlay:function(){return r.settings.fixedRowsTop>0||i.columnHeaders().length>0},shouldRenderBottomOverlay:function(){return r.settings.fixedRowsBottom>0},minSpareRows:function(){return r.settings.minSpareRows},renderAllRows:this.settings.renderAllRows,rowHeaders:function(){var y=[];return r.instance.hasRowHeaders()&&y.push(function(S,E){var O=S>=0?r.instance.rowIndexMapper.getVisualFromRenderableIndex(S):S;r.appendRowHeader(O,E)}),r.instance.runHooks("afterGetRowHeaderRenderers",y),yJ(r,FL,y.length),y},columnHeaders:function(){var y=[];return r.instance.hasColHeaders()&&y.push(function(S,E){var O=S>=0?r.instance.columnIndexMapper.getVisualFromRenderableIndex(S):S;r.appendColHeader(O,E)}),r.instance.runHooks("afterGetColumnHeaderRenderers",y),yJ(r,jL,y.length),y},columnWidth:function(y){var S=r.instance.columnIndexMapper.getVisualFromRenderableIndex(y);return r.instance.getColWidth(S===null?y:S)},rowHeight:function(y){var S=r.instance.rowIndexMapper.getVisualFromRenderableIndex(y);return r.instance.getRowHeight(S===null?y:S)},cellRenderer:function(y,S,E){var O=r.translateFromRenderableToVisualIndex(y,S),A=iS(O,2),$=A[0],B=A[1],j=r.instance.runHooks("modifyGetCellCoords",$,B),z=$,W=B;if(Array.isArray(j)){var Q=iS(j,2);z=Q[0],W=Q[1]}var q=r.instance.getCellMeta(z,W),Se=r.instance.colToProp(W),Ie=r.instance.getDataAtRowProp(z,Se);r.instance.hasHook("beforeValueRender")&&(Ie=r.instance.runHooks("beforeValueRender",Ie,q)),r.instance.runHooks("beforeRenderer",E,$,B,Se,Ie,q),r.instance.getCellRenderer(q)(r.instance,E,$,B,Se,Ie,q),r.instance.runHooks("afterRenderer",E,$,B,Se,Ie,q)},selections:this.instance.selection.highlight,hideBorderOnMouseDownOver:function(){return r.settings.fragmentSelection},onWindowResize:function(){r.instance&&!r.instance.isDestroyed&&r.instance.refreshDimensions()},onContainerElementResize:function(){r.instance&&!r.instance.isDestroyed&&r.instance.refreshDimensions()},onCellMouseDown:function(y,S,E,O){var A=r.translateFromRenderableToVisualCoords(S),$={row:!1,column:!1,cell:!1};r.instance.listen(),r.activeWt=O,n.mouseDown=!0,r.instance.runHooks("beforeOnCellMouseDown",y,A,E,$),!Ay(y)&&(hJ(y,{coords:A,selection:r.instance.selection,controller:$,cellCoordsFactory:function(j,z){return r.instance._createCellCoords(j,z)}}),r.instance.runHooks("afterOnCellMouseDown",y,A,E),r.activeWt=r._wt)},onCellContextMenu:function(y,S,E,O){var A=r.translateFromRenderableToVisualCoords(S);r.activeWt=O,n.mouseDown=!1,r.instance.selection.isInProgress()&&r.instance.selection.finish(),r.instance.runHooks("beforeOnCellContextMenu",y,A,E),!Ay(y)&&(r.instance.runHooks("afterOnCellContextMenu",y,A,E),r.activeWt=r._wt)},onCellMouseOut:function(y,S,E,O){var A=r.translateFromRenderableToVisualCoords(S);r.activeWt=O,r.instance.runHooks("beforeOnCellMouseOut",y,A,E),!Ay(y)&&(r.instance.runHooks("afterOnCellMouseOut",y,A,E),r.activeWt=r._wt)},onCellMouseOver:function(y,S,E,O){var A=r.translateFromRenderableToVisualCoords(S),$={row:!1,column:!1,cell:!1};r.activeWt=O,r.instance.runHooks("beforeOnCellMouseOver",y,A,E,$),!Ay(y)&&(n.mouseDown&&hJ(y,{coords:A,selection:r.instance.selection,controller:$,cellCoordsFactory:function(j,z){return r.instance._createCellCoords(j,z)}}),r.instance.runHooks("afterOnCellMouseOver",y,A,E),r.activeWt=r._wt)},onCellMouseUp:function(y,S,E,O){var A=r.translateFromRenderableToVisualCoords(S);r.activeWt=O,r.instance.runHooks("beforeOnCellMouseUp",y,A,E),!(Ay(y)||r.instance.isDestroyed)&&(r.instance.runHooks("afterOnCellMouseUp",y,A,E),r.activeWt=r._wt)},onCellCornerMouseDown:function(y){y.preventDefault(),r.instance.runHooks("afterOnCellCornerMouseDown",y)},onCellCornerDblClick:function(y){y.preventDefault(),r.instance.runHooks("afterOnCellCornerDblClick",y)},beforeDraw:function(y,S){return r.beforeRender(y,S)},onDraw:function(y){return r.afterRender(y)},onScrollVertically:function(){return r.instance.runHooks("afterScrollVertically")},onScrollHorizontally:function(){return r.instance.runHooks("afterScrollHorizontally")},onBeforeRemoveCellClassNames:function(){return r.instance.runHooks("beforeRemoveCellClassNames")},onBeforeHighlightingRowHeader:function(y,S,E){var O=r.instance.rowIndexMapper,A=O.getVisualFromRenderableIndex(y),$=r.instance.runHooks("beforeHighlightingRowHeader",A,S,E);return O.getRenderableFromVisualIndex(O.getNearestNotHiddenIndex($,1))},onBeforeHighlightingColumnHeader:function(y,S,E){var O=r.instance.columnIndexMapper,A=O.getVisualFromRenderableIndex(y),$=r.instance.runHooks("beforeHighlightingColumnHeader",A,S,E);return O.getRenderableFromVisualIndex(O.getNearestNotHiddenIndex($,1))},onAfterDrawSelection:function(y,S,E){var O,A=r.translateFromRenderableToVisualIndex(y,S),$=iS(A,2),B=$[0],j=$[1],z=r.instance.selection.getSelectedRange(),W=z.size();if(W>0){var Q=(E??0)+1-W,q=z.peekByIndex(Q);O=[q.from.row,q.from.col,q.to.row,q.to.col]}return r.instance.runHooks("afterDrawSelection",B,j,O,E)},onBeforeDrawBorders:function(y,S){var E=iS(y,4),O=E[0],A=E[1],$=E[2],B=E[3],j=[r.instance.rowIndexMapper.getVisualFromRenderableIndex(O),r.instance.columnIndexMapper.getVisualFromRenderableIndex(A),r.instance.rowIndexMapper.getVisualFromRenderableIndex($),r.instance.columnIndexMapper.getVisualFromRenderableIndex(B)];return r.instance.runHooks("beforeDrawBorders",j,S)},onBeforeTouchScroll:function(){return r.instance.runHooks("beforeTouchScroll")},onAfterMomentumScroll:function(){return r.instance.runHooks("afterMomentumScroll")},onBeforeStretchingColumnWidth:function(y,S){var E=r.instance.columnIndexMapper.getVisualFromRenderableIndex(S);return r.instance.runHooks("beforeStretchingColumnWidth",y,E)},onModifyRowHeaderWidth:function(y){return r.instance.runHooks("modifyRowHeaderWidth",y)},onModifyGetCellCoords:function(y,S,E){var O=r.instance.rowIndexMapper,A=r.instance.columnIndexMapper,$=S>=0?A.getVisualFromRenderableIndex(S):S,B=y>=0?O.getVisualFromRenderableIndex(y):y,j=r.instance.runHooks("modifyGetCellCoords",B,$,E);if(Array.isArray(j)){var z=iS(j,4),W=z[0],Q=z[1],q=z[2],Se=z[3];return[W>=0?O.getRenderableFromVisualIndex(O.getNearestNotHiddenIndex(W,1)):W,Q>=0?A.getRenderableFromVisualIndex(A.getNearestNotHiddenIndex(Q,1)):Q,q>=0?O.getRenderableFromVisualIndex(O.getNearestNotHiddenIndex(q,-1)):q,Se>=0?A.getRenderableFromVisualIndex(A.getNearestNotHiddenIndex(Se,-1)):Se]}},viewportRowCalculatorOverride:function(y){var S=r.settings.viewportRowRenderingOffset;if(S==="auto"&&r.settings.fixedRowsTop&&(S=10),S>0||S==="auto"){var E=r.countRenderableRows(),O=y.startRow,A=y.endRow;if(typeof S=="number")y.startRow=Math.max(O-S,0),y.endRow=Math.min(A+S,E-1);else if(S==="auto"){var $=Math.ceil(A/E*12);y.startRow=Math.max(O-$,0),y.endRow=Math.min(A+$,E-1)}}r.instance.runHooks("afterViewportRowCalculatorOverride",y)},viewportColumnCalculatorOverride:function(y){var S=r.settings.viewportColumnRenderingOffset;if(S==="auto"&&r.settings.fixedColumnsStart&&(S=10),S>0||S==="auto"){var E=r.countRenderableColumns(),O=y.startColumn,A=y.endColumn;if(typeof S=="number"&&(y.startColumn=Math.max(O-S,0),y.endColumn=Math.min(A+S,E-1)),S==="auto"){var $=Math.ceil(A/E*6);y.startColumn=Math.max(O-$,0),y.endColumn=Math.min(A+$,E-1)}}r.instance.runHooks("afterViewportColumnCalculatorOverride",y)},rowHeaderWidth:function(){return r.settings.rowHeaderWidth},columnHeaderHeight:function(){var y=r.instance.runHooks("modifyColumnHeaderHeight");return r.settings.columnHeaderHeight||y}};this.instance.runHooks("beforeInitWalkontable",i),this._wt=new YXe(i),this.activeWt=this._wt;var o=this._wt.wtTable.spreader,s=this.instance.rootElement.getBoundingClientRect(),a=s.width,h=s.height;this.setLastSize(a,h),this.eventManager.addEventListener(o,"mousedown",function(p){p.target===o&&p.which===3&&p.stopPropagation()}),this.eventManager.addEventListener(o,"contextmenu",function(p){p.target===o&&p.which===3&&p.stopPropagation()}),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"click",function(){r.settings.observeDOMVisibility&&r._wt.drawInterrupted&&(r.instance.forceFullRender=!0,r.render())})}},{key:"isTextSelectionAllowed",value:function(r){if(XP(r))return!0;var n=tm(r,this.instance.view._wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&n||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&n||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}},{key:"isMouseDown",value:function(){return ep.get(this).mouseDown}},{key:"isSelectedOnlyCell",value:function(){var r,n;return(r=(n=this.instance.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingle())!==null&&r!==void 0?r:!1}},{key:"isCellEdited",value:function(){var r=this.instance.getActiveEditor();return r&&r.isOpened()}},{key:"beforeRender",value:function(r,n){r&&this.instance.runHooks("beforeViewRender",this.instance.forceFullRender,n)}},{key:"afterRender",value:function(r){r&&this.instance.runHooks("afterViewRender",this.instance.forceFullRender)}},{key:"appendRowHeader",value:function(r,n){if(n.firstChild){var i=n.firstChild;if(!Wr(i,"relative")){Eu(n),this.appendRowHeader(r,n);return}this.updateCellHeader(i.querySelector(".rowHeader"),r,this.instance.getRowHeader)}else{var o=this.instance,s=o.rootDocument,a=o.getRowHeader,h=s.createElement("div"),p=s.createElement("span");h.className="relative",p.className="rowHeader",this.updateCellHeader(p,r,a),h.appendChild(p),n.appendChild(h)}this.instance.runHooks("afterGetRowHeader",r,n)}},{key:"appendColHeader",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.instance.getColHeader,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;if(n.firstChild){var s=n.firstChild;Wr(s,"relative")?this.updateCellHeader(s.querySelector(".colHeader"),r,i,o):(Eu(n),this.appendColHeader(r,n,i,o))}else{var a=this.instance.rootDocument,h=a.createElement("div"),p=a.createElement("span");h.className="relative",p.className="colHeader",this.updateCellHeader(p,r,i,o),h.appendChild(p),n.appendChild(h)}this.instance.runHooks("afterGetColHeader",r,n,o)}},{key:"updateCellHeader",value:function(r,n,i){var o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,s=n,a=this._wt.wtOverlays.getParentOverlay(r)||this._wt;r.parentNode&&(Wr(r,"colHeader")?s=a.wtTable.columnFilter.sourceToRendered(n):Wr(r,"rowHeader")&&(s=a.wtTable.rowFilter.sourceToRendered(n))),s>-1?iw(r,i(n,o)):(fm(r,String.fromCharCode(160)),Vt(r,"cornerHeader"))}},{key:"maximumVisibleElementWidth",value:function(r){var n=this._wt.wtViewport.getWorkspaceWidth(),i=n-r;return i>0?i:0}},{key:"maximumVisibleElementHeight",value:function(r){var n=this._wt.wtViewport.getWorkspaceHeight(),i=n-r;return i>0?i:0}},{key:"setLastSize",value:function(r,n){var i=ep.get(this),o=[r,n];i.lastWidth=o[0],i.lastHeight=o[1]}},{key:"getLastSize",value:function(){var r=ep.get(this);return{width:r.lastWidth,height:r.lastHeight}}},{key:"getFirstFullyVisibleRow",value:function(){return this.instance.rowIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getFirstVisibleRow())}},{key:"getLastFullyVisibleRow",value:function(){return this.instance.rowIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getLastVisibleRow())}},{key:"getFirstFullyVisibleColumn",value:function(){return this.instance.columnIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getFirstVisibleColumn())}},{key:"getLastFullyVisibleColumn",value:function(){return this.instance.columnIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getLastVisibleColumn())}},{key:"getColumnHeadersCount",value:function(){return gJ(this,jL)}},{key:"getRowHeadersCount",value:function(){return gJ(this,FL)}},{key:"destroy",value:function(){this._wt.destroy(),this.eventManager.destroy()}}]),e}();const Rat=Oat;function tz(e){"@babel/helpers - typeof";return tz=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tz(e)}var kat="ABCDEFGHIJKLMNOPQRSTUVWXYZ",vJ=kat.length;function Pat(e){for(var t=e+1,r="",n;t>0;)n=(t-1)%vJ,r=String.fromCharCode(65+n)+r,t=parseInt((t-n)/vJ,10);return r}function _J(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=e,n=[];return(!Array.isArray(e)||!Array.isArray(e[0]))&&(r=[e]),r.forEach(function(i,o){Array.isArray(i)?i.forEach(function(s,a){n.push([o+t,a,s])}):Object.keys(i).forEach(function(s){n.push([o+t,s,i[s]])})}),n}function fhe(e){var t=0;return Array.isArray(e)&&(e[0]&&Array.isArray(e[0])?t=e[0].length:e[0]&&pn(e[0])&&(t=pU(e[0]))),t}function Aat(e){return!!(Array.isArray(e)&&e.length&&e.every(function(t){return Array.isArray(t)}))}function Iat(e){return!!(Array.isArray(e)&&e.length&&e.every(function(t){return tz(t)==="object"&&!Array.isArray(t)&&t!==null}))}function Ax(e){"@babel/helpers - typeof";return Ax=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ax(e)}function Mat(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function bJ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Dat(n.key),n)}}function $at(e,t,r){return t&&bJ(e.prototype,t),r&&bJ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Dat(e){var t=Lat(e,"string");return Ax(t)==="symbol"?t:String(t)}function Lat(e,t){if(Ax(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ax(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Nat=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];Mat(this,e),this.hot=t,this.data=r,this.dataType="array",this.colToProp=function(){},this.propToCol=function(){}}return $at(e,[{key:"modifyRowData",value:function(r){var n;return this.hot.hasHook("modifyRowData")&&(n=this.hot.runHooks("modifyRowData",r)),n!==void 0&&!Number.isInteger(n)?n:this.data[r]}},{key:"getData",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,r)}},{key:"setData",value:function(r){this.data=r}},{key:"getAtColumn",value:function(r){var n=this,i=[];return Fe(this.data,function(o,s){var a=n.getAtCell(s,r);i.push(a)}),i}},{key:"getAtRow",value:function(r,n,i){var o=this,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,a=n===void 0&&i===void 0,h=null,p=null;if(h=this.modifyRowData(r),Array.isArray(h))p=[],a?h.forEach(function(E,O){p[O]=o.getAtPhysicalCell(r,O,h)}):Or(n,i,function(E){p[E-n]=o.getAtPhysicalCell(r,E,h)});else if(pn(h)||hi(h))if(s?p=[]:p={},!a||s){var y=0,S=this.countFirstRowKeys()-1;Or(y,S,function(E){var O=o.colToProp(E);if(E>=(n||y)&&E<=(i||S)&&!Number.isInteger(O)){var A=o.getAtPhysicalCell(r,O,h);s?p.push(A):q2(p,O,A)}})}else mn(h,function(E,O){q2(p,O,o.getAtPhysicalCell(r,O,h))});return p}},{key:"setAtCell",value:function(r,n,i){if(!(r>=this.countRows()||n>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){var o=Dv(i);this.hot.runHooks("modifySourceData",r,this.propToCol(n),o,"set"),o.isTouched()&&(i=o.value)}Number.isInteger(n)?this.data[r][n]=i:q2(this.data[r],n,i)}}},{key:"getAtPhysicalCell",value:function(r,n,i){var o=null;if(i&&(typeof n=="string"?o=H3e(i,n):typeof n=="function"?o=n(i):o=i[n]),this.hot.hasHook("modifySourceData")){var s=Dv(o);this.hot.runHooks("modifySourceData",r,this.colToProp(n),s,"get"),s.isTouched()&&(o=s.value)}return o}},{key:"getAtCell",value:function(r,n){var i=this.modifyRowData(r);return this.getAtPhysicalCell(r,this.colToProp(n),i)}},{key:"getByRange",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=!1,a=null,h=null,p=null,y=null;n===null||i===null?(s=!0,a=0,p=this.countRows()-1):(a=Math.min(n.row,i.row),h=Math.min(n.col,i.col),p=Math.max(n.row,i.row),y=Math.max(n.col,i.col));var S=[];return Or(a,p,function(E){S.push(s?r.getAtRow(E,void 0,void 0,o):r.getAtRow(E,h,y,o))}),S}},{key:"countRows",value:function(){if(this.hot.hasHook("modifySourceLength")){var r=this.hot.runHooks("modifySourceLength");if(Number.isInteger(r))return r}return this.data.length}},{key:"countFirstRowKeys",value:function(){return fhe(this.data)}},{key:"destroy",value:function(){this.data=null,this.hot=null}}]),e}();const Bat=Nat;var wJ;function jat(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function Fat(e,t){return mn(t,function(r,n){ui(e[n])&&(e[n]=r)}),e}function hhe(e){var t=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/,r=t.exec(e);return r?"".concat(r[1].toLowerCase(),"-").concat(r[2].toUpperCase()):e}function dhe(e){pr(e)&&wU(Jn(wJ||(wJ=jat(['Language with code "',`" was not found. You should register particular language 
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`],['Language with code "',`" was not found. You should register particular language\\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`])),e))}function zat(e,t){var r=Array.isArray(e)&&Number.isInteger(t);return r?e[t]:e}var phe=Zs("phraseFormatters"),Hat=phe.register,Vat=phe.getValues;function Uat(e,t){Hat(e,t)}function Wat(){return Vat()}Uat("pluralize",zat);function Ix(e){"@babel/helpers - typeof";return Ix=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ix(e)}var ar;function ur(e,t,r){return t=Gat(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Gat(e){var t=Yat(e,"string");return Ix(t)==="symbol"?t:String(t)}function Yat(e,t){if(Ix(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ix(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Kat=(ar={languageCode:"en-US"},ur(ar,r4,"No available options"),ur(ar,n4,"Insert row above"),ur(ar,i4,"Insert row below"),ur(ar,o4,"Insert column left"),ur(ar,a4,"Insert column right"),ur(ar,s4,["Remove row","Remove rows"]),ur(ar,l4,["Remove column","Remove columns"]),ur(ar,u4,"Undo"),ur(ar,c4,"Redo"),ur(ar,f4,"Read only"),ur(ar,h4,"Clear column"),ur(ar,T4,"Alignment"),ur(ar,O4,"Left"),ur(ar,R4,"Center"),ur(ar,k4,"Right"),ur(ar,P4,"Justify"),ur(ar,A4,"Top"),ur(ar,I4,"Middle"),ur(ar,M4,"Bottom"),ur(ar,v4,"Freeze column"),ur(ar,_4,"Unfreeze column"),ur(ar,$4,"Borders"),ur(ar,D4,"Top"),ur(ar,L4,"Right"),ur(ar,N4,"Bottom"),ur(ar,B4,"Left"),ur(ar,j4,"Remove border(s)"),ur(ar,S4,"Add comment"),ur(ar,x4,"Edit comment"),ur(ar,C4,"Delete comment"),ur(ar,E4,"Read-only comment"),ur(ar,b4,"Merge cells"),ur(ar,w4,"Unmerge cells"),ur(ar,d4,"Copy"),ur(ar,p4,["Copy with header","Copy with headers"]),ur(ar,m4,["Copy with group header","Copy with group headers"]),ur(ar,g4,["Copy header only","Copy headers only"]),ur(ar,y4,"Cut"),ur(ar,F4,"Insert child row"),ur(ar,z4,"Detach from parent"),ur(ar,H4,["Hide column","Hide columns"]),ur(ar,V4,["Show column","Show columns"]),ur(ar,U4,["Hide row","Hide rows"]),ur(ar,W4,["Show row","Show rows"]),ur(ar,gM,"None"),ur(ar,G4,"Is empty"),ur(ar,Y4,"Is not empty"),ur(ar,K4,"Is equal to"),ur(ar,q4,"Is not equal to"),ur(ar,X4,"Begins with"),ur(ar,Z4,"Ends with"),ur(ar,J4,"Contains"),ur(ar,Q4,"Does not contain"),ur(ar,eW,"Greater than"),ur(ar,tW,"Greater than or equal to"),ur(ar,rW,"Less than"),ur(ar,nW,"Less than or equal to"),ur(ar,iW,"Is between"),ur(ar,oW,"Is not between"),ur(ar,aW,"After"),ur(ar,sW,"Before"),ur(ar,lW,"Today"),ur(ar,uW,"Tomorrow"),ur(ar,cW,"Yesterday"),ur(ar,IA,"Blank cells"),ur(ar,fW,"Filter by condition"),ur(ar,hW,"Filter by value"),ur(ar,dW,"And"),ur(ar,yM,"Or"),ur(ar,pW,"Select all"),ur(ar,mW,"Clear"),ur(ar,gW,"OK"),ur(ar,yW,"Cancel"),ur(ar,vW,"Search"),ur(ar,_W,"Value"),ur(ar,bW,"Second value"),ar);const mhe=Kat;var rz=mhe.languageCode,TM=Zs("languagesDictionaries"),qat=TM.register,ghe=TM.getItem,Xat=TM.hasItem,Zat=TM.getValues;yhe(mhe);function yhe(e,t){var r=e,n=t;return pn(e)&&(n=e,r=n.languageCode),Jat(r,n),qat(r,ba(n)),ba(n)}function Jat(e,t){e!==rz&&Fat(t,ghe(rz))}function vhe(e){return CW(e)?ba(ghe(e)):null}function CW(e){return Xat(e)}function Qat(){return Zat()}function _he(e,t,r){var n=vhe(e);if(n===null)return null;var i=n[t];if(ui(i))return null;var o=est(i,r);return Array.isArray(o)?o[0]:o}function est(e,t){var r=e;return Fe(Wat(),function(n){r=n(e,t)}),r}function tst(e){var t=hhe(e);return CW(t)||(t=rz,dhe(e)),t}var OM="active-header",RM="area",Mx="cell",EW="fill",ME="header",TW="custom-selection";function N_(e){"@babel/helpers - typeof";return N_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},N_(e)}function rst(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function SJ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,whe(n.key),n)}}function nst(e,t,r){return t&&SJ(e.prototype,t),r&&SJ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function jk(){return typeof Reflect<"u"&&Reflect.get?jk=Reflect.get.bind():jk=function(t,r,n){var i=ist(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},jk.apply(this,arguments)}function ist(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=B_(e),e!==null););return e}function ost(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&nz(e,t)}function nz(e,t){return nz=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},nz(e,t)}function ast(e){var t=lst();return function(){var n=B_(e),i;if(t){var o=B_(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return sst(this,i)}}function sst(e,t){if(t&&(N_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return bhe(e)}function bhe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function lst(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function B_(e){return B_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},B_(e)}function ust(e,t,r){return t=whe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function whe(e){var t=cst(e,"string");return N_(t)==="symbol"?t:String(t)}function cst(e,t){if(N_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(N_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var fst=function(e){ost(r,e);var t=ast(r);function r(n,i){var o;return rst(this,r),o=t.call(this,n,null),ust(bhe(o),"visualCellRange",null),o.visualCellRange=i||null,o.commit(),o}return nst(r,[{key:"add",value:function(i){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(i):this.visualCellRange.expand(i),this}},{key:"clear",value:function(){return this.visualCellRange=null,jk(B_(r.prototype),"clear",this).call(this)}},{key:"trimToVisibleCellsRangeOnly",value:function(i){var o=i.from,s=i.to,a=this.getNearestNotHiddenCoords(o,1),h=this.getNearestNotHiddenCoords(s,-1);if(a===null||h===null)return null;if(a.row>h.row||a.col>h.col){var p=this.settings.type==="header"||this.settings.type==="active-header";if(!p)return null;a=o,h=s}return this.settings.createCellRange(a,a,h)}},{key:"getNearestNotHiddenCoords",value:function(i,o){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:o,a=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper(),i.row,o);if(a===null)return null;var h=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper(),i.col,s);return h===null?null:this.settings.createCellCoords(a,h)}},{key:"getNearestNotHiddenIndex",value:function(i,o,s){if(o<0)return o;var a=i.getNearestNotHiddenIndex(o,s),h=this.settings.type==="header"||this.settings.type==="active-header";return h&&a===null?-1:a}},{key:"commit",value:function(){if(this.visualCellRange===null)return this;var i=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return i===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(i.from,i.to),this}},{key:"syncWith",value:function(i){var o=i.getVerticalDirection()==="N-S"?1:-1,s=i.getHorizontalDirection()==="W-E"?1:-1,a=this.getNearestNotHiddenCoords(i.from.clone().normalize(),o,s);if(a!==null&&i.overlaps(a)){if(this.cellRange===null){var h=this.settings.visualToRenderableCoords(a);this.cellRange=this.settings.createCellRange(h)}return i.setHighlight(a),this}return i.setHighlight(i.from),this}},{key:"getCorners",value:function(){var i=this.cellRange,o=i.from,s=i.to,a=o.row===null||s.row===null,h=o.col===null||s.col===null,p=this.settings.createCellCoords(a?null:Math.min(o.row,s.row),h?null:Math.min(o.col,s.col)),y=this.settings.createCellCoords(a?null:Math.max(o.row,s.row),h?null:Math.max(o.col,s.col));return[p.row,p.col,y.row,y.col]}},{key:"getVisualCorners",value:function(){var i=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),o=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[i.row,i.col,o.row,o.col]}},{key:"createRenderableCellRange",value:function(i,o){var s=this.settings.visualToRenderableCoords(i),a=this.settings.visualToRenderableCoords(o);return this.settings.createCellRange(s,s,a)}}]),r}(xZe);const lw=fst;function $x(e){"@babel/helpers - typeof";return $x=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$x(e)}var hst=["activeHeaderClassName"];function xJ(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function CJ(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?xJ(Object(r),!0).forEach(function(n){dst(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):xJ(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function dst(e,t,r){return t=pst(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function pst(e){var t=mst(e,"string");return $x(t)==="symbol"?t:String(t)}function mst(e,t){if($x(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if($x(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function gst(e,t){if(e==null)return{};var r=yst(e,t),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function yst(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,o;for(o=0;o<n.length;o++)i=n[o],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function vst(e){var t=e.activeHeaderClassName,r=gst(e,hst),n=new lw(CJ(CJ({highlightHeaderClassName:t},r),{},{selectionType:OM}));return n}function Dx(e){"@babel/helpers - typeof";return Dx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dx(e)}var _st=["layerLevel","areaCornerVisible"];function EJ(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function TJ(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?EJ(Object(r),!0).forEach(function(n){bst(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):EJ(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function bst(e,t,r){return t=wst(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function wst(e){var t=Sst(e,"string");return Dx(t)==="symbol"?t:String(t)}function Sst(e,t){if(Dx(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Dx(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function xst(e,t){if(e==null)return{};var r=Cst(e,t),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Cst(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,o;for(o=0;o<n.length;o++)i=n[o],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function Est(e){var t=e.layerLevel,r=e.areaCornerVisible,n=xst(e,_st),i=new lw(TJ(TJ({className:"area",markIntersections:!0,layerLevel:Math.min(t,7),border:{width:1,color:"#4b89ff",cornerVisible:r}},n),{},{selectionType:RM}));return i}function Lx(e){"@babel/helpers - typeof";return Lx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lx(e)}var Tst=["cellCornerVisible"];function OJ(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function RJ(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?OJ(Object(r),!0).forEach(function(n){Ost(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):OJ(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Ost(e,t,r){return t=Rst(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Rst(e){var t=kst(e,"string");return Lx(t)==="symbol"?t:String(t)}function kst(e,t){if(Lx(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Lx(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Pst(e,t){if(e==null)return{};var r=Ast(e,t),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Ast(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,o;for(o=0;o<n.length;o++)i=n[o],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function Ist(e){var t=e.cellCornerVisible,r=Pst(e,Tst),n=new lw(RJ(RJ({className:"current",border:{width:2,color:"#4b89ff",cornerVisible:t}},r),{},{selectionType:Mx}));return n}function Nx(e){"@babel/helpers - typeof";return Nx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nx(e)}var Mst=["border","visualCellRange"];function kJ(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function zL(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?kJ(Object(r),!0).forEach(function(n){$st(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):kJ(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function $st(e,t,r){return t=Dst(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Dst(e){var t=Lst(e,"string");return Nx(t)==="symbol"?t:String(t)}function Lst(e,t){if(Nx(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Nx(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Nst(e,t){if(e==null)return{};var r=Bst(e,t),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Bst(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,o;for(o=0;o<n.length;o++)i=n[o],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function jst(e){var t=e.border,r=e.visualCellRange,n=Nst(e,Mst),i=new lw(zL(zL(zL({},t),n),{},{selectionType:TW}),r);return i}function Bx(e){"@babel/helpers - typeof";return Bx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bx(e)}function PJ(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function AJ(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?PJ(Object(r),!0).forEach(function(n){Fst(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):PJ(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Fst(e,t,r){return t=zst(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function zst(e){var t=Hst(e,"string");return Bx(t)==="symbol"?t:String(t)}function Hst(e,t){if(Bx(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Bx(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Vst(e){if(e==null)throw new TypeError("Cannot destructure "+e)}function Ust(e){var t=Object.assign({},(Vst(e),e)),r=new lw(AJ(AJ({className:"fill",border:{width:1,color:"#ff0000"}},t),{},{selectionType:EW}));return r}function jx(e){"@babel/helpers - typeof";return jx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jx(e)}var Wst=["headerClassName","rowClassName","columnClassName"];function IJ(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function MJ(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?IJ(Object(r),!0).forEach(function(n){Gst(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):IJ(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Gst(e,t,r){return t=Yst(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Yst(e){var t=Kst(e,"string");return jx(t)==="symbol"?t:String(t)}function Kst(e,t){if(jx(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(jx(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function qst(e,t){if(e==null)return{};var r=Xst(e,t),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Xst(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,o;for(o=0;o<n.length;o++)i=n[o],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function Zst(e){var t=e.headerClassName,r=e.rowClassName,n=e.columnClassName,i=qst(e,Wst),o=new lw(MJ(MJ({className:"highlight",highlightHeaderClassName:t,highlightRowClassName:r,highlightColumnClassName:n},i),{},{highlightOnlyClosestHeader:!0,selectionType:ME}));return o}function Fx(e){"@babel/helpers - typeof";return Fx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fx(e)}function $J(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Jst(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?$J(Object(r),!0).forEach(function(n){Qst(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$J(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Qst(e,t,r){return t=elt(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function elt(e){var t=tlt(e,"string");return Fx(t)==="symbol"?t:String(t)}function tlt(e,t){if(Fx(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Fx(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var She=Zs("highlight/types"),uw=She.register,rlt=She.getItem;uw(OM,vst);uw(RM,Est);uw(Mx,Ist);uw(TW,jst);uw(EW,Ust);uw(ME,Zst);function uy(e,t){return rlt(e)(Jst({type:e},t))}function zx(e){"@babel/helpers - typeof";return zx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zx(e)}function Wf(e){return alt(e)||olt(e)||ilt(e)||nlt()}function nlt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ilt(e,t){if(e){if(typeof e=="string")return iz(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return iz(e,t)}}function olt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function alt(e){if(Array.isArray(e))return iz(e)}function iz(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function DJ(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function oS(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?DJ(Object(r),!0).forEach(function(n){slt(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):DJ(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function slt(e,t,r){return t=xhe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function llt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function LJ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,xhe(n.key),n)}}function ult(e,t,r){return t&&LJ(e.prototype,t),r&&LJ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function xhe(e){var t=clt(e,"string");return zx(t)==="symbol"?t:String(t)}function clt(e,t){if(zx(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(zx(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var flt=function(e){function t(r){llt(this,t),this.options=r,this.layerLevel=0,this.cell=uy(Mx,r),this.fill=uy(EW,r),this.areas=new Map,this.headers=new Map,this.activeHeaders=new Map,this.customSelections=[]}return ult(t,[{key:"isEnabledFor",value:function(n,i){var o=n;n===Mx&&(o="current");var s=this.options.disabledCellSelection(i.row,i.col);return typeof s=="string"&&(s=[s]),s===!1||Array.isArray(s)&&!s.includes(o)}},{key:"useLayerLevel",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=n,this}},{key:"getCell",value:function(){return this.cell}},{key:"getFill",value:function(){return this.fill}},{key:"createOrGetArea",value:function(){var n=this.layerLevel,i;return this.areas.has(n)?i=this.areas.get(n):(i=uy(RM,oS({layerLevel:n},this.options)),this.areas.set(n,i)),i}},{key:"getAreas",value:function(){return Wf(this.areas.values())}},{key:"createOrGetHeader",value:function(){var n=this.layerLevel,i;return this.headers.has(n)?i=this.headers.get(n):(i=uy(ME,oS({},this.options)),this.headers.set(n,i)),i}},{key:"getHeaders",value:function(){return Wf(this.headers.values())}},{key:"createOrGetActiveHeader",value:function(){var n=this.layerLevel,i;return this.activeHeaders.has(n)?i=this.activeHeaders.get(n):(i=uy(OM,oS({},this.options)),this.activeHeaders.set(n,i)),i}},{key:"getActiveHeaders",value:function(){return Wf(this.activeHeaders.values())}},{key:"getCustomSelections",value:function(){return Wf(this.customSelections.values())}},{key:"addCustomSelection",value:function(n){this.customSelections.push(uy(TW,oS(oS({},this.options),n)))}},{key:"clear",value:function(){this.cell.clear(),this.fill.clear(),Fe(this.areas.values(),function(n){return void n.clear()}),Fe(this.headers.values(),function(n){return void n.clear()}),Fe(this.activeHeaders.values(),function(n){return void n.clear()})}},{key:e,value:function(){return[this.cell,this.fill].concat(Wf(this.areas.values()),Wf(this.headers.values()),Wf(this.activeHeaders.values()),Wf(this.customSelections))[Symbol.iterator]()}}]),t}(Symbol.iterator);const hlt=flt;function Hx(e){"@babel/helpers - typeof";return Hx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hx(e)}function dlt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function NJ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,mlt(n.key),n)}}function plt(e,t,r){return t&&NJ(e.prototype,t),r&&NJ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function mlt(e){var t=glt(e,"string");return Hx(t)==="symbol"?t:String(t)}function glt(e,t){if(Hx(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Hx(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ylt=function(e){function t(r){dlt(this,t),this.ranges=[],this.createCellRange=r}return plt(t,[{key:"isEmpty",value:function(){return this.size()===0}},{key:"set",value:function(n){return this.clear(),this.ranges.push(this.createCellRange(n)),this}},{key:"add",value:function(n){return this.ranges.push(this.createCellRange(n)),this}},{key:"pop",value:function(){return this.ranges.pop(),this}},{key:"current",value:function(){return this.peekByIndex(0)}},{key:"previous",value:function(){return this.peekByIndex(-1)}},{key:"includes",value:function(n){return this.ranges.some(function(i){return i.includes(n)})}},{key:"clear",value:function(){return this.ranges.length=0,this}},{key:"size",value:function(){return this.ranges.length}},{key:"peekByIndex",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,i=this.size()+n-1,o;return i>=0&&(o=this.ranges[i]),o}},{key:e,value:function(){return this.ranges[Symbol.iterator]()}}]),t}(Symbol.iterator);const vlt=ylt;function Vx(e){"@babel/helpers - typeof";return Vx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vx(e)}function _lt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function BJ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,wlt(n.key),n)}}function blt(e,t,r){return t&&BJ(e.prototype,t),r&&BJ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function wlt(e){var t=Slt(e,"string");return Vx(t)==="symbol"?t:String(t)}function Slt(e,t){if(Vx(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Vx(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Che=function(){function e(t,r){_lt(this,e),this.range=t,this.options=r}return blt(e,[{key:"transformStart",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=this.options.createCellCoords(r,n),s=this.range.current().highlight,a=this.options.visualToRenderableCoords(s),h=a.row,p=a.col,y=s,S=0,E=0;if(this.runLocalHooks("beforeTransformStart",o),h!==null&&p!==null){var O=this.options.countRows(),A=this.options.countCols(),$=this.options.fixedRowsBottom(),B=this.options.minSpareRows(),j=this.options.minSpareCols(),z=this.options.autoWrapRow(),W=this.options.autoWrapCol();h+r>O-1?i&&B>0&&!($&&h>=O-$-1)?(this.runLocalHooks("insertRowRequire",O),O=this.options.countRows()):W&&(o.row=1-O,o.col=p+o.col===A-1?1-A:1):W&&h+o.row<0&&p+o.col>=0&&(o.row=O-1,o.col=p+o.col===0?A-1:-1),p+o.col>A-1?i&&j>0?(this.runLocalHooks("insertColRequire",A),A=this.options.countCols()):z&&(o.row=h+o.row===O-1?1-O:1,o.col=1-A):z&&p+o.col<0&&h+o.row>=0&&(o.row=h+o.row===0?O-1:-1,o.col=A-1);var Q=this.options.createCellCoords(h+o.row,p+o.col);S=0,E=0,Q.row<0?(S=-1,Q.row=0):Q.row>0&&Q.row>=O&&(S=1,Q.row=O-1),Q.col<0?(E=-1,Q.col=0):Q.col>0&&Q.col>=A&&(E=1,Q.col=A-1),y=this.options.renderableToVisualCoords(Q)}return this.runLocalHooks("afterTransformStart",y,S,E),y}},{key:"transformEnd",value:function(r,n){var i=this.options.createCellCoords(r,n),o=this.range.current(),s=o.to,a=0,h=0;this.runLocalHooks("beforeTransformEnd",i);var p=this.options.visualToRenderableCoords(o.highlight),y=p.row,S=p.col;if(y!==null&&S!==null){var E=this.options.countRows(),O=this.options.countCols(),A=this.options.visualToRenderableCoords(o.to),$=A.row,B=A.col,j=this.options.createCellCoords($+i.row,B+i.col);a=0,h=0,j.row<0?(a=-1,j.row=0):j.row>0&&j.row>=E&&(a=1,j.row=E-1),j.col<0?(h=-1,j.col=0):j.col>0&&j.col>=O&&(h=1,j.col=O-1),s=this.options.renderableToVisualCoords(j)}return this.runLocalHooks("afterTransformEnd",s,a,h),s}}]),e}();ci(Che,Ya);const xlt=Che;function Ux(e){"@babel/helpers - typeof";return Ux=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ux(e)}var jJ;function FJ(e,t){return Olt(e)||Tlt(e,t)||Elt(e,t)||Clt()}function Clt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Elt(e,t){if(e){if(typeof e=="string")return zJ(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return zJ(e,t)}}function zJ(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Tlt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],h=!0,p=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;h=!1}else for(;!(h=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);h=!0);}catch(y){p=!0,i=y}finally{try{if(!h&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(p)throw i}}return a}}function Olt(e){if(Array.isArray(e))return e}function Rlt(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function klt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function HJ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Alt(n.key),n)}}function Plt(e,t,r){return t&&HJ(e.prototype,t),r&&HJ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Alt(e){var t=Ilt(e,"string");return Ux(t)==="symbol"?t:String(t)}function Ilt(e,t){if(Ux(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ux(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ehe=function(){function e(t,r){var n=this;klt(this,e),this.settings=t,this.tableProps=r,this.inProgress=!1,this.selectedByCorner=!1,this.selectedByRowHeader=new Set,this.selectedByColumnHeader=new Set,this.selectedRange=new vlt(function(i,o,s){return n.tableProps.createCellRange(i,o,s)}),this.highlight=new hlt({headerClassName:t.currentHeaderClassName,activeHeaderClassName:t.activeHeaderClassName,rowClassName:t.currentRowClassName,columnClassName:t.currentColClassName,disabledCellSelection:function(o,s){return n.tableProps.isDisabledCellSelection(o,s)},cellCornerVisible:function(){return n.isCellCornerVisible.apply(n,arguments)},areaCornerVisible:function(){return n.isAreaCornerVisible.apply(n,arguments)},visualToRenderableCoords:function(o){return n.tableProps.visualToRenderableCoords(o)},renderableToVisualCoords:function(o){return n.tableProps.renderableToVisualCoords(o)},createCellCoords:function(o,s){return n.tableProps.createCellCoords(o,s)},createCellRange:function(o,s,a){return n.tableProps.createCellRange(o,s,a)},rowIndexMapper:function(){return n.tableProps.rowIndexMapper()},columnIndexMapper:function(){return n.tableProps.columnIndexMapper()}}),this.transformation=new xlt(this.selectedRange,{countRows:function(){return n.tableProps.countRowsTranslated()},countCols:function(){return n.tableProps.countColsTranslated()},visualToRenderableCoords:function(o){return n.tableProps.visualToRenderableCoords(o)},renderableToVisualCoords:function(o){return n.tableProps.renderableToVisualCoords(o)},createCellCoords:function(o,s){return n.tableProps.createCellCoords(o,s)},fixedRowsBottom:function(){return t.fixedRowsBottom},minSpareRows:function(){return t.minSpareRows},minSpareCols:function(){return t.minSpareCols},autoWrapRow:function(){return t.autoWrapRow},autoWrapCol:function(){return t.autoWrapCol}}),this.transformation.addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks.apply(n,["beforeModifyTransformStart"].concat(o))}),this.transformation.addLocalHook("afterTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks.apply(n,["afterModifyTransformStart"].concat(o))}),this.transformation.addLocalHook("beforeTransformEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks.apply(n,["beforeModifyTransformEnd"].concat(o))}),this.transformation.addLocalHook("afterTransformEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks.apply(n,["afterModifyTransformEnd"].concat(o))}),this.transformation.addLocalHook("insertRowRequire",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks.apply(n,["insertRowRequire"].concat(o))}),this.transformation.addLocalHook("insertColRequire",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks.apply(n,["insertColRequire"].concat(o))})}return Plt(e,[{key:"getSelectedRange",value:function(){return this.selectedRange}},{key:"begin",value:function(){this.inProgress=!0}},{key:"finish",value:function(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1}},{key:"isInProgress",value:function(){return this.inProgress}},{key:"setRangeStart",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=this.settings.selectionMode==="multiple",s=ui(n)?this.tableProps.getShortcutManager().isCtrlPressed():n,a=r.row<0,h=r.col<0,p=a&&h,y=r.clone();this.selectedByCorner=p,this.runLocalHooks("beforeSetRangeStart".concat(i?"Only":""),y),(!o||o&&!s&&ui(n))&&this.selectedRange.clear(),this.selectedRange.add(y),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),!p&&h&&this.selectedByRowHeader.add(this.getLayerLevel()),!p&&a&&this.selectedByColumnHeader.add(this.getLayerLevel()),i||this.setRangeEnd(r)}},{key:"setRangeStartOnly",value:function(r,n){this.setRangeStart(r,n,!0)}},{key:"setRangeEnd",value:function(r){if(!this.selectedRange.isEmpty()){var n=r.clone();this.runLocalHooks("beforeSetRangeEnd",n),this.begin();var i=this.selectedRange.current();this.settings.selectionMode!=="single"&&i.setTo(this.tableProps.createCellCoords(n.row,n.col)),this.highlight.getCell().clear(),this.highlight.isEnabledFor(Mx,i.highlight)&&this.highlight.getCell().add(this.selectedRange.current().highlight).commit().syncWith(i);var o=this.getLayerLevel();o<this.highlight.layerLevel&&(Fe(this.highlight.getAreas(),function($){return void $.clear()}),Fe(this.highlight.getHeaders(),function($){return void $.clear()}),Fe(this.highlight.getActiveHeaders(),function($){return void $.clear()})),this.highlight.useLayerLevel(o);var s=this.highlight.createOrGetArea(),a=this.highlight.createOrGetHeader(),h=this.highlight.createOrGetActiveHeader();if(s.clear(),a.clear(),h.clear(),this.highlight.isEnabledFor(RM,i.highlight)&&(this.isMultiple()||o>=1)&&(s.add(i.from).add(i.to).commit(),o===1)){var p=this.selectedRange.previous();this.highlight.useLayerLevel(o-1).createOrGetArea().add(p.from).commit().syncWith(p),this.highlight.useLayerLevel(o)}if(this.highlight.isEnabledFor(ME,i.highlight)){var y=this.tableProps.countRowsTranslated()===0,S=this.tableProps.countColsTranslated()===0,E=i;if((y||S)&&(E=i.clone()),y&&(E.from.row=-1),S&&(E.from.col=-1),this.settings.selectionMode==="single"?(this.isSelectedByAnyHeader()&&E.from.normalize(),a.add(E.from).commit()):a.add(E.from).add(E.to).commit(),this.isEntireRowSelected()){var O=this.tableProps.countCols()===i.getWidth();O&&h.add(this.tableProps.createCellCoords(i.from.row,-1)).add(this.tableProps.createCellCoords(i.to.row,-1)).commit()}if(this.isEntireColumnSelected()){var A=this.tableProps.countRows()===i.getHeight();A&&h.add(this.tableProps.createCellCoords(-1,i.from.col)).add(this.tableProps.createCellCoords(-1,i.to.col)).commit()}}this.runLocalHooks("afterSetRangeEnd",r)}}},{key:"isMultiple",value:function(){var r=Dv(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",r),r.value}},{key:"transformStart",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.setRangeStart(this.transformation.transformStart(r,n,i))}},{key:"transformEnd",value:function(r,n){this.setRangeEnd(this.transformation.transformEnd(r,n))}},{key:"getLayerLevel",value:function(){return this.selectedRange.size()-1}},{key:"isSelected",value:function(){return!this.selectedRange.isEmpty()}},{key:"isSelectedByRowHeader",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(r)&&this.isEntireRowSelected(r)}},{key:"isEntireRowSelected",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return r===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(r)}},{key:"isSelectedByColumnHeader",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&this.isEntireColumnSelected(r)}},{key:"isEntireColumnSelected",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return r===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(r)}},{key:"isSelectedByAnyHeader",value:function(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}},{key:"isSelectedByCorner",value:function(){return this.selectedByCorner}},{key:"inInSelection",value:function(r){return this.selectedRange.includes(r)}},{key:"isCellCornerVisible",value:function(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}},{key:"isAreaCornerVisible",value:function(r){return Number.isInteger(r)&&r!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}},{key:"clear",value:function(){this.selectedRange.clear(),this.highlight.clear()}},{key:"deselect",value:function(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}},{key:"selectAll",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=this.tableProps.countRows(),o=this.tableProps.countCols();if(!(!r&&!n&&(i===0||o===0))){var s=this.tableProps.createCellCoords(n?-1:0,r?-1:0),a=this.tableProps.createCellCoords(i-1,o-1);this.clear(),this.setRangeStartOnly(s),this.selectedByRowHeader.add(this.getLayerLevel()),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(a),this.finish()}}},{key:"selectCells",value:function(r){var n=this,i=L_(r);if(i===wM)return!1;if(i===bM)throw new Error(Jn(jJ||(jJ=Rlt([`Unsupported format of the selection ranges was passed. To select cells pass 
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd, 
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`],[`Unsupported format of the selection ranges was passed. To select cells pass\\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`]))));var o=Cx(i,{propToCol:function(y){return n.tableProps.propToCol(y)},keepDirection:!0}),s=this.tableProps.countRows(),a=this.tableProps.countCols(),h=!r.some(function(p){var y=o(p),S=FJ(y,4),E=S[0],O=S[1],A=S[2],$=S[3],B=Vf(E,s)&&Vf(O,a)&&Vf(A,s)&&Vf($,a);return!B});return h&&(this.clear(),Fe(r,function(p){var y=o(p),S=FJ(y,4),E=S[0],O=S[1],A=S[2],$=S[3];n.setRangeStartOnly(n.tableProps.createCellCoords(E,O),!1),n.setRangeEnd(n.tableProps.createCellCoords(A,$)),n.finish()})),h}},{key:"selectColumns",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:r,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1,o=typeof r=="string"?this.tableProps.propToCol(r):r,s=typeof n=="string"?this.tableProps.propToCol(n):n,a=this.tableProps.countCols(),h=this.tableProps.countRows(),p=Vf(o,a)&&Vf(s,a);return p&&(this.setRangeStartOnly(this.tableProps.createCellCoords(i,o)),this.setRangeEnd(this.tableProps.createCellCoords(h-1,s)),this.finish()),p}},{key:"selectRows",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:r,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1,o=this.tableProps.countRows(),s=this.tableProps.countCols(),a=Vf(r,o)&&Vf(n,o);return a&&(this.setRangeStartOnly(this.tableProps.createCellCoords(r,i)),this.setRangeEnd(this.tableProps.createCellCoords(n,s-1)),this.finish()),a}},{key:"refresh",value:function(){var r=this.highlight.getCustomSelections();if(r.forEach(function(p){p.commit()}),!!this.isSelected()){var n=this.highlight.getCell(),i=this.getLayerLevel();n.commit().syncWith(this.selectedRange.current());for(var o=0;o<this.selectedRange.size();o+=1){this.highlight.useLayerLevel(o);var s=this.highlight.createOrGetArea(),a=this.highlight.createOrGetHeader(),h=this.highlight.createOrGetActiveHeader();s.commit(),a.commit(),h.commit()}this.highlight.useLayerLevel(i)}}}]),e}();ci(Ehe,Ya);const Mlt=Ehe;var $lt=jr,The=sE,Dlt=Ou.f,Llt=Mm,VJ=to,Nlt=fU,Blt=Wa,jlt=hU,UJ=The("".startsWith),Flt=The("".slice),zlt=Math.min,Ohe=jlt("startsWith"),Hlt=!Ohe&&!!function(){var e=Dlt(String.prototype,"startsWith");return e&&!e.writable}();$lt({target:"String",proto:!0,forced:!Hlt&&!Ohe},{startsWith:function(t){var r=VJ(Blt(this));Nlt(t);var n=Llt(zlt(arguments.length>1?arguments[1]:void 0,r.length)),i=VJ(t);return UJ?UJ(r,i,n):Flt(r,n,n+i.length)===i}});var WJ=/^(\r\n|\n\r|\r|\n)/,Vlt=/^[^\t\r\n]+/,GJ=/^\t/;function Ult(e){var t=[[""]];if(e.length===0)return t;for(var r=0,n=0,i;e.length>0&&i!==e.length;)if(i=e.length,e.match(GJ))e=e.replace(GJ,""),r+=1,t[n][r]="";else if(e.match(WJ))e=e.replace(WJ,""),r=0,n+=1,t[n]=[""];else{var o="";if(e.startsWith('"')){for(var s=0,a=!0;a;){var h=e.slice(0,1);h==='"'&&(s+=1),o+=h,e=e.slice(1),(e.length===0||e.match(/^[\t\r\n]/)&&s%2===0)&&(a=!1)}o=o.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,function(y){return new Array(Math.floor(y.length/2)).fill('"').join("")})}else{var p=e.match(Vlt);o=p?p[0]:"",e=e.slice(o.length)}t[n][r]=o}return t}function QS(e){var t,r,n,i,o="",s;for(t=0,r=e.length;t<r;t+=1){for(i=e[t].length,n=0;n<i;n+=1)n>0&&(o+="	"),s=e[t][n],typeof s=="string"?s.indexOf(`
`)>-1?o+='"'.concat(s.replace(/"/g,'""'),'"'):o+=s:s==null?o+="":o+=s;t!==r-1&&(o+=`
`)}return o}function HL(e){return Klt(e)||Ylt(e)||Glt(e)||Wlt()}function Wlt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Glt(e,t){if(e){if(typeof e=="string")return oz(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return oz(e,t)}}function Ylt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Klt(e){if(Array.isArray(e))return oz(e)}function oz(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function j_(e){"@babel/helpers - typeof";return j_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},j_(e)}function qlt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function YJ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Zlt(n.key),n)}}function Xlt(e,t,r){return t&&YJ(e.prototype,t),r&&YJ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Zlt(e){var t=Jlt(e,"string");return j_(t)==="symbol"?t:String(t)}function Jlt(e,t){if(j_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(j_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Qlt=function(){function e(t,r,n){qlt(this,e),this.instance=t,this.metaManager=n,this.tableMeta=n.getTableMeta(),this.dataSource=r,this.duckSchema=this.createDuckSchema(),this.colToPropCache=void 0,this.propToColCache=void 0,this.createMap()}return Xlt(e,[{key:"createMap",value:function(){var r=this.getSchema();if(typeof r>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");var n=this.tableMeta.columns,i;if(this.colToPropCache=[],this.propToColCache=new Map,n){var o=0,s=0,a=!1;if(typeof n=="function"){var h=pU(r);o=h>0?h:this.countFirstRowKeys(),a=!0}else{var p=this.tableMeta.maxCols;o=Math.min(p,n.length)}for(i=0;i<o;i++){var y=a?n(i):n[i];if(pn(y)){if(typeof y.data<"u"){var S=a?s:i;this.colToPropCache[S]=y.data,this.propToColCache.set(y.data,S)}s+=1}}}else this.recursiveDuckColumns(r)}},{key:"countFirstRowKeys",value:function(){return fhe(this.dataSource)}},{key:"recursiveDuckColumns",value:function(r,n,i){var o=this,s=n,a=i,h;return typeof s>"u"&&(s=0,a=""),j_(r)==="object"&&!Array.isArray(r)&&mn(r,function(p,y){p===null?(h=a+y,o.colToPropCache.push(h),o.propToColCache.set(h,s),s+=1):s=o.recursiveDuckColumns(p,s,"".concat(y,"."))}),s}},{key:"colToProp",value:function(r){if(Number.isInteger(r)===!1)return r;var n=this.instance.toPhysicalColumn(r);return n===null?r:this.colToPropCache&&pr(this.colToPropCache[n])?this.colToPropCache[n]:n}},{key:"propToCol",value:function(r){var n=this.propToColCache.get(r);if(pr(n))return this.instance.toVisualColumn(n);var i=this.instance.toVisualColumn(r);return i===null?r:i}},{key:"getSchema",value:function(){var r=this.tableMeta.dataSchema;return r?typeof r=="function"?r():r:this.duckSchema}},{key:"createDuckSchema",value:function(){return this.dataSource&&this.dataSource[0]?P1(this.dataSource[0]):{}}},{key:"refreshDuckSchema",value:function(){this.duckSchema=this.createDuckSchema()}},{key:"createRow",value:function(r){var n=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},s=o.source,a=o.mode,h=a===void 0?"above":a,p=this.instance.countSourceRows(),y=p,S=0,E=r;(typeof E!="number"||E>=p)&&(E=p),E<this.instance.countRows()&&(y=this.instance.toPhysicalRow(E));var O=this.instance.runHooks("beforeCreateRow",E,i,s);if(O===!1||y===null)return{delta:0};for(var A=this.tableMeta.maxRows,$=this.getSchema().length,B=[],j=function(){var Q=null;n.instance.dataType==="array"?n.tableMeta.dataSchema?Q=ba(n.getSchema()):(Q=[],Or($-1,function(){return Q.push(null)})):n.instance.dataType==="function"?Q=n.tableMeta.dataSchema(E+S):(Q={},sM(Q,n.getSchema())),B.push(Q),S+=1};S<i&&p+S<A;)j();this.instance.rowIndexMapper.insertIndexes(E,S),h==="below"&&(y=Math.min(y+1,p)),this.spliceData(y,0,B);var z=this.instance.toVisualRow(y);return this.instance.countSourceRows()===B.length&&this.instance.columnIndexMapper.initToLength(this.instance.getInitialColumnCount()),S>0&&(r==null?this.metaManager.createRow(null,S):s!=="auto"&&this.metaManager.createRow(y,i)),this.instance.runHooks("afterCreateRow",z,S,s),this.instance.forceFullRender=!0,{delta:S,startPhysicalIndex:y}}},{key:"createCol",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},o=i.source,s=i.mode,a=s===void 0?"start":s;if(!this.instance.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");var h=this.dataSource,p=this.tableMeta.maxCols,y=this.instance.countSourceCols(),S=r;(typeof S!="number"||S>=y)&&(S=y);var E=this.instance.runHooks("beforeCreateCol",S,n,o);if(E===!1)return{delta:0};var O=y;S<this.instance.countCols()&&(O=this.instance.toPhysicalColumn(S));var A=this.instance.countSourceRows(),$=this.instance.countCols(),B=0,j=O;a==="end"&&(j=Math.min(j+1,y));for(var z=j;B<n&&$<p;){if(typeof S!="number"||S>=$)if(A>0)for(var W=0;W<A;W+=1)typeof h[W]>"u"&&(h[W]=[]),h[W].push(null);else h.push([null]);else for(var Q=0;Q<A;Q++)h[Q].splice(j,0,null);B+=1,j+=1,$+=1}this.instance.columnIndexMapper.insertIndexes(S,B),B>0&&(r==null?this.metaManager.createColumn(null,B):o!=="auto"&&this.metaManager.createColumn(z,n));var q=this.instance.toVisualColumn(z);return this.instance.runHooks("afterCreateCol",q,B,o),this.instance.forceFullRender=!0,this.refreshDuckSchema(),{delta:B,startPhysicalIndex:z}}},{key:"removeRow",value:function(r){var n=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,o=arguments.length>2?arguments[2]:void 0,s=Number.isInteger(r)?r:-i,a=this.visualRowsToPhysical(s,i),h=this.instance.countSourceRows();s=(h+s)%h;var p=this.instance.runHooks("beforeRemoveRow",s,a.length,a,o);if(p===!1)return!1;var y=a.length;if(this.filterData(s,y,a),s<this.instance.countRows()){this.instance.rowIndexMapper.removeIndexes(a);var S=pr(this.tableMeta.columns)||pr(this.tableMeta.dataSchema);this.instance.rowIndexMapper.getNotTrimmedIndexesLength()===0&&S===!1&&this.instance.columnIndexMapper.setIndexesSequence([])}var E=a.slice(0).sort(function(O,A){return A-O});return E.forEach(function(O){n.metaManager.removeRow(O,1)}),this.instance.runHooks("afterRemoveRow",s,y,a,o),this.instance.forceFullRender=!0,!0}},{key:"removeCol",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,i=arguments.length>2?arguments[2]:void 0;if(this.instance.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");var o=typeof r!="number"?-n:r;o=(this.instance.countCols()+o)%this.instance.countCols();var s=this.visualColumnsToPhysical(o,n),a=s.slice(0).sort(function(z,W){return W-z}),h=this.instance.runHooks("beforeRemoveCol",o,n,s,i);if(h===!1)return!1;for(var p=!0,y=a.length,S=this.dataSource,E=0;E<y;E++)p&&s[0]!==s[E]-E&&(p=!1);if(p)for(var O=0,A=this.instance.countSourceRows();O<A;O++)S[O].splice(s[0],n),O===0&&this.metaManager.removeColumn(s[0],n);else for(var $=0,B=this.instance.countSourceRows();$<B;$++)for(var j=0;j<y;j++)S[$].splice(a[j],1),$===0&&this.metaManager.removeColumn(a[j],1);return o<this.instance.countCols()&&(this.instance.columnIndexMapper.removeIndexes(s),this.instance.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.instance.rowIndexMapper.setIndexesSequence([])),this.instance.runHooks("afterRemoveCol",o,n,s,i),this.instance.forceFullRender=!0,this.refreshDuckSchema(),!0}},{key:"spliceCol",value:function(r,n,i){for(var o=this.instance.getDataAtCol(r),s=o.slice(n,n+i),a=o.slice(n+i),h=arguments.length,p=new Array(h>3?h-3:0),y=3;y<h;y++)p[y-3]=arguments[y];o9(p,a);for(var S=0;S<i;)p.push(null),S+=1;return S3e(p),this.instance.populateFromArray(n,r,p,null,null,"spliceCol"),s}},{key:"spliceRow",value:function(r,n,i){for(var o=this.instance.getSourceDataAtRow(r),s=o.slice(n,n+i),a=o.slice(n+i),h=arguments.length,p=new Array(h>3?h-3:0),y=3;y<h;y++)p[y-3]=arguments[y];o9(p,a);for(var S=0;S<i;)p.push(null),S+=1;return this.instance.populateFromArray(r,n,[p],null,null,"spliceRow"),s}},{key:"spliceData",value:function(r,n,i){var o=this,s=this.instance.runHooks("beforeDataSplice",r,n,i);if(s!==!1){var a=[].concat(HL(this.dataSource.slice(0,r)),HL(i),HL(this.dataSource.slice(r)));this.dataSource.length=0,a.forEach(function(h){return o.dataSource.push(h)})}}},{key:"filterData",value:function(r,n,i){var o=this.instance.runHooks("filterData",r,n,i);Array.isArray(o)===!1&&(o=this.dataSource.filter(function(s,a){return i.indexOf(a)===-1})),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,o)}},{key:"get",value:function(r,n){var i=this.instance.toPhysicalRow(r),o=this.dataSource[i],s=this.instance.runHooks("modifyRowData",i);o=isNaN(s)?s:o;var a=null;if(o&&o.hasOwnProperty&&Gi(o,n))a=o[n];else if(typeof n=="string"&&n.indexOf(".")>-1){var h=n.split("."),p=o;if(!p)return null;for(var y=0,S=h.length;y<S;y++)if(p=p[h[y]],typeof p>"u")return null;a=p}else typeof n=="function"&&(a=n(this.dataSource.slice(i,i+1)[0]));if(this.instance.hasHook("modifyData")){var E=Dv(a);this.instance.runHooks("modifyData",i,this.propToCol(n),E,"get"),E.isTouched()&&(a=E.value)}return a}},{key:"getCopyable",value:function(r,n){return this.instance.getCellMeta(r,this.propToCol(n)).copyable?this.get(r,n):""}},{key:"set",value:function(r,n,i){var o=this.instance.toPhysicalRow(r),s=i,a=this.dataSource[o],h=this.instance.runHooks("modifyRowData",o);if(a=isNaN(h)?h:a,this.instance.hasHook("modifyData")){var p=Dv(s);this.instance.runHooks("modifyData",o,this.propToCol(n),p,"set"),p.isTouched()&&(s=p.value)}if(a&&a.hasOwnProperty&&Gi(a,n))a[n]=s;else if(typeof n=="string"&&n.indexOf(".")>-1){var y=n.split("."),S=a,E=0,O;for(E=0,O=y.length-1;E<O;E++)typeof S[y[E]]>"u"&&(S[y[E]]={}),S=S[y[E]];S[y[E]]=s}else typeof n=="function"?n(this.dataSource.slice(o,o+1)[0],s):a[n]=s}},{key:"visualRowsToPhysical",value:function(r,n){for(var i=this.instance.countSourceRows(),o=[],s=(i+r)%i,a=n,h;s<i&&a;)h=this.instance.toPhysicalRow(s),o.push(h),a-=1,s+=1;return o}},{key:"visualColumnsToPhysical",value:function(r,n){for(var i=this.instance.countCols(),o=[],s=(i+r)%i,a=n;s<i&&a;){var h=this.instance.toPhysicalColumn(s);o.push(h),a-=1,s+=1}return o}},{key:"clear",value:function(){for(var r=0;r<this.instance.countSourceRows();r++)for(var n=0;n<this.instance.countCols();n++)this.set(r,this.colToProp(n),"")}},{key:"getLength",value:function(){var r=this.tableMeta.maxRows,n;r<0||r===0?n=0:n=r||1/0;var i=this.instance.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(i,n)}},{key:"getAll",value:function(){var r={row:0,col:0},n={row:Math.max(this.instance.countRows()-1,0),col:Math.max(this.instance.countCols()-1,0)};return r.row-n.row===0&&!this.instance.countSourceRows()?[]:this.getRange(r,n,e.DESTINATION_RENDERER)}},{key:"countCachedColumns",value:function(){return this.colToPropCache.length}},{key:"getRange",value:function(r,n,i){var o=[],s,a,h,p=this.tableMeta.maxRows,y=this.tableMeta.maxCols;if(p===0||y===0)return[];var S=i===e.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,E=Math.min(Math.max(p-1,0),Math.max(r.row,n.row)),O=Math.min(Math.max(y-1,0),Math.max(r.col,n.col));for(s=Math.min(r.row,n.row);s<=E;s++){h=[];var A=s>=0?this.instance.toPhysicalRow(s):s;for(a=Math.min(r.col,n.col);a<=O&&A!==null;a++)h.push(S.call(this,s,this.colToProp(a)));A!==null&&o.push(h)}return o}},{key:"getText",value:function(r,n){return QS(this.getRange(r,n,e.DESTINATION_RENDERER))}},{key:"getCopyableText",value:function(r,n){return QS(this.getRange(r,n,e.DESTINATION_CLIPBOARD_GENERATOR))}},{key:"destroy",value:function(){this.instance=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}],[{key:"DESTINATION_RENDERER",get:function(){return 1}},{key:"DESTINATION_CLIPBOARD_GENERATOR",get:function(){return 2}}]),e}();const eut=Qlt;function tut(e,t){var r;return e==="CELL_TYPE"?!1:((r=t._automaticallyAssignedMetaProps)===null||r===void 0?void 0:r.has(e))||!Gi(t,e)}function kM(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,n=typeof t.type=="string"?O6e(t.type):t.type;if(e._automaticallyAssignedMetaProps&&mn(t,function(o,s){return void e._automaticallyAssignedMetaProps.delete(s)}),!!pn(n)){r===e&&!e._automaticallyAssignedMetaProps&&(e._automaticallyAssignedMetaProps=new Set);var i={};mn(n,function(o,s){if(tut(s,r)){var a;i[s]=o,(a=e._automaticallyAssignedMetaProps)===null||a===void 0||a.add(s)}}),lo(e,i)}}function rut(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function r(){}Xh(r,e);for(var n=0;n<t.length;n++)r.prototype[t[n]]=void 0;return r}function Fk(e){return Number.isInteger(e)&&e>=0}function zk(e,t){if(!e())throw new Error("Assertion failed: ".concat(t))}function PR(e){return e==null}function az(e){"@babel/helpers - typeof";return az=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},az(e)}const Rhe=function(){return{_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",isEmptyCol:function(t){var r,n,i;for(r=0,n=this.countRows();r<n;r++)if(i=this.getDataAtCell(r,t),_o(i)===!1)return!1;return!0},isEmptyRow:function(t){var r,n,i,o;for(r=0,n=this.countCols();r<n;r++)if(i=this.getDataAtCell(t,r),_o(i)===!1)return az(i)==="object"?(o=this.getCellMeta(t,r),Iue(this.getSchema()[o.prop],i)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:void 0,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:void 0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",visibleRows:10,width:void 0,wordWrap:!0}};function Wx(e){"@babel/helpers - typeof";return Wx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wx(e)}function KJ(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function qJ(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?KJ(Object(r),!0).forEach(function(n){nut(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):KJ(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function nut(e,t,r){return t=Phe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function XJ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Phe(n.key),n)}}function khe(e,t,r){return t&&XJ(e.prototype,t),r&&XJ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Phe(e){var t=iut(e,"string");return Wx(t)==="symbol"?t:String(t)}function iut(e,t){if(Wx(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Wx(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ahe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function out(){return khe(function e(){Ahe(this,e)})}var aut=function(){function e(t){Ahe(this,e),this.metaCtor=out(),this.meta=this.metaCtor.prototype,lo(this.meta,Rhe()),this.meta.instance=t}return khe(e,[{key:"getMetaConstructor",value:function(){return this.metaCtor}},{key:"getMeta",value:function(){return this.meta}},{key:"updateMeta",value:function(r){var n;lo(this.meta,r),kM(this.meta,qJ(qJ({},r),{},{type:(n=r.type)!==null&&n!==void 0?n:this.meta.type}),r)}}]),e}();function Gx(e){"@babel/helpers - typeof";return Gx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gx(e)}function sut(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ZJ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,uut(n.key),n)}}function lut(e,t,r){return t&&ZJ(e.prototype,t),r&&ZJ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function uut(e){var t=cut(e,"string");return Gx(t)==="symbol"?t:String(t)}function cut(e,t){if(Gx(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Gx(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var fut=function(){function e(t){sut(this,e);var r=t.getMetaConstructor();this.meta=new r}return lut(e,[{key:"getMeta",value:function(){return this.meta}},{key:"updateMeta",value:function(r){lo(this.meta,r),kM(this.meta,r,r)}}]),e}();function Yx(e){"@babel/helpers - typeof";return Yx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yx(e)}function JJ(e){return mut(e)||put(e)||dut(e)||hut()}function hut(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function dut(e,t){if(e){if(typeof e=="string")return sz(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return sz(e,t)}}function put(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function mut(e){if(Array.isArray(e))return sz(e)}function sz(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function gut(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function QJ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,vut(n.key),n)}}function yut(e,t,r){return t&&QJ(e.prototype,t),r&&QJ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function vut(e){var t=_ut(e,"string");return Yx(t)==="symbol"?t:String(t)}function _ut(e,t){if(Yx(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Yx(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var lz=function(e){function t(r){gut(this,t),this.valueFactory=r,this.data=[],this.index=[],this.holes=new Set}return yut(t,[{key:"obtain",value:function(n){zk(function(){return Fk(n)},"Expecting an unsigned number.");var i=this._getStorageIndexByKey(n),o;if(i>=0)o=this.data[i],o===void 0&&(o=this.valueFactory(n),this.data[i]=o);else if(o=this.valueFactory(n),this.holes.size>0){var s=this.holes.values().next().value;this.holes.delete(s),this.data[s]=o,this.index[n]=s}else this.data.push(o),this.index[n]=this.data.length-1;return o}},{key:"insert",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;zk(function(){return Fk(n)||PR(n)},"Expecting an unsigned number or null/undefined argument.");for(var o=[],s=this.data.length,a=0;a<i;a++)o.push(s+a),this.data.push(void 0);var h=PR(n)?this.index.length:n;this.index=[].concat(JJ(this.index.slice(0,h)),o,JJ(this.index.slice(h)))}},{key:"remove",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;zk(function(){return Fk(n)||PR(n)},"Expecting an unsigned number or null/undefined argument.");for(var o=this.index.splice(PR(n)?this.index.length-i:n,i),s=0;s<o.length;s++){var a=o[s];typeof a=="number"&&this.holes.add(a)}}},{key:"size",value:function(){return this.data.length-this.holes.size}},{key:"values",value:function(){var n=this;return Us(this.data,function(i,o){return!n.holes.has(o)})[Symbol.iterator]()}},{key:"entries",value:function(){for(var n=[],i=0;i<this.data.length;i++){var o=this._getKeyByStorageIndex(i);o!==-1&&n.push([o,this.data[i]])}var s=0;return{next:function(){if(s<n.length){var h=n[s];return s+=1,{value:h,done:!1}}return{done:!0}}}}},{key:"clear",value:function(){this.data=[],this.index=[],this.holes.clear()}},{key:"_getStorageIndexByKey",value:function(n){return this.index.length>n?this.index[n]:-1}},{key:"_getKeyByStorageIndex",value:function(n){return this.index.indexOf(n)}},{key:e,value:function(){return this.entries()}}]),t}(Symbol.iterator);function Kx(e){"@babel/helpers - typeof";return Kx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Kx(e)}function but(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function eQ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Sut(n.key),n)}}function wut(e,t,r){return t&&eQ(e.prototype,t),r&&eQ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Sut(e){var t=xut(e,"string");return Kx(t)==="symbol"?t:String(t)}function xut(e,t){if(Kx(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Kx(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Cut=["data","width"],Eut=function(){function e(t){var r=this;but(this,e),this.globalMeta=t,this.metas=new lz(function(){return r._createMeta()})}return wut(e,[{key:"updateMeta",value:function(r,n){var i=this.getMeta(r);lo(i,n),kM(i,n)}},{key:"createColumn",value:function(r,n){this.metas.insert(r,n)}},{key:"removeColumn",value:function(r,n){this.metas.remove(r,n)}},{key:"getMeta",value:function(r){return this.metas.obtain(r)}},{key:"getMetaConstructor",value:function(r){return this.metas.obtain(r).constructor}},{key:"clearCache",value:function(){this.metas.clear()}},{key:"_createMeta",value:function(){return rut(this.globalMeta.getMetaConstructor(),Cut).prototype}}]),e}();function qx(e){"@babel/helpers - typeof";return qx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qx(e)}function Tut(e){return Put(e)||kut(e)||Rut(e)||Out()}function Out(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Rut(e,t){if(e){if(typeof e=="string")return uz(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return uz(e,t)}}function kut(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Put(e){if(Array.isArray(e))return uz(e)}function uz(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Aut(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function tQ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Mut(n.key),n)}}function Iut(e,t,r){return t&&tQ(e.prototype,t),r&&tQ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Mut(e){var t=$ut(e,"string");return qx(t)==="symbol"?t:String(t)}function $ut(e,t){if(qx(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(qx(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Dut=function(){function e(t){var r=this;Aut(this,e),this.columnMeta=t,this.metas=new lz(function(){return r._createRow()})}return Iut(e,[{key:"updateMeta",value:function(r,n,i){var o=this.getMeta(r,n);lo(o,i),kM(o,i)}},{key:"createRow",value:function(r,n){this.metas.insert(r,n)}},{key:"createColumn",value:function(r,n){for(var i=0;i<this.metas.size();i++)this.metas.obtain(i).insert(r,n)}},{key:"removeRow",value:function(r,n){this.metas.remove(r,n)}},{key:"removeColumn",value:function(r,n){for(var i=0;i<this.metas.size();i++)this.metas.obtain(i).remove(r,n)}},{key:"getMeta",value:function(r,n,i){var o=this.metas.obtain(r).obtain(n);return i===void 0?o:o[i]}},{key:"setMeta",value:function(r,n,i,o){var s,a=this.metas.obtain(r).obtain(n);(s=a._automaticallyAssignedMetaProps)===null||s===void 0||s.delete(i),a[i]=o}},{key:"removeMeta",value:function(r,n,i){var o=this.metas.obtain(r).obtain(n);delete o[i]}},{key:"getMetas",value:function(){for(var r=[],n=Array.from(this.metas.values()),i=0;i<n.length;i++)r.push.apply(r,Tut(n[i].values()));return r}},{key:"getMetasAtRow",value:function(r){zk(function(){return Fk(r)},"Expecting an unsigned number.");var n=new Map(this.metas);return n.has(r)?Array.from(n.get(r).values()):[]}},{key:"clearCache",value:function(){this.metas.clear()}},{key:"_createRow",value:function(){var r=this;return new lz(function(n){return r._createMeta(n)})}},{key:"_createMeta",value:function(r){var n=this.columnMeta.getMetaConstructor(r);return new n}}]),e}();function Xx(e){"@babel/helpers - typeof";return Xx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xx(e)}function Lut(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function rQ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,But(n.key),n)}}function Nut(e,t,r){return t&&rQ(e.prototype,t),r&&rQ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function But(e){var t=jut(e,"string");return Xx(t)==="symbol"?t:String(t)}function jut(e,t){if(Xx(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Xx(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ihe=function(){function e(t){var r=this,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];Lut(this,e),this.hot=t,this.globalMeta=new aut(t),this.tableMeta=new fut(this.globalMeta),this.columnMeta=new Eut(this.globalMeta),this.cellMeta=new Dut(this.columnMeta),i.forEach(function(o){return new o(r)}),this.globalMeta.updateMeta(n)}return Nut(e,[{key:"getGlobalMeta",value:function(){return this.globalMeta.getMeta()}},{key:"updateGlobalMeta",value:function(r){this.globalMeta.updateMeta(r)}},{key:"getTableMeta",value:function(){return this.tableMeta.getMeta()}},{key:"updateTableMeta",value:function(r){this.tableMeta.updateMeta(r)}},{key:"getColumnMeta",value:function(r){return this.columnMeta.getMeta(r)}},{key:"updateColumnMeta",value:function(r,n){this.columnMeta.updateMeta(r,n)}},{key:"getCellMeta",value:function(r,n,i){var o=i.visualRow,s=i.visualColumn,a=this.cellMeta.getMeta(r,n);return a.visualRow=o,a.visualCol=s,a.row=r,a.col=n,this.runLocalHooks("afterGetCellMeta",a),a}},{key:"getCellMetaKeyValue",value:function(r,n,i){if(typeof i!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(r,n,i)}},{key:"setCellMeta",value:function(r,n,i,o){this.cellMeta.setMeta(r,n,i,o)}},{key:"updateCellMeta",value:function(r,n,i){this.cellMeta.updateMeta(r,n,i)}},{key:"removeCellMeta",value:function(r,n,i){this.cellMeta.removeMeta(r,n,i)}},{key:"getCellsMeta",value:function(){return this.cellMeta.getMetas()}},{key:"getCellsMetaAtRow",value:function(r){return this.cellMeta.getMetasAtRow(r)}},{key:"createRow",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(r,n)}},{key:"removeRow",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(r,n)}},{key:"createColumn",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(r,n),this.columnMeta.createColumn(r,n)}},{key:"removeColumn",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(r,n),this.columnMeta.removeColumn(r,n)}},{key:"clearCellsCache",value:function(){this.cellMeta.clearCache()}},{key:"clearCache",value:function(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}]),e}();ci(Ihe,Ya);function MA(e){"@babel/helpers - typeof";return MA=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},MA(e)}function nQ(e,t,r,n){var i=n.hotInstance,o=n.dataMap,s=n.dataSource,a=n.internalSource,h=n.source,p=n.metaManager,y=n.firstRun,S=Hc(a),E=i.getSettings();Array.isArray(E.dataSchema)?i.dataType="array":hi(E.dataSchema)?i.dataType="function":i.dataType="object",o&&o.destroy(),e=i.runHooks("before".concat(S),e,y,h);var O=new eut(i,e,p);if(t(O),MA(e)==="object"&&e!==null)e.push&&e.splice||(e=[e]);else if(e===null){var A=O.getSchema();e=[];var $,B=0,j=0;for(B=0,j=E.startRows;B<j;B++)if((i.dataType==="object"||i.dataType==="function")&&E.dataSchema)$=ba(A),e.push($);else if(i.dataType==="array")$=ba(A[0]),e.push($);else{$=[];for(var z=0,W=E.startCols;z<W;z++)$.push(null);e.push($)}}else throw new Error("".concat(a," only accepts array of objects or array of arrays (").concat(MA(e)," given)"));Array.isArray(e[0])&&(i.dataType="array"),E.data=e,O.dataSource=e,s.data=e,s.dataType=i.dataType,s.colToProp=O.colToProp.bind(O),s.propToCol=O.propToCol.bind(O),s.countCachedColumns=O.countCachedColumns.bind(O),r(O),i.runHooks("after".concat(S),e,y,h),y||(i.runHooks("afterChange",null,a),i.render())}function Zx(e){"@babel/helpers - typeof";return Zx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zx(e)}function Fut(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function iQ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Hut(n.key),n)}}function zut(e,t,r){return t&&iQ(e.prototype,t),r&&iQ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Hut(e){var t=Vut(e,"string");return Zx(t)==="symbol"?t:String(t)}function Vut(e,t){if(Zx(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Zx(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Uut=function(){function e(t){var r=this;Fut(this,e),this.metaManager=t,this.metaSyncMemo=new Map,t.addLocalHook("afterGetCellMeta",function(n){return r.extendCellMeta(n)}),gr.getSingleton().add("beforeRender",function(n){n&&r.metaSyncMemo.clear()},this.metaManager.hot)}return zut(e,[{key:"extendCellMeta",value:function(r){var n,i=r.row,o=r.col;if(!((n=this.metaSyncMemo.get(i))!==null&&n!==void 0&&n.has(o))){var s=r.visualRow,a=r.visualCol,h=this.metaManager.hot,p=h.colToProp(a);r.prop=p,h.runHooks("beforeGetCellMeta",s,a,r);var y=Gi(r,"type")?r.type:null,S=hi(r.cells)?r.cells(i,o,p):null;if(y)if(S){var E;S.type=(E=S.type)!==null&&E!==void 0?E:y}else S={type:y};S&&this.metaManager.updateCellMeta(i,o,S),h.runHooks("afterGetCellMeta",s,a,r),this.metaSyncMemo.has(i)||this.metaSyncMemo.set(i,new Set),this.metaSyncMemo.get(i).add(o)}}}]),e}();function Jx(e){"@babel/helpers - typeof";return Jx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jx(e)}function Wut(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function oQ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Yut(n.key),n)}}function Gut(e,t,r){return t&&oQ(e.prototype,t),r&&oQ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Yut(e){var t=Kut(e,"string");return Jx(t)==="symbol"?t:String(t)}function Kut(e,t){if(Jx(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Jx(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var qut=function(){function e(t){Wut(this,e),this.metaManager=t,this.usageTracker=new Set,this.propDescriptors=new Map([["fixedColumnsLeft",{target:"fixedColumnsStart",onChange:function(n){var i=this.metaManager.hot.isRtl();if(i&&n==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{onChange:function(n,i,o){if(!o)throw new Error("The `".concat(n,"` option can not be updated after the Handsontable is initialized."))}}]]),this.extendMetaProps()}return Gut(e,[{key:"extendMetaProps",value:function(){var r=this;this.propDescriptors.forEach(function(n,i){var o=n.target,s=n.onChange,a=s===void 0?function(){}:s,h=typeof o=="string",p=h?o:i,y="_".concat(p);r.metaManager.globalMeta.meta[y]=r.metaManager.globalMeta.meta[p],r.installPropWatcher(i,y,a),h&&r.installPropWatcher(o,y,a)})}},{key:"installPropWatcher",value:function(r,n,i){var o=this;Object.defineProperty(this.metaManager.globalMeta.meta,r,{get:function(){return this[n]},set:function(a){var h=!o.usageTracker.has(r);o.usageTracker.add(r),i.call(o,r,a,h),this[n]=a},enumerable:!0,configurable:!0})}}]),e}(),aQ=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),AR=function(t){return t.map(function(r){var n=r.toLowerCase();return aQ.has(n)?aQ.get(n):n}).sort().join("+")},Xut=function(t){return t.split("+")},sQ=function(t){return t.toLowerCase()},lQ;function Zut(e){return ect(e)||Qut(e)||Mhe(e)||Jut()}function Jut(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Qut(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function ect(e){if(Array.isArray(e))return cz(e)}function tct(e,t){return ict(e)||nct(e,t)||Mhe(e,t)||rct()}function rct(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Mhe(e,t){if(e){if(typeof e=="string")return cz(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return cz(e,t)}}function cz(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function nct(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],h=!0,p=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;h=!1}else for(;!(h=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);h=!0);}catch(y){p=!0,i=y}finally{try{if(!h&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(p)throw i}}return a}}function ict(e){if(Array.isArray(e))return e}function oct(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var act=function(t){var r=hM({errorIdExists:function(y){return'The "'.concat(y,'" shortcut is already registered in the "').concat(t,'" context.')}}),n=function(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},S=y.keys,E=y.callback,O=y.group,A=y.runOnlyIf,$=A===void 0?function(){return!0}:A,B=y.captureCtrl,j=B===void 0?!1:B,z=y.preventDefault,W=z===void 0?!0:z,Q=y.stopPropagation,q=Q===void 0?!1:Q,Se=y.relativeToGroup,Ie=y.position;if(ui(O))throw new Error("You need to define the shortcut's group.");if(hi(E)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(S)===!1)throw new Error(Jn(lQ||(lQ=oct([`Pass the shortcut's keys as an array of arrays, 
      using the KeyboardEvent.key properties: 
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`],[`Pass the shortcut\\'s keys as an array of arrays,\\x20
      using the KeyboardEvent.key properties:\\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`]))));var He={callback:E,group:O,runOnlyIf:$,captureCtrl:j,preventDefault:W,stopPropagation:q};if(pr(Se)){var Le=[Se,Ie];He.relativeToGroup=Le[0],He.position=Le[1]}S.forEach(function(ze){var ct=AR(ze),At=r.hasItem(ct);if(At){var Qe=r.getItem(ct),de=Qe.findIndex(function(Ce){return Ce.group===Se});de!==-1?Ie==="before"?de-=1:de+=1:de=Qe.length,Qe.splice(de,0,He)}else r.addItem(ct,[He])})},i=function(y){var S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};y.forEach(function(E){mn(S,function(O,A){Object.prototype.hasOwnProperty.call(E,A)===!1&&(E[A]=S[A])}),n(E)})},o=function(y){var S=AR(y);r.removeItem(S)},s=function(y){var S=r.getItems();S.forEach(function(E){var O=tct(E,2),A=O[0],$=O[1],B=$.filter(function(j){return j.group!==y});B.length===0?o(Xut(A)):($.length=0,$.push.apply($,Zut(B)))})},a=function(y){var S=AR(y),E=r.getItem(S);return pr(E)?E.slice():[]},h=function(y){var S=AR(y);return r.hasItem(S)};return{addShortcut:n,addShortcuts:i,getShortcuts:a,hasShortcut:h,removeShortcutsByKeys:o,removeShortcutsByGroup:s}};function sct(){var e=new Set;return{press:function(r){e.add(r)},release:function(r){e.delete(r)},releaseAll:function(){e.clear()},isPressed:function(r){return e.has(r)}}}var lct=["meta","alt","shift","control"],aS=sct();function uct(e,t,r,n,i){var o=function(O){return lct.includes(O)},s=function(O){var A=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,$=[];return O.altKey&&$.push("alt"),A&&(O.ctrlKey||O.metaKey)?$.push("control/meta"):(O.ctrlKey&&$.push("control"),O.metaKey&&$.push("meta")),O.shiftKey&&$.push("shift"),$},a=function(O){if(t(O)!==!1){var A=r(O);if(!(O.keyCode===229||A===!1||Ay(O))){var $=sQ(O.key),B=[];o($)?aS.press($):B=s(O);var j=[$].concat(B),z=i(O,j);!z&&(x9()&&B.includes("meta")||!x9()&&B.includes("control"))&&i(O,[$].concat(s(O,!0))),n(O)}}},h=function(O){if(t(O)!==!1){var A=sQ(O.key);o(A)!==!1&&aS.release(A)}},p=function(){aS.releaseAll()},y=function(){for(var O=e;O;)O.document.documentElement.addEventListener("keydown",a),O.document.documentElement.addEventListener("keyup",h),O.document.documentElement.addEventListener("blur",p),O=YP(O)},S=function(){for(var O=e;O;)O.document.documentElement.removeEventListener("keydown",a),O.document.documentElement.removeEventListener("keyup",h),O.document.documentElement.removeEventListener("blur",p),O=YP(O)};return{mount:y,unmount:S,isPressed:function(O){return aS.isPressed(O)},releasePressedKeys:function(){return aS.releaseAll()}}}var cct=function(t){var r=t.ownerWindow,n=t.handleEvent,i=t.beforeKeyDown,o=t.afterKeyDown,s=hM({errorIdExists:function($){return'The "'.concat($,'" context name is already registered.')}}),a="grid",h=function($){var B=act($);return s.addItem($,B),B},p=function(){return a},y=function($){return s.getItem($)},S=function($){a=$},E=!1,O=uct(r,n,i,o,function(A,$){var B=y(p()),j=!1;if(!B.hasShortcut($))return j;for(var z=B.getShortcuts($),W=0;W<z.length;W++){var Q=z[W],q=Q.callback,Se=Q.runOnlyIf,Ie=Q.preventDefault,He=Q.stopPropagation,Le=Q.captureCtrl;if(Se(A)!==!1&&(E=Le,j=q(A,$)===!1,E=!1,Ie&&A.preventDefault(),He&&A.stopPropagation(),j))break}return j});return O.mount(),{addContext:h,getActiveContextName:p,getContext:y,setActiveContextName:S,isCtrlPressed:function(){return!E&&(O.isPressed("control")||O.isPressed("meta"))},releasePressedKeys:function(){return O.releasePressedKeys()},destroy:function(){return O.unmount()}}},uQ,cQ;function Da(e){"@babel/helpers - typeof";return Da=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Da(e)}function fQ(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function iu(e,t){return dct(e)||hct(e,t)||$he(e,t)||fct()}function fct(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function hct(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],h=!0,p=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;h=!1}else for(;!(h=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);h=!0);}catch(y){p=!0,i=y}finally{try{if(!h&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(p)throw i}}return a}}function dct(e){if(Array.isArray(e))return e}function cy(e){return gct(e)||mct(e)||$he(e)||pct()}function pct(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $he(e,t){if(e){if(typeof e=="string")return fz(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return fz(e,t)}}function mct(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function gct(e){if(Array.isArray(e))return fz(e)}function fz(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var yct="gridDefault",VL=null,IR=new Set;function OW(e,t){var r,n=this,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=!1,s=this,a=new Fi(s),h,p,y,S,E=!0;pat(i)&&dat(this),this.rootElement=e,this.rootDocument=e.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;var O=(r=t==null?void 0:t.layoutDirection)!==null&&r!==void 0?r:"inherit",A=["rtl","ltr"].includes(O)?O:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",A),this.isRtl=function(){return A==="rtl"},this.isLtr=function(){return!s.isRtl()},this.getDirectionFactor=function(){return s.isLtr()?1:-1},t.language=tst(t.language);var $=new Ihe(s,t,[Uut,qut]),B=$.getTableMeta(),j=$.getGlobalMeta(),z=hM();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,e.insertBefore(this.container,e.firstChild),QF(this)&&T3e(t.licenseKey,e),this.guid="ht_".concat(Wue()),this.columnIndexMapper=new PF,this.rowIndexMapper=new PF,p=new Bat(s),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);var W=function(U){var K=U.row,re=U.col;return s._createCellCoords(K>=0?s.rowIndexMapper.getRenderableFromVisualIndex(K):K,re>=0?s.columnIndexMapper.getRenderableFromVisualIndex(re):re)},Q=function(U){var K=U.row,re=U.col;return s._createCellCoords(K>=0?s.rowIndexMapper.getVisualFromRenderableIndex(K):K,re>=0?s.columnIndexMapper.getVisualFromRenderableIndex(re):re)},q=new Mlt(B,{rowIndexMapper:function(){return s.rowIndexMapper},columnIndexMapper:function(){return s.columnIndexMapper},countCols:function(){return s.countCols()},countRows:function(){return s.countRows()},propToCol:function(U){return h.propToCol(U)},isEditorOpened:function(){return s.getActiveEditor()?s.getActiveEditor().isOpened():!1},countColsTranslated:function(){return n.view.countRenderableColumns()},countRowsTranslated:function(){return n.view.countRenderableRows()},getShortcutManager:function(){return s.getShortcutManager()},createCellCoords:function(U,K){return s._createCellCoords(U,K)},createCellRange:function(U,K,re){return s._createCellRange(U,K,re)},visualToRenderableCoords:W,renderableToVisualCoords:Q,isDisabledCellSelection:function(U,K){return s.getCellMeta(U,K).disableVisualSelection}});this.selection=q;var Se=function(U){var K=U.hiddenIndexesChanged;K&&n.selection.refresh()};this.columnIndexMapper.addLocalHook("cacheUpdated",Se),this.rowIndexMapper.addLocalHook("cacheUpdated",Se),this.selection.addLocalHook("beforeSetRangeStart",function(M){n.runHooks("beforeSetRangeStart",M)}),this.selection.addLocalHook("beforeSetRangeStartOnly",function(M){n.runHooks("beforeSetRangeStartOnly",M)}),this.selection.addLocalHook("beforeSetRangeEnd",function(M){n.runHooks("beforeSetRangeEnd",M),M.row<0&&(M.row=n.view._wt.wtTable.getFirstVisibleRow()),M.col<0&&(M.col=n.view._wt.wtTable.getFirstVisibleColumn())}),this.selection.addLocalHook("afterSetRangeEnd",function(M){var U=Dv(!1),K=n.selection.getSelectedRange(),re=K.current(),me=re.from,Oe=re.to,We=K.size()-1;n.runHooks("afterSelection",me.row,me.col,Oe.row,Oe.col,U,We),n.runHooks("afterSelectionByProp",me.row,s.colToProp(me.col),Oe.row,s.colToProp(Oe.col),U,We);var Je=n.selection.isSelectedByAnyHeader(),ht=n.selection.selectedRange.current(),ft=!0;o&&(ft=!1),U.isTouched()&&(ft=!U.value);var St=n.selection.isSelectedByRowHeader(),Tt=n.selection.isSelectedByColumnHeader();ft!==!1&&(Je?St?n.view.scrollViewportVertically(s.rowIndexMapper.getRenderableFromVisualIndex(M.row)):Tt&&n.view.scrollViewportHorizontally(s.columnIndexMapper.getRenderableFromVisualIndex(M.col)):ht&&!n.selection.isMultiple()?n.view.scrollViewport(W(ht.from)):n.view.scrollViewport(W(M))),St&&Tt?Vt(n.rootElement,["ht__selection--rows","ht__selection--columns"]):St?(qr(n.rootElement,"ht__selection--columns"),Vt(n.rootElement,"ht__selection--rows")):Tt?(qr(n.rootElement,"ht__selection--rows"),Vt(n.rootElement,"ht__selection--columns")):qr(n.rootElement,["ht__selection--rows","ht__selection--columns"]),n._refreshBorders(null)}),this.selection.addLocalHook("afterSelectionFinished",function(M){var U=M.length-1,K=M[U],re=K.from,me=K.to;n.runHooks("afterSelectionEnd",re.row,re.col,me.row,me.col,U),n.runHooks("afterSelectionEndByProp",re.row,s.colToProp(re.col),me.row,s.colToProp(me.col),U)}),this.selection.addLocalHook("afterIsMultipleSelection",function(M){var U=n.runHooks("afterIsMultipleSelection",M.value);M.value&&(M.value=U)}),this.selection.addLocalHook("beforeModifyTransformStart",function(M){n.runHooks("modifyTransformStart",M)}),this.selection.addLocalHook("afterModifyTransformStart",function(M,U,K){n.runHooks("afterModifyTransformStart",M,U,K)}),this.selection.addLocalHook("beforeModifyTransformEnd",function(M){n.runHooks("modifyTransformEnd",M)}),this.selection.addLocalHook("afterModifyTransformEnd",function(M,U,K){n.runHooks("afterModifyTransformEnd",M,U,K)}),this.selection.addLocalHook("afterDeselect",function(){S.destroyEditor(),n._refreshBorders(),qr(n.rootElement,["ht__selection--rows","ht__selection--columns"]),n.runHooks("afterDeselect")}),this.selection.addLocalHook("insertRowRequire",function(M){n.alter("insert_row_above",M,1,"auto")}),this.selection.addLocalHook("insertColRequire",function(M){n.alter("insert_col_start",M,1,"auto")}),y={alter:function(U,K){var re,me,Oe=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,We=arguments.length>3?arguments[3]:void 0,Je=arguments.length>4?arguments[4]:void 0,ht=function($r){if($r.length===0)return[];var Mr=cy($r);Mr.sort(function(an,Hr){var Fr=iu(an,1),rn=Fr[0],ri=iu(Hr,1),En=ri[0];return rn===En?0:rn>En?1:-1});var ln=oa(Mr,function(an,Hr){var Fr=iu(Hr,2),rn=Fr[0],ri=Fr[1],En=an[an.length-1],un=iu(En,2),zr=un[0],bo=un[1],aa=zr+bo;if(rn<=aa){var zo=Math.max(ri-(aa-rn),0);En[1]+=zo}else an.push([rn,ri]);return an},[Mr[0]]);return ln};switch(U){case"insert_row":IR.has(U)||(IR.add(U),ni(Jn(uQ||(uQ=fQ(["The `","` action of the `alter()` method is deprecated and will be removed \n                              in the next major release of Handsontable. Use the `insert_row_above` action instead."],["The \\`","\\` action of the \\`alter()\\` method is deprecated and will be removed\\x20\n                              in the next major release of Handsontable. Use the \\`insert_row_above\\` action instead."])),U)));case"insert_row_below":case"insert_row_above":var ft=s.countSourceRows();if(B.maxRows===ft)return;var St=U==="insert_row_below"?"below":"above";K=(re=K)!==null&&re!==void 0?re:U==="insert_row"||St==="below"?ft:0;var Tt=h.createRow(K,Oe,{source:We,mode:St}),Xt=Tt.delta,jt=Tt.startPhysicalIndex;if(Xt){var Kt=q.selectedRange.current(),qe=Kt==null?void 0:Kt.from,yr=qe==null?void 0:qe.row,Ar=s.toVisualRow(jt);if(q.isSelectedByCorner())s.selectAll();else if(pr(yr)&&yr>=Ar){var wr=Kt.to,vr=wr.row,Cr=wr.col,se=qe.col;q.isSelectedByRowHeader()&&(se=-1),q.getSelectedRange().pop(),q.setRangeStartOnly(s._createCellCoords(yr+Xt,se),!0),q.setRangeEnd(s._createCellCoords(vr+Xt,Cr))}else s._refreshBorders()}break;case"insert_col":IR.has(U)||(IR.add(U),ni(Jn(cQ||(cQ=fQ(["The `","` action of the `alter()` method is deprecated and will be removed \n                              in the next major release of Handsontable. Use the `insert_col_start` action instead."],["The \\`","\\` action of the \\`alter()\\` method is deprecated and will be removed\\x20\n                              in the next major release of Handsontable. Use the \\`insert_col_start\\` action instead."])),U)));case"insert_col_start":case"insert_col_end":var ye=U==="insert_col_end"?"end":"start";K=(me=K)!==null&&me!==void 0?me:U==="insert_col"||ye==="end"?s.countSourceCols():0;var Ee=h.createCol(K,Oe,{source:We,mode:ye}),Ye=Ee.delta,je=Ee.startPhysicalIndex;if(Ye){if(Array.isArray(B.colHeaders)){var tt=[s.toVisualColumn(je),0];tt.length+=Ye,Array.prototype.splice.apply(B.colHeaders,tt)}var Ue=q.selectedRange.current(),Ve=Ue==null?void 0:Ue.from,at=Ve==null?void 0:Ve.col,et=s.toVisualColumn(je);if(q.isSelectedByCorner())s.selectAll();else if(pr(at)&&at>=et){var mt=Ue.to,Ht=mt.row,or=mt.col,fr=Ve.row;q.isSelectedByColumnHeader()&&(fr=-1),q.getSelectedRange().pop(),q.setRangeStartOnly(s._createCellCoords(fr,at+Ye),!0),q.setRangeEnd(s._createCellCoords(Ht,or+Ye))}else s._refreshBorders()}break;case"remove_row":var Ir=function($r){var Mr=0;Fe($r,function(ln){var an=iu(ln,2),Hr=an[0],Fr=an[1],rn=_o(Hr)?s.countRows()-1:Math.max(Hr-Mr,0);Number.isInteger(Hr)&&(Hr=Math.max(Hr-Mr,0));var ri=h.removeRow(Hr,Fr,We);if(ri){var En=s.countRows(),un=B.fixedRowsTop;un>=rn+1&&(B.fixedRowsTop-=Math.min(Fr,un-rn));var zr=B.fixedRowsBottom;zr&&rn>=En-zr&&(B.fixedRowsBottom-=Math.min(Fr,zr)),Mr+=Fr}})};Array.isArray(K)?Ir(ht(K)):Ir([[K,Oe]]),y.adjustRowsAndCols(),s._refreshBorders();break;case"remove_col":var Ur=function($r){var Mr=0;Fe($r,function(ln){var an=iu(ln,2),Hr=an[0],Fr=an[1],rn=_o(Hr)?s.countCols()-1:Math.max(Hr-Mr,0),ri=s.toPhysicalColumn(rn);Number.isInteger(Hr)&&(Hr=Math.max(Hr-Mr,0));var En=h.removeCol(Hr,Fr,We);if(En){var un=B.fixedColumnsStart;un>=rn+1&&(B.fixedColumnsStart-=Math.min(Fr,un-rn)),Array.isArray(B.colHeaders)&&(typeof ri>"u"&&(ri=-1),B.colHeaders.splice(ri,Fr)),Mr+=Fr}})};Array.isArray(K)?Ur(ht(K)):Ur([[K,Oe]]),y.adjustRowsAndCols(),s._refreshBorders();break;default:throw new Error('There is no such action "'.concat(U,'"'))}Je||y.adjustRowsAndCols()},adjustRowsAndCols:function(){var U=B.minRows,K=B.minSpareRows,re=B.minCols,me=B.minSpareCols;if(s.countRows()===0&&s.countCols()===0&&q.deselect(),U){var Oe=s.countRows();Oe<U&&h.createRow(Oe,U-Oe,{source:"auto"})}if(K){var We=s.countEmptyRows(!0);if(We<K){var Je=K-We,ht=Math.min(Je,B.maxRows-s.countSourceRows());h.createRow(s.countRows(),ht,{source:"auto"})}}{var ft;(re||me)&&(ft=s.countEmptyCols(!0));var St=s.countCols();if(re&&!B.columns&&St<re){var Tt=re-St;ft+=Tt,h.createCol(St,Tt,{source:"auto"})}if(me&&!B.columns&&s.dataType==="array"&&ft<me){St=s.countCols();var Xt=me-ft,jt=Math.min(Xt,B.maxCols-St);h.createCol(St,jt,{source:"auto"})}}if(q.isSelected()){var Kt=s.countRows(),qe=s.countCols();Fe(q.selectedRange,function(yr){var Ar=!1,wr=yr.from.row,vr=yr.from.col,Cr=yr.to.row,se=yr.to.col;wr>Kt-1?(wr=Kt-1,Ar=!0,Cr>wr&&(Cr=wr)):Cr>Kt-1&&(Cr=Kt-1,Ar=!0,wr>Cr&&(wr=Cr)),vr>qe-1?(vr=qe-1,Ar=!0,se>vr&&(se=vr)):se>qe-1&&(se=qe-1,Ar=!0,vr>se&&(vr=se)),Ar&&s.selectCell(wr,vr,Cr,se)})}s.view&&s.view.adjustElementsSize()},populateFromArray:function(U,K,re,me,Oe,We,Je){var ht,ft,St,Tt,Xt=[],jt={},Kt=[],qe=U.row,yr=U.col;if(ft=K.length,ft===0)return!1;var Ar=0,wr=0;switch(pn(re)&&(Ar=re.col-yr+1,wr=re.row-qe+1),Oe){case"shift_down":var vr=Ck(K),Cr=vr.length,se=Math.max(Cr,Ar),ye=s.getData().slice(qe),Ee=Ck(ye).slice(yr,yr+se);for(St=0;St<se;St+=1)if(St<Cr){for(ht=0,ft=vr[St].length;ht<wr-ft;ht+=1)vr[St].push(vr[St][ht%ft]);St<Ee.length?Kt.push(vr[St].concat(Ee[St])):Kt.push(vr[St].concat(new Array(ye.length).fill(null)))}else Kt.push(vr[St%Cr].concat(Ee[St]));s.populateFromArray(qe,yr,Ck(Kt));break;case"shift_right":var Ye=K.length,je=Math.max(Ye,wr),tt=s.getData().slice(qe).map(function(un){return un.slice(yr)});for(ht=0;ht<je;ht+=1)if(ht<Ye){for(St=0,Tt=K[ht].length;St<Ar-Tt;St+=1)K[ht].push(K[ht][St%Tt]);if(ht<tt.length)for(var Ue=0;Ue<tt[ht].length;Ue+=1)K[ht].push(tt[ht][Ue]);else{var Ve;(Ve=K[ht]).push.apply(Ve,cy(new Array(tt[0].length).fill(null)))}}else K.push(K[ht%ft].slice(0,je).concat(tt[ht]));s.populateFromArray(qe,yr,K);break;case"overwrite":default:jt.row=U.row,jt.col=U.col;var at={row:re&&U?re.row-U.row+1:1,col:re&&U?re.col-U.col+1:1},et=0,mt=0,Ht=!0,or,fr=function(zr){var bo=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,aa=K[zr%K.length];return bo!==null?aa[bo%aa.length]:aa},Ir=K.length,Ur=re?re.row-U.row+1:0;for(re?ft=Ur:ft=Math.max(Ir,Ur),ht=0;ht<ft&&!(re&&jt.row>re.row&&Ur>Ir||!B.allowInsertRow&&jt.row>s.countRows()-1||jt.row>=B.maxRows);ht++){var _n=ht-et,$r=fr(_n).length,Mr=re?re.col-U.col+1:0;if(re?Tt=Mr:Tt=Math.max($r,Mr),jt.col=U.col,or=s.getCellMeta(jt.row,jt.col),(me==="CopyPaste.paste"||me==="Autofill.fill")&&or.skipRowOnPaste){et+=1,jt.row+=1,ft+=1;continue}for(mt=0,St=0;St<Tt&&!(re&&jt.col>re.col&&Mr>$r||!B.allowInsertColumn&&jt.col>s.countCols()-1||jt.col>=B.maxCols);St++){if(or=s.getCellMeta(jt.row,jt.col),(me==="CopyPaste.paste"||me==="Autofill.fill")&&or.skipColumnOnPaste){mt+=1,jt.col+=1,Tt+=1;continue}if(or.readOnly&&me!=="UndoRedo.undo"){jt.col+=1;continue}var ln=St-mt,an=fr(_n,ln),Hr=s.getDataAtCell(jt.row,jt.col),Fr={row:_n,col:ln};if(me==="Autofill.fill"){var rn=s.runHooks("beforeAutofillInsidePopulate",Fr,We,K,Je,{},at);rn&&(an=ui(rn.value)?an:rn.value)}if(an!==null&&Da(an)==="object")if(Array.isArray(an)&&Hr===null&&(Hr=[]),Hr===null||Da(Hr)!=="object")Ht=!1;else{var ri=P1(Array.isArray(Hr)?Hr:Hr[0]||Hr),En=P1(Array.isArray(an)?an:an[0]||an);Iue(ri,En)||Array.isArray(ri)&&Array.isArray(En)?an=ba(an):Ht=!1}else Hr!==null&&Da(Hr)==="object"&&(Ht=!1);Ht&&Xt.push([jt.row,jt.col,an]),Ht=!0,jt.col+=1}jt.row+=1}s.setDataAtCell(Xt,null,null,me||"populateFromArray");break}}};function Ie(M){var U=hhe(M);CW(U)?(s.runHooks("beforeLanguageChange",U),j.language=U,s.runHooks("afterLanguageChange",U)):dhe(M)}function He(M,U){var K=M==="className"?s.rootElement:s.table;if(E)Vt(K,U);else{var re=[],me=[];j[M]&&(re=Array.isArray(j[M])?j[M]:s9(j[M])),U&&(me=Array.isArray(U)?U:s9(U));var Oe=a9(re,me),We=a9(me,re);Oe.length&&qr(K,Oe),We.length&&Vt(K,We)}j[M]=U}this.init=function(){p.setData(B.data),s.runHooks("beforeInit"),(gu()||Due())&&Vt(s.rootElement,"mobile"),this.updateSettings(B,!0),this.view=new Rat(this),S=W4e.getInstance(s,B,q),s.runHooks("init"),this.forceFullRender=!0,this.view.render(),E&&s.rootElement.offsetParent===null&&kUe(s.rootElement,function(){s.view._wt.wtOverlays.updateLastSpreaderSize(),s.render(),s.view.adjustElementsSize()}),Da(E)==="object"&&(s.runHooks("afterChange",E[0],E[1]),E=!1),s.runHooks("afterInit")};function Le(){var M=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue:function(){this.validatorsInQueue+=1,M=!1},removeValidatorFormQueue:function(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty:function(){},checkIfQueueIsEmpty:function(){this.validatorsInQueue===0&&M===!1&&(M=!0,this.onQueueEmpty(this.valid))}}}function ze(M){var U=M.replace(",",".");return isNaN(parseFloat(U))===!1?parseFloat(U):M}function ct(M,U,K){if(M.length){var re=s.getActiveEditor(),me=s.runHooks("beforeChange",M,U||"edit"),Oe=!0;if(me===!1){re&&re.cancelChanges();return}var We=new Le;We.onQueueEmpty=function(Kt){re&&Oe&&re.cancelChanges(),K(Kt)};for(var Je=M.length-1;Je>=0;Je--)if(M[Je]===null)M.splice(Je,1);else{var ht=iu(M[Je],4),ft=ht[0],St=ht[1],Tt=ht[3],Xt=h.propToCol(St),jt=s.getCellMeta(ft,Xt);jt.type==="numeric"&&typeof Tt=="string"&&gWe(Tt)&&(M[Je][3]=ze(Tt)),s.getCellValidator(jt)&&(We.addValidatorToQueue(),s.validateCell(M[Je][3],jt,function(Kt,qe){return function(yr){if(typeof yr!="boolean")throw new Error("Validation error: result is not boolean");if(yr===!1&&qe.allowInvalid===!1){Oe=!1,M.splice(Kt,1),qe.valid=!0;var Ar=s.getCell(qe.visualRow,qe.visualCol);Ar!==null&&qr(Ar,B.invalidCellClassName)}We.removeValidatorFormQueue()}}(Je,jt),U))}We.checkIfQueueIsEmpty()}}function At(M,U){var K=M.length-1;if(!(K<0)){for(;K>=0;K--){var re=!1;if(M[K]===null){M.splice(K,1);continue}if(!((M[K][2]===null||M[K][2]===void 0)&&(M[K][3]===null||M[K][3]===void 0))){if(B.allowInsertRow)for(;M[K][0]>s.countRows()-1;){var me=h.createRow(void 0,void 0,{source:U}),Oe=me.delta;if(Oe===0){re=!0;break}}if(s.dataType==="array"&&(!B.columns||B.columns.length===0)&&B.allowInsertColumn)for(;h.propToCol(M[K][1])>s.countCols()-1;){var We=h.createCol(void 0,void 0,{source:U}),Je=We.delta;if(Je===0){re=!0;break}}re||h.set(M[K][0],M[K][1],M[K][3])}}s.forceFullRender=!0,y.adjustRowsAndCols(),s.runHooks("beforeChangeRender",M,U),S.lockEditor(),s._refreshBorders(null),S.unlockEditor(),s.view.adjustElementsSize(),s.runHooks("afterChange",M,U||"edit");var ht=s.getActiveEditor();ht&&pr(ht.refreshValue)&&ht.refreshValue()}}this._createCellCoords=function(M,U){return s.view._wt.createCellCoords(M,U)},this._createCellRange=function(M,U,K){return s.view._wt.createCellRange(M,U,K)},this.validateCell=function(M,U,K,re){var me=s.getCellValidator(U);function Oe(We){var Je=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(!Je||U.hidden===!0){K(We);return}var ht=U.visualCol,ft=U.visualRow,St=s.getCell(ft,ht,!0);if(St&&St.nodeName!=="TH"){var Tt=s.rowIndexMapper.getRenderableFromVisualIndex(ft),Xt=s.columnIndexMapper.getRenderableFromVisualIndex(ht);s.view._wt.getSetting("cellRenderer",Tt,Xt,St)}K(We)}x3e(me)&&(me=function(We){return function(Je,ht){ht(We.test(Je))}}(me)),hi(me)?(M=s.runHooks("beforeValidate",M,U.visualRow,U.prop,re),s._registerImmediate(function(){me.call(U,M,function(We){s&&(We=s.runHooks("afterValidate",We,M,U.visualRow,U.prop,re),U.valid=We,Oe(We),s.runHooks("postAfterValidate",We,M,U.visualRow,U.prop,re))})})):s._registerImmediate(function(){U.valid=!0,Oe(U.valid,!1)})};function Qe(M,U,K){return Array.isArray(M)?M:[[M,U,K]]}this.setDataAtCell=function(M,U,K,re){var me=Qe(M,U,K),Oe=[],We=re,Je,ht,ft;for(Je=0,ht=me.length;Je<ht;Je++){if(Da(me[Je])!=="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof me[Je][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");me[Je][1]>=this.countCols()?ft=me[Je][1]:ft=h.colToProp(me[Je][1]),Oe.push([me[Je][0],ft,p.getAtCell(this.toPhysicalRow(me[Je][0]),me[Je][1]),me[Je][2]])}!We&&Da(M)==="object"&&(We=U),s.runHooks("afterSetDataAtCell",Oe,We),ct(Oe,We,function(){At(Oe,We)})},this.setDataAtRowProp=function(M,U,K,re){var me=Qe(M,U,K),Oe=[],We=re,Je,ht;for(Je=0,ht=me.length;Je<ht;Je++)Oe.push([me[Je][0],me[Je][1],p.getAtCell(this.toPhysicalRow(me[Je][0]),me[Je][1]),me[Je][2]]);!We&&Da(M)==="object"&&(We=U),s.runHooks("afterSetDataAtRowProp",Oe,We),ct(Oe,We,function(){At(Oe,We)})},this.listen=function(){s&&!s.isListening()&&(VL=s.guid,s.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(VL=null,s.runHooks("afterUnlisten"))},this.isListening=function(){return VL===s.guid},this.destroyEditor=function(){var M=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,U=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;s._refreshBorders(M,U)},this.populateFromArray=function(M,U,K,re,me,Oe,We,Je,ht){if(!(Da(K)==="object"&&Da(K[0])==="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");var ft=typeof re=="number"?s._createCellCoords(re,me):null;return y.populateFromArray(s._createCellCoords(M,U),K,ft,Oe,We,Je,ht)},this.spliceCol=function(M,U,K){for(var re,me=arguments.length,Oe=new Array(me>3?me-3:0),We=3;We<me;We++)Oe[We-3]=arguments[We];return(re=h).spliceCol.apply(re,[M,U,K].concat(Oe))},this.spliceRow=function(M,U,K){for(var re,me=arguments.length,Oe=new Array(me>3?me-3:0),We=3;We<me;We++)Oe[We-3]=arguments[We];return(re=h).spliceRow.apply(re,[M,U,K].concat(Oe))},this.getSelected=function(){if(q.isSelected())return dn(q.getSelectedRange(),function(M){var U=M.from,K=M.to;return[U.row,U.col,K.row,K.col]})},this.getSelectedLast=function(){var M=this.getSelected(),U;return M&&M.length>0&&(U=M[M.length-1]),U},this.getSelectedRange=function(){if(q.isSelected())return Array.from(q.getSelectedRange())},this.getSelectedRangeLast=function(){var M=this.getSelectedRange(),U;return M&&M.length>0&&(U=M[M.length-1]),U},this.emptySelectedCells=function(M){var U=this;if(!(!q.isSelected()||this.countRows()===0||this.countCols()===0)){var K=[];Fe(q.getSelectedRange(),function(re){var me=re.getTopStartCorner(),Oe=re.getBottomEndCorner();Or(me.row,Oe.row,function(We){Or(me.col,Oe.col,function(Je){U.getCellMeta(We,Je).readOnly||K.push([We,Je,null])})})}),K.length>0&&this.setDataAtCell(K,M)}},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){var M=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(M,0),!this.isRenderSuspended()&&M===this.renderSuspendedCounter&&(this.renderCall?this.render():this._refreshBorders(null))},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||(S.lockEditor(),this._refreshBorders(null),S.unlockEditor()))},this.batchRender=function(M){this.suspendRender();var U=M();return this.resumeRender(),U},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){var M=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,U=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(U,0),(!this.isExecutionSuspended()&&U===this.executionSuspendedCounter||M)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(M){var U=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();var K=M();return this.resumeExecution(U),K},this.batch=function(M){this.suspendRender(),this.suspendExecution();var U=M();return this.resumeExecution(),this.resumeRender(),U},this.refreshDimensions=function(){if(s.view){var M=s.view.getLastSize(),U=M.width,K=M.height,re=s.rootElement.getBoundingClientRect(),me=re.width,Oe=re.height,We=me!==U||Oe!==K,Je=s.runHooks("beforeRefreshDimensions",{width:U,height:K},{width:me,height:Oe},We)===!1;Je||((We||s.view._wt.wtOverlays.scrollableElement===s.rootWindow)&&(s.view.setLastSize(me,Oe),s.render()),s.runHooks("afterRefreshDimensions",{width:U,height:K},{width:me,height:Oe},We))}},this.updateData=function(M,U){var K=this;nQ(M,function(re){h=re},function(re){h=re,s.columnIndexMapper.fitToLength(K.getInitialColumnCount()),s.rowIndexMapper.fitToLength(K.countSourceRows()),y.adjustRowsAndCols()},{hotInstance:s,dataMap:h,dataSource:p,internalSource:"updateData",source:U,metaManager:$,firstRun:E})},this.loadData=function(M,U){nQ(M,function(K){h=K},function(){$.clearCellsCache(),s.initIndexMappers(),y.adjustRowsAndCols(),E&&(E=[null,"loadData"])},{hotInstance:s,dataMap:h,dataSource:p,internalSource:"loadData",source:U,metaManager:$,firstRun:E})},this.getInitialColumnCount=function(){var M=B.columns,U=0;if(Array.isArray(M))U=M.length;else if(hi(M))if(s.dataType==="array")for(var K=this.countSourceCols(),re=0;re<K;re+=1)M(re)&&(U+=1);else(s.dataType==="object"||s.dataType==="function")&&(U=h.colToPropCache.length);else if(pr(B.dataSchema)){var me=h.getSchema();U=Array.isArray(me)?me.length:pU(me)}else U=this.countSourceCols();return U},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(M,U,K,re){return ui(M)?h.getAll():h.getRange(s._createCellCoords(M,U),s._createCellCoords(K,re),h.DESTINATION_RENDERER)},this.getCopyableText=function(M,U,K,re){return h.getCopyableText(s._createCellCoords(M,U),s._createCellCoords(K,re))},this.getCopyableData=function(M,U){return h.getCopyable(M,h.colToProp(U))},this.getSchema=function(){return h.getSchema()},this.updateSettings=function(M){var U=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,K=(E?s.loadData:s.updateData).bind(this),re=!1,me,Oe;if(pr(M.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(pr(M.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(pr(M.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(me in M)me==="data"||(me==="language"?Ie(M.language):me==="className"?He("className",M.className):me==="tableClassName"&&s.table?(He("tableClassName",M.tableClassName),s.view._wt.wtOverlays.syncOverlayTableClassNames()):gr.getSingleton().isRegistered(me)||gr.getSingleton().isDeprecated(me)?(hi(M[me])||Array.isArray(M[me]))&&(M[me].initialHook=!0,s.addHook(me,M[me])):!U&&Gi(M,me)&&(j[me]=M[me]));M.data===void 0&&B.data===void 0?K(null,"updateSettings"):M.data!==void 0?K(M.data,"updateSettings"):M.columns!==void 0&&(h.createMap(),s.initIndexMappers());var We=s.countCols(),Je=B.columns;if(Je&&hi(Je)&&(re=!0),(M.cell!==void 0||M.cells!==void 0||M.columns!==void 0)&&$.clearCache(),We>0)for(me=0,Oe=0;me<We;me++){if(Je){var ht=re?Je(me):Je[Oe];ht&&$.updateColumnMeta(Oe,ht)}Oe+=1}pr(M.cell)&&mn(M.cell,function(Kt){s.setCellMetaObject(Kt.row,Kt.col,Kt)}),s.runHooks("afterCellMetaReset");var ft=s.rootElement.style.height;ft!==""&&(ft=parseInt(s.rootElement.style.height,10));var St=M.height;if(hi(St)&&(St=St()),U){var Tt=s.rootElement.getAttribute("style");Tt&&s.rootElement.setAttribute("data-initialstyle",s.rootElement.getAttribute("style"))}if(St===null){var Xt=s.rootElement.getAttribute("data-initialstyle");Xt&&(Xt.indexOf("height")>-1||Xt.indexOf("overflow")>-1)?s.rootElement.setAttribute("style",Xt):(s.rootElement.style.height="",s.rootElement.style.overflow="")}else St!==void 0&&(s.rootElement.style.height=isNaN(St)?"".concat(St):"".concat(St,"px"),s.rootElement.style.overflow="hidden");if(typeof M.width<"u"){var jt=M.width;hi(jt)&&(jt=jt()),s.rootElement.style.width=isNaN(jt)?"".concat(jt):"".concat(jt,"px")}U||(s.view&&(s.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),s.view._wt.exportSettingsAsClassNames()),s.runHooks("afterUpdateSettings",M)),y.adjustRowsAndCols(),s.view&&!E&&(s.forceFullRender=!0,S.lockEditor(),s._refreshBorders(null),s.view._wt.wtOverlays.adjustElementsSize(),S.unlockEditor()),!U&&s.view&&(ft===""||St===""||St===void 0)&&ft!==St&&s.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){var M=s.getSelectedLast();if(B.getValue){if(hi(B.getValue))return B.getValue.call(s);if(M)return s.getData()[M[0][0]][B.getValue]}else if(M)return s.getDataAtCell(M[0],M[1])},this.getSettings=function(){return B},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(M,U,K,re,me){y.alter(M,U,K,re,me)},this.getCell=function(M,U){var K=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,re=U,me=M;if(U>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(U)))return null;re=this.columnIndexMapper.getRenderableFromVisualIndex(U)}if(M>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(M)))return null;me=this.rowIndexMapper.getRenderableFromVisualIndex(M)}return me===null||re===null?null:s.view.getCellAtCoords(s._createCellCoords(me,re),K)},this.getCoords=function(M){var U=this.view._wt.wtTable.getCoords(M);if(U===null)return null;var K=U.row,re=U.col,me=K,Oe=re;return K>=0&&(me=this.rowIndexMapper.getVisualFromRenderableIndex(K)),re>=0&&(Oe=this.columnIndexMapper.getVisualFromRenderableIndex(re)),s._createCellCoords(me,Oe)},this.colToProp=function(M){return h.colToProp(M)},this.propToCol=function(M){return h.propToCol(M)},this.toVisualRow=function(M){return n.rowIndexMapper.getVisualFromPhysicalIndex(M)},this.toVisualColumn=function(M){return n.columnIndexMapper.getVisualFromPhysicalIndex(M)},this.toPhysicalRow=function(M){return n.rowIndexMapper.getPhysicalFromVisualIndex(M)},this.toPhysicalColumn=function(M){return n.columnIndexMapper.getPhysicalFromVisualIndex(M)},this.getDataAtCell=function(M,U){return h.get(M,h.colToProp(U))},this.getDataAtRowProp=function(M,U){return h.get(M,U)},this.getDataAtCol=function(M){for(var U=[],K=h.getRange(s._createCellCoords(0,M),s._createCellCoords(B.data.length-1,M),h.DESTINATION_RENDERER),re=0;re<K.length;re+=1)for(var me=0;me<K[re].length;me+=1)U.push(K[re][me]);return U},this.getDataAtProp=function(M){for(var U=[],K=h.getRange(s._createCellCoords(0,h.propToCol(M)),s._createCellCoords(B.data.length-1,h.propToCol(M)),h.DESTINATION_RENDERER),re=0;re<K.length;re+=1)for(var me=0;me<K[re].length;me+=1)U.push(K[re][me]);return U},this.getSourceData=function(M,U,K,re){var me;return M===void 0?me=p.getData():me=p.getByRange(s._createCellCoords(M,U),s._createCellCoords(K,re)),me},this.getSourceDataArray=function(M,U,K,re){var me;return M===void 0?me=p.getData(!0):me=p.getByRange(s._createCellCoords(M,U),s._createCellCoords(K,re),!0),me},this.getSourceDataAtCol=function(M){return p.getAtColumn(M)},this.setSourceDataAtCell=function(M,U,K,re){var me=Qe(M,U,K),Oe=this.hasHook("afterSetSourceDataAtCell"),We=[];Oe&&Fe(me,function(ht){var ft=iu(ht,3),St=ft[0],Tt=ft[1],Xt=ft[2];We.push([St,Tt,p.getAtCell(St,Tt),Xt])}),Fe(me,function(ht){var ft=iu(ht,3),St=ft[0],Tt=ft[1],Xt=ft[2];p.setAtCell(St,Tt,Xt)}),Oe&&this.runHooks("afterSetSourceDataAtCell",We,re),this.render();var Je=s.getActiveEditor();Je&&pr(Je.refreshValue)&&Je.refreshValue()},this.getSourceDataAtRow=function(M){return p.getAtRow(M)},this.getSourceDataAtCell=function(M,U){return p.getAtCell(M,U)},this.getDataAtRow=function(M){var U=h.getRange(s._createCellCoords(M,0),s._createCellCoords(M,this.countCols()-1),h.DESTINATION_RENDERER);return U[0]||[]},this.getDataType=function(M,U,K,re){var me=this,Oe=M===void 0?[0,0,this.countRows(),this.countCols()]:[M,U,K,re],We=Oe[0],Je=Oe[1],ht=Oe[2],ft=Oe[3],St=null,Tt=null;ht===void 0&&(ht=We),ft===void 0&&(ft=Je);var Xt="mixed";return Or(Math.max(Math.min(We,ht),0),Math.max(We,ht),function(jt){var Kt=!0;return Or(Math.max(Math.min(Je,ft),0),Math.max(Je,ft),function(qe){var yr=me.getCellMeta(jt,qe);return Tt=yr.type,St?Kt=St===Tt:St=Tt,Kt}),Xt=Kt?Tt:"mixed",Kt}),Xt},this.removeCellMeta=function(M,U,K){var re=[this.toPhysicalRow(M),this.toPhysicalColumn(U)],me=re[0],Oe=re[1],We=$.getCellMetaKeyValue(me,Oe,K),Je=s.runHooks("beforeRemoveCellMeta",M,U,K,We);Je!==!1&&($.removeCellMeta(me,Oe,K),s.runHooks("afterRemoveCellMeta",M,U,K,We)),We=null},this.spliceCellsMeta=function(M){for(var U=this,K=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,re=arguments.length,me=new Array(re>2?re-2:0),Oe=2;Oe<re;Oe++)me[Oe-2]=arguments[Oe];if(me.length>0&&!Array.isArray(me[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");K>0&&$.removeRow(this.toPhysicalRow(M),K),me.length>0&&Fe(me.reverse(),function(We){$.createRow(U.toPhysicalRow(M)),Fe(We,function(Je,ht){return U.setCellMetaObject(M,ht,Je)})}),s.render()},this.setCellMetaObject=function(M,U,K){var re=this;Da(K)==="object"&&mn(K,function(me,Oe){re.setCellMeta(M,U,Oe,me)})},this.setCellMeta=function(M,U,K,re){var me=s.runHooks("beforeSetCellMeta",M,U,K,re);if(me!==!1){var Oe=M,We=U;M<this.countRows()&&(Oe=this.toPhysicalRow(M)),U<this.countCols()&&(We=this.toPhysicalColumn(U)),$.setCellMeta(Oe,We,K,re),s.runHooks("afterSetCellMeta",M,U,K,re)}},this.getCellsMeta=function(){return $.getCellsMeta()},this.getCellMeta=function(M,U){var K=this.toPhysicalRow(M),re=this.toPhysicalColumn(U);return K===null&&(K=M),re===null&&(re=U),$.getCellMeta(K,re,{visualRow:M,visualColumn:U})},this.getCellMetaAtRow=function(M){return $.getCellsMetaAtRow(M)},this.isColumnModificationAllowed=function(){return!(s.dataType==="object"||B.columns)},this.getCellRenderer=function(M,U){var K=typeof M=="number"?s.getCellMeta(M,U).renderer:M.renderer;return typeof K=="string"?w7(K):ui(K)?w7("text"):K},this.getCellEditor=function(M,U){var K=typeof M=="number"?s.getCellMeta(M,U).editor:M.editor;return typeof K=="string"?G9(K):ui(K)?G9("text"):K},this.getCellValidator=function(M,U){var K=typeof M=="number"?s.getCellMeta(M,U).validator:M.validator;return typeof K=="string"?a6e(K):K},this.validateCells=function(M){this._validateCells(M)},this.validateRows=function(M,U){if(!Array.isArray(M))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(U,M)},this.validateColumns=function(M,U){if(!Array.isArray(M))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(U,void 0,M)},this._validateCells=function(M,U,K){var re=new Le;M&&(re.onQueueEmpty=M);for(var me=s.countRows()-1;me>=0;){if(U!==void 0&&U.indexOf(me)===-1){me-=1;continue}for(var Oe=s.countCols()-1;Oe>=0;){if(K!==void 0&&K.indexOf(Oe)===-1){Oe-=1;continue}re.addValidatorToQueue(),s.validateCell(s.getDataAtCell(me,Oe),s.getCellMeta(me,Oe),function(We){if(typeof We!="boolean")throw new Error("Validation error: result is not boolean");We===!1&&(re.valid=!1),re.removeValidatorFormQueue()},"validateCells"),Oe-=1}me-=1}re.checkIfQueueIsEmpty()},this.getRowHeader=function(M){var U=B.rowHeaders,K=M;return K!==void 0&&(K=s.runHooks("modifyRowHeader",K)),K===void 0?(U=[],Or(s.countRows()-1,function(re){U.push(s.getRowHeader(re))})):Array.isArray(U)&&U[K]!==void 0?U=U[K]:hi(U)?U=U(K):U&&typeof U!="string"&&typeof U!="number"&&(U=K+1),U},this.hasRowHeaders=function(){return!!B.rowHeaders},this.hasColHeaders=function(){if(B.colHeaders!==void 0&&B.colHeaders!==null)return!!B.colHeaders;for(var M=0,U=s.countCols();M<U;M++)if(s.getColHeader(M))return!0;return!1},this.getColHeader=function(M){var U=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1,K=s.runHooks("modifyColHeader",M);if(K===void 0){for(var re=[],me=s.countCols(),Oe=0;Oe<me;Oe++)re.push(s.getColHeader(Oe));return re}var We=B.colHeaders,Je=function(Tt){for(var Xt=[],jt=s.countCols(),Kt=0;Kt<jt;Kt++)hi(B.columns)&&B.columns(Kt)&&Xt.push(Kt);return Xt[Tt]},ht=s.toPhysicalColumn(K),ft=Je(ht);return B.colHeaders===!1?We=null:B.columns&&hi(B.columns)&&B.columns(ft)&&B.columns(ft).title?We=B.columns(ft).title:B.columns&&B.columns[ht]&&B.columns[ht].title?We=B.columns[ht].title:Array.isArray(B.colHeaders)&&B.colHeaders[ht]!==void 0?We=B.colHeaders[ht]:hi(B.colHeaders)?We=B.colHeaders(ht):B.colHeaders&&typeof B.colHeaders!="string"&&typeof B.colHeaders!="number"&&(We=Pat(K)),We=s.runHooks("modifyColumnHeaderValue",We,M,U),We},this._getColWidthFromSettings=function(M){var U;if(M>=0){var K=s.getCellMeta(0,M);U=K.width}if((U===void 0||U===B.width)&&(U=B.colWidths),U!=null){switch(Da(U)){case"object":U=U[M];break;case"function":U=U(M);break}typeof U=="string"&&(U=parseInt(U,10))}return U},this.getColWidth=function(M){var U=s._getColWidthFromSettings(M);return U=s.runHooks("modifyColWidth",U,M),U===void 0&&(U=NU.DEFAULT_WIDTH),U},this._getRowHeightFromSettings=function(M){var U=B.rowHeights;if(U!=null){switch(Da(U)){case"object":U=U[M];break;case"function":U=U(M);break}typeof U=="string"&&(U=parseInt(U,10))}return U},this.getRowHeight=function(M){var U=s._getRowHeightFromSettings(M);return U=s.runHooks("modifyRowHeight",U,M),U},this.countSourceRows=function(){return p.countRows()},this.countSourceCols=function(){return p.countFirstRowKeys()},this.countRows=function(){return h.getLength()},this.countCols=function(){var M=B.maxCols,U=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(M,U)},this.countRenderedRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleColumnsCount():-1},this.countEmptyRows=function(){var M=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,U=0;return Nj(s.countRows()-1,function(K){if(s.isEmptyRow(K))U+=1;else if(M===!0)return!1}),U},this.countEmptyCols=function(){var M=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,U=0;return Nj(s.countCols()-1,function(K){if(s.isEmptyCol(K))U+=1;else if(M===!0)return!1}),U},this.isEmptyRow=function(M){return B.isEmptyRow.call(s,M)},this.isEmptyCol=function(M){return B.isEmptyCol.call(s,M)},this.selectCell=function(M,U,K,re){var me=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,Oe=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return ui(M)||ui(U)?!1:this.selectCells([[M,U,K,re]],me,Oe)},this.selectCells=function(){var M=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],U=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,K=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;U===!1&&(o=!0);var re=q.selectCells(M);return re&&K&&s.listen(),o=!1,re},this.selectColumns=function(M){var U=arguments.length>1&&arguments[1]!==void 0?arguments[1]:M;return q.selectColumns(M,U)},this.selectRows=function(M){var U=arguments.length>1&&arguments[1]!==void 0?arguments[1]:M;return q.selectRows(M,U)},this.deselectCell=function(){q.deselect()},this.selectAll=function(){var M=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,U=M&&this.hasRowHeaders(),K=M&&this.hasColHeaders();o=!0,q.selectAll(U,K),o=!1};var de=function(U,K){return U.getNearestNotHiddenIndex(K,1,!0)};this.scrollViewportTo=function(M,U){var K=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,re=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,me=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,Oe=!K,We=!re,Je=M,ht=U;if(me){var ft=Number.isInteger(M),St=Number.isInteger(U),Tt=ft?de(this.rowIndexMapper,M):void 0,Xt=St?de(this.columnIndexMapper,U):void 0;if(Tt===null||Xt===null)return!1;Je=ft?s.rowIndexMapper.getRenderableFromVisualIndex(Tt):void 0,ht=St?s.columnIndexMapper.getRenderableFromVisualIndex(Xt):void 0}var jt=Number.isInteger(Je),Kt=Number.isInteger(ht);return jt&&Kt?s.view.scrollViewport(s._createCellCoords(Je,ht),Oe,re,K,We):jt&&Kt===!1?s.view.scrollViewportVertically(Je,Oe,K):Kt&&jt===!1?s.view.scrollViewportHorizontally(ht,re,We):!1},this.destroy=function(){if(s._clearTimeouts(),s._clearImmediates(),s.view&&s.view.destroy(),p&&p.destroy(),p=null,this.getShortcutManager().destroy(),$.clearCache(),QF(s)){var M=this.rootDocument.querySelector(".hot-display-license-info");M&&M.parentNode.removeChild(M)}Eu(s.rootElement),a.destroy(),S&&S.destroy(),s.batchExecution(function(){s.rowIndexMapper.unregisterAll(),s.columnIndexMapper.unregisterAll(),z.getItems().forEach(function(U){var K=iu(U,2),re=K[1];re.destroy()}),z.clear(),s.runHooks("afterDestroy")},!0),gr.getSingleton().destroy(s),mn(s,function(U,K,re){hi(U)?re[K]=Ce(K):K!=="guid"&&(re[K]=null)}),s.isDestroyed=!0,h&&h.destroy(),s.rowIndexMapper=null,s.columnIndexMapper=null,h=null,y=null,q=null,S=null,s=null};function Ce(M){return function(){throw new Error('The "'.concat(M,'" method cannot be called because this Handsontable instance has been destroyed'))}}this.getActiveEditor=function(){return S.getActiveEditor()},this.getPlugin=function(M){var U=Hc(M);return U==="UndoRedo"?this.undoRedo:z.getItem(U)},this.getPluginName=function(M){return M===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:z.getId(M)},this.getInstance=function(){return s},this.addHook=function(M,U){gr.getSingleton().add(M,U,s)},this.hasHook=function(M){return gr.getSingleton().has(M,s)||gr.getSingleton().has(M)},this.addHookOnce=function(M,U){gr.getSingleton().once(M,U,s)},this.removeHook=function(M,U){gr.getSingleton().remove(M,U,s)},this.runHooks=function(M,U,K,re,me,Oe,We){return gr.getSingleton().run(s,M,U,K,re,me,Oe,We)},this.getTranslatedPhrase=function(M,U){return _he(B.language,M,U)},this.toHTML=function(){return uJ(n)},this.toTableElement=function(){var M=n.rootDocument.createElement("div");return M.insertAdjacentHTML("afterbegin",uJ(n)),M.firstElementChild},this.timeouts=[],this._registerTimeout=function(M){var U=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,K=M;typeof K=="function"&&(K=setTimeout(K,U)),this.timeouts.push(K)},this._clearTimeouts=function(){Fe(this.timeouts,function(M){clearTimeout(M)})},this.immediates=[],this._registerImmediate=function(M){this.immediates.push(setImmediate(M))},this._clearImmediates=function(){Fe(this.immediates,function(M){clearImmediate(M)})},this._refreshBorders=function(){var M=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,U=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;S.destroyEditor(M),s.view.render(),U&&q.isSelected()&&S.prepareEditor()},this.isRtl=function(){return s.rootWindow.getComputedStyle(s.rootElement).direction==="rtl"},this.isLtr=function(){return!s.isRtl()},this.getDirectionFactor=function(){return s.isLtr()?1:-1};var pt=cct({handleEvent:function(U){var K=s.isListening(),re=(U==null?void 0:U.key)!==void 0;return K&&re},beforeKeyDown:function(U){return n.runHooks("beforeKeyDown",U)},afterKeyDown:function(U){n.isDestroyed||s.runHooks("afterDocumentKeyDown",U)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",function(M){M.ctrlKey===!1&&M.metaKey===!1&&pt.releasePressedKeys()}),this.getShortcutManager=function(){return pt};var Ct=pt.addContext("grid"),ie={runOnlyIf:function(){return pr(s.getSelected())&&s.countRenderedRows()>0&&s.countRenderedCols()>0},group:yct};pt.setActiveContextName("grid"),Ct.addShortcuts([{keys:[["Control/Meta","A"]],callback:function(){s.selectAll()}},{keys:[["Control/Meta","Enter"]],callback:function(){for(var U=s.getSelectedRange(),K=U[U.length-1].highlight,re=K.row,me=K.col,Oe=s.getDataAtCell(re,me),We=new Map,Je=0;Je<U.length;Je++)U[Je].forAll(function(ht,ft){if(ht>=0&&ft>=0&&(ht!==re||ft!==me)){var St=s.getCellMeta(ht,ft),Tt=St.readOnly;Tt||We.set("".concat(ht,"x").concat(ft),[ht,ft,Oe])}});s.setDataAtCell(Array.from(We.values()))},runOnlyIf:function(){return s.getSelectedRangeLast().getCellsCount()>1}},{keys:[["ArrowUp"]],callback:function(){q.transformStart(-1,0)}},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:function(){q.setRangeStart(s._createCellCoords(s.rowIndexMapper.getNearestNotHiddenIndex(0,1),s.getSelectedRangeLast().highlight.col))}},{keys:[["ArrowUp","Shift"]],callback:function(){q.transformEnd(-1,0)}},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var U=s.getSelectedRangeLast(),K=U.from,re=U.to,me=s.rowIndexMapper.getNearestNotHiddenIndex(0,1);q.setRangeStart(K.clone()),q.setRangeEnd(s._createCellCoords(me,re.col))},runOnlyIf:function(){return!(s.selection.isSelectedByCorner()||s.selection.isSelectedByColumnHeader())}},{keys:[["ArrowDown"]],callback:function(){q.transformStart(1,0)}},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:function(){q.setRangeStart(s._createCellCoords(s.rowIndexMapper.getNearestNotHiddenIndex(s.countRows()-1,-1),s.getSelectedRangeLast().highlight.col))}},{keys:[["ArrowDown","Shift"]],callback:function(){q.transformEnd(1,0)}},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var U=s.getSelectedRangeLast(),K=U.from,re=U.to,me=s.rowIndexMapper.getNearestNotHiddenIndex(s.countRows()-1,-1);q.setRangeStart(K.clone()),q.setRangeEnd(s._createCellCoords(me,re.col))},runOnlyIf:function(){return!(s.selection.isSelectedByCorner()||s.selection.isSelectedByColumnHeader())}},{keys:[["ArrowLeft"]],callback:function(){q.transformStart(0,-1*s.getDirectionFactor())}},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:function(){var U,K=s.getSelectedRangeLast().highlight.row,re=(U=s.columnIndexMapper).getNearestNotHiddenIndex.apply(U,cy(s.isRtl()?[s.countCols()-1,-1]:[0,1]));q.setRangeStart(s._createCellCoords(K,re))}},{keys:[["ArrowLeft","Shift"]],callback:function(){q.transformEnd(0,-1*s.getDirectionFactor())}},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var U,K=s.getSelectedRangeLast(),re=K.from,me=K.to,Oe=(U=s.columnIndexMapper).getNearestNotHiddenIndex.apply(U,cy(s.isRtl()?[s.countCols()-1,-1]:[0,1]));q.setRangeStart(re.clone()),q.setRangeEnd(s._createCellCoords(me.row,Oe))},runOnlyIf:function(){return!(s.selection.isSelectedByCorner()||s.selection.isSelectedByRowHeader())}},{keys:[["ArrowRight"]],callback:function(){q.transformStart(0,s.getDirectionFactor())}},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:function(){var U,K=s.getSelectedRangeLast().highlight.row,re=(U=s.columnIndexMapper).getNearestNotHiddenIndex.apply(U,cy(s.isRtl()?[0,1]:[s.countCols()-1,-1]));q.setRangeStart(s._createCellCoords(K,re))}},{keys:[["ArrowRight","Shift"]],callback:function(){q.transformEnd(0,s.getDirectionFactor())}},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var U,K=s.getSelectedRangeLast(),re=K.from,me=K.to,Oe=(U=s.columnIndexMapper).getNearestNotHiddenIndex.apply(U,cy(s.isRtl()?[0,1]:[s.countCols()-1,-1]));q.setRangeStart(re.clone()),q.setRangeEnd(s._createCellCoords(me.row,Oe))},runOnlyIf:function(){return!(s.selection.isSelectedByCorner()||s.selection.isSelectedByRowHeader())}},{keys:[["Home"]],captureCtrl:!0,callback:function(){var U=parseInt(s.getSettings().fixedColumnsStart,10),K=s.getSelectedRangeLast().highlight.row,re=s.columnIndexMapper.getNearestNotHiddenIndex(U,1);q.setRangeStart(s._createCellCoords(K,re))},runOnlyIf:function(){return s.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["Home","Shift"]],callback:function(){q.setRangeEnd(s._createCellCoords(q.selectedRange.current().from.row,s.columnIndexMapper.getNearestNotHiddenIndex(0,1)))}},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:function(){var U=parseInt(s.getSettings().fixedRowsTop,10),K=parseInt(s.getSettings().fixedColumnsStart,10),re=s.rowIndexMapper.getNearestNotHiddenIndex(U,1),me=s.columnIndexMapper.getNearestNotHiddenIndex(K,1);q.setRangeStart(s._createCellCoords(re,me))},runOnlyIf:function(){return s.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["End"]],captureCtrl:!0,callback:function(){q.setRangeStart(s._createCellCoords(s.getSelectedRangeLast().highlight.row,s.columnIndexMapper.getNearestNotHiddenIndex(s.countCols()-1,-1)))},runOnlyIf:function(){return s.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["End","Shift"]],callback:function(){q.setRangeEnd(s._createCellCoords(q.selectedRange.current().from.row,s.columnIndexMapper.getNearestNotHiddenIndex(s.countCols()-1,-1)))}},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:function(){var U=parseInt(s.getSettings().fixedRowsBottom,10),K=s.rowIndexMapper.getNearestNotHiddenIndex(s.countRows()-U-1,-1),re=s.columnIndexMapper.getNearestNotHiddenIndex(s.countCols()-1,-1);q.setRangeStart(s._createCellCoords(K,re))},runOnlyIf:function(){return s.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["PageUp"]],callback:function(){q.transformStart(-s.countVisibleRows(),0)}},{keys:[["PageUp","Shift"]],callback:function(){var U=s.getSelectedRangeLast(),K=U.to,re=Math.max(K.row-s.countVisibleRows(),0),me=s.rowIndexMapper.getNearestNotHiddenIndex(re,1);if(me!==null){var Oe=s._createCellCoords(me,K.col),We=K.row-s.view.getFirstFullyVisibleRow(),Je=Math.max(Oe.row-We,0);q.setRangeEnd(Oe),s.scrollViewportTo(Je)}}},{keys:[["PageDown"]],callback:function(){q.transformStart(s.countVisibleRows(),0)}},{keys:[["PageDown","Shift"]],callback:function(){var U=s.getSelectedRangeLast(),K=U.to,re=Math.min(K.row+s.countVisibleRows(),s.countRows()-1),me=s.rowIndexMapper.getNearestNotHiddenIndex(re,-1);if(me!==null){var Oe=s._createCellCoords(me,K.col),We=K.row-s.view.getFirstFullyVisibleRow(),Je=Math.min(Oe.row-We,s.countRows()-1);q.setRangeEnd(Oe),s.scrollViewportTo(Je)}}},{keys:[["Tab"]],callback:function(U){var K=typeof B.tabMoves=="function"?B.tabMoves(U):B.tabMoves;q.transformStart(K.row,K.col,!0)}},{keys:[["Shift","Tab"]],callback:function(U){var K=typeof B.tabMoves=="function"?B.tabMoves(U):B.tabMoves;q.transformStart(-K.row,-K.col)}}],ie),kce().forEach(function(M){var U=LU(M);z.addItem(M,new U(n))}),gr.getSingleton().run(s,"construct")}function Qx(e){"@babel/helpers - typeof";return Qx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qx(e)}function hQ(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function dQ(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?hQ(Object(r),!0).forEach(function(n){vct(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):hQ(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function vct(e,t,r){return t=Dhe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _ct(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pQ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Dhe(n.key),n)}}function bct(e,t,r){return t&&pQ(e.prototype,t),r&&pQ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Dhe(e){var t=wct(e,"string");return Qx(t)==="symbol"?t:String(t)}function wct(e,t){if(Qx(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Qx(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var mQ=215,Lhe="menu",Sct=Lhe,Nhe=function(){function e(t,r){_ct(this,e),this.hot=t,this.options=r||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:mQ,container:this.hot.rootDocument.documentElement},this.eventManager=new Fi(this),this.container=this.createContainer(this.options.name),this.hotMenu=null,this.hotSubMenus={},this.parentMenu=this.options.parent||null,this.menuItems=null,this.origOutsideClickDeselects=null,this.keyEvent=!1,this.offset={above:0,below:0,left:0,right:0},this._afterScrollCallback=null,this.registerEvents()}return bct(e,[{key:"registerEvents",value:function(){for(var r=this,n=this.hot.rootWindow;n;)this.eventManager.addEventListener(n.document,"mousedown",function(i){return r.onDocumentMouseDown(i)}),this.eventManager.addEventListener(n.document,"contextmenu",function(i){return r.onDocumentContextMenu(i)}),n=YP(n)}},{key:"setMenuItems",value:function(r){this.menuItems=r}},{key:"getSelectedItem",value:function(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}},{key:"hasSelectedItem",value:function(){return Array.isArray(this.hotMenu.getSelectedLast())}},{key:"setOffset",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.offset[r]=n}},{key:"isSubMenu",value:function(){return this.parentMenu!==null}},{key:"open",value:function(){var r=this;this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";var n=tce(function(O){return r.openSubMenu(O)},300),i=this.options.minWidth||mQ,o=!1,s=Us(this.menuItems,function(O){return O.key===Ex&&(o=!0),Unt(O,r.hot)});if(s.length<1&&!o)s.push(Qfe()[Ex]);else if(s.length===0)return;s=Ynt(s,hn);var a=!1,h={data:s,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth:function(A){return pr(A)&&A<i?i:A},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,maxCols:1,columns:[{data:"name",renderer:function(A,$,B,j,z,W){return r.menuItemRenderer(A,$,B,j,z,W)}}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",afterOnCellMouseOver:function(A,$){r.isAllSubMenusClosed()?n($.row):r.openSubMenu($.row)},rowHeights:function(A){return s[A].name===hn?1:23},afterOnCellContextMenu:function(A){A.preventDefault(),S9()&&a&&r.hasSelectedItem()&&r.close(!0)},beforeOnCellMouseUp:function(A){r.hasSelectedItem()&&(a=!r.isCommandPassive(r.getSelectedItem()),r.executeCommand(A))},afterOnCellMouseUp:function(A){(!S9()||!cm(A))&&a&&r.hasSelectedItem()&&(gu()||Due()?setTimeout(function(){return r.close(!0)},325):r.close(!0))},afterUnlisten:function(){!r.hasSelectedItem()&&r.isOpened()&&r.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new OW(this.container,h),this.hotMenu.addHook("afterInit",function(){return r.onAfterInit()}),this.hotMenu.addHook("afterSelection",function(){return r.onAfterSelection.apply(r,arguments)}),this.hotMenu.init(),this.hotMenu.listen();var p=this.hotMenu.getShortcutManager(),y=p.addContext(Sct),S={group:Lhe},E=dQ(dQ({},S),{},{runOnlyIf:function(A){return XP(A.target)===!1||r.container.contains(A.target)===!1}});p.setActiveContextName("menu"),y.addShortcuts([{keys:[["Escape"]],callback:function(){r.keyEvent=!0,r.close(),r.keyEvent=!1}},{keys:[["ArrowDown"]],callback:function(){var A=r.hotMenu.getSelectedLast();r.keyEvent=!0,A?r.selectNextCell(A[0],A[1]):r.selectFirstCell(),r.keyEvent=!1}},{keys:[["ArrowUp"]],callback:function(){var A=r.hotMenu.getSelectedLast();r.keyEvent=!0,A?r.selectPrevCell(A[0],A[1]):r.selectLastCell(),r.keyEvent=!1}},{keys:[["ArrowRight"]],callback:function(){var A=r.hotMenu.getSelectedLast();if(r.keyEvent=!0,A){var $=r.openSubMenu(A[0]);$&&$.selectFirstCell()}r.keyEvent=!1}},{keys:[["ArrowLeft"]],callback:function(){var A=r.hotMenu.getSelectedLast();r.keyEvent=!0,A&&r.isSubMenu()&&(r.close(),r.parentMenu&&r.parentMenu.hotMenu.listen()),r.keyEvent=!1}},{keys:[["Enter"]],callback:function(A){var $=r.hotMenu.getSelectedLast();r.keyEvent=!0,r.hotMenu.getSourceDataAtRow($[0]).submenu||(r.executeCommand(A),r.close(!0)),r.keyEvent=!1}},{keys:[["PageUp"]],callback:function(){var A=r.hotMenu.getSelectedLast();r.keyEvent=!0,A?r.hotMenu.selection.transformStart(-r.hotMenu.countVisibleRows(),0):r.selectFirstCell(),r.keyEvent=!1}},{keys:[["PageDown"]],callback:function(){var A=r.hotMenu.getSelectedLast();r.keyEvent=!0,A?r.hotMenu.selection.transformStart(r.hotMenu.countVisibleRows(),0):r.selectLastCell(),r.keyEvent=!1}}],E),this.blockMainTableCallbacks(),this.runLocalHooks("afterOpen")}},{key:"close",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.isOpened()&&(r&&this.parentMenu?this.parentMenu.close():(this.closeAllSubMenus(),this.container.style.display="none",this.releaseMainTableCallbacks(),this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.parentMenu&&this.parentMenu.hotMenu.listen()))}},{key:"openSubMenu",value:function(r){if(!this.hotMenu)return!1;var n=this.hotMenu.getCell(r,0);if(this.closeAllSubMenus(),!n||!Fnt(n))return!1;var i=this.hotMenu.getSourceDataAtRow(r),o=new e(this.hot,{parent:this,name:i.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return o.setMenuItems(i.submenu.items),o.open(),o.setPosition(n.getBoundingClientRect()),this.hotSubMenus[i.key]=o,o}},{key:"closeSubMenu",value:function(r){var n=this.hotMenu.getSourceDataAtRow(r),i=this.hotSubMenus[n.key];i&&(i.destroy(),delete this.hotSubMenus[n.key])}},{key:"closeAllSubMenus",value:function(){var r=this;Fe(this.hotMenu.getData(),function(n,i){return r.closeSubMenu(i)})}},{key:"isAllSubMenusClosed",value:function(){return Object.keys(this.hotSubMenus).length===0}},{key:"destroy",value:function(){var r=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),r&&r.removeChild(this.container)}},{key:"isOpened",value:function(){return this.hotMenu!==null}},{key:"executeCommand",value:function(r){if(!(!this.isOpened()||!this.hasSelectedItem())){var n=this.getSelectedItem();if(this.runLocalHooks("select",n,r),!this.isCommandPassive(n)){var i=this.hot.getSelectedRange(),o=i?jnt(i):[];this.runLocalHooks("executeCommand",n.key,o,r),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",n.key,o,r)}}}},{key:"isCommandPassive",value:function(r){var n=r.isCommand,i=r.name,o=r.disabled,s=r.submenu,a=o===!0||typeof o=="function"&&o.call(this.hot)===!0;return n===!1||i===hn||a===!0||s}},{key:"setPosition",value:function(r){var n=new cot(r,this.container.ownerDocument.defaultView);this.options.keepInViewport?(n.fitsBelow(this.container)?this.setPositionBelowCursor(n):n.fitsAbove(this.container)?this.setPositionAboveCursor(n):this.setPositionBelowCursor(n),this.hot.isLtr()?this.setHorizontalPositionForLtr(n):this.setHorizontalPositionForRtl(n)):(this.setPositionBelowCursor(n),this.setPositionOnRightOfCursor(n))}},{key:"setHorizontalPositionForRtl",value:function(r){r.fitsOnLeft(this.container)?this.setPositionOnLeftOfCursor(r):this.setPositionOnRightOfCursor(r)}},{key:"setHorizontalPositionForLtr",value:function(r){r.fitsOnRight(this.container)?this.setPositionOnRightOfCursor(r):this.setPositionOnLeftOfCursor(r)}},{key:"setPositionAboveCursor",value:function(r){var n=this.offset.above+r.top-this.container.offsetHeight;this.isSubMenu()&&(n=r.top+r.cellHeight-this.container.offsetHeight+3),this.container.style.top="".concat(n,"px")}},{key:"setPositionBelowCursor",value:function(r){var n=this.offset.below+r.top+1;this.isSubMenu()&&(n=r.top-1),this.container.style.top="".concat(n,"px")}},{key:"setPositionOnRightOfCursor",value:function(r){var n=r.left;if(this.isSubMenu()){var i=this.parentMenu.container.getBoundingClientRect(),o=i.right;n+=r.cellWidth+o-(r.left+r.cellWidth)}else n+=this.offset.right;this.container.style.left="".concat(n,"px")}},{key:"setPositionOnLeftOfCursor",value:function(r){var n=this.offset.left+r.left-this.container.offsetWidth;if(this.isSubMenu()){var i=this.parentMenu.container.getBoundingClientRect(),o=i.left;n-=r.left-o}this.container.style.left="".concat(n,"px")}},{key:"selectFirstCell",value:function(){var r=this.hotMenu.getCell(0,0);ER(r)||TR(r)||OR(r)?this.selectNextCell(0,0):this.hotMenu.selectCell(0,0)}},{key:"selectLastCell",value:function(){var r=this.hotMenu.countRows()-1,n=this.hotMenu.getCell(r,0);ER(n)||TR(n)||OR(n)?this.selectPrevCell(r,0):(this.hotMenu.selectCell(r,0,void 0,void 0,!1),this.hotMenu.scrollViewportTo(r,0,!0,!1))}},{key:"selectNextCell",value:function(r,n){var i=r+1,o=i<this.hotMenu.countRows()?this.hotMenu.getCell(i,n):null;o&&(ER(o)||TR(o)||OR(o)?this.selectNextCell(i,n):this.hotMenu.selectCell(i,n))}},{key:"selectPrevCell",value:function(r,n){var i=r-1,o=i>=0?this.hotMenu.getCell(i,n):null;o&&(ER(o)||TR(o)||OR(o)?this.selectPrevCell(i,n):this.hotMenu.selectCell(i,n))}},{key:"menuItemRenderer",value:function(r,n,i,o,s,a){var h=this,p=r.getSourceDataAtRow(i),y=this.hot.rootDocument.createElement("div"),S=function(j){return Gi(j,"submenu")},E=function(j){return new RegExp(hn,"i").test(j.name)},O=function(j){return j.disabled===!0||typeof j.disabled=="function"&&j.disabled.call(h.hot)===!0},A=function(j){return j.disableSelection},$=a;typeof $=="function"&&($=$.call(this.hot)),Eu(n),Vt(y,"htItemWrapper"),n.appendChild(y),E(p)?Vt(n,"htSeparator"):typeof p.renderer=="function"?(Vt(n,"htCustomMenuRenderer"),n.appendChild(p.renderer(r,y,i,o,s,$))):iw(y,$),O(p)?(Vt(n,"htDisabled"),this.eventManager.addEventListener(n,"mouseenter",function(){return r.deselectCell()})):A(p)?(Vt(n,"htSelectionDisabled"),this.eventManager.addEventListener(n,"mouseenter",function(){return r.deselectCell()})):S(p)?(Vt(n,"htSubmenu"),A(p)?this.eventManager.addEventListener(n,"mouseenter",function(){return r.deselectCell()}):this.eventManager.addEventListener(n,"mouseenter",function(){return r.selectCell(i,o,void 0,void 0,!1,!1)})):(qr(n,["htSubmenu","htDisabled"]),A(p)?this.eventManager.addEventListener(n,"mouseenter",function(){return r.deselectCell()}):this.eventManager.addEventListener(n,"mouseenter",function(){return r.selectCell(i,o,void 0,void 0,!1,!1)}))}},{key:"createContainer",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=this.options.container.ownerDocument,i=r,o;return i&&(hi(i)&&(i=i.call(this.hot),i===null||ui(i)?i="":i=i.toString()),i=i.replace(/[^A-z0-9]/g,"_"),i="".concat(this.options.className,"Sub_").concat(i),o=n.querySelector(".".concat(this.options.className,".").concat(i))),o||(o=n.createElement("div"),Vt(o,"htMenu ".concat(this.options.className)),i&&Vt(o,i),this.options.container.appendChild(o)),o}},{key:"blockMainTableCallbacks",value:function(){this._afterScrollCallback=function(){},this.hot.addHook("afterScrollVertically",this._afterScrollCallback),this.hot.addHook("afterScrollHorizontally",this._afterScrollCallback)}},{key:"releaseMainTableCallbacks",value:function(){this._afterScrollCallback&&(this.hot.removeHook("afterScrollVertically",this._afterScrollCallback),this.hot.removeHook("afterScrollHorizontally",this._afterScrollCallback),this._afterScrollCallback=null)}},{key:"onAfterInit",value:function(){var r=this.hotMenu.view._wt.wtTable,n=this.hotMenu.getSettings().data,i=r.hider.style,o=r.holder.style,s=parseInt(i.width,10),a=oa(n,function(h,p){return h+(p.name===hn?1:26)},0);o.width="".concat(s+3,"px"),o.height="".concat(a+3,"px"),i.height=o.height}},{key:"onAfterSelection",value:function(r,n,i,o,s){this.keyEvent===!1&&(s.value=!0)}},{key:"onDocumentMouseDown",value:function(r){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!tm(r.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!tm(r.target,".htMenu")&&this.close(!0))}},{key:"onDocumentContextMenu",value:function(r){this.isOpened()&&Wr(r.target,"htCore")&&tm(r.target,this.hotMenu.rootElement)&&r.preventDefault()}}]),e}();ci(Nhe,Ya);const RW=Nhe;function F_(e){"@babel/helpers - typeof";return F_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},F_(e)}function xct(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gQ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ect(n.key),n)}}function Cct(e,t,r){return t&&gQ(e.prototype,t),r&&gQ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ect(e){var t=Tct(e,"string");return F_(t)==="symbol"?t:String(t)}function Tct(e,t){if(F_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(F_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function kp(){return typeof Reflect<"u"&&Reflect.get?kp=Reflect.get.bind():kp=function(t,r,n){var i=Oct(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},kp.apply(this,arguments)}function Oct(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=_c(e),e!==null););return e}function Rct(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&hz(e,t)}function hz(e,t){return hz=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},hz(e,t)}function kct(e){var t=Act();return function(){var n=_c(e),i;if(t){var o=_c(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Pct(this,i)}}function Pct(e,t){if(t&&(F_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Bhe(e)}function Bhe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Act(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _c(e){return _c=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_c(e)}var MR="contextMenu",Ict=70;gr.getSingleton().register("afterContextMenuDefaultOptions");gr.getSingleton().register("beforeContextMenuShow");gr.getSingleton().register("afterContextMenuShow");gr.getSingleton().register("afterContextMenuHide");gr.getSingleton().register("afterContextMenuExecute");var jhe=function(e){Rct(r,e);var t=kct(r);function r(n){var i;return xct(this,r),i=t.call(this,n),i.eventManager=new Fi(Bhe(i)),i.commandExecutor=new Xfe(i.hot),i.itemsFactory=null,i.menu=null,i}return Cct(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[MR]}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){var o=this.hot.getSettings()[MR];typeof o.callback=="function"&&this.commandExecutor.setCommonCallback(o.callback),this.menu=new RW(this.hot,{className:"htContextMenu",keepInViewport:!0,container:o.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",function(){return i.onMenuBeforeOpen()}),this.menu.addLocalHook("afterOpen",function(){return i.onMenuAfterOpen()}),this.menu.addLocalHook("afterClose",function(){return i.onMenuAfterClose()}),this.menu.addLocalHook("executeCommand",function(){for(var s,a=arguments.length,h=new Array(a),p=0;p<a;p++)h[p]=arguments[p];return(s=i.executeCommand).call.apply(s,[i].concat(h))}),this.addHook("afterOnCellContextMenu",function(s){return i.onAfterOnCellContextMenu(s)}),kp(_c(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),kp(_c(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),kp(_c(r.prototype),"disablePlugin",this).call(this)}},{key:"open",value:function(i){if(this.menu&&(this.prepareMenuItems(),this.menu.open(),!!this.menu.isOpened())){var o=0,s=0;if(this.hot.rootDocument!==this.menu.container.ownerDocument){var a=this.hot.rootWindow.frameElement,h=a.getBoundingClientRect(),p=h.top,y=h.left;o=p-M1(i.view),s=y-Lv(i.view)}else o=-1*M1(this.menu.hotMenu.rootWindow),s=-1*Lv(this.menu.hotMenu.rootWindow);this.menu.setPosition({top:parseInt(i.pageY,10)+o,left:parseInt(i.pageX,10)+s})}}},{key:"close",value:function(){this.menu&&(this.menu.close(),this.itemsFactory=null)}},{key:"executeCommand",value:function(i){var o;this.itemsFactory===null&&this.prepareMenuItems();for(var s=arguments.length,a=new Array(s>1?s-1:0),h=1;h<s;h++)a[h-1]=arguments[h];(o=this.commandExecutor).execute.apply(o,[i].concat(a))}},{key:"prepareMenuItems",value:function(){var i=this;this.itemsFactory=new ehe(this.hot,r.DEFAULT_ITEMS);var o=this.hot.getSettings()[MR],s={items:this.itemsFactory.getItems(o)};this.hot.runHooks("afterContextMenuDefaultOptions",s),this.itemsFactory.setPredefinedItems(s.items);var a=this.itemsFactory.getItems(o);this.hot.runHooks("beforeContextMenuSetItems",a),this.menu.setMenuItems(a),Fe(a,function(h){return i.commandExecutor.registerCommand(h.key,h)})}},{key:"onAfterOnCellContextMenu",value:function(i){var o=this.hot.getSettings(),s=o.rowHeaders,a=o.colHeaders;function h(y){return y.nodeName==="TD"||y.parentNode.nodeName==="TD"}var p=i.target;this.close(),!Wr(p,"handsontableInput")&&(i.preventDefault(),i.stopPropagation(),!(!(s||a)&&!h(p)&&!(Wr(p,"current")&&Wr(p,"wtBorder")))&&this.open(i))}},{key:"onMenuBeforeOpen",value:function(){this.hot.runHooks("beforeContextMenuShow",this)}},{key:"onMenuAfterOpen",value:function(){this.hot.runHooks("afterContextMenuShow",this)}},{key:"onMenuAfterClose",value:function(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}},{key:"destroy",value:function(){this.close(),this.menu&&this.menu.destroy(),kp(_c(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return MR}},{key:"PLUGIN_PRIORITY",get:function(){return Ict}},{key:"PLUGIN_DEPS",get:function(){return["plugin:AutoColumnSize"]}},{key:"DEFAULT_ITEMS",get:function(){return[xM,CM,hn,kE,PE,hn,SM,IE,hn,EM,_M,hn,AE,hn,Is]}}]),r}(Yn);jhe.SEPARATOR={name:hn};function Mct(e){return{key:"copy",name:function(){return this.getTranslatedPhrase(d4)},callback:function(){e.copyCellsOnly()},disabled:function(){if(this.countRows()===0||this.countCols()===0)return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function $ct(e){return{key:"copy_column_headers_only",name:function(){var r=this.getSelectedRangeLast(),n=r?Math.min(r.getWidth()-1,1):0;return this.getTranslatedPhrase(g4,n)},callback:function(){e.copyColumnHeadersOnly()},disabled:function(){if(!this.hasColHeaders())return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function Dct(e){return{key:"copy_with_column_group_headers",name:function(){var r=this.getSelectedRangeLast(),n=r?Math.min(r.getWidth()-1,1):0;return this.getTranslatedPhrase(m4,n)},callback:function(){e.copyWithAllColumnHeaders()},disabled:function(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function Lct(e){return{key:"copy_with_column_headers",name:function(){var r=this.getSelectedRangeLast(),n=r?Math.min(r.getWidth()-1,1):0;return this.getTranslatedPhrase(p4,n)},callback:function(){e.copyWithColumnHeaders()},disabled:function(){if(!this.hasColHeaders())return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function Nct(e){return{key:"cut",name:function(){return this.getTranslatedPhrase(y4)},callback:function(){e.cut()},disabled:function(){if(this.countRows()===0||this.countCols()===0)return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function eC(e){"@babel/helpers - typeof";return eC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},eC(e)}function Bct(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yQ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Fct(n.key),n)}}function jct(e,t,r){return t&&yQ(e.prototype,t),r&&yQ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Fct(e){var t=zct(e,"string");return eC(t)==="symbol"?t:String(t)}function zct(e,t){if(eC(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(eC(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Hct=function(){function e(){Bct(this,e),this.data={}}return jct(e,[{key:"setData",value:function(r,n){this.data[r]=n}},{key:"getData",value:function(r){return this.data[r]||void 0}}]),e}();function tC(e){"@babel/helpers - typeof";return tC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tC(e)}function vQ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Uct(n.key),n)}}function Vct(e,t,r){return t&&vQ(e.prototype,t),r&&vQ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Uct(e){var t=Wct(e,"string");return tC(t)==="symbol"?t:String(t)}function Wct(e,t){if(tC(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(tC(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Gct(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var Yct=Vct(function e(){Gct(this,e),this.clipboardData=new Hct});function rC(e){"@babel/helpers - typeof";return rC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rC(e)}function Kct(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _Q(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Xct(n.key),n)}}function qct(e,t,r){return t&&_Q(e.prototype,t),r&&_Q(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Xct(e){var t=Zct(e,"string");return rC(t)==="symbol"?t:String(t)}function Zct(e,t){if(rC(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(rC(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var kW=function(){function e(t){Kct(this,e),this.rootDocument=t.defaultView?t:t.ownerDocument,this.mainElement=null,this.eventManager=new Fi(this),this.listenersCount=new WeakSet,this.container=t}return qct(e,[{key:"useSecondaryElement",value:function(){var r=eft(this.container);this.listenersCount.has(r)||(this.listenersCount.add(r),bQ(this.eventManager,r,this)),this.mainElement=r}},{key:"setFocusableElement",value:function(r){this.listenersCount.has(r)||(this.listenersCount.add(r),bQ(this.eventManager,r,this)),this.mainElement=r}},{key:"getFocusableElement",value:function(){return this.mainElement}},{key:"focus",value:function(){this.mainElement.value=" ",gu()||RUe(this.mainElement)}}]),e}();ci(kW,Ya);var $A=new WeakMap;function Jct(e){var t=new kW(e),r=$A.get(e);return r=isNaN(r)?0:r,$A.set(e,r+1),t}function Qct(e){e.eventManager.clear()}var UL=function(t,r){return function(n){return r.runLocalHooks(t,n)}};function bQ(e,t,r){e.addEventListener(t,"copy",UL("copy",r)),e.addEventListener(t,"cut",UL("cut",r)),e.addEventListener(t,"paste",UL("paste",r))}var DA=new WeakMap;function eft(e){var t=DA.get(e);if(t)return t.parentElement||e.appendChild(t),t;var r=e.defaultView?e:e.ownerDocument,n=r.createElement("textarea");return DA.set(e,n),n.setAttribute("data-hot-input",""),n.className="HandsontableCopyPaste",n.tabIndex=-1,n.autocomplete="off",n.wrap="hard",n.value=" ",e.appendChild(n),n}function wQ(e){if(e instanceof kW){var t=$A.get(e.container);if(t=isNaN(t)?0:t,t>0&&(t-=1),Qct(e),t<=0){t=0;var r=DA.get(e.container);r&&r.parentNode&&(r.parentNode.removeChild(r),DA.delete(e.container)),e.mainElement=null}$A.set(e.container,t)}}function nC(e){"@babel/helpers - typeof";return nC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nC(e)}function tft(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function SQ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,nft(n.key),n)}}function rft(e,t,r){return t&&SQ(e.prototype,t),r&&SQ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function nft(e){var t=ift(e,"string");return nC(t)==="symbol"?t:String(t)}function ift(e,t){if(nC(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(nC(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function xQ(e,t){Fhe(e,t),t.add(e)}function fy(e,t,r){Fhe(e,t),t.set(e,r)}function Fhe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $R(e,t,r){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return r}function da(e,t){var r=zhe(e,t,"get");return oft(e,r)}function oft(e,t){return t.get?t.get.call(e):t.value}function hy(e,t,r){var n=zhe(e,t,"set");return aft(e,n,r),r}function zhe(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function aft(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var Gf=new WeakMap,WL=new WeakMap,sS=new WeakMap,dz=new WeakMap,pz=new WeakMap,lS=new WeakMap,DR=new WeakSet,CQ=new WeakSet,sft=function(){function e(t){var r=t.countRows,n=t.countColumns,i=t.rowsLimit,o=t.columnsLimit,s=t.countColumnHeaders;tft(this,e),xQ(this,CQ),xQ(this,DR),fy(this,Gf,{writable:!0,value:void 0}),fy(this,WL,{writable:!0,value:void 0}),fy(this,sS,{writable:!0,value:void 0}),fy(this,dz,{writable:!0,value:void 0}),fy(this,pz,{writable:!0,value:void 0}),fy(this,lS,{writable:!0,value:void 0}),hy(this,WL,r),hy(this,sS,n),hy(this,dz,i),hy(this,pz,o),hy(this,lS,s)}return rft(e,[{key:"setSelectedRange",value:function(r){hy(this,Gf,r)}},{key:"getCellsRange",value:function(){if(da(this,WL).call(this)===0||da(this,sS).call(this)===0)return null;var r=da(this,Gf).getTopStartCorner(),n=r.row,i=r.col,o=da(this,Gf).getBottomEndCorner(),s=o.row,a=o.col,h=$R(this,CQ,lft).call(this,n,s),p=$R(this,DR,GL).call(this,i,a),y=s!==h||a!==p;return{isRangeTrimmed:y,startRow:n,startCol:i,endRow:h,endCol:p}}},{key:"getMostBottomColumnHeadersRange",value:function(){if(da(this,sS).call(this)===0||da(this,lS).call(this)===0)return null;var r=da(this,Gf).getTopStartCorner(),n=r.col,i=da(this,Gf).getBottomEndCorner(),o=i.col,s=$R(this,DR,GL).call(this,n,o),a=o!==s;return{isRangeTrimmed:a,startRow:-1,startCol:n,endRow:-1,endCol:s}}},{key:"getAllColumnHeadersRange",value:function(){if(da(this,sS).call(this)===0||da(this,lS).call(this)===0)return null;var r=da(this,Gf).getTopStartCorner(),n=r.col,i=da(this,Gf).getBottomEndCorner(),o=i.col,s=$R(this,DR,GL).call(this,n,o),a=o!==s;return{isRangeTrimmed:a,startRow:-da(this,lS).call(this),startCol:n,endRow:-1,endCol:s}}}]),e}();function GL(e,t){return Math.min(t,Math.max(e+da(this,pz).call(this)-1,e))}function lft(e,t){return Math.min(t,Math.max(e+da(this,dz).call(this)-1,e))}function Hhe(e){var t=[],r=[];return Fe(e,function(n){var i=Math.min(n.startRow,n.endRow),o=Math.max(n.startRow,n.endRow);Or(i,o,function(h){t.indexOf(h)===-1&&t.push(h)});var s=Math.min(n.startCol,n.endCol),a=Math.max(n.startCol,n.endCol);Or(s,a,function(h){r.indexOf(h)===-1&&r.push(h)})}),{rows:t,columns:r}}function uft(e,t){return dft(e)||hft(e,t)||fft(e,t)||cft()}function cft(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function fft(e,t){if(e){if(typeof e=="string")return EQ(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return EQ(e,t)}}function EQ(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function hft(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],h=!0,p=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;h=!1}else for(;!(h=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);h=!0);}catch(y){p=!0,i=y}finally{try{if(!h&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(p)throw i}}return a}}function dft(e){if(Array.isArray(e))return e}function Sm(e){"@babel/helpers - typeof";return Sm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sm(e)}function pft(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function TQ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Uhe(n.key),n)}}function mft(e,t,r){return t&&TQ(e.prototype,t),r&&TQ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Pp(){return typeof Reflect<"u"&&Reflect.get?Pp=Reflect.get.bind():Pp=function(t,r,n){var i=gft(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Pp.apply(this,arguments)}function gft(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=bc(e),e!==null););return e}function yft(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&mz(e,t)}function mz(e,t){return mz=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},mz(e,t)}function vft(e){var t=bft();return function(){var n=bc(e),i;if(t){var o=bc(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return _ft(this,i)}}function _ft(e,t){if(t&&(Sm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ha(e)}function ha(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function bft(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function bc(e){return bc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},bc(e)}function wft(e,t){Vhe(e,t),t.add(e)}function tp(e,t,r){Vhe(e,t),t.set(e,r)}function Vhe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function dy(e,t,r){return t=Uhe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Uhe(e){var t=Sft(e,"string");return Sm(t)==="symbol"?t:String(t)}function Sft(e,t){if(Sm(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Sm(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function xft(e,t,r){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return r}function Qa(e,t){var r=Whe(e,t,"get");return Cft(e,r)}function Cft(e,t){return t.get?t.get.call(e):t.value}function Xu(e,t,r){var n=Whe(e,t,"set");return Eft(e,n,r),r}function Whe(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function Eft(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}gr.getSingleton().register("afterCopyLimit");gr.getSingleton().register("modifyCopyableRange");gr.getSingleton().register("beforeCut");gr.getSingleton().register("afterCut");gr.getSingleton().register("beforePaste");gr.getSingleton().register("afterPaste");gr.getSingleton().register("beforeCopy");gr.getSingleton().register("afterCopy");var LR="copyPaste",Tft=80,Oft=["fragmentSelection"],OQ=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join(""),YL=new WeakMap,KL=new WeakMap,qL=new WeakMap,py=new WeakMap,NR=new WeakMap,BR=new WeakMap,my=new WeakMap,RQ=new WeakSet,Rft=function(e){yft(r,e);var t=vft(r);function r(){var n;pft(this,r);for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n=t.call.apply(t,[this].concat(o)),wft(ha(n),RQ),dy(ha(n),"columnsLimit",1/0),dy(ha(n),"rowsLimit",1/0),dy(ha(n),"pasteMode","overwrite"),dy(ha(n),"uiContainer",n.hot.rootDocument.body),tp(ha(n),YL,{writable:!0,value:!1}),tp(ha(n),KL,{writable:!0,value:!1}),tp(ha(n),qL,{writable:!0,value:!1}),tp(ha(n),py,{writable:!0,value:"cells-only"}),tp(ha(n),NR,{writable:!0,value:!1}),tp(ha(n),BR,{writable:!0,value:!1}),tp(ha(n),my,{writable:!0,value:new sft({countRows:function(){return n.hot.countRows()},countColumns:function(){return n.hot.countCols()},rowsLimit:function(){return n.rowsLimit},columnsLimit:function(){return n.columnsLimit},countColumnHeaders:function(){return n.hot.view.getColumnHeadersCount()}})}),dy(ha(n),"copyableRanges",[]),dy(ha(n),"focusableElement",void 0),n}return mft(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[LR]}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){var o=this.hot.getSettings(),s=o[LR];if(Sm(s)==="object"){var a,h;this.pasteMode=(a=s.pasteMode)!==null&&a!==void 0?a:this.pasteMode,this.rowsLimit=isNaN(s.rowsLimit)?this.rowsLimit:s.rowsLimit,this.columnsLimit=isNaN(s.columnsLimit)?this.columnsLimit:s.columnsLimit,Xu(this,YL,!!s.copyColumnHeaders),Xu(this,KL,!!s.copyColumnGroupHeaders),Xu(this,qL,!!s.copyColumnHeadersOnly),this.uiContainer=(h=s.uiContainer)!==null&&h!==void 0?h:this.uiContainer}this.addHook("afterContextMenuDefaultOptions",function(p){return i.onAfterContextMenuDefaultOptions(p)}),this.addHook("afterOnCellMouseUp",function(){return i.onAfterOnCellMouseUp()}),this.addHook("afterSelectionEnd",function(){return i.onAfterSelectionEnd()}),this.addHook("beforeKeyDown",function(){return i.onBeforeKeyDown()}),this.focusableElement=Jct(this.uiContainer),this.focusableElement.addLocalHook("copy",function(p){return i.onCopy(p)}).addLocalHook("cut",function(p){return i.onCut(p)}).addLocalHook("paste",function(p){return i.onPaste(p)}),Pp(bc(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.getOrCreateFocusableElement(),Pp(bc(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.focusableElement&&wQ(this.focusableElement),Pp(bc(r.prototype),"disablePlugin",this).call(this)}},{key:"copy",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";Xu(this,py,i),Xu(this,NR,!0),this.getOrCreateFocusableElement(),this.focusableElement.focus(),this.hot.rootDocument.execCommand("copy")}},{key:"copyCellsOnly",value:function(){this.copy("cells-only")}},{key:"copyColumnHeadersOnly",value:function(){this.copy("column-headers-only")}},{key:"copyWithAllColumnHeaders",value:function(){this.copy("with-column-group-headers")}},{key:"copyWithColumnHeaders",value:function(){this.copy("with-column-headers")}},{key:"cut",value:function(){Xu(this,BR,!0),this.getOrCreateFocusableElement(),this.focusableElement.focus(),this.hot.rootDocument.execCommand("cut")}},{key:"getRangedCopyableData",value:function(i){return QS(this.getRangedData(i))}},{key:"getRangedData",value:function(i){var o=this,s=[],a=Hhe(i),h=a.rows,p=a.columns;return Fe(h,function(y){var S=[];Fe(p,function(E){y<0?S.push(o.hot.getColHeader(E,y)):S.push(o.hot.getCopyableData(y,E))}),s.push(S)}),s}},{key:"paste",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:i;if(!(!i&&!o)){var s=new Yct;i&&s.clipboardData.setData("text/plain",i),o&&s.clipboardData.setData("text/html",o),this.getOrCreateFocusableElement(),this.onPaste(s)}}},{key:"setCopyableText",value:function(){var i=this.hot.getSelectedRangeLast();if(i){Qa(this,my).setSelectedRange(i);var o=new Map([["headers",null],["cells",null]]);Qa(this,py)==="column-headers-only"?o.set("headers",Qa(this,my).getMostBottomColumnHeadersRange()):(Qa(this,py)==="with-column-headers"?o.set("headers",Qa(this,my).getMostBottomColumnHeadersRange()):Qa(this,py)==="with-column-group-headers"&&o.set("headers",Qa(this,my).getAllColumnHeadersRange()),o.set("cells",Qa(this,my).getCellsRange())),this.copyableRanges=Array.from(o.values()).filter(function(S){return S!==null}).map(function(S){var E=S.startRow,O=S.startCol,A=S.endRow,$=S.endCol;return{startRow:E,startCol:O,endRow:A,endCol:$}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);var s=o.get("cells");if(s!==null&&s.isRangeTrimmed){var a=s.startRow,h=s.startCol,p=s.endRow,y=s.endCol;this.hot.runHooks("afterCopyLimit",p-a+1,y-h+1,this.rowsLimit,this.columnsLimit)}}}},{key:"getOrCreateFocusableElement",value:function(){var i,o=(i=this.hot.getActiveEditor())===null||i===void 0?void 0:i.TEXTAREA;o?this.focusableElement.setFocusableElement(o):this.focusableElement.useSecondaryElement()}},{key:"isEditorOpened",value:function(){var i;return(i=this.hot.getActiveEditor())===null||i===void 0?void 0:i.isOpened()}},{key:"populateValues",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.getSelectedRangeLast();if(i.length){for(var s=i.length,a=i[0].length,h=[],p=o.getTopStartCorner(),y=p.row,S=p.col,E=o.getBottomEndCorner(),O=E.row,A=E.col,$=y,B=S,j=y,z=S;h.length<s||$<=O;){var W=this.hot.getCellMeta($,S),Q=W.skipRowOnPaste,q=W.visualRow;if($=q+1,Q!==!0){j=q,B=S;for(var Se=[],Ie=h.length%s;Se.length<a||B<=A;){var He=this.hot.getCellMeta(y,B),Le=He.skipColumnOnPaste,ze=He.visualCol;if(B=ze+1,Le!==!0){z=ze;var ct=Se.length%a;Se.push(i[Ie][ct])}}h.push(Se)}}return this.hot.populateFromArray(y,S,h,void 0,void 0,"CopyPaste.paste",this.pasteMode),[y,S,j,z]}}},{key:"onCopy",value:function(i){if(!(!this.hot.isListening()&&!Qa(this,NR)||this.isEditorOpened())){this.setCopyableText(),Xu(this,NR,!1);var o=this.getRangedData(this.copyableRanges),s=xft(this,RQ,kft).call(this,this.copyableRanges),a=!!this.hot.runHooks("beforeCopy",o,this.copyableRanges,s);if(a){var h=QS(o);if(i&&i.clipboardData){var p=cJ(o,this.hot.rootDocument);i.clipboardData.setData("text/plain",h),i.clipboardData.setData("text/html",[OQ,p].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",h);this.hot.runHooks("afterCopy",o,this.copyableRanges,s)}Xu(this,py,"cells-only"),i.preventDefault()}}},{key:"onCut",value:function(i){if(!(!this.hot.isListening()&&!Qa(this,BR)||this.isEditorOpened())){this.setCopyableText(),Xu(this,BR,!1);var o=this.getRangedData(this.copyableRanges),s=!!this.hot.runHooks("beforeCut",o,this.copyableRanges);if(s){var a=QS(o);if(i&&i.clipboardData){var h=cJ(o,this.hot.rootDocument);i.clipboardData.setData("text/plain",a),i.clipboardData.setData("text/html",[OQ,h].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",a);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",o,this.copyableRanges)}i.preventDefault()}}},{key:"onPaste",value:function(i){if(!(!this.hot.isListening()||this.isEditorOpened())){i&&i.preventDefault&&i.preventDefault();var o;if(i&&typeof i.clipboardData<"u"){var s=vU(i.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});if(s&&/(<table)|(<TABLE)/g.test(s)){var a=cat(s,this.hot.rootDocument);o=a.data}else o=i.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(o=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof o=="string"&&(o=Ult(o)),!(o&&o.length===0)&&this.hot.runHooks("beforePaste",o,this.copyableRanges)!==!1){var h=this.populateValues(o),p=uft(h,4),y=p[0],S=p[1],E=p[2],O=p[3];this.hot.selectCell(y,S,Math.min(this.hot.countRows()-1,E),Math.min(this.hot.countCols()-1,O)),this.hot.runHooks("afterPaste",o,this.copyableRanges)}}}},{key:"onAfterContextMenuDefaultOptions",value:function(i){i.items.push({name:"---------"},Mct(this)),Qa(this,YL)&&i.items.push(Lct(this)),Qa(this,KL)&&i.items.push(Dct(this)),Qa(this,qL)&&i.items.push($ct(this)),i.items.push(Nct(this))}},{key:"onAfterOnCellMouseUp",value:function(){!this.hot.isListening()||this.isEditorOpened()||this.hot.getSettings().fragmentSelection||(this.getOrCreateFocusableElement(),this.focusableElement.focus())}},{key:"onAfterSelectionEnd",value:function(){this.isEditorOpened()||(this.getOrCreateFocusableElement(),!(this.hot.getSettings().fragmentSelection&&this.focusableElement.getFocusableElement()!==this.hot.rootDocument.activeElement&&CUe())&&(this.setCopyableText(),this.focusableElement.focus()))}},{key:"onBeforeKeyDown",value:function(){if(!(!this.hot.isListening()||this.isEditorOpened())){var i=this.hot.rootDocument.activeElement,o=this.hot.getActiveEditor();!o||i!==this.focusableElement.getFocusableElement()&&i!==o.select||(this.getOrCreateFocusableElement(),this.focusableElement.focus())}}},{key:"destroy",value:function(){this.focusableElement&&(wQ(this.focusableElement),this.focusableElement=null),Pp(bc(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return LR}},{key:"SETTING_KEYS",get:function(){return[LR].concat(Oft)}},{key:"PLUGIN_PRIORITY",get:function(){return Tft}}]),r}(Yn);function kft(e){for(var t=Hhe(e),r=t.rows,n=0,i=0;i<r.length&&!(r[i]>=0);i++)n+=1;return{columnHeadersCount:n}}function Ghe(e,t){return"border_row".concat(e,"col").concat(t)}function TS(){return{width:1,color:"#000"}}function wc(){return{hide:!0}}function Pft(){return{width:1,color:"#000",cornerVisible:!1}}function XL(e){if(pr(e.start)||pr(e.left)){var t;e.start=(t=e.start)!==null&&t!==void 0?t:e.left}if(pr(e.end)||pr(e.right)){var r;e.end=(r=e.end)!==null&&r!==void 0?r:e.right}return delete e.left,delete e.right,e}function uS(e){return pr(e.start)&&(e.left=e.start),pr(e.end)&&(e.right=e.end),e}function ZL(e,t){return{id:Ghe(e,t),border:Pft(),row:e,col:t,top:wc(),bottom:wc(),start:wc(),end:wc()}}function Aft(e,t){return Gi(t,"border")&&t.border&&(e.border=t.border),Gi(t,"top")&&pr(t.top)&&(t.top?(pn(t.top)||(t.top=TS()),e.top=t.top):(t.top=wc(),e.top=t.top)),Gi(t,"bottom")&&pr(t.bottom)&&(t.bottom?(pn(t.bottom)||(t.bottom=TS()),e.bottom=t.bottom):(t.bottom=wc(),e.bottom=t.bottom)),Gi(t,"start")&&pr(t.start)&&(t.start?(pn(t.start)||(t.start=TS()),e.start=t.start):(t.start=wc(),e.start=t.start)),Gi(t,"end")&&pr(t.end)&&(t.end?(pn(t.end)||(t.end=TS()),e.end=t.end):(t.end=wc(),e.end=t.end)),e}function Jc(e,t){var r=!1;return Fe(e.getSelectedRange(),function(n){n.forAll(function(i,o){if(!(i<0||o<0)){var s=e.getCellMeta(i,o).borders;if(s)if(t){if(!Gi(s[t],"hide")||s[t].hide===!1)return r=!0,!1}else return r=!0,!1}})}),r}function PM(e){return'<span class="selected">'.concat(String.fromCharCode(10003),"</span>").concat(e)}function Ift(e){return e.some(function(t){return pr(t.left)||pr(t.right)})}function Mft(e){return e.some(function(t){return pr(t.start)||pr(t.end)})}var $ft=new Map([["left","start"],["right","end"]]);function Dft(e){var t;return(t=$ft.get(e))!==null&&t!==void 0?t:e}function Lft(e){return{key:"borders:bottom",name:function(){var r=this.getTranslatedPhrase(N4),n=Jc(this,"bottom");return n&&(r=PM(r)),r},callback:function(r,n){var i=Jc(this,"bottom");e.prepareBorder(n,"bottom",i)}}}function Nft(e){var t=e.hot.isRtl()?"end":"start";return{key:"borders:left",name:function(){var n=this.getTranslatedPhrase(B4),i=Jc(this,t);return i&&(n=PM(n)),n},callback:function(n,i){var o=Jc(this,t);e.prepareBorder(i,t,o)}}}function Bft(e){return{key:"borders:no_borders",name:function(){return this.getTranslatedPhrase(j4)},callback:function(r,n){e.prepareBorder(n,"noBorders")},disabled:function(){return!Jc(this)}}}function jft(e){var t=e.hot.isRtl()?"start":"end";return{key:"borders:right",name:function(){var n=this.getTranslatedPhrase(L4),i=Jc(this,t);return i&&(n=PM(n)),n},callback:function(n,i){var o=Jc(this,t);e.prepareBorder(i,t,o)}}}function Fft(e){return{key:"borders:top",name:function(){var r=this.getTranslatedPhrase(D4),n=Jc(this,"top");return n&&(r=PM(r)),r},callback:function(r,n){var i=Jc(this,"top");e.prepareBorder(n,"top",i)}}}function z_(e){"@babel/helpers - typeof";return z_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},z_(e)}function kQ(e,t){return Uft(e)||Vft(e,t)||Hft(e,t)||zft()}function zft(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Hft(e,t){if(e){if(typeof e=="string")return PQ(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return PQ(e,t)}}function PQ(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Vft(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],h=!0,p=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;h=!1}else for(;!(h=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);h=!0);}catch(y){p=!0,i=y}finally{try{if(!h&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(p)throw i}}return a}}function Uft(e){if(Array.isArray(e))return e}function Wft(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function AQ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Khe(n.key),n)}}function Gft(e,t,r){return t&&AQ(e.prototype,t),r&&AQ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ap(){return typeof Reflect<"u"&&Reflect.get?Ap=Reflect.get.bind():Ap=function(t,r,n){var i=Yft(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Ap.apply(this,arguments)}function Yft(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Sc(e),e!==null););return e}function Kft(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&gz(e,t)}function gz(e,t){return gz=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},gz(e,t)}function qft(e){var t=Zft();return function(){var n=Sc(e),i;if(t){var o=Sc(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Xft(this,i)}}function Xft(e,t){if(t&&(z_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Yhe(e)}function Yhe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Zft(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Sc(e){return Sc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Sc(e)}function Jft(e,t,r){return t=Khe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Khe(e){var t=Qft(e,"string");return z_(t)==="symbol"?t:String(t)}function Qft(e,t){if(z_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(z_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var jR="customBorders",eht=90,tht=function(e){Kft(r,e);var t=qft(r);function r(){var n;Wft(this,r);for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n=t.call.apply(t,[this].concat(o)),Jft(Yhe(n),"savedBorders",[]),n}return Gft(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[jR]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.addHook("afterContextMenuDefaultOptions",function(o){return i.onAfterContextMenuDefaultOptions(o)}),this.addHook("init",function(){return i.onAfterInit()}),Ap(Sc(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.hideBorders(),Ap(Sc(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),Ap(Sc(r.prototype),"updatePlugin",this).call(this)}},{key:"setBorders",value:function(i,o){var s=this,a=["top","bottom","start","end"],h=null;o&&(this.checkSettingsCohesion([o]),a=Object.keys(o),h=XL(o));var p=L_(i),y=Cx(p);Fe(i,function(S){for(var E=y(S),O=kQ(E,4),A=O[0],$=O[1],B=O[2],j=O[3],z=function(q){for(var Se=function(Le){Fe(a,function(ze){s.prepareBorderFromCustomAdded(q,Le,h,Dft(ze))})},Ie=$;Ie<=j;Ie+=1)Se(Ie)},W=A;W<=B;W+=1)z(W)}),this.hot.view.render()}},{key:"getBorders",value:function(i){var o=this;if(!Array.isArray(i))return this.savedBorders;var s=L_(i),a=Cx(s),h=[];return Fe(i,function(p){for(var y=a(p),S=kQ(y,4),E=S[0],O=S[1],A=S[2],$=S[3],B=function(W){for(var Q=function(Ie){Fe(o.savedBorders,function(He){He.row===W&&He.col===Ie&&h.push(uS(He))})},q=O;q<=$;q+=1)Q(q)},j=E;j<=A;j+=1)B(j)}),h}},{key:"clearBorders",value:function(i){var o=this;i?this.setBorders(i):(Fe(this.savedBorders,function(s){o.clearBordersFromSelectionSettings(s.id),o.clearNullCellRange(),o.hot.removeCellMeta(s.row,s.col,"borders")}),this.savedBorders.length=0)}},{key:"insertBorderIntoSettings",value:function(i,o){var s=this.checkSavedBorders(i);s||this.savedBorders.push(i);var a=this.hot._createCellRange(this.hot._createCellCoords(i.row,i.col)),h=this.checkCustomSelections(i,a,o);h||this.hot.selection.highlight.addCustomSelection({border:i,visualCellRange:a})}},{key:"prepareBorderFromCustomAdded",value:function(i,o,s,a){var h=this.hot.countRows(),p=this.hot.countCols();if(!(i>=h||o>=p)){var y=ZL(i,o);s&&(y=Aft(y,s),Fe(this.hot.selection.highlight.customSelections,function(S){if(y.id===S.settings.id)return Object.assign(S.settings,s),y.id=S.settings.id,y.top=S.settings.top,y.bottom=S.settings.bottom,y.start=S.settings.start,y.end=S.settings.end,!1})),this.hot.setCellMeta(i,o,"borders",uS(y)),this.insertBorderIntoSettings(y,a)}}},{key:"prepareBorderFromCustomAddedRange",value:function(i,o){var s=this,a=Math.min(i.to.row,this.hot.countRows()-1),h=Math.min(i.to.col,this.hot.countCols()-1);Or(i.from.row,a,function(p){Or(i.from.col,h,function(y){var S=ZL(p,y),E=0;p===i.from.row&&Gi(o,"top")&&(E+=1,S.top=o.top),p===i.to.row&&Gi(o,"bottom")&&(E+=1,S.bottom=o.bottom),y===i.from.col&&Gi(o,"start")&&(E+=1,S.start=o.start),y===i.to.col&&Gi(o,"end")&&(E+=1,S.end=o.end),E>0&&(s.hot.setCellMeta(p,y,"borders",uS(S)),s.insertBorderIntoSettings(S))})})}},{key:"removeAllBorders",value:function(i,o){var s=Ghe(i,o);this.spliceBorder(s),this.clearBordersFromSelectionSettings(s),this.clearNullCellRange(),this.hot.removeCellMeta(i,o,"borders")}},{key:"setBorder",value:function(i,o,s,a){var h=this.hot.getCellMeta(i,o).borders;if(!h||h.border===void 0?h=ZL(i,o):h=XL(h),a){h[s]=wc();var p=this.countHide(h);if(p===4)this.removeAllBorders(i,o);else{var y=this.checkCustomSelectionsFromContextMenu(h,s,a);y||this.insertBorderIntoSettings(h),this.hot.setCellMeta(i,o,"borders",uS(h))}}else{h[s]=TS();var S=this.checkCustomSelectionsFromContextMenu(h,s,a);S||this.insertBorderIntoSettings(h),this.hot.setCellMeta(i,o,"borders",uS(h))}}},{key:"prepareBorder",value:function(i,o,s){var a=this;Fe(i,function(h){var p=h.start,y=h.end;if(p.row===y.row&&p.col===y.col)o==="noBorders"?a.removeAllBorders(p.row,p.col):a.setBorder(p.row,p.col,o,s);else switch(o){case"noBorders":Or(p.col,y.col,function(S){Or(p.row,y.row,function(E){a.removeAllBorders(E,S)})});break;case"top":Or(p.col,y.col,function(S){a.setBorder(p.row,S,o,s)});break;case"bottom":Or(p.col,y.col,function(S){a.setBorder(y.row,S,o,s)});break;case"start":Or(p.row,y.row,function(S){a.setBorder(S,p.col,o,s)});break;case"end":Or(p.row,y.row,function(S){a.setBorder(S,y.col,o,s)});break}})}},{key:"createCustomBorders",value:function(i){var o=this;Fe(i,function(s){var a=XL(s);s.range?o.prepareBorderFromCustomAddedRange(s.range,a):o.prepareBorderFromCustomAdded(s.row,s.col,a)})}},{key:"countHide",value:function(i){var o=i.top,s=i.bottom,a=i.start,h=i.end,p=[o,s,a,h];return oa(p,function(y,S){var E=y;return S&&S.hide&&(E+=1),E},0)}},{key:"clearBordersFromSelectionSettings",value:function(i){var o=dn(this.hot.selection.highlight.customSelections,function(s){return s.settings.id}).indexOf(i);o>-1&&this.hot.selection.highlight.customSelections[o].clear()}},{key:"clearNullCellRange",value:function(){var i=this;Fe(this.hot.selection.highlight.customSelections,function(o,s){if(o.cellRange===null)return i.hot.selection.highlight.customSelections[s].destroy(),i.hot.selection.highlight.customSelections.splice(s,1),!1})}},{key:"hideBorders",value:function(){var i=this;Fe(this.savedBorders,function(o){i.clearBordersFromSelectionSettings(o.id),i.clearNullCellRange()})}},{key:"spliceBorder",value:function(i){var o=dn(this.savedBorders,function(s){return s.id}).indexOf(i);o>-1&&this.savedBorders.splice(o,1)}},{key:"checkSavedBorders",value:function(i){var o=this,s=!1,a=this.countHide(i);return a===4?(this.spliceBorder(i.id),s=!0):Fe(this.savedBorders,function(h,p){if(i.id===h.id)return o.savedBorders[p]=i,s=!0,!1}),s}},{key:"checkCustomSelectionsFromContextMenu",value:function(i,o,s){var a=!1;return Fe(this.hot.selection.highlight.customSelections,function(h){if(i.id===h.settings.id)return mn(h.instanceBorders,function(p){p.toggleHiddenClass(o,s)}),a=!0,!1}),a}},{key:"checkCustomSelections",value:function(i,o,s){var a=this.countHide(i),h=!1;return a===4?(this.removeAllBorders(i.row,i.col),h=!0):Fe(this.hot.selection.highlight.customSelections,function(p){if(i.id===p.settings.id)return p.visualCellRange=o,p.commit(),s&&mn(p.instanceBorders,function(y){y.changeBorderStyle(s,i)}),h=!0,!1}),h}},{key:"changeBorderSettings",value:function(){var i=this.hot.getSettings()[jR];if(Array.isArray(i)){var o=ba(i);this.checkSettingsCohesion(o),o.length||(this.savedBorders=o),this.createCustomBorders(o)}else i!==void 0&&this.createCustomBorders(this.savedBorders)}},{key:"checkSettingsCohesion",value:function(i){var o=Ift(i),s=Mft(i);if(o&&s)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&o)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}},{key:"onAfterContextMenuDefaultOptions",value:function(i){this.hot.getSettings()[jR]&&i.items.push({name:"---------"},{key:"borders",name:function(){return this.getTranslatedPhrase($4)},disabled:function(){return this.selection.isSelectedByCorner()},submenu:{items:[Fft(this),jft(this),Lft(this),Nft(this),Bft(this)]}})}},{key:"onAfterInit",value:function(){this.changeBorderSettings()}},{key:"destroy",value:function(){Ap(Sc(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return jR}},{key:"PLUGIN_PRIORITY",get:function(){return eht}}]),r}(Yn);function H_(e){"@babel/helpers - typeof";return H_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},H_(e)}function rht(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function IQ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,iht(n.key),n)}}function nht(e,t,r){return t&&IQ(e.prototype,t),r&&IQ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function iht(e){var t=oht(e,"string");return H_(t)==="symbol"?t:String(t)}function oht(e,t){if(H_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(H_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ip(){return typeof Reflect<"u"&&Reflect.get?Ip=Reflect.get.bind():Ip=function(t,r,n){var i=aht(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Ip.apply(this,arguments)}function aht(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=xc(e),e!==null););return e}function sht(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&yz(e,t)}function yz(e,t){return yz=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},yz(e,t)}function lht(e){var t=cht();return function(){var n=xc(e),i;if(t){var o=xc(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return uht(this,i)}}function uht(e,t){if(t&&(H_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return qhe(e)}function qhe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function cht(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function xc(e){return xc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},xc(e)}var MQ="dragToScroll",fht=100,hht=function(e){sht(r,e);var t=lht(r);function r(n){var i;return rht(this,r),i=t.call(this,n),i.eventManager=new Fi(qhe(i)),i.boundaries=null,i.callback=null,i.listening=!1,i}return nht(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[MQ]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.addHook("afterOnCellMouseDown",function(o){return i.setupListening(o)}),this.addHook("afterOnCellCornerMouseDown",function(o){return i.setupListening(o)}),this.registerEvents(),Ip(xc(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Ip(xc(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.unregisterEvents(),Ip(xc(r.prototype),"disablePlugin",this).call(this)}},{key:"setBoundaries",value:function(i){this.boundaries=i}},{key:"setCallback",value:function(i){this.callback=i}},{key:"check",value:function(i,o){var s=0,a=0;o<this.boundaries.top?a=o-this.boundaries.top:o>this.boundaries.bottom&&(a=o-this.boundaries.bottom),i<this.boundaries.left?s=i-this.boundaries.left:i>this.boundaries.right&&(s=i-this.boundaries.right),this.callback(s,a)}},{key:"listen",value:function(){this.listening=!0}},{key:"unlisten",value:function(){this.listening=!1}},{key:"isListening",value:function(){return this.listening}},{key:"registerEvents",value:function(){for(var i=this,o=this.hot.rootWindow,s=o;s;)this.eventManager.addEventListener(s.document,"contextmenu",function(){return i.unlisten()}),this.eventManager.addEventListener(s.document,"mouseup",function(){return i.unlisten()}),this.eventManager.addEventListener(s.document,"mousemove",function(a){return i.onMouseMove(a)}),s=YP(s)}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"setupListening",value:function(i){if(!cm(i)){var o=this.hot.view._wt.wtTable.holder;o!==this.hot.rootWindow&&(this.setBoundaries(o.getBoundingClientRect()),this.setCallback(function(s,a){s<0?o.scrollLeft-=50:s>0&&(o.scrollLeft+=50),a<0?o.scrollTop-=20:a>0&&(o.scrollTop+=20)}),this.listen())}}},{key:"onMouseMove",value:function(i){this.isListening()&&this.check(i.clientX,i.clientY)}},{key:"destroy",value:function(){Ip(xc(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return MQ}},{key:"PLUGIN_PRIORITY",get:function(){return fht}}]),r}(Yn);function V_(e){"@babel/helpers - typeof";return V_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},V_(e)}function dht(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $Q(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,mht(n.key),n)}}function pht(e,t,r){return t&&$Q(e.prototype,t),r&&$Q(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function mht(e){var t=ght(e,"string");return V_(t)==="symbol"?t:String(t)}function ght(e,t){if(V_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(V_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Mp(){return typeof Reflect<"u"&&Reflect.get?Mp=Reflect.get.bind():Mp=function(t,r,n){var i=yht(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Mp.apply(this,arguments)}function yht(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Cc(e),e!==null););return e}function vht(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&vz(e,t)}function vz(e,t){return vz=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},vz(e,t)}function _ht(e){var t=wht();return function(){var n=Cc(e),i;if(t){var o=Cc(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return bht(this,i)}}function bht(e,t){if(t&&(V_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Xhe(e)}function Xhe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function wht(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Cc(e){return Cc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Cc(e)}gr.getSingleton().register("afterDropdownMenuDefaultOptions");gr.getSingleton().register("beforeDropdownMenuShow");gr.getSingleton().register("afterDropdownMenuShow");gr.getSingleton().register("afterDropdownMenuHide");gr.getSingleton().register("afterDropdownMenuExecute");var JL="dropdownMenu",Sht=230,QL="changeType",Zhe=function(e){vht(r,e);var t=_ht(r);function r(n){var i;return dht(this,r),i=t.call(this,n),i.eventManager=new Fi(Xhe(i)),i.commandExecutor=new Xfe(i.hot),i.itemsFactory=null,i.menu=null,i.hot.addHook("afterGetColHeader",function(o,s){return i.onAfterGetColHeader(o,s)}),i}return pht(r,[{key:"isEnabled",value:function(){return this.hot.getSettings()[JL]}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){this.itemsFactory=new ehe(this.hot,r.DEFAULT_ITEMS);var o=this.hot.getSettings()[JL],s={items:this.itemsFactory.getItems(o)};this.registerEvents(),typeof o.callback=="function"&&this.commandExecutor.setCommonCallback(o.callback),Mp(Cc(r.prototype),"enablePlugin",this).call(this),this.callOnPluginsReady(function(){i.hot.runHooks("afterDropdownMenuDefaultOptions",s),i.itemsFactory.setPredefinedItems(s.items);var a=i.itemsFactory.getItems(o);i.menu&&i.menu.destroy(),i.menu=new RW(i.hot,{className:"htDropdownMenu",keepInViewport:!0,container:o.uiContainer||i.hot.rootDocument.body}),i.hot.runHooks("beforeDropdownMenuSetItems",a),i.menu.setMenuItems(a),i.menu.addLocalHook("beforeOpen",function(){return i.onMenuBeforeOpen()}),i.menu.addLocalHook("afterOpen",function(){return i.onMenuAfterOpen()}),i.menu.addLocalHook("afterClose",function(){return i.onMenuAfterClose()}),i.menu.addLocalHook("executeCommand",function(){for(var h,p=arguments.length,y=new Array(p),S=0;S<p;S++)y[S]=arguments[S];return(h=i.executeCommand).call.apply(h,[i].concat(y))}),Fe(a,function(h){return i.commandExecutor.registerCommand(h.key,h)})})}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Mp(Cc(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.close(),this.menu&&this.menu.destroy(),Mp(Cc(r.prototype),"disablePlugin",this).call(this)}},{key:"registerEvents",value:function(){var i=this;this.eventManager.addEventListener(this.hot.rootElement,"click",function(o){return i.onTableClick(o)})}},{key:"open",value:function(i){this.menu&&(this.menu.open(),i.width&&this.menu.setOffset("left",i.width),this.menu.setPosition(i))}},{key:"close",value:function(){this.menu&&this.menu.close()}},{key:"executeCommand",value:function(i){for(var o,s=arguments.length,a=new Array(s>1?s-1:0),h=1;h<s;h++)a[h-1]=arguments[h];(o=this.commandExecutor).execute.apply(o,[i].concat(a))}},{key:"setListening",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.menu.isOpened()&&(i?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}},{key:"onTableClick",value:function(i){if(i.stopPropagation(),Wr(i.target,QL)&&!this.menu.isOpened()){var o=0,s=0;if(this.hot.rootDocument!==this.menu.container.ownerDocument){var a=this.hot.rootWindow.frameElement,h=a.getBoundingClientRect(),p=h.top,y=h.left;o=p,s=y}var S=i.target.getBoundingClientRect();this.open({left:S.left+s,top:S.top+i.target.offsetHeight+3+o,width:S.width,height:S.height})}}},{key:"onAfterGetColHeader",value:function(i,o){var s=o.parentNode;if(s){var a=s.parentNode.childNodes,h=Array.prototype.indexOf.call(a,s);if(!(i<0||h!==a.length-1)){var p=o.querySelector(".".concat(QL));if(!(this.enabled&&p)){if(!this.enabled){p&&p.parentNode.removeChild(p);return}var y=this.hot.rootDocument.createElement("button");y.className=QL,y.type="button",y.onclick=function(){return!1},o.firstChild.insertBefore(y,o.firstChild.firstChild)}}}}},{key:"onMenuBeforeOpen",value:function(){this.hot.runHooks("beforeDropdownMenuShow",this)}},{key:"onMenuAfterOpen",value:function(){this.hot.runHooks("afterDropdownMenuShow",this)}},{key:"onMenuAfterClose",value:function(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}},{key:"destroy",value:function(){this.close(),this.menu&&this.menu.destroy(),Mp(Cc(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return JL}},{key:"PLUGIN_PRIORITY",get:function(){return Sht}},{key:"PLUGIN_DEPS",get:function(){return["plugin:AutoColumnSize"]}},{key:"DEFAULT_ITEMS",get:function(){return[kE,PE,hn,IE,hn,vM,hn,AE,hn,Is]}}]),r}(Yn);Zhe.SEPARATOR={name:hn};function iC(e){"@babel/helpers - typeof";return iC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},iC(e)}function xht(e,t){return Oht(e)||Tht(e,t)||Eht(e,t)||Cht()}function Cht(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Eht(e,t){if(e){if(typeof e=="string")return DQ(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return DQ(e,t)}}function DQ(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Tht(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],h=!0,p=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;h=!1}else for(;!(h=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);h=!0);}catch(y){p=!0,i=y}finally{try{if(!h&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(p)throw i}}return a}}function Oht(e){if(Array.isArray(e))return e}function Rht(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function LQ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Pht(n.key),n)}}function kht(e,t,r){return t&&LQ(e.prototype,t),r&&LQ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Pht(e){var t=Aht(e,"string");return iC(t)==="symbol"?t:String(t)}function Aht(e,t){if(iC(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(iC(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Iht=function(){function e(t){Rht(this,e),this.hot=t,this.options={}}return kht(e,[{key:"setOptions",value:function(r){this.options=r}},{key:"getData",value:function(){var r=this,n=this._getDataRange(),i=n.startRow,o=n.startCol,s=n.endRow,a=n.endCol,h=this.options,p=[];return Or(i,s,function(y){var S=[];!h.exportHiddenRows&&r._isHiddenRow(y)||(Or(o,a,function(E){!h.exportHiddenColumns&&r._isHiddenColumn(E)||S.push(r.hot.getDataAtCell(y,E))}),p.push(S))}),p}},{key:"getRowHeaders",value:function(){var r=this,n=[];if(this.options.rowHeaders){var i=this._getDataRange(),o=i.startRow,s=i.endRow,a=this.hot.getRowHeader();Or(o,s,function(h){!r.options.exportHiddenRows&&r._isHiddenRow(h)||n.push(a[h])})}return n}},{key:"getColumnHeaders",value:function(){var r=this,n=[];if(this.options.columnHeaders){var i=this._getDataRange(),o=i.startCol,s=i.endCol,a=this.hot.getColHeader();Or(o,s,function(h){!r.options.exportHiddenColumns&&r._isHiddenColumn(h)||n.push(a[h])})}return n}},{key:"_getDataRange",value:function(){var r=this.hot.countCols()-1,n=this.hot.countRows()-1,i=xht(this.options.range,4),o=i[0],s=o===void 0?0:o,a=i[1],h=a===void 0?0:a,p=i[2],y=p===void 0?n:p,S=i[3],E=S===void 0?r:S;return s=Math.max(s,0),h=Math.max(h,0),y=Math.min(y,n),E=Math.min(E,r),{startRow:s,startCol:h,endRow:y,endCol:E}}},{key:"_isHiddenRow",value:function(r){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(r))}},{key:"_isHiddenColumn",value:function(r){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(r))}}]),e}();const Mht=Iht;function oC(e){"@babel/helpers - typeof";return oC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},oC(e)}function $ht(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function NQ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Lht(n.key),n)}}function Dht(e,t,r){return t&&NQ(e.prototype,t),r&&NQ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Lht(e){var t=Nht(e,"string");return oC(t)==="symbol"?t:String(t)}function Nht(e,t){if(oC(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(oC(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Bht=function(){function e(t,r){$ht(this,e),this.dataProvider=t,this.options=this._mergeOptions(r),this.dataProvider.setOptions(this.options)}return Dht(e,[{key:"_mergeOptions",value:function(r){var n=za(this.constructor.DEFAULT_OPTIONS),i=new Date;return n=lo(za(e.DEFAULT_OPTIONS),n),n=lo(n,r),n.filename=Yue(n.filename,{YYYY:i.getFullYear(),MM:"".concat(i.getMonth()+1).padStart(2,"0"),DD:"".concat(i.getDate()).padStart(2,"0")}),n}}],[{key:"DEFAULT_OPTIONS",get:function(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}}]),e}();const jht=Bht;function U_(e){"@babel/helpers - typeof";return U_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},U_(e)}function Fht(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function BQ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Hht(n.key),n)}}function zht(e,t,r){return t&&BQ(e.prototype,t),r&&BQ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Hht(e){var t=Vht(e,"string");return U_(t)==="symbol"?t:String(t)}function Vht(e,t){if(U_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(U_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Uht(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_z(e,t)}function _z(e,t){return _z=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},_z(e,t)}function Wht(e){var t=Kht();return function(){var n=LA(e),i;if(t){var o=LA(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Ght(this,i)}}function Ght(e,t){if(t&&(U_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Yht(e)}function Yht(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Kht(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function LA(e){return LA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},LA(e)}var qht=String.fromCharCode(13),Xht=String.fromCharCode(34),Zht=String.fromCharCode(10),Jht=function(e){Uht(r,e);var t=Wht(r);function r(){return Fht(this,r),t.apply(this,arguments)}return zht(r,[{key:"export",value:function(){var i=this,o=this.options,s=this.dataProvider.getData(),a=this.dataProvider.getColumnHeaders(),h=a.length>0,p=this.dataProvider.getRowHeaders(),y=p.length>0,S=o.bom?String.fromCharCode(65279):"";return h&&(a=dn(a,function(E){return i._escapeCell(E,!0)}),y&&(S+=o.columnDelimiter),S+=a.join(o.columnDelimiter),S+=o.rowDelimiter),Fe(s,function(E,O){O>0&&(S+=o.rowDelimiter),y&&(S+=i._escapeCell(p[O])+o.columnDelimiter),S+=E.map(function(A){return i._escapeCell(A)}).join(o.columnDelimiter)}),S}},{key:"_escapeCell",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,s=Ji(i);return s!==""&&(o||s.indexOf(qht)>=0||s.indexOf(Xht)>=0||s.indexOf(Zht)>=0||s.indexOf(this.options.columnDelimiter)>=0)&&(s=s.replace(new RegExp('"',"g"),'""'),s='"'.concat(s,'"')),s}}],[{key:"DEFAULT_OPTIONS",get:function(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:`\r
`}}}]),r}(jht);const Qht=Jht;function aC(e){"@babel/helpers - typeof";return aC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},aC(e)}function edt(e,t,r){return t=tdt(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function tdt(e){var t=rdt(e,"string");return aC(t)==="symbol"?t:String(t)}function rdt(e,t){if(aC(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(aC(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ndt="csv",bz=edt({},ndt,Qht);function idt(e,t,r){return typeof bz[e]=="function"?new bz[e](t,r):null}function W_(e){"@babel/helpers - typeof";return W_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},W_(e)}function odt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jQ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,sdt(n.key),n)}}function adt(e,t,r){return t&&jQ(e.prototype,t),r&&jQ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function sdt(e){var t=ldt(e,"string");return W_(t)==="symbol"?t:String(t)}function ldt(e,t){if(W_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(W_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function udt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&wz(e,t)}function wz(e,t){return wz=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},wz(e,t)}function cdt(e){var t=ddt();return function(){var n=NA(e),i;if(t){var o=NA(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return fdt(this,i)}}function fdt(e,t){if(t&&(W_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return hdt(e)}function hdt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ddt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function NA(e){return NA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},NA(e)}var pdt="exportFile",mdt=240,gdt=function(e){udt(r,e);var t=cdt(r);function r(){return odt(this,r),t.apply(this,arguments)}return adt(r,[{key:"isEnabled",value:function(){return!0}},{key:"exportAsString",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createTypeFormatter(i,o).export()}},{key:"exportAsBlob",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createBlob(this._createTypeFormatter(i,o))}},{key:"downloadFile",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=this.hot,a=s.rootDocument,h=s.rootWindow,p=this._createTypeFormatter(i,o),y=this._createBlob(p),S=h.URL||h.webkitURL,E=a.createElement("a"),O="".concat(p.options.filename,".").concat(p.options.fileExtension);if(E.download!==void 0){var A=S.createObjectURL(y);E.style.display="none",E.setAttribute("href",A),E.setAttribute("download",O),a.body.appendChild(E),E.dispatchEvent(new MouseEvent("click")),a.body.removeChild(E),setTimeout(function(){S.revokeObjectURL(A)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(y,O)}},{key:"_createTypeFormatter",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!bz[i])throw new Error('Export format type "'.concat(i,'" is not supported.'));return idt(i,new Mht(this.hot),o)}},{key:"_createBlob",value:function(i){var o=null;return typeof Blob<"u"&&(o=new Blob([i.export()],{type:"".concat(i.options.mimeType,";charset=").concat(i.options.encoding)})),o}}],[{key:"PLUGIN_KEY",get:function(){return pdt}},{key:"PLUGIN_PRIORITY",get:function(){return mdt}}]),r}(Yn);function sC(e){"@babel/helpers - typeof";return sC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sC(e)}function ydt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function FQ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_dt(n.key),n)}}function vdt(e,t,r){return t&&FQ(e.prototype,t),r&&FQ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _dt(e){var t=bdt(e,"string");return sC(t)==="symbol"?t:String(t)}function bdt(e,t){if(sC(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(sC(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Jhe=function(){function e(t,r){var n=r.id,i=r.stateless,o=i===void 0?!0:i;ydt(this,e),this.hot=t,this.id=n,this.elements=[],this.hidden=!1,this.stateId="Filters.component.".concat(this.id),this.state=o?null:this.hot.columnIndexMapper.registerMap(this.stateId,new pM)}return vdt(e,[{key:"reset",value:function(){Fe(this.elements,function(r){return r.reset()})}},{key:"hide",value:function(){this.hidden=!0}},{key:"show",value:function(){this.hidden=!1}},{key:"isHidden",value:function(){return this.hot===null||this.hidden}},{key:"restoreState",value:function(r){this.state&&this.setState(this.state.getValueAtIndex(r))}},{key:"setState",value:function(){throw new Error("The state setting logic is not implemented")}},{key:"saveState",value:function(r){this.state&&this.state.setValueAtIndex(r,this.getState())}},{key:"getState",value:function(){throw new Error("The state gathering logic is not implemented")}},{key:"destroy",value:function(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),Fe(this.elements,function(r){return r.destroy()}),this.state=null,this.elements=null,this.hot=null}}]),e}();ci(Jhe,Ya);const AM=Jhe;var lC={};function Fh(e,t){if(!lC[e])throw Error('Filter condition "'.concat(e,'" does not exist.'));var r=lC[e],n=r.condition,i=r.descriptor,o=t;return i.inputValuesDecorator&&(o=i.inputValuesDecorator(o)),function(s){return n.apply(s.meta.instance,[].concat([s],[o]))}}function $p(e){if(!lC[e])throw Error('Filter condition "'.concat(e,'" does not exist.'));return lC[e].descriptor}function ro(e,t,r){r.key=e,lC[e]={condition:t,descriptor:r}}var ko="none";function wdt(){return!0}ro(ko,wdt,{name:gM,inputsCount:0,showOperators:!1});var e1="empty";function Sdt(e){return _o(e.value)}ro(e1,Sdt,{name:G4,inputsCount:0,showOperators:!0});var Hk="not_empty";function xdt(e,t){return!Fh(e1,t)(e)}ro(Hk,xdt,{name:Y4,inputsCount:0,showOperators:!0});function Cdt(e,t){return Rdt(e)||Odt(e,t)||Tdt(e,t)||Edt()}function Edt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Tdt(e,t){if(e){if(typeof e=="string")return zQ(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return zQ(e,t)}}function zQ(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Odt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],h=!0,p=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;h=!1}else for(;!(h=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);h=!0);}catch(y){p=!0,i=y}finally{try{if(!h&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(p)throw i}}return a}}function Rdt(e){if(Array.isArray(e))return e}var t1="eq";function kdt(e,t){var r=Cdt(t,1),n=r[0];return Ji(e.value).toLocaleLowerCase(e.meta.locale)===Ji(n)}ro(t1,kdt,{name:K4,inputsCount:1,showOperators:!0});var Vk="neq";function Pdt(e,t){return!Fh(t1,t)(e)}ro(Vk,Pdt,{name:q4,inputsCount:1,showOperators:!0});function Adt(e,t){return Ddt(e)||$dt(e,t)||Mdt(e,t)||Idt()}function Idt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Mdt(e,t){if(e){if(typeof e=="string")return HQ(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return HQ(e,t)}}function HQ(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function $dt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],h=!0,p=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;h=!1}else for(;!(h=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);h=!0);}catch(y){p=!0,i=y}finally{try{if(!h&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(p)throw i}}return a}}function Ddt(e){if(Array.isArray(e))return e}var Qhe="gt";function Ldt(e,t){var r=Adt(t,1),n=r[0],i=n;return e.meta.type==="numeric"&&(i=parseFloat(i,10)),e.value>i}ro(Qhe,Ldt,{name:eW,inputsCount:1,showOperators:!0});function Ndt(e,t){return zdt(e)||Fdt(e,t)||jdt(e,t)||Bdt()}function Bdt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function jdt(e,t){if(e){if(typeof e=="string")return VQ(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return VQ(e,t)}}function VQ(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Fdt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],h=!0,p=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;h=!1}else for(;!(h=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);h=!0);}catch(y){p=!0,i=y}finally{try{if(!h&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(p)throw i}}return a}}function zdt(e){if(Array.isArray(e))return e}var ede="gte";function Hdt(e,t){var r=Ndt(t,1),n=r[0],i=n;return e.meta.type==="numeric"&&(i=parseFloat(i,10)),e.value>=i}ro(ede,Hdt,{name:tW,inputsCount:1,showOperators:!0});function Vdt(e,t){return Ydt(e)||Gdt(e,t)||Wdt(e,t)||Udt()}function Udt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Wdt(e,t){if(e){if(typeof e=="string")return UQ(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return UQ(e,t)}}function UQ(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Gdt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],h=!0,p=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;h=!1}else for(;!(h=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);h=!0);}catch(y){p=!0,i=y}finally{try{if(!h&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(p)throw i}}return a}}function Ydt(e){if(Array.isArray(e))return e}var tde="lt";function Kdt(e,t){var r=Vdt(t,1),n=r[0],i=n;return e.meta.type==="numeric"&&(i=parseFloat(i,10)),e.value<i}ro(tde,Kdt,{name:rW,inputsCount:1,showOperators:!0});function qdt(e,t){return Qdt(e)||Jdt(e,t)||Zdt(e,t)||Xdt()}function Xdt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Zdt(e,t){if(e){if(typeof e=="string")return WQ(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return WQ(e,t)}}function WQ(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Jdt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],h=!0,p=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;h=!1}else for(;!(h=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);h=!0);}catch(y){p=!0,i=y}finally{try{if(!h&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(p)throw i}}return a}}function Qdt(e){if(Array.isArray(e))return e}var rde="lte";function ept(e,t){var r=qdt(t,1),n=r[0],i=n;return e.meta.type==="numeric"&&(i=parseFloat(i,10)),e.value<=i}ro(rde,ept,{name:nW,inputsCount:1,showOperators:!0});function tpt(e,t){return opt(e)||ipt(e,t)||npt(e,t)||rpt()}function rpt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function npt(e,t){if(e){if(typeof e=="string")return GQ(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return GQ(e,t)}}function GQ(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ipt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],h=!0,p=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;h=!1}else for(;!(h=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);h=!0);}catch(y){p=!0,i=y}finally{try{if(!h&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(p)throw i}}return a}}function opt(e){if(Array.isArray(e))return e}var PW="date_after";function apt(e,t){var r=tpt(t,1),n=r[0],i=Ut(e.value,e.meta.dateFormat),o=Ut(n,e.meta.dateFormat);return!i.isValid()||!o.isValid()?!1:i.diff(o)>=0}ro(PW,apt,{name:aW,inputsCount:1,showOperators:!0});function spt(e,t){return fpt(e)||cpt(e,t)||upt(e,t)||lpt()}function lpt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function upt(e,t){if(e){if(typeof e=="string")return YQ(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return YQ(e,t)}}function YQ(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function cpt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],h=!0,p=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;h=!1}else for(;!(h=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);h=!0);}catch(y){p=!0,i=y}finally{try{if(!h&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(p)throw i}}return a}}function fpt(e){if(Array.isArray(e))return e}var AW="date_before";function hpt(e,t){var r=spt(t,1),n=r[0],i=Ut(e.value,e.meta.dateFormat),o=Ut(n,e.meta.dateFormat);return!i.isValid()||!o.isValid()?!1:i.diff(o)<=0}ro(AW,hpt,{name:sW,inputsCount:1,showOperators:!0});function dpt(e,t){return ypt(e)||gpt(e,t)||mpt(e,t)||ppt()}function ppt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function mpt(e,t){if(e){if(typeof e=="string")return KQ(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return KQ(e,t)}}function KQ(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function gpt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],h=!0,p=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;h=!1}else for(;!(h=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);h=!0);}catch(y){p=!0,i=y}finally{try{if(!h&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(p)throw i}}return a}}function ypt(e){if(Array.isArray(e))return e}var BA="between";function vpt(e,t){var r=dpt(t,2),n=r[0],i=r[1],o=n,s=i;if(e.meta.type==="numeric"){var a=parseFloat(o,10),h=parseFloat(s,10);o=Math.min(a,h),s=Math.max(a,h)}else if(e.meta.type==="date"){var p=Fh(AW,[s]),y=Fh(PW,[o]);return p(e)&&y(e)}return e.value>=o&&e.value<=s}ro(BA,vpt,{name:iW,inputsCount:2,showOperators:!0});var nde="not_between";function _pt(e,t){return!Fh(BA,t)(e)}ro(nde,_pt,{name:oW,inputsCount:2,showOperators:!0});function bpt(e,t){return Cpt(e)||xpt(e,t)||Spt(e,t)||wpt()}function wpt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Spt(e,t){if(e){if(typeof e=="string")return qQ(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return qQ(e,t)}}function qQ(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function xpt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],h=!0,p=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;h=!1}else for(;!(h=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);h=!0);}catch(y){p=!0,i=y}finally{try{if(!h&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(p)throw i}}return a}}function Cpt(e){if(Array.isArray(e))return e}var ide="begins_with";function Ept(e,t){var r=bpt(t,1),n=r[0];return Ji(e.value).toLocaleLowerCase(e.meta.locale).startsWith(Ji(n))}ro(ide,Ept,{name:X4,inputsCount:1,showOperators:!0});var Tpt=jr,ode=sE,Opt=Ou.f,Rpt=Mm,XQ=to,kpt=fU,Ppt=Wa,Apt=hU,ZQ=ode("".endsWith),Ipt=ode("".slice),Mpt=Math.min,ade=Apt("endsWith"),$pt=!ade&&!!function(){var e=Opt(String.prototype,"endsWith");return e&&!e.writable}();Tpt({target:"String",proto:!0,forced:!$pt&&!ade},{endsWith:function(t){var r=XQ(Ppt(this));kpt(t);var n=arguments.length>1?arguments[1]:void 0,i=r.length,o=n===void 0?i:Mpt(Rpt(n),i),s=XQ(t);return ZQ?ZQ(r,s,o):Ipt(r,o-s.length,o)===s}});function Dpt(e,t){return jpt(e)||Bpt(e,t)||Npt(e,t)||Lpt()}function Lpt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Npt(e,t){if(e){if(typeof e=="string")return JQ(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return JQ(e,t)}}function JQ(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Bpt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],h=!0,p=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;h=!1}else for(;!(h=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);h=!0);}catch(y){p=!0,i=y}finally{try{if(!h&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(p)throw i}}return a}}function jpt(e){if(Array.isArray(e))return e}var sde="ends_with";function Fpt(e,t){var r=Dpt(t,1),n=r[0];return Ji(e.value).toLocaleLowerCase(e.meta.locale).endsWith(Ji(n))}ro(sde,Fpt,{name:Z4,inputsCount:1,showOperators:!0});function zpt(e,t){return Wpt(e)||Upt(e,t)||Vpt(e,t)||Hpt()}function Hpt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Vpt(e,t){if(e){if(typeof e=="string")return QQ(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return QQ(e,t)}}function QQ(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Upt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],h=!0,p=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;h=!1}else for(;!(h=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);h=!0);}catch(y){p=!0,i=y}finally{try{if(!h&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(p)throw i}}return a}}function Wpt(e){if(Array.isArray(e))return e}var IW="contains";function Gpt(e,t){var r=zpt(t,1),n=r[0];return Ji(e.value).toLocaleLowerCase(e.meta.locale).indexOf(Ji(n))>=0}ro(IW,Gpt,{name:J4,inputsCount:1,showOperators:!0});var lde="not_contains";function Ypt(e,t){return!Fh(IW,t)(e)}ro(lde,Ypt,{name:Q4,inputsCount:1,showOperators:!0});var ude="date_tomorrow";function Kpt(e){var t=Ut(e.value,e.meta.dateFormat);return t.isValid()?t.isSame(Ut().subtract(-1,"days").startOf("day"),"d"):!1}ro(ude,Kpt,{name:uW,inputsCount:0});var cde="date_today";function qpt(e){var t=Ut(e.value,e.meta.dateFormat);return t.isValid()?t.isSame(Ut().startOf("day"),"d"):!1}ro(cde,qpt,{name:lW,inputsCount:0});var fde="date_yesterday";function Xpt(e){var t=Ut(e.value,e.meta.dateFormat);return t.isValid()?t.isSame(Ut().subtract(1,"days").startOf("day"),"d"):!1}ro(fde,Xpt,{name:cW,inputsCount:0});BVe();function Zpt(e,t){var r=e;return r===""&&(r="(".concat(t,")")),r}var Sz=new Set([1]).has(1),Jpt=Sz&&typeof Array.from=="function";function $E(e){var t=e;return Sz&&(t=new Set(t)),function(r){var n;return Sz?n=t.has(r):n=!!~t.indexOf(r),n}}function hde(e){return e??""}function xz(e){var t=e;return Jpt?t=Array.from(new Set(t)):t=Pue(t),t=t.sort(function(r,n){return typeof r=="number"&&typeof n=="number"?r-n:r===n?0:r>n?1:-1}),t}function eee(e,t,r,n){var i=[],o=e===t,s;return o||(s=$E(t)),Fe(e,function(a){var h=!1;(o||s(a))&&(h=!0);var p={checked:h,value:a,visualValue:Zpt(a,r)};n&&n(p),i.push(p)}),i}function dde(e,t){return rmt(e)||tmt(e,t)||emt(e,t)||Qpt()}function Qpt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function emt(e,t){if(e){if(typeof e=="string")return tee(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return tee(e,t)}}function tee(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function tmt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],h=!0,p=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;h=!1}else for(;!(h=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);h=!0);}catch(y){p=!0,i=y}finally{try{if(!h&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(p)throw i}}return a}}function rmt(e){if(Array.isArray(e))return e}var Dp="by_value";function nmt(e,t){var r=dde(t,1),n=r[0];return n(e.value)}ro(Dp,nmt,{name:"By value",inputsCount:0,inputValuesDecorator:function(t){var r=dde(t,1),n=r[0];return[$E(n)]},showOperators:!1});var uC={};function imt(e){if(!uC[e])throw Error('Operation with id "'.concat(e,'" does not exist.'));var t=uC[e].func;return function(r,n){return t(r,n)}}function omt(e){return uC[e].name}function MW(e,t,r){uC[e]={name:t,func:r}}var Oh="conjunction",amt=dW;function smt(e,t){return e.every(function(r){return r.func(t)})}MW(Oh,amt,smt);var jA="disjunction",lmt=yM;function umt(e,t){return e.some(function(r){return r.func(t)})}MW(jA,lmt,umt);var $W="disjunctionWithExtraCondition",cmt=yM;function fmt(e,t){if(e.length<3)throw Error("Operation doesn't work on less then three conditions.");return e.slice(0,e.length-1).some(function(r){return r.func(t)})&&e[e.length-1].func(t)}MW($W,cmt,fmt);function cC(e){"@babel/helpers - typeof";return cC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cC(e)}var cS;function eN(e,t,r){return t=hmt(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function hmt(e){var t=dmt(e,"string");return cC(t)==="symbol"?t:String(t)}function dmt(e,t){if(cC(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(cC(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var pmt="numeric",pde="text",mmt="date",ree=(cS={},eN(cS,pmt,[ko,hn,e1,Hk,hn,t1,Vk,hn,Qhe,ede,tde,rde,BA,nde]),eN(cS,pde,[ko,hn,e1,Hk,hn,t1,Vk,hn,ide,sde,hn,IW,lde]),eN(cS,mmt,[ko,hn,e1,Hk,hn,t1,Vk,hn,AW,PW,BA,hn,ude,cde,fde]),cS);function gmt(e){var t=[],r=e;return ree[r]||(r=pde),Fe(ree[r],function(n){var i;n===hn?i={name:hn}:i=za($p(n)),t.push(i)}),t}function fC(e){"@babel/helpers - typeof";return fC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fC(e)}function ymt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function nee(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_mt(n.key),n)}}function vmt(e,t,r){return t&&nee(e.prototype,t),r&&nee(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _mt(e){var t=bmt(e,"string");return fC(t)==="symbol"?t:String(t)}function bmt(e,t){if(fC(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(fC(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var tN="built",rN="building",iee=["click","input","keydown","keypress","keyup","focus","blur","change"],mde=function(){function e(t,r){ymt(this,e),this.hot=t,this.eventManager=new Fi(this),this.options=lo(e.DEFAULTS,r),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName),this.buildState=null}return vmt(e,[{key:"setValue",value:function(r){this.options.value=r,this.update()}},{key:"getValue",value:function(){return this.options.value}},{key:"element",get:function(){return this.buildState===rN?this._element:this.buildState===tN?(this.update(),this._element):(this.buildState=rN,this.build(),this.buildState=tN,this._element)}},{key:"isBuilt",value:function(){return this.buildState===tN}},{key:"translateIfPossible",value:function(r){return typeof r=="string"&&r.startsWith(Ea)?this.hot.getTranslatedPhrase(r):r}},{key:"build",value:function(){var r=this,n=function(s,a){r.eventManager.addEventListener(s,a,function(h){return r.runLocalHooks(a,h,r)})};if(this.buildState||(this.buildState=rN),this.options.className&&Vt(this._element,this.options.className),this.options.children.length)Fe(this.options.children,function(o){return r._element.appendChild(o.element)});else if(this.options.wrapIt){var i=this.hot.rootDocument.createElement(this.options.tagName);mn(this.options,function(o,s){i[s]!==void 0&&s!=="className"&&s!=="tagName"&&s!=="children"&&(i[s]=r.translateIfPossible(o))}),this._element.appendChild(i),Fe(iee,function(o){return n(i,o)})}else Fe(iee,function(o){return n(r._element,o)})}},{key:"update",value:function(){}},{key:"reset",value:function(){this.options.value="",this.update()}},{key:"show",value:function(){this.element.style.display=""}},{key:"hide",value:function(){this.element.style.display="none"}},{key:"focus",value:function(){}},{key:"destroy",value:function(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}}],[{key:"DEFAULTS",get:function(){return za({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}}]),e}();ci(mde,Ya);const Rh=mde;function G_(e){"@babel/helpers - typeof";return G_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},G_(e)}function wmt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function oee(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,xmt(n.key),n)}}function Smt(e,t,r){return t&&oee(e.prototype,t),r&&oee(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function xmt(e){var t=Cmt(e,"string");return G_(t)==="symbol"?t:String(t)}function Cmt(e,t){if(G_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(G_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Uk(){return typeof Reflect<"u"&&Reflect.get?Uk=Reflect.get.bind():Uk=function(t,r,n){var i=Emt(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Uk.apply(this,arguments)}function Emt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Y_(e),e!==null););return e}function Tmt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Cz(e,t)}function Cz(e,t){return Cz=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Cz(e,t)}function Omt(e){var t=kmt();return function(){var n=Y_(e),i;if(t){var o=Y_(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Rmt(this,i)}}function Rmt(e,t){if(t&&(G_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return gde(e)}function gde(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function kmt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Y_(e){return Y_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Y_(e)}var FR=new WeakMap,Pmt=function(e){Tmt(r,e);var t=Omt(r);function r(n,i){var o;return wmt(this,r),o=t.call(this,n,lo(r.DEFAULTS,i)),FR.set(gde(o),{}),o.registerHooks(),o}return Smt(r,[{key:"registerHooks",value:function(){var i=this;this.addLocalHook("click",function(){return i.onClick()}),this.addLocalHook("keyup",function(o){return i.onKeyup(o)})}},{key:"build",value:function(){Uk(Y_(r.prototype),"build",this).call(this);var i=FR.get(this),o=this.hot.rootDocument.createElement("div");i.input=this._element.firstChild,Vt(this._element,"htUIInput"),Vt(o,"htUIInputIcon"),this._element.appendChild(o),this.update()}},{key:"update",value:function(){if(this.isBuilt()){var i=FR.get(this).input;i.type=this.options.type,i.placeholder=this.translateIfPossible(this.options.placeholder),i.value=this.translateIfPossible(this.options.value)}}},{key:"focus",value:function(){this.isBuilt()&&FR.get(this).input.focus()}},{key:"onClick",value:function(){}},{key:"onKeyup",value:function(i){this.options.value=i.target.value}}],[{key:"DEFAULTS",get:function(){return za({placeholder:"",type:"text",tagName:"input"})}}]),r}(Rh);const fv=Pmt;function K_(e){"@babel/helpers - typeof";return K_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},K_(e)}function Amt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function aee(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Mmt(n.key),n)}}function Imt(e,t,r){return t&&aee(e.prototype,t),r&&aee(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Mmt(e){var t=$mt(e,"string");return K_(t)==="symbol"?t:String(t)}function $mt(e,t){if(K_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(K_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function hv(){return typeof Reflect<"u"&&Reflect.get?hv=Reflect.get.bind():hv=function(t,r,n){var i=Dmt(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},hv.apply(this,arguments)}function Dmt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=kh(e),e!==null););return e}function Lmt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ez(e,t)}function Ez(e,t){return Ez=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Ez(e,t)}function Nmt(e){var t=jmt();return function(){var n=kh(e),i;if(t){var o=kh(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Bmt(this,i)}}function Bmt(e,t){if(t&&(K_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return yde(e)}function yde(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function jmt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function kh(e){return kh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},kh(e)}var zR=new WeakMap,Fmt=function(e){Lmt(r,e);var t=Nmt(r);function r(n,i){var o;return Amt(this,r),o=t.call(this,n,lo(r.DEFAULTS,i)),zR.set(yde(o),{}),o.menu=null,o.items=[],o.registerHooks(),o}return Imt(r,[{key:"registerHooks",value:function(){var i=this;this.addLocalHook("click",function(){return i.onClick()})}},{key:"setItems",value:function(i){this.items=this.translateNames(i),this.menu&&this.menu.setMenuItems(this.items)}},{key:"translateNames",value:function(i){var o=this;return Fe(i,function(s){s.name=o.translateIfPossible(s.name)}),i}},{key:"build",value:function(){var i=this;hv(kh(r.prototype),"build",this).call(this),this.menu=new RW(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer}),this.menu.setMenuItems(this.items);var o=new Rh(this.hot,{className:"htUISelectCaption"}),s=new Rh(this.hot,{className:"htUISelectDropdown"}),a=zR.get(this);a.caption=o,a.captionElement=o.element,a.dropdown=s,Fe([o,s],function(h){return i._element.appendChild(h.element)}),this.menu.addLocalHook("select",function(h){return i.onMenuSelect(h)}),this.menu.addLocalHook("afterClose",function(){return i.onMenuClosed()}),this.update()}},{key:"update",value:function(){if(this.isBuilt()){var i;this.options.value?i=this.options.value.name:i=this.menu.hot.getTranslatedPhrase(gM),zR.get(this).captionElement.textContent=i,hv(kh(r.prototype),"update",this).call(this)}}},{key:"openOptions",value:function(){var i=this.element.getBoundingClientRect();this.menu&&(this.menu.open(),this.menu.setPosition({left:this.hot.isLtr()?i.left-5:i.left-31,top:i.top-1,width:i.width,height:i.height}))}},{key:"closeOptions",value:function(){this.menu&&this.menu.close()}},{key:"onMenuSelect",value:function(i){i.name!==hn&&(this.options.value=i,this.update(),this.runLocalHooks("select",this.options.value))}},{key:"onMenuClosed",value:function(){this.runLocalHooks("afterClose")}},{key:"onClick",value:function(){this.openOptions()}},{key:"destroy",value:function(){this.menu&&(this.menu.destroy(),this.menu=null);var i=zR.get(this),o=i.caption,s=i.dropdown;o&&o.destroy(),s&&s.destroy(),hv(kh(r.prototype),"destroy",this).call(this)}}],[{key:"DEFAULTS",get:function(){return za({className:"htUISelect",wrapIt:!1})}}]),r}(Rh);const see=Fmt;function q_(e){"@babel/helpers - typeof";return q_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},q_(e)}function zmt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function lee(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Vmt(n.key),n)}}function Hmt(e,t,r){return t&&lee(e.prototype,t),r&&lee(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Vmt(e){var t=Umt(e,"string");return q_(t)==="symbol"?t:String(t)}function Umt(e,t){if(q_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(q_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Wk(){return typeof Reflect<"u"&&Reflect.get?Wk=Reflect.get.bind():Wk=function(t,r,n){var i=Wmt(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Wk.apply(this,arguments)}function Wmt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=X_(e),e!==null););return e}function Gmt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Tz(e,t)}function Tz(e,t){return Tz=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Tz(e,t)}function Ymt(e){var t=Xmt();return function(){var n=X_(e),i;if(t){var o=X_(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Kmt(this,i)}}function Kmt(e,t){if(t&&(q_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return qmt(e)}function qmt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Xmt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function X_(e){return X_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},X_(e)}var Zmt=function(e){Gmt(r,e);var t=Ymt(r);function r(n,i){var o;return zmt(this,r),o=t.call(this,n,{id:i.id,stateless:!1}),o.name=i.name,o.addSeparator=i.addSeparator,o.elements.push(new see(o.hot,{menuContainer:i.menuContainer})),o.elements.push(new fv(o.hot,{placeholder:_W})),o.elements.push(new fv(o.hot,{placeholder:bW})),o.registerHooks(),o}return Hmt(r,[{key:"registerHooks",value:function(){var i=this;this.getSelectElement().addLocalHook("select",function(o){return i.onConditionSelect(o)}),this.getSelectElement().addLocalHook("afterClose",function(){return i.onSelectUIClosed()}),Fe(this.getInputElements(),function(o){o.addLocalHook("keydown",function(s){return i.onInputKeyDown(s)})})}},{key:"setState",value:function(i){var o=this;if(this.reset(),!!i){var s=za(i.command);s.name.startsWith(zi)&&(s.name=this.hot.getTranslatedPhrase(s.name)),this.getSelectElement().setValue(s),Fe(i.args,function(a,h){if(h>s.inputsCount-1)return!1;var p=o.getInputElement(h);p.setValue(a),p[s.inputsCount>h?"show":"hide"](),h||setTimeout(function(){return p.focus()},10)})}}},{key:"getState",value:function(){var i=this.getSelectElement().getValue()||$p(ko),o=[];return Fe(this.getInputElements(),function(s,a){i.inputsCount>a&&o.push(s.getValue())}),{command:i,args:o}}},{key:"updateState",value:function(i,o){var s=$p(i?i.name:ko);this.state.setValueAtIndex(o,{command:s,args:i?i.args:[]}),i||Fe(this.getInputElements(),function(a){return a.setValue(null)})}},{key:"getSelectElement",value:function(){return this.elements.filter(function(i){return i instanceof see})[0]}},{key:"getInputElement",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.getInputElements()[i]}},{key:"getInputElements",value:function(){return this.elements.filter(function(i){return i instanceof fv})}},{key:"getMenuItemDescriptor",value:function(){var i=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return i.isHidden()},renderer:function(s,a,h,p,y,S){Vt(a.parentNode,"htFiltersMenuCondition"),i.addSeparator&&Vt(a.parentNode,"border");var E=i.hot.rootDocument.createElement("div");return Vt(E,"htFiltersMenuLabel"),E.textContent=S,a.appendChild(E),a.parentNode.hasAttribute("ghost-table")||Fe(i.elements,function(O){return a.appendChild(O.element)}),a}}}},{key:"reset",value:function(){var i=this.hot.getPlugin("filters").getSelectedColumn(),o=[$p(ko)];if(i!==null){var s=i.visualIndex;o=gmt(this.hot.getDataType(0,s,this.hot.countRows(),s))}Fe(this.getInputElements(),function(a){return a.hide()}),this.getSelectElement().setItems(o),Wk(X_(r.prototype),"reset",this).call(this),this.getSelectElement().setValue(o[0])}},{key:"onConditionSelect",value:function(i){Fe(this.getInputElements(),function(o,s){o[i.inputsCount>s?"show":"hide"](),s===0&&setTimeout(function(){return o.focus()},10)}),this.runLocalHooks("change",i)}},{key:"onSelectUIClosed",value:function(){this.runLocalHooks("afterClose")}},{key:"onInputKeyDown",value:function(i){A1(i.keyCode,"ENTER")?(this.runLocalHooks("accept"),Cu(i)):A1(i.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Cu(i))}}]),r}(AM);const nN=Zmt;function Z_(e){"@babel/helpers - typeof";return Z_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Z_(e)}function Jmt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function uee(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,egt(n.key),n)}}function Qmt(e,t,r){return t&&uee(e.prototype,t),r&&uee(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function egt(e){var t=tgt(e,"string");return Z_(t)==="symbol"?t:String(t)}function tgt(e,t){if(Z_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Z_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Gk(){return typeof Reflect<"u"&&Reflect.get?Gk=Reflect.get.bind():Gk=function(t,r,n){var i=rgt(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Gk.apply(this,arguments)}function rgt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=J_(e),e!==null););return e}function ngt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Oz(e,t)}function Oz(e,t){return Oz=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Oz(e,t)}function igt(e){var t=agt();return function(){var n=J_(e),i;if(t){var o=J_(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return ogt(this,i)}}function ogt(e,t){if(t&&(Z_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return vde(e)}function vde(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function agt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function J_(e){return J_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},J_(e)}var HR=new WeakMap,sgt=function(e){ngt(r,e);var t=igt(r);function r(n,i){var o;return Jmt(this,r),o=t.call(this,n,lo(r.DEFAULTS,i)),HR.set(vde(o),{}),o}return Qmt(r,[{key:"build",value:function(){Gk(J_(r.prototype),"build",this).call(this);var i=HR.get(this);i.input=this._element.firstChild;var o=this.hot.rootDocument.createElement("label");o.textContent=this.translateIfPossible(this.options.label.textContent),o.htmlFor=this.translateIfPossible(this.options.label.htmlFor),i.label=o,this._element.appendChild(o),this.update()}},{key:"update",value:function(){if(this.isBuilt()){var i=HR.get(this);i.input.checked=this.options.checked,i.label.textContent=this.translateIfPossible(this.options.label.textContent)}}},{key:"isChecked",value:function(){return this.options.checked}},{key:"setChecked",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.options.checked=i,this.update()}},{key:"focus",value:function(){this.isBuilt()&&HR.get(this).input.focus()}}],[{key:"DEFAULTS",get:function(){return za({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}}]),r}(Rh);const cee=sgt;function Q_(e){"@babel/helpers - typeof";return Q_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Q_(e)}var fee;function lgt(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function ugt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function hee(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,fgt(n.key),n)}}function cgt(e,t,r){return t&&hee(e.prototype,t),r&&hee(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function fgt(e){var t=hgt(e,"string");return Q_(t)==="symbol"?t:String(t)}function hgt(e,t){if(Q_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Q_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function dgt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Rz(e,t)}function Rz(e,t){return Rz=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Rz(e,t)}function pgt(e){var t=ygt();return function(){var n=FA(e),i;if(t){var o=FA(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return mgt(this,i)}}function mgt(e,t){if(t&&(Q_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ggt(e)}function ggt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ygt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function FA(e){return FA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},FA(e)}var dee=0,vgt=function(e){dgt(r,e);var t=pgt(r);function r(n,i){var o;return ugt(this,r),o=t.call(this,n,{id:i.id,stateless:!1}),o.name=i.name,o.buildOperatorsElement(),o}return cgt(r,[{key:"getMenuItemDescriptor",value:function(){var i=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return i.isHidden()},renderer:function(s,a){return Vt(a.parentNode,"htFiltersMenuOperators"),a.parentNode.hasAttribute("ghost-table")||Fe(i.elements,function(h){return a.appendChild(h.element)}),a}}}},{key:"buildOperatorsElement",value:function(){var i=this,o=[Oh,jA];Fe(o,function(s){var a=new cee(i.hot,{name:"operator",label:{htmlFor:s,textContent:omt(s)},value:s,checked:s===o[dee],id:s});a.addLocalHook("change",function(h){return i.onRadioInputChange(h)}),i.elements.push(a)})}},{key:"setChecked",value:function(i){if(this.elements.length<i)throw Error(Jn(fee||(fee=lgt(["Radio button with index "," doesn't exist."])),i));Fe(this.elements,function(o,s){o.setChecked(s===i)})}},{key:"getActiveOperationId",value:function(){var i=this.elements.find(function(o){return o instanceof cee&&o.isChecked()});return i?i.getValue():Oh}},{key:"getState",value:function(){return this.getActiveOperationId()}},{key:"setState",value:function(i){this.reset(),i&&this.getActiveOperationId()!==i&&Fe(this.elements,function(o){o.setChecked(o.getValue()===i)})}},{key:"updateState",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Oh,o=arguments.length>1?arguments[1]:void 0,s=i;s===$W&&(s=jA),this.state.setValueAtIndex(o,s)}},{key:"reset",value:function(){this.setChecked(dee)}},{key:"onRadioInputChange",value:function(i){this.setState(i.target.value)}}]),r}(AM);const _gt=vgt;var bgt=sn,wgt=Wa,pee=to,Sgt=/"/g,xgt=bgt("".replace),Cgt=function(e,t,r,n){var i=pee(wgt(e)),o="<"+t;return r!==""&&(o+=" "+r+'="'+xgt(pee(n),Sgt,"&quot;")+'"'),o+">"+i+"</"+t+">"},Egt=on,Tgt=function(e){return Egt(function(){var t=""[e]('"');return t!==t.toLowerCase()||t.split('"').length>3})},Ogt=jr,Rgt=Cgt,kgt=Tgt;Ogt({target:"String",proto:!0,forced:kgt("link")},{link:function(t){return Rgt(this,"a","href",t)}});function eb(e){"@babel/helpers - typeof";return eb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},eb(e)}function Pgt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mee(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Igt(n.key),n)}}function Agt(e,t,r){return t&&mee(e.prototype,t),r&&mee(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Igt(e){var t=Mgt(e,"string");return eb(t)==="symbol"?t:String(t)}function Mgt(e,t){if(eb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(eb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Yk(){return typeof Reflect<"u"&&Reflect.get?Yk=Reflect.get.bind():Yk=function(t,r,n){var i=$gt(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Yk.apply(this,arguments)}function $gt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=tb(e),e!==null););return e}function Dgt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&kz(e,t)}function kz(e,t){return kz=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},kz(e,t)}function Lgt(e){var t=Bgt();return function(){var n=tb(e),i;if(t){var o=tb(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Ngt(this,i)}}function Ngt(e,t){if(t&&(eb(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _de(e)}function _de(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Bgt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function tb(e){return tb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},tb(e)}var iN=new WeakMap,jgt=function(e){Dgt(r,e);var t=Lgt(r);function r(n,i){var o;return Pgt(this,r),o=t.call(this,n,lo(r.DEFAULTS,i)),iN.set(_de(o),{}),o}return Agt(r,[{key:"build",value:function(){Yk(tb(r.prototype),"build",this).call(this);var i=iN.get(this);i.link=this._element.firstChild}},{key:"update",value:function(){this.isBuilt()&&(iN.get(this).link.textContent=this.translateIfPossible(this.options.textContent))}}],[{key:"DEFAULTS",get:function(){return za({href:"#",tagName:"a"})}}]),r}(Rh);const gee=jgt;function rb(e){"@babel/helpers - typeof";return rb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rb(e)}function yee(e){return Vgt(e)||Hgt(e)||zgt(e)||Fgt()}function Fgt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zgt(e,t){if(e){if(typeof e=="string")return Pz(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Pz(e,t)}}function Hgt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Vgt(e){if(Array.isArray(e))return Pz(e)}function Pz(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Ugt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function vee(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ggt(n.key),n)}}function Wgt(e,t,r){return t&&vee(e.prototype,t),r&&vee(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ggt(e){var t=Ygt(e,"string");return rb(t)==="symbol"?t:String(t)}function Ygt(e,t){if(rb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(rb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function dv(){return typeof Reflect<"u"&&Reflect.get?dv=Reflect.get.bind():dv=function(t,r,n){var i=Kgt(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},dv.apply(this,arguments)}function Kgt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ph(e),e!==null););return e}function qgt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Az(e,t)}function Az(e,t){return Az=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Az(e,t)}function Xgt(e){var t=Jgt();return function(){var n=Ph(e),i;if(t){var o=Ph(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Zgt(this,i)}}function Zgt(e,t){if(t&&(rb(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return bde(e)}function bde(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Jgt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ph(e){return Ph=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ph(e)}var Qgt=new WeakMap,eyt="multipleSelect.itemBox",tyt=function(e){qgt(r,e);var t=Xgt(r);function r(n,i){var o;return Ugt(this,r),o=t.call(this,n,lo(r.DEFAULTS,i)),Qgt.set(bde(o),{}),o.searchInput=new fv(o.hot,{placeholder:vW,className:"htUIMultipleSelectSearch"}),o.selectAllUI=new gee(o.hot,{textContent:pW,className:"htUISelectAll"}),o.clearAllUI=new gee(o.hot,{textContent:mW,className:"htUIClearAll"}),o.items=[],o.itemsBox=null,o.registerHooks(),o}return Wgt(r,[{key:"registerHooks",value:function(){var i=this;this.searchInput.addLocalHook("keydown",function(o){return i.onInputKeyDown(o)}),this.searchInput.addLocalHook("input",function(o){return i.onInput(o)}),this.selectAllUI.addLocalHook("click",function(o){return i.onSelectAllClick(o)}),this.clearAllUI.addLocalHook("click",function(o){return i.onClearAllClick(o)})}},{key:"setItems",value:function(i){this.items=i,this.itemsBox&&this.itemsBox.loadData(this.items)}},{key:"setLocale",value:function(i){this.locale=i}},{key:"getLocale",value:function(){return this.locale}},{key:"getItems",value:function(){return yee(this.items)}},{key:"getValue",value:function(){return nyt(this.items)}},{key:"isSelectedAllValues",value:function(){return this.items.length===this.getValue().length}},{key:"build",value:function(){var i=this;dv(Ph(r.prototype),"build",this).call(this);var o=this.hot.rootDocument,s=o.createElement("div"),a=new Rh(this.hot,{className:"htUISelectionControls",children:[this.selectAllUI,this.clearAllUI]});this._element.appendChild(this.searchInput.element),this._element.appendChild(a.element),this._element.appendChild(s);var h=function(y){if(i._element){i.itemsBox&&i.itemsBox.destroy(),Vt(y,"htUIMultipleSelectHot"),i.itemsBox=new i.hot.constructor(y,{data:i.items,columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:function(A,$,B,j,z,W){A.title=W.instance.getDataAtRowProp($,W.label.property)},maxCols:1,autoWrapCol:!0,height:110,colWidths:function(){return i.itemsBox.container.scrollWidth-Mo(o)},copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},layoutDirection:i.hot.isRtl()?"rtl":"ltr"}),i.itemsBox.init();var S=i.itemsBox.getShortcutManager(),E=S.getContext("grid");E.addShortcut({keys:[["Escape"]],callback:function(A){i.runLocalHooks("keydown",A,i)},group:eyt})}};h(s),setTimeout(function(){return h(s)},100)}},{key:"reset",value:function(){this.searchInput.reset(),this.selectAllUI.reset(),this.clearAllUI.reset()}},{key:"update",value:function(){this.isBuilt()&&(this.itemsBox.loadData(ryt(this.items,this.options.value)),dv(Ph(r.prototype),"update",this).call(this))}},{key:"destroy",value:function(){this.itemsBox&&this.itemsBox.destroy(),this.searchInput.destroy(),this.clearAllUI.destroy(),this.selectAllUI.destroy(),this.searchInput=null,this.clearAllUI=null,this.selectAllUI=null,this.itemsBox=null,this.items=null,dv(Ph(r.prototype),"destroy",this).call(this)}},{key:"onInput",value:function(i){var o=this,s=i.target.value.toLocaleLowerCase(this.getLocale()),a;s===""?a=yee(this.items):a=Us(this.items,function(h){return"".concat(h.value).toLocaleLowerCase(o.getLocale()).indexOf(s)>=0}),this.itemsBox.loadData(a)}},{key:"onInputKeyDown",value:function(i){this.runLocalHooks("keydown",i,this);var o=rce(A1,i.keyCode);o("ARROW_DOWN|TAB")&&!this.itemsBox.isListening()&&(Cu(i),this.itemsBox.listen(),this.itemsBox.selectCell(0,0))}},{key:"onSelectAllClick",value:function(i){var o=[];i.preventDefault(),Fe(this.itemsBox.getSourceData(),function(s,a){s.checked=!0,o.push(_J(s,a)[0])}),this.itemsBox.setSourceDataAtCell(o)}},{key:"onClearAllClick",value:function(i){var o=[];i.preventDefault(),Fe(this.itemsBox.getSourceData(),function(s,a){s.checked=!1,o.push(_J(s,a)[0])}),this.itemsBox.setSourceDataAtCell(o)}}],[{key:"DEFAULTS",get:function(){return za({className:"htUIMultipleSelect",value:[]})}}]),r}(Rh);const _ee=tyt;function ryt(e,t){var r=$E(t);return dn(e,function(n){return n.checked=r(n.value),n})}function nyt(e){var t=[];return Fe(e,function(r){r.checked&&t.push(r.value)}),t}function nb(e){"@babel/helpers - typeof";return nb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nb(e)}function iyt(e,t){return lyt(e)||syt(e,t)||ayt(e,t)||oyt()}function oyt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ayt(e,t){if(e){if(typeof e=="string")return bee(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return bee(e,t)}}function bee(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function syt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],h=!0,p=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;h=!1}else for(;!(h=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);h=!0);}catch(y){p=!0,i=y}finally{try{if(!h&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(p)throw i}}return a}}function lyt(e){if(Array.isArray(e))return e}function uyt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function wee(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,fyt(n.key),n)}}function cyt(e,t,r){return t&&wee(e.prototype,t),r&&wee(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function fyt(e){var t=hyt(e,"string");return nb(t)==="symbol"?t:String(t)}function hyt(e,t){if(nb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(nb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Kk(){return typeof Reflect<"u"&&Reflect.get?Kk=Reflect.get.bind():Kk=function(t,r,n){var i=dyt(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Kk.apply(this,arguments)}function dyt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=ib(e),e!==null););return e}function pyt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Iz(e,t)}function Iz(e,t){return Iz=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Iz(e,t)}function myt(e){var t=vyt();return function(){var n=ib(e),i;if(t){var o=ib(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return gyt(this,i)}}function gyt(e,t){if(t&&(nb(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return yyt(e)}function yyt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function vyt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ib(e){return ib=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ib(e)}var _yt=function(e){pyt(r,e);var t=myt(r);function r(n,i){var o;return uyt(this,r),o=t.call(this,n,{id:i.id,stateless:!1}),o.name=i.name,o.elements.push(new _ee(o.hot)),o.registerHooks(),o}return cyt(r,[{key:"registerHooks",value:function(){var i=this;this.getMultipleSelectElement().addLocalHook("keydown",function(o){return i.onInputKeyDown(o)})}},{key:"setState",value:function(i){if(this.reset(),i&&i.command.key===Dp){var o=this.getMultipleSelectElement();o.setItems(i.itemsSnapshot),o.setValue(i.args[0]),o.setLocale(i.locale)}}},{key:"getState",value:function(){var i=this.getMultipleSelectElement(),o=i.getItems();return{command:{key:i.isSelectedAllValues()||!o.length?ko:Dp},args:[i.getValue()],itemsSnapshot:o}}},{key:"updateState",value:function(i){var o=this,s=function(h,p,y,S,E){var O=Us(p,function(Se){return Se.name===Dp}),A=iyt(O,1),$=A[0],B={},j=o.hot.getTranslatedPhrase(IA);if($){var z=xz(dn(S(h,E),function(Se){return Se.value}));y&&($.args[0]=y);var W=[],Q=eee(z,$.args[0],j,function(Se){Se.checked&&W.push(Se.value)}),q=i.editedConditionStack.column;B.locale=o.hot.getCellMeta(0,q).locale,B.args=[W],B.command=$p(Dp),B.itemsSnapshot=Q}else B.args=[],B.command=$p(ko);o.state.setValueAtIndex(h,B)};s(i.editedConditionStack.column,i.editedConditionStack.conditions,i.conditionArgsChange,i.filteredRowsFactory),i.dependentConditionStacks.length&&s(i.dependentConditionStacks[0].column,i.dependentConditionStacks[0].conditions,i.conditionArgsChange,i.filteredRowsFactory,i.editedConditionStack)}},{key:"getMultipleSelectElement",value:function(){return this.elements.filter(function(i){return i instanceof _ee})[0]}},{key:"getMenuItemDescriptor",value:function(){var i=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return i.isHidden()},renderer:function(s,a,h,p,y,S){Vt(a.parentNode,"htFiltersMenuValue");var E=i.hot.rootDocument.createElement("div");return Vt(E,"htFiltersMenuLabel"),E.textContent=S,a.appendChild(E),a.parentNode.hasAttribute("ghost-table")||Fe(i.elements,function(O){return a.appendChild(O.element)}),a}}}},{key:"reset",value:function(){var i=this.hot.getTranslatedPhrase(IA),o=xz(this._getColumnVisibleValues()),s=eee(o,o,i);this.getMultipleSelectElement().setItems(s),Kk(ib(r.prototype),"reset",this).call(this),this.getMultipleSelectElement().setValue(o);var a=this.hot.getPlugin("filters").getSelectedColumn();a!==null&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,a.visualIndex).locale)}},{key:"onInputKeyDown",value:function(i){A1(i.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Cu(i))}},{key:"_getColumnVisibleValues",value:function(){var i=this.hot.getPlugin("filters").getSelectedColumn();return i===null?[]:dn(this.hot.getDataAtCol(i.visualIndex),function(o){return hde(o)})}}]),r}(AM);const byt=_yt;function ob(e){"@babel/helpers - typeof";return ob=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ob(e)}function wyt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function See(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,xyt(n.key),n)}}function Syt(e,t,r){return t&&See(e.prototype,t),r&&See(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function xyt(e){var t=Cyt(e,"string");return ob(t)==="symbol"?t:String(t)}function Cyt(e,t){if(ob(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ob(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Eyt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Mz(e,t)}function Mz(e,t){return Mz=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Mz(e,t)}function Tyt(e){var t=kyt();return function(){var n=zA(e),i;if(t){var o=zA(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Oyt(this,i)}}function Oyt(e,t){if(t&&(ob(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ryt(e)}function Ryt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function kyt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function zA(e){return zA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},zA(e)}var Pyt=function(e){Eyt(r,e);var t=Tyt(r);function r(n,i){var o;return wyt(this,r),o=t.call(this,n,{id:i.id,stateless:!0}),o.name=i.name,o.elements.push(new fv(o.hot,{type:"button",value:gW,className:"htUIButton htUIButtonOK",identifier:r.BUTTON_OK})),o.elements.push(new fv(o.hot,{type:"button",value:yW,className:"htUIButton htUIButtonCancel",identifier:r.BUTTON_CANCEL})),o.registerHooks(),o}return Syt(r,[{key:"registerHooks",value:function(){var i=this;Fe(this.elements,function(o){o.addLocalHook("click",function(s,a){return i.onButtonClick(s,a)})})}},{key:"getMenuItemDescriptor",value:function(){var i=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return i.isHidden()},renderer:function(s,a){return Vt(a.parentNode,"htFiltersMenuActionBar"),a.parentNode.hasAttribute("ghost-table")||Fe(i.elements,function(h){return a.appendChild(h.element)}),a}}}},{key:"accept",value:function(){this.runLocalHooks("accept")}},{key:"cancel",value:function(){this.runLocalHooks("cancel")}},{key:"onButtonClick",value:function(i,o){o.options.identifier===r.BUTTON_OK?this.accept():this.cancel()}}],[{key:"BUTTON_OK",get:function(){return"ok"}},{key:"BUTTON_CANCEL",get:function(){return"cancel"}}]),r}(AM);const Ayt=Pyt;function hC(e){"@babel/helpers - typeof";return hC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hC(e)}var xee,Cee;function Eee(e,t){return Dyt(e)||$yt(e,t)||Myt(e,t)||Iyt()}function Iyt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Myt(e,t){if(e){if(typeof e=="string")return Tee(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Tee(e,t)}}function Tee(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function $yt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],h=!0,p=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;h=!1}else for(;!(h=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);h=!0);}catch(y){p=!0,i=y}finally{try{if(!h&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(p)throw i}}return a}}function Dyt(e){if(Array.isArray(e))return e}function Oee(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function Lyt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ree(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Byt(n.key),n)}}function Nyt(e,t,r){return t&&Ree(e.prototype,t),r&&Ree(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Byt(e){var t=jyt(e,"string");return hC(t)==="symbol"?t:String(t)}function jyt(e,t){if(hC(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(hC(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var kee="ConditionCollection.filteringStates",wde=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;Lyt(this,e),this.hot=t,this.isMapRegistrable=r,this.filteringStates=new pM,this.isMapRegistrable===!0?this.hot.columnIndexMapper.registerMap(kee,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}return Nyt(e,[{key:"isEmpty",value:function(){return this.getFilteredColumns().length===0}},{key:"isMatch",value:function(r,n){var i,o=this.filteringStates.getValueAtIndex(n),s=(i=o==null?void 0:o.conditions)!==null&&i!==void 0?i:[],a=o==null?void 0:o.operation;return this.isMatchInConditions(s,r,a)}},{key:"isMatchInConditions",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Oh;return r.length?imt(i)(r,n):!0}},{key:"addCondition",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Oh,o=arguments.length>3?arguments[3]:void 0,s=this.hot.getCellMeta(0,r).locale,a=dn(n.args,function(S){return typeof S=="string"?S.toLocaleLowerCase(s):S}),h=n.name||n.command.key;this.runLocalHooks("beforeAdd",r);var p=this.getOperation(r);if(p){if(p!==i)throw Error(Jn(xee||(xee=Oee(["The column of index "," has been already applied with a `","` \n        filter operation. Use `removeConditions` to clear the current conditions and then add new ones. \n        Mind that you cannot mix different types of operations (for instance, if you use `conjunction`, \n        use it consequently for a particular column)."],["The column of index "," has been already applied with a \\`","\\`\\x20\n        filter operation. Use \\`removeConditions\\` to clear the current conditions and then add new ones.\\x20\n        Mind that you cannot mix different types of operations (for instance, if you use \\`conjunction\\`,\\x20\n        use it consequently for a particular column)."])),r,p))}else if(ui(uC[i]))throw new Error(Jn(Cee||(Cee=Oee(["Unexpected operation named `","`. Possible ones are \n        `disjunction` and `conjunction`."],["Unexpected operation named \\`","\\`. Possible ones are\\x20\n        \\`disjunction\\` and \\`conjunction\\`."])),i));var y=this.getConditions(r);y.length===0?this.filteringStates.setValueAtIndex(r,{operation:i,conditions:[{name:h,args:a,func:Fh(h,a)}]},o):y.push({name:h,args:a,func:Fh(h,a)}),this.runLocalHooks("afterAdd",r)}},{key:"getConditions",value:function(r){var n,i;return(n=(i=this.filteringStates.getValueAtIndex(r))===null||i===void 0?void 0:i.conditions)!==null&&n!==void 0?n:[]}},{key:"getOperation",value:function(r){var n;return(n=this.filteringStates.getValueAtIndex(r))===null||n===void 0?void 0:n.operation}},{key:"getFilteredColumns",value:function(){return this.filteringStates.getEntries().map(function(r){var n=Eee(r,1),i=n[0];return i})}},{key:"getColumnStackPosition",value:function(r){return this.getFilteredColumns().indexOf(r)}},{key:"exportAllConditions",value:function(){return oa(this.filteringStates.getEntries(),function(r,n){var i=Eee(n,2),o=i[0],s=i[1],a=s.operation,h=s.conditions;return r.push({column:o,operation:a,conditions:dn(h,function(p){var y=p.name,S=p.args;return{name:y,args:S}})}),r},[])}},{key:"importAllConditions",value:function(r){var n=this;this.clean(),Fe(r,function(i){Fe(i.conditions,function(o){return n.addCondition(i.column,o)})})}},{key:"removeConditions",value:function(r){this.runLocalHooks("beforeRemove",r),this.filteringStates.clearValue(r),this.runLocalHooks("afterRemove",r)}},{key:"clean",value:function(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}},{key:"hasConditions",value:function(r,n){var i=this.getConditions(r);return n?i.some(function(o){return o.name===n}):i.length>0}},{key:"destroy",value:function(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(kee),this.filteringStates=null,this.clearLocalHooks()}}]),e}();ci(wde,Ya);const Sde=wde;function dC(e){"@babel/helpers - typeof";return dC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},dC(e)}function Fyt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Pee(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Hyt(n.key),n)}}function zyt(e,t,r){return t&&Pee(e.prototype,t),r&&Pee(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Hyt(e){var t=Vyt(e,"string");return dC(t)==="symbol"?t:String(t)}function Vyt(e,t){if(dC(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(dC(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Uyt=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(){return[]};Fyt(this,e),this.conditionCollection=t,this.columnDataFactory=r}return zyt(e,[{key:"filter",value:function(){var r=this,n=[];return Fe(this.conditionCollection.getFilteredColumns(),function(i,o){var s=r.columnDataFactory(i);o&&(s=r._getIntersectData(s,n)),n=r.filterByColumn(i,s)}),n}},{key:"filterByColumn",value:function(r){var n=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],o=[];return Fe(i,function(s){s!==void 0&&n.conditionCollection.isMatch(s,r)&&o.push(s)}),o}},{key:"_getIntersectData",value:function(r,n){var i=[];return Fe(n,function(o){var s=o.meta.visualRow;r[s]!==void 0&&(i[s]=r[s])}),i}}]),e}();const xde=Uyt;function pC(e){"@babel/helpers - typeof";return pC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pC(e)}function Wyt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Aee(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Yyt(n.key),n)}}function Gyt(e,t,r){return t&&Aee(e.prototype,t),r&&Aee(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Yyt(e){var t=Kyt(e,"string");return pC(t)==="symbol"?t:String(t)}function Kyt(e,t){if(pC(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(pC(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Cde=function(){function e(t,r){var n=this,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:function(){return[]};Wyt(this,e),this.hot=t,this.conditionCollection=r,this.columnDataFactory=i,this.changes=[],this.grouping=!1,this.latestEditedColumnPosition=-1,this.latestOrderStack=[],this.conditionCollection.addLocalHook("beforeRemove",function(o){return n._onConditionBeforeModify(o)}),this.conditionCollection.addLocalHook("afterRemove",function(o){return n.updateStatesAtColumn(o)}),this.conditionCollection.addLocalHook("afterAdd",function(o){return n.updateStatesAtColumn(o)}),this.conditionCollection.addLocalHook("beforeClean",function(){return n._onConditionBeforeClean()}),this.conditionCollection.addLocalHook("afterClean",function(){return n._onConditionAfterClean()})}return Gyt(e,[{key:"groupChanges",value:function(){this.grouping=!0}},{key:"flush",value:function(){var r=this;this.grouping=!1,Fe(this.changes,function(n){r.updateStatesAtColumn(n)}),this.changes.length=0}},{key:"_onConditionBeforeModify",value:function(r){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(r)}},{key:"updateStatesAtColumn",value:function(r,n){var i=this;if(this.grouping){this.changes.indexOf(r)===-1&&this.changes.push(r);return}var o=this.conditionCollection.exportAllConditions(),s=this.conditionCollection.getColumnStackPosition(r);s===-1&&(s=this.latestEditedColumnPosition);var a=o.slice(0,s),h=o.slice(s);h.length&&h[0].column===r&&h.shift();var p=m4e(function(S,E){var O=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],A=new Sde(i.hot,!1),$=[].concat(S,O);A.importAllConditions($);var B=i.columnDataFactory(E),j;A.isEmpty()?j=B:j=new xde(A,function(W){return i.columnDataFactory(W)}).filter(),j=dn(j,function(W){return W.meta.visualRow});var z=$E(j);return A.destroy(),Us(B,function(W){return z(W.meta.visualRow)})})(a),y=[].concat(this.conditionCollection.getConditions(r));this.runLocalHooks("update",{editedConditionStack:{column:r,conditions:y},dependentConditionStacks:h,filteredRowsFactory:p,conditionArgsChange:n})}},{key:"_onConditionBeforeClean",value:function(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}},{key:"_onConditionAfterClean",value:function(){var r=this;Fe(this.latestOrderStack,function(n){r.updateStatesAtColumn(n)})}},{key:"destroy",value:function(){var r=this;this.clearLocalHooks(),mn(this,function(n,i){r[i]=null})}}]),e}();ci(Cde,Ya);const qyt=Cde;function ab(e){"@babel/helpers - typeof";return ab=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ab(e)}var Iee;function Xyt(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function Zyt(e,t){return tvt(e)||evt(e,t)||Qyt(e,t)||Jyt()}function Jyt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Qyt(e,t){if(e){if(typeof e=="string")return Mee(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Mee(e,t)}}function Mee(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function evt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],h=!0,p=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;h=!1}else for(;!(h=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);h=!0);}catch(y){p=!0,i=y}finally{try{if(!h&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(p)throw i}}return a}}function tvt(e){if(Array.isArray(e))return e}function rvt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $ee(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ivt(n.key),n)}}function nvt(e,t,r){return t&&$ee(e.prototype,t),r&&$ee(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ivt(e){var t=ovt(e,"string");return ab(t)==="symbol"?t:String(t)}function ovt(e,t){if(ab(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ab(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function pv(){return typeof Reflect<"u"&&Reflect.get?pv=Reflect.get.bind():pv=function(t,r,n){var i=avt(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},pv.apply(this,arguments)}function avt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ah(e),e!==null););return e}function svt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&$z(e,t)}function $z(e,t){return $z=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},$z(e,t)}function lvt(e){var t=cvt();return function(){var n=Ah(e),i;if(t){var o=Ah(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return uvt(this,i)}}function uvt(e,t){if(t&&(ab(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ede(e)}function Ede(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function cvt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ah(e){return Ah=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ah(e)}var Dee="filters",fvt=250,hvt=function(e){svt(r,e);var t=lvt(r);function r(n){var i;return rvt(this,r),i=t.call(this,n),i.eventManager=new Fi(Ede(i)),i.dropdownMenuPlugin=null,i.conditionCollection=null,i.conditionUpdateObserver=null,i.components=new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]]),i.filtersRowsMap=null,i.hot.addHook("afterGetColHeader",function(o,s){return i.onAfterGetColHeader(o,s)}),i}return nvt(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Dee]}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new RE),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");var o=this.hot.getSettings().dropdownMenu,s=o&&o.uiContainer||this.hot.rootDocument.body,a=function(O){return O.addLocalHook("accept",function(){return i.onActionBarSubmit("accept")}),O.addLocalHook("cancel",function(){return i.onActionBarSubmit("cancel")}),O.addLocalHook("change",function(A){return i.onComponentChange(O,A)}),O},h=function(){return"".concat(i.hot.getTranslatedPhrase(fW),":")},p=function(){return"".concat(i.hot.getTranslatedPhrase(hW),":")};if(!this.components.get("filter_by_condition")){var y=new nN(this.hot,{id:"filter_by_condition",name:h,addSeparator:!1,menuContainer:s});y.addLocalHook("afterClose",function(){return i.onSelectUIClosed()}),this.components.set("filter_by_condition",a(y))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new _gt(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){var S=new nN(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:s});S.addLocalHook("afterClose",function(){return i.onSelectUIClosed()}),this.components.set("filter_by_condition2",a(S))}this.components.get("filter_by_value")||this.components.set("filter_by_value",a(new byt(this.hot,{id:"filter_by_value",name:p}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",a(new Ayt(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new Sde(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new qyt(this.hot,this.conditionCollection,function(E){return i.getDataMapAtColumn(E)}),this.conditionUpdateObserver.addLocalHook("update",function(E){return i.updateComponents(E)})),this.components.forEach(function(E){return E.show()}),this.addHook("beforeDropdownMenuSetItems",function(E){return i.onBeforeDropdownMenuSetItems(E)}),this.addHook("afterDropdownMenuDefaultOptions",function(E){return i.onAfterDropdownMenuDefaultOptions(E)}),this.addHook("afterDropdownMenuShow",function(){return i.onAfterDropdownMenuShow()}),this.addHook("afterDropdownMenuHide",function(){return i.onAfterDropdownMenuHide()}),this.addHook("afterChange",function(E){return i.onAfterChange(E)}),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),pv(Ah(r.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){var i=this;if(this.enabled){var o;(o=this.dropdownMenuPlugin)!==null&&o!==void 0&&o.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach(function(s,a){s.destroy(),i.components.set(a,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}pv(Ah(r.prototype),"disablePlugin",this).call(this)}},{key:"addCondition",value:function(i,o,s){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:Oh,h=this.hot.toPhysicalColumn(i);this.conditionCollection.addCondition(h,{command:{key:o},args:s},a)}},{key:"removeConditions",value:function(i){var o=this.hot.toPhysicalColumn(i);this.conditionCollection.removeConditions(o)}},{key:"clearConditions",value:function(i){if(i===void 0)this.conditionCollection.clean();else{var o=this.hot.toPhysicalColumn(i);this.conditionCollection.removeConditions(o)}}},{key:"filter",value:function(){var i=this,o=this._createDataFilter(),s=!this.conditionCollection.isEmpty(),a=[],h=this.conditionCollection.exportAllConditions(),p=this.hot.runHooks("beforeFilter",h);if(p!==!1)if(s){var y=[];this.hot.batchExecution(function(){i.filtersRowsMap.clear(),a=dn(o.filter(),function(E){return E.meta.visualRow});var S=$E(a);Or(i.hot.countSourceRows()-1,function(E){S(E)||y.push(E)}),Fe(y,function(E){i.filtersRowsMap.setValueAtIndex(E,!0)})},!0),a.length||this.hot.deselectCell()}else this.filtersRowsMap.clear();this.hot.runHooks("afterFilter",h),this.hot.view.adjustElementsSize(!0),this.hot.render(),this.clearColumnSelection()}},{key:"getSelectedColumn",value:function(){var i,o=(i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight;return o?{visualIndex:o.col,physicalIndex:this.hot.toPhysicalColumn(o.col)}:null}},{key:"clearColumnSelection",value:function(){var i=this.getSelectedColumn();i!==null&&this.hot.selectCell(0,i.visualIndex)}},{key:"getDataMapAtColumn",value:function(i){var o=this,s=this.hot.toVisualColumn(i),a=[];return Fe(this.hot.getSourceDataAtCol(s),function(h,p){var y,S=o.hot.getCellMeta(p,s),E=S.row,O=S.col,A=S.visualCol,$=S.visualRow,B=S.type,j=S.instance,z=S.dateFormat,W=S.locale,Q=(y=o.hot.getDataAtCell(o.hot.toVisualRow(p),s))!==null&&y!==void 0?y:h;a.push({meta:{row:E,col:O,visualCol:A,visualRow:$,type:B,instance:j,dateFormat:z,locale:W},value:hde(Q)})}),a}},{key:"onAfterChange",value:function(i){var o=this;i&&Fe(i,function(s){var a=Zyt(s,2),h=a[1],p=o.hot.propToCol(h);o.conditionCollection.hasConditions(p)&&o.updateValueComponentCondition(p)})}},{key:"updateValueComponentCondition",value:function(i){var o=this.hot.getDataAtCol(i),s=xz(o);this.conditionUpdateObserver.updateStatesAtColumn(i,s)}},{key:"restoreComponents",value:function(i){var o,s=(o=this.getSelectedColumn())===null||o===void 0?void 0:o.physicalIndex;i.forEach(function(a){a.isHidden()||a.restoreState(s)}),this.updateDependentComponentsVisibility()}},{key:"onAfterDropdownMenuShow",value:function(){this.restoreComponents(Array.from(this.components.values()))}},{key:"onAfterDropdownMenuHide",value:function(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}},{key:"onBeforeDropdownMenuSetItems",value:function(){var i=this;this.dropdownMenuPlugin&&this.dropdownMenuPlugin.menu.addLocalHook("afterOpen",function(){i.dropdownMenuPlugin.menu.hotMenu.updateSettings({hiddenRows:!0})})}},{key:"onAfterDropdownMenuDefaultOptions",value:function(i){i.items.push({name:hn}),this.components.forEach(function(o){i.items.push(o.getMenuItemDescriptor())})}},{key:"getOperationBasedOnArguments",value:function(i,o,s,a){var h=i;return h===jA&&o.command.key!==ko&&s.command.key!==ko&&a.command.key!==ko?h=$W:a.command.key!==ko&&(o.command.key===ko||s.command.key===ko)&&(h=Oh),h}},{key:"onActionBarSubmit",value:function(i){var o;if(i==="accept"){var s=this.getSelectedColumn();if(s===null){var a;(a=this.dropdownMenuPlugin)===null||a===void 0||a.close();return}var h=s.physicalIndex,p=this.components.get("filter_by_condition").getState(),y=this.components.get("filter_by_condition2").getState(),S=this.components.get("filter_by_value").getState(),E=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),p,y,S);this.conditionUpdateObserver.groupChanges();var O=this.conditionCollection.getColumnStackPosition(h);O===-1&&(O=void 0),this.conditionCollection.removeConditions(h),p.command.key!==ko&&(this.conditionCollection.addCondition(h,p,E,O),y.command.key!==ko&&this.conditionCollection.addCondition(h,y,E,O)),S.command.key!==ko&&this.conditionCollection.addCondition(h,S,E,O),this.conditionUpdateObserver.flush(),this.components.forEach(function(A){return A.saveState(h)}),this.filtersRowsMap.clear(),this.filter()}(o=this.dropdownMenuPlugin)===null||o===void 0||o.close()}},{key:"onComponentChange",value:function(i,o){this.updateDependentComponentsVisibility(),i.constructor===nN&&!o.inputsCount&&this.setListeningDropdownMenu()}},{key:"onSelectUIClosed",value:function(){this.setListeningDropdownMenu()}},{key:"setListeningDropdownMenu",value:function(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}},{key:"updateDependentComponentsVisibility",value:function(){var i=this.components.get("filter_by_condition"),o=i.getState(),s=o.command,a=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];s.showOperators?this.showComponents.apply(this,a):this.hideComponents.apply(this,a)}},{key:"onAfterGetColHeader",value:function(i,o){var s=this.hot.toPhysicalColumn(i);this.enabled&&this.conditionCollection.hasConditions(s)?Vt(o,"htFiltersActive"):qr(o,"htFiltersActive")}},{key:"_createDataFilter",value:function(){var i=this,o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.conditionCollection;return new xde(o,function(s){return i.getDataMapAtColumn(s)})}},{key:"updateComponents",value:function(i){var o;if((o=this.dropdownMenuPlugin)!==null&&o!==void 0&&o.enabled){var s=i.editedConditionStack,a=s.conditions,h=s.column,p=a.filter(function(E){return E.name===Dp}),y=a.filter(function(E){return E.name!==Dp});if(p.length>=2||y.length>=3)ni(Jn(Iee||(Iee=Xyt([`The filter conditions have been applied properly, but couldnt be displayed visually. 
        The overall amount of conditions exceed the capability of the dropdown menu. 
        For more details see the documentation.`],[`The filter conditions have been applied properly, but couldnt be displayed visually.\\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\\x20
        For more details see the documentation.`]))));else{var S=this.conditionCollection.getOperation(h);this.components.get("filter_by_condition").updateState(y[0],h),this.components.get("filter_by_condition2").updateState(y[1],h),this.components.get("filter_operators").updateState(S,h),this.components.get("filter_by_value").updateState(i)}}}},{key:"getIndexesOfComponents",value:function(){var i=[];if(!this.dropdownMenuPlugin)return i;for(var o=this.dropdownMenuPlugin.menu,s=arguments.length,a=new Array(s),h=0;h<s;h++)a[h]=arguments[h];return Fe(a,function(p){Fe(o.menuItems,function(y,S){y.key===p.getMenuItemDescriptor().key&&i.push(S)})}),i}},{key:"changeComponentsVisibility",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(this.dropdownMenuPlugin){for(var o=this.dropdownMenuPlugin.menu,s=o.hotMenu,a=s.getPlugin("hiddenRows"),h=arguments.length,p=new Array(h>1?h-1:0),y=1;y<h;y++)p[y-1]=arguments[y];var S=this.getIndexesOfComponents.apply(this,p);i?a.showRows(S):a.hideRows(S),s.render()}}},{key:"hideComponents",value:function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];this.changeComponentsVisibility.apply(this,[!1].concat(o))}},{key:"showComponents",value:function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];this.changeComponentsVisibility.apply(this,[!0].concat(o))}},{key:"destroy",value:function(){var i=this;this.enabled&&(this.components.forEach(function(o,s){o!==null&&(o.destroy(),i.components.set(s,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),pv(Ah(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Dee}},{key:"PLUGIN_PRIORITY",get:function(){return fvt}},{key:"PLUGIN_DEPS",get:function(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}}]),r}(Yn);function mC(e){"@babel/helpers - typeof";return mC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mC(e)}function Lee(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function r1(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Lee(Object(r),!0).forEach(function(n){dvt(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Lee(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function dvt(e,t,r){return t=pvt(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function pvt(e){var t=mvt(e,"string");return mC(t)==="symbol"?t:String(t)}function mvt(e,t){if(mC(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(mC(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Tde="internal-use-in-handsontable",gvt={licenseKey:Tde,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!0,nullDate:{year:1899,month:12,day:31},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function Ode(e){var t,r;return{maxColumns:e.maxColumns,maxRows:e.maxRows,language:(t=e[ga])===null||t===void 0||(r=t.language)===null||r===void 0?void 0:r.langCode}}function Rde(e){return Object.keys(e).reduce(function(t,r){return r!=="hyperformula"&&(t[r]=e[r]),t},{})}function yvt(e){var t,r=e[ga],n=Rde(r!=null&&(t=r.engine)!==null&&t!==void 0&&t.hyperformula?r.engine:{}),i=Ode(e);return r1(r1(r1({},gvt),n),i)}function vvt(e){var t,r=e[ga],n=Rde(r!=null&&(t=r.engine)!==null&&t!==void 0&&t.hyperformula?r.engine:{}),i=Ode(e);return r1(r1({},n),i)}function Dz(e){"@babel/helpers - typeof";return Dz=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dz(e)}function IM(){var e="engine_relationship",t=Zs(ga);return t.hasItem(e)||t.register(e,new Map),t.getItem(e)}function DW(){var e="shared_engine_usage",t=Zs(ga);return t.hasItem(e)||t.register(e,new Map),t.getItem(e)}function _vt(e){var t=e.getSettings(),r=t[ga],n=r==null?void 0:r.engine;if(r===!0||ui(n))return null;if(typeof n.hyperformula=="function"||typeof n=="function"){var i;return bvt((i=n.hyperformula)!==null&&i!==void 0?i:n,t,e)}else if(Dz(n)==="object"&&ui(n.hyperformula)){var o=IM(),s=DW().get(n);return o.has(n)||o.set(n,[]),o.get(n).push(e),s&&s.push(e.guid),n.getConfig().licenseKey||n.updateConfig({licenseKey:Tde}),n}return null}function bvt(e,t,r){var n=t[ga],i=yvt(t),o=IM(),s=DW();wvt(e,n.functions),Svt(e,n.language);var a=e.buildEmpty(i);return o.set(a,[r]),s.set(a,[r.guid]),xvt(a,n.namedExpressions),a.on("sheetAdded",function(){a.rebuildAndRecalculate()}),a.on("sheetRemoved",function(){a.rebuildAndRecalculate()}),a}function Nee(e){var t,r=IM(),n=r.size===0?[]:Array.from((t=r.get(e))!==null&&t!==void 0?t:[]);return new Map(n.map(function(i){return[i.getPlugin("formulas").sheetId,i]}))}function Bee(e,t){if(e){var r=IM(),n=r.get(e),i=DW(),o=i.get(e);n&&n.includes(t)&&(n.splice(n.indexOf(t),1),n.length===0&&r.delete(e)),o&&o.includes(t.guid)&&(o.splice(o.indexOf(t.guid),1),o.length===0&&(i.delete(e),e.destroy()))}}function wvt(e,t){t&&t.forEach(function(r){var n=r.name,i=r.plugin,o=r.translations;try{e.registerFunction(n,i,o)}catch(s){ni(s.message)}})}function Svt(e,t){if(t){var r=t.langCode;try{e.registerLanguage(r,t)}catch(n){ni(n.message)}}}function xvt(e,t){t&&(e.suspendEvaluation(),t.forEach(function(r){var n=r.name,i=r.expression,o=r.scope,s=r.options;try{e.addNamedExpression(n,i,o,s)}catch(a){ni(a.message)}}),e.resumeEvaluation())}function Cvt(e,t){return(ui(t)||!e.doesSheetExist(t))&&(t=e.addSheet(t)),t}function kde(e){return typeof e=="string"&&e.charAt(0)==="'"&&e.charAt(1)==="="}function Evt(e){return kde(e)?e.substr(1):e}function Tvt(e){return kvt(e)||Rvt(e)||Pde(e)||Ovt()}function Ovt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Rvt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function kvt(e){if(Array.isArray(e))return Lz(e)}function jee(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Fee(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?jee(Object(r),!0).forEach(function(n){qk(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):jee(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function zh(e){"@babel/helpers - typeof";return zh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zh(e)}function gy(e,t){return Ivt(e)||Avt(e,t)||Pde(e,t)||Pvt()}function Pvt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Pde(e,t){if(e){if(typeof e=="string")return Lz(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Lz(e,t)}}function Lz(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Avt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],h=!0,p=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;h=!1}else for(;!(h=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);h=!0);}catch(y){p=!0,i=y}finally{try{if(!h&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(p)throw i}}return a}}function Ivt(e){if(Array.isArray(e))return e}function Mvt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function zee(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ade(n.key),n)}}function $vt(e,t,r){return t&&zee(e.prototype,t),r&&zee(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Lp(){return typeof Reflect<"u"&&Reflect.get?Lp=Reflect.get.bind():Lp=function(t,r,n){var i=Dvt(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Lp.apply(this,arguments)}function Dvt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ec(e),e!==null););return e}function Lvt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Nz(e,t)}function Nz(e,t){return Nz=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Nz(e,t)}function Nvt(e){var t=jvt();return function(){var n=Ec(e),i;if(t){var o=Ec(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Bvt(this,i)}}function Bvt(e,t){if(t&&(zh(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return cp(e)}function cp(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function jvt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ec(e){return Ec=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ec(e)}function qk(e,t,r){return t=Ade(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ade(e){var t=Fvt(e,"string");return zh(t)==="symbol"?t:String(t)}function Fvt(e,t){if(zh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(zh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function oN(e,t,r){zvt(e,t),t.set(e,r)}function zvt(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yy(e,t,r){var n=Ide(e,t,"set");return Hvt(e,n,r),r}function Hvt(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}function vy(e,t){var r=Ide(e,t,"get");return Vvt(e,r)}function Ide(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function Vvt(e,t){return t.get?t.get.call(e):t.value}var ga="formulas",Uvt=260,Hee="row_move";gr.getSingleton().register("afterNamedExpressionAdded");gr.getSingleton().register("afterNamedExpressionRemoved");gr.getSingleton().register("afterSheetAdded");gr.getSingleton().register("afterSheetRemoved");gr.getSingleton().register("afterSheetRenamed");gr.getSingleton().register("afterFormulasValuesUpdate");var _y=function(t){return t==="UndoRedo.undo"||t==="UndoRedo.redo"||t==="auto"},rp=new WeakMap,aN=new WeakMap,fS=new WeakMap,Wvt=function(e){Lvt(r,e);var t=Nvt(r);function r(){var n;Mvt(this,r);for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n=t.call.apply(t,[this].concat(o)),oN(cp(n),rp,{writable:!0,value:!1}),oN(cp(n),aN,{writable:!0,value:!1}),oN(cp(n),fS,{writable:!0,value:[["valuesUpdated",function(){var a;return(a=n).onEngineValuesUpdated.apply(a,arguments)}],["namedExpressionAdded",function(){var a;return(a=n).onEngineNamedExpressionsAdded.apply(a,arguments)}],["namedExpressionRemoved",function(){var a;return(a=n).onEngineNamedExpressionsRemoved.apply(a,arguments)}],["sheetAdded",function(){var a;return(a=n).onEngineSheetAdded.apply(a,arguments)}],["sheetRenamed",function(){var a;return(a=n).onEngineSheetRenamed.apply(a,arguments)}],["sheetRemoved",function(){var a;return(a=n).onEngineSheetRemoved.apply(a,arguments)}]]}),qk(cp(n),"staticRegister",Zs("formulas")),qk(cp(n),"engine",null),qk(cp(n),"sheetName",null),n}return $vt(r,[{key:"sheetId",get:function(){return this.sheetName===null?null:this.engine.getSheetId(this.sheetName)}},{key:"isEnabled",value:function(){return!!this.hot.getSettings()[ga]}},{key:"enablePlugin",value:function(){var i,o=this;if(!this.enabled){if(this.engine=(i=_vt(this.hot))!==null&&i!==void 0?i:this.engine,!this.engine){ni("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(this.sheetName!==null&&!this.engine.doesSheetExist(this.sheetName)){var s=this.addSheet(this.sheetName,this.hot.getSourceDataArray());s!==!1&&(this.sheetName=s)}this.addHook("beforeLoadData",function(){return o.onBeforeLoadData.apply(o,arguments)}),this.addHook("afterLoadData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.addHook("beforeUpdateData",function(){return o.onBeforeLoadData.apply(o,arguments)}),this.addHook("afterUpdateData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.addHook("modifyData",function(){return o.onModifyData.apply(o,arguments)}),this.addHook("modifySourceData",function(){return o.onModifySourceData.apply(o,arguments)}),this.addHook("beforeValidate",function(){return o.onBeforeValidate.apply(o,arguments)}),this.addHook("afterSetSourceDataAtCell",function(){return o.onAfterSetSourceDataAtCell.apply(o,arguments)}),this.addHook("afterSetDataAtCell",function(){return o.onAfterSetDataAtCell.apply(o,arguments)}),this.addHook("afterSetDataAtRowProp",function(){return o.onAfterSetDataAtCell.apply(o,arguments)}),this.addHook("beforeCreateRow",function(){return o.onBeforeCreateRow.apply(o,arguments)}),this.addHook("beforeCreateCol",function(){return o.onBeforeCreateCol.apply(o,arguments)}),this.addHook("afterCreateRow",function(){return o.onAfterCreateRow.apply(o,arguments)}),this.addHook("afterCreateCol",function(){return o.onAfterCreateCol.apply(o,arguments)}),this.addHook("beforeRemoveRow",function(){return o.onBeforeRemoveRow.apply(o,arguments)}),this.addHook("beforeRemoveCol",function(){return o.onBeforeRemoveCol.apply(o,arguments)}),this.addHook("afterRemoveRow",function(){return o.onAfterRemoveRow.apply(o,arguments)}),this.addHook("afterRemoveCol",function(){return o.onAfterRemoveCol.apply(o,arguments)}),this.addHook("beforeUndo",function(a){(a==null?void 0:a.actionType)!==Hee&&o.engine.undo()}),this.addHook("beforeRedo",function(a){(a==null?void 0:a.actionType)!==Hee&&o.engine.redo()}),this.addHook("afterDetachChild",function(){return o.onAfterDetachChild.apply(o,arguments)}),this.addHook("beforeAutofill",function(){return o.onBeforeAutofill.apply(o,arguments)}),vy(this,fS).forEach(function(a){var h=gy(a,2),p=h[0],y=h[1];return o.engine.on(p,y)}),Lp(Ec(r.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){var i=this;vy(this,fS).forEach(function(o){var s=gy(o,2),a=s[0],h=s[1];return i.engine.off(a,h)}),Bee(this.engine,this.hot),this.engine=null,Lp(Ec(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(i){this.engine.updateConfig(vvt(this.hot.getSettings()));var o=this.hot.getSettings()[ga];if(pr(o)&&pr(o.sheetName)&&o.sheetName!==this.sheetName&&this.switchSheet(o.sheetName),!i.data&&this.sheetName===null){var s=this.hot.getSettings()[ga].sheetName;s&&this.engine.doesSheetExist(s)?this.switchSheet(this.sheetName):this.sheetName=this.addSheet(s??void 0,this.hot.getSourceDataArray())}Lp(Ec(r.prototype),"updatePlugin",this).call(this,i)}},{key:"destroy",value:function(){var i=this;vy(this,fS).forEach(function(o){var s,a=gy(o,2),h=a[0],p=a[1];return(s=i.engine)===null||s===void 0?void 0:s.off(h,p)}),yy(this,fS,null),Bee(this.engine,this.hot),this.engine=null,Lp(Ec(r.prototype),"destroy",this).call(this)}},{key:"getPhysicalIndexPosition",value:function(i,o,s,a,h){return!h&&i>=s?a+(i-s):o}},{key:"toPhysicalRowPosition",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this.getPhysicalIndexPosition(i,this.hot.toPhysicalRow(i),this.hot.countRows(),this.hot.countSourceRows(),o)}},{key:"toPhysicalColumnPosition",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this.getPhysicalIndexPosition(i,this.hot.toPhysicalColumn(i),this.hot.countCols(),this.hot.countSourceCols(),o)}},{key:"addSheet",value:function(i,o){if(pr(o)&&!Aat(o))return ni("The provided data should be an array of arrays."),!1;if(i!=null&&this.engine.doesSheetExist(i))return ni("Sheet with the provided name already exists."),!1;try{var s=this.engine.addSheet(i??void 0);return o&&this.engine.setSheetContent(this.engine.getSheetId(s),o),s}catch(a){return ni(a.message),!1}}},{key:"switchSheet",value:function(i){if(!this.engine.doesSheetExist(i)){wU("The sheet named `".concat(i,"` does not exist, switch aborted."));return}this.sheetName=i;var o=this.engine.getSheetSerialized(this.sheetId);o.length>0&&this.hot.loadData(o,"".concat(Hc(ga),".switchSheet"))}},{key:"getCellType",value:function(i,o){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId,a=this.hot.toPhysicalRow(i),h=this.hot.toPhysicalColumn(o);return a!==null&&h!==null?this.engine.getCellType({sheet:s,row:a,col:h}):"EMPTY"}},{key:"isFormulaCellType",value:function(i,o){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId,a=this.hot.toPhysicalRow(i),h=this.hot.toPhysicalColumn(o);return a===null||h===null?!1:this.engine.doesCellHaveFormula({sheet:s,row:a,col:h})}},{key:"renderDependentSheets",value:function(i){var o=this,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,a=new Set;i.forEach(function(h){var p,y=h==null||(p=h.address)===null||p===void 0?void 0:p.sheet;y!==void 0&&(a.has(y)||a.add(y))}),Nee(this.engine).forEach(function(h,p){if((s||p!==o.sheetId)&&a.has(p)){var y;h.render(),(y=h.view)===null||y===void 0||y.adjustElementsSize()}})}},{key:"validateDependentCells",value:function(i){var o=this,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],a=function(y){var S,E=(S=y==null?void 0:y.address)!==null&&S!==void 0?S:{},O=E.row,A=E.col,$=E.sheet;return pr($)?"".concat($,":").concat(O,"x").concat(A):""},h=new Set(s.map(function(p){return a(p)}));i.forEach(function(p){var y,S,E=(y=p.address)!==null&&y!==void 0?y:{},O=E.row,A=E.col,$=pr(O)?o.hot.toVisualRow(O):null,B=pr(A)?o.hot.toVisualColumn(A):null;if(!($===null||B===null)){var j=p==null||(S=p.address)===null||S===void 0?void 0:S.sheet,z=a(p);if(j!==void 0&&!h.has(z)){var W=Nee(o.engine).get(j);if(!W)return;W.validateCell(W.getDataAtCell($,B),W.getCellMeta($,B),function(){})}}})}},{key:"syncChangeWithEngine",value:function(i,o,s){var a={row:this.toPhysicalRowPosition(i),col:this.toPhysicalColumnPosition(o),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(a)){ni("Not possible to set cell data at ".concat(JSON.stringify(a)));return}return this.engine.setCellContents(a,s)}},{key:"onBeforeValidate",value:function(i,o,s){var a=this.hot.propToCol(s);if(this.isFormulaCellType(o,a)){var h={row:this.hot.toPhysicalRow(o),col:this.hot.toPhysicalColumn(a),sheet:this.sheetId},p=this.engine.getCellValue(h);return zh(p)==="object"&&p!==null?p.value:p}return i}},{key:"onBeforeAutofill",value:function(i,o,s){var a=this,h=function(E){return Fee(Fee({},E),{},{sheet:a.sheetId})},p={start:h(o.getTopStartCorner()),end:h(o.getBottomEndCorner())},y={start:h(s.getTopStartCorner()),end:h(s.getBottomEndCorner())};return this.engine.isItPossibleToSetCellContents(y)===!1?!1:this.engine.getFillRangeData(p,y)}},{key:"onBeforeLoadData",value:function(i,o){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";s.includes(Hc(ga))||yy(this,aN,ui(this.hot.getSettings().data))}},{key:"onAfterLoadData",value:function(i,o){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";if(!s.includes(Hc(ga)))if(this.sheetName=Cvt(this.engine,this.hot.getSettings()[ga].sheetName),vy(this,aN))this.switchSheet(this.sheetName);else{var a=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,a)){yy(this,rp,!0);var h=this.engine.setSheetContent(this.sheetId,this.hot.getSourceDataArray());this.renderDependentSheets(h),yy(this,rp,!1)}}}},{key:"onModifyData",value:function(i,o,s,a){if(!(a!=="get"||vy(this,rp)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))){var h=this.hot.toVisualRow(i),p=this.isFormulaCellType(h,o);if(!p){var y=this.getCellType(h,o);if(y!=="ARRAY"){kde(s.value)&&(s.value=Evt(s.value));return}}var S={row:i,col:this.toPhysicalColumnPosition(o),sheet:this.sheetId},E=this.engine.getCellValue(S),O=zh(E)==="object"&&E!==null?E.value:E;s.value=O}}},{key:"onModifySourceData",value:function(i,o,s,a){if(!(a!=="get"||vy(this,rp)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))){var h=this.hot.toVisualRow(i),p=this.hot.propToCol(o),y=this.isFormulaCellType(h,p);if(!y){var S=this.getCellType(h,p);if(S!=="ARRAY")return}var E=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(!(E.width===0&&E.height===0)){var O={row:i,col:this.toPhysicalColumnPosition(p),sheet:this.sheetId};s.value=this.engine.getCellSerialized(O)}}}},{key:"onAfterSetDataAtCell",value:function(i,o){var s=this;if(!_y(o)){var a=[],h=[],p=this.engine.batch(function(){i.forEach(function(y){var S=gy(y,4),E=S[0],O=S[1],A=S[3],$=s.hot.propToCol(O),B=s.hot.toPhysicalRow(E),j=s.hot.toPhysicalColumn($),z={row:B,col:j,sheet:s.sheetId};B!==null&&j!==null?s.syncChangeWithEngine(E,$,A):a.push([E,$,A]),h.push({address:z})})});a.length&&this.hot.addHookOnce("afterChange",function(){var y=s.engine.batch(function(){a.forEach(function(S){var E=gy(S,3),O=E[0],A=E[1],$=E[2];s.syncChangeWithEngine(O,A,$)})});s.renderDependentSheets(y,!0)}),this.renderDependentSheets(p),this.validateDependentCells(p,h)}}},{key:"onAfterSetSourceDataAtCell",value:function(i,o){var s=this;if(!_y(o)){var a=[],h=[];i.forEach(function(p){var y=gy(p,4),S=y[0],E=y[1],O=y[3],A=s.hot.propToCol(E);if(Ls(A)){var $={row:S,col:s.toPhysicalColumnPosition(A),sheet:s.sheetId};if(!s.engine.isItPossibleToSetCellContents($)){ni("Not possible to set source cell data at ".concat(JSON.stringify($)));return}h.push({address:$}),a.push.apply(a,Tvt(s.engine.setCellContents($,O)))}}),this.renderDependentSheets(a),this.validateDependentCells(a,h)}}},{key:"onBeforeCreateRow",value:function(i,o){if(this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[this.toPhysicalRowPosition(i),o]))return!1}},{key:"onBeforeCreateCol",value:function(i,o){if(this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[this.toPhysicalColumnPosition(i),o]))return!1}},{key:"onBeforeRemoveRow",value:function(i,o,s){var a=this,h=s.every(function(p){return a.engine.isItPossibleToRemoveRows(a.sheetId,[p,1])});return h===!1?!1:void 0}},{key:"onBeforeRemoveCol",value:function(i,o,s){var a=this,h=s.every(function(p){return a.engine.isItPossibleToRemoveColumns(a.sheetId,[p,1])});return h===!1?!1:void 0}},{key:"onAfterCreateRow",value:function(i,o,s){if(!_y(s)){var a=this.engine.addRows(this.sheetId,[this.toPhysicalRowPosition(i),o]);this.renderDependentSheets(a)}}},{key:"onAfterCreateCol",value:function(i,o,s){if(!_y(s)){var a=this.engine.addColumns(this.sheetId,[this.toPhysicalColumnPosition(i),o]);this.renderDependentSheets(a)}}},{key:"onAfterRemoveRow",value:function(i,o,s,a){var h=this;if(!_y(a)){var p=s.sort().reverse(),y=this.engine.batch(function(){p.forEach(function(S){h.engine.removeRows(h.sheetId,[S,1])})});this.renderDependentSheets(y)}}},{key:"onAfterRemoveCol",value:function(i,o,s,a){var h=this;if(!_y(a)){var p=s.sort().reverse(),y=this.engine.batch(function(){p.forEach(function(S){h.engine.removeColumns(h.sheetId,[S,1])})});this.renderDependentSheets(y)}}},{key:"onAfterDetachChild",value:function(i,o,s){var a,h=this;yy(this,rp,!0);var p=this.hot.getSourceDataArray(s,0,s+(((a=o.__children)===null||a===void 0?void 0:a.length)||0),this.hot.countSourceCols());yy(this,rp,!1),p.forEach(function(y,S){y.forEach(function(E,O){h.engine.setCellContents({col:O,row:s+S,sheet:h.sheetId},[[E]])})})}},{key:"onEngineValuesUpdated",value:function(i){this.hot.runHooks("afterFormulasValuesUpdate",i)}},{key:"onEngineNamedExpressionsAdded",value:function(i,o){this.hot.runHooks("afterNamedExpressionAdded",i,o)}},{key:"onEngineNamedExpressionsRemoved",value:function(i,o){this.hot.runHooks("afterNamedExpressionRemoved",i,o)}},{key:"onEngineSheetAdded",value:function(i){this.hot.runHooks("afterSheetAdded",i)}},{key:"onEngineSheetRenamed",value:function(i,o){this.hot.runHooks("afterSheetRenamed",i,o)}},{key:"onEngineSheetRemoved",value:function(i,o){this.hot.runHooks("afterSheetRemoved",i,o)}}],[{key:"PLUGIN_KEY",get:function(){return ga}},{key:"PLUGIN_PRIORITY",get:function(){return Uvt}}]),r}(Yn);function Gvt(e,t){return Xvt(e)||qvt(e,t)||Kvt(e,t)||Yvt()}function Yvt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Kvt(e,t){if(e){if(typeof e=="string")return Vee(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Vee(e,t)}}function Vee(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function qvt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],h=!0,p=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;h=!1}else for(;!(h=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);h=!0);}catch(y){p=!0,i=y}finally{try{if(!h&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(p)throw i}}return a}}function Xvt(e){if(Array.isArray(e))return e}function Zvt(e){return{key:"hidden_columns_hide",name:function(){var r=this.getSelectedLast(),n=0;if(Array.isArray(r)){var i=Gvt(r,4),o=i[1],s=i[3];o-s!==0&&(n=1)}return this.getTranslatedPhrase(H4,n)},callback:function(){for(var r=this.getSelectedRangeLast(),n=r.from,i=r.to,o=Math.max(Math.min(n.col,i.col),0),s=Math.max(n.col,i.col),a=[],h=o;h<=s;h+=1)a.push(h);e.hideColumns(a);var p=a[a.length-1],y=this.columnIndexMapper.getNearestNotHiddenIndex(p,1,!0);Number.isInteger(y)&&y>=0?this.selectColumns(y):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden:function(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function VR(e){return t_t(e)||e_t(e)||Qvt(e)||Jvt()}function Jvt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Qvt(e,t){if(e){if(typeof e=="string")return Bz(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Bz(e,t)}}function e_t(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function t_t(e){if(Array.isArray(e))return Bz(e)}function Bz(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function r_t(e){var t=[];return{key:"hidden_columns_show",name:function(){var n=t.length>1?1:0;return this.getTranslatedPhrase(V4,n)},callback:function(){var n,i;if(t.length!==0){var o=t[0],s=t[t.length-1];o=(n=this.columnIndexMapper.getNearestNotHiddenIndex(o-1,-1))!==null&&n!==void 0?n:0,s=(i=this.columnIndexMapper.getNearestNotHiddenIndex(s+1,1))!==null&&i!==void 0?i:this.countCols()-1,e.showColumns(t),this.render(),this.view.adjustElementsSize(!0);var a=s-o+1===this.countCols();a||this.selectColumns(o,s)}},disabled:!1,hidden:function(){var n=this,i=dn(e.getHiddenColumns(),function(z){return n.toPhysicalColumn(z)});if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||i.length<1)return!0;t.length=0;var o=this.getSelectedRangeLast(),s=o.getTopStartCorner().col,a=o.getBottomEndCorner().col,h=this.columnIndexMapper,p=h.getRenderableFromVisualIndex(s),y=h.getRenderableFromVisualIndex(a),S=h.getNotTrimmedIndexes(),E=[];if(s!==a){var O=a-s+1,A=y-p+1;if(O>A){var $=S.slice(s,a+1);E.push.apply(E,VR($.filter(function(z){return i.includes(z)})))}}else if(p===0&&p<s)E.push.apply(E,VR(S.slice(0,s)));else if(p===null)E.push.apply(E,VR(S.slice(0,this.countCols())));else{var B=this.countCols()-1,j=h.getRenderableFromVisualIndex(h.getNearestNotHiddenIndex(B,-1));y===j&&B>a&&E.push.apply(E,VR(S.slice(a+1)))}return Fe(E,function(z){t.push(n.toVisualColumn(z))}),t.length===0}}}function sb(e){"@babel/helpers - typeof";return sb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sb(e)}function n_t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Uee(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,o_t(n.key),n)}}function i_t(e,t,r){return t&&Uee(e.prototype,t),r&&Uee(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function o_t(e){var t=a_t(e,"string");return sb(t)==="symbol"?t:String(t)}function a_t(e,t){if(sb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(sb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Np(){return typeof Reflect<"u"&&Reflect.get?Np=Reflect.get.bind():Np=function(t,r,n){var i=s_t(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Np.apply(this,arguments)}function s_t(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Tc(e),e!==null););return e}function l_t(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&jz(e,t)}function jz(e,t){return jz=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},jz(e,t)}function u_t(e){var t=f_t();return function(){var n=Tc(e),i;if(t){var o=Tc(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return c_t(this,i)}}function c_t(e,t){if(t&&(sb(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Fz(e)}function Fz(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function f_t(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Tc(e){return Tc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Tc(e)}function Wee(e,t,r){h_t(e,t),t.set(e,r)}function h_t(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function es(e,t){var r=Mde(e,t,"get");return d_t(e,r)}function d_t(e,t){return t.get?t.get.call(e):t.value}function hS(e,t,r){var n=Mde(e,t,"set");return p_t(e,n,r),r}function Mde(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function p_t(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}gr.getSingleton().register("beforeHideColumns");gr.getSingleton().register("afterHideColumns");gr.getSingleton().register("beforeUnhideColumns");gr.getSingleton().register("afterUnhideColumns");var sN="hiddenColumns",m_t=310,ou=new WeakMap,au=new WeakMap,g_t=function(e){l_t(r,e);var t=u_t(r);function r(){var n;n_t(this,r);for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n=t.call.apply(t,[this].concat(o)),Wee(Fz(n),ou,{writable:!0,value:{}}),Wee(Fz(n),au,{writable:!0,value:null}),n}return i_t(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[sN]}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){var o=this.hot.getSettings()[sN];pn(o)&&(hS(this,ou,o),ui(o.copyPasteEnabled)&&(o.copyPasteEnabled=!0)),hS(this,au,new dM),es(this,au).addLocalHook("init",function(){return i.onMapInit()}),this.hot.columnIndexMapper.registerMap(this.pluginName,es(this,au)),this.addHook("afterContextMenuDefaultOptions",function(){return i.onAfterContextMenuDefaultOptions.apply(i,arguments)}),this.addHook("afterGetCellMeta",function(s,a,h){return i.onAfterGetCellMeta(s,a,h)}),this.addHook("modifyColWidth",function(s,a){return i.onModifyColWidth(s,a)}),this.addHook("afterGetColHeader",function(){return i.onAfterGetColHeader.apply(i,arguments)}),this.addHook("modifyCopyableRange",function(s){return i.onModifyCopyableRange(s)}),Np(Tc(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Np(Tc(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),hS(this,ou,{}),Np(Tc(r.prototype),"disablePlugin",this).call(this),this.resetCellsMeta()}},{key:"showColumns",value:function(i){var o=this,s=this.getHiddenColumns(),a=this.isValidConfig(i),h=s,p=es(this,au).getValues().slice(),y=i.length>0;if(a&&y){var S=i.map(function(O){return o.hot.toPhysicalColumn(O)});Fe(S,function(O){p[O]=!1}),h=oa(p,function(O,A,$){return A&&O.push(o.hot.toVisualColumn($)),O},[])}var E=this.hot.runHooks("beforeUnhideColumns",s,h,a&&y);E!==!1&&(a&&y&&es(this,au).setValues(p),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",s,h,a&&y,a&&h.length<s.length))}},{key:"showColumn",value:function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];this.showColumns(o)}},{key:"hideColumns",value:function(i){var o=this,s=this.getHiddenColumns(),a=this.isValidConfig(i),h=s;a&&(h=Array.from(new Set(s.concat(i))));var p=this.hot.runHooks("beforeHideColumns",s,h,a);p!==!1&&(a&&this.hot.batchExecution(function(){Fe(i,function(y){es(o,au).setValueAtIndex(o.hot.toPhysicalColumn(y),!0)})},!0),this.hot.runHooks("afterHideColumns",s,h,a,a&&h.length>s.length))}},{key:"hideColumn",value:function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];this.hideColumns(o)}},{key:"getHiddenColumns",value:function(){var i=this;return dn(es(this,au).getHiddenIndexes(),function(o){return i.hot.toVisualColumn(o)})}},{key:"isHidden",value:function(i){return es(this,au).getValueAtIndex(this.hot.toPhysicalColumn(i))||!1}},{key:"isValidConfig",value:function(i){var o=this.hot.countCols();return Array.isArray(i)&&i.length>0?i.every(function(s){return Number.isInteger(s)&&s>=0&&s<o}):!1}},{key:"resetCellsMeta",value:function(){Fe(this.hot.getCellsMeta(),function(i){i&&(i.skipColumnOnPaste=!1)})}},{key:"onModifyColWidth",value:function(i,o){if(this.isHidden(o))return 0;if(es(this,ou).indicators&&(this.isHidden(o+1)||this.isHidden(o-1))&&typeof i=="number"&&this.hot.hasColHeaders())return i+15}},{key:"onAfterGetCellMeta",value:function(i,o,s){if(es(this,ou).copyPasteEnabled===!1&&this.isHidden(o)&&(s.skipColumnOnPaste=!0),this.isHidden(o-1))s.className=s.className||"",s.className.indexOf("afterHiddenColumn")===-1&&(s.className+=" afterHiddenColumn");else if(s.className){var a=s.className.split(" ");if(a.length>0){var h=a.indexOf("afterHiddenColumn");h>-1&&a.splice(h,1),s.className=a.join(" ")}}}},{key:"onModifyCopyableRange",value:function(i){var o=this;if(es(this,ou).copyPasteEnabled)return i;var s=[],a=function(p,y,S,E){s.push({startRow:p,endRow:y,startCol:S,endCol:E})};return Fe(i,function(h){var p=!0,y=0;Or(h.startCol,h.endCol,function(S){o.isHidden(S)?(p||a(h.startRow,h.endRow,y,S-1),p=!0):(p&&(y=S),S===h.endCol&&a(h.startRow,h.endRow,y,S),p=!1)})}),s}},{key:"onAfterGetColHeader",value:function(i,o){if(!(!es(this,ou).indicators||i<0)){var s=[];i>=1&&this.isHidden(i-1)&&s.push("afterHiddenColumn"),i<this.hot.countCols()-1&&this.isHidden(i+1)&&s.push("beforeHiddenColumn"),Vt(o,s)}}},{key:"onAfterContextMenuDefaultOptions",value:function(i){i.items.push({name:hn},Zvt(this),r_t(this))}},{key:"onMapInit",value:function(){Array.isArray(es(this,ou).columns)&&this.hideColumns(es(this,ou).columns)}},{key:"destroy",value:function(){hS(this,ou,null),hS(this,au,null),Np(Tc(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return sN}},{key:"PLUGIN_PRIORITY",get:function(){return m_t}}]),r}(Yn);function y_t(e,t){return w_t(e)||b_t(e,t)||__t(e,t)||v_t()}function v_t(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function __t(e,t){if(e){if(typeof e=="string")return Gee(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Gee(e,t)}}function Gee(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function b_t(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],h=!0,p=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;h=!1}else for(;!(h=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);h=!0);}catch(y){p=!0,i=y}finally{try{if(!h&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(p)throw i}}return a}}function w_t(e){if(Array.isArray(e))return e}function S_t(e){return{key:"hidden_rows_hide",name:function(){var r=this.getSelectedLast(),n=0;if(Array.isArray(r)){var i=y_t(r,3),o=i[0],s=i[2];o-s!==0&&(n=1)}return this.getTranslatedPhrase(U4,n)},callback:function(){for(var r=this.getSelectedRangeLast(),n=r.from,i=r.to,o=Math.max(Math.min(n.row,i.row),0),s=Math.max(n.row,i.row),a=[],h=o;h<=s;h+=1)a.push(h);e.hideRows(a);var p=a[a.length-1],y=this.rowIndexMapper.getNearestNotHiddenIndex(p,1,!0);Number.isInteger(y)&&y>=0?this.selectRows(y):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden:function(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function UR(e){return T_t(e)||E_t(e)||C_t(e)||x_t()}function x_t(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function C_t(e,t){if(e){if(typeof e=="string")return zz(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return zz(e,t)}}function E_t(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function T_t(e){if(Array.isArray(e))return zz(e)}function zz(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function O_t(e){var t=[];return{key:"hidden_rows_show",name:function(){var n=t.length>1?1:0;return this.getTranslatedPhrase(W4,n)},callback:function(){var n,i;if(t.length!==0){var o=t[0],s=t[t.length-1];o=(n=this.rowIndexMapper.getNearestNotHiddenIndex(o-1,-1))!==null&&n!==void 0?n:0,s=(i=this.rowIndexMapper.getNearestNotHiddenIndex(s+1,1))!==null&&i!==void 0?i:this.countRows()-1,e.showRows(t),this.render(),this.view.adjustElementsSize(!0);var a=s-o+1===this.countRows();a||this.selectRows(o,s)}},disabled:!1,hidden:function(){var n=this,i=dn(e.getHiddenRows(),function(z){return n.toPhysicalRow(z)});if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||i.length<1)return!0;t.length=0;var o=this.getSelectedRangeLast(),s=o.getTopStartCorner().row,a=o.getBottomEndCorner().row,h=this.rowIndexMapper,p=h.getRenderableFromVisualIndex(s),y=h.getRenderableFromVisualIndex(a),S=h.getNotTrimmedIndexes(),E=[];if(s!==a){var O=a-s+1,A=y-p+1;if(O>A){var $=S.slice(s,a+1);E.push.apply(E,UR($.filter(function(z){return i.includes(z)})))}}else if(p===0&&p<s)E.push.apply(E,UR(S.slice(0,s)));else if(p===null)E.push.apply(E,UR(S.slice(0,this.countRows())));else{var B=this.countRows()-1,j=h.getRenderableFromVisualIndex(h.getNearestNotHiddenIndex(B,-1));y===j&&B>a&&E.push.apply(E,UR(S.slice(a+1)))}return Fe(E,function(z){t.push(n.toVisualRow(z))}),t.length===0}}}function lb(e){"@babel/helpers - typeof";return lb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lb(e)}function R_t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Yee(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,P_t(n.key),n)}}function k_t(e,t,r){return t&&Yee(e.prototype,t),r&&Yee(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function P_t(e){var t=A_t(e,"string");return lb(t)==="symbol"?t:String(t)}function A_t(e,t){if(lb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(lb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Bp(){return typeof Reflect<"u"&&Reflect.get?Bp=Reflect.get.bind():Bp=function(t,r,n){var i=I_t(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Bp.apply(this,arguments)}function I_t(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Oc(e),e!==null););return e}function M_t(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Hz(e,t)}function Hz(e,t){return Hz=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Hz(e,t)}function $_t(e){var t=L_t();return function(){var n=Oc(e),i;if(t){var o=Oc(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return D_t(this,i)}}function D_t(e,t){if(t&&(lb(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Vz(e)}function Vz(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function L_t(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Oc(e){return Oc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Oc(e)}function Kee(e,t,r){N_t(e,t),t.set(e,r)}function N_t(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function As(e,t){var r=$de(e,t,"get");return B_t(e,r)}function B_t(e,t){return t.get?t.get.call(e):t.value}function dS(e,t,r){var n=$de(e,t,"set");return j_t(e,n,r),r}function $de(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function j_t(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}gr.getSingleton().register("beforeHideRows");gr.getSingleton().register("afterHideRows");gr.getSingleton().register("beforeUnhideRows");gr.getSingleton().register("afterUnhideRows");var lN="hiddenRows",F_t=320,Zu=new WeakMap,su=new WeakMap,z_t=function(e){M_t(r,e);var t=$_t(r);function r(){var n;R_t(this,r);for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n=t.call.apply(t,[this].concat(o)),Kee(Vz(n),Zu,{writable:!0,value:{}}),Kee(Vz(n),su,{writable:!0,value:null}),n}return k_t(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[lN]}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){var o=this.hot.getSettings()[lN];pn(o)&&(dS(this,Zu,o),ui(o.copyPasteEnabled)&&(o.copyPasteEnabled=!0)),dS(this,su,new dM),As(this,su).addLocalHook("init",function(){return i.onMapInit()}),this.hot.rowIndexMapper.registerMap(this.pluginName,As(this,su)),this.addHook("afterContextMenuDefaultOptions",function(){return i.onAfterContextMenuDefaultOptions.apply(i,arguments)}),this.addHook("afterGetCellMeta",function(s,a,h){return i.onAfterGetCellMeta(s,a,h)}),this.addHook("modifyRowHeight",function(s,a){return i.onModifyRowHeight(s,a)}),this.addHook("afterGetRowHeader",function(){return i.onAfterGetRowHeader.apply(i,arguments)}),this.addHook("modifyCopyableRange",function(s){return i.onModifyCopyableRange(s)}),Bp(Oc(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Bp(Oc(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap(this.pluginName),dS(this,Zu,{}),Bp(Oc(r.prototype),"disablePlugin",this).call(this),this.resetCellsMeta()}},{key:"showRows",value:function(i){var o=this,s=this.getHiddenRows(),a=this.isValidConfig(i),h=s,p=As(this,su).getValues().slice(),y=i.length>0;if(a&&y){var S=i.map(function(O){return o.hot.toPhysicalRow(O)});Fe(S,function(O){p[O]=!1}),h=oa(p,function(O,A,$){return A&&O.push(o.hot.toVisualRow($)),O},[])}var E=this.hot.runHooks("beforeUnhideRows",s,h,a&&y);E!==!1&&(a&&y&&As(this,su).setValues(p),this.hot.runHooks("afterUnhideRows",s,h,a&&y,a&&h.length<s.length))}},{key:"showRow",value:function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];this.showRows(o)}},{key:"hideRows",value:function(i){var o=this,s=this.getHiddenRows(),a=this.isValidConfig(i),h=s;a&&(h=Array.from(new Set(s.concat(i))));var p=this.hot.runHooks("beforeHideRows",s,h,a);p!==!1&&(a&&this.hot.batchExecution(function(){Fe(i,function(y){As(o,su).setValueAtIndex(o.hot.toPhysicalRow(y),!0)})},!0),this.hot.runHooks("afterHideRows",s,h,a,a&&h.length>s.length))}},{key:"hideRow",value:function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];this.hideRows(o)}},{key:"getHiddenRows",value:function(){var i=this;return dn(As(this,su).getHiddenIndexes(),function(o){return i.hot.toVisualRow(o)})}},{key:"isHidden",value:function(i){return As(this,su).getValueAtIndex(this.hot.toPhysicalRow(i))||!1}},{key:"isValidConfig",value:function(i){var o=this.hot.countRows();return Array.isArray(i)&&i.length>0?i.every(function(s){return Number.isInteger(s)&&s>=0&&s<o}):!1}},{key:"resetCellsMeta",value:function(){Fe(this.hot.getCellsMeta(),function(i){i&&(i.skipRowOnPaste=!1)})}},{key:"onModifyRowHeight",value:function(i,o){return this.isHidden(o)?0:i}},{key:"onAfterGetCellMeta",value:function(i,o,s){if(As(this,Zu).copyPasteEnabled===!1&&this.isHidden(i)&&(s.skipRowOnPaste=!0),this.isHidden(i-1))s.className=s.className||"",s.className.indexOf("afterHiddenRow")===-1&&(s.className+=" afterHiddenRow");else if(s.className){var a=s.className.split(" ");if(a.length>0){var h=a.indexOf("afterHiddenRow");h>-1&&a.splice(h,1),s.className=a.join(" ")}}}},{key:"onModifyCopyableRange",value:function(i){var o=this;if(As(this,Zu).copyPasteEnabled)return i;var s=[],a=function(p,y,S,E){s.push({startRow:p,endRow:y,startCol:S,endCol:E})};return Fe(i,function(h){var p=!0,y=0;Or(h.startRow,h.endRow,function(S){o.isHidden(S)?(p||a(y,S-1,h.startCol,h.endCol),p=!0):(p&&(y=S),S===h.endRow&&a(y,S,h.startCol,h.endCol),p=!1)})}),s}},{key:"onAfterGetRowHeader",value:function(i,o){if(!(!As(this,Zu).indicators||i<0)){var s=[];i>=1&&this.isHidden(i-1)&&s.push("afterHiddenRow"),i<this.hot.countRows()-1&&this.isHidden(i+1)&&s.push("beforeHiddenRow"),Vt(o,s)}}},{key:"onAfterContextMenuDefaultOptions",value:function(i){i.items.push({name:hn},S_t(this),O_t(this))}},{key:"onMapInit",value:function(){Array.isArray(As(this,Zu).rows)&&this.hideRows(As(this,Zu).rows)}},{key:"destroy",value:function(){dS(this,Zu,null),dS(this,su,null),Bp(Oc(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return lN}},{key:"PLUGIN_PRIORITY",get:function(){return F_t}}]),r}(Yn);function H_t(e,t){return G_t(e)||W_t(e,t)||U_t(e,t)||V_t()}function V_t(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function U_t(e,t){if(e){if(typeof e=="string")return qee(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return qee(e,t)}}function qee(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function W_t(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],h=!0,p=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;h=!1}else for(;!(h=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);h=!0);}catch(y){p=!0,i=y}finally{try{if(!h&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(p)throw i}}return a}}function G_t(e){if(Array.isArray(e))return e}function Y_t(e){return{key:"freeze_column",name:function(){return this.getTranslatedPhrase(v4)},callback:function(r,n){var i=H_t(n,1),o=i[0].start.col;e.freezeColumn(o),this.render(),this.view.adjustElementsSize(!0)},hidden:function(){var r=this.getSelectedRange(),n=!1;return(r===void 0||r.length>1||r[0].from.col!==r[0].to.col||r[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(n=!0),n}}}function K_t(e,t){return J_t(e)||Z_t(e,t)||X_t(e,t)||q_t()}function q_t(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function X_t(e,t){if(e){if(typeof e=="string")return Xee(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Xee(e,t)}}function Xee(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Z_t(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],h=!0,p=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;h=!1}else for(;!(h=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);h=!0);}catch(y){p=!0,i=y}finally{try{if(!h&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(p)throw i}}return a}}function J_t(e){if(Array.isArray(e))return e}function Q_t(e){return{key:"unfreeze_column",name:function(){return this.getTranslatedPhrase(_4)},callback:function(r,n){var i=K_t(n,1),o=i[0].start.col;e.unfreezeColumn(o),this.render(),this.view.adjustElementsSize(!0)},hidden:function(){var r=this.getSelectedRange(),n=!1;return(r===void 0||r.length>1||r[0].from.col!==r[0].to.col||r[0].from.col>=this.getSettings().fixedColumnsStart)&&(n=!0),n}}}function ub(e){"@babel/helpers - typeof";return ub=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ub(e)}function ebt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Zee(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,rbt(n.key),n)}}function tbt(e,t,r){return t&&Zee(e.prototype,t),r&&Zee(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function rbt(e){var t=nbt(e,"string");return ub(t)==="symbol"?t:String(t)}function nbt(e,t){if(ub(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ub(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function mv(){return typeof Reflect<"u"&&Reflect.get?mv=Reflect.get.bind():mv=function(t,r,n){var i=ibt(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},mv.apply(this,arguments)}function ibt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ih(e),e!==null););return e}function obt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Uz(e,t)}function Uz(e,t){return Uz=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Uz(e,t)}function abt(e){var t=lbt();return function(){var n=Ih(e),i;if(t){var o=Ih(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return sbt(this,i)}}function sbt(e,t){if(t&&(ub(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Dde(e)}function Dde(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function lbt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ih(e){return Ih=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ih(e)}gr.getSingleton().register("beforeColumnFreeze");gr.getSingleton().register("afterColumnFreeze");gr.getSingleton().register("beforeColumnUnfreeze");gr.getSingleton().register("afterColumnUnfreeze");var Jee="manualColumnFreeze",ubt=110,pS=new WeakMap,cbt=function(e){obt(r,e);var t=abt(r);function r(n){var i;return ebt(this,r),i=t.call(this,n),pS.set(Dde(i),{afterFirstUse:!1}),i}return tbt(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Jee]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.addHook("afterContextMenuDefaultOptions",function(o){return i.addContextMenuEntry(o)}),this.addHook("beforeColumnMove",function(o,s){return i.onBeforeColumnMove(o,s)}),mv(Ih(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var i=pS.get(this);i.afterFirstUse=!1,mv(Ih(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),mv(Ih(r.prototype),"updatePlugin",this).call(this)}},{key:"freezeColumn",value:function(i){var o=pS.get(this),s=this.hot.getSettings(),a=s.fixedColumnsStart<this.hot.countCols()&&i>s.fixedColumnsStart-1;o.afterFirstUse||(o.afterFirstUse=!0);var h=this.hot.runHooks("beforeColumnFreeze",i,a);h!==!1&&(a&&(this.hot.columnIndexMapper.moveIndexes(i,s.fixedColumnsStart),s._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",i,a))}},{key:"unfreezeColumn",value:function(i){var o=pS.get(this),s=this.hot.getSettings(),a=s.fixedColumnsStart>0&&i<=s.fixedColumnsStart-1;o.afterFirstUse||(o.afterFirstUse=!0);var h=this.hot.runHooks("beforeColumnUnfreeze",i,a);h!==!1&&(a&&(s._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(i,s.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",i,a))}},{key:"addContextMenuEntry",value:function(i){i.items.push({name:"---------"},Y_t(this),Q_t(this))}},{key:"onBeforeColumnMove",value:function(i,o){var s=pS.get(this);if(s.afterFirstUse){var a=this.hot.getSettings().fixedColumnsStart;if(o<a||i.some(function(h){return h<a}))return!1}}}],[{key:"PLUGIN_KEY",get:function(){return Jee}},{key:"PLUGIN_PRIORITY",get:function(){return ubt}}]),r}(Yn);function gC(e){"@babel/helpers - typeof";return gC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gC(e)}function fbt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Qee(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,dbt(n.key),n)}}function hbt(e,t,r){return t&&Qee(e.prototype,t),r&&Qee(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function dbt(e){var t=pbt(e,"string");return gC(t)==="symbol"?t:String(t)}function pbt(e,t){if(gC(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(gC(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var uN=0,ete=1,tte=2,by="px",mbt=function(){function e(t){fbt(this,e),this.hot=t,this._element=null,this.state=uN,this.inlineProperty=t.isRtl()?"right":"left"}return hbt(e,[{key:"appendTo",value:function(r){r.appendChild(this._element),this.state=tte}},{key:"build",value:function(){this.state===uN&&(this._element=this.hot.rootDocument.createElement("div"),this.state=ete)}},{key:"destroy",value:function(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=uN}},{key:"isAppended",value:function(){return this.state===tte}},{key:"isBuilt",value:function(){return this.state>=ete}},{key:"setPosition",value:function(r,n){Ls(r)&&(this._element.style.top=r+by),Ls(n)&&(this._element.style[this.inlineProperty]=n+by)}},{key:"getPosition",value:function(){var r=this._element.style;return{top:r.top?parseInt(r.top,10):0,start:r[this.inlineProperty]?parseInt(r[this.inlineProperty],10):0}}},{key:"setSize",value:function(r,n){Ls(r)&&(this._element.style.width=r+by),Ls(n)&&(this._element.style.height=n+by)}},{key:"getSize",value:function(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}},{key:"setOffset",value:function(r,n){Ls(r)&&(this._element.style.marginTop=r+by),Ls(n)&&(this._element.style["margin".concat(Hc(this.inlineProperty))]=n+by)}},{key:"getOffset",value:function(){var r=this._element.style,n="margin".concat(Hc(this.inlineProperty));return{top:r.marginTop?parseInt(r.marginTop,10):0,start:r[n]?parseInt(r[n],10):0}}}]),e}();const Lde=mbt;function cb(e){"@babel/helpers - typeof";return cb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cb(e)}function gbt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function rte(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,vbt(n.key),n)}}function ybt(e,t,r){return t&&rte(e.prototype,t),r&&rte(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function vbt(e){var t=_bt(e,"string");return cb(t)==="symbol"?t:String(t)}function _bt(e,t){if(cb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(cb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Xk(){return typeof Reflect<"u"&&Reflect.get?Xk=Reflect.get.bind():Xk=function(t,r,n){var i=bbt(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Xk.apply(this,arguments)}function bbt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=fb(e),e!==null););return e}function wbt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Wz(e,t)}function Wz(e,t){return Wz=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Wz(e,t)}function Sbt(e){var t=Ebt();return function(){var n=fb(e),i;if(t){var o=fb(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return xbt(this,i)}}function xbt(e,t){if(t&&(cb(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Cbt(e)}function Cbt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ebt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function fb(e){return fb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},fb(e)}var Tbt="ht__manualColumnMove--backlight",Obt=function(e){wbt(r,e);var t=Sbt(r);function r(){return gbt(this,r),t.apply(this,arguments)}return ybt(r,[{key:"build",value:function(){Xk(fb(r.prototype),"build",this).call(this),Vt(this._element,Tbt)}}]),r}(Lde);const Rbt=Obt;function hb(e){"@babel/helpers - typeof";return hb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hb(e)}function kbt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function nte(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Abt(n.key),n)}}function Pbt(e,t,r){return t&&nte(e.prototype,t),r&&nte(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Abt(e){var t=Ibt(e,"string");return hb(t)==="symbol"?t:String(t)}function Ibt(e,t){if(hb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(hb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Zk(){return typeof Reflect<"u"&&Reflect.get?Zk=Reflect.get.bind():Zk=function(t,r,n){var i=Mbt(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Zk.apply(this,arguments)}function Mbt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=db(e),e!==null););return e}function $bt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Gz(e,t)}function Gz(e,t){return Gz=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Gz(e,t)}function Dbt(e){var t=Bbt();return function(){var n=db(e),i;if(t){var o=db(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Lbt(this,i)}}function Lbt(e,t){if(t&&(hb(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Nbt(e)}function Nbt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Bbt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function db(e){return db=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},db(e)}var jbt="ht__manualColumnMove--guideline",Fbt=function(e){$bt(r,e);var t=Dbt(r);function r(){return kbt(this,r),t.apply(this,arguments)}return Pbt(r,[{key:"build",value:function(){Zk(db(r.prototype),"build",this).call(this),Vt(this._element,jbt)}}]),r}(Lde);const zbt=Fbt;function pb(e){"@babel/helpers - typeof";return pb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pb(e)}function Hbt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ite(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ubt(n.key),n)}}function Vbt(e,t,r){return t&&ite(e.prototype,t),r&&ite(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ubt(e){var t=Wbt(e,"string");return pb(t)==="symbol"?t:String(t)}function Wbt(e,t){if(pb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(pb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function jp(){return typeof Reflect<"u"&&Reflect.get?jp=Reflect.get.bind():jp=function(t,r,n){var i=Gbt(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},jp.apply(this,arguments)}function Gbt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Rc(e),e!==null););return e}function Ybt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Yz(e,t)}function Yz(e,t){return Yz=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Yz(e,t)}function Kbt(e){var t=Xbt();return function(){var n=Rc(e),i;if(t){var o=Rc(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return qbt(this,i)}}function qbt(e,t){if(t&&(pb(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Kz(e)}function Kz(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Xbt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Rc(e){return Rc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Rc(e)}gr.getSingleton().register("beforeColumnMove");gr.getSingleton().register("afterColumnMove");var cN="manualColumnMove",Zbt=120,Yf=new WeakMap,ote="ht__manualColumnMove",WR="show-ui",fN="on-moving--columns",hN="after-selection--columns",Jbt=function(e){Ybt(r,e);var t=Kbt(r);function r(n){var i;return Hbt(this,r),i=t.call(this,n),Yf.set(Kz(i),{columnsToMove:[],countCols:0,fixedColumns:0,pressed:void 0,target:{eventPageX:void 0,coords:void 0,TD:void 0,col:void 0},cachedDropIndex:void 0}),i.eventManager=new Fi(Kz(i)),i.backlight=new Rbt(n),i.guideline=new zbt(n),i}return Vbt(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[cN]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){return i.onBeforeOnCellMouseDown.apply(i,arguments)}),this.addHook("beforeOnCellMouseOver",function(){return i.onBeforeOnCellMouseOver.apply(i,arguments)}),this.addHook("afterScrollVertically",function(){return i.onAfterScrollVertically()}),this.addHook("afterLoadData",function(){return i.onAfterLoadData.apply(i,arguments)}),this.buildPluginUI(),this.registerEvents(),Vt(this.hot.rootElement,ote),jp(Rc(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),jp(Rc(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){qr(this.hot.rootElement,ote),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),jp(Rc(r.prototype),"disablePlugin",this).call(this)}},{key:"moveColumn",value:function(i,o){return this.moveColumns([i],o)}},{key:"moveColumns",value:function(i,o){var s=Yf.get(this),a=s.cachedDropIndex,h=this.isMovePossible(i,o),p=this.hot.runHooks("beforeColumnMove",i,o,a,h);if(s.cachedDropIndex=void 0,p!==!1){h&&this.hot.columnIndexMapper.moveIndexes(i,o);var y=h&&this.isColumnOrderChanged(i,o);return this.hot.runHooks("afterColumnMove",i,o,a,h,y),y}}},{key:"dragColumn",value:function(i,o){return this.dragColumns([i],o)}},{key:"dragColumns",value:function(i,o){var s=this.countFinalIndex(i,o),a=Yf.get(this);return a.cachedDropIndex=o,this.moveColumns(i,s)}},{key:"isMovePossible",value:function(i,o){var s=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),a=i.length+o>s,h=o<0,p=i.some(function(S){return S<0}),y=i.some(function(S){return S>=s});return!(a||h||p||y)}},{key:"isColumnOrderChanged",value:function(i,o){return i.some(function(s,a){return s-a!==o})}},{key:"countFinalIndex",value:function(i,o){var s=oa(i,function(a,h){return h<o&&(a+=1),a},0);return o-s}},{key:"getColumnsWidth",value:function(i,o){for(var s=this.hot.columnIndexMapper,a=0,h=i;h<=o;h+=1){var p=s.getRenderableFromVisualIndex(h);h<0?a+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:p!==null&&(a+=this.hot.view._wt.wtTable.getStretchedColumnWidth(p)||0)}return a}},{key:"moveBySettingsOrLoad",value:function(){var i=this.hot.getSettings()[cN];if(Array.isArray(i))this.moveColumns(i,0);else if(i!==void 0){var o=this.persistentStateLoad();o.length&&this.moveColumns(o,0)}}},{key:"isFixedColumnsStart",value:function(i){return i<this.hot.getSettings().fixedColumnsStart}},{key:"persistentStateSave",value:function(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}},{key:"persistentStateLoad",value:function(){var i={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",i),i.value?i.value:[]}},{key:"prepareColumnsToMoving",value:function(i,o){var s=[];return Or(i,o,function(a){s.push(a)}),s}},{key:"refreshPositions",value:function(){var i=Yf.get(this),o=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(i.hoveredColumn)&&o>0&&this.hot.scrollViewportTo(void 0,this.hot.columnIndexMapper.getNearestNotHiddenIndex(o-1,-1));var s=this.hot.view._wt.wtTable,a=this.hot.view._wt.wtOverlays.scrollableElement,h=typeof a.scrollX=="number"?a.scrollX:a.scrollLeft,p=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,i.hoveredColumn-1),y=s.hider.offsetWidth,S=s.TBODY.offsetLeft,E=this.backlight.getOffset().start,O=this.backlight.getSize().width,A=0,$=0;if(this.hot.isRtl()){var B=this.hot.rootWindow,j=ii(this.hot.rootElement),z=B.innerWidth-i.rootElementOffset-j;$=B.innerWidth-i.target.eventPageX-z-(a.scrollX===void 0?h:0)}else $=i.target.eventPageX-(i.rootElementOffset-(a.scrollX===void 0?h:0));if(i.hasRowHeaders&&(A=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(i.hoveredColumn)&&(p+=h),p+=A,i.hoveredColumn<0)i.fixedColumnsStart>0?i.target.col=0:i.target.col=o>0?o-1:o;else if(i.target.TD.offsetWidth/2+p<=$){var W=i.hoveredColumn>=i.countCols?i.countCols-1:i.hoveredColumn;i.target.col=W+1,p+=i.target.TD.offsetWidth}else i.target.col=i.hoveredColumn;var Q=$,q=p;$+O+E>=y?Q=y-O-E:$+E<S+A&&(Q=S+A+Math.abs(E)),p>=y-1?q=y-1:q===0?q=1:a.scrollX!==void 0&&i.hoveredColumn<i.fixedColumnsStart&&(q-=i.rootElementOffset<=a.scrollX?i.rootElementOffset:0),this.backlight.setPosition(null,Q),this.guideline.setPosition(null,q)}},{key:"registerEvents",value:function(){var i=this,o=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(o,"mousemove",function(s){return i.onMouseMove(s)}),this.eventManager.addEventListener(o,"mouseup",function(){return i.onMouseUp()})}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"onBeforeOnCellMouseDown",value:function(i,o,s,a){var h=this.hot.view._wt.wtTable,p=this.hot.selection.isSelectedByColumnHeader(),y=this.hot.getSelectedRangeLast(),S=Yf.get(this),E=Wr(i.target,"sortAction");if(!y||!p||S.pressed||i.button!==0||E){S.pressed=!1,S.columnsToMove.length=0,qr(this.hot.rootElement,[fN,WR]);return}var O=this.guideline.isBuilt()&&!this.guideline.isAppended(),A=this.backlight.isBuilt()&&!this.backlight.isAppended();O&&A&&(this.guideline.appendTo(h.hider),this.backlight.appendTo(h.hider));var $=y.from,B=y.to,j=Math.min($.col,B.col),z=Math.max($.col,B.col);if(o.row<0&&o.col>=j&&o.col<=z){a.column=!0,S.pressed=!0,S.target.eventPageX=i.pageX,S.target.eventOffsetX=i.offsetX,S.hoveredColumn=o.col,S.target.TD=s,S.target.col=o.col,S.columnsToMove=this.prepareColumnsToMoving(j,z),S.hasRowHeaders=!!this.hot.getSettings().rowHeaders,S.countCols=this.hot.countCols(),S.fixedColumnsStart=this.hot.getSettings().fixedColumnsStart,S.rootElementOffset=ao(this.hot.rootElement).left;var W=S.hasRowHeaders?-1:0,Q=h.holder.scrollTop+h.getColumnHeaderHeight(0)+1,q=o.col<S.fixedColumnsStart,Se=Math.abs(this.hot.view._wt.wtOverlays.inlineStartOverlay.getScrollPosition()),Ie=Math.abs(i.offsetX-(this.hot.isRtl()?i.target.offsetWidth:0)),He=this.getColumnsWidth(j,o.col-1)+Ie,Le=this.getColumnsWidth(W,j-1)+(q?Se:0)+He;this.backlight.setPosition(Q,Le),this.backlight.setSize(this.getColumnsWidth(j,z),h.hider.offsetHeight-Q),this.backlight.setOffset(null,-He),Vt(this.hot.rootElement,fN)}else qr(this.hot.rootElement,hN),S.pressed=!1,S.columnsToMove.length=0}},{key:"onMouseMove",value:function(i){var o=Yf.get(this);if(o.pressed){if(i.target===this.backlight.element){var s=this.backlight.getSize().width;this.backlight.setSize(0),setTimeout(function(){this.backlight.setPosition(s)})}o.target.eventPageX=i.pageX,this.refreshPositions()}}},{key:"onBeforeOnCellMouseOver",value:function(i,o,s,a){var h=this.hot.getSelectedRangeLast(),p=Yf.get(this);!h||!p.pressed||(p.columnsToMove.indexOf(o.col)>-1?qr(this.hot.rootElement,WR):Vt(this.hot.rootElement,WR),a.row=!0,a.column=!0,a.cell=!0,p.hoveredColumn=o.col,p.target.TD=s)}},{key:"onMouseUp",value:function(){var i=Yf.get(this),o=i.target.col,s=i.columnsToMove.length;if(i.hoveredColumn=void 0,i.pressed=!1,i.backlightWidth=0,qr(this.hot.rootElement,[fN,WR,hN]),this.hot.selection.isSelectedByColumnHeader()&&Vt(this.hot.rootElement,hN),!(s<1||o===void 0)){var a=i.columnsToMove[0],h=this.hot.toPhysicalColumn(a),p=this.dragColumns(i.columnsToMove,o);if(i.columnsToMove.length=0,p===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);var y=this.hot.toVisualColumn(h),S=y+s-1;this.hot.selectColumns(y,S)}}}},{key:"onAfterScrollVertically",value:function(){var i=this.hot.view._wt.wtTable,o=i.getColumnHeaderHeight(0)+1,s=i.holder.scrollTop,a=o+s;this.backlight.setPosition(a),this.backlight.setSize(null,i.hider.offsetHeight-a)}},{key:"buildPluginUI",value:function(){this.backlight.build(),this.guideline.build()}},{key:"onAfterLoadData",value:function(){this.moveBySettingsOrLoad()}},{key:"destroy",value:function(){this.backlight.destroy(),this.guideline.destroy(),jp(Rc(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return cN}},{key:"PLUGIN_PRIORITY",get:function(){return Zbt}}]),r}(Yn);function mb(e){"@babel/helpers - typeof";return mb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mb(e)}function Qbt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ate(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,twt(n.key),n)}}function ewt(e,t,r){return t&&ate(e.prototype,t),r&&ate(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function twt(e){var t=rwt(e,"string");return mb(t)==="symbol"?t:String(t)}function rwt(e,t){if(mb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(mb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Fp(){return typeof Reflect<"u"&&Reflect.get?Fp=Reflect.get.bind():Fp=function(t,r,n){var i=nwt(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Fp.apply(this,arguments)}function nwt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=kc(e),e!==null););return e}function iwt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&qz(e,t)}function qz(e,t){return qz=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},qz(e,t)}function owt(e){var t=swt();return function(){var n=kc(e),i;if(t){var o=kc(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return awt(this,i)}}function awt(e,t){if(t&&(mb(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Xz(e)}function Xz(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function swt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function kc(e){return kc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},kc(e)}var GR="manualColumnResize",lwt=130,ste="manualColumnWidths",dN=new WeakMap,uwt=function(e){iwt(r,e);var t=owt(r);function r(n){var i;Qbt(this,r),i=t.call(this,n);var o=i.hot.rootDocument;return i.currentTH=null,i.currentCol=null,i.selectedCols=[],i.currentWidth=null,i.newSize=null,i.startY=null,i.startWidth=null,i.startOffset=null,i.handle=o.createElement("DIV"),i.guide=o.createElement("DIV"),i.eventManager=new Fi(Xz(i)),i.pressed=null,i.dblclick=0,i.autoresizeTimeout=null,i.columnWidthsMap=void 0,dN.set(Xz(i),{config:void 0}),Vt(i.handle,"manualColumnResizer"),Vt(i.guide,"manualColumnResizerGuide"),i}return ewt(r,[{key:"inlineDir",get:function(){return this.hot.isRtl()?"right":"left"}},{key:"isEnabled",value:function(){return this.hot.getSettings()[GR]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.columnWidthsMap=new Jh,this.columnWidthsMap.addLocalHook("init",function(){return i.onMapInit()}),this.hot.columnIndexMapper.registerMap(this.pluginName,this.columnWidthsMap),this.addHook("modifyColWidth",function(o,s){return i.onModifyColWidth(o,s)}),this.addHook("beforeStretchingColumnWidth",function(o,s){return i.onBeforeStretchingColumnWidth(o,s)}),this.addHook("beforeColumnResize",function(o,s,a){return i.onBeforeColumnResize(o,s,a)}),this.bindEvents(),Fp(kc(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Fp(kc(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var i=dN.get(this);i.config=this.columnWidthsMap.getValues(),this.hot.columnIndexMapper.unregisterMap(this.pluginName),Fp(kc(r.prototype),"disablePlugin",this).call(this)}},{key:"saveManualColumnWidths",value:function(){this.hot.runHooks("persistentStateSave",ste,this.columnWidthsMap.getValues())}},{key:"loadManualColumnWidths",value:function(){var i={};return this.hot.runHooks("persistentStateLoad",ste,i),i.value}},{key:"setManualSize",value:function(i,o){var s=Math.max(o,20),a=this.hot.toPhysicalColumn(i);return this.columnWidthsMap.setValueAtIndex(a,s),s}},{key:"clearManualSize",value:function(i){var o=this.hot.toPhysicalColumn(i);this.columnWidthsMap.setValueAtIndex(o,null)}},{key:"onMapInit",value:function(){var i=this,o=dN.get(this),s=this.hot.getSettings()[GR],a=this.loadManualColumnWidths();typeof a<"u"?this.hot.batchExecution(function(){a.forEach(function(h,p){i.columnWidthsMap.setValueAtIndex(p,h)})},!0):Array.isArray(s)?(this.hot.batchExecution(function(){s.forEach(function(h,p){i.columnWidthsMap.setValueAtIndex(p,h)})},!0),o.config=s):s===!0&&Array.isArray(o.config)&&this.hot.batchExecution(function(){o.config.forEach(function(h,p){i.columnWidthsMap.setValueAtIndex(p,h)})},!0)}},{key:"setupHandlePosition",value:function(i){var o=this;if(i.parentNode){this.currentTH=i;var s=this.hot.view._wt,a=s.wtTable.getCoords(this.currentTH),h=a.col;if(!(h<0)){var p=Ni(this.currentTH),y=this.currentTH.getBoundingClientRect(),S=h<s.getSetting("fixedColumnsStart"),E;S&&(E=s.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,a.row,a.col)),E||(E=s.wtOverlays.topOverlay.getRelativeCellPosition(this.currentTH,a.row,a.col)),this.currentCol=this.hot.columnIndexMapper.getVisualFromRenderableIndex(h),this.selectedCols=[];var O=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&O){var A=this.hot.getSelectedRange();Fe(A,function($){var B=$.getTopStartCorner().col,j=$.getBottomEndCorner().col;Or(B,j,function(z){o.selectedCols.includes(z)||o.selectedCols.push(z)})})}this.selectedCols.includes(this.currentCol)||(this.selectedCols=[this.currentCol]),this.startOffset=E.start-6,this.startWidth=parseInt(y.width,10),this.handle.style.top="".concat(E.top,"px"),this.handle.style[this.inlineDir]="".concat(this.startOffset+this.startWidth,"px"),this.handle.style.height="".concat(p,"px"),this.hot.rootElement.appendChild(this.handle)}}}},{key:"refreshHandlePosition",value:function(){this.handle.style[this.inlineDir]="".concat(this.startOffset+this.currentWidth,"px")}},{key:"setupGuidePosition",value:function(){var i=parseInt(Ni(this.handle),10),o=parseInt(this.handle.style.top,10)+i,s=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);Vt(this.handle,"active"),Vt(this.guide,"active"),this.guide.style.top="".concat(o,"px"),this.refreshGuidePosition(),this.guide.style.height="".concat(s-i,"px"),this.hot.rootElement.appendChild(this.guide)}},{key:"refreshGuidePosition",value:function(){this.guide.style[this.inlineDir]=this.handle.style[this.inlineDir]}},{key:"hideHandleAndGuide",value:function(){qr(this.handle,"active"),qr(this.guide,"active")}},{key:"checkIfColumnHeader",value:function(i){return!!em(i,["THEAD"],this.hot.rootElement)}},{key:"getClosestTHParent",value:function(i){return i.tagName!=="TABLE"?i.tagName==="TH"?i:this.getClosestTHParent(i.parentNode):null}},{key:"onMouseOver",value:function(i){if(!Xue(i.target)&&this.checkIfColumnHeader(i.target)){var o=this.getClosestTHParent(i.target);if(!o)return;var s=o.getAttribute("colspan");o&&(s===null||s==="1")&&(this.pressed||this.setupHandlePosition(o))}}},{key:"afterMouseDownTimeout",value:function(){var i=this,o=function(){i.hot.forceFullRender=!0,i.hot.view.render(),i.hot.view.adjustElementsSize(!0)},s=function(p,y){var S=i.hot.runHooks("beforeColumnResize",i.newSize,p,!0);S!==void 0&&(i.newSize=S),i.hot.getSettings().stretchH==="all"?i.clearManualSize(p):i.setManualSize(p,i.newSize),i.saveManualColumnWidths(),i.hot.runHooks("afterColumnResize",i.newSize,p,!0),y&&o()};if(this.dblclick>=2){var a=this.selectedCols.length;a>1?(Fe(this.selectedCols,function(h){s(h)}),o()):Fe(this.selectedCols,function(h){s(h,!0)})}this.dblclick=0,this.autoresizeTimeout=null}},{key:"onMouseDown",value:function(i){var o=this;Wr(i.target,"manualColumnResizer")&&(this.setupHandlePosition(this.currentTH),this.setupGuidePosition(),this.pressed=!0,this.autoresizeTimeout===null&&(this.autoresizeTimeout=setTimeout(function(){return o.afterMouseDownTimeout()},500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startX=i.pageX,this.newSize=this.startWidth)}},{key:"onMouseMove",value:function(i){var o=this;if(this.pressed){var s=(i.pageX-this.startX)*this.hot.getDirectionFactor();this.currentWidth=this.startWidth+s,Fe(this.selectedCols,function(a){o.newSize=o.setManualSize(a,o.currentWidth)}),this.refreshHandlePosition(),this.refreshGuidePosition()}}},{key:"onMouseUp",value:function(){var i=this,o=function(){i.hot.forceFullRender=!0,i.hot.view.render(),i.hot.view.adjustElementsSize(!0)},s=function(p,y){i.hot.runHooks("beforeColumnResize",i.newSize,p,!1),y&&o(),i.saveManualColumnWidths(),i.hot.runHooks("afterColumnResize",i.newSize,p,!1)};if(this.pressed){if(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startWidth){var a=this.selectedCols.length;a>1?(Fe(this.selectedCols,function(h){s(h)}),o()):Fe(this.selectedCols,function(h){s(h,!0)})}this.setupHandlePosition(this.currentTH)}}},{key:"bindEvents",value:function(){var i=this,o=this.hot,s=o.rootWindow,a=o.rootElement;this.eventManager.addEventListener(a,"mouseover",function(h){return i.onMouseOver(h)}),this.eventManager.addEventListener(a,"mousedown",function(h){return i.onMouseDown(h)}),this.eventManager.addEventListener(s,"mousemove",function(h){return i.onMouseMove(h)}),this.eventManager.addEventListener(s,"mouseup",function(){return i.onMouseUp()})}},{key:"onModifyColWidth",value:function(i,o){var s=i;if(this.enabled){var a=this.hot.toPhysicalColumn(o),h=this.columnWidthsMap.getValueAtIndex(a);this.hot.getSettings()[GR]&&h&&(s=h)}return s}},{key:"onBeforeStretchingColumnWidth",value:function(i,o){var s=this.columnWidthsMap.getValueAtIndex(o);return s===null&&(s=i),s}},{key:"onBeforeColumnResize",value:function(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}},{key:"destroy",value:function(){Fp(kc(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return GR}},{key:"PLUGIN_PRIORITY",get:function(){return lwt}}]),r}(Yn);function yC(e){"@babel/helpers - typeof";return yC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yC(e)}function cwt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function lte(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,hwt(n.key),n)}}function fwt(e,t,r){return t&&lte(e.prototype,t),r&&lte(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function hwt(e){var t=dwt(e,"string");return yC(t)==="symbol"?t:String(t)}function dwt(e,t){if(yC(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(yC(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var pN=0,ute=1,cte=2,wy="px",pwt=function(){function e(t){cwt(this,e),this.hot=t,this._element=null,this.state=pN}return fwt(e,[{key:"appendTo",value:function(r){r.appendChild(this._element),this.state=cte}},{key:"build",value:function(){this.state===pN&&(this._element=this.hot.rootDocument.createElement("div"),this.state=ute)}},{key:"destroy",value:function(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=pN}},{key:"isAppended",value:function(){return this.state===cte}},{key:"isBuilt",value:function(){return this.state>=ute}},{key:"setPosition",value:function(r,n){r!==void 0&&(this._element.style.top=r+wy),n!==void 0&&(this._element.style.left=n+wy)}},{key:"getPosition",value:function(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}},{key:"setSize",value:function(r,n){r&&(this._element.style.width=r+wy),n&&(this._element.style.height=n+wy)}},{key:"getSize",value:function(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}},{key:"setOffset",value:function(r,n){r&&(this._element.style.marginTop=r+wy),n&&(this._element.style.marginLeft=n+wy)}},{key:"getOffset",value:function(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}}]),e}();const Nde=pwt;function gb(e){"@babel/helpers - typeof";return gb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gb(e)}function mwt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fte(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ywt(n.key),n)}}function gwt(e,t,r){return t&&fte(e.prototype,t),r&&fte(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ywt(e){var t=vwt(e,"string");return gb(t)==="symbol"?t:String(t)}function vwt(e,t){if(gb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(gb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Jk(){return typeof Reflect<"u"&&Reflect.get?Jk=Reflect.get.bind():Jk=function(t,r,n){var i=_wt(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Jk.apply(this,arguments)}function _wt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=yb(e),e!==null););return e}function bwt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Zz(e,t)}function Zz(e,t){return Zz=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Zz(e,t)}function wwt(e){var t=Cwt();return function(){var n=yb(e),i;if(t){var o=yb(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Swt(this,i)}}function Swt(e,t){if(t&&(gb(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return xwt(e)}function xwt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Cwt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function yb(e){return yb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},yb(e)}var Ewt="ht__manualRowMove--backlight",Twt=function(e){bwt(r,e);var t=wwt(r);function r(){return mwt(this,r),t.apply(this,arguments)}return gwt(r,[{key:"build",value:function(){Jk(yb(r.prototype),"build",this).call(this),Vt(this._element,Ewt)}}]),r}(Nde);const Owt=Twt;function vb(e){"@babel/helpers - typeof";return vb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vb(e)}function Rwt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function hte(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Pwt(n.key),n)}}function kwt(e,t,r){return t&&hte(e.prototype,t),r&&hte(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Pwt(e){var t=Awt(e,"string");return vb(t)==="symbol"?t:String(t)}function Awt(e,t){if(vb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(vb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Qk(){return typeof Reflect<"u"&&Reflect.get?Qk=Reflect.get.bind():Qk=function(t,r,n){var i=Iwt(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Qk.apply(this,arguments)}function Iwt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=_b(e),e!==null););return e}function Mwt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Jz(e,t)}function Jz(e,t){return Jz=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Jz(e,t)}function $wt(e){var t=Nwt();return function(){var n=_b(e),i;if(t){var o=_b(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Dwt(this,i)}}function Dwt(e,t){if(t&&(vb(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Lwt(e)}function Lwt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Nwt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _b(e){return _b=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_b(e)}var Bwt="ht__manualRowMove--guideline",jwt=function(e){Mwt(r,e);var t=$wt(r);function r(){return Rwt(this,r),t.apply(this,arguments)}return kwt(r,[{key:"build",value:function(){Qk(_b(r.prototype),"build",this).call(this),Vt(this._element,Bwt)}}]),r}(Nde);const Fwt=jwt;function bb(e){"@babel/helpers - typeof";return bb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bb(e)}function zwt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dte(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Vwt(n.key),n)}}function Hwt(e,t,r){return t&&dte(e.prototype,t),r&&dte(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Vwt(e){var t=Uwt(e,"string");return bb(t)==="symbol"?t:String(t)}function Uwt(e,t){if(bb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(bb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function zp(){return typeof Reflect<"u"&&Reflect.get?zp=Reflect.get.bind():zp=function(t,r,n){var i=Wwt(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},zp.apply(this,arguments)}function Wwt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Pc(e),e!==null););return e}function Gwt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Qz(e,t)}function Qz(e,t){return Qz=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Qz(e,t)}function Ywt(e){var t=qwt();return function(){var n=Pc(e),i;if(t){var o=Pc(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Kwt(this,i)}}function Kwt(e,t){if(t&&(bb(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return eH(e)}function eH(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function qwt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Pc(e){return Pc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Pc(e)}gr.getSingleton().register("beforeRowMove");gr.getSingleton().register("afterRowMove");var mN="manualRowMove",Xwt=140,Kf=new WeakMap,pte="ht__manualRowMove",YR="show-ui",gN="on-moving--rows",yN="after-selection--rows",Zwt=function(e){Gwt(r,e);var t=Ywt(r);function r(n){var i;return zwt(this,r),i=t.call(this,n),Kf.set(eH(i),{rowsToMove:[],pressed:void 0,target:{eventPageY:void 0,coords:void 0,TD:void 0,row:void 0},cachedDropIndex:void 0}),i.eventManager=new Fi(eH(i)),i.backlight=new Owt(n),i.guideline=new Fwt(n),i}return Hwt(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[mN]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){return i.onBeforeOnCellMouseDown.apply(i,arguments)}),this.addHook("beforeOnCellMouseOver",function(){return i.onBeforeOnCellMouseOver.apply(i,arguments)}),this.addHook("afterScrollHorizontally",function(){return i.onAfterScrollHorizontally()}),this.addHook("afterLoadData",function(){return i.onAfterLoadData.apply(i,arguments)}),this.buildPluginUI(),this.registerEvents(),Vt(this.hot.rootElement,pte),zp(Pc(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),zp(Pc(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){qr(this.hot.rootElement,pte),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),zp(Pc(r.prototype),"disablePlugin",this).call(this)}},{key:"moveRow",value:function(i,o){return this.moveRows([i],o)}},{key:"moveRows",value:function(i,o){var s=Kf.get(this),a=s.cachedDropIndex,h=this.isMovePossible(i,o),p=this.hot.runHooks("beforeRowMove",i,o,a,h);if(s.cachedDropIndex=void 0,p!==!1){h&&this.hot.rowIndexMapper.moveIndexes(i,o);var y=h&&this.isRowOrderChanged(i,o);return this.hot.runHooks("afterRowMove",i,o,a,h,y),y}}},{key:"dragRow",value:function(i,o){return this.dragRows([i],o)}},{key:"dragRows",value:function(i,o){var s=this.countFinalIndex(i,o),a=Kf.get(this);return a.cachedDropIndex=o,this.moveRows(i,s)}},{key:"isMovePossible",value:function(i,o){var s=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),a=i.length+o>s,h=o<0,p=i.some(function(S){return S<0}),y=i.some(function(S){return S>=s});return!(a||h||p||y)}},{key:"isRowOrderChanged",value:function(i,o){return i.some(function(s,a){return s-a!==o})}},{key:"countFinalIndex",value:function(i,o){var s=oa(i,function(a,h){return h<o&&(a+=1),a},0);return o-s}},{key:"getRowsHeight",value:function(i,o){for(var s=this.hot.rowIndexMapper,a=0,h=i;h<=o;h++){var p=s.getRenderableFromVisualIndex(h);p!==null&&(a+=this.hot.view._wt.wtTable.getRowHeight(p)||23)}return a}},{key:"moveBySettingsOrLoad",value:function(){var i=this.hot.getSettings()[mN];if(Array.isArray(i))this.moveRows(i,0);else if(i!==void 0){var o=this.persistentStateLoad();o.length&&this.moveRows(o,0)}}},{key:"isFixedRowTop",value:function(i){return i<this.hot.getSettings().fixedRowsTop}},{key:"isFixedRowBottom",value:function(i){return i>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}},{key:"persistentStateSave",value:function(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}},{key:"persistentStateLoad",value:function(){var i={};return this.hot.runHooks("persistentStateLoad","manualRowMove",i),i.value?i.value:[]}},{key:"prepareRowsToMoving",value:function(){var i=this.hot.getSelectedRangeLast(),o=[];if(!i)return o;var s=i.from,a=i.to,h=Math.min(s.row,a.row),p=Math.max(s.row,a.row);return Or(h,p,function(y){o.push(y)}),o}},{key:"refreshPositions",value:function(){var i=Kf.get(this),o=i.target.coords,s=this.hot.view.getFirstFullyVisibleRow(),a=this.hot.view.getLastFullyVisibleRow(),h=this.hot.countRows();this.isFixedRowTop(o.row)&&s>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(s-1,-1)),this.isFixedRowBottom(o.row)&&a<h&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(a+1,1),void 0,!0);var p=this.hot.view._wt.wtTable,y=i.target.TD,S=ao(this.hot.rootElement),E=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,o.row-1),O=i.target.eventPageY-S.top+p.holder.scrollTop,A=p.hider.offsetHeight,$=p.TBODY.offsetTop,B=this.backlight.getOffset().top,j=this.backlight.getSize().height;this.isFixedRowTop(o.row)&&(E+=p.holder.scrollTop),o.row<0?i.target.row=s>0?s-1:s:y.offsetHeight/2+E<=O?(i.target.row=o.row+1,E+=o.row===0?y.offsetHeight-1:y.offsetHeight):i.target.row=o.row;var z=O,W=E;O+j+B>=A?z=A-j-B:O+B<$&&(z=$+Math.abs(B)),E>=A-1&&(W=A-1),this.backlight.setPosition(z),this.guideline.setPosition(W)}},{key:"registerEvents",value:function(){var i=this,o=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(o,"mousemove",function(s){return i.onMouseMove(s)}),this.eventManager.addEventListener(o,"mouseup",function(){return i.onMouseUp()})}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"onBeforeOnCellMouseDown",value:function(i,o,s,a){var h=this.hot.view._wt,p=h.wtTable,y=h.wtViewport,S=this.hot.selection.isSelectedByRowHeader(),E=this.hot.getSelectedRangeLast(),O=Kf.get(this);if(!E||!S||O.pressed||i.button!==0){O.pressed=!1,O.rowsToMove.length=0,qr(this.hot.rootElement,[gN,YR]);return}var A=this.guideline.isBuilt()&&!this.guideline.isAppended(),$=this.backlight.isBuilt()&&!this.backlight.isAppended();A&&$&&(this.guideline.appendTo(p.hider),this.backlight.appendTo(p.hider));var B=E.from,j=E.to,z=Math.min(B.row,j.row),W=Math.max(B.row,j.row);if(o.col<0&&o.row>=z&&o.row<=W){a.row=!0,O.pressed=!0,O.target.eventPageY=i.pageY,O.target.coords=o,O.target.TD=s,O.rowsToMove=this.prepareRowsToMoving();var Q=p.holder.scrollLeft+y.getRowHeaderWidth();this.backlight.setPosition(null,Q),this.backlight.setSize(p.hider.offsetWidth-Q,this.getRowsHeight(z,W)),this.backlight.setOffset((this.getRowsHeight(z,o.row-1)+i.offsetY)*-1,null),Vt(this.hot.rootElement,gN),this.refreshPositions()}else qr(this.hot.rootElement,yN),O.pressed=!1,O.rowsToMove.length=0}},{key:"onMouseMove",value:function(i){var o=Kf.get(this);if(o.pressed){if(i.target===this.backlight.element){var s=this.backlight.getSize().height;this.backlight.setSize(null,0),setTimeout(function(){this.backlight.setPosition(null,s)})}o.target.eventPageY=i.pageY,this.refreshPositions()}}},{key:"onBeforeOnCellMouseOver",value:function(i,o,s,a){var h=this.hot.getSelectedRangeLast(),p=Kf.get(this);!h||!p.pressed||(p.rowsToMove.indexOf(o.row)>-1?qr(this.hot.rootElement,YR):Vt(this.hot.rootElement,YR),a.row=!0,a.column=!0,a.cell=!0,p.target.coords=o,p.target.TD=s)}},{key:"onMouseUp",value:function(){var i=Kf.get(this),o=i.target.row,s=i.rowsToMove.length;if(i.pressed=!1,i.backlightHeight=0,qr(this.hot.rootElement,[gN,YR,yN]),this.hot.selection.isSelectedByRowHeader()&&Vt(this.hot.rootElement,yN),!(s<1||o===void 0)){var a=i.rowsToMove[0],h=this.hot.toPhysicalRow(a),p=this.dragRows(i.rowsToMove,o);if(i.rowsToMove.length=0,p===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);var y=this.hot.toVisualRow(h),S=y+s-1;this.hot.selectRows(y,S)}}}},{key:"onAfterScrollHorizontally",value:function(){var i=this.hot.view._wt.wtTable,o=this.hot.view._wt.wtViewport.getRowHeaderWidth(),s=i.holder.scrollLeft,a=o+s;this.backlight.setPosition(null,a),this.backlight.setSize(i.hider.offsetWidth-a)}},{key:"buildPluginUI",value:function(){this.backlight.build(),this.guideline.build()}},{key:"onAfterLoadData",value:function(){this.moveBySettingsOrLoad()}},{key:"destroy",value:function(){this.backlight.destroy(),this.guideline.destroy(),zp(Pc(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return mN}},{key:"PLUGIN_PRIORITY",get:function(){return Xwt}}]),r}(Yn);function wb(e){"@babel/helpers - typeof";return wb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wb(e)}function Jwt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mte(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,e0t(n.key),n)}}function Qwt(e,t,r){return t&&mte(e.prototype,t),r&&mte(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function e0t(e){var t=t0t(e,"string");return wb(t)==="symbol"?t:String(t)}function t0t(e,t){if(wb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(wb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Hp(){return typeof Reflect<"u"&&Reflect.get?Hp=Reflect.get.bind():Hp=function(t,r,n){var i=r0t(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Hp.apply(this,arguments)}function r0t(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ac(e),e!==null););return e}function n0t(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&tH(e,t)}function tH(e,t){return tH=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},tH(e,t)}function i0t(e){var t=a0t();return function(){var n=Ac(e),i;if(t){var o=Ac(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return o0t(this,i)}}function o0t(e,t){if(t&&(wb(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return rH(e)}function rH(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function a0t(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ac(e){return Ac=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ac(e)}var KR="manualRowResize",s0t=30,gte="manualRowHeights",vN=new WeakMap,l0t=function(e){n0t(r,e);var t=i0t(r);function r(n){var i;Jwt(this,r),i=t.call(this,n);var o=i.hot.rootDocument;return i.currentTH=null,i.currentRow=null,i.selectedRows=[],i.currentHeight=null,i.newSize=null,i.startY=null,i.startHeight=null,i.startOffset=null,i.handle=o.createElement("DIV"),i.guide=o.createElement("DIV"),i.eventManager=new Fi(rH(i)),i.pressed=null,i.dblclick=0,i.autoresizeTimeout=null,i.rowHeightsMap=void 0,vN.set(rH(i),{config:void 0}),Vt(i.handle,"manualRowResizer"),Vt(i.guide,"manualRowResizerGuide"),i}return Qwt(r,[{key:"inlineDir",get:function(){return this.hot.isRtl()?"right":"left"}},{key:"isEnabled",value:function(){return this.hot.getSettings()[KR]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.rowHeightsMap=new Jh,this.rowHeightsMap.addLocalHook("init",function(){return i.onMapInit()}),this.hot.rowIndexMapper.registerMap(this.pluginName,this.rowHeightsMap),this.addHook("modifyRowHeight",function(o,s){return i.onModifyRowHeight(o,s)}),this.bindEvents(),Hp(Ac(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Hp(Ac(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var i=vN.get(this);i.config=this.rowHeightsMap.getValues(),this.hot.rowIndexMapper.unregisterMap(this.pluginName),Hp(Ac(r.prototype),"disablePlugin",this).call(this)}},{key:"saveManualRowHeights",value:function(){this.hot.runHooks("persistentStateSave",gte,this.rowHeightsMap.getValues())}},{key:"loadManualRowHeights",value:function(){var i={};return this.hot.runHooks("persistentStateLoad",gte,i),i.value}},{key:"setManualSize",value:function(i,o){var s=this.hot.toPhysicalRow(i),a=Math.max(o,$ce.DEFAULT_HEIGHT);return this.rowHeightsMap.setValueAtIndex(s,a),a}},{key:"setupHandlePosition",value:function(i){var o=this;this.currentTH=i;var s=this.hot.view,a=s._wt,h=a.wtTable.getCoords(this.currentTH),p=h.row;if(!(p<0)){var y=ii(this.currentTH),S=this.currentTH.getBoundingClientRect(),E=p<a.getSetting("fixedRowsTop"),O=p>=s.countNotHiddenRowIndexes(0,1)-a.getSetting("fixedRowsBottom"),A;E?A=a.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,h.row,h.col):O&&(A=a.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,h.row,h.col)),A||(A=a.wtOverlays.inlineStartOverlay.getRelativeCellPosition(this.currentTH,h.row,h.col)),this.currentRow=this.hot.rowIndexMapper.getVisualFromRenderableIndex(p),this.selectedRows=[];var $=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&$){var B=this.hot.getSelectedRange();Fe(B,function(j){var z=j.getTopStartCorner().row,W=j.getBottomStartCorner().row;Or(z,W,function(Q){o.selectedRows.includes(Q)||o.selectedRows.push(Q)})})}this.selectedRows.includes(this.currentRow)||(this.selectedRows=[this.currentRow]),this.startOffset=A.top-6,this.startHeight=parseInt(S.height,10),this.handle.style.top="".concat(this.startOffset+this.startHeight,"px"),this.handle.style[this.inlineDir]="".concat(A.start,"px"),this.handle.style.width="".concat(y,"px"),this.hot.rootElement.appendChild(this.handle)}}},{key:"refreshHandlePosition",value:function(){this.handle.style.top="".concat(this.startOffset+this.currentHeight,"px")}},{key:"setupGuidePosition",value:function(){var i=parseInt(ii(this.handle),10),o=parseInt(this.handle.style[this.inlineDir],10)+i,s=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);Vt(this.handle,"active"),Vt(this.guide,"active"),this.guide.style.top=this.handle.style.top,this.guide.style[this.inlineDir]="".concat(o,"px"),this.guide.style.width="".concat(s-i,"px"),this.hot.rootElement.appendChild(this.guide)}},{key:"refreshGuidePosition",value:function(){this.guide.style.top=this.handle.style.top}},{key:"hideHandleAndGuide",value:function(){qr(this.handle,"active"),qr(this.guide,"active")}},{key:"checkIfRowHeader",value:function(i){var o,s,a=em(i,["TH"],this.hot.rootElement);return a&&((o=i.parentNode)===null||o===void 0||(s=o.parentNode)===null||s===void 0?void 0:s.tagName)==="TBODY"}},{key:"getClosestTHParent",value:function(i){return i.tagName!=="TABLE"?i.tagName==="TH"?i:this.getClosestTHParent(i.parentNode):null}},{key:"getActualRowHeight",value:function(i){var o=this.hot.view._wt.wtTable.getRowHeight(i);return o!==void 0&&this.newSize<o?o:this.newSize}},{key:"onMouseOver",value:function(i){if(!Xue(i.target)&&this.checkIfRowHeader(i.target)){var o=this.getClosestTHParent(i.target);o&&(this.pressed||this.setupHandlePosition(o))}}},{key:"afterMouseDownTimeout",value:function(){var i=this,o=function(){i.hot.forceFullRender=!0,i.hot.view.render(),i.hot.view.adjustElementsSize(!0)},s=function(p,y){var S=i.hot.runHooks("beforeRowResize",i.getActualRowHeight(p),p,!0);S!==void 0&&(i.newSize=S),i.setManualSize(p,i.newSize),i.hot.runHooks("afterRowResize",i.getActualRowHeight(p),p,!0),y&&o()};if(this.dblclick>=2){var a=this.selectedRows.length;a>1?(Fe(this.selectedRows,function(h){s(h)}),o()):Fe(this.selectedRows,function(h){s(h,!0)})}this.dblclick=0,this.autoresizeTimeout=null}},{key:"onMouseDown",value:function(i){var o=this;Wr(i.target,"manualRowResizer")&&(this.setupHandlePosition(this.currentTH),this.setupGuidePosition(),this.pressed=!0,this.autoresizeTimeout===null&&(this.autoresizeTimeout=setTimeout(function(){return o.afterMouseDownTimeout()},500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startY=i.pageY,this.newSize=this.startHeight)}},{key:"onMouseMove",value:function(i){var o=this;this.pressed&&(this.currentHeight=this.startHeight+(i.pageY-this.startY),Fe(this.selectedRows,function(s){o.newSize=o.setManualSize(s,o.currentHeight)}),this.refreshHandlePosition(),this.refreshGuidePosition())}},{key:"onMouseUp",value:function(){var i=this,o=function(){i.hot.forceFullRender=!0,i.hot.view.render(),i.hot.view.adjustElementsSize(!0)},s=function(p,y){i.hot.runHooks("beforeRowResize",i.getActualRowHeight(p),p,!1),y&&o(),i.saveManualRowHeights(),i.hot.runHooks("afterRowResize",i.getActualRowHeight(p),p,!1)};if(this.pressed){if(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startHeight){var a=this.selectedRows.length;a>1?(Fe(this.selectedRows,function(h){s(h)}),o()):Fe(this.selectedRows,function(h){s(h,!0)})}this.setupHandlePosition(this.currentTH)}}},{key:"bindEvents",value:function(){var i=this,o=this.hot,s=o.rootElement,a=o.rootWindow;this.eventManager.addEventListener(s,"mouseover",function(h){return i.onMouseOver(h)}),this.eventManager.addEventListener(s,"mousedown",function(h){return i.onMouseDown(h)}),this.eventManager.addEventListener(a,"mousemove",function(h){return i.onMouseMove(h)}),this.eventManager.addEventListener(a,"mouseup",function(){return i.onMouseUp()})}},{key:"onModifyRowHeight",value:function(i,o){var s=i;if(this.enabled){var a=this.hot.toPhysicalRow(o),h=this.rowHeightsMap.getValueAtIndex(a);this.hot.getSettings()[KR]&&h&&(s=h)}return s}},{key:"onMapInit",value:function(){var i=this,o=vN.get(this),s=this.hot.getSettings()[KR],a=this.loadManualRowHeights();this.hot.batchExecution(function(){typeof a<"u"?a.forEach(function(h,p){i.rowHeightsMap.setValueAtIndex(p,h)}):Array.isArray(s)?(s.forEach(function(h,p){i.rowHeightsMap.setValueAtIndex(p,h)}),o.config=s):s===!0&&Array.isArray(o.config)&&o.config.forEach(function(h,p){i.rowHeightsMap.setValueAtIndex(p,h)})},!0)}},{key:"destroy",value:function(){Hp(Ac(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return KR}},{key:"PLUGIN_PRIORITY",get:function(){return s0t}}]),r}(Yn);function vC(e){"@babel/helpers - typeof";return vC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vC(e)}var yte,vte,_te,bte;function qR(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function u0t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function wte(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,f0t(n.key),n)}}function c0t(e,t,r){return t&&wte(e.prototype,t),r&&wte(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function f0t(e){var t=h0t(e,"string");return vC(t)==="symbol"?t:String(t)}function h0t(e,t){if(vC(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(vC(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var d0t=function(){function e(t,r,n,i,o,s){u0t(this,e),this.row=t,this.col=r,this.rowspan=n,this.colspan=i,this.removed=!1,this.cellCoordsFactory=o,this.cellRangeFactory=s}return c0t(e,[{key:"normalize",value:function(r){var n=r.countRows(),i=r.countCols();this.row<0?this.row=0:this.row>n-1&&(this.row=n-1),this.col<0?this.col=0:this.col>i-1&&(this.col=i-1),this.row+this.rowspan>n-1&&(this.rowspan=n-this.row),this.col+this.colspan>i-1&&(this.colspan=i-this.col)}},{key:"includes",value:function(r,n){return this.row<=r&&this.col<=n&&this.row+this.rowspan-1>=r&&this.col+this.colspan-1>=n}},{key:"includesHorizontally",value:function(r){return this.col<=r&&this.col+this.colspan-1>=r}},{key:"includesVertically",value:function(r){return this.row<=r&&this.row+this.rowspan-1>=r}},{key:"shift",value:function(r,n){var i=r[0]||r[1],o=n+Math.abs(r[0]||r[1])-1,s=r[0]?"colspan":"rowspan",a=r[0]?"col":"row",h=Math.min(n,o),p=Math.max(n,o),y=this[a],S=this[a]+this[s]-1;if(y>=n&&(this[a]+=i),i>0)n<=S&&n>y&&(this[s]+=i);else if(i<0){if(h<=y&&p>=S)return this.removed=!0,!1;if(y>=h&&y<=p){var E=p-y+1,O=Math.abs(i)-E;this[a]-=O+i,this[s]-=E}else if(y<=h&&S>=p)this[s]+=i;else if(y<=h&&S>=h&&S<p){var A=S-h+1;this[s]-=A}}return!0}},{key:"isFarther",value:function(r,n){return r?n==="down"?r.row+r.rowspan-1<this.row+this.rowspan-1:n==="up"?r.row>this.row:n==="right"?r.col+r.colspan-1<this.col+this.colspan-1:n==="left"?r.col>this.col:null:!0}},{key:"getLastRow",value:function(){return this.row+this.rowspan-1}},{key:"getLastColumn",value:function(){return this.col+this.colspan-1}},{key:"getRange",value:function(){return this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))}}],[{key:"NEGATIVE_VALUES_WARNING",value:function(r){return Jn(yte||(yte=qR(["The merged cell declared with {row: ",", col: ",`, 
      rowspan: `,", colspan: ",`} contains negative values, which is 
      not supported. It will not be added to the collection.`],["The merged cell declared with {row: ",", col: ",`,\\x20
      rowspan: `,", colspan: ",`} contains negative values, which is\\x20
      not supported. It will not be added to the collection.`])),r.row,r.col,r.rowspan,r.colspan)}},{key:"IS_OUT_OF_BOUNDS_WARNING",value:function(r){return Jn(vte||(vte=qR(["The merged cell declared at [",", ",`] is positioned 
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`],["The merged cell declared at [",", ",`] is positioned\\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`])),r.row,r.col)}},{key:"IS_SINGLE_CELL",value:function(r){return Jn(_te||(_te=qR(["The merged cell declared at [",", ",`] has both "rowspan" 
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`],["The merged cell declared at [",", ",`] has both "rowspan"\\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`])),r.row,r.col)}},{key:"ZERO_SPAN_WARNING",value:function(r){return Jn(bte||(bte=qR(["The merged cell declared at [",", ",`] has "rowspan" 
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`],["The merged cell declared at [",", ",`] has "rowspan"\\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`])),r.row,r.col)}},{key:"containsNegativeValues",value:function(r){return r.row<0||r.col<0||r.rowspan<0||r.colspan<0}},{key:"isSingleCell",value:function(r){return r.colspan===1&&r.rowspan===1}},{key:"containsZeroSpan",value:function(r){return r.colspan===0||r.rowspan===0}},{key:"isOutOfBounds",value:function(r,n,i){return r.row<0||r.col<0||r.row>=n||r.row+r.rowspan-1>=n||r.col>=i||r.col+r.colspan-1>=i}}]),e}();const fu=d0t;function nH(e,t,r,n){t?t.row===r&&t.col===n?(e.setAttribute("rowspan",t.rowspan.toString()),e.setAttribute("colspan",t.colspan.toString())):(e.removeAttribute("rowspan"),e.removeAttribute("colspan"),e.style.display="none"):(e.removeAttribute("rowspan"),e.removeAttribute("colspan"),e.style.display="")}function _C(e){"@babel/helpers - typeof";return _C=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_C(e)}var Ste;function p0t(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function xte(e){return v0t(e)||y0t(e)||g0t(e)||m0t()}function m0t(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function g0t(e,t){if(e){if(typeof e=="string")return iH(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return iH(e,t)}}function y0t(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function v0t(e){if(Array.isArray(e))return iH(e)}function iH(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _0t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Cte(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,w0t(n.key),n)}}function b0t(e,t,r){return t&&Cte(e.prototype,t),r&&Cte(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function w0t(e){var t=S0t(e,"string");return _C(t)==="symbol"?t:String(t)}function S0t(e,t){if(_C(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_C(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var x0t=function(){function e(t){_0t(this,e),this.plugin=t,this.mergedCells=[],this.hot=t.hot}return b0t(e,[{key:"get",value:function(r,n){var i=this.mergedCells,o=!1;return Fe(i,function(s){return s.row<=r&&s.row+s.rowspan-1>=r&&s.col<=n&&s.col+s.colspan-1>=n?(o=s,!1):!0}),o}},{key:"getByRange",value:function(r){var n=this.mergedCells,i=!1;return Fe(n,function(o){return o.row<=r.from.row&&o.row+o.rowspan-1>=r.to.row&&o.col<=r.from.col&&o.col+o.colspan-1>=r.to.col?(i=o,i):!0}),i}},{key:"getWithinRange",value:function(r){var n=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,o=this.mergedCells,s=[],a=r;if(!a.includesRange){var h=this.hot._createCellCoords(a.from.row,a.from.col),p=this.hot._createCellCoords(a.to.row,a.to.col);a=this.hot._createCellRange(h,h,p)}return Fe(o,function(y){var S=n.hot._createCellCoords(y.row,y.col),E=n.hot._createCellCoords(y.row+y.rowspan-1,y.col+y.colspan-1),O=n.hot._createCellRange(S,S,E);i?a.overlaps(O)&&s.push(y):a.includesRange(O)&&s.push(y)}),s.length?s:!1}},{key:"add",value:function(r){var n=this.mergedCells,i=r.row,o=r.col,s=r.rowspan,a=r.colspan,h=new fu(i,o,s,a,this.hot._createCellCoords,this.hot._createCellRange),p=this.get(i,o),y=this.isOverlapping(h);return!p&&!y?(this.hot&&h.normalize(this.hot),n.push(h),h):(ni(e.IS_OVERLAPPING_WARNING(h)),!1)}},{key:"remove",value:function(r,n){var i=this.mergedCells,o=this.get(r,n),s=o?this.mergedCells.indexOf(o):-1;return o&&s!==-1?(i.splice(s,1),o):!1}},{key:"clear",value:function(){var r=this,n=this.mergedCells,i=[],o=[];Fe(n,function(s){var a=r.hot.getCell(s.row,s.col);a&&i.push([a,r.get(s.row,s.col),s.row,s.col])}),this.mergedCells.length=0,Fe(i,function(s,a){Or(0,s.rowspan-1,function(h){Or(0,s.colspan-1,function(p){if(p!==0||h!==0){var y=r.hot.getCell(s.row+h,s.col+p);y&&o.push([y,null,null,null])}})}),i[a][1]=null}),Fe(i,function(s){nH.apply(void 0,xte(s))}),Fe(o,function(s){nH.apply(void 0,xte(s))})}},{key:"isOverlapping",value:function(r){var n=this,i=this.hot._createCellRange(this.hot._createCellCoords(0,0),this.hot._createCellCoords(r.row,r.col),this.hot._createCellCoords(r.row+r.rowspan-1,r.col+r.colspan-1)),o=!1;return Fe(this.mergedCells,function(s){var a=n.hot._createCellRange(n.hot._createCellCoords(0,0),n.hot._createCellCoords(s.row,s.col),n.hot._createCellCoords(s.row+s.rowspan-1,s.col+s.colspan-1));return a.overlaps(i)?(o=!0,!1):!0}),o}},{key:"isFirstRenderableMergedCell",value:function(r,n){var i=this.get(r,n);return i&&this.hot.rowIndexMapper.getNearestNotHiddenIndex(i.row,1)===r&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(i.col,1)===n}},{key:"getFirstRenderableCoords",value:function(r,n){var i=this.get(r,n);if(!i||this.isFirstRenderableMergedCell(r,n))return this.hot._createCellCoords(r,n);var o=this.hot.rowIndexMapper.getNearestNotHiddenIndex(i.row,1),s=this.hot.columnIndexMapper.getNearestNotHiddenIndex(i.col,1);return this.hot._createCellCoords(o,s)}},{key:"shiftCollections",value:function(r,n,i){var o=this,s=[0,0];switch(r){case"right":s[0]+=i;break;case"left":s[0]-=i;break;case"down":s[1]+=i;break;case"up":s[1]-=i;break}Fe(this.mergedCells,function(a){a.shift(s,n)}),Nj(this.mergedCells.length-1,0,function(a){var h=o.mergedCells[a];h&&h.removed&&o.mergedCells.splice(o.mergedCells.indexOf(h),1)})}}],[{key:"IS_OVERLAPPING_WARNING",value:function(r){return Jn(Ste||(Ste=p0t(["The merged cell declared at [",", ",`], overlaps 
      with the other declared merged cell. The overlapping merged cell was not added to the table, please 
      fix your setup.`],["The merged cell declared at [",", ",`], overlaps\\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\\x20
      fix your setup.`])),r.row,r.col)}}]),e}();const C0t=x0t;function bC(e){"@babel/helpers - typeof";return bC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bC(e)}function np(e,t){return R0t(e)||O0t(e,t)||T0t(e,t)||E0t()}function E0t(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function T0t(e,t){if(e){if(typeof e=="string")return Ete(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ete(e,t)}}function Ete(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function O0t(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],h=!0,p=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;h=!1}else for(;!(h=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);h=!0);}catch(y){p=!0,i=y}finally{try{if(!h&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(p)throw i}}return a}}function R0t(e){if(Array.isArray(e))return e}function k0t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Tte(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,A0t(n.key),n)}}function P0t(e,t,r){return t&&Tte(e.prototype,t),r&&Tte(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function A0t(e){var t=I0t(e,"string");return bC(t)==="symbol"?t:String(t)}function I0t(e,t){if(bC(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(bC(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var M0t=function(){function e(t){k0t(this,e),this.plugin=t,this.mergedCellsCollection=this.plugin.mergedCellsCollection,this.currentFillData=null}return P0t(e,[{key:"correctSelectionAreaSize",value:function(r){if(r[0]===r[2]&&r[1]===r[3]){var n=this.mergedCellsCollection.get(r[0],r[1]);n&&(r[2]=r[0]+n.rowspan-1,r[3]=r[1]+n.colspan-1)}}},{key:"getDirection",value:function(r,n){var i=null;return n[0]===r[0]&&n[1]===r[1]&&n[3]===r[3]?i="down":n[2]===r[2]&&n[1]===r[1]&&n[3]===r[3]?i="up":n[1]===r[1]&&n[2]===r[2]?i="right":i="left",i}},{key:"snapDragArea",value:function(r,n,i,o){var s=n.slice(0),a=this.getAutofillSize(r,n,i),h=np(r,4),p=h[0],y=h[1],S=h[2],E=h[3],O=["up","down"].indexOf(i)>-1,A=O?S-p+1:E-y+1,$=Math.floor(a/A)*A,B=a-$,j=this.getFarthestCollection(r,n,i,o);if(j){if(i==="down"){var z=j.row+j.rowspan-p-B,W=s[2]+z;W>=this.plugin.hot.countRows()?s[2]-=B:s[2]+=B?z:0}else if(i==="right"){var Q=j.col+j.colspan-y-B,q=s[3]+Q;q>=this.plugin.hot.countCols()?s[3]-=B:s[3]+=B?Q:0}else if(i==="up"){var Se=S-B-j.row+1,Ie=s[0]+Se;Ie<0?s[0]+=B:s[0]-=B?Se:0}else if(i==="left"){var He=E-B-j.col+1,Le=s[1]+He;Le<0?s[1]+=B:s[1]-=B?He:0}}return this.updateCurrentFillCache({baseArea:r,dragDirection:i,foundMergedCells:o,fillSize:a,dragArea:s,cycleLength:A}),s}},{key:"updateCurrentFillCache",value:function(r){this.currentFillData||(this.currentFillData={}),lo(this.currentFillData,r)}},{key:"getAutofillSize",value:function(r,n,i){var o=np(r,4),s=o[0],a=o[1],h=o[2],p=o[3],y=np(n,4),S=y[0],E=y[1],O=y[2],A=y[3];switch(i){case"up":return s-S;case"down":return O-h;case"left":return a-E;case"right":return A-p;default:return null}}},{key:"getDragArea",value:function(r,n,i){var o=np(r,4),s=o[0],a=o[1],h=o[2],p=o[3],y=np(n,4),S=y[0],E=y[1],O=y[2],A=y[3];switch(i){case"up":return[S,E,s-1,p];case"down":return[h+1,a,O,p];case"left":return[S,E,h,a-1];case"right":return[s,p+1,O,A];default:return null}}},{key:"getFarthestCollection",value:function(r,n,i,o){var s=np(r,4),a=s[0],h=s[1],p=s[2],y=s[3],S=["up","down"].indexOf(i)>-1,E=S?p:y,O=S?a:h,A=this.getAutofillSize(r,n,i),$=S?p-a+1:y-h+1,B=Math.floor(A/$)*$,j=A-B,z=null,W=null,Q=null;switch(i){case"up":z="includesVertically",Q=E-j+1;break;case"left":z="includesHorizontally",Q=E-j+1;break;case"down":z="includesVertically",Q=O+j-1;break;case"right":z="includesHorizontally",Q=O+j-1;break}return Fe(o,function(q){q[z](Q)&&q.isFarther(W,i)&&(W=q)}),W}},{key:"recreateAfterDataPopulation",value:function(r){if(this.currentFillData){var n=this.getRangeFromChanges(r),i=this.currentFillData.foundMergedCells,o=this.currentFillData.dragDirection,s=function(E,O){switch(o){case"up":return E.row-O>=n.from.row;case"down":return E.row+E.rowspan-1+O<=n.to.row;case"left":return E.col-O>=n.from.column;case"right":return E.col+E.colspan-1+O<=n.to.column;default:return null}},a=0,h=null,p=1;do for(var y=0;y<i.length;y+=1){if(h=i[y],a=p*this.currentFillData.cycleLength,s(h,a))switch(o){case"up":this.plugin.mergedCellsCollection.add({row:h.row-a,rowspan:h.rowspan,col:h.col,colspan:h.colspan});break;case"down":this.plugin.mergedCellsCollection.add({row:h.row+a,rowspan:h.rowspan,col:h.col,colspan:h.colspan});break;case"left":this.plugin.mergedCellsCollection.add({row:h.row,rowspan:h.rowspan,col:h.col-a,colspan:h.colspan});break;case"right":this.plugin.mergedCellsCollection.add({row:h.row,rowspan:h.rowspan,col:h.col+a,colspan:h.colspan});break}y===i.length-1&&(p+=1)}while(s(h,a));this.currentFillData=null,this.plugin.hot.render(),i.length>0&&this.plugin.ifChromeForceRepaint()}}},{key:"getRangeFromChanges",value:function(r){var n=this,i={min:null,max:null},o={min:null,max:null};return Fe(r,function(s){var a=s[0],h=n.plugin.hot.propToCol(s[1]);(i.min===null||a<i.min)&&(i.min=a),(i.max===null||a>i.max)&&(i.max=a),(o.min===null||h<o.min)&&(o.min=h),(o.max===null||h>o.max)&&(o.max=h)}),{from:{row:i.min,column:o.min},to:{row:i.max,column:o.max}}}},{key:"dragAreaOverlapsCollections",value:function(r,n,i){var o=this.getDragArea(r,n,i),s=np(o,4),a=s[0],h=s[1],p=s[2],y=s[3],S=this.plugin.hot._createCellCoords(a,h),E=this.plugin.hot._createCellCoords(p,y),O=this.plugin.hot._createCellRange(S,S,E);return!!this.mergedCellsCollection.getWithinRange(O,!0)}}]),e}();const $0t=M0t;function wC(e){"@babel/helpers - typeof";return wC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wC(e)}function D0t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ote(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,N0t(n.key),n)}}function L0t(e,t,r){return t&&Ote(e.prototype,t),r&&Ote(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function N0t(e){var t=B0t(e,"string");return wC(t)==="symbol"?t:String(t)}function B0t(e,t){if(wC(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(wC(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var j0t=function(){function e(t){D0t(this,e),this.plugin=t,this.hot=t.hot,this.fullySelectedMergedCellClassName="fullySelectedMergedCell"}return L0t(e,[{key:"snapDelta",value:function(r,n,i){var o=n.to,s=o.row+r.row,a=o.col+r.col;r.row?this.jumpOverMergedCell(r,i,s):r.col&&this.jumpOverMergedCell(r,i,a)}},{key:"jumpOverMergedCell",value:function(r,n,i){var o=r.row||r.col,s=null,a=null,h=null;r.row?(s=n.includesVertically(i),a=n.row,h=n.getLastRow()):r.col&&(s=n.includesHorizontally(i),a=n.col,h=n.getLastColumn()),o!==0&&(o>0?s&&i!==a&&(o+=h-i+1):s&&i!==h&&(o-=i-a+1),r.row?r.row=o:r.col&&(r.col=o))}},{key:"getUpdatedSelectionRange",value:function(r,n){return this.hot._createCellRange(r.highlight,r.from,this.hot._createCellCoords(r.to.row+n.row,r.to.col+n.col))}},{key:"getSelectedMergedCellClassName",value:function(r,n,i,o){var s=Math.min(i[0],i[2]),a=Math.min(i[1],i[3]),h=Math.max(i[0],i[2]),p=Math.max(i[1],i[3]);if(o!==void 0){var y=this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(r,n);if(y){var S=this.plugin.mergedCellsCollection.get(r,n);if(S){var E=S.getLastRow(),O=S.getLastColumn(),A=s<=S.row&&a<=S.col&&h>=E&&p>=O;if(A)return"".concat(this.fullySelectedMergedCellClassName,"-").concat(o);if(this.plugin.selectionCalculations.isMergeCellFullySelected(S,this.plugin.hot.getSelectedRange()))return"".concat(this.fullySelectedMergedCellClassName,"-multiple")}}}}},{key:"isMergeCellFullySelected",value:function(r,n){var i=[];if(!n||!r)return!1;for(var o=0;o<r.rowspan;o+=1)for(var s=0;s<r.colspan;s+=1)i.push(this.hot._createCellCoords(r.row+o,r.col+s));for(var a=0;a<i.length;a+=1){for(var h=[],p=0;p<n.length;p+=1)h[p]=n[p].includes(i[a]);if(!h.includes(!0))return!1}return!0}},{key:"getSelectedMergedCellClassNameToRemove",value:function(){for(var r=[],n=0;n<=7;n+=1)r.push("".concat(this.fullySelectedMergedCellClassName,"-").concat(n));return r.push("".concat(this.fullySelectedMergedCellClassName,"-multiple")),r}}]),e}();const F0t=j0t;function z0t(e){return{key:"mergeCells",name:function(){var r=this.getSelectedLast();if(r){var n=e.mergedCellsCollection.get(r[0],r[1]);if(n.row===r[0]&&n.col===r[1]&&n.row+n.rowspan-1===r[2]&&n.col+n.colspan-1===r[3])return this.getTranslatedPhrase(w4)}return this.getTranslatedPhrase(b4)},callback:function(){e.toggleMergeOnSelection()},disabled:function(){var r=this.getSelectedLast();if(!r)return!0;var n=fu.isSingleCell({row:r[0],col:r[1],rowspan:r[2]-r[0]+1,colspan:r[3]-r[1]+1});return n||this.selection.isSelectedByCorner()},hidden:!1}}function Sb(e){"@babel/helpers - typeof";return Sb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sb(e)}function H0t(e,t){return W0t(e)||U0t(e,t)||Bde(e,t)||V0t()}function V0t(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function U0t(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],h=!0,p=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;h=!1}else for(;!(h=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);h=!0);}catch(y){p=!0,i=y}finally{try{if(!h&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(p)throw i}}return a}}function W0t(e){if(Array.isArray(e))return e}function G0t(e){return q0t(e)||K0t(e)||Bde(e)||Y0t()}function Y0t(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Bde(e,t){if(e){if(typeof e=="string")return oH(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return oH(e,t)}}function K0t(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function q0t(e){if(Array.isArray(e))return oH(e)}function oH(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function X0t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Rte(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,J0t(n.key),n)}}function Z0t(e,t,r){return t&&Rte(e.prototype,t),r&&Rte(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function J0t(e){var t=Q0t(e,"string");return Sb(t)==="symbol"?t:String(t)}function Q0t(e,t){if(Sb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Sb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function gv(){return typeof Reflect<"u"&&Reflect.get?gv=Reflect.get.bind():gv=function(t,r,n){var i=eSt(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},gv.apply(this,arguments)}function eSt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Mh(e),e!==null););return e}function tSt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&aH(e,t)}function aH(e,t){return aH=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},aH(e,t)}function rSt(e){var t=iSt();return function(){var n=Mh(e),i;if(t){var o=Mh(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return nSt(this,i)}}function nSt(e,t){if(t&&(Sb(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return jde(e)}function jde(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function iSt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Mh(e){return Mh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Mh(e)}gr.getSingleton().register("beforeMergeCells");gr.getSingleton().register("afterMergeCells");gr.getSingleton().register("beforeUnmergeCells");gr.getSingleton().register("afterUnmergeCells");var OS="mergeCells",oSt=150,kte=new WeakMap,Pte=OS,aSt=function(e){tSt(r,e);var t=rSt(r);function r(n){var i;return X0t(this,r),i=t.call(this,n),kte.set(jde(i),{lastDesiredCoords:null}),i.mergedCellsCollection=null,i.autofillCalculations=null,i.selectionCalculations=null,i}return Z0t(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[OS]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.mergedCellsCollection=new C0t(this),this.autofillCalculations=new $0t(this),this.selectionCalculations=new F0t(this),this.addHook("afterInit",function(){return i.onAfterInit.apply(i,arguments)}),this.addHook("modifyTransformStart",function(){return i.onModifyTransformStart.apply(i,arguments)}),this.addHook("afterModifyTransformStart",function(){return i.onAfterModifyTransformStart.apply(i,arguments)}),this.addHook("modifyTransformEnd",function(){return i.onModifyTransformEnd.apply(i,arguments)}),this.addHook("modifyGetCellCoords",function(){return i.onModifyGetCellCoords.apply(i,arguments)}),this.addHook("beforeSetRangeStart",function(){return i.onBeforeSetRangeStart.apply(i,arguments)}),this.addHook("beforeSetRangeStartOnly",function(){return i.onBeforeSetRangeStart.apply(i,arguments)}),this.addHook("beforeSetRangeEnd",function(){return i.onBeforeSetRangeEnd.apply(i,arguments)}),this.addHook("afterIsMultipleSelection",function(){return i.onAfterIsMultipleSelection.apply(i,arguments)}),this.addHook("afterRenderer",function(){return i.onAfterRenderer.apply(i,arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){return i.addMergeActionsToContextMenu.apply(i,arguments)}),this.addHook("afterGetCellMeta",function(){return i.onAfterGetCellMeta.apply(i,arguments)}),this.addHook("afterViewportRowCalculatorOverride",function(){return i.onAfterViewportRowCalculatorOverride.apply(i,arguments)}),this.addHook("afterViewportColumnCalculatorOverride",function(){return i.onAfterViewportColumnCalculatorOverride.apply(i,arguments)}),this.addHook("modifyAutofillRange",function(){return i.onModifyAutofillRange.apply(i,arguments)}),this.addHook("afterCreateCol",function(){return i.onAfterCreateCol.apply(i,arguments)}),this.addHook("afterRemoveCol",function(){return i.onAfterRemoveCol.apply(i,arguments)}),this.addHook("afterCreateRow",function(){return i.onAfterCreateRow.apply(i,arguments)}),this.addHook("afterRemoveRow",function(){return i.onAfterRemoveRow.apply(i,arguments)}),this.addHook("afterChange",function(){return i.onAfterChange.apply(i,arguments)}),this.addHook("beforeDrawBorders",function(){return i.onBeforeDrawAreaBorders.apply(i,arguments)}),this.addHook("afterDrawSelection",function(){return i.onAfterDrawSelection.apply(i,arguments)}),this.addHook("beforeRemoveCellClassNames",function(){return i.onBeforeRemoveCellClassNames.apply(i,arguments)}),this.addHook("beforeUndoStackChange",function(o,s){if(s==="MergeCells")return!1}),this.registerShortcuts(),gv(Mh(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),gv(Mh(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){var i=this.hot.getSettings()[OS];this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(i),gv(Mh(r.prototype),"updatePlugin",this).call(this)}},{key:"ifChromeForceRepaint",value:function(){var i=this;if(Mue()){var o=[],s=[];this.mergedCellsCollection.mergedCells.forEach(function(a){for(var h=a.row,p=a.rowspan,y=h+1;y<h+p;y++)s.push(y)}),s=G0t(new Set(s)),s.forEach(function(a){var h=i.hot.rowIndexMapper.getRenderableFromVisualIndex(a);i.hot.view._wt.wtOverlays.getOverlays(!0).map(function(p){return(p==null?void 0:p.name)==="master"?p:p.clone.wtTable}).forEach(function(p){var y=p.getRow(h);y&&(y.style.background=D1(y,"backgroundColor").replace(")",", 0.99)"),o.push(y))})}),this.hot._registerTimeout(function(){o.forEach(function(a){a.style.background=D1(a,"backgroundColor").replace(", 0.99)",")")})},1)}}},{key:"validateSetting",value:function(i){var o=!0;return i?(fu.containsNegativeValues(i)?(ni(fu.NEGATIVE_VALUES_WARNING(i)),o=!1):fu.isOutOfBounds(i,this.hot.countRows(),this.hot.countCols())?(ni(fu.IS_OUT_OF_BOUNDS_WARNING(i)),o=!1):fu.isSingleCell(i)?(ni(fu.IS_SINGLE_CELL(i)),o=!1):fu.containsZeroSpan(i)&&(ni(fu.ZERO_SPAN_WARNING(i)),o=!1),o):!1}},{key:"generateFromSettings",value:function(i){var o=this;if(Array.isArray(i)){var s=[];if(Fe(i,function(a){if(o.validateSetting(a)){var h=o.hot._createCellCoords(a.row,a.col),p=o.hot._createCellCoords(a.row+a.rowspan-1,a.col+a.colspan-1),y=o.hot._createCellRange(h,h,p);o.mergeRange(y,!0,!0),Or(a.row,a.row+a.rowspan-1,function(S){Or(a.col,a.col+a.colspan-1,function(E){S===a.row&&E===a.col||s.push([S,E,null])})})}}),s.length===0)return;this.hot.setDataAtCell(s)}}},{key:"clearCollections",value:function(){this.mergedCellsCollection.clear()}},{key:"canMergeRange",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return o?!0:this.validateSetting(i)}},{key:"toggleMergeOnSelection",value:function(){var i=this.hot.getSelectedRangeLast();if(i){i.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");var o=i.from,s=i.to;this.toggleMerge(i),this.hot.selectCell(o.row,o.col,s.row,s.col,!1)}}},{key:"mergeSelection",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(i){i.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");var o=i.from,s=i.to;this.unmergeRange(i,!0),this.mergeRange(i),this.hot.selectCell(o.row,o.col,s.row,s.col,!1)}}},{key:"unmergeSelection",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(i){var o=i.from,s=i.to;this.unmergeRange(i,!0),this.hot.selectCell(o.row,o.col,s.row,s.col,!1)}}},{key:"mergeRange",value:function(i){var o=this,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,h=i.getTopStartCorner(),p=i.getBottomEndCorner(),y={row:h.row,col:h.col,rowspan:p.row-h.row+1,colspan:p.col-h.col+1},S=[],E=null;if(!this.canMergeRange(y,s))return!1;this.hot.runHooks("beforeMergeCells",i,s),Or(0,y.rowspan-1,function(A){Or(0,y.colspan-1,function($){var B=null;S[A]||(S[A]=[]),A===0&&$===0?B=o.hot.getSourceDataAtCell(o.hot.toPhysicalRow(y.row),o.hot.toPhysicalColumn(y.col)):o.hot.setCellMeta(y.row+A,y.col+$,"hidden",!0),S[A][$]=B})}),this.hot.setCellMeta(y.row,y.col,"spanned",!0);var O=this.mergedCellsCollection.add(y);return O?(a?E=[y.row,y.col,S]:this.hot.populateFromArray(y.row,y.col,S,void 0,void 0,this.pluginName),s||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",i,y,s),E):!0}},{key:"unmergeRange",value:function(i){var o=this,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,a=this.mergedCellsCollection.getWithinRange(i);a&&(this.hot.runHooks("beforeUnmergeCells",i,s),Fe(a,function(h){o.mergedCellsCollection.remove(h.row,h.col),Or(0,h.rowspan-1,function(p){Or(0,h.colspan-1,function(y){o.hot.removeCellMeta(h.row+p,h.col+y,"hidden")})}),o.hot.removeCellMeta(h.row,h.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",i,s),this.hot.render())}},{key:"toggleMerge",value:function(i){var o=this.mergedCellsCollection.get(i.from.row,i.from.col),s=o.row===i.from.row&&o.col===i.from.col&&o.row+o.rowspan-1===i.to.row&&o.col+o.colspan-1===i.to.col;s?this.unmergeRange(i):this.mergeSelection(i)}},{key:"merge",value:function(i,o,s,a){var h=this.hot._createCellCoords(i,o),p=this.hot._createCellCoords(s,a);this.mergeRange(this.hot._createCellRange(h,h,p))}},{key:"unmerge",value:function(i,o,s,a){var h=this.hot._createCellCoords(i,o),p=this.hot._createCellCoords(s,a);this.unmergeRange(this.hot._createCellRange(h,h,p))}},{key:"onAfterInit",value:function(){this.generateFromSettings(this.hot.getSettings()[OS]),this.hot.render()}},{key:"registerShortcuts",value:function(){var i=this,o=this.hot.getShortcutManager(),s=o.getContext("grid");s.addShortcut({keys:[["Control","m"]],callback:function(){i.toggleMerge(i.hot.getSelectedRangeLast()),i.hot.render()},runOnlyIf:function(h){return!h.altKey},group:Pte})}},{key:"unregisterShortcuts",value:function(){var i=this.hot.getShortcutManager(),o=i.getContext("grid");o.removeShortcutsByGroup(Pte)}},{key:"onAfterIsMultipleSelection",value:function(i){if(i){for(var o=this.mergedCellsCollection.mergedCells,s=this.hot.getSelectedRangeLast(),a=0;a<o.length;a+=1)if(s.from.row===o[a].row&&s.from.col===o[a].col&&s.to.row===o[a].row+o[a].rowspan-1&&s.to.col===o[a].col+o[a].colspan-1)return!1}return i}},{key:"onModifyTransformStart",value:function(i){var o=kte.get(this),s=this.hot.getSelectedRangeLast(),a={row:i.row,col:i.col},h=null,p=this.hot._createCellCoords(s.highlight.row,s.highlight.col),y=this.mergedCellsCollection.get(p.row,p.col);if(o.lastDesiredCoords||(o.lastDesiredCoords=this.hot._createCellCoords(null,null)),y){var S=this.hot._createCellCoords(y.row,y.col),E=this.hot._createCellCoords(y.row+y.rowspan-1,y.col+y.colspan-1),O=this.hot._createCellRange(S,S,E);O.includes(o.lastDesiredCoords)||(o.lastDesiredCoords=this.hot._createCellCoords(null,null)),a.row=o.lastDesiredCoords.row?o.lastDesiredCoords.row-p.row:a.row,a.col=o.lastDesiredCoords.col?o.lastDesiredCoords.col-p.col:a.col,i.row>0?a.row=y.row+y.rowspan-1-p.row+i.row:i.row<0&&(a.row=p.row-y.row+i.row),i.col>0?a.col=y.col+y.colspan-1-p.col+i.col:i.col<0&&(a.col=p.col-y.col+i.col)}h=this.hot._createCellCoords(s.highlight.row+a.row,s.highlight.col+a.col);var A=this.mergedCellsCollection.get(h.row,h.col);if(A){var $=this.mergedCellsCollection.getFirstRenderableCoords(A.row,A.col);o.lastDesiredCoords=h,a={row:$.row-p.row,col:$.col-p.col}}a.row!==0&&(i.row=a.row),a.col!==0&&(i.col=a.col)}},{key:"onModifyTransformEnd",value:function(i){var o=this,s=this.hot.getSelectedRangeLast(),a=za(i),h=this.selectionCalculations.getUpdatedSelectionRange(s,i),p=za(a),y=this.mergedCellsCollection.getWithinRange(h,!0);do p=za(a),this.selectionCalculations.getUpdatedSelectionRange(s,a),Fe(y,function(S){o.selectionCalculations.snapDelta(a,s,S)});while(a.row!==p.row||a.col!==p.col);i.row=a.row,i.col=a.col}},{key:"onModifyGetCellCoords",value:function(i,o){if(!(i<0||o<0)){var s=this.mergedCellsCollection.get(i,o);if(s){var a=s.row,h=s.col,p=s.colspan,y=s.rowspan;return[a,h,a+y-1,h+p-1]}}}},{key:"addMergeActionsToContextMenu",value:function(i){i.items.push({name:"---------"},z0t(this))}},{key:"onAfterRenderer",value:function(i,o,s){var a=this.mergedCellsCollection.get(o,s),h=pn(a)?za(a):void 0;if(pn(h)){var p=this.hot,y=p.rowIndexMapper,S=p.columnIndexMapper,E=h.row,O=h.col,A=h.colspan,$=h.rowspan,B=this.translateMergedCellToRenderable(E,$,O,A),j=H0t(B,2),z=j[0],W=j[1],Q=y.getRenderableFromVisualIndex(o),q=S.getRenderableFromVisualIndex(s),Se=z-Q+1,Ie=W-q+1;h.row=y.getNearestNotHiddenIndex(h.row,1),h.col=S.getNearestNotHiddenIndex(h.col,1),h.rowspan=Math.min(h.rowspan,Se),h.colspan=Math.min(h.colspan,Ie)}nH(i,h,o,s)}},{key:"onBeforeSetRangeStart",value:function(i){if(this.mergedCellsCollection.isFirstRenderableMergedCell(i.row,i.col)){var o=this.mergedCellsCollection.get(i.row,i.col),s=[o.row,o.col];i.row=s[0],i.col=s[1]}}},{key:"onBeforeSetRangeEnd",value:function(i){var o=this.hot.getSelectedRangeLast();o.highlight=this.hot._createCellCoords(o.highlight.row,o.highlight.col),o.to=i;var s=!1;if(!(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()))do{s=!1;for(var a=0;a<this.mergedCellsCollection.mergedCells.length;a+=1){var h=this.mergedCellsCollection.mergedCells[a],p=h.getRange();o.expandByRange(p)&&(i.row=o.to.row,i.col=o.to.col,s=!0)}}while(s)}},{key:"onAfterGetCellMeta",value:function(i,o,s){var a=this.mergedCellsCollection.get(i,o);a&&(a.row!==i||a.col!==o?s.copyable=!1:(s.rowspan=a.rowspan,s.colspan=a.colspan))}},{key:"onAfterViewportRowCalculatorOverride",value:function(i){var o=this.hot.countCols();this.modifyViewportRowStart(i,o),this.modifyViewportRowEnd(i,o)}},{key:"modifyViewportRowStart",value:function(i,o){for(var s=this.hot.rowIndexMapper,a=s.getVisualFromRenderableIndex(i.startRow),h=0;h<o;h+=1){var p=this.mergedCellsCollection.get(a,h);if(pn(p)){var y=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(p.row,1));if(y<i.startRow){i.startRow=y,this.modifyViewportRowStart(i,o);return}}}}},{key:"modifyViewportRowEnd",value:function(i,o){for(var s=this.hot.rowIndexMapper,a=s.getVisualFromRenderableIndex(i.endRow),h=0;h<o;h+=1){var p=this.mergedCellsCollection.get(a,h);if(pn(p)){var y=p.row+p.rowspan-1,S=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(y,-1));if(S>i.endRow){i.endRow=S,this.modifyViewportRowEnd(i,o);return}}}}},{key:"onAfterViewportColumnCalculatorOverride",value:function(i){var o=this.hot.countRows();this.modifyViewportColumnStart(i,o),this.modifyViewportColumnEnd(i,o)}},{key:"modifyViewportColumnStart",value:function(i,o){for(var s=this.hot.columnIndexMapper,a=s.getVisualFromRenderableIndex(i.startColumn),h=0;h<o;h+=1){var p=this.mergedCellsCollection.get(h,a);if(pn(p)){var y=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(p.col,1));if(y<i.startColumn){i.startColumn=y,this.modifyViewportColumnStart(i,o);return}}}}},{key:"modifyViewportColumnEnd",value:function(i,o){for(var s=this.hot.columnIndexMapper,a=s.getVisualFromRenderableIndex(i.endColumn),h=0;h<o;h+=1){var p=this.mergedCellsCollection.get(h,a);if(pn(p)){var y=p.col+p.colspan-1,S=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(y,-1));if(S>i.endColumn){i.endColumn=S,this.modifyViewportColumnEnd(i,o);return}}}}},{key:"translateMergedCellToRenderable",value:function(i,o,s,a){var h=this.hot,p=h.rowIndexMapper,y=h.columnIndexMapper,S,E;o===0?S=p.getNearestNotHiddenIndex(i,1):S=p.getNearestNotHiddenIndex(i+o-1,-1),a===0?E=y.getNearestNotHiddenIndex(s,1):E=y.getNearestNotHiddenIndex(s+a-1,-1);var O=i>=0?p.getRenderableFromVisualIndex(S):i,A=s>=0?y.getRenderableFromVisualIndex(E):s;return[O,A]}},{key:"onModifyAutofillRange",value:function(i,o){this.autofillCalculations.correctSelectionAreaSize(o);var s=this.autofillCalculations.getDirection(o,i),a=i;if(this.autofillCalculations.dragAreaOverlapsCollections(o,a,s))return a=o,a;var h=this.mergedCellsCollection.getWithinRange({from:{row:o[0],col:o[1]},to:{row:o[2],col:o[3]}});return h&&(a=this.autofillCalculations.snapDragArea(o,a,s,h)),a}},{key:"onAfterCreateCol",value:function(i,o){this.mergedCellsCollection.shiftCollections("right",i,o)}},{key:"onAfterRemoveCol",value:function(i,o){this.mergedCellsCollection.shiftCollections("left",i,o)}},{key:"onAfterCreateRow",value:function(i,o,s){s!=="auto"&&this.mergedCellsCollection.shiftCollections("down",i,o)}},{key:"onAfterRemoveRow",value:function(i,o){this.mergedCellsCollection.shiftCollections("up",i,o)}},{key:"onAfterChange",value:function(i,o){o==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(i)}},{key:"onBeforeDrawAreaBorders",value:function(i,o){if(o&&o==="area"){var s=this.hot.getSelectedRangeLast(),a=this.mergedCellsCollection.getWithinRange(s);Fe(a,function(h){s.getBottomEndCorner().row===h.getLastRow()&&s.getBottomEndCorner().col===h.getLastColumn()&&(i[2]=h.row,i[3]=h.col)})}}},{key:"onAfterModifyTransformStart",value:function(i,o,s){if(this.enabled){var a=this.mergedCellsCollection.get(i.row,i.col);if(a){var h=o>0,p=o<0,y=s<0,S=s>0,E=a.row+a.rowspan-1===this.hot.countRows()-1,O=a.row===0,A=a.col+a.colspan-1===this.hot.countCols()-1,$=a.col===0;(h&&E||p&&O||S&&A||y&&$)&&(i.row=a.row,i.col=a.col)}}}},{key:"onAfterDrawSelection",value:function(i,o,s,a){if(s)return this.selectionCalculations.getSelectedMergedCellClassName(i,o,s,a)}},{key:"onBeforeRemoveCellClassNames",value:function(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}}],[{key:"PLUGIN_KEY",get:function(){return OS}},{key:"PLUGIN_PRIORITY",get:function(){return oSt}}]),r}(Yn);function Ate(e){return cSt(e)||uSt(e)||lSt(e)||sSt()}function sSt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function lSt(e,t){if(e){if(typeof e=="string")return Ite(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ite(e,t)}}function Ite(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function uSt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function cSt(e){if(Array.isArray(e))return e}function fSt(e,t){return function(r,n){var i=Ate(r),o=i.slice(1),s=Ate(n),a=s.slice(1);return function h(p){var y=e[p],S=t[p],E=o[p],O=a[p],A=S.multiColumnSorting,$=A.compareFunctionFactory?A.compareFunctionFactory:Ffe(S.type),B=$(y,S,A)(E,O);if(B===wu){var j=p+1;if(typeof t[j]<"u")return h(j)}return B}(0)}}var Mte;function hSt(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function $te(){ni(Jn(Mte||(Mte=hSt(["Plugins `columnSorting` and `multiColumnSorting` should not be enabled simultaneously. \n    Only `multiColumnSorting` will work."],["Plugins \\`columnSorting\\` and \\`multiColumnSorting\\` should not be enabled simultaneously. \n    Only \\`multiColumnSorting\\` will work."]))))}var Fde="sort";function dSt(e,t,r){var n=[];return r===!1||e.isColumnSorted(t)&&e.getNumberOfSortedColumns()>1&&n.push("".concat(Fde,"-").concat(e.getIndexOfColumnInSortQueue(t)+1)),n}function pSt(e){var t=e.className.split(" "),r=new RegExp("^".concat(Fde,"-[0-9]{1,2}$"));return t.filter(function(n){return r.test(n)})}function xb(e){"@babel/helpers - typeof";return xb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xb(e)}function mSt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Dte(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ySt(n.key),n)}}function gSt(e,t,r){return t&&Dte(e.prototype,t),r&&Dte(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ySt(e){var t=vSt(e,"string");return xb(t)==="symbol"?t:String(t)}function vSt(e,t){if(xb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(xb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function is(){return typeof Reflect<"u"&&Reflect.get?is=Reflect.get.bind():is=function(t,r,n){var i=_St(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},is.apply(this,arguments)}function _St(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=pa(e),e!==null););return e}function bSt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&sH(e,t)}function sH(e,t){return sH=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},sH(e,t)}function wSt(e){var t=CSt();return function(){var n=pa(e),i;if(t){var o=pa(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return SSt(this,i)}}function SSt(e,t){if(t&&(xb(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return xSt(e)}function xSt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function CSt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function pa(e){return pa=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},pa(e)}var lH="multiColumnSorting",ESt=170,TSt="append",Lte="columnSorting";jfe(lH,fSt);var OSt=function(e){bSt(r,e);var t=wSt(r);function r(n){var i;return mSt(this,r),i=t.call(this,n),i.pluginKey=lH,i}return gSt(r,[{key:"isEnabled",value:function(){return is(pa(r.prototype),"isEnabled",this).call(this)}},{key:"enablePlugin",value:function(){!this.enabled&&this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[Lte]&&$te(),is(pa(r.prototype),"enablePlugin",this).call(this)}},{key:"disablePlugin",value:function(){is(pa(r.prototype),"disablePlugin",this).call(this)}},{key:"sort",value:function(i){is(pa(r.prototype),"sort",this).call(this,i)}},{key:"clearSort",value:function(){is(pa(r.prototype),"clearSort",this).call(this)}},{key:"isSorted",value:function(){return is(pa(r.prototype),"isSorted",this).call(this)}},{key:"getSortConfig",value:function(i){return is(pa(r.prototype),"getSortConfig",this).call(this,i)}},{key:"setSortConfig",value:function(i){is(pa(r.prototype),"setSortConfig",this).call(this,i)}},{key:"getNormalizedSortConfigs",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(i)?i:[i]}},{key:"updateHeaderClasses",value:function(i){for(var o,s=arguments.length,a=new Array(s>1?s-1:0),h=1;h<s;h++)a[h-1]=arguments[h];(o=is(pa(r.prototype),"updateHeaderClasses",this)).call.apply(o,[this,i].concat(a)),qr(i,pSt(i)),this.enabled!==!1&&Vt(i,dSt.apply(void 0,a))}},{key:"onUpdateSettings",value:function(i){this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[Lte]&&$te(),is(pa(r.prototype),"onUpdateSettings",this).call(this,i)}},{key:"onAfterOnCellMouseDown",value:function(i,o){zF(o.row,o.col,i)!==!1&&this.wasClickableHeaderClicked(i,o.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(o.col),this.sort(this.getNextSortConfig(o.col,TSt))):this.sort(this.getColumnNextConfig(o.col)))}}],[{key:"PLUGIN_KEY",get:function(){return lH}},{key:"PLUGIN_PRIORITY",get:function(){return ESt}}]),r}(Hfe);function Cb(e){"@babel/helpers - typeof";return Cb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cb(e)}function RSt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Nte(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,PSt(n.key),n)}}function kSt(e,t,r){return t&&Nte(e.prototype,t),r&&Nte(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function PSt(e){var t=ASt(e,"string");return Cb(t)==="symbol"?t:String(t)}function ASt(e,t){if(Cb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Cb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function eP(){return typeof Reflect<"u"&&Reflect.get?eP=Reflect.get.bind():eP=function(t,r,n){var i=ISt(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},eP.apply(this,arguments)}function ISt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Eb(e),e!==null););return e}function MSt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&uH(e,t)}function uH(e,t){return uH=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},uH(e,t)}function $St(e){var t=NSt();return function(){var n=Eb(e),i;if(t){var o=Eb(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return DSt(this,i)}}function DSt(e,t){if(t&&(Cb(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return LSt(e)}function LSt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function NSt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Eb(e){return Eb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Eb(e)}var BSt="multipleSelectionHandles",jSt=160,FSt=function(e){MSt(r,e);var t=$St(r);function r(n){var i;return RSt(this,r),i=t.call(this,n),i.dragged=[],i.eventManager=null,i.lastSetCell=null,i}return kSt(r,[{key:"isEnabled",value:function(){return gu()}},{key:"enablePlugin",value:function(){this.enabled||(this.eventManager||(this.eventManager=new Fi(this)),this.registerListeners(),eP(Eb(r.prototype),"enablePlugin",this).call(this))}},{key:"registerListeners",value:function(){var i=this,o=this,s=this.hot.rootElement;function a(h){if(o.dragged.length===1)return o.dragged.splice(0,o.dragged.length),!0;var p=o.dragged.indexOf(h);if(p===-1)return!1;p===0?o.dragged=o.dragged.slice(0,1):p===1&&(o.dragged=o.dragged.slice(-1))}this.eventManager.addEventListener(s,"touchstart",function(h){var p;if(Wr(h.target,"topSelectionHandle-HitArea"))return p=o.hot.getSelectedRangeLast(),o.dragged.push("top"),o.touchStartRange={width:p.getWidth(),height:p.getHeight(),direction:p.getDirection()},h.preventDefault(),!1;if(Wr(h.target,"bottomSelectionHandle-HitArea"))return p=o.hot.getSelectedRangeLast(),o.dragged.push("bottom"),o.touchStartRange={width:p.getWidth(),height:p.getHeight(),direction:p.getDirection()},h.preventDefault(),!1}),this.eventManager.addEventListener(s,"touchend",function(h){if(Wr(h.target,"topSelectionHandle-HitArea"))return a.call(o,"top"),o.touchStartRange=void 0,h.preventDefault(),!1;if(Wr(h.target,"bottomSelectionHandle-HitArea"))return a.call(o,"bottom"),o.touchStartRange=void 0,h.preventDefault(),!1}),this.eventManager.addEventListener(s,"touchmove",function(h){var p=i.hot.rootDocument,y,S,E,O,A,$;if(o.dragged.length!==0){var B=p.elementFromPoint(h.touches[0].clientX,h.touches[0].clientY);!B||B===o.lastSetCell||((B.nodeName==="TD"||B.nodeName==="TH")&&(y=o.hot.getCoords(B),y.col===-1&&(y.col=0),S=o.hot.getSelectedRangeLast(),E=S.getWidth(),O=S.getHeight(),A=S.getDirection(),E===1&&O===1&&o.hot.selection.setRangeEnd(y),$=o.getCurrentRangeCoords(S,y,o.touchStartRange.direction,A,o.dragged[0]),$.start!==null&&o.hot.selection.setRangeStart($.start),o.hot.selection.setRangeEnd($.end),o.lastSetCell=B),h.preventDefault())}})}},{key:"getCurrentRangeCoords",value:function(i,o,s,a,h){var p=i.getTopStartCorner(),y=i.getBottomEndCorner(),S=i.getBottomStartCorner(),E=i.getTopEndCorner(),O={start:null,end:null};switch(s){case"NE-SW":switch(a){case"NE-SW":case"NW-SE":h==="top"?O={start:this.hot._createCellCoords(o.row,i.highlight.col),end:this.hot._createCellCoords(S.row,o.col)}:O={start:this.hot._createCellCoords(i.highlight.row,o.col),end:this.hot._createCellCoords(o.row,p.col)};break;case"SE-NW":h==="bottom"&&(O={start:this.hot._createCellCoords(y.row,o.col),end:this.hot._createCellCoords(o.row,p.col)});break}break;case"NW-SE":switch(a){case"NE-SW":h==="top"?O={start:o,end:S}:O.end=o;break;case"NW-SE":h==="top"?O={start:o,end:y}:O.end=o;break;case"SE-NW":h==="top"?O={start:o,end:p}:O.end=o;break;case"SW-NE":h==="top"?O={start:o,end:E}:O.end=o;break}break;case"SW-NE":switch(a){case"NW-SE":h==="bottom"?O={start:this.hot._createCellCoords(o.row,p.col),end:this.hot._createCellCoords(S.row,o.col)}:O={start:this.hot._createCellCoords(p.row,o.col),end:this.hot._createCellCoords(o.row,y.col)};break;case"SW-NE":h==="top"?O={start:this.hot._createCellCoords(i.highlight.row,o.col),end:this.hot._createCellCoords(o.row,y.col)}:O={start:this.hot._createCellCoords(o.row,p.col),end:this.hot._createCellCoords(p.row,o.col)};break;case"SE-NW":h==="bottom"?O={start:this.hot._createCellCoords(o.row,E.col),end:this.hot._createCellCoords(p.row,o.col)}:h==="top"&&(O={start:S,end:o});break}break;case"SE-NW":switch(a){case"NW-SE":case"NE-SW":case"SW-NE":h==="top"&&(O.end=o);break;case"SE-NW":h==="top"?O.end=o:O={start:o,end:p};break}break}return O}},{key:"isDragged",value:function(){return this.dragged.length>0}}],[{key:"PLUGIN_KEY",get:function(){return BSt}},{key:"PLUGIN_PRIORITY",get:function(){return jSt}}]),r}(Yn);function cH(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.label,r=t===void 0?"":t,n=e.colspan,i=n===void 0?1:n,o=e.origColspan,s=o===void 0?1:o,a=e.collapsible,h=a===void 0?!1:a,p=e.crossHiddenColumns,y=p===void 0?[]:p,S=e.isCollapsed,E=S===void 0?!1:S,O=e.isHidden,A=O===void 0?!1:O,$=e.isRoot,B=$===void 0?!1:$,j=e.isPlaceholder,z=j===void 0?!1:j;return{label:r,colspan:i,origColspan:s,collapsible:h,isCollapsed:E,crossHiddenColumns:y,isHidden:A,isRoot:B,isPlaceholder:z}}function zde(){return{label:"",isPlaceholder:!0}}function Bte(e){return USt(e)||VSt(e)||HSt(e)||zSt()}function zSt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function HSt(e,t){if(e){if(typeof e=="string")return fH(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return fH(e,t)}}function VSt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function USt(e){if(Array.isArray(e))return fH(e)}function fH(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function WSt(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0,r=[];if(t===0)return r;Fe(e,function(i){var o=[],s=0;r.push(o),Fe(i,function(a){var h=cH();if(pn(a)){var p=a.label,y=a.colspan;h.label=Ji(p),typeof y=="number"&&y>1&&(h.colspan=y,h.origColspan=y)}else h.label=Ji(a);s+=h.origColspan;var S=!1;if(s>=t&&(h.colspan=h.origColspan-(s-t),h.origColspan=h.colspan,S=!0),o.push(h),h.colspan>1)for(var E=0;E<h.colspan-1;E++)o.push(zde());return!S})});var n=Math.max.apply(Math,Bte(dn(r,function(i){return i.length})));return Fe(r,function(i){if(i.length<n){var o=dn(new Array(n-i.length),function(){return cH()});i.splice.apply(i,[i.length,0].concat(Bte(o)))}}),r}function SC(e){"@babel/helpers - typeof";return SC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},SC(e)}var GSt=["row","col"];function jte(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function YSt(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?jte(Object(r),!0).forEach(function(n){KSt(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):jte(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function KSt(e,t,r){return t=Hde(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function qSt(e,t){if(e==null)return{};var r=XSt(e,t),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function XSt(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,o;for(o=0;o<n.length;o++)i=n[o],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function ZSt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Fte(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Hde(n.key),n)}}function JSt(e,t,r){return t&&Fte(e.prototype,t),r&&Fte(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Hde(e){var t=QSt(e,"string");return SC(t)==="symbol"?t:String(t)}function QSt(e,t){if(SC(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(SC(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _N(e,t,r){e1t(e,t),t.set(e,r)}function e1t(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function dl(e,t){var r=Vde(e,t,"get");return t1t(e,r)}function t1t(e,t){return t.get?t.get.call(e):t.value}function mS(e,t,r){var n=Vde(e,t,"set");return r1t(e,n,r),r}function Vde(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function r1t(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var zte=["label","collapsible"],Ju=new WeakMap,ip=new WeakMap,bN=new WeakMap,n1t=function(){function e(){ZSt(this,e),_N(this,Ju,{writable:!0,value:[]}),_N(this,ip,{writable:!0,value:0}),_N(this,bN,{writable:!0,value:1/0})}return JSt(e,[{key:"setColumnsLimit",value:function(r){mS(this,bN,r)}},{key:"setData",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];mS(this,Ju,WSt(r,dl(this,bN))),mS(this,ip,dl(this,Ju).length)}},{key:"getData",value:function(){return dl(this,Ju)}},{key:"mergeWith",value:function(r){var n=this;Fe(r,function(i){var o=i.row,s=i.col,a=qSt(i,GSt),h=n.getHeaderSettings(o,s);h!==null&&lo(h,a,zte)})}},{key:"map",value:function(r){Fe(dl(this,Ju),function(n){Fe(n,function(i){var o=r(YSt({},i));pn(o)&&lo(i,o,zte)})})}},{key:"getHeaderSettings",value:function(r,n){var i;if(r>=dl(this,ip)||r<0)return null;var o=dl(this,Ju)[r];return n>=o.length?null:(i=o[n])!==null&&i!==void 0?i:null}},{key:"getHeadersSettings",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,o=[];if(r>=dl(this,ip)||r<0)return o;for(var s=dl(this,Ju)[r],a=0,h=n;h<s.length;h++){var p=s[h];if(p.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(a+=p.colspan,o.push(p),p.colspan>1&&(h+=p.colspan-1),a===i)break;if(a>i)throw new Error("The last column settings cannot overlap the other header layers")}return o}},{key:"getLayersCount",value:function(){return dl(this,ip)}},{key:"getColumnsCount",value:function(){return dl(this,ip)>0?dl(this,Ju)[0].length:0}},{key:"clear",value:function(){mS(this,Ju,[]),mS(this,ip,0)}}]),e}();function xC(e){"@babel/helpers - typeof";return xC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xC(e)}function Hte(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Vte(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Hte(Object(r),!0).forEach(function(n){tP(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Hte(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function i1t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ute(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ude(n.key),n)}}function o1t(e,t,r){return t&&Ute(e.prototype,t),r&&Ute(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function tP(e,t,r){return t=Ude(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ude(e){var t=a1t(e,"string");return xC(t)==="symbol"?t:String(t)}function a1t(e,t){if(xC(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(xC(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function s1t(e){return f1t(e)||c1t(e)||u1t(e)||l1t()}function l1t(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function u1t(e,t){if(e){if(typeof e=="string")return hH(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return hH(e,t)}}function c1t(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function f1t(e){if(Array.isArray(e))return hH(e)}function hH(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var h1t="DF-pre-order";function Wde(e,t){for(var r=e.call(t,this),n=0;n<this.childs.length;n++){if(r===!1)return!1;r=Wde.call(this.childs[n],e,t)}return r}var d1t="DF-post-order";function Gde(e,t){for(var r=0;r<this.childs.length;r++){var n=Gde.call(this.childs[r],e,t);if(n===!1)return!1}return e.call(t,this)}var Yde="BF";function p1t(e,t){var r=[this];function n(){if(r.length!==0){var i=r.shift();r.push.apply(r,s1t(i.childs)),e.call(t,i)!==!1&&n()}}n()}var m1t=Yde,Wte=new Map([[h1t,Wde],[d1t,Gde],[Yde,p1t]]),Gte=function(){function e(t){i1t(this,e),tP(this,"data",{}),tP(this,"parent",null),tP(this,"childs",[]),this.data=t}return o1t(e,[{key:"addChild",value:function(r){r.parent=this,this.childs.push(r)}},{key:"cloneTree",value:function(){for(var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this,n=new e(Vte({},r.data)),i=0;i<r.childs.length;i++)n.addChild(this.cloneTree(r.childs[i]));return n}},{key:"replaceTreeWith",value:function(r){this.data=Vte({},r.data),this.childs=[];for(var n=0;n<r.childs.length;n++)this.addChild(r.childs[n])}},{key:"walkDown",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:m1t;if(!Wte.has(n))throw new Error('Traversal strategy "'.concat(n,'" does not exist'));Wte.get(n).call(this,r,this)}},{key:"walkUp",value:function(r){var n=this,i=function o(s){var a=r.call(n,s);a!==!1&&s.parent!==null&&o(s.parent)};i(this)}}]),e}();function CC(e){"@babel/helpers - typeof";return CC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},CC(e)}function Yte(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Kte(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Yte(Object(r),!0).forEach(function(n){g1t(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Yte(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function g1t(e,t,r){return t=Kde(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function y1t(e,t){return w1t(e)||b1t(e,t)||_1t(e,t)||v1t()}function v1t(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _1t(e,t){if(e){if(typeof e=="string")return qte(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return qte(e,t)}}function qte(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function b1t(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],h=!0,p=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;h=!1}else for(;!(h=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);h=!0);}catch(y){p=!0,i=y}finally{try{if(!h&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(p)throw i}}return a}}function w1t(e){if(Array.isArray(e))return e}function S1t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Xte(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Kde(n.key),n)}}function x1t(e,t,r){return t&&Xte(e.prototype,t),r&&Xte(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Kde(e){var t=C1t(e,"string");return CC(t)==="symbol"?t:String(t)}function C1t(e,t){if(CC(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(CC(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function wN(e,t,r){E1t(e,t),t.set(e,r)}function E1t(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function fa(e,t){var r=qde(e,t,"get");return T1t(e,r)}function T1t(e,t){return t.get?t.get.call(e):t.value}function O1t(e,t,r){var n=qde(e,t,"set");return R1t(e,n,r),r}function qde(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function R1t(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var Sy=new WeakMap,op=new WeakMap,xy=new WeakMap,k1t=function(){function e(t){S1t(this,e),wN(this,Sy,{writable:!0,value:new Map}),wN(this,op,{writable:!0,value:new Map}),wN(this,xy,{writable:!0,value:null}),O1t(this,xy,t)}return x1t(e,[{key:"getRoots",value:function(){return Array.from(fa(this,Sy).values())}},{key:"getRootByColumn",value:function(r){var n;return fa(this,op).has(r)&&(n=fa(this,Sy).get(fa(this,op).get(r))),n}},{key:"getNode",value:function(r,n){var i=this.getRootByColumn(n);if(i){var o=n-fa(this,op).get(n),s=0,a;return i.walkDown(function(h){var p=h.data,y=p.origColspan,S=p.headerLevel;if(r===S){if(o>=s&&o<=s+y-1)return a=h,a.data.isRoot=n===a.data.columnIndex,!1;s+=y}}),a}}},{key:"rebuildTreeIndex",value:function(){var r=this,n=0;fa(this,op).clear(),Fe(fa(this,Sy),function(i){for(var o=y1t(i,2),s=o[1].data.colspan,a=n;a<n+s;a++)fa(r,op).set(a,n);n+=s})}},{key:"buildTree",value:function(){this.clear();for(var r=fa(this,xy).getColumnsCount(),n=0;n<r;){var i=fa(this,xy).getHeaderSettings(0,n),o=new Gte;fa(this,Sy).set(n,o),this.buildLeaves(o,n,0,i.origColspan),n+=i.origColspan}this.rebuildTreeIndex()}},{key:"buildLeaves",value:function(r,n,i){var o=this,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1,a=fa(this,xy).getHeadersSettings(i,n,s);i+=1,Fe(a,function(h){var p=Kte(Kte({},h),{},{headerLevel:i-1,columnIndex:n}),y;i===1?(r.data=p,y=r):(y=new Gte(p),r.addChild(y)),i<fa(o,xy).getLayersCount()&&o.buildLeaves(y,n,i,h.origColspan),n+=h.origColspan})}},{key:"clear",value:function(){fa(this,Sy).clear(),fa(this,op).clear()}}]),e}();function Xde(e,t){e.walkDown(function(r){var n=r.data,i=r.childs;if(!n.isHidden&&(t(n.columnIndex),i.length===0))for(var o=1;o<n.colspan;o++)t(n.columnIndex+o)})}function HA(e,t){var r=e.childs;if(r.length!==0)return r[0].data[t]}function VA(e){return HA(e,"origColspan")===e.data.origColspan}function LW(e){var t=e.data,r=e.childs;if(!t.isCollapsed||t.isHidden||t.origColspan<=1)return{rollbackModification:function(){},affectedColumns:[],colspanCompensation:0};var n=VA(e);if(n)return LW(r[0]);t.isCollapsed=!1;var i=r.slice(1),o=new Set,s=0;if(i.length>0)Fe(i,function(S){S.replaceTreeWith(S.data.clonedTree),S.data.clonedTree=null;var E=S.data;s+=E.colspan,Xde(S,function(O){o.add(O)})});else{var a=t.colspan,h=t.origColspan,p=t.columnIndex;s=h-a;for(var y=1;y<h;y++)o.add(p+y)}return e.walkUp(function(S){var E=S.data;E.colspan+=s,E.colspan>=E.origColspan?(E.colspan=E.origColspan,E.isCollapsed=!1):VA(S)&&(E.isCollapsed=HA(S,"isCollapsed"))}),{rollbackModification:function(){return NW(e)},affectedColumns:Array.from(o),colspanCompensation:s}}function NW(e){var t,r=e.data,n=e.childs;if(r.isCollapsed||r.isHidden||r.origColspan<=1)return{rollbackModification:function(){},affectedColumns:[],colspanCompensation:0};var i=VA(e);if(i)return NW(n[0]);r.isCollapsed=!0;var o=n.slice(1),s=new Set;if(o.length>0)Fe(o,function(E){Xde(E,function(O){s.add(O)}),E.data.clonedTree=E.cloneTree(),E.walkDown(function(O){var A=O.data;A.isHidden=!0})});else for(var a=r.origColspan,h=r.columnIndex,p=1;p<a;p++){var y=h+p;s.add(y)}var S=r.colspan-((t=HA(e,"colspan"))!==null&&t!==void 0?t:1);return e.walkUp(function(E){var O=E.data;O.colspan-=S,O.colspan<=1?(O.colspan=1,O.isCollapsed=!0):VA(E)&&(O.isCollapsed=HA(E,"isCollapsed"))}),{rollbackModification:function(){return LW(e)},affectedColumns:Array.from(s),colspanCompensation:S}}var Zte;function P1t(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function A1t(e,t){if(!Number.isInteger(t))throw new Error("The passed gridColumnIndex argument has invalid type.");if(e.childs.length>0)throw new Error(Jn(Zte||(Zte=P1t([`The passed node is not the last node on the tree. Only for 
the last node, the hide column modification can be applied.`],[`The passed node is not the last node on the tree. Only for\\x20
the last node, the hide column modification can be applied.`]))));var r=e.data.crossHiddenColumns;if(!r.includes(t)){var n=!1;e.walkUp(function(i){var o=i.data.collapsible;if(o)return n=!0,!1}),!n&&e.walkUp(function(i){var o=i.data;o.crossHiddenColumns.push(t),o.colspan>1?o.colspan-=1:o.isHidden=!0})}}var Jte;function I1t(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function M1t(e,t){if(!Number.isInteger(t))throw new Error("The passed gridColumnIndex argument has invalid type.");if(e.childs.length>0)throw new Error(Jn(Jte||(Jte=I1t([`The passed node is not the last node on the tree. Only for 
the last node, the show column modification can be applied.`],[`The passed node is not the last node on the tree. Only for\\x20
the last node, the show column modification can be applied.`]))));var r=e.data.crossHiddenColumns;if(r.includes(t)){var n=!1;e.walkUp(function(i){var o=i.data.collapsible;if(o)return n=!0,!1}),!n&&e.walkUp(function(i){var o=i.data;o.crossHiddenColumns.splice(o.crossHiddenColumns.indexOf(t),1),!o.isHidden&&o.colspan<o.origColspan&&(o.colspan+=1),o.isHidden=!1})}}var Qte=new Map([["collapse",NW],["expand",LW],["hide-column",A1t],["show-column",M1t]]);function $1t(e,t,r){if(!Qte.has(e))throw new Error('The node modifier action ("'.concat(e,'") does not exist.'));return Qte.get(e)(t,r)}var D1t=["crossHiddenColumns"];function L1t(e,t){if(e==null)return{};var r=N1t(e,t),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function N1t(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,o;for(o=0;o<n.length;o++)i=n[o],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function XR(e){var t=[];return Fe(e,function(r){r.walkDown(function(n){for(var i=n.data,o=i.origColspan,s=i.columnIndex,a=i.headerLevel,h=i.crossHiddenColumns,p=j1t(t,a),y=!1,S=s;S<s+o;S++){var E=h.includes(S);if(E||y)p.push(zde());else{var O=B1t(i);O.isRoot=!0,p.push(O),y=!0}}})}),t}function B1t(e){var t=cH(e);t.crossHiddenColumns;var r=L1t(t,D1t);return r}function j1t(e,t){var r;return Array.isArray(e[t])?r=e[t]:(r=[],e[t]=r),r}function EC(e){"@babel/helpers - typeof";return EC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},EC(e)}var F1t=["row"];function ere(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function tre(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ere(Object(r),!0).forEach(function(n){z1t(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ere(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function z1t(e,t,r){return t=Zde(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function H1t(e,t){if(e==null)return{};var r=V1t(e,t),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function V1t(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,o;for(o=0;o<n.length;o++)i=n[o],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function U1t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function rre(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Zde(n.key),n)}}function W1t(e,t,r){return t&&rre(e.prototype,t),r&&rre(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Zde(e){var t=G1t(e,"string");return EC(t)==="symbol"?t:String(t)}function G1t(e,t){if(EC(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(EC(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function SN(e,t,r){Y1t(e,t),t.set(e,r)}function Y1t(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gS(e,t,r){var n=Jde(e,t,"set");return K1t(e,n,r),r}function K1t(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}function Ui(e,t){var r=Jde(e,t,"get");return q1t(e,r)}function Jde(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function q1t(e,t){return t.get?t.get.call(e):t.value}var lu=new WeakMap,ts=new WeakMap,ap=new WeakMap,X1t=function(){function e(){U1t(this,e),SN(this,lu,{writable:!0,value:new n1t}),SN(this,ts,{writable:!0,value:new k1t(Ui(this,lu))}),SN(this,ap,{writable:!0,value:[[]]})}return W1t(e,[{key:"setState",value:function(r){Ui(this,lu).setData(r);var n=!1;try{Ui(this,ts).buildTree()}catch{Ui(this,ts).clear(),Ui(this,lu).clear(),n=!0}return gS(this,ap,XR(Ui(this,ts).getRoots())),n}},{key:"setColumnsLimit",value:function(r){Ui(this,lu).setColumnsLimit(r)}},{key:"mergeStateWith",value:function(r){var n=this,i=dn(r,function(o){var s=o.row,a=H1t(o,F1t);return tre({row:s<0?n.rowCoordsToLevel(s):s},a)});Ui(this,lu).mergeWith(i),Ui(this,ts).buildTree(),gS(this,ap,XR(Ui(this,ts).getRoots()))}},{key:"mapState",value:function(r){Ui(this,lu).map(r),Ui(this,ts).buildTree(),gS(this,ap,XR(Ui(this,ts).getRoots()))}},{key:"mapNodes",value:function(r){return oa(Ui(this,ts).getRoots(),function(n,i){return i.walkDown(function(o){var s=r(o.data);s!==void 0&&n.push(s)}),n},[])}},{key:"triggerNodeModification",value:function(r,n,i){n<0&&(n=this.rowCoordsToLevel(n));var o=Ui(this,ts).getNode(n,i),s;return o&&(s=$1t(r,o,i),gS(this,ap,XR(Ui(this,ts).getRoots()))),s}},{key:"triggerColumnModification",value:function(r,n){return this.triggerNodeModification(r,-1,n)}},{key:"rowCoordsToLevel",value:function(r){if(r>=0)return null;var n=r+Math.max(this.getLayersCount(),1);return n<0?null:n}},{key:"levelToRowCoords",value:function(r){if(r<0)return null;var n=r-Math.max(this.getLayersCount(),1);return n>=0?null:n}},{key:"getHeaderSettings",value:function(r,n){var i,o;return r<0&&(r=this.rowCoordsToLevel(r)),r===null||r>=this.getLayersCount()?null:(i=(o=Ui(this,ap)[r])===null||o===void 0?void 0:o[n])!==null&&i!==void 0?i:null}},{key:"getHeaderTreeNodeData",value:function(r,n){if(r<0&&(r=this.rowCoordsToLevel(r)),r===null||r>=this.getLayersCount())return null;var i=Ui(this,ts).getNode(r,n);return i?tre({},i.data):null}},{key:"findLeftMostColumnIndex",value:function(r,n){var i,o=(i=this.getHeaderSettings(r,n))!==null&&i!==void 0?i:{isRoot:!0},s=o.isRoot;if(s)return n;for(var a=n-1;a>=0;){var h,p=(h=this.getHeaderSettings(r,a))!==null&&h!==void 0?h:{isRoot:!0},y=p.isRoot;if(y)break;a-=1}return a}},{key:"getLayersCount",value:function(){return Ui(this,lu).getLayersCount()}},{key:"getColumnsCount",value:function(){return Ui(this,lu).getColumnsCount()}},{key:"clear",value:function(){gS(this,ap,[]),Ui(this,lu).clear(),Ui(this,ts).clear()}}]),e}();function TC(e){"@babel/helpers - typeof";return TC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},TC(e)}function Z1t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function nre(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Qde(n.key),n)}}function J1t(e,t,r){return t&&nre(e.prototype,t),r&&nre(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function yS(e,t,r){return t=Qde(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Qde(e){var t=Q1t(e,"string");return TC(t)==="symbol"?t:String(t)}function Q1t(e,t){if(TC(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(TC(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ext=function(){function e(t,r){Z1t(this,e),yS(this,"hot",void 0),yS(this,"nestedHeaderSettingsGetter",void 0),yS(this,"layersCount",0),yS(this,"container",void 0),yS(this,"widthsMap",void 0),this.hot=t,this.nestedHeaderSettingsGetter=r,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}return J1t(e,[{key:"setLayersCount",value:function(r){return this.layersCount=r,this}},{key:"getWidth",value:function(r){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(r))}},{key:"buildWidthsMap",value:function(){this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);var r=this.container.querySelectorAll("tr:last-of-type th"),n=r.length;this.widthsMap.clear();for(var i=0;i<n;i++){var o=this.hot.columnIndexMapper.getVisualFromRenderableIndex(i),s=this.hot.toPhysicalColumn(o);this.widthsMap.setValueAtIndex(s,r[i].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}},{key:"_buildGhostTable",value:function(r){for(var n=this.hot,i=n.rootDocument,o=n.columnIndexMapper,s=i.createDocumentFragment(),a=i.createElement("table"),h=!!this.hot.getSettings().dropdownMenu,p=o.getRenderableIndexesLength(),y=0;y<this.layersCount;y++){for(var S=i.createElement("tr"),E=0;E<p;E++){var O=o.getVisualFromRenderableIndex(E);O===null&&(O=E);var A=i.createElement("th"),$=this.nestedHeaderSettingsGetter(y,O);if($&&(!$.isPlaceholder||$.isHidden)){var B=$.label;h&&(B+='<button class="changeType"></button>'),iw(A,B),A.colSpan=$.colspan,S.appendChild(A)}}a.appendChild(S)}s.appendChild(a),r.appendChild(s)}},{key:"clear",value:function(){this.widthsMap.clear(),this.container=null}}]),e}();const txt=ext;function Tb(e){"@babel/helpers - typeof";return Tb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Tb(e)}var ire,ore;function are(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function rxt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function sre(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,epe(n.key),n)}}function nxt(e,t,r){return t&&sre(e.prototype,t),r&&sre(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Vp(){return typeof Reflect<"u"&&Reflect.get?Vp=Reflect.get.bind():Vp=function(t,r,n){var i=ixt(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Vp.apply(this,arguments)}function ixt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ic(e),e!==null););return e}function oxt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&dH(e,t)}function dH(e,t){return dH=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},dH(e,t)}function axt(e){var t=lxt();return function(){var n=Ic(e),i;if(t){var o=Ic(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return sxt(this,i)}}function sxt(e,t){if(t&&(Tb(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return RS(e)}function RS(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function lxt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ic(e){return Ic=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ic(e)}function lre(e,t,r){return t=epe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function epe(e){var t=uxt(e,"string");return Tb(t)==="symbol"?t:String(t)}function uxt(e,t){if(Tb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Tb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ure(e,t,r){cxt(e,t),t.set(e,r)}function cxt(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ZR(e,t,r){var n=tpe(e,t,"set");return fxt(e,n,r),r}function fxt(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}function Ii(e,t){var r=tpe(e,t,"get");return hxt(e,r)}function tpe(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function hxt(e,t){return t.get?t.get.call(e):t.value}var cre="nestedHeaders",dxt=280,qi=new WeakMap,qf=new WeakMap,pxt=function(e){oxt(r,e);var t=axt(r);function r(){var n;rxt(this,r);for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n=t.call.apply(t,[this].concat(o)),ure(RS(n),qi,{writable:!0,value:new X1t}),ure(RS(n),qf,{writable:!0,value:null}),lre(RS(n),"ghostTable",new txt(n.hot,function(a,h){return n.getHeaderSettings(a,h)})),lre(RS(n),"detectedOverlappedHeaders",!1),n}return nxt(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[cre]}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){var o=this.hot.getSettings(),s=o.nestedHeaders;(!Array.isArray(s)||!Array.isArray(s[0]))&&ni(Jn(ire||(ire=are([`Your Nested Headers plugin configuration is invalid. The settings has to be 
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`],[`Your Nested Headers plugin configuration is invalid. The settings has to be\\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`])))),this.addHook("init",function(){return i.onInit()}),this.addHook("afterLoadData",function(){return i.onAfterLoadData.apply(i,arguments)}),this.addHook("beforeOnCellMouseDown",function(){return i.onBeforeOnCellMouseDown.apply(i,arguments)}),this.addHook("afterOnCellMouseDown",function(){return i.onAfterOnCellMouseDown.apply(i,arguments)}),this.addHook("beforeOnCellMouseOver",function(){return i.onBeforeOnCellMouseOver.apply(i,arguments)}),this.addHook("afterGetColumnHeaderRenderers",function(a){return i.onAfterGetColumnHeaderRenderers(a)}),this.addHook("modifyColWidth",function(){return i.onModifyColWidth.apply(i,arguments)}),this.addHook("modifyColumnHeaderValue",function(){return i.onModifyColumnHeaderValue.apply(i,arguments)}),this.addHook("beforeHighlightingColumnHeader",function(){return i.onBeforeHighlightingColumnHeader.apply(i,arguments)}),this.addHook("beforeCopy",function(){return i.onBeforeCopy.apply(i,arguments)}),this.addHook("afterViewportColumnCalculatorOverride",function(){return i.onAfterViewportColumnCalculatorOverride.apply(i,arguments)}),Vp(Ic(r.prototype),"enablePlugin",this).call(this),this.updatePlugin()}}},{key:"updatePlugin",value:function(){var i=this;if(this.hot.view){var o=this.hot.getSettings(),s=o.nestedHeaders;Ii(this,qi).setColumnsLimit(this.hot.countCols()),Array.isArray(s)&&(this.detectedOverlappedHeaders=Ii(this,qi).setState(s)),this.detectedOverlappedHeaders&&ni(Jn(ore||(ore=are([`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration 
                        is currently not supported.`],[`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\\x20
                        is currently not supported.`])))),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach(function(a,h){var p=a===!0?"hide-column":"show-column";Ii(i,qi).triggerColumnModification(p,h)}),!Ii(this,qf)&&this.enabled&&ZR(this,qf,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(function(a){a.forEach(function(h){var p=h.op,y=h.index,S=h.newValue;if(p==="replace"){var E=S===!0?"hide-column":"show-column";Ii(i,qi).triggerColumnModification(E,y)}}),i.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),Vp(Ic(r.prototype),"updatePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){this.clearColspans(),Ii(this,qi).clear(),Ii(this,qf).unsubscribe(),ZR(this,qf,null),this.ghostTable.clear(),Vp(Ic(r.prototype),"disablePlugin",this).call(this)}},{key:"getStateManager",value:function(){return Ii(this,qi)}},{key:"getLayersCount",value:function(){return Ii(this,qi).getLayersCount()}},{key:"getHeaderSettings",value:function(i,o){return Ii(this,qi).getHeaderSettings(i,o)}},{key:"clearColspans",value:function(){if(this.hot.view)for(var i=this.hot.view._wt,o=i.getSetting("columnHeaders").length,s=i.wtTable.THEAD,a=i.wtOverlays.topOverlay.clone.wtTable.THEAD,h=i.wtOverlays.topInlineStartCornerOverlay?i.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,p=0;p<o;p++){var y=s.childNodes[p];if(!y)break;for(var S=a.childNodes[p],E=h?h.childNodes[p]:null,O=0,A=y.childNodes.length;O<A;O++)y.childNodes[O].removeAttribute("colspan"),qr(y.childNodes[O],"hiddenHeader"),S&&S.childNodes[O]&&(S.childNodes[O].removeAttribute("colspan"),qr(S.childNodes[O],"hiddenHeader")),h&&E&&E.childNodes[O]&&(E.childNodes[O].removeAttribute("colspan"),qr(E.childNodes[O],"hiddenHeader"))}}},{key:"headerRendererFactory",value:function(i){var o=this,s=this.hot.view._wt.getSetting("fixedColumnsStart");return function(a,h){var p,y=o.hot,S=y.columnIndexMapper,E=y.view,O=S.getVisualFromRenderableIndex(a);O===null&&(O=a),h.removeAttribute("colspan"),qr(h,"hiddenHeader");var A=(p=Ii(o,qi).getHeaderSettings(i,O))!==null&&p!==void 0?p:{label:""},$=A.colspan,B=A.isHidden,j=A.isPlaceholder;if(j||B)Vt(h,"hiddenHeader");else if($>1){var z,W,Q=E._wt.wtOverlays,q=(z=Q.topInlineStartCornerOverlay)===null||z===void 0?void 0:z.clone.wtTable.THEAD.contains(h),Se=(W=Q.inlineStartOverlay)===null||W===void 0?void 0:W.clone.wtTable.THEAD.contains(h),Ie=q||Se?Math.min($,s-a):$;Ie>1&&h.setAttribute("colspan",Ie)}o.hot.view.appendColHeader(O,h,function(){return o.getColumnHeaderValue.apply(o,arguments)},i)}}},{key:"getColumnHeaderValue",value:function(i,o){var s,a=(s=Ii(this,qi).getHeaderSettings(o,i))!==null&&s!==void 0?s:{},h=a.isHidden,p=a.isPlaceholder;return p||h?"":this.hot.getColHeader(i,o)}},{key:"onBeforeHighlightingColumnHeader",value:function(i,o,s){var a=Ii(this,qi).getHeaderTreeNodeData(o,i);if(!a)return i;var h=s.classNames,p=s.columnCursor,y=s.selectionType,S=s.selectionWidth,E=Ii(this,qi).getHeaderSettings(o,i),O=E.isRoot,A=E.colspan;if(y===ME){if(!O)return a.columnIndex}else y===OM&&(A>S-p||!O)&&(h.length=0);return i}},{key:"onBeforeCopy",value:function(i,o,s){var a=s.columnHeadersCount;if(a!==0)for(var h=0;h<o.length;h++){var p=o[h],y=p.startRow,S=p.startCol,E=p.endRow,O=p.endCol,A=E-y+1,$=S-O+1;if(y>=0||$===1)break;for(var B=S;B<=O;B++)for(var j=y;j<=E;j++){var z,W=A+j,Q=B-S;if(Q!==0){var q=(z=Ii(this,qi).getHeaderTreeNodeData(j,B))===null||z===void 0?void 0:z.isRoot;q===!1&&(i[W][Q]="")}}}}},{key:"onBeforeOnCellMouseDown",value:function(i,o,s,a){var h=this._getHeaderTreeNodeDataByCoords(o);h&&(a.column=!0)}},{key:"onAfterOnCellMouseDown",value:function(i,o){var s=this._getHeaderTreeNodeDataByCoords(o);if(s){var a=this.hot.selection,h=a.isSelected()?a.getSelectedRange().current():null,p=[],y=s.columnIndex,S=s.origColspan,E=!a.inInSelection(o);i.shiftKey&&h?o.col<h.from.col?p.push(h.getTopEndCorner().col,y,o.row):o.col>h.from.col?p.push(h.getTopStartCorner().col,y+S-1,o.row):p.push(y,y+S-1,o.row):(mU(i)||cm(i)&&E)&&p.push(y,y+S-1,o.row),a.selectColumns.apply(a,p)}}},{key:"onBeforeOnCellMouseOver",value:function(i,o,s,a){var h;if(this.hot.view.isMouseDown()){var p=this._getHeaderTreeNodeDataByCoords(o);if(p){var y=p.columnIndex,S=p.origColspan,E=this.hot.getSelectedRangeLast(),O=E.getTopStartCorner(),A=E.getBottomEndCorner(),$=E.from;a.column=!0,a.cell=!0;var B=[];o.col<$.col?B.push(A.col,y):o.col>$.col?B.push(O.col,y+S-1):B.push(y,y+S-1),(h=this.hot).selectColumns.apply(h,B)}}}},{key:"onAfterGetColumnHeaderRenderers",value:function(i){i.length=0;for(var o=0;o<Ii(this,qi).getLayersCount();o++)i.push(this.headerRendererFactory(o))}},{key:"onAfterViewportColumnCalculatorOverride",value:function(i){for(var o=Ii(this,qi).getLayersCount(),s=i.startColumn,a=!!o,h=0;h<o;h++){var p=Ii(this,qi).findLeftMostColumnIndex(h,i.startColumn),y=this.hot.columnIndexMapper.getRenderableFromVisualIndex(p);if(p>=0&&(a=!1),Ls(y)&&y<i.startColumn){s=y;break}}i.startColumn=a?Ii(this,qi).getHeaderTreeNodeData(0,s).columnIndex:s}},{key:"onModifyColWidth",value:function(i,o){var s=this.ghostTable.getWidth(o);return i>s?i:s}},{key:"onModifyColumnHeaderValue",value:function(i,o,s){var a,h=(a=Ii(this,qi).getHeaderTreeNodeData(s,o))!==null&&a!==void 0?a:{label:""},p=h.label;return p}},{key:"onInit",value:function(){this.updatePlugin()}},{key:"onAfterLoadData",value:function(i,o){o||this.updatePlugin()}},{key:"destroy",value:function(){ZR(this,qi,null),Ii(this,qf)!==null&&(Ii(this,qf).unsubscribe(),ZR(this,qf,null)),Vp(Ic(r.prototype),"destroy",this).call(this)}},{key:"_getHeaderTreeNodeDataByCoords",value:function(i){if(!(i.row>=0||i.col<0))return Ii(this,qi).getHeaderTreeNodeData(i.row,i.col)}}],[{key:"PLUGIN_KEY",get:function(){return cre}},{key:"PLUGIN_PRIORITY",get:function(){return dxt}}]),r}(Yn);function fre(e){return vxt(e)||yxt(e)||gxt(e)||mxt()}function mxt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function gxt(e,t){if(e){if(typeof e=="string")return pH(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return pH(e,t)}}function yxt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function vxt(e){if(Array.isArray(e))return pH(e)}function pH(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Ob(e){"@babel/helpers - typeof";return Ob=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ob(e)}function _xt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function hre(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,wxt(n.key),n)}}function bxt(e,t,r){return t&&hre(e.prototype,t),r&&hre(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function wxt(e){var t=Sxt(e,"string");return Ob(t)==="symbol"?t:String(t)}function Sxt(e,t){if(Ob(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ob(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var xxt=function(){function e(t,r){_xt(this,e),this.hot=r,this.data=null,this.plugin=t,this.parentReference=new WeakMap,this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}}return bxt(e,[{key:"setData",value:function(r){this.data=r}},{key:"getData",value:function(){return this.data}},{key:"getRawSourceData",value:function(){var r=null;return this.plugin.disableCoreAPIModifiers(),r=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),r}},{key:"updateWithData",value:function(r){this.setData(r),this.rewriteCache()}},{key:"rewriteCache",value:function(){var r=this;this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},Or(0,this.data.length-1,function(n){r.cacheNode(r.data[n],0,null)})}},{key:"cacheNode",value:function(r,n,i){var o=this;this.cache.levels[n]||(this.cache.levels[n]=[],this.cache.levelCount+=1),this.cache.levels[n].push(r),this.cache.rows.push(r),this.cache.nodeInfo.set(r,{parent:i,row:this.cache.rows.length-1,level:n}),this.hasChildren(r)&&Fe(r.__children,function(s){o.cacheNode(s,n+1,r)})}},{key:"getDataObject",value:function(r){return r==null?null:this.cache.rows[r]}},{key:"readTreeNodes",value:function(r,n,i,o){var s=this,a=!1,h=n;if(isNaN(h)&&h.end)return h;var p=r;return p||(p={__children:this.data},a=!0,h-=1),i!=null&&h===i?{result:p,end:!0}:o!=null&&p===o?{result:h,end:!0}:(h+=1,p.__children&&Fe(p.__children,function(y){if(s.parentReference.set(y,a?null:p),h=s.readTreeNodes(y,h,i,o),isNaN(h)&&h.end)return!1}),h)}},{key:"mockParent",value:function(){var r=this.mockNode();return r.__children=this.data,r}},{key:"mockNode",value:function(){var r={};return mn(this.data[0],function(n,i){r[i]=null}),r}},{key:"getRowIndex",value:function(r){return r==null?null:this.cache.nodeInfo.get(r).row}},{key:"getRowIndexWithinParent",value:function(r){var n=null;isNaN(r)?n=r:n=this.getDataObject(r);var i=this.getRowParent(r);return i==null?this.data.indexOf(n):i.__children.indexOf(n)}},{key:"countAllRows",value:function(){var r={__children:this.data};return this.countChildren(r)}},{key:"countChildren",value:function(r){var n=this,i=0,o=r;return isNaN(o)||(o=this.getDataObject(o)),!o||!o.__children?0:(Fe(o.__children,function(s){i+=1,s.__children&&(i+=n.countChildren(s))}),i)}},{key:"getRowParent",value:function(r){var n;return isNaN(r)?n=r:n=this.getDataObject(r),this.getRowObjectParent(n)}},{key:"getRowObjectParent",value:function(r){return!r||Ob(r)!=="object"?null:this.cache.nodeInfo.get(r).parent}},{key:"getRowLevel",value:function(r){var n=null;return isNaN(r)?n=r:n=this.getDataObject(r),n?this.getRowObjectLevel(n):null}},{key:"getRowObjectLevel",value:function(r){return r==null?null:this.cache.nodeInfo.get(r).level}},{key:"hasChildren",value:function(r){var n=r;return isNaN(n)||(n=this.getDataObject(n)),!!(n.__children&&n.__children.length)}},{key:"isChild",value:function(r){return this.getRowParent(r)!==null}},{key:"getChild",value:function(r,n){var i;return((i=r.__children)===null||i===void 0?void 0:i[n])||null}},{key:"isRowHighestLevel",value:function(r){return!this.isChild(r)}},{key:"isParent",value:function(r){var n,i=r;return isNaN(i)||(i=this.getDataObject(i)),i&&!!i.__children&&((n=i.__children)===null||n===void 0?void 0:n.length)!==0}},{key:"addChild",value:function(r,n){var i=n;this.hot.runHooks("beforeAddChild",r,i);var o=null;r&&(o=this.getRowIndex(r)),this.hot.runHooks("beforeCreateRow",o+this.countChildren(r)+1,1);var s=r;r||(s=this.mockParent()),s.__children||(s.__children=[]),i||(i=this.mockNode()),s.__children.push(i),this.rewriteCache();var a=this.getRowIndex(i);this.hot.rowIndexMapper.insertIndexes(a,1),this.hot.runHooks("afterCreateRow",a,1),this.hot.runHooks("afterAddChild",r,i)}},{key:"addChildAtIndex",value:function(r,n,i){var o=i,s;if(o||(o=this.mockNode()),this.hot.runHooks("beforeAddChild",r,o,n),r){var a=this.getRowIndex(r),h=a+n+1;this.hot.runHooks("beforeCreateRow",h,1),r.__children.splice(n,null,o),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(r),"__children",r.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(h,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",h,1),s=h}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",n,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),s=this.getRowIndex(this.data[n]);o=this.getDataObject(s),this.hot.runHooks("afterAddChild",r,o,n)}},{key:"addSibling",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"below",i=this.translateTrimmedRow(r),o=this.getRowParent(i),s=this.getRowIndexWithinParent(i);switch(n){case"below":this.addChildAtIndex(o,s+1,null);break;case"above":this.addChildAtIndex(o,s,null);break}}},{key:"detachFromParent",value:function(r){var n=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,o=null,s=[];Array.isArray(r)?(Or(r[0],r[2],function(j){var z=n.translateTrimmedRow(j);s.push(n.getDataObject(z))}),Or(0,s.length-2,function(j){n.detachFromParent(s[j],!1)}),o=s[s.length-1]):o=r;var a=this.getRowIndex(o),h=this.countChildren(o),p=this.getRowIndexWithinParent(o),y=this.getRowParent(o),S=this.getRowParent(y),E=this.getRowIndex(S),O=null;if(this.hot.runHooks("beforeDetachChild",y,o),p!=null){var A=Array.from(new Array(a+h+1).keys()).splice(-1*(h+1));if(this.hot.runHooks("beforeRemoveRow",a,h+1,A,this.plugin.pluginName),y.__children.splice(p,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",a,h+1,A,this.plugin.pluginName),S){O=E+this.countChildren(S);var $=this.getChild(S,this.countChildren(S)-1),B=this.getRowIndex($);this.hot.runHooks("beforeCreateRow",B+1,h+1,this.plugin.pluginName),S.__children.push(o)}else O=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",O-2,h+1,this.plugin.pluginName),this.data.push(o)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",O-2,h+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",y,o,this.getRowIndex(o)),i&&this.hot.render()}},{key:"filterData",value:function(r,n,i){var o=this,s=[];Fe(i,function(a){s.push(o.getDataObject(a))}),Fe(s,function(a){var h=o.getRowIndexWithinParent(a),p=o.getRowParent(a);p===null?o.data.splice(h,1):p.__children.splice(h,1)}),this.rewriteCache()}},{key:"spliceData",value:function(r,n,i){var o=this.getDataObject(r-1),s=null,a=r;if(o&&o.__children&&o.__children.length===0?(s=o,a=0):r<this.countAllRows()&&(s=this.getRowParent(r),a=this.getRowIndexWithinParent(r)),s)if(i){var h;(h=s.__children).splice.apply(h,[a,n].concat(fre(i)))}else s.__children.splice(a,n);else if(i){var p;(p=this.data).splice.apply(p,[a,n].concat(fre(i)))}else this.data.splice(a,n);this.rewriteCache()}},{key:"syncRowWithRawSource",value:function(r){var n=r,i=null;do i=this.getRowParent(i),i!==null&&(n=i);while(i!==null);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndex(n),"__children",n.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}},{key:"moveRow",value:function(r,n,i,o){var s=n===this.hot.countRows(),a=this.getRowParent(r),h=this.getRowIndexWithinParent(r),p=a.__children.slice(h,h+1),y=r>n,S=s?this.getRowParent(n-1):this.getRowParent(n);S==null&&(S=this.getRowParent(n-1)),S==null&&(S=this.getDataObject(n-1)),S?S.__children||(S.__children=[]):(S=this.getDataObject(n),S.__children=[]);var E=s||i||o?S.__children.length:this.getRowIndexWithinParent(n),O=a===S;S.__children.splice(E,0,p[0]),a.__children.splice(h+(y&&O?1:0),1),this.syncRowWithRawSource(a),O||this.syncRowWithRawSource(S)}},{key:"translateTrimmedRow",value:function(r){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(r):r}},{key:"untranslateTrimmedRow",value:function(r){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(r):r}}]),e}();const Cxt=xxt;function OC(e){"@babel/helpers - typeof";return OC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},OC(e)}function dre(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Txt(n.key),n)}}function Ext(e,t,r){return t&&dre(e.prototype,t),r&&dre(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Txt(e){var t=Oxt(e,"string");return OC(t)==="symbol"?t:String(t)}function Oxt(e,t){if(OC(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(OC(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Rxt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var kxt=Ext(function e(t,r){Rxt(this,e),this.hot=r,this.plugin=t});const BW=kxt;function Rb(e){"@babel/helpers - typeof";return Rb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rb(e)}function Pxt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pre(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ixt(n.key),n)}}function Axt(e,t,r){return t&&pre(e.prototype,t),r&&pre(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ixt(e){var t=Mxt(e,"string");return Rb(t)==="symbol"?t:String(t)}function Mxt(e,t){if(Rb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Rb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function $xt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&mH(e,t)}function mH(e,t){return mH=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},mH(e,t)}function Dxt(e){var t=Bxt();return function(){var n=UA(e),i;if(t){var o=UA(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Lxt(this,i)}}function Lxt(e,t){if(t&&(Rb(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Nxt(e)}function Nxt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Bxt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function UA(e){return UA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},UA(e)}var jxt=function(e){$xt(r,e);var t=Dxt(r);function r(n,i){var o;return Pxt(this,r),o=t.call(this,n,i),o.dataManager=o.plugin.dataManager,o.collapsingUI=o.plugin.collapsingUI,o.rowHeaderWidthCache=null,o}return Axt(r,[{key:"appendLevelIndicators",value:function(i,o){var s=this.hot.toPhysicalRow(i),a=this.dataManager.getRowLevel(s),h=this.dataManager.getDataObject(s),p=o.getElementsByTagName("DIV")[0],y=p.querySelector("span.rowHeader"),S=p.querySelectorAll('[class^="ht_nesting"]');if(Fe(S,function($){$&&p.removeChild($)}),Vt(o,r.CSS_CLASSES.indicatorContainer),a){var E=this.hot.rootDocument,O=y.cloneNode(!0);p.innerHTML="",Or(0,a-1,function(){var $=E.createElement("SPAN");Vt($,r.CSS_CLASSES.emptyIndicator),p.appendChild($)}),p.appendChild(O)}if(this.dataManager.hasChildren(h)){var A=this.hot.rootDocument.createElement("DIV");Vt(o,r.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(s)?Vt(A,"".concat(r.CSS_CLASSES.button," ").concat(r.CSS_CLASSES.expandButton)):Vt(A,"".concat(r.CSS_CLASSES.button," ").concat(r.CSS_CLASSES.collapseButton)),p.appendChild(A)}}},{key:"updateRowHeaderWidth",value:function(i){var o=i;o||(o=this.dataManager.cache.levelCount),this.rowHeaderWidthCache=Math.max(50,11+10*o+25),this.hot.render()}}],[{key:"CSS_CLASSES",get:function(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}}]),r}(BW);const rpe=jxt;function kb(e){"@babel/helpers - typeof";return kb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kb(e)}function mre(e){return Vxt(e)||Hxt(e)||zxt(e)||Fxt()}function Fxt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zxt(e,t){if(e){if(typeof e=="string")return gH(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return gH(e,t)}}function Hxt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Vxt(e){if(Array.isArray(e))return gH(e)}function gH(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Uxt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gre(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Gxt(n.key),n)}}function Wxt(e,t,r){return t&&gre(e.prototype,t),r&&gre(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Gxt(e){var t=Yxt(e,"string");return kb(t)==="symbol"?t:String(t)}function Yxt(e,t){if(kb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(kb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Kxt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&yH(e,t)}function yH(e,t){return yH=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},yH(e,t)}function qxt(e){var t=Jxt();return function(){var n=WA(e),i;if(t){var o=WA(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Xxt(this,i)}}function Xxt(e,t){if(t&&(kb(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Zxt(e)}function Zxt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Jxt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function WA(e){return WA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},WA(e)}var Qxt=function(e){Kxt(r,e);var t=qxt(r);function r(n,i){var o;return Uxt(this,r),o=t.call(this,n,i),o.dataManager=o.plugin.dataManager,o.collapsedRows=[],o.collapsedRowsStash={stash:function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;o.lastCollapsedRows=o.collapsedRows.slice(0),o.expandMultipleChildren(o.lastCollapsedRows,a)},shiftStash:function(a,h){var p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;h==null&&(h=1/0),Fe(o.lastCollapsedRows,function(y,S){y>=a&&y<h&&(o.lastCollapsedRows[S]=y+p)})},applyStash:function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;o.collapseMultipleChildren(o.lastCollapsedRows,a),o.lastCollapsedRows=void 0},trimStash:function(a,h){Or(a,a+h-1,function(p){var y=o.lastCollapsedRows.indexOf(p);y>-1&&o.lastCollapsedRows.splice(y,1)})}},o}return Wxt(r,[{key:"collapseChildren",value:function(i){var o=this,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,h=[],p=null,y=null,S=null;return isNaN(i)?(p=i,y=this.dataManager.getRowIndex(p)):(p=this.dataManager.getDataObject(i),y=i),this.dataManager.hasChildren(p)&&Fe(p.__children,function(E){h.push(o.dataManager.getRowIndex(E))}),S=this.collapseRows(h,!0,!1),a&&this.trimRows(S),s&&this.renderAndAdjust(),this.collapsedRows.indexOf(y)===-1&&this.collapsedRows.push(y),S}},{key:"collapseMultipleChildren",value:function(i){var o=this,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,h=[];Fe(i,function(p){h.push.apply(h,mre(o.collapseChildren(p,!1,!1)))}),a&&this.trimRows(h),s&&this.renderAndAdjust()}},{key:"collapseRow",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.collapseRows([i],o)}},{key:"collapseRows",value:function(i){var o=this,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,h=[];return Fe(i,function(p){h.push(p),s&&o.collapseChildRows(p,h)}),a&&this.trimRows(h),h}},{key:"collapseChildRows",value:function(i){var o=this,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(i)){var h=this.dataManager.getDataObject(i);Fe(h.__children,function(p){var y=o.dataManager.getRowIndex(p);s.push(y),o.collapseChildRows(y,s)})}a&&this.trimRows(s)}},{key:"expandRow",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.expandRows([i],o)}},{key:"expandRows",value:function(i){var o=this,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,h=[];return Fe(i,function(p){h.push(p),s&&o.expandChildRows(p,h)}),a&&this.untrimRows(h),h}},{key:"expandChildRows",value:function(i){var o=this,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(i)){var h=this.dataManager.getDataObject(i);Fe(h.__children,function(p){if(!o.isAnyParentCollapsed(p)){var y=o.dataManager.getRowIndex(p);s.push(y),o.expandChildRows(y,s)}})}a&&this.untrimRows(s)}},{key:"expandChildren",value:function(i){var o=this,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,h=[],p=null,y=null,S=null;return isNaN(i)?(p=i,y=this.dataManager.getRowIndex(i)):(p=this.dataManager.getDataObject(i),y=i),this.collapsedRows.splice(this.collapsedRows.indexOf(y),1),this.dataManager.hasChildren(p)&&Fe(p.__children,function(E){var O=o.dataManager.getRowIndex(E);h.push(O)}),S=this.expandRows(h,!0,!1),a&&this.untrimRows(S),s&&this.renderAndAdjust(),S}},{key:"expandMultipleChildren",value:function(i){var o=this,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,h=[];Fe(i,function(p){h.push.apply(h,mre(o.expandChildren(p,!1,!1)))}),a&&this.untrimRows(h),s&&this.renderAndAdjust()}},{key:"collapseAll",value:function(){var i=this,o=this.dataManager.getData(),s=[];Fe(o,function(a){i.dataManager.hasChildren(a)&&s.push(a)}),this.collapseMultipleChildren(s),this.renderAndAdjust()}},{key:"expandAll",value:function(){var i=this,o=this.dataManager.getData(),s=[];Fe(o,function(a){i.dataManager.hasChildren(a)&&s.push(a)}),this.expandMultipleChildren(s),this.renderAndAdjust()}},{key:"trimRows",value:function(i){var o=this;this.hot.batchExecution(function(){Fe(i,function(s){o.plugin.collapsedRowsMap.setValueAtIndex(s,!0)})},!0)}},{key:"untrimRows",value:function(i){var o=this;this.hot.batchExecution(function(){Fe(i,function(s){o.plugin.collapsedRowsMap.setValueAtIndex(s,!1)})},!0)}},{key:"areChildrenCollapsed",value:function(i){var o=this,s=isNaN(i)?i:this.dataManager.getDataObject(i),a=!0;return s===null&&(s={__children:this.dataManager.data}),this.dataManager.hasChildren(s)&&Fe(s.__children,function(h){var p=o.dataManager.getRowIndex(h);if(!o.plugin.collapsedRowsMap.getValueAtIndex(p))return a=!1,!1}),a}},{key:"isAnyParentCollapsed",value:function(i){for(var o=i;o!==null;){o=this.dataManager.getRowParent(o);var s=this.dataManager.getRowIndex(o);if(this.collapsedRows.indexOf(s)>-1)return!0}return!1}},{key:"toggleState",value:function(i,o){if(!(o.col>=0)){var s=this.translateTrimmedRow(o.row);Wr(i.target,rpe.CSS_CLASSES.button)&&(this.areChildrenCollapsed(s)?this.expandChildren(s):this.collapseChildren(s),Cu(i))}}},{key:"translateTrimmedRow",value:function(i){return this.hot.toPhysicalRow(i)}},{key:"untranslateTrimmedRow",value:function(i){return this.hot.toVisualRow(i)}},{key:"renderAndAdjust",value:function(){this.hot.render(),this.hot.view.adjustElementsSize()}}]),r}(BW);const eCt=Qxt;function Pb(e){"@babel/helpers - typeof";return Pb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pb(e)}function tCt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yre(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,nCt(n.key),n)}}function rCt(e,t,r){return t&&yre(e.prototype,t),r&&yre(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function nCt(e){var t=iCt(e,"string");return Pb(t)==="symbol"?t:String(t)}function iCt(e,t){if(Pb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Pb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function oCt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&vH(e,t)}function vH(e,t){return vH=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},vH(e,t)}function aCt(e){var t=lCt();return function(){var n=GA(e),i;if(t){var o=GA(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return sCt(this,i)}}function sCt(e,t){if(t&&(Pb(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return npe(e)}function npe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function lCt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function GA(e){return GA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},GA(e)}var vre=new WeakMap,uCt=function(e){oCt(r,e);var t=aCt(r);function r(n,i){var o;return tCt(this,r),o=t.call(this,n,i),vre.set(npe(o),{row_above:function(a,h){var p=h[h.length-1];o.dataManager.addSibling(p.start.row,"above")},row_below:function(a,h){var p=h[h.length-1];o.dataManager.addSibling(p.start.row,"below")}}),o.dataManager=o.plugin.dataManager,o}return rCt(r,[{key:"appendOptions",value:function(i){var o=this,s=[{key:"add_child",name:function(){return this.getTranslatedPhrase(F4)},callback:function(){var h=o.dataManager.translateTrimmedRow(o.hot.getSelectedLast()[0]),p=o.dataManager.getDataObject(h);o.dataManager.addChild(p)},disabled:function(){var h=o.hot.getSelectedLast();return!h||h[0]<0||o.hot.selection.isSelectedByColumnHeader()||o.hot.countRows()>=o.hot.getSettings().maxRows}},{key:"detach_from_parent",name:function(){return this.getTranslatedPhrase(z4)},callback:function(){o.dataManager.detachFromParent(o.hot.getSelectedLast())},disabled:function(){var h=o.hot.getSelectedLast(),p=o.dataManager.translateTrimmedRow(h[0]),y=o.dataManager.getRowParent(p);return!y||!h||h[0]<0||o.hot.selection.isSelectedByColumnHeader()||o.hot.countRows()>=o.hot.getSettings().maxRows}},{name:"---------"}];return Or(0,i.items.length-1,function(a){if(a===0)return Fe(s,function(h,p){i.items.splice(a+p,0,h)}),!1}),this.modifyRowInsertingOptions(i)}},{key:"modifyRowInsertingOptions",value:function(i){var o=vre.get(this);return Or(0,i.items.length-1,function(s){var a=o[i.items[s].key];a!=null&&(i.items[s].callback=a)}),i}}]),r}(BW);const cCt=uCt;function RC(e){"@babel/helpers - typeof";return RC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},RC(e)}var _re;function bre(e){return pCt(e)||dCt(e)||hCt(e)||fCt()}function fCt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function hCt(e,t){if(e){if(typeof e=="string")return _H(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _H(e,t)}}function dCt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function pCt(e){if(Array.isArray(e))return _H(e)}function _H(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function mCt(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function gCt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function wre(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,vCt(n.key),n)}}function yCt(e,t,r){return t&&wre(e.prototype,t),r&&wre(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function vCt(e){var t=_Ct(e,"string");return RC(t)==="symbol"?t:String(t)}function _Ct(e,t){if(RC(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(RC(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var bCt=function(){function e(t){gCt(this,e),this.plugin=t,this.hot=t.hot,this.dataManager=t.dataManager,this.collapsingUI=t.collapsingUI}return yCt(e,[{key:"onBeforeRowMove",value:function(r,n,i,o){var s=this,a=this.displayAPICompatibilityWarning({rows:r,finalIndex:n,dropIndex:i,movePossible:o});if(a)return!1;this.movedToCollapsed=!1;var h=i===this.hot.countRows(),p=h?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(i),y=!0,S=r.map(function(B){if(!y)return!1;var j=s.dataManager.translateTrimmedRow(B);return y=s.shouldAllowMoving(j,p),j}),E=S.indexOf(p)===-1;if(!y||!E)return!1;var O=this.getBaseParent(S),A=this.getTargetParent(h,p),$=O===A;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(A),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(S,p,$),this.moveRows(S,p,A),this.dataManager.rewriteCache(),this.moveCellsMeta(S,p),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",r,n,i,o,o&&this.isRowOrderChanged(r,n)),this.hot.render(),this.selectCells(r,i),!1}},{key:"displayAPICompatibilityWarning",value:function(r){var n=r.rows,i=r.finalIndex,o=r.dropIndex,s=r.movePossible,a=!1;return ui(o)&&(ni(Jn(_re||(_re=mCt([`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows 
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`],[`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`])))),this.hot.runHooks("afterRowMove",n,i,o,s,!1),a=!0),a}},{key:"shouldAllowMoving",value:function(r,n){return!(this.dataManager.isParent(r)||this.dataManager.isRowHighestLevel(r)||r===n||n===0)}},{key:"getBaseParent",value:function(r){return this.dataManager.getRowParent(r[0])}},{key:"getTargetParent",value:function(r,n){var i=this.dataManager.getRowParent(r?n-1:n);return i==null&&(i=this.dataManager.getRowParent(n-1)),i}},{key:"shiftCollapsibleParentsLocations",value:function(r,n,i){i||(Math.max.apply(Math,bre(r))<=n?this.collapsingUI.collapsedRowsStash.shiftStash(r[0],n,-1*r.length):this.collapsingUI.collapsedRowsStash.shiftStash(n,r[0],r.length))}},{key:"moveRows",value:function(r,n,i){var o=this,s=n===this.dataManager.getRowIndex(i)+this.dataManager.countChildren(i)+1;this.hot.batchRender(function(){r.forEach(function(a){o.dataManager.moveRow(a,n,o.movedToCollapsed,s)})})}},{key:"moveCellsMeta",value:function(r,n){var i=this,o,s=[],a=Math.max.apply(Math,bre(r))<n;r.forEach(function(h){s.push(i.hot.getCellMetaAtRow(h))}),this.hot.spliceCellsMeta(r[0],r.length),(o=this.hot).spliceCellsMeta.apply(o,[n-(a?s.length:0),0].concat(s))}},{key:"selectCells",value:function(r,n){var i=r.length,o=0,s=0,a=null,h=null;if(this.movedToCollapsed){var p=null;r[i-1]<n?p=this.dataManager.translateTrimmedRow(n-i):p=this.dataManager.translateTrimmedRow(n);var y=this.dataManager.getRowParent(p===null?this.hot.countSourceRows()-1:p-1),S=this.dataManager.getRowIndex(y);o=this.dataManager.untranslateTrimmedRow(S),s=o}else r[i-1]<n?(s=n-1,o=s-i+1):(o=n,s=o+i-1);a=this.hot.selection,h=this.hot.countCols()-1,a.setRangeStart(this.hot._createCellCoords(o,0)),a.setRangeEnd(this.hot._createCellCoords(s,h),!0)}},{key:"isRowOrderChanged",value:function(r,n){return r.some(function(i,o){return i-o!==n})}}]),e}();function Ab(e){"@babel/helpers - typeof";return Ab=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ab(e)}function wCt(e){return ECt(e)||CCt(e)||xCt(e)||SCt()}function SCt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function xCt(e,t){if(e){if(typeof e=="string")return bH(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return bH(e,t)}}function CCt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function ECt(e){if(Array.isArray(e))return bH(e)}function bH(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function TCt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Sre(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,RCt(n.key),n)}}function OCt(e,t,r){return t&&Sre(e.prototype,t),r&&Sre(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function RCt(e){var t=kCt(e,"string");return Ab(t)==="symbol"?t:String(t)}function kCt(e,t){if(Ab(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ab(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Up(){return typeof Reflect<"u"&&Reflect.get?Up=Reflect.get.bind():Up=function(t,r,n){var i=PCt(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Up.apply(this,arguments)}function PCt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Mc(e),e!==null););return e}function ACt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&wH(e,t)}function wH(e,t){return wH=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},wH(e,t)}function ICt(e){var t=$Ct();return function(){var n=Mc(e),i;if(t){var o=Mc(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return MCt(this,i)}}function MCt(e,t){if(t&&(Ab(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ipe(e)}function ipe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function $Ct(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Mc(e){return Mc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Mc(e)}var xN="nestedRows",DCt=300,Qu=new WeakMap,LCt="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.",NCt=function(e){ACt(r,e);var t=ICt(r);function r(n){var i;return TCt(this,r),i=t.call(this,n),i.dataManager=null,i.headersUI=null,i.collapsedRowsMap=null,Qu.set(ipe(i),{movedToCollapsed:!1,skipRender:null,skipCoreAPIModifiers:!1}),i}return OCt(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[xN]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new RE),this.dataManager=new Cxt(this,this.hot),this.collapsingUI=new eCt(this,this.hot),this.headersUI=new rpe(this,this.hot),this.contextMenuUI=new cCt(this,this.hot),this.rowMoveController=new bCt(this),this.addHook("afterInit",function(){return i.onAfterInit.apply(i,arguments)}),this.addHook("beforeViewRender",function(){return i.onBeforeViewRender.apply(i,arguments)}),this.addHook("modifyRowData",function(){return i.onModifyRowData.apply(i,arguments)}),this.addHook("modifySourceLength",function(){return i.onModifySourceLength.apply(i,arguments)}),this.addHook("beforeDataSplice",function(){return i.onBeforeDataSplice.apply(i,arguments)}),this.addHook("filterData",function(){return i.onFilterData.apply(i,arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){return i.onAfterContextMenuDefaultOptions.apply(i,arguments)}),this.addHook("afterGetRowHeader",function(){return i.onAfterGetRowHeader.apply(i,arguments)}),this.addHook("beforeOnCellMouseDown",function(){return i.onBeforeOnCellMouseDown.apply(i,arguments)}),this.addHook("beforeRemoveRow",function(){return i.onBeforeRemoveRow.apply(i,arguments)}),this.addHook("afterRemoveRow",function(){return i.onAfterRemoveRow.apply(i,arguments)}),this.addHook("beforeAddChild",function(){return i.onBeforeAddChild.apply(i,arguments)}),this.addHook("afterAddChild",function(){return i.onAfterAddChild.apply(i,arguments)}),this.addHook("beforeDetachChild",function(){return i.onBeforeDetachChild.apply(i,arguments)}),this.addHook("afterDetachChild",function(){return i.onAfterDetachChild.apply(i,arguments)}),this.addHook("modifyRowHeaderWidth",function(){return i.onModifyRowHeaderWidth.apply(i,arguments)}),this.addHook("afterCreateRow",function(){return i.onAfterCreateRow.apply(i,arguments)}),this.addHook("beforeRowMove",function(){return i.onBeforeRowMove.apply(i,arguments)}),this.addHook("beforeLoadData",function(o){return i.onBeforeLoadData(o)}),this.addHook("beforeUpdateData",function(o){return i.onBeforeLoadData(o)}),Up(Mc(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),Up(Mc(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin();var i=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(i),Up(Mc(r.prototype),"updatePlugin",this).call(this)}},{key:"onBeforeRowMove",value:function(i,o,s,a){return this.rowMoveController.onBeforeRowMove(i,o,s,a)}},{key:"disableCoreAPIModifiers",value:function(){var i=Qu.get(this);i.skipCoreAPIModifiers=!0}},{key:"enableCoreAPIModifiers",value:function(){var i=Qu.get(this);i.skipCoreAPIModifiers=!1}},{key:"onBeforeOnCellMouseDown",value:function(i,o,s){this.collapsingUI.toggleState(i,o,s)}},{key:"onModifyRowData",value:function(i){var o=Qu.get(this);if(!o.skipCoreAPIModifiers)return this.dataManager.getDataObject(i)}},{key:"onModifySourceLength",value:function(){var i=Qu.get(this);if(!i.skipCoreAPIModifiers)return this.dataManager.countAllRows()}},{key:"onBeforeDataSplice",value:function(i,o,s){var a=Qu.get(this);return a.skipCoreAPIModifiers||this.dataManager.isRowHighestLevel(i)?!0:(this.dataManager.spliceData(i,o,s),!1)}},{key:"onFilterData",value:function(i,o,s){var a=Qu.get(this);return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(s[0],o),this.collapsingUI.collapsedRowsStash.shiftStash(s[0],null,-1*o),this.dataManager.filterData(i,o,s),a.skipRender=!0,this.dataManager.getData().slice()}},{key:"onAfterContextMenuDefaultOptions",value:function(i){return this.contextMenuUI.appendOptions(i)}},{key:"onAfterGetRowHeader",value:function(i,o){this.headersUI.appendLevelIndicators(i,o)}},{key:"onModifyRowHeaderWidth",value:function(i){return this.headersUI.rowHeaderWidthCache||i}},{key:"onAfterRemoveRow",value:function(i,o,s,a){var h=this;if(a!==this.pluginName){var p=Qu.get(this);setTimeout(function(){p.skipRender=null,h.headersUI.updateRowHeaderWidth(),h.collapsingUI.collapsedRowsStash.applyStash()},0)}}},{key:"onBeforeRemoveRow",value:function(i,o,s){var a=this,h=Array.from(s.reduce(function(p,y){if(a.dataManager.isParent(y)){var S=a.dataManager.getDataObject(y).__children;return p.add(y),Array.isArray(S)&&S.forEach(function(E){return p.add(a.dataManager.getRowIndex(E))}),p}return p.add(y)},new Set));s.length=0,s.push.apply(s,h)}},{key:"onBeforeAddChild",value:function(){this.collapsingUI.collapsedRowsStash.stash()}},{key:"onAfterAddChild",value:function(i,o){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(o)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}},{key:"onBeforeDetachChild",value:function(){this.collapsingUI.collapsedRowsStash.stash()}},{key:"onAfterDetachChild",value:function(i,o,s){this.collapsingUI.collapsedRowsStash.shiftStash(s,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}},{key:"onAfterCreateRow",value:function(){this.dataManager.rewriteCache()}},{key:"onAfterInit",value:function(){var i=Math.max.apply(Math,wCt(this.dataManager.cache.levels));i>0&&this.headersUI.updateRowHeaderWidth(i)}},{key:"onBeforeViewRender",value:function(i,o){var s=Qu.get(this);s.skipRender&&(o.skipRender=!0)}},{key:"destroy",value:function(){Up(Mc(r.prototype),"destroy",this).call(this)}},{key:"onBeforeLoadData",value:function(i){if(!Iat(i)){wU(LCt),this.hot.getSettings()[xN]=!1,this.disablePlugin();return}this.dataManager.setData(i),this.dataManager.rewriteCache()}}],[{key:"PLUGIN_KEY",get:function(){return xN}},{key:"PLUGIN_PRIORITY",get:function(){return DCt}}]),r}(Yn);function kC(e){"@babel/helpers - typeof";return kC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kC(e)}function BCt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function xre(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,FCt(n.key),n)}}function jCt(e,t,r){return t&&xre(e.prototype,t),r&&xre(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function FCt(e){var t=zCt(e,"string");return kC(t)==="symbol"?t:String(t)}function zCt(e,t){if(kC(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(kC(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var HCt=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;BCt(this,e),this.rootWindow=r,this.prefix=t,this.savedKeys=[],this.loadSavedKeys()}return jCt(e,[{key:"saveValue",value:function(r,n){this.rootWindow.localStorage.setItem("".concat(this.prefix,"_").concat(r),JSON.stringify(n)),this.savedKeys.indexOf(r)===-1&&(this.savedKeys.push(r),this.saveSavedKeys())}},{key:"loadValue",value:function(r,n){var i=typeof r>"u"?n:r,o=this.rootWindow.localStorage.getItem("".concat(this.prefix,"_").concat(i));return o===null?void 0:JSON.parse(o)}},{key:"reset",value:function(r){this.rootWindow.localStorage.removeItem("".concat(this.prefix,"_").concat(r))}},{key:"resetAll",value:function(){var r=this;Fe(this.savedKeys,function(n,i){r.rootWindow.localStorage.removeItem("".concat(r.prefix,"_").concat(r.savedKeys[i]))}),this.clearSavedKeys()}},{key:"loadSavedKeys",value:function(){var r=this.rootWindow.localStorage.getItem("".concat(this.prefix,"__persistentStateKeys")),n=typeof r=="string"?JSON.parse(r):void 0;this.savedKeys=n||[]}},{key:"saveSavedKeys",value:function(){this.rootWindow.localStorage.setItem("".concat(this.prefix,"__persistentStateKeys"),JSON.stringify(this.savedKeys))}},{key:"clearSavedKeys",value:function(){this.savedKeys.length=0,this.saveSavedKeys()}}]),e}();const VCt=HCt;function Ib(e){"@babel/helpers - typeof";return Ib=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ib(e)}function UCt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Cre(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,GCt(n.key),n)}}function WCt(e,t,r){return t&&Cre(e.prototype,t),r&&Cre(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function GCt(e){var t=YCt(e,"string");return Ib(t)==="symbol"?t:String(t)}function YCt(e,t){if(Ib(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ib(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Wp(){return typeof Reflect<"u"&&Reflect.get?Wp=Reflect.get.bind():Wp=function(t,r,n){var i=KCt(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Wp.apply(this,arguments)}function KCt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=$c(e),e!==null););return e}function qCt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&SH(e,t)}function SH(e,t){return SH=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},SH(e,t)}function XCt(e){var t=QCt();return function(){var n=$c(e),i;if(t){var o=$c(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return ZCt(this,i)}}function ZCt(e,t){if(t&&(Ib(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return JCt(e)}function JCt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function QCt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function $c(e){return $c=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},$c(e)}gr.getSingleton().register("persistentStateSave");gr.getSingleton().register("persistentStateLoad");gr.getSingleton().register("persistentStateReset");var Ere="persistentState",eEt=0,tEt=function(e){qCt(r,e);var t=XCt(r);function r(n){var i;return UCt(this,r),i=t.call(this,n),i.storage=void 0,i}return WCt(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Ere]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.storage||(this.storage=new VCt(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",function(o,s){return i.saveValue(o,s)}),this.addHook("persistentStateLoad",function(o,s){return i.loadValue(o,s)}),this.addHook("persistentStateReset",function(){return i.resetValue()}),Wp($c(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.storage=void 0,Wp($c(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Wp($c(r.prototype),"updatePlugin",this).call(this)}},{key:"loadValue",value:function(i,o){o.value=this.storage.loadValue(i)}},{key:"saveValue",value:function(i,o){this.storage.saveValue(i,o)}},{key:"resetValue",value:function(i){typeof i>"u"?this.storage.resetAll():this.storage.reset(i)}},{key:"destroy",value:function(){Wp($c(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Ere}},{key:"PLUGIN_PRIORITY",get:function(){return eEt}}]),r}(Yn);function Mb(e){"@babel/helpers - typeof";return Mb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mb(e)}function rEt(e){return aEt(e)||oEt(e)||iEt(e)||nEt()}function nEt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function iEt(e,t){if(e){if(typeof e=="string")return xH(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return xH(e,t)}}function oEt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function aEt(e){if(Array.isArray(e))return xH(e)}function xH(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function sEt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Tre(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,uEt(n.key),n)}}function lEt(e,t,r){return t&&Tre(e.prototype,t),r&&Tre(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function uEt(e){var t=cEt(e,"string");return Mb(t)==="symbol"?t:String(t)}function cEt(e,t){if(Mb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Mb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Gp(){return typeof Reflect<"u"&&Reflect.get?Gp=Reflect.get.bind():Gp=function(t,r,n){var i=fEt(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Gp.apply(this,arguments)}function fEt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Dc(e),e!==null););return e}function hEt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&CH(e,t)}function CH(e,t){return CH=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},CH(e,t)}function dEt(e){var t=gEt();return function(){var n=Dc(e),i;if(t){var o=Dc(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return pEt(this,i)}}function pEt(e,t){if(t&&(Mb(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return mEt(e)}function mEt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function gEt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Dc(e){return Dc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Dc(e)}var CN="search",yEt=190,vEt="htSearchResult",_Et=function(t,r,n,i,o){t.getCellMeta(r,n).isSearchResult=o},bEt=function(t,r,n){return ui(t)||t===null||!t.toLocaleLowerCase||t.length===0||ui(r)||r===null?!1:r.toString().toLocaleLowerCase(n.locale).indexOf(t.toLocaleLowerCase(n.locale))!==-1},wEt=function(e){hEt(r,e);var t=dEt(r);function r(n){var i;return sEt(this,r),i=t.call(this,n),i.callback=_Et,i.queryMethod=bEt,i.searchResultClass=vEt,i}return lEt(r,[{key:"isEnabled",value:function(){return this.hot.getSettings()[CN]}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){var o=this.hot.getSettings()[CN];this.updatePluginSettings(o),this.addHook("beforeRenderer",function(){return i.onBeforeRenderer.apply(i,arguments)}),Gp(Dc(r.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){var i=this,o=function(){return i.onBeforeRenderer.apply(i,arguments)};this.hot.addHook("beforeRenderer",o),this.hot.addHookOnce("afterViewRender",function(){i.hot.removeHook("beforeRenderer",o)}),Gp(Dc(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Gp(Dc(r.prototype),"updatePlugin",this).call(this)}},{key:"query",value:function(i){var o=this,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getCallback(),a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getQueryMethod(),h=this.hot.countRows(),p=this.hot.countCols(),y=[],S=this.hot;return Or(0,h-1,function(E){Or(0,p-1,function(O){var A=o.hot.getDataAtCell(E,O),$=o.hot.getCellMeta(E,O),B=$.search.callback||s,j=$.search.queryMethod||a,z=j(i,A,$);if(z){var W={row:E,col:O,data:A};y.push(W)}B&&B(S,E,O,A,z)})}),y}},{key:"getCallback",value:function(){return this.callback}},{key:"setCallback",value:function(i){this.callback=i}},{key:"getQueryMethod",value:function(){return this.queryMethod}},{key:"setQueryMethod",value:function(i){this.queryMethod=i}},{key:"getSearchResultClass",value:function(){return this.searchResultClass}},{key:"setSearchResultClass",value:function(i){this.searchResultClass=i}},{key:"updatePluginSettings",value:function(i){pn(i)&&(i.searchResultClass&&this.setSearchResultClass(i.searchResultClass),i.queryMethod&&this.setQueryMethod(i.queryMethod),i.callback&&this.setCallback(i.callback))}},{key:"onBeforeRenderer",value:function(i,o,s,a,h,p){var y=p.className||[],S=[];if(typeof y=="string")S=y.split(" ");else{var E;(E=S).push.apply(E,rEt(y))}this.isEnabled()&&p.isSearchResult?S.includes(this.searchResultClass)||S.push("".concat(this.searchResultClass)):S.includes(this.searchResultClass)&&S.splice(S.indexOf(this.searchResultClass),1),p.className=S.join(" ")}},{key:"destroy",value:function(){Gp(Dc(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return CN}},{key:"PLUGIN_PRIORITY",get:function(){return yEt}}]),r}(Yn);function $b(e){"@babel/helpers - typeof";return $b=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$b(e)}function SEt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ore(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,CEt(n.key),n)}}function xEt(e,t,r){return t&&Ore(e.prototype,t),r&&Ore(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function CEt(e){var t=EEt(e,"string");return $b(t)==="symbol"?t:String(t)}function EEt(e,t){if($b(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if($b(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function yv(){return typeof Reflect<"u"&&Reflect.get?yv=Reflect.get.bind():yv=function(t,r,n){var i=TEt(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},yv.apply(this,arguments)}function TEt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=$h(e),e!==null););return e}function OEt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&EH(e,t)}function EH(e,t){return EH=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},EH(e,t)}function REt(e){var t=AEt();return function(){var n=$h(e),i;if(t){var o=$h(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return kEt(this,i)}}function kEt(e,t){if(t&&($b(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return PEt(e)}function PEt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function AEt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function $h(e){return $h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},$h(e)}var IEt="touchScroll",MEt=200,$Et=function(e){OEt(r,e);var t=REt(r);function r(n){var i;return SEt(this,r),i=t.call(this,n),i.scrollbars=[],i.clones=[],i.lockedCollection=!1,i.freezeOverlays=!1,i}return xEt(r,[{key:"isEnabled",value:function(){return zue()}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.addHook("afterViewRender",function(){return i.onAfterViewRender()}),this.registerEvents(),yv($h(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.lockedCollection=!1,yv($h(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){yv($h(r.prototype),"disablePlugin",this).call(this)}},{key:"registerEvents",value:function(){var i=this;this.addHook("beforeTouchScroll",function(){return i.onBeforeTouchScroll()}),this.addHook("afterMomentumScroll",function(){return i.onAfterMomentumScroll()})}},{key:"onAfterViewRender",value:function(){if(!this.lockedCollection){var i=this.hot.view._wt.wtOverlays,o=i.topOverlay,s=i.bottomOverlay,a=i.inlineStartOverlay,h=i.topInlineStartCornerOverlay,p=i.bottomInlineStartCornerOverlay;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(o),s.clone&&this.scrollbars.push(s),this.scrollbars.push(a),h&&this.scrollbars.push(h),p&&p.clone&&this.scrollbars.push(p),this.clones=[],o.needFullRender&&this.clones.push(o.clone.wtTable.holder.parentNode),s.needFullRender&&this.clones.push(s.clone.wtTable.holder.parentNode),a.needFullRender&&this.clones.push(a.clone.wtTable.holder.parentNode),h&&this.clones.push(h.clone.wtTable.holder.parentNode),p&&p.clone&&this.clones.push(p.clone.wtTable.holder.parentNode)}}},{key:"onBeforeTouchScroll",value:function(){this.freezeOverlays=!0,Fe(this.clones,function(i){Vt(i,"hide-tween")})}},{key:"onAfterMomentumScroll",value:function(){var i=this;this.freezeOverlays=!1,Fe(this.clones,function(o){qr(o,"hide-tween"),Vt(o,"show-tween")}),this.hot._registerTimeout(function(){Fe(i.clones,function(o){qr(o,"show-tween")})},400),Fe(this.scrollbars,function(o){o.refresh(),o.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}}],[{key:"PLUGIN_KEY",get:function(){return IEt}},{key:"PLUGIN_PRIORITY",get:function(){return MEt}},{key:"SETTING_KEYS",get:function(){return!0}}]),r}(Yn);function Db(e){"@babel/helpers - typeof";return Db=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Db(e)}function DEt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Rre(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,NEt(n.key),n)}}function LEt(e,t,r){return t&&Rre(e.prototype,t),r&&Rre(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function NEt(e){var t=BEt(e,"string");return Db(t)==="symbol"?t:String(t)}function BEt(e,t){if(Db(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Db(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Yp(){return typeof Reflect<"u"&&Reflect.get?Yp=Reflect.get.bind():Yp=function(t,r,n){var i=jEt(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Yp.apply(this,arguments)}function jEt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Lc(e),e!==null););return e}function FEt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&TH(e,t)}function TH(e,t){return TH=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},TH(e,t)}function zEt(e){var t=UEt();return function(){var n=Lc(e),i;if(t){var o=Lc(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return HEt(this,i)}}function HEt(e,t){if(t&&(Db(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return VEt(e)}function VEt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function UEt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Lc(e){return Lc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Lc(e)}var JR="trimRows",WEt=330,GEt=function(e){FEt(r,e);var t=zEt(r);function r(n){var i;return DEt(this,r),i=t.call(this,n),i.trimmedRowsMap=null,i}return LEt(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[JR]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new RE),this.trimmedRowsMap.addLocalHook("init",function(){return i.onMapInit()}),Yp(Lc(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){var i=this,o=this.hot.getSettings()[JR];Array.isArray(o)&&this.hot.batchExecution(function(){i.trimmedRowsMap.clear(),Fe(o,function(s){i.trimmedRowsMap.setValueAtIndex(s,!0)})},!0),Yp(Lc(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap("trimRows"),Yp(Lc(r.prototype),"disablePlugin",this).call(this)}},{key:"getTrimmedRows",value:function(){return this.trimmedRowsMap.getTrimmedIndexes()}},{key:"trimRows",value:function(i){var o=this,s=this.getTrimmedRows(),a=this.isValidConfig(i),h=s;a&&(h=Array.from(new Set(s.concat(i))));var p=this.hot.runHooks("beforeTrimRow",s,h,a);p!==!1&&(a&&this.hot.batchExecution(function(){Fe(i,function(y){o.trimmedRowsMap.setValueAtIndex(y,!0)})},!0),this.hot.runHooks("afterTrimRow",s,h,a,a&&h.length>s.length))}},{key:"trimRow",value:function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];this.trimRows(o)}},{key:"untrimRows",value:function(i){var o=this.getTrimmedRows(),s=this.isValidConfig(i),a=o,h=this.trimmedRowsMap.getValues().slice(),p=i.length>0;s&&p&&(Fe(i,function(S){h[S]=!1}),a=oa(h,function(S,E,O){return E&&S.push(O),S},[]));var y=this.hot.runHooks("beforeUntrimRow",o,a,s&&p);y!==!1&&(s&&p&&this.trimmedRowsMap.setValues(h),this.hot.runHooks("afterUntrimRow",o,a,s&&p,s&&a.length<o.length))}},{key:"untrimRow",value:function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];this.untrimRows(o)}},{key:"isTrimmed",value:function(i){return this.trimmedRowsMap.getValueAtIndex(i)||!1}},{key:"untrimAll",value:function(){this.untrimRows(this.getTrimmedRows())}},{key:"isValidConfig",value:function(i){var o=this.hot.countSourceRows();return i.every(function(s){return Number.isInteger(s)&&s>=0&&s<o})}},{key:"onMapInit",value:function(){var i=this,o=this.hot.getSettings()[JR];Array.isArray(o)&&this.hot.batchExecution(function(){Fe(o,function(s){i.trimmedRowsMap.setValueAtIndex(s,!0)})},!0)}},{key:"destroy",value:function(){Yp(Lc(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return JR}},{key:"PLUGIN_PRIORITY",get:function(){return WEt}}]),r}(Yn);function Lb(e){"@babel/helpers - typeof";return Lb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lb(e)}function ope(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kre(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,YEt(n.key),n)}}function ape(e,t,r){return t&&kre(e.prototype,t),r&&kre(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function YEt(e){var t=KEt(e,"string");return Lb(t)==="symbol"?t:String(t)}function KEt(e,t){if(Lb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Lb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function spe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&OH(e,t)}function OH(e,t){return OH=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},OH(e,t)}function lpe(e){var t=ZEt();return function(){var n=YA(e),i;if(t){var o=YA(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return qEt(this,i)}}function qEt(e,t){if(t&&(Lb(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return XEt(e)}function XEt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ZEt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function YA(e){return YA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},YA(e)}function JEt(e){return tTt(e)||eTt(e)||cpe(e)||QEt()}function QEt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function eTt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function tTt(e){if(Array.isArray(e))return RH(e)}function upe(e,t){return iTt(e)||nTt(e,t)||cpe(e,t)||rTt()}function rTt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function cpe(e,t){if(e){if(typeof e=="string")return RH(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return RH(e,t)}}function RH(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function nTt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,s,a=[],h=!0,p=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;h=!1}else for(;!(h=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);h=!0);}catch(y){p=!0,i=y}finally{try{if(!h&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(p)throw i}}return a}}function iTt(e){if(Array.isArray(e))return e}var fpe="undoRedo",oTt="undoRedo";function dr(e){var t=this;this.instance=e,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,this.enabled=!1,e.addHook("afterChange",function(r,n){var i=this,o=r&&r.length;if(o){var s=r.find(function(h){var p=upe(h,4),y=p[2],S=p[3];return y!==S});if(s){var a=function(){var p=r.reduce(function(S,E){return S.push(JEt(E)),S},[]);Fe(p,function(S){S[1]=e.propToCol(S[1])});var y=o>1?i.getSelected():[[p[0][0],p[0][1]]];return new dr.ChangeAction(p,y)};t.done(a,n)}}}),e.addHook("afterCreateRow",function(r,n,i){t.done(function(){return new dr.CreateRowAction(r,n)},i)}),e.addHook("beforeRemoveRow",function(r,n,i,o){var s=function(){var h=e.toPhysicalRow(r),p=ba(t.instance.getSourceData(h,0,h+n-1,t.instance.countSourceCols()-1));return new dr.RemoveRowAction(h,p,e.getSettings().fixedRowsBottom,e.getSettings().fixedRowsTop,e.rowIndexMapper.getIndexesSequence())};t.done(s,o)}),e.addHook("afterCreateCol",function(r,n,i){t.done(function(){return new dr.CreateColumnAction(r,n)},i)}),e.addHook("beforeRemoveCol",function(r,n,i,o){var s=function(){var h=t.instance.getSourceDataArray(),p=(t.instance.countCols()+r)%t.instance.countCols(),y=[],S=[],E=[];Or(h.length-1,function($){var B=[],j=h[$];Or(p,p+(n-1),function(z){B.push(j[e.toPhysicalColumn(z)])}),y.push(B)}),Or(n-1,function($){E.push(e.toPhysicalColumn(p+$))}),Array.isArray(e.getSettings().colHeaders)&&Or(n-1,function($){S.push(e.getSettings().colHeaders[e.toPhysicalColumn(p+$)]||null)});var O=e.columnIndexMapper.getIndexesSequence(),A=e.rowIndexMapper.getIndexesSequence();return new dr.RemoveColumnAction(p,E,y,S,O,A,e.getSettings().fixedColumnsStart)};t.done(s,o)}),e.addHook("beforeCellAlignment",function(r,n,i,o){t.done(function(){return new dr.CellAlignmentAction(r,n,i,o)})}),e.addHook("beforeFilter",function(r){t.done(function(){return new dr.FiltersAction(r)})}),e.addHook("beforeRowMove",function(r,n){r!==!1&&t.done(function(){return new dr.RowMoveAction(r,n)})}),e.addHook("beforeMergeCells",function(r,n){n||t.done(function(){return new dr.MergeCellsAction(e,r)})}),e.addHook("afterUnmergeCells",function(r,n){n||t.done(function(){return new dr.UnmergeCellsAction(e,r)})}),e.addHook("afterInit",function(){t.init()})}dr.prototype.done=function(e,t){if(!this.ignoreNewActions){var r=t==="UndoRedo.undo"||t==="UndoRedo.redo"||t==="auto";if(!r){var n=this.doneActions.slice(),i=this.instance.runHooks("beforeUndoStackChange",n,t);if(i!==!1){var o=e(),s=this.undoneActions.slice();this.doneActions.push(o),this.instance.runHooks("afterUndoStackChange",n,this.doneActions.slice()),this.instance.runHooks("beforeRedoStackChange",s),this.undoneActions.length=0,this.instance.runHooks("afterRedoStackChange",s,this.undoneActions.slice())}}}};dr.prototype.undo=function(){if(this.isUndoAvailable()){var e=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",e);var t=this.doneActions.pop();this.instance.runHooks("afterUndoStackChange",e,this.doneActions.slice());var r=ba(t),n=this.instance.runHooks("beforeUndo",r);if(n===!1)return;this.ignoreNewActions=!0;var i=this,o=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",o),t.undo(this.instance,function(){i.ignoreNewActions=!1,i.undoneActions.push(t)}),this.instance.runHooks("afterRedoStackChange",o,this.undoneActions.slice()),this.instance.runHooks("afterUndo",r)}};dr.prototype.redo=function(){if(this.isRedoAvailable()){var e=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",e);var t=this.undoneActions.pop();this.instance.runHooks("afterRedoStackChange",e,this.undoneActions.slice());var r=ba(t),n=this.instance.runHooks("beforeRedo",r);if(n===!1)return;this.ignoreNewActions=!0;var i=this,o=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",o),t.redo(this.instance,function(){i.ignoreNewActions=!1,i.doneActions.push(t)}),this.instance.runHooks("afterUndoStackChange",o,this.doneActions.slice()),this.instance.runHooks("afterRedo",r)}};dr.prototype.isUndoAvailable=function(){return this.doneActions.length>0};dr.prototype.isRedoAvailable=function(){return this.undoneActions.length>0};dr.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0};dr.prototype.isEnabled=function(){return this.enabled};dr.prototype.enable=function(){if(!this.isEnabled()){var e=this.instance;this.enabled=!0,lTt(e),this.registerShortcuts(),e.addHook("afterChange",hpe)}};dr.prototype.disable=function(){if(this.isEnabled()){var e=this.instance;this.enabled=!1,uTt(e),this.unregisterShortcuts(),e.removeHook("afterChange",hpe)}};dr.prototype.destroy=function(){this.clear(),this.instance=null,this.doneActions=null,this.undoneActions=null};dr.Action=function(){};dr.Action.prototype.undo=function(){};dr.Action.prototype.redo=function(){};dr.ChangeAction=function(e,t){this.changes=e,this.selected=t,this.actionType="change"};Xh(dr.ChangeAction,dr.Action);dr.ChangeAction.prototype.undo=function(e,t){for(var r=ba(this.changes),n=e.countEmptyRows(!0),i=e.countEmptyCols(!0),o=0,s=r.length;o<s;o++)r[o].splice(3,1);e.addHookOnce("afterChange",t),e.setDataAtCell(r,null,null,"UndoRedo.undo");for(var a=0,h=r.length;a<h;a++){var p=upe(r[a],2),y=p[0],S=p[1];e.getSettings().minSpareRows&&y+1+e.getSettings().minSpareRows===e.countRows()&&n===e.getSettings().minSpareRows&&(e.alter("remove_row",parseInt(y+1,10),e.getSettings().minSpareRows),e.undoRedo.doneActions.pop()),e.getSettings().minSpareCols&&S+1+e.getSettings().minSpareCols===e.countCols()&&i===e.getSettings().minSpareCols&&(e.alter("remove_col",parseInt(S+1,10),e.getSettings().minSpareCols),e.undoRedo.doneActions.pop())}e.selectCells(this.selected,!1,!1)};dr.ChangeAction.prototype.redo=function(e,t){for(var r=ba(this.changes),n=0,i=r.length;n<i;n++)r[n].splice(2,1);e.addHookOnce("afterChange",t),e.setDataAtCell(r,null,null,"UndoRedo.redo"),this.selected&&e.selectCells(this.selected,!1,!1)};dr.CreateRowAction=function(e,t){this.index=e,this.amount=t,this.actionType="insert_row"};Xh(dr.CreateRowAction,dr.Action);dr.CreateRowAction.prototype.undo=function(e,t){var r=e.countRows(),n=e.getSettings().minSpareRows;this.index>=r&&this.index-n<r&&(this.index-=n),e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",this.index,this.amount,"UndoRedo.undo")};dr.CreateRowAction.prototype.redo=function(e,t){e.addHookOnce("afterCreateRow",t),e.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")};dr.RemoveRowAction=function(e,t,r,n,i){this.index=e,this.data=t,this.actionType="remove_row",this.fixedRowsBottom=r,this.fixedRowsTop=n,this.rowIndexesSequence=i};Xh(dr.RemoveRowAction,dr.Action);dr.RemoveRowAction.prototype.undo=function(e,t){var r=this,n=e.getSettings(),i=[];n.fixedRowsBottom=this.fixedRowsBottom,n.fixedRowsTop=this.fixedRowsTop,this.data.forEach(function(o,s){Object.keys(o).forEach(function(a){var h=parseInt(a,10);i.push([r.index+s,isNaN(h)?a:h,o[a]])})}),e.alter("insert_row_above",this.index,this.data.length,"UndoRedo.undo"),e.addHookOnce("afterViewRender",t),e.setSourceDataAtCell(i,null,null,"UndoRedo.undo"),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence)};dr.RemoveRowAction.prototype.redo=function(e,t){e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")};dr.CreateColumnAction=function(e,t){this.index=e,this.amount=t,this.actionType="insert_col"};Xh(dr.CreateColumnAction,dr.Action);dr.CreateColumnAction.prototype.undo=function(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount,"UndoRedo.undo")};dr.CreateColumnAction.prototype.redo=function(e,t){e.addHookOnce("afterCreateCol",t),e.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")};dr.RemoveColumnAction=function(e,t,r,n,i,o,s){this.index=e,this.indexes=t,this.data=r,this.amount=this.data[0].length,this.headers=n,this.columnPositions=i.slice(0),this.rowPositions=o.slice(0),this.actionType="remove_col",this.fixedColumnsStart=s};Xh(dr.RemoveColumnAction,dr.Action);dr.RemoveColumnAction.prototype.undo=function(e,t){var r=this,n=e.getSettings();n.fixedColumnsStart=this.fixedColumnsStart;for(var i=this.indexes.slice(0).sort(),o=function(E,O,A){return A[r.indexes.indexOf(i[O])]},s=this.data.length,a=[],h=0;h<s;h++)a.push(dn(this.data[h],o));var p=dn(this.headers,o),y=[];e.alter("insert_col_start",this.indexes[0],this.indexes.length,"UndoRedo.undo"),Fe(e.getSourceDataArray(),function(S,E){Fe(i,function(O,A){S[O]=a[E][A],y.push([E,O,S[O]])})}),e.setSourceDataAtCell(y,void 0,void 0,"UndoRedo.undo"),e.columnIndexMapper.insertIndexes(i[0],i.length),typeof this.headers<"u"&&Fe(p,function(S,E){e.getSettings().colHeaders[i[E]]=S}),e.batchExecution(function(){e.rowIndexMapper.setIndexesSequence(r.rowPositions),e.columnIndexMapper.setIndexesSequence(r.columnPositions)},!0),e.addHookOnce("afterViewRender",t),e.render()};dr.RemoveColumnAction.prototype.redo=function(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount,"UndoRedo.redo")};dr.CellAlignmentAction=function(e,t,r,n){this.stateBefore=e,this.range=t,this.type=r,this.alignment=n};dr.CellAlignmentAction.prototype.undo=function(e,t){var r=this;Fe(this.range,function(n){n.forAll(function(i,o){i>=0&&o>=0&&e.setCellMeta(i,o,"className",r.stateBefore[i][o]||" htLeft")})}),e.addHookOnce("afterViewRender",t),e.render()};dr.CellAlignmentAction.prototype.redo=function(e,t){Zf(this.range,this.type,this.alignment,function(r,n){return e.getCellMeta(r,n)},function(r,n,i,o){return e.setCellMeta(r,n,i,o)}),e.addHookOnce("afterViewRender",t),e.render()};dr.FiltersAction=function(e){this.conditionsStack=e,this.actionType="filter"};Xh(dr.FiltersAction,dr.Action);dr.FiltersAction.prototype.undo=function(e,t){var r=e.getPlugin("filters");e.addHookOnce("afterViewRender",t),r.conditionCollection.importAllConditions(this.conditionsStack.slice(0,this.conditionsStack.length-1)),r.filter()};dr.FiltersAction.prototype.redo=function(e,t){var r=e.getPlugin("filters");e.addHookOnce("afterViewRender",t),r.conditionCollection.importAllConditions(this.conditionsStack),r.filter()};var aTt=function(e){spe(r,e);var t=lpe(r);function r(n,i){var o;ope(this,r),o=t.call(this),o.cellRange=i;var s=o.cellRange.getTopStartCorner(),a=o.cellRange.getBottomEndCorner();return o.rangeData=n.getData(s.row,s.col,a.row,a.col),o}return ape(r,[{key:"undo",value:function(i,o){var s=i.getPlugin("mergeCells");i.addHookOnce("afterViewRender",o),s.unmergeRange(this.cellRange,!0);var a=this.cellRange.getTopStartCorner();i.populateFromArray(a.row,a.col,this.rangeData,void 0,void 0,"MergeCells")}},{key:"redo",value:function(i,o){var s=i.getPlugin("mergeCells");i.addHookOnce("afterViewRender",o),s.mergeRange(this.cellRange)}}]),r}(dr.Action);dr.MergeCellsAction=aTt;var sTt=function(e){spe(r,e);var t=lpe(r);function r(n,i){var o;return ope(this,r),o=t.call(this),o.cellRange=i,o}return ape(r,[{key:"undo",value:function(i,o){var s=i.getPlugin("mergeCells");i.addHookOnce("afterViewRender",o),s.mergeRange(this.cellRange,!0)}},{key:"redo",value:function(i,o){var s=i.getPlugin("mergeCells");i.addHookOnce("afterViewRender",o),s.unmergeRange(this.cellRange,!0),i.render()}}]),r}(dr.Action);dr.UnmergeCellsAction=sTt;dr.RowMoveAction=function(e,t){this.rows=e.slice(),this.finalIndex=t,this.actionType="row_move"};Xh(dr.RowMoveAction,dr.Action);dr.RowMoveAction.prototype.undo=function(e,t){var r=this,n=e.getPlugin("manualRowMove"),i=[].concat(this.rows),o=i.filter(function(y){return y>r.finalIndex}),s=i.filter(function(y){return y<=r.finalIndex}),a=o.sort(function(y,S){return S-y}).concat(s.sort(function(y,S){return y-S}));e.addHookOnce("afterViewRender",t);for(var h=0;h<a.length;h+=1){var p=e.toVisualRow(a[h]);n.moveRow(p,a[h])}e.render(),e.deselectCell(),e.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)};dr.RowMoveAction.prototype.redo=function(e,t){var r=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",t),r.moveRows(this.rows.slice(),this.finalIndex),e.render(),e.deselectCell(),e.selectRows(this.finalIndex,this.finalIndex+this.rows.length-1)};dr.prototype.init=function(){var e=this.instance.getSettings().undo,t=typeof e>"u"||e;this.instance.undoRedo||(this.instance.undoRedo=this),t?this.instance.undoRedo.enable():this.instance.undoRedo.disable()};dr.prototype.registerShortcuts=function(){var e=this,t=this.instance.getShortcutManager(),r=t.getContext("grid"),n=function(s){return!s.altKey},i={runOnlyIf:n,group:fpe};r.addShortcuts([{keys:[["Control/Meta","z"]],callback:function(){e.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:function(){e.redo()}}],i)};dr.prototype.unregisterShortcuts=function(){var e=this.instance.getShortcutManager(),t=e.getContext("grid");t.removeShortcutsByGroup(fpe)};function hpe(e,t){var r=this;if(t==="loadData")return r.undoRedo.clear()}function lTt(e){e.undo=function(){return e.undoRedo.undo()},e.redo=function(){return e.undoRedo.redo()},e.isUndoAvailable=function(){return e.undoRedo.isUndoAvailable()},e.isRedoAvailable=function(){return e.undoRedo.isRedoAvailable()},e.clearUndo=function(){return e.undoRedo.clear()}}function uTt(e){delete e.undo,delete e.redo,delete e.isUndoAvailable,delete e.isRedoAvailable,delete e.clearUndo}var DE=gr.getSingleton();DE.add("afterUpdateSettings",function(){var e;(e=this.getPlugin("undoRedo"))===null||e===void 0||e.init()});DE.register("beforeUndo");DE.register("afterUndo");DE.register("beforeRedo");DE.register("afterRedo");dr.PLUGIN_KEY=oTt;dr.SETTING_KEYS=!0;function cTt(){Dn(FQe),Dn(het),Dn(Aet),Dn(Ctt),Dn(Vtt),Dn(Hfe),Dn(Ant),Dn(hit),Dn(jhe),Dn(Rft),Dn(tht),Dn(hht),Dn(Zhe),Dn(gdt),Dn(hvt),Dn(Wvt),Dn(g_t),Dn(z_t),Dn(cbt),Dn(Jbt),Dn(uwt),Dn(Zwt),Dn(l0t),Dn(aSt),Dn(OSt),Dn(FSt),Dn(pxt),Dn(NCt),Dn(tEt),Dn(wEt),Dn($Et),Dn(GEt),Dn(dr)}function fTt(){EGe(),HGe(),s6e(),R6e(),cTt()}uu(Sce);xn.editors={BaseEditor:ow};function xn(e,t){var r=new OW(e,t||{},xW);return r.init(),r}xn.Core=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new OW(e,t,xW)};xn.DefaultSettings=Rhe();xn.hooks=gr.getSingleton();xn.CellCoords=eA;xn.CellRange=BU;xn.packageName="handsontable";xn.buildDate="28/03/2023 12:24:11";xn.version="12.3.3";xn.languages={dictionaryKeys:rit,getLanguageDictionary:vhe,getLanguagesDictionaries:Qat,registerLanguageDictionary:yhe,getTranslatedPhrase:_he};function Pre(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function hTt(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Pre(Object(r),!0).forEach(function(n){dTt(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Pre(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function PC(e){"@babel/helpers - typeof";return PC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},PC(e)}function Nb(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Are(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ppe(n.key),n)}}function Bb(e,t,r){return t&&Are(e.prototype,t),r&&Are(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function dTt(e,t,r){return t=ppe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function AC(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&kH(e,t)}function KA(e){return KA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},KA(e)}function kH(e,t){return kH=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},kH(e,t)}function pTt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function dpe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function mTt(e,t){if(t&&(typeof t=="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return dpe(e)}function IC(e){var t=pTt();return function(){var n=KA(e),i;if(t){var o=KA(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return mTt(this,i)}}function gTt(e){return yTt(e)||vTt(e)||_Tt(e)||bTt()}function yTt(e){if(Array.isArray(e))return PH(e)}function vTt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function _Tt(e,t){if(e){if(typeof e=="string")return PH(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return PH(e,t)}}function PH(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function bTt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function wTt(e,t){if(typeof e!="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ppe(e){var t=wTt(e,"string");return typeof t=="symbol"?t:String(t)}var EN=null,STt="Your `HotTable` configuration includes `autoRowSize`/`autoColumnSize` options, which are not compatible with  the component-based renderers`. Disable `autoRowSize` and `autoColumnSize` to prevent row and column misalignment.",xTt="The Handsontable instance bound to this component was destroyed and cannot be used properly.",qA="global",CTt="hot-wrapper-editor-container";function ETt(){if(typeof console<"u"){var e;(e=console).warn.apply(e,arguments)}}function AH(e,t){var r=io.Children.toArray(e),n=io.Children.count(e),i=null;return n!==0&&(n===1&&r[0].props[t]?i=r[0]:i=r.find(function(o){return o.props[t]!==void 0})),i||null}function mpe(e){return e?e.type.WrappedComponent?e.type.WrappedComponent:e.type:null}function gpe(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document,t=arguments.length>1?arguments[1]:void 0;if(t===null)return null;var r=vpe(t.props,!1);return r.className="".concat(CTt," ").concat(r.className),Kie.createPortal(io.createElement("div",Object.assign({},r),t),e.body)}function ype(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:qA,n=AH(e,"hot-editor"),i=mpe(n);return n?io.cloneElement(n,{emitEditorInstance:function(s,a){t.get(i)||t.set(i,new Map);var h=t.get(i);h.set(a??qA,s)},editorColumnScope:r,isEditor:!0}):null}function TTt(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:document;r||(r=document),EN||(EN=r.createDocumentFragment());var n=r.createElement("DIV");EN.appendChild(n);var i=io.cloneElement(e,hTt({key:"".concat(t.row,"-").concat(t.col)},t));return{portal:Kie.createPortal(i,n,"".concat(t.row,"-").concat(t.col,"-").concat(Math.random())),portalContainer:n}}function vpe(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return{id:e.id||(t?"hot-"+Math.random().toString(36).substring(5):void 0),className:e.className||"",style:e.style||{}}}var _pe=function(){function e(){Nb(this,e)}return Bb(e,null,[{key:"getSettings",value:function(r){var n={};if(r.settings){var i=r.settings;for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])}for(var s in r)s!=="settings"&&s!=="children"&&r.hasOwnProperty(s)&&(n[s]=r[s]);return n}}]),e}(),OTt=function(e){AC(r,e);var t=IC(r);function r(){return Nb(this,r),t.apply(this,arguments)}return Bb(r,[{key:"getSettingsProps",value:function(){var i=this;return this.internalProps=["_componentRendererColumns","_emitColumnSettings","_columnIndex","_getChildElementByType","_getRendererWrapper","_getEditorClass","_getEditorCache","_getOwnerDocument","hot-renderer","hot-editor","children"],Object.keys(this.props).filter(function(o){return!i.internalProps.includes(o)}).reduce(function(o,s){return o[s]=i.props[s],o},{})}},{key:"getLocalEditorElement",value:function(){return ype(this.props.children,this.props._getEditorCache(),this.props._columnIndex)}},{key:"createColumnSettings",value:function(){var i=this.props._getChildElementByType(this.props.children,"hot-renderer"),o=this.getLocalEditorElement();this.columnSettings=_pe.getSettings(this.getSettingsProps()),i!==null&&(this.columnSettings.renderer=this.props._getRendererWrapper(i),this.props._componentRendererColumns.set(this.props._columnIndex,!0)),o!==null&&(this.columnSettings.editor=this.props._getEditorClass(o,this.props._columnIndex))}},{key:"emitColumnSettings",value:function(){this.props._emitColumnSettings(this.columnSettings,this.props._columnIndex)}},{key:"componentDidMount",value:function(){this.createColumnSettings(),this.emitColumnSettings()}},{key:"componentDidUpdate",value:function(){this.createColumnSettings(),this.emitColumnSettings()}},{key:"render",value:function(){var i=this.props._getOwnerDocument(),o=gpe(i,this.getLocalEditorElement());return io.createElement(io.Fragment,null,o)}}]),r}(io.Component),RTt=function(e){AC(r,e);var t=IC(r);function r(){var n;return Nb(this,r),n=t.apply(this,arguments),n.state={portals:[]},n}return Bb(r,[{key:"render",value:function(){return io.createElement(io.Fragment,null,this.state.portals)}}]),r}(io.Component),kTt="12.3.3";function jW(e,t){return t={exports:{}},e(t,t.exports),t.exports}/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $o=typeof Symbol=="function"&&Symbol.for,FW=$o?Symbol.for("react.element"):60103,zW=$o?Symbol.for("react.portal"):60106,MM=$o?Symbol.for("react.fragment"):60107,$M=$o?Symbol.for("react.strict_mode"):60108,DM=$o?Symbol.for("react.profiler"):60114,LM=$o?Symbol.for("react.provider"):60109,NM=$o?Symbol.for("react.context"):60110,HW=$o?Symbol.for("react.async_mode"):60111,BM=$o?Symbol.for("react.concurrent_mode"):60111,jM=$o?Symbol.for("react.forward_ref"):60112,FM=$o?Symbol.for("react.suspense"):60113,PTt=$o?Symbol.for("react.suspense_list"):60120,zM=$o?Symbol.for("react.memo"):60115,HM=$o?Symbol.for("react.lazy"):60116,ATt=$o?Symbol.for("react.block"):60121,ITt=$o?Symbol.for("react.fundamental"):60117,MTt=$o?Symbol.for("react.responder"):60118,$Tt=$o?Symbol.for("react.scope"):60119;function _s(e){if(PC(e)==="object"&&e!==null){var t=e.$$typeof;switch(t){case FW:switch(e=e.type,e){case HW:case BM:case MM:case DM:case $M:case FM:return e;default:switch(e=e&&e.$$typeof,e){case NM:case jM:case HM:case zM:case LM:return e;default:return t}}case zW:return t}}}function bpe(e){return _s(e)===BM}var DTt=HW,LTt=BM,NTt=NM,BTt=LM,jTt=FW,FTt=jM,zTt=MM,HTt=HM,VTt=zM,UTt=zW,WTt=DM,GTt=$M,YTt=FM,KTt=function(t){return bpe(t)||_s(t)===HW},qTt=bpe,XTt=function(t){return _s(t)===NM},ZTt=function(t){return _s(t)===LM},JTt=function(t){return PC(t)==="object"&&t!==null&&t.$$typeof===FW},QTt=function(t){return _s(t)===jM},eOt=function(t){return _s(t)===MM},tOt=function(t){return _s(t)===HM},rOt=function(t){return _s(t)===zM},nOt=function(t){return _s(t)===zW},iOt=function(t){return _s(t)===DM},oOt=function(t){return _s(t)===$M},aOt=function(t){return _s(t)===FM},sOt=function(t){return typeof t=="string"||typeof t=="function"||t===MM||t===BM||t===DM||t===$M||t===FM||t===PTt||PC(t)==="object"&&t!==null&&(t.$$typeof===HM||t.$$typeof===zM||t.$$typeof===LM||t.$$typeof===NM||t.$$typeof===jM||t.$$typeof===ITt||t.$$typeof===MTt||t.$$typeof===$Tt||t.$$typeof===ATt)},lOt=_s,uOt={AsyncMode:DTt,ConcurrentMode:LTt,ContextConsumer:NTt,ContextProvider:BTt,Element:jTt,ForwardRef:FTt,Fragment:zTt,Lazy:HTt,Memo:VTt,Portal:UTt,Profiler:WTt,StrictMode:GTt,Suspense:YTt,isAsyncMode:KTt,isConcurrentMode:qTt,isContextConsumer:XTt,isContextProvider:ZTt,isElement:JTt,isForwardRef:QTt,isFragment:eOt,isLazy:tOt,isMemo:rOt,isPortal:nOt,isProfiler:iOt,isStrictMode:oOt,isSuspense:aOt,isValidElementType:sOt,typeOf:lOt},si=jW(function(e,t){});si.AsyncMode;si.ConcurrentMode;si.ContextConsumer;si.ContextProvider;si.Element;si.ForwardRef;si.Fragment;si.Lazy;si.Memo;si.Portal;si.Profiler;si.StrictMode;si.Suspense;si.isAsyncMode;si.isConcurrentMode;si.isContextConsumer;si.isContextProvider;si.isElement;si.isForwardRef;si.isFragment;si.isLazy;si.isMemo;si.isPortal;si.isProfiler;si.isStrictMode;si.isSuspense;si.isValidElementType;si.typeOf;jW(function(e){e.exports=uOt});/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var Ire=Object.getOwnPropertySymbols,cOt=Object.prototype.hasOwnProperty,fOt=Object.prototype.propertyIsEnumerable;function hOt(e){if(e==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}function dOt(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de",Object.getOwnPropertyNames(e)[0]==="5")return!1;for(var t={},r=0;r<10;r++)t["_"+String.fromCharCode(r)]=r;var n=Object.getOwnPropertyNames(t).map(function(o){return t[o]});if(n.join("")!=="0123456789")return!1;var i={};return"abcdefghijklmnopqrst".split("").forEach(function(o){i[o]=o}),Object.keys(Object.assign({},i)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}dOt();var pOt="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",mOt=pOt;Function.call.bind(Object.prototype.hasOwnProperty);function wpe(){}function Spe(){}Spe.resetWarningCache=wpe;var gOt=function(){function t(i,o,s,a,h,p){if(p!==mOt){var y=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw y.name="Invariant Violation",y}}t.isRequired=t;function r(){return t}var n={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:r,element:t,elementType:t,instanceOf:r,node:t,objectOf:r,oneOf:r,oneOfType:r,shape:r,exact:r,checkPropTypes:Spe,resetWarningCache:wpe};return n.PropTypes=n,n},yOt=jW(function(e){e.exports=gOt()}),TN=yOt,xpe=function(e){AC(r,e);var t=IC(r);function r(){var n;return Nb(this,r),n=t.apply(this,arguments),n.id=null,n.__hotInstance=null,n.hotElementRef=null,n.columnSettings=[],n.renderersPortalManager=null,n.portalCacheArray=[],n.renderedCellCache=new Map,n.editorCache=new Map,n.componentRendererColumns=new Map,n}return Bb(r,[{key:"hotInstance",get:function(){return!this.__hotInstance||this.__hotInstance&&!this.__hotInstance.isDestroyed?this.__hotInstance:(console.warn(xTt),null)},set:function(i){this.__hotInstance=i}},{key:"getRenderedCellCache",value:function(){return this.renderedCellCache}},{key:"getEditorCache",value:function(){return this.editorCache}},{key:"clearCache",value:function(){this.getRenderedCellCache().clear(),this.componentRendererColumns.clear()}},{key:"getOwnerDocument",value:function(){return this.hotElementRef?this.hotElementRef.ownerDocument:document}},{key:"setHotElementRef",value:function(i){this.hotElementRef=i}},{key:"getRendererWrapper",value:function(i){var o=this;return function(s,a,h,p,y,S,E){var O=o.getRenderedCellCache();if(O.has("".concat(h,"-").concat(p))&&(a.innerHTML=O.get("".concat(h,"-").concat(p)).innerHTML),a&&!a.getAttribute("ghost-table")){for(var A=TTt(i,{TD:a,row:h,col:p,prop:y,value:S,cellProperties:E,isRenderer:!0},a.ownerDocument),$=A.portal,B=A.portalContainer;a.firstChild;)a.removeChild(a.firstChild);a.appendChild(B),o.portalCacheArray.push($)}return O.set("".concat(h,"-").concat(p),a),a}}},{key:"getEditorClass",value:function(i){var o,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:qA,a=mpe(i),h=(o=this.getEditorCache().get(a))===null||o===void 0?void 0:o.get(s);return this.makeEditorClass(h)}},{key:"makeEditorClass",value:function(i){var o=function(s){AC(h,s);var a=IC(h);function h(p){var y;return Nb(this,h),y=a.call(this,p),i.hotCustomEditorInstance=dpe(y),y.editorComponent=i,y}return Bb(h,[{key:"focus",value:function(){}},{key:"getValue",value:function(){}},{key:"setValue",value:function(){}},{key:"open",value:function(){}},{key:"close",value:function(){}}]),h}(xn.editors.BaseEditor);return Object.getOwnPropertyNames(xn.editors.BaseEditor.prototype).forEach(function(s){s!=="constructor"&&(o.prototype[s]=function(){for(var a,h=arguments.length,p=new Array(h),y=0;y<h;y++)p[y]=arguments[y];return(a=i[s]).call.apply(a,[i].concat(p))})}),o}},{key:"getGlobalRendererElement",value:function(){return AH(this.props.children,"hot-renderer")}},{key:"getGlobalEditorElement",value:function(){return ype(this.props.children,this.getEditorCache())}},{key:"createNewGlobalSettings",value:function(){var i=_pe.getSettings(this.props),o=this.getGlobalRendererElement(),s=this.getGlobalEditorElement();return i.columns=this.columnSettings.length?this.columnSettings:i.columns,s?i.editor=this.getEditorClass(s,qA):i.editor=this.props.editor||(this.props.settings?this.props.settings.editor:void 0),o?(i.renderer=this.getRendererWrapper(o),this.componentRendererColumns.set("global",!0)):i.renderer=this.props.renderer||(this.props.settings?this.props.settings.renderer:void 0),i}},{key:"displayAutoSizeWarning",value:function(i){var o,s;this.hotInstance&&((o=this.hotInstance.getPlugin("autoRowSize"))!==null&&o!==void 0&&o.enabled||(s=this.hotInstance.getPlugin("autoColumnSize"))!==null&&s!==void 0&&s.enabled)&&this.componentRendererColumns.size>0&&ETt(STt)}},{key:"setHotColumnSettings",value:function(i,o){this.columnSettings[o]=i}},{key:"handsontableBeforeViewRender",value:function(){this.getRenderedCellCache().clear()}},{key:"handsontableAfterViewRender",value:function(){var i=this;this.renderersPortalManager.setState({portals:gTt(this.portalCacheArray)},function(){i.portalCacheArray=[]})}},{key:"updateHot",value:function(i){this.hotInstance&&this.hotInstance.updateSettings(i,!1)}},{key:"setRenderersPortalManagerRef",value:function(i){this.renderersPortalManager=i}},{key:"componentDidMount",value:function(){var i=this,o=this.createNewGlobalSettings();this.hotInstance=new xn.Core(this.hotElementRef,o),this.hotInstance.addHook("beforeViewRender",function(){return i.handsontableBeforeViewRender()}),this.hotInstance.addHook("afterViewRender",function(){return i.handsontableAfterViewRender()}),this.hotInstance.init(),this.displayAutoSizeWarning(o)}},{key:"componentDidUpdate",value:function(){this.clearCache();var i=this.createNewGlobalSettings();this.updateHot(i),this.displayAutoSizeWarning(i)}},{key:"componentWillUnmount",value:function(){this.clearCache(),this.hotInstance&&this.hotInstance.destroy()}},{key:"render",value:function(){var i=this,o=vpe(this.props),s=function(S){return S.type===OTt},a=io.Children.toArray(this.props.children),h=a.filter(function(y){return s(y)}).map(function(y,S){return io.cloneElement(y,{_componentRendererColumns:i.componentRendererColumns,_emitColumnSettings:i.setHotColumnSettings.bind(i),_columnIndex:S,_getChildElementByType:AH.bind(i),_getRendererWrapper:i.getRendererWrapper.bind(i),_getEditorClass:i.getEditorClass.bind(i),_getOwnerDocument:i.getOwnerDocument.bind(i),_getEditorCache:i.getEditorCache.bind(i),children:y.props.children})}),p=gpe(this.getOwnerDocument(),this.getGlobalEditorElement());return io.createElement(io.Fragment,null,io.createElement("div",Object.assign({ref:this.setHotElementRef.bind(this)},o),h),io.createElement(RTt,{ref:this.setRenderersPortalManagerRef.bind(this)}),p)}}],[{key:"version",get:function(){return kTt}}]),r}(io.Component);xpe.propTypes={style:TN.object,id:TN.string,className:TN.string};io.Component;fTt();function vOt({fileName:e,deleteFile:t,dataState:r,setdataState:n,size:i,setSize:o,saveCheck:s,setsaveCheck:a,checkifDeleted:h,userName:p,supabase:y}){const S=_t.useRef(e===""?null:e),[E,O]=_t.useState(0),A=()=>{const j=localStorage.getItem(p+"/"+e),z=localStorage.getItem(p+"/"+e+"/lastrow"),W=localStorage.getItem(p+"/"+e+"/savestate");j!=null&&z!=null&&W!=null&&(n(JSON.parse(j).grid),o(z),a(W))},$=()=>{console.log("removed const "+e+" data"),t(),B(),n([]),localStorage.removeItem(p+"/"+e),localStorage.removeItem(p+"/"+e+"/lastrow"),localStorage.removeItem(p+"/"+e+"/savestate")},B=async()=>{const j=p+"/"+e,{error:z}=await y.storage.from("User-Files").remove(j);z&&console.log(z)};return _t.useEffect(()=>{i!=0&&localStorage.setItem(p+"/"+e+"/lastrow",i)},[i]),_t.useEffect(()=>{localStorage.setItem(p+"/"+e+"/savestate",s)},[s]),_t.useEffect(()=>{e!=""&&(o(0),n([]),A())},[e]),_t.useEffect(()=>{h!=!1&&$()},[h]),Pe.jsxs(Pe.Fragment,{children:[Pe.jsxs("div",{className:"hottable-divq",children:[e&&Pe.jsx(xpe,{id:p+"/"+e,ref:S,data:r,persistentState:!0,dataSchema:{Name:null,PickupAddress:null,DropoffAddress:null,Type:null,Time:null},rowHeaders:!0,colHeaders:["Full Name","Pickup Address","Dropoff Address","Trip Type: WC/ST/BCWCH","HH:MM AM/PM"],columns:[{data:"Name"},{data:"PickupAddress"},{data:"DropoffAddress"},{data:"Type"},{data:"Time"}],afterOnCellMouseDown:function(j,z){O(z.row)},height:"100vh",width:"78%",stretchH:"all",minSpareRows:50,beforeRefreshDimensions:()=>!1,licenseKey:"non-commercial-and-evaluation",afterChange:function(j,z){z!="edit"&&z!="CopyPaste.paste"||(+j[j.length-1][0]+1>i&&o(+j[j.length-1][0]+1),localStorage.setItem(p+"/"+e,JSON.stringify({grid:r})),a("Unsaved"))}}),";"]}),";"]})}function Mre({userFiles:e,changePage:t,selectFile:r,fileName:n,setdataState:i}){const[o,s]=_t.useState(0),a=p=>{t(p)},h=p=>{r(p)};return Pe.jsx(Pe.Fragment,{children:Pe.jsxs("div",{className:"input-div",children:[Pe.jsx("button",{className:"button-colors input-button-import one-two",onMouseDown:()=>{a("schedule"),r(""),i([])},children:"New Schedule"}),Pe.jsxs("div",{className:"schedule-select-div",children:[Pe.jsxs("div",{className:"sched-index",children:["Schedules (",e.length,")"]}),e.length===0&&Pe.jsx("div",{}),Pe.jsx("ul",{children:e.map((p,y)=>Pe.jsxs("li",{id:p,className:n!=""&&(n==p||o==y)?"list-css list-css-active":"list-css",onMouseEnter:()=>s(y),onMouseLeave:()=>s(-1),onMouseDown:()=>{h(p),a("grid")},children:[Pe.jsx("div",{style:{display:"inline-block"},children:Pe.jsx("span",{className:"glyphicon glyphicon-th sched-glyph"})}),Pe.jsx("div",{className:"files-div",children:p.replace(/\*/g,"/")})]},y))})]})]})})}function _Ot({changePage:e,setFileName2:t}){const[r,n]=_t.useState(""),i=(o,s)=>{let a=s.replace(/\s/g,"");t(a),e(o)};return Pe.jsx(Pe.Fragment,{children:Pe.jsx("div",{className:"init-sched-div",children:Pe.jsxs("form",{onSubmit:()=>{i("grid",r===""?"":r)},children:[Pe.jsx("input",{type:"text",className:"schedule-input-series",placeholder:"Schedule Name",onChange:o=>n(o.target.value),value:r}),Pe.jsx("button",{className:"button-colors input-button-import submit-button",type:"submit",children:"Create Schedule"})]})})})}function bOt({fileName:e,dataState:t,size:r,setsaveCheck:n,setcheckifDeleted:i,saveCheck:o,userName:s,supabase:a}){const h=async()=>{const y=JSON.parse(JSON.stringify(t));let S=JSON.stringify(y.splice(0,r)),E=new Blob([[S]],{type:"application/json"});const{error:O}=await a.storage.from("User-Files").update(s+"/"+e,E);O?console.log(O):n("Saved")},p=()=>{e!=""&&i(!0)};return Pe.jsxs(Pe.Fragment,{children:[Pe.jsx("div",{className:"page-title-div",children:Pe.jsx("p",{className:"page-title",children:"Schedule"})}),Pe.jsxs("div",{className:"change-map-div",children:[Pe.jsx("button",{className:e==""?"hidden":"button-colors select-map-button",onClick:()=>h(),children:" Save File"}),Pe.jsx("button",{className:e==""?"hidden":"button-colors select-map-button",onClick:()=>{p()},children:"Delete File"}),Pe.jsx("p",{style:{display:"inline-block",paddingLeft:"20px"},className:e==""?"hidden":o=="Saved"?"saved":"unsaved",children:o})]})]})}function wOt({dkey:e,name:t,address:r,type:n,status1:i,deleteDriver:o}){const[s,a]=_t.useState(i);return Pe.jsx(Pe.Fragment,{children:Pe.jsxs("div",{id:e,className:"driver-div",children:[Pe.jsxs("div",{className:"name",children:[Pe.jsx("p",{className:"make-grey",children:"Name:"})," ",t]}),Pe.jsxs("div",{className:"address",children:[Pe.jsx("p",{className:"make-grey",children:"Starting Address: "})," ",r]}),Pe.jsxs("div",{className:"vType",children:[Pe.jsx("p",{className:"make-grey",children:"Vehicle Type: "})," ",n," "]}),Pe.jsx("button",{className:"button1",children:"Edit"}),Pe.jsx("button",{onClick:()=>o(t),className:"button-colors button2",children:"Delete"}),Pe.jsxs("div",{className:"status-title",children:[Pe.jsx("p",{className:"make-grey",children:"Status: "})," ",s==!0?"Active":"Inactive",Pe.jsx("i",{style:{fontSize:"9px"},className:s==!0?"fi fi-ss-circle status":"fi fi-ss-circle status-red"})]})]})})}function SOt({supabase:e,userName:t,driverload:r,handleDriver:n,setDriverHave:i}){const[o,s]=_t.useState(""),[a,h]=_t.useState(""),[p,y]=_t.useState(""),S=async()=>{const{data:E,error:O}=await e.from("user_drivers").insert([{user_id:t,Name:o,Address:a,vType:p,Status:!0,Color:"#735EFF"}]);O?console.log(O):(r.push({Name:o,Address:a,Type:p,Status:!0,Color:"#735EFF"}),i(A=>[A]),s(""),h(""),y(""))};return Pe.jsx(Pe.Fragment,{children:Pe.jsxs("div",{className:"driver-input-div",children:[Pe.jsx("input",{className:"schedule-input-series2 iname",placeholder:"Name",onChange:E=>s(E.target.value),value:o}),Pe.jsx("input",{className:"schedule-input-series2 iaddress",placeholder:"Address",onChange:E=>h(E.target.value),value:a}),Pe.jsxs("select",{className:"schedule-input-series2 itype",onChange:E=>y(E.target.value),value:p,children:[Pe.jsx("option",{value:"",children:"Select Vehicle Type"}),Pe.jsx("option",{value:"WC",children:"Wheelchair"}),Pe.jsx("option",{value:"ST",children:"Stretcher"}),Pe.jsx("option",{value:"BCWCH",children:"Bariatric Wheelchair"})]}),Pe.jsx("button",{onClick:()=>S(),className:"button-colors input-button-import ibutton",children:"Add Driver"})]})})}function xOt(){return Pe.jsx(Pe.Fragment,{children:Pe.jsx("div",{className:"page-title-div",children:Pe.jsx("p",{className:"page-title",children:"Drivers"})})})}function sp({color:e}){function t(r,n){r=r.replace(/^\s*#|\s*$/g,""),r.length===3&&(r=r.replace(/(.)/g,"$1$1"));var i=parseInt(r.substr(0,2),16),o=parseInt(r.substr(2,2),16),s=parseInt(r.substr(4,2),16);n<0?(n=Math.abs(n),i=Math.round(i*(100-n)/100),o=Math.round(o*(100-n)/100),s=Math.round(s*(100-n)/100)):(i+=Math.round((255-i)*(n/100)),o+=Math.round((255-o)*(n/100)),s+=Math.round((255-s)*(n/100)));var a=i.toString(16).length===1?"0"+i.toString(16):i.toString(16),h=o.toString(16).length===1?"0"+o.toString(16):o.toString(16),p=s.toString(16).length===1?"0"+s.toString(16):s.toString(16);return"#"+a+h+p}return Pe.jsx(Pe.Fragment,{children:Pe.jsx("div",{className:"dynamic-marker-set",style:{borderColor:e,boxShadow:`0px 0px 7px ${e}`,backgroundColor:t(e,30)}})})}const Cpe=e=>{const t=[];for(let r=0;r<e.length;r++)e[r].Status==!0&&t.push(e[r]);return t},COt=(e,t)=>{let r=[[]],n=0;const i=Cpe(t),o=e.Sched.TimeSet[0],s=e.Sched.TimeSet[e.Sched.TimeSet.length-1];h(o,s),a();function a(){for(let S=1;S<=i.length;S++){const E=[i[S-1].Name];for(let O=1;O<n;O++)E.push("");r[S]=E}}function h(S,E){const O=p(E),A=p(S),$=O-A,B=["","8:00 AM",S];let j=0;for(;$-j>60;)j+=60,B.push(y(A+j));B.push(E),n+=B.length,r[0]=B}function p(S){const E=S.split(":"),O=E[1].split(" ");let A=Number(E[0]),$=Number(O[0]);O[1]=="PM"&&(A+=12);let j=A*60;return j+=$,j}function y(S){let E=Math.floor(S/60),O=S%60,A="";return E>12?(E-=12,A="PM"):A="AM",String(E)+":"+String(O)+" "+A}return console.log(r),r};function EOt({routeData:e,driverload:t}){const[r,n]=_t.useState(COt(e,t)),[i,o]=_t.useState(Cpe(t));return Pe.jsx(Pe.Fragment,{children:Pe.jsx("div",{className:"OPfather",children:Pe.jsx("div",{className:"dynamic-return",children:Pe.jsx("div",{className:"dynamic-app",children:Pe.jsxs("div",{className:"dynamic-grid",style:{gridTemplateColumns:`70px repeat(${(r[0].length-1)*6}, 1fr)`,gridTemplateRows:`35px repeat(${r.length-1}, 1fr)`},children:[r.map((s,a)=>s.map((h,p)=>Pe.jsx("div",{style:{gridColumn:p*6,gridRow:a+1},className:"dynamic-grid-item",children:h},`${a}-${p}`))),r.map((s,a)=>a===0?null:Pe.jsx("div",{className:"dynamic-overlay",style:{gridColumn:`2 / span ${(r[0].length-1)*6}`,gridRow:`${a+1} / span 1`,backgroundColor:i[a-1].Color}},a)),Pe.jsx("div",{className:"dynamic-marker",style:{gridColumn:"9",gridRow:"2"},children:Pe.jsx(sp,{color:i[2-2].Color})}),Pe.jsx("div",{className:"dynamic-marker",style:{gridColumn:"18",gridRow:"2"},children:Pe.jsx(sp,{color:i[2-2].Color})}),Pe.jsx("div",{className:"dynamic-marker",style:{gridColumn:"48",gridRow:"2"},children:Pe.jsx(sp,{color:i[2-2].Color})}),Pe.jsx("div",{className:"dynamic-marker",style:{gridColumn:"12",gridRow:"4"},children:Pe.jsx(sp,{color:i[4-2].Color})}),Pe.jsx("div",{className:"dynamic-marker",style:{gridColumn:"30",gridRow:"4"},children:Pe.jsx(sp,{color:i[4-2].Color})}),Pe.jsx("div",{className:"dynamic-marker",style:{gridColumn:"54",gridRow:"4"},children:Pe.jsx(sp,{color:i[4-2].Color})}),Pe.jsx("div",{className:"dynamic-marker",style:{gridColumn:"42",gridRow:"3"},children:Pe.jsx(sp,{color:i[3-2].Color})})]})})})})})}function TOt({currentPage:e,changePage:t,fileName:r,userFiles:n,selectFile:i,handleFileName:o,deleteFile:s,dataState:a,setdataState:h,size:p,setSize:y,saveCheck:S,setsaveCheck:E,checkifDeleted:O,setcheckifDeleted:A,userName:$,queryRouteAPI:B,supabase:j,reformatDataForRouteQuery:z,driverload:W,deleteDriver:Q,handleDriver:q,setDriverHave:Se,driverhave:Ie,grabAndListUserDrivers:He,routeData:Le,tab:ze,setTab:ct,activeTab:At,setActiveTab:Qe}){const de=()=>{if(e==="route")return At==="Map"?Pe.jsx(FEe,{routeData:Le,driverload:W}):Pe.jsx(EOt,{routeData:Le,driverload:W});if(e==="schedule")return Pe.jsx(_Ot,{changePage:t,setFileName2:o});if(e==="grid")return Pe.jsx(vOt,{fileName:r,deleteFile:s,dataState:a,setdataState:h,size:p,setSize:y,saveCheck:S,setsaveCheck:E,checkifDeleted:O,setcheckifDeleted:A,userName:$,supabase:j});if(e==="driver")return W.map((Ct,ie)=>{const M=ie;return Pe.jsx(wOt,{dkey:ie,name:Ct.Name,address:Ct.Address,type:Ct.Type,status1:Ct.Status,deleteDriver:Q,supabase:j,driverload:W,id:Ct.Id},M)})},Ce=()=>{if(e==="route")return Pe.jsx(HEe,{fileName:r,selectFile:i,userFiles:n,queryRouteAPI:B,reformatDataForRouteQuery:z,driverload:W,supabase:j});if(e==="schedule")return Pe.jsx(Mre,{userFiles:n,changePage:t,selectFile:i,fileName:r});if(e==="grid")return Pe.jsx(Mre,{userFiles:n,changePage:t,selectFile:i,fileName:r,setdataState:h});if(e==="driver")return Pe.jsx(SOt,{supabase:j,userName:$,driverload:W,handleDriver:q,setDriverHave:Se,grabAndListUserDrivers:He})},pt=()=>{if(e==="route")return Pe.jsx(BEe,{tab:ze,activeTab:At,setActiveTab:Qe});if(e=="grid"||e=="schedule")return Pe.jsx(bOt,{fileName:r,dataState:a,size:p,setsaveCheck:E,deleteFile:s,setcheckifDeleted:A,checkifDeleted:O,saveCheck:S,userName:$,supabase:j});if(e==="driver")return Pe.jsx(xOt,{})};return Pe.jsx(Pe.Fragment,{children:Pe.jsxs("div",{id:"root",className:"page-grid",children:[Pe.jsx("div",{className:"header",children:pt()}),Pe.jsx("div",{className:"main",children:de()}),Pe.jsx("div",{className:"input",children:Ce()})]})})}function OOt({supabase:e,setLogOut:t}){const r=jC(),[n,i]=_t.useState("route"),[o,s]=_t.useState(""),[a,h]=_t.useState([]),[p,y]=_t.useState(r.state.userid),[S,E]=_t.useState([]),[O,A]=_t.useState(0),[$,B]=_t.useState("Saved"),[j,z]=_t.useState(!0),[W,Q]=_t.useState(!1);_t.useState(!1);const[q,Se]=_t.useState([]),[Ie,He]=_t.useState([]),[Le,ze]=_t.useState(null),[ct,At]=_t.useState([]),[Qe,de]=_t.useState("Map"),Ce=ft=>{let St=ft.replace(/\//g,"*");s(St),pt(St),a.push(St)},pt=async ft=>{const St=p+"/"+ft;let Tt=new Blob([[""]],{type:"application/json"});const{error:Xt}=await e.storage.from("User-Files").upload(St,Tt);Xt&&console.log(Xt)},Ct=()=>{const ft=a.indexOf(o);ft>-1&&a.splice(ft,1),localStorage.setItem(p,JSON.stringify({files:a})),s(""),i("schedule"),Q(!1)},ie=ft=>{let St=-1;for(let Tt=0;Tt<q.length;Tt++)q[Tt].Name==ft&&(console.log("found"),St=Tt);M(St),St>-1&&q.splice(St,1),He(Tt=>[Tt])},M=async ft=>{const{error:St}=await e.from("user_drivers").delete().eq("Name",q[ft].Name);St&&console.log(St)},U=ft=>{s(ft)},K=ft=>{i(ft)};_t.useEffect(()=>{a.length==0&&n=="route"&&re()},[]),_t.useEffect(()=>{q.length==0&&n=="route"&&me()},[]);const re=async()=>{const{data:ft,error:St}=await e.storage.from("User-Files").list(p);if(St)console.log("error: "+St);else{if(ft==null)return;let Tt=[];for(let Xt=0;Xt<ft.length;Xt++){const{data:jt,error:Kt}=await e.storage.from("User-Files").download(p+"/"+ft[Xt].name);Kt?console.log(Kt):Je(jt).then(async qe=>{localStorage.setItem(p+"/"+ft[Xt].name,JSON.stringify({grid:qe})),localStorage.setItem(p+"/"+ft[Xt].name+"/lastrow",qe.length),localStorage.setItem(p+"/"+ft[Xt].name+"/savestate","Saved")}),Tt[Xt]=ft[Xt].name}h(Tt)}},me=async()=>{const{data:ft,error:St}=await e.from("user_drivers").select().eq("user_id",p);if(St)console.log(St);else{if(ft==null){console.log("NO DRIVERS_NULL");return}for(let Tt=0;Tt<ft.length;Tt++)q.push({Name:ft[Tt].Name,Address:ft[Tt].Address,Type:ft[Tt].vType,Status:ft[Tt].Status,Id:ft[Tt].driver_id,Color:ft[Tt].Color});He(Tt=>[Tt])}ct.push("Map"),At(ct)},Oe=async()=>{const{data:ft,error:St}=await e.storage.from("User-Files").download(p+"/"+o);St?console.log(St):Je(ft).then(async Tt=>{const Xt=[];let jt='"';if(Tt.length==1)Xt[0]=`{
`+jt+[0]+jt+": "+JSON.stringify(Tt[0],null,3)+`
}
`;else for(let Ee=0;Ee<Tt.length;Ee++)if(Ee==0){Xt[Ee]=`{
`+jt+[Ee]+jt+": "+JSON.stringify(Tt[Ee],null,3)+`
`;continue}else if(Ee==Tt.length-1){Xt[Ee]=jt+[Ee]+jt+": "+JSON.stringify(Tt[Ee],null,3)+`
}`;continue}else{Xt[Ee]=jt+[Ee]+jt+": "+JSON.stringify(Tt[Ee],null,3)+`
`;continue}const qe=We();let yr=new FormData,Ar=new Blob([[Xt]],{type:"application/json"}),wr=new Blob([[qe]],{type:"application/json"}),vr=new File([Ar],"Patients.json"),Cr=new File([wr],"Drivers.json");yr.append("file",vr),yr.append("file2",Cr);const ye=await(await fetch("http://localhost:5001/uploadjson",{method:"POST",body:yr})).json();ze(ye),ct.push(o),At(ct)})},We=()=>{let ft={};const St=q.length;for(let Tt=0,Xt=0;Tt<St;Tt++)q[Tt].Status==!0&&(ft[Xt]=q[Tt],Xt++);return JSON.stringify(ft,null,3)};function Je(ft){return new Promise((St,Tt)=>{const Xt=new FileReader;Xt.addEventListener("loadend",jt=>{const Kt=jt.target.result;try{const qe=JSON.parse(Kt);St(qe)}catch(qe){Tt(qe)}}),Xt.readAsText(ft)})}const ht=ft=>{Se(ft)};return Pe.jsx(Pe.Fragment,{children:Pe.jsxs("div",{className:"div-grid",children:[Pe.jsx("div",{className:"menu1",children:Pe.jsx($0e,{onMenuClick:K,currentPage:n,selectFile:U,setLogOut:t})}),Pe.jsx("div",{className:"app",children:Pe.jsx(TOt,{currentPage:n,fileName:o,userName:p,changePage:K,handleFileName:Ce,selectFile:U,userFiles:a,deleteFile:Ct,dataState:S,setdataState:E,size:O,setSize:A,saveCheck:$,setsaveCheck:B,mapOn:j,setmapOn:z,checkifDeleted:W,setcheckifDeleted:Q,supabase:e,reformatDataForRouteQuery:Oe,driverload:q,deleteDriver:ie,handleDriver:ht,setDriverHave:He,driverhave:Ie,grabAndListUserDrivers:me,routeData:Le,tab:ct,setTab:At,activeTab:Qe,setActiveTab:de})})]})})}const ROt=({logOut:e,setLogOut:t,supabase:r,userData:n,setUserData:i,setsessionData:o})=>{const[s,a]=_t.useState(""),[h,p]=_t.useState(""),[y,S]=_t.useState(!1),[E,O]=_t.useState(!1),[A,$]=_t.useState(!1),B=pI(),j=async()=>{let{data:W,error:Q}=await r.auth.signInWithPassword({email:h,password:s});Q==null?(localStorage.setItem("email",h),i(W.user),o(W.session)):(O(!0),S(!0))},z=()=>{if(s==""){S(!0);return}if(h==""){O(!0);return}else j()};return _t.useEffect(()=>{async function W(){const Q=await r.auth.getSession();Q&&(i(Q.data.session.user),o(Q.data))}e==null&&W()},[]),_t.useEffect(()=>{async function W(){const{error:Q}=await r.auth.signOut();Q?console.log("error signing out: "+Q):(i(null),o(null),t(null))}e==!0&&W()},[e]),_t.useEffect(()=>{if(n!=null&&e!=!0){const W={userid:n.id};B("/whichway",{state:W})}},[n]),Pe.jsx(Pe.Fragment,{children:Pe.jsxs("div",{className:"parent-login-div",children:[Pe.jsx("p",{style:{fontWeight:"400",fontFamily:"roboto"},children:"Login"}),Pe.jsx("input",{className:E==!1?"t-2":"t-2 t-2-warning",placeholder:"Username",onChange:W=>{p(W.target.value),O(!1)},value:h}),Pe.jsx("input",{className:y==!1?"t-2 t-2-3":"t-2 t-2-3 t-2-warning",type:A?"":"password",placeholder:"Password",onChange:W=>{a(W.target.value),S(!1)},value:s}),Pe.jsx("button",{className:"input-button-import v3",type:"button",onClick:()=>z(),children:"Authenticate"}),Pe.jsxs("label",{style:{display:"block",fontSize:"14px",fontFamily:"roboto",fontWeight:"300"},children:[Pe.jsx("input",{type:"checkbox",onChange:()=>$(!A),style:{marginRight:"7px"}}),"Show Password"]})]})})};function kOt({supabase:e,userData:t,setUserData:r,setsessionData:n}){const[i,o]=_t.useState(""),[s,a]=_t.useState(""),[h,p]=_t.useState(""),[y,S]=_t.useState(""),[E,O]=_t.useState(""),[A,$]=_t.useState(""),[B,j]=_t.useState(!1),[z,W]=_t.useState(!1),[Q,q]=_t.useState(!1),[Se,Ie]=_t.useState(!1),[He,Le]=_t.useState(!1),[ze,ct]=_t.useState(!1),At=pI(),Qe=()=>{if(i==""){j(!0);return}if(s==""){W(!0);return}if(h==""){q(!0);return}if(y==""){Ie(!0);return}if(E==""){Le(!0);return}if(A==""){ct(!0);return}else de()},de=async()=>{const{data:Ce,error:pt}=await e.auth.signUp({email:h,password:y,options:{data:{FirstName:i,LastName:s,PhoneNumber:E,Organization:A}}});pt?console.log(pt):(r(Ce.user),n(Ce.session),At("/verification"))};return Pe.jsx(Pe.Fragment,{children:Pe.jsx("div",{className:"signup-container",children:Pe.jsxs("div",{className:"sign-up-grid",children:[Pe.jsx("p",{style:{fontWeight:"400",fontFamily:"roboto",fontSize:"40px",textAlign:"center",color:"#337ab7"},className:"sign-header",children:"Sign Up"}),Pe.jsx("input",{placeholder:"First Name",className:B==!1?"schedule-input-series-sign-up fname":"schedule-input-series-sign-up fname-active",type:"text",onChange:Ce=>{o(Ce.target.value),j(!1)},value:i}),Pe.jsx("input",{placeholder:"Last Name",className:z==!1?"schedule-input-series-sign-up lname":"schedule-input-series-sign-up lname-active",type:"text",onChange:Ce=>{a(Ce.target.value),W(!1)},value:s}),Pe.jsx("input",{placeholder:"Email",className:Q==!1?"schedule-input-series-sign-up email":"schedule-input-series-sign-up email-active",type:"email",onChange:Ce=>{p(Ce.target.value),q(!1)},value:h}),Pe.jsx("input",{placeholder:"Password",className:Se==!1?"schedule-input-series-sign-up password":"schedule-input-series-sign-up password-active",type:"text",onChange:Ce=>{S(Ce.target.value),Ie(!1)},value:y}),Pe.jsx("input",{placeholder:"Phone Number",className:He==!1?"schedule-input-series-sign-up number":"schedule-input-series-sign-up number-active",type:"tel",pattern:"[0-9]{3}-[0-9]{2}-[0-9]{3}",onChange:Ce=>{O(Ce.target.value),Le(!1)},value:E}),Pe.jsx("input",{placeholder:"Organization Name",className:ze==!1?"schedule-input-series-sign-up org":"schedule-input-series-sign-up org-active",type:"text",onChange:Ce=>{$(Ce.target.value),ct(!1)},value:A}),Pe.jsx("button",{onClick:()=>Qe(),className:"input-button-import v5 sign-up",children:"Sign Up"})]})})})}function POt({supabase:e,userData:t,setUserData:r,setsessionData:n}){return Pe.jsx(Pe.Fragment,{children:Pe.jsxs("p",{style:{textAlign:"center",fontSize:"16px",marginTop:"300px",fontFamily:"roboto"},children:["go to your email at (",t.email,") and confirm your email to start routing"]})})}function AOt(){const[e,t]=_t.useState(null),[r,n]=_t.useState(null),[i,o]=_t.useState(null),s=x0e("https://jskylaemugysziiuhbnp.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Impza3lsYWVtdWd5c3ppaXVoYm5wIiwicm9sZSI6ImFub24iLCJpYXQiOjE2ODQzNjcyNzIsImV4cCI6MTk5OTk0MzI3Mn0.z2ChCLTkbBB3PnW8YMCJk3ESdfLE3R3Cc7V8tF8FI4E");return Pe.jsxs(mbe,{children:[Pe.jsx(Cy,{path:"/",element:Pe.jsx(M0e,{})}),Pe.jsx(Cy,{path:"/log-in/",element:Pe.jsx(ROt,{supabase:s,logOut:e,setLogOut:t,userData:r,setsessionData:o,setUserData:n})}),Pe.jsx(Cy,{path:"/register/",element:Pe.jsx(kOt,{supabase:s,userData:r,setUserData:n,setsessionData:o})}),Pe.jsx(Cy,{path:"/whichway",element:Pe.jsx(OOt,{supabase:s,setLogOut:t})}),Pe.jsx(Cy,{path:"/verification",element:Pe.jsx(POt,{supabase:s,userData:r,setUserData:n,setsessionData:o})})]})}ON.createRoot(document.getElementById("root")).render(Pe.jsx(bbe,{children:Pe.jsx(AOt,{})}))});export default IOt();
